(self.webpackChunksmartlocker_workspace=self.webpackChunksmartlocker_workspace||[]).push([[73],{97185:(ne,L,y)=>{"use strict";function l(Ir,Ot){var Le="function"==typeof Symbol&&Ir[Symbol.iterator];if(!Le)return Ir;var at,qt,we=Le.call(Ir),Re=[];try{for(;(void 0===Ot||Ot-- >0)&&!(at=we.next()).done;)Re.push(at.value)}catch(Pr){qt={error:Pr}}finally{try{at&&!at.done&&(Le=we.return)&&Le.call(we)}finally{if(qt)throw qt.error}}return Re}function O(Ir){return Ir&&Ir.__esModule&&Object.prototype.hasOwnProperty.call(Ir,"default")?Ir.default:Ir}function R(Ir,Ot){return Ir(Ot={exports:{}},Ot.exports),Ot.exports}y.d(L,{zj:()=>je,oI:()=>cn,ni:()=>ce,gg:()=>Fr});var N=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(we){return we&&"number"==typeof we.length&&we.length>=0&&we.length%1==0},Ir.exports=Ot.default});O(N);var H=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(Le){return function(){for(var we=[],at=arguments.length;at--;)we[at]=arguments[at];var Re=we.pop();return Le.call(this,we,Re)}},Ir.exports=Ot.default});O(H);var j=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.fallback=at,Ot.wrap=Re;var qt,Le=Ot.hasSetImmediate="function"==typeof setImmediate&&setImmediate,we=Ot.hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;function at(Pr){setTimeout(Pr,0)}function Re(Pr){return function(er){for(var hr=[],Nr=arguments.length-1;Nr-- >0;)hr[Nr]=arguments[Nr+1];return Pr(function(){return er.apply(void 0,hr)})}}qt=Le?setImmediate:we?process.nextTick:at,Ot.default=Re(qt)});O(j);var Ye=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(er){return(0,_t.isAsync)(er)?function(){for(var hr=[],Nr=arguments.length;Nr--;)hr[Nr]=arguments[Nr];var $r=hr.pop(),C=er.apply(this,hr);return qt(C,$r)}:(0,Le.default)(function(hr,Nr){var $r;try{$r=er.apply(this,hr)}catch(C){return Nr(C)}if($r&&"function"==typeof $r.then)return qt($r,Nr);Nr(null,$r)})};var Le=at(H),we=at(j);function at(er){return er&&er.__esModule?er:{default:er}}function qt(er,hr){return er.then(function(Nr){Pr(hr,null,Nr)},function(Nr){Pr(hr,Nr&&Nr.message?Nr:new Error(Nr))})}function Pr(er,hr,Nr){try{er(hr,Nr)}catch($r){(0,we.default)(function(C){throw C},$r)}}Ir.exports=Ot.default});O(Ye);var _t=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.isAsyncIterable=Ot.isAsyncGenerator=Ot.isAsync=void 0;var er,Le=(er=Ye)&&er.__esModule?er:{default:er};function at(er){return"AsyncFunction"===er[Symbol.toStringTag]}Ot.default=function(er){if("function"!=typeof er)throw new Error("expected a function");return at(er)?(0,Le.default)(er):er},Ot.isAsync=at,Ot.isAsyncGenerator=function(er){return"AsyncGenerator"===er[Symbol.toStringTag]},Ot.isAsyncIterable=function(er){return"function"==typeof er[Symbol.asyncIterator]}});O(_t);var tt=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(we,at){if(void 0===at&&(at=we.length),!at)throw new Error("arity is undefined");function Re(){for(var qt=this,Pr=[],er=arguments.length;er--;)Pr[er]=arguments[er];return"function"==typeof Pr[at-1]?we.apply(this,Pr):new Promise(function(hr,Nr){Pr[at-1]=function($r){for(var C=[],Y=arguments.length-1;Y-- >0;)C[Y]=arguments[Y+1];if($r)return Nr($r);hr(C.length>1?C:C[0])},we.apply(qt,Pr)})}return Object.defineProperty(Re,"name",{configurable:!0,value:"awaitable("+we.name+")"}),Re},Ir.exports=Ot.default});O(tt);var Gt=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0});var Le=Re(N),we=Re(_t),at=Re(tt);function Re(qt){return qt&&qt.__esModule?qt:{default:qt}}Ot.default=(0,at.default)(function(qt,Pr,er){var hr=(0,Le.default)(Pr)?[]:{};qt(Pr,function(Nr,$r,C){(0,we.default)(Nr)(function(Y){for(var nt=[],xt=arguments.length-1;xt-- >0;)nt[xt]=arguments[xt+1];nt.length<2&&(nt=nt[0]),hr[$r]=nt,C(Y)})},function(Nr){return er(Nr,hr)})},3),Ir.exports=Ot.default});O(Gt);var Q=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(we){function at(){for(var Re=[],qt=arguments.length;qt--;)Re[qt]=arguments[qt];if(null!==we){var Pr=we;we=null,Pr.apply(this,Re)}}return Object.assign(at,we),at},Ir.exports=Ot.default});O(Q);var Ut=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(Le){return Le[Symbol.iterator]&&Le[Symbol.iterator]()},Ir.exports=Ot.default});O(Ut);var ot=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(hr){if((0,Le.default)(hr))return function(hr){var Nr=-1,$r=hr.length;return function(){return++Nr<$r?{value:hr[Nr],key:Nr}:null}}(hr);var Nr=(0,we.default)(hr);return Nr?function(hr){var Nr=-1;return function(){var C=hr.next();return C.done?null:(Nr++,{value:C.value,key:Nr})}}(Nr):function(hr){var Nr=hr?Object.keys(hr):[],$r=-1,C=Nr.length;return function(){var Ge=Nr[++$r];return $r<C?{value:hr[Ge],key:Ge}:null}}(hr)};var Le=at(N),we=at(Ut);function at(hr){return hr&&hr.__esModule?hr:{default:hr}}Ir.exports=Ot.default});O(ot);var Ue=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(we){return function(){for(var at=[],Re=arguments.length;Re--;)at[Re]=arguments[Re];if(null===we)throw new Error("Callback was already called.");var qt=we;we=null,qt.apply(this,at)}},Ir.exports=Ot.default});O(Ue);var ct=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default={},Ir.exports=Ot.default});O(ct);var Xe=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(Re,qt,Pr,er){var hr=!1,Nr=!1,$r=!1,C=0,Y=0;function Ge(){C>=qt||$r||hr||($r=!0,Re.next().then(function(Dt){var Z=Dt.value;if(!Nr&&!hr){if($r=!1,Dt.done)return hr=!0,void(C<=0&&er(null));C++,Pr(Z,Y,nt),Y++,Ge()}}).catch(xt))}function nt(Dt,Z){if(C-=1,!Nr){if(Dt)return xt(Dt);if(!1===Dt)return hr=!0,void(Nr=!0);if(Z===Le.default||hr&&C<=0)return hr=!0,er(null);Ge()}}function xt(Dt){Nr||($r=!1,hr=!0,er(Dt))}Ge()};var Re,Le=(Re=ct)&&Re.__esModule?Re:{default:Re};Ir.exports=Ot.default});O(Xe);var Pt=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0});var Le=Pr(Q),we=Pr(ot),at=Pr(Ue),Re=Pr(Xe),qt=Pr(ct);function Pr(er){return er&&er.__esModule?er:{default:er}}Ot.default=function(er){return function(hr,Nr,$r){if($r=(0,Le.default)($r),er<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!hr)return $r(null);if((0,_t.isAsyncGenerator)(hr))return(0,Re.default)(hr,er,Nr,$r);if((0,_t.isAsyncIterable)(hr))return(0,Re.default)(hr[Symbol.asyncIterator](),er,Nr,$r);var C=(0,we.default)(hr),Y=!1,Ge=!1,nt=0,xt=!1;function Dt(Ze,Et){if(!Ge)if(nt-=1,Ze)Y=!0,$r(Ze);else if(!1===Ze)Y=!0,Ge=!0;else{if(Et===qt.default||Y&&nt<=0)return Y=!0,$r(null);xt||Z()}}function Z(){for(xt=!0;nt<er&&!Y;){var Ze=C();if(null===Ze)return Y=!0,void(nt<=0&&$r(null));nt+=1,Nr(Ze.value,Ze.key,(0,at.default)(Dt))}xt=!1}Z()}},Ir.exports=Ot.default});O(Pt);var kt=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0});var Le=Re(Pt),we=Re(_t),at=Re(tt);function Re(Pr){return Pr&&Pr.__esModule?Pr:{default:Pr}}Ot.default=(0,at.default)(function(Pr,er,hr,Nr){return(0,Le.default)(er)(Pr,(0,we.default)(hr),Nr)},4),Ir.exports=Ot.default});O(kt);var ut=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0});var Le=at(kt),we=at(tt);function at(qt){return qt&&qt.__esModule?qt:{default:qt}}Ot.default=(0,we.default)(function(qt,Pr,er){return(0,Le.default)(qt,1,Pr,er)},3),Ir.exports=Ot.default});O(ut);var le=O(R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(qt,Pr){return(0,Le.default)(we.default,qt,Pr)};var Le=at(Gt),we=at(ut);function at(qt){return qt&&qt.__esModule?qt:{default:qt}}Ir.exports=Ot.default})),ce=function(){function Ir(){for(var Ot=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Ot[we];this.args=[],this.tasks=[]}return Ir.prototype.call=function(){for(var Ot=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Ot[we];return this.args=Le,le(this.tasks)},Ir.prototype.tap=function(Ot,Le){var we=this;this.tasks.push(function(at){Le.apply(void 0,function(){for(var Ir=[],Ot=0;Ot<arguments.length;Ot++)Ir=Ir.concat(l(arguments[Ot]));return Ir}(we.args)),at(null,Ot)})},Ir}(),ae=R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0});var Le=hr(N),we=hr(ct),at=hr(kt),Re=hr(Q),qt=hr(Ue),Pr=hr(_t),er=hr(tt);function hr(Y){return Y&&Y.__esModule?Y:{default:Y}}function Nr(Y,Ge,nt){nt=(0,Re.default)(nt);var xt=0,Dt=0,Z=Y.length,Ze=!1;function Et(Mt,Jt){!1===Mt&&(Ze=!0),!0!==Ze&&(Mt?nt(Mt):(++Dt===Z||Jt===we.default)&&nt(null))}for(0===Z&&nt(null);xt<Z;xt++)Ge(Y[xt],xt,(0,qt.default)(Et))}function $r(Y,Ge,nt){return(0,at.default)(Y,1/0,Ge,nt)}Ot.default=(0,er.default)(function(Y,Ge,nt){return((0,Le.default)(Y)?Nr:$r)(Y,(0,Pr.default)(Ge),nt)},3),Ir.exports=Ot.default});O(ae);var Ie=O(R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.default=function(qt,Pr){return(0,we.default)(Le.default,qt,Pr)};var Le=at(ae),we=at(Gt);function at(qt){return qt&&qt.__esModule?qt:{default:qt}}Ir.exports=Ot.default})),je=function(){function Ir(){for(var Ot=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Ot[we];this.tasks=[]}return Ir.prototype.promise=function(){for(var Ot=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Ot[we];return Ie(this.tasks)},Ir.prototype.tapPromise=function(Ot,Le){var we=this;this.tasks.push(function(at){return function(Ir,Ot,Le,we){return new(Le||(Le=Promise))(function(Re,qt){function Pr(Nr){try{hr(we.next(Nr))}catch($r){qt($r)}}function er(Nr){try{hr(we.throw(Nr))}catch($r){qt($r)}}function hr(Nr){Nr.done?Re(Nr.value):function(Re){return Re instanceof Le?Re:new Le(function(qt){qt(Re)})}(Nr.value).then(Pr,er)}hr((we=we.apply(Ir,Ot||[])).next())})}(we,void 0,void 0,function(){return function(Ir,Ot){var we,at,Re,qt,Le={label:0,sent:function(){if(1&Re[0])throw Re[1];return Re[1]},trys:[],ops:[]};return qt={next:Pr(0),throw:Pr(1),return:Pr(2)},"function"==typeof Symbol&&(qt[Symbol.iterator]=function(){return this}),qt;function Pr(hr){return function(Nr){return function(hr){if(we)throw new TypeError("Generator is already executing.");for(;Le;)try{if(we=1,at&&(Re=2&hr[0]?at.return:hr[0]?at.throw||((Re=at.return)&&Re.call(at),0):at.next)&&!(Re=Re.call(at,hr[1])).done)return Re;switch(at=0,Re&&(hr=[2&hr[0],Re.value]),hr[0]){case 0:case 1:Re=hr;break;case 4:return Le.label++,{value:hr[1],done:!1};case 5:Le.label++,at=hr[1],hr=[0];continue;case 7:hr=Le.ops.pop(),Le.trys.pop();continue;default:if(!(Re=(Re=Le.trys).length>0&&Re[Re.length-1])&&(6===hr[0]||2===hr[0])){Le=0;continue}if(3===hr[0]&&(!Re||hr[1]>Re[0]&&hr[1]<Re[3])){Le.label=hr[1];break}if(6===hr[0]&&Le.label<Re[1]){Le.label=Re[1],Re=hr;break}if(Re&&Le.label<Re[2]){Le.label=Re[2],Le.ops.push(hr);break}Re[2]&&Le.ops.pop(),Le.trys.pop();continue}hr=Ot.call(Ir,Le)}catch(Nr){hr=[6,Nr],at=0}finally{we=Re=0}if(5&hr[0])throw hr[1];return{value:hr[0]?hr[1]:void 0,done:!0}}([hr,Nr])}}}(this,function(Re){switch(Re.label){case 0:return[4,Le()];case 1:return Re.sent(),at(null,Ot),[2]}})})})},Ir}(),xr=O(R(function(Ir,Ot){Object.defineProperty(Ot,"__esModule",{value:!0});var Le=qt(Q),we=qt(Ue),at=qt(_t),Re=qt(tt);function qt(er){return er&&er.__esModule?er:{default:er}}Ot.default=(0,Re.default)(function(er,hr){if(hr=(0,Le.default)(hr),!Array.isArray(er))return hr(new Error("First argument to waterfall must be an array of functions"));if(!er.length)return hr();var Nr=0;function $r(Y){(0,at.default)(er[Nr++]).apply(void 0,Y.concat([(0,we.default)(C)]))}function C(Y){for(var Ge=[],nt=arguments.length-1;nt-- >0;)Ge[nt]=arguments[nt+1];if(!1!==Y){if(Y||Nr===er.length)return hr.apply(void 0,[Y].concat(Ge));$r(Ge)}}$r([])}),Ir.exports=Ot.default})),Fr=function(){function Ir(){for(var Ot=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Ot[we];this.tasks=[]}return Ir.prototype.call=function(){for(var Ot=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Ot[we];return xr(this.tasks)},Ir.prototype.tap=function(Ot,Le){this.tasks.push(0===this.tasks.length?function(we){var at=Le();we(!!at&&null,at)}:function(we,at){at(!!Le()&&null,Ot)})},Ir}(),cn=function(){function Ir(){for(var Ot=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Ot[we];this.tasks=[]}return Ir.prototype.call=function(){for(var Ot=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Ot[we];return le(this.tasks)},Ir.prototype.tap=function(Ot,Le){this.tasks.push(function(we){we(Le(),Ot)})},Ir}()},42837:(ne,L,y)=>{"use strict";y.d(L,{nC:()=>M.ZP,Hp:()=>M.Hp,e7:()=>M.e7,yT:()=>M.yT,vK:()=>l.v,BlendType:()=>O.h,AttributeType:()=>R.GC,ScaleTypes:()=>R.vY,StyleScaleType:()=>R.ee,MapServiceEvent:()=>j.I,CoordinateSystem:()=>be.l,CoordinateUniform:()=>be.k,CameraUniform:()=>W.l,SceneEventList:()=>Rt.P,PositionType:()=>ot.d,gl:()=>Pr.gl});var M=y(54184),l=(y(20051),y(92444)),O=(y(10120),y(35781)),R=y(39727),N=y(33511);y.o(N,"CameraUniform")&&y.d(L,{CameraUniform:function(){return N.CameraUniform}}),y.o(N,"CoordinateSystem")&&y.d(L,{CoordinateSystem:function(){return N.CoordinateSystem}}),y.o(N,"CoordinateUniform")&&y.d(L,{CoordinateUniform:function(){return N.CoordinateUniform}}),y.o(N,"Layers")&&y.d(L,{Layers:function(){return N.Layers}}),y.o(N,"MapServiceEvent")&&y.d(L,{MapServiceEvent:function(){return N.MapServiceEvent}}),y.o(N,"PointLayer")&&y.d(L,{PointLayer:function(){return N.PointLayer}}),y.o(N,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return N.PolygonLayer}}),y.o(N,"PositionType")&&y.d(L,{PositionType:function(){return N.PositionType}}),y.o(N,"Scene")&&y.d(L,{Scene:function(){return N.Scene}}),y.o(N,"SceneEventList")&&y.d(L,{SceneEventList:function(){return N.SceneEventList}}),y.o(N,"gl")&&y.d(L,{gl:function(){return N.gl}});var j=y(53262),be=y(62306),Ne=y(75541);y.o(Ne,"CameraUniform")&&y.d(L,{CameraUniform:function(){return Ne.CameraUniform}}),y.o(Ne,"Layers")&&y.d(L,{Layers:function(){return Ne.Layers}}),y.o(Ne,"PointLayer")&&y.d(L,{PointLayer:function(){return Ne.PointLayer}}),y.o(Ne,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Ne.PolygonLayer}}),y.o(Ne,"PositionType")&&y.d(L,{PositionType:function(){return Ne.PositionType}}),y.o(Ne,"Scene")&&y.d(L,{Scene:function(){return Ne.Scene}}),y.o(Ne,"SceneEventList")&&y.d(L,{SceneEventList:function(){return Ne.SceneEventList}}),y.o(Ne,"gl")&&y.d(L,{gl:function(){return Ne.gl}});var W=y(40646),Ye=y(24495);y.o(Ye,"Layers")&&y.d(L,{Layers:function(){return Ye.Layers}}),y.o(Ye,"PointLayer")&&y.d(L,{PointLayer:function(){return Ye.PointLayer}}),y.o(Ye,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Ye.PolygonLayer}}),y.o(Ye,"PositionType")&&y.d(L,{PositionType:function(){return Ye.PositionType}}),y.o(Ye,"Scene")&&y.d(L,{Scene:function(){return Ye.Scene}}),y.o(Ye,"SceneEventList")&&y.d(L,{SceneEventList:function(){return Ye.SceneEventList}}),y.o(Ye,"gl")&&y.d(L,{gl:function(){return Ye.gl}});var Rt=y(80533),wt=y(63877);y.o(wt,"Layers")&&y.d(L,{Layers:function(){return wt.Layers}}),y.o(wt,"PointLayer")&&y.d(L,{PointLayer:function(){return wt.PointLayer}}),y.o(wt,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return wt.PolygonLayer}}),y.o(wt,"PositionType")&&y.d(L,{PositionType:function(){return wt.PositionType}}),y.o(wt,"Scene")&&y.d(L,{Scene:function(){return wt.Scene}}),y.o(wt,"gl")&&y.d(L,{gl:function(){return wt.gl}});var tt=y(21236);y.o(tt,"Layers")&&y.d(L,{Layers:function(){return tt.Layers}}),y.o(tt,"PointLayer")&&y.d(L,{PointLayer:function(){return tt.PointLayer}}),y.o(tt,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return tt.PolygonLayer}}),y.o(tt,"PositionType")&&y.d(L,{PositionType:function(){return tt.PositionType}}),y.o(tt,"Scene")&&y.d(L,{Scene:function(){return tt.Scene}}),y.o(tt,"gl")&&y.d(L,{gl:function(){return tt.gl}});var Q=y(22115);y.o(Q,"Layers")&&y.d(L,{Layers:function(){return Q.Layers}}),y.o(Q,"PointLayer")&&y.d(L,{PointLayer:function(){return Q.PointLayer}}),y.o(Q,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Q.PolygonLayer}}),y.o(Q,"PositionType")&&y.d(L,{PositionType:function(){return Q.PositionType}}),y.o(Q,"Scene")&&y.d(L,{Scene:function(){return Q.Scene}}),y.o(Q,"gl")&&y.d(L,{gl:function(){return Q.gl}});var ot=y(59304),Ue=y(35323);y.o(Ue,"Layers")&&y.d(L,{Layers:function(){return Ue.Layers}}),y.o(Ue,"PointLayer")&&y.d(L,{PointLayer:function(){return Ue.PointLayer}}),y.o(Ue,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Ue.PolygonLayer}}),y.o(Ue,"Scene")&&y.d(L,{Scene:function(){return Ue.Scene}}),y.o(Ue,"gl")&&y.d(L,{gl:function(){return Ue.gl}});var Xe=y(35393);y.o(Xe,"Layers")&&y.d(L,{Layers:function(){return Xe.Layers}}),y.o(Xe,"PointLayer")&&y.d(L,{PointLayer:function(){return Xe.PointLayer}}),y.o(Xe,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Xe.PolygonLayer}}),y.o(Xe,"Scene")&&y.d(L,{Scene:function(){return Xe.Scene}}),y.o(Xe,"gl")&&y.d(L,{gl:function(){return Xe.gl}}),y(12260);var ut=y(25655);y.o(ut,"Layers")&&y.d(L,{Layers:function(){return ut.Layers}}),y.o(ut,"PointLayer")&&y.d(L,{PointLayer:function(){return ut.PointLayer}}),y.o(ut,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return ut.PolygonLayer}}),y.o(ut,"Scene")&&y.d(L,{Scene:function(){return ut.Scene}}),y.o(ut,"gl")&&y.d(L,{gl:function(){return ut.gl}});var le=y(94671);y.o(le,"Layers")&&y.d(L,{Layers:function(){return le.Layers}}),y.o(le,"PointLayer")&&y.d(L,{PointLayer:function(){return le.PointLayer}}),y.o(le,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return le.PolygonLayer}}),y.o(le,"Scene")&&y.d(L,{Scene:function(){return le.Scene}}),y.o(le,"gl")&&y.d(L,{gl:function(){return le.gl}});var ae=y(75846);y.o(ae,"Layers")&&y.d(L,{Layers:function(){return ae.Layers}}),y.o(ae,"PointLayer")&&y.d(L,{PointLayer:function(){return ae.PointLayer}}),y.o(ae,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return ae.PolygonLayer}}),y.o(ae,"Scene")&&y.d(L,{Scene:function(){return ae.Scene}}),y.o(ae,"gl")&&y.d(L,{gl:function(){return ae.gl}});var Ie=y(81210);y.o(Ie,"Layers")&&y.d(L,{Layers:function(){return Ie.Layers}}),y.o(Ie,"PointLayer")&&y.d(L,{PointLayer:function(){return Ie.PointLayer}}),y.o(Ie,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Ie.PolygonLayer}}),y.o(Ie,"Scene")&&y.d(L,{Scene:function(){return Ie.Scene}}),y.o(Ie,"gl")&&y.d(L,{gl:function(){return Ie.gl}});var gt=y(20626);y.o(gt,"Layers")&&y.d(L,{Layers:function(){return gt.Layers}}),y.o(gt,"PointLayer")&&y.d(L,{PointLayer:function(){return gt.PointLayer}}),y.o(gt,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return gt.PolygonLayer}}),y.o(gt,"Scene")&&y.d(L,{Scene:function(){return gt.Scene}}),y.o(gt,"gl")&&y.d(L,{gl:function(){return gt.gl}});var Fr=y(6974);y.o(Fr,"Layers")&&y.d(L,{Layers:function(){return Fr.Layers}}),y.o(Fr,"PointLayer")&&y.d(L,{PointLayer:function(){return Fr.PointLayer}}),y.o(Fr,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Fr.PolygonLayer}}),y.o(Fr,"Scene")&&y.d(L,{Scene:function(){return Fr.Scene}}),y.o(Fr,"gl")&&y.d(L,{gl:function(){return Fr.gl}}),y(55576);var Ot=y(23824);y.o(Ot,"Layers")&&y.d(L,{Layers:function(){return Ot.Layers}}),y.o(Ot,"PointLayer")&&y.d(L,{PointLayer:function(){return Ot.PointLayer}}),y.o(Ot,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Ot.PolygonLayer}}),y.o(Ot,"Scene")&&y.d(L,{Scene:function(){return Ot.Scene}}),y.o(Ot,"gl")&&y.d(L,{gl:function(){return Ot.gl}});var we=y(34710);y.o(we,"Layers")&&y.d(L,{Layers:function(){return we.Layers}}),y.o(we,"PointLayer")&&y.d(L,{PointLayer:function(){return we.PointLayer}}),y.o(we,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return we.PolygonLayer}}),y.o(we,"Scene")&&y.d(L,{Scene:function(){return we.Scene}}),y.o(we,"gl")&&y.d(L,{gl:function(){return we.gl}});var Re=y(27159);y.o(Re,"Layers")&&y.d(L,{Layers:function(){return Re.Layers}}),y.o(Re,"PointLayer")&&y.d(L,{PointLayer:function(){return Re.PointLayer}}),y.o(Re,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Re.PolygonLayer}}),y.o(Re,"Scene")&&y.d(L,{Scene:function(){return Re.Scene}}),y.o(Re,"gl")&&y.d(L,{gl:function(){return Re.gl}});var Pr=y(24558)},54184:(ne,L,y)=>{"use strict";y.d(L,{e7:()=>Fi,Hp:()=>yi,ZP:()=>Vi,yT:()=>Dn}),y(78320);var Ue,_=y(42624),l=y.n(_),m=y(15922),O=y(43857),R=y(92444),N=y(75134),H=y(47289),j=y(93512),be=y(30832),Ne=y(51002),V=y.n(Ne);function W(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function Ye(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?W(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):W(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}function _t(te,ie){var F="undefined"!=typeof Symbol&&te[Symbol.iterator]||te["@@iterator"];if(!F){if(Array.isArray(te)||(F=function(te,ie){if(te){if("string"==typeof te)return wt(te,undefined);var F=Object.prototype.toString.call(te).slice(8,-1);if("Object"===F&&te.constructor&&(F=te.constructor.name),"Map"===F||"Set"===F)return Array.from(te);if("Arguments"===F||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F))return wt(te,undefined)}}(te))||ie&&te&&"number"==typeof te.length){F&&(te=F);var U=0,de=function(){};return{s:de,n:function(){return U>=te.length?{done:!0}:{done:!1,value:te[U++]}},e:function(lr){throw lr},f:de}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Nt,Te=!0,mt=!1;return{s:function(){F=F.call(te)},n:function(){var lr=F.next();return Te=lr.done,lr},e:function(lr){mt=!0,Nt=lr},f:function(){try{!Te&&null!=F.return&&F.return()}finally{if(mt)throw Nt}}}}function wt(te,ie){(null==ie||ie>te.length)&&(ie=te.length);for(var F=0,U=new Array(ie);F<ie;F++)U[F]=te[F];return U}function Q(te,ie,F){var de,U=_t(ie);try{for(U.s();!(de=U.n()).done;){var Te=de.value,mt=Te.icon,Nt=Te.xOffset;te[mt.id]=Ye(Ye({},mt),{},{x:Nt,y:F,image:mt.image,width:mt.width,height:mt.height})}}catch(Lt){U.e(Lt)}finally{U.f()}}function Ut(te){return Math.pow(2,Math.ceil(Math.log2(te)))}function ct(te,ie){var F="undefined"!=typeof Symbol&&te[Symbol.iterator]||te["@@iterator"];if(!F){if(Array.isArray(te)||(F=function(te,ie){if(te){if("string"==typeof te)return Pt(te,undefined);var F=Object.prototype.toString.call(te).slice(8,-1);if("Object"===F&&te.constructor&&(F=te.constructor.name),"Map"===F||"Set"===F)return Array.from(te);if("Arguments"===F||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F))return Pt(te,undefined)}}(te))||ie&&te&&"number"==typeof te.length){F&&(te=F);var U=0,de=function(){};return{s:de,n:function(){return U>=te.length?{done:!0}:{done:!1,value:te[U++]}},e:function(lr){throw lr},f:de}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Nt,Te=!0,mt=!1;return{s:function(){F=F.call(te)},n:function(){var lr=F.next();return Te=lr.done,lr},e:function(lr){mt=!0,Nt=lr},f:function(){try{!Te&&null!=F.return&&F.return()}finally{if(mt)throw Nt}}}}function Pt(te,ie){(null==ie||ie>te.length)&&(ie=te.length);for(var F=0,U=new Array(ie);F<ie;F++)U[F]=te[F];return U}function kt(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function ut(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?kt(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):kt(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var ir=function(){for(var te=[],ie=32;ie<128;ie++)te.push(String.fromCharCode(ie));return te}();function Le(te,ie,F,U){te.font="".concat(U," ").concat(F,"px ").concat(ie),te.fillStyle="black",te.textBaseline="middle"}function we(te,ie){for(var F=0;F<te.length;F++)ie.data[4*F+3]=te[F]}var Nr,at=(0,m.b2)()(Ue=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"fontAtlas",void 0),(0,j.Z)(this,"iconFontMap",void 0),(0,j.Z)(this,"iconFontGlyphs",{}),(0,j.Z)(this,"fontOptions",void 0),(0,j.Z)(this,"key",void 0),(0,j.Z)(this,"cache",new be.z6(3))}return(0,H.Z)(te,[{key:"scale",get:function(){return 1}},{key:"canvas",get:function(){var F=this.cache.get(this.key);return F&&F.data}},{key:"mapping",get:function(){var F=this.cache.get(this.key);return F&&F.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:"sans-serif",fontWeight:"normal",characterSet:ir,fontSize:24,buffer:3,sdf:!0,cutoff:.25,radius:8,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(F){var U=this;F.forEach(function(de){U.iconFontGlyphs[de.name]=de.unicode})}},{key:"addIconFont",value:function(F,U){this.iconFontMap.set(F,U)}},{key:"getIconFontKey",value:function(F){return this.iconFontMap.get(F)||F}},{key:"getGlyph",value:function(F){return this.iconFontGlyphs[F]?String.fromCharCode(parseInt(this.iconFontGlyphs[F],16)):""}},{key:"setFontOptions",value:function(F){this.fontOptions=ut(ut({},this.fontOptions),F),this.key=this.getKey();var U=this.getNewChars(this.key,this.fontOptions.characterSet),de=this.cache.get(this.key);if(!de||0!==U.length){var Te=this.generateFontAtlas(this.key,U,de);this.fontAtlas=Te,this.cache.set(this.key,Te)}}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(F,U,de){var Te=this.fontOptions,mt=Te.fontFamily,Nt=Te.fontWeight,Lt=Te.fontSize,lr=Te.buffer,jr=Te.sdf,Ln=Te.radius,Xn=Te.cutoff,ni=Te.iconfont,Ci=de&&de.data;Ci||((Ci=document.createElement("canvas")).width=1024);var Si=Ci.getContext("2d");Le(Si,mt,Lt,Nt);var ea=function(te){var F=te.getFontWidth,U=te.fontHeight,de=te.buffer,Te=te.maxCanvasWidth,mt=te.mapping,Nt=void 0===mt?{}:mt,Lt=te.xOffset,jr=te.yOffset,Ln=void 0===jr?0:jr,Xn=0,ni=void 0===Lt?0:Lt;Array.from(te.characterSet).forEach(function(Si,ea){if(!Nt[Si]){var xa=F(Si,ea);ni+30>Te&&(ni=0,Xn++),Nt[Si]={x:ni,y:Ln+30*Xn,width:30,height:30,advance:xa},ni+=30}});var Ci=U+2*de;return{mapping:Nt,xOffset:ni,yOffset:Ln+Xn*Ci,canvasHeight:Ut(Ln+(Xn+1)*Ci)}}(ut({getFontWidth:function(Su){return Si.measureText(Su).width},fontHeight:1*Lt,buffer:lr,characterSet:U,maxCanvasWidth:1024},de&&{mapping:de.mapping,xOffset:de.xOffset,yOffset:de.yOffset})),xa=ea.mapping,ua=ea.canvasHeight,Ha=ea.xOffset,Wa=ea.yOffset,Ka=Si.getImageData(0,0,Ci.width,Ci.height);if(Ci.height=ua,Si.putImageData(Ka,0,0),Le(Si,mt,Lt,Nt),jr){var no,ia=new(V())(Lt,lr,Ln,Xn,mt,Nt),ga=Si.getImageData(0,0,ia.size,ia.size),la=ct(U);try{for(la.s();!(no=la.n()).done;){var ki=no.value;if(ni){var Ca=String.fromCharCode(parseInt(ki.replace("&#x","").replace(";",""),16));we(ia.draw(Ca),ga)}else we(ia.draw(ki),ga);Si.putImageData(ga,xa[ki].x,xa[ki].y)}}catch(Ko){la.e(Ko)}finally{la.f()}}else{var Yl,go=ct(U);try{for(go.s();!(Yl=go.n()).done;){var uu=Yl.value;Si.fillText(uu,xa[uu].x,xa[uu].y+1*Lt)}}catch(Ko){go.e(Ko)}finally{go.f()}}return{xOffset:Ha,yOffset:Wa,mapping:xa,data:Ci,width:Ci.width,height:Ci.height}}},{key:"getKey",value:function(){return"key"}},{key:"getNewChars",value:function(F,U){var de=this.cache.get(F);if(!de)return U;var Te=[],Nt=new Set(Object.keys(de.mapping));return new Set(U).forEach(function(lr){Nt.has(lr)||Te.push(lr)}),Te}}]),te}())||Ue,Re=y(66518),qt=y(41885),Pr=y(59553),er=y(99187);var Et,Tr,xt=(0,m.b2)()(Nr=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){var U;(0,N.Z)(this,F);for(var de=arguments.length,Te=new Array(de),mt=0;mt<de;mt++)Te[mt]=arguments[mt];return U=ie.call.apply(ie,[this].concat(Te)),(0,j.Z)((0,Re.Z)(U),"canvasHeight",128),(0,j.Z)((0,Re.Z)(U),"texture",void 0),(0,j.Z)((0,Re.Z)(U),"canvas",void 0),(0,j.Z)((0,Re.Z)(U),"iconData",void 0),(0,j.Z)((0,Re.Z)(U),"iconMap",void 0),(0,j.Z)((0,Re.Z)(U),"ctx",void 0),(0,j.Z)((0,Re.Z)(U),"loadingImageCount",0),U}return(0,H.Z)(F,[{key:"isLoading",value:function(){return 0===this.loadingImageCount}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(de,Te){var mt=this,Nt=new Image;if(this.loadingImageCount++,this.hasImage(de))throw new Error("Image Id already exists");this.iconData.push({id:de,size:64}),this.updateIconMap(),this.loadImage(Te).then(function(Lt){Nt=Lt;var lr=mt.iconData.find(function(jr){return jr.id===de});lr&&(lr.image=Nt,lr.width=Nt.width,lr.height=Nt.height),mt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(de){return this.iconMap.hasOwnProperty(de)}},{key:"removeImage",value:function(de){this.hasImage(de)&&(this.iconData=this.iconData.filter(function(Te){return Te.id!==de}),delete this.iconMap[de],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,0===this.loadingImageCount&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var de=this;this.canvas.width=1024,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(Te){var mt=de.iconMap[Te],Nt=mt.x,Lt=mt.y,lr=mt.image,jr=mt.width,Ln=void 0===jr?64:jr,Xn=mt.height,ni=void 0===Xn?64:Xn,Si=Math.max(Ln,ni)/64,ea=ni/Si,xa=Ln/Si;lr&&de.ctx.drawImage(lr,Nt+(64-xa)/2,Lt+(64-ea)/2,xa,ea)})}},{key:"updateIconMap",value:function(){var de=function(te,ie,F){var lr,U=0,de=0,Te=0,mt=[],Nt={},Lt=_t(te);try{for(Lt.s();!(lr=Lt.n()).done;){var jr=lr.value;if(!Nt[jr.id]){var Ln=jr.size;U+Ln+3>1024&&(Q(Nt,mt,de),U=0,de=Te+de+3,Te=0,mt=[]),mt.push({icon:jr,xOffset:U}),U=U+Ln+3,Te=Math.max(Te,Ln)}}}catch(ni){Lt.e(ni)}finally{Lt.f()}return mt.length>0&&Q(Nt,mt,de),{mapping:Nt,canvasHeight:Ut(Te+de+3)}}(this.iconData),mt=de.canvasHeight;this.iconMap=de.mapping,this.canvasHeight=mt}},{key:"loadImage",value:function(de){return new Promise(function(Te,mt){if(de instanceof HTMLImageElement)Te(de);else{var Nt=new Image;Nt.crossOrigin="anonymous",Nt.onload=function(){Te(Nt)},Nt.onerror=function(){mt(new Error("Could not load image at "+de))},Nt.src=de instanceof File?URL.createObjectURL(de):de}})}}]),F}(_.EventEmitter))||Nr,Dt=y(83838),Z=y(30651),Mt=(0,m.b2)()(Et=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"viewport",void 0),(0,j.Z)(this,"overridedViewProjectionMatrix",void 0),(0,j.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,j.Z)(this,"jitteredProjectionMatrix",void 0),(0,j.Z)(this,"viewMatrixInverse",void 0),(0,j.Z)(this,"cameraPosition",void 0)}return(0,H.Z)(te,[{key:"init",value:function(){}},{key:"update",value:function(F){this.viewport=F,this.viewMatrixInverse=Z.create(),Z.invert(this.viewMatrixInverse,F.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var F=this.viewport.getCenter(),U=(0,Dt.Z)(F,2);return[U[0],U[1]]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(F,U){return this.viewport.projectFlat(F,U)}},{key:"setViewProjectionMatrix",value:function(F){this.overridedViewProjectionMatrix=F}},{key:"jitterProjectionMatrix",value:function(F,U){var de=Z.fromTranslation(Z.create(),[F,U,0]);this.jitteredProjectionMatrix=Z.multiply(Z.create(),de,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Z.multiply(Z.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),te}())||Et;function gr(te,ie){(null==ie||ie>te.length)&&(ie=te.length);for(var F=0,U=new Array(ie);F<ie;F++)U[F]=te[F];return U}var mn,hi,sr=(0,m.b2)()(Tr=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"container",void 0),(0,j.Z)(this,"controlCorners",void 0),(0,j.Z)(this,"controlContainer",void 0),(0,j.Z)(this,"scene",void 0),(0,j.Z)(this,"mapsService",void 0),(0,j.Z)(this,"controls",[]),(0,j.Z)(this,"unAddControls",[])}return(0,H.Z)(te,[{key:"init",value:function(F,U){this.container=F.container,this.scene=U,this.mapsService=U.get(R.v.IMapService),this.initControlPos()}},{key:"addControl",value:function(F,U){U.get(R.v.IMapService).map?(F.addTo(this.scene),this.controls.push(F)):this.unAddControls.push(F)}},{key:"getControlByName",value:function(F){return this.controls.find(function(U){return U.controlOption.name===F})}},{key:"removeControl",value:function(F){var U=this.controls.indexOf(F);return U>-1&&this.controls.splice(U,1),F.remove(),this}},{key:"addControls",value:function(){var F=this;this.unAddControls.forEach(function(U){U.addTo(F.scene),F.controls.push(U)}),this.unAddControls=[]}},{key:"destroy",value:function(){var U,F=function(te,ie){var F="undefined"!=typeof Symbol&&te[Symbol.iterator]||te["@@iterator"];if(!F){if(Array.isArray(te)||(F=function(te,ie){if(te){if("string"==typeof te)return gr(te,void 0);var F=Object.prototype.toString.call(te).slice(8,-1);if("Object"===F&&te.constructor&&(F=te.constructor.name),"Map"===F||"Set"===F)return Array.from(te);if("Arguments"===F||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F))return gr(te,void 0)}}(te))||ie&&te&&"number"==typeof te.length){F&&(te=F);var U=0,de=function(){};return{s:de,n:function(){return U>=te.length?{done:!0}:{done:!1,value:te[U++]}},e:function(lr){throw lr},f:de}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Nt,Te=!0,mt=!1;return{s:function(){F=F.call(te)},n:function(){var lr=F.next();return Te=lr.done,lr},e:function(lr){mt=!0,Nt=lr},f:function(){try{!Te&&null!=F.return&&F.return()}finally{if(mt)throw Nt}}}}(this.controls);try{for(F.s();!(U=F.n()).done;)U.value.remove()}catch(Te){F.e(Te)}finally{F.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var F=this.controlCorners={},U="l7-",de=this.controlContainer=be.SO.create("div",U+"control-container",this.container);function Te(){var mt=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],Nt=mt.map(function(Lt){return U+Lt}).join(" ");F[mt.join("")]=be.SO.create("div",Nt,de)}Te(["top","left"]),Te(["top","right"]),Te(["bottom","left"]),Te(["bottom","right"]),Te(["top","center"]),Te(["right","center"]),Te(["left","center"]),Te(["bottom","center"])}},{key:"clearControlPos",value:function(){for(var F in this.controlCorners)this.controlCorners[F]&&be.SO.remove(this.controlCorners[F]);this.controlContainer&&be.SO.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),te}())||Tr,On=(0,m.b2)()(mn=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"container",void 0),(0,j.Z)(this,"scene",void 0),(0,j.Z)(this,"mapsService",void 0),(0,j.Z)(this,"markers",[]),(0,j.Z)(this,"markerLayers",[]),(0,j.Z)(this,"unAddMarkers",[]),(0,j.Z)(this,"unAddMarkerLayers",[])}return(0,H.Z)(te,[{key:"addMarkerLayer",value:function(F){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(F),F.addTo(this.scene)):this.unAddMarkerLayers.push(F)}},{key:"removeMarkerLayer",value:function(F){F.destroy(),this.markerLayers.indexOf(F);var U=this.markerLayers.indexOf(F);U>-1&&this.markerLayers.splice(U,1)}},{key:"addMarker",value:function(F){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(F),F.addTo(this.scene)):this.unAddMarkers.push(F)}},{key:"addMarkers",value:function(){var F=this;this.unAddMarkers.forEach(function(U){U.addTo(F.scene),F.markers.push(U)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var F=this;this.unAddMarkerLayers.forEach(function(U){F.markerLayers.push(U),U.addTo(F.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(F){F.remove(),this.markers.indexOf(F);var U=this.markers.indexOf(F);U>-1&&this.markers.splice(U,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(F){this.scene=F,this.mapsService=F.get(R.v.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(F){F.remove()}),this.markers=[],this.markerLayers.forEach(function(F){F.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(F){F.destroy()}}]),te}())||mn,si=(0,m.b2)()(hi=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"scene",void 0),(0,j.Z)(this,"popup",void 0),(0,j.Z)(this,"mapsService",void 0),(0,j.Z)(this,"unAddPopup",void 0)}return(0,H.Z)(te,[{key:"removePopup",value:function(F){F.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(F){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(F.addTo(this.scene),this.popup=F):this.unAddPopup=F}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(F){this.scene=F,this.mapsService=F.get(R.v.IMapService)}}]),te}())||hi,ai=y(3912),Yi=y.n(ai);const Ei={MapToken:"\u60a8\u6b63\u5728\u4f7f\u7528 Demo\u6d4b\u8bd5\u5730\u56fetoken\uff0c\u5982\u679c\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u53bb\u5bf9\u5e94\u5730\u56fe\u8bf7\u6ce8\u518cToken",SDK:"\u8bf7\u786e\u8ba4\u5f15\u5165\u4e86mapbox-gl api\u4e14\u5728L7\u4e4b\u524d\u5f15\u5165"};var ve;function _e(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function G(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?_e(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):_e(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var oe={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},xe={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Oe=(0,m.b2)()(ve=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"sceneConfigCache",{}),(0,j.Z)(this,"layerConfigCache",{})}return(0,H.Z)(te,[{key:"getSceneConfig",value:function(F){return this.sceneConfigCache[F]}},{key:"getSceneWarninfo",value:function(F){return Ei[F]}},{key:"setSceneConfig",value:function(F,U){this.sceneConfigCache[F]=G(G({},oe),U)}},{key:"getLayerConfig",value:function(F){return this.layerConfigCache[F]}},{key:"setLayerConfig",value:function(F,U,de){this.layerConfigCache[U]=G({},Yi()({},this.sceneConfigCache[F],xe,de))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),te}())||ve,pe=y(32952),Ae=y(56326),Tt=y(58623),wr=Math.PI/180;function Br(te){var ie=te.latitude,F=void 0===ie?0:ie,U=te.zoom,Te=te.scale,mt=te.highPrecision,Nt=void 0!==mt&&mt,Lt=te.flipY,lr=void 0!==Lt&&Lt,jr={},Ln=512*(Te=void 0!==Te?Te:Math.pow(2,void 0===U?0:U)),Xn=Math.cos(F*wr),ni=Ln/360,Ci=ni/Xn,Si=Ln/4003e4/Xn;if(jr.pixelsPerMeter=[Si,-Si,Si],jr.metersPerPixel=[1/Si,-1/Si,1/Si],jr.pixelsPerDegree=[ni,-Ci,Si],jr.degreesPerPixel=[1/ni,-1/Ci,1/Si],Nt){var ea=wr*Math.tan(F*wr)/Xn,ua=Ln/4003e4*ea,Ha=ua/Ci*Si;jr.pixelsPerDegree2=[0,-ni*ea/2,ua],jr.pixelsPerMeter2=[Ha,0,Ha],lr&&(jr.pixelsPerDegree2[1]=-jr.pixelsPerDegree2[1],jr.pixelsPerMeter2[1]=-jr.pixelsPerMeter2[1])}return lr&&(jr.pixelsPerMeter[1]=-jr.pixelsPerMeter[1],jr.metersPerPixel[1]=-jr.metersPerPixel[1],jr.pixelsPerDegree[1]=-jr.pixelsPerDegree[1],jr.degreesPerPixel[1]=-jr.degreesPerPixel[1]),jr}var Pn,rr,Sn,an,fn,Ji,ji,Ti,_a,Ia,Rn=y(62306),Di=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],_n=(Pn=(0,m.b2)(),rr=(0,m.f3)(R.v.ICameraService),Pn((an=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"needRefresh",!0),(0,pe.Z)(this,"cameraService",fn,this),(0,j.Z)(this,"coordinateSystem",void 0),(0,j.Z)(this,"viewportCenter",void 0),(0,j.Z)(this,"viewportCenterProjection",void 0),(0,j.Z)(this,"pixelsPerDegree",void 0),(0,j.Z)(this,"pixelsPerDegree2",void 0),(0,j.Z)(this,"pixelsPerMeter",void 0)}return(0,H.Z)(te,[{key:"refresh",value:function(){var F=this.cameraService.getZoom(),U=this.cameraService.getZoomScale(),de=this.cameraService.getCenter(),Te=Br({latitude:de[1],zoom:F}),mt=Te.pixelsPerMeter,Nt=Te.pixelsPerDegree;this.viewportCenter=de,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=mt,this.pixelsPerDegree=Nt,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Rn.l.LNGLAT||this.coordinateSystem===Rn.l.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Rn.l.LNGLAT_OFFSET?this.calculateLnglatOffset(de,F):this.coordinateSystem===Rn.l.P20_OFFSET&&this.calculateLnglatOffset(de,F,U,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(F){this.coordinateSystem=F}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(F,U,de,Te){var mt=Br({latitude:F[1],zoom:U,scale:de,flipY:Te,highPrecision:!0}),Nt=mt.pixelsPerMeter,Lt=mt.pixelsPerDegree,lr=mt.pixelsPerDegree2,jr=this.cameraService.getViewMatrix(),Ln=this.cameraService.getProjectionMatrix(),Xn=Z.multiply([],Ln,jr),ni=this.cameraService.projectFlat([Math.fround(F[0]),Math.fround(F[1])],Math.pow(2,U));this.viewportCenterProjection=Tt.fF([],[ni[0],ni[1],0,1],Xn),jr=this.cameraService.getViewMatrixUncentered()||jr,Xn=Z.multiply([],Ln,jr),Xn=Z.multiply([],Xn,Di),this.cameraService.setViewProjectionMatrix(Xn),this.pixelsPerMeter=Nt,this.pixelsPerDegree=Lt,this.pixelsPerDegree2=lr}}]),te}(),fn=(0,Ae.Z)(an.prototype,"cameraService",[rr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sn=an))||Sn),Oi=y(11524),ta=y.n(Oi),oi=y(12260);var Xi={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},to=(Ji=(0,m.b2)(),ji=(0,m.f3)(R.v.IMapService),Ji((_a=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){var U;(0,N.Z)(this,F);for(var de=arguments.length,Te=new Array(de),mt=0;mt<de;mt++)Te[mt]=arguments[mt];return U=ie.call.apply(ie,[this].concat(Te)),(0,pe.Z)((0,Re.Z)(U),"mapService",Ia,(0,Re.Z)(U)),(0,j.Z)((0,Re.Z)(U),"hammertime",void 0),(0,j.Z)((0,Re.Z)(U),"lastClickTime",0),(0,j.Z)((0,Re.Z)(U),"lastClickXY",[-1,-1]),(0,j.Z)((0,Re.Z)(U),"clickTimer",void 0),(0,j.Z)((0,Re.Z)(U),"$containter",void 0),(0,j.Z)((0,Re.Z)(U),"onDrag",function(Nt){var Lt=U.interactionEvent(Nt);Lt.type=Xi[Lt.type],U.emit(oi.s.Drag,Lt)}),(0,j.Z)((0,Re.Z)(U),"onHammer",function(Nt){Nt.srcEvent.stopPropagation();var Lt=U.interactionEvent(Nt);U.emit(oi.s.Hover,Lt)}),(0,j.Z)((0,Re.Z)(U),"onTouch",function(Nt){var Lt=Nt.touches[0];U.onHover({x:Lt.pageX,y:Lt.pageY,type:"touch"})}),(0,j.Z)((0,Re.Z)(U),"onHover",function(Nt){var jr=Nt.clientX,Ln=Nt.clientY,Xn=Nt.type,ni=U.mapService.getMapContainer();if(ni){var Ci=ni.getBoundingClientRect();jr=jr-Ci.left-ni.clientLeft,Ln=Ln-Ci.top-ni.clientTop}var xa=U.mapService.containerToLngLat([jr,Ln]);if("click"!==Xn)"touch"!==Xn?"click"!==Xn&&"dblclick"!==Xn&&U.emit(oi.s.Hover,{x:jr,y:Ln,lngLat:xa,type:Xn,target:Nt}):U.isDoubleTap(jr,Ln,xa);else{if("ontouchstart"in document.documentElement)return;U.isDoubleTap(jr,Ln,xa)}}),U}return(0,H.Z)(F,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(oi.s.Hover)}},{key:"triggerHover",value:function(de){this.emit(oi.s.Hover,{x:de.x,y:de.y})}},{key:"triggerSelect",value:function(de){this.emit(oi.s.Select,{featureId:de})}},{key:"triggerActive",value:function(de){this.emit(oi.s.Active,{featureId:de})}},{key:"addEventListenerOnMap",value:function(){var de=this.mapService.getMapContainer();if(de){var Te=new(ta().Manager)(de);Te.add(new(ta().Tap)({event:"dblclick",taps:2})),Te.add(new(ta().Tap)({event:"click"})),Te.add(new(ta().Pan)({threshold:0,pointers:0})),Te.add(new(ta().Press)({})),Te.on("dblclick click",this.onHammer),Te.on("panstart panmove panend pancancel",this.onDrag),de.addEventListener("mousemove",this.onHover),de.addEventListener("mousedown",this.onHover,!0),de.addEventListener("mouseup",this.onHover),de.addEventListener("contextmenu",this.onHover),this.hammertime=Te}}},{key:"removeEventListenerOnMap",value:function(){var de=this.mapService.getMapContainer();de&&(de.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),de.removeEventListener("mousedown",this.onHover),de.removeEventListener("mouseup",this.onHover),de.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(de){var Nt,Lt,Te=de.type;"touch"===de.pointerType?(Lt=Math.floor(de.pointers[0].clientY),Nt=Math.floor(de.pointers[0].clientX)):(Lt=Math.floor(de.srcEvent.y),Nt=Math.floor(de.srcEvent.x));var lr=this.mapService.getMapContainer();if(lr){var jr=lr.getBoundingClientRect();Nt-=jr.left,Lt-=jr.top}return{x:Nt,y:Lt,lngLat:this.mapService.containerToLngLat([Nt,Lt]),type:Te,target:de.srcEvent}}},{key:"isDoubleTap",value:function(de,Te,mt){var Nt=this,Lt=(new Date).getTime();Lt-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-de)<10&&Math.abs(this.lastClickXY[1]-Te)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),this.emit(oi.s.Hover,{x:de,y:Te,lngLat:mt,type:"dblclick"})):(this.lastClickTime=Lt,this.lastClickXY=[de,Te],this.clickTimer=setTimeout(function(){Nt.emit(oi.s.Hover,{x:de,y:Te,lngLat:mt,type:"click"})},400))}}]),F}(l()),Ia=(0,Ae.Z)(_a.prototype,"mapService",[ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ti=_a))||Ti),Ho=y(8239),Za=y(88774),Wi=y.n(Za),wu=(window,0);function Da(te){var ie=te;if("string"==typeof te&&(ie=document.getElementById(te)),ie){var F=document.createElement("div");return F.style.cssText+="\n      position: absolute;\n      z-index:2;\n      height: 100%;\n      width: 100%;\n      pointer-events: none;\n    ",F.id="l7-scene-".concat(wu++),F.classList.add("l7-scene"),ie.appendChild(F),F}return null}var ra,bo,ma,vo,Fo,Ls,aa,Jo,Ma,Ya,$o,Bi=y(24558);function Na(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function Ee(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?Na(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):Na(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var or,Yr,$n,xi,lo,ro,co,ps,du,ts,ks,Qs,gs,Oa,ko,Ve=(ra=(0,m.b2)(),bo=(0,m.f3)(R.v.IRendererService),ma=(0,m.f3)(R.v.IGlobalConfigService),vo=(0,m.f3)(R.v.IInteractionService),Fo=(0,m.f3)(R.v.ILayerService),ra((aa=function(){function te(){var ie=this;(0,N.Z)(this,te),(0,pe.Z)(this,"rendererService",Jo,this),(0,pe.Z)(this,"configService",Ma,this),(0,pe.Z)(this,"interactionService",Ya,this),(0,pe.Z)(this,"layerService",$o,this),(0,j.Z)(this,"pickingFBO",void 0),(0,j.Z)(this,"width",0),(0,j.Z)(this,"height",0),(0,j.Z)(this,"alreadyInPicking",!1),(0,j.Z)(this,"pickBufferScale",1),(0,j.Z)(this,"pickFromPickingFBO",function(F,U){var de,Te=U.x,mt=U.y,Nt=U.lngLat,Lt=U.type,lr=U.target,jr=!1,Ln=ie.rendererService,ni=Ln.readPixels,Si=(0,Ln.getContainer)().getBoundingClientRect(),ea=Si.width,xa=Si.height;ea*=be.SO.DPR,xa*=be.SO.DPR;var ga,ua=F.getLayerConfig(),Ha=ua.enableHighlight,Wa=ua.enableSelect,Ka=Te*be.SO.DPR,ia=mt*be.SO.DPR;if(Ka>ea-1*be.SO.DPR||Ka<0||ia>xa-1*be.SO.DPR||ia<0)return!1;if(0!==(ga=ni({x:Math.floor(Ka/ie.pickBufferScale),y:Math.floor((xa-(mt+1)*be.SO.DPR)/ie.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:ie.pickingFBO}))[0]||0!==ga[1]||0!==ga[2]){var la=(0,be.W0)(ga),no=F.getSource().getFeatureById(la);la!==F.getCurrentPickId()&&"mousemove"===Lt&&(Lt="mouseenter");var ki={x:Te,y:mt,type:Lt,lngLat:Nt,featureId:la,feature:no,target:lr};no&&(jr=!0,F.setCurrentPickId(la),ie.triggerHoverOnLayer(F,ki))}else{var Ca={x:Te,y:mt,lngLat:Nt,type:null!==F.getCurrentPickId()&&"mousemove"===Lt?"mouseout":"un"+Lt,featureId:null,target:lr,feature:null};ie.triggerHoverOnLayer(F,Ee(Ee({},Ca),{},{type:"unpick"})),ie.triggerHoverOnLayer(F,Ca),F.setCurrentPickId(null)}if(Ha&&ie.highlightPickedFeature(F,ga),Wa&&"click"===Lt&&(null===(de=ga)||void 0===de?void 0:de.toString())!==[0,0,0,0].toString()){var ba=(0,be.W0)(ga);null===F.getCurrentSelectedId()||ba!==F.getCurrentSelectedId()?(ie.selectFeature(F,ga),F.setCurrentSelectedId(ba)):(ie.selectFeature(F,new Uint8Array([0,0,0,0])),F.setCurrentSelectedId(null))}return jr})}return(0,H.Z)(te,[{key:"init",value:function(F){var U=this.rendererService,de=U.createTexture2D,Te=U.createFramebuffer,Lt=(0,U.getContainer)().getBoundingClientRect(),lr=Lt.width,jr=Lt.height;lr*=be.SO.DPR,jr*=be.SO.DPR,this.pickBufferScale=this.configService.getSceneConfig(F).pickBufferScale||1,this.pickingFBO=Te({color:de({width:Math.round(lr/this.pickBufferScale),height:Math.round(jr/this.pickBufferScale),wrapS:Bi.gl.CLAMP_TO_EDGE,wrapT:Bi.gl.CLAMP_TO_EDGE})}),this.interactionService.on(oi.s.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:(ie=(0,Ho.Z)(Wi().mark(function U(de,Te,mt){var Lt,lr,jr,Nt=this;return Wi().wrap(function(ni){for(;;)switch(ni.prev=ni.next){case 0:lr=(Lt=this.rendererService).useFramebuffer,jr=Lt.clear,this.resizePickingFBO(),lr(this.pickingFBO,function(){jr({framebuffer:Nt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),de.hooks.beforePickingEncode.call(),de.renderModels(),de.hooks.afterPickingEncode.call();var Ci=Nt.pickBox(de,Te);mt(Ci)});case 3:case"end":return ni.stop()}},U,this)})),function(U,de,Te){return ie.apply(this,arguments)})},{key:"pickBox",value:function(F,U){var de=this,Te=U.map(function(Ca){return Math.floor((Ca<0?0:Ca)*be.SO.DPR/de.pickBufferScale)}),mt=(0,Dt.Z)(Te,4),Nt=mt[0],Lt=mt[1],lr=mt[2],jr=mt[3],Ln=this.rendererService,ni=Ln.readPixels,Si=(0,Ln.getContainer)().getBoundingClientRect(),ea=Si.width,xa=Si.height;if(xa*=be.SO.DPR,Nt>((ea*=be.SO.DPR)-1)*be.SO.DPR/this.pickBufferScale||lr<0||Lt>(xa-1)*be.SO.DPR/this.pickBufferScale||jr<0)return[];var ua,Ha=Math.min(ea/this.pickBufferScale,lr)-Nt,Wa=Math.min(xa/this.pickBufferScale,jr)-Lt;ua=ni({x:Nt,y:Math.floor(xa/this.pickBufferScale-(jr+1)),width:Ha,height:Wa,data:new Uint8Array(Ha*Wa*4),framebuffer:this.pickingFBO});for(var Ka=[],ia={},ga=0;ga<ua.length/4;ga+=1){var la=ua.slice(4*ga,4*ga+4),no=(0,be.W0)(la);if(-1!==no&&!ia[no]){var ki=F.getSource().getFeatureById(no);Ka.push(ki),ia[no]=!0}}return Ka}},{key:"pickingAllLayer",value:function(){var ie=(0,Ho.Z)(Wi().mark(function U(de){return Wi().wrap(function(mt){for(;;)switch(mt.prev=mt.next){case 0:if(!this.alreadyInPicking&&!this.layerService.alreadyInRendering){mt.next=2;break}return mt.abrupt("return");case 2:return this.alreadyInPicking=!0,mt.next=5,this.pickingLayers(de);case 5:this.layerService.renderLayers("picking"),this.alreadyInPicking=!1;case 7:case"end":return mt.stop()}},U,this)}));return function(U){return ie.apply(this,arguments)}}()},{key:"resizePickingFBO",value:function(){var U=(0,this.rendererService.getContainer)().getBoundingClientRect(),de=U.width,Te=U.height;Te*=be.SO.DPR,(this.width!==(de*=be.SO.DPR)||this.height!==Te)&&(this.pickingFBO.resize({width:Math.round(de/this.pickBufferScale),height:Math.round(Te/this.pickBufferScale)}),this.width=de,this.height=Te)}},{key:"pickingLayers",value:function(){var ie=(0,Ho.Z)(Wi().mark(function U(de){var mt,Lt,lr,Te=this;return Wi().wrap(function(Xn){for(;;)switch(Xn.prev=Xn.next){case 0:Lt=(mt=this.rendererService).useFramebuffer,lr=mt.clear,this.resizePickingFBO(),Lt(this.pickingFBO,function(){Te.layerService.getLayers().filter(function(Ci){return Ci.needPick(de.type)}).reverse().some(function(Ci){return lr({framebuffer:Te.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Ci.hooks.beforePickingEncode.call(),Ci.renderModels(),Ci.hooks.afterPickingEncode.call(),Te.pickFromPickingFBO(Ci,de)&&!Ci.getLayerConfig().enablePropagation})});case 3:case"end":return Xn.stop()}},U,this)}));return function(U){return ie.apply(this,arguments)}}()},{key:"triggerHoverOnLayer",value:function(F,U){(function(te){var ie,F,U=!0;return null==te||null===(ie=te.target)||void 0===ie||null===(F=ie.path)||void 0===F||F.map(function(de){var Te;null!=de&&de.classList&&(null==de||null===(Te=de.classList)||void 0===Te||Te.forEach(function(mt){("l7-marker"===mt||"l7-popup"===mt)&&(U=!1)}))}),U})(U)&&F.emit(U.type,U)}},{key:"highlightPickedFeature",value:function(F,U){var de=(0,Dt.Z)(U,3);F.hooks.beforeHighlight.call([de[0],de[1],de[2]])}},{key:"selectFeature",value:function(F,U){var de=(0,Dt.Z)(U,3);F.hooks.beforeSelect.call([de[0],de[1],de[2]])}}]),te;var ie}(),Jo=(0,Ae.Z)(aa.prototype,"rendererService",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ma=(0,Ae.Z)(aa.prototype,"configService",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ya=(0,Ae.Z)(aa.prototype,"interactionService",[vo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=(0,Ae.Z)(aa.prototype,"layerService",[Fo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ls=aa))||Ls),St=function(){function te(){var ie=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,N.Z)(this,te),(0,j.Z)(this,"autoStart",void 0),(0,j.Z)(this,"startTime",0),(0,j.Z)(this,"oldTime",0),(0,j.Z)(this,"running",!1),(0,j.Z)(this,"elapsedTime",0),this.autoStart=ie}return(0,H.Z)(te,[{key:"start",value:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var F=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var U=("undefined"==typeof performance?Date:performance).now();F=(U-this.oldTime)/1e3,this.oldTime=U,this.elapsedTime+=F}return F}}]),te}(),Eu=(or=(0,m.b2)(),Yr=(0,m.f3)(R.v.IRendererService),$n=(0,m.f3)(R.v.IMapService),xi=(0,m.f3)(R.v.IGlobalConfigService),or((ro=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"clock",new St),(0,j.Z)(this,"alreadyInRendering",!1),(0,j.Z)(this,"layers",[]),(0,j.Z)(this,"layerRenderID",void 0),(0,j.Z)(this,"sceneInited",!1),(0,j.Z)(this,"animateInstanceCount",0),(0,j.Z)(this,"lastRenderType",void 0),(0,j.Z)(this,"lastPickRenderTime",void 0),(0,pe.Z)(this,"renderService",co,this),(0,pe.Z)(this,"mapService",ps,this),(0,pe.Z)(this,"configService",du,this)}return(0,H.Z)(te,[{key:"add",value:function(F){this.sceneInited&&F.init(),this.layers.push(F)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(F){F.inited||F.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(F){return this.layers.find(function(U){return U.id===F})}},{key:"getLayerByName",value:function(F){return this.layers.find(function(U){return U.name===F})}},{key:"remove",value:function(F){var U=this.layers.indexOf(F);U>-1&&this.layers.splice(U,1),F.emit("remove",null),F.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(F){!this.renderTest(F)||this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(U){return U.inited}).filter(function(U){return U.isVisible()}).forEach(function(U){U.hooks.beforeRenderData.call(),U.hooks.beforeRender.call(),U.render(),U.hooks.afterRender.call()}),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(F,U){return F.zIndex-U.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(F){return F.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){0==this.animateInstanceCount++&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){0==--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"renderTest",value:function(F){var de=(new Date).getTime()-this.lastPickRenderTime;if("picking"===F&&(this.lastPickRenderTime=(new Date).getTime()),F)switch(F){case"picking":return"mapRender"===this.lastRenderType||"animate"===this.lastRenderType?(this.lastRenderType="picking",de>48):(this.lastRenderType="picking",!0);case"animate":return"mapRender"===this.lastRenderType?(this.lastRenderType="animate",!1):(this.lastRenderType="animate",!0);case"mapRender":return this.lastRenderType="mapRender",!0;default:return!0}return!0}},{key:"clear",value:function(){var F=(0,be.CI)(this.mapService.bgColor);this.renderService.clear({color:F,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers("animate"),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),te}(),co=(0,Ae.Z)(ro.prototype,"renderService",[Yr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ps=(0,Ae.Z)(ro.prototype,"mapService",[$n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=(0,Ae.Z)(ro.prototype,"configService",[xi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lo=ro))||lo),fl=y(71189),Wo=y(96109),Qo=y(28303),Lo=y.n(Qo),es=function(){function te(ie){var F=this;(0,N.Z)(this,te),(0,j.Z)(this,"name",void 0),(0,j.Z)(this,"type",void 0),(0,j.Z)(this,"scale",void 0),(0,j.Z)(this,"descriptor",void 0),(0,j.Z)(this,"featureBufferLayout",[]),(0,j.Z)(this,"needRescale",!1),(0,j.Z)(this,"needRemapping",!1),(0,j.Z)(this,"needRegenerateVertices",!1),(0,j.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,j.Z)(this,"vertexAttribute",void 0),(0,j.Z)(this,"defaultCallback",function(U){var de;return 0===U.length?(null===(de=F.scale)||void 0===de?void 0:de.defaultValues)||[]:U.map(function(Te,mt){var Nt;return(null===(Nt=F.scale)||void 0===Nt?void 0:Nt.scalers[mt].func)(Te)})}),this.setProps(ie)}return(0,H.Z)(te,[{key:"setProps",value:function(F){Object.assign(this,F)}},{key:"mapping",value:function(F){var U;if(null!==(U=this.scale)&&void 0!==U&&U.callback){var de,Te=null===(de=this.scale)||void 0===de?void 0:de.callback.apply(de,(0,Wo.Z)(F));if(!Lo()(Te))return[Te]}return this.defaultCallback(F)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),te}();function Ol(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function Ll(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?Ol(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):Ol(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var g,T,K,D,ge,Fe,yt,Zt,Ft,Or,zr,Jn,bi,pi,oa,Ea,Fa,vi,Xo,vu,Tu,Ec,Du,Nl,mu,gu,tu,oo,Tc,Cc,rs,tc,ru,wc=((0,j.Z)(ts={},Bi.gl.FLOAT,4),(0,j.Z)(ts,Bi.gl.UNSIGNED_BYTE,1),(0,j.Z)(ts,Bi.gl.UNSIGNED_SHORT,2),ts),Rl=(ks=(0,m.b2)(),Qs=(0,m.f3)(R.v.IRendererService),ks((Oa=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"attributesAndIndices",void 0),(0,pe.Z)(this,"rendererService",ko,this),(0,j.Z)(this,"attributes",[]),(0,j.Z)(this,"triangulation",void 0),(0,j.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,H.Z)(te,[{key:"registerStyleAttribute",value:function(F){var U=this.getLayerStyleAttribute(F.name||"");return U?U.setProps(F):(U=new es(F),this.attributes.push(U)),U}},{key:"updateStyleAttribute",value:function(F,U,de){var Te=this.getLayerStyleAttribute(F);Te||(Te=this.registerStyleAttribute(Ll(Ll({},U),{},{name:F})));var mt=U.scale;mt&&Te&&(Te.scale=mt,Te.needRescale=!0,Te.needRemapping=!0,Te.needRegenerateVertices=!0,de&&de.featureRange&&(Te.featureRange=de.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(F){return this.attributes.find(function(U){return U.name===F})}},{key:"getLayerAttributeScale",value:function(F){var U,de=this.getLayerStyleAttribute(F),Te=null==de||null===(U=de.scale)||void 0===U?void 0:U.scalers;return Te&&Te[0]?Te[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(F,U){var de=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,Te=arguments.length>3?arguments[3]:void 0,mt=this.attributes.find(function(Wa){return Wa.name===F});if(mt&&mt.descriptor){var Nt=mt.descriptor,Lt=Nt.update,lr=Nt.buffer,jr=Nt.size,Ln=void 0===jr?0:jr,Xn=wc[lr.type||Bi.gl.FLOAT];if(Lt){var ni=this.featureLayout,Ci=ni.elements,Si=ni.sizePerElement,ea=Ci.slice(de,Te);if(!ea.length)return;var xa=ea[0].offset,ua=xa*Ln*Xn,Ha=ea.map(function(Wa,Ka){for(var ia=Wa.featureIdx,ga=Wa.vertices,la=Wa.normals,no=ga.length/Si,ki=[],Ca=0;Ca<no;Ca++){var ba=la?la.slice(3*Ca,3*Ca+3):[];ki.push.apply(ki,(0,Wo.Z)(Lt(U[ia],ia,ga.slice(Ca*Si,Ca*Si+Si),Ka,ba)))}return ki}).reduce(function(Wa,Ka){return Wa.push.apply(Wa,(0,Wo.Z)(Ka)),Wa},[]);mt.vertexAttribute.updateBuffer({data:Ha,offset:ua})}}}},{key:"createAttributesAndIndices",value:function(F,U,de){var Te=this;this.featureLayout={sizePerElement:0,elements:[]},U&&(this.triangulation=U);var mt=this.attributes.map(function(ua){return ua.resetDescriptor(),ua.descriptor}),Nt=0,lr=[];F.forEach(function(ua,Ha){var Wa=Te.triangulation(ua,de),ia=Wa.vertices,ga=Wa.normals,la=Wa.size;Wa.indices.forEach(function(ba){lr.push(ba+Nt)});var no=ia.length/la;Te.featureLayout.sizePerElement=la,Te.featureLayout.elements.push({featureIdx:Ha,vertices:ia,normals:ga,offset:Nt}),Nt+=no;for(var ki=function(go){var Yl=(null==ga?void 0:ga.slice(3*go,3*go+3))||[],uu=ia.slice(go*la,go*la+la);mt.forEach(function(Ko,Su){var Hu;Ko&&Ko.update&&(Hu=Ko.buffer.data).push.apply(Hu,(0,Wo.Z)(Ko.update(ua,Ha,uu,go,Yl)))})},Ca=0;Ca<no;Ca++)ki(Ca)});var Xn=this.rendererService,ni=Xn.createAttribute,Ci=Xn.createBuffer,Si=Xn.createElements,ea={};mt.forEach(function(ua,Ha){if(ua){var Wa=ua.buffer,ga=(0,fl.Z)(ua,["buffer","update","name"]),la=ni(Ll({buffer:Ci(Wa)},ga));ea[ua.name||""]=la,Te.attributes[Ha].vertexAttribute=la}});var xa=Si({data:lr,type:Bi.gl.UNSIGNED_INT,count:lr.length});return this.attributesAndIndices={attributes:ea,elements:xa},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var F;this.attributes.forEach(function(U){U.vertexAttribute&&U.vertexAttribute.destroy()}),null===(F=this.attributesAndIndices)||void 0===F||F.elements.destroy(),this.attributes=[]}}]),te}(),ko=(0,Ae.Z)(Oa.prototype,"rendererService",[Qs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gs=Oa))||gs),hl=y(97185),eu=y(18660),Dl=y.n(eu);var Ac,Nu=(g=(0,m.b2)(),T=(0,m.f3)(R.v.SceneID),K=(0,m.f3)(R.v.IIconService),D=(0,m.f3)(R.v.IFontService),ge=(0,m.f3)(R.v.IControlService),Fe=(0,m.f3)(R.v.IGlobalConfigService),yt=(0,m.f3)(R.v.IMapService),Zt=(0,m.f3)(R.v.ICoordinateSystemService),Ft=(0,m.f3)(R.v.IRendererService),Or=(0,m.f3)(R.v.ILayerService),zr=(0,m.f3)(R.v.ICameraService),Jn=(0,m.f3)(R.v.IInteractionService),bi=(0,m.f3)(R.v.IPickingService),pi=(0,m.f3)(R.v.IShaderModuleService),oa=(0,m.f3)(R.v.IMarkerService),Ea=(0,m.f3)(R.v.IPopupService),g((vi=function(te){(0,qt.Z)(F,te);var U,ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){var U;return(0,N.Z)(this,F),U=ie.call(this),(0,j.Z)((0,Re.Z)(U),"destroyed",!1),(0,j.Z)((0,Re.Z)(U),"loaded",!1),(0,j.Z)((0,Re.Z)(U),"loadFont",!1),(0,j.Z)((0,Re.Z)(U),"fontFamily",""),(0,pe.Z)((0,Re.Z)(U),"id",Xo,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"iconService",vu,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"fontService",Tu,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"controlService",Ec,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"configService",Du,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"map",Nl,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"coordinateSystemService",mu,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"rendererService",gu,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"layerService",tu,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"cameraService",oo,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"interactionService",Tc,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"pickingService",Cc,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"shaderModuleService",rs,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"markerService",tc,(0,Re.Z)(U)),(0,pe.Z)((0,Re.Z)(U),"popupService",ru,(0,Re.Z)(U)),(0,j.Z)((0,Re.Z)(U),"inited",!1),(0,j.Z)((0,Re.Z)(U),"initPromise",void 0),(0,j.Z)((0,Re.Z)(U),"rendering",!1),(0,j.Z)((0,Re.Z)(U),"$container",void 0),(0,j.Z)((0,Re.Z)(U),"canvas",void 0),(0,j.Z)((0,Re.Z)(U),"markerContainer",void 0),(0,j.Z)((0,Re.Z)(U),"hooks",void 0),(0,j.Z)((0,Re.Z)(U),"handleWindowResized",function(){U.emit("resize"),U.$container&&(U.initContainer(),be.SO.triggerResize(),U.coordinateSystemService.needRefresh=!0,U.render())}),(0,j.Z)((0,Re.Z)(U),"handleMapCameraChanged",function(de){U.cameraService.update(de),U.render("mapRender")}),U.hooks={init:new hl.zj},U}return(0,H.Z)(F,[{key:"init",value:function(de){var Te=this;this.configService.setSceneConfig(this.id,de),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,Ho.Z)(Wi().mark(function mt(){return Wi().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:return Lt.next=2,new Promise(function(lr){Te.map.onCameraChanged(function(jr){Te.cameraService.init(),Te.cameraService.update(jr),"GAODE2.x"!==Te.map.version&&lr()}),"GAODE2.x"!==Te.map.version?Te.map.init():lr()});case 2:if("GAODE2.x"!==Te.map.version||!Te.map.initViewPort){Lt.next=6;break}return Lt.next=5,Te.map.init();case 5:Te.map.initViewPort();case 6:Te.map.onCameraChanged(Te.handleMapCameraChanged),Te.map.addMarkerContainer(),Te.markerService.addMarkers(),Te.markerService.addMarkerLayers(),Te.popupService.initPopup(),Te.interactionService.init(),Te.interactionService.on(oi.s.Drag,Te.addSceneEvent.bind(Te));case 13:case"end":return Lt.stop()}},mt)}))),this.hooks.init.tapPromise("initRenderer",(0,Ho.Z)(Wi().mark(function mt(){var Nt;return Wi().wrap(function(lr){for(;;)switch(lr.prev=lr.next){case 0:if(Nt=Da(Te.configService.getSceneConfig(Te.id).id||""),Te.$container=Nt,!Nt){lr.next=11;break}return Te.canvas=be.SO.create("canvas","",Nt),Te.setCanvas(),lr.next=7,Te.rendererService.init(Te.canvas,Te.configService.getSceneConfig(Te.id));case 7:Dl()(Te.$container,Te.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(Te.handleWindowResized),lr.next=12;break;case 11:console.error("\u5bb9\u5668 id \u4e0d\u5b58\u5728");case 12:Te.pickingService.init(Te.id);case 13:case"end":return lr.stop()}},mt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(de){this.layerService.add(de),this.render()}},{key:"render",value:(U=(0,Ho.Z)(Wi().mark(function Te(mt){return Wi().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:if(!this.rendering&&!this.destroyed){Lt.next=2;break}return Lt.abrupt("return");case 2:if(this.rendering=!0,this.inited){Lt.next=15;break}return Lt.next=6,this.initPromise;case 6:if(this.destroyed&&this.destroy(),!this.loadFont||!document.fonts){Lt.next=10;break}return Lt.next=10,document.fonts.load("24px ".concat(this.fontFamily),"L7text");case 10:this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 15:this.layerService.renderLayers(mt),this.rendering=!1;case 17:case"end":return Lt.stop()}},Te,this)})),function(Te){return U.apply(this,arguments)})},{key:"addFontFace",value:function(de,Te){this.fontFamily=de;var mt=document.createElement("style");mt.type="text/css",mt.innerText="\n        @font-face{\n            font-family: '".concat(de,"';\n            src: url('").concat(Te,"') format('woff2'),\n            url('").concat(Te,"') format('woff'),\n            url('").concat(Te,"') format('truetype');\n        }"),document.getElementsByTagName("head")[0].appendChild(mt),this.loadFont=!0}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(de){var Te,mt=null===(Te=this.$container)||void 0===Te?void 0:Te.getElementsByTagName("canvas")[0];return this.render(),"jpg"===de?null==mt?void 0:mt.toDataURL("image/jpeg"):null==mt?void 0:mt.toDataURL("image/png")}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var de=this.$container.parentElement;null!==de&&(this.markerContainer=be.SO.create("div","l7-marker-container",de))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var de,Te;this.inited?(this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),null===(de=this.$container)||void 0===de||null===(Te=de.parentNode)||void 0===Te||Te.removeChild(this.$container),this.removeAllListeners(),this.inited=!1,(0,eu.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)):this.destroyed=!0}},{key:"initContainer",value:function(){var de,Te,mt=be.SO.DPR,Nt=(null===(de=this.$container)||void 0===de?void 0:de.clientWidth)||400,Lt=(null===(Te=this.$container)||void 0===Te?void 0:Te.clientHeight)||300,lr=this.canvas;lr&&(lr.width=Nt*mt,lr.height=Lt*mt,lr.style.width="".concat(Nt,"px"),lr.style.height="".concat(Lt,"px")),this.rendererService.viewport({x:0,y:0,width:mt*Nt,height:mt*Lt})}},{key:"setCanvas",value:function(){var de,Te,mt=be.SO.DPR,Nt=(null===(de=this.$container)||void 0===de?void 0:de.clientWidth)||400,Lt=(null===(Te=this.$container)||void 0===Te?void 0:Te.clientHeight)||300,lr=this.canvas;lr.width=Nt*mt,lr.height=Lt*mt,lr.style.width="".concat(Nt,"px"),lr.style.height="".concat(Lt,"px")}},{key:"addSceneEvent",value:function(de){this.emit(de.type,de)}}]),F}(_.EventEmitter),Xo=(0,Ae.Z)(vi.prototype,"id",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vu=(0,Ae.Z)(vi.prototype,"iconService",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=(0,Ae.Z)(vi.prototype,"fontService",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ec=(0,Ae.Z)(vi.prototype,"controlService",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Du=(0,Ae.Z)(vi.prototype,"configService",[Fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nl=(0,Ae.Z)(vi.prototype,"map",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=(0,Ae.Z)(vi.prototype,"coordinateSystemService",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=(0,Ae.Z)(vi.prototype,"rendererService",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tu=(0,Ae.Z)(vi.prototype,"layerService",[Or],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oo=(0,Ae.Z)(vi.prototype,"cameraService",[zr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tc=(0,Ae.Z)(vi.prototype,"interactionService",[Jn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc=(0,Ae.Z)(vi.prototype,"pickingService",[bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rs=(0,Ae.Z)(vi.prototype,"shaderModuleService",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tc=(0,Ae.Z)(vi.prototype,"markerService",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ru=(0,Ae.Z)(vi.prototype,"popupService",[Ea],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fa=vi))||Fa),La=y(72699),Ju=y.n(La),Us=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function nc(te){var ie={};return{content:te=te.replace(Us,function(F,U,de){var Te=de.split(":"),mt=Te[0].trim(),Nt="";switch(Te.length>1&&(Nt=Te[1].trim()),U){case"bool":Nt="true"===Nt;break;case"float":case"int":Nt=Number(Nt);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":Nt=Nt?Nt.replace("[","").replace("]","").split(",").reduce(function(Lt,lr){return Lt.push(Number(lr.trim())),Lt},[]):new Array(function(te){var ie=0;switch(te){case"vec2":case"ivec2":ie=2;break;case"vec3":case"ivec3":ie=3;break;case"vec4":case"ivec4":case"mat2":ie=4;break;case"mat3":ie=9;break;case"mat4":ie=16}return ie}(U)).fill(0)}return ie[mt]=Nt,"uniform ".concat(U," ").concat(mt,";\n")}),uniforms:ie}}function Bl(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function yu(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?Bl(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):Bl(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var $u="#define PI 3.14159265359",ic=/precision\s+(high|low|medium)p\s+float/,uf=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Cu=(0,m.b2)()(Ac=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"moduleCache",{}),(0,j.Z)(this,"rawContentCache",{})}return(0,H.Z)(te,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:$u,fs:$u}),this.registerModule("decode",{vs:"#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",fs:""}),this.registerModule("projection",{vs:"#define TILE_SIZE 512.0\n#define PI 3.1415926536\n#define WORLD_SCALE TILE_SIZE / (PI * 2.0)\n\n#define COORDINATE_SYSTEM_LNGLAT 1.0\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\n#define COORDINATE_SYSTEM_P20_2 8.0\n\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrix;\nuniform float u_Zoom : 1;\nuniform float u_ZoomScale : 1;\n\nuniform float u_CoordinateSystem;\nuniform vec2 u_ViewportCenter;\nuniform vec4 u_ViewportCenterProjection;\nuniform vec3 u_PixelsPerDegree;\nuniform vec3 u_PixelsPerDegree2;\nuniform vec3 u_PixelsPerMeter;\n\nuniform vec2 u_ViewportSize;\nuniform float u_DevicePixelRatio;\nuniform float u_FocalDistance;\nuniform vec3 u_CameraPosition;\n\n// uniform mat4 u_Mvp;\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1., 1.);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01\n    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01\n// reverse Y\nvec3 reverse_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {\n    return vector * vec3(1.0, -1.0, 1.0);\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0\n    return vector;\n  }\n  return vector;\n}\n\nvec4 project_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(vec4(X, Y, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return vec4(\n      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // return vec4(\n    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), \n    //   project_scale(position.z), \n    //   position.w);\n\n     return vec4(\n      position.xy, \n      project_scale(position.z), \n      position.w);\n  }\n  return position;\n\n  // TODO: \u74e6\u7247\u5750\u6807\u7cfb & \u5e38\u89c4\u4e16\u754c\u5750\u6807\u7cfb\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\nfloat project_pixel_allmap(float pixel) {\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    return pixel * pow(2.0, u_Zoom);\n  }\n  return pixel;\n}\n\nfloat project_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));\n  }\n  return pixel;\n}\nvec2 project_pixel(vec2 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));\n  }\n  return pixel * -1.;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n     pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\n\nbool isEqual( float a,  float b) {\n    return  a< b + 0.001 && a > b - 0.001;\n}",fs:""}),this.registerModule("project",{vs:"\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n\n// gaode2.0\nvec2 customProject(vec2 lnglat) { // \u7ecf\u7eac\u5ea6 => \u5e73\u9762\u5750\u6807\n  float t = lnglat.x;\n  float e = lnglat.y;\n  float Sm = 180.0 / PI;\n  float Tm = 6378137.0;\n  float Rm = PI / 180.0;\n  float r = 85.0511287798;\n  e = max(min(r, e), -r);\n  t *= Rm;\n  e *= Rm;\n  e = log(tan(PI / 4.0 + e / 2.0));\n  return vec2(t * Tm, e * Tm);\n}\n\nvec2 unProjCustomCoord(vec2 point) { // \u5e73\u9762\u5750\u6807 => \u7ecf\u7eac\u5ea6\n  float Sm = 57.29577951308232; //180 / Math.PI\n  float Tm = 6378137.0;\n  float t = point.x;\n  float e = point.y;\n  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);\n}\n\n\nfloat customPixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}",fs:""}),this.registerModule("sdf_2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n"}),this.registerModule("lighting",{vs:"// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {\n//   vec3 lightDir = normalize(light.position - fragPos);\n//   // diffuse shading\n//   float diff = max(dot(normal, lightDir), 0.0);\n//   // specular shading\n//   vec3 reflectDir = reflect(-lightDir, normal);\n//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);\n//   // attenuation\n//   float distance = length(light.position - fragPos);\n//   float attenuation = 1.0 / (light.constant + light.linear * distance +\n//           light.quadratic * (distance * distance));\n\n//   vec3 ambient = light.ambient * u_Ambient;\n//   vec3 diffuse = light.diffuse * diff * u_Diffuse;\n//   vec3 specular = light.specular * spec * u_Specular;\n\n//   float spotEffect = dot(normalize(light.direction), -lightDir);\n//   float spotCosCutoff = cos(light.angle / 180.0 * PI);\n//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);\n//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);\n//   if (spotEffect > spotCosCutoff) {\n//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);\n//   } else {\n//     spotEffect = 0.0;\n//   }\n\n//   return ambient + attenuation * (spotEffect * diffuse + specular);\n// }\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {\n  //   if (i >= u_NumOfSpotLights) {\n  //     break;\n  //   }\n  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);\n  // }\n  return weight;\n}\n",fs:""}),this.registerModule("light",{vs:"#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",fs:""}),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n\nfloat setPickingOrder(float z) {\n   bool selected = bool(v_PickingResult.a);\n   return selected ? z + 1. : 0.;\n}\n",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n"}),this.registerModule("styleMapping",{vs:"attribute float a_vertexId;\n\nuniform mat4 u_cellTypeLayout;      // \u63cf\u8ff0\u6570\u636e\u7eb9\u7406 cell \u7ed3\u6784\u7684\u77e9\u9635\nuniform sampler2D u_dataTexture;    // \u6570\u636e\u7eb9\u7406\n\nbool hasOpacity() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 opacity \u7684\u6570\u636e\n  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeOpacity() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 strokeOpacity \u7684\u6570\u636e\n  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeWidth() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 strokeWidth \u7684\u6570\u636e\n  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStroke() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 stroke \u7684\u6570\u636e\n  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasOffsets() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 offsets \u7684\u6570\u636e\n  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\n// \u6839\u636e\u5750\u6807\u4f4d\u7f6e\u5148\u662f\u8ba1\u7b97 uv \uff0c\u7136\u540e\u6839\u636e uv \u4ece\u6570\u636e\u7eb9\u7406\u4e2d\u53d6\u503c\nfloat pos2value(vec2 pos, float columnWidth, float rowHeight) {\n  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;\n  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);\n  return texture2D(u_dataTexture, vec2(u, v)).r;\n}\n\n/*\n  currentRow \u5f53\u524d\u884c\n  currentColumn \u5f53\u524d\u5217\n  columnCount \u6709\u591a\u5c11\u5217\n  nextStep \u9700\u8981\u8ba1\u7b97\u5f53\u524d cell \u540e\u7684\u7b2c\u51e0\u4e2a cell \uff08\u5f53\u524d cell \u5219 nextStep = 0\uff09\n*/\nvec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {\n  float nextColumn = currentColumn;\n  float nextRow = currentRow;\n  if(currentColumn + nextStep <= columnCount){\n    nextColumn = currentColumn + nextStep;\n  } else {\n    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4e0d\u4f1a\u51fa\u73b0\u8de8\u4e24\u884c\n    nextRow = currentRow + 1.0;\n  }\n  return vec2(nextColumn, nextRow);\n}\n\n// \u8ba1\u7b97\u5f53\u524d\u5355\u4e2a cell \u7684\u5927\u5c0f\nfloat calCellCount() { \n  //   u_cellTypeLayout\n  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51e0\u884c\u51e0\u5217\n  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793a\u6709\u6570\u636e\u6620\u5c04\u30010.0 \u8868\u793a\u6ca1\u6709\n  //   1.0, 0.0, 0.0, 0.0, // offsets\n  //   0.0, 0.0, 0.0, 0.0\n  \n  return  u_cellTypeLayout[1][0] +        // opacity\n          u_cellTypeLayout[1][1] +        // strokeOpacity\n          u_cellTypeLayout[1][2] +        // strokeWidth\n          u_cellTypeLayout[1][3] * 4.0 +  // stroke\n          u_cellTypeLayout[2][0] * 2.0;   // offsets\n}",fs:""}),this.registerModule("styleMappingCalOpacity",{vs:"\n// \u8ba1\u7b97 opacity \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasOpacity()) { // \u6570\u636e\u7eb9\u7406\u4e2d\u4e0d\u5b58\u5728 opacity \u7684\u65f6\u5019\u53d6\u9ed8\u8ba4\u503c\uff08\u7528\u6237\u5728 style \u4e2d\u4f20\u5165\u7684\u662f\u5e38\u91cf\uff09\n    return vec2(u_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:"\n// \u8ba1\u7b97 strokeOpaicty \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeOpacity()) {\n    return vec2(u_stroke_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:"\n// \u8ba1\u7b97 strokeWidth \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeWidth()) {\n    return vec2(u_stroke_width, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeWidth, textureOffset + 1.0);\n  }\n}\n",fs:""})}},{key:"registerModule",value:function(F,U){if(!this.rawContentCache[F]){var Te=U.fs,mt=U.uniforms,Nt=nc(U.vs),Lt=Nt.content,lr=Nt.uniforms,jr=nc(Te),Xn=jr.uniforms;this.rawContentCache[F]={fs:jr.content,uniforms:yu(yu(yu({},lr),Xn),mt),vs:Lt}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(F){var U=this;if(this.moduleCache[F])return this.moduleCache[F];var Te=this.rawContentCache[F].fs,mt=this.processModule(this.rawContentCache[F].vs,[],"vs"),Nt=mt.content,Lt=mt.includeList,lr=this.processModule(Te,[],"fs"),jr=lr.content,Ln=lr.includeList,Xn=jr,ni=Ju()(Lt.concat(Ln).concat(F)).reduce(function(Ci,Si){return yu(yu({},Ci),U.rawContentCache[Si].uniforms)},{});return ic.test(jr)||(Xn="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+jr),this.moduleCache[F]={fs:Xn.trim(),uniforms:ni,vs:Nt.trim()},this.moduleCache[F]}},{key:"processModule",value:function(F,U,de){var Te=this;return{content:F.replace(uf,function(Nt,Lt){var jr=Lt.split(" ")[0].replace(/"/g,"");if(U.indexOf(jr)>-1)return"";var Ln=Te.rawContentCache[jr][de];return U.push(jr),Te.processModule(Ln,U,de).content}),includeList:U}}}]),te}())||Ac;function nu(te,ie,F){return(nu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(de,Te,mt){var Nt=function(te,ie){for(;!Object.prototype.hasOwnProperty.call(te,ie)&&null!==(te=(0,er.Z)(te)););return te}(de,Te);if(Nt){var Lt=Object.getOwnPropertyDescriptor(Nt,Te);return Lt.get?Lt.get.call(mt):Lt.value}})(te,ie,F||te)}var js,zl,ac,oc,Zu,$a,Au=y(55576),ns=(js=(0,m.b2)(),zl=(0,m.f3)(R.v.IShaderModuleService),js((oc=function(){function te(){(0,N.Z)(this,te),(0,pe.Z)(this,"shaderModuleService",Zu,this),(0,j.Z)(this,"rendererService",void 0),(0,j.Z)(this,"cameraService",void 0),(0,j.Z)(this,"mapService",void 0),(0,j.Z)(this,"interactionService",void 0),(0,j.Z)(this,"layerService",void 0),(0,j.Z)(this,"config",void 0)}return(0,H.Z)(te,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Au.G.Normal}},{key:"init",value:function(F,U){this.config=U,this.rendererService=F.getContainer().get(R.v.IRendererService),this.cameraService=F.getContainer().get(R.v.ICameraService),this.mapService=F.getContainer().get(R.v.IMapService),this.interactionService=F.getContainer().get(R.v.IInteractionService),this.layerService=F.getContainer().get(R.v.ILayerService)}},{key:"render",value:function(F){}}]),te}(),Zu=(0,Ae.Z)(oc.prototype,"shaderModuleService",[zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ac=oc))||ac);var sa,ja,ws,Ul,Uu,Pu=(0,m.b2)()($a=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(de,Te){nu((0,er.Z)(F.prototype),"init",this).call(this,de,Te)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),F}(ns))||$a;function Mc(te,ie){var F="undefined"!=typeof Symbol&&te[Symbol.iterator]||te["@@iterator"];if(!F){if(Array.isArray(te)||(F=function(te,ie){if(te){if("string"==typeof te)return lf(te,undefined);var F=Object.prototype.toString.call(te).slice(8,-1);if("Object"===F&&te.constructor&&(F=te.constructor.name),"Map"===F||"Set"===F)return Array.from(te);if("Arguments"===F||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F))return lf(te,undefined)}}(te))||ie&&te&&"number"==typeof te.length){F&&(te=F);var U=0,de=function(){};return{s:de,n:function(){return U>=te.length?{done:!0}:{done:!1,value:te[U++]}},e:function(lr){throw lr},f:de}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Nt,Te=!0,mt=!1;return{s:function(){F=F.call(te)},n:function(){var lr=F.next();return Te=lr.done,lr},e:function(lr){mt=!0,Nt=lr},f:function(){try{!Te&&null!=F.return&&F.return()}finally{if(mt)throw Nt}}}}function lf(te,ie){(null==ie||ie>te.length)&&(ie=te.length);for(var F=0,U=new Array(ie);F<ie;F++)U[F]=te[F];return U}var _u,Vl=(sa=(0,m.b2)(),ja=(0,m.f3)(R.v.IPostProcessor),sa((Ul=function(){function te(){(0,N.Z)(this,te),(0,j.Z)(this,"passes",[]),(0,pe.Z)(this,"postProcessor",Uu,this),(0,j.Z)(this,"layer",void 0),(0,j.Z)(this,"renderFlag",void 0),(0,j.Z)(this,"width",0),(0,j.Z)(this,"height",0)}return(0,H.Z)(te,[{key:"setLayer",value:function(F){this.layer=F}},{key:"setRenderFlag",value:function(F){this.renderFlag=F}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:(ie=(0,Ho.Z)(Wi().mark(function U(){var de,Te,mt;return Wi().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:de=Mc(this.passes),Lt.prev=1,de.s();case 3:if((Te=de.n()).done){Lt.next=9;break}return mt=Te.value,Lt.next=7,mt.render(this.layer);case 7:Lt.next=3;break;case 9:Lt.next=14;break;case 11:Lt.prev=11,Lt.t0=Lt.catch(1),de.e(Lt.t0);case 14:return Lt.prev=14,de.f(),Lt.finish(14);case 17:this.layer.renderModels();case 18:case"end":return Lt.stop()}},U,this,[[1,11,14,17]])})),function(){return ie.apply(this,arguments)})},{key:"resize",value:function(F,U){(this.width!==F||this.height!==U)&&(this.width=F,this.height=U)}},{key:"add",value:function(F,U){F.getType()===Au.G.PostProcessing?this.postProcessor.add(F,this.layer,U):(F.init(this.layer,U),this.passes.push(F))}},{key:"insert",value:function(F,U,de){F.init(this.layer,U),this.passes.splice(de,0,F)}},{key:"destroy",value:function(){this.passes.length=0}}]),te;var ie}(),Uu=(0,Ae.Z)(Ul.prototype,"postProcessor",[ja],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ws=Ul))||ws);function So(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function gl(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?So(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):So(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var _l,Fn=(0,m.b2)()(_u=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){var U;(0,N.Z)(this,F);for(var de=arguments.length,Te=new Array(de),mt=0;mt<de;mt++)Te[mt]=arguments[mt];return U=ie.call.apply(ie,[this].concat(Te)),(0,j.Z)((0,Re.Z)(U),"pickingFBO",void 0),(0,j.Z)((0,Re.Z)(U),"layer",void 0),(0,j.Z)((0,Re.Z)(U),"width",0),(0,j.Z)((0,Re.Z)(U),"height",0),(0,j.Z)((0,Re.Z)(U),"alreadyInRendering",!1),(0,j.Z)((0,Re.Z)(U),"pickFromPickingFBO",function(Nt){var Lt=Nt.x,lr=Nt.y,jr=Nt.lngLat,Ln=Nt.type;if(U.layer.isVisible()&&U.layer.needPick(Ln)){var la,Xn=U.rendererService,Ci=Xn.readPixels,Si=Xn.useFramebuffer,ea=(0,Xn.getViewportSize)(),xa=ea.width,ua=ea.height,Ha=U.layer.getLayerConfig(),Wa=Ha.enableHighlight,Ka=Ha.enableSelect,ia=Lt*be.SO.DPR,ga=lr*be.SO.DPR;ia>xa||ia<0||ga>ua||ga<0||Si(U.pickingFBO,function(){var no;if(0!==(la=Ci({x:Math.round(ia),y:Math.round(ua-(lr+1)*be.SO.DPR),width:1,height:1,data:new Uint8Array(4),framebuffer:U.pickingFBO}))[0]||0!==la[1]||0!==la[2]){var ki=(0,be.W0)(la),Ca=U.layer.getSource().getFeatureById(ki),ba={x:Lt,y:lr,type:Ln,lngLat:jr,featureId:ki,feature:Ca};Ca&&(U.layer.setCurrentPickId(ki),U.triggerHoverOnLayer(ba))}else{var go={x:Lt,y:lr,lngLat:jr,type:null===U.layer.getCurrentPickId()?"un"+Ln:"mouseout",featureId:null,feature:null};U.triggerHoverOnLayer(gl(gl({},go),{},{type:"unpick"})),U.triggerHoverOnLayer(go),U.layer.setCurrentPickId(null)}Wa&&U.highlightPickedFeature(la),Ka&&"click"===Ln&&(null===(no=la)||void 0===no?void 0:no.toString())!==[0,0,0,0].toString()&&U.selectFeature(la)})}}),U}return(0,H.Z)(F,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(de,Te){nu((0,er.Z)(F.prototype),"init",this).call(this,de,Te),this.layer=de;var mt=this.rendererService,Nt=mt.createTexture2D,Lt=mt.createFramebuffer,jr=(0,mt.getViewportSize)();this.pickingFBO=Lt({color:Nt({width:jr.width,height:jr.height,wrapS:Bi.gl.CLAMP_TO_EDGE,wrapT:Bi.gl.CLAMP_TO_EDGE})}),this.interactionService.on(oi.s.Hover,this.pickFromPickingFBO),this.interactionService.on(oi.s.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(oi.s.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(de){var Te=this;if(!this.alreadyInRendering){var mt=this.rendererService,Lt=mt.useFramebuffer,lr=mt.clear,jr=(0,mt.getViewportSize)(),Ln=jr.width,Xn=jr.height;this.alreadyInRendering=!0,(this.width!==Ln||this.height!==Xn)&&(this.pickingFBO.resize({width:Ln,height:Xn}),this.width=Ln,this.height=Xn),Lt(this.pickingFBO,function(){lr({framebuffer:Te.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var ni=Te.layer.multiPassRenderer.getRenderFlag();Te.layer.multiPassRenderer.setRenderFlag(!1),de.hooks.beforePickingEncode.call(),de.render(),de.hooks.afterPickingEncode.call(),Te.layer.multiPassRenderer.setRenderFlag(ni),Te.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(de){this.layer.emit(de.type,de)}},{key:"highlightPickedFeature",value:function(de){var Te=(0,Dt.Z)(de,3);this.layer.hooks.beforeHighlight.call([Te[0],Te[1],Te[2]]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(de){var Te=(0,Dt.Z)(de,3);this.layer.hooks.beforeSelect.call([Te[0],Te[1],Te[2]]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(de){var mt=(0,be.Z6)(de.featureId);this.selectFeature(new Uint8Array(mt))}},{key:"highlightFeatureHandle",value:function(de){var mt=(0,be.Z6)(de.featureId);this.highlightPickedFeature(new Uint8Array(mt))}}]),F}(ns))||_u,za=y(20051);function iu(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function Es(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?iu(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):iu(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var Ts,xl=(0,m.b2)()(_l=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var de=this.shaderModuleService.getModule("blur-pass"),Te=de.vs,mt=de.fs,Nt=de.uniforms,Lt=this.rendererService.getViewportSize(),lr=Lt.width,jr=Lt.height;return{vs:Te,fs:mt,uniforms:Es(Es({},Nt),{},{u_ViewportSize:[lr,jr]})}}},{key:"convertOptionsToUniforms",value:function(de){var Te={};return Lo()(de.blurRadius)||(Te.u_BlurDir=[de.blurRadius,0]),Te}}]),F}(za.Z))||_l;function sc(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function au(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?sc(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):sc(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var Ws,cf=(0,m.b2)()(Ts=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var de=this.shaderModuleService.getModule("blur-pass"),Te=de.vs,mt=de.fs,Nt=de.uniforms,Lt=this.rendererService.getViewportSize(),lr=Lt.width,jr=Lt.height;return{vs:Te,fs:mt,uniforms:au(au({},Nt),{},{u_ViewportSize:[lr,jr]})}}},{key:"convertOptionsToUniforms",value:function(de){var Te={};return Lo()(de.blurRadius)||(Te.u_BlurDir=[0,de.blurRadius]),Te}}]),F}(za.Z))||Ts;function Cs(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function $i(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?Cs(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):Cs(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var mo,bu=(0,m.b2)()(Ws=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:'varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}'});var de=this.shaderModuleService.getModule("colorhalftone-pass"),Te=de.vs,mt=de.fs,Nt=de.uniforms,Lt=this.rendererService.getViewportSize(),lr=Lt.width,jr=Lt.height;return{vs:Te,fs:mt,uniforms:$i($i({},Nt),{},{u_ViewportSize:[lr,jr]})}}}]),F}(za.Z))||Ws;var Po,wo=(0,m.b2)()(mo=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}"}),this.shaderModuleService.getModule("copy-pass")}}]),F}(za.Z))||mo;function fo(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function jl(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?fo(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):fo(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var ys,As=(0,m.b2)()(Po=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var de=this.shaderModuleService.getModule("hexagonalpixelate-pass"),Te=de.vs,mt=de.fs,Nt=de.uniforms,Lt=this.rendererService.getViewportSize(),lr=Lt.width,jr=Lt.height;return{vs:Te,fs:mt,uniforms:jl(jl({},Nt),{},{u_ViewportSize:[lr,jr]})}}}]),F}(za.Z))||Po;function is(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function al(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?is(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):is(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var ol,Kc=(0,m.b2)()(ys=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var de=this.shaderModuleService.getModule("ink-pass"),Te=de.vs,mt=de.fs,Nt=de.uniforms,Lt=this.rendererService.getViewportSize(),lr=Lt.width,jr=Lt.height;return{vs:Te,fs:mt,uniforms:al(al({},Nt),{},{u_ViewportSize:[lr,jr]})}}}]),F}(za.Z))||ys;var Rc,Gu=(0,m.b2)()(ol=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}"}),this.shaderModuleService.getModule("noise-pass")}}]),F}(za.Z))||ol;var o,p,b,E,A,B,Ce,s=(0,m.b2)()(Rc=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}"}),this.shaderModuleService.getModule("sepia-pass")}}]),F}(za.Z))||Rc,$=(o=(0,m.b2)(),p=(0,m.f3)(R.v.IRendererService),b=(0,m.zY)(),o((A=function(){function te(){(0,N.Z)(this,te),(0,pe.Z)(this,"rendererService",B,this),(0,j.Z)(this,"passes",[]),(0,j.Z)(this,"readFBO",void 0),(0,j.Z)(this,"writeFBO",void 0)}return(0,H.Z)(te,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:(ie=(0,Ho.Z)(Wi().mark(function U(de){var Te,mt;return Wi().wrap(function(Lt){for(;;)switch(Lt.prev=Lt.next){case 0:Te=0;case 1:if(!(Te<this.passes.length)){Lt.next=10;break}return(mt=this.passes[Te]).setRenderToScreen(this.isLastEnabledPass(Te)),Lt.next=6,mt.render(de);case 6:Te!==this.passes.length-1&&this.swap();case 7:Te++,Lt.next=1;break;case 10:case"end":return Lt.stop()}},U,this)})),function(U){return ie.apply(this,arguments)})},{key:"resize",value:function(F,U){this.readFBO.resize({width:F,height:U}),this.writeFBO.resize({width:F,height:U})}},{key:"add",value:function(F,U,de){F.init(U,de),this.passes.push(F)}},{key:"insert",value:function(F,U,de,Te){F.init(de,Te),this.passes.splice(U,0,F)}},{key:"getPostProcessingPassByName",value:function(F){return this.passes.find(function(U){return U.getName()===F})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(F){for(var U=F+1;U<this.passes.length;U++)if(this.passes[U].isEnabled())return!1;return!0}},{key:"swap",value:function(){var F=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=F}}]),te;var ie}(),B=(0,Ae.Z)(A.prototype,"rendererService",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,Ae.Z)(A.prototype,"init",[b],Object.getOwnPropertyDescriptor(A.prototype,"init"),A.prototype),E=A))||E);var $e,pt,Ke,ft,It,et=(0,m.b2)()(Ce=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){return(0,N.Z)(this,F),ie.apply(this,arguments)}return(0,H.Z)(F,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(de,Te){nu((0,er.Z)(F.prototype),"init",this).call(this,de,Te)}},{key:"render",value:function(de){var Te=this.rendererService,Nt=Te.clear;(0,Te.useFramebuffer)(null,function(){Nt({color:[0,0,0,0],depth:1,stencil:0}),de.multiPassRenderer.setRenderFlag(!1),de.render(),de.multiPassRenderer.setRenderFlag(!0)})}}]),F}(ns))||Ce;function Wt(te,ie){var F=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ie&&(U=U.filter(function(de){return Object.getOwnPropertyDescriptor(te,de).enumerable})),F.push.apply(F,U)}return F}function pr(te){for(var ie=1;ie<arguments.length;ie++){var F=null!=arguments[ie]?arguments[ie]:{};ie%2?Wt(Object(F),!0).forEach(function(U){(0,j.Z)(te,U,F[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(F)):Wt(Object(F)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(F,U))})}return te}var Qr="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}";function dn(te,ie){for(var F=0,U=1/ie,de=te;de>0;)F+=U*(de%ie),de=Math.floor(de/ie),U/=ie;return F}var qn=1,Vn=($e=(0,m.b2)(),pt=(0,m.f3)(R.v.IShaderModuleService),$e((ft=function(te){(0,qt.Z)(F,te);var ie=function(te){var ie=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var de,U=(0,er.Z)(te);if(ie){var Te=(0,er.Z)(this).constructor;de=Reflect.construct(U,arguments,Te)}else de=U.apply(this,arguments);return(0,Pr.Z)(this,de)}}(F);function F(){var U;(0,N.Z)(this,F);for(var de=arguments.length,Te=new Array(de),mt=0;mt<de;mt++)Te[mt]=arguments[mt];return U=ie.call.apply(ie,[this].concat(Te)),(0,pe.Z)((0,Re.Z)(U),"shaderModuleService",It,(0,Re.Z)(U)),(0,j.Z)((0,Re.Z)(U),"haltonSequence",[]),(0,j.Z)((0,Re.Z)(U),"accumulatingId",0),(0,j.Z)((0,Re.Z)(U),"frame",0),(0,j.Z)((0,Re.Z)(U),"timer",void 0),(0,j.Z)((0,Re.Z)(U),"sampleRenderTarget",void 0),(0,j.Z)((0,Re.Z)(U),"prevRenderTarget",void 0),(0,j.Z)((0,Re.Z)(U),"outputRenderTarget",void 0),(0,j.Z)((0,Re.Z)(U),"copyRenderTarget",void 0),(0,j.Z)((0,Re.Z)(U),"blendModel",void 0),(0,j.Z)((0,Re.Z)(U),"outputModel",void 0),(0,j.Z)((0,Re.Z)(U),"copyModel",void 0),U}return(0,H.Z)(F,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(de,Te){nu((0,er.Z)(F.prototype),"init",this).call(this,de,Te);var mt=this.rendererService,Nt=mt.createFramebuffer,Lt=mt.createTexture2D;this.sampleRenderTarget=Nt({color:Lt({width:1,height:1,wrapS:Bi.gl.CLAMP_TO_EDGE,wrapT:Bi.gl.CLAMP_TO_EDGE})}),this.prevRenderTarget=Nt({color:Lt({width:1,height:1,wrapS:Bi.gl.CLAMP_TO_EDGE,wrapT:Bi.gl.CLAMP_TO_EDGE})}),this.outputRenderTarget=Nt({color:Lt({width:1,height:1,wrapS:Bi.gl.CLAMP_TO_EDGE,wrapT:Bi.gl.CLAMP_TO_EDGE})}),this.copyRenderTarget=Nt({color:Lt({width:1,height:1,wrapS:Bi.gl.CLAMP_TO_EDGE,wrapT:Bi.gl.CLAMP_TO_EDGE})});for(var lr=0;lr<30;lr++)this.haltonSequence.push([dn(lr,2),dn(lr,3)]);this.blendModel=this.createTriangleModel("blend-pass","uniform float u_opacity : 1.0;\nuniform float u_MixRatio : 0.5;\n\nuniform sampler2D u_Diffuse1;\nuniform sampler2D u_Diffuse2;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  vec4 texel1 = texture2D(u_Diffuse1, v_UV);\n  vec4 texel2 = texture2D(u_Diffuse2, v_UV);\n  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);\n}\n"),this.outputModel=this.createTriangleModel("copy-pass",Qr,{blend:{enable:!0,func:{srcRGB:Bi.gl.ONE,dstRGB:Bi.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:Bi.gl.ONE,dstAlpha:Bi.gl.ONE_MINUS_SRC_ALPHA},equation:{rgb:Bi.gl.FUNC_ADD,alpha:Bi.gl.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Qr)}},{key:"render",value:function(de){var Te=this,mt=this.rendererService,Nt=mt.clear,lr=mt.useFramebuffer,jr=(0,mt.getViewportSize)(),Ln=jr.width,Xn=jr.height;this.sampleRenderTarget.resize({width:Ln,height:Xn}),this.prevRenderTarget.resize({width:Ln,height:Xn}),this.outputRenderTarget.resize({width:Ln,height:Xn}),this.copyRenderTarget.resize({width:Ln,height:Xn}),this.resetFrame(),this.stopAccumulating();var ni=de.multiPassRenderer.getPostProcessor().getReadFBO();lr(ni,function(){Nt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ni}),de.multiPassRenderer.setRenderFlag(!1),de.render(),de.multiPassRenderer.setRenderFlag(!0)});var Ci=function Si(ea){!Te.accumulatingId||ea!==Te.accumulatingId||Te.isFinished()||(Te.doRender(de),requestAnimationFrame(function(){Si(ea)}))};this.accumulatingId=qn++,this.timer=window.setTimeout(function(){Ci(Te.accumulatingId)},50)}},{key:"doRender",value:function(de){var Te=this,mt=this.rendererService,Nt=mt.clear,lr=mt.useFramebuffer,jr=(0,mt.getViewportSize)(),Ln=jr.width,Xn=jr.height,Ci=de.getLayerConfig().jitterScale,Si=void 0===Ci?1:Ci,ea=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((2*ea[0]-1)/Ln*Si,(2*ea[1]-1)/Xn*Si),de.multiPassRenderer.setRenderFlag(!1),de.hooks.beforeRender.call(),lr(this.sampleRenderTarget,function(){Nt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:Te.sampleRenderTarget}),de.render()}),de.hooks.afterRender.call(),de.multiPassRenderer.setRenderFlag(!0);var xa=de.getLayerConfig();lr(this.outputRenderTarget,function(){Te.blendModel.draw({uniforms:{u_opacity:xa.opacity||1,u_MixRatio:0===Te.frame?1:.9,u_Diffuse1:Te.sampleRenderTarget,u_Diffuse2:0===Te.frame?de.multiPassRenderer.getPostProcessor().getReadFBO():Te.prevRenderTarget}})}),0===this.frame&&Nt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(lr(this.copyRenderTarget,function(){Te.outputModel.draw({uniforms:{u_Texture:Te.outputRenderTarget}})}),lr(de.multiPassRenderer.getPostProcessor().getReadFBO(),function(){Te.copyModel.draw({uniforms:{u_Texture:Te.copyRenderTarget}})}),de.multiPassRenderer.getPostProcessor().render(de));var ua=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=ua,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(de,Te,mt){this.shaderModuleService.registerModule(de,{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:Te});var Nt=this.shaderModuleService.getModule(de),jr=Nt.uniforms,Ln=this.rendererService;return(0,Ln.createModel)(pr({vs:Nt.vs,fs:Nt.fs,attributes:{a_Position:(0,Ln.createAttribute)({buffer:(0,Ln.createBuffer)({data:[-4,-4,4,-4,0,4],type:Bi.gl.FLOAT}),size:2})},uniforms:pr({},jr),depth:{enable:!1},count:3},mt))}}]),F}(ns),It=(0,Ae.Z)(ft.prototype,"shaderModuleService",[pt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=ft))||Ke),Nn=new m.W2;Nn.bind(R.v.IGlobalConfigService).to(Oe).inSingletonScope(),Nn.bind(R.v.IShaderModuleService).to(Cu).inSingletonScope(),(0,m.GW)((0,m.b2)(),_.EventEmitter),Nn.bind(R.v.IEventEmitter).to(_.EventEmitter);var Li=(0,O.Z)(Nn,!1),Dn=function(ie){var F=Li.lazyInject(ie);return function(U,de,Te){F.call(this,U,de),Te&&(Te.initializer=function(){return U[de]})}};const Vi=Nn;var li=0;function yi(){var te=new m.W2;return te.parent=Nn,te.bind(R.v.SceneID).toConstantValue("".concat(li++)),te.bind(R.v.ILayerService).to(Eu).inSingletonScope(),te.bind(R.v.ISceneService).to(Nu).inSingletonScope(),te.bind(R.v.ICameraService).to(Mt).inSingletonScope(),te.bind(R.v.ICoordinateSystemService).to(_n).inSingletonScope(),te.bind(R.v.IInteractionService).to(to).inSingletonScope(),te.bind(R.v.IPickingService).to(Ve).inSingletonScope(),te.bind(R.v.IControlService).to(sr).inSingletonScope(),te.bind(R.v.IMarkerService).to(On).inSingletonScope(),te.bind(R.v.IIconService).to(xt).inSingletonScope(),te.bind(R.v.IFontService).to(at).inSingletonScope(),te.bind(R.v.IPopupService).to(si).inSingletonScope(),te.bind(R.v.INormalPass).to(Pu).whenTargetNamed("clear"),te.bind(R.v.INormalPass).to(Fn).whenTargetNamed("pixelPicking"),te.bind(R.v.INormalPass).to(et).whenTargetNamed("render"),te.bind(R.v.INormalPass).to(Vn).whenTargetNamed("taa"),te.bind(R.v.IFactoryNormalPass).toFactory(function(ie){return function(F){return ie.container.getNamed(R.v.INormalPass,F)}}),te.bind(R.v.IPostProcessingPass).to(wo).whenTargetNamed("copy"),te.bind(R.v.IPostProcessingPass).to(xl).whenTargetNamed("blurH"),te.bind(R.v.IPostProcessingPass).to(cf).whenTargetNamed("blurV"),te.bind(R.v.IPostProcessingPass).to(Gu).whenTargetNamed("noise"),te.bind(R.v.IPostProcessingPass).to(s).whenTargetNamed("sepia"),te.bind(R.v.IPostProcessingPass).to(bu).whenTargetNamed("colorHalftone"),te.bind(R.v.IPostProcessingPass).to(As).whenTargetNamed("hexagonalPixelate"),te.bind(R.v.IPostProcessingPass).to(Kc).whenTargetNamed("ink"),te.bind(R.v.IFactoryPostProcessingPass).toFactory(function(ie){return function(F){var U=ie.container.getNamed(R.v.IPostProcessingPass,F);return U.setName(F),U}}),te}function Fi(te){var ie=new m.W2;return ie.parent=te,ie.bind(R.v.IStyleAttributeService).to(Rl).inSingletonScope(),ie.bind(R.v.IMultiPassRenderer).to(Vl).inSingletonScope(),ie.bind(R.v.IPostProcessor).to($).inSingletonScope(),ie}},22115:()=>{},21236:()=>{},40646:(ne,L,y)=>{"use strict";y.d(L,{l:()=>M});var M={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},59304:(ne,L,y)=>{"use strict";y.d(L,{d:()=>M});var M=(()=>{return(_=M||(M={})).TOPRIGHT="topright",_.TOPLEFT="topleft",_.BOTTOMRIGHT="bottomright",_.BOTTOMLEFT="bottomleft",_.TOPCENTER="topcenter",_.BOTTOMCENTER="bottomcenter",_.LEFTCENTER="leftcenter",_.RIGHTCENTER="rightcenter",M;var _})()},35323:()=>{},35393:()=>{},24495:()=>{},62306:(ne,L,y)=>{"use strict";y.d(L,{l:()=>M,k:()=>_});var M=(()=>{return(l=M||(M={}))[l.LNGLAT=1]="LNGLAT",l[l.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",l[l.VECTOR_TILE=3]="VECTOR_TILE",l[l.IDENTITY=4]="IDENTITY",l[l.P20=5]="P20",l[l.P20_OFFSET=6]="P20_OFFSET",l[l.METER_OFFSET=7]="METER_OFFSET",l[l.P20_2=8]="P20_2",M;var l})(),_={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"}},12260:(ne,L,y)=>{"use strict";y.d(L,{s:()=>M});var M=(()=>{return(_=M||(M={})).Hover="hover",_.Click="click",_.Select="select",_.Active="active",_.Drag="drag",M;var _})()},25655:()=>{},35781:(ne,L,y)=>{"use strict";y.d(L,{h:()=>M});var M=(()=>{return(_=M||(M={})).normal="normal",_.additive="additive",_.subtractive="subtractive",_.min="min",_.max="max",_.none="none",M;var _})()},39727:(ne,L,y)=>{"use strict";y.d(L,{vY:()=>M,ee:()=>_,GC:()=>l});var M=(()=>{return(m=M||(M={})).LINEAR="linear",m.POWER="power",m.LOG="log",m.IDENTITY="identity",m.TIME="time",m.QUANTILE="quantile",m.QUANTIZE="quantize",m.THRESHOLD="threshold",m.CAT="cat",M;var m})(),_=(()=>{return(m=_||(_={})).CONSTANT="constant",m.VARIABLE="variable",_;var m})(),l=(()=>{return(m=l||(l={}))[m.Attribute=0]="Attribute",m[m.InstancedAttribute=1]="InstancedAttribute",m[m.Uniform=2]="Uniform",l;var m})()},53262:(ne,L,y)=>{"use strict";y.d(L,{I:()=>M});var M=["mapload"]},94671:()=>{},75846:()=>{},81210:()=>{},20626:()=>{},6974:()=>{},55576:(ne,L,y)=>{"use strict";y.d(L,{G:()=>M});var M=(()=>{return(_=M||(M={})).Normal="normal",_.PostProcessing="post-processing",M;var _})()},23824:()=>{},75541:()=>{},34710:()=>{},27159:()=>{},24558:(ne,L,y)=>{"use strict";y.d(L,{gl:()=>M});var M=(()=>{return(_=M||(M={}))[_.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",_[_.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",_[_.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",_[_.POINTS=0]="POINTS",_[_.LINES=1]="LINES",_[_.LINE_LOOP=2]="LINE_LOOP",_[_.LINE_STRIP=3]="LINE_STRIP",_[_.TRIANGLES=4]="TRIANGLES",_[_.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",_[_.TRIANGLE_FAN=6]="TRIANGLE_FAN",_[_.ZERO=0]="ZERO",_[_.ONE=1]="ONE",_[_.SRC_COLOR=768]="SRC_COLOR",_[_.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",_[_.SRC_ALPHA=770]="SRC_ALPHA",_[_.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",_[_.DST_ALPHA=772]="DST_ALPHA",_[_.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",_[_.DST_COLOR=774]="DST_COLOR",_[_.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",_[_.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",_[_.FUNC_ADD=32774]="FUNC_ADD",_[_.BLEND_EQUATION=32777]="BLEND_EQUATION",_[_.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",_[_.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",_[_.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",_[_.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",_[_.MAX_EXT=32776]="MAX_EXT",_[_.MIN_EXT=32775]="MIN_EXT",_[_.BLEND_DST_RGB=32968]="BLEND_DST_RGB",_[_.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",_[_.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",_[_.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",_[_.CONSTANT_COLOR=32769]="CONSTANT_COLOR",_[_.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",_[_.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",_[_.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",_[_.BLEND_COLOR=32773]="BLEND_COLOR",_[_.ARRAY_BUFFER=34962]="ARRAY_BUFFER",_[_.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",_[_.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",_[_.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",_[_.STREAM_DRAW=35040]="STREAM_DRAW",_[_.STATIC_DRAW=35044]="STATIC_DRAW",_[_.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",_[_.BUFFER_SIZE=34660]="BUFFER_SIZE",_[_.BUFFER_USAGE=34661]="BUFFER_USAGE",_[_.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",_[_.FRONT=1028]="FRONT",_[_.BACK=1029]="BACK",_[_.FRONT_AND_BACK=1032]="FRONT_AND_BACK",_[_.CULL_FACE=2884]="CULL_FACE",_[_.BLEND=3042]="BLEND",_[_.DITHER=3024]="DITHER",_[_.STENCIL_TEST=2960]="STENCIL_TEST",_[_.DEPTH_TEST=2929]="DEPTH_TEST",_[_.SCISSOR_TEST=3089]="SCISSOR_TEST",_[_.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",_[_.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",_[_.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",_[_.NO_ERROR=0]="NO_ERROR",_[_.INVALID_ENUM=1280]="INVALID_ENUM",_[_.INVALID_VALUE=1281]="INVALID_VALUE",_[_.INVALID_OPERATION=1282]="INVALID_OPERATION",_[_.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",_[_.CW=2304]="CW",_[_.CCW=2305]="CCW",_[_.LINE_WIDTH=2849]="LINE_WIDTH",_[_.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",_[_.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",_[_.CULL_FACE_MODE=2885]="CULL_FACE_MODE",_[_.FRONT_FACE=2886]="FRONT_FACE",_[_.DEPTH_RANGE=2928]="DEPTH_RANGE",_[_.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",_[_.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",_[_.DEPTH_FUNC=2932]="DEPTH_FUNC",_[_.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",_[_.STENCIL_FUNC=2962]="STENCIL_FUNC",_[_.STENCIL_FAIL=2964]="STENCIL_FAIL",_[_.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",_[_.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",_[_.STENCIL_REF=2967]="STENCIL_REF",_[_.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",_[_.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",_[_.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",_[_.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",_[_.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",_[_.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",_[_.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",_[_.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",_[_.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",_[_.VIEWPORT=2978]="VIEWPORT",_[_.SCISSOR_BOX=3088]="SCISSOR_BOX",_[_.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",_[_.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",_[_.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",_[_.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",_[_.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",_[_.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",_[_.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",_[_.RED_BITS=3410]="RED_BITS",_[_.GREEN_BITS=3411]="GREEN_BITS",_[_.BLUE_BITS=3412]="BLUE_BITS",_[_.ALPHA_BITS=3413]="ALPHA_BITS",_[_.DEPTH_BITS=3414]="DEPTH_BITS",_[_.STENCIL_BITS=3415]="STENCIL_BITS",_[_.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",_[_.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",_[_.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",_[_.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",_[_.SAMPLES=32937]="SAMPLES",_[_.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",_[_.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",_[_.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",_[_.DONT_CARE=4352]="DONT_CARE",_[_.FASTEST=4353]="FASTEST",_[_.NICEST=4354]="NICEST",_[_.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",_[_.BYTE=5120]="BYTE",_[_.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",_[_.SHORT=5122]="SHORT",_[_.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",_[_.INT=5124]="INT",_[_.UNSIGNED_INT=5125]="UNSIGNED_INT",_[_.FLOAT=5126]="FLOAT",_[_.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",_[_.ALPHA=6406]="ALPHA",_[_.RGB=6407]="RGB",_[_.RGBA=6408]="RGBA",_[_.LUMINANCE=6409]="LUMINANCE",_[_.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",_[_.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",_[_.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",_[_.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",_[_.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",_[_.VERTEX_SHADER=35633]="VERTEX_SHADER",_[_.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",_[_.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",_[_.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",_[_.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",_[_.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",_[_.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",_[_.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",_[_.SHADER_TYPE=35663]="SHADER_TYPE",_[_.DELETE_STATUS=35712]="DELETE_STATUS",_[_.LINK_STATUS=35714]="LINK_STATUS",_[_.VALIDATE_STATUS=35715]="VALIDATE_STATUS",_[_.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",_[_.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",_[_.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",_[_.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",_[_.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",_[_.NEVER=512]="NEVER",_[_.LESS=513]="LESS",_[_.EQUAL=514]="EQUAL",_[_.LEQUAL=515]="LEQUAL",_[_.GREATER=516]="GREATER",_[_.NOTEQUAL=517]="NOTEQUAL",_[_.GEQUAL=518]="GEQUAL",_[_.ALWAYS=519]="ALWAYS",_[_.KEEP=7680]="KEEP",_[_.REPLACE=7681]="REPLACE",_[_.INCR=7682]="INCR",_[_.DECR=7683]="DECR",_[_.INVERT=5386]="INVERT",_[_.INCR_WRAP=34055]="INCR_WRAP",_[_.DECR_WRAP=34056]="DECR_WRAP",_[_.VENDOR=7936]="VENDOR",_[_.RENDERER=7937]="RENDERER",_[_.VERSION=7938]="VERSION",_[_.NEAREST=9728]="NEAREST",_[_.LINEAR=9729]="LINEAR",_[_.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",_[_.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",_[_.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",_[_.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",_[_.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",_[_.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",_[_.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",_[_.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",_[_.TEXTURE_2D=3553]="TEXTURE_2D",_[_.TEXTURE=5890]="TEXTURE",_[_.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",_[_.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",_[_.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",_[_.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",_[_.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",_[_.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",_[_.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",_[_.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",_[_.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",_[_.TEXTURE0=33984]="TEXTURE0",_[_.TEXTURE1=33985]="TEXTURE1",_[_.TEXTURE2=33986]="TEXTURE2",_[_.TEXTURE3=33987]="TEXTURE3",_[_.TEXTURE4=33988]="TEXTURE4",_[_.TEXTURE5=33989]="TEXTURE5",_[_.TEXTURE6=33990]="TEXTURE6",_[_.TEXTURE7=33991]="TEXTURE7",_[_.TEXTURE8=33992]="TEXTURE8",_[_.TEXTURE9=33993]="TEXTURE9",_[_.TEXTURE10=33994]="TEXTURE10",_[_.TEXTURE11=33995]="TEXTURE11",_[_.TEXTURE12=33996]="TEXTURE12",_[_.TEXTURE13=33997]="TEXTURE13",_[_.TEXTURE14=33998]="TEXTURE14",_[_.TEXTURE15=33999]="TEXTURE15",_[_.TEXTURE16=34e3]="TEXTURE16",_[_.TEXTURE17=34001]="TEXTURE17",_[_.TEXTURE18=34002]="TEXTURE18",_[_.TEXTURE19=34003]="TEXTURE19",_[_.TEXTURE20=34004]="TEXTURE20",_[_.TEXTURE21=34005]="TEXTURE21",_[_.TEXTURE22=34006]="TEXTURE22",_[_.TEXTURE23=34007]="TEXTURE23",_[_.TEXTURE24=34008]="TEXTURE24",_[_.TEXTURE25=34009]="TEXTURE25",_[_.TEXTURE26=34010]="TEXTURE26",_[_.TEXTURE27=34011]="TEXTURE27",_[_.TEXTURE28=34012]="TEXTURE28",_[_.TEXTURE29=34013]="TEXTURE29",_[_.TEXTURE30=34014]="TEXTURE30",_[_.TEXTURE31=34015]="TEXTURE31",_[_.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",_[_.REPEAT=10497]="REPEAT",_[_.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",_[_.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",_[_.FLOAT_VEC2=35664]="FLOAT_VEC2",_[_.FLOAT_VEC3=35665]="FLOAT_VEC3",_[_.FLOAT_VEC4=35666]="FLOAT_VEC4",_[_.INT_VEC2=35667]="INT_VEC2",_[_.INT_VEC3=35668]="INT_VEC3",_[_.INT_VEC4=35669]="INT_VEC4",_[_.BOOL=35670]="BOOL",_[_.BOOL_VEC2=35671]="BOOL_VEC2",_[_.BOOL_VEC3=35672]="BOOL_VEC3",_[_.BOOL_VEC4=35673]="BOOL_VEC4",_[_.FLOAT_MAT2=35674]="FLOAT_MAT2",_[_.FLOAT_MAT3=35675]="FLOAT_MAT3",_[_.FLOAT_MAT4=35676]="FLOAT_MAT4",_[_.SAMPLER_2D=35678]="SAMPLER_2D",_[_.SAMPLER_CUBE=35680]="SAMPLER_CUBE",_[_.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",_[_.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",_[_.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",_[_.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",_[_.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",_[_.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",_[_.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",_[_.COMPILE_STATUS=35713]="COMPILE_STATUS",_[_.LOW_FLOAT=36336]="LOW_FLOAT",_[_.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",_[_.HIGH_FLOAT=36338]="HIGH_FLOAT",_[_.LOW_INT=36339]="LOW_INT",_[_.MEDIUM_INT=36340]="MEDIUM_INT",_[_.HIGH_INT=36341]="HIGH_INT",_[_.FRAMEBUFFER=36160]="FRAMEBUFFER",_[_.RENDERBUFFER=36161]="RENDERBUFFER",_[_.RGBA4=32854]="RGBA4",_[_.RGB5_A1=32855]="RGB5_A1",_[_.RGB565=36194]="RGB565",_[_.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",_[_.STENCIL_INDEX=6401]="STENCIL_INDEX",_[_.STENCIL_INDEX8=36168]="STENCIL_INDEX8",_[_.DEPTH_STENCIL=34041]="DEPTH_STENCIL",_[_.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",_[_.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",_[_.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",_[_.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",_[_.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",_[_.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",_[_.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",_[_.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",_[_.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",_[_.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",_[_.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",_[_.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",_[_.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",_[_.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",_[_.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",_[_.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",_[_.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",_[_.NONE=0]="NONE",_[_.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",_[_.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",_[_.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",_[_.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",_[_.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",_[_.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",_[_.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",_[_.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",_[_.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",_[_.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",_[_.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",_[_.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",_[_.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",_[_.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",M;var _})()},20051:(ne,L,y)=>{"use strict";y.d(L,{Z:()=>Xe});var lt,tt,Gt,Q,Ut,M=y(32952),_=y(75134),l=y(47289),m=y(93512),O=y(56326),R=y(93890),N=y.n(R),H=y(28303),j=y.n(H),be=y(35037),Ne=y.n(be),V=y(15922),_t=(y(78320),y(24558)),Rt=y(92444),wt=y(55576);function ot(Pt,kt){var ut=Object.keys(Pt);if(Object.getOwnPropertySymbols){var ir=Object.getOwnPropertySymbols(Pt);kt&&(ir=ir.filter(function(le){return Object.getOwnPropertyDescriptor(Pt,le).enumerable})),ut.push.apply(ut,ir)}return ut}function Ue(Pt){for(var kt=1;kt<arguments.length;kt++){var ut=null!=arguments[kt]?arguments[kt]:{};kt%2?ot(Object(ut),!0).forEach(function(ir){(0,m.Z)(Pt,ir,ut[ir])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Pt,Object.getOwnPropertyDescriptors(ut)):ot(Object(ut)).forEach(function(ir){Object.defineProperty(Pt,ir,Object.getOwnPropertyDescriptor(ut,ir))})}return Pt}var Xe=(lt=(0,V.b2)(),tt=(0,V.f3)(Rt.v.IShaderModuleService),lt((Q=function(){function Pt(){(0,_.Z)(this,Pt),(0,M.Z)(this,"shaderModuleService",Ut,this),(0,m.Z)(this,"rendererService",void 0),(0,m.Z)(this,"config",void 0),(0,m.Z)(this,"quad","attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}"),(0,m.Z)(this,"enabled",!0),(0,m.Z)(this,"renderToScreen",!1),(0,m.Z)(this,"model",void 0),(0,m.Z)(this,"name",void 0),(0,m.Z)(this,"optionsToUpdate",{})}return(0,l.Z)(Pt,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(ut){this.name=ut}},{key:"getType",value:function(){return wt.G.PostProcessing}},{key:"init",value:function(ut,ir){this.config=ir,this.rendererService=ut.getContainer().get(Rt.v.IRendererService);var le=this.rendererService,ce=le.createAttribute,ae=le.createBuffer,me=le.createModel,Ie=this.setupShaders(),xr=Ie.uniforms;this.model=me({vs:Ie.vs,fs:Ie.fs,attributes:{a_Position:ce({buffer:ae({data:[-4,-4,4,-4,0,4],type:_t.gl.FLOAT}),size:2})},uniforms:Ue(Ue({u_Texture:null},xr),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}},{key:"render",value:function(ut){var ir=this,le=ut.multiPassRenderer.getPostProcessor(),ce=this.rendererService,ae=ce.useFramebuffer,Ie=ce.clear,je=(0,ce.getViewportSize)(),gt=je.width,xr=je.height;ae(this.renderToScreen?null:le.getWriteFBO(),function(){Ie({framebuffer:le.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),ir.model.draw({uniforms:Ue({u_Texture:le.getReadFBO(),u_ViewportSize:[gt,xr]},ir.convertOptionsToUniforms(ir.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(ut){this.enabled=ut}},{key:"setRenderToScreen",value:function(ut){this.renderToScreen=ut}},{key:"updateOptions",value:function(ut){this.optionsToUpdate=Ue(Ue({},this.optionsToUpdate),ut)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(ut){var ir={};return Object.keys(ut).forEach(function(le){j()(ut[le])||(ir["u_".concat(N()(Ne()(le)))]=ut[le])}),ir}}]),Pt}(),Ut=(0,O.Z)(Q.prototype,"shaderModuleService",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=Q))||Gt)},80533:(ne,L,y)=>{"use strict";y.d(L,{P:()=>M});var M=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},63877:()=>{},33511:()=>{},92444:(ne,L,y)=>{"use strict";y.d(L,{v:()=>M});var M={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},10120:(ne,L,y)=>{"use strict";y(43770)},88818:()=>{},30832:(ne,L,y)=>{"use strict";y.d(L,{SO:()=>M,z6:()=>Tr,a5:()=>_,Z:()=>xt,rQ:()=>mi,bV:()=>On,zi:()=>hi,ds:()=>Jt,Ev:()=>mr,oO:()=>Mt,W0:()=>sr,Z6:()=>dr,We:()=>Pr,gJ:()=>at,vP:()=>$r,yM:()=>Z,yA:()=>Et,CI:()=>gr});var M={};y.r(M),y.d(M,{DPR:()=>Ue,addClass:()=>W,create:()=>Ne,empty:()=>lt,getClass:()=>wt,getContainer:()=>N,getViewPortScale:()=>ot,hasClass:()=>_t,printCanvas:()=>Ut,remove:()=>V,removeClass:()=>Ye,setClass:()=>Rt,setTransform:()=>Gt,splitWords:()=>j,triggerResize:()=>Q,trim:()=>H});var _={};y.r(_),y.d(_,{getColumn:()=>ve,getSatByColumn:()=>_e,max:()=>si,mean:()=>Pi,min:()=>ai,mode:()=>Ei,statMap:()=>re,sum:()=>Yi});var O=y(83838),R=window.document.documentElement.style;function N(G){var oe=G;return"string"==typeof G&&(oe=document.getElementById(G)),oe}function H(G){return G.trim?G.trim():G.replace(/^\s+|\s+$/g,"")}function j(G){return H(G).split(/\s+/)}function Ne(G,oe,xe){var Oe=document.createElement(G);return Oe.className=oe||"",xe&&xe.appendChild(Oe),Oe}function V(G){var oe=G.parentNode;oe&&oe.removeChild(G)}function W(G,oe){if(void 0!==G.classList)for(var xe=j(oe),Oe=0,pe=xe.length;Oe<pe;Oe++)G.classList.add(xe[Oe]);else if(!_t(G,oe)){var Ae=wt(G);Rt(G,(Ae?Ae+" ":"")+oe)}}function Ye(G,oe){void 0!==G.classList?G.classList.remove(oe):Rt(G,H((" "+wt(G)+" ").replace(" "+oe+" "," ")))}function _t(G,oe){if(void 0!==G.classList)return G.classList.contains(oe);var xe=wt(G);return xe.length>0&&new RegExp("(^|\\s)"+oe+"(\\s|$)").test(xe)}function Rt(G,oe){G instanceof HTMLElement?G.className=oe:G.className.baseVal=oe}function wt(G){return G instanceof SVGElement&&(G=G.correspondingElement),void 0===G.className.baseVal?G.className:G.className.baseVal}function lt(G){for(;G&&G.firstChild;)G.removeChild(G.firstChild)}var tt=function(G){if(!R)return G[0];for(var oe in G)if(G[oe]&&G[oe]in R)return G[oe];return G[0]}(["transform","WebkitTransform"]);function Gt(G,oe){G.style[tt]=oe}function Q(){if("function"==typeof Event)window.dispatchEvent(new Event("resize"));else{var G=window.document.createEvent("UIEvents");G.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(G)}}function Ut(G){var oe=["padding: "+(G.height/2-8)+"px "+G.width/2+"px;","line-height: "+G.height+"px;","background-image: url("+G.toDataURL()+");"];console.log("%c\n",oe.join(""))}function ot(){var G,oe=document.querySelector('meta[name="viewport"]');if(!oe)return 1;var Oe=(null===(G=oe.content)||void 0===G?void 0:G.split(",")).find(function(pe){var Ae=pe.split("=");return"initial-scale"===(0,O.Z)(Ae,2)[0]});return Oe?1*Oe.split("=")[1]:1}var Ue=ot()<1?1:window.devicePixelRatio,ct=y(75134),Xe=y(47289),Pt=y(66518),kt=y(41885),ut=y(59553),ir=y(99187),le=y(92007);function ae(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(G){return!1}}function me(G,oe,xe){return(me=ae()?Reflect.construct:function(pe,Ae,Tt){var wr=[null];wr.push.apply(wr,Ae);var ar=new(Function.bind.apply(pe,wr));return Tt&&(0,le.Z)(ar,Tt.prototype),ar}).apply(null,arguments)}function Ie(G){var oe="function"==typeof Map?new Map:void 0;return(Ie=function(Oe){if(null===Oe||!function(G){return-1!==Function.toString.call(G).indexOf("[native code]")}(Oe))return Oe;if("function"!=typeof Oe)throw new TypeError("Super expression must either be null or a function");if(void 0!==oe){if(oe.has(Oe))return oe.get(Oe);oe.set(Oe,pe)}function pe(){return me(Oe,arguments,(0,ir.Z)(this).constructor)}return pe.prototype=Object.create(Oe.prototype,{constructor:{value:pe,enumerable:!1,writable:!0,configurable:!0}}),(0,le.Z)(pe,Oe)})(G)}var je=y(93512);var Fr=function(G){(0,kt.Z)(xe,G);var oe=function(G){var oe=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(G){return!1}}();return function(){var pe,Oe=(0,ir.Z)(G);if(oe){var Ae=(0,ir.Z)(this).constructor;pe=Reflect.construct(Oe,arguments,Ae)}else pe=Oe.apply(this,arguments);return(0,ut.Z)(this,pe)}}(xe);function xe(Oe,pe,Ae){var Tt;return(0,ct.Z)(this,xe),Tt=oe.call(this,Oe),(0,je.Z)((0,Pt.Z)(Tt),"status",void 0),(0,je.Z)((0,Pt.Z)(Tt),"url",void 0),Tt.status=pe,Tt.url=Ae,Tt.name=Tt.constructor.name,Tt.message=Oe,Tt}return(0,Xe.Z)(xe,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),xe}(Ie(Error));var at=function(oe,xe){return function(oe,xe){var Oe=function(G){var oe=new XMLHttpRequest;for(var xe in oe.open("GET",G.url,!0),G.headers)G.headers.hasOwnProperty(xe)&&oe.setRequestHeader(xe,G.headers[xe]);return oe.withCredentials="include"===G.credentials,oe}(oe);return Oe.responseType="arraybuffer",Oe.onerror=function(){xe(new Error(Oe.statusText))},Oe.onload=function(){var pe=Oe.response;if(0===pe.byteLength&&200===Oe.status)return xe(new Error("http status 200 returned without content."));Oe.status>=200&&Oe.status<300&&Oe.response?xe(null,{data:pe,cacheControl:Oe.getResponseHeader("Cache-Control"),expires:Oe.getResponseHeader("Expires")}):xe(new Fr(Oe.statusText,Oe.status,oe.url))},Oe.send(),Oe}(oe,function(Oe,pe){if(Oe)xe(Oe);else if(pe){var Ae=new window.Image;Ae.crossOrigin="anonymous";var Tt=window.URL||window.webkitURL;Ae.onload=function(){xe(null,Ae),Tt.revokeObjectURL(Ae.src)};var wr=new window.Blob([new Uint8Array(pe.data)],{type:"image/png"});Ae.src=pe.data.byteLength?Tt.createObjectURL(wr):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},Re=y(70576),qt=2*Math.PI*6378137/2;function Pr(G){var oe=[1/0,1/0,-1/0,-1/0];return G.forEach(function(xe){er(oe,xe.coordinates)}),oe}function er(G,oe){return Array.isArray(oe[0])?oe.forEach(function(xe){er(G,xe)}):(G[0]>oe[0]&&(G[0]=oe[0]),G[1]>oe[1]&&(G[1]=oe[1]),G[2]<oe[0]&&(G[2]=oe[0]),G[3]<oe[1]&&(G[3]=oe[1])),G}function $r(G){var oe=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],xe=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1},Oe=(G=nt(G,oe))[0],pe=G[1],Ae=Oe*qt/180,Tt=Math.log(Math.tan((90+pe)*Math.PI/360))/(Math.PI/180);return Tt=Tt*qt/180,xe.enable&&(Ae=Number(Ae.toFixed(xe.decimal)),Tt=Number(Tt.toFixed(xe.decimal))),3===G.length?[Ae,Tt,G[2]]:[Ae,Tt]}function nt(G,oe){if(!1===oe)return G;var xe=function(G){if(null==G)throw new Error("lng is required");return(G>180||G<-180)&&((G%=360)>180&&(G=-360+G),G<-180&&(G=360+G),0===G&&(G=0)),G}(G[0]),Oe=function(G){if(null==G)throw new Error("lat is required");return(G>90||G<-90)&&((G%=180)>90&&(G=-180+G),G<-90&&(G=180+G),0===G&&(G=0)),G}(G[1]);return Oe>85&&(Oe=85),Oe<-85&&(Oe=-85),3===G.length?[xe,Oe,G[2]]:[xe,Oe]}function xt(G){var oe=85.0511287798,xe=Math.max(Math.min(oe,G[1]),-oe),Oe=256<<20,pe=Math.PI/180,Ae=G[0]*pe,Tt=xe*pe;return Tt=Math.log(Math.tan(Math.PI/4+Tt/2)),Ae=Oe*(.5/Math.PI*Ae+.5),Tt=Oe*(-.5/Math.PI*Tt+(pe=.5)),[Math.floor(Ae),Math.floor(Tt)]}function Z(G,oe,xe){var Oe=(0,Re.Ht)(oe[1]-G[1]),pe=(0,Re.Ht)(oe[0]-G[0]),Ae=(0,Re.Ht)(G[1]),Tt=(0,Re.Ht)(oe[1]),wr=Math.pow(Math.sin(Oe/2),2)+Math.pow(Math.sin(pe/2),2)*Math.cos(Ae)*Math.cos(Tt);return(0,Re.DL)(2*Math.atan2(Math.sqrt(wr),Math.sqrt(1-wr)),"meters")}function Et(G,oe){var xe=Math.abs(G[1][1]-G[0][1])*oe,Oe=Math.abs(G[1][0]-G[0][0])*oe;return[[G[0][0]-Oe,G[0][1]-xe],[G[1][0]+Oe,G[1][1]+xe]]}function Mt(G,oe){return G[0][0]<=oe[0][0]&&G[0][1]<=oe[0][1]&&G[1][0]>=oe[1][0]&&G[1][1]>=oe[1][1]}function Jt(G){return[[G[0],G[1]],[G[2],G[3]]]}var Tr=function(){function G(){var oe=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,xe=arguments.length>1?arguments[1]:void 0;(0,ct.Z)(this,G),(0,je.Z)(this,"limit",void 0),(0,je.Z)(this,"cache",void 0),(0,je.Z)(this,"destroy",void 0),(0,je.Z)(this,"order",void 0),this.limit=oe,this.destroy=xe||this.defaultDestroy,this.order=[],this.clear()}return(0,Xe.Z)(G,[{key:"clear",value:function(){var xe=this;this.order.forEach(function(Oe){xe.delete(Oe)}),this.cache={},this.order=[]}},{key:"get",value:function(xe){var Oe=this.cache[xe];return Oe&&(this.deleteOrder(xe),this.appendOrder(xe)),Oe}},{key:"set",value:function(xe,Oe){this.cache[xe]?(this.delete(xe),this.cache[xe]=Oe,this.appendOrder(xe)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[xe]=Oe,this.appendOrder(xe))}},{key:"delete",value:function(xe){var Oe=this.cache[xe];Oe&&(this.deleteCache(xe),this.deleteOrder(xe),this.destroy(Oe,xe))}},{key:"deleteCache",value:function(xe){delete this.cache[xe]}},{key:"deleteOrder",value:function(xe){var Oe=this.order.findIndex(function(pe){return pe===xe});Oe>=0&&this.order.splice(Oe,1)}},{key:"appendOrder",value:function(xe){this.order.push(xe)}},{key:"defaultDestroy",value:function(xe,Oe){return null}}]),G}();function mr(G,oe){G.forEach(function(xe){!oe[xe]||(oe[xe]=oe[xe].bind(oe))})}var Yt=y(27859);function gr(G){var oe=Yt.ZP(G),xe=[0,0,0,0];return null!=oe&&(xe[0]=oe.r/255,xe[1]=oe.g/255,xe[2]=oe.b/255,xe[3]=oe.opacity),xe}function sr(G){return(G&&G[0])+256*(G&&G[1])+65536*(G&&G[2])-1}function dr(G){return[G+1&255,G+1>>8&255,G+1>>8>>8&255]}var On=(()=>{return(G=On||(On={})).CENTER="center",G.TOP="top",G["TOP-LEFT"]="top-left",G["TOP-RIGHT"]="top-right",G.BOTTOM="bottom",G["BOTTOM-LEFT"]="bottom-left",G.LEFT="left",G.RIGHT="right",On;var G})(),mi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hi(G,oe,xe){var Oe=G.classList;for(var pe in mi)mi.hasOwnProperty(pe)&&Oe.remove("l7-".concat(xe,"-anchor-").concat(pe));Oe.add("l7-".concat(xe,"-anchor-").concat(oe))}function si(G){if(0===G.length)throw new Error("max requires at least one data point");for(var oe=G[0],xe=1;xe<G.length;xe++)G[xe]>oe&&(oe=G[xe]);return 1*oe}function ai(G){if(0===G.length)throw new Error("min requires at least one data point");for(var oe=G[0],xe=1;xe<G.length;xe++)G[xe]<oe&&(oe=G[xe]);return 1*oe}function Yi(G){if(0===G.length)return 0;for(var oe=1*G[0],xe=1;xe<G.length;xe++)oe+=1*G[xe];return oe}function Pi(G){if(0===G.length)throw new Error("mean requires at least one data point");return Yi(G)/G.length}function Ei(G){if(0===G.length)throw new Error("mean requires at least one data point");if(G.length<3)return G[0];G.sort();for(var oe=G[0],xe=NaN,Oe=0,pe=1,Ae=1;Ae<G.length+1;Ae++)G[Ae]!==oe?(pe>Oe&&(Oe=pe,xe=oe),pe=1,oe=G[Ae]):pe++;return 1*xe}var re={min:ai,max:si,mean:Pi,sum:Yi,mode:Ei};function ve(G,oe){return G.map(function(xe){return xe[oe]})}function _e(G,oe){return re[G](oe)}},97935:(ne,L,y)=>{var M=y(96847);function l(R){var N=0;if(R&&R.length>0){N+=Math.abs(m(R[0]));for(var H=1;H<R.length;H++)N-=Math.abs(m(R[H]))}return N}function m(R){var N,H,be,Ne,V,W,Ye=0,_t=R.length;if(_t>2){for(W=0;W<_t;W++)W===_t-2?(be=_t-2,Ne=_t-1,V=0):W===_t-1?(be=_t-1,Ne=0,V=1):(be=W,Ne=W+1,V=W+2),N=R[be],H=R[Ne],Ye+=(O(R[V][0])-O(N[0]))*Math.sin(O(H[1]));Ye=Ye*M.RADIUS*M.RADIUS/2}return Ye}function O(R){return R*Math.PI/180}ne.exports.geometry=function _(R){var H,N=0;switch(R.type){case"Polygon":return l(R.coordinates);case"MultiPolygon":for(H=0;H<R.coordinates.length;H++)N+=l(R.coordinates[H]);return N;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(H=0;H<R.geometries.length;H++)N+=_(R.geometries[H]);return N}},ne.exports.ring=m},57452:(ne,L,y)=>{var M=y(97935);function l(H,j){return function(be){return H(be,j)}}function O(H,j){H[0]=R(H[0],j=!!j);for(var be=1;be<H.length;be++)H[be]=R(H[be],!j);return H}function R(H,j){return function(H){return M.ring(H)>=0}(H)===j?H:H.reverse()}ne.exports=function _(H,j){switch(H&&H.type||null){case"FeatureCollection":return H.features=H.features.map(l(_,j)),H;case"GeometryCollection":return H.geometries=H.geometries.map(l(_,j)),H;case"Feature":return H.geometry=_(H.geometry,j),H;case"Polygon":case"MultiPolygon":return function(H,j){return"Polygon"===H.type?H.coordinates=O(H.coordinates,j):"MultiPolygon"===H.type&&(H.coordinates=H.coordinates.map(l(O,j))),H}(H,j);default:return H}}},51002:ne=>{"use strict";ne.exports=y,ne.exports.default=y;var L=1e20;function y(O,R,N,H,j,be){this.fontSize=O||24,this.buffer=void 0===R?3:R,this.cutoff=H||.25,this.fontFamily=j||"sans-serif",this.fontWeight=be||"normal",this.radius=N||8;var Ne=this.size=this.fontSize+2*this.buffer,V=Ne+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Ne,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(V*V),this.gridInner=new Float64Array(V*V),this.f=new Float64Array(V),this.z=new Float64Array(V+1),this.v=new Uint16Array(V),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(Ne/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function l(O,R,N,H,j,be){for(var Ne=0;Ne<R;Ne++)m(O,Ne,R,N,H,j,be);for(var V=0;V<N;V++)m(O,V*R,1,R,H,j,be)}function m(O,R,N,H,j,be,Ne){var V,W,Ye,_t;for(be[0]=0,Ne[0]=-L,Ne[1]=L,V=0;V<H;V++)j[V]=O[R+V*N];for(V=1,W=0,Ye=0;V<H;V++){do{Ye=(j[V]-j[_t=be[W]]+V*V-_t*_t)/(V-_t)/2}while(Ye<=Ne[W]&&--W>-1);be[++W]=V,Ne[W]=Ye,Ne[W+1]=L}for(V=0,W=0;V<H;V++){for(;Ne[W+1]<V;)W++;O[R+V*N]=j[_t=be[W]]+(V-_t)*(V-_t)}}y.prototype._draw=function(O,R){var be,Ne,V,W,Ye,_t,Rt,wt,lt,N=this.ctx.measureText(O),H=N.width,j=2*this.buffer;R&&this.useMetrics?(Ye=Math.floor(N.actualBoundingBoxAscent),wt=this.buffer+Math.ceil(N.actualBoundingBoxAscent),_t=this.buffer,Rt=this.buffer,be=(Ne=Math.min(this.size,Math.ceil(N.actualBoundingBoxRight-N.actualBoundingBoxLeft)))+j,V=(W=Math.min(this.size-_t,Math.ceil(N.actualBoundingBoxAscent+N.actualBoundingBoxDescent)))+j,this.ctx.textBaseline="alphabetic"):(be=Ne=this.size,V=W=this.size,Ye=19*this.fontSize/24,_t=Rt=0,wt=this.middle,this.ctx.textBaseline="middle"),Ne&&W&&(this.ctx.clearRect(Rt,_t,Ne,W),this.ctx.fillText(O,this.buffer,wt),lt=this.ctx.getImageData(Rt,_t,Ne,W));var tt=new Uint8ClampedArray(be*V);return function(O,R,N,H,j,be,Ne){be.fill(L,0,R*N),Ne.fill(0,0,R*N);for(var V=(R-H)/2,W=0;W<j;W++)for(var Ye=0;Ye<H;Ye++){var _t=(W+V)*R+Ye+V,Rt=O.data[4*(W*H+Ye)+3]/255;if(1===Rt)be[_t]=0,Ne[_t]=L;else if(0===Rt)be[_t]=L,Ne[_t]=0;else{var wt=Math.max(0,.5-Rt),lt=Math.max(0,Rt-.5);be[_t]=wt*wt,Ne[_t]=lt*lt}}}(lt,be,V,Ne,W,this.gridOuter,this.gridInner),l(this.gridOuter,be,V,this.f,this.v,this.z),l(this.gridInner,be,V,this.f,this.v,this.z),function(O,R,N,H,j,be,Ne){for(var V=0;V<R*N;V++){var W=Math.sqrt(H[V])-Math.sqrt(j[V]);O[V]=Math.round(255-255*(W/be+Ne))}}(tt,be,V,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:tt,metrics:{width:Ne,height:W,sdfWidth:be,sdfHeight:V,top:Ye,left:0,advance:H}}},y.prototype.draw=function(O){return this._draw(O,!1).data},y.prototype.drawWithMetrics=function(O){return this._draw(O,!0)}},27859:(ne,L,y)=>{"use strict";function M(me,Ie,je){me.prototype=Ie.prototype=je,je.constructor=me}function _(me,Ie){var je=Object.create(me.prototype);for(var gt in Ie)je[gt]=Ie[gt];return je}function l(){}y.d(L,{ZP:()=>Gt,B8:()=>Ue});var m=.7,O=1/m,R="\\s*([+-]?\\d+)\\s*",N="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",H="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",j=/^#([0-9a-f]{3,8})$/,be=new RegExp("^rgb\\("+[R,R,R]+"\\)$"),Ne=new RegExp("^rgb\\("+[H,H,H]+"\\)$"),V=new RegExp("^rgba\\("+[R,R,R,N]+"\\)$"),W=new RegExp("^rgba\\("+[H,H,H,N]+"\\)$"),Ye=new RegExp("^hsl\\("+[N,H,H]+"\\)$"),_t=new RegExp("^hsla\\("+[N,H,H,N]+"\\)$"),Rt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function wt(){return this.rgb().formatHex()}function tt(){return this.rgb().formatRgb()}function Gt(me){var Ie,je;return me=(me+"").trim().toLowerCase(),(Ie=j.exec(me))?(je=Ie[1].length,Ie=parseInt(Ie[1],16),6===je?Q(Ie):3===je?new ct(Ie>>8&15|Ie>>4&240,Ie>>4&15|240&Ie,(15&Ie)<<4|15&Ie,1):8===je?Ut(Ie>>24&255,Ie>>16&255,Ie>>8&255,(255&Ie)/255):4===je?Ut(Ie>>12&15|Ie>>8&240,Ie>>8&15|Ie>>4&240,Ie>>4&15|240&Ie,((15&Ie)<<4|15&Ie)/255):null):(Ie=be.exec(me))?new ct(Ie[1],Ie[2],Ie[3],1):(Ie=Ne.exec(me))?new ct(255*Ie[1]/100,255*Ie[2]/100,255*Ie[3]/100,1):(Ie=V.exec(me))?Ut(Ie[1],Ie[2],Ie[3],Ie[4]):(Ie=W.exec(me))?Ut(255*Ie[1]/100,255*Ie[2]/100,255*Ie[3]/100,Ie[4]):(Ie=Ye.exec(me))?ut(Ie[1],Ie[2]/100,Ie[3]/100,1):(Ie=_t.exec(me))?ut(Ie[1],Ie[2]/100,Ie[3]/100,Ie[4]):Rt.hasOwnProperty(me)?Q(Rt[me]):"transparent"===me?new ct(NaN,NaN,NaN,0):null}function Q(me){return new ct(me>>16&255,me>>8&255,255&me,1)}function Ut(me,Ie,je,gt){return gt<=0&&(me=Ie=je=NaN),new ct(me,Ie,je,gt)}function ot(me){return me instanceof l||(me=Gt(me)),me?new ct((me=me.rgb()).r,me.g,me.b,me.opacity):new ct}function Ue(me,Ie,je,gt){return 1===arguments.length?ot(me):new ct(me,Ie,je,null==gt?1:gt)}function ct(me,Ie,je,gt){this.r=+me,this.g=+Ie,this.b=+je,this.opacity=+gt}function Xe(){return"#"+kt(this.r)+kt(this.g)+kt(this.b)}function Pt(){var me=this.opacity;return(1===(me=isNaN(me)?1:Math.max(0,Math.min(1,me)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===me?")":", "+me+")")}function kt(me){return((me=Math.max(0,Math.min(255,Math.round(me)||0)))<16?"0":"")+me.toString(16)}function ut(me,Ie,je,gt){return gt<=0?me=Ie=je=NaN:je<=0||je>=1?me=Ie=NaN:Ie<=0&&(me=NaN),new ce(me,Ie,je,gt)}function ir(me){if(me instanceof ce)return new ce(me.h,me.s,me.l,me.opacity);if(me instanceof l||(me=Gt(me)),!me)return new ce;if(me instanceof ce)return me;var Ie=(me=me.rgb()).r/255,je=me.g/255,gt=me.b/255,xr=Math.min(Ie,je,gt),Fr=Math.max(Ie,je,gt),cn=NaN,Ir=Fr-xr,Ot=(Fr+xr)/2;return Ir?(cn=Ie===Fr?(je-gt)/Ir+6*(je<gt):je===Fr?(gt-Ie)/Ir+2:(Ie-je)/Ir+4,Ir/=Ot<.5?Fr+xr:2-Fr-xr,cn*=60):Ir=Ot>0&&Ot<1?0:cn,new ce(cn,Ir,Ot,me.opacity)}function ce(me,Ie,je,gt){this.h=+me,this.s=+Ie,this.l=+je,this.opacity=+gt}function ae(me,Ie,je){return 255*(me<60?Ie+(je-Ie)*me/60:me<180?je:me<240?Ie+(je-Ie)*(240-me)/60:Ie)}M(l,Gt,{copy:function(me){return Object.assign(new this.constructor,this,me)},displayable:function(){return this.rgb().displayable()},hex:wt,formatHex:wt,formatHsl:function(){return ir(this).formatHsl()},formatRgb:tt,toString:tt}),M(ct,Ue,_(l,{brighter:function(me){return me=null==me?O:Math.pow(O,me),new ct(this.r*me,this.g*me,this.b*me,this.opacity)},darker:function(me){return me=null==me?m:Math.pow(m,me),new ct(this.r*me,this.g*me,this.b*me,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xe,formatHex:Xe,formatRgb:Pt,toString:Pt})),M(ce,function(me,Ie,je,gt){return 1===arguments.length?ir(me):new ce(me,Ie,je,null==gt?1:gt)},_(l,{brighter:function(me){return me=null==me?O:Math.pow(O,me),new ce(this.h,this.s,this.l*me,this.opacity)},darker:function(me){return me=null==me?m:Math.pow(m,me),new ce(this.h,this.s,this.l*me,this.opacity)},rgb:function(){var me=this.h%360+360*(this.h<0),Ie=isNaN(me)||isNaN(this.s)?0:this.s,je=this.l,gt=je+(je<.5?je:1-je)*Ie,xr=2*je-gt;return new ct(ae(me>=240?me-240:me+120,xr,gt),ae(me,xr,gt),ae(me<120?me+240:me-120,xr,gt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var me=this.opacity;return(1===(me=isNaN(me)?1:Math.max(0,Math.min(1,me)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===me?")":", "+me+")")}}))},41604:ne=>{"use strict";function L(le,ce,ae){ae=ae||2;var xr,Fr,cn,Ir,Ot,Le,we,me=ce&&ce.length,Ie=me?ce[0]*ae:le.length,je=y(le,0,Ie,ae,!0),gt=[];if(!je||je.next===je.prev)return gt;if(me&&(je=function(le,ce,ae,me){var je,gt,cn,Ie=[];for(je=0,gt=ce.length;je<gt;je++)(cn=y(le,ce[je]*me,je<gt-1?ce[je+1]*me:le.length,me,!1))===cn.next&&(cn.steiner=!0),Ie.push(_t(cn));for(Ie.sort(H),je=0;je<Ie.length;je++)ae=M(ae=j(Ie[je],ae),ae.next);return ae}(le,ce,je,ae)),le.length>80*ae){xr=cn=le[0],Fr=Ir=le[1];for(var at=ae;at<Ie;at+=ae)(Ot=le[at])<xr&&(xr=Ot),(Le=le[at+1])<Fr&&(Fr=Le),Ot>cn&&(cn=Ot),Le>Ir&&(Ir=Le);we=0!==(we=Math.max(cn-xr,Ir-Fr))?1/we:0}return _(je,gt,ae,xr,Fr,we),gt}function y(le,ce,ae,me,Ie){var je,gt;if(Ie===ir(le,ce,ae,me)>0)for(je=ce;je<ae;je+=me)gt=Pt(je,le[je],le[je+1],gt);else for(je=ae-me;je>=ce;je-=me)gt=Pt(je,le[je],le[je+1],gt);return gt&&tt(gt,gt.next)&&(kt(gt),gt=gt.next),gt}function M(le,ce){if(!le)return le;ce||(ce=le);var me,ae=le;do{if(me=!1,ae.steiner||!tt(ae,ae.next)&&0!==lt(ae.prev,ae,ae.next))ae=ae.next;else{if(kt(ae),(ae=ce=ae.prev)===ae.next)break;me=!0}}while(me||ae!==ce);return ce}function _(le,ce,ae,me,Ie,je,gt){if(le){!gt&&je&&function(le,ce,ae,me){var Ie=le;do{null===Ie.z&&(Ie.z=Ye(Ie.x,Ie.y,ce,ae,me)),Ie.prevZ=Ie.prev,Ie.nextZ=Ie.next,Ie=Ie.next}while(Ie!==le);Ie.prevZ.nextZ=null,Ie.prevZ=null,function(le){var ce,ae,me,Ie,je,gt,xr,Fr,cn=1;do{for(ae=le,le=null,je=null,gt=0;ae;){for(gt++,me=ae,xr=0,ce=0;ce<cn&&(xr++,me=me.nextZ);ce++);for(Fr=cn;xr>0||Fr>0&&me;)0!==xr&&(0===Fr||!me||ae.z<=me.z)?(Ie=ae,ae=ae.nextZ,xr--):(Ie=me,me=me.nextZ,Fr--),je?je.nextZ=Ie:le=Ie,Ie.prevZ=je,je=Ie;ae=me}je.nextZ=null,cn*=2}while(gt>1)}(Ie)}(le,me,Ie,je);for(var Fr,cn,xr=le;le.prev!==le.next;)if(Fr=le.prev,cn=le.next,je?m(le,me,Ie,je):l(le))ce.push(Fr.i/ae),ce.push(le.i/ae),ce.push(cn.i/ae),kt(le),le=cn.next,xr=cn.next;else if((le=cn)===xr){gt?1===gt?_(le=O(M(le),ce,ae),ce,ae,me,Ie,je,2):2===gt&&R(le,ce,ae,me,Ie,je):_(M(le),ce,ae,me,Ie,je,1);break}}}function l(le){var ce=le.prev,ae=le,me=le.next;if(lt(ce,ae,me)>=0)return!1;for(var Ie=le.next.next;Ie!==le.prev;){if(Rt(ce.x,ce.y,ae.x,ae.y,me.x,me.y,Ie.x,Ie.y)&&lt(Ie.prev,Ie,Ie.next)>=0)return!1;Ie=Ie.next}return!0}function m(le,ce,ae,me){var Ie=le.prev,je=le,gt=le.next;if(lt(Ie,je,gt)>=0)return!1;for(var cn=Ie.x>je.x?Ie.x>gt.x?Ie.x:gt.x:je.x>gt.x?je.x:gt.x,Ir=Ie.y>je.y?Ie.y>gt.y?Ie.y:gt.y:je.y>gt.y?je.y:gt.y,Ot=Ye(Ie.x<je.x?Ie.x<gt.x?Ie.x:gt.x:je.x<gt.x?je.x:gt.x,Ie.y<je.y?Ie.y<gt.y?Ie.y:gt.y:je.y<gt.y?je.y:gt.y,ce,ae,me),Le=Ye(cn,Ir,ce,ae,me),we=le.prevZ,at=le.nextZ;we&&we.z>=Ot&&at&&at.z<=Le;){if(we!==le.prev&&we!==le.next&&Rt(Ie.x,Ie.y,je.x,je.y,gt.x,gt.y,we.x,we.y)&&lt(we.prev,we,we.next)>=0||(we=we.prevZ,at!==le.prev&&at!==le.next&&Rt(Ie.x,Ie.y,je.x,je.y,gt.x,gt.y,at.x,at.y)&&lt(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;we&&we.z>=Ot;){if(we!==le.prev&&we!==le.next&&Rt(Ie.x,Ie.y,je.x,je.y,gt.x,gt.y,we.x,we.y)&&lt(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;at&&at.z<=Le;){if(at!==le.prev&&at!==le.next&&Rt(Ie.x,Ie.y,je.x,je.y,gt.x,gt.y,at.x,at.y)&&lt(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}function O(le,ce,ae){var me=le;do{var Ie=me.prev,je=me.next.next;!tt(Ie,je)&&Gt(Ie,me,me.next,je)&&Ue(Ie,je)&&Ue(je,Ie)&&(ce.push(Ie.i/ae),ce.push(me.i/ae),ce.push(je.i/ae),kt(me),kt(me.next),me=le=je),me=me.next}while(me!==le);return M(me)}function R(le,ce,ae,me,Ie,je){var gt=le;do{for(var xr=gt.next.next;xr!==gt.prev;){if(gt.i!==xr.i&&wt(gt,xr)){var Fr=Xe(gt,xr);return gt=M(gt,gt.next),Fr=M(Fr,Fr.next),_(gt,ce,ae,me,Ie,je),void _(Fr,ce,ae,me,Ie,je)}xr=xr.next}gt=gt.next}while(gt!==le)}function H(le,ce){return le.x-ce.x}function j(le,ce){var ae=function(le,ce){var gt,ae=ce,me=le.x,Ie=le.y,je=-1/0;do{if(Ie<=ae.y&&Ie>=ae.next.y&&ae.next.y!==ae.y){var xr=ae.x+(Ie-ae.y)*(ae.next.x-ae.x)/(ae.next.y-ae.y);if(xr<=me&&xr>je){if(je=xr,xr===me){if(Ie===ae.y)return ae;if(Ie===ae.next.y)return ae.next}gt=ae.x<ae.next.x?ae:ae.next}}ae=ae.next}while(ae!==ce);if(!gt)return null;if(me===je)return gt;var Le,Fr=gt,cn=gt.x,Ir=gt.y,Ot=1/0;ae=gt;do{me>=ae.x&&ae.x>=cn&&me!==ae.x&&Rt(Ie<Ir?me:je,Ie,cn,Ir,Ie<Ir?je:me,Ie,ae.x,ae.y)&&(Le=Math.abs(Ie-ae.y)/(me-ae.x),Ue(ae,le)&&(Le<Ot||Le===Ot&&(ae.x>gt.x||ae.x===gt.x&&Ne(gt,ae)))&&(gt=ae,Ot=Le)),ae=ae.next}while(ae!==Fr);return gt}(le,ce);if(!ae)return ce;var me=Xe(ae,le),Ie=M(ae,ae.next);return M(me,me.next),ce===ae?Ie:ce}function Ne(le,ce){return lt(le.prev,le,ce.prev)<0&&lt(ce.next,le,le.next)<0}function Ye(le,ce,ae,me,Ie){return(le=1431655765&((le=858993459&((le=252645135&((le=16711935&((le=32767*(le-ae)*Ie)|le<<8))|le<<4))|le<<2))|le<<1))|(ce=1431655765&((ce=858993459&((ce=252645135&((ce=16711935&((ce=32767*(ce-me)*Ie)|ce<<8))|ce<<4))|ce<<2))|ce<<1))<<1}function _t(le){var ce=le,ae=le;do{(ce.x<ae.x||ce.x===ae.x&&ce.y<ae.y)&&(ae=ce),ce=ce.next}while(ce!==le);return ae}function Rt(le,ce,ae,me,Ie,je,gt,xr){return(Ie-gt)*(ce-xr)-(le-gt)*(je-xr)>=0&&(le-gt)*(me-xr)-(ae-gt)*(ce-xr)>=0&&(ae-gt)*(je-xr)-(Ie-gt)*(me-xr)>=0}function wt(le,ce){return le.next.i!==ce.i&&le.prev.i!==ce.i&&!function(le,ce){var ae=le;do{if(ae.i!==le.i&&ae.next.i!==le.i&&ae.i!==ce.i&&ae.next.i!==ce.i&&Gt(ae,ae.next,le,ce))return!0;ae=ae.next}while(ae!==le);return!1}(le,ce)&&(Ue(le,ce)&&Ue(ce,le)&&function(le,ce){var ae=le,me=!1,Ie=(le.x+ce.x)/2,je=(le.y+ce.y)/2;do{ae.y>je!=ae.next.y>je&&ae.next.y!==ae.y&&Ie<(ae.next.x-ae.x)*(je-ae.y)/(ae.next.y-ae.y)+ae.x&&(me=!me),ae=ae.next}while(ae!==le);return me}(le,ce)&&(lt(le.prev,le,ce.prev)||lt(le,ce.prev,ce))||tt(le,ce)&&lt(le.prev,le,le.next)>0&&lt(ce.prev,ce,ce.next)>0)}function lt(le,ce,ae){return(ce.y-le.y)*(ae.x-ce.x)-(ce.x-le.x)*(ae.y-ce.y)}function tt(le,ce){return le.x===ce.x&&le.y===ce.y}function Gt(le,ce,ae,me){var Ie=Ut(lt(le,ce,ae)),je=Ut(lt(le,ce,me)),gt=Ut(lt(ae,me,le)),xr=Ut(lt(ae,me,ce));return!!(Ie!==je&&gt!==xr||0===Ie&&Q(le,ae,ce)||0===je&&Q(le,me,ce)||0===gt&&Q(ae,le,me)||0===xr&&Q(ae,ce,me))}function Q(le,ce,ae){return ce.x<=Math.max(le.x,ae.x)&&ce.x>=Math.min(le.x,ae.x)&&ce.y<=Math.max(le.y,ae.y)&&ce.y>=Math.min(le.y,ae.y)}function Ut(le){return le>0?1:le<0?-1:0}function Ue(le,ce){return lt(le.prev,le,le.next)<0?lt(le,ce,le.next)>=0&&lt(le,le.prev,ce)>=0:lt(le,ce,le.prev)<0||lt(le,le.next,ce)<0}function Xe(le,ce){var ae=new ut(le.i,le.x,le.y),me=new ut(ce.i,ce.x,ce.y),Ie=le.next,je=ce.prev;return le.next=ce,ce.prev=le,ae.next=Ie,Ie.prev=ae,me.next=ae,ae.prev=me,je.next=me,me.prev=je,me}function Pt(le,ce,ae,me){var Ie=new ut(le,ce,ae);return me?(Ie.next=me.next,Ie.prev=me,me.next.prev=Ie,me.next=Ie):(Ie.prev=Ie,Ie.next=Ie),Ie}function kt(le){le.next.prev=le.prev,le.prev.next=le.next,le.prevZ&&(le.prevZ.nextZ=le.nextZ),le.nextZ&&(le.nextZ.prevZ=le.prevZ)}function ut(le,ce,ae){this.i=le,this.x=ce,this.y=ae,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ir(le,ce,ae,me){for(var Ie=0,je=ce,gt=ae-me;je<ae;je+=me)Ie+=(le[gt]-le[je])*(le[je+1]+le[gt+1]),gt=je;return Ie}ne.exports=L,ne.exports.default=L,L.deviation=function(le,ce,ae,me){var Ie=ce&&ce.length,gt=Math.abs(ir(le,0,Ie?ce[0]*ae:le.length,ae));if(Ie)for(var xr=0,Fr=ce.length;xr<Fr;xr++)gt-=Math.abs(ir(le,ce[xr]*ae,xr<Fr-1?ce[xr+1]*ae:le.length,ae));var Ot=0;for(xr=0;xr<me.length;xr+=3){var Le=me[xr]*ae,we=me[xr+1]*ae,at=me[xr+2]*ae;Ot+=Math.abs((le[Le]-le[at])*(le[we+1]-le[Le+1])-(le[Le]-le[we])*(le[at+1]-le[Le+1]))}return 0===gt&&0===Ot?0:Math.abs((Ot-gt)/gt)},L.flatten=function(le){for(var ce=le[0][0].length,ae={vertices:[],holes:[],dimensions:ce},me=0,Ie=0;Ie<le.length;Ie++){for(var je=0;je<le[Ie].length;je++)for(var gt=0;gt<ce;gt++)ae.vertices.push(le[Ie][je][gt]);Ie>0&&ae.holes.push(me+=le[Ie-1].length)}return ae}},18660:ne=>{function L(M){var _=M.target||M.srcElement;_.__resizeRAF__&&cancelAnimationFrame(_.__resizeRAF__),_.__resizeRAF__=requestAnimationFrame(function(){var l=_.__resizeTrigger__,m=l&&l.__resizeListeners__;m&&m.forEach(function(O){O.call(l,M)})})}var y=function(_,l){var R,O=this.document,N=O.attachEvent;if("undefined"!=typeof navigator&&(R=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!_.__resizeListeners__)if(_.__resizeListeners__=[],N)_.__resizeTrigger__=_,_.attachEvent("onresize",L);else{"static"===getComputedStyle(_).position&&(_.style.position="relative");var j=_.__resizeTrigger__=O.createElement("object");j.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),j.setAttribute("class","resize-sensor"),j.setAttribute("tabindex","-1"),j.setAttribute("title",""),j.__resizeElement__=_,j.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",L)},j.type="text/html",R&&_.appendChild(j),j.data="about:blank",R||_.appendChild(j)}_.__resizeListeners__.push(l)};ne.exports="undefined"==typeof window?y:y.bind(window),ne.exports.unbind=function(M,_){var l=document.attachEvent,m=M.__resizeListeners__||[];if(_){var O=m.indexOf(_);-1!==O&&m.splice(O,1)}else m=M.__resizeListeners__=[];if(!m.length){if(l)M.detachEvent("onresize",L);else if(M.__resizeTrigger__){var R=M.__resizeTrigger__.contentDocument,N=R&&R.defaultView;N&&(N.removeEventListener("resize",L),delete N.__resizeTrigger__),M.__resizeTrigger__=!M.removeChild(M.__resizeTrigger__)}delete M.__resizeListeners__}}},42624:ne=>{"use strict";var L=Object.prototype.hasOwnProperty,y="~";function M(){}function _(R,N,H){this.fn=R,this.context=N,this.once=H||!1}function l(R,N,H,j,be){if("function"!=typeof H)throw new TypeError("The listener must be a function");var Ne=new _(H,j||R,be),V=y?y+N:N;return R._events[V]?R._events[V].fn?R._events[V]=[R._events[V],Ne]:R._events[V].push(Ne):(R._events[V]=Ne,R._eventsCount++),R}function m(R,N){0==--R._eventsCount?R._events=new M:delete R._events[N]}function O(){this._events=new M,this._eventsCount=0}Object.create&&(M.prototype=Object.create(null),(new M).__proto__||(y=!1)),O.prototype.eventNames=function(){var H,j,N=[];if(0===this._eventsCount)return N;for(j in H=this._events)L.call(H,j)&&N.push(y?j.slice(1):j);return Object.getOwnPropertySymbols?N.concat(Object.getOwnPropertySymbols(H)):N},O.prototype.listeners=function(N){var j=this._events[y?y+N:N];if(!j)return[];if(j.fn)return[j.fn];for(var be=0,Ne=j.length,V=new Array(Ne);be<Ne;be++)V[be]=j[be].fn;return V},O.prototype.listenerCount=function(N){var j=this._events[y?y+N:N];return j?j.fn?1:j.length:0},O.prototype.emit=function(N,H,j,be,Ne,V){var W=y?y+N:N;if(!this._events[W])return!1;var Rt,wt,Ye=this._events[W],_t=arguments.length;if(Ye.fn){switch(Ye.once&&this.removeListener(N,Ye.fn,void 0,!0),_t){case 1:return Ye.fn.call(Ye.context),!0;case 2:return Ye.fn.call(Ye.context,H),!0;case 3:return Ye.fn.call(Ye.context,H,j),!0;case 4:return Ye.fn.call(Ye.context,H,j,be),!0;case 5:return Ye.fn.call(Ye.context,H,j,be,Ne),!0;case 6:return Ye.fn.call(Ye.context,H,j,be,Ne,V),!0}for(wt=1,Rt=new Array(_t-1);wt<_t;wt++)Rt[wt-1]=arguments[wt];Ye.fn.apply(Ye.context,Rt)}else{var tt,lt=Ye.length;for(wt=0;wt<lt;wt++)switch(Ye[wt].once&&this.removeListener(N,Ye[wt].fn,void 0,!0),_t){case 1:Ye[wt].fn.call(Ye[wt].context);break;case 2:Ye[wt].fn.call(Ye[wt].context,H);break;case 3:Ye[wt].fn.call(Ye[wt].context,H,j);break;case 4:Ye[wt].fn.call(Ye[wt].context,H,j,be);break;default:if(!Rt)for(tt=1,Rt=new Array(_t-1);tt<_t;tt++)Rt[tt-1]=arguments[tt];Ye[wt].fn.apply(Ye[wt].context,Rt)}}return!0},O.prototype.on=function(N,H,j){return l(this,N,H,j,!1)},O.prototype.once=function(N,H,j){return l(this,N,H,j,!0)},O.prototype.removeListener=function(N,H,j,be){var Ne=y?y+N:N;if(!this._events[Ne])return this;if(!H)return m(this,Ne),this;var V=this._events[Ne];if(V.fn)V.fn===H&&(!be||V.once)&&(!j||V.context===j)&&m(this,Ne);else{for(var W=0,Ye=[],_t=V.length;W<_t;W++)(V[W].fn!==H||be&&!V[W].once||j&&V[W].context!==j)&&Ye.push(V[W]);Ye.length?this._events[Ne]=1===Ye.length?Ye[0]:Ye:m(this,Ne)}return this},O.prototype.removeAllListeners=function(N){var H;return N?this._events[H=y?y+N:N]&&m(this,H):(this._events=new M,this._eventsCount=0),this},O.prototype.off=O.prototype.removeListener,O.prototype.addListener=O.prototype.on,O.prefixed=y,O.EventEmitter=O,ne.exports=O},14563:(ne,L,y)=>{"use strict";y.d(L,{Ib:()=>M,WT:()=>_,FD:()=>l});var M=1e-6,_="undefined"!=typeof Float32Array?Float32Array:Array,l=Math.random;Math,Math.hypot||(Math.hypot=function(){for(var H=0,j=arguments.length;j--;)H+=arguments[j]*arguments[j];return Math.sqrt(H)})},30651:(ne,L,y)=>{"use strict";y.r(L),y.d(L,{create:()=>_,clone:()=>l,copy:()=>m,fromValues:()=>O,set:()=>R,identity:()=>N,transpose:()=>H,invert:()=>j,adjoint:()=>be,determinant:()=>Ne,multiply:()=>V,translate:()=>W,scale:()=>Ye,rotate:()=>_t,rotateX:()=>Rt,rotateY:()=>wt,rotateZ:()=>lt,fromTranslation:()=>tt,fromScaling:()=>Gt,fromRotation:()=>Q,fromXRotation:()=>Ut,fromYRotation:()=>ot,fromZRotation:()=>Ue,fromRotationTranslation:()=>ct,fromQuat2:()=>Xe,getTranslation:()=>Pt,getScaling:()=>kt,getRotation:()=>ut,fromRotationTranslationScale:()=>ir,fromRotationTranslationScaleOrigin:()=>le,fromQuat:()=>ce,frustum:()=>ae,perspectiveNO:()=>me,perspective:()=>Ie,perspectiveZO:()=>je,perspectiveFromFieldOfView:()=>gt,orthoNO:()=>xr,ortho:()=>Fr,orthoZO:()=>cn,lookAt:()=>Ir,targetTo:()=>Ot,str:()=>Le,frob:()=>we,add:()=>at,subtract:()=>Re,multiplyScalar:()=>qt,multiplyScalarAndAdd:()=>Pr,exactEquals:()=>er,equals:()=>hr,mul:()=>Nr,sub:()=>$r});var M=y(14563);function _(){var C=new M.WT(16);return M.WT!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function l(C){var Y=new M.WT(16);return Y[0]=C[0],Y[1]=C[1],Y[2]=C[2],Y[3]=C[3],Y[4]=C[4],Y[5]=C[5],Y[6]=C[6],Y[7]=C[7],Y[8]=C[8],Y[9]=C[9],Y[10]=C[10],Y[11]=C[11],Y[12]=C[12],Y[13]=C[13],Y[14]=C[14],Y[15]=C[15],Y}function m(C,Y){return C[0]=Y[0],C[1]=Y[1],C[2]=Y[2],C[3]=Y[3],C[4]=Y[4],C[5]=Y[5],C[6]=Y[6],C[7]=Y[7],C[8]=Y[8],C[9]=Y[9],C[10]=Y[10],C[11]=Y[11],C[12]=Y[12],C[13]=Y[13],C[14]=Y[14],C[15]=Y[15],C}function O(C,Y,Ge,nt,xt,Dt,Z,Ze,Et,Mt,Jt,Tr,mr,Yt,gr,sr){var dr=new M.WT(16);return dr[0]=C,dr[1]=Y,dr[2]=Ge,dr[3]=nt,dr[4]=xt,dr[5]=Dt,dr[6]=Z,dr[7]=Ze,dr[8]=Et,dr[9]=Mt,dr[10]=Jt,dr[11]=Tr,dr[12]=mr,dr[13]=Yt,dr[14]=gr,dr[15]=sr,dr}function R(C,Y,Ge,nt,xt,Dt,Z,Ze,Et,Mt,Jt,Tr,mr,Yt,gr,sr,dr){return C[0]=Y,C[1]=Ge,C[2]=nt,C[3]=xt,C[4]=Dt,C[5]=Z,C[6]=Ze,C[7]=Et,C[8]=Mt,C[9]=Jt,C[10]=Tr,C[11]=mr,C[12]=Yt,C[13]=gr,C[14]=sr,C[15]=dr,C}function N(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function H(C,Y){if(C===Y){var Ge=Y[1],nt=Y[2],xt=Y[3],Dt=Y[6],Z=Y[7],Ze=Y[11];C[1]=Y[4],C[2]=Y[8],C[3]=Y[12],C[4]=Ge,C[6]=Y[9],C[7]=Y[13],C[8]=nt,C[9]=Dt,C[11]=Y[14],C[12]=xt,C[13]=Z,C[14]=Ze}else C[0]=Y[0],C[1]=Y[4],C[2]=Y[8],C[3]=Y[12],C[4]=Y[1],C[5]=Y[5],C[6]=Y[9],C[7]=Y[13],C[8]=Y[2],C[9]=Y[6],C[10]=Y[10],C[11]=Y[14],C[12]=Y[3],C[13]=Y[7],C[14]=Y[11],C[15]=Y[15];return C}function j(C,Y){var Ge=Y[0],nt=Y[1],xt=Y[2],Dt=Y[3],Z=Y[4],Ze=Y[5],Et=Y[6],Mt=Y[7],Jt=Y[8],Tr=Y[9],mr=Y[10],Yt=Y[11],gr=Y[12],sr=Y[13],dr=Y[14],mn=Y[15],On=Ge*Ze-nt*Z,mi=Ge*Et-xt*Z,hi=Ge*Mt-Dt*Z,si=nt*Et-xt*Ze,ai=nt*Mt-Dt*Ze,Yi=xt*Mt-Dt*Et,Pi=Jt*sr-Tr*gr,Ei=Jt*dr-mr*gr,re=Jt*mn-Yt*gr,ve=Tr*dr-mr*sr,_e=Tr*mn-Yt*sr,G=mr*mn-Yt*dr,oe=On*G-mi*_e+hi*ve+si*re-ai*Ei+Yi*Pi;return oe?(C[0]=(Ze*G-Et*_e+Mt*ve)*(oe=1/oe),C[1]=(xt*_e-nt*G-Dt*ve)*oe,C[2]=(sr*Yi-dr*ai+mn*si)*oe,C[3]=(mr*ai-Tr*Yi-Yt*si)*oe,C[4]=(Et*re-Z*G-Mt*Ei)*oe,C[5]=(Ge*G-xt*re+Dt*Ei)*oe,C[6]=(dr*hi-gr*Yi-mn*mi)*oe,C[7]=(Jt*Yi-mr*hi+Yt*mi)*oe,C[8]=(Z*_e-Ze*re+Mt*Pi)*oe,C[9]=(nt*re-Ge*_e-Dt*Pi)*oe,C[10]=(gr*ai-sr*hi+mn*On)*oe,C[11]=(Tr*hi-Jt*ai-Yt*On)*oe,C[12]=(Ze*Ei-Z*ve-Et*Pi)*oe,C[13]=(Ge*ve-nt*Ei+xt*Pi)*oe,C[14]=(sr*mi-gr*si-dr*On)*oe,C[15]=(Jt*si-Tr*mi+mr*On)*oe,C):null}function be(C,Y){var Ge=Y[0],nt=Y[1],xt=Y[2],Dt=Y[3],Z=Y[4],Ze=Y[5],Et=Y[6],Mt=Y[7],Jt=Y[8],Tr=Y[9],mr=Y[10],Yt=Y[11],gr=Y[12],sr=Y[13],dr=Y[14],mn=Y[15];return C[0]=Ze*(mr*mn-Yt*dr)-Tr*(Et*mn-Mt*dr)+sr*(Et*Yt-Mt*mr),C[1]=-(nt*(mr*mn-Yt*dr)-Tr*(xt*mn-Dt*dr)+sr*(xt*Yt-Dt*mr)),C[2]=nt*(Et*mn-Mt*dr)-Ze*(xt*mn-Dt*dr)+sr*(xt*Mt-Dt*Et),C[3]=-(nt*(Et*Yt-Mt*mr)-Ze*(xt*Yt-Dt*mr)+Tr*(xt*Mt-Dt*Et)),C[4]=-(Z*(mr*mn-Yt*dr)-Jt*(Et*mn-Mt*dr)+gr*(Et*Yt-Mt*mr)),C[5]=Ge*(mr*mn-Yt*dr)-Jt*(xt*mn-Dt*dr)+gr*(xt*Yt-Dt*mr),C[6]=-(Ge*(Et*mn-Mt*dr)-Z*(xt*mn-Dt*dr)+gr*(xt*Mt-Dt*Et)),C[7]=Ge*(Et*Yt-Mt*mr)-Z*(xt*Yt-Dt*mr)+Jt*(xt*Mt-Dt*Et),C[8]=Z*(Tr*mn-Yt*sr)-Jt*(Ze*mn-Mt*sr)+gr*(Ze*Yt-Mt*Tr),C[9]=-(Ge*(Tr*mn-Yt*sr)-Jt*(nt*mn-Dt*sr)+gr*(nt*Yt-Dt*Tr)),C[10]=Ge*(Ze*mn-Mt*sr)-Z*(nt*mn-Dt*sr)+gr*(nt*Mt-Dt*Ze),C[11]=-(Ge*(Ze*Yt-Mt*Tr)-Z*(nt*Yt-Dt*Tr)+Jt*(nt*Mt-Dt*Ze)),C[12]=-(Z*(Tr*dr-mr*sr)-Jt*(Ze*dr-Et*sr)+gr*(Ze*mr-Et*Tr)),C[13]=Ge*(Tr*dr-mr*sr)-Jt*(nt*dr-xt*sr)+gr*(nt*mr-xt*Tr),C[14]=-(Ge*(Ze*dr-Et*sr)-Z*(nt*dr-xt*sr)+gr*(nt*Et-xt*Ze)),C[15]=Ge*(Ze*mr-Et*Tr)-Z*(nt*mr-xt*Tr)+Jt*(nt*Et-xt*Ze),C}function Ne(C){var Y=C[0],Ge=C[1],nt=C[2],xt=C[3],Dt=C[4],Z=C[5],Ze=C[6],Et=C[7],Mt=C[8],Jt=C[9],Tr=C[10],mr=C[11],Yt=C[12],gr=C[13],sr=C[14],dr=C[15];return(Y*Z-Ge*Dt)*(Tr*dr-mr*sr)-(Y*Ze-nt*Dt)*(Jt*dr-mr*gr)+(Y*Et-xt*Dt)*(Jt*sr-Tr*gr)+(Ge*Ze-nt*Z)*(Mt*dr-mr*Yt)-(Ge*Et-xt*Z)*(Mt*sr-Tr*Yt)+(nt*Et-xt*Ze)*(Mt*gr-Jt*Yt)}function V(C,Y,Ge){var nt=Y[0],xt=Y[1],Dt=Y[2],Z=Y[3],Ze=Y[4],Et=Y[5],Mt=Y[6],Jt=Y[7],Tr=Y[8],mr=Y[9],Yt=Y[10],gr=Y[11],sr=Y[12],dr=Y[13],mn=Y[14],On=Y[15],mi=Ge[0],hi=Ge[1],si=Ge[2],ai=Ge[3];return C[0]=mi*nt+hi*Ze+si*Tr+ai*sr,C[1]=mi*xt+hi*Et+si*mr+ai*dr,C[2]=mi*Dt+hi*Mt+si*Yt+ai*mn,C[3]=mi*Z+hi*Jt+si*gr+ai*On,C[4]=(mi=Ge[4])*nt+(hi=Ge[5])*Ze+(si=Ge[6])*Tr+(ai=Ge[7])*sr,C[5]=mi*xt+hi*Et+si*mr+ai*dr,C[6]=mi*Dt+hi*Mt+si*Yt+ai*mn,C[7]=mi*Z+hi*Jt+si*gr+ai*On,C[8]=(mi=Ge[8])*nt+(hi=Ge[9])*Ze+(si=Ge[10])*Tr+(ai=Ge[11])*sr,C[9]=mi*xt+hi*Et+si*mr+ai*dr,C[10]=mi*Dt+hi*Mt+si*Yt+ai*mn,C[11]=mi*Z+hi*Jt+si*gr+ai*On,C[12]=(mi=Ge[12])*nt+(hi=Ge[13])*Ze+(si=Ge[14])*Tr+(ai=Ge[15])*sr,C[13]=mi*xt+hi*Et+si*mr+ai*dr,C[14]=mi*Dt+hi*Mt+si*Yt+ai*mn,C[15]=mi*Z+hi*Jt+si*gr+ai*On,C}function W(C,Y,Ge){var Z,Ze,Et,Mt,Jt,Tr,mr,Yt,gr,sr,dr,mn,nt=Ge[0],xt=Ge[1],Dt=Ge[2];return Y===C?(C[12]=Y[0]*nt+Y[4]*xt+Y[8]*Dt+Y[12],C[13]=Y[1]*nt+Y[5]*xt+Y[9]*Dt+Y[13],C[14]=Y[2]*nt+Y[6]*xt+Y[10]*Dt+Y[14],C[15]=Y[3]*nt+Y[7]*xt+Y[11]*Dt+Y[15]):(Ze=Y[1],Et=Y[2],Mt=Y[3],Jt=Y[4],Tr=Y[5],mr=Y[6],Yt=Y[7],gr=Y[8],sr=Y[9],dr=Y[10],mn=Y[11],C[0]=Z=Y[0],C[1]=Ze,C[2]=Et,C[3]=Mt,C[4]=Jt,C[5]=Tr,C[6]=mr,C[7]=Yt,C[8]=gr,C[9]=sr,C[10]=dr,C[11]=mn,C[12]=Z*nt+Jt*xt+gr*Dt+Y[12],C[13]=Ze*nt+Tr*xt+sr*Dt+Y[13],C[14]=Et*nt+mr*xt+dr*Dt+Y[14],C[15]=Mt*nt+Yt*xt+mn*Dt+Y[15]),C}function Ye(C,Y,Ge){var nt=Ge[0],xt=Ge[1],Dt=Ge[2];return C[0]=Y[0]*nt,C[1]=Y[1]*nt,C[2]=Y[2]*nt,C[3]=Y[3]*nt,C[4]=Y[4]*xt,C[5]=Y[5]*xt,C[6]=Y[6]*xt,C[7]=Y[7]*xt,C[8]=Y[8]*Dt,C[9]=Y[9]*Dt,C[10]=Y[10]*Dt,C[11]=Y[11]*Dt,C[12]=Y[12],C[13]=Y[13],C[14]=Y[14],C[15]=Y[15],C}function _t(C,Y,Ge,nt){var Et,Mt,Jt,Tr,mr,Yt,gr,sr,dr,mn,On,mi,hi,si,ai,Yi,Pi,Ei,re,ve,_e,G,oe,xe,xt=nt[0],Dt=nt[1],Z=nt[2],Ze=Math.hypot(xt,Dt,Z);return Ze<M.Ib?null:(xt*=Ze=1/Ze,Dt*=Ze,Z*=Ze,Et=Math.sin(Ge),Mt=Math.cos(Ge),mr=Y[1],Yt=Y[2],gr=Y[3],dr=Y[5],mn=Y[6],On=Y[7],hi=Y[9],si=Y[10],ai=Y[11],re=xt*Dt*(Jt=1-Mt)-Z*Et,ve=Dt*Dt*Jt+Mt,_e=Z*Dt*Jt+xt*Et,G=xt*Z*Jt+Dt*Et,oe=Dt*Z*Jt-xt*Et,xe=Z*Z*Jt+Mt,C[0]=(Tr=Y[0])*(Yi=xt*xt*Jt+Mt)+(sr=Y[4])*(Pi=Dt*xt*Jt+Z*Et)+(mi=Y[8])*(Ei=Z*xt*Jt-Dt*Et),C[1]=mr*Yi+dr*Pi+hi*Ei,C[2]=Yt*Yi+mn*Pi+si*Ei,C[3]=gr*Yi+On*Pi+ai*Ei,C[4]=Tr*re+sr*ve+mi*_e,C[5]=mr*re+dr*ve+hi*_e,C[6]=Yt*re+mn*ve+si*_e,C[7]=gr*re+On*ve+ai*_e,C[8]=Tr*G+sr*oe+mi*xe,C[9]=mr*G+dr*oe+hi*xe,C[10]=Yt*G+mn*oe+si*xe,C[11]=gr*G+On*oe+ai*xe,Y!==C&&(C[12]=Y[12],C[13]=Y[13],C[14]=Y[14],C[15]=Y[15]),C)}function Rt(C,Y,Ge){var nt=Math.sin(Ge),xt=Math.cos(Ge),Dt=Y[4],Z=Y[5],Ze=Y[6],Et=Y[7],Mt=Y[8],Jt=Y[9],Tr=Y[10],mr=Y[11];return Y!==C&&(C[0]=Y[0],C[1]=Y[1],C[2]=Y[2],C[3]=Y[3],C[12]=Y[12],C[13]=Y[13],C[14]=Y[14],C[15]=Y[15]),C[4]=Dt*xt+Mt*nt,C[5]=Z*xt+Jt*nt,C[6]=Ze*xt+Tr*nt,C[7]=Et*xt+mr*nt,C[8]=Mt*xt-Dt*nt,C[9]=Jt*xt-Z*nt,C[10]=Tr*xt-Ze*nt,C[11]=mr*xt-Et*nt,C}function wt(C,Y,Ge){var nt=Math.sin(Ge),xt=Math.cos(Ge),Dt=Y[0],Z=Y[1],Ze=Y[2],Et=Y[3],Mt=Y[8],Jt=Y[9],Tr=Y[10],mr=Y[11];return Y!==C&&(C[4]=Y[4],C[5]=Y[5],C[6]=Y[6],C[7]=Y[7],C[12]=Y[12],C[13]=Y[13],C[14]=Y[14],C[15]=Y[15]),C[0]=Dt*xt-Mt*nt,C[1]=Z*xt-Jt*nt,C[2]=Ze*xt-Tr*nt,C[3]=Et*xt-mr*nt,C[8]=Dt*nt+Mt*xt,C[9]=Z*nt+Jt*xt,C[10]=Ze*nt+Tr*xt,C[11]=Et*nt+mr*xt,C}function lt(C,Y,Ge){var nt=Math.sin(Ge),xt=Math.cos(Ge),Dt=Y[0],Z=Y[1],Ze=Y[2],Et=Y[3],Mt=Y[4],Jt=Y[5],Tr=Y[6],mr=Y[7];return Y!==C&&(C[8]=Y[8],C[9]=Y[9],C[10]=Y[10],C[11]=Y[11],C[12]=Y[12],C[13]=Y[13],C[14]=Y[14],C[15]=Y[15]),C[0]=Dt*xt+Mt*nt,C[1]=Z*xt+Jt*nt,C[2]=Ze*xt+Tr*nt,C[3]=Et*xt+mr*nt,C[4]=Mt*xt-Dt*nt,C[5]=Jt*xt-Z*nt,C[6]=Tr*xt-Ze*nt,C[7]=mr*xt-Et*nt,C}function tt(C,Y){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=Y[0],C[13]=Y[1],C[14]=Y[2],C[15]=1,C}function Gt(C,Y){return C[0]=Y[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Y[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=Y[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Q(C,Y,Ge){var Ze,Et,Mt,nt=Ge[0],xt=Ge[1],Dt=Ge[2],Z=Math.hypot(nt,xt,Dt);return Z<M.Ib?null:(nt*=Z=1/Z,xt*=Z,Dt*=Z,Ze=Math.sin(Y),Et=Math.cos(Y),C[0]=nt*nt*(Mt=1-Et)+Et,C[1]=xt*nt*Mt+Dt*Ze,C[2]=Dt*nt*Mt-xt*Ze,C[3]=0,C[4]=nt*xt*Mt-Dt*Ze,C[5]=xt*xt*Mt+Et,C[6]=Dt*xt*Mt+nt*Ze,C[7]=0,C[8]=nt*Dt*Mt+xt*Ze,C[9]=xt*Dt*Mt-nt*Ze,C[10]=Dt*Dt*Mt+Et,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function Ut(C,Y){var Ge=Math.sin(Y),nt=Math.cos(Y);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=nt,C[6]=Ge,C[7]=0,C[8]=0,C[9]=-Ge,C[10]=nt,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ot(C,Y){var Ge=Math.sin(Y),nt=Math.cos(Y);return C[0]=nt,C[1]=0,C[2]=-Ge,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=Ge,C[9]=0,C[10]=nt,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ue(C,Y){var Ge=Math.sin(Y),nt=Math.cos(Y);return C[0]=nt,C[1]=Ge,C[2]=0,C[3]=0,C[4]=-Ge,C[5]=nt,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ct(C,Y,Ge){var nt=Y[0],xt=Y[1],Dt=Y[2],Z=Y[3],Ze=nt+nt,Et=xt+xt,Mt=Dt+Dt,Jt=nt*Ze,Tr=nt*Et,mr=nt*Mt,Yt=xt*Et,gr=xt*Mt,sr=Dt*Mt,dr=Z*Ze,mn=Z*Et,On=Z*Mt;return C[0]=1-(Yt+sr),C[1]=Tr+On,C[2]=mr-mn,C[3]=0,C[4]=Tr-On,C[5]=1-(Jt+sr),C[6]=gr+dr,C[7]=0,C[8]=mr+mn,C[9]=gr-dr,C[10]=1-(Jt+Yt),C[11]=0,C[12]=Ge[0],C[13]=Ge[1],C[14]=Ge[2],C[15]=1,C}function Xe(C,Y){var Ge=new M.WT(3),nt=-Y[0],xt=-Y[1],Dt=-Y[2],Z=Y[3],Ze=Y[4],Et=Y[5],Mt=Y[6],Jt=Y[7],Tr=nt*nt+xt*xt+Dt*Dt+Z*Z;return Tr>0?(Ge[0]=2*(Ze*Z+Jt*nt+Et*Dt-Mt*xt)/Tr,Ge[1]=2*(Et*Z+Jt*xt+Mt*nt-Ze*Dt)/Tr,Ge[2]=2*(Mt*Z+Jt*Dt+Ze*xt-Et*nt)/Tr):(Ge[0]=2*(Ze*Z+Jt*nt+Et*Dt-Mt*xt),Ge[1]=2*(Et*Z+Jt*xt+Mt*nt-Ze*Dt),Ge[2]=2*(Mt*Z+Jt*Dt+Ze*xt-Et*nt)),ct(C,Y,Ge),C}function Pt(C,Y){return C[0]=Y[12],C[1]=Y[13],C[2]=Y[14],C}function kt(C,Y){var Dt=Y[4],Z=Y[5],Ze=Y[6],Et=Y[8],Mt=Y[9],Jt=Y[10];return C[0]=Math.hypot(Y[0],Y[1],Y[2]),C[1]=Math.hypot(Dt,Z,Ze),C[2]=Math.hypot(Et,Mt,Jt),C}function ut(C,Y){var Ge=new M.WT(3);kt(Ge,Y);var nt=1/Ge[0],xt=1/Ge[1],Dt=1/Ge[2],Z=Y[0]*nt,Ze=Y[1]*xt,Et=Y[2]*Dt,Mt=Y[4]*nt,Jt=Y[5]*xt,Tr=Y[6]*Dt,mr=Y[8]*nt,Yt=Y[9]*xt,gr=Y[10]*Dt,sr=Z+Jt+gr,dr=0;return sr>0?(dr=2*Math.sqrt(sr+1),C[3]=.25*dr,C[0]=(Tr-Yt)/dr,C[1]=(mr-Et)/dr,C[2]=(Ze-Mt)/dr):Z>Jt&&Z>gr?(dr=2*Math.sqrt(1+Z-Jt-gr),C[3]=(Tr-Yt)/dr,C[0]=.25*dr,C[1]=(Ze+Mt)/dr,C[2]=(mr+Et)/dr):Jt>gr?(dr=2*Math.sqrt(1+Jt-Z-gr),C[3]=(mr-Et)/dr,C[0]=(Ze+Mt)/dr,C[1]=.25*dr,C[2]=(Tr+Yt)/dr):(dr=2*Math.sqrt(1+gr-Z-Jt),C[3]=(Ze-Mt)/dr,C[0]=(mr+Et)/dr,C[1]=(Tr+Yt)/dr,C[2]=.25*dr),C}function ir(C,Y,Ge,nt){var xt=Y[0],Dt=Y[1],Z=Y[2],Ze=Y[3],Et=xt+xt,Mt=Dt+Dt,Jt=Z+Z,Tr=xt*Et,mr=xt*Mt,Yt=xt*Jt,gr=Dt*Mt,sr=Dt*Jt,dr=Z*Jt,mn=Ze*Et,On=Ze*Mt,mi=Ze*Jt,hi=nt[0],si=nt[1],ai=nt[2];return C[0]=(1-(gr+dr))*hi,C[1]=(mr+mi)*hi,C[2]=(Yt-On)*hi,C[3]=0,C[4]=(mr-mi)*si,C[5]=(1-(Tr+dr))*si,C[6]=(sr+mn)*si,C[7]=0,C[8]=(Yt+On)*ai,C[9]=(sr-mn)*ai,C[10]=(1-(Tr+gr))*ai,C[11]=0,C[12]=Ge[0],C[13]=Ge[1],C[14]=Ge[2],C[15]=1,C}function le(C,Y,Ge,nt,xt){var Dt=Y[0],Z=Y[1],Ze=Y[2],Et=Y[3],Mt=Dt+Dt,Jt=Z+Z,Tr=Ze+Ze,mr=Dt*Mt,Yt=Dt*Jt,gr=Dt*Tr,sr=Z*Jt,dr=Z*Tr,mn=Ze*Tr,On=Et*Mt,mi=Et*Jt,hi=Et*Tr,si=nt[0],ai=nt[1],Yi=nt[2],Pi=xt[0],Ei=xt[1],re=xt[2],ve=(1-(sr+mn))*si,_e=(Yt+hi)*si,G=(gr-mi)*si,oe=(Yt-hi)*ai,xe=(1-(mr+mn))*ai,Oe=(dr+On)*ai,pe=(gr+mi)*Yi,Ae=(dr-On)*Yi,Tt=(1-(mr+sr))*Yi;return C[0]=ve,C[1]=_e,C[2]=G,C[3]=0,C[4]=oe,C[5]=xe,C[6]=Oe,C[7]=0,C[8]=pe,C[9]=Ae,C[10]=Tt,C[11]=0,C[12]=Ge[0]+Pi-(ve*Pi+oe*Ei+pe*re),C[13]=Ge[1]+Ei-(_e*Pi+xe*Ei+Ae*re),C[14]=Ge[2]+re-(G*Pi+Oe*Ei+Tt*re),C[15]=1,C}function ce(C,Y){var Ge=Y[0],nt=Y[1],xt=Y[2],Dt=Y[3],Z=Ge+Ge,Ze=nt+nt,Et=xt+xt,Mt=Ge*Z,Jt=nt*Z,Tr=nt*Ze,mr=xt*Z,Yt=xt*Ze,gr=xt*Et,sr=Dt*Z,dr=Dt*Ze,mn=Dt*Et;return C[0]=1-Tr-gr,C[1]=Jt+mn,C[2]=mr-dr,C[3]=0,C[4]=Jt-mn,C[5]=1-Mt-gr,C[6]=Yt+sr,C[7]=0,C[8]=mr+dr,C[9]=Yt-sr,C[10]=1-Mt-Tr,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ae(C,Y,Ge,nt,xt,Dt,Z){var Ze=1/(Ge-Y),Et=1/(xt-nt),Mt=1/(Dt-Z);return C[0]=2*Dt*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=2*Dt*Et,C[6]=0,C[7]=0,C[8]=(Ge+Y)*Ze,C[9]=(xt+nt)*Et,C[10]=(Z+Dt)*Mt,C[11]=-1,C[12]=0,C[13]=0,C[14]=Z*Dt*2*Mt,C[15]=0,C}function me(C,Y,Ge,nt,xt){var Z,Dt=1/Math.tan(Y/2);return C[0]=Dt/Ge,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Dt,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,null!=xt&&xt!==1/0?(C[10]=(xt+nt)*(Z=1/(nt-xt)),C[14]=2*xt*nt*Z):(C[10]=-1,C[14]=-2*nt),C}var Ie=me;function je(C,Y,Ge,nt,xt){var Z,Dt=1/Math.tan(Y/2);return C[0]=Dt/Ge,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Dt,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,null!=xt&&xt!==1/0?(C[10]=xt*(Z=1/(nt-xt)),C[14]=xt*nt*Z):(C[10]=-1,C[14]=-nt),C}function gt(C,Y,Ge,nt){var xt=Math.tan(Y.upDegrees*Math.PI/180),Dt=Math.tan(Y.downDegrees*Math.PI/180),Z=Math.tan(Y.leftDegrees*Math.PI/180),Ze=Math.tan(Y.rightDegrees*Math.PI/180),Et=2/(Z+Ze),Mt=2/(xt+Dt);return C[0]=Et,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Mt,C[6]=0,C[7]=0,C[8]=-(Z-Ze)*Et*.5,C[9]=(xt-Dt)*Mt*.5,C[10]=nt/(Ge-nt),C[11]=-1,C[12]=0,C[13]=0,C[14]=nt*Ge/(Ge-nt),C[15]=0,C}function xr(C,Y,Ge,nt,xt,Dt,Z){var Ze=1/(Y-Ge),Et=1/(nt-xt),Mt=1/(Dt-Z);return C[0]=-2*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Et,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*Mt,C[11]=0,C[12]=(Y+Ge)*Ze,C[13]=(xt+nt)*Et,C[14]=(Z+Dt)*Mt,C[15]=1,C}var Fr=xr;function cn(C,Y,Ge,nt,xt,Dt,Z){var Ze=1/(Y-Ge),Et=1/(nt-xt),Mt=1/(Dt-Z);return C[0]=-2*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*Et,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=Mt,C[11]=0,C[12]=(Y+Ge)*Ze,C[13]=(xt+nt)*Et,C[14]=Dt*Mt,C[15]=1,C}function Ir(C,Y,Ge,nt){var xt,Dt,Z,Ze,Et,Mt,Jt,Tr,mr,Yt,gr=Y[0],sr=Y[1],dr=Y[2],mn=nt[0],On=nt[1],mi=nt[2],hi=Ge[0],si=Ge[1],ai=Ge[2];return Math.abs(gr-hi)<M.Ib&&Math.abs(sr-si)<M.Ib&&Math.abs(dr-ai)<M.Ib?N(C):(Jt=gr-hi,Tr=sr-si,mr=dr-ai,xt=On*(mr*=Yt=1/Math.hypot(Jt,Tr,mr))-mi*(Tr*=Yt),Dt=mi*(Jt*=Yt)-mn*mr,Z=mn*Tr-On*Jt,(Yt=Math.hypot(xt,Dt,Z))?(xt*=Yt=1/Yt,Dt*=Yt,Z*=Yt):(xt=0,Dt=0,Z=0),Ze=Tr*Z-mr*Dt,Et=mr*xt-Jt*Z,Mt=Jt*Dt-Tr*xt,(Yt=Math.hypot(Ze,Et,Mt))?(Ze*=Yt=1/Yt,Et*=Yt,Mt*=Yt):(Ze=0,Et=0,Mt=0),C[0]=xt,C[1]=Ze,C[2]=Jt,C[3]=0,C[4]=Dt,C[5]=Et,C[6]=Tr,C[7]=0,C[8]=Z,C[9]=Mt,C[10]=mr,C[11]=0,C[12]=-(xt*gr+Dt*sr+Z*dr),C[13]=-(Ze*gr+Et*sr+Mt*dr),C[14]=-(Jt*gr+Tr*sr+mr*dr),C[15]=1,C)}function Ot(C,Y,Ge,nt){var xt=Y[0],Dt=Y[1],Z=Y[2],Ze=nt[0],Et=nt[1],Mt=nt[2],Jt=xt-Ge[0],Tr=Dt-Ge[1],mr=Z-Ge[2],Yt=Jt*Jt+Tr*Tr+mr*mr;Yt>0&&(Jt*=Yt=1/Math.sqrt(Yt),Tr*=Yt,mr*=Yt);var gr=Et*mr-Mt*Tr,sr=Mt*Jt-Ze*mr,dr=Ze*Tr-Et*Jt;return(Yt=gr*gr+sr*sr+dr*dr)>0&&(gr*=Yt=1/Math.sqrt(Yt),sr*=Yt,dr*=Yt),C[0]=gr,C[1]=sr,C[2]=dr,C[3]=0,C[4]=Tr*dr-mr*sr,C[5]=mr*gr-Jt*dr,C[6]=Jt*sr-Tr*gr,C[7]=0,C[8]=Jt,C[9]=Tr,C[10]=mr,C[11]=0,C[12]=xt,C[13]=Dt,C[14]=Z,C[15]=1,C}function Le(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function we(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])}function at(C,Y,Ge){return C[0]=Y[0]+Ge[0],C[1]=Y[1]+Ge[1],C[2]=Y[2]+Ge[2],C[3]=Y[3]+Ge[3],C[4]=Y[4]+Ge[4],C[5]=Y[5]+Ge[5],C[6]=Y[6]+Ge[6],C[7]=Y[7]+Ge[7],C[8]=Y[8]+Ge[8],C[9]=Y[9]+Ge[9],C[10]=Y[10]+Ge[10],C[11]=Y[11]+Ge[11],C[12]=Y[12]+Ge[12],C[13]=Y[13]+Ge[13],C[14]=Y[14]+Ge[14],C[15]=Y[15]+Ge[15],C}function Re(C,Y,Ge){return C[0]=Y[0]-Ge[0],C[1]=Y[1]-Ge[1],C[2]=Y[2]-Ge[2],C[3]=Y[3]-Ge[3],C[4]=Y[4]-Ge[4],C[5]=Y[5]-Ge[5],C[6]=Y[6]-Ge[6],C[7]=Y[7]-Ge[7],C[8]=Y[8]-Ge[8],C[9]=Y[9]-Ge[9],C[10]=Y[10]-Ge[10],C[11]=Y[11]-Ge[11],C[12]=Y[12]-Ge[12],C[13]=Y[13]-Ge[13],C[14]=Y[14]-Ge[14],C[15]=Y[15]-Ge[15],C}function qt(C,Y,Ge){return C[0]=Y[0]*Ge,C[1]=Y[1]*Ge,C[2]=Y[2]*Ge,C[3]=Y[3]*Ge,C[4]=Y[4]*Ge,C[5]=Y[5]*Ge,C[6]=Y[6]*Ge,C[7]=Y[7]*Ge,C[8]=Y[8]*Ge,C[9]=Y[9]*Ge,C[10]=Y[10]*Ge,C[11]=Y[11]*Ge,C[12]=Y[12]*Ge,C[13]=Y[13]*Ge,C[14]=Y[14]*Ge,C[15]=Y[15]*Ge,C}function Pr(C,Y,Ge,nt){return C[0]=Y[0]+Ge[0]*nt,C[1]=Y[1]+Ge[1]*nt,C[2]=Y[2]+Ge[2]*nt,C[3]=Y[3]+Ge[3]*nt,C[4]=Y[4]+Ge[4]*nt,C[5]=Y[5]+Ge[5]*nt,C[6]=Y[6]+Ge[6]*nt,C[7]=Y[7]+Ge[7]*nt,C[8]=Y[8]+Ge[8]*nt,C[9]=Y[9]+Ge[9]*nt,C[10]=Y[10]+Ge[10]*nt,C[11]=Y[11]+Ge[11]*nt,C[12]=Y[12]+Ge[12]*nt,C[13]=Y[13]+Ge[13]*nt,C[14]=Y[14]+Ge[14]*nt,C[15]=Y[15]+Ge[15]*nt,C}function er(C,Y){return C[0]===Y[0]&&C[1]===Y[1]&&C[2]===Y[2]&&C[3]===Y[3]&&C[4]===Y[4]&&C[5]===Y[5]&&C[6]===Y[6]&&C[7]===Y[7]&&C[8]===Y[8]&&C[9]===Y[9]&&C[10]===Y[10]&&C[11]===Y[11]&&C[12]===Y[12]&&C[13]===Y[13]&&C[14]===Y[14]&&C[15]===Y[15]}function hr(C,Y){var Ge=C[0],nt=C[1],xt=C[2],Dt=C[3],Z=C[4],Ze=C[5],Et=C[6],Mt=C[7],Jt=C[8],Tr=C[9],mr=C[10],Yt=C[11],gr=C[12],sr=C[13],dr=C[14],mn=C[15],On=Y[0],mi=Y[1],hi=Y[2],si=Y[3],ai=Y[4],Yi=Y[5],Pi=Y[6],Ei=Y[7],re=Y[8],ve=Y[9],_e=Y[10],G=Y[11],oe=Y[12],xe=Y[13],Oe=Y[14],pe=Y[15];return Math.abs(Ge-On)<=M.Ib*Math.max(1,Math.abs(Ge),Math.abs(On))&&Math.abs(nt-mi)<=M.Ib*Math.max(1,Math.abs(nt),Math.abs(mi))&&Math.abs(xt-hi)<=M.Ib*Math.max(1,Math.abs(xt),Math.abs(hi))&&Math.abs(Dt-si)<=M.Ib*Math.max(1,Math.abs(Dt),Math.abs(si))&&Math.abs(Z-ai)<=M.Ib*Math.max(1,Math.abs(Z),Math.abs(ai))&&Math.abs(Ze-Yi)<=M.Ib*Math.max(1,Math.abs(Ze),Math.abs(Yi))&&Math.abs(Et-Pi)<=M.Ib*Math.max(1,Math.abs(Et),Math.abs(Pi))&&Math.abs(Mt-Ei)<=M.Ib*Math.max(1,Math.abs(Mt),Math.abs(Ei))&&Math.abs(Jt-re)<=M.Ib*Math.max(1,Math.abs(Jt),Math.abs(re))&&Math.abs(Tr-ve)<=M.Ib*Math.max(1,Math.abs(Tr),Math.abs(ve))&&Math.abs(mr-_e)<=M.Ib*Math.max(1,Math.abs(mr),Math.abs(_e))&&Math.abs(Yt-G)<=M.Ib*Math.max(1,Math.abs(Yt),Math.abs(G))&&Math.abs(gr-oe)<=M.Ib*Math.max(1,Math.abs(gr),Math.abs(oe))&&Math.abs(sr-xe)<=M.Ib*Math.max(1,Math.abs(sr),Math.abs(xe))&&Math.abs(dr-Oe)<=M.Ib*Math.max(1,Math.abs(dr),Math.abs(Oe))&&Math.abs(mn-pe)<=M.Ib*Math.max(1,Math.abs(mn),Math.abs(pe))}var Nr=V,$r=Re},58623:(ne,L,y)=>{"use strict";y.d(L,{Ue:()=>_,al:()=>m,bA:()=>Rt,fF:()=>ut});var M=y(14563);function _(){var Le=new M.WT(4);return M.WT!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0,Le[3]=0),Le}function m(Le,we,at,Re){var qt=new M.WT(4);return qt[0]=Le,qt[1]=we,qt[2]=at,qt[3]=Re,qt}function Rt(Le,we,at){return Le[0]=we[0]*at,Le[1]=we[1]*at,Le[2]=we[2]*at,Le[3]=we[3]*at,Le}function ut(Le,we,at){var Re=we[0],qt=we[1],Pr=we[2],er=we[3];return Le[0]=at[0]*Re+at[4]*qt+at[8]*Pr+at[12]*er,Le[1]=at[1]*Re+at[5]*qt+at[9]*Pr+at[13]*er,Le[2]=at[2]*Re+at[6]*qt+at[10]*Pr+at[14]*er,Le[3]=at[3]*Re+at[7]*qt+at[11]*Pr+at[15]*er,Le}_()},11524:(ne,L,y)=>{var M;!function(_,l,m,O){"use strict";var Rt,R=["","webkit","Moz","MS","ms","o"],N=l.createElement("div"),j=Math.round,be=Math.abs,Ne=Date.now;function V(Ee,Ve,St){return setTimeout(Gt(Ee,St),Ve)}function W(Ee,Ve,St){return!!Array.isArray(Ee)&&(Ye(Ee,St[Ve],St),!0)}function Ye(Ee,Ve,St){var or;if(Ee)if(Ee.forEach)Ee.forEach(Ve,St);else if(Ee.length!==O)for(or=0;or<Ee.length;)Ve.call(St,Ee[or],or,Ee),or++;else for(or in Ee)Ee.hasOwnProperty(or)&&Ve.call(St,Ee[or],or,Ee)}function _t(Ee,Ve,St){var or="DEPRECATED METHOD: "+Ve+"\n"+St+" AT \n";return function(){var Yr=new Error("get-stack-trace"),$n=Yr&&Yr.stack?Yr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",xi=_.console&&(_.console.warn||_.console.log);return xi&&xi.call(_.console,or,$n),Ee.apply(this,arguments)}}Rt="function"!=typeof Object.assign?function(Ve){if(Ve===O||null===Ve)throw new TypeError("Cannot convert undefined or null to object");for(var St=Object(Ve),or=1;or<arguments.length;or++){var Yr=arguments[or];if(Yr!==O&&null!==Yr)for(var $n in Yr)Yr.hasOwnProperty($n)&&(St[$n]=Yr[$n])}return St}:Object.assign;var wt=_t(function(Ve,St,or){for(var Yr=Object.keys(St),$n=0;$n<Yr.length;)(!or||or&&Ve[Yr[$n]]===O)&&(Ve[Yr[$n]]=St[Yr[$n]]),$n++;return Ve},"extend","Use `assign`."),lt=_t(function(Ve,St){return wt(Ve,St,!0)},"merge","Use `assign`.");function tt(Ee,Ve,St){var Yr,or=Ve.prototype;(Yr=Ee.prototype=Object.create(or)).constructor=Ee,Yr._super=or,St&&Rt(Yr,St)}function Gt(Ee,Ve){return function(){return Ee.apply(Ve,arguments)}}function Q(Ee,Ve){return"function"==typeof Ee?Ee.apply(Ve&&Ve[0]||O,Ve):Ee}function Ut(Ee,Ve){return Ee===O?Ve:Ee}function ot(Ee,Ve,St){Ye(Pt(Ve),function(or){Ee.addEventListener(or,St,!1)})}function Ue(Ee,Ve,St){Ye(Pt(Ve),function(or){Ee.removeEventListener(or,St,!1)})}function ct(Ee,Ve){for(;Ee;){if(Ee==Ve)return!0;Ee=Ee.parentNode}return!1}function Xe(Ee,Ve){return Ee.indexOf(Ve)>-1}function Pt(Ee){return Ee.trim().split(/\s+/g)}function kt(Ee,Ve,St){if(Ee.indexOf&&!St)return Ee.indexOf(Ve);for(var or=0;or<Ee.length;){if(St&&Ee[or][St]==Ve||!St&&Ee[or]===Ve)return or;or++}return-1}function ut(Ee){return Array.prototype.slice.call(Ee,0)}function ir(Ee,Ve,St){for(var or=[],Yr=[],$n=0;$n<Ee.length;){var xi=Ve?Ee[$n][Ve]:Ee[$n];kt(Yr,xi)<0&&or.push(Ee[$n]),Yr[$n]=xi,$n++}return St&&(or=Ve?or.sort(function(ro,co){return ro[Ve]>co[Ve]}):or.sort()),or}function le(Ee,Ve){for(var St,or,Yr=Ve[0].toUpperCase()+Ve.slice(1),$n=0;$n<R.length;){if((or=(St=R[$n])?St+Yr:Ve)in Ee)return or;$n++}return O}var ce=1;function me(Ee){var Ve=Ee.ownerDocument||Ee;return Ve.defaultView||Ve.parentWindow||_}var je="ontouchstart"in _,gt=le(_,"PointerEvent")!==O,xr=je&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Fr="touch",Ir="mouse",nt=["x","y"],xt=["clientX","clientY"];function Dt(Ee,Ve){var St=this;this.manager=Ee,this.callback=Ve,this.element=Ee.element,this.target=Ee.options.inputTarget,this.domHandler=function(or){Q(Ee.options.enable,[Ee])&&St.handler(or)},this.init()}function Ze(Ee,Ve,St){var or=St.pointers.length,Yr=St.changedPointers.length,$n=1&Ve&&or-Yr==0,xi=12&Ve&&or-Yr==0;St.isFirst=!!$n,St.isFinal=!!xi,$n&&(Ee.session={}),St.eventType=Ve,function(Ee,Ve){var St=Ee.session,or=Ve.pointers,Yr=or.length;St.firstInput||(St.firstInput=Tr(Ve)),Yr>1&&!St.firstMultiple?St.firstMultiple=Tr(Ve):1===Yr&&(St.firstMultiple=!1);var $n=St.firstInput,xi=St.firstMultiple,lo=xi?xi.center:$n.center,ro=Ve.center=mr(or);Ve.timeStamp=Ne(),Ve.deltaTime=Ve.timeStamp-$n.timeStamp,Ve.angle=dr(lo,ro),Ve.distance=sr(lo,ro),function(Ee,Ve){var St=Ve.center,or=Ee.offsetDelta||{},Yr=Ee.prevDelta||{},$n=Ee.prevInput||{};(1===Ve.eventType||4===$n.eventType)&&(Yr=Ee.prevDelta={x:$n.deltaX||0,y:$n.deltaY||0},or=Ee.offsetDelta={x:St.x,y:St.y}),Ve.deltaX=Yr.x+(St.x-or.x),Ve.deltaY=Yr.y+(St.y-or.y)}(St,Ve),Ve.offsetDirection=gr(Ve.deltaX,Ve.deltaY);var co=Yt(Ve.deltaTime,Ve.deltaX,Ve.deltaY);Ve.overallVelocityX=co.x,Ve.overallVelocityY=co.y,Ve.overallVelocity=be(co.x)>be(co.y)?co.x:co.y,Ve.scale=xi?function(Ee,Ve){return sr(Ve[0],Ve[1],xt)/sr(Ee[0],Ee[1],xt)}(xi.pointers,or):1,Ve.rotation=xi?function(Ee,Ve){return dr(Ve[1],Ve[0],xt)+dr(Ee[1],Ee[0],xt)}(xi.pointers,or):0,Ve.maxPointers=St.prevInput?Ve.pointers.length>St.prevInput.maxPointers?Ve.pointers.length:St.prevInput.maxPointers:Ve.pointers.length,function(Ee,Ve){var Yr,$n,xi,lo,St=Ee.lastInterval||Ve,or=Ve.timeStamp-St.timeStamp;if(8!=Ve.eventType&&(or>25||St.velocity===O)){var ro=Ve.deltaX-St.deltaX,co=Ve.deltaY-St.deltaY,ps=Yt(or,ro,co);$n=ps.x,xi=ps.y,Yr=be(ps.x)>be(ps.y)?ps.x:ps.y,lo=gr(ro,co),Ee.lastInterval=Ve}else Yr=St.velocity,$n=St.velocityX,xi=St.velocityY,lo=St.direction;Ve.velocity=Yr,Ve.velocityX=$n,Ve.velocityY=xi,Ve.direction=lo}(St,Ve);var ps=Ee.element;ct(Ve.srcEvent.target,ps)&&(ps=Ve.srcEvent.target),Ve.target=ps}(Ee,St),Ee.emit("hammer.input",St),Ee.recognize(St),Ee.session.prevInput=St}function Tr(Ee){for(var Ve=[],St=0;St<Ee.pointers.length;)Ve[St]={clientX:j(Ee.pointers[St].clientX),clientY:j(Ee.pointers[St].clientY)},St++;return{timeStamp:Ne(),pointers:Ve,center:mr(Ve),deltaX:Ee.deltaX,deltaY:Ee.deltaY}}function mr(Ee){var Ve=Ee.length;if(1===Ve)return{x:j(Ee[0].clientX),y:j(Ee[0].clientY)};for(var St=0,or=0,Yr=0;Yr<Ve;)St+=Ee[Yr].clientX,or+=Ee[Yr].clientY,Yr++;return{x:j(St/Ve),y:j(or/Ve)}}function Yt(Ee,Ve,St){return{x:Ve/Ee||0,y:St/Ee||0}}function gr(Ee,Ve){return Ee===Ve?1:be(Ee)>=be(Ve)?Ee<0?2:4:Ve<0?8:16}function sr(Ee,Ve,St){St||(St=nt);var or=Ve[St[0]]-Ee[St[0]],Yr=Ve[St[1]]-Ee[St[1]];return Math.sqrt(or*or+Yr*Yr)}function dr(Ee,Ve,St){return St||(St=nt),180*Math.atan2(Ve[St[1]]-Ee[St[1]],Ve[St[0]]-Ee[St[0]])/Math.PI}Dt.prototype={handler:function(){},init:function(){this.evEl&&ot(this.element,this.evEl,this.domHandler),this.evTarget&&ot(this.target,this.evTarget,this.domHandler),this.evWin&&ot(me(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ue(this.element,this.evEl,this.domHandler),this.evTarget&&Ue(this.target,this.evTarget,this.domHandler),this.evWin&&Ue(me(this.element),this.evWin,this.domHandler)}};var mi={mousedown:1,mousemove:2,mouseup:4},hi="mousedown",si="mousemove mouseup";function ai(){this.evEl=hi,this.evWin=si,this.pressed=!1,Dt.apply(this,arguments)}tt(ai,Dt,{handler:function(Ve){var St=mi[Ve.type];1&St&&0===Ve.button&&(this.pressed=!0),2&St&&1!==Ve.which&&(St=4),this.pressed&&(4&St&&(this.pressed=!1),this.callback(this.manager,St,{pointers:[Ve],changedPointers:[Ve],pointerType:Ir,srcEvent:Ve}))}});var Yi={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Pi={2:Fr,3:"pen",4:Ir,5:"kinect"},Ei="pointerdown",re="pointermove pointerup pointercancel";function ve(){this.evEl=Ei,this.evWin=re,Dt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}_.MSPointerEvent&&!_.PointerEvent&&(Ei="MSPointerDown",re="MSPointerMove MSPointerUp MSPointerCancel"),tt(ve,Dt,{handler:function(Ve){var St=this.store,or=!1,Yr=Ve.type.toLowerCase().replace("ms",""),$n=Yi[Yr],xi=Pi[Ve.pointerType]||Ve.pointerType,lo=xi==Fr,ro=kt(St,Ve.pointerId,"pointerId");1&$n&&(0===Ve.button||lo)?ro<0&&(St.push(Ve),ro=St.length-1):12&$n&&(or=!0),!(ro<0)&&(St[ro]=Ve,this.callback(this.manager,$n,{pointers:St,changedPointers:[Ve],pointerType:xi,srcEvent:Ve}),or&&St.splice(ro,1))}});var _e={touchstart:1,touchmove:2,touchend:4,touchcancel:8},G="touchstart",oe="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=G,this.evWin=oe,this.started=!1,Dt.apply(this,arguments)}function Oe(Ee,Ve){var St=ut(Ee.touches),or=ut(Ee.changedTouches);return 12&Ve&&(St=ir(St.concat(or),"identifier",!0)),[St,or]}tt(xe,Dt,{handler:function(Ve){var St=_e[Ve.type];if(1===St&&(this.started=!0),this.started){var or=Oe.call(this,Ve,St);12&St&&or[0].length-or[1].length==0&&(this.started=!1),this.callback(this.manager,St,{pointers:or[0],changedPointers:or[1],pointerType:Fr,srcEvent:Ve})}}});var pe={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Ae="touchstart touchmove touchend touchcancel";function Tt(){this.evTarget=Ae,this.targetIds={},Dt.apply(this,arguments)}function wr(Ee,Ve){var St=ut(Ee.touches),or=this.targetIds;if(3&Ve&&1===St.length)return or[St[0].identifier]=!0,[St,St];var Yr,$n,xi=ut(Ee.changedTouches),lo=[],ro=this.target;if($n=St.filter(function(co){return ct(co.target,ro)}),1===Ve)for(Yr=0;Yr<$n.length;)or[$n[Yr].identifier]=!0,Yr++;for(Yr=0;Yr<xi.length;)or[xi[Yr].identifier]&&lo.push(xi[Yr]),12&Ve&&delete or[xi[Yr].identifier],Yr++;return lo.length?[ir($n.concat(lo),"identifier",!0),lo]:void 0}function Br(){Dt.apply(this,arguments);var Ee=Gt(this.handler,this);this.touch=new Tt(this.manager,Ee),this.mouse=new ai(this.manager,Ee),this.primaryTouch=null,this.lastTouches=[]}function Rn(Ee,Ve){1&Ee?(this.primaryTouch=Ve.changedPointers[0].identifier,Pn.call(this,Ve)):12&Ee&&Pn.call(this,Ve)}function Pn(Ee){var Ve=Ee.changedPointers[0];if(Ve.identifier===this.primaryTouch){var St={x:Ve.clientX,y:Ve.clientY};this.lastTouches.push(St);var or=this.lastTouches;setTimeout(function(){var $n=or.indexOf(St);$n>-1&&or.splice($n,1)},2500)}}function rr(Ee){for(var Ve=Ee.srcEvent.clientX,St=Ee.srcEvent.clientY,or=0;or<this.lastTouches.length;or++){var Yr=this.lastTouches[or],$n=Math.abs(Ve-Yr.x),xi=Math.abs(St-Yr.y);if($n<=25&&xi<=25)return!0}return!1}tt(Tt,Dt,{handler:function(Ve){var St=pe[Ve.type],or=wr.call(this,Ve,St);!or||this.callback(this.manager,St,{pointers:or[0],changedPointers:or[1],pointerType:Fr,srcEvent:Ve})}}),tt(Br,Dt,{handler:function(Ve,St,or){var $n=or.pointerType==Ir;if(!($n&&or.sourceCapabilities&&or.sourceCapabilities.firesTouchEvents)){if(or.pointerType==Fr)Rn.call(this,St,or);else if($n&&rr.call(this,or))return;this.callback(Ve,St,or)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Sn=le(N.style,"touchAction"),an=Sn!==O,fn="compute",_n="manipulation",Oi="none",ta="pan-x",oi="pan-y",Ji=function(){if(!an)return!1;var Ee={},Ve=_.CSS&&_.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(St){Ee[St]=!Ve||_.CSS.supports("touch-action",St)}),Ee}();function ji(Ee,Ve){this.manager=Ee,this.set(Ve)}function Wi(Ee){this.options=Rt({},this.defaults,Ee||{}),this.id=ce++,this.manager=null,this.options.enable=Ut(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function va(Ee){return 16&Ee?"cancel":8&Ee?"end":4&Ee?"move":2&Ee?"start":""}function wu(Ee){return 16==Ee?"down":8==Ee?"up":2==Ee?"left":4==Ee?"right":""}function Da(Ee,Ve){var St=Ve.manager;return St?St.get(Ee):Ee}function qo(){Wi.apply(this,arguments)}function Bi(){qo.apply(this,arguments),this.pX=null,this.pY=null}function ra(){qo.apply(this,arguments)}function bo(){Wi.apply(this,arguments),this._timer=null,this._input=null}function ma(){qo.apply(this,arguments)}function vo(){qo.apply(this,arguments)}function Fo(){Wi.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ls(Ee,Ve){return(Ve=Ve||{}).recognizers=Ut(Ve.recognizers,Ls.defaults.preset),new Ma(Ee,Ve)}function Ma(Ee,Ve){this.options=Rt({},Ls.defaults,Ve||{}),this.options.inputTarget=this.options.inputTarget||Ee,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ee,this.input=function(Ee){return new(Ee.options.inputClass||(gt?ve:xr?Tt:je?Br:ai))(Ee,Ze)}(this),this.touchAction=new ji(this,this.options.touchAction),Ya(this,!0),Ye(this.options.recognizers,function(St){var or=this.add(new St[0](St[1]));St[2]&&or.recognizeWith(St[2]),St[3]&&or.requireFailure(St[3])},this)}function Ya(Ee,Ve){var or,St=Ee.element;St.style&&(Ye(Ee.options.cssProps,function(Yr,$n){or=le(St.style,$n),Ve?(Ee.oldCssProps[or]=St.style[or],St.style[or]=Yr):St.style[or]=Ee.oldCssProps[or]||""}),Ve||(Ee.oldCssProps={}))}ji.prototype={set:function(Ee){Ee==fn&&(Ee=this.compute()),an&&this.manager.element.style&&Ji[Ee]&&(this.manager.element.style[Sn]=Ee),this.actions=Ee.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ee=[];return Ye(this.manager.recognizers,function(Ve){Q(Ve.options.enable,[Ve])&&(Ee=Ee.concat(Ve.getTouchAction()))}),function(Ee){if(Xe(Ee,Oi))return Oi;var Ve=Xe(Ee,ta),St=Xe(Ee,oi);return Ve&&St?Oi:Ve||St?Ve?ta:oi:Xe(Ee,_n)?_n:"auto"}(Ee.join(" "))},preventDefaults:function(Ee){var Ve=Ee.srcEvent,St=Ee.offsetDirection;if(!this.manager.session.prevented){var or=this.actions,Yr=Xe(or,Oi)&&!Ji[Oi],$n=Xe(or,oi)&&!Ji[oi],xi=Xe(or,ta)&&!Ji[ta];if(Yr&&1===Ee.pointers.length&&Ee.distance<2&&Ee.deltaTime<250)return;return xi&&$n||!(Yr||$n&&6&St||xi&&24&St)?void 0:this.preventSrc(Ve)}Ve.preventDefault()},preventSrc:function(Ee){this.manager.session.prevented=!0,Ee.preventDefault()}},Wi.prototype={defaults:{},set:function(Ee){return Rt(this.options,Ee),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ee){if(W(Ee,"recognizeWith",this))return this;var Ve=this.simultaneous;return Ve[(Ee=Da(Ee,this)).id]||(Ve[Ee.id]=Ee,Ee.recognizeWith(this)),this},dropRecognizeWith:function(Ee){return W(Ee,"dropRecognizeWith",this)||(Ee=Da(Ee,this),delete this.simultaneous[Ee.id]),this},requireFailure:function(Ee){if(W(Ee,"requireFailure",this))return this;var Ve=this.requireFail;return-1===kt(Ve,Ee=Da(Ee,this))&&(Ve.push(Ee),Ee.requireFailure(this)),this},dropRequireFailure:function(Ee){if(W(Ee,"dropRequireFailure",this))return this;Ee=Da(Ee,this);var Ve=kt(this.requireFail,Ee);return Ve>-1&&this.requireFail.splice(Ve,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ee){return!!this.simultaneous[Ee.id]},emit:function(Ee){var Ve=this,St=this.state;function or(Yr){Ve.manager.emit(Yr,Ee)}St<8&&or(Ve.options.event+va(St)),or(Ve.options.event),Ee.additionalEvent&&or(Ee.additionalEvent),St>=8&&or(Ve.options.event+va(St))},tryEmit:function(Ee){if(this.canEmit())return this.emit(Ee);this.state=32},canEmit:function(){for(var Ee=0;Ee<this.requireFail.length;){if(!(33&this.requireFail[Ee].state))return!1;Ee++}return!0},recognize:function(Ee){var Ve=Rt({},Ee);if(!Q(this.options.enable,[this,Ve]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Ve),30&this.state&&this.tryEmit(Ve)},process:function(Ee){},getTouchAction:function(){},reset:function(){}},tt(qo,Wi,{defaults:{pointers:1},attrTest:function(Ee){var Ve=this.options.pointers;return 0===Ve||Ee.pointers.length===Ve},process:function(Ee){var Ve=this.state,St=Ee.eventType,or=6&Ve,Yr=this.attrTest(Ee);return or&&(8&St||!Yr)?16|Ve:or||Yr?4&St?8|Ve:2&Ve?4|Ve:2:32}}),tt(Bi,qo,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var Ee=this.options.direction,Ve=[];return 6&Ee&&Ve.push(oi),24&Ee&&Ve.push(ta),Ve},directionTest:function(Ee){var Ve=this.options,St=!0,or=Ee.distance,Yr=Ee.direction,$n=Ee.deltaX,xi=Ee.deltaY;return Yr&Ve.direction||(6&Ve.direction?(Yr=0===$n?1:$n<0?2:4,St=$n!=this.pX,or=Math.abs(Ee.deltaX)):(Yr=0===xi?1:xi<0?8:16,St=xi!=this.pY,or=Math.abs(Ee.deltaY))),Ee.direction=Yr,St&&or>Ve.threshold&&Yr&Ve.direction},attrTest:function(Ee){return qo.prototype.attrTest.call(this,Ee)&&(2&this.state||!(2&this.state)&&this.directionTest(Ee))},emit:function(Ee){this.pX=Ee.deltaX,this.pY=Ee.deltaY;var Ve=wu(Ee.direction);Ve&&(Ee.additionalEvent=this.options.event+Ve),this._super.emit.call(this,Ee)}}),tt(ra,qo,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Oi]},attrTest:function(Ee){return this._super.attrTest.call(this,Ee)&&(Math.abs(Ee.scale-1)>this.options.threshold||2&this.state)},emit:function(Ee){1!==Ee.scale&&(Ee.additionalEvent=this.options.event+(Ee.scale<1?"in":"out")),this._super.emit.call(this,Ee)}}),tt(bo,Wi,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Ee){var Ve=this.options,St=Ee.pointers.length===Ve.pointers,or=Ee.distance<Ve.threshold,Yr=Ee.deltaTime>Ve.time;if(this._input=Ee,!or||!St||12&Ee.eventType&&!Yr)this.reset();else if(1&Ee.eventType)this.reset(),this._timer=V(function(){this.state=8,this.tryEmit()},Ve.time,this);else if(4&Ee.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Ee){8===this.state&&(Ee&&4&Ee.eventType?this.manager.emit(this.options.event+"up",Ee):(this._input.timeStamp=Ne(),this.manager.emit(this.options.event,this._input)))}}),tt(ma,qo,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Oi]},attrTest:function(Ee){return this._super.attrTest.call(this,Ee)&&(Math.abs(Ee.rotation)>this.options.threshold||2&this.state)}}),tt(vo,qo,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Bi.prototype.getTouchAction.call(this)},attrTest:function(Ee){var St,Ve=this.options.direction;return 30&Ve?St=Ee.overallVelocity:6&Ve?St=Ee.overallVelocityX:24&Ve&&(St=Ee.overallVelocityY),this._super.attrTest.call(this,Ee)&&Ve&Ee.offsetDirection&&Ee.distance>this.options.threshold&&Ee.maxPointers==this.options.pointers&&be(St)>this.options.velocity&&4&Ee.eventType},emit:function(Ee){var Ve=wu(Ee.offsetDirection);Ve&&this.manager.emit(this.options.event+Ve,Ee),this.manager.emit(this.options.event,Ee)}}),tt(Fo,Wi,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[_n]},process:function(Ee){var Ve=this.options,St=Ee.pointers.length===Ve.pointers,or=Ee.distance<Ve.threshold,Yr=Ee.deltaTime<Ve.time;if(this.reset(),1&Ee.eventType&&0===this.count)return this.failTimeout();if(or&&Yr&&St){if(4!=Ee.eventType)return this.failTimeout();var $n=!this.pTime||Ee.timeStamp-this.pTime<Ve.interval,xi=!this.pCenter||sr(this.pCenter,Ee.center)<Ve.posThreshold;if(this.pTime=Ee.timeStamp,this.pCenter=Ee.center,xi&&$n?this.count+=1:this.count=1,this._input=Ee,0==this.count%Ve.taps)return this.hasRequireFailures()?(this._timer=V(function(){this.state=8,this.tryEmit()},Ve.interval,this),2):8}return 32},failTimeout:function(){return this._timer=V(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ls.VERSION="2.0.7",Ls.defaults={domEvents:!1,touchAction:fn,enable:!0,inputTarget:null,inputClass:null,preset:[[ma,{enable:!1}],[ra,{enable:!1},["rotate"]],[vo,{direction:6}],[Bi,{direction:6},["swipe"]],[Fo],[Fo,{event:"doubletap",taps:2},["tap"]],[bo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ma.prototype={set:function(Ee){return Rt(this.options,Ee),Ee.touchAction&&this.touchAction.update(),Ee.inputTarget&&(this.input.destroy(),this.input.target=Ee.inputTarget,this.input.init()),this},stop:function(Ee){this.session.stopped=Ee?2:1},recognize:function(Ee){var Ve=this.session;if(!Ve.stopped){this.touchAction.preventDefaults(Ee);var St,or=this.recognizers,Yr=Ve.curRecognizer;(!Yr||Yr&&8&Yr.state)&&(Yr=Ve.curRecognizer=null);for(var $n=0;$n<or.length;)St=or[$n],2===Ve.stopped||Yr&&St!=Yr&&!St.canRecognizeWith(Yr)?St.reset():St.recognize(Ee),!Yr&&14&St.state&&(Yr=Ve.curRecognizer=St),$n++}},get:function(Ee){if(Ee instanceof Wi)return Ee;for(var Ve=this.recognizers,St=0;St<Ve.length;St++)if(Ve[St].options.event==Ee)return Ve[St];return null},add:function(Ee){if(W(Ee,"add",this))return this;var Ve=this.get(Ee.options.event);return Ve&&this.remove(Ve),this.recognizers.push(Ee),Ee.manager=this,this.touchAction.update(),Ee},remove:function(Ee){if(W(Ee,"remove",this))return this;if(Ee=this.get(Ee)){var Ve=this.recognizers,St=kt(Ve,Ee);-1!==St&&(Ve.splice(St,1),this.touchAction.update())}return this},on:function(Ee,Ve){if(Ee!==O&&Ve!==O){var St=this.handlers;return Ye(Pt(Ee),function(or){St[or]=St[or]||[],St[or].push(Ve)}),this}},off:function(Ee,Ve){if(Ee!==O){var St=this.handlers;return Ye(Pt(Ee),function(or){Ve?St[or]&&St[or].splice(kt(St[or],Ve),1):delete St[or]}),this}},emit:function(Ee,Ve){this.options.domEvents&&function(Ee,Ve){var St=l.createEvent("Event");St.initEvent(Ee,!0,!0),St.gesture=Ve,Ve.target.dispatchEvent(St)}(Ee,Ve);var St=this.handlers[Ee]&&this.handlers[Ee].slice();if(St&&St.length){Ve.type=Ee,Ve.preventDefault=function(){Ve.srcEvent.preventDefault()};for(var or=0;or<St.length;)St[or](Ve),or++}},destroy:function(){this.element&&Ya(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},Rt(Ls,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ma,Input:Dt,TouchAction:ji,TouchInput:Tt,MouseInput:ai,PointerEventInput:ve,TouchMouseInput:Br,SingleTouchInput:xe,Recognizer:Wi,AttrRecognizer:qo,Tap:Fo,Pan:Bi,Swipe:vo,Pinch:ra,Rotate:ma,Press:bo,on:ot,off:Ue,each:Ye,merge:lt,extend:wt,assign:Rt,inherit:tt,bindFn:Gt,prefixed:le}),(void 0!==_?_:"undefined"!=typeof self?self:{}).Hammer=Ls,(M=function(){return Ls}.call(L,y,L,ne))!==O&&(ne.exports=M)}(window,document)},82469:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});var y=Symbol.for("INJECTION");function M(R,N,H,j){Object.defineProperty(R,N,{configurable:!0,enumerable:!0,get:function(){return j&&!Reflect.hasMetadata(y,this,N)&&Reflect.defineMetadata(y,H(),this,N),Reflect.hasMetadata(y,this,N)?Reflect.getMetadata(y,this,N):H()},set:function(V){Reflect.defineMetadata(y,V,this,N)}})}L.makePropertyInjectDecorator=function(R,N){return function(H){return function(j,be){M(j,be,function(){return R.get(H)},N)}}},L.makePropertyInjectNamedDecorator=function(R,N){return function(H,j){return function(be,Ne){M(be,Ne,function(){return R.getNamed(H,j)},N)}}},L.makePropertyInjectTaggedDecorator=function(R,N){return function(H,j,be){return function(Ne,V){M(Ne,V,function(){return R.getTagged(H,j,be)},N)}}},L.makePropertyMultiInjectDecorator=function(R,N){return function(H){return function(j,be){M(j,be,function(){return R.getAll(H)},N)}}}},43857:(ne,L,y)=>{"use strict";var _=y(82469);L.Z=function(m,O){return void 0===O&&(O=!0),{lazyInject:_.makePropertyInjectDecorator(m,O),lazyInjectNamed:_.makePropertyInjectNamedDecorator(m,O),lazyInjectTagged:_.makePropertyInjectTaggedDecorator(m,O),lazyMultiInject:_.makePropertyMultiInjectDecorator(m,O)}}},84848:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.tagProperty=L.tagParameter=L.decorate=void 0;var M=y(90640),_=y(7259);function O(j,be,Ne,V,W){var Ye={},_t="number"==typeof W,Rt=void 0!==W&&_t?W.toString():Ne;if(_t&&void 0!==Ne)throw new Error(M.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(j,be)&&(Ye=Reflect.getMetadata(j,be));var wt=Ye[Rt];if(Array.isArray(wt))for(var lt=0,tt=wt;lt<tt.length;lt++){var Gt=tt[lt];if(Gt.key===V.key)throw new Error(M.DUPLICATED_METADATA+" "+Gt.key.toString())}else wt=[];wt.push(V),Ye[Rt]=wt,Reflect.defineMetadata(j,Ye,be)}function R(j,be){Reflect.decorate(j,be)}function N(j,be){return function(Ne,V){be(Ne,V,j)}}L.tagParameter=function(j,be,Ne,V){O(_.TAGGED,j,be,V,Ne)},L.tagProperty=function(j,be,Ne){O(_.TAGGED_PROP,j.constructor,be,Ne)},L.decorate=function(j,be,Ne){"number"==typeof Ne?R([N(Ne,j)],be):"string"==typeof Ne?Reflect.decorate([j],be,Ne):R([j],be)}},53615:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.inject=L.LazyServiceIdentifer=void 0;var M=y(90640),_=y(7259),l=y(95839),m=y(84848),O=function(){function N(H){this._cb=H}return N.prototype.unwrap=function(){return this._cb()},N}();L.LazyServiceIdentifer=O,L.inject=function(N){return function(H,j,be){if(void 0===N)throw new Error(M.UNDEFINED_INJECT_ANNOTATION(H.name));var Ne=new l.Metadata(_.INJECT_TAG,N);"number"==typeof be?m.tagParameter(H,j,be,Ne):m.tagProperty(H,j,Ne)}}},57549:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.injectable=void 0;var M=y(90640),_=y(7259);L.injectable=function(){return function(m){if(Reflect.hasOwnMetadata(_.PARAM_TYPES,m))throw new Error(M.DUPLICATED_INJECTABLE_DECORATOR);var O=Reflect.getMetadata(_.DESIGN_PARAM_TYPES,m)||[];return Reflect.defineMetadata(_.PARAM_TYPES,O,m),m}}},42048:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.multiInject=void 0;var M=y(7259),_=y(95839),l=y(84848);L.multiInject=function(O){return function(R,N,H){var j=new _.Metadata(M.MULTI_INJECT_TAG,O);"number"==typeof H?l.tagParameter(R,N,H,j):l.tagProperty(R,N,j)}}},35546:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.named=void 0;var M=y(7259),_=y(95839),l=y(84848);L.named=function(O){return function(R,N,H){var j=new _.Metadata(M.NAMED_TAG,O);"number"==typeof H?l.tagParameter(R,N,H,j):l.tagProperty(R,N,j)}}},78098:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.optional=void 0;var M=y(7259),_=y(95839),l=y(84848);L.optional=function(){return function(O,R,N){var H=new _.Metadata(M.OPTIONAL_TAG,!0);"number"==typeof N?l.tagParameter(O,R,N,H):l.tagProperty(O,R,H)}}},18955:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.postConstruct=void 0;var M=y(90640),_=y(7259),l=y(95839);L.postConstruct=function(){return function(O,R,N){var H=new l.Metadata(_.POST_CONSTRUCT,R);if(Reflect.hasOwnMetadata(_.POST_CONSTRUCT,O.constructor))throw new Error(M.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(_.POST_CONSTRUCT,H,O.constructor)}}},43881:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.tagged=void 0;var M=y(95839),_=y(84848);L.tagged=function(m,O){return function(R,N,H){var j=new M.Metadata(m,O);"number"==typeof H?_.tagParameter(R,N,H,j):_.tagProperty(R,N,j)}}},91698:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.targetName=void 0;var M=y(7259),_=y(95839),l=y(84848);L.targetName=function(O){return function(R,N,H){var j=new _.Metadata(M.NAME_TAG,O);l.tagParameter(R,N,H,j)}}},14978:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.unmanaged=void 0;var M=y(7259),_=y(95839),l=y(84848);L.unmanaged=function(){return function(O,R,N){var H=new _.Metadata(M.UNMANAGED_TAG,!0);l.tagParameter(O,R,N,H)}}},31885:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Binding=void 0;var M=y(21785),_=y(16800),l=function(){function m(O,R){this.id=_.id(),this.activated=!1,this.serviceIdentifier=O,this.scope=R,this.type=M.BindingTypeEnum.Invalid,this.constraint=function(N){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return m.prototype.clone=function(){var O=new m(this.serviceIdentifier,this.scope);return O.activated=O.scope===M.BindingScopeEnum.Singleton&&this.activated,O.implementationType=this.implementationType,O.dynamicValue=this.dynamicValue,O.scope=this.scope,O.type=this.type,O.factory=this.factory,O.provider=this.provider,O.constraint=this.constraint,O.onActivation=this.onActivation,O.cache=this.cache,O},m}();L.Binding=l},54046:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingCount=void 0,L.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},90640:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.STACK_OVERFLOW=L.CIRCULAR_DEPENDENCY_IN_FACTORY=L.POST_CONSTRUCT_ERROR=L.MULTIPLE_POST_CONSTRUCT_METHODS=L.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=L.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=L.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=L.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=L.ARGUMENTS_LENGTH_MISMATCH=L.INVALID_DECORATOR_OPERATION=L.INVALID_TO_SELF_VALUE=L.INVALID_FUNCTION_BINDING=L.INVALID_MIDDLEWARE_RETURN=L.NO_MORE_SNAPSHOTS_AVAILABLE=L.INVALID_BINDING_TYPE=L.NOT_IMPLEMENTED=L.CIRCULAR_DEPENDENCY=L.UNDEFINED_INJECT_ANNOTATION=L.MISSING_INJECT_ANNOTATION=L.MISSING_INJECTABLE_ANNOTATION=L.NOT_REGISTERED=L.CANNOT_UNBIND=L.AMBIGUOUS_MATCH=L.KEY_NOT_FOUND=L.NULL_ARGUMENT=L.DUPLICATED_METADATA=L.DUPLICATED_INJECTABLE_DECORATOR=void 0,L.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",L.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",L.NULL_ARGUMENT="NULL argument",L.KEY_NOT_FOUND="Key Not Found",L.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",L.CANNOT_UNBIND="Could not unbind serviceIdentifier:",L.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",L.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",L.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",L.UNDEFINED_INJECT_ANNOTATION=function(m){return"@inject called with undefined this could mean that the class "+m+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},L.CIRCULAR_DEPENDENCY="Circular dependency found:",L.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",L.INVALID_BINDING_TYPE="Invalid binding type:",L.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",L.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",L.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",L.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",L.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",L.ARGUMENTS_LENGTH_MISMATCH=function(){for(var m=[],O=0;O<arguments.length;O++)m[O]=arguments[O];return"The number of constructor arguments in the derived class "+m[0]+" must be >= than the number of constructor arguments of its base class."},L.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",L.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",L.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",L.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",L.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",L.POST_CONSTRUCT_ERROR=function(){for(var m=[],O=0;O<arguments.length;O++)m[O]=arguments[O];return"@postConstruct error in class "+m[0]+": "+m[1]},L.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var m=[],O=0;O<arguments.length;O++)m[O]=arguments[O];return"It looks like there is a circular dependency in one of the '"+m[0]+"' bindings. Please investigate bindings withservice identifier '"+m[1]+"'."},L.STACK_OVERFLOW="Maximum call stack size exceeded"},21785:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.TargetTypeEnum=L.BindingTypeEnum=L.BindingScopeEnum=void 0,L.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"},L.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},L.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},7259:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.NON_CUSTOM_TAG_KEYS=L.POST_CONSTRUCT=L.DESIGN_PARAM_TYPES=L.PARAM_TYPES=L.TAGGED_PROP=L.TAGGED=L.MULTI_INJECT_TAG=L.INJECT_TAG=L.OPTIONAL_TAG=L.UNMANAGED_TAG=L.NAME_TAG=L.NAMED_TAG=void 0,L.NAMED_TAG="named",L.NAME_TAG="name",L.UNMANAGED_TAG="unmanaged",L.OPTIONAL_TAG="optional",L.INJECT_TAG="inject",L.MULTI_INJECT_TAG="multi_inject",L.TAGGED="inversify:tagged",L.TAGGED_PROP="inversify:tagged_props",L.PARAM_TYPES="inversify:paramtypes",L.DESIGN_PARAM_TYPES="design:paramtypes",L.POST_CONSTRUCT="post_construct",L.NON_CUSTOM_TAG_KEYS=[L.INJECT_TAG,L.MULTI_INJECT_TAG,L.NAME_TAG,L.UNMANAGED_TAG,L.NAMED_TAG,L.OPTIONAL_TAG]},93414:function(ne,L,y){"use strict";var M=this&&this.__awaiter||function(wt,lt,tt,Gt){return new(tt||(tt=Promise))(function(Ut,ot){function Ue(Pt){try{Xe(Gt.next(Pt))}catch(kt){ot(kt)}}function ct(Pt){try{Xe(Gt.throw(Pt))}catch(kt){ot(kt)}}function Xe(Pt){Pt.done?Ut(Pt.value):function(Ut){return Ut instanceof tt?Ut:new tt(function(ot){ot(Ut)})}(Pt.value).then(Ue,ct)}Xe((Gt=Gt.apply(wt,lt||[])).next())})},_=this&&this.__generator||function(wt,lt){var Gt,Q,Ut,ot,tt={label:0,sent:function(){if(1&Ut[0])throw Ut[1];return Ut[1]},trys:[],ops:[]};return ot={next:Ue(0),throw:Ue(1),return:Ue(2)},"function"==typeof Symbol&&(ot[Symbol.iterator]=function(){return this}),ot;function Ue(Xe){return function(Pt){return function(Xe){if(Gt)throw new TypeError("Generator is already executing.");for(;tt;)try{if(Gt=1,Q&&(Ut=2&Xe[0]?Q.return:Xe[0]?Q.throw||((Ut=Q.return)&&Ut.call(Q),0):Q.next)&&!(Ut=Ut.call(Q,Xe[1])).done)return Ut;switch(Q=0,Ut&&(Xe=[2&Xe[0],Ut.value]),Xe[0]){case 0:case 1:Ut=Xe;break;case 4:return tt.label++,{value:Xe[1],done:!1};case 5:tt.label++,Q=Xe[1],Xe=[0];continue;case 7:Xe=tt.ops.pop(),tt.trys.pop();continue;default:if(!(Ut=(Ut=tt.trys).length>0&&Ut[Ut.length-1])&&(6===Xe[0]||2===Xe[0])){tt=0;continue}if(3===Xe[0]&&(!Ut||Xe[1]>Ut[0]&&Xe[1]<Ut[3])){tt.label=Xe[1];break}if(6===Xe[0]&&tt.label<Ut[1]){tt.label=Ut[1],Ut=Xe;break}if(Ut&&tt.label<Ut[2]){tt.label=Ut[2],tt.ops.push(Xe);break}Ut[2]&&tt.ops.pop(),tt.trys.pop();continue}Xe=lt.call(wt,tt)}catch(Pt){Xe=[6,Pt],Q=0}finally{Gt=Ut=0}if(5&Xe[0])throw Xe[1];return{value:Xe[0]?Xe[1]:void 0,done:!0}}([Xe,Pt])}}},l=this&&this.__spreadArray||function(wt,lt){for(var tt=0,Gt=lt.length,Q=wt.length;tt<Gt;tt++,Q++)wt[Q]=lt[tt];return wt};Object.defineProperty(L,"__esModule",{value:!0}),L.Container=void 0;var m=y(31885),O=y(90640),R=y(21785),N=y(7259),H=y(28236),j=y(71256),be=y(2739),Ne=y(38809),V=y(16800),W=y(48736),Ye=y(8974),_t=y(22377),Rt=function(){function wt(lt){this._appliedMiddleware=[];var tt=lt||{};if("object"!=typeof tt)throw new Error(""+O.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===tt.defaultScope)tt.defaultScope=R.BindingScopeEnum.Transient;else if(tt.defaultScope!==R.BindingScopeEnum.Singleton&&tt.defaultScope!==R.BindingScopeEnum.Transient&&tt.defaultScope!==R.BindingScopeEnum.Request)throw new Error(""+O.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===tt.autoBindInjectable)tt.autoBindInjectable=!1;else if("boolean"!=typeof tt.autoBindInjectable)throw new Error(""+O.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===tt.skipBaseClassChecks)tt.skipBaseClassChecks=!1;else if("boolean"!=typeof tt.skipBaseClassChecks)throw new Error(""+O.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:tt.autoBindInjectable,defaultScope:tt.defaultScope,skipBaseClassChecks:tt.skipBaseClassChecks},this.id=V.id(),this._bindingDictionary=new _t.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new H.MetadataReader}return wt.merge=function(lt,tt){for(var Gt=[],Q=2;Q<arguments.length;Q++)Gt[Q-2]=arguments[Q];var Ut=new wt,ot=l([lt,tt],Gt).map(function(Xe){return j.getBindingDictionary(Xe)}),Ue=j.getBindingDictionary(Ut);function ct(Xe,Pt){Xe.traverse(function(kt,ut){ut.forEach(function(ir){Pt.add(ir.serviceIdentifier,ir.clone())})})}return ot.forEach(function(Xe){ct(Xe,Ue)}),Ut},wt.prototype.load=function(){for(var lt=[],tt=0;tt<arguments.length;tt++)lt[tt]=arguments[tt];for(var Gt=this._getContainerModuleHelpersFactory(),Q=0,Ut=lt;Q<Ut.length;Q++){var ot=Ut[Q],Ue=Gt(ot.id);ot.registry(Ue.bindFunction,Ue.unbindFunction,Ue.isboundFunction,Ue.rebindFunction)}},wt.prototype.loadAsync=function(){for(var lt=[],tt=0;tt<arguments.length;tt++)lt[tt]=arguments[tt];return M(this,void 0,void 0,function(){var Gt,Q,Ut,ot,Ue;return _(this,function(ct){switch(ct.label){case 0:Gt=this._getContainerModuleHelpersFactory(),Q=0,Ut=lt,ct.label=1;case 1:return Q<Ut.length?(Ue=Gt((ot=Ut[Q]).id),[4,ot.registry(Ue.bindFunction,Ue.unbindFunction,Ue.isboundFunction,Ue.rebindFunction)]):[3,4];case 2:ct.sent(),ct.label=3;case 3:return Q++,[3,1];case 4:return[2]}})})},wt.prototype.unload=function(){for(var lt=this,tt=[],Gt=0;Gt<arguments.length;Gt++)tt[Gt]=arguments[Gt];var Q=function(Ut){return function(ot){return ot.moduleId===Ut}};tt.forEach(function(Ut){var ot=Q(Ut.id);lt._bindingDictionary.removeByCondition(ot)})},wt.prototype.bind=function(lt){var Gt=new m.Binding(lt,this.options.defaultScope||R.BindingScopeEnum.Transient);return this._bindingDictionary.add(lt,Gt),new Ne.BindingToSyntax(Gt)},wt.prototype.rebind=function(lt){return this.unbind(lt),this.bind(lt)},wt.prototype.unbind=function(lt){try{this._bindingDictionary.remove(lt)}catch(tt){throw new Error(O.CANNOT_UNBIND+" "+W.getServiceIdentifierAsString(lt))}},wt.prototype.unbindAll=function(){this._bindingDictionary=new _t.Lookup},wt.prototype.isBound=function(lt){var tt=this._bindingDictionary.hasKey(lt);return!tt&&this.parent&&(tt=this.parent.isBound(lt)),tt},wt.prototype.isBoundNamed=function(lt,tt){return this.isBoundTagged(lt,N.NAMED_TAG,tt)},wt.prototype.isBoundTagged=function(lt,tt,Gt){var Q=!1;if(this._bindingDictionary.hasKey(lt)){var Ut=this._bindingDictionary.get(lt),ot=j.createMockRequest(this,lt,tt,Gt);Q=Ut.some(function(Ue){return Ue.constraint(ot)})}return!Q&&this.parent&&(Q=this.parent.isBoundTagged(lt,tt,Gt)),Q},wt.prototype.snapshot=function(){this._snapshots.push(Ye.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},wt.prototype.restore=function(){var lt=this._snapshots.pop();if(void 0===lt)throw new Error(O.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=lt.bindings,this._middleware=lt.middleware},wt.prototype.createChild=function(lt){var tt=new wt(lt||this.options);return tt.parent=this,tt},wt.prototype.applyMiddleware=function(){for(var lt=[],tt=0;tt<arguments.length;tt++)lt[tt]=arguments[tt];this._appliedMiddleware=this._appliedMiddleware.concat(lt);var Gt=this._middleware?this._middleware:this._planAndResolve();this._middleware=lt.reduce(function(Q,Ut){return Ut(Q)},Gt)},wt.prototype.applyCustomMetadataReader=function(lt){this._metadataReader=lt},wt.prototype.get=function(lt){return this._get(!1,!1,R.TargetTypeEnum.Variable,lt)},wt.prototype.getTagged=function(lt,tt,Gt){return this._get(!1,!1,R.TargetTypeEnum.Variable,lt,tt,Gt)},wt.prototype.getNamed=function(lt,tt){return this.getTagged(lt,N.NAMED_TAG,tt)},wt.prototype.getAll=function(lt){return this._get(!0,!0,R.TargetTypeEnum.Variable,lt)},wt.prototype.getAllTagged=function(lt,tt,Gt){return this._get(!1,!0,R.TargetTypeEnum.Variable,lt,tt,Gt)},wt.prototype.getAllNamed=function(lt,tt){return this.getAllTagged(lt,N.NAMED_TAG,tt)},wt.prototype.resolve=function(lt){var tt=this.createChild();return tt.bind(lt).toSelf(),this._appliedMiddleware.forEach(function(Gt){tt.applyMiddleware(Gt)}),tt.get(lt)},wt.prototype._getContainerModuleHelpersFactory=function(){var lt=this,tt=function(Ue,ct){Ue._binding.moduleId=ct},Gt=function(Ue){return function(ct){var Pt=lt.bind.bind(lt)(ct);return tt(Pt,Ue),Pt}},ot=function(Ue){return function(ct){var Pt=lt.rebind.bind(lt)(ct);return tt(Pt,Ue),Pt}};return function(Ue){return{bindFunction:Gt(Ue),isboundFunction:function(ct){return lt.isBound.bind(lt)(ct)},rebindFunction:ot(Ue),unbindFunction:function(ct){lt.unbind.bind(lt)(ct)}}}},wt.prototype._get=function(lt,tt,Gt,Q,Ut,ot){var Ue=null,ct={avoidConstraints:lt,contextInterceptor:function(Xe){return Xe},isMultiInject:tt,key:Ut,serviceIdentifier:Q,targetType:Gt,value:ot};if(this._middleware){if(null==(Ue=this._middleware(ct)))throw new Error(O.INVALID_MIDDLEWARE_RETURN)}else Ue=this._planAndResolve()(ct);return Ue},wt.prototype._planAndResolve=function(){var lt=this;return function(tt){var Gt=j.plan(lt._metadataReader,lt,tt.isMultiInject,tt.targetType,tt.serviceIdentifier,tt.key,tt.value,tt.avoidConstraints);return Gt=tt.contextInterceptor(Gt),be.resolve(Gt)}},wt}();L.Container=Rt},6070:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.AsyncContainerModule=L.ContainerModule=void 0;var M=y(16800);L.ContainerModule=function(O){this.id=M.id(),this.registry=O},L.AsyncContainerModule=function(O){this.id=M.id(),this.registry=O}},8974:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.ContainerSnapshot=void 0;var y=function(){function M(){}return M.of=function(_,l){var m=new M;return m.bindings=_,m.middleware=l,m},M}();L.ContainerSnapshot=y},22377:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Lookup=void 0;var M=y(90640),_=function(){function l(){this._map=new Map}return l.prototype.getMap=function(){return this._map},l.prototype.add=function(m,O){if(null==m)throw new Error(M.NULL_ARGUMENT);if(null==O)throw new Error(M.NULL_ARGUMENT);var R=this._map.get(m);void 0!==R?(R.push(O),this._map.set(m,R)):this._map.set(m,[O])},l.prototype.get=function(m){if(null==m)throw new Error(M.NULL_ARGUMENT);var O=this._map.get(m);if(void 0!==O)return O;throw new Error(M.KEY_NOT_FOUND)},l.prototype.remove=function(m){if(null==m)throw new Error(M.NULL_ARGUMENT);if(!this._map.delete(m))throw new Error(M.KEY_NOT_FOUND)},l.prototype.removeByCondition=function(m){var O=this;this._map.forEach(function(R,N){var H=R.filter(function(j){return!m(j)});H.length>0?O._map.set(N,H):O._map.delete(N)})},l.prototype.hasKey=function(m){if(null==m)throw new Error(M.NULL_ARGUMENT);return this._map.has(m)},l.prototype.clone=function(){var m=new l;return this._map.forEach(function(O,R){O.forEach(function(N){return m.add(R,N.clone())})}),m},l.prototype.traverse=function(m){this._map.forEach(function(O,R){m(R,O)})},l}();L.Lookup=_},15922:(ne,L,y)=>{"use strict";L.GW=L.zY=L.f3=L.b2=L.W2=void 0,y(7259);var l=y(93414);Object.defineProperty(L,"W2",{enumerable:!0,get:function(){return l.Container}});y(21785),y(6070);var R=y(57549);Object.defineProperty(L,"b2",{enumerable:!0,get:function(){return R.injectable}});y(43881),y(35546);var j=y(53615);Object.defineProperty(L,"f3",{enumerable:!0,get:function(){return j.inject}});y(78098),y(14978),y(42048),y(91698);var Ye=y(18955);Object.defineProperty(L,"zY",{enumerable:!0,get:function(){return Ye.postConstruct}});y(28236),y(16800);var wt=y(84848);Object.defineProperty(L,"GW",{enumerable:!0,get:function(){return wt.decorate}});y(9446),y(48736),y(85527)},68902:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Context=void 0;var M=y(16800),_=function(){function l(m){this.id=M.id(),this.container=m}return l.prototype.addPlan=function(m){this.plan=m},l.prototype.setCurrentRequest=function(m){this.currentRequest=m},l}();L.Context=_},95839:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Metadata=void 0;var M=y(7259),_=function(){function l(m,O){this.key=m,this.value=O}return l.prototype.toString=function(){return this.key===M.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},l}();L.Metadata=_},28236:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.MetadataReader=void 0;var M=y(7259),_=function(){function l(){}return l.prototype.getConstructorMetadata=function(m){return{compilerGeneratedMetadata:Reflect.getMetadata(M.PARAM_TYPES,m),userGeneratedMetadata:Reflect.getMetadata(M.TAGGED,m)||{}}},l.prototype.getPropertiesMetadata=function(m){return Reflect.getMetadata(M.TAGGED_PROP,m)||[]},l}();L.MetadataReader=_},96742:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Plan=void 0,L.Plan=function(_,l){this.parentContext=_,this.rootRequest=l}},71256:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.getBindingDictionary=L.createMockRequest=L.plan=void 0;var M=y(54046),_=y(90640),l=y(21785),m=y(7259),O=y(61674),R=y(48736),N=y(68902),H=y(95839),j=y(96742),be=y(64479),Ne=y(68779),V=y(56407);function W(Q){return Q._bindingDictionary}function _t(Q,Ut,ot,Ue,ct){var Pt,Xe=lt(ot.container,ct.serviceIdentifier);return Xe.length===M.BindingCount.NoBindingsAvailable&&ot.container.options.autoBindInjectable&&"function"==typeof ct.serviceIdentifier&&Q.getConstructorMetadata(ct.serviceIdentifier).compilerGeneratedMetadata&&(ot.container.bind(ct.serviceIdentifier).toSelf(),Xe=lt(ot.container,ct.serviceIdentifier)),Pt=Ut?Xe:Xe.filter(function(kt){var ut=new Ne.Request(kt.serviceIdentifier,ot,Ue,kt,ct);return kt.constraint(ut)}),function(Q,Ut,ot,Ue){switch(Ut.length){case M.BindingCount.NoBindingsAvailable:if(ot.isOptional())return Ut;var ct=R.getServiceIdentifierAsString(Q),Xe=_.NOT_REGISTERED;throw Xe+=R.listMetadataForTarget(ct,ot),Xe+=R.listRegisteredBindingsForServiceIdentifier(Ue,ct,lt),new Error(Xe);case M.BindingCount.OnlyOneBindingAvailable:if(!ot.isArray())return Ut;case M.BindingCount.MultipleBindingsAvailable:default:if(ot.isArray())return Ut;throw ct=R.getServiceIdentifierAsString(Q),Xe=_.AMBIGUOUS_MATCH+" "+ct,Xe+=R.listRegisteredBindingsForServiceIdentifier(Ue,ct,lt),new Error(Xe)}}(ct.serviceIdentifier,Pt,ct,ot.container),Pt}function wt(Q,Ut,ot,Ue,ct,Xe){var Pt,kt;if(null===ct){Pt=_t(Q,Ut,Ue,null,Xe),kt=new Ne.Request(ot,Ue,null,Pt,Xe);var ut=new j.Plan(Ue,kt);Ue.addPlan(ut)}else Pt=_t(Q,Ut,Ue,ct,Xe),kt=ct.addChildRequest(Xe.serviceIdentifier,Pt,Xe);Pt.forEach(function(ir){var le=null;if(Xe.isArray())le=kt.addChildRequest(ir.serviceIdentifier,ir,Xe);else{if(ir.cache)return;le=kt}if(ir.type===l.BindingTypeEnum.Instance&&null!==ir.implementationType){var ce=be.getDependencies(Q,ir.implementationType);if(!Ue.container.options.skipBaseClassChecks){var ae=be.getBaseClassDependencyCount(Q,ir.implementationType);if(ce.length<ae){var me=_.ARGUMENTS_LENGTH_MISMATCH(be.getFunctionName(ir.implementationType));throw new Error(me)}}ce.forEach(function(Ie){wt(Q,!1,Ie.serviceIdentifier,Ue,le,Ie)})}})}function lt(Q,Ut){var ot=[],Ue=W(Q);return Ue.hasKey(Ut)?ot=Ue.get(Ut):null!==Q.parent&&(ot=lt(Q.parent,Ut)),ot}L.getBindingDictionary=W,L.plan=function(Q,Ut,ot,Ue,ct,Xe,Pt,kt){void 0===kt&&(kt=!1);var ut=new N.Context(Ut),ir=function(Q,Ut,ot,Ue,ct,Xe){var kt=new H.Metadata(Q?m.MULTI_INJECT_TAG:m.INJECT_TAG,ot),ut=new V.Target(Ut,"",ot,kt);if(void 0!==ct){var ir=new H.Metadata(ct,Xe);ut.metadata.push(ir)}return ut}(ot,Ue,ct,0,Xe,Pt);try{return wt(Q,kt,ct,ut,null,ir),ut}catch(le){throw O.isStackOverflowExeption(le)&&ut.plan&&R.circularDependencyToException(ut.plan.rootRequest),le}},L.createMockRequest=function(Q,Ut,ot,Ue){var ct=new V.Target(l.TargetTypeEnum.Variable,"",Ut,new H.Metadata(ot,Ue)),Xe=new N.Context(Q);return new Ne.Request(Ut,Xe,null,[],ct)}},46872:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.QueryableString=void 0;var y=function(){function M(_){this.str=_}return M.prototype.startsWith=function(_){return 0===this.str.indexOf(_)},M.prototype.endsWith=function(_){var l,m=_.split("").reverse().join("");return l=this.str.split("").reverse().join(""),this.startsWith.call({str:l},m)},M.prototype.contains=function(_){return-1!==this.str.indexOf(_)},M.prototype.equals=function(_){return this.str===_},M.prototype.value=function(){return this.str},M}();L.QueryableString=y},64479:function(ne,L,y){"use strict";var M=this&&this.__spreadArray||function(_t,Rt){for(var wt=0,lt=Rt.length,tt=_t.length;wt<lt;wt++,tt++)_t[tt]=Rt[wt];return _t};Object.defineProperty(L,"__esModule",{value:!0}),L.getFunctionName=L.getBaseClassDependencyCount=L.getDependencies=void 0;var _=y(53615),l=y(90640),m=y(21785),O=y(7259),R=y(48736);Object.defineProperty(L,"getFunctionName",{enumerable:!0,get:function(){return R.getFunctionName}});var N=y(56407);function j(_t,Rt,wt,lt){var tt=_t.getConstructorMetadata(wt),Gt=tt.compilerGeneratedMetadata;if(void 0===Gt)throw new Error(l.MISSING_INJECTABLE_ANNOTATION+" "+Rt+".");var Ut=tt.userGeneratedMetadata,ot=Object.keys(Ut),Pt=function(_t,Rt,wt,lt,tt){for(var Gt=[],Q=0;Q<tt;Q++){var ot=be(Q,_t,Rt,wt,lt);null!==ot&&Gt.push(ot)}return Gt}(lt,Rt,Gt,Ut,0===wt.length&&ot.length>0||ot.length>wt.length?ot.length:wt.length),kt=V(_t,wt);return M(M([],Pt),kt)}function be(_t,Rt,wt,lt,tt){var Gt=tt[_t.toString()]||[],Q=Ye(Gt),Ut=!0!==Q.unmanaged,ot=lt[_t];if((ot=Q.inject||Q.multiInject||ot)instanceof _.LazyServiceIdentifer&&(ot=ot.unwrap()),Ut){if(!Rt&&(ot===Object||ot===Function||void 0===ot))throw new Error(l.MISSING_INJECT_ANNOTATION+" argument "+_t+" in class "+wt+".");var ir=new N.Target(m.TargetTypeEnum.ConstructorArgument,Q.targetName,ot);return ir.metadata=Gt,ir}return null}function V(_t,Rt){for(var wt=_t.getPropertiesMetadata(Rt),lt=[],Gt=0,Q=Object.keys(wt);Gt<Q.length;Gt++){var Ut=Q[Gt],ot=wt[Ut],Ue=Ye(wt[Ut]),Pt=new N.Target(m.TargetTypeEnum.ClassProperty,Ue.targetName||Ut,Ue.inject||Ue.multiInject);Pt.metadata=ot,lt.push(Pt)}var kt=Object.getPrototypeOf(Rt.prototype).constructor;if(kt!==Object){var ut=V(_t,kt);lt=M(M([],lt),ut)}return lt}function Ye(_t){var Rt={};return _t.forEach(function(wt){Rt[wt.key.toString()]=wt.value}),{inject:Rt[O.INJECT_TAG],multiInject:Rt[O.MULTI_INJECT_TAG],targetName:Rt[O.NAME_TAG],unmanaged:Rt[O.UNMANAGED_TAG]}}L.getDependencies=function(_t,Rt){return j(_t,R.getFunctionName(Rt),Rt,!1)},L.getBaseClassDependencyCount=function W(_t,Rt){var wt=Object.getPrototypeOf(Rt.prototype).constructor;if(wt!==Object){var tt=j(_t,R.getFunctionName(wt),wt,!0),Gt=tt.map(function(ot){return ot.metadata.filter(function(Ue){return Ue.key===O.UNMANAGED_TAG})}),Q=[].concat.apply([],Gt).length,Ut=tt.length-Q;return Ut>0?Ut:W(_t,wt)}return 0}},68779:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Request=void 0;var M=y(16800),_=function(){function l(m,O,R,N,H){this.id=M.id(),this.serviceIdentifier=m,this.parentContext=O,this.parentRequest=R,this.target=H,this.childRequests=[],this.bindings=Array.isArray(N)?N:[N],this.requestScope=null===R?new Map:null}return l.prototype.addChildRequest=function(m,O,R){var N=new l(m,this.parentContext,this,O,R);return this.childRequests.push(N),N},l}();L.Request=_},56407:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Target=void 0;var M=y(7259),_=y(16800),l=y(95839),m=y(46872),O=function(){function R(N,H,j,be){this.id=_.id(),this.type=N,this.serviceIdentifier=j,this.name=new m.QueryableString(H||""),this.metadata=new Array;var Ne=null;"string"==typeof be?Ne=new l.Metadata(M.NAMED_TAG,be):be instanceof l.Metadata&&(Ne=be),null!==Ne&&this.metadata.push(Ne)}return R.prototype.hasTag=function(N){for(var H=0,j=this.metadata;H<j.length;H++)if(j[H].key===N)return!0;return!1},R.prototype.isArray=function(){return this.hasTag(M.MULTI_INJECT_TAG)},R.prototype.matchesArray=function(N){return this.matchesTag(M.MULTI_INJECT_TAG)(N)},R.prototype.isNamed=function(){return this.hasTag(M.NAMED_TAG)},R.prototype.isTagged=function(){return this.metadata.some(function(N){return M.NON_CUSTOM_TAG_KEYS.every(function(H){return N.key!==H})})},R.prototype.isOptional=function(){return this.matchesTag(M.OPTIONAL_TAG)(!0)},R.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(N){return N.key===M.NAMED_TAG})[0]:null},R.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(N){return M.NON_CUSTOM_TAG_KEYS.every(function(H){return N.key!==H})}):null},R.prototype.matchesNamedTag=function(N){return this.matchesTag(M.NAMED_TAG)(N)},R.prototype.matchesTag=function(N){var H=this;return function(j){for(var be=0,Ne=H.metadata;be<Ne.length;be++){var V=Ne[be];if(V.key===N&&V.value===j)return!0}return!1}},R}();L.Target=O},77661:function(ne,L,y){"use strict";var M=this&&this.__spreadArray||function(j,be){for(var Ne=0,V=be.length,W=j.length;Ne<V;Ne++,W++)j[W]=be[Ne];return j};Object.defineProperty(L,"__esModule",{value:!0}),L.resolveInstance=void 0;var _=y(90640),l=y(21785),m=y(7259);L.resolveInstance=function(j,be,Ne){var V=null;return V=be.length>0?function(j,be,Ne){var V=be.filter(function(Ye){return null!==Ye.target&&Ye.target.type===l.TargetTypeEnum.ClassProperty}),W=V.map(Ne);return V.forEach(function(Ye,_t){var Rt;Rt=Ye.target.name.value(),j[Rt]=W[_t]}),j}(V=function(j,be){return new(j.bind.apply(j,M([void 0],be)))}(j,be.filter(function(_t){return null!==_t.target&&_t.target.type===l.TargetTypeEnum.ConstructorArgument}).map(Ne)),be,Ne):new j,function(j,be){if(Reflect.hasMetadata(m.POST_CONSTRUCT,j)){var Ne=Reflect.getMetadata(m.POST_CONSTRUCT,j);try{be[Ne.value]()}catch(V){throw new Error(_.POST_CONSTRUCT_ERROR(j.name,V.message))}}}(j,V),V}},2739:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.resolve=void 0;var M=y(90640),_=y(21785),l=y(61674),m=y(48736),O=y(77661),R=function(j,be,Ne){try{return Ne()}catch(V){throw l.isStackOverflowExeption(V)?new Error(M.CIRCULAR_DEPENDENCY_IN_FACTORY(j,be.toString())):V}},N=function(j){return function(be){be.parentContext.setCurrentRequest(be);var Ne=be.bindings,V=be.childRequests,W=be.target&&be.target.isArray(),Ye=!(be.parentRequest&&be.parentRequest.target&&be.target&&be.parentRequest.target.matchesArray(be.target.serviceIdentifier));if(W&&Ye)return V.map(function(Gt){return N(j)(Gt)});var _t=null;if(!be.target.isOptional()||0!==Ne.length){var Rt=Ne[0],wt=Rt.scope===_.BindingScopeEnum.Singleton,lt=Rt.scope===_.BindingScopeEnum.Request;if(wt&&Rt.activated)return Rt.cache;if(lt&&null!==j&&j.has(Rt.id))return j.get(Rt.id);if(Rt.type===_.BindingTypeEnum.ConstantValue)_t=Rt.cache,Rt.activated=!0;else if(Rt.type===_.BindingTypeEnum.Function)_t=Rt.cache,Rt.activated=!0;else if(Rt.type===_.BindingTypeEnum.Constructor)_t=Rt.implementationType;else if(Rt.type===_.BindingTypeEnum.DynamicValue&&null!==Rt.dynamicValue)_t=R("toDynamicValue",Rt.serviceIdentifier,function(){return Rt.dynamicValue(be.parentContext)});else if(Rt.type===_.BindingTypeEnum.Factory&&null!==Rt.factory)_t=R("toFactory",Rt.serviceIdentifier,function(){return Rt.factory(be.parentContext)});else if(Rt.type===_.BindingTypeEnum.Provider&&null!==Rt.provider)_t=R("toProvider",Rt.serviceIdentifier,function(){return Rt.provider(be.parentContext)});else{if(Rt.type!==_.BindingTypeEnum.Instance||null===Rt.implementationType){var tt=m.getServiceIdentifierAsString(be.serviceIdentifier);throw new Error(M.INVALID_BINDING_TYPE+" "+tt)}_t=O.resolveInstance(Rt.implementationType,V,N(j))}return"function"==typeof Rt.onActivation&&(_t=Rt.onActivation(be.parentContext,_t)),wt&&(Rt.cache=_t,Rt.activated=!0),lt&&null!==j&&!j.has(Rt.id)&&j.set(Rt.id,_t),_t}}};L.resolve=function(j){return N(j.plan.rootRequest.requestScope)(j.plan.rootRequest)}},73504:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingInSyntax=void 0;var M=y(21785),_=y(18564),l=function(){function m(O){this._binding=O}return m.prototype.inRequestScope=function(){return this._binding.scope=M.BindingScopeEnum.Request,new _.BindingWhenOnSyntax(this._binding)},m.prototype.inSingletonScope=function(){return this._binding.scope=M.BindingScopeEnum.Singleton,new _.BindingWhenOnSyntax(this._binding)},m.prototype.inTransientScope=function(){return this._binding.scope=M.BindingScopeEnum.Transient,new _.BindingWhenOnSyntax(this._binding)},m}();L.BindingInSyntax=l},80620:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingInWhenOnSyntax=void 0;var M=y(73504),_=y(17067),l=y(24803),m=function(){function O(R){this._binding=R,this._bindingWhenSyntax=new l.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new _.BindingOnSyntax(this._binding),this._bindingInSyntax=new M.BindingInSyntax(R)}return O.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},O.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},O.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},O.prototype.when=function(R){return this._bindingWhenSyntax.when(R)},O.prototype.whenTargetNamed=function(R){return this._bindingWhenSyntax.whenTargetNamed(R)},O.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},O.prototype.whenTargetTagged=function(R,N){return this._bindingWhenSyntax.whenTargetTagged(R,N)},O.prototype.whenInjectedInto=function(R){return this._bindingWhenSyntax.whenInjectedInto(R)},O.prototype.whenParentNamed=function(R){return this._bindingWhenSyntax.whenParentNamed(R)},O.prototype.whenParentTagged=function(R,N){return this._bindingWhenSyntax.whenParentTagged(R,N)},O.prototype.whenAnyAncestorIs=function(R){return this._bindingWhenSyntax.whenAnyAncestorIs(R)},O.prototype.whenNoAncestorIs=function(R){return this._bindingWhenSyntax.whenNoAncestorIs(R)},O.prototype.whenAnyAncestorNamed=function(R){return this._bindingWhenSyntax.whenAnyAncestorNamed(R)},O.prototype.whenAnyAncestorTagged=function(R,N){return this._bindingWhenSyntax.whenAnyAncestorTagged(R,N)},O.prototype.whenNoAncestorNamed=function(R){return this._bindingWhenSyntax.whenNoAncestorNamed(R)},O.prototype.whenNoAncestorTagged=function(R,N){return this._bindingWhenSyntax.whenNoAncestorTagged(R,N)},O.prototype.whenAnyAncestorMatches=function(R){return this._bindingWhenSyntax.whenAnyAncestorMatches(R)},O.prototype.whenNoAncestorMatches=function(R){return this._bindingWhenSyntax.whenNoAncestorMatches(R)},O.prototype.onActivation=function(R){return this._bindingOnSyntax.onActivation(R)},O}();L.BindingInWhenOnSyntax=m},17067:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingOnSyntax=void 0;var M=y(24803),_=function(){function l(m){this._binding=m}return l.prototype.onActivation=function(m){return this._binding.onActivation=m,new M.BindingWhenSyntax(this._binding)},l}();L.BindingOnSyntax=_},38809:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingToSyntax=void 0;var M=y(90640),_=y(21785),l=y(80620),m=y(18564),O=function(){function R(N){this._binding=N}return R.prototype.to=function(N){return this._binding.type=_.BindingTypeEnum.Instance,this._binding.implementationType=N,new l.BindingInWhenOnSyntax(this._binding)},R.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+M.INVALID_TO_SELF_VALUE);return this.to(this._binding.serviceIdentifier)},R.prototype.toConstantValue=function(N){return this._binding.type=_.BindingTypeEnum.ConstantValue,this._binding.cache=N,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=_.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},R.prototype.toDynamicValue=function(N){return this._binding.type=_.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=N,this._binding.implementationType=null,new l.BindingInWhenOnSyntax(this._binding)},R.prototype.toConstructor=function(N){return this._binding.type=_.BindingTypeEnum.Constructor,this._binding.implementationType=N,this._binding.scope=_.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},R.prototype.toFactory=function(N){return this._binding.type=_.BindingTypeEnum.Factory,this._binding.factory=N,this._binding.scope=_.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},R.prototype.toFunction=function(N){if("function"!=typeof N)throw new Error(M.INVALID_FUNCTION_BINDING);var H=this.toConstantValue(N);return this._binding.type=_.BindingTypeEnum.Function,this._binding.scope=_.BindingScopeEnum.Singleton,H},R.prototype.toAutoFactory=function(N){return this._binding.type=_.BindingTypeEnum.Factory,this._binding.factory=function(H){return function(){return H.container.get(N)}},this._binding.scope=_.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},R.prototype.toProvider=function(N){return this._binding.type=_.BindingTypeEnum.Provider,this._binding.provider=N,this._binding.scope=_.BindingScopeEnum.Singleton,new m.BindingWhenOnSyntax(this._binding)},R.prototype.toService=function(N){this.toDynamicValue(function(H){return H.container.get(N)})},R}();L.BindingToSyntax=O},18564:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingWhenOnSyntax=void 0;var M=y(17067),_=y(24803),l=function(){function m(O){this._binding=O,this._bindingWhenSyntax=new _.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new M.BindingOnSyntax(this._binding)}return m.prototype.when=function(O){return this._bindingWhenSyntax.when(O)},m.prototype.whenTargetNamed=function(O){return this._bindingWhenSyntax.whenTargetNamed(O)},m.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},m.prototype.whenTargetTagged=function(O,R){return this._bindingWhenSyntax.whenTargetTagged(O,R)},m.prototype.whenInjectedInto=function(O){return this._bindingWhenSyntax.whenInjectedInto(O)},m.prototype.whenParentNamed=function(O){return this._bindingWhenSyntax.whenParentNamed(O)},m.prototype.whenParentTagged=function(O,R){return this._bindingWhenSyntax.whenParentTagged(O,R)},m.prototype.whenAnyAncestorIs=function(O){return this._bindingWhenSyntax.whenAnyAncestorIs(O)},m.prototype.whenNoAncestorIs=function(O){return this._bindingWhenSyntax.whenNoAncestorIs(O)},m.prototype.whenAnyAncestorNamed=function(O){return this._bindingWhenSyntax.whenAnyAncestorNamed(O)},m.prototype.whenAnyAncestorTagged=function(O,R){return this._bindingWhenSyntax.whenAnyAncestorTagged(O,R)},m.prototype.whenNoAncestorNamed=function(O){return this._bindingWhenSyntax.whenNoAncestorNamed(O)},m.prototype.whenNoAncestorTagged=function(O,R){return this._bindingWhenSyntax.whenNoAncestorTagged(O,R)},m.prototype.whenAnyAncestorMatches=function(O){return this._bindingWhenSyntax.whenAnyAncestorMatches(O)},m.prototype.whenNoAncestorMatches=function(O){return this._bindingWhenSyntax.whenNoAncestorMatches(O)},m.prototype.onActivation=function(O){return this._bindingOnSyntax.onActivation(O)},m}();L.BindingWhenOnSyntax=l},24803:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingWhenSyntax=void 0;var M=y(17067),_=y(9446),l=function(){function m(O){this._binding=O}return m.prototype.when=function(O){return this._binding.constraint=O,new M.BindingOnSyntax(this._binding)},m.prototype.whenTargetNamed=function(O){return this._binding.constraint=_.namedConstraint(O),new M.BindingOnSyntax(this._binding)},m.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(O){return null!==O.target&&!O.target.isNamed()&&!O.target.isTagged()},new M.BindingOnSyntax(this._binding)},m.prototype.whenTargetTagged=function(O,R){return this._binding.constraint=_.taggedConstraint(O)(R),new M.BindingOnSyntax(this._binding)},m.prototype.whenInjectedInto=function(O){return this._binding.constraint=function(R){return _.typeConstraint(O)(R.parentRequest)},new M.BindingOnSyntax(this._binding)},m.prototype.whenParentNamed=function(O){return this._binding.constraint=function(R){return _.namedConstraint(O)(R.parentRequest)},new M.BindingOnSyntax(this._binding)},m.prototype.whenParentTagged=function(O,R){return this._binding.constraint=function(N){return _.taggedConstraint(O)(R)(N.parentRequest)},new M.BindingOnSyntax(this._binding)},m.prototype.whenAnyAncestorIs=function(O){return this._binding.constraint=function(R){return _.traverseAncerstors(R,_.typeConstraint(O))},new M.BindingOnSyntax(this._binding)},m.prototype.whenNoAncestorIs=function(O){return this._binding.constraint=function(R){return!_.traverseAncerstors(R,_.typeConstraint(O))},new M.BindingOnSyntax(this._binding)},m.prototype.whenAnyAncestorNamed=function(O){return this._binding.constraint=function(R){return _.traverseAncerstors(R,_.namedConstraint(O))},new M.BindingOnSyntax(this._binding)},m.prototype.whenNoAncestorNamed=function(O){return this._binding.constraint=function(R){return!_.traverseAncerstors(R,_.namedConstraint(O))},new M.BindingOnSyntax(this._binding)},m.prototype.whenAnyAncestorTagged=function(O,R){return this._binding.constraint=function(N){return _.traverseAncerstors(N,_.taggedConstraint(O)(R))},new M.BindingOnSyntax(this._binding)},m.prototype.whenNoAncestorTagged=function(O,R){return this._binding.constraint=function(N){return!_.traverseAncerstors(N,_.taggedConstraint(O)(R))},new M.BindingOnSyntax(this._binding)},m.prototype.whenAnyAncestorMatches=function(O){return this._binding.constraint=function(R){return _.traverseAncerstors(R,O)},new M.BindingOnSyntax(this._binding)},m.prototype.whenNoAncestorMatches=function(O){return this._binding.constraint=function(R){return!_.traverseAncerstors(R,O)},new M.BindingOnSyntax(this._binding)},m}();L.BindingWhenSyntax=l},9446:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.typeConstraint=L.namedConstraint=L.taggedConstraint=L.traverseAncerstors=void 0;var M=y(7259),_=y(95839),l=function(N,H){var j=N.parentRequest;return null!==j&&(!!H(j)||l(j,H))};L.traverseAncerstors=l;var m=function(N){return function(H){var j=function(be){return null!==be&&null!==be.target&&be.target.matchesTag(N)(H)};return j.metaData=new _.Metadata(N,H),j}};L.taggedConstraint=m;var O=m(M.NAMED_TAG);L.namedConstraint=O,L.typeConstraint=function(N){return function(H){return null!==H&&("string"==typeof N?H.bindings[0].serviceIdentifier===N:N===H.bindings[0].implementationType)}}},85527:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.multiBindToService=void 0,L.multiBindToService=function(M){return function(_){return function(){for(var l=[],m=0;m<arguments.length;m++)l[m]=arguments[m];return l.forEach(function(O){return M.bind(O).toService(_)})}}}},61674:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.isStackOverflowExeption=void 0;var M=y(90640);L.isStackOverflowExeption=function(l){return l instanceof RangeError||l.message===M.STACK_OVERFLOW}},16800:(ne,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.id=void 0;var y=0;L.id=function(){return y++}},48736:(ne,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.circularDependencyToException=L.listMetadataForTarget=L.listRegisteredBindingsForServiceIdentifier=L.getServiceIdentifierAsString=L.getFunctionName=void 0;var M=y(90640);function _(j){return"function"==typeof j?j.name:"symbol"==typeof j?j.toString():j}function m(j,be){return null!==j.parentRequest&&(j.parentRequest.serviceIdentifier===be||m(j.parentRequest,be))}function H(j){if(j.name)return j.name;var be=j.toString(),Ne=be.match(/^function\s*([^\s(]+)/);return Ne?Ne[1]:"Anonymous function: "+be}L.getServiceIdentifierAsString=_,L.listRegisteredBindingsForServiceIdentifier=function(j,be,Ne){var V="",W=Ne(j,be);return 0!==W.length&&(V="\nRegistered bindings:",W.forEach(function(Ye){var _t="Object";null!==Ye.implementationType&&(_t=H(Ye.implementationType)),V=V+"\n "+_t,Ye.constraint.metaData&&(V=V+" - "+Ye.constraint.metaData)})),V},L.circularDependencyToException=function R(j){j.childRequests.forEach(function(be){if(m(be,be.serviceIdentifier)){var Ne=function(j){return function be(V,W){void 0===W&&(W=[]);var Ye=_(V.serviceIdentifier);return W.push(Ye),null!==V.parentRequest?be(V.parentRequest,W):W}(j).reverse().join(" --\x3e ")}(be);throw new Error(M.CIRCULAR_DEPENDENCY+" "+Ne)}R(be)})},L.listMetadataForTarget=function(j,be){if(be.isTagged()||be.isNamed()){var Ne="",V=be.getNamedTag(),W=be.getCustomTags();return null!==V&&(Ne+=V.toString()+"\n"),null!==W&&W.forEach(function(Ye){Ne+=Ye.toString()+"\n"})," "+j+"\n "+j+" - "+Ne}return" "+j},L.getFunctionName=H},88660:(ne,L,y)=>{"use strict";y.r(L),y.d(L,{Function:()=>eu,Interpreter:()=>ko,default:()=>Dl,evaluate:()=>hl,vm:()=>M});var M={};y.r(M),y.d(M,{Script:()=>Rl,compileFunction:()=>Ll,createContext:()=>Ol,runInContext:()=>kl,runInNewContext:()=>wc});var _={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},l="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",m={5:l,"5module":l+" export import",6:l+" const class extends export import super"},O=/^in(stanceof)?$/,R="\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0560-\u0588\u05d0-\u05ea\u05ef-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u0860-\u086a\u08a0-\u08b4\u08b6-\u08c7\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u09fc\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0af9\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58-\u0c5a\u0c60\u0c61\u0c80\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d04-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d54-\u0d56\u0d5f-\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e86-\u0e8a\u0e8c-\u0ea3\u0ea5\u0ea7-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f5\u13f8-\u13fd\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1878\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1c80-\u1c88\u1c90-\u1cba\u1cbd-\u1cbf\u1ce9-\u1cec\u1cee-\u1cf3\u1cf5\u1cf6\u1cfa\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2118-\u211d\u2124\u2126\u2128\u212a-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309b-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312f\u3131-\u318e\u31a0-\u31bf\u31f0-\u31ff\u3400-\u4dbf\u4e00-\u9ffc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua7bf\ua7c2-\ua7ca\ua7f5-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua8fd\ua8fe\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab69\uab70-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",N="\u200c\u200d\xb7\u0300-\u036f\u0387\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u07fd\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08d3-\u08e1\u08e3-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u09fe\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0afa-\u0aff\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b55-\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c00-\u0c04\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d00-\u0d03\u0d3b\u0d3c\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d81-\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19d0-\u19da\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1ab0-\u1abd\u1abf\u1ac0\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf4\u1cf7-\u1cf9\u1dc0-\u1df9\u1dfb-\u1dff\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69e\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua82c\ua880\ua881\ua8b4-\ua8c5\ua8d0-\ua8d9\ua8e0-\ua8f1\ua8ff-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\ua9e5\ua9f0-\ua9f9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b-\uaa7d\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f",H=new RegExp("["+R+"]"),j=new RegExp("["+R+N+"]");R=N=null;var be=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],Ne=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function V(g,T){for(var K=65536,D=0;D<T.length;D+=2){if((K+=T[D])>g)return!1;if((K+=T[D+1])>=g)return!0}}function W(g,T){return g<65?36===g:g<91||(g<97?95===g:g<123||(g<=65535?g>=170&&H.test(String.fromCharCode(g)):!1!==T&&V(g,be)))}function Ye(g,T){return g<48?36===g:g<58||!(g<65)&&(g<91||(g<97?95===g:g<123||(g<=65535?g>=170&&j.test(String.fromCharCode(g)):!1!==T&&(V(g,be)||V(g,Ne)))))}var _t=function(T,K){void 0===K&&(K={}),this.label=T,this.keyword=K.keyword,this.beforeExpr=!!K.beforeExpr,this.startsExpr=!!K.startsExpr,this.isLoop=!!K.isLoop,this.isAssign=!!K.isAssign,this.prefix=!!K.prefix,this.postfix=!!K.postfix,this.binop=K.binop||null,this.updateContext=null};function Rt(g,T){return new _t(g,{beforeExpr:!0,binop:T})}var wt={beforeExpr:!0},lt={startsExpr:!0},tt={};function Gt(g,T){return void 0===T&&(T={}),T.keyword=g,tt[g]=new _t(g,T)}var Q={num:new _t("num",lt),regexp:new _t("regexp",lt),string:new _t("string",lt),name:new _t("name",lt),eof:new _t("eof"),bracketL:new _t("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new _t("]"),braceL:new _t("{",{beforeExpr:!0,startsExpr:!0}),braceR:new _t("}"),parenL:new _t("(",{beforeExpr:!0,startsExpr:!0}),parenR:new _t(")"),comma:new _t(",",wt),semi:new _t(";",wt),colon:new _t(":",wt),dot:new _t("."),question:new _t("?",wt),questionDot:new _t("?."),arrow:new _t("=>",wt),template:new _t("template"),invalidTemplate:new _t("invalidTemplate"),ellipsis:new _t("...",wt),backQuote:new _t("`",lt),dollarBraceL:new _t("${",{beforeExpr:!0,startsExpr:!0}),eq:new _t("=",{beforeExpr:!0,isAssign:!0}),assign:new _t("_=",{beforeExpr:!0,isAssign:!0}),incDec:new _t("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new _t("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Rt("||",1),logicalAND:Rt("&&",2),bitwiseOR:Rt("|",3),bitwiseXOR:Rt("^",4),bitwiseAND:Rt("&",5),equality:Rt("==/!=/===/!==",6),relational:Rt("</>/<=/>=",7),bitShift:Rt("<</>>/>>>",8),plusMin:new _t("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Rt("%",10),star:Rt("*",10),slash:Rt("/",10),starstar:new _t("**",{beforeExpr:!0}),coalesce:Rt("??",1),_break:Gt("break"),_case:Gt("case",wt),_catch:Gt("catch"),_continue:Gt("continue"),_debugger:Gt("debugger"),_default:Gt("default",wt),_do:Gt("do",{isLoop:!0,beforeExpr:!0}),_else:Gt("else",wt),_finally:Gt("finally"),_for:Gt("for",{isLoop:!0}),_function:Gt("function",lt),_if:Gt("if"),_return:Gt("return",wt),_switch:Gt("switch"),_throw:Gt("throw",wt),_try:Gt("try"),_var:Gt("var"),_const:Gt("const"),_while:Gt("while",{isLoop:!0}),_with:Gt("with"),_new:Gt("new",{beforeExpr:!0,startsExpr:!0}),_this:Gt("this",lt),_super:Gt("super",lt),_class:Gt("class",lt),_extends:Gt("extends",wt),_export:Gt("export"),_import:Gt("import",lt),_null:Gt("null",lt),_true:Gt("true",lt),_false:Gt("false",lt),_in:Gt("in",{beforeExpr:!0,binop:7}),_instanceof:Gt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Gt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Gt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Gt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Ut=/\r\n?|\n|\u2028|\u2029/,ot=new RegExp(Ut.source,"g");function Ue(g,T){return 10===g||13===g||!T&&(8232===g||8233===g)}var ct=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Xe=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Pt=Object.prototype,kt=Pt.hasOwnProperty,ut=Pt.toString;function ir(g,T){return kt.call(g,T)}var le=Array.isArray||function(g){return"[object Array]"===ut.call(g)};function ce(g){return new RegExp("^(?:"+g.replace(/ /g,"|")+")$")}var ae=function(T,K){this.line=T,this.column=K};ae.prototype.offset=function(T){return new ae(this.line,this.column+T)};var me=function(T,K,D){this.start=K,this.end=D,null!==T.sourceFile&&(this.source=T.sourceFile)};function Ie(g,T){for(var K=1,D=0;;){ot.lastIndex=D;var ge=ot.exec(g);if(!(ge&&ge.index<T))return new ae(K,T-D);++K,D=ge.index+ge[0].length}}var je={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Pr(g,T){return 2|(g?4:0)|(T?8:0)}var Ge=function(T,K,D){this.options=T=function(g){var T={};for(var K in je)T[K]=g&&ir(g,K)?g[K]:je[K];if(T.ecmaVersion>=2015&&(T.ecmaVersion-=2009),null==T.allowReserved&&(T.allowReserved=T.ecmaVersion<5),le(T.onToken)){var D=T.onToken;T.onToken=function(ge){return D.push(ge)}}return le(T.onComment)&&(T.onComment=function(g,T){return function(K,D,ge,Fe,yt,Zt){var Ft={type:K?"Block":"Line",value:D,start:ge,end:Fe};g.locations&&(Ft.loc=new me(this,yt,Zt)),g.ranges&&(Ft.range=[ge,Fe]),T.push(Ft)}}(T,T.onComment)),T}(T),this.sourceFile=T.sourceFile,this.keywords=ce(m[T.ecmaVersion>=6?6:"module"===T.sourceType?"5module":5]);var ge="";if(!0!==T.allowReserved){for(var Fe=T.ecmaVersion;!(ge=_[Fe]);Fe--);"module"===T.sourceType&&(ge+=" await")}this.reservedWords=ce(ge);var yt=(ge?ge+" ":"")+_.strict;this.reservedWordsStrict=ce(yt),this.reservedWordsStrictBind=ce(yt+" "+_.strictBind),this.input=String(K),this.containsEsc=!1,D?(this.pos=D,this.lineStart=this.input.lastIndexOf("\n",D-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Ut).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Q.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===T.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&T.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},nt={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Ge.prototype.parse=function(){var T=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(T)},nt.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},nt.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},nt.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},nt.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},nt.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},nt.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Ge.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},Ge.extend=function(){for(var T=[],K=arguments.length;K--;)T[K]=arguments[K];for(var D=this,ge=0;ge<T.length;ge++)D=T[ge](D);return D},Ge.parse=function(T,K){return new this(K,T).parse()},Ge.parseExpressionAt=function(T,K,D){var ge=new this(D,T,K);return ge.nextToken(),ge.parseExpression()},Ge.tokenizer=function(T,K){return new this(K,T)},Object.defineProperties(Ge.prototype,nt);var xt=Ge.prototype,Dt=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function Z(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}xt.strictDirective=function(g){for(;;){Xe.lastIndex=g,g+=Xe.exec(this.input)[0].length;var T=Dt.exec(this.input.slice(g));if(!T)return!1;if("use strict"===(T[1]||T[2])){Xe.lastIndex=g+T[0].length;var K=Xe.exec(this.input),D=K.index+K[0].length,ge=this.input.charAt(D);return";"===ge||"}"===ge||Ut.test(K[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(ge)||"!"===ge&&"="===this.input.charAt(D+1))}Xe.lastIndex=g+=T[0].length,g+=Xe.exec(this.input)[0].length,";"===this.input[g]&&g++}},xt.eat=function(g){return this.type===g&&(this.next(),!0)},xt.isContextual=function(g){return this.type===Q.name&&this.value===g&&!this.containsEsc},xt.eatContextual=function(g){return!!this.isContextual(g)&&(this.next(),!0)},xt.expectContextual=function(g){this.eatContextual(g)||this.unexpected()},xt.canInsertSemicolon=function(){return this.type===Q.eof||this.type===Q.braceR||Ut.test(this.input.slice(this.lastTokEnd,this.start))},xt.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},xt.semicolon=function(){!this.eat(Q.semi)&&!this.insertSemicolon()&&this.unexpected()},xt.afterTrailingComma=function(g,T){if(this.type===g)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),T||this.next(),!0},xt.expect=function(g){this.eat(g)||this.unexpected()},xt.unexpected=function(g){this.raise(null!=g?g:this.start,"Unexpected token")},xt.checkPatternErrors=function(g,T){if(g){g.trailingComma>-1&&this.raiseRecoverable(g.trailingComma,"Comma is not permitted after the rest element");var K=T?g.parenthesizedAssign:g.parenthesizedBind;K>-1&&this.raiseRecoverable(K,"Parenthesized pattern")}},xt.checkExpressionErrors=function(g,T){if(!g)return!1;var K=g.shorthandAssign,D=g.doubleProto;if(!T)return K>=0||D>=0;K>=0&&this.raise(K,"Shorthand property assignments are valid only in destructuring patterns"),D>=0&&this.raiseRecoverable(D,"Redefinition of __proto__ property")},xt.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},xt.isSimpleAssignTarget=function(g){return"ParenthesizedExpression"===g.type?this.isSimpleAssignTarget(g.expression):"Identifier"===g.type||"MemberExpression"===g.type};var Ze=Ge.prototype;Ze.parseTopLevel=function(g){var T={};for(g.body||(g.body=[]);this.type!==Q.eof;){var K=this.parseStatement(null,!0,T);g.body.push(K)}if(this.inModule)for(var D=0,ge=Object.keys(this.undefinedExports);D<ge.length;D+=1){var Fe=ge[D];this.raiseRecoverable(this.undefinedExports[Fe].start,"Export '"+Fe+"' is not defined")}return this.adaptDirectivePrologue(g.body),this.next(),g.sourceType=this.options.sourceType,this.finishNode(g,"Program")};var Et={kind:"loop"},Mt={kind:"switch"};Ze.isLet=function(g){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Xe.lastIndex=this.pos;var T=Xe.exec(this.input),K=this.pos+T[0].length,D=this.input.charCodeAt(K);if(91===D)return!0;if(g)return!1;if(123===D)return!0;if(W(D,!0)){for(var ge=K+1;Ye(this.input.charCodeAt(ge),!0);)++ge;var Fe=this.input.slice(K,ge);if(!O.test(Fe))return!0}return!1},Ze.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Xe.lastIndex=this.pos;var g=Xe.exec(this.input),T=this.pos+g[0].length;return!(Ut.test(this.input.slice(this.pos,T))||"function"!==this.input.slice(T,T+8)||T+8!==this.input.length&&Ye(this.input.charAt(T+8)))},Ze.parseStatement=function(g,T,K){var Fe,D=this.type,ge=this.startNode();switch(this.isLet(g)&&(D=Q._var,Fe="let"),D){case Q._break:case Q._continue:return this.parseBreakContinueStatement(ge,D.keyword);case Q._debugger:return this.parseDebuggerStatement(ge);case Q._do:return this.parseDoStatement(ge);case Q._for:return this.parseForStatement(ge);case Q._function:return g&&(this.strict||"if"!==g&&"label"!==g)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(ge,!1,!g);case Q._class:return g&&this.unexpected(),this.parseClass(ge,!0);case Q._if:return this.parseIfStatement(ge);case Q._return:return this.parseReturnStatement(ge);case Q._switch:return this.parseSwitchStatement(ge);case Q._throw:return this.parseThrowStatement(ge);case Q._try:return this.parseTryStatement(ge);case Q._const:case Q._var:return Fe=Fe||this.value,g&&"var"!==Fe&&this.unexpected(),this.parseVarStatement(ge,Fe);case Q._while:return this.parseWhileStatement(ge);case Q._with:return this.parseWithStatement(ge);case Q.braceL:return this.parseBlock(!0,ge);case Q.semi:return this.parseEmptyStatement(ge);case Q._export:case Q._import:if(this.options.ecmaVersion>10&&D===Q._import){Xe.lastIndex=this.pos;var yt=Xe.exec(this.input),Ft=this.input.charCodeAt(this.pos+yt[0].length);if(40===Ft||46===Ft)return this.parseExpressionStatement(ge,this.parseExpression())}return this.options.allowImportExportEverywhere||(T||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),D===Q._import?this.parseImport(ge):this.parseExport(ge,K);default:if(this.isAsyncFunction())return g&&this.unexpected(),this.next(),this.parseFunctionStatement(ge,!0,!g);var Or=this.value,zr=this.parseExpression();return D===Q.name&&"Identifier"===zr.type&&this.eat(Q.colon)?this.parseLabeledStatement(ge,Or,zr,g):this.parseExpressionStatement(ge,zr)}},Ze.parseBreakContinueStatement=function(g,T){var K="break"===T;this.next(),this.eat(Q.semi)||this.insertSemicolon()?g.label=null:this.type!==Q.name?this.unexpected():(g.label=this.parseIdent(),this.semicolon());for(var D=0;D<this.labels.length;++D){var ge=this.labels[D];if((null==g.label||ge.name===g.label.name)&&(null!=ge.kind&&(K||"loop"===ge.kind)||g.label&&K))break}return D===this.labels.length&&this.raise(g.start,"Unsyntactic "+T),this.finishNode(g,K?"BreakStatement":"ContinueStatement")},Ze.parseDebuggerStatement=function(g){return this.next(),this.semicolon(),this.finishNode(g,"DebuggerStatement")},Ze.parseDoStatement=function(g){return this.next(),this.labels.push(Et),g.body=this.parseStatement("do"),this.labels.pop(),this.expect(Q._while),g.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Q.semi):this.semicolon(),this.finishNode(g,"DoWhileStatement")},Ze.parseForStatement=function(g){this.next();var T=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Et),this.enterScope(0),this.expect(Q.parenL),this.type===Q.semi)return T>-1&&this.unexpected(T),this.parseFor(g,null);var K=this.isLet();if(this.type===Q._var||this.type===Q._const||K){var D=this.startNode(),ge=K?"let":this.value;return this.next(),this.parseVar(D,!0,ge),this.finishNode(D,"VariableDeclaration"),(this.type===Q._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===D.declarations.length?(this.options.ecmaVersion>=9&&(this.type===Q._in?T>-1&&this.unexpected(T):g.await=T>-1),this.parseForIn(g,D)):(T>-1&&this.unexpected(T),this.parseFor(g,D))}var Fe=new Z,yt=this.parseExpression(!0,Fe);return this.type===Q._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===Q._in?T>-1&&this.unexpected(T):g.await=T>-1),this.toAssignable(yt,!1,Fe),this.checkLVal(yt),this.parseForIn(g,yt)):(this.checkExpressionErrors(Fe,!0),T>-1&&this.unexpected(T),this.parseFor(g,yt))},Ze.parseFunctionStatement=function(g,T,K){return this.next(),this.parseFunction(g,Tr|(K?0:mr),!1,T)},Ze.parseIfStatement=function(g){return this.next(),g.test=this.parseParenExpression(),g.consequent=this.parseStatement("if"),g.alternate=this.eat(Q._else)?this.parseStatement("if"):null,this.finishNode(g,"IfStatement")},Ze.parseReturnStatement=function(g){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Q.semi)||this.insertSemicolon()?g.argument=null:(g.argument=this.parseExpression(),this.semicolon()),this.finishNode(g,"ReturnStatement")},Ze.parseSwitchStatement=function(g){this.next(),g.discriminant=this.parseParenExpression(),g.cases=[],this.expect(Q.braceL),this.labels.push(Mt),this.enterScope(0);for(var T,K=!1;this.type!==Q.braceR;)if(this.type===Q._case||this.type===Q._default){var D=this.type===Q._case;T&&this.finishNode(T,"SwitchCase"),g.cases.push(T=this.startNode()),T.consequent=[],this.next(),D?T.test=this.parseExpression():(K&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),K=!0,T.test=null),this.expect(Q.colon)}else T||this.unexpected(),T.consequent.push(this.parseStatement(null));return this.exitScope(),T&&this.finishNode(T,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(g,"SwitchStatement")},Ze.parseThrowStatement=function(g){return this.next(),Ut.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),g.argument=this.parseExpression(),this.semicolon(),this.finishNode(g,"ThrowStatement")};var Jt=[];Ze.parseTryStatement=function(g){if(this.next(),g.block=this.parseBlock(),g.handler=null,this.type===Q._catch){var T=this.startNode();if(this.next(),this.eat(Q.parenL)){T.param=this.parseBindingAtom();var K="Identifier"===T.param.type;this.enterScope(K?32:0),this.checkLVal(T.param,K?4:2),this.expect(Q.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),T.param=null,this.enterScope(0);T.body=this.parseBlock(!1),this.exitScope(),g.handler=this.finishNode(T,"CatchClause")}return g.finalizer=this.eat(Q._finally)?this.parseBlock():null,!g.handler&&!g.finalizer&&this.raise(g.start,"Missing catch or finally clause"),this.finishNode(g,"TryStatement")},Ze.parseVarStatement=function(g,T){return this.next(),this.parseVar(g,!1,T),this.semicolon(),this.finishNode(g,"VariableDeclaration")},Ze.parseWhileStatement=function(g){return this.next(),g.test=this.parseParenExpression(),this.labels.push(Et),g.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(g,"WhileStatement")},Ze.parseWithStatement=function(g){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),g.object=this.parseParenExpression(),g.body=this.parseStatement("with"),this.finishNode(g,"WithStatement")},Ze.parseEmptyStatement=function(g){return this.next(),this.finishNode(g,"EmptyStatement")},Ze.parseLabeledStatement=function(g,T,K,D){for(var ge=0,Fe=this.labels;ge<Fe.length;ge+=1)Fe[ge].name===T&&this.raise(K.start,"Label '"+T+"' is already declared");for(var Zt=this.type.isLoop?"loop":this.type===Q._switch?"switch":null,Ft=this.labels.length-1;Ft>=0;Ft--){var Or=this.labels[Ft];if(Or.statementStart!==g.start)break;Or.statementStart=this.start,Or.kind=Zt}return this.labels.push({name:T,kind:Zt,statementStart:this.start}),g.body=this.parseStatement(D?-1===D.indexOf("label")?D+"label":D:"label"),this.labels.pop(),g.label=K,this.finishNode(g,"LabeledStatement")},Ze.parseExpressionStatement=function(g,T){return g.expression=T,this.semicolon(),this.finishNode(g,"ExpressionStatement")},Ze.parseBlock=function(g,T,K){for(void 0===g&&(g=!0),void 0===T&&(T=this.startNode()),T.body=[],this.expect(Q.braceL),g&&this.enterScope(0);this.type!==Q.braceR;){var D=this.parseStatement(null);T.body.push(D)}return K&&(this.strict=!1),this.next(),g&&this.exitScope(),this.finishNode(T,"BlockStatement")},Ze.parseFor=function(g,T){return g.init=T,this.expect(Q.semi),g.test=this.type===Q.semi?null:this.parseExpression(),this.expect(Q.semi),g.update=this.type===Q.parenR?null:this.parseExpression(),this.expect(Q.parenR),g.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(g,"ForStatement")},Ze.parseForIn=function(g,T){var K=this.type===Q._in;return this.next(),"VariableDeclaration"===T.type&&null!=T.declarations[0].init&&(!K||this.options.ecmaVersion<8||this.strict||"var"!==T.kind||"Identifier"!==T.declarations[0].id.type)?this.raise(T.start,(K?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===T.type&&this.raise(T.start,"Invalid left-hand side in for-loop"),g.left=T,g.right=K?this.parseExpression():this.parseMaybeAssign(),this.expect(Q.parenR),g.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(g,K?"ForInStatement":"ForOfStatement")},Ze.parseVar=function(g,T,K){for(g.declarations=[],g.kind=K;;){var D=this.startNode();if(this.parseVarId(D,K),this.eat(Q.eq)?D.init=this.parseMaybeAssign(T):"const"!==K||this.type===Q._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===D.id.type||T&&(this.type===Q._in||this.isContextual("of"))?D.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),g.declarations.push(this.finishNode(D,"VariableDeclarator")),!this.eat(Q.comma))break}return g},Ze.parseVarId=function(g,T){g.id=this.parseBindingAtom(),this.checkLVal(g.id,"var"===T?1:2,!1)};var Tr=1,mr=2;Ze.parseFunction=function(g,T,K,D){this.initFunction(g),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!D)&&(this.type===Q.star&&T&mr&&this.unexpected(),g.generator=this.eat(Q.star)),this.options.ecmaVersion>=8&&(g.async=!!D),T&Tr&&(g.id=4&T&&this.type!==Q.name?null:this.parseIdent(),g.id&&!(T&mr)&&this.checkLVal(g.id,this.strict||g.generator||g.async?this.treatFunctionsAsVar?1:2:3));var ge=this.yieldPos,Fe=this.awaitPos,yt=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Pr(g.async,g.generator)),T&Tr||(g.id=this.type===Q.name?this.parseIdent():null),this.parseFunctionParams(g),this.parseFunctionBody(g,K,!1),this.yieldPos=ge,this.awaitPos=Fe,this.awaitIdentPos=yt,this.finishNode(g,T&Tr?"FunctionDeclaration":"FunctionExpression")},Ze.parseFunctionParams=function(g){this.expect(Q.parenL),g.params=this.parseBindingList(Q.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},Ze.parseClass=function(g,T){this.next();var K=this.strict;this.strict=!0,this.parseClassId(g,T),this.parseClassSuper(g);var D=this.startNode(),ge=!1;for(D.body=[],this.expect(Q.braceL);this.type!==Q.braceR;){var Fe=this.parseClassElement(null!==g.superClass);Fe&&(D.body.push(Fe),"MethodDefinition"===Fe.type&&"constructor"===Fe.kind&&(ge&&this.raise(Fe.start,"Duplicate constructor in the same class"),ge=!0))}return this.strict=K,this.next(),g.body=this.finishNode(D,"ClassBody"),this.finishNode(g,T?"ClassDeclaration":"ClassExpression")},Ze.parseClassElement=function(g){var T=this;if(this.eat(Q.semi))return null;var K=this.startNode(),D=function(Ft,Or){void 0===Or&&(Or=!1);var zr=T.start,Jn=T.startLoc;return!(!T.eatContextual(Ft)||(T.type===Q.parenL||Or&&T.canInsertSemicolon())&&(K.key&&T.unexpected(),K.computed=!1,K.key=T.startNodeAt(zr,Jn),K.key.name=Ft,T.finishNode(K.key,"Identifier"),1))};K.kind="method",K.static=D("static");var ge=this.eat(Q.star),Fe=!1;ge||(this.options.ecmaVersion>=8&&D("async",!0)?(Fe=!0,ge=this.options.ecmaVersion>=9&&this.eat(Q.star)):D("get")?K.kind="get":D("set")&&(K.kind="set")),K.key||this.parsePropertyName(K);var yt=K.key,Zt=!1;return K.computed||K.static||!("Identifier"===yt.type&&"constructor"===yt.name||"Literal"===yt.type&&"constructor"===yt.value)?K.static&&"Identifier"===yt.type&&"prototype"===yt.name&&this.raise(yt.start,"Classes may not have a static property named prototype"):("method"!==K.kind&&this.raise(yt.start,"Constructor can't have get/set modifier"),ge&&this.raise(yt.start,"Constructor can't be a generator"),Fe&&this.raise(yt.start,"Constructor can't be an async method"),K.kind="constructor",Zt=g),this.parseClassMethod(K,ge,Fe,Zt),"get"===K.kind&&0!==K.value.params.length&&this.raiseRecoverable(K.value.start,"getter should have no params"),"set"===K.kind&&1!==K.value.params.length&&this.raiseRecoverable(K.value.start,"setter should have exactly one param"),"set"===K.kind&&"RestElement"===K.value.params[0].type&&this.raiseRecoverable(K.value.params[0].start,"Setter cannot use rest params"),K},Ze.parseClassMethod=function(g,T,K,D){return g.value=this.parseMethod(T,K,D),this.finishNode(g,"MethodDefinition")},Ze.parseClassId=function(g,T){this.type===Q.name?(g.id=this.parseIdent(),T&&this.checkLVal(g.id,2,!1)):(!0===T&&this.unexpected(),g.id=null)},Ze.parseClassSuper=function(g){g.superClass=this.eat(Q._extends)?this.parseExprSubscripts():null},Ze.parseExport=function(g,T){if(this.next(),this.eat(Q.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(g.exported=this.parseIdent(!0),this.checkExport(T,g.exported.name,this.lastTokStart)):g.exported=null),this.expectContextual("from"),this.type!==Q.string&&this.unexpected(),g.source=this.parseExprAtom(),this.semicolon(),this.finishNode(g,"ExportAllDeclaration");if(this.eat(Q._default)){var K;if(this.checkExport(T,"default",this.lastTokStart),this.type===Q._function||(K=this.isAsyncFunction())){var D=this.startNode();this.next(),K&&this.next(),g.declaration=this.parseFunction(D,4|Tr,!1,K)}else if(this.type===Q._class){var ge=this.startNode();g.declaration=this.parseClass(ge,"nullableID")}else g.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(g,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())g.declaration=this.parseStatement(null),"VariableDeclaration"===g.declaration.type?this.checkVariableExport(T,g.declaration.declarations):this.checkExport(T,g.declaration.id.name,g.declaration.id.start),g.specifiers=[],g.source=null;else{if(g.declaration=null,g.specifiers=this.parseExportSpecifiers(T),this.eatContextual("from"))this.type!==Q.string&&this.unexpected(),g.source=this.parseExprAtom();else{for(var Fe=0,yt=g.specifiers;Fe<yt.length;Fe+=1){var Zt=yt[Fe];this.checkUnreserved(Zt.local),this.checkLocalExport(Zt.local)}g.source=null}this.semicolon()}return this.finishNode(g,"ExportNamedDeclaration")},Ze.checkExport=function(g,T,K){!g||(ir(g,T)&&this.raiseRecoverable(K,"Duplicate export '"+T+"'"),g[T]=!0)},Ze.checkPatternExport=function(g,T){var K=T.type;if("Identifier"===K)this.checkExport(g,T.name,T.start);else if("ObjectPattern"===K)for(var D=0,ge=T.properties;D<ge.length;D+=1)this.checkPatternExport(g,ge[D]);else if("ArrayPattern"===K)for(var yt=0,Zt=T.elements;yt<Zt.length;yt+=1){var Ft=Zt[yt];Ft&&this.checkPatternExport(g,Ft)}else"Property"===K?this.checkPatternExport(g,T.value):"AssignmentPattern"===K?this.checkPatternExport(g,T.left):"RestElement"===K?this.checkPatternExport(g,T.argument):"ParenthesizedExpression"===K&&this.checkPatternExport(g,T.expression)},Ze.checkVariableExport=function(g,T){if(g)for(var K=0,D=T;K<D.length;K+=1)this.checkPatternExport(g,D[K].id)},Ze.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},Ze.parseExportSpecifiers=function(g){var T=[],K=!0;for(this.expect(Q.braceL);!this.eat(Q.braceR);){if(K)K=!1;else if(this.expect(Q.comma),this.afterTrailingComma(Q.braceR))break;var D=this.startNode();D.local=this.parseIdent(!0),D.exported=this.eatContextual("as")?this.parseIdent(!0):D.local,this.checkExport(g,D.exported.name,D.exported.start),T.push(this.finishNode(D,"ExportSpecifier"))}return T},Ze.parseImport=function(g){return this.next(),this.type===Q.string?(g.specifiers=Jt,g.source=this.parseExprAtom()):(g.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),g.source=this.type===Q.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(g,"ImportDeclaration")},Ze.parseImportSpecifiers=function(){var g=[],T=!0;if(this.type===Q.name){var K=this.startNode();if(K.local=this.parseIdent(),this.checkLVal(K.local,2),g.push(this.finishNode(K,"ImportDefaultSpecifier")),!this.eat(Q.comma))return g}if(this.type===Q.star){var D=this.startNode();return this.next(),this.expectContextual("as"),D.local=this.parseIdent(),this.checkLVal(D.local,2),g.push(this.finishNode(D,"ImportNamespaceSpecifier")),g}for(this.expect(Q.braceL);!this.eat(Q.braceR);){if(T)T=!1;else if(this.expect(Q.comma),this.afterTrailingComma(Q.braceR))break;var ge=this.startNode();ge.imported=this.parseIdent(!0),this.eatContextual("as")?ge.local=this.parseIdent():(this.checkUnreserved(ge.imported),ge.local=ge.imported),this.checkLVal(ge.local,2),g.push(this.finishNode(ge,"ImportSpecifier"))}return g},Ze.adaptDirectivePrologue=function(g){for(var T=0;T<g.length&&this.isDirectiveCandidate(g[T]);++T)g[T].directive=g[T].expression.raw.slice(1,-1)},Ze.isDirectiveCandidate=function(g){return"ExpressionStatement"===g.type&&"Literal"===g.expression.type&&"string"==typeof g.expression.value&&('"'===this.input[g.start]||"'"===this.input[g.start])};var gr=Ge.prototype;gr.toAssignable=function(g,T,K){if(this.options.ecmaVersion>=6&&g)switch(g.type){case"Identifier":this.inAsync&&"await"===g.name&&this.raise(g.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":g.type="ObjectPattern",K&&this.checkPatternErrors(K,!0);for(var D=0,ge=g.properties;D<ge.length;D+=1){var Fe=ge[D];this.toAssignable(Fe,T),"RestElement"===Fe.type&&("ArrayPattern"===Fe.argument.type||"ObjectPattern"===Fe.argument.type)&&this.raise(Fe.argument.start,"Unexpected token")}break;case"Property":"init"!==g.kind&&this.raise(g.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(g.value,T);break;case"ArrayExpression":g.type="ArrayPattern",K&&this.checkPatternErrors(K,!0),this.toAssignableList(g.elements,T);break;case"SpreadElement":g.type="RestElement",this.toAssignable(g.argument,T),"AssignmentPattern"===g.argument.type&&this.raise(g.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==g.operator&&this.raise(g.left.end,"Only '=' operator can be used for specifying default value."),g.type="AssignmentPattern",delete g.operator,this.toAssignable(g.left,T);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(g.expression,T,K);break;case"ChainExpression":this.raiseRecoverable(g.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!T)break;default:this.raise(g.start,"Assigning to rvalue")}else K&&this.checkPatternErrors(K,!0);return g},gr.toAssignableList=function(g,T){for(var K=g.length,D=0;D<K;D++){var ge=g[D];ge&&this.toAssignable(ge,T)}if(K){var Fe=g[K-1];6===this.options.ecmaVersion&&T&&Fe&&"RestElement"===Fe.type&&"Identifier"!==Fe.argument.type&&this.unexpected(Fe.argument.start)}return g},gr.parseSpread=function(g){var T=this.startNode();return this.next(),T.argument=this.parseMaybeAssign(!1,g),this.finishNode(T,"SpreadElement")},gr.parseRestBinding=function(){var g=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==Q.name&&this.unexpected(),g.argument=this.parseBindingAtom(),this.finishNode(g,"RestElement")},gr.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Q.bracketL:var g=this.startNode();return this.next(),g.elements=this.parseBindingList(Q.bracketR,!0,!0),this.finishNode(g,"ArrayPattern");case Q.braceL:return this.parseObj(!0)}return this.parseIdent()},gr.parseBindingList=function(g,T,K){for(var D=[],ge=!0;!this.eat(g);)if(ge?ge=!1:this.expect(Q.comma),T&&this.type===Q.comma)D.push(null);else{if(K&&this.afterTrailingComma(g))break;if(this.type===Q.ellipsis){var Fe=this.parseRestBinding();this.parseBindingListItem(Fe),D.push(Fe),this.type===Q.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(g);break}var yt=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(yt),D.push(yt)}return D},gr.parseBindingListItem=function(g){return g},gr.parseMaybeDefault=function(g,T,K){if(K=K||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Q.eq))return K;var D=this.startNodeAt(g,T);return D.left=K,D.right=this.parseMaybeAssign(),this.finishNode(D,"AssignmentPattern")},gr.checkLVal=function(g,T,K){switch(void 0===T&&(T=0),g.type){case"Identifier":2===T&&"let"===g.name&&this.raiseRecoverable(g.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(g.name)&&this.raiseRecoverable(g.start,(T?"Binding ":"Assigning to ")+g.name+" in strict mode"),K&&(ir(K,g.name)&&this.raiseRecoverable(g.start,"Argument name clash"),K[g.name]=!0),0!==T&&5!==T&&this.declareName(g.name,T,g.start);break;case"ChainExpression":this.raiseRecoverable(g.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":T&&this.raiseRecoverable(g.start,"Binding member expression");break;case"ObjectPattern":for(var D=0,ge=g.properties;D<ge.length;D+=1)this.checkLVal(ge[D],T,K);break;case"Property":this.checkLVal(g.value,T,K);break;case"ArrayPattern":for(var yt=0,Zt=g.elements;yt<Zt.length;yt+=1){var Ft=Zt[yt];Ft&&this.checkLVal(Ft,T,K)}break;case"AssignmentPattern":this.checkLVal(g.left,T,K);break;case"RestElement":this.checkLVal(g.argument,T,K);break;case"ParenthesizedExpression":this.checkLVal(g.expression,T,K);break;default:this.raise(g.start,(T?"Binding":"Assigning to")+" rvalue")}};var sr=Ge.prototype;sr.checkPropClash=function(g,T,K){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===g.type||this.options.ecmaVersion>=6&&(g.computed||g.method||g.shorthand))){var ge,D=g.key;switch(D.type){case"Identifier":ge=D.name;break;case"Literal":ge=String(D.value);break;default:return}var Fe=g.kind;if(this.options.ecmaVersion>=6)return void("__proto__"===ge&&"init"===Fe&&(T.proto&&(K?K.doubleProto<0&&(K.doubleProto=D.start):this.raiseRecoverable(D.start,"Redefinition of __proto__ property")),T.proto=!0));var yt=T[ge="$"+ge];yt?("init"===Fe?this.strict&&yt.init||yt.get||yt.set:yt.init||yt[Fe])&&this.raiseRecoverable(D.start,"Redefinition of property"):yt=T[ge]={init:!1,get:!1,set:!1},yt[Fe]=!0}},sr.parseExpression=function(g,T){var K=this.start,D=this.startLoc,ge=this.parseMaybeAssign(g,T);if(this.type===Q.comma){var Fe=this.startNodeAt(K,D);for(Fe.expressions=[ge];this.eat(Q.comma);)Fe.expressions.push(this.parseMaybeAssign(g,T));return this.finishNode(Fe,"SequenceExpression")}return ge},sr.parseMaybeAssign=function(g,T,K){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(g);this.exprAllowed=!1}var D=!1,ge=-1,Fe=-1;T?(ge=T.parenthesizedAssign,Fe=T.trailingComma,T.parenthesizedAssign=T.trailingComma=-1):(T=new Z,D=!0);var yt=this.start,Zt=this.startLoc;(this.type===Q.parenL||this.type===Q.name)&&(this.potentialArrowAt=this.start);var Ft=this.parseMaybeConditional(g,T);if(K&&(Ft=K.call(this,Ft,yt,Zt)),this.type.isAssign){var Or=this.startNodeAt(yt,Zt);return Or.operator=this.value,Or.left=this.type===Q.eq?this.toAssignable(Ft,!1,T):Ft,D||(T.parenthesizedAssign=T.trailingComma=T.doubleProto=-1),T.shorthandAssign>=Or.left.start&&(T.shorthandAssign=-1),this.checkLVal(Ft),this.next(),Or.right=this.parseMaybeAssign(g),this.finishNode(Or,"AssignmentExpression")}return D&&this.checkExpressionErrors(T,!0),ge>-1&&(T.parenthesizedAssign=ge),Fe>-1&&(T.trailingComma=Fe),Ft},sr.parseMaybeConditional=function(g,T){var K=this.start,D=this.startLoc,ge=this.parseExprOps(g,T);if(this.checkExpressionErrors(T))return ge;if(this.eat(Q.question)){var Fe=this.startNodeAt(K,D);return Fe.test=ge,Fe.consequent=this.parseMaybeAssign(),this.expect(Q.colon),Fe.alternate=this.parseMaybeAssign(g),this.finishNode(Fe,"ConditionalExpression")}return ge},sr.parseExprOps=function(g,T){var K=this.start,D=this.startLoc,ge=this.parseMaybeUnary(T,!1);return this.checkExpressionErrors(T)||ge.start===K&&"ArrowFunctionExpression"===ge.type?ge:this.parseExprOp(ge,K,D,-1,g)},sr.parseExprOp=function(g,T,K,D,ge){var Fe=this.type.binop;if(null!=Fe&&(!ge||this.type!==Q._in)&&Fe>D){var yt=this.type===Q.logicalOR||this.type===Q.logicalAND,Zt=this.type===Q.coalesce;Zt&&(Fe=Q.logicalAND.binop);var Ft=this.value;this.next();var Or=this.start,zr=this.startLoc,Jn=this.parseExprOp(this.parseMaybeUnary(null,!1),Or,zr,Fe,ge),bi=this.buildBinary(T,K,g,Jn,Ft,yt||Zt);return(yt&&this.type===Q.coalesce||Zt&&(this.type===Q.logicalOR||this.type===Q.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(bi,T,K,D,ge)}return g},sr.buildBinary=function(g,T,K,D,ge,Fe){var yt=this.startNodeAt(g,T);return yt.left=K,yt.operator=ge,yt.right=D,this.finishNode(yt,Fe?"LogicalExpression":"BinaryExpression")},sr.parseMaybeUnary=function(g,T){var ge,K=this.start,D=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))ge=this.parseAwait(),T=!0;else if(this.type.prefix){var Fe=this.startNode(),yt=this.type===Q.incDec;Fe.operator=this.value,Fe.prefix=!0,this.next(),Fe.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(g,!0),yt?this.checkLVal(Fe.argument):this.strict&&"delete"===Fe.operator&&"Identifier"===Fe.argument.type?this.raiseRecoverable(Fe.start,"Deleting local variable in strict mode"):T=!0,ge=this.finishNode(Fe,yt?"UpdateExpression":"UnaryExpression")}else{if(ge=this.parseExprSubscripts(g),this.checkExpressionErrors(g))return ge;for(;this.type.postfix&&!this.canInsertSemicolon();){var Zt=this.startNodeAt(K,D);Zt.operator=this.value,Zt.prefix=!1,Zt.argument=ge,this.checkLVal(ge),this.next(),ge=this.finishNode(Zt,"UpdateExpression")}}return!T&&this.eat(Q.starstar)?this.buildBinary(K,D,ge,this.parseMaybeUnary(null,!1),"**",!1):ge},sr.parseExprSubscripts=function(g){var T=this.start,K=this.startLoc,D=this.parseExprAtom(g);if("ArrowFunctionExpression"===D.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return D;var ge=this.parseSubscripts(D,T,K);return g&&"MemberExpression"===ge.type&&(g.parenthesizedAssign>=ge.start&&(g.parenthesizedAssign=-1),g.parenthesizedBind>=ge.start&&(g.parenthesizedBind=-1)),ge},sr.parseSubscripts=function(g,T,K,D){for(var ge=this.options.ecmaVersion>=8&&"Identifier"===g.type&&"async"===g.name&&this.lastTokEnd===g.end&&!this.canInsertSemicolon()&&g.end-g.start==5&&this.potentialArrowAt===g.start,Fe=!1;;){var yt=this.parseSubscript(g,T,K,D,ge,Fe);if(yt.optional&&(Fe=!0),yt===g||"ArrowFunctionExpression"===yt.type){if(Fe){var Zt=this.startNodeAt(T,K);Zt.expression=yt,yt=this.finishNode(Zt,"ChainExpression")}return yt}g=yt}},sr.parseSubscript=function(g,T,K,D,ge,Fe){var yt=this.options.ecmaVersion>=11,Zt=yt&&this.eat(Q.questionDot);D&&Zt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Ft=this.eat(Q.bracketL);if(Ft||Zt&&this.type!==Q.parenL&&this.type!==Q.backQuote||this.eat(Q.dot)){var Or=this.startNodeAt(T,K);Or.object=g,Or.property=Ft?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),Or.computed=!!Ft,Ft&&this.expect(Q.bracketR),yt&&(Or.optional=Zt),g=this.finishNode(Or,"MemberExpression")}else if(!D&&this.eat(Q.parenL)){var zr=new Z,Jn=this.yieldPos,bi=this.awaitPos,pi=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var oa=this.parseExprList(Q.parenR,this.options.ecmaVersion>=8,!1,zr);if(ge&&!Zt&&!this.canInsertSemicolon()&&this.eat(Q.arrow))return this.checkPatternErrors(zr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Jn,this.awaitPos=bi,this.awaitIdentPos=pi,this.parseArrowExpression(this.startNodeAt(T,K),oa,!0);this.checkExpressionErrors(zr,!0),this.yieldPos=Jn||this.yieldPos,this.awaitPos=bi||this.awaitPos,this.awaitIdentPos=pi||this.awaitIdentPos;var Ea=this.startNodeAt(T,K);Ea.callee=g,Ea.arguments=oa,yt&&(Ea.optional=Zt),g=this.finishNode(Ea,"CallExpression")}else if(this.type===Q.backQuote){(Zt||Fe)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Fa=this.startNodeAt(T,K);Fa.tag=g,Fa.quasi=this.parseTemplate({isTagged:!0}),g=this.finishNode(Fa,"TaggedTemplateExpression")}return g},sr.parseExprAtom=function(g){this.type===Q.slash&&this.readRegexp();var T,K=this.potentialArrowAt===this.start;switch(this.type){case Q._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),T=this.startNode(),this.next(),this.type===Q.parenL&&!this.allowDirectSuper&&this.raise(T.start,"super() call outside constructor of a subclass"),this.type!==Q.dot&&this.type!==Q.bracketL&&this.type!==Q.parenL&&this.unexpected(),this.finishNode(T,"Super");case Q._this:return T=this.startNode(),this.next(),this.finishNode(T,"ThisExpression");case Q.name:var D=this.start,ge=this.startLoc,Fe=this.containsEsc,yt=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Fe&&"async"===yt.name&&!this.canInsertSemicolon()&&this.eat(Q._function))return this.parseFunction(this.startNodeAt(D,ge),0,!1,!0);if(K&&!this.canInsertSemicolon()){if(this.eat(Q.arrow))return this.parseArrowExpression(this.startNodeAt(D,ge),[yt],!1);if(this.options.ecmaVersion>=8&&"async"===yt.name&&this.type===Q.name&&!Fe)return yt=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(Q.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(D,ge),[yt],!0)}return yt;case Q.regexp:var Zt=this.value;return(T=this.parseLiteral(Zt.value)).regex={pattern:Zt.pattern,flags:Zt.flags},T;case Q.num:case Q.string:return this.parseLiteral(this.value);case Q._null:case Q._true:case Q._false:return(T=this.startNode()).value=this.type===Q._null?null:this.type===Q._true,T.raw=this.type.keyword,this.next(),this.finishNode(T,"Literal");case Q.parenL:var Ft=this.start,Or=this.parseParenAndDistinguishExpression(K);return g&&(g.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Or)&&(g.parenthesizedAssign=Ft),g.parenthesizedBind<0&&(g.parenthesizedBind=Ft)),Or;case Q.bracketL:return T=this.startNode(),this.next(),T.elements=this.parseExprList(Q.bracketR,!0,!0,g),this.finishNode(T,"ArrayExpression");case Q.braceL:return this.parseObj(!1,g);case Q._function:return T=this.startNode(),this.next(),this.parseFunction(T,0);case Q._class:return this.parseClass(this.startNode(),!1);case Q._new:return this.parseNew();case Q.backQuote:return this.parseTemplate();case Q._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},sr.parseExprImport=function(){var g=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var T=this.parseIdent(!0);switch(this.type){case Q.parenL:return this.parseDynamicImport(g);case Q.dot:return g.meta=T,this.parseImportMeta(g);default:this.unexpected()}},sr.parseDynamicImport=function(g){if(this.next(),g.source=this.parseMaybeAssign(),!this.eat(Q.parenR)){var T=this.start;this.eat(Q.comma)&&this.eat(Q.parenR)?this.raiseRecoverable(T,"Trailing comma is not allowed in import()"):this.unexpected(T)}return this.finishNode(g,"ImportExpression")},sr.parseImportMeta=function(g){this.next();var T=this.containsEsc;return g.property=this.parseIdent(!0),"meta"!==g.property.name&&this.raiseRecoverable(g.property.start,"The only valid meta property for import is 'import.meta'"),T&&this.raiseRecoverable(g.start,"'import.meta' must not contain escaped characters"),"module"!==this.options.sourceType&&this.raiseRecoverable(g.start,"Cannot use 'import.meta' outside a module"),this.finishNode(g,"MetaProperty")},sr.parseLiteral=function(g){var T=this.startNode();return T.value=g,T.raw=this.input.slice(this.start,this.end),110===T.raw.charCodeAt(T.raw.length-1)&&(T.bigint=T.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(T,"Literal")},sr.parseParenExpression=function(){this.expect(Q.parenL);var g=this.parseExpression();return this.expect(Q.parenR),g},sr.parseParenAndDistinguishExpression=function(g){var D,T=this.start,K=this.startLoc,ge=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var pi,Fe=this.start,yt=this.startLoc,Zt=[],Ft=!0,Or=!1,zr=new Z,Jn=this.yieldPos,bi=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==Q.parenR;){if(Ft?Ft=!1:this.expect(Q.comma),ge&&this.afterTrailingComma(Q.parenR,!0)){Or=!0;break}if(this.type===Q.ellipsis){pi=this.start,Zt.push(this.parseParenItem(this.parseRestBinding())),this.type===Q.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}Zt.push(this.parseMaybeAssign(!1,zr,this.parseParenItem))}var oa=this.start,Ea=this.startLoc;if(this.expect(Q.parenR),g&&!this.canInsertSemicolon()&&this.eat(Q.arrow))return this.checkPatternErrors(zr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Jn,this.awaitPos=bi,this.parseParenArrowList(T,K,Zt);(!Zt.length||Or)&&this.unexpected(this.lastTokStart),pi&&this.unexpected(pi),this.checkExpressionErrors(zr,!0),this.yieldPos=Jn||this.yieldPos,this.awaitPos=bi||this.awaitPos,Zt.length>1?((D=this.startNodeAt(Fe,yt)).expressions=Zt,this.finishNodeAt(D,"SequenceExpression",oa,Ea)):D=Zt[0]}else D=this.parseParenExpression();if(this.options.preserveParens){var Fa=this.startNodeAt(T,K);return Fa.expression=D,this.finishNode(Fa,"ParenthesizedExpression")}return D},sr.parseParenItem=function(g){return g},sr.parseParenArrowList=function(g,T,K){return this.parseArrowExpression(this.startNodeAt(g,T),K)};var dr=[];sr.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var g=this.startNode(),T=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(Q.dot)){g.meta=T;var K=this.containsEsc;return g.property=this.parseIdent(!0),"target"!==g.property.name&&this.raiseRecoverable(g.property.start,"The only valid meta property for new is 'new.target'"),K&&this.raiseRecoverable(g.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(g.start,"'new.target' can only be used in functions"),this.finishNode(g,"MetaProperty")}var D=this.start,ge=this.startLoc,Fe=this.type===Q._import;return g.callee=this.parseSubscripts(this.parseExprAtom(),D,ge,!0),Fe&&"ImportExpression"===g.callee.type&&this.raise(D,"Cannot use new with import()"),g.arguments=this.eat(Q.parenL)?this.parseExprList(Q.parenR,this.options.ecmaVersion>=8,!1):dr,this.finishNode(g,"NewExpression")},sr.parseTemplateElement=function(g){var T=g.isTagged,K=this.startNode();return this.type===Q.invalidTemplate?(T||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),K.value={raw:this.value,cooked:null}):K.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),K.tail=this.type===Q.backQuote,this.finishNode(K,"TemplateElement")},sr.parseTemplate=function(g){void 0===g&&(g={});var T=g.isTagged;void 0===T&&(T=!1);var K=this.startNode();this.next(),K.expressions=[];var D=this.parseTemplateElement({isTagged:T});for(K.quasis=[D];!D.tail;)this.type===Q.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Q.dollarBraceL),K.expressions.push(this.parseExpression()),this.expect(Q.braceR),K.quasis.push(D=this.parseTemplateElement({isTagged:T}));return this.next(),this.finishNode(K,"TemplateLiteral")},sr.isAsyncProp=function(g){return!g.computed&&"Identifier"===g.key.type&&"async"===g.key.name&&(this.type===Q.name||this.type===Q.num||this.type===Q.string||this.type===Q.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Q.star)&&!Ut.test(this.input.slice(this.lastTokEnd,this.start))},sr.parseObj=function(g,T){var K=this.startNode(),D=!0,ge={};for(K.properties=[],this.next();!this.eat(Q.braceR);){if(D)D=!1;else if(this.expect(Q.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Q.braceR))break;var Fe=this.parseProperty(g,T);g||this.checkPropClash(Fe,ge,T),K.properties.push(Fe)}return this.finishNode(K,g?"ObjectPattern":"ObjectExpression")},sr.parseProperty=function(g,T){var D,ge,Fe,yt,K=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(Q.ellipsis))return g?(K.argument=this.parseIdent(!1),this.type===Q.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(K,"RestElement")):(this.type===Q.parenL&&T&&(T.parenthesizedAssign<0&&(T.parenthesizedAssign=this.start),T.parenthesizedBind<0&&(T.parenthesizedBind=this.start)),K.argument=this.parseMaybeAssign(!1,T),this.type===Q.comma&&T&&T.trailingComma<0&&(T.trailingComma=this.start),this.finishNode(K,"SpreadElement"));this.options.ecmaVersion>=6&&(K.method=!1,K.shorthand=!1,(g||T)&&(Fe=this.start,yt=this.startLoc),g||(D=this.eat(Q.star)));var Zt=this.containsEsc;return this.parsePropertyName(K),!g&&!Zt&&this.options.ecmaVersion>=8&&!D&&this.isAsyncProp(K)?(ge=!0,D=this.options.ecmaVersion>=9&&this.eat(Q.star),this.parsePropertyName(K,T)):ge=!1,this.parsePropertyValue(K,g,D,ge,Fe,yt,T,Zt),this.finishNode(K,"Property")},sr.parsePropertyValue=function(g,T,K,D,ge,Fe,yt,Zt){if((K||D)&&this.type===Q.colon&&this.unexpected(),this.eat(Q.colon))g.value=T?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,yt),g.kind="init";else if(this.options.ecmaVersion>=6&&this.type===Q.parenL)T&&this.unexpected(),g.kind="init",g.method=!0,g.value=this.parseMethod(K,D);else if(T||Zt||!(this.options.ecmaVersion>=5)||g.computed||"Identifier"!==g.key.type||"get"!==g.key.name&&"set"!==g.key.name||this.type===Q.comma||this.type===Q.braceR||this.type===Q.eq)this.options.ecmaVersion>=6&&!g.computed&&"Identifier"===g.key.type?((K||D)&&this.unexpected(),this.checkUnreserved(g.key),"await"===g.key.name&&!this.awaitIdentPos&&(this.awaitIdentPos=ge),g.kind="init",T?g.value=this.parseMaybeDefault(ge,Fe,g.key):this.type===Q.eq&&yt?(yt.shorthandAssign<0&&(yt.shorthandAssign=this.start),g.value=this.parseMaybeDefault(ge,Fe,g.key)):g.value=g.key,g.shorthand=!0):this.unexpected();else{if((K||D)&&this.unexpected(),g.kind=g.key.name,this.parsePropertyName(g),g.value=this.parseMethod(!1),g.value.params.length!==("get"===g.kind?0:1))this.raiseRecoverable(g.value.start,"get"===g.kind?"getter should have no params":"setter should have exactly one param");else"set"===g.kind&&"RestElement"===g.value.params[0].type&&this.raiseRecoverable(g.value.params[0].start,"Setter cannot use rest params")}},sr.parsePropertyName=function(g){if(this.options.ecmaVersion>=6){if(this.eat(Q.bracketL))return g.computed=!0,g.key=this.parseMaybeAssign(),this.expect(Q.bracketR),g.key;g.computed=!1}return g.key=this.type===Q.num||this.type===Q.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},sr.initFunction=function(g){g.id=null,this.options.ecmaVersion>=6&&(g.generator=g.expression=!1),this.options.ecmaVersion>=8&&(g.async=!1)},sr.parseMethod=function(g,T,K){var D=this.startNode(),ge=this.yieldPos,Fe=this.awaitPos,yt=this.awaitIdentPos;return this.initFunction(D),this.options.ecmaVersion>=6&&(D.generator=g),this.options.ecmaVersion>=8&&(D.async=!!T),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|Pr(T,D.generator)|(K?128:0)),this.expect(Q.parenL),D.params=this.parseBindingList(Q.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(D,!1,!0),this.yieldPos=ge,this.awaitPos=Fe,this.awaitIdentPos=yt,this.finishNode(D,"FunctionExpression")},sr.parseArrowExpression=function(g,T,K){var D=this.yieldPos,ge=this.awaitPos,Fe=this.awaitIdentPos;return this.enterScope(16|Pr(K,!1)),this.initFunction(g),this.options.ecmaVersion>=8&&(g.async=!!K),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,g.params=this.toAssignableList(T,!0),this.parseFunctionBody(g,!0,!1),this.yieldPos=D,this.awaitPos=ge,this.awaitIdentPos=Fe,this.finishNode(g,"ArrowFunctionExpression")},sr.parseFunctionBody=function(g,T,K){var ge=this.strict,Fe=!1;if(T&&this.type!==Q.braceL)g.body=this.parseMaybeAssign(),g.expression=!0,this.checkParams(g,!1);else{var yt=this.options.ecmaVersion>=7&&!this.isSimpleParamList(g.params);(!ge||yt)&&(Fe=this.strictDirective(this.end))&&yt&&this.raiseRecoverable(g.start,"Illegal 'use strict' directive in function with non-simple parameter list");var Zt=this.labels;this.labels=[],Fe&&(this.strict=!0),this.checkParams(g,!ge&&!Fe&&!T&&!K&&this.isSimpleParamList(g.params)),this.strict&&g.id&&this.checkLVal(g.id,5),g.body=this.parseBlock(!1,void 0,Fe&&!ge),g.expression=!1,this.adaptDirectivePrologue(g.body.body),this.labels=Zt}this.exitScope()},sr.isSimpleParamList=function(g){for(var T=0,K=g;T<K.length;T+=1)if("Identifier"!==K[T].type)return!1;return!0},sr.checkParams=function(g,T){for(var K={},D=0,ge=g.params;D<ge.length;D+=1)this.checkLVal(ge[D],1,T?null:K)},sr.parseExprList=function(g,T,K,D){for(var ge=[],Fe=!0;!this.eat(g);){if(Fe)Fe=!1;else if(this.expect(Q.comma),T&&this.afterTrailingComma(g))break;var yt=void 0;K&&this.type===Q.comma?yt=null:this.type===Q.ellipsis?(yt=this.parseSpread(D),D&&this.type===Q.comma&&D.trailingComma<0&&(D.trailingComma=this.start)):yt=this.parseMaybeAssign(!1,D),ge.push(yt)}return ge},sr.checkUnreserved=function(g){var T=g.start,K=g.end,D=g.name;this.inGenerator&&"yield"===D&&this.raiseRecoverable(T,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===D&&this.raiseRecoverable(T,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(D)&&this.raise(T,"Unexpected keyword '"+D+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(T,K).indexOf("\\")||(this.strict?this.reservedWordsStrict:this.reservedWords).test(D)&&(!this.inAsync&&"await"===D&&this.raiseRecoverable(T,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(T,"The keyword '"+D+"' is reserved"))},sr.parseIdent=function(g,T){var K=this.startNode();return this.type===Q.name?K.name=this.value:this.type.keyword?(K.name=this.type.keyword,("class"===K.name||"function"===K.name)&&(this.lastTokEnd!==this.lastTokStart+1||46!==this.input.charCodeAt(this.lastTokStart))&&this.context.pop()):this.unexpected(),this.next(!!g),this.finishNode(K,"Identifier"),g||(this.checkUnreserved(K),"await"===K.name&&!this.awaitIdentPos&&(this.awaitIdentPos=K.start)),K},sr.parseYield=function(g){this.yieldPos||(this.yieldPos=this.start);var T=this.startNode();return this.next(),this.type===Q.semi||this.canInsertSemicolon()||this.type!==Q.star&&!this.type.startsExpr?(T.delegate=!1,T.argument=null):(T.delegate=this.eat(Q.star),T.argument=this.parseMaybeAssign(g)),this.finishNode(T,"YieldExpression")},sr.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var g=this.startNode();return this.next(),g.argument=this.parseMaybeUnary(null,!1),this.finishNode(g,"AwaitExpression")};var mn=Ge.prototype;mn.raise=function(g,T){var K=Ie(this.input,g),D=new SyntaxError(T+=" ("+K.line+":"+K.column+")");throw D.pos=g,D.loc=K,D.raisedAt=this.pos,D},mn.raiseRecoverable=mn.raise,mn.curPosition=function(){if(this.options.locations)return new ae(this.curLine,this.pos-this.lineStart)};var On=Ge.prototype,mi=function(T){this.flags=T,this.var=[],this.lexical=[],this.functions=[]};On.enterScope=function(g){this.scopeStack.push(new mi(g))},On.exitScope=function(){this.scopeStack.pop()},On.treatFunctionsAsVarInScope=function(g){return 2&g.flags||!this.inModule&&1&g.flags},On.declareName=function(g,T,K){var D=!1;if(2===T){var ge=this.currentScope();D=ge.lexical.indexOf(g)>-1||ge.functions.indexOf(g)>-1||ge.var.indexOf(g)>-1,ge.lexical.push(g),this.inModule&&1&ge.flags&&delete this.undefinedExports[g]}else if(4===T)this.currentScope().lexical.push(g);else if(3===T){var yt=this.currentScope();D=this.treatFunctionsAsVar?yt.lexical.indexOf(g)>-1:yt.lexical.indexOf(g)>-1||yt.var.indexOf(g)>-1,yt.functions.push(g)}else for(var Zt=this.scopeStack.length-1;Zt>=0;--Zt){var Ft=this.scopeStack[Zt];if(Ft.lexical.indexOf(g)>-1&&!(32&Ft.flags&&Ft.lexical[0]===g)||!this.treatFunctionsAsVarInScope(Ft)&&Ft.functions.indexOf(g)>-1){D=!0;break}if(Ft.var.push(g),this.inModule&&1&Ft.flags&&delete this.undefinedExports[g],3&Ft.flags)break}D&&this.raiseRecoverable(K,"Identifier '"+g+"' has already been declared")},On.checkLocalExport=function(g){-1===this.scopeStack[0].lexical.indexOf(g.name)&&-1===this.scopeStack[0].var.indexOf(g.name)&&(this.undefinedExports[g.name]=g)},On.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},On.currentVarScope=function(){for(var g=this.scopeStack.length-1;;g--){var T=this.scopeStack[g];if(3&T.flags)return T}},On.currentThisScope=function(){for(var g=this.scopeStack.length-1;;g--){var T=this.scopeStack[g];if(3&T.flags&&!(16&T.flags))return T}};var hi=function(T,K,D){this.type="",this.start=K,this.end=0,T.options.locations&&(this.loc=new me(T,D)),T.options.directSourceFile&&(this.sourceFile=T.options.directSourceFile),T.options.ranges&&(this.range=[K,0])},si=Ge.prototype;function ai(g,T,K,D){return g.type=T,g.end=K,this.options.locations&&(g.loc.end=D),this.options.ranges&&(g.range[1]=K),g}si.startNode=function(){return new hi(this,this.start,this.startLoc)},si.startNodeAt=function(g,T){return new hi(this,g,T)},si.finishNode=function(g,T){return ai.call(this,g,T,this.lastTokEnd,this.lastTokEndLoc)},si.finishNodeAt=function(g,T,K,D){return ai.call(this,g,T,K,D)};var Yi=function(T,K,D,ge,Fe){this.token=T,this.isExpr=!!K,this.preserveSpace=!!D,this.override=ge,this.generator=!!Fe},Pi={b_stat:new Yi("{",!1),b_expr:new Yi("{",!0),b_tmpl:new Yi("${",!1),p_stat:new Yi("(",!1),p_expr:new Yi("(",!0),q_tmpl:new Yi("`",!0,!0,function(g){return g.tryReadTemplateToken()}),f_stat:new Yi("function",!1),f_expr:new Yi("function",!0),f_expr_gen:new Yi("function",!0,!1,null,!0),f_gen:new Yi("function",!1,!1,null,!0)},Ei=Ge.prototype;Ei.initialContext=function(){return[Pi.b_stat]},Ei.braceIsBlock=function(g){var T=this.curContext();return T===Pi.f_expr||T===Pi.f_stat||(g!==Q.colon||T!==Pi.b_stat&&T!==Pi.b_expr?g===Q._return||g===Q.name&&this.exprAllowed?Ut.test(this.input.slice(this.lastTokEnd,this.start)):g===Q._else||g===Q.semi||g===Q.eof||g===Q.parenR||g===Q.arrow||(g===Q.braceL?T===Pi.b_stat:g!==Q._var&&g!==Q._const&&g!==Q.name&&!this.exprAllowed):!T.isExpr)},Ei.inGeneratorContext=function(){for(var g=this.context.length-1;g>=1;g--){var T=this.context[g];if("function"===T.token)return T.generator}return!1},Ei.updateContext=function(g){var T,K=this.type;K.keyword&&g===Q.dot?this.exprAllowed=!1:(T=K.updateContext)?T.call(this,g):this.exprAllowed=K.beforeExpr},Q.parenR.updateContext=Q.braceR.updateContext=function(){if(1!==this.context.length){var g=this.context.pop();g===Pi.b_stat&&"function"===this.curContext().token&&(g=this.context.pop()),this.exprAllowed=!g.isExpr}else this.exprAllowed=!0},Q.braceL.updateContext=function(g){this.context.push(this.braceIsBlock(g)?Pi.b_stat:Pi.b_expr),this.exprAllowed=!0},Q.dollarBraceL.updateContext=function(){this.context.push(Pi.b_tmpl),this.exprAllowed=!0},Q.parenL.updateContext=function(g){this.context.push(g===Q._if||g===Q._for||g===Q._with||g===Q._while?Pi.p_stat:Pi.p_expr),this.exprAllowed=!0},Q.incDec.updateContext=function(){},Q._function.updateContext=Q._class.updateContext=function(g){!g.beforeExpr||g===Q.semi||g===Q._else||g===Q._return&&Ut.test(this.input.slice(this.lastTokEnd,this.start))||(g===Q.colon||g===Q.braceL)&&this.curContext()===Pi.b_stat?this.context.push(Pi.f_stat):this.context.push(Pi.f_expr),this.exprAllowed=!1},Q.backQuote.updateContext=function(){this.curContext()===Pi.q_tmpl?this.context.pop():this.context.push(Pi.q_tmpl),this.exprAllowed=!1},Q.star.updateContext=function(g){if(g===Q._function){var T=this.context.length-1;this.context[T]=this.context[T]===Pi.f_expr?Pi.f_expr_gen:Pi.f_gen}this.exprAllowed=!0},Q.name.updateContext=function(g){var T=!1;this.options.ecmaVersion>=6&&g!==Q.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(T=!0),this.exprAllowed=T};var re="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",G={9:re,10:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic",11:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic"},oe="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",xe="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Ae={9:xe,10:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",11:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},Tt={};function wr(g){var T=Tt[g]={binary:ce(G[g]+" "+oe),nonBinary:{General_Category:ce(oe),Script:ce(Ae[g])}};T.nonBinary.Script_Extensions=T.nonBinary.Script,T.nonBinary.gc=T.nonBinary.General_Category,T.nonBinary.sc=T.nonBinary.Script,T.nonBinary.scx=T.nonBinary.Script_Extensions}wr(9),wr(10),wr(11);var Kt=Ge.prototype,ar=function(T){this.parser=T,this.validFlags="gim"+(T.options.ecmaVersion>=6?"uy":"")+(T.options.ecmaVersion>=9?"s":""),this.unicodeProperties=Tt[T.options.ecmaVersion>=11?11:T.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function Br(g){return g<=65535?String.fromCharCode(g):(g-=65536,String.fromCharCode(55296+(g>>10),56320+(1023&g)))}function Rn(g){return 36===g||g>=40&&g<=43||46===g||63===g||g>=91&&g<=94||g>=123&&g<=125}function Sn(g){return g>=65&&g<=90||g>=97&&g<=122}function Di(g){return Sn(g)||95===g}function _n(g){return Di(g)||Oi(g)}function Oi(g){return g>=48&&g<=57}function ta(g){return g>=48&&g<=57||g>=65&&g<=70||g>=97&&g<=102}function oi(g){return g>=65&&g<=70?g-65+10:g>=97&&g<=102?g-97+10:g-48}function Ji(g){return g>=48&&g<=55}ar.prototype.reset=function(T,K,D){var ge=-1!==D.indexOf("u");this.start=0|T,this.source=K+"",this.flags=D,this.switchU=ge&&this.parser.options.ecmaVersion>=6,this.switchN=ge&&this.parser.options.ecmaVersion>=9},ar.prototype.raise=function(T){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+T)},ar.prototype.at=function(T,K){void 0===K&&(K=!1);var D=this.source,ge=D.length;if(T>=ge)return-1;var Fe=D.charCodeAt(T);if(!K&&!this.switchU||Fe<=55295||Fe>=57344||T+1>=ge)return Fe;var yt=D.charCodeAt(T+1);return yt>=56320&&yt<=57343?(Fe<<10)+yt-56613888:Fe},ar.prototype.nextIndex=function(T,K){void 0===K&&(K=!1);var D=this.source,ge=D.length;if(T>=ge)return ge;var yt,Fe=D.charCodeAt(T);return!K&&!this.switchU||Fe<=55295||Fe>=57344||T+1>=ge||(yt=D.charCodeAt(T+1))<56320||yt>57343?T+1:T+2},ar.prototype.current=function(T){return void 0===T&&(T=!1),this.at(this.pos,T)},ar.prototype.lookahead=function(T){return void 0===T&&(T=!1),this.at(this.nextIndex(this.pos,T),T)},ar.prototype.advance=function(T){void 0===T&&(T=!1),this.pos=this.nextIndex(this.pos,T)},ar.prototype.eat=function(T,K){return void 0===K&&(K=!1),this.current(K)===T&&(this.advance(K),!0)},Kt.validateRegExpFlags=function(g){for(var T=g.validFlags,K=g.flags,D=0;D<K.length;D++){var ge=K.charAt(D);-1===T.indexOf(ge)&&this.raise(g.start,"Invalid regular expression flag"),K.indexOf(ge,D+1)>-1&&this.raise(g.start,"Duplicate regular expression flag")}},Kt.validateRegExpPattern=function(g){this.regexp_pattern(g),!g.switchN&&this.options.ecmaVersion>=9&&g.groupNames.length>0&&(g.switchN=!0,this.regexp_pattern(g))},Kt.regexp_pattern=function(g){g.pos=0,g.lastIntValue=0,g.lastStringValue="",g.lastAssertionIsQuantifiable=!1,g.numCapturingParens=0,g.maxBackReference=0,g.groupNames.length=0,g.backReferenceNames.length=0,this.regexp_disjunction(g),g.pos!==g.source.length&&(g.eat(41)&&g.raise("Unmatched ')'"),(g.eat(93)||g.eat(125))&&g.raise("Lone quantifier brackets")),g.maxBackReference>g.numCapturingParens&&g.raise("Invalid escape");for(var T=0,K=g.backReferenceNames;T<K.length;T+=1)-1===g.groupNames.indexOf(K[T])&&g.raise("Invalid named capture referenced")},Kt.regexp_disjunction=function(g){for(this.regexp_alternative(g);g.eat(124);)this.regexp_alternative(g);this.regexp_eatQuantifier(g,!0)&&g.raise("Nothing to repeat"),g.eat(123)&&g.raise("Lone quantifier brackets")},Kt.regexp_alternative=function(g){for(;g.pos<g.source.length&&this.regexp_eatTerm(g););},Kt.regexp_eatTerm=function(g){return this.regexp_eatAssertion(g)?(g.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(g)&&g.switchU&&g.raise("Invalid quantifier"),!0):!!(g.switchU?this.regexp_eatAtom(g):this.regexp_eatExtendedAtom(g))&&(this.regexp_eatQuantifier(g),!0)},Kt.regexp_eatAssertion=function(g){var T=g.pos;if(g.lastAssertionIsQuantifiable=!1,g.eat(94)||g.eat(36))return!0;if(g.eat(92)){if(g.eat(66)||g.eat(98))return!0;g.pos=T}if(g.eat(40)&&g.eat(63)){var K=!1;if(this.options.ecmaVersion>=9&&(K=g.eat(60)),g.eat(61)||g.eat(33))return this.regexp_disjunction(g),g.eat(41)||g.raise("Unterminated group"),g.lastAssertionIsQuantifiable=!K,!0}return g.pos=T,!1},Kt.regexp_eatQuantifier=function(g,T){return void 0===T&&(T=!1),!!this.regexp_eatQuantifierPrefix(g,T)&&(g.eat(63),!0)},Kt.regexp_eatQuantifierPrefix=function(g,T){return g.eat(42)||g.eat(43)||g.eat(63)||this.regexp_eatBracedQuantifier(g,T)},Kt.regexp_eatBracedQuantifier=function(g,T){var K=g.pos;if(g.eat(123)){var D=0,ge=-1;if(this.regexp_eatDecimalDigits(g)&&(D=g.lastIntValue,g.eat(44)&&this.regexp_eatDecimalDigits(g)&&(ge=g.lastIntValue),g.eat(125)))return-1!==ge&&ge<D&&!T&&g.raise("numbers out of order in {} quantifier"),!0;g.switchU&&!T&&g.raise("Incomplete quantifier"),g.pos=K}return!1},Kt.regexp_eatAtom=function(g){return this.regexp_eatPatternCharacters(g)||g.eat(46)||this.regexp_eatReverseSolidusAtomEscape(g)||this.regexp_eatCharacterClass(g)||this.regexp_eatUncapturingGroup(g)||this.regexp_eatCapturingGroup(g)},Kt.regexp_eatReverseSolidusAtomEscape=function(g){var T=g.pos;if(g.eat(92)){if(this.regexp_eatAtomEscape(g))return!0;g.pos=T}return!1},Kt.regexp_eatUncapturingGroup=function(g){var T=g.pos;if(g.eat(40)){if(g.eat(63)&&g.eat(58)){if(this.regexp_disjunction(g),g.eat(41))return!0;g.raise("Unterminated group")}g.pos=T}return!1},Kt.regexp_eatCapturingGroup=function(g){if(g.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(g):63===g.current()&&g.raise("Invalid group"),this.regexp_disjunction(g),g.eat(41))return g.numCapturingParens+=1,!0;g.raise("Unterminated group")}return!1},Kt.regexp_eatExtendedAtom=function(g){return g.eat(46)||this.regexp_eatReverseSolidusAtomEscape(g)||this.regexp_eatCharacterClass(g)||this.regexp_eatUncapturingGroup(g)||this.regexp_eatCapturingGroup(g)||this.regexp_eatInvalidBracedQuantifier(g)||this.regexp_eatExtendedPatternCharacter(g)},Kt.regexp_eatInvalidBracedQuantifier=function(g){return this.regexp_eatBracedQuantifier(g,!0)&&g.raise("Nothing to repeat"),!1},Kt.regexp_eatSyntaxCharacter=function(g){var T=g.current();return!!Rn(T)&&(g.lastIntValue=T,g.advance(),!0)},Kt.regexp_eatPatternCharacters=function(g){for(var T=g.pos,K=0;-1!==(K=g.current())&&!Rn(K);)g.advance();return g.pos!==T},Kt.regexp_eatExtendedPatternCharacter=function(g){var T=g.current();return!(-1===T||36===T||T>=40&&T<=43||46===T||63===T||91===T||94===T||124===T||(g.advance(),0))},Kt.regexp_groupSpecifier=function(g){if(g.eat(63)){if(this.regexp_eatGroupName(g))return-1!==g.groupNames.indexOf(g.lastStringValue)&&g.raise("Duplicate capture group name"),void g.groupNames.push(g.lastStringValue);g.raise("Invalid group")}},Kt.regexp_eatGroupName=function(g){if(g.lastStringValue="",g.eat(60)){if(this.regexp_eatRegExpIdentifierName(g)&&g.eat(62))return!0;g.raise("Invalid capture group name")}return!1},Kt.regexp_eatRegExpIdentifierName=function(g){if(g.lastStringValue="",this.regexp_eatRegExpIdentifierStart(g)){for(g.lastStringValue+=Br(g.lastIntValue);this.regexp_eatRegExpIdentifierPart(g);)g.lastStringValue+=Br(g.lastIntValue);return!0}return!1},Kt.regexp_eatRegExpIdentifierStart=function(g){var T=g.pos,K=this.options.ecmaVersion>=11,D=g.current(K);return g.advance(K),92===D&&this.regexp_eatRegExpUnicodeEscapeSequence(g,K)&&(D=g.lastIntValue),function(g){return W(g,!0)||36===g||95===g}(D)?(g.lastIntValue=D,!0):(g.pos=T,!1)},Kt.regexp_eatRegExpIdentifierPart=function(g){var T=g.pos,K=this.options.ecmaVersion>=11,D=g.current(K);return g.advance(K),92===D&&this.regexp_eatRegExpUnicodeEscapeSequence(g,K)&&(D=g.lastIntValue),function(g){return Ye(g,!0)||36===g||95===g||8204===g||8205===g}(D)?(g.lastIntValue=D,!0):(g.pos=T,!1)},Kt.regexp_eatAtomEscape=function(g){return!!(this.regexp_eatBackReference(g)||this.regexp_eatCharacterClassEscape(g)||this.regexp_eatCharacterEscape(g)||g.switchN&&this.regexp_eatKGroupName(g))||(g.switchU&&(99===g.current()&&g.raise("Invalid unicode escape"),g.raise("Invalid escape")),!1)},Kt.regexp_eatBackReference=function(g){var T=g.pos;if(this.regexp_eatDecimalEscape(g)){var K=g.lastIntValue;if(g.switchU)return K>g.maxBackReference&&(g.maxBackReference=K),!0;if(K<=g.numCapturingParens)return!0;g.pos=T}return!1},Kt.regexp_eatKGroupName=function(g){if(g.eat(107)){if(this.regexp_eatGroupName(g))return g.backReferenceNames.push(g.lastStringValue),!0;g.raise("Invalid named reference")}return!1},Kt.regexp_eatCharacterEscape=function(g){return this.regexp_eatControlEscape(g)||this.regexp_eatCControlLetter(g)||this.regexp_eatZero(g)||this.regexp_eatHexEscapeSequence(g)||this.regexp_eatRegExpUnicodeEscapeSequence(g,!1)||!g.switchU&&this.regexp_eatLegacyOctalEscapeSequence(g)||this.regexp_eatIdentityEscape(g)},Kt.regexp_eatCControlLetter=function(g){var T=g.pos;if(g.eat(99)){if(this.regexp_eatControlLetter(g))return!0;g.pos=T}return!1},Kt.regexp_eatZero=function(g){return 48===g.current()&&!Oi(g.lookahead())&&(g.lastIntValue=0,g.advance(),!0)},Kt.regexp_eatControlEscape=function(g){var T=g.current();return 116===T?(g.lastIntValue=9,g.advance(),!0):110===T?(g.lastIntValue=10,g.advance(),!0):118===T?(g.lastIntValue=11,g.advance(),!0):102===T?(g.lastIntValue=12,g.advance(),!0):114===T&&(g.lastIntValue=13,g.advance(),!0)},Kt.regexp_eatControlLetter=function(g){var T=g.current();return!!Sn(T)&&(g.lastIntValue=T%32,g.advance(),!0)},Kt.regexp_eatRegExpUnicodeEscapeSequence=function(g,T){void 0===T&&(T=!1);var K=g.pos,D=T||g.switchU;if(g.eat(117)){if(this.regexp_eatFixedHexDigits(g,4)){var ge=g.lastIntValue;if(D&&ge>=55296&&ge<=56319){var Fe=g.pos;if(g.eat(92)&&g.eat(117)&&this.regexp_eatFixedHexDigits(g,4)){var yt=g.lastIntValue;if(yt>=56320&&yt<=57343)return g.lastIntValue=1024*(ge-55296)+(yt-56320)+65536,!0}g.pos=Fe,g.lastIntValue=ge}return!0}if(D&&g.eat(123)&&this.regexp_eatHexDigits(g)&&g.eat(125)&&function(g){return g>=0&&g<=1114111}(g.lastIntValue))return!0;D&&g.raise("Invalid unicode escape"),g.pos=K}return!1},Kt.regexp_eatIdentityEscape=function(g){if(g.switchU)return!!this.regexp_eatSyntaxCharacter(g)||!!g.eat(47)&&(g.lastIntValue=47,!0);var T=g.current();return!(99===T||g.switchN&&107===T||(g.lastIntValue=T,g.advance(),0))},Kt.regexp_eatDecimalEscape=function(g){g.lastIntValue=0;var T=g.current();if(T>=49&&T<=57){do{g.lastIntValue=10*g.lastIntValue+(T-48),g.advance()}while((T=g.current())>=48&&T<=57);return!0}return!1},Kt.regexp_eatCharacterClassEscape=function(g){var T=g.current();if(function(g){return 100===g||68===g||115===g||83===g||119===g||87===g}(T))return g.lastIntValue=-1,g.advance(),!0;if(g.switchU&&this.options.ecmaVersion>=9&&(80===T||112===T)){if(g.lastIntValue=-1,g.advance(),g.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(g)&&g.eat(125))return!0;g.raise("Invalid property name")}return!1},Kt.regexp_eatUnicodePropertyValueExpression=function(g){var T=g.pos;if(this.regexp_eatUnicodePropertyName(g)&&g.eat(61)){var K=g.lastStringValue;if(this.regexp_eatUnicodePropertyValue(g))return this.regexp_validateUnicodePropertyNameAndValue(g,K,g.lastStringValue),!0}return g.pos=T,!!this.regexp_eatLoneUnicodePropertyNameOrValue(g)&&(this.regexp_validateUnicodePropertyNameOrValue(g,g.lastStringValue),!0)},Kt.regexp_validateUnicodePropertyNameAndValue=function(g,T,K){ir(g.unicodeProperties.nonBinary,T)||g.raise("Invalid property name"),g.unicodeProperties.nonBinary[T].test(K)||g.raise("Invalid property value")},Kt.regexp_validateUnicodePropertyNameOrValue=function(g,T){g.unicodeProperties.binary.test(T)||g.raise("Invalid property name")},Kt.regexp_eatUnicodePropertyName=function(g){var T=0;for(g.lastStringValue="";Di(T=g.current());)g.lastStringValue+=Br(T),g.advance();return""!==g.lastStringValue},Kt.regexp_eatUnicodePropertyValue=function(g){var T=0;for(g.lastStringValue="";_n(T=g.current());)g.lastStringValue+=Br(T),g.advance();return""!==g.lastStringValue},Kt.regexp_eatLoneUnicodePropertyNameOrValue=function(g){return this.regexp_eatUnicodePropertyValue(g)},Kt.regexp_eatCharacterClass=function(g){if(g.eat(91)){if(g.eat(94),this.regexp_classRanges(g),g.eat(93))return!0;g.raise("Unterminated character class")}return!1},Kt.regexp_classRanges=function(g){for(;this.regexp_eatClassAtom(g);){var T=g.lastIntValue;if(g.eat(45)&&this.regexp_eatClassAtom(g)){var K=g.lastIntValue;g.switchU&&(-1===T||-1===K)&&g.raise("Invalid character class"),-1!==T&&-1!==K&&T>K&&g.raise("Range out of order in character class")}}},Kt.regexp_eatClassAtom=function(g){var T=g.pos;if(g.eat(92)){if(this.regexp_eatClassEscape(g))return!0;if(g.switchU){var K=g.current();(99===K||Ji(K))&&g.raise("Invalid class escape"),g.raise("Invalid escape")}g.pos=T}var D=g.current();return 93!==D&&(g.lastIntValue=D,g.advance(),!0)},Kt.regexp_eatClassEscape=function(g){var T=g.pos;if(g.eat(98))return g.lastIntValue=8,!0;if(g.switchU&&g.eat(45))return g.lastIntValue=45,!0;if(!g.switchU&&g.eat(99)){if(this.regexp_eatClassControlLetter(g))return!0;g.pos=T}return this.regexp_eatCharacterClassEscape(g)||this.regexp_eatCharacterEscape(g)},Kt.regexp_eatClassControlLetter=function(g){var T=g.current();return!(!Oi(T)&&95!==T||(g.lastIntValue=T%32,g.advance(),0))},Kt.regexp_eatHexEscapeSequence=function(g){var T=g.pos;if(g.eat(120)){if(this.regexp_eatFixedHexDigits(g,2))return!0;g.switchU&&g.raise("Invalid escape"),g.pos=T}return!1},Kt.regexp_eatDecimalDigits=function(g){var T=g.pos,K=0;for(g.lastIntValue=0;Oi(K=g.current());)g.lastIntValue=10*g.lastIntValue+(K-48),g.advance();return g.pos!==T},Kt.regexp_eatHexDigits=function(g){var T=g.pos,K=0;for(g.lastIntValue=0;ta(K=g.current());)g.lastIntValue=16*g.lastIntValue+oi(K),g.advance();return g.pos!==T},Kt.regexp_eatLegacyOctalEscapeSequence=function(g){if(this.regexp_eatOctalDigit(g)){var T=g.lastIntValue;if(this.regexp_eatOctalDigit(g)){var K=g.lastIntValue;g.lastIntValue=T<=3&&this.regexp_eatOctalDigit(g)?64*T+8*K+g.lastIntValue:8*T+K}else g.lastIntValue=T;return!0}return!1},Kt.regexp_eatOctalDigit=function(g){var T=g.current();return Ji(T)?(g.lastIntValue=T-48,g.advance(),!0):(g.lastIntValue=0,!1)},Kt.regexp_eatFixedHexDigits=function(g,T){var K=g.pos;g.lastIntValue=0;for(var D=0;D<T;++D){var ge=g.current();if(!ta(ge))return g.pos=K,!1;g.lastIntValue=16*g.lastIntValue+oi(ge),g.advance()}return!0};var ji=function(T){this.type=T.type,this.value=T.value,this.start=T.start,this.end=T.end,T.options.locations&&(this.loc=new me(T,T.startLoc,T.endLoc)),T.options.ranges&&(this.range=[T.start,T.end])},Ti=Ge.prototype;function Ia(g){return"function"!=typeof BigInt?null:BigInt(g.replace(/_/g,""))}function Gi(g){return g<=65535?String.fromCharCode(g):(g-=65536,String.fromCharCode(55296+(g>>10),56320+(1023&g)))}Ti.next=function(g){!g&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new ji(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Ti.getToken=function(){return this.next(),new ji(this)},"undefined"!=typeof Symbol&&(Ti[Symbol.iterator]=function(){var g=this;return{next:function(){var T=g.getToken();return{done:T.type===Q.eof,value:T}}}}),Ti.curContext=function(){return this.context[this.context.length-1]},Ti.nextToken=function(){var g=this.curContext();return(!g||!g.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(Q.eof):g.override?g.override(this):void this.readToken(this.fullCharCodeAtPos())},Ti.readToken=function(g){return W(g,this.options.ecmaVersion>=6)||92===g?this.readWord():this.getTokenFromCode(g)},Ti.fullCharCodeAtPos=function(){var g=this.input.charCodeAt(this.pos);return g<=55295||g>=57344?g:(g<<10)+this.input.charCodeAt(this.pos+1)-56613888},Ti.skipBlockComment=function(){var g=this.options.onComment&&this.curPosition(),T=this.pos,K=this.input.indexOf("*/",this.pos+=2);if(-1===K&&this.raise(this.pos-2,"Unterminated comment"),this.pos=K+2,this.options.locations){ot.lastIndex=T;for(var D;(D=ot.exec(this.input))&&D.index<this.pos;)++this.curLine,this.lineStart=D.index+D[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(T+2,K),T,this.pos,g,this.curPosition())},Ti.skipLineComment=function(g){for(var T=this.pos,K=this.options.onComment&&this.curPosition(),D=this.input.charCodeAt(this.pos+=g);this.pos<this.input.length&&!Ue(D);)D=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(T+g,this.pos),T,this.pos,K,this.curPosition())},Ti.skipSpace=function(){e:for(;this.pos<this.input.length;){var g=this.input.charCodeAt(this.pos);switch(g){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(g>8&&g<14||g>=5760&&ct.test(String.fromCharCode(g))))break e;++this.pos}}},Ti.finishToken=function(g,T){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var K=this.type;this.type=g,this.value=T,this.updateContext(K)},Ti.readToken_dot=function(){var g=this.input.charCodeAt(this.pos+1);if(g>=48&&g<=57)return this.readNumber(!0);var T=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===g&&46===T?(this.pos+=3,this.finishToken(Q.ellipsis)):(++this.pos,this.finishToken(Q.dot))},Ti.readToken_slash=function(){var g=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===g?this.finishOp(Q.assign,2):this.finishOp(Q.slash,1)},Ti.readToken_mult_modulo_exp=function(g){var T=this.input.charCodeAt(this.pos+1),K=1,D=42===g?Q.star:Q.modulo;return this.options.ecmaVersion>=7&&42===g&&42===T&&(++K,D=Q.starstar,T=this.input.charCodeAt(this.pos+2)),61===T?this.finishOp(Q.assign,K+1):this.finishOp(D,K)},Ti.readToken_pipe_amp=function(g){var T=this.input.charCodeAt(this.pos+1);return T===g?this.options.ecmaVersion>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(Q.assign,3):this.finishOp(124===g?Q.logicalOR:Q.logicalAND,2):61===T?this.finishOp(Q.assign,2):this.finishOp(124===g?Q.bitwiseOR:Q.bitwiseAND,1)},Ti.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(Q.assign,2):this.finishOp(Q.bitwiseXOR,1)},Ti.readToken_plus_min=function(g){var T=this.input.charCodeAt(this.pos+1);return T===g?45!==T||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!Ut.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(Q.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===T?this.finishOp(Q.assign,2):this.finishOp(Q.plusMin,1)},Ti.readToken_lt_gt=function(g){var T=this.input.charCodeAt(this.pos+1),K=1;return T===g?(K=62===g&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+K)?this.finishOp(Q.assign,K+1):this.finishOp(Q.bitShift,K)):33!==T||60!==g||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===T&&(K=2),this.finishOp(Q.relational,K)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},Ti.readToken_eq_excl=function(g){var T=this.input.charCodeAt(this.pos+1);return 61===T?this.finishOp(Q.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===g&&62===T&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Q.arrow)):this.finishOp(61===g?Q.eq:Q.prefix,1)},Ti.readToken_question=function(){var g=this.options.ecmaVersion;if(g>=11){var T=this.input.charCodeAt(this.pos+1);if(46===T){var K=this.input.charCodeAt(this.pos+2);if(K<48||K>57)return this.finishOp(Q.questionDot,2)}if(63===T)return g>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(Q.assign,3):this.finishOp(Q.coalesce,2)}return this.finishOp(Q.question,1)},Ti.getTokenFromCode=function(g){switch(g){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Q.parenL);case 41:return++this.pos,this.finishToken(Q.parenR);case 59:return++this.pos,this.finishToken(Q.semi);case 44:return++this.pos,this.finishToken(Q.comma);case 91:return++this.pos,this.finishToken(Q.bracketL);case 93:return++this.pos,this.finishToken(Q.bracketR);case 123:return++this.pos,this.finishToken(Q.braceL);case 125:return++this.pos,this.finishToken(Q.braceR);case 58:return++this.pos,this.finishToken(Q.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Q.backQuote);case 48:var T=this.input.charCodeAt(this.pos+1);if(120===T||88===T)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===T||79===T)return this.readRadixNumber(8);if(98===T||66===T)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(g);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(g);case 124:case 38:return this.readToken_pipe_amp(g);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(g);case 60:case 62:return this.readToken_lt_gt(g);case 61:case 33:return this.readToken_eq_excl(g);case 63:return this.readToken_question();case 126:return this.finishOp(Q.prefix,1)}this.raise(this.pos,"Unexpected character '"+Gi(g)+"'")},Ti.finishOp=function(g,T){var K=this.input.slice(this.pos,this.pos+T);return this.pos+=T,this.finishToken(g,K)},Ti.readRegexp=function(){for(var g,T,K=this.pos;;){this.pos>=this.input.length&&this.raise(K,"Unterminated regular expression");var D=this.input.charAt(this.pos);if(Ut.test(D)&&this.raise(K,"Unterminated regular expression"),g)g=!1;else{if("["===D)T=!0;else if("]"===D&&T)T=!1;else if("/"===D&&!T)break;g="\\"===D}++this.pos}var ge=this.input.slice(K,this.pos);++this.pos;var Fe=this.pos,yt=this.readWord1();this.containsEsc&&this.unexpected(Fe);var Zt=this.regexpState||(this.regexpState=new ar(this));Zt.reset(K,ge,yt),this.validateRegExpFlags(Zt),this.validateRegExpPattern(Zt);var Ft=null;try{Ft=new RegExp(ge,yt)}catch(Or){}return this.finishToken(Q.regexp,{pattern:ge,flags:yt,value:Ft})},Ti.readInt=function(g,T,K){for(var D=this.options.ecmaVersion>=12&&void 0===T,ge=K&&48===this.input.charCodeAt(this.pos),Fe=this.pos,yt=0,Zt=0,Ft=0,Or=null==T?1/0:T;Ft<Or;++Ft,++this.pos){var zr=this.input.charCodeAt(this.pos),Jn=void 0;if(D&&95===zr)ge&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===Zt&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===Ft&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Zt=zr;else{if((Jn=zr>=97?zr-97+10:zr>=65?zr-65+10:zr>=48&&zr<=57?zr-48:1/0)>=g)break;Zt=zr,yt=yt*g+Jn}}return D&&95===Zt&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Fe||null!=T&&this.pos-Fe!==T?null:yt},Ti.readRadixNumber=function(g){var T=this.pos;this.pos+=2;var K=this.readInt(g);return null==K&&this.raise(this.start+2,"Expected number in radix "+g),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(K=Ia(this.input.slice(T,this.pos)),++this.pos):W(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Q.num,K)},Ti.readNumber=function(g){var T=this.pos;!g&&null===this.readInt(10,void 0,!0)&&this.raise(T,"Invalid number");var K=this.pos-T>=2&&48===this.input.charCodeAt(T);K&&this.strict&&this.raise(T,"Invalid number");var D=this.input.charCodeAt(this.pos);if(!K&&!g&&this.options.ecmaVersion>=11&&110===D){var ge=Ia(this.input.slice(T,this.pos));return++this.pos,W(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Q.num,ge)}K&&/[89]/.test(this.input.slice(T,this.pos))&&(K=!1),46===D&&!K&&(++this.pos,this.readInt(10),D=this.input.charCodeAt(this.pos)),(69===D||101===D)&&!K&&((43===(D=this.input.charCodeAt(++this.pos))||45===D)&&++this.pos,null===this.readInt(10)&&this.raise(T,"Invalid number")),W(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Fe=function(g,T){return T?parseInt(g,8):parseFloat(g.replace(/_/g,""))}(this.input.slice(T,this.pos),K);return this.finishToken(Q.num,Fe)},Ti.readCodePoint=function(){var T;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var K=++this.pos;T=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,T>1114111&&this.invalidStringToken(K,"Code point out of bounds")}else T=this.readHexChar(4);return T},Ti.readString=function(g){for(var T="",K=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var D=this.input.charCodeAt(this.pos);if(D===g)break;92===D?(T+=this.input.slice(K,this.pos),T+=this.readEscapedChar(!1),K=this.pos):(Ue(D,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return T+=this.input.slice(K,this.pos++),this.finishToken(Q.string,T)};var Ni={};function Wi(g,T){g.prototype=Object.create(T.prototype),g.prototype.constructor=g,g.__proto__=T}function va(g){var T="function"==typeof Map?new Map:void 0;return(va=function(D){if(null===D||!function(g){return-1!==Function.toString.call(g).indexOf("[native code]")}(D))return D;if("function"!=typeof D)throw new TypeError("Super expression must either be null or a function");if(void 0!==T){if(T.has(D))return T.get(D);T.set(D,ge)}function ge(){return Da(D,arguments,ra(this).constructor)}return ge.prototype=Object.create(D.prototype,{constructor:{value:ge,enumerable:!1,writable:!0,configurable:!0}}),Bi(ge,D)})(g)}function wu(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(g){return!1}}function Da(g,T,K){return(Da=wu()?Reflect.construct:function(ge,Fe,yt){var Zt=[null];Zt.push.apply(Zt,Fe);var Or=new(Function.bind.apply(ge,Zt));return yt&&Bi(Or,yt.prototype),Or}).apply(null,arguments)}function Bi(g,T){return(Bi=Object.setPrototypeOf||function(D,ge){return D.__proto__=ge,D})(g,T)}function ra(g){return(ra=Object.setPrototypeOf?Object.getPrototypeOf:function(K){return K.__proto__||Object.getPrototypeOf(K)})(g)}Ti.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(g){if(g!==Ni)throw g;this.readInvalidTemplateToken()}this.inTemplateElement=!1},Ti.invalidStringToken=function(g,T){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Ni;this.raise(g,T)},Ti.readTmplToken=function(){for(var g="",T=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var K=this.input.charCodeAt(this.pos);if(96===K||36===K&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==Q.template&&this.type!==Q.invalidTemplate?(g+=this.input.slice(T,this.pos),this.finishToken(Q.template,g)):36===K?(this.pos+=2,this.finishToken(Q.dollarBraceL)):(++this.pos,this.finishToken(Q.backQuote));if(92===K)g+=this.input.slice(T,this.pos),g+=this.readEscapedChar(!0),T=this.pos;else if(Ue(K)){switch(g+=this.input.slice(T,this.pos),++this.pos,K){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:g+="\n";break;default:g+=String.fromCharCode(K)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),T=this.pos}else++this.pos}},Ti.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(Q.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Ti.readEscapedChar=function(g){var T=this.input.charCodeAt(++this.pos);switch(++this.pos,T){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Gi(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(g)return this.invalidStringToken(this.pos-1,"Invalid escape sequence in template string"),null;default:if(T>=48&&T<=55){var D=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],ge=parseInt(D,8);return ge>255&&(D=D.slice(0,-1),ge=parseInt(D,8)),this.pos+=D.length-1,T=this.input.charCodeAt(this.pos),("0"!==D||56===T||57===T)&&(this.strict||g)&&this.invalidStringToken(this.pos-1-D.length,g?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(ge)}return Ue(T)?"":String.fromCharCode(T)}},Ti.readHexChar=function(g){var T=this.pos,K=this.readInt(16,g);return null===K&&this.invalidStringToken(T,"Bad character escape sequence"),K},Ti.readWord1=function(){this.containsEsc=!1;for(var g="",T=!0,K=this.pos,D=this.options.ecmaVersion>=6;this.pos<this.input.length;){var ge=this.fullCharCodeAtPos();if(Ye(ge,D))this.pos+=ge<=65535?1:2;else{if(92!==ge)break;this.containsEsc=!0,g+=this.input.slice(K,this.pos);var Fe=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var yt=this.readCodePoint();(T?W:Ye)(yt,D)||this.invalidStringToken(Fe,"Invalid Unicode escape"),g+=Gi(yt),K=this.pos}T=!1}return g+this.input.slice(K,this.pos)},Ti.readWord=function(){var g=this.readWord1(),T=Q.name;return this.keywords.test(g)&&(T=tt[g]),this.finishToken(T,g)},Ge.acorn={Parser:Ge,version:"7.4.1",defaultOptions:je,Position:ae,SourceLocation:me,getLineInfo:Ie,Node:hi,TokenType:_t,tokTypes:Q,keywordTypes:tt,TokContext:Yi,tokContexts:Pi,isIdentifierChar:Ye,isIdentifierStart:W,Token:ji,isNewLine:Ue,lineBreak:Ut,lineBreakG:ot,nonASCIIwhitespace:ct};var bo=function(g){function T(){return g.apply(this,arguments)||this}return Wi(T,g),T}(va(Error)),ma=function(g){function T(){return g.apply(this,arguments)||this}return Wi(T,g),T}(va(SyntaxError)),vo=function(g){function T(){return g.apply(this,arguments)||this}return Wi(T,g),T}(va(ReferenceError)),Fo=function(g){function T(){return g.apply(this,arguments)||this}return Wi(T,g),T}(va(TypeError)),Ls=function(g){function T(){return g.apply(this,arguments)||this}return Wi(T,g),T}(bo),aa=function(g){function T(){return g.apply(this,arguments)||this}return Wi(T,g),T}(ma),Jo=function(g){function T(){return g.apply(this,arguments)||this}return Wi(T,g),T}(vo),Ma={UnknownError:[3001,"%0",Ls],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",Ls],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Jo],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Jo],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Jo],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Jo],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Jo],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Jo],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Jo],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Jo],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Jo],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Jo],FunctionUndefinedReferenceError:[2001,"%0 is not a function",vo],VariableUndefinedReferenceError:[2002,"%0 is not defined",vo],IsNotConstructor:[2003,"%0 is not a constructor",Fo]};function Ya(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(g){return!1}}function $o(g,T,K){return($o=Ya()?Reflect.construct:function(ge,Fe,yt){var Zt=[null];Zt.push.apply(Zt,Fe);var Or=new(Function.bind.apply(ge,Zt));return yt&&Na(Or,yt.prototype),Or}).apply(null,arguments)}function Na(g,T){return(Na=Object.setPrototypeOf||function(D,ge){return D.__proto__=ge,D})(g,T)}function Ve(g,T){Object.defineProperty(g,"name",{value:T,writable:!1,enumerable:!1,configurable:!0})}var St=Object.prototype.hasOwnProperty,or=Symbol("Break"),Yr=Symbol("Continue"),$n=Symbol("DefaultCase"),xi=Symbol("EmptyStatementReturn"),lo=Symbol("WithScopeName"),ro=Symbol("SuperScopeName"),co=Symbol("RootScopeName"),ps=Symbol("GlobalScopeName");function du(g){return"function"==typeof g}var Eu=function(){function g(K){this.interpreter=K}return g.prototype.generator=function(){var D=this.interpreter;return{getOptions:D.getOptions.bind(D),getCurrentScope:function(){return this.getCurrentScope()}.bind(D),getGlobalScope:function(){return this.getGlobalScope()}.bind(D),getCurrentContext:function(){return this.getCurrentContext()}.bind(D),getExecStartTime:D.getExecStartTime.bind(D)}},g}();function fl(g,T,K){if(void 0===K&&(K=!0),!(g instanceof Eu))throw new Error("Illegal call");if("string"!=typeof T)return T;if(T){var D=g.generator(),Fe={timeout:D.getOptions().timeout,_initEnv:function(){K||this.setCurrentContext(D.getCurrentContext()),this.execStartTime=D.getExecStartTime(),this.execEndTime=this.execStartTime}},yt=K?D.getGlobalScope():D.getCurrentScope();return new ko(yt,Fe).evaluate(T)}}function Wo(g){if(!(g instanceof Eu))throw new Error("Illegal call");for(var T=g.generator(),K=arguments.length,D=new Array(K>1?K-1:0),ge=1;ge<K;ge++)D[ge-1]=arguments[ge];var Fe=D.pop(),yt=new ko(T.getGlobalScope(),T.getOptions()),Zt="\n\t\t    (function anonymous("+D.join(",")+"){\n\t\t        "+Fe+"\n\t\t    });\n\t\t    ";return yt.evaluate(Zt)}Object.defineProperty(fl,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(Wo,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var Qo=function(T){this.value=T},Lo=function(T){this.value=T},es=function(T){this.value=T},ts=function(T,K,D){void 0===K&&(K=null),this.name=D,this.parent=K,this.data=T,this.labelStack=[]};function ks(){}function Qs(g,T){return void 0===g&&(g=null),new ts(Object.create(null),g,T)}var Oa={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:fl,Function:Wo};"undefined"!=typeof JSON&&(Oa.JSON=JSON),"undefined"!=typeof Promise&&(Oa.Promise=Promise),"undefined"!=typeof Set&&(Oa.Set=Set),"undefined"!=typeof Map&&(Oa.Map=Map),"undefined"!=typeof Symbol&&(Oa.Symbol=Symbol),"undefined"!=typeof Proxy&&(Oa.Proxy=Proxy),"undefined"!=typeof WeakMap&&(Oa.WeakMap=WeakMap),"undefined"!=typeof WeakSet&&(Oa.WeakSet=WeakSet),"undefined"!=typeof Reflect&&(Oa.Reflect=Reflect);var ko=function(){function g(K,D){void 0===K&&(K=g.global),void 0===D&&(D={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:D.ecmaVersion||g.ecmaVersion,timeout:D.timeout||0,rootContext:D.rootContext,globalContextInFunction:void 0===D.globalContextInFunction?g.globalContextInFunction:D.globalContextInFunction,_initEnv:D._initEnv},this.context=K||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var T=g.prototype;return T.initEnvironment=function(D){var ge;if(D instanceof ts)ge=D;else{var Fe=null,yt=this.createSuperScope(D);this.options.rootContext&&(Fe=new ts(function(g){return Object.create(g)}(this.options.rootContext),yt,co)),ge=new ts(D,Fe||yt,ps)}this.globalScope=ge,this.currentScope=this.globalScope,this.globalContext=ge.data,this.currentContext=ge.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var Zt=this.options._initEnv;Zt&&Zt.call(this)},T.getExecStartTime=function(){return this.execStartTime},T.getExecutionTime=function(){return this.execEndTime-this.execStartTime},T.setExecTimeout=function(D){void 0===D&&(D=0),this.options.timeout=D},T.getOptions=function(){return this.options},T.getGlobalScope=function(){return this.globalScope},T.getCurrentScope=function(){return this.currentScope},T.getCurrentContext=function(){return this.currentContext},T.isInterruptThrow=function(D){return D instanceof Ls||D instanceof Jo||D instanceof aa},T.createSuperScope=function(D){var ge=Object.assign({},Oa);return Object.keys(ge).forEach(function(yt){yt in D&&delete ge[yt]}),new ts(ge,null,ro)},T.setCurrentContext=function(D){this.currentContext=D},T.setCurrentScope=function(D){this.currentScope=D},T.evaluate=function(D){var ge;if(void 0===D&&(D=""),D)return ge=function(g,T){return Ge.parse(g,T)}(D,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||g.ecmaVersion}),this.evaluateNode(ge,D)},T.appendCode=function(D){return this.evaluate(D)},T.evaluateNode=function(D,ge){void 0===ge&&(ge=""),this.value=void 0,this.source=ge,this.sourceList.push(ge),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var yt=this.getCurrentScope(),Zt=this.getCurrentContext(),Ft=yt.labelStack.concat([]),Or=this.callStack.concat([]);try{var Jn=this.createClosure(D);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),Jn()}catch(bi){throw bi}finally{this.setCurrentScope(yt),this.setCurrentContext(Zt),yt.labelStack=Ft,this.callStack=Or,this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},T.createErrorMessage=function(D,ge,Fe){var yt=D[1].replace("%0",String(ge));return null!==Fe&&(yt+=this.getNodePosition(Fe||this.lastExecNode)),yt},T.createError=function(D,ge){return new ge(D)},T.createThrowError=function(D,ge){return this.createError(D,ge)},T.createInternalThrowError=function(D,ge,Fe){return this.createError(this.createErrorMessage(D,ge,Fe),D[2])},T.checkTimeout=function(){if(!this.isRunning)return!1;var D=this.options.timeout||0;return Date.now()-this.execStartTime>D},T.getNodePosition=function(D){return D&&D.loc?" ["+D.loc.start.line+":"+D.loc.start.column+"]":""},T.createClosure=function(D){var Fe,ge=this;switch(D.type){case"BinaryExpression":Fe=this.binaryExpressionHandler(D);break;case"LogicalExpression":Fe=this.logicalExpressionHandler(D);break;case"UnaryExpression":Fe=this.unaryExpressionHandler(D);break;case"UpdateExpression":Fe=this.updateExpressionHandler(D);break;case"ObjectExpression":Fe=this.objectExpressionHandler(D);break;case"ArrayExpression":Fe=this.arrayExpressionHandler(D);break;case"CallExpression":Fe=this.callExpressionHandler(D);break;case"NewExpression":Fe=this.newExpressionHandler(D);break;case"MemberExpression":Fe=this.memberExpressionHandler(D);break;case"ThisExpression":Fe=this.thisExpressionHandler(D);break;case"SequenceExpression":Fe=this.sequenceExpressionHandler(D);break;case"Literal":Fe=this.literalHandler(D);break;case"Identifier":Fe=this.identifierHandler(D);break;case"AssignmentExpression":Fe=this.assignmentExpressionHandler(D);break;case"FunctionDeclaration":Fe=this.functionDeclarationHandler(D);break;case"VariableDeclaration":Fe=this.variableDeclarationHandler(D);break;case"BlockStatement":case"Program":Fe=this.programHandler(D);break;case"ExpressionStatement":Fe=this.expressionStatementHandler(D);break;case"EmptyStatement":Fe=this.emptyStatementHandler(D);break;case"ReturnStatement":Fe=this.returnStatementHandler(D);break;case"FunctionExpression":Fe=this.functionExpressionHandler(D);break;case"IfStatement":Fe=this.ifStatementHandler(D);break;case"ConditionalExpression":Fe=this.conditionalExpressionHandler(D);break;case"ForStatement":Fe=this.forStatementHandler(D);break;case"WhileStatement":Fe=this.whileStatementHandler(D);break;case"DoWhileStatement":Fe=this.doWhileStatementHandler(D);break;case"ForInStatement":Fe=this.forInStatementHandler(D);break;case"WithStatement":Fe=this.withStatementHandler(D);break;case"ThrowStatement":Fe=this.throwStatementHandler(D);break;case"TryStatement":Fe=this.tryStatementHandler(D);break;case"ContinueStatement":Fe=this.continueStatementHandler(D);break;case"BreakStatement":Fe=this.breakStatementHandler(D);break;case"SwitchStatement":Fe=this.switchStatementHandler(D);break;case"LabeledStatement":Fe=this.labeledStatementHandler(D);break;case"DebuggerStatement":Fe=this.debuggerStatementHandler(D);break;default:throw this.createInternalThrowError(Ma.NodeTypeSyntaxError,D.type,D)}return function(){var yt=ge.options.timeout;if(yt&&yt>0&&ge.checkTimeout())throw ge.createInternalThrowError(Ma.ExecutionTimeOutError,yt,null);return ge.lastExecNode=D,Fe.apply(void 0,arguments)}},T.binaryExpressionHandler=function(D){var ge=this,Fe=this.createClosure(D.left),yt=this.createClosure(D.right);return function(){var Zt=Fe(),Ft=yt();switch(D.operator){case"==":return Zt==Ft;case"!=":return Zt!=Ft;case"===":return Zt===Ft;case"!==":return Zt!==Ft;case"<":return Zt<Ft;case"<=":return Zt<=Ft;case">":return Zt>Ft;case">=":return Zt>=Ft;case"<<":return Zt<<Ft;case">>":return Zt>>Ft;case">>>":return Zt>>>Ft;case"+":return Zt+Ft;case"-":return Zt-Ft;case"*":return Zt*Ft;case"**":return Math.pow(Zt,Ft);case"/":return Zt/Ft;case"%":return Zt%Ft;case"|":return Zt|Ft;case"^":return Zt^Ft;case"&":return Zt&Ft;case"in":return Zt in Ft;case"instanceof":return Zt instanceof Ft;default:throw ge.createInternalThrowError(Ma.BinaryOperatorSyntaxError,D.operator,D)}}},T.logicalExpressionHandler=function(D){var ge=this,Fe=this.createClosure(D.left),yt=this.createClosure(D.right);return function(){switch(D.operator){case"||":return Fe()||yt();case"&&":return Fe()&&yt();default:throw ge.createInternalThrowError(Ma.LogicalOperatorSyntaxError,D.operator,D)}}},T.unaryExpressionHandler=function(D){var ge=this;switch(D.operator){case"delete":var Fe=this.createObjectGetter(D.argument),yt=this.createNameGetter(D.argument);return function(){return delete Fe()[yt()]};default:var Zt;if("typeof"===D.operator&&"Identifier"===D.argument.type){var Ft=this.createObjectGetter(D.argument),Or=this.createNameGetter(D.argument);Zt=function(){return Ft()[Or()]}}else Zt=this.createClosure(D.argument);return function(){var zr=Zt();switch(D.operator){case"-":return-zr;case"+":return+zr;case"!":return!zr;case"~":return~zr;case"void":return;case"typeof":return typeof zr;default:throw ge.createInternalThrowError(Ma.UnaryOperatorSyntaxError,D.operator,D)}}}},T.updateExpressionHandler=function(D){var ge=this,Fe=this.createObjectGetter(D.argument),yt=this.createNameGetter(D.argument);return function(){var Zt=Fe(),Ft=yt();switch(ge.assertVariable(Zt,Ft,D),D.operator){case"++":return D.prefix?++Zt[Ft]:Zt[Ft]++;case"--":return D.prefix?--Zt[Ft]:Zt[Ft]--;default:throw ge.createInternalThrowError(Ma.UpdateOperatorSyntaxError,D.operator,D)}}},T.objectExpressionHandler=function(D){var ge=this,Fe=[],Zt=Object.create(null);return D.properties.forEach(function(Ft){var Or=Ft.kind,zr=function(Ft){return"Identifier"===Ft.type?Ft.name:"Literal"===Ft.type?Ft.value:this.throwError(Ma.ObjectStructureSyntaxError,Ft.type,Ft)}(Ft.key);(!Zt[zr]||"init"===Or)&&(Zt[zr]={}),Zt[zr][Or]=ge.createClosure(Ft.value),Fe.push({key:zr,property:Ft})}),function(){for(var Ft={},Or=Fe.length,zr=0;zr<Or;zr++){var Jn=Fe[zr],bi=Jn.key,pi=Zt[bi],oa=pi.init?pi.init():void 0,Ea=pi.get?pi.get():function(){},Fa=pi.set?pi.set():function(Tu){};if("set"in pi||"get"in pi)Object.defineProperty(Ft,bi,{configurable:!0,enumerable:!0,get:Ea,set:Fa});else{var Xo=Jn.property;"Identifier"===Xo.key.type&&"FunctionExpression"===Xo.value.type&&"init"===Xo.kind&&!Xo.value.id&&Ve(oa,Xo.key.name),Ft[bi]=oa}}return Ft}},T.arrayExpressionHandler=function(D){var ge=this,Fe=D.elements.map(function(yt){return yt&&ge.createClosure(yt)});return function(){for(var yt=Fe.length,Zt=Array(yt),Ft=0;Ft<yt;Ft++){var Or=Fe[Ft];Or&&(Zt[Ft]=Or())}return Zt}},T.safeObjectGet=function(D,ge,Fe){return D[ge]},T.createCallFunctionGetter=function(D){var ge=this;switch(D.type){case"MemberExpression":var Fe=this.createClosure(D.object),yt=this.createMemberKeyGetter(D),Zt=this.source;return function(){var Or=Fe(),zr=yt(),Jn=ge.safeObjectGet(Or,zr,D);if(!Jn||!du(Jn)){var bi=Zt.slice(D.start,D.end);throw ge.createInternalThrowError(Ma.FunctionUndefinedReferenceError,bi,D)}return Jn.__IS_EVAL_FUNC?function(pi){return Jn(new Eu(ge),pi,!0)}:Jn.__IS_FUNCTION_FUNC?function(){for(var pi=arguments.length,oa=new Array(pi),Ea=0;Ea<pi;Ea++)oa[Ea]=arguments[Ea];return Jn.apply(void 0,[new Eu(ge)].concat(oa))}:Jn.bind(Or)};default:var Ft=this.createClosure(D);return function(){var Or="";"Identifier"===D.type&&(Or=D.name);var zr=Ft();if(!zr||!du(zr))throw ge.createInternalThrowError(Ma.FunctionUndefinedReferenceError,Or,D);if("Identifier"===D.type&&zr.__IS_EVAL_FUNC&&"eval"===Or)return function(pi){var oa=ge.getScopeFromName(Or,ge.getCurrentScope()),Ea=oa.name===ro||oa.name===ps||oa.name===co;return zr(new Eu(ge),pi,!Ea)};if(zr.__IS_EVAL_FUNC)return function(pi){return zr(new Eu(ge),pi,!0)};if(zr.__IS_FUNCTION_FUNC)return function(){for(var pi=arguments.length,oa=new Array(pi),Ea=0;Ea<pi;Ea++)oa[Ea]=arguments[Ea];return zr.apply(void 0,[new Eu(ge)].concat(oa))};var Jn=ge.options.globalContextInFunction;if("Identifier"===D.type){var bi=ge.getIdentifierScope(D);bi.name===lo&&(Jn=bi.data)}return zr.bind(Jn)}}},T.callExpressionHandler=function(D){var ge=this,Fe=this.createCallFunctionGetter(D.callee),yt=D.arguments.map(function(Zt){return ge.createClosure(Zt)});return function(){return Fe().apply(void 0,yt.map(function(Zt){return Zt()}))}},T.functionExpressionHandler=function(D){var ge=this,Fe=this,yt=this.source,Zt=this.collectDeclVars,Ft=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Or=D.id?D.id.name:"",zr=D.params.length,Jn=D.params.map(function(Ea){return ge.createParamNameGetter(Ea)}),bi=this.createClosure(D.body),pi=this.collectDeclVars,oa=this.collectDeclFuncs;return this.collectDeclVars=Zt,this.collectDeclFuncs=Ft,function(){var Ea=Fe.getCurrentScope(),Fa=function vi(){for(var Xo=arguments.length,vu=new Array(Xo),Tu=0;Tu<Xo;Tu++)vu[Tu]=arguments[Tu];Fe.callStack.push(""+Or);var Ec=Fe.getCurrentScope(),Du=Qs(Ea,"FunctionScope("+Or+")");Fe.setCurrentScope(Du),Fe.addDeclarationsToScope(pi,oa,Du),Or&&(Du.data[Or]=vi),Du.data.arguments=arguments,Jn.forEach(function(gu,tu){Du.data[gu()]=vu[tu]});var Nl=Fe.getCurrentContext();Fe.setCurrentContext(this);var mu=bi();if(Fe.setCurrentContext(Nl),Fe.setCurrentScope(Ec),Fe.callStack.pop(),mu instanceof Qo)return mu.value};return Ve(Fa,Or),Object.defineProperty(Fa,"length",{value:zr,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Fa,"toString",{value:function(){return yt.slice(D.start,D.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Fa,"valueOf",{value:function(){return yt.slice(D.start,D.end)},writable:!0,configurable:!0,enumerable:!1}),Fa}},T.newExpressionHandler=function(D){var ge=this,Fe=this.source,yt=this.createClosure(D.callee),Zt=D.arguments.map(function(Ft){return ge.createClosure(Ft)});return function(){var Ft=yt();if(!du(Ft)||Ft.__IS_EVAL_FUNC){var Or=D.callee,zr=Fe.slice(Or.start,Or.end);throw ge.createInternalThrowError(Ma.IsNotConstructor,zr,D)}return Ft.__IS_FUNCTION_FUNC?Ft.apply(void 0,[new Eu(ge)].concat(Zt.map(function(Jn){return Jn()}))):$o(Ft,Zt.map(function(Jn){return Jn()}))}},T.memberExpressionHandler=function(D){var ge=this.createClosure(D.object),Fe=this.createMemberKeyGetter(D);return function(){return ge()[Fe()]}},T.thisExpressionHandler=function(D){var ge=this;return function(){return ge.getCurrentContext()}},T.sequenceExpressionHandler=function(D){var ge=this,Fe=D.expressions.map(function(yt){return ge.createClosure(yt)});return function(){for(var yt,Zt=Fe.length,Ft=0;Ft<Zt;Ft++)yt=(0,Fe[Ft])();return yt}},T.literalHandler=function(D){return function(){return D.regex?new RegExp(D.regex.pattern,D.regex.flags):D.value}},T.identifierHandler=function(D){var ge=this;return function(){var Fe=ge.getCurrentScope(),yt=ge.getScopeDataFromName(D.name,Fe);return ge.assertVariable(yt,D.name,D),yt[D.name]}},T.getIdentifierScope=function(D){var ge=this.getCurrentScope();return this.getScopeFromName(D.name,ge)},T.assignmentExpressionHandler=function(D){var ge=this;"Identifier"===D.left.type&&"FunctionExpression"===D.right.type&&!D.right.id&&(D.right.id={type:"Identifier",name:D.left.name});var Fe=this.createObjectGetter(D.left),yt=this.createNameGetter(D.left),Zt=this.createClosure(D.right);return function(){var Ft=Fe(),Or=yt(),zr=Zt();switch("="!==D.operator&&ge.assertVariable(Ft,Or,D),D.operator){case"=":return Ft[Or]=zr;case"+=":return Ft[Or]+=zr;case"-=":return Ft[Or]-=zr;case"*=":return Ft[Or]*=zr;case"**=":return Ft[Or]=Math.pow(Ft[Or],zr);case"/=":return Ft[Or]/=zr;case"%=":return Ft[Or]%=zr;case"<<=":return Ft[Or]<<=zr;case">>=":return Ft[Or]>>=zr;case">>>=":return Ft[Or]>>>=zr;case"&=":return Ft[Or]&=zr;case"^=":return Ft[Or]^=zr;case"|=":return Ft[Or]|=zr;default:throw ge.createInternalThrowError(Ma.AssignmentExpressionSyntaxError,D.type,D)}}},T.functionDeclarationHandler=function(D){if(D.id){var ge=this.functionExpressionHandler(D);Object.defineProperty(ge,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(D.id.name,ge)}return function(){return xi}},T.getVariableName=function(D){if("Identifier"===D.type)return D.name;throw this.createInternalThrowError(Ma.VariableTypeSyntaxError,D.type,D)},T.variableDeclarationHandler=function(D){for(var Fe,ge=this,yt=[],Zt=0;Zt<D.declarations.length;Zt++){var Ft=D.declarations[Zt];this.varDeclaration(this.getVariableName(Ft.id)),Ft.init&&yt.push({type:"AssignmentExpression",operator:"=",left:Ft.id,right:Ft.init})}return yt.length&&(Fe=this.createClosure({type:"BlockStatement",body:yt})),function(){if(Fe){var Or=ge.isVarDeclMode;ge.isVarDeclMode=!0,Fe(),ge.isVarDeclMode=Or}return xi}},T.assertVariable=function(D,ge,Fe){if(D===this.globalScope.data&&!(ge in D))throw this.createInternalThrowError(Ma.VariableUndefinedReferenceError,ge,Fe)},T.programHandler=function(D){var ge=this,Fe=D.body.map(function(yt){return ge.createClosure(yt)});return function(){for(var yt=xi,Zt=0;Zt<Fe.length;Zt++){var Or=ge.setValue((0,Fe[Zt])());if(Or!==xi&&((yt=Or)instanceof Qo||yt instanceof Lo||yt instanceof es||yt===or||yt===Yr))break}return yt}},T.expressionStatementHandler=function(D){return this.createClosure(D.expression)},T.emptyStatementHandler=function(D){return function(){return xi}},T.returnStatementHandler=function(D){var ge=D.argument?this.createClosure(D.argument):ks;return function(){return new Qo(ge())}},T.ifStatementHandler=function(D){var ge=this.createClosure(D.test),Fe=this.createClosure(D.consequent),yt=D.alternate?this.createClosure(D.alternate):function(){return xi};return function(){return ge()?Fe():yt()}},T.conditionalExpressionHandler=function(D){return this.ifStatementHandler(D)},T.forStatementHandler=function(D){var ge=this,Fe=ks,yt=D.test?this.createClosure(D.test):function(){return!0},Zt=ks,Ft=this.createClosure(D.body);return"ForStatement"===D.type&&(Fe=D.init?this.createClosure(D.init):Fe,Zt=D.update?this.createClosure(D.update):ks),function(Or){var zr,Jn=xi,bi="DoWhileStatement"===D.type;for(Or&&"LabeledStatement"===Or.type&&(zr=Or.label.name),Fe();bi||yt();Zt()){bi=!1;var pi=ge.setValue(Ft());if(pi!==xi&&pi!==Yr){if(pi===or)break;if((Jn=pi)instanceof es&&Jn.value===zr){Jn=xi;continue}if(Jn instanceof Qo||Jn instanceof Lo||Jn instanceof es)break}}return Jn}},T.whileStatementHandler=function(D){return this.forStatementHandler(D)},T.doWhileStatementHandler=function(D){return this.forStatementHandler(D)},T.forInStatementHandler=function(D){var ge=this,Fe=D.left,yt=this.createClosure(D.right),Zt=this.createClosure(D.body);return"VariableDeclaration"===D.left.type&&(this.createClosure(D.left)(),Fe=D.left.declarations[0].id),function(Ft){var Or,Jn,zr=xi;Ft&&"LabeledStatement"===Ft.type&&(Or=Ft.label.name);var bi=yt();for(Jn in bi){ge.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:Fe,right:{type:"Literal",value:Jn}})();var pi=ge.setValue(Zt());if(pi!==xi&&pi!==Yr){if(pi===or)break;if((zr=pi)instanceof es&&zr.value===Or){zr=xi;continue}if(zr instanceof Qo||zr instanceof Lo||zr instanceof es)break}}return zr}},T.withStatementHandler=function(D){var ge=this,Fe=this.createClosure(D.object),yt=this.createClosure(D.body);return function(){var Zt=Fe(),Ft=ge.getCurrentScope(),Or=new ts(Zt,Ft,lo);ge.setCurrentScope(Or);var zr=ge.setValue(yt());return ge.setCurrentScope(Ft),zr}},T.throwStatementHandler=function(D){var ge=this,Fe=this.createClosure(D.argument);return function(){throw ge.setValue(void 0),Fe()}},T.tryStatementHandler=function(D){var ge=this,Fe=this.createClosure(D.block),yt=D.handler?this.catchClauseHandler(D.handler):null,Zt=D.finalizer?this.createClosure(D.finalizer):null;return function(){var pi,oa,Ft=ge.getCurrentScope(),Or=ge.getCurrentContext(),zr=Ft.labelStack.concat([]),Jn=ge.callStack.concat([]),bi=xi,Ea=function(){ge.setCurrentScope(Ft),ge.setCurrentContext(Or),Ft.labelStack=zr,ge.callStack=Jn};try{(bi=ge.setValue(Fe()))instanceof Qo&&(pi=bi)}catch(Fa){if(Ea(),ge.isInterruptThrow(Fa))throw Fa;if(yt)try{(bi=ge.setValue(yt(Fa)))instanceof Qo&&(pi=bi)}catch(vi){if(Ea(),ge.isInterruptThrow(vi))throw vi;oa=vi}}if(Zt)try{(bi=Zt())instanceof Qo&&(pi=bi)}catch(Fa){if(Ea(),ge.isInterruptThrow(Fa))throw Fa;oa=Fa}if(oa)throw oa;return pi||bi}},T.catchClauseHandler=function(D){var ge=this,Fe=this.createParamNameGetter(D.param),yt=this.createClosure(D.body);return function(Zt){var Ft,zr=ge.getCurrentScope().data,Jn=Fe(),bi=St.call(zr,Jn),pi=zr[Jn];return zr[Jn]=Zt,Ft=yt(),bi?zr[Jn]=pi:delete zr[Jn],Ft}},T.continueStatementHandler=function(D){return function(){return D.label?new es(D.label.name):Yr}},T.breakStatementHandler=function(D){return function(){return D.label?new Lo(D.label.name):or}},T.switchStatementHandler=function(D){var ge=this,Fe=this.createClosure(D.discriminant),yt=D.cases.map(function(Zt){return ge.switchCaseHandler(Zt)});return function(){for(var Or,zr,Jn,Zt=Fe(),Ft=!1,bi=0;bi<yt.length;bi++){var pi=yt[bi](),oa=pi.testClosure();if(oa!==$n){if(Ft||oa===Zt){if(Ft=!0,(zr=ge.setValue(pi.bodyClosure()))===xi)continue;if(zr===or||(Or=zr)instanceof Qo||Or instanceof Lo||Or instanceof es||Or===Yr)break}}else Jn=pi}return!Ft&&Jn&&((zr=ge.setValue(Jn.bodyClosure()))===xi||zr===or||zr===Yr||(Or=zr)),Or}},T.switchCaseHandler=function(D){var ge=D.test?this.createClosure(D.test):function(){return $n},Fe=this.createClosure({type:"BlockStatement",body:D.consequent});return function(){return{testClosure:ge,bodyClosure:Fe}}},T.labeledStatementHandler=function(D){var ge=this,Fe=D.label.name,yt=this.createClosure(D.body);return function(){var Zt,Ft=ge.getCurrentScope();return Ft.labelStack.push(Fe),(Zt=yt(D))instanceof Lo&&Zt.value===Fe&&(Zt=xi),Ft.labelStack.pop(),Zt}},T.debuggerStatementHandler=function(D){return function(){return xi}},T.createParamNameGetter=function(D){if("Identifier"===D.type)return function(){return D.name};throw this.createInternalThrowError(Ma.ParamTypeSyntaxError,D.type,D)},T.createObjectKeyGetter=function(D){var ge;return ge="Identifier"===D.type?function(){return D.name}:this.createClosure(D),function(){return ge()}},T.createMemberKeyGetter=function(D){return D.computed?this.createClosure(D.property):this.createObjectKeyGetter(D.property)},T.createObjectGetter=function(D){var ge=this;switch(D.type){case"Identifier":return function(){return ge.getScopeDataFromName(D.name,ge.getCurrentScope())};case"MemberExpression":return this.createClosure(D.object);default:throw this.createInternalThrowError(Ma.AssignmentTypeSyntaxError,D.type,D)}},T.createNameGetter=function(D){switch(D.type){case"Identifier":return function(){return D.name};case"MemberExpression":return this.createMemberKeyGetter(D);default:throw this.createInternalThrowError(Ma.AssignmentTypeSyntaxError,D.type,D)}},T.varDeclaration=function(D){this.collectDeclVars[D]=void 0},T.funcDeclaration=function(D,ge){this.collectDeclFuncs[D]=ge},T.addDeclarationsToScope=function(D,ge,Fe){var yt=Fe.data;for(var Zt in ge){var Ft=ge[Zt];yt[Zt]=Ft&&Ft()}for(var Or in D)Or in yt||(yt[Or]=void 0)},T.getScopeValue=function(D,ge){return this.getScopeFromName(D,ge).data[D]},T.getScopeDataFromName=function(D,ge){return this.getScopeFromName(D,ge).data},T.getScopeFromName=function(D,ge){var Fe=ge;do{if(D in Fe.data)return Fe}while(Fe=Fe.parent);return this.globalScope},T.setValue=function(D){return this.isVarDeclMode||this.callStack.length||D===xi||D===or||D===Yr||D instanceof Lo||D instanceof es||(this.value=D instanceof Qo?D.value:D),D},T.getValue=function(){return this.value},g}();function Ol(g){return void 0===g&&(g=Object.create(null)),g}function Ll(g,T,K){void 0===T&&(T=[]),void 0===K&&(K={});var D=K.parsingContext,ge=void 0===K.timeout?0:K.timeout,Fe="\n    (function anonymous("+T.join(",")+"){\n         "+g+"\n    });\n    ";return new ko(D,{ecmaVersion:K.ecmaVersion,timeout:ge,rootContext:K.rootContext,globalContextInFunction:K.globalContextInFunction}).evaluate(Fe)}function kl(g,T,K){return new ko(T,K).evaluate(g)}ko.version="0.0.2",ko.eval=fl,ko.Function=Wo,ko.ecmaVersion=5,ko.globalContextInFunction=void 0,ko.global=Object.create(null);var wc=kl,Rl=function(){function g(K){this._code=K}var T=g.prototype;return T.runInContext=function(D){return kl(this._code,D)},T.runInNewContext=function(D){return kl(this._code,D)},g}();const hl=function(g,T,K){return kl(g,T,K)};function eu(){for(var g=arguments.length,T=new Array(g),K=0;K<g;K++)T[K]=arguments[K];var D=T.pop();return Ll(D||"",T)}const Dl=hl},35296:function(ne,L,y){ne.exports=function(M){"use strict";var _=function(q){return q instanceof Uint8Array||q instanceof Uint16Array||q instanceof Uint32Array||q instanceof Int8Array||q instanceof Int16Array||q instanceof Int32Array||q instanceof Float32Array||q instanceof Float64Array||q instanceof Uint8ClampedArray},l=function(q,De){for(var it=Object.keys(De),cr=0;cr<it.length;++cr)q[it[cr]]=De[it[cr]];return q},m="\n";function O(q){return"undefined"!=typeof atob?atob(q):"base64:"+q}function R(q){var De=new Error("(regl) "+q);throw console.error(De),De}function N(q,De){q||R(De)}function H(q){return q?": "+q:""}function Ne(q,De){switch(De){case"number":return"number"==typeof q;case"object":return"object"==typeof q;case"string":return"string"==typeof q;case"boolean":return"boolean"==typeof q;case"function":return"function"==typeof q;case"undefined":return void 0===q;case"symbol":return"symbol"==typeof q}}function Ye(q,De,it){De.indexOf(q)<0&&R("invalid value"+H(it)+". must be one of: "+De)}var _t=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function wt(q,De){for(q+="";q.length<De;)q=" "+q;return q}function lt(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function tt(q,De){this.number=q,this.line=De,this.errors=[]}function Gt(q,De,it){this.file=q,this.line=De,this.message=it}function Q(){var q=new Error,De=(q.stack||q).toString(),it=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(De);if(it)return it[1];var cr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(De);return cr?cr[1]:"unknown"}function Ut(){var q=new Error,De=(q.stack||q).toString(),it=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(De);if(it)return it[1];var cr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(De);return cr?cr[1]:"unknown"}function ot(q,De){var it=q.split("\n"),cr=1,kr=0,ur={unknown:new lt,0:new lt};ur.unknown.name=ur[0].name=De||Q(),ur.unknown.lines.push(new tt(0,""));for(var Cr=0;Cr<it.length;++Cr){var Ur=it[Cr],Gr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Ur);if(Gr)switch(Gr[1]){case"line":var Kr=/(\d+)(\s+\d+)?/.exec(Gr[2]);Kr&&(cr=0|Kr[1],Kr[2]&&((kr=0|Kr[2])in ur||(ur[kr]=new lt)));break;case"define":var qr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Gr[2]);qr&&(ur[kr].name=qr[1]?O(qr[2]):qr[2])}ur[kr].lines.push(new tt(cr++,Ur))}return Object.keys(ur).forEach(function(en){var pn=ur[en];pn.lines.forEach(function(Hr){pn.index[Hr.number]=Hr})}),ur}function kt(q){q._commandRef=Q()}function ir(q,De){var it=Ut();R(q+" in command "+(De||Q())+("unknown"===it?"":" called from "+it))}function ae(q,De,it,cr){Ne(q,De)||ir("invalid parameter type"+H(it)+". expected "+De+", got "+typeof q,cr||Q())}var je=33071,Y={};function Ge(q,De){return 32820===q||32819===q||33635===q?2:34042===q?4:Y[q]*De}function nt(q){return!(q&q-1||!q)}Y[5120]=Y[5121]=1,Y[5122]=Y[5123]=Y[36193]=Y[33635]=Y[32819]=Y[32820]=2,Y[5124]=Y[5125]=Y[5126]=Y[34042]=4;var Z=l(N,{optional:function(q){q()},raise:R,commandRaise:ir,command:function(q,De,it){q||ir(De,it||Q())},parameter:function(q,De,it){q in De||R("unknown parameter ("+q+")"+H(it)+". possible values: "+Object.keys(De).join())},commandParameter:function(q,De,it,cr){q in De||ir("unknown parameter ("+q+")"+H(it)+". possible values: "+Object.keys(De).join(),cr||Q())},constructor:function(q){Object.keys(q).forEach(function(De){_t.indexOf(De)<0&&R('invalid regl constructor argument "'+De+'". must be one of '+_t)})},type:function(q,De,it){Ne(q,De)||R("invalid parameter type"+H(it)+". expected "+De+", got "+typeof q)},commandType:ae,isTypedArray:function(q,De){_(q)||R("invalid parameter type"+H(De)+". must be a typed array")},nni:function(q,De){q>=0&&(0|q)===q||R("invalid parameter type, ("+q+")"+H(De)+". must be a nonnegative integer")},oneOf:Ye,shaderError:function(q,De,it,cr,kr){if(!q.getShaderParameter(De,q.COMPILE_STATUS)){var ur=q.getShaderInfoLog(De),Cr=cr===q.FRAGMENT_SHADER?"fragment":"vertex";ae(it,"string",Cr+" shader source must be a string",kr);var Ur=ot(it,kr),Gr=function(q){var De=[];return q.split("\n").forEach(function(it){if(!(it.length<5)){var cr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(it);cr?De.push(new Gt(0|cr[1],0|cr[2],cr[3].trim())):it.length>0&&De.push(new Gt("unknown",0,it))}}),De}(ur);(function(q,De){De.forEach(function(it){var cr=q[it.file];if(cr){var kr=cr.index[it.line];if(kr)return kr.errors.push(it),void(cr.hasErrors=!0)}q.unknown.hasErrors=!0,q.unknown.lines[0].errors.push(it)})})(Ur,Gr),Object.keys(Ur).forEach(function(Kr){var qr=Ur[Kr];if(qr.hasErrors){var en=[""],pn=[""];Hr("file number "+Kr+": "+qr.name+"\n","color:red;text-decoration:underline;font-weight:bold"),qr.lines.forEach(function(tn){if(tn.errors.length>0){Hr(wt(tn.number,4)+"|  ","background-color:yellow; font-weight:bold"),Hr(tn.line+m,"color:red; background-color:yellow; font-weight:bold");var Vt=0;tn.errors.forEach(function(_r){var Wr=_r.message,An=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Wr);if(An){var Mr=An[1];switch(Wr=An[2],Mr){case"assign":Mr="="}Vt=Math.max(tn.line.indexOf(Mr,Vt),0)}else Vt=0;Hr(wt("| ",6)),Hr(wt("^^^",Vt+3)+m,"font-weight:bold"),Hr(wt("| ",6)),Hr(Wr+m,"font-weight:bold")}),Hr(wt("| ",6)+m)}else Hr(wt(tn.number,4)+"|  "),Hr(tn.line+m,"color:red")}),"undefined"==typeof document||window.chrome?console.log(en.join("")):(pn[0]=en.join("%c"),console.log.apply(console,pn))}function Hr(tn,Vt){en.push(tn),pn.push(Vt||"")}}),N.raise("Error compiling "+Cr+" shader, "+Ur[0].name)}},linkError:function(q,De,it,cr,kr){if(!q.getProgramParameter(De,q.LINK_STATUS)){var ur=q.getProgramInfoLog(De),Cr=ot(it,kr),Gr='Error linking program with vertex shader, "'+ot(cr,kr)[0].name+'", and fragment shader "'+Cr[0].name+'"';"undefined"!=typeof document?console.log("%c"+Gr+"\n%c"+ur,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Gr+m+ur),N.raise(Gr)}},callSite:Ut,saveCommandRef:kt,saveDrawInfo:function(q,De,it,cr){function kr(Gr){return Gr?cr.id(Gr):0}function ur(Gr,Kr){Object.keys(Kr).forEach(function(qr){Gr[cr.id(qr)]=!0})}kt(q),q._fragId=kr(q.static.frag),q._vertId=kr(q.static.vert);var Cr=q._uniformSet={};ur(Cr,De.static),ur(Cr,De.dynamic);var Ur=q._attributeSet={};ur(Ur,it.static),ur(Ur,it.dynamic),q._hasCount="count"in q.static||"count"in q.dynamic||"elements"in q.static||"elements"in q.dynamic},framebufferFormat:function(q,De,it){q.texture?Ye(q.texture._texture.internalformat,De,"unsupported texture format for attachment"):Ye(q.renderbuffer._renderbuffer.format,it,"unsupported renderbuffer format for attachment")},guessCommand:Q,texture2D:function(q,De,it){var cr,kr=De.width,ur=De.height,Cr=De.channels;N(kr>0&&kr<=it.maxTextureSize&&ur>0&&ur<=it.maxTextureSize,"invalid texture shape"),(q.wrapS!==je||q.wrapT!==je)&&N(nt(kr)&&nt(ur),"incompatible wrap mode for texture, both width and height must be power of 2"),1===De.mipmask?1!==kr&&1!==ur&&N(9984!==q.minFilter&&9986!==q.minFilter&&9985!==q.minFilter&&9987!==q.minFilter,"min filter requires mipmap"):(N(nt(kr)&&nt(ur),"texture must be a square power of 2 to support mipmapping"),N(De.mipmask===(kr<<1)-1,"missing or incomplete mipmap data")),5126===De.type&&(it.extensions.indexOf("oes_texture_float_linear")<0&&N(9728===q.minFilter&&9728===q.magFilter,"filter not supported, must enable oes_texture_float_linear"),N(!q.genMipmaps,"mipmap generation not supported with float textures"));var Ur=De.images;for(cr=0;cr<16;++cr)if(Ur[cr]){var Gr=kr>>cr,Kr=ur>>cr;N(De.mipmask&1<<cr,"missing mipmap data");var qr=Ur[cr];if(N(qr.width===Gr&&qr.height===Kr,"invalid shape for mip images"),N(qr.format===De.format&&qr.internalformat===De.internalformat&&qr.type===De.type,"incompatible type for mip image"),!qr.compressed&&qr.data){var en=Math.ceil(Ge(qr.type,Cr)*Gr/qr.unpackAlignment)*qr.unpackAlignment;N(qr.data.byteLength===en*Kr,"invalid data for image, buffer size is inconsistent with image format")}}else q.genMipmaps||N(0==(De.mipmask&1<<cr),"extra mipmap data");De.compressed&&N(!q.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(q,De,it,cr){var kr=q.width,ur=q.height,Cr=q.channels;N(kr>0&&kr<=cr.maxTextureSize&&ur>0&&ur<=cr.maxTextureSize,"invalid texture shape"),N(kr===ur,"cube map must be square"),N(De.wrapS===je&&De.wrapT===je,"wrap mode not supported by cube map");for(var Ur=0;Ur<it.length;++Ur){var Gr=it[Ur];N(Gr.width===kr&&Gr.height===ur,"inconsistent cube map face shape"),De.genMipmaps&&(N(!Gr.compressed,"can not generate mipmap for compressed textures"),N(1===Gr.mipmask,"can not specify mipmaps and generate mipmaps"));for(var Kr=Gr.images,qr=0;qr<16;++qr){var en=Kr[qr];if(en){var pn=kr>>qr,Hr=ur>>qr;N(Gr.mipmask&1<<qr,"missing mipmap data"),N(en.width===pn&&en.height===Hr,"invalid shape for mip images"),N(en.format===q.format&&en.internalformat===q.internalformat&&en.type===q.type,"incompatible type for mip image"),en.compressed||en.data&&N(en.data.byteLength===pn*Hr*Math.max(Ge(en.type,Cr),en.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}}),Ze=0;function Tr(q,De){this.id=Ze++,this.type=q,this.data=De}function mr(q){return q.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Yt(q){if(0===q.length)return[];var De=q.charAt(0),it=q.charAt(q.length-1);if(q.length>1&&De===it&&('"'===De||"'"===De))return['"'+mr(q.substr(1,q.length-2))+'"'];var cr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(q);if(cr)return Yt(q.substr(0,cr.index)).concat(Yt(cr[1])).concat(Yt(q.substr(cr.index+cr[0].length)));var kr=q.split(".");if(1===kr.length)return['"'+mr(q)+'"'];for(var ur=[],Cr=0;Cr<kr.length;++Cr)ur=ur.concat(Yt(kr[Cr]));return ur}function gr(q){return"["+Yt(q).join("][")+"]"}var On={DynamicVariable:Tr,define:function(q,De){return new Tr(q,gr(De+""))},isDynamic:function(q){return"function"==typeof q&&!q._reglType||q instanceof Tr},unbox:function mn(q,De){return"function"==typeof q?new Tr(0,q):"number"==typeof q||"boolean"==typeof q?new Tr(5,q):Array.isArray(q)?new Tr(6,q.map(function(it,cr){return mn(it,De+"["+cr+"]")})):q instanceof Tr?q:void Z(!1,"invalid option type in uniform "+De)},accessor:gr},mi={next:"function"==typeof requestAnimationFrame?function(q){return requestAnimationFrame(q)}:function(q){return setTimeout(q,16)},cancel:"function"==typeof cancelAnimationFrame?function(q){return cancelAnimationFrame(q)}:clearTimeout},si="undefined"!=typeof my&&my&&"function"==typeof my.showToast?function(){return+new Date}:"undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function ve(q){return"string"==typeof q?q.split():(Z(Array.isArray(q),"invalid extension array"),q)}function _e(q){return"string"==typeof q?(Z("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(q)):q}function G(q){var it,cr,kr,ur,De=q||{},Cr={},Ur=[],Gr=[],Kr="undefined"==typeof window?1:window.devicePixelRatio,qr=!1,en=function(tn){tn&&Z.raise(tn)},pn=function(){};if("string"==typeof De?(Z("undefined"!=typeof document,"selector queries only supported in DOM environments"),it=document.querySelector(De),Z(it,"invalid query string for element")):"object"==typeof De?function(q){return"string"==typeof q.nodeName&&"function"==typeof q.appendChild&&"function"==typeof q.getBoundingClientRect}(De)?it=De:function(q){return"function"==typeof q.drawArrays||"function"==typeof q.drawElements}(De)?kr=(ur=De).canvas:(Z.constructor(De),"gl"in De?ur=De.gl:"canvas"in De?kr=_e(De.canvas):"container"in De&&(cr=_e(De.container)),"attributes"in De&&Z.type(Cr=De.attributes,"object","invalid context attributes"),"extensions"in De&&(Ur=ve(De.extensions)),"optionalExtensions"in De&&(Gr=ve(De.optionalExtensions)),"onDone"in De&&(Z.type(De.onDone,"function","invalid or missing onDone callback"),en=De.onDone),"profile"in De&&(qr=!!De.profile),"pixelRatio"in De&&Z((Kr=+De.pixelRatio)>0,"invalid pixel ratio")):Z.raise("invalid arguments to regl"),it&&("canvas"===it.nodeName.toLowerCase()?kr=it:cr=it),!ur){if(!kr){Z("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var Hr=function(q,De,it){var ur,cr=document.createElement("canvas");function kr(){var Ur=window.innerWidth,Gr=window.innerHeight;if(q!==document.body){var Kr=cr.getBoundingClientRect();Ur=Kr.right-Kr.left,Gr=Kr.bottom-Kr.top}cr.width=it*Ur,cr.height=it*Gr}return l(cr.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),q.appendChild(cr),q===document.body&&(cr.style.position="absolute",l(q.style,{margin:0,padding:0})),q!==document.body&&"function"==typeof ResizeObserver?(ur=new ResizeObserver(function(){setTimeout(kr)})).observe(q):window.addEventListener("resize",kr,!1),kr(),{canvas:cr,onDestroy:function(){ur?ur.disconnect():window.removeEventListener("resize",kr),q.removeChild(cr)}}}(cr||document.body,0,Kr);if(!Hr)return null;kr=Hr.canvas,pn=Hr.onDestroy}void 0===Cr.premultipliedAlpha&&(Cr.premultipliedAlpha=!0),ur=function(q,De){function it(cr){try{return q.getContext(cr,De)}catch(kr){return null}}return it("webgl")||it("experimental-webgl")||it("webgl-experimental")}(kr,Cr)}return ur?{gl:ur,canvas:kr,container:cr,extensions:Ur,optionalExtensions:Gr,pixelRatio:Kr,profile:qr,onDone:en,onDestroy:pn}:(pn(),en("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function oe(q,De){var it={};function cr(Ur){Z.type(Ur,"string","extension name must be string");var Kr,Gr=Ur.toLowerCase();try{Kr=it[Gr]=function(Ur){return q.getExtension(Ur)?q.getExtension(Ur):q.getExtension(Ur.toLowerCase())?q.getExtension(Ur.toLowerCase()):null}(Ur)}catch(qr){}return!!Kr}for(var ur=0;ur<De.extensions.length;++ur){var Cr=De.extensions[ur];if(!cr(Cr))return De.onDestroy(),De.onDone('"'+Cr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return De.optionalExtensions.forEach(cr),{extensions:it,restore:function(){Object.keys(it).forEach(function(Ur){if(it[Ur]&&!cr(Ur))throw new Error("(regl): error restoring extension "+Ur)})}}}function xe(q,De){for(var it=Array(q),cr=0;cr<q;++cr)it[cr]=De(cr);return it}function Rn(q){var De,it;return De=(q>65535)<<4,De|=it=((q>>>=De)>255)<<3,De|=it=((q>>>=it)>15)<<2,(De|=it=((q>>>=it)>3)<<1)|(q>>>=it)>>1}function Pn(){var q=xe(8,function(){return[]});function De(ur){var Cr=function(q){for(var De=16;De<=1<<28;De*=16)if(q<=De)return De;return 0}(ur),Ur=q[Rn(Cr)>>2];return Ur.length>0?Ur.pop():new ArrayBuffer(Cr)}function it(ur){q[Rn(ur.byteLength)>>2].push(ur)}return{alloc:De,free:it,allocType:function(ur,Cr){var Ur=null;switch(ur){case 5120:Ur=new Int8Array(De(Cr),0,Cr);break;case 5121:Ur=new Uint8Array(De(Cr),0,Cr);break;case 5122:Ur=new Int16Array(De(2*Cr),0,Cr);break;case 5123:Ur=new Uint16Array(De(2*Cr),0,Cr);break;case 5124:Ur=new Int32Array(De(4*Cr),0,Cr);break;case 5125:Ur=new Uint32Array(De(4*Cr),0,Cr);break;case 5126:Ur=new Float32Array(De(4*Cr),0,Cr);break;default:return null}return Ur.length!==Cr?Ur.subarray(0,Cr):Ur},freeType:function(ur){it(ur.buffer)}}}var rr=Pn();rr.zero=Pn();var aa=6408;function St(q){return!!q&&"object"==typeof q&&Array.isArray(q.shape)&&Array.isArray(q.stride)&&"number"==typeof q.offset&&q.shape.length===q.stride.length&&(Array.isArray(q.data)||_(q.data))}var or=function(q){return Object.keys(q).map(function(De){return q[De]})},Yr={shape:function(q){for(var De=[],it=q;it.length;it=it[0])De.push(it.length);return De},flatten:function(q,De,it,cr){var kr=1;if(De.length)for(var ur=0;ur<De.length;++ur)kr*=De[ur];else kr=0;var Cr=cr||rr.allocType(it,kr);switch(De.length){case 0:break;case 1:!function(q,De,it){for(var cr=0;cr<De;++cr)it[cr]=q[cr]}(q,De[0],Cr);break;case 2:!function(q,De,it,cr){for(var kr=0,ur=0;ur<De;++ur)for(var Cr=q[ur],Ur=0;Ur<it;++Ur)cr[kr++]=Cr[Ur]}(q,De[0],De[1],Cr);break;case 3:lo(q,De[0],De[1],De[2],Cr,0);break;default:ro(q,De,0,Cr,0)}return Cr}};function lo(q,De,it,cr,kr,ur){for(var Cr=ur,Ur=0;Ur<De;++Ur)for(var Gr=q[Ur],Kr=0;Kr<it;++Kr)for(var qr=Gr[Kr],en=0;en<cr;++en)kr[Cr++]=qr[en]}function ro(q,De,it,cr,kr){for(var ur=1,Cr=it+1;Cr<De.length;++Cr)ur*=De[Cr];var Ur=De[it];if(De.length-it==4){var Gr=De[it+1],Kr=De[it+2],qr=De[it+3];for(Cr=0;Cr<Ur;++Cr)lo(q[Cr],Gr,Kr,qr,cr,kr),kr+=ur}else for(Cr=0;Cr<Ur;++Cr)ro(q[Cr],De,it+1,cr,kr),kr+=ur}var du={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Qs={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ko={dynamic:35048,stream:35040,static:35044},Ol=Yr.flatten,Ll=Yr.shape,eu=[];function Dl(q){return 0|du[Object.prototype.toString.call(q)]}function g(q,De){for(var it=0;it<De.length;++it)q[it]=De[it]}function T(q,De,it,cr,kr,ur,Cr){for(var Ur=0,Gr=0;Gr<it;++Gr)for(var Kr=0;Kr<cr;++Kr)q[Ur++]=De[kr*Gr+ur*Kr+Cr]}eu[5120]=1,eu[5122]=2,eu[5124]=4,eu[5121]=1,eu[5123]=2,eu[5125]=4,eu[5126]=4;var Or={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},oa=5121,Fa=5123,Xo=5125;var Nl=new Float32Array(1),mu=new Uint32Array(Nl.buffer);function tu(q){for(var De=rr.allocType(5123,q.length),it=0;it<q.length;++it)if(isNaN(q[it]))De[it]=65535;else if(q[it]===1/0)De[it]=31744;else if(q[it]===-1/0)De[it]=64512;else{Nl[0]=q[it];var cr=mu[0],kr=cr>>>31<<15,ur=(cr<<1>>>24)-127,Cr=cr>>13&1023;De[it]=ur<-24?kr:ur<-14?kr+(Cr+1024>>-14-ur):ur>15?kr+31744:kr+(ur+15<<10)+Cr}return De}function oo(q){return Array.isArray(q)||_(q)}var Tc=function(q){return!(q&q-1||!q)},rs=3553,ru=34069,Rs=6408,La=6409,pl=34041,dl=36193,zu=5121,js=5126,yl=33984,Ro=[9984,9986,9985,9987],Fn=[0,La,6410,6407,Rs],za={};function Vu(q){return"[object "+q+"]"}za[La]=za[6406]=za[6402]=1,za[pl]=za[6410]=2,za[6407]=za[35904]=3,za[Rs]=za[35906]=4;var _l=Vu("HTMLCanvasElement"),iu=Vu("OffscreenCanvas"),Es=Vu("CanvasRenderingContext2D"),Xc=Vu("ImageBitmap"),hn=Vu("HTMLImageElement"),Yc=Vu("HTMLVideoElement"),Oc=Object.keys(du).concat([_l,iu,Es,Xc,hn,Yc]),xl=[];xl[zu]=1,xl[js]=4,xl[dl]=2,xl[5123]=2,xl[5125]=4;var Ga=[];function Ts(q){return Array.isArray(q)&&(0===q.length||"number"==typeof q[0])}function sc(q){return!!Array.isArray(q)&&!(0===q.length||!oo(q[0]))}function au(q){return Object.prototype.toString.call(q)}function Ds(q){return au(q)===_l}function Hs(q){return au(q)===iu}function Ws(q){return!!("undefined"!=typeof my&&my&&"function"==typeof my.showToast&&q&&q.getContext)}function Cs(q){if(!q)return!1;if(Ws(q))return!0;var De=au(q);return Oc.indexOf(De)>=0||Ts(q)||sc(q)||St(q)}function $i(q){return 0|du[Object.prototype.toString.call(q)]}function Ns(q,De){return rr.allocType(q.type===dl?js:q.type,De)}function Yo(q,De){q.type===dl?(q.data=tu(De),rr.freeType(De)):q.data=De}function bu(q,De,it,cr,kr,ur){var Cr;if(Cr=void 0!==Ga[q]?Ga[q]:za[q]*xl[De],ur&&(Cr*=6),kr){for(var Ur=0,Gr=it;Gr>=1;)Ur+=Cr*Gr*Gr,Gr/=2;return Ur}return Cr*it*cr}function ou(q,De,it,cr,kr,ur,Cr){var Ur={"don't care":4352,"dont care":4352,nice:4354,fast:4353},Gr={repeat:10497,clamp:33071,mirror:33648},Kr={nearest:9728,linear:9729},qr=l({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Kr),en={none:0,browser:37444},pn={uint8:zu,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Hr={alpha:6406,luminance:La,"luminance alpha":6410,rgb:6407,rgba:Rs,rgba4:32854,"rgb5 a1":32855,rgb565:36194},tn={};De.ext_srgb&&(Hr.srgb=35904,Hr.srgba=35906),De.oes_texture_float&&(pn.float32=pn.float=js),De.oes_texture_half_float&&(pn.float16=pn["half float"]=dl),De.webgl_depth_texture&&(l(Hr,{depth:6402,"depth stencil":pl}),l(pn,{uint16:5123,uint32:5125,"depth stencil":34042})),De.webgl_compressed_texture_s3tc&&l(tn,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),De.webgl_compressed_texture_atc&&l(tn,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),De.webgl_compressed_texture_pvrtc&&l(tn,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),De.webgl_compressed_texture_etc1&&(tn["rgb etc1"]=36196);var Vt=Array.prototype.slice.call(q.getParameter(34467)||new Uint32Array(0));Object.keys(tn).forEach(function(Qe){var vr=tn[Qe];Vt.indexOf(vr)>=0&&(Hr[Qe]=vr)});var _r=Object.keys(Hr);it.textureFormats=_r;var Wr=[];Object.keys(Hr).forEach(function(Qe){Wr[Hr[Qe]]=Qe});var An=[];Object.keys(pn).forEach(function(Qe){An[pn[Qe]]=Qe});var Mr=[];Object.keys(Kr).forEach(function(Qe){Mr[Kr[Qe]]=Qe});var wn=[];Object.keys(qr).forEach(function(Qe){wn[qr[Qe]]=Qe});var rn=[];Object.keys(Gr).forEach(function(Qe){rn[Gr[Qe]]=Qe});var ui=_r.reduce(function(Qe,vr){var tr=Hr[vr];return Qe[tr]=tr===La||6406===tr||tr===La||6410===tr||6402===tr||tr===pl||De.ext_srgb&&(35904===tr||35906===tr)?tr:32855===tr||vr.indexOf("rgba")>=0?Rs:6407,Qe},{});function Lr(){this.internalformat=Rs,this.format=Rs,this.type=zu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function Er(Qe,vr){Qe.internalformat=vr.internalformat,Qe.format=vr.format,Qe.type=vr.type,Qe.compressed=vr.compressed,Qe.premultiplyAlpha=vr.premultiplyAlpha,Qe.flipY=vr.flipY,Qe.unpackAlignment=vr.unpackAlignment,Qe.colorSpace=vr.colorSpace,Qe.width=vr.width,Qe.height=vr.height,Qe.channels=vr.channels}function Gn(Qe,vr){if("object"==typeof vr&&vr){if("premultiplyAlpha"in vr&&(Z.type(vr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Qe.premultiplyAlpha=vr.premultiplyAlpha),"flipY"in vr&&(Z.type(vr.flipY,"boolean","invalid texture flip"),Qe.flipY=vr.flipY),"alignment"in vr&&(Z.oneOf(vr.alignment,[1,2,4,8],"invalid texture unpack alignment"),Qe.unpackAlignment=vr.alignment),"colorSpace"in vr&&(Z.parameter(vr.colorSpace,en,"invalid colorSpace"),Qe.colorSpace=en[vr.colorSpace]),"type"in vr){var tr=vr.type;Z(De.oes_texture_float||!("float"===tr||"float32"===tr),"you must enable the OES_texture_float extension in order to use floating point textures."),Z(De.oes_texture_half_float||!("half float"===tr||"float16"===tr),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Z(De.webgl_depth_texture||!("uint16"===tr||"uint32"===tr||"depth stencil"===tr),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Z.parameter(tr,pn,"invalid texture type"),Qe.type=pn[tr]}var zn=Qe.width,ya=Qe.height,He=Qe.channels,Pe=!1;"shape"in vr?(Z(Array.isArray(vr.shape)&&vr.shape.length>=2,"shape must be an array"),zn=vr.shape[0],ya=vr.shape[1],3===vr.shape.length&&(Z((He=vr.shape[2])>0&&He<=4,"invalid number of channels"),Pe=!0),Z(zn>=0&&zn<=it.maxTextureSize,"invalid width"),Z(ya>=0&&ya<=it.maxTextureSize,"invalid height")):("radius"in vr&&(zn=ya=vr.radius,Z(zn>=0&&zn<=it.maxTextureSize,"invalid radius")),"width"in vr&&Z((zn=vr.width)>=0&&zn<=it.maxTextureSize,"invalid width"),"height"in vr&&Z((ya=vr.height)>=0&&ya<=it.maxTextureSize,"invalid height"),"channels"in vr&&(Z((He=vr.channels)>0&&He<=4,"invalid number of channels"),Pe=!0)),Qe.width=0|zn,Qe.height=0|ya,Qe.channels=0|He;var vt=!1;if("format"in vr){var jt=vr.format;Z(De.webgl_depth_texture||!("depth"===jt||"depth stencil"===jt),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Z.parameter(jt,Hr,"invalid texture format");var fr=Qe.internalformat=Hr[jt];Qe.format=ui[fr],jt in pn&&("type"in vr||(Qe.type=pn[jt])),jt in tn&&(Qe.compressed=!0),vt=!0}!Pe&&vt?Qe.channels=za[Qe.format]:Pe&&!vt?Qe.channels!==Fn[Qe.format]&&(Qe.format=Qe.internalformat=Fn[Qe.channels]):vt&&Pe&&Z(Qe.channels===za[Qe.format],"number of channels inconsistent with specified format")}}function vn(Qe){q.pixelStorei(37440,Qe.flipY),q.pixelStorei(37441,Qe.premultiplyAlpha),q.pixelStorei(37443,Qe.colorSpace),q.pixelStorei(3317,Qe.unpackAlignment)}function Jr(){Lr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function xn(Qe,vr){var tr=null;if(Cs(vr)?tr=vr:vr&&(Z.type(vr,"object","invalid pixel data type"),Gn(Qe,vr),"x"in vr&&(Qe.xOffset=0|vr.x),"y"in vr&&(Qe.yOffset=0|vr.y),Cs(vr.data)&&(tr=vr.data)),Z(!Qe.compressed||tr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),vr.copy){Z(!tr,"can not specify copy and data field for the same texture");var zn=kr.viewportWidth,ya=kr.viewportHeight;Qe.width=Qe.width||zn-Qe.xOffset,Qe.height=Qe.height||ya-Qe.yOffset,Qe.needsCopy=!0,Z(Qe.xOffset>=0&&Qe.xOffset<zn&&Qe.yOffset>=0&&Qe.yOffset<ya&&Qe.width>0&&Qe.width<=zn&&Qe.height>0&&Qe.height<=ya,"copy texture read out of bounds")}else if(tr){if(_(tr))Qe.channels=Qe.channels||4,Qe.data=tr,!("type"in vr)&&Qe.type===zu&&(Qe.type=$i(tr));else if(Ts(tr))Qe.channels=Qe.channels||4,function(q,De){var it=De.length;switch(q.type){case zu:case 5123:case 5125:case js:var cr=rr.allocType(q.type,it);cr.set(De),q.data=cr;break;case dl:q.data=tu(De);break;default:Z.raise("unsupported texture type, must specify a typed array")}}(Qe,tr),Qe.alignment=1,Qe.needsFree=!0;else if(St(tr)){var He=tr.data;!Array.isArray(He)&&Qe.type===zu&&(Qe.type=$i(He));var jt,fr,At,bt,dt,ze,Pe=tr.shape,vt=tr.stride;3===Pe.length?(At=Pe[2],ze=vt[2]):(Z(2===Pe.length,"invalid ndarray pixel data, must be 2 or 3D"),At=1,ze=1),jt=Pe[0],fr=Pe[1],bt=vt[0],dt=vt[1],Qe.alignment=1,Qe.width=jt,Qe.height=fr,Qe.channels=At,Qe.format=Qe.internalformat=Fn[At],Qe.needsFree=!0,function(q,De,it,cr,kr,ur){for(var Cr=q.width,Ur=q.height,Gr=q.channels,qr=Ns(q,Cr*Ur*Gr),en=0,pn=0;pn<Ur;++pn)for(var Hr=0;Hr<Cr;++Hr)for(var tn=0;tn<Gr;++tn)qr[en++]=De[it*Hr+cr*pn+kr*tn+ur];Yo(q,qr)}(Qe,He,bt,dt,ze,tr.offset)}else if(Ws(tr)||Ds(tr)||Hs(tr)||function(q){return au(q)===Es}(tr))Qe.element=Ws(tr)||Ds(tr)||Hs(tr)?tr:tr.canvas,Qe.width=Qe.element.width,Qe.height=Qe.element.height,Qe.channels=4;else if(function(q){return au(q)===Xc}(tr))Qe.element=tr,Qe.width=tr.width,Qe.height=tr.height,Qe.channels=4;else if(function(q){return au(q)===hn}(tr))Qe.element=tr,Qe.width=tr.naturalWidth,Qe.height=tr.naturalHeight,Qe.channels=4;else if(function(q){return au(q)===Yc}(tr))Qe.element=tr,Qe.width=tr.videoWidth,Qe.height=tr.videoHeight,Qe.channels=4;else if(sc(tr)){var ht=Qe.width||tr[0].length,We=Qe.height||tr.length,Ht=Qe.channels;Ht=oo(tr[0][0])?Ht||tr[0][0].length:Ht||1;for(var $t=Yr.shape(tr),Zr=1,un=0;un<$t.length;++un)Zr*=$t[un];var ln=Ns(Qe,Zr);Yr.flatten(tr,$t,"",ln),Yo(Qe,ln),Qe.alignment=1,Qe.width=ht,Qe.height=We,Qe.channels=Ht,Qe.format=Qe.internalformat=Fn[Ht],Qe.needsFree=!0}}else Qe.width=Qe.width||1,Qe.height=Qe.height||1,Qe.channels=Qe.channels||4;Qe.type===js?Z(it.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Qe.type===dl&&Z(it.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function En(Qe,vr,tr){var zn=Qe.element,ya=Qe.data,He=Qe.internalformat,Pe=Qe.format,vt=Qe.type,jt=Qe.width,fr=Qe.height;vn(Qe),zn?q.texImage2D(vr,tr,Pe,Pe,vt,zn):Qe.compressed?q.compressedTexImage2D(vr,tr,He,jt,fr,0,ya):Qe.needsCopy?(cr(),q.copyTexImage2D(vr,tr,Pe,Qe.xOffset,Qe.yOffset,jt,fr,0)):q.texImage2D(vr,tr,Pe,jt,fr,0,Pe,vt,ya||null)}function zi(Qe,vr,tr,zn,ya){var He=Qe.element,Pe=Qe.data,vt=Qe.internalformat,jt=Qe.format,fr=Qe.type,At=Qe.width,bt=Qe.height;vn(Qe),He?q.texSubImage2D(vr,ya,tr,zn,jt,fr,He):Qe.compressed?q.compressedTexSubImage2D(vr,ya,tr,zn,vt,At,bt,Pe):Qe.needsCopy?(cr(),q.copyTexSubImage2D(vr,ya,tr,zn,Qe.xOffset,Qe.yOffset,At,bt)):q.texSubImage2D(vr,ya,tr,zn,At,bt,jt,fr,Pe)}var Ii=[];function Cn(){return Ii.pop()||new Jr}function Tn(Qe){Qe.needsFree&&rr.freeType(Qe.data),Jr.call(Qe),Ii.push(Qe)}function _i(){Lr.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Zi(Qe,vr,tr){var zn=Qe.images[0]=Cn();Qe.mipmask=1,zn.width=Qe.width=vr,zn.height=Qe.height=tr,zn.channels=Qe.channels=4}function fa(Qe,vr){var tr=null;if(Cs(vr))Er(tr=Qe.images[0]=Cn(),Qe),xn(tr,vr),Qe.mipmask=1;else if(Gn(Qe,vr),Array.isArray(vr.mipmap))for(var zn=vr.mipmap,ya=0;ya<zn.length;++ya)Er(tr=Qe.images[ya]=Cn(),Qe),tr.width>>=ya,tr.height>>=ya,xn(tr,zn[ya]),Qe.mipmask|=1<<ya;else Er(tr=Qe.images[0]=Cn(),Qe),xn(tr,vr),Qe.mipmask=1;Er(Qe,Qe.images[0]),Qe.compressed&&(33776===Qe.internalformat||33777===Qe.internalformat||33778===Qe.internalformat||33779===Qe.internalformat)&&Z(Qe.width%4==0&&Qe.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Io(Qe,vr){for(var tr=Qe.images,zn=0;zn<tr.length;++zn){if(!tr[zn])return;En(tr[zn],vr,zn)}}var Mo=[];function ha(){var Qe=Mo.pop()||new _i;Lr.call(Qe),Qe.mipmask=0;for(var vr=0;vr<16;++vr)Qe.images[vr]=null;return Qe}function ds(Qe){for(var vr=Qe.images,tr=0;tr<vr.length;++tr)vr[tr]&&Tn(vr[tr]),vr[tr]=null;Mo.push(Qe)}function so(){this.minFilter=9728,this.magFilter=9728,this.wrapS=33071,this.wrapT=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function vs(Qe,vr){if("min"in vr){var tr=vr.min;Z.parameter(tr,qr),Qe.minFilter=qr[tr],Ro.indexOf(Qe.minFilter)>=0&&!("faces"in vr)&&(Qe.genMipmaps=!0)}if("mag"in vr){var zn=vr.mag;Z.parameter(zn,Kr),Qe.magFilter=Kr[zn]}var ya=Qe.wrapS,He=Qe.wrapT;if("wrap"in vr){var Pe=vr.wrap;"string"==typeof Pe?(Z.parameter(Pe,Gr),ya=He=Gr[Pe]):Array.isArray(Pe)&&(Z.parameter(Pe[0],Gr),Z.parameter(Pe[1],Gr),ya=Gr[Pe[0]],He=Gr[Pe[1]])}else{if("wrapS"in vr){var vt=vr.wrapS;Z.parameter(vt,Gr),ya=Gr[vt]}if("wrapT"in vr){var jt=vr.wrapT;Z.parameter(jt,Gr),He=Gr[jt]}}if(Qe.wrapS=ya,Qe.wrapT=He,"anisotropic"in vr){var fr=vr.anisotropic;Z("number"==typeof fr&&fr>=1&&fr<=it.maxAnisotropic,"aniso samples must be between 1 and "),Qe.anisotropic=vr.anisotropic}if("mipmap"in vr){var At=!1;switch(typeof vr.mipmap){case"string":Z.parameter(vr.mipmap,Ur,"invalid mipmap hint"),Qe.mipmapHint=Ur[vr.mipmap],Qe.genMipmaps=!0,At=!0;break;case"boolean":At=Qe.genMipmaps=vr.mipmap;break;case"object":Z(Array.isArray(vr.mipmap),"invalid mipmap type"),Qe.genMipmaps=!1,At=!0;break;default:Z.raise("invalid mipmap type")}At&&!("min"in vr)&&(Qe.minFilter=9984)}}function Uo(Qe,vr){q.texParameteri(vr,10241,Qe.minFilter),q.texParameteri(vr,10240,Qe.magFilter),q.texParameteri(vr,10242,Qe.wrapS),q.texParameteri(vr,10243,Qe.wrapT),De.ext_texture_filter_anisotropic&&q.texParameteri(vr,34046,Qe.anisotropic),Qe.genMipmaps&&(q.hint(33170,Qe.mipmapHint),q.generateMipmap(vr))}var ss=0,ms={},us=it.maxTextureUnits,Vo=Array(us).map(function(){return null});function Hi(Qe){Lr.call(this),this.mipmask=0,this.internalformat=Rs,this.id=ss++,this.refCount=1,this.target=Qe,this.texture=q.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new so,Cr.profile&&(this.stats={size:0})}function ls(Qe){q.activeTexture(yl),q.bindTexture(Qe.target,Qe.texture)}function ka(){var Qe=Vo[0];Qe?q.bindTexture(Qe.target,Qe.texture):q.bindTexture(rs,null)}function uo(Qe){var vr=Qe.texture;Z(vr,"must not double destroy texture");var tr=Qe.unit,zn=Qe.target;tr>=0&&(q.activeTexture(yl+tr),q.bindTexture(zn,null),Vo[tr]=null),q.deleteTexture(vr),Qe.texture=null,Qe.params=null,Qe.pixels=null,Qe.refCount=0,delete ms[Qe.id],ur.textureCount--}return l(Hi.prototype,{bind:function(){var Qe=this;Qe.bindCount+=1;var vr=Qe.unit;if(vr<0){for(var tr=0;tr<us;++tr){var zn=Vo[tr];if(zn){if(zn.bindCount>0)continue;zn.unit=-1}Vo[tr]=Qe,vr=tr;break}vr>=us&&Z.raise("insufficient number of texture units"),Cr.profile&&ur.maxTextureUnits<vr+1&&(ur.maxTextureUnits=vr+1),Qe.unit=vr,q.activeTexture(yl+vr),q.bindTexture(Qe.target,Qe.texture)}return vr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&uo(this)}}),Cr.profile&&(ur.getTotalTextureSize=function(){var Qe=0;return Object.keys(ms).forEach(function(vr){Qe+=ms[vr].stats.size}),Qe}),{create2D:function(Qe,vr){var tr=new Hi(rs);function zn(Pe,vt){var jt=tr.texInfo;so.call(jt);var fr=ha();return"number"==typeof Pe?Zi(fr,0|Pe,"number"==typeof vt?0|vt:0|Pe):Pe?(Z.type(Pe,"object","invalid arguments to regl.texture"),vs(jt,Pe),fa(fr,Pe)):Zi(fr,1,1),jt.genMipmaps&&(fr.mipmask=(fr.width<<1)-1),tr.mipmask=fr.mipmask,Er(tr,fr),Z.texture2D(jt,fr,it),tr.internalformat=fr.internalformat,zn.width=fr.width,zn.height=fr.height,ls(tr),Io(fr,rs),Uo(jt,rs),ka(),ds(fr),Cr.profile&&(tr.stats.size=bu(tr.internalformat,tr.type,fr.width,fr.height,jt.genMipmaps,!1)),zn.format=Wr[tr.internalformat],zn.type=An[tr.type],zn.mag=Mr[jt.magFilter],zn.min=wn[jt.minFilter],zn.wrapS=rn[jt.wrapS],zn.wrapT=rn[jt.wrapT],zn}return ms[tr.id]=tr,ur.textureCount++,zn(Qe,vr),zn.subimage=function(Pe,vt,jt,fr){Z(!!Pe,"must specify image data");var At=0|vt,bt=0|jt,dt=0|fr,ze=Cn();return Er(ze,tr),ze.width=0,ze.height=0,xn(ze,Pe),ze.width=ze.width||(tr.width>>dt)-At,ze.height=ze.height||(tr.height>>dt)-bt,Z(tr.type===ze.type&&tr.format===ze.format&&tr.internalformat===ze.internalformat,"incompatible format for texture.subimage"),Z(At>=0&&bt>=0&&At+ze.width<=tr.width&&bt+ze.height<=tr.height,"texture.subimage write out of bounds"),Z(tr.mipmask&1<<dt,"missing mipmap data"),Z(ze.data||ze.element||ze.needsCopy,"missing image data"),ls(tr),zi(ze,rs,At,bt,dt),ka(),Tn(ze),zn},zn.resize=function(Pe,vt){var jt=0|Pe,fr=0|vt||jt;if(jt===tr.width&&fr===tr.height)return zn;zn.width=tr.width=jt,zn.height=tr.height=fr,ls(tr);for(var At=0;tr.mipmask>>At;++At){var bt=jt>>At,dt=fr>>At;if(!bt||!dt)break;q.texImage2D(rs,At,tr.format,bt,dt,0,tr.format,tr.type,null)}return ka(),Cr.profile&&(tr.stats.size=bu(tr.internalformat,tr.type,jt,fr,!1,!1)),zn},zn._reglType="texture2d",zn._texture=tr,Cr.profile&&(zn.stats=tr.stats),zn.destroy=function(){tr.decRef()},zn},createCube:function(Qe,vr,tr,zn,ya,He){var Pe=new Hi(34067);ms[Pe.id]=Pe,ur.cubeCount++;var vt=new Array(6);function jt(bt,dt,ze,ht,We,Ht){var $t,Zr=Pe.texInfo;for(so.call(Zr),$t=0;$t<6;++$t)vt[$t]=ha();if("number"!=typeof bt&&bt)if("object"==typeof bt)if(dt)fa(vt[0],bt),fa(vt[1],dt),fa(vt[2],ze),fa(vt[3],ht),fa(vt[4],We),fa(vt[5],Ht);else if(vs(Zr,bt),Gn(Pe,bt),"faces"in bt){var ln=bt.faces;for(Z(Array.isArray(ln)&&6===ln.length,"cube faces must be a length 6 array"),$t=0;$t<6;++$t)Z("object"==typeof ln[$t]&&!!ln[$t],"invalid input for cube map face"),Er(vt[$t],Pe),fa(vt[$t],ln[$t])}else for($t=0;$t<6;++$t)fa(vt[$t],bt);else Z.raise("invalid arguments to cube map");else{var un=0|bt||1;for($t=0;$t<6;++$t)Zi(vt[$t],un,un)}for(Er(Pe,vt[0]),Z.optional(function(){it.npotTextureCube||Z(Tc(Pe.width)&&Tc(Pe.height),"your browser does not support non power or two texture dimensions")}),Pe.mipmask=Zr.genMipmaps?(vt[0].width<<1)-1:vt[0].mipmask,Z.textureCube(Pe,Zr,vt,it),Pe.internalformat=vt[0].internalformat,jt.width=vt[0].width,jt.height=vt[0].height,ls(Pe),$t=0;$t<6;++$t)Io(vt[$t],ru+$t);for(Uo(Zr,34067),ka(),Cr.profile&&(Pe.stats.size=bu(Pe.internalformat,Pe.type,jt.width,jt.height,Zr.genMipmaps,!0)),jt.format=Wr[Pe.internalformat],jt.type=An[Pe.type],jt.mag=Mr[Zr.magFilter],jt.min=wn[Zr.minFilter],jt.wrapS=rn[Zr.wrapS],jt.wrapT=rn[Zr.wrapT],$t=0;$t<6;++$t)ds(vt[$t]);return jt}return jt(Qe,vr,tr,zn,ya,He),jt.subimage=function(bt,dt,ze,ht,We){Z(!!dt,"must specify image data"),Z("number"==typeof bt&&bt===(0|bt)&&bt>=0&&bt<6,"invalid face");var Ht=0|ze,$t=0|ht,Zr=0|We,un=Cn();return Er(un,Pe),un.width=0,un.height=0,xn(un,dt),un.width=un.width||(Pe.width>>Zr)-Ht,un.height=un.height||(Pe.height>>Zr)-$t,Z(Pe.type===un.type&&Pe.format===un.format&&Pe.internalformat===un.internalformat,"incompatible format for texture.subimage"),Z(Ht>=0&&$t>=0&&Ht+un.width<=Pe.width&&$t+un.height<=Pe.height,"texture.subimage write out of bounds"),Z(Pe.mipmask&1<<Zr,"missing mipmap data"),Z(un.data||un.element||un.needsCopy,"missing image data"),ls(Pe),zi(un,ru+bt,Ht,$t,Zr),ka(),Tn(un),jt},jt.resize=function(bt){var dt=0|bt;if(dt!==Pe.width){jt.width=Pe.width=dt,jt.height=Pe.height=dt,ls(Pe);for(var ze=0;ze<6;++ze)for(var ht=0;Pe.mipmask>>ht;++ht)q.texImage2D(ru+ze,ht,Pe.format,dt>>ht,dt>>ht,0,Pe.format,Pe.type,null);return ka(),Cr.profile&&(Pe.stats.size=bu(Pe.internalformat,Pe.type,jt.width,jt.height,!1,!0)),jt}},jt._reglType="textureCube",jt._texture=Pe,Cr.profile&&(jt.stats=Pe.stats),jt.destroy=function(){Pe.decRef()},jt},clear:function(){for(var Qe=0;Qe<us;++Qe)q.activeTexture(yl+Qe),q.bindTexture(rs,null),Vo[Qe]=null;or(ms).forEach(uo),ur.cubeCount=0,ur.textureCount=0},getTexture:function(Qe){return null},restore:function(){for(var Qe=0;Qe<us;++Qe){var vr=Vo[Qe];vr&&(vr.bindCount=0,vr.unit=-1,Vo[Qe]=null)}or(ms).forEach(function(tr){tr.texture=q.createTexture(),q.bindTexture(tr.target,tr.texture);for(var zn=0;zn<32;++zn)if(0!=(tr.mipmask&1<<zn))if(tr.target===rs)q.texImage2D(rs,zn,tr.internalformat,tr.width>>zn,tr.height>>zn,0,tr.internalformat,tr.type,null);else for(var ya=0;ya<6;++ya)q.texImage2D(ru+ya,zn,tr.internalformat,tr.width>>zn,tr.height>>zn,0,tr.internalformat,tr.type,null);Uo(tr.texInfo,tr.target)})},refresh:function(){for(var Qe=0;Qe<us;++Qe){var vr=Vo[Qe];vr&&(vr.bindCount=0,vr.unit=-1,Vo[Qe]=null),q.activeTexture(yl+Qe),q.bindTexture(rs,null),q.bindTexture(34067,null)}}}}Ga[32854]=2,Ga[32855]=2,Ga[36194]=2,Ga[pl]=4,Ga[33776]=.5,Ga[33777]=.5,Ga[33778]=1,Ga[33779]=1,Ga[35986]=.5,Ga[35987]=1,Ga[34798]=1,Ga[35840]=.5,Ga[35841]=.25,Ga[35842]=.5,Ga[35843]=.25,Ga[36196]=.5;var mo=36161,il=32854,Qi=[];function zo(q,De,it){return Qi[q]*De*it}Qi[il]=2,Qi[32855]=2,Qi[36194]=2,Qi[33189]=2,Qi[36168]=1,Qi[34041]=4,Qi[35907]=4,Qi[34836]=16,Qi[34842]=8,Qi[34843]=6;var As=36160,ys=3553,is=34069,cc=[6407,6408],fc=[];fc[6408]=4,fc[6407]=3;var El=[];El[5121]=1,El[5126]=4,El[36193]=2;var Ce=[32854,32855,36194,35907,34842,34843,34836],Me={};Me[36053]="complete",Me[36054]="incomplete attachment",Me[36057]="incomplete dimensions",Me[36055]="incomplete, missing attachment",Me[36061]="unsupported";var Ke=["attributes","elements","offset","count","primitive","instances"];function ft(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}var Xr=5121;function Vn(q,De,it,cr,kr,ur,Cr){function Ur(qr){var en;null===De.next?(Z(kr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),en=Xr):(Z(null!==De.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),en=De.next.colorAttachments[0].texture._texture.type,Z.optional(function(){ur.oes_texture_float?(Z(en===Xr||5126===en,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),5126===en&&Z(Cr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Z(en===Xr,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var pn=0,Hr=0,tn=cr.framebufferWidth,Vt=cr.framebufferHeight,_r=null;_(qr)?_r=qr:qr&&(Z.type(qr,"object","invalid arguments to regl.read()"),Hr=0|qr.y,Z((pn=0|qr.x)>=0&&pn<cr.framebufferWidth,"invalid x offset for regl.read"),Z(Hr>=0&&Hr<cr.framebufferHeight,"invalid y offset for regl.read"),tn=0|(qr.width||cr.framebufferWidth-pn),Vt=0|(qr.height||cr.framebufferHeight-Hr),_r=qr.data||null),_r&&(en===Xr?Z(_r instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):5126===en&&Z(_r instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Z(tn>0&&tn+pn<=cr.framebufferWidth,"invalid width for read pixels"),Z(Vt>0&&Vt+Hr<=cr.framebufferHeight,"invalid height for read pixels"),it();var Wr=tn*Vt*4;return _r||(en===Xr?_r=new Uint8Array(Wr):5126===en&&(_r=_r||new Float32Array(Wr))),Z.isTypedArray(_r,"data buffer for regl.read() must be a typedarray"),Z(_r.byteLength>=Wr,"data buffer for regl.read() too small"),q.pixelStorei(3333,4),q.readPixels(pn,Hr,tn,Vt,6408,en,_r),_r}return function(qr){return qr&&"framebuffer"in qr?function(qr){var en;return De.setFBO({framebuffer:qr.framebuffer},function(){en=Ur(qr)}),en}(qr):Ur(qr)}}function Nn(q){return Array.prototype.slice.call(q)}function Li(q){return Nn(q).join("")}var gi="xyzw".split(""),Nt="blend.enable",Lt="blend.color",lr="blend.equation",jr="blend.func",Ln="depth.enable",Xn="depth.func",ni="depth.range",Ci="depth.mask",Si="colorMask",ea="cull.enable",xa="cull.face",ua="frontFace",Ha="lineWidth",Wa="polygonOffset.enable",Ka="polygonOffset.offset",ia="sample.alpha",ga="sample.enable",la="sample.coverage",no="stencil.enable",ki="stencil.mask",Ca="stencil.func",ba="stencil.opFront",go="stencil.opBack",Yl="scissor.enable",uu="scissor.box",Ko="viewport",Su="profile",Hu="framebuffer",ul="vert",Ys="frag",Kl="elements",Wu="primitive",ca="count",Hf="offset",Tl="instances",Wf="vao",Ks="Width",xh="Height",Dc=Hu+Ks,hc=Hu+xh,Xf="drawingBuffer",ll=Xf+Ks,qc=Xf+xh,$h=[jr,lr,Ca,ba,go,la,Ko,uu,Ka],hf=34962,pf=35664,Pf=35665,Bc=35666,Iu=35667,Yf=35668,Cl=35669,If=35671,Mf=35672,Qc=35673,vf=35674,Fs=35675,Kf=35676,_s=35678,ql=35680,ef=1028,Js=1029,rf=7680,Mu={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ch=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Al={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Jl={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ah={frag:35632,vert:35633},$f={cw:2304,ccw:2305};function yf(q){return Array.isArray(q)||_(q)||St(q)}function Lf(q){return q.sort(function(De,it){return De===Ko?-1:it===Ko?1:De<it?-1:1})}function as(q,De,it,cr){this.thisDep=q,this.contextDep=De,this.propDep=it,this.append=cr}function Zo(q){return q&&!(q.thisDep||q.contextDep||q.propDep)}function os(q){return new as(!1,!1,!1,q)}function cu(q,De){var it=q.type;if(0===it){var cr=q.data.length;return new as(!0,cr>=1,cr>=2,De)}if(4===it){var kr=q.data;return new as(kr.thisDep,kr.contextDep,kr.propDep,De)}if(5===it)return new as(!1,!1,!1,De);if(6===it){for(var ur=!1,Cr=!1,Ur=!1,Gr=0;Gr<q.data.length;++Gr){var Kr=q.data[Gr];if(1===Kr.type)Ur=!0;else if(2===Kr.type)Cr=!0;else if(3===Kr.type)ur=!0;else if(0===Kr.type){ur=!0;var qr=Kr.data;qr>=1&&(Cr=!0),qr>=2&&(Ur=!0)}else 4===Kr.type&&(ur=ur||Kr.data.thisDep,Cr=Cr||Kr.data.contextDep,Ur=Ur||Kr.data.propDep)}return new as(ur,Cr,Ur,De)}return new as(3===it,2===it,1===it,De)}var Ph=new as(!1,!1,!1,function(){});function Ap(q,De,it,cr,kr,ur,Cr,Ur,Gr,Kr,qr,en,pn,Hr,tn){var Vt=Kr.Record,_r={add:32774,subtract:32778,"reverse subtract":32779};it.ext_blend_minmax&&(_r.min=32775,_r.max=32776);var Wr=it.angle_instanced_arrays,An=it.webgl_draw_buffers,Mr=it.oes_vertex_array_object,wn={dirty:!0,profile:tn.profile},rn={},ui=[],Lr={},Er={};function Gn(He){return He.replace(".","_")}function vn(He,Pe,vt){var jt=Gn(He);ui.push(He),rn[jt]=wn[jt]=!!vt,Lr[jt]=Pe}function Jr(He,Pe,vt){var jt=Gn(He);ui.push(He),Array.isArray(vt)?(wn[jt]=vt.slice(),rn[jt]=vt.slice()):wn[jt]=rn[jt]=vt,Er[jt]=Pe}vn("dither",3024),vn(Nt,3042),Jr(Lt,"blendColor",[0,0,0,0]),Jr(lr,"blendEquationSeparate",[32774,32774]),Jr(jr,"blendFuncSeparate",[1,0,1,0]),vn(Ln,2929,!0),Jr(Xn,"depthFunc",513),Jr(ni,"depthRange",[0,1]),Jr(Ci,"depthMask",!0),Jr(Si,Si,[!0,!0,!0,!0]),vn(ea,2884),Jr(xa,"cullFace",Js),Jr(ua,ua,2305),Jr(Ha,Ha,1),vn(Wa,32823),Jr(Ka,"polygonOffset",[0,0]),vn(ia,32926),vn(ga,32928),Jr(la,"sampleCoverage",[1,!1]),vn(no,2960),Jr(ki,"stencilMask",-1),Jr(Ca,"stencilFunc",[519,0,-1]),Jr(ba,"stencilOpSeparate",[ef,rf,rf,rf]),Jr(go,"stencilOpSeparate",[Js,rf,rf,rf]),vn(Yl,3089),Jr(uu,"scissor",[0,0,q.drawingBufferWidth,q.drawingBufferHeight]),Jr(Ko,Ko,[0,0,q.drawingBufferWidth,q.drawingBufferHeight]);var xn={gl:q,context:pn,strings:De,next:rn,current:wn,draw:en,elements:ur,buffer:kr,shader:qr,attributes:Kr.state,vao:Kr,uniforms:Gr,framebuffer:Ur,extensions:it,timer:Hr,isBufferArgs:yf},En={primTypes:Or,compareFuncs:Al,blendFuncs:Mu,blendEquations:_r,stencilOps:Jl,glTypes:Qs,orientationType:$f};Z.optional(function(){xn.isArrayLike=oo}),An&&(En.backBuffer=[Js],En.drawBuffer=xe(cr.maxDrawbuffers,function(He){return 0===He?[0]:xe(He,function(Pe){return 36064+Pe})}));var zi=0;function Ii(){var He=function(){var q=0,De=[],it=[];function kr(){var en=[],Hr=[];return l(function(){en.push.apply(en,Nn(arguments))},{def:function(){var Vt="v"+q++;return Hr.push(Vt),arguments.length>0&&(en.push(Vt,"="),en.push.apply(en,Nn(arguments)),en.push(";")),Vt},toString:function(){return Li([Hr.length>0?"var "+Hr.join(",")+";":"",Li(en)])}})}function ur(){var en=kr(),pn=kr(),Hr=en.toString,tn=pn.toString;function Vt(_r,Wr){pn(_r,Wr,"=",en.def(_r,Wr),";")}return l(function(){en.apply(en,Nn(arguments))},{def:en.def,entry:en,exit:pn,save:Vt,set:function(_r,Wr,An){Vt(_r,Wr),en(_r,Wr,"=",An,";")},toString:function(){return Hr()+tn()}})}var Ur=kr(),Gr={};return{global:Ur,link:function(en){for(var pn=0;pn<it.length;++pn)if(it[pn]===en)return De[pn];var Hr="g"+q++;return De.push(Hr),it.push(en),Hr},block:kr,proc:function(en,pn){var Hr=[];function tn(){var Mr="a"+Hr.length;return Hr.push(Mr),Mr}pn=pn||0;for(var Vt=0;Vt<pn;++Vt)tn();var _r=ur(),Wr=_r.toString;return Gr[en]=l(_r,{arg:tn,toString:function(){return Li(["function(",Hr.join(),"){",Wr(),"}"])}})},scope:ur,cond:function(){var en=Li(arguments),pn=ur(),Hr=ur(),tn=pn.toString,Vt=Hr.toString;return l(pn,{then:function(){return pn.apply(pn,Nn(arguments)),this},else:function(){return Hr.apply(Hr,Nn(arguments)),this},toString:function(){var _r=Vt();return _r&&(_r="else{"+_r+"}"),Li(["if(",en,"){",tn(),"}",_r])}})},compile:function(){var en=['"use strict";',Ur,"return {"];Object.keys(Gr).forEach(function(Vt){en.push('"',Vt,'":',Gr[Vt].toString(),",")}),en.push("}");var pn=Li(en).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return("undefined"!=typeof my&&my&&"function"==typeof my.showToast?M.Function.apply(null,De.concat(pn)):Function.apply(null,De.concat(pn))).apply(null,it)}}}(),Pe=He.link,vt=He.global;He.id=zi++,He.batchId="0";var jt=Pe(xn),fr=He.shared={props:"a0"};Object.keys(xn).forEach(function(ht){fr[ht]=vt.def(jt,".",ht)}),Z.optional(function(){He.CHECK=Pe(Z),He.commandStr=Z.guessCommand(),He.command=Pe(He.commandStr),He.assert=function(ht,We,Ht){ht("if(!(",We,"))",this.CHECK,".commandRaise(",Pe(Ht),",",this.command,");")},En.invalidBlendCombinations=Ch});var At=He.next={},bt=He.current={};Object.keys(Er).forEach(function(ht){Array.isArray(wn[ht])&&(At[ht]=vt.def(fr.next,".",ht),bt[ht]=vt.def(fr.current,".",ht))});var dt=He.constants={};Object.keys(En).forEach(function(ht){dt[ht]=vt.def(JSON.stringify(En[ht]))}),He.invoke=function(ht,We){switch(We.type){case 0:var Ht=["this",fr.context,fr.props,He.batchId];return ht.def(Pe(We.data),".call(",Ht.slice(0,Math.max(We.data.length+1,4)),")");case 1:return ht.def(fr.props,We.data);case 2:return ht.def(fr.context,We.data);case 3:return ht.def("this",We.data);case 4:return We.data.append(He,ht),We.data.ref;case 5:return We.data.toString();case 6:return We.data.map(function($t){return He.invoke(ht,$t)})}},He.attribCache={};var ze={};return He.scopeAttrib=function(ht){var We=De.id(ht);if(We in ze)return ze[We];var Ht=Kr.scope[We];return Ht||(Ht=Kr.scope[We]=new Vt),ze[We]=Pe(Ht)},He}function vs(He,Pe,vt,jt,fr){var At=He.static,bt=He.dynamic;Z.optional(function(){var kn=[Hu,ul,Ys,Kl,Wu,Hf,ca,Tl,Su,Wf].concat(ui);function jn(Kn){Object.keys(Kn).forEach(function(Hn){Z.command(kn.indexOf(Hn)>=0,'unknown parameter "'+Hn+'"',fr.commandStr)})}jn(At),jn(bt)});var dt=function(He,Pe){var vt=He.static;if("string"==typeof vt[Ys]&&"string"==typeof vt[ul]){if(Object.keys(Pe.dynamic).length>0)return null;var fr=Pe.static,At=Object.keys(fr);if(At.length>0&&"number"==typeof fr[At[0]]){for(var bt=[],dt=0;dt<At.length;++dt)Z("number"==typeof fr[At[dt]],"must specify all vertex attribute locations when using vaos"),bt.push([0|fr[At[dt]],At[dt]]);return bt}}return null}(He,Pe),ze=function(He,Pe){var vt=He.static,jt=He.dynamic;if(Hu in vt){var fr=vt[Hu];return fr?(fr=Ur.getFramebuffer(fr),Z.command(fr,"invalid framebuffer object"),os(function(bt,dt){var ze=bt.link(fr),ht=bt.shared;dt.set(ht.framebuffer,".next",ze);var We=ht.context;return dt.set(We,"."+Dc,ze+".width"),dt.set(We,"."+hc,ze+".height"),ze})):os(function(bt,dt){var ze=bt.shared;dt.set(ze.framebuffer,".next","null");var ht=ze.context;return dt.set(ht,"."+Dc,ht+"."+ll),dt.set(ht,"."+hc,ht+"."+qc),"null"})}if(Hu in jt){var At=jt[Hu];return cu(At,function(bt,dt){var ze=bt.invoke(dt,At),ht=bt.shared,We=ht.framebuffer,Ht=dt.def(We,".getFramebuffer(",ze,")");Z.optional(function(){bt.assert(dt,"!"+ze+"||"+Ht,"invalid framebuffer object")}),dt.set(We,".next",Ht);var $t=ht.context;return dt.set($t,"."+Dc,Ht+"?"+Ht+".width:"+$t+"."+ll),dt.set($t,"."+hc,Ht+"?"+Ht+".height:"+$t+"."+qc),Ht})}return null}(He),ht=function(He,Pe,vt){var jt=He.static,fr=He.dynamic;function At(ze){if(ze in jt){var ht=jt[ze];Z.commandType(ht,"object","invalid "+ze,vt.commandStr);var Zr,un,We=!0,Ht=0|ht.x,$t=0|ht.y;return"width"in ht?Z.command((Zr=0|ht.width)>=0,"invalid "+ze,vt.commandStr):We=!1,"height"in ht?Z.command((un=0|ht.height)>=0,"invalid "+ze,vt.commandStr):We=!1,new as(!We&&Pe&&Pe.thisDep,!We&&Pe&&Pe.contextDep,!We&&Pe&&Pe.propDep,function(on,Yn){var kn=on.shared.context,jn=Zr;"width"in ht||(jn=Yn.def(kn,".",Dc,"-",Ht));var Kn=un;return"height"in ht||(Kn=Yn.def(kn,".",hc,"-",$t)),[Ht,$t,jn,Kn]})}if(ze in fr){var ln=fr[ze],bn=cu(ln,function(on,Yn){var kn=on.invoke(Yn,ln);Z.optional(function(){on.assert(Yn,kn+"&&typeof "+kn+'==="object"',"invalid "+ze)});var jn=on.shared.context,Kn=Yn.def(kn,".x|0"),Hn=Yn.def(kn,".y|0"),ci=Yn.def('"width" in ',kn,"?",kn,".width|0:","(",jn,".",Dc,"-",Kn,")"),qa=Yn.def('"height" in ',kn,"?",kn,".height|0:","(",jn,".",hc,"-",Hn,")");return Z.optional(function(){on.assert(Yn,ci+">=0&&"+qa+">=0","invalid "+ze)}),[Kn,Hn,ci,qa]});return Pe&&(bn.thisDep=bn.thisDep||Pe.thisDep,bn.contextDep=bn.contextDep||Pe.contextDep,bn.propDep=bn.propDep||Pe.propDep),bn}return Pe?new as(Pe.thisDep,Pe.contextDep,Pe.propDep,function(on,Yn){var kn=on.shared.context;return[0,0,Yn.def(kn,".",Dc),Yn.def(kn,".",hc)]}):null}var bt=At(Ko);if(bt){var dt=bt;bt=new as(bt.thisDep,bt.contextDep,bt.propDep,function(ze,ht){var We=dt.append(ze,ht),Ht=ze.shared.context;return ht.set(Ht,".viewportWidth",We[2]),ht.set(Ht,".viewportHeight",We[3]),We})}return{viewport:bt,scissor_box:At(uu)}}(He,ze,fr),We=function(He,Pe){var vt=He.static,jt=He.dynamic,fr={},At=!1,dt=function(){if(Wf in vt){var Yn=vt[Wf];return null!==Yn&&null===Kr.getVAO(Yn)&&(Yn=Kr.createVAO(Yn)),At=!0,fr.vao=Yn,os(function(jn){var Kn=Kr.getVAO(Yn);return Kn?jn.link(Kn):"null"})}if(Wf in jt){At=!0;var kn=jt[Wf];return cu(kn,function(jn,Kn){var Hn=jn.invoke(Kn,kn);return Kn.def(jn.shared.vao+".getVAO("+Hn+")")})}return null}(),ze=!1,We=function(){if(Kl in vt){var Yn=vt[Kl];if(fr.elements=Yn,yf(Yn)){var kn=fr.elements=ur.create(Yn,!0);Yn=ur.getElements(kn),ze=!0}else Yn&&(Yn=ur.getElements(Yn),ze=!0,Z.command(Yn,"invalid elements",Pe.commandStr));var jn=os(function(Hn,ci){if(Yn){var qa=Hn.link(Yn);return Hn.ELEMENTS=qa,qa}return Hn.ELEMENTS=null,null});return jn.value=Yn,jn}if(Kl in jt){ze=!0;var Kn=jt[Kl];return cu(Kn,function(Hn,ci){var qa=Hn.shared,jo=qa.isBufferArgs,$l=qa.elements,ao=Hn.invoke(ci,Kn),Ba=ci.def("null"),zs=ci.def(jo,"(",ao,")"),Xu=Hn.cond(zs).then(Ba,"=",$l,".createStream(",ao,");").else(Ba,"=",$l,".getElements(",ao,");");return Z.optional(function(){Hn.assert(Xu.else,"!"+ao+"||"+Ba,"invalid elements")}),ci.entry(Xu),ci.exit(Hn.cond(zs).then($l,".destroyStream(",Ba,");")),Hn.ELEMENTS=Ba,Ba})}return At?new as(dt.thisDep,dt.contextDep,dt.propDep,function(Hn,ci){return ci.def(Hn.shared.vao+".currentVAO?"+Hn.shared.elements+".getElements("+Hn.shared.vao+".currentVAO.elements):null")}):null}();function $t(Yn,kn){if(Yn in vt){var jn=0|vt[Yn];return kn?fr.offset=jn:fr.instances=jn,Z.command(!kn||jn>=0,"invalid "+Yn,Pe.commandStr),os(function(Hn,ci){return kn&&(Hn.OFFSET=jn),jn})}if(Yn in jt){var Kn=jt[Yn];return cu(Kn,function(Hn,ci){var qa=Hn.invoke(ci,Kn);return kn&&(Hn.OFFSET=qa,Z.optional(function(){Hn.assert(ci,qa+">=0","invalid "+Yn)})),qa})}if(kn){if(ze)return os(function(Hn,ci){return Hn.OFFSET=0,0});if(At)return new as(dt.thisDep,dt.contextDep,dt.propDep,function(Hn,ci){return ci.def(Hn.shared.vao+".currentVAO?"+Hn.shared.vao+".currentVAO.offset:0")})}else if(At)return new as(dt.thisDep,dt.contextDep,dt.propDep,function(Hn,ci){return ci.def(Hn.shared.vao+".currentVAO?"+Hn.shared.vao+".currentVAO.instances:-1")});return null}var Zr=$t(Hf,!0),ln=function(){if(Wu in vt){var Yn=vt[Wu];return fr.primitive=Yn,Z.commandParameter(Yn,Or,"invalid primitve",Pe.commandStr),os(function(jn,Kn){return Or[Yn]})}if(Wu in jt){var kn=jt[Wu];return cu(kn,function(jn,Kn){var Hn=jn.constants.primTypes,ci=jn.invoke(Kn,kn);return Z.optional(function(){jn.assert(Kn,ci+" in "+Hn,"invalid primitive, must be one of "+Object.keys(Or))}),Kn.def(Hn,"[",ci,"]")})}return ze?Zo(We)?os(We.value?function(jn,Kn){return Kn.def(jn.ELEMENTS,".primType")}:function(){return 4}):new as(We.thisDep,We.contextDep,We.propDep,function(jn,Kn){var Hn=jn.ELEMENTS;return Kn.def(Hn,"?",Hn,".primType:",4)}):At?new as(dt.thisDep,dt.contextDep,dt.propDep,function(jn,Kn){return Kn.def(jn.shared.vao+".currentVAO?"+jn.shared.vao+".currentVAO.primitive:4")}):null}(),bn=function(){if(ca in vt){var Yn=0|vt[ca];return fr.count=Yn,Z.command("number"==typeof Yn&&Yn>=0,"invalid vertex count",Pe.commandStr),os(function(){return Yn})}if(ca in jt){var kn=jt[ca];return cu(kn,function(ci,qa){var jo=ci.invoke(qa,kn);return Z.optional(function(){ci.assert(qa,"typeof "+jo+'==="number"&&'+jo+">=0&&"+jo+"===("+jo+"|0)","invalid vertex count")}),jo})}if(ze){if(Zo(We)){if(We)return Zr?new as(Zr.thisDep,Zr.contextDep,Zr.propDep,function(ci,qa){var jo=qa.def(ci.ELEMENTS,".vertCount-",ci.OFFSET);return Z.optional(function(){ci.assert(qa,jo+">=0","invalid vertex offset/element buffer too small")}),jo}):os(function(ci,qa){return qa.def(ci.ELEMENTS,".vertCount")});var jn=os(function(){return-1});return Z.optional(function(){jn.MISSING=!0}),jn}var Kn=new as(We.thisDep||Zr.thisDep,We.contextDep||Zr.contextDep,We.propDep||Zr.propDep,function(ci,qa){var jo=ci.ELEMENTS;return ci.OFFSET?qa.def(jo,"?",jo,".vertCount-",ci.OFFSET,":-1"):qa.def(jo,"?",jo,".vertCount:-1")});return Z.optional(function(){Kn.DYNAMIC=!0}),Kn}return At?new as(dt.thisDep,dt.contextDep,dt.propDep,function(ci,qa){return qa.def(ci.shared.vao,".currentVAO?",ci.shared.vao,".currentVAO.count:-1")}):null}(),on=$t(Tl,!1);return{elements:We,primitive:ln,count:bn,instances:on,offset:Zr,vao:dt,vaoActive:At,elementsActive:ze,static:fr}}(He,fr),Ht=function(He,Pe){var vt=He.static,jt=He.dynamic,fr={};return ui.forEach(function(At){var bt=Gn(At);function dt(ze,ht){if(At in vt){var We=ze(vt[At]);fr[bt]=os(function(){return We})}else if(At in jt){var Ht=jt[At];fr[bt]=cu(Ht,function($t,Zr){return ht($t,Zr,$t.invoke(Zr,Ht))})}}switch(At){case ea:case Nt:case"dither":case no:case Ln:case Yl:case Wa:case ia:case ga:case Ci:return dt(function(ze){return Z.commandType(ze,"boolean",At,Pe.commandStr),ze},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,"typeof "+We+'==="boolean"',"invalid flag "+At,ze.commandStr)}),We});case Xn:return dt(function(ze){return Z.commandParameter(ze,Al,"invalid "+At,Pe.commandStr),Al[ze]},function(ze,ht,We){var Ht=ze.constants.compareFuncs;return Z.optional(function(){ze.assert(ht,We+" in "+Ht,"invalid "+At+", must be one of "+Object.keys(Al))}),ht.def(Ht,"[",We,"]")});case ni:return dt(function(ze){return Z.command(oo(ze)&&2===ze.length&&"number"==typeof ze[0]&&"number"==typeof ze[1]&&ze[0]<=ze[1],"depth range is 2d array",Pe.commandStr),ze},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,ze.shared.isArrayLike+"("+We+")&&"+We+".length===2&&typeof "+We+'[0]==="number"&&typeof '+We+'[1]==="number"&&'+We+"[0]<="+We+"[1]","depth range must be a 2d array")}),[ht.def("+",We,"[0]"),ht.def("+",We,"[1]")]});case jr:return dt(function(ze){Z.commandType(ze,"object","blend.func",Pe.commandStr);var ht="srcRGB"in ze?ze.srcRGB:ze.src,We="srcAlpha"in ze?ze.srcAlpha:ze.src,Ht="dstRGB"in ze?ze.dstRGB:ze.dst,$t="dstAlpha"in ze?ze.dstAlpha:ze.dst;return Z.commandParameter(ht,Mu,bt+".srcRGB",Pe.commandStr),Z.commandParameter(We,Mu,bt+".srcAlpha",Pe.commandStr),Z.commandParameter(Ht,Mu,bt+".dstRGB",Pe.commandStr),Z.commandParameter($t,Mu,bt+".dstAlpha",Pe.commandStr),Z.command(-1===Ch.indexOf(ht+", "+Ht),"unallowed blending combination (srcRGB, dstRGB) = ("+ht+", "+Ht+")",Pe.commandStr),[Mu[ht],Mu[Ht],Mu[We],Mu[$t]]},function(ze,ht,We){var Ht=ze.constants.blendFuncs;function $t(kn,jn){var Kn=ht.def('"',kn,jn,'" in ',We,"?",We,".",kn,jn,":",We,".",kn);return Z.optional(function(){ze.assert(ht,Kn+" in "+Ht,"invalid "+At+"."+kn+jn+", must be one of "+Object.keys(Mu))}),Kn}Z.optional(function(){ze.assert(ht,We+"&&typeof "+We+'==="object"',"invalid blend func, must be an object")});var Zr=$t("src","RGB"),un=$t("dst","RGB");Z.optional(function(){ze.assert(ht,ze.constants.invalidBlendCombinations+".indexOf("+Zr+'+", "+'+un+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ln=ht.def(Ht,"[",Zr,"]"),bn=ht.def(Ht,"[",$t("src","Alpha"),"]");return[ln,ht.def(Ht,"[",un,"]"),bn,ht.def(Ht,"[",$t("dst","Alpha"),"]")]});case lr:return dt(function(ze){return"string"==typeof ze?(Z.commandParameter(ze,_r,"invalid "+At,Pe.commandStr),[_r[ze],_r[ze]]):"object"==typeof ze?(Z.commandParameter(ze.rgb,_r,At+".rgb",Pe.commandStr),Z.commandParameter(ze.alpha,_r,At+".alpha",Pe.commandStr),[_r[ze.rgb],_r[ze.alpha]]):void Z.commandRaise("invalid blend.equation",Pe.commandStr)},function(ze,ht,We){var Ht=ze.constants.blendEquations,$t=ht.def(),Zr=ht.def(),un=ze.cond("typeof ",We,'==="string"');return Z.optional(function(){function ln(bn,on,Yn){ze.assert(bn,Yn+" in "+Ht,"invalid "+on+", must be one of "+Object.keys(_r))}ln(un.then,At,We),ze.assert(un.else,We+"&&typeof "+We+'==="object"',"invalid "+At),ln(un.else,At+".rgb",We+".rgb"),ln(un.else,At+".alpha",We+".alpha")}),un.then($t,"=",Zr,"=",Ht,"[",We,"];"),un.else($t,"=",Ht,"[",We,".rgb];",Zr,"=",Ht,"[",We,".alpha];"),ht(un),[$t,Zr]});case Lt:return dt(function(ze){return Z.command(oo(ze)&&4===ze.length,"blend.color must be a 4d array",Pe.commandStr),xe(4,function(ht){return+ze[ht]})},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,ze.shared.isArrayLike+"("+We+")&&"+We+".length===4","blend.color must be a 4d array")}),xe(4,function(Ht){return ht.def("+",We,"[",Ht,"]")})});case ki:return dt(function(ze){return Z.commandType(ze,"number",bt,Pe.commandStr),0|ze},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,"typeof "+We+'==="number"',"invalid stencil.mask")}),ht.def(We,"|0")});case Ca:return dt(function(ze){Z.commandType(ze,"object",bt,Pe.commandStr);var ht=ze.cmp||"keep",We=ze.ref||0,Ht="mask"in ze?ze.mask:-1;return Z.commandParameter(ht,Al,At+".cmp",Pe.commandStr),Z.commandType(We,"number",At+".ref",Pe.commandStr),Z.commandType(Ht,"number",At+".mask",Pe.commandStr),[Al[ht],We,Ht]},function(ze,ht,We){var Ht=ze.constants.compareFuncs;return Z.optional(function(){function ln(){ze.assert(ht,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ln(We+"&&typeof ",We,'==="object"'),ln('!("cmp" in ',We,")||(",We,".cmp in ",Ht,")")}),[ht.def('"cmp" in ',We,"?",Ht,"[",We,".cmp]",":",rf),ht.def(We,".ref|0"),ht.def('"mask" in ',We,"?",We,".mask|0:-1")]});case ba:case go:return dt(function(ze){Z.commandType(ze,"object",bt,Pe.commandStr);var ht=ze.fail||"keep",We=ze.zfail||"keep",Ht=ze.zpass||"keep";return Z.commandParameter(ht,Jl,At+".fail",Pe.commandStr),Z.commandParameter(We,Jl,At+".zfail",Pe.commandStr),Z.commandParameter(Ht,Jl,At+".zpass",Pe.commandStr),[At===go?Js:ef,Jl[ht],Jl[We],Jl[Ht]]},function(ze,ht,We){var Ht=ze.constants.stencilOps;function $t(Zr){return Z.optional(function(){ze.assert(ht,'!("'+Zr+'" in '+We+")||("+We+"."+Zr+" in "+Ht+")","invalid "+At+"."+Zr+", must be one of "+Object.keys(Jl))}),ht.def('"',Zr,'" in ',We,"?",Ht,"[",We,".",Zr,"]:",rf)}return Z.optional(function(){ze.assert(ht,We+"&&typeof "+We+'==="object"',"invalid "+At)}),[At===go?Js:ef,$t("fail"),$t("zfail"),$t("zpass")]});case Ka:return dt(function(ze){Z.commandType(ze,"object",bt,Pe.commandStr);var ht=0|ze.factor,We=0|ze.units;return Z.commandType(ht,"number",bt+".factor",Pe.commandStr),Z.commandType(We,"number",bt+".units",Pe.commandStr),[ht,We]},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,We+"&&typeof "+We+'==="object"',"invalid "+At)}),[ht.def(We,".factor|0"),ht.def(We,".units|0")]});case xa:return dt(function(ze){var ht=0;return"front"===ze?ht=ef:"back"===ze&&(ht=Js),Z.command(!!ht,bt,Pe.commandStr),ht},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,We+'==="front"||'+We+'==="back"',"invalid cull.face")}),ht.def(We,'==="front"?',ef,":",Js)});case Ha:return dt(function(ze){return Z.command("number"==typeof ze&&ze>=cr.lineWidthDims[0]&&ze<=cr.lineWidthDims[1],"invalid line width, must be a positive number between "+cr.lineWidthDims[0]+" and "+cr.lineWidthDims[1],Pe.commandStr),ze},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,"typeof "+We+'==="number"&&'+We+">="+cr.lineWidthDims[0]+"&&"+We+"<="+cr.lineWidthDims[1],"invalid line width")}),We});case ua:return dt(function(ze){return Z.commandParameter(ze,$f,bt,Pe.commandStr),$f[ze]},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,We+'==="cw"||'+We+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),ht.def(We+'==="cw"?2304:2305')});case Si:return dt(function(ze){return Z.command(oo(ze)&&4===ze.length,"color.mask must be length 4 array",Pe.commandStr),ze.map(function(ht){return!!ht})},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,ze.shared.isArrayLike+"("+We+")&&"+We+".length===4","invalid color.mask")}),xe(4,function(Ht){return"!!"+We+"["+Ht+"]"})});case la:return dt(function(ze){Z.command("object"==typeof ze&&ze,bt,Pe.commandStr);var ht="value"in ze?ze.value:1,We=!!ze.invert;return Z.command("number"==typeof ht&&ht>=0&&ht<=1,"sample.coverage.value must be a number between 0 and 1",Pe.commandStr),[ht,We]},function(ze,ht,We){return Z.optional(function(){ze.assert(ht,We+"&&typeof "+We+'==="object"',"invalid sample.coverage")}),[ht.def('"value" in ',We,"?+",We,".value:1"),ht.def("!!",We,".invert")]})}}),fr}(He,fr),$t=function(He,Pe,vt){var jt=He.static,fr=He.dynamic;function At(We){if(We in jt){var Ht=De.id(jt[We]);Z.optional(function(){qr.shader(Ah[We],Ht,Z.guessCommand())});var $t=os(function(){return Ht});return $t.id=Ht,$t}if(We in fr){var Zr=fr[We];return cu(Zr,function(un,ln){var bn=un.invoke(ln,Zr),on=ln.def(un.shared.strings,".id(",bn,")");return Z.optional(function(){ln(un.shared.shader,".shader(",Ah[We],",",on,",",un.command,");")}),on})}return null}var ht,bt=At(Ys),dt=At(ul),ze=null;return Zo(bt)&&Zo(dt)?(ze=qr.program(dt.id,bt.id,null,vt),ht=os(function(We,Ht){return We.link(ze)})):ht=new as(bt&&bt.thisDep||dt&&dt.thisDep,bt&&bt.contextDep||dt&&dt.contextDep,bt&&bt.propDep||dt&&dt.propDep,function(We,Ht){var Zr,$t=We.shared.shader;Zr=bt?bt.append(We,Ht):Ht.def($t,".",Ys);var ln=$t+".program("+(dt?dt.append(We,Ht):Ht.def($t,".",ul))+","+Zr;return Z.optional(function(){ln+=","+We.command}),Ht.def(ln+")")}),{frag:bt,vert:dt,progVar:ht,program:ze}}(He,0,dt);function Zr(kn){var jn=ht[kn];jn&&(Ht[kn]=jn)}Zr(Ko),Zr(Gn(uu));var un=Object.keys(Ht).length>0,ln={framebuffer:ze,draw:We,shader:$t,state:Ht,dirty:un,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ln.profile=function(He){var jt,Pe=He.static,vt=He.dynamic;if(Su in Pe){var fr=!!Pe[Su];(jt=os(function(bt,dt){return fr})).enable=fr}else if(Su in vt){var At=vt[Su];jt=cu(At,function(bt,dt){return bt.invoke(dt,At)})}return jt}(He),ln.uniforms=function(He,Pe){var vt=He.static,jt=He.dynamic,fr={};return Object.keys(vt).forEach(function(At){var dt,bt=vt[At];if("number"==typeof bt||"boolean"==typeof bt)dt=os(function(){return bt});else if("function"==typeof bt){var ze=bt._reglType;"texture2d"===ze||"textureCube"===ze?dt=os(function(ht){return ht.link(bt)}):"framebuffer"===ze||"framebufferCube"===ze?(Z.command(bt.color.length>0,'missing color attachment for framebuffer sent to uniform "'+At+'"',Pe.commandStr),dt=os(function(ht){return ht.link(bt.color[0])})):Z.commandRaise('invalid data for uniform "'+At+'"',Pe.commandStr)}else oo(bt)?dt=os(function(ht){return ht.global.def("[",xe(bt.length,function(Ht){return Z.command("number"==typeof bt[Ht]||"boolean"==typeof bt[Ht],"invalid uniform "+At,ht.commandStr),bt[Ht]}),"]")}):Z.commandRaise('invalid or missing data for uniform "'+At+'"',Pe.commandStr);dt.value=bt,fr[At]=dt}),Object.keys(jt).forEach(function(At){var bt=jt[At];fr[At]=cu(bt,function(dt,ze){return dt.invoke(ze,bt)})}),fr}(vt,fr),ln.drawVAO=ln.scopeVAO=We.vao,!ln.drawVAO&&$t.program&&!dt&&it.angle_instanced_arrays&&We.static.elements){var bn=!0,on=$t.program.attributes.map(function(kn){var jn=Pe.static[kn];return bn=bn&&!!jn,jn});if(bn&&on.length>0){var Yn=Kr.getVAO(Kr.createVAO({attributes:on,elements:We.static.elements}));ln.drawVAO=new as(null,null,null,function(kn,jn){return kn.link(Yn)}),ln.useVAO=!0}}return dt?ln.useVAO=!0:ln.attributes=function(He,Pe){var vt=He.static,jt=He.dynamic,fr={};return Object.keys(vt).forEach(function(At){var bt=vt[At],dt=De.id(At),ze=new Vt;if(yf(bt))ze.state=1,ze.buffer=kr.getBuffer(kr.create(bt,hf,!1,!0)),ze.type=0;else{var ht=kr.getBuffer(bt);if(ht)ze.state=1,ze.buffer=ht,ze.type=0;else if(Z.command("object"==typeof bt&&bt,"invalid data for attribute "+At,Pe.commandStr),"constant"in bt){var We=bt.constant;ze.buffer="null",ze.state=2,"number"==typeof We?ze.x=We:(Z.command(oo(We)&&We.length>0&&We.length<=4,"invalid constant for attribute "+At,Pe.commandStr),gi.forEach(function(on,Yn){Yn<We.length&&(ze[on]=We[Yn])}))}else{ht=yf(bt.buffer)?kr.getBuffer(kr.create(bt.buffer,hf,!1,!0)):kr.getBuffer(bt.buffer),Z.command(!!ht,'missing buffer for attribute "'+At+'"',Pe.commandStr);var Ht=0|bt.offset;Z.command(Ht>=0,'invalid offset for attribute "'+At+'"',Pe.commandStr);var $t=0|bt.stride;Z.command($t>=0&&$t<256,'invalid stride for attribute "'+At+'", must be integer betweeen [0, 255]',Pe.commandStr);var Zr=0|bt.size;Z.command(!("size"in bt)||Zr>0&&Zr<=4,'invalid size for attribute "'+At+'", must be 1,2,3,4',Pe.commandStr);var un=!!bt.normalized,ln=0;"type"in bt&&(Z.commandParameter(bt.type,Qs,"invalid type for attribute "+At,Pe.commandStr),ln=Qs[bt.type]);var bn=0|bt.divisor;Z.optional(function(){"divisor"in bt&&(Z.command(0===bn||Wr,'cannot specify divisor for attribute "'+At+'", instancing not supported',Pe.commandStr),Z.command(bn>=0,'invalid divisor for attribute "'+At+'"',Pe.commandStr));var on=Pe.commandStr,Yn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(bt).forEach(function(kn){Z.command(Yn.indexOf(kn)>=0,'unknown parameter "'+kn+'" for attribute pointer "'+At+'" (valid parameters are '+Yn+")",on)})}),ze.buffer=ht,ze.state=1,ze.size=Zr,ze.normalized=un,ze.type=ln||ht.dtype,ze.offset=Ht,ze.stride=$t,ze.divisor=bn}}fr[At]=os(function(on,Yn){var kn=on.attribCache;if(dt in kn)return kn[dt];var jn={isStream:!1};return Object.keys(ze).forEach(function(Kn){jn[Kn]=ze[Kn]}),ze.buffer&&(jn.buffer=on.link(ze.buffer),jn.type=jn.type||jn.buffer+".dtype"),kn[dt]=jn,jn})}),Object.keys(jt).forEach(function(At){var bt=jt[At];fr[At]=cu(bt,function(ze,ht){var We=ze.invoke(ht,bt),Ht=ze.shared,$t=ze.constants,Zr=Ht.isBufferArgs,un=Ht.buffer;Z.optional(function(){ze.assert(ht,We+"&&(typeof "+We+'==="object"||typeof '+We+'==="function")&&('+Zr+"("+We+")||"+un+".getBuffer("+We+")||"+un+".getBuffer("+We+".buffer)||"+Zr+"("+We+'.buffer)||("constant" in '+We+"&&(typeof "+We+'.constant==="number"||'+Ht.isArrayLike+"("+We+".constant))))",'invalid dynamic attribute "'+At+'"')});var ln={isStream:ht.def(!1)},bn=new Vt;bn.state=1,Object.keys(bn).forEach(function(jn){ln[jn]=ht.def(""+bn[jn])});var on=ln.buffer,Yn=ln.type;function kn(jn){ht(ln[jn],"=",We,".",jn,"|0;")}return ht("if(",Zr,"(",We,")){",ln.isStream,"=true;",on,"=",un,".createStream(",hf,",",We,");",Yn,"=",on,".dtype;","}else{",on,"=",un,".getBuffer(",We,");","if(",on,"){",Yn,"=",on,".dtype;",'}else if("constant" in ',We,"){",ln.state,"=",2,";","if(typeof "+We+'.constant === "number"){',ln[gi[0]],"=",We,".constant;",gi.slice(1).map(function(jn){return ln[jn]}).join("="),"=0;","}else{",gi.map(function(jn,Kn){return ln[jn]+"="+We+".constant.length>"+Kn+"?"+We+".constant["+Kn+"]:0;"}).join(""),"}}else{","if(",Zr,"(",We,".buffer)){",on,"=",un,".createStream(",hf,",",We,".buffer);","}else{",on,"=",un,".getBuffer(",We,".buffer);","}",Yn,'="type" in ',We,"?",$t.glTypes,"[",We,".type]:",on,".dtype;",ln.normalized,"=!!",We,".normalized;"),kn("size"),kn("offset"),kn("stride"),kn("divisor"),ht("}}"),ht.exit("if(",ln.isStream,"){",un,".destroyStream(",on,");","}"),ln})}),fr}(Pe,fr),ln.context=function(He){var Pe=He.static,vt=He.dynamic,jt={};return Object.keys(Pe).forEach(function(fr){var At=Pe[fr];jt[fr]=os(function(bt,dt){return"number"==typeof At||"boolean"==typeof At?""+At:bt.link(At)})}),Object.keys(vt).forEach(function(fr){var At=vt[fr];jt[fr]=cu(At,function(bt,dt){return bt.invoke(dt,At)})}),jt}(jt),ln}function Uo(He,Pe,vt){var fr=He.shared.context,At=He.scope();Object.keys(vt).forEach(function(bt){Pe.save(fr,"."+bt);var ze=vt[bt].append(He,Pe);Array.isArray(ze)?At(fr,".",bt,"=[",ze.join(),"];"):At(fr,".",bt,"=",ze,";")}),Pe(At)}function ss(He,Pe,vt,jt){var dt,fr=He.shared,At=fr.gl,bt=fr.framebuffer;An&&(dt=Pe.def(fr.extensions,".webgl_draw_buffers"));var Ht,ze=He.constants,ht=ze.drawBuffer,We=ze.backBuffer;Ht=vt?vt.append(He,Pe):Pe.def(bt,".next"),jt||Pe("if(",Ht,"!==",bt,".cur){"),Pe("if(",Ht,"){",At,".bindFramebuffer(",36160,",",Ht,".framebuffer);"),An&&Pe(dt,".drawBuffersWEBGL(",ht,"[",Ht,".colorAttachments.length]);"),Pe("}else{",At,".bindFramebuffer(",36160,",null);"),An&&Pe(dt,".drawBuffersWEBGL(",We,");"),Pe("}",bt,".cur=",Ht,";"),jt||Pe("}")}function ms(He,Pe,vt){var jt=He.shared,fr=jt.gl,At=He.current,bt=He.next,dt=jt.current,ze=jt.next,ht=He.cond(dt,".dirty");ui.forEach(function(We){var $t,Zr,Ht=Gn(We);if(!(Ht in vt.state))if(Ht in bt){$t=bt[Ht],Zr=At[Ht];var un=xe(wn[Ht].length,function(bn){return ht.def($t,"[",bn,"]")});ht(He.cond(un.map(function(bn,on){return bn+"!=="+Zr+"["+on+"]"}).join("||")).then(fr,".",Er[Ht],"(",un,");",un.map(function(bn,on){return Zr+"["+on+"]="+bn}).join(";"),";"))}else{$t=ht.def(ze,".",Ht);var ln=He.cond($t,"!==",dt,".",Ht);ht(ln),Ht in Lr?ln(He.cond($t).then(fr,".enable(",Lr[Ht],");").else(fr,".disable(",Lr[Ht],");"),dt,".",Ht,"=",$t,";"):ln(fr,".",Er[Ht],"(",$t,");",dt,".",Ht,"=",$t,";")}}),0===Object.keys(vt.state).length&&ht(dt,".dirty=false;"),Pe(ht)}function us(He,Pe,vt,jt){var fr=He.shared,At=He.current,bt=fr.current,dt=fr.gl;Lf(Object.keys(vt)).forEach(function(ze){var ht=vt[ze];if(!jt||jt(ht)){var We=ht.append(He,Pe);if(Lr[ze]){var Ht=Lr[ze];Zo(ht)?Pe(dt,We?".enable(":".disable(",Ht,");"):Pe(He.cond(We).then(dt,".enable(",Ht,");").else(dt,".disable(",Ht,");")),Pe(bt,".",ze,"=",We,";")}else if(oo(We)){var $t=At[ze];Pe(dt,".",Er[ze],"(",We,");",We.map(function(Zr,un){return $t+"["+un+"]="+Zr}).join(";"),";")}else Pe(dt,".",Er[ze],"(",We,");",bt,".",ze,"=",We,";")}})}function Vo(He,Pe){Wr&&(He.instancing=Pe.def(He.shared.extensions,".angle_instanced_arrays"))}function Hi(He,Pe,vt,jt,fr){var Ht,$t,bn,At=He.shared,bt=He.stats,dt=At.current,ze=At.timer,ht=vt.profile;function We(){return"undefined"!=typeof my&&my&&"function"==typeof my.showToast||"undefined"==typeof performance?"Date.now()":"performance.now()"}function Zr(kn){kn(Ht=Pe.def(),"=",We(),";"),"string"==typeof fr?kn(bt,".count+=",fr,";"):kn(bt,".count++;"),Hr&&(jt?kn($t=Pe.def(),"=",ze,".getNumPendingQueries();"):kn(ze,".beginQuery(",bt,");"))}function un(kn){kn(bt,".cpuTime+=",We(),"-",Ht,";"),Hr&&(jt?kn(ze,".pushScopeStats(",$t,",",ze,".getNumPendingQueries(),",bt,");"):kn(ze,".endQuery();"))}function ln(kn){var jn=Pe.def(dt,".profile");Pe(dt,".profile=",kn,";"),Pe.exit(dt,".profile=",jn,";")}if(ht){if(Zo(ht))return void(ht.enable?(Zr(Pe),un(Pe.exit),ln("true")):ln("false"));ln(bn=ht.append(He,Pe))}else bn=Pe.def(dt,".profile");var on=He.block();Zr(on),Pe("if(",bn,"){",on,"}");var Yn=He.block();un(Yn),Pe.exit("if(",bn,"){",Yn,"}")}function ls(He,Pe,vt,jt,fr){var At=He.shared;jt.forEach(function(ze){var Ht,ht=ze.name,We=vt.attributes[ht];if(We){if(!fr(We))return;Ht=We.append(He,Pe)}else{if(!fr(Ph))return;var $t=He.scopeAttrib(ht);Z.optional(function(){He.assert(Pe,$t+".state","missing attribute "+ht)}),Ht={},Object.keys(new Vt).forEach(function(Zr){Ht[Zr]=Pe.def($t,".",Zr)})}!function(ze,ht,We){var Ht=At.gl,$t=Pe.def(ze,".location"),Zr=Pe.def(At.attributes,"[",$t,"]"),un=We.state,ln=We.buffer,bn=[We.x,We.y,We.z,We.w],on=["buffer","normalized","offset","stride"];function Yn(){Pe("if(!",Zr,".buffer){",Ht,".enableVertexAttribArray(",$t,");}");var Kn,jn=We.type;if(Kn=We.size?Pe.def(We.size,"||",ht):ht,Pe("if(",Zr,".type!==",jn,"||",Zr,".size!==",Kn,"||",on.map(function(ci){return Zr+"."+ci+"!=="+We[ci]}).join("||"),"){",Ht,".bindBuffer(",hf,",",ln,".buffer);",Ht,".vertexAttribPointer(",[$t,Kn,jn,We.normalized,We.stride,We.offset],");",Zr,".type=",jn,";",Zr,".size=",Kn,";",on.map(function(ci){return Zr+"."+ci+"="+We[ci]+";"}).join(""),"}"),Wr){var Hn=We.divisor;Pe("if(",Zr,".divisor!==",Hn,"){",He.instancing,".vertexAttribDivisorANGLE(",[$t,Hn],");",Zr,".divisor=",Hn,";}")}}function kn(){Pe("if(",Zr,".buffer){",Ht,".disableVertexAttribArray(",$t,");",Zr,".buffer=null;","}if(",gi.map(function(jn,Kn){return Zr+"."+jn+"!=="+bn[Kn]}).join("||"),"){",Ht,".vertexAttrib4f(",$t,",",bn,");",gi.map(function(jn,Kn){return Zr+"."+jn+"="+bn[Kn]+";"}).join(""),"}")}1===un?Yn():2===un?kn():(Pe("if(",un,"===",1,"){"),Yn(),Pe("}else{"),kn(),Pe("}"))}(He.link(ze),function(ze){switch(ze){case pf:case Iu:case If:return 2;case Pf:case Yf:case Mf:return 3;case Bc:case Cl:case Qc:return 4;default:return 1}}(ze.info.type),Ht)})}function ka(He,Pe,vt,jt,fr,At){for(var ze,bt=He.shared,dt=bt.gl,ht=0;ht<jt.length;++ht){var bn,We=jt[ht],Ht=We.name,$t=We.info.type,Zr=vt.uniforms[Ht],ln=He.link(We)+".location";if(Zr){if(!fr(Zr))continue;if(Zo(Zr)){var on=Zr.value;if(Z.command(null!=on,'missing uniform "'+Ht+'"',He.commandStr),$t===_s||$t===ql){Z.command("function"==typeof on&&($t===_s&&("texture2d"===on._reglType||"framebuffer"===on._reglType)||$t===ql&&("textureCube"===on._reglType||"framebufferCube"===on._reglType)),"invalid texture for uniform "+Ht,He.commandStr);var Yn=He.link(on._texture||on.color[0]._texture);Pe(dt,".uniform1i(",ln,",",Yn+".bind());"),Pe.exit(Yn,".unbind();")}else if($t===vf||$t===Fs||$t===Kf){Z.optional(function(){Z.command(oo(on),"invalid matrix for uniform "+Ht,He.commandStr),Z.command($t===vf&&4===on.length||$t===Fs&&9===on.length||$t===Kf&&16===on.length,"invalid length for matrix uniform "+Ht,He.commandStr)});var kn=He.global.def("new Float32Array(["+Array.prototype.slice.call(on)+"])"),jn=2;$t===Fs?jn=3:$t===Kf&&(jn=4),Pe(dt,".uniformMatrix",jn,"fv(",ln,",false,",kn,");")}else{switch($t){case 5126:Z.commandType(on,"number","uniform "+Ht,He.commandStr),ze="1f";break;case pf:Z.command(oo(on)&&2===on.length,"uniform "+Ht,He.commandStr),ze="2f";break;case Pf:Z.command(oo(on)&&3===on.length,"uniform "+Ht,He.commandStr),ze="3f";break;case Bc:Z.command(oo(on)&&4===on.length,"uniform "+Ht,He.commandStr),ze="4f";break;case 35670:Z.commandType(on,"boolean","uniform "+Ht,He.commandStr),ze="1i";break;case 5124:Z.commandType(on,"number","uniform "+Ht,He.commandStr),ze="1i";break;case If:case Iu:Z.command(oo(on)&&2===on.length,"uniform "+Ht,He.commandStr),ze="2i";break;case Mf:case Yf:Z.command(oo(on)&&3===on.length,"uniform "+Ht,He.commandStr),ze="3i";break;case Qc:case Cl:Z.command(oo(on)&&4===on.length,"uniform "+Ht,He.commandStr),ze="4i"}Pe(dt,".uniform",ze,"(",ln,",",oo(on)?Array.prototype.slice.call(on):on,");")}continue}bn=Zr.append(He,Pe)}else{if(!fr(Ph))continue;bn=Pe.def(bt.uniforms,"[",De.id(Ht),"]")}$t===_s?(Z(!Array.isArray(bn),"must specify a scalar prop for textures"),Pe("if(",bn,"&&",bn,'._reglType==="framebuffer"){',bn,"=",bn,".color[0];","}")):$t===ql&&(Z(!Array.isArray(bn),"must specify a scalar prop for cube maps"),Pe("if(",bn,"&&",bn,'._reglType==="framebufferCube"){',bn,"=",bn,".color[0];","}")),Z.optional(function(){function zs(Yu,Qf){He.assert(Pe,Yu,'bad data or missing for uniform "'+Ht+'".  '+Qf)}function Xu(Yu){Z(!Array.isArray(bn),"must not specify an array type for uniform"),zs("typeof "+bn+'==="'+Yu+'"',"invalid type, expected "+Yu)}function Ou(Yu,Qf){Array.isArray(bn)?Z(bn.length===Yu,"must have length "+Yu):zs(bt.isArrayLike+"("+bn+")&&"+bn+".length==="+Yu,"invalid vector, should have length "+Yu)}function Mh(Yu){Z(!Array.isArray(bn),"must not specify a value type"),zs("typeof "+bn+'==="function"&&'+bn+'._reglType==="texture'+(3553===Yu?"2d":"Cube")+'"',"invalid texture type")}switch($t){case 5124:Xu("number");break;case Iu:Ou(2);break;case Yf:Ou(3);break;case Cl:Ou(4);break;case 5126:Xu("number");break;case pf:Ou(2);break;case Pf:Ou(3);break;case Bc:Ou(4);break;case 35670:Xu("boolean");break;case If:Ou(2);break;case Mf:Ou(3);break;case Qc:case vf:Ou(4);break;case Fs:Ou(9);break;case Kf:Ou(16);break;case _s:Mh(3553);break;case ql:Mh(34067)}});var Kn=1;switch($t){case _s:case ql:var Hn=Pe.def(bn,"._texture");Pe(dt,".uniform1i(",ln,",",Hn,".bind());"),Pe.exit(Hn,".unbind();");continue;case 5124:case 35670:ze="1i";break;case Iu:case If:ze="2i",Kn=2;break;case Yf:case Mf:ze="3i",Kn=3;break;case Cl:case Qc:ze="4i",Kn=4;break;case 5126:ze="1f";break;case pf:ze="2f",Kn=2;break;case Pf:ze="3f",Kn=3;break;case Bc:ze="4f",Kn=4;break;case vf:ze="Matrix2fv";break;case Fs:ze="Matrix3fv";break;case Kf:ze="Matrix4fv"}if("M"===ze.charAt(0)){Pe(dt,".uniform",ze,"(",ln,",");var ci=Math.pow($t-vf+2,2),qa=He.global.def("new Float32Array(",ci,")");Array.isArray(bn)?Pe("false,(",xe(ci,function(zs){return qa+"["+zs+"]="+bn[zs]}),",",qa,")"):Pe("false,(Array.isArray(",bn,")||",bn," instanceof Float32Array)?",bn,":(",xe(ci,function(zs){return qa+"["+zs+"]="+bn+"["+zs+"]"}),",",qa,")"),Pe(");")}else if(Kn>1){for(var jo=[],$l=[],ao=0;ao<Kn;++ao)Array.isArray(bn)?$l.push(bn[ao]):$l.push(Pe.def(bn+"["+ao+"]")),At&&jo.push(Pe.def());At&&Pe("if(!",He.batchId,"||",jo.map(function(zs,Xu){return zs+"!=="+$l[Xu]}).join("||"),"){",jo.map(function(zs,Xu){return zs+"="+$l[Xu]+";"}).join("")),Pe(dt,".uniform",ze,"(",ln,",",$l.join(","),");"),At&&Pe("}")}else{if(Z(!Array.isArray(bn),"uniform value must not be an array"),At){var Ba=Pe.def();Pe("if(!",He.batchId,"||",Ba,"!==",bn,"){",Ba,"=",bn,";")}Pe(dt,".uniform",ze,"(",ln,",",bn,");"),At&&Pe("}")}}}function uo(He,Pe,vt,jt){var fr=He.shared,At=fr.gl,bt=fr.draw,dt=jt.draw;var Hn,Kn,ci,We=(ci=Pe,(Kn=dt.elements)?((Kn.contextDep&&jt.contextDynamic||Kn.propDep)&&(ci=vt),Hn=Kn.append(He,ci),dt.elementsActive&&ci("if("+Hn+")"+At+".bindBuffer(34963,"+Hn+".buffer.buffer);")):(Hn=ci.def(),ci(Hn,"=",bt,".",Kl,";","if(",Hn,"){",At,".bindBuffer(",34963,",",Hn,".buffer.buffer);}","else if(",fr.vao,".currentVAO){",Hn,"=",He.shared.elements+".getElements("+fr.vao,".currentVAO.elements);",Mr?"":"if("+Hn+")"+At+".bindBuffer(34963,"+Hn+".buffer.buffer);","}")),Hn);function Ht(Kn){var Hn=dt[Kn];return Hn?Hn.append(He,Hn.contextDep&&jt.contextDynamic||Hn.propDep?vt:Pe):Pe.def(bt,".",Kn)}var ln,bn,$t=Ht(Wu),Zr=Ht(Hf),un=function(){var Hn,Kn=dt.count,ci=Pe;return Kn?((Kn.contextDep&&jt.contextDynamic||Kn.propDep)&&(ci=vt),Hn=Kn.append(He,ci),Z.optional(function(){Kn.MISSING&&He.assert(Pe,"false","missing vertex count"),Kn.DYNAMIC&&He.assert(ci,Hn+">=0","missing vertex count")})):(Hn=ci.def(bt,".",ca),Z.optional(function(){He.assert(ci,Hn+">=0","missing vertex count")})),Hn}();if("number"==typeof un){if(0===un)return}else vt("if(",un,"){"),vt.exit("}");Wr&&(ln=Ht(Tl),bn=He.instancing);var on=We+".type",Yn=dt.elements&&Zo(dt.elements)&&!dt.vaoActive;function kn(){function Kn(){vt(bn,".drawElementsInstancedANGLE(",[$t,un,on,Zr+"<<(("+on+"-5121)>>1)",ln],");")}function Hn(){vt(bn,".drawArraysInstancedANGLE(",[$t,Zr,un,ln],");")}We&&"null"!==We?Yn?Kn():(vt("if(",We,"){"),Kn(),vt("}else{"),Hn(),vt("}")):Hn()}function jn(){function Kn(){vt(At+".drawElements("+[$t,un,on,Zr+"<<(("+on+"-5121)>>1)"]+");")}function Hn(){vt(At+".drawArrays("+[$t,Zr,un]+");")}We&&"null"!==We?Yn?Kn():(vt("if(",We,"){"),Kn(),vt("}else{"),Hn(),vt("}")):Hn()}Wr&&("number"!=typeof ln||ln>=0)?"string"==typeof ln?(vt("if(",ln,">0){"),kn(),vt("}else if(",ln,"<0){"),jn(),vt("}")):kn():jn()}function Ai(He,Pe,vt,jt,fr){var At=Ii(),bt=At.proc("body",fr);return Z.optional(function(){At.commandStr=Pe.commandStr,At.command=At.link(Pe.commandStr)}),Wr&&(At.instancing=bt.def(At.shared.extensions,".angle_instanced_arrays")),He(At,bt,vt,jt),At.compile().body}function pa(He,Pe,vt,jt){Vo(He,Pe),vt.useVAO?vt.drawVAO?Pe(He.shared.vao,".setVAO(",vt.drawVAO.append(He,Pe),");"):Pe(He.shared.vao,".setVAO(",He.shared.vao,".targetVAO);"):(Pe(He.shared.vao,".setVAO(null);"),ls(He,Pe,vt,jt.attributes,function(){return!0})),ka(He,Pe,vt,jt.uniforms,function(){return!0},!1),uo(He,Pe,Pe,vt)}function To(He,Pe,vt,jt){function fr(){return!0}He.batchId="a1",Vo(He,Pe),ls(He,Pe,vt,jt.attributes,fr),ka(He,Pe,vt,jt.uniforms,fr,!1),uo(He,Pe,Pe,vt)}function Pl(He,Pe,vt,jt){Vo(He,Pe);var fr=vt.contextDep,At=Pe.def(),ze=Pe.def();He.shared.props=ze,He.batchId=At;var ht=He.scope(),We=He.scope();function Ht(on){return on.contextDep&&fr||on.propDep}function $t(on){return!Ht(on)}if(Pe(ht.entry,"for(",At,"=0;",At,"<","a1",";++",At,"){",ze,"=","a0","[",At,"];",We,"}",ht.exit),vt.needsContext&&Uo(He,We,vt.context),vt.needsFramebuffer&&ss(He,We,vt.framebuffer),us(He,We,vt.state,Ht),vt.profile&&Ht(vt.profile)&&Hi(He,We,vt,!1,!0),jt)vt.useVAO?vt.drawVAO?Ht(vt.drawVAO)?We(He.shared.vao,".setVAO(",vt.drawVAO.append(He,We),");"):ht(He.shared.vao,".setVAO(",vt.drawVAO.append(He,ht),");"):ht(He.shared.vao,".setVAO(",He.shared.vao,".targetVAO);"):(ht(He.shared.vao,".setVAO(null);"),ls(He,ht,vt,jt.attributes,$t),ls(He,We,vt,jt.attributes,Ht)),ka(He,ht,vt,jt.uniforms,$t,!1),ka(He,We,vt,jt.uniforms,Ht,!0),uo(He,ht,We,vt);else{var Zr=He.global.def("{}"),un=vt.shader.progVar.append(He,We),ln=We.def(un,".id"),bn=We.def(Zr,"[",ln,"]");We(He.shared.gl,".useProgram(",un,".program);","if(!",bn,"){",bn,"=",Zr,"[",ln,"]=",He.link(function(on){return Ai(To,He,vt,on,2)}),"(",un,");}",bn,".call(this,a0[",At,"],",At,");")}}function zn(He,Pe,vt){var jt=Pe.static[vt];if(jt&&function(He){if("object"==typeof He&&!oo(He)){for(var Pe=Object.keys(He),vt=0;vt<Pe.length;++vt)if(On.isDynamic(He[Pe[vt]]))return!0;return!1}}(jt)){var fr=He.global,At=Object.keys(jt),bt=!1,dt=!1,ze=!1,ht=He.global.def("{}");At.forEach(function(Ht){var $t=jt[Ht];if(On.isDynamic($t)){"function"==typeof $t&&($t=jt[Ht]=On.unbox($t));var Zr=cu($t,null);bt=bt||Zr.thisDep,ze=ze||Zr.propDep,dt=dt||Zr.contextDep}else{switch(fr(ht,".",Ht,"="),typeof $t){case"number":fr($t);break;case"string":fr('"',$t,'"');break;case"object":Array.isArray($t)&&fr("[",$t.join(),"]");break;default:fr(He.link($t))}fr(";")}}),Pe.dynamic[vt]=new On.DynamicVariable(4,{thisDep:bt,contextDep:dt,propDep:ze,ref:ht,append:function(Ht,$t){At.forEach(function(Zr){var un=jt[Zr];if(On.isDynamic(un)){var ln=Ht.invoke($t,un);$t(ht,".",Zr,"=",ln,";")}})}}),delete Pe.static[vt]}}return{next:rn,current:wn,procs:function(){var He=Ii(),Pe=He.proc("poll"),vt=He.proc("refresh"),jt=He.block();Pe(jt),vt(jt);var ze,fr=He.shared,At=fr.gl,bt=fr.next,dt=fr.current;jt(dt,".dirty=false;"),ss(He,Pe),ss(He,vt,null,!0),Wr&&(ze=He.link(Wr)),it.oes_vertex_array_object&&vt(He.link(it.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var ht=0;ht<cr.maxAttributes;++ht){var We=vt.def(fr.attributes,"[",ht,"]"),Ht=He.cond(We,".buffer");Ht.then(At,".enableVertexAttribArray(",ht,");",At,".bindBuffer(",hf,",",We,".buffer.buffer);",At,".vertexAttribPointer(",ht,",",We,".size,",We,".type,",We,".normalized,",We,".stride,",We,".offset);").else(At,".disableVertexAttribArray(",ht,");",At,".vertexAttrib4f(",ht,",",We,".x,",We,".y,",We,".z,",We,".w);",We,".buffer=null;"),vt(Ht),Wr&&vt(ze,".vertexAttribDivisorANGLE(",ht,",",We,".divisor);")}return vt(He.shared.vao,".currentVAO=null;",He.shared.vao,".setVAO(",He.shared.vao,".targetVAO);"),Object.keys(Lr).forEach(function($t){var Zr=Lr[$t],un=jt.def(bt,".",$t),ln=He.block();ln("if(",un,"){",At,".enable(",Zr,")}else{",At,".disable(",Zr,")}",dt,".",$t,"=",un,";"),vt(ln),Pe("if(",un,"!==",dt,".",$t,"){",ln,"}")}),Object.keys(Er).forEach(function($t){var ln,bn,Zr=Er[$t],un=wn[$t],on=He.block();if(on(At,".",Zr,"("),oo(un)){var Yn=un.length;ln=He.global.def(bt,".",$t),bn=He.global.def(dt,".",$t),on(xe(Yn,function(kn){return ln+"["+kn+"]"}),");",xe(Yn,function(kn){return bn+"["+kn+"]="+ln+"["+kn+"];"}).join("")),Pe("if(",xe(Yn,function(kn){return ln+"["+kn+"]!=="+bn+"["+kn+"]"}).join("||"),"){",on,"}")}else ln=jt.def(bt,".",$t),bn=jt.def(dt,".",$t),on(ln,");",dt,".",$t,"=",ln,";"),Pe("if(",ln,"!==",bn,"){",on,"}");vt(on)}),He.compile()}(),compile:function(He,Pe,vt,jt,fr){var At=Ii();At.stats=At.link(fr),Object.keys(Pe.static).forEach(function(dt){zn(At,Pe,dt)}),$h.forEach(function(dt){zn(At,He,dt)});var bt=vs(He,Pe,vt,jt,At);return function(He,Pe){var vt=He.proc("draw",1);Vo(He,vt),Uo(He,vt,Pe.context),ss(He,vt,Pe.framebuffer),ms(He,vt,Pe),us(He,vt,Pe.state),Hi(He,vt,Pe,!1,!0);var jt=Pe.shader.progVar.append(He,vt);if(vt(He.shared.gl,".useProgram(",jt,".program);"),Pe.shader.program)pa(He,vt,Pe,Pe.shader.program);else{vt(He.shared.vao,".setVAO(null);");var fr=He.global.def("{}"),At=vt.def(jt,".id"),bt=vt.def(fr,"[",At,"]");vt(He.cond(bt).then(bt,".call(this,a0);").else(bt,"=",fr,"[",At,"]=",He.link(function(dt){return Ai(pa,He,Pe,dt,1)}),"(",jt,");",bt,".call(this,a0);"))}Object.keys(Pe.state).length>0&&vt(He.shared.current,".dirty=true;"),He.shared.vao&&vt(He.shared.vao,".setVAO(null);")}(At,bt),function(He,Pe){var vt=He.proc("scope",3);He.batchId="a2";var jt=He.shared,fr=jt.current;function At(bt){var dt=Pe.shader[bt];dt&&vt.set(jt.shader,"."+bt,dt.append(He,vt))}Uo(He,vt,Pe.context),Pe.framebuffer&&Pe.framebuffer.append(He,vt),Lf(Object.keys(Pe.state)).forEach(function(bt){var ze=Pe.state[bt].append(He,vt);oo(ze)?ze.forEach(function(ht,We){vt.set(He.next[bt],"["+We+"]",ht)}):vt.set(jt.next,"."+bt,ze)}),Hi(He,vt,Pe,!0,!0),[Kl,Hf,ca,Tl,Wu].forEach(function(bt){var dt=Pe.draw[bt];!dt||vt.set(jt.draw,"."+bt,""+dt.append(He,vt))}),Object.keys(Pe.uniforms).forEach(function(bt){var dt=Pe.uniforms[bt].append(He,vt);Array.isArray(dt)&&(dt="["+dt.join()+"]"),vt.set(jt.uniforms,"["+De.id(bt)+"]",dt)}),Object.keys(Pe.attributes).forEach(function(bt){var dt=Pe.attributes[bt].append(He,vt),ze=He.scopeAttrib(bt);Object.keys(new Vt).forEach(function(ht){vt.set(ze,"."+ht,dt[ht])})}),Pe.scopeVAO&&vt.set(jt.vao,".targetVAO",Pe.scopeVAO.append(He,vt)),At(ul),At(Ys),Object.keys(Pe.state).length>0&&(vt(fr,".dirty=true;"),vt.exit(fr,".dirty=true;")),vt("a1(",He.shared.context,",a0,",He.batchId,");")}(At,bt),function(He,Pe){var vt=He.proc("batch",2);He.batchId="0",Vo(He,vt);var jt=!1,fr=!0;Object.keys(Pe.context).forEach(function(Zr){jt=jt||Pe.context[Zr].propDep}),jt||(Uo(He,vt,Pe.context),fr=!1);var At=Pe.framebuffer,bt=!1;function dt(Zr){return Zr.contextDep&&jt||Zr.propDep}At?(At.propDep?jt=bt=!0:At.contextDep&&jt&&(bt=!0),bt||ss(He,vt,At)):ss(He,vt,null),Pe.state.viewport&&Pe.state.viewport.propDep&&(jt=!0),ms(He,vt,Pe),us(He,vt,Pe.state,function(Zr){return!dt(Zr)}),(!Pe.profile||!dt(Pe.profile))&&Hi(He,vt,Pe,!1,"a1"),Pe.contextDep=jt,Pe.needsContext=fr,Pe.needsFramebuffer=bt;var ze=Pe.shader.progVar;if(ze.contextDep&&jt||ze.propDep)Pl(He,vt,Pe,null);else{var ht=ze.append(He,vt);if(vt(He.shared.gl,".useProgram(",ht,".program);"),Pe.shader.program)Pl(He,vt,Pe,Pe.shader.program);else{vt(He.shared.vao,".setVAO(null);");var We=He.global.def("{}"),Ht=vt.def(ht,".id"),$t=vt.def(We,"[",Ht,"]");vt(He.cond($t).then($t,".call(this,a0,a1);").else($t,"=",We,"[",Ht,"]=",He.link(function(Zr){return Ai(Pl,He,Pe,Zr,2)}),"(",ht,");",$t,".call(this,a0,a1);"))}}Object.keys(Pe.state).length>0&&vt(He.shared.current,".dirty=true;"),He.shared.vao&&vt(He.shared.vao,".setVAO(null);")}(At,bt),l(At.compile(),{destroy:function(){bt.shader.program.destroy()}})}}}var Ip=function(q,De){if(!De.ext_disjoint_timer_query)return null;var it=[];function kr(Wr){it.push(Wr)}var ur=[];function Gr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Kr=[];function en(Wr){Kr.push(Wr)}var pn=[];function Hr(Wr,An,Mr){var wn=Kr.pop()||new Gr;wn.startQueryIndex=Wr,wn.endQueryIndex=An,wn.sum=0,wn.stats=Mr,pn.push(wn)}var tn=[],Vt=[];return{beginQuery:function(Wr){var An=it.pop()||De.ext_disjoint_timer_query.createQueryEXT();De.ext_disjoint_timer_query.beginQueryEXT(35007,An),ur.push(An),Hr(ur.length-1,ur.length,Wr)},endQuery:function(){De.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Hr,update:function(){var Wr,An,Mr=ur.length;if(0!==Mr){Vt.length=Math.max(Vt.length,Mr+1),tn.length=Math.max(tn.length,Mr+1),tn[0]=0,Vt[0]=0;var wn=0;for(Wr=0,An=0;An<ur.length;++An){var rn=ur[An];De.ext_disjoint_timer_query.getQueryObjectEXT(rn,34919)?(wn+=De.ext_disjoint_timer_query.getQueryObjectEXT(rn,34918),kr(rn)):ur[Wr++]=rn,tn[An+1]=wn,Vt[An+1]=Wr}for(ur.length=Wr,Wr=0,An=0;An<pn.length;++An){var ui=pn[An],Lr=ui.startQueryIndex,Er=ui.endQueryIndex;ui.sum+=tn[Er]-tn[Lr];var Gn=Vt[Lr],vn=Vt[Er];vn===Gn?(ui.stats.gpuTime+=ui.sum/1e6,en(ui)):(ui.startQueryIndex=Gn,ui.endQueryIndex=vn,pn[Wr++]=ui)}pn.length=Wr}},getNumPendingQueries:function(){return ur.length},clear:function(){it.push.apply(it,ur);for(var Wr=0;Wr<it.length;Wr++)De.ext_disjoint_timer_query.deleteQueryEXT(it[Wr]);ur.length=0,it.length=0},restore:function(){ur.length=0,it.length=0}}},Ih="webglcontextlost",zc="webglcontextrestored";function nf(q,De){for(var it=0;it<q.length;++it)if(q[it]===De)return it;return-1}return function(q){var De=G(q);if(!De)return null;var it=De.gl,cr=it.getContextAttributes(),kr=it.isContextLost(),ur=oe(it,De);if(!ur)return null;var Cr=function(){var q={"":0},De=[""];return{id:function(it){var cr=q[it];return cr||(cr=q[it]=De.length,De.push(it),cr)},str:function(it){return De[it]}}}(),Ur={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Gr=ur.extensions,Kr=Ip(0,Gr),qr=si(),en=it.drawingBufferWidth,pn=it.drawingBufferHeight,Hr={tick:0,time:0,viewportWidth:en,viewportHeight:pn,framebufferWidth:en,framebufferHeight:pn,drawingBufferWidth:en,drawingBufferHeight:pn,pixelRatio:De.pixelRatio},Vt={elements:null,primitive:4,count:-1,offset:0,instances:-1},_r=function(q,De){var it=1;De.ext_texture_filter_anisotropic&&(it=q.getParameter(34047));var cr=1,kr=1;De.webgl_draw_buffers&&(cr=q.getParameter(34852),kr=q.getParameter(36063));var ur=!!De.oes_texture_float;if(ur){var Cr=q.createTexture();q.bindTexture(3553,Cr),q.texImage2D(3553,0,aa,1,1,0,aa,5126,null);var Ur=q.createFramebuffer();if(q.bindFramebuffer(36160,Ur),q.framebufferTexture2D(36160,36064,3553,Cr,0),q.bindTexture(3553,null),36053!==q.checkFramebufferStatus(36160))ur=!1;else{q.viewport(0,0,1,1),q.clearColor(1,0,0,1),q.clear(16384);var Gr=rr.allocType(5126,4);q.readPixels(0,0,1,1,aa,5126,Gr),q.getError()?ur=!1:(q.deleteFramebuffer(Ur),q.deleteTexture(Cr),ur=1===Gr[0]),rr.freeType(Gr)}}var qr=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var en=q.createTexture(),pn=rr.allocType(5121,36);q.activeTexture(33984),q.bindTexture(34067,en),q.texImage2D(34069,0,aa,3,3,0,aa,5121,pn),rr.freeType(pn),q.bindTexture(34067,null),q.deleteTexture(en),qr=!q.getError()}return{colorBits:[q.getParameter(3410),q.getParameter(3411),q.getParameter(3412),q.getParameter(3413)],depthBits:q.getParameter(3414),stencilBits:q.getParameter(3415),subpixelBits:q.getParameter(3408),extensions:Object.keys(De).filter(function(Hr){return!!De[Hr]}),maxAnisotropic:it,maxDrawbuffers:cr,maxColorAttachments:kr,pointSizeDims:q.getParameter(33901),lineWidthDims:q.getParameter(33902),maxViewportDims:q.getParameter(3386),maxCombinedTextureUnits:q.getParameter(35661),maxCubeMapSize:q.getParameter(34076),maxRenderbufferSize:q.getParameter(34024),maxTextureUnits:q.getParameter(34930),maxTextureSize:q.getParameter(3379),maxAttributes:q.getParameter(34921),maxVertexUniforms:q.getParameter(36347),maxVertexTextureUnits:q.getParameter(35660),maxVaryingVectors:q.getParameter(36348),maxFragmentUniforms:q.getParameter(36349),glsl:q.getParameter(35724),renderer:q.getParameter(7937),vendor:q.getParameter(7936),version:q.getParameter(7938),readFloat:ur,npotTextureCube:qr}}(it,Gr),Wr=function(q,De,it,cr){var kr=0,ur={};function Cr(Vt){this.id=kr++,this.buffer=q.createBuffer(),this.type=Vt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,it.profile&&(this.stats={size:0})}Cr.prototype.bind=function(){q.bindBuffer(this.type,this.buffer)},Cr.prototype.destroy=function(){pn(this)};var Ur=[];function qr(Vt,_r,Wr){Vt.byteLength=_r.byteLength,q.bufferData(Vt.type,_r,Wr)}function en(Vt,_r,Wr,An,Mr,wn){var rn,ui;if(Vt.usage=Wr,Array.isArray(_r)){if(Vt.dtype=An||5126,_r.length>0)if(Array.isArray(_r[0])){rn=Ll(_r);for(var Lr=1,Er=1;Er<rn.length;++Er)Lr*=rn[Er];Vt.dimension=Lr,qr(Vt,ui=Ol(_r,rn,Vt.dtype),Wr),wn?Vt.persistentData=ui:rr.freeType(ui)}else if("number"==typeof _r[0]){Vt.dimension=Mr;var Gn=rr.allocType(Vt.dtype,_r.length);g(Gn,_r),qr(Vt,Gn,Wr),wn?Vt.persistentData=Gn:rr.freeType(Gn)}else _(_r[0])?(Vt.dimension=_r[0].length,Vt.dtype=An||Dl(_r[0])||5126,qr(Vt,ui=Ol(_r,[_r.length,_r[0].length],Vt.dtype),Wr),wn?Vt.persistentData=ui:rr.freeType(ui)):Z.raise("invalid buffer data")}else if(_(_r))Vt.dtype=An||Dl(_r),Vt.dimension=Mr,qr(Vt,_r,Wr),wn&&(Vt.persistentData=new Uint8Array(new Uint8Array(_r.buffer)));else if(St(_r)){var vn=_r.stride,Jr=_r.offset,xn=0,En=0,zi=0,Ii=0;1===(rn=_r.shape).length?(xn=rn[0],En=1,zi=vn[0],Ii=0):2===rn.length?(xn=rn[0],En=rn[1],zi=vn[0],Ii=vn[1]):Z.raise("invalid shape"),Vt.dtype=An||Dl(_r.data)||5126,Vt.dimension=En;var Cn=rr.allocType(Vt.dtype,xn*En);T(Cn,_r.data,xn,En,zi,Ii,Jr),qr(Vt,Cn,Wr),wn?Vt.persistentData=Cn:rr.freeType(Cn)}else _r instanceof ArrayBuffer?(Vt.dtype=5121,Vt.dimension=Mr,qr(Vt,_r,Wr),wn&&(Vt.persistentData=new Uint8Array(new Uint8Array(_r)))):Z.raise("invalid buffer data")}function pn(Vt){De.bufferCount--,cr(Vt);var _r=Vt.buffer;Z(_r,"buffer must not be deleted already"),q.deleteBuffer(_r),Vt.buffer=null,delete ur[Vt.id]}return it.profile&&(De.getTotalBufferSize=function(){var Vt=0;return Object.keys(ur).forEach(function(_r){Vt+=ur[_r].stats.size}),Vt}),{create:function(Vt,_r,Wr,An){De.bufferCount++;var Mr=new Cr(_r);function wn(Lr){var Er=35044,Gn=null,vn=0,Jr=0,xn=1;return Array.isArray(Lr)||_(Lr)||St(Lr)||Lr instanceof ArrayBuffer?Gn=Lr:"number"==typeof Lr?vn=0|Lr:Lr&&(Z.type(Lr,"object","buffer arguments must be an object, a number or an array"),"data"in Lr&&(Z(null===Gn||Array.isArray(Gn)||_(Gn)||St(Gn),"invalid data for buffer"),Gn=Lr.data),"usage"in Lr&&(Z.parameter(Lr.usage,ko,"invalid buffer usage"),Er=ko[Lr.usage]),"type"in Lr&&(Z.parameter(Lr.type,Qs,"invalid buffer type"),Jr=Qs[Lr.type]),"dimension"in Lr&&(Z.type(Lr.dimension,"number","invalid dimension"),xn=0|Lr.dimension),"length"in Lr&&(Z.nni(vn,"buffer length must be a nonnegative integer"),vn=0|Lr.length)),Mr.bind(),Gn?en(Mr,Gn,Er,Jr,xn,An):(vn&&q.bufferData(Mr.type,vn,Er),Mr.dtype=Jr||5121,Mr.usage=Er,Mr.dimension=xn,Mr.byteLength=vn),it.profile&&(Mr.stats.size=Mr.byteLength*eu[Mr.dtype]),wn}function rn(Lr,Er){Z(Er+Lr.byteLength<=Mr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Lr.byteLength+" starting from offset "+Er+" to a buffer of size "+Mr.byteLength),q.bufferSubData(Mr.type,Er,Lr)}return ur[Mr.id]=Mr,Wr||wn(Vt),wn._reglType="buffer",wn._buffer=Mr,wn.subdata=function(Lr,Er){var vn,Gn=0|(Er||0);if(Mr.bind(),_(Lr)||Lr instanceof ArrayBuffer)rn(Lr,Gn);else if(Array.isArray(Lr)){if(Lr.length>0)if("number"==typeof Lr[0]){var Jr=rr.allocType(Mr.dtype,Lr.length);g(Jr,Lr),rn(Jr,Gn),rr.freeType(Jr)}else if(Array.isArray(Lr[0])||_(Lr[0])){vn=Ll(Lr);var xn=Ol(Lr,vn,Mr.dtype);rn(xn,Gn),rr.freeType(xn)}else Z.raise("invalid buffer data")}else if(St(Lr)){var En=Lr.stride,zi=0,Ii=0,Cn=0,Tn=0;1===(vn=Lr.shape).length?(zi=vn[0],Ii=1,Cn=En[0],Tn=0):2===vn.length?(zi=vn[0],Ii=vn[1],Cn=En[0],Tn=En[1]):Z.raise("invalid shape");var _i=Array.isArray(Lr.data)?Mr.dtype:Dl(Lr.data),Zi=rr.allocType(_i,zi*Ii);T(Zi,Lr.data,zi,Ii,Cn,Tn,Lr.offset),rn(Zi,Gn),rr.freeType(Zi)}else Z.raise("invalid data for buffer subdata");return wn},it.profile&&(wn.stats=Mr.stats),wn.destroy=function(){pn(Mr)},wn},createStream:function(Vt,_r){var Wr=Ur.pop();return Wr||(Wr=new Cr(Vt)),Wr.bind(),en(Wr,_r,35040,0,1,!1),Wr},destroyStream:function(Vt){Ur.push(Vt)},clear:function(){or(ur).forEach(pn),Ur.forEach(pn)},getBuffer:function(Vt){return Vt&&Vt._buffer instanceof Cr?Vt._buffer:null},restore:function(){or(ur).forEach(function(Vt){Vt.buffer=q.createBuffer(),q.bindBuffer(Vt.type,Vt.buffer),q.bufferData(Vt.type,Vt.persistentData||Vt.byteLength,Vt.usage)})},_initBuffer:en}}(it,Ur,De,function(Ai){return Mr.destroyBuffer(Ai)}),An=function(q,De,it,cr){var kr={},ur=0,Cr={uint8:oa,uint16:Fa};function Ur(tn){this.id=ur++,kr[this.id]=this,this.buffer=tn,this.primType=4,this.vertCount=0,this.type=0}De.oes_element_index_uint&&(Cr.uint32=Xo),Ur.prototype.bind=function(){this.buffer.bind()};var Gr=[];function en(tn,Vt,_r,Wr,An,Mr,wn){var rn;if(tn.buffer.bind(),Vt){var ui=wn;!wn&&(!_(Vt)||St(Vt)&&!_(Vt.data))&&(ui=De.oes_element_index_uint?Xo:Fa),it._initBuffer(tn.buffer,Vt,_r,ui,3)}else q.bufferData(34963,Mr,_r),tn.buffer.dtype=rn||oa,tn.buffer.usage=_r,tn.buffer.dimension=3,tn.buffer.byteLength=Mr;if(rn=wn,!wn){switch(tn.buffer.dtype){case oa:case 5120:rn=oa;break;case Fa:case 5122:rn=Fa;break;case Xo:case 5124:rn=Xo;break;default:Z.raise("unsupported type for element array")}tn.buffer.dtype=rn}tn.type=rn,Z(rn!==Xo||!!De.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Lr=An;Lr<0&&(Lr=tn.buffer.byteLength,rn===Fa?Lr>>=1:rn===Xo&&(Lr>>=2)),tn.vertCount=Lr;var Er=Wr;if(Wr<0){Er=4;var Gn=tn.buffer.dimension;1===Gn&&(Er=0),2===Gn&&(Er=1),3===Gn&&(Er=4)}tn.primType=Er}function pn(tn){cr.elementsCount--,Z(null!==tn.buffer,"must not double destroy elements"),delete kr[tn.id],tn.buffer.destroy(),tn.buffer=null}return{create:function(tn,Vt){var _r=it.create(null,34963,!0),Wr=new Ur(_r._buffer);function An(Mr){if(Mr)if("number"==typeof Mr)_r(Mr),Wr.primType=4,Wr.vertCount=0|Mr,Wr.type=oa;else{var wn=null,rn=35044,ui=-1,Lr=-1,Er=0,Gn=0;Array.isArray(Mr)||_(Mr)||St(Mr)?wn=Mr:(Z.type(Mr,"object","invalid arguments for elements"),"data"in Mr&&(wn=Mr.data,Z(Array.isArray(wn)||_(wn)||St(wn),"invalid data for element buffer")),"usage"in Mr&&(Z.parameter(Mr.usage,ko,"invalid element buffer usage"),rn=ko[Mr.usage]),"primitive"in Mr&&(Z.parameter(Mr.primitive,Or,"invalid element buffer primitive"),ui=Or[Mr.primitive]),"count"in Mr&&(Z("number"==typeof Mr.count&&Mr.count>=0,"invalid vertex count for elements"),Lr=0|Mr.count),"type"in Mr&&(Z.parameter(Mr.type,Cr,"invalid buffer type"),Gn=Cr[Mr.type]),"length"in Mr?Er=0|Mr.length:(Er=Lr,Gn===Fa||5122===Gn?Er*=2:(Gn===Xo||5124===Gn)&&(Er*=4))),en(Wr,wn,rn,ui,Lr,Er,Gn)}else _r(),Wr.primType=4,Wr.vertCount=0,Wr.type=oa;return An}return cr.elementsCount++,An(tn),An._reglType="elements",An._elements=Wr,An.subdata=function(Mr,wn){return _r.subdata(Mr,wn),An},An.destroy=function(){pn(Wr)},An},createStream:function(tn){var Vt=Gr.pop();return Vt||(Vt=new Ur(it.create(null,34963,!0,!1)._buffer)),en(Vt,tn,35040,-1,-1,0,0),Vt},destroyStream:function(tn){Gr.push(tn)},getElements:function(tn){return"function"==typeof tn&&tn._elements instanceof Ur?tn._elements:null},clear:function(){or(kr).forEach(pn)}}}(it,Gr,Wr,Ur),Mr=function(q,De,it,cr,kr,ur,Cr){for(var Ur=it.maxAttributes,Gr=new Array(Ur),Kr=0;Kr<Ur;++Kr)Gr[Kr]=new ft;var qr=0,en={},pn={Record:ft,scope:{},state:Gr,currentVAO:null,targetVAO:null,restore:tn()?function(){tn()&&or(en).forEach(function(Er){Er.refresh()})}:function(){},createVAO:function(Lr){var Er=new wn;function Gn(vn){var Jr;if(Array.isArray(vn))Jr=vn,Er.elements&&Er.ownsElements&&Er.elements.destroy(),Er.elements=null,Er.ownsElements=!1,Er.offset=0,Er.count=0,Er.instances=-1,Er.primitive=4;else{if(Z("object"==typeof vn,"invalid arguments for create vao"),Z("attributes"in vn,"must specify attributes for vao"),vn.elements){var xn=vn.elements;Er.ownsElements?"function"==typeof xn&&"elements"===xn._reglType?(Er.elements.destroy(),Er.ownsElements=!1):(Er.elements(xn),Er.ownsElements=!1):ur.getElements(vn.elements)?(Er.elements=vn.elements,Er.ownsElements=!1):(Er.elements=ur.create(vn.elements),Er.ownsElements=!0)}else Er.elements=null,Er.ownsElements=!1;Jr=vn.attributes,Er.offset=0,Er.count=-1,Er.instances=-1,Er.primitive=4,Er.elements&&(Er.count=Er.elements._elements.vertCount,Er.primitive=Er.elements._elements.primType),"offset"in vn&&(Er.offset=0|vn.offset),"count"in vn&&(Er.count=0|vn.count),"instances"in vn&&(Er.instances=0|vn.instances),"primitive"in vn&&(Z(vn.primitive in Or,"bad primitive type: "+vn.primitive),Er.primitive=Or[vn.primitive]),Z.optional(()=>{for(var Io=Object.keys(vn),Mo=0;Mo<Io.length;++Mo)Z(Ke.indexOf(Io[Mo])>=0,'invalid option for vao: "'+Io[Mo]+'" valid options are '+Ke)}),Z(Array.isArray(Jr),"attributes must be an array")}Z(Jr.length<Ur,"too many attributes"),Z(Jr.length>0,"must specify at least one attribute");var En={},zi=Er.attributes;zi.length=Jr.length;for(var Ii=0;Ii<Jr.length;++Ii){var Zi,Cn=Jr[Ii],Tn=zi[Ii]=new ft,_i=Cn.data||Cn;Array.isArray(_i)||_(_i)||St(_i)?(Er.buffers[Ii]&&(Zi=Er.buffers[Ii],_(_i)&&Zi._buffer.byteLength>=_i.byteLength?Zi.subdata(_i):(Zi.destroy(),Er.buffers[Ii]=null)),Er.buffers[Ii]||(Zi=Er.buffers[Ii]=kr.create(Cn,34962,!1,!0)),Tn.buffer=kr.getBuffer(Zi),Tn.size=0|Tn.buffer.dimension,Tn.normalized=!1,Tn.type=Tn.buffer.dtype,Tn.offset=0,Tn.stride=0,Tn.divisor=0,Tn.state=1,En[Ii]=1):kr.getBuffer(Cn)?(Tn.buffer=kr.getBuffer(Cn),Tn.size=0|Tn.buffer.dimension,Tn.normalized=!1,Tn.type=Tn.buffer.dtype,Tn.offset=0,Tn.stride=0,Tn.divisor=0,Tn.state=1):kr.getBuffer(Cn.buffer)?(Tn.buffer=kr.getBuffer(Cn.buffer),Tn.size=0|(+Cn.size||Tn.buffer.dimension),Tn.normalized=!!Cn.normalized||!1,"type"in Cn?(Z.parameter(Cn.type,Qs,"invalid buffer type"),Tn.type=Qs[Cn.type]):Tn.type=Tn.buffer.dtype,Tn.offset=0|(Cn.offset||0),Tn.stride=0|(Cn.stride||0),Tn.divisor=0|(Cn.divisor||0),Tn.state=1,Z(Tn.size>=1&&Tn.size<=4,"size must be between 1 and 4"),Z(Tn.offset>=0,"invalid offset"),Z(Tn.stride>=0&&Tn.stride<=255,"stride must be between 0 and 255"),Z(Tn.divisor>=0,"divisor must be positive"),Z(!Tn.divisor||!!De.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Cn?(Z(Ii>0,"first attribute must not be a constant"),Tn.x=+Cn.x||0,Tn.y=+Cn.y||0,Tn.z=+Cn.z||0,Tn.w=+Cn.w||0,Tn.state=2):Z(!1,"invalid attribute spec for location "+Ii)}for(var fa=0;fa<Er.buffers.length;++fa)!En[fa]&&Er.buffers[fa]&&(Er.buffers[fa].destroy(),Er.buffers[fa]=null);return Er.refresh(),Gn}return cr.vaoCount+=1,Gn.destroy=function(){for(var vn=0;vn<Er.buffers.length;++vn)Er.buffers[vn]&&Er.buffers[vn].destroy();Er.buffers.length=0,Er.ownsElements&&(Er.elements.destroy(),Er.elements=null,Er.ownsElements=!1),Er.destroy()},Gn._vao=Er,Gn._reglType="vao",Gn(Lr)},getVAO:function(Lr){return"function"==typeof Lr&&Lr._vao?Lr._vao:null},destroyBuffer:function(Lr){for(var Er=0;Er<Gr.length;++Er){var Gn=Gr[Er];Gn.buffer===Lr&&(q.disableVertexAttribArray(Er),Gn.buffer=null)}},setVAO:tn()?function(Lr){Lr!==pn.currentVAO&&(tn().bindVertexArrayOES(Lr?Lr.vao:null),pn.currentVAO=Lr)}:function(Lr){if(Lr!==pn.currentVAO){if(Lr)Lr.bindAttrs();else{for(var Er=Vt(),Gn=0;Gn<Gr.length;++Gn){var vn=Gr[Gn];vn.buffer?(q.enableVertexAttribArray(Gn),vn.buffer.bind(),q.vertexAttribPointer(Gn,vn.size,vn.type,vn.normalized,vn.stride,vn.offfset),Er&&vn.divisor&&Er.vertexAttribDivisorANGLE(Gn,vn.divisor)):(q.disableVertexAttribArray(Gn),q.vertexAttrib4f(Gn,vn.x,vn.y,vn.z,vn.w))}q.bindBuffer(34963,Cr.elements?Cr.elements.buffer.buffer:null)}pn.currentVAO=Lr}},clear:tn()?function(){or(en).forEach(function(Lr){Lr.destroy()})}:function(){}};function tn(){return De.oes_vertex_array_object}function Vt(){return De.angle_instanced_arrays}function wn(){this.id=++qr,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Lr=tn();this.vao=Lr?Lr.createVertexArrayOES():null,en[this.id]=this,this.buffers=[]}return wn.prototype.bindAttrs=function(){for(var Lr=Vt(),Er=this.attributes,Gn=0;Gn<Er.length;++Gn){var vn=Er[Gn];vn.buffer?(q.enableVertexAttribArray(Gn),q.bindBuffer(34962,vn.buffer.buffer),q.vertexAttribPointer(Gn,vn.size,vn.type,vn.normalized,vn.stride,vn.offset),Lr&&vn.divisor&&Lr.vertexAttribDivisorANGLE(Gn,vn.divisor)):(q.disableVertexAttribArray(Gn),q.vertexAttrib4f(Gn,vn.x,vn.y,vn.z,vn.w))}for(var Jr=Er.length;Jr<Ur;++Jr)q.disableVertexAttribArray(Jr);var xn=ur.getElements(this.elements);q.bindBuffer(34963,xn?xn.buffer.buffer:null)},wn.prototype.refresh=function(){var Lr=tn();Lr&&(Lr.bindVertexArrayOES(this.vao),this.bindAttrs(),pn.currentVAO=null,Lr.bindVertexArrayOES(null))},wn.prototype.destroy=function(){if(this.vao){var Lr=tn();this===pn.currentVAO&&(pn.currentVAO=null,Lr.bindVertexArrayOES(null)),Lr.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),en[this.id]&&(delete en[this.id],cr.vaoCount-=1)},pn}(it,Gr,_r,Ur,Wr,An,Vt),rn=function(q,De,it,cr){var kr={},ur={};function Cr(Vt,_r,Wr,An){this.name=Vt,this.id=_r,this.location=Wr,this.info=An}function Ur(Vt,_r){for(var Wr=0;Wr<Vt.length;++Wr)if(Vt[Wr].id===_r.id)return void(Vt[Wr].location=_r.location);Vt.push(_r)}function Gr(Vt,_r,Wr){var An=35632===Vt?kr:ur,Mr=An[_r];if(!Mr){var wn=De.str(_r);Mr=q.createShader(Vt),q.shaderSource(Mr,wn),q.compileShader(Mr),Z.shaderError(q,Mr,wn,Vt,Wr),An[_r]=Mr}return Mr}var Kr={},qr=[],en=0;function pn(Vt,_r){this.id=en++,this.fragId=Vt,this.vertId=_r,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,cr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Hr(Vt,_r,Wr){var An,Mr,wn=Gr(35632,Vt.fragId),rn=Gr(35633,Vt.vertId),ui=Vt.program=q.createProgram();if(q.attachShader(ui,wn),q.attachShader(ui,rn),Wr)for(An=0;An<Wr.length;++An){var Lr=Wr[An];q.bindAttribLocation(ui,Lr[0],Lr[1])}q.linkProgram(ui),Z.linkError(q,ui,De.str(Vt.fragId),De.str(Vt.vertId),_r);var Er=q.getProgramParameter(ui,35718);cr.profile&&(Vt.stats.uniformsCount=Er);var Gn=Vt.uniforms;for(An=0;An<Er;++An)if(Mr=q.getActiveUniform(ui,An))if(Mr.size>1)for(var vn=0;vn<Mr.size;++vn){var Jr=Mr.name.replace("[0]","["+vn+"]");Ur(Gn,new Cr(Jr,De.id(Jr),q.getUniformLocation(ui,Jr),Mr))}else Ur(Gn,new Cr(Mr.name,De.id(Mr.name),q.getUniformLocation(ui,Mr.name),Mr));var xn=q.getProgramParameter(ui,35721);cr.profile&&(Vt.stats.attributesCount=xn);var En=Vt.attributes;for(An=0;An<xn;++An)(Mr=q.getActiveAttrib(ui,An))&&Ur(En,new Cr(Mr.name,De.id(Mr.name),q.getAttribLocation(ui,Mr.name),Mr))}return cr.profile&&(it.getMaxUniformsCount=function(){var Vt=0;return qr.forEach(function(_r){_r.stats.uniformsCount>Vt&&(Vt=_r.stats.uniformsCount)}),Vt},it.getMaxAttributesCount=function(){var Vt=0;return qr.forEach(function(_r){_r.stats.attributesCount>Vt&&(Vt=_r.stats.attributesCount)}),Vt}),{clear:function(){var Vt=q.deleteShader.bind(q);or(kr).forEach(Vt),kr={},or(ur).forEach(Vt),ur={},qr.forEach(function(_r){q.deleteProgram(_r.program)}),qr.length=0,Kr={},it.shaderCount=0},program:function(Vt,_r,Wr,An){Z.command(Vt>=0,"missing vertex shader",Wr),Z.command(_r>=0,"missing fragment shader",Wr);var Mr=Kr[_r];Mr||(Mr=Kr[_r]={});var wn=Mr[Vt];if(wn&&(wn.refCount++,!An))return wn;var rn=new pn(_r,Vt);return it.shaderCount++,Hr(rn,Wr,An),wn||(Mr[Vt]=rn),qr.push(rn),l(rn,{destroy:function(){if(rn.refCount--,rn.refCount<=0){q.deleteProgram(rn.program);var ui=qr.indexOf(rn);qr.splice(ui,1),it.shaderCount--}Mr[rn.vertId].refCount<=0&&(q.deleteShader(ur[rn.vertId]),delete ur[rn.vertId],delete Kr[rn.fragId][rn.vertId]),Object.keys(Kr[rn.fragId]).length||(q.deleteShader(kr[rn.fragId]),delete kr[rn.fragId],delete Kr[rn.fragId])}})},restore:function(){kr={},ur={};for(var Vt=0;Vt<qr.length;++Vt)Hr(qr[Vt],null,qr[Vt].attributes.map(function(_r){return[_r.location,_r.name]}))},shader:Gr,frag:-1,vert:-1}}(it,Cr,Ur,De),ui=ou(it,Gr,_r,function(){Gn.procs.poll()},Hr,Ur,De),Lr=function(q,De,it,cr,kr){var ur={rgba4:il,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};De.ext_srgb&&(ur.srgba=35907),De.ext_color_buffer_half_float&&(ur.rgba16f=34842,ur.rgb16f=34843),De.webgl_color_buffer_float&&(ur.rgba32f=34836);var Cr=[];Object.keys(ur).forEach(function(Hr){Cr[ur[Hr]]=Hr});var Ur=0,Gr={};function Kr(Hr){this.id=Ur++,this.refCount=1,this.renderbuffer=Hr,this.format=il,this.width=0,this.height=0,kr.profile&&(this.stats={size:0})}function qr(Hr){var tn=Hr.renderbuffer;Z(tn,"must not double destroy renderbuffer"),q.bindRenderbuffer(mo,null),q.deleteRenderbuffer(tn),Hr.renderbuffer=null,Hr.refCount=0,delete Gr[Hr.id],cr.renderbufferCount--}return Kr.prototype.decRef=function(){--this.refCount<=0&&qr(this)},kr.profile&&(cr.getTotalRenderbufferSize=function(){var Hr=0;return Object.keys(Gr).forEach(function(tn){Hr+=Gr[tn].stats.size}),Hr}),{create:function(Hr,tn){var Vt=new Kr(q.createRenderbuffer());function _r(An,Mr){var wn=0,rn=0,ui=il;if("object"==typeof An&&An){var Lr=An;if("shape"in Lr){var Er=Lr.shape;Z(Array.isArray(Er)&&Er.length>=2,"invalid renderbuffer shape"),wn=0|Er[0],rn=0|Er[1]}else"radius"in Lr&&(wn=rn=0|Lr.radius),"width"in Lr&&(wn=0|Lr.width),"height"in Lr&&(rn=0|Lr.height);"format"in Lr&&(Z.parameter(Lr.format,ur,"invalid renderbuffer format"),ui=ur[Lr.format])}else"number"==typeof An?(wn=0|An,rn="number"==typeof Mr?0|Mr:wn):An?Z.raise("invalid arguments to renderbuffer constructor"):wn=rn=1;if(Z(wn>0&&rn>0&&wn<=it.maxRenderbufferSize&&rn<=it.maxRenderbufferSize,"invalid renderbuffer size"),wn!==Vt.width||rn!==Vt.height||ui!==Vt.format)return _r.width=Vt.width=wn,_r.height=Vt.height=rn,Vt.format=ui,q.bindRenderbuffer(mo,Vt.renderbuffer),q.renderbufferStorage(mo,ui,wn,rn),Z(0===q.getError(),"invalid render buffer format"),kr.profile&&(Vt.stats.size=zo(Vt.format,Vt.width,Vt.height)),_r.format=Cr[Vt.format],_r}return Gr[Vt.id]=Vt,cr.renderbufferCount++,_r(Hr,tn),_r.resize=function(An,Mr){var wn=0|An,rn=0|Mr||wn;return wn===Vt.width&&rn===Vt.height||(Z(wn>0&&rn>0&&wn<=it.maxRenderbufferSize&&rn<=it.maxRenderbufferSize,"invalid renderbuffer size"),_r.width=Vt.width=wn,_r.height=Vt.height=rn,q.bindRenderbuffer(mo,Vt.renderbuffer),q.renderbufferStorage(mo,Vt.format,wn,rn),Z(0===q.getError(),"invalid render buffer format"),kr.profile&&(Vt.stats.size=zo(Vt.format,Vt.width,Vt.height))),_r},_r._reglType="renderbuffer",_r._renderbuffer=Vt,kr.profile&&(_r.stats=Vt.stats),_r.destroy=function(){Vt.decRef()},_r},clear:function(){or(Gr).forEach(qr)},restore:function(){or(Gr).forEach(function(Hr){Hr.renderbuffer=q.createRenderbuffer(),q.bindRenderbuffer(mo,Hr.renderbuffer),q.renderbufferStorage(mo,Hr.format,Hr.width,Hr.height)}),q.bindRenderbuffer(mo,null)}}}(it,Gr,_r,Ur,De),Er=function(q,De,it,cr,kr,ur){var Cr={cur:null,next:null,dirty:!1,setFBO:null},Ur=["rgba"],Gr=["rgba4","rgb565","rgb5 a1"];De.ext_srgb&&Gr.push("srgba"),De.ext_color_buffer_half_float&&Gr.push("rgba16f","rgb16f"),De.webgl_color_buffer_float&&Gr.push("rgba32f");var Kr=["uint8"];function qr(Jr,xn,En){this.target=Jr,this.texture=xn,this.renderbuffer=En;var zi=0,Ii=0;xn?(zi=xn.width,Ii=xn.height):En&&(zi=En.width,Ii=En.height),this.width=zi,this.height=Ii}function en(Jr){Jr&&(Jr.texture&&Jr.texture._texture.decRef(),Jr.renderbuffer&&Jr.renderbuffer._renderbuffer.decRef())}function pn(Jr,xn,En){if(Jr)if(Jr.texture){var zi=Jr.texture._texture,Ii=Math.max(1,zi.width),Cn=Math.max(1,zi.height);Z(Ii===xn&&Cn===En,"inconsistent width/height for supplied texture"),zi.refCount+=1}else{var Tn=Jr.renderbuffer._renderbuffer;Z(Tn.width===xn&&Tn.height===En,"inconsistent width/height for renderbuffer"),Tn.refCount+=1}}function Hr(Jr,xn){xn&&(xn.texture?q.framebufferTexture2D(As,Jr,xn.target,xn.texture._texture.texture,0):q.framebufferRenderbuffer(As,Jr,36161,xn.renderbuffer._renderbuffer.renderbuffer))}function tn(Jr){var xn=ys,En=null,zi=null,Ii=Jr;"object"==typeof Jr&&(Ii=Jr.data,"target"in Jr&&(xn=0|Jr.target)),Z.type(Ii,"function","invalid attachment data");var Cn=Ii._reglType;return"texture2d"===Cn?(En=Ii,Z(xn===ys)):"textureCube"===Cn?(En=Ii,Z(xn>=is&&xn<is+6,"invalid cube map target")):"renderbuffer"===Cn?(zi=Ii,xn=36161):Z.raise("invalid regl object for attachment"),new qr(xn,En,zi)}function Vt(Jr,xn,En,zi,Ii){if(En){var Cn=cr.create2D({width:Jr,height:xn,format:zi,type:Ii});return Cn._texture.refCount=0,new qr(ys,Cn,null)}var Tn=kr.create({width:Jr,height:xn,format:zi});return Tn._renderbuffer.refCount=0,new qr(36161,null,Tn)}function _r(Jr){return Jr&&(Jr.texture||Jr.renderbuffer)}function Wr(Jr,xn,En){Jr&&(Jr.texture?Jr.texture.resize(xn,En):Jr.renderbuffer&&Jr.renderbuffer.resize(xn,En),Jr.width=xn,Jr.height=En)}De.oes_texture_half_float&&Kr.push("half float","float16"),De.oes_texture_float&&Kr.push("float","float32");var An=0,Mr={};function wn(){this.id=An++,Mr[this.id]=this,this.framebuffer=q.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function rn(Jr){Jr.colorAttachments.forEach(en),en(Jr.depthAttachment),en(Jr.stencilAttachment),en(Jr.depthStencilAttachment)}function ui(Jr){var xn=Jr.framebuffer;Z(xn,"must not double destroy framebuffer"),q.deleteFramebuffer(xn),Jr.framebuffer=null,ur.framebufferCount--,delete Mr[Jr.id]}function Lr(Jr){var xn;q.bindFramebuffer(As,Jr.framebuffer);var En=Jr.colorAttachments;for(xn=0;xn<En.length;++xn)Hr(36064+xn,En[xn]);for(xn=En.length;xn<it.maxColorAttachments;++xn)q.framebufferTexture2D(As,36064+xn,ys,null,0);q.framebufferTexture2D(As,33306,ys,null,0),q.framebufferTexture2D(As,36096,ys,null,0),q.framebufferTexture2D(As,36128,ys,null,0),Hr(36096,Jr.depthAttachment),Hr(36128,Jr.stencilAttachment),Hr(33306,Jr.depthStencilAttachment);var zi=q.checkFramebufferStatus(As);!q.isContextLost()&&36053!==zi&&Z.raise("framebuffer configuration not supported, status = "+Me[zi]),q.bindFramebuffer(As,Cr.next?Cr.next.framebuffer:null),Cr.cur=Cr.next,q.getError()}function Er(Jr,xn){var En=new wn;function zi(Cn,Tn){var _i;Z(Cr.next!==En,"can not update framebuffer which is currently in use");var Zi=0,fa=0,Io=!0,Mo=!0,ha=null,ds=!0,so="rgba",vs="uint8",Uo=1,ss=null,ms=null,us=null,Vo=!1;if("number"==typeof Cn)Zi=0|Cn,fa=0|Tn||Zi;else if(Cn){Z.type(Cn,"object","invalid arguments for framebuffer");var Hi=Cn;if("shape"in Hi){var ls=Hi.shape;Z(Array.isArray(ls)&&ls.length>=2,"invalid shape for framebuffer"),Zi=ls[0],fa=ls[1]}else"radius"in Hi&&(Zi=fa=Hi.radius),"width"in Hi&&(Zi=Hi.width),"height"in Hi&&(fa=Hi.height);("color"in Hi||"colors"in Hi)&&(ha=Hi.color||Hi.colors,Array.isArray(ha)&&Z(1===ha.length||De.webgl_draw_buffers,"multiple render targets not supported")),ha||("colorCount"in Hi&&Z((Uo=0|Hi.colorCount)>0,"invalid color buffer count"),"colorTexture"in Hi&&(ds=!!Hi.colorTexture,so="rgba4"),"colorType"in Hi&&(vs=Hi.colorType,ds?(Z(De.oes_texture_float||!("float"===vs||"float32"===vs),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Z(De.oes_texture_half_float||!("half float"===vs||"float16"===vs),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===vs||"float16"===vs?(Z(De.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),so="rgba16f"):("float"===vs||"float32"===vs)&&(Z(De.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),so="rgba32f"),Z.oneOf(vs,Kr,"invalid color type")),"colorFormat"in Hi&&(Ur.indexOf(so=Hi.colorFormat)>=0?ds=!0:Gr.indexOf(so)>=0?ds=!1:Z.optional(function(){ds?Z.oneOf(Hi.colorFormat,Ur,"invalid color format for texture"):Z.oneOf(Hi.colorFormat,Gr,"invalid color format for renderbuffer")}))),("depthTexture"in Hi||"depthStencilTexture"in Hi)&&Z(!(Vo=!(!Hi.depthTexture&&!Hi.depthStencilTexture))||De.webgl_depth_texture,"webgl_depth_texture extension not supported"),"depth"in Hi&&("boolean"==typeof Hi.depth?Io=Hi.depth:(ss=Hi.depth,Mo=!1)),"stencil"in Hi&&("boolean"==typeof Hi.stencil?Mo=Hi.stencil:(ms=Hi.stencil,Io=!1)),"depthStencil"in Hi&&("boolean"==typeof Hi.depthStencil?Io=Mo=Hi.depthStencil:(us=Hi.depthStencil,Io=!1,Mo=!1))}else Zi=fa=1;var ka=null,uo=null,Ai=null,pa=null;if(Array.isArray(ha))ka=ha.map(tn);else if(ha)ka=[tn(ha)];else for(ka=new Array(Uo),_i=0;_i<Uo;++_i)ka[_i]=Vt(Zi,fa,ds,so,vs);Z(De.webgl_draw_buffers||ka.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Z(ka.length<=it.maxColorAttachments,"too many color attachments, not supported"),Zi=Zi||ka[0].width,fa=fa||ka[0].height,ss?uo=tn(ss):Io&&!Mo&&(uo=Vt(Zi,fa,Vo,"depth","uint32")),ms?Ai=tn(ms):Mo&&!Io&&(Ai=Vt(Zi,fa,!1,"stencil","uint8")),us?pa=tn(us):!ss&&!ms&&Mo&&Io&&(pa=Vt(Zi,fa,Vo,"depth stencil","depth stencil")),Z(!!ss+!!ms+!!us<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Qa=null;for(_i=0;_i<ka.length;++_i)if(pn(ka[_i],Zi,fa),Z(!ka[_i]||ka[_i].texture&&cc.indexOf(ka[_i].texture._texture.format)>=0||ka[_i].renderbuffer&&Ce.indexOf(ka[_i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+_i+" is invalid"),ka[_i]&&ka[_i].texture){var To=fc[ka[_i].texture._texture.format]*El[ka[_i].texture._texture.type];null===Qa?Qa=To:Z(Qa===To,"all color attachments much have the same number of bits per pixel.")}return pn(uo,Zi,fa),Z(!uo||uo.texture&&6402===uo.texture._texture.format||uo.renderbuffer&&33189===uo.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),pn(Ai,Zi,fa),Z(!Ai||Ai.renderbuffer&&36168===Ai.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),pn(pa,Zi,fa),Z(!pa||pa.texture&&34041===pa.texture._texture.format||pa.renderbuffer&&34041===pa.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),rn(En),En.width=Zi,En.height=fa,En.colorAttachments=ka,En.depthAttachment=uo,En.stencilAttachment=Ai,En.depthStencilAttachment=pa,zi.color=ka.map(_r),zi.depth=_r(uo),zi.stencil=_r(Ai),zi.depthStencil=_r(pa),zi.width=En.width,zi.height=En.height,Lr(En),zi}return ur.framebufferCount++,zi(Jr,xn),l(zi,{resize:function(Cn,Tn){Z(Cr.next!==En,"can not resize a framebuffer which is currently in use");var _i=Math.max(0|Cn,1),Zi=Math.max(0|Tn||_i,1);if(_i===En.width&&Zi===En.height)return zi;for(var fa=En.colorAttachments,Io=0;Io<fa.length;++Io)Wr(fa[Io],_i,Zi);return Wr(En.depthAttachment,_i,Zi),Wr(En.stencilAttachment,_i,Zi),Wr(En.depthStencilAttachment,_i,Zi),En.width=zi.width=_i,En.height=zi.height=Zi,Lr(En),zi},_reglType:"framebuffer",_framebuffer:En,destroy:function(){ui(En),rn(En)},use:function(Cn){Cr.setFBO({framebuffer:zi},Cn)}})}return l(Cr,{getFramebuffer:function(Jr){if("function"==typeof Jr&&"framebuffer"===Jr._reglType){var xn=Jr._framebuffer;if(xn instanceof wn)return xn}return null},create:Er,createCube:function(Jr){var xn=Array(6);function En(Ii){var Cn;Z(xn.indexOf(Cr.next)<0,"can not update framebuffer which is currently in use");var so,Tn={color:null},_i=0,Zi=null,fa="rgba",Io="uint8",Mo=1;if("number"==typeof Ii)_i=0|Ii;else if(Ii){Z.type(Ii,"object","invalid arguments for framebuffer");var ha=Ii;if("shape"in ha){var ds=ha.shape;Z(Array.isArray(ds)&&ds.length>=2,"invalid shape for framebuffer"),Z(ds[0]===ds[1],"cube framebuffer must be square"),_i=ds[0]}else"radius"in ha&&(_i=0|ha.radius),"width"in ha?(_i=0|ha.width,"height"in ha&&Z(ha.height===_i,"must be square")):"height"in ha&&(_i=0|ha.height);("color"in ha||"colors"in ha)&&(Zi=ha.color||ha.colors,Array.isArray(Zi)&&Z(1===Zi.length||De.webgl_draw_buffers,"multiple render targets not supported")),Zi||("colorCount"in ha&&Z((Mo=0|ha.colorCount)>0,"invalid color buffer count"),"colorType"in ha&&(Z.oneOf(ha.colorType,Kr,"invalid color type"),Io=ha.colorType),"colorFormat"in ha&&(fa=ha.colorFormat,Z.oneOf(ha.colorFormat,Ur,"invalid color format for texture"))),"depth"in ha&&(Tn.depth=ha.depth),"stencil"in ha&&(Tn.stencil=ha.stencil),"depthStencil"in ha&&(Tn.depthStencil=ha.depthStencil)}else _i=1;if(Zi)if(Array.isArray(Zi))for(so=[],Cn=0;Cn<Zi.length;++Cn)so[Cn]=Zi[Cn];else so=[Zi];else{so=Array(Mo);var vs={radius:_i,format:fa,type:Io};for(Cn=0;Cn<Mo;++Cn)so[Cn]=cr.createCube(vs)}for(Tn.color=Array(so.length),Cn=0;Cn<so.length;++Cn){var Uo=so[Cn];Z("function"==typeof Uo&&"textureCube"===Uo._reglType,"invalid cube map"),Z(Uo.width===(_i=_i||Uo.width)&&Uo.height===_i,"invalid cube map shape"),Tn.color[Cn]={target:is,data:so[Cn]}}for(Cn=0;Cn<6;++Cn){for(var ss=0;ss<so.length;++ss)Tn.color[ss].target=is+Cn;Cn>0&&(Tn.depth=xn[0].depth,Tn.stencil=xn[0].stencil,Tn.depthStencil=xn[0].depthStencil),xn[Cn]?xn[Cn](Tn):xn[Cn]=Er(Tn)}return l(En,{width:_i,height:_i,color:so})}return En(Jr),l(En,{faces:xn,resize:function(Ii){var Cn,Tn=0|Ii;if(Z(Tn>0&&Tn<=it.maxCubeMapSize,"invalid radius for cube fbo"),Tn===En.width)return En;var _i=En.color;for(Cn=0;Cn<_i.length;++Cn)_i[Cn].resize(Tn);for(Cn=0;Cn<6;++Cn)xn[Cn].resize(Tn);return En.width=En.height=Tn,En},_reglType:"framebufferCube",destroy:function(){xn.forEach(function(Ii){Ii.destroy()})}})},clear:function(){or(Mr).forEach(ui)},restore:function(){Cr.cur=null,Cr.next=null,Cr.dirty=!0,or(Mr).forEach(function(Jr){Jr.framebuffer=q.createFramebuffer(),Lr(Jr)})}})}(it,Gr,_r,ui,Lr,Ur),Gn=Ap(it,Cr,Gr,_r,Wr,An,0,Er,{},Mr,rn,Vt,Hr,Kr,De),vn=Vn(it,Er,Gn.procs.poll,Hr,cr,Gr,_r),Jr=Gn.next,xn=it.canvas,En=[],zi=[],Ii=[],Cn=[De.onDestroy],Tn=null;function _i(){if(0===En.length)return Kr&&Kr.update(),void(Tn=null);Tn=mi.next(_i),Vo();for(var Ai=En.length-1;Ai>=0;--Ai){var pa=En[Ai];pa&&pa(Hr,null,0)}it.flush(),Kr&&Kr.update()}function Zi(){!Tn&&En.length>0&&(Tn=mi.next(_i))}function fa(){Tn&&(mi.cancel(_i),Tn=null)}function Io(Ai){Ai.preventDefault(),kr=!0,fa(),zi.forEach(function(pa){pa()})}function Mo(Ai){it.getError(),kr=!1,ur.restore(),rn.restore(),Wr.restore(),ui.restore(),Lr.restore(),Er.restore(),Mr.restore(),Kr&&Kr.restore(),Gn.procs.refresh(),Zi(),Ii.forEach(function(pa){pa()})}var ha="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast;function so(Ai){function Qa(At,bt){var dt={},ze={};return Object.keys(At).forEach(function(ht){var We=At[ht];if(On.isDynamic(We))ze[ht]=On.unbox(We,ht);else{if(bt&&Array.isArray(We))for(var Ht=0;Ht<We.length;++Ht)if(On.isDynamic(We[Ht]))return void(ze[ht]=On.unbox(We,ht));dt[ht]=We}}),{dynamic:ze,static:dt}}Z(!!Ai,"invalid args to regl({...})"),Z.type(Ai,"object","invalid args to regl({...})");var To=Qa(Ai.context||{},!0),Pl=Qa(Ai.uniforms||{},!0),Qe=Qa(Ai.attributes||{},!1),vr=Qa(function(At){var bt=l({},At);function dt(ze){if(ze in bt){var ht=bt[ze];delete bt[ze],Object.keys(ht).forEach(function(We){bt[ze+"."+We]=ht[We]})}}return delete bt.uniforms,delete bt.attributes,delete bt.context,delete bt.vao,"stencil"in bt&&bt.stencil.op&&(bt.stencil.opBack=bt.stencil.opFront=bt.stencil.op,delete bt.stencil.op),dt("blend"),dt("depth"),dt("cull"),dt("stencil"),dt("polygonOffset"),dt("scissor"),dt("sample"),"vao"in At&&(bt.vao=At.vao),bt}(Ai),!1),tr={gpuTime:0,cpuTime:0,count:0},zn=Gn.compile(vr,Qe,Pl,To,tr),ya=zn.draw,He=zn.batch,Pe=zn.scope,vt=[];return l(function(At,bt){var dt;if(kr&&Z.raise("context lost"),"function"==typeof At)return Pe.call(this,null,At,0);if("function"==typeof bt)if("number"==typeof At)for(dt=0;dt<At;++dt)Pe.call(this,null,bt,dt);else{if(!Array.isArray(At))return Pe.call(this,At,bt,0);for(dt=0;dt<At.length;++dt)Pe.call(this,At[dt],bt,dt)}else if("number"==typeof At){if(At>0)return He.call(this,function(At){for(;vt.length<At;)vt.push(null);return vt}(0|At),0|At)}else{if(!Array.isArray(At))return ya.call(this,At);if(At.length)return He.call(this,At,At.length)}},{stats:tr,destroy:function(){zn.destroy()}})}!ha&&xn&&(xn.addEventListener(Ih,Io,!1),xn.addEventListener(zc,Mo,!1));var vs=Er.setFBO=so({framebuffer:On.define.call(null,1,"framebuffer")});function Uo(Ai,pa){var Qa=0;Gn.procs.poll();var To=pa.color;To&&(it.clearColor(+To[0]||0,+To[1]||0,+To[2]||0,+To[3]||0),Qa|=16384),"depth"in pa&&(it.clearDepth(+pa.depth),Qa|=256),"stencil"in pa&&(it.clearStencil(0|pa.stencil),Qa|=1024),Z(!!Qa,"called regl.clear with no buffer specified"),it.clear(Qa)}function ms(Ai){return Z.type(Ai,"function","regl.frame() callback must be a function"),En.push(Ai),Zi(),{cancel:function(){var Qa=nf(En,Ai);Z(Qa>=0,"cannot cancel a frame twice"),En[Qa]=function To(){var Pl=nf(En,To);En[Pl]=En[En.length-1],En.length-=1,En.length<=0&&fa()}}}}function us(){var Ai=Jr.viewport,pa=Jr.scissor_box;Ai[0]=Ai[1]=pa[0]=pa[1]=0,Hr.viewportWidth=Hr.framebufferWidth=Hr.drawingBufferWidth=Ai[2]=pa[2]=it.drawingBufferWidth,Hr.viewportHeight=Hr.framebufferHeight=Hr.drawingBufferHeight=Ai[3]=pa[3]=it.drawingBufferHeight}function Vo(){Hr.tick+=1,Hr.time=ls(),us(),Gn.procs.poll()}function Hi(){ui.refresh(),us(),Gn.procs.refresh(),Kr&&Kr.update()}function ls(){return(si()-qr)/1e3}Hi();var uo=l(so,{clear:function(Ai){if(Z("object"==typeof Ai&&Ai,"regl.clear() takes an object as input"),"framebuffer"in Ai)if(Ai.framebuffer&&"framebufferCube"===Ai.framebuffer_reglType)for(var pa=0;pa<6;++pa)vs(l({framebuffer:Ai.framebuffer.faces[pa]},Ai),Uo);else vs(Ai,Uo);else Uo(0,Ai)},prop:On.define.bind(null,1),context:On.define.bind(null,2),this:On.define.bind(null,3),draw:so({}),buffer:function(Ai){return Wr.create(Ai,34962,!1,!1)},elements:function(Ai){return An.create(Ai,!1)},texture:ui.create2D,cube:ui.createCube,renderbuffer:Lr.create,framebuffer:Er.create,framebufferCube:Er.createCube,vao:Mr.createVAO,attributes:cr,frame:ms,on:function(Ai,pa){var Qa;switch(Z.type(pa,"function","listener callback must be a function"),Ai){case"frame":return ms(pa);case"lost":Qa=zi;break;case"restore":Qa=Ii;break;case"destroy":Qa=Cn;break;default:Z.raise("invalid event, must be one of frame,lost,restore,destroy")}return Qa.push(pa),{cancel:function(){for(var To=0;To<Qa.length;++To)if(Qa[To]===pa)return Qa[To]=Qa[Qa.length-1],void Qa.pop()}}},limits:_r,hasExtension:function(Ai){return _r.extensions.indexOf(Ai.toLowerCase())>=0},read:vn,destroy:function(){En.length=0,fa(),!ha&&xn&&(xn.removeEventListener(Ih,Io),xn.removeEventListener(zc,Mo)),rn.clear(),Er.clear(),Lr.clear(),Mr.clear(),ui.clear(),An.clear(),Wr.clear(),Kr&&Kr.clear(),Cn.forEach(function(Ai){Ai()})},_gl:it,_refresh:Hi,poll:function(){Vo(),Kr&&Kr.update()},now:ls,stats:Ur});return De.onDone(null,uo),uo}}(y(88660))},81235:(ne,L,y)=>{var l=y(4153)(y(27038),"DataView");ne.exports=l},41505:(ne,L,y)=>{var M=y(59410),_=y(21143),l=y(604),m=y(80584),O=y(7792);function R(N){var H=-1,j=null==N?0:N.length;for(this.clear();++H<j;){var be=N[H];this.set(be[0],be[1])}}R.prototype.clear=M,R.prototype.delete=_,R.prototype.get=l,R.prototype.has=m,R.prototype.set=O,ne.exports=R},73545:(ne,L,y)=>{var M=y(63391),_=y(68971),l=y(18858),m=y(13913),O=y(68944);function R(N){var H=-1,j=null==N?0:N.length;for(this.clear();++H<j;){var be=N[H];this.set(be[0],be[1])}}R.prototype.clear=M,R.prototype.delete=_,R.prototype.get=l,R.prototype.has=m,R.prototype.set=O,ne.exports=R},39046:(ne,L,y)=>{var l=y(4153)(y(27038),"Map");ne.exports=l},93177:(ne,L,y)=>{var M=y(70536),_=y(61502),l=y(94960),m=y(61539),O=y(34138);function R(N){var H=-1,j=null==N?0:N.length;for(this.clear();++H<j;){var be=N[H];this.set(be[0],be[1])}}R.prototype.clear=M,R.prototype.delete=_,R.prototype.get=l,R.prototype.has=m,R.prototype.set=O,ne.exports=R},97129:(ne,L,y)=>{var l=y(4153)(y(27038),"Promise");ne.exports=l},74918:(ne,L,y)=>{var l=y(4153)(y(27038),"Set");ne.exports=l},48690:(ne,L,y)=>{var M=y(93177),_=y(30365),l=y(58235);function m(O){var R=-1,N=null==O?0:O.length;for(this.__data__=new M;++R<N;)this.add(O[R])}m.prototype.add=m.prototype.push=_,m.prototype.has=l,ne.exports=m},33667:(ne,L,y)=>{var M=y(73545),_=y(18034),l=y(37238),m=y(54384),O=y(81450),R=y(61386);function N(H){var j=this.__data__=new M(H);this.size=j.size}N.prototype.clear=_,N.prototype.delete=l,N.prototype.get=m,N.prototype.has=O,N.prototype.set=R,ne.exports=N},57333:(ne,L,y)=>{var M=y(27038);ne.exports=M.Symbol},96820:(ne,L,y)=>{var M=y(27038);ne.exports=M.Uint8Array},54203:(ne,L,y)=>{var l=y(4153)(y(27038),"WeakMap");ne.exports=l},81638:ne=>{ne.exports=function(y,M,_){switch(_.length){case 0:return y.call(M);case 1:return y.call(M,_[0]);case 2:return y.call(M,_[0],_[1]);case 3:return y.call(M,_[0],_[1],_[2])}return y.apply(M,_)}},4500:ne=>{ne.exports=function(y,M){for(var _=-1,l=null==y?0:y.length;++_<l&&!1!==M(y[_],_,y););return y}},11375:ne=>{ne.exports=function(y,M){for(var _=-1,l=null==y?0:y.length,m=0,O=[];++_<l;){var R=y[_];M(R,_,y)&&(O[m++]=R)}return O}},5242:(ne,L,y)=>{var M=y(2166);ne.exports=function(l,m){return!(null==l||!l.length)&&M(l,m,0)>-1}},80679:ne=>{ne.exports=function(y,M,_){for(var l=-1,m=null==y?0:y.length;++l<m;)if(_(M,y[l]))return!0;return!1}},71890:(ne,L,y)=>{var M=y(48282),_=y(2952),l=y(81690),m=y(84444),O=y(20968),R=y(47679),H=Object.prototype.hasOwnProperty;ne.exports=function(be,Ne){var V=l(be),W=!V&&_(be),Ye=!V&&!W&&m(be),_t=!V&&!W&&!Ye&&R(be),Rt=V||W||Ye||_t,wt=Rt?M(be.length,String):[],lt=wt.length;for(var tt in be)(Ne||H.call(be,tt))&&(!Rt||!("length"==tt||Ye&&("offset"==tt||"parent"==tt)||_t&&("buffer"==tt||"byteLength"==tt||"byteOffset"==tt)||O(tt,lt)))&&wt.push(tt);return wt}},14992:ne=>{ne.exports=function(y,M){for(var _=-1,l=null==y?0:y.length,m=Array(l);++_<l;)m[_]=M(y[_],_,y);return m}},94165:ne=>{ne.exports=function(y,M){for(var _=-1,l=M.length,m=y.length;++_<l;)y[m+_]=M[_];return y}},89731:ne=>{ne.exports=function(y,M,_,l){var m=-1,O=null==y?0:y.length;for(l&&O&&(_=y[++m]);++m<O;)_=M(_,y[m],m,y);return _}},8141:ne=>{ne.exports=function(y,M){for(var _=-1,l=null==y?0:y.length;++_<l;)if(M(y[_],_,y))return!0;return!1}},87280:ne=>{ne.exports=function(y){return y.split("")}},54561:ne=>{var L=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;ne.exports=function(M){return M.match(L)||[]}},63530:(ne,L,y)=>{var M=y(63581),_=y(71166);ne.exports=function(m,O,R){(void 0!==R&&!_(m[O],R)||void 0===R&&!(O in m))&&M(m,O,R)}},23898:(ne,L,y)=>{var M=y(63581),_=y(71166),m=Object.prototype.hasOwnProperty;ne.exports=function(R,N,H){var j=R[N];(!m.call(R,N)||!_(j,H)||void 0===H&&!(N in R))&&M(R,N,H)}},15758:(ne,L,y)=>{var M=y(71166);ne.exports=function(l,m){for(var O=l.length;O--;)if(M(l[O][0],m))return O;return-1}},22067:(ne,L,y)=>{var M=y(11694),_=y(59108);ne.exports=function(m,O){return m&&M(O,_(O),m)}},70882:(ne,L,y)=>{var M=y(11694),_=y(42970);ne.exports=function(m,O){return m&&M(O,_(O),m)}},63581:(ne,L,y)=>{var M=y(20395);ne.exports=function(l,m,O){"__proto__"==m&&M?M(l,m,{configurable:!0,enumerable:!0,value:O,writable:!0}):l[m]=O}},15820:ne=>{ne.exports=function(y,M,_){return y==y&&(void 0!==_&&(y=y<=_?y:_),void 0!==M&&(y=y>=M?y:M)),y}},77007:(ne,L,y)=>{var M=y(33667),_=y(4500),l=y(23898),m=y(22067),O=y(70882),R=y(50694),N=y(53595),H=y(14746),j=y(78857),be=y(58605),Ne=y(51675),V=y(26663),W=y(62963),Ye=y(32143),_t=y(31563),Rt=y(81690),wt=y(84444),lt=y(32e3),tt=y(53867),Gt=y(48855),Q=y(59108),Ut=y(42970),Xe="[object Arguments]",le="[object Function]",Ie="[object Object]",$r={};$r[Xe]=$r["[object Array]"]=$r["[object ArrayBuffer]"]=$r["[object DataView]"]=$r["[object Boolean]"]=$r["[object Date]"]=$r["[object Float32Array]"]=$r["[object Float64Array]"]=$r["[object Int8Array]"]=$r["[object Int16Array]"]=$r["[object Int32Array]"]=$r["[object Map]"]=$r["[object Number]"]=$r[Ie]=$r["[object RegExp]"]=$r["[object Set]"]=$r["[object String]"]=$r["[object Symbol]"]=$r["[object Uint8Array]"]=$r["[object Uint8ClampedArray]"]=$r["[object Uint16Array]"]=$r["[object Uint32Array]"]=!0,$r["[object Error]"]=$r[le]=$r["[object WeakMap]"]=!1,ne.exports=function C(Y,Ge,nt,xt,Dt,Z){var Ze,Et=1&Ge,Mt=2&Ge,Jt=4&Ge;if(nt&&(Ze=Dt?nt(Y,xt,Dt,Z):nt(Y)),void 0!==Ze)return Ze;if(!tt(Y))return Y;var Tr=Rt(Y);if(Tr){if(Ze=W(Y),!Et)return N(Y,Ze)}else{var mr=V(Y),Yt=mr==le||"[object GeneratorFunction]"==mr;if(wt(Y))return R(Y,Et);if(mr==Ie||mr==Xe||Yt&&!Dt){if(Ze=Mt||Yt?{}:_t(Y),!Et)return Mt?j(Y,O(Ze,Y)):H(Y,m(Ze,Y))}else{if(!$r[mr])return Dt?Y:{};Ze=Ye(Y,mr,Et)}}Z||(Z=new M);var gr=Z.get(Y);if(gr)return gr;Z.set(Y,Ze),Gt(Y)?Y.forEach(function(mn){Ze.add(C(mn,Ge,nt,mn,Y,Z))}):lt(Y)&&Y.forEach(function(mn,On){Ze.set(On,C(mn,Ge,nt,On,Y,Z))});var dr=Tr?void 0:(Jt?Mt?Ne:be:Mt?Ut:Q)(Y);return _(dr||Y,function(mn,On){dr&&(mn=Y[On=mn]),l(Ze,On,C(mn,Ge,nt,On,Y,Z))}),Ze}},60920:(ne,L,y)=>{var M=y(53867),_=Object.create,l=function(){function m(){}return function(O){if(!M(O))return{};if(_)return _(O);m.prototype=O;var R=new m;return m.prototype=void 0,R}}();ne.exports=l},12229:ne=>{ne.exports=function(y,M,_,l){for(var m=y.length,O=_+(l?1:-1);l?O--:++O<m;)if(M(y[O],O,y))return O;return-1}},75290:(ne,L,y)=>{var _=y(8269)();ne.exports=_},19215:(ne,L,y)=>{var M=y(94165),_=y(81690);ne.exports=function(m,O,R){var N=O(m);return _(m)?N:M(N,R(m))}},72802:(ne,L,y)=>{var M=y(57333),_=y(21613),l=y(81244),R=M?M.toStringTag:void 0;ne.exports=function(H){return null==H?void 0===H?"[object Undefined]":"[object Null]":R&&R in Object(H)?_(H):l(H)}},2166:(ne,L,y)=>{var M=y(12229),_=y(2469),l=y(54299);ne.exports=function(O,R,N){return R==R?l(O,R,N):M(O,_,N)}},77090:(ne,L,y)=>{var M=y(72802),_=y(27503);ne.exports=function(O){return _(O)&&"[object Arguments]"==M(O)}},30696:(ne,L,y)=>{var M=y(36863),_=y(27503);ne.exports=function l(m,O,R,N,H){return m===O||(null==m||null==O||!_(m)&&!_(O)?m!=m&&O!=O:M(m,O,R,N,l,H))}},36863:(ne,L,y)=>{var M=y(33667),_=y(27667),l=y(64630),m=y(70838),O=y(26663),R=y(81690),N=y(84444),H=y(47679),be="[object Arguments]",Ne="[object Array]",V="[object Object]",Ye=Object.prototype.hasOwnProperty;ne.exports=function(Rt,wt,lt,tt,Gt,Q){var Ut=R(Rt),ot=R(wt),Ue=Ut?Ne:O(Rt),ct=ot?Ne:O(wt),Xe=(Ue=Ue==be?V:Ue)==V,Pt=(ct=ct==be?V:ct)==V,kt=Ue==ct;if(kt&&N(Rt)){if(!N(wt))return!1;Ut=!0,Xe=!1}if(kt&&!Xe)return Q||(Q=new M),Ut||H(Rt)?_(Rt,wt,lt,tt,Gt,Q):l(Rt,wt,Ue,lt,tt,Gt,Q);if(!(1&lt)){var ut=Xe&&Ye.call(Rt,"__wrapped__"),ir=Pt&&Ye.call(wt,"__wrapped__");if(ut||ir){var le=ut?Rt.value():Rt,ce=ir?wt.value():wt;return Q||(Q=new M),Gt(le,ce,lt,tt,Q)}}return!!kt&&(Q||(Q=new M),m(Rt,wt,lt,tt,Gt,Q))}},63434:(ne,L,y)=>{var M=y(26663),_=y(27503);ne.exports=function(O){return _(O)&&"[object Map]"==M(O)}},2469:ne=>{ne.exports=function(y){return y!=y}},43540:(ne,L,y)=>{var M=y(55836),_=y(38466),l=y(53867),m=y(51217),R=/^\[object .+?Constructor\]$/,Ne=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");ne.exports=function(W){return!(!l(W)||_(W))&&(M(W)?Ne:R).test(m(W))}},67495:(ne,L,y)=>{var M=y(26663),_=y(27503);ne.exports=function(O){return _(O)&&"[object Set]"==M(O)}},99390:(ne,L,y)=>{var M=y(72802),_=y(8613),l=y(27503),kt={};kt["[object Float32Array]"]=kt["[object Float64Array]"]=kt["[object Int8Array]"]=kt["[object Int16Array]"]=kt["[object Int32Array]"]=kt["[object Uint8Array]"]=kt["[object Uint8ClampedArray]"]=kt["[object Uint16Array]"]=kt["[object Uint32Array]"]=!0,kt["[object Arguments]"]=kt["[object Array]"]=kt["[object ArrayBuffer]"]=kt["[object Boolean]"]=kt["[object DataView]"]=kt["[object Date]"]=kt["[object Error]"]=kt["[object Function]"]=kt["[object Map]"]=kt["[object Number]"]=kt["[object Object]"]=kt["[object RegExp]"]=kt["[object Set]"]=kt["[object String]"]=kt["[object WeakMap]"]=!1,ne.exports=function(ir){return l(ir)&&_(ir.length)&&!!kt[M(ir)]}},92488:(ne,L,y)=>{var M=y(58845),_=y(36700),m=Object.prototype.hasOwnProperty;ne.exports=function(R){if(!M(R))return _(R);var N=[];for(var H in Object(R))m.call(R,H)&&"constructor"!=H&&N.push(H);return N}},50762:(ne,L,y)=>{var M=y(53867),_=y(58845),l=y(25618),O=Object.prototype.hasOwnProperty;ne.exports=function(N){if(!M(N))return l(N);var H=_(N),j=[];for(var be in N)"constructor"==be&&(H||!O.call(N,be))||j.push(be);return j}},9085:(ne,L,y)=>{var M=y(33667),_=y(63530),l=y(75290),m=y(23607),O=y(53867),R=y(42970),N=y(45959);ne.exports=function H(j,be,Ne,V,W){j!==be&&l(be,function(Ye,_t){if(W||(W=new M),O(Ye))m(j,be,_t,Ne,H,V,W);else{var Rt=V?V(N(j,_t),Ye,_t+"",j,be,W):void 0;void 0===Rt&&(Rt=Ye),_(j,_t,Rt)}},R)}},23607:(ne,L,y)=>{var M=y(63530),_=y(50694),l=y(96282),m=y(53595),O=y(31563),R=y(2952),N=y(81690),H=y(82027),j=y(84444),be=y(55836),Ne=y(53867),V=y(82358),W=y(47679),Ye=y(45959),_t=y(31413);ne.exports=function(wt,lt,tt,Gt,Q,Ut,ot){var Ue=Ye(wt,tt),ct=Ye(lt,tt),Xe=ot.get(ct);if(Xe)M(wt,tt,Xe);else{var Pt=Ut?Ut(Ue,ct,tt+"",wt,lt,ot):void 0,kt=void 0===Pt;if(kt){var ut=N(ct),ir=!ut&&j(ct),le=!ut&&!ir&&W(ct);Pt=ct,ut||ir||le?N(Ue)?Pt=Ue:H(Ue)?Pt=m(Ue):ir?(kt=!1,Pt=_(ct,!0)):le?(kt=!1,Pt=l(ct,!0)):Pt=[]:V(ct)||R(ct)?(Pt=Ue,R(Ue)?Pt=_t(Ue):(!Ne(Ue)||be(Ue))&&(Pt=O(ct))):kt=!1}kt&&(ot.set(ct,Pt),Q(Pt,ct,Gt,Ut,ot),ot.delete(ct)),M(wt,tt,Pt)}}},17421:ne=>{ne.exports=function(y){return function(M){return null==y?void 0:y[M]}}},84441:(ne,L,y)=>{var M=y(80290),_=y(15529),l=y(39009);ne.exports=function(O,R){return l(_(O,R,M),O+"")}},99372:(ne,L,y)=>{var M=y(45654),_=y(20395),l=y(80290);ne.exports=_?function(O,R){return _(O,"toString",{configurable:!0,enumerable:!1,value:M(R),writable:!0})}:l},63586:ne=>{ne.exports=function(y,M,_){var l=-1,m=y.length;M<0&&(M=-M>m?0:m+M),(_=_>m?m:_)<0&&(_+=m),m=M>_?0:_-M>>>0,M>>>=0;for(var O=Array(m);++l<m;)O[l]=y[l+M];return O}},48282:ne=>{ne.exports=function(y,M){for(var _=-1,l=Array(y);++_<y;)l[_]=M(_);return l}},68166:(ne,L,y)=>{var M=y(57333),_=y(14992),l=y(81690),m=y(7786),R=M?M.prototype:void 0,N=R?R.toString:void 0;ne.exports=function H(j){if("string"==typeof j)return j;if(l(j))return _(j,H)+"";if(m(j))return N?N.call(j):"";var be=j+"";return"0"==be&&1/j==-1/0?"-0":be}},13743:(ne,L,y)=>{var M=y(87478),_=/^\s+/;ne.exports=function(m){return m&&m.slice(0,M(m)+1).replace(_,"")}},70544:ne=>{ne.exports=function(y){return function(M){return y(M)}}},83987:(ne,L,y)=>{var M=y(48690),_=y(5242),l=y(80679),m=y(13747),O=y(52252),R=y(57673);ne.exports=function(j,be,Ne){var V=-1,W=_,Ye=j.length,_t=!0,Rt=[],wt=Rt;if(Ne)_t=!1,W=l;else if(Ye>=200){var lt=be?null:O(j);if(lt)return R(lt);_t=!1,W=m,wt=new M}else wt=be?[]:Rt;e:for(;++V<Ye;){var tt=j[V],Gt=be?be(tt):tt;if(tt=Ne||0!==tt?tt:0,_t&&Gt==Gt){for(var Q=wt.length;Q--;)if(wt[Q]===Gt)continue e;be&&wt.push(Gt),Rt.push(tt)}else W(wt,Gt,Ne)||(wt!==Rt&&wt.push(Gt),Rt.push(tt))}return Rt}},13747:ne=>{ne.exports=function(y,M){return y.has(M)}},26477:(ne,L,y)=>{var M=y(63586);ne.exports=function(l,m,O){var R=l.length;return O=void 0===O?R:O,!m&&O>=R?l:M(l,m,O)}},88461:(ne,L,y)=>{var M=y(96820);ne.exports=function(l){var m=new l.constructor(l.byteLength);return new M(m).set(new M(l)),m}},50694:(ne,L,y)=>{ne=y.nmd(ne);var M=y(27038),_=L&&!L.nodeType&&L,l=_&&ne&&!ne.nodeType&&ne,O=l&&l.exports===_?M.Buffer:void 0,R=O?O.allocUnsafe:void 0;ne.exports=function(H,j){if(j)return H.slice();var be=H.length,Ne=R?R(be):new H.constructor(be);return H.copy(Ne),Ne}},59757:(ne,L,y)=>{var M=y(88461);ne.exports=function(l,m){var O=m?M(l.buffer):l.buffer;return new l.constructor(O,l.byteOffset,l.byteLength)}},83615:ne=>{var L=/\w*$/;ne.exports=function(M){var _=new M.constructor(M.source,L.exec(M));return _.lastIndex=M.lastIndex,_}},42282:(ne,L,y)=>{var M=y(57333),_=M?M.prototype:void 0,l=_?_.valueOf:void 0;ne.exports=function(O){return l?Object(l.call(O)):{}}},96282:(ne,L,y)=>{var M=y(88461);ne.exports=function(l,m){var O=m?M(l.buffer):l.buffer;return new l.constructor(O,l.byteOffset,l.length)}},53595:ne=>{ne.exports=function(y,M){var _=-1,l=y.length;for(M||(M=Array(l));++_<l;)M[_]=y[_];return M}},11694:(ne,L,y)=>{var M=y(23898),_=y(63581);ne.exports=function(m,O,R,N){var H=!R;R||(R={});for(var j=-1,be=O.length;++j<be;){var Ne=O[j],V=N?N(R[Ne],m[Ne],Ne,R,m):void 0;void 0===V&&(V=m[Ne]),H?_(R,Ne,V):M(R,Ne,V)}return R}},14746:(ne,L,y)=>{var M=y(11694),_=y(10296);ne.exports=function(m,O){return M(m,_(m),O)}},78857:(ne,L,y)=>{var M=y(11694),_=y(29572);ne.exports=function(m,O){return M(m,_(m),O)}},93412:(ne,L,y)=>{var M=y(27038);ne.exports=M["__core-js_shared__"]},30906:(ne,L,y)=>{var M=y(84441),_=y(71100);ne.exports=function(m){return M(function(O,R){var N=-1,H=R.length,j=H>1?R[H-1]:void 0,be=H>2?R[2]:void 0;for(j=m.length>3&&"function"==typeof j?(H--,j):void 0,be&&_(R[0],R[1],be)&&(j=H<3?void 0:j,H=1),O=Object(O);++N<H;){var Ne=R[N];Ne&&m(O,Ne,N,j)}return O})}},8269:ne=>{ne.exports=function(y){return function(M,_,l){for(var m=-1,O=Object(M),R=l(M),N=R.length;N--;){var H=R[y?N:++m];if(!1===_(O[H],H,O))break}return M}}},66803:(ne,L,y)=>{var M=y(26477),_=y(407),l=y(2150),m=y(41233);ne.exports=function(R){return function(N){N=m(N);var H=_(N)?l(N):void 0,j=H?H[0]:N.charAt(0),be=H?M(H,1).join(""):N.slice(1);return j[R]()+be}}},17407:(ne,L,y)=>{var M=y(89731),_=y(75289),l=y(96590),O=RegExp("['\u2019]","g");ne.exports=function(N){return function(H){return M(l(_(H).replace(O,"")),N,"")}}},52252:(ne,L,y)=>{var M=y(74918),_=y(49122),l=y(57673),O=M&&1/l(new M([,-0]))[1]==1/0?function(R){return new M(R)}:_;ne.exports=O},4068:(ne,L,y)=>{var l=y(17421)({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"});ne.exports=l},20395:(ne,L,y)=>{var M=y(4153),_=function(){try{var l=M(Object,"defineProperty");return l({},"",{}),l}catch(m){}}();ne.exports=_},27667:(ne,L,y)=>{var M=y(48690),_=y(8141),l=y(13747);ne.exports=function(N,H,j,be,Ne,V){var W=1&j,Ye=N.length,_t=H.length;if(Ye!=_t&&!(W&&_t>Ye))return!1;var Rt=V.get(N),wt=V.get(H);if(Rt&&wt)return Rt==H&&wt==N;var lt=-1,tt=!0,Gt=2&j?new M:void 0;for(V.set(N,H),V.set(H,N);++lt<Ye;){var Q=N[lt],Ut=H[lt];if(be)var ot=W?be(Ut,Q,lt,H,N,V):be(Q,Ut,lt,N,H,V);if(void 0!==ot){if(ot)continue;tt=!1;break}if(Gt){if(!_(H,function(Ue,ct){if(!l(Gt,ct)&&(Q===Ue||Ne(Q,Ue,j,be,V)))return Gt.push(ct)})){tt=!1;break}}else if(Q!==Ut&&!Ne(Q,Ut,j,be,V)){tt=!1;break}}return V.delete(N),V.delete(H),tt}},64630:(ne,L,y)=>{var M=y(57333),_=y(96820),l=y(71166),m=y(27667),O=y(37461),R=y(57673),Gt=M?M.prototype:void 0,Q=Gt?Gt.valueOf:void 0;ne.exports=function(ot,Ue,ct,Xe,Pt,kt,ut){switch(ct){case"[object DataView]":if(ot.byteLength!=Ue.byteLength||ot.byteOffset!=Ue.byteOffset)return!1;ot=ot.buffer,Ue=Ue.buffer;case"[object ArrayBuffer]":return!(ot.byteLength!=Ue.byteLength||!kt(new _(ot),new _(Ue)));case"[object Boolean]":case"[object Date]":case"[object Number]":return l(+ot,+Ue);case"[object Error]":return ot.name==Ue.name&&ot.message==Ue.message;case"[object RegExp]":case"[object String]":return ot==Ue+"";case"[object Map]":var ir=O;case"[object Set]":if(ir||(ir=R),ot.size!=Ue.size&&!(1&Xe))return!1;var ce=ut.get(ot);if(ce)return ce==Ue;Xe|=2,ut.set(ot,Ue);var ae=m(ir(ot),ir(Ue),Xe,Pt,kt,ut);return ut.delete(ot),ae;case"[object Symbol]":if(Q)return Q.call(ot)==Q.call(Ue)}return!1}},70838:(ne,L,y)=>{var M=y(58605),m=Object.prototype.hasOwnProperty;ne.exports=function(R,N,H,j,be,Ne){var V=1&H,W=M(R),Ye=W.length;if(Ye!=M(N).length&&!V)return!1;for(var wt=Ye;wt--;){var lt=W[wt];if(!(V?lt in N:m.call(N,lt)))return!1}var tt=Ne.get(R),Gt=Ne.get(N);if(tt&&Gt)return tt==N&&Gt==R;var Q=!0;Ne.set(R,N),Ne.set(N,R);for(var Ut=V;++wt<Ye;){var ot=R[lt=W[wt]],Ue=N[lt];if(j)var ct=V?j(Ue,ot,lt,N,R,Ne):j(ot,Ue,lt,R,N,Ne);if(!(void 0===ct?ot===Ue||be(ot,Ue,H,j,Ne):ct)){Q=!1;break}Ut||(Ut="constructor"==lt)}if(Q&&!Ut){var Xe=R.constructor,Pt=N.constructor;Xe!=Pt&&"constructor"in R&&"constructor"in N&&!("function"==typeof Xe&&Xe instanceof Xe&&"function"==typeof Pt&&Pt instanceof Pt)&&(Q=!1)}return Ne.delete(R),Ne.delete(N),Q}},61138:ne=>{var L="object"==typeof global&&global&&global.Object===Object&&global;ne.exports=L},58605:(ne,L,y)=>{var M=y(19215),_=y(10296),l=y(59108);ne.exports=function(O){return M(O,l,_)}},51675:(ne,L,y)=>{var M=y(19215),_=y(29572),l=y(42970);ne.exports=function(O){return M(O,l,_)}},85556:(ne,L,y)=>{var M=y(36586);ne.exports=function(l,m){var O=l.__data__;return M(m)?O["string"==typeof m?"string":"hash"]:O.map}},4153:(ne,L,y)=>{var M=y(43540),_=y(36825);ne.exports=function(m,O){var R=_(m,O);return M(R)?R:void 0}},52398:(ne,L,y)=>{var _=y(93332)(Object.getPrototypeOf,Object);ne.exports=_},21613:(ne,L,y)=>{var M=y(57333),_=Object.prototype,l=_.hasOwnProperty,m=_.toString,O=M?M.toStringTag:void 0;ne.exports=function(N){var H=l.call(N,O),j=N[O];try{N[O]=void 0;var be=!0}catch(V){}var Ne=m.call(N);return be&&(H?N[O]=j:delete N[O]),Ne}},10296:(ne,L,y)=>{var M=y(11375),_=y(65336),m=Object.prototype.propertyIsEnumerable,O=Object.getOwnPropertySymbols;ne.exports=O?function(N){return null==N?[]:(N=Object(N),M(O(N),function(H){return m.call(N,H)}))}:_},29572:(ne,L,y)=>{var M=y(94165),_=y(52398),l=y(10296),m=y(65336);ne.exports=Object.getOwnPropertySymbols?function(N){for(var H=[];N;)M(H,l(N)),N=_(N);return H}:m},26663:(ne,L,y)=>{var M=y(81235),_=y(39046),l=y(97129),m=y(74918),O=y(54203),R=y(72802),N=y(51217),H="[object Map]",be="[object Promise]",Ne="[object Set]",V="[object WeakMap]",W="[object DataView]",Ye=N(M),_t=N(_),Rt=N(l),wt=N(m),lt=N(O),tt=R;(M&&tt(new M(new ArrayBuffer(1)))!=W||_&&tt(new _)!=H||l&&tt(l.resolve())!=be||m&&tt(new m)!=Ne||O&&tt(new O)!=V)&&(tt=function(Gt){var Q=R(Gt),Ut="[object Object]"==Q?Gt.constructor:void 0,ot=Ut?N(Ut):"";if(ot)switch(ot){case Ye:return W;case _t:return H;case Rt:return be;case wt:return Ne;case lt:return V}return Q}),ne.exports=tt},36825:ne=>{ne.exports=function(y,M){return null==y?void 0:y[M]}},407:ne=>{var R=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");ne.exports=function(H){return R.test(H)}},59316:ne=>{var L=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;ne.exports=function(M){return L.test(M)}},59410:(ne,L,y)=>{var M=y(95969);ne.exports=function(){this.__data__=M?M(null):{},this.size=0}},21143:ne=>{ne.exports=function(y){var M=this.has(y)&&delete this.__data__[y];return this.size-=M?1:0,M}},604:(ne,L,y)=>{var M=y(95969),m=Object.prototype.hasOwnProperty;ne.exports=function(R){var N=this.__data__;if(M){var H=N[R];return"__lodash_hash_undefined__"===H?void 0:H}return m.call(N,R)?N[R]:void 0}},80584:(ne,L,y)=>{var M=y(95969),l=Object.prototype.hasOwnProperty;ne.exports=function(O){var R=this.__data__;return M?void 0!==R[O]:l.call(R,O)}},7792:(ne,L,y)=>{var M=y(95969);ne.exports=function(m,O){var R=this.__data__;return this.size+=this.has(m)?0:1,R[m]=M&&void 0===O?"__lodash_hash_undefined__":O,this}},62963:ne=>{var y=Object.prototype.hasOwnProperty;ne.exports=function(_){var l=_.length,m=new _.constructor(l);return l&&"string"==typeof _[0]&&y.call(_,"index")&&(m.index=_.index,m.input=_.input),m}},32143:(ne,L,y)=>{var M=y(88461),_=y(59757),l=y(83615),m=y(42282),O=y(96282);ne.exports=function(Xe,Pt,kt){var ut=Xe.constructor;switch(Pt){case"[object ArrayBuffer]":return M(Xe);case"[object Boolean]":case"[object Date]":return new ut(+Xe);case"[object DataView]":return _(Xe,kt);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return O(Xe,kt);case"[object Map]":return new ut;case"[object Number]":case"[object String]":return new ut(Xe);case"[object RegExp]":return l(Xe);case"[object Set]":return new ut;case"[object Symbol]":return m(Xe)}}},31563:(ne,L,y)=>{var M=y(60920),_=y(52398),l=y(58845);ne.exports=function(O){return"function"!=typeof O.constructor||l(O)?{}:M(_(O))}},20968:ne=>{var y=/^(?:0|[1-9]\d*)$/;ne.exports=function(_,l){var m=typeof _;return!!(l=null==l?9007199254740991:l)&&("number"==m||"symbol"!=m&&y.test(_))&&_>-1&&_%1==0&&_<l}},71100:(ne,L,y)=>{var M=y(71166),_=y(93406),l=y(20968),m=y(53867);ne.exports=function(R,N,H){if(!m(H))return!1;var j=typeof N;return!!("number"==j?_(H)&&l(N,H.length):"string"==j&&N in H)&&M(H[N],R)}},36586:ne=>{ne.exports=function(y){var M=typeof y;return"string"==M||"number"==M||"symbol"==M||"boolean"==M?"__proto__"!==y:null===y}},38466:(ne,L,y)=>{var m,M=y(93412),_=(m=/[^.]+$/.exec(M&&M.keys&&M.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"";ne.exports=function(m){return!!_&&_ in m}},58845:ne=>{var L=Object.prototype;ne.exports=function(M){var _=M&&M.constructor;return M===("function"==typeof _&&_.prototype||L)}},63391:ne=>{ne.exports=function(){this.__data__=[],this.size=0}},68971:(ne,L,y)=>{var M=y(15758),l=Array.prototype.splice;ne.exports=function(O){var R=this.__data__,N=M(R,O);return!(N<0||(N==R.length-1?R.pop():l.call(R,N,1),--this.size,0))}},18858:(ne,L,y)=>{var M=y(15758);ne.exports=function(l){var m=this.__data__,O=M(m,l);return O<0?void 0:m[O][1]}},13913:(ne,L,y)=>{var M=y(15758);ne.exports=function(l){return M(this.__data__,l)>-1}},68944:(ne,L,y)=>{var M=y(15758);ne.exports=function(l,m){var O=this.__data__,R=M(O,l);return R<0?(++this.size,O.push([l,m])):O[R][1]=m,this}},70536:(ne,L,y)=>{var M=y(41505),_=y(73545),l=y(39046);ne.exports=function(){this.size=0,this.__data__={hash:new M,map:new(l||_),string:new M}}},61502:(ne,L,y)=>{var M=y(85556);ne.exports=function(l){var m=M(this,l).delete(l);return this.size-=m?1:0,m}},94960:(ne,L,y)=>{var M=y(85556);ne.exports=function(l){return M(this,l).get(l)}},61539:(ne,L,y)=>{var M=y(85556);ne.exports=function(l){return M(this,l).has(l)}},34138:(ne,L,y)=>{var M=y(85556);ne.exports=function(l,m){var O=M(this,l),R=O.size;return O.set(l,m),this.size+=O.size==R?0:1,this}},37461:ne=>{ne.exports=function(y){var M=-1,_=Array(y.size);return y.forEach(function(l,m){_[++M]=[m,l]}),_}},95969:(ne,L,y)=>{var _=y(4153)(Object,"create");ne.exports=_},36700:(ne,L,y)=>{var _=y(93332)(Object.keys,Object);ne.exports=_},25618:ne=>{ne.exports=function(y){var M=[];if(null!=y)for(var _ in Object(y))M.push(_);return M}},70938:(ne,L,y)=>{ne=y.nmd(ne);var M=y(61138),_=L&&!L.nodeType&&L,l=_&&ne&&!ne.nodeType&&ne,O=l&&l.exports===_&&M.process,R=function(){try{return l&&l.require&&l.require("util").types||O&&O.binding&&O.binding("util")}catch(H){}}();ne.exports=R},81244:ne=>{var y=Object.prototype.toString;ne.exports=function(_){return y.call(_)}},93332:ne=>{ne.exports=function(y,M){return function(_){return y(M(_))}}},15529:(ne,L,y)=>{var M=y(81638),_=Math.max;ne.exports=function(m,O,R){return O=_(void 0===O?m.length-1:O,0),function(){for(var N=arguments,H=-1,j=_(N.length-O,0),be=Array(j);++H<j;)be[H]=N[O+H];H=-1;for(var Ne=Array(O+1);++H<O;)Ne[H]=N[H];return Ne[O]=R(be),M(m,this,Ne)}}},27038:(ne,L,y)=>{var M=y(61138),_="object"==typeof self&&self&&self.Object===Object&&self,l=M||_||Function("return this")();ne.exports=l},45959:ne=>{ne.exports=function(y,M){if(("constructor"!==M||"function"!=typeof y[M])&&"__proto__"!=M)return y[M]}},30365:ne=>{ne.exports=function(M){return this.__data__.set(M,"__lodash_hash_undefined__"),this}},58235:ne=>{ne.exports=function(y){return this.__data__.has(y)}},57673:ne=>{ne.exports=function(y){var M=-1,_=Array(y.size);return y.forEach(function(l){_[++M]=l}),_}},39009:(ne,L,y)=>{var M=y(99372),l=y(44094)(M);ne.exports=l},44094:ne=>{var M=Date.now;ne.exports=function(l){var m=0,O=0;return function(){var R=M(),N=16-(R-O);if(O=R,N>0){if(++m>=800)return arguments[0]}else m=0;return l.apply(void 0,arguments)}}},18034:(ne,L,y)=>{var M=y(73545);ne.exports=function(){this.__data__=new M,this.size=0}},37238:ne=>{ne.exports=function(y){var M=this.__data__,_=M.delete(y);return this.size=M.size,_}},54384:ne=>{ne.exports=function(y){return this.__data__.get(y)}},81450:ne=>{ne.exports=function(y){return this.__data__.has(y)}},61386:(ne,L,y)=>{var M=y(73545),_=y(39046),l=y(93177);ne.exports=function(R,N){var H=this.__data__;if(H instanceof M){var j=H.__data__;if(!_||j.length<199)return j.push([R,N]),this.size=++H.size,this;H=this.__data__=new l(j)}return H.set(R,N),this.size=H.size,this}},54299:ne=>{ne.exports=function(y,M,_){for(var l=_-1,m=y.length;++l<m;)if(y[l]===M)return l;return-1}},2150:(ne,L,y)=>{var M=y(87280),_=y(407),l=y(1879);ne.exports=function(O){return _(O)?l(O):M(O)}},51217:ne=>{var y=Function.prototype.toString;ne.exports=function(_){if(null!=_){try{return y.call(_)}catch(l){}try{return _+""}catch(l){}}return""}},87478:ne=>{var L=/\s/;ne.exports=function(M){for(var _=M.length;_--&&L.test(M.charAt(_)););return _}},1879:ne=>{var L="\\ud800-\\udfff",O="["+L+"]",R="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",N="\\ud83c[\\udffb-\\udfff]",j="[^"+L+"]",be="(?:\\ud83c[\\udde6-\\uddff]){2}",Ne="[\\ud800-\\udbff][\\udc00-\\udfff]",W="(?:"+R+"|"+N+")?",Ye="[\\ufe0e\\ufe0f]?",Rt=Ye+W+"(?:\\u200d(?:"+[j,be,Ne].join("|")+")"+Ye+W+")*",wt="(?:"+[j+R+"?",R,be,Ne,O].join("|")+")",lt=RegExp(N+"(?="+N+")|"+wt+Rt,"g");ne.exports=function(Gt){return Gt.match(lt)||[]}},58863:ne=>{var L="\\ud800-\\udfff",m="\\u2700-\\u27bf",O="a-z\\xdf-\\xf6\\xf8-\\xff",be="A-Z\\xc0-\\xd6\\xd8-\\xde",V="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ye="["+V+"]",Rt="\\d+",wt="["+m+"]",lt="["+O+"]",tt="[^"+L+V+Rt+m+O+be+"]",ot="(?:\\ud83c[\\udde6-\\uddff]){2}",Ue="[\\ud800-\\udbff][\\udc00-\\udfff]",ct="["+be+"]",Pt="(?:"+lt+"|"+tt+")",kt="(?:"+ct+"|"+tt+")",ut="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",ir="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",le="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",ce="[\\ufe0e\\ufe0f]?",je=ce+le+"(?:\\u200d(?:"+["[^"+L+"]",ot,Ue].join("|")+")"+ce+le+")*",gt="(?:"+[wt,ot,Ue].join("|")+")"+je,xr=RegExp([ct+"?"+lt+"+"+ut+"(?="+[Ye,ct,"$"].join("|")+")",kt+"+"+ir+"(?="+[Ye,ct+Pt,"$"].join("|")+")",ct+"?"+Pt+"+"+ut,ct+"+"+ir,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rt,gt].join("|"),"g");ne.exports=function(cn){return cn.match(xr)||[]}},35037:(ne,L,y)=>{var M=y(76974),l=y(17407)(function(m,O,R){return O=O.toLowerCase(),m+(R?M(O):O)});ne.exports=l},76974:(ne,L,y)=>{var M=y(41233),_=y(93890);ne.exports=function(m){return _(M(m).toLowerCase())}},43770:(ne,L,y)=>{var M=y(15820),_=y(45038);ne.exports=function(m,O,R){return void 0===R&&(R=O,O=void 0),void 0!==R&&(R=(R=_(R))==R?R:0),void 0!==O&&(O=(O=_(O))==O?O:0),M(_(m),O,R)}},37524:(ne,L,y)=>{var M=y(77007);ne.exports=function(O){return M(O,5)}},45654:ne=>{ne.exports=function(y){return function(){return y}}},75289:(ne,L,y)=>{var M=y(4068),_=y(41233),l=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,j=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");ne.exports=function(Ne){return(Ne=_(Ne))&&Ne.replace(l,M).replace(j,"")}},71166:ne=>{ne.exports=function(y,M){return y===M||y!=y&&M!=M}},80290:ne=>{ne.exports=function(y){return y}},2952:(ne,L,y)=>{var M=y(77090),_=y(27503),l=Object.prototype,m=l.hasOwnProperty,O=l.propertyIsEnumerable,R=M(function(){return arguments}())?M:function(N){return _(N)&&m.call(N,"callee")&&!O.call(N,"callee")};ne.exports=R},81690:ne=>{ne.exports=Array.isArray},93406:(ne,L,y)=>{var M=y(55836),_=y(8613);ne.exports=function(m){return null!=m&&_(m.length)&&!M(m)}},82027:(ne,L,y)=>{var M=y(93406),_=y(27503);ne.exports=function(m){return _(m)&&M(m)}},84444:(ne,L,y)=>{ne=y.nmd(ne);var M=y(27038),_=y(61711),l=L&&!L.nodeType&&L,m=l&&ne&&!ne.nodeType&&ne,R=m&&m.exports===l?M.Buffer:void 0;ne.exports=(R?R.isBuffer:void 0)||_},49977:(ne,L,y)=>{var M=y(30696);ne.exports=function(l,m){return M(l,m)}},55836:(ne,L,y)=>{var M=y(72802),_=y(53867);ne.exports=function(H){if(!_(H))return!1;var j=M(H);return"[object Function]"==j||"[object GeneratorFunction]"==j||"[object AsyncFunction]"==j||"[object Proxy]"==j}},8613:ne=>{ne.exports=function(M){return"number"==typeof M&&M>-1&&M%1==0&&M<=9007199254740991}},32e3:(ne,L,y)=>{var M=y(63434),_=y(70544),l=y(70938),m=l&&l.isMap,O=m?_(m):M;ne.exports=O},28303:ne=>{ne.exports=function(y){return null==y}},80167:(ne,L,y)=>{var M=y(72802),_=y(27503);ne.exports=function(O){return"number"==typeof O||_(O)&&"[object Number]"==M(O)}},53867:ne=>{ne.exports=function(y){var M=typeof y;return null!=y&&("object"==M||"function"==M)}},27503:ne=>{ne.exports=function(y){return null!=y&&"object"==typeof y}},82358:(ne,L,y)=>{var M=y(72802),_=y(52398),l=y(27503),N=Function.prototype.toString,H=Object.prototype.hasOwnProperty,j=N.call(Object);ne.exports=function(Ne){if(!l(Ne)||"[object Object]"!=M(Ne))return!1;var V=_(Ne);if(null===V)return!0;var W=H.call(V,"constructor")&&V.constructor;return"function"==typeof W&&W instanceof W&&N.call(W)==j}},48855:(ne,L,y)=>{var M=y(67495),_=y(70544),l=y(70938),m=l&&l.isSet,O=m?_(m):M;ne.exports=O},64871:(ne,L,y)=>{var M=y(72802),_=y(81690),l=y(27503);ne.exports=function(R){return"string"==typeof R||!_(R)&&l(R)&&"[object String]"==M(R)}},7786:(ne,L,y)=>{var M=y(72802),_=y(27503);ne.exports=function(O){return"symbol"==typeof O||_(O)&&"[object Symbol]"==M(O)}},47679:(ne,L,y)=>{var M=y(99390),_=y(70544),l=y(70938),m=l&&l.isTypedArray,O=m?_(m):M;ne.exports=O},59108:(ne,L,y)=>{var M=y(71890),_=y(92488),l=y(93406);ne.exports=function(O){return l(O)?M(O):_(O)}},42970:(ne,L,y)=>{var M=y(71890),_=y(50762),l=y(93406);ne.exports=function(O){return l(O)?M(O,!0):_(O)}},3912:(ne,L,y)=>{var M=y(9085),l=y(30906)(function(m,O,R){M(m,O,R)});ne.exports=l},33939:(ne,L,y)=>{var M=y(9085),l=y(30906)(function(m,O,R,N){M(m,O,R,N)});ne.exports=l},49122:ne=>{ne.exports=function(){}},65336:ne=>{ne.exports=function(){return[]}},61711:ne=>{ne.exports=function(){return!1}},45038:(ne,L,y)=>{var M=y(13743),_=y(53867),l=y(7786),O=/^[-+]0x[0-9a-f]+$/i,R=/^0b[01]+$/i,N=/^0o[0-7]+$/i,H=parseInt;ne.exports=function(be){if("number"==typeof be)return be;if(l(be))return NaN;if(_(be)){var Ne="function"==typeof be.valueOf?be.valueOf():be;be=_(Ne)?Ne+"":Ne}if("string"!=typeof be)return 0===be?be:+be;be=M(be);var V=R.test(be);return V||N.test(be)?H(be.slice(2),V?2:8):O.test(be)?NaN:+be}},31413:(ne,L,y)=>{var M=y(11694),_=y(42970);ne.exports=function(m){return M(m,_(m))}},41233:(ne,L,y)=>{var M=y(68166);ne.exports=function(l){return null==l?"":M(l)}},72699:(ne,L,y)=>{var M=y(83987);ne.exports=function(l){return l&&l.length?M(l):[]}},93890:(ne,L,y)=>{var _=y(66803)("toUpperCase");ne.exports=_},96590:(ne,L,y)=>{var M=y(54561),_=y(59316),l=y(41233),m=y(58863);ne.exports=function(R,N,H){return R=l(R),void 0===(N=H?void 0:N)?_(R)?m(R):M(R):R.match(N)||[]}},82958:function(ne){ne.exports=function(){"use strict";var L,y,M;function _(l,m){if(L)if(y){var O="var sharedChunk = {}; ("+L+")(sharedChunk); ("+y+")(sharedChunk);",R={};L(R),M=m(R),"undefined"!=typeof window&&(M.workerUrl=window.URL.createObjectURL(new Blob([O],{type:"text/javascript"})))}else y=m;else L=m}return _(0,function(l){function m(e,t){return e(t={exports:{}},t.exports),t.exports}var O=R;function R(e,t,r,f){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(f-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=f,this.p2x=r,this.p2y=f}R.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},R.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},R.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},R.prototype.solveCurveX=function(e,t){var r,f,d,x,S;for(void 0===t&&(t=1e-6),d=e,S=0;S<8;S++){if(x=this.sampleCurveX(d)-e,Math.abs(x)<t)return d;var P=this.sampleCurveDerivativeX(d);if(Math.abs(P)<1e-6)break;d-=x/P}if((d=e)<(r=0))return r;if(d>(f=1))return f;for(;r<f;){if(x=this.sampleCurveX(d),Math.abs(x-e)<t)return d;e>x?r=d:f=d,d=.5*(f-r)+r}return d},R.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var N=H;function H(e,t){this.x=e,this.y=t}H.prototype={clone:function(){return new H(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),f=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=f,this},_rotateAround:function(e,t){var r=Math.cos(e),f=Math.sin(e),d=t.y+f*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-f*(this.y-t.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},H.convert=function(e){return e instanceof H?e:Array.isArray(e)?new H(e[0],e[1]):e};var j="undefined"!=typeof self?self:{},be=Math.pow(2,53)-1;function Ne(e,t,r,f){var d=new O(e,t,r,f);return function(x){return d.solve(x)}}var V=Ne(.25,.1,.25,1);function W(e,t,r){return Math.min(r,Math.max(t,e))}function Ye(e,t,r){var f=r-t,d=((e-t)%f+f)%f+t;return d===t?r:d}function _t(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var f=0,d=t;f<d.length;f+=1){var x=d[f];for(var S in x)e[S]=x[S]}return e}var Rt=1;function wt(){return Rt++}function lt(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function tt(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Gt(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function Q(e,t){return-1!==e.indexOf(t,e.length-t.length)}function Ut(e,t,r){var f={};for(var d in e)f[d]=t.call(r||this,e[d],d,e);return f}function ot(e,t,r){var f={};for(var d in e)t.call(r||this,e[d],d,e)&&(f[d]=e[d]);return f}function Ue(e){return Array.isArray(e)?e.map(Ue):"object"==typeof e&&e?Ut(e,Ue):e}var ct={};function Xe(e){ct[e]||("undefined"!=typeof console&&console.warn(e),ct[e]=!0)}function Pt(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function kt(e){for(var t=0,r=0,f=e.length,d=f-1,x=void 0,S=void 0;r<f;d=r++)t+=((S=e[d]).x-(x=e[r]).x)*(x.y+S.y);return t}function ut(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function ir(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(f,d,x,S){var P=x||S;return t[d]=!P||P.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var le=null;function ce(e){if(null==le){var t=e.navigator?e.navigator.userAgent:null;le=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return le}function ae(e){try{var t=j[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var me,Ie,je,gt,xr=j.performance&&j.performance.now?j.performance.now.bind(j.performance):Date.now.bind(Date),Fr=j.requestAnimationFrame||j.mozRequestAnimationFrame||j.webkitRequestAnimationFrame||j.msRequestAnimationFrame,cn=j.cancelAnimationFrame||j.mozCancelAnimationFrame||j.webkitCancelAnimationFrame||j.msCancelAnimationFrame,Ir={now:xr,frame:function(e){var t=Fr(e);return{cancel:function(){return cn(t)}}},getImageData:function(e,t){void 0===t&&(t=0);var r=j.document.createElement("canvas"),f=r.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,f.drawImage(e,0,0,e.width,e.height),f.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return me||(me=j.document.createElement("a")),me.href=e,me.href},hardwareConcurrency:j.navigator&&j.navigator.hardwareConcurrency||4,get devicePixelRatio(){return j.devicePixelRatio},get prefersReducedMotion(){return!!j.matchMedia&&(null==Ie&&(Ie=j.matchMedia("(prefers-reduced-motion: reduce)")),Ie.matches)}},Ot={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Le={supported:!1,testSupport:function(e){!we&&gt&&(at?Re(e):je=e)}},we=!1,at=!1;function Re(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,gt),e.isContextLost())return;Le.supported=!0}catch(r){}e.deleteTexture(t),we=!0}j.document&&((gt=j.document.createElement("img")).onload=function(){je&&Re(je),je=null,at=!0},gt.onerror=function(){we=!0,je=null},gt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var qt="01",Pr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function er(e){return 0===e.indexOf("mapbox:")}Pr.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",qt,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Pr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Pr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Pr.prototype.normalizeStyleURL=function(e,t){if(!er(e))return e;var r=C(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Pr.prototype.normalizeGlyphsURL=function(e,t){if(!er(e))return e;var r=C(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Pr.prototype.normalizeSourceURL=function(e,t){if(!er(e))return e;var r=C(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},Pr.prototype.normalizeSpriteURL=function(e,t,r,f){var d=C(e);return er(e)?(d.path="/styles/v1"+d.path+"/sprite"+t+r,this._makeAPIURL(d,this._customAccessToken||f)):(d.path+=""+t+r,Y(d))},Pr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!er(e))return e;var r=C(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Ir.devicePixelRatio>=2||512===t?"@2x":"")+(Le.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var f=this._customAccessToken||function(d){for(var x=0,S=d;x<S.length;x+=1){var P=S[x].match(/^access_token=(.*)$/);if(P)return P[1]}return null}(r.params)||Ot.ACCESS_TOKEN;return Ot.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,f)},Pr.prototype.canonicalizeTileURL=function(e,t){var r=C(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var f="mapbox://tiles/";f+=r.path.replace("/v4/","");var d=r.params;return t&&(d=d.filter(function(x){return!x.match(/^access_token=/)})),d.length&&(f+="?"+d.join("&")),f},Pr.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&er(t),f=[],d=0,x=e.tiles||[];d<x.length;d+=1){var S=x[d];Nr(S)?f.push(this.canonicalizeTileURL(S,r)):f.push(S)}return f},Pr.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",f=C(Ot.API_URL);if(e.protocol=f.protocol,e.authority=f.authority,"http"===e.protocol){var d=e.params.indexOf("secure");d>=0&&e.params.splice(d,1)}if("/"!==f.path&&(e.path=""+f.path+e.path),!Ot.REQUIRE_ACCESS_TOKEN)return Y(e);if(!(t=t||Ot.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(x){return-1===x.indexOf("access_token")}),e.params.push("access_token="+t),Y(e)};var hr=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Nr(e){return hr.test(e)}var $r=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function C(e){var t=e.match($r);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Y(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ge(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(j.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var nt=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};nt.prototype.getStorageKey=function(e){var t,r=Ge(Ot.ACCESS_TOKEN);return t=r&&r.u?j.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(f,d){return String.fromCharCode(Number("0x"+d))})):Ot.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},nt.prototype.fetchEventData=function(){var e=ae("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var f=j.localStorage.getItem(t);f&&(this.eventData=JSON.parse(f));var d=j.localStorage.getItem(r);d&&(this.anonId=d)}catch(x){Xe("Unable to read from LocalStorage")}},nt.prototype.saveEventData=function(){var e=ae("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{j.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&j.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(f){Xe("Unable to write to LocalStorage")}},nt.prototype.processRequests=function(e){},nt.prototype.postEvent=function(e,t,r,f){var d=this;if(Ot.EVENTS_URL){var x=C(Ot.EVENTS_URL);x.params.push("access_token="+(f||Ot.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:qt,userId:this.anonId},P=t?_t(S,t):S,z={url:Y(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=Ei(z,function(J){d.pendingRequest=null,r(J),d.saveEventData(),d.processRequests(f)})}},nt.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var xt,Dt,Z=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,f,d,x){this.skuToken=d,(Ot.EVENTS_URL&&x||Ot.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(S){return er(S)||Nr(S)}))&&this.queueRequest({id:f,timestamp:Date.now()},x)},t.prototype.processRequests=function(r){var f=this;if(!this.pendingRequest&&0!==this.queue.length){var d=this.queue.shift(),x=d.id,S=d.timestamp;x&&this.success[x]||(this.anonId||this.fetchEventData(),tt(this.anonId)||(this.anonId=lt()),this.postEvent(S,{skuToken:this.skuToken},function(P){P||x&&(f.success[x]=!0)},r))}},t}(nt),Ze=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,f){Ot.EVENTS_URL&&Ot.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(d){return er(d)||Nr(d)})&&this.queueRequest(Date.now(),f)},t.prototype.processRequests=function(r){var f=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var d=Ge(Ot.ACCESS_TOKEN),x=d?d.u:Ot.ACCESS_TOKEN,S=x!==this.eventData.tokenU;tt(this.anonId)||(this.anonId=lt(),S=!0);var P=this.queue.shift();if(this.eventData.lastSuccess){var z=new Date(this.eventData.lastSuccess),J=new Date(P),ee=(P-this.eventData.lastSuccess)/864e5;S=S||ee>=1||ee<-1||z.getDate()!==J.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(P,{"enabled.telemetry":!1},function(ue){ue||(f.eventData.lastSuccess=P,f.eventData.tokenU=x)},r)}},t}(nt)),Et=Ze.postTurnstileEvent.bind(Ze),Mt=new Z,Jt=Mt.postMapLoadEvent.bind(Mt),Tr=500,mr=50;function Yt(){j.caches&&!xt&&(xt=j.caches.open("mapbox-tiles"))}function gr(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var sr,dr=1/0;function mn(){return null==sr&&(sr=j.OffscreenCanvas&&new j.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof j.createImageBitmap),sr}var On={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(On);var si,ai,mi=function(e){function t(r,f,d){401===f&&Nr(d)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=f,this.url=d,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),hi=ut()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===j.location.protocol?j.parent:j).location.href},Yi=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(hi())&&!/^\w+:/.test(r))){if(j.fetch&&j.Request&&j.AbortController&&j.Request.prototype.hasOwnProperty("signal"))return function(f,d){var x,S=new j.AbortController,P=new j.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:hi(),signal:S.signal}),z=!1,J=!1,ee=(x=P.url).indexOf("sku=")>0&&Nr(x);"json"===f.type&&P.headers.set("Accept","application/json");var ue=function(Se,qe,Je){if(!J){if(Se&&"SecurityError"!==Se.message&&Xe(Se),qe&&Je)return ye(qe);var Ct=Date.now();j.fetch(P).then(function(st){if(st.ok){var zt=ee?st.clone():null;return ye(st,zt,Ct)}return d(new mi(st.statusText,st.status,f.url))}).catch(function(st){20!==st.code&&d(new Error(st.message))})}},ye=function(Se,qe,Je){("arrayBuffer"===f.type?Se.arrayBuffer():"json"===f.type?Se.json():Se.text()).then(function(Ct){J||(qe&&Je&&function(st,zt,Qt){if(Yt(),xt){var yr={status:zt.status,statusText:zt.statusText,headers:new j.Headers};zt.headers.forEach(function(Rr,nn){return yr.headers.set(nn,Rr)});var Sr=ir(zt.headers.get("Cache-Control")||"");Sr["no-store"]||(Sr["max-age"]&&yr.headers.set("Expires",new Date(Qt+1e3*Sr["max-age"]).toUTCString()),new Date(yr.headers.get("Expires")).getTime()-Qt<42e4||function(Rr,nn){if(void 0===Dt)try{new Response(new ReadableStream),Dt=!0}catch(gn){Dt=!1}Dt?nn(Rr.body):Rr.blob().then(nn)}(zt,function(Rr){var nn=new j.Response(Rr,yr);Yt(),xt&&xt.then(function(gn){return gn.put(gr(st.url),nn)}).catch(function(gn){return Xe(gn.message)})}))}}(P,qe,Je),z=!0,d(null,Ct,Se.headers.get("Cache-Control"),Se.headers.get("Expires")))}).catch(function(Ct){J||d(new Error(Ct.message))})};return ee?function(Se,qe){if(Yt(),!xt)return qe(null);var Je=gr(Se.url);xt.then(function(Ct){Ct.match(Je).then(function(st){var zt=function(Qt){if(!Qt)return!1;var yr=new Date(Qt.headers.get("Expires")||0),Sr=ir(Qt.headers.get("Cache-Control")||"");return yr>Date.now()&&!Sr["no-cache"]}(st);Ct.delete(Je),zt&&Ct.put(Je,st.clone()),qe(null,st,zt)}).catch(qe)}).catch(qe)}(P,ue):ue(null,null),{cancel:function(){J=!0,z||S.abort()}}}(e,t);if(ut()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(f,d){var x=new j.XMLHttpRequest;for(var S in x.open(f.method||"GET",f.url,!0),"arrayBuffer"===f.type&&(x.responseType="arraybuffer"),f.headers)x.setRequestHeader(S,f.headers[S]);return"json"===f.type&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials="include"===f.credentials,x.onerror=function(){d(new Error(x.statusText))},x.onload=function(){if((x.status>=200&&x.status<300||0===x.status)&&null!==x.response){var P=x.response;if("json"===f.type)try{P=JSON.parse(x.response)}catch(z){return d(z)}d(null,P,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else d(new mi(x.statusText,x.status,f.url))},x.send(f.body),{cancel:function(){return x.abort()}}}(e,t)},Pi=function(e,t){return Yi(_t(e,{type:"arrayBuffer"}),t)},Ei=function(e,t){return Yi(_t(e,{method:"POST"}),t)},re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";si=[],ai=0;var ve=function(e,t){if(Le.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ai>=Ot.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return si.push(r),r}ai++;var f=!1,d=function(){if(!f)for(f=!0,ai--;si.length&&ai<Ot.MAX_PARALLEL_IMAGE_REQUESTS;){var S=si.shift();S.cancelled||(S.cancel=ve(S.requestParameters,S.callback).cancel)}},x=Pi(e,function(S,P,z,J){var ue,ye;d(),S?t(S):P&&(mn()?(ue=t,ye=new j.Blob([new Uint8Array(P)],{type:"image/png"}),j.createImageBitmap(ye).then(function(Se){ue(null,Se)}).catch(function(Se){ue(new Error("Could not load image because of "+Se.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(ee,ue,ye,Se){var qe=new j.Image,Je=j.URL;qe.onload=function(){ue(null,qe),Je.revokeObjectURL(qe.src),qe.onload=null,j.requestAnimationFrame(function(){qe.src=re})},qe.onerror=function(){return ue(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Ct=new j.Blob([new Uint8Array(ee)],{type:"image/png"});qe.cacheControl=ye,qe.expires=Se,qe.src=ee.byteLength?Je.createObjectURL(Ct):re}(P,t,z,J))});return{cancel:function(){x.cancel(),d()}}};function _e(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function G(e,t,r){if(r&&r[e]){var f=r[e].indexOf(t);-1!==f&&r[e].splice(f,1)}}var oe=function(e,t){void 0===t&&(t={}),_t(this,t),this.type=e},xe=function(e){function t(r,f){void 0===f&&(f={}),e.call(this,"error",_t({error:r},f))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(oe),Oe=function(){};Oe.prototype.on=function(e,t){return this._listeners=this._listeners||{},_e(e,t,this._listeners),this},Oe.prototype.off=function(e,t){return G(e,t,this._listeners),G(e,t,this._oneTimeListeners),this},Oe.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},_e(e,t,this._oneTimeListeners),this},Oe.prototype.fire=function(e,t){"string"==typeof e&&(e=new oe(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var f=0,d=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];f<d.length;f+=1)d[f].call(this,e);for(var x=0,S=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];x<S.length;x+=1){var P=S[x];G(r,P,this._oneTimeListeners),P.call(this,e)}var z=this._eventedParent;z&&(_t(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),z.fire(e))}else e instanceof xe&&console.error(e.error);return this},Oe.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Oe.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var pe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ae=function(e,t,r,f){this.message=(e?e+": ":"")+r,f&&(this.identifier=f),null!=t&&t.__line__&&(this.line=t.__line__)};function Tt(e){var t=e.value;return t?[new Ae(e.key,t,"constants have been deprecated as of v8")]:[]}function wr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var f=0,d=t;f<d.length;f+=1){var x=d[f];for(var S in x)e[S]=x[S]}return e}function Kt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function ar(e){if(Array.isArray(e))return e.map(ar);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=ar(e[r]);return t}return Kt(e)}var Br=function(e){function t(r,f){e.call(this,f),this.message=f,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Rn=function(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var r=0,f=t;r<f.length;r+=1){var d=f[r];this.bindings[d[0]]=d[1]}};Rn.prototype.concat=function(e){return new Rn(this,e)},Rn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Rn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Pn={kind:"null"},rr={kind:"number"},Sn={kind:"string"},an={kind:"boolean"},fn={kind:"color"},Di={kind:"object"},_n={kind:"value"},Oi={kind:"collator"},ta={kind:"formatted"},oi={kind:"resolvedImage"};function Ji(e,t){return{kind:"array",itemType:e,N:t}}function ji(e){if("array"===e.kind){var t=ji(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}return e.kind}var Ti=[Pn,rr,Sn,an,fn,ta,Di,Ji(_n),oi];function _a(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!_a(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var r=0,f=Ti;r<f.length;r+=1)if(!_a(f[r],t))return null}return"Expected "+ji(e)+" but found "+ji(t)+" instead."}function Ia(e,t){return t.some(function(r){return r.kind===e.kind})}function Gi(e,t){return t.some(function(r){return"null"===r?null===e:"array"===r?Array.isArray(e):"object"===r?e&&!Array.isArray(e)&&"object"==typeof e:r===typeof e})}var Ni=m(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function f(P){return(P=Math.round(P))<0?0:P>255?255:P}function d(P){return f("%"===P[P.length-1]?parseFloat(P)/100*255:parseInt(P))}function x(P){return(z="%"===P[P.length-1]?parseFloat(P)/100:parseFloat(P))<0?0:z>1?1:z;var z}function S(P,z,J){return J<0?J+=1:J>1&&(J-=1),6*J<1?P+(z-P)*J*6:2*J<1?z:3*J<2?P+(z-P)*(2/3-J)*6:P}try{t.parseCSSColor=function(P){var z,J=P.replace(/ /g,"").toLowerCase();if(J in r)return r[J].slice();if("#"===J[0])return 4===J.length?(z=parseInt(J.substr(1),16))>=0&&z<=4095?[(3840&z)>>4|(3840&z)>>8,240&z|(240&z)>>4,15&z|(15&z)<<4,1]:null:7===J.length&&(z=parseInt(J.substr(1),16))>=0&&z<=16777215?[(16711680&z)>>16,(65280&z)>>8,255&z,1]:null;var ee=J.indexOf("("),ue=J.indexOf(")");if(-1!==ee&&ue+1===J.length){var ye=J.substr(0,ee),Se=J.substr(ee+1,ue-(ee+1)).split(","),qe=1;switch(ye){case"rgba":if(4!==Se.length)return null;qe=x(Se.pop());case"rgb":return 3!==Se.length?null:[d(Se[0]),d(Se[1]),d(Se[2]),qe];case"hsla":if(4!==Se.length)return null;qe=x(Se.pop());case"hsl":if(3!==Se.length)return null;var Je=(parseFloat(Se[0])%360+360)%360/360,Ct=x(Se[1]),st=x(Se[2]),zt=st<=.5?st*(Ct+1):st+Ct-st*Ct,Qt=2*st-zt;return[f(255*S(Qt,zt,Je+1/3)),f(255*S(Qt,zt,Je)),f(255*S(Qt,zt,Je-1/3)),qe];default:return null}}return null}}catch(P){}}).parseCSSColor,Xi=function(e,t,r,f){void 0===f&&(f=1),this.r=e,this.g=t,this.b=r,this.a=f};Xi.parse=function(e){if(e){if(e instanceof Xi)return e;if("string"==typeof e){var t=Ni(e);if(t)return new Xi(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Xi.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],f=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+f+")"},Xi.prototype.toArray=function(){var e=this.a;return 0===e?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Xi.black=new Xi(0,0,0,1),Xi.white=new Xi(1,1,1,1),Xi.transparent=new Xi(0,0,0,0),Xi.red=new Xi(1,0,0,1);var to=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};to.prototype.compare=function(e,t){return this.collator.compare(e,t)},to.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ho=function(e,t,r,f,d){this.text=e,this.image=t,this.scale=r,this.fontStack=f,this.textColor=d},Za=function(e){this.sections=e};Za.fromString=function(e){return new Za([new Ho(e,null,null,null,null)])},Za.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length})},Za.factory=function(e){return e instanceof Za?e:Za.fromString(e)},Za.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(e){return e.text}).join("")},Za.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var f=r[t];if(f.image)e.push(["image",f.image.name]);else{e.push(f.text);var d={};f.fontStack&&(d["text-font"]=["literal",f.fontStack.split(",")]),f.scale&&(d["font-scale"]=f.scale),f.textColor&&(d["text-color"]=["rgba"].concat(f.textColor.toArray())),e.push(d)}}return e};var Wi=function(e){this.name=e.name,this.available=e.available};function va(e,t,r,f){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===f||"number"==typeof f&&f>=0&&f<=1?null:"Invalid rgba value ["+[e,t,r,f].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof f?[e,t,r,f]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function wu(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Xi||e instanceof to||e instanceof Za||e instanceof Wi)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!wu(r[t]))return!1;return!0}if("object"==typeof e){for(var f in e)if(!wu(e[f]))return!1;return!0}return!1}function Da(e){if(null===e)return Pn;if("string"==typeof e)return Sn;if("boolean"==typeof e)return an;if("number"==typeof e)return rr;if(e instanceof Xi)return fn;if(e instanceof to)return Oi;if(e instanceof Za)return ta;if(e instanceof Wi)return oi;if(Array.isArray(e)){for(var t,r=e.length,f=0,d=e;f<d.length;f+=1){var x=Da(d[f]);if(t){if(t===x)continue;t=_n;break}t=x}return Ji(t||_n,r)}return Di}function qo(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Xi||e instanceof Za||e instanceof Wi?e.toString():JSON.stringify(e)}Wi.prototype.toString=function(){return this.name},Wi.fromString=function(e){return e?new Wi({name:e,available:!1}):null},Wi.prototype.serialize=function(){return["image",this.name]};var Bi=function(e,t){this.type=e,this.value=t};Bi.parse=function(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!wu(e[1]))return t.error("invalid value");var r=e[1],f=Da(r),d=t.expectedType;return"array"!==f.kind||0!==f.N||!d||"array"!==d.kind||"number"==typeof d.N&&0!==d.N||(f=d),new Bi(f,r)},Bi.prototype.evaluate=function(){return this.value},Bi.prototype.eachChild=function(){},Bi.prototype.outputDefined=function(){return!0},Bi.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Xi?["rgba"].concat(this.value.toArray()):this.value instanceof Za?this.value.serialize():this.value};var ra=function(e){this.name="ExpressionEvaluationError",this.message=e};ra.prototype.toJSON=function(){return this.message};var bo={string:Sn,number:rr,boolean:an,object:Di},ma=function(e,t){this.type=e,this.args=t};ma.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,f=1,d=e[0];if("array"===d){var x,S;if(e.length>2){var P=e[1];if("string"!=typeof P||!(P in bo)||"object"===P)return t.error('The item type argument of "array" must be one of string, number, boolean',1);x=bo[P],f++}else x=_n;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);S=e[2],f++}r=Ji(x,S)}else r=bo[d];for(var z=[];f<e.length;f++){var J=t.parse(e[f],f,_n);if(!J)return null;z.push(J)}return new ma(r,z)},ma.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!_a(this.type,Da(r)))return r;if(t===this.args.length-1)throw new ra("Expected value to be of type "+ji(this.type)+", but found "+ji(Da(r))+" instead.")}return null},ma.prototype.eachChild=function(e){this.args.forEach(e)},ma.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ma.prototype.serialize=function(){var e=this.type,t=[e.kind];if("array"===e.kind){var r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);var f=e.N;("number"==typeof f||this.args.length>1)&&t.push(f)}}return t.concat(this.args.map(function(d){return d.serialize()}))};var vo=function(e){this.type=ta,this.sections=e};vo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");for(var f=[],d=!1,x=1;x<=e.length-1;++x){var S=e[x];if(d&&"object"==typeof S&&!Array.isArray(S)){d=!1;var P=null;if(S["font-scale"]&&!(P=t.parse(S["font-scale"],1,rr)))return null;var z=null;if(S["text-font"]&&!(z=t.parse(S["text-font"],1,Ji(Sn))))return null;var J=null;if(S["text-color"]&&!(J=t.parse(S["text-color"],1,fn)))return null;var ee=f[f.length-1];ee.scale=P,ee.font=z,ee.textColor=J}else{var ue=t.parse(e[x],1,_n);if(!ue)return null;var ye=ue.type.kind;if("string"!==ye&&"value"!==ye&&"null"!==ye&&"resolvedImage"!==ye)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,f.push({content:ue,scale:null,font:null,textColor:null})}}return new vo(f)},vo.prototype.evaluate=function(e){return new Za(this.sections.map(function(t){var r=t.content.evaluate(e);return Da(r)===oi?new Ho("",r,null,null,null):new Ho(qo(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},vo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var f=r[t];e(f.content),f.scale&&e(f.scale),f.font&&e(f.font),f.textColor&&e(f.textColor)}},vo.prototype.outputDefined=function(){return!1},vo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var f=r[t];e.push(f.content.serialize());var d={};f.scale&&(d["font-scale"]=f.scale.serialize()),f.font&&(d["text-font"]=f.font.serialize()),f.textColor&&(d["text-color"]=f.textColor.serialize()),e.push(d)}return e};var Fo=function(e){this.type=oi,this.input=e};Fo.parse=function(e,t){if(2!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Sn);return r?new Fo(r):t.error("No image name provided.")},Fo.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Wi.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},Fo.prototype.eachChild=function(e){e(this.input)},Fo.prototype.outputDefined=function(){return!1},Fo.prototype.serialize=function(){return["image",this.input.serialize()]};var Ls={"to-boolean":an,"to-color":fn,"to-number":rr,"to-string":Sn},aa=function(e,t){this.type=e,this.args=t};aa.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");for(var f=Ls[r],d=[],x=1;x<e.length;x++){var S=t.parse(e[x],x,_n);if(!S)return null;d.push(S)}return new aa(f,d)},aa.prototype.evaluate=function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){for(var t,r,f=0,d=this.args;f<d.length;f+=1){if(r=null,(t=d[f].evaluate(e))instanceof Xi)return t;if("string"==typeof t){var x=e.parseColor(t);if(x)return x}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":va(t[0],t[1],t[2],t[3])))return new Xi(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ra(r||"Could not parse color from value '"+("string"==typeof t?t:String(JSON.stringify(t)))+"'")}if("number"===this.type.kind){for(var S=null,P=0,z=this.args;P<z.length;P+=1){if(null===(S=z[P].evaluate(e)))return 0;var J=Number(S);if(!isNaN(J))return J}throw new ra("Could not convert "+JSON.stringify(S)+" to number.")}return"formatted"===this.type.kind?Za.fromString(qo(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Wi.fromString(qo(this.args[0].evaluate(e))):qo(this.args[0].evaluate(e))},aa.prototype.eachChild=function(e){this.args.forEach(e)},aa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},aa.prototype.serialize=function(){if("formatted"===this.type.kind)return new vo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Fo(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Jo=["Unknown","Point","LineString","Polygon"],Ma=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ma.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ma.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Jo[this.feature.type]:this.feature.type:null},Ma.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ma.prototype.canonicalID=function(){return this.canonical},Ma.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ma.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Xi.parse(e)),t};var Ya=function(e,t,r,f){this.name=e,this.type=t,this._evaluate=r,this.args=f};Ya.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Ya.prototype.eachChild=function(e){this.args.forEach(e)},Ya.prototype.outputDefined=function(){return!1},Ya.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Ya.parse=function(e,t){var r,f=e[0],d=Ya.definitions[f];if(!d)return t.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0);for(var x=Array.isArray(d)?d[0]:d.type,S=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,P=S.filter(function(fi){var Zn=fi[0];return!Array.isArray(Zn)||Zn.length===e.length-1}),z=null,J=0,ee=P;J<ee.length;J+=1){var ue=ee[J],ye=ue[0],Se=ue[1];z=new ks(t.registry,t.path,null,t.scope);for(var qe=[],Je=!1,Ct=1;Ct<e.length;Ct++){var st=e[Ct],zt=Array.isArray(ye)?ye[Ct-1]:ye.type,Qt=z.parse(st,1+qe.length,zt);if(!Qt){Je=!0;break}qe.push(Qt)}if(!Je)if(Array.isArray(ye)&&ye.length!==qe.length)z.error("Expected "+ye.length+" arguments, but found "+qe.length+" instead.");else{for(var yr=0;yr<qe.length;yr++){var Sr=Array.isArray(ye)?ye[yr]:ye.type,Rr=qe[yr];z.concat(yr+1).checkSubtype(Sr,Rr.type)}if(0===z.errors.length)return new Ya(f,x,Se,qe)}}if(1===P.length)(r=t.errors).push.apply(r,z.errors);else{for(var nn=(P.length?P:S).map(function(fi){var Zn;return Zn=fi[0],Array.isArray(Zn)?"("+Zn.map(ji).join(", ")+")":"("+ji(Zn.type)+"...)"}).join(" | "),gn=[],ii=1;ii<e.length;ii++){var Bn=t.parse(e[ii],1+gn.length);if(!Bn)return null;gn.push(ji(Bn.type))}t.error("Expected arguments of type "+nn+", but found ("+gn.join(", ")+") instead.")}return null},Ya.register=function(e,t){for(var r in Ya.definitions=t,t)e[r]=Ya};var $o=function(e,t,r){this.type=Oi,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function Na(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Ee(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Ve(e,t){var r=(180+e[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(r*d*8192),Math.round(f*d*8192)]}function St(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function or(e,t){for(var r,f,d,x,S,P,z,J=!1,ee=0,ue=t.length;ee<ue;ee++)for(var ye=t[ee],Se=0,qe=ye.length;Se<qe-1;Se++){if((x=(r=e)[0]-(f=ye[Se])[0])*(z=r[1]-(d=ye[Se+1])[1])-(P=r[0]-d[0])*(S=r[1]-f[1])==0&&x*P<=0&&S*z<=0)return!1;St(e,ye[Se],ye[Se+1])&&(J=!J)}return J}function Yr(e,t){for(var r=0;r<t.length;r++)if(or(e,t[r]))return!0;return!1}function $n(e,t,r,f){var d=f[0]-r[0],x=f[1]-r[1],S=(e[0]-r[0])*x-d*(e[1]-r[1]),P=(t[0]-r[0])*x-d*(t[1]-r[1]);return S>0&&P<0||S<0&&P>0}function xi(e,t,r){for(var f=0,d=r;f<d.length;f+=1)for(var x=d[f],S=0;S<x.length-1;++S)if((ue=[(ee=x[S+1])[0]-(J=x[S])[0],ee[1]-J[1]])[0]*(ye=[(z=t)[0]-(P=e)[0],z[1]-P[1]])[1]-ue[1]*ye[0]!=0&&$n(P,z,J,ee)&&$n(J,ee,P,z))return!0;var P,z,J,ee,ue,ye;return!1}function lo(e,t){for(var r=0;r<e.length;++r)if(!or(e[r],t))return!1;for(var f=0;f<e.length-1;++f)if(xi(e[f],e[f+1],t))return!1;return!0}function ro(e,t){for(var r=0;r<t.length;r++)if(lo(e,t[r]))return!0;return!1}function co(e,t,r){for(var f=[],d=0;d<e.length;d++){for(var x=[],S=0;S<e[d].length;S++){var P=Ve(e[d][S],r);Na(t,P),x.push(P)}f.push(x)}return f}function ps(e,t,r){for(var f=[],d=0;d<e.length;d++){var x=co(e[d],t,r);f.push(x)}return f}function du(e,t,r,f){if(e[0]<r[0]||e[0]>r[2]){var d=.5*f,x=e[0]-r[0]>d?-f:r[0]-e[0]>d?f:0;0===x&&(x=e[0]-r[2]>d?-f:r[2]-e[0]>d?f:0),e[0]+=x}Na(t,e)}function Eu(e,t,r,f){for(var d=8192*Math.pow(2,f.z),x=[8192*f.x,8192*f.y],S=[],P=0,z=e;P<z.length;P+=1)for(var J=0,ee=z[P];J<ee.length;J+=1){var ue=ee[J],ye=[ue.x+x[0],ue.y+x[1]];du(ye,t,r,d),S.push(ye)}return S}function fl(e,t,r,f){for(var d,x=8192*Math.pow(2,f.z),S=[8192*f.x,8192*f.y],P=[],z=0,J=e;z<J.length;z+=1){for(var ee=[],ue=0,ye=J[z];ue<ye.length;ue+=1){var Se=ye[ue],qe=[Se.x+S[0],Se.y+S[1]];Na(t,qe),ee.push(qe)}P.push(ee)}if(t[2]-t[0]<=x/2){(d=t)[0]=d[1]=1/0,d[2]=d[3]=-1/0;for(var Je=0,Ct=P;Je<Ct.length;Je+=1)for(var st=0,zt=Ct[Je];st<zt.length;st+=1)du(zt[st],t,r,x)}return P}$o.parse=function(e,t){if(2!==e.length)return t.error("Expected one argument.");var r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");var f=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,an);if(!f)return null;var d=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,an);if(!d)return null;var x=null;return r.locale&&!(x=t.parse(r.locale,1,Sn))?null:new $o(f,d,x)},$o.prototype.evaluate=function(e){return new to(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},$o.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},$o.prototype.outputDefined=function(){return!1},$o.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Wo=function(e,t){this.type=an,this.geojson=e,this.geometries=t};function Qo(e){if(e instanceof Ya&&("get"===e.name&&1===e.args.length||"feature-state"===e.name||"has"===e.name&&1===e.args.length||"properties"===e.name||"geometry-type"===e.name||"id"===e.name||/^filter-/.test(e.name))||e instanceof Wo)return!1;var t=!0;return e.eachChild(function(r){t&&!Qo(r)&&(t=!1)}),t}function Lo(e){if(e instanceof Ya&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild(function(r){t&&!Lo(r)&&(t=!1)}),t}function es(e,t){if(e instanceof Ya&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(f){r&&!es(f,t)&&(r=!1)}),r}Wo.parse=function(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(wu(e[1])){var r=e[1];if("FeatureCollection"===r.type)for(var f=0;f<r.features.length;++f){var d=r.features[f].geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new Wo(r,r.features[f].geometry)}else if("Feature"===r.type){var x=r.geometry.type;if("Polygon"===x||"MultiPolygon"===x)return new Wo(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Wo(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Wo.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(t,r){var f=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],x=t.canonicalID();if("Polygon"===r.type){var S=co(r.coordinates,d,x),P=Eu(t.geometry(),f,d,x);if(!Ee(f,d))return!1;for(var z=0,J=P;z<J.length;z+=1)if(!or(J[z],S))return!1}if("MultiPolygon"===r.type){var ee=ps(r.coordinates,d,x),ue=Eu(t.geometry(),f,d,x);if(!Ee(f,d))return!1;for(var ye=0,Se=ue;ye<Se.length;ye+=1)if(!Yr(Se[ye],ee))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(t,r){var f=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],x=t.canonicalID();if("Polygon"===r.type){var S=co(r.coordinates,d,x),P=fl(t.geometry(),f,d,x);if(!Ee(f,d))return!1;for(var z=0,J=P;z<J.length;z+=1)if(!lo(J[z],S))return!1}if("MultiPolygon"===r.type){var ee=ps(r.coordinates,d,x),ue=fl(t.geometry(),f,d,x);if(!Ee(f,d))return!1;for(var ye=0,Se=ue;ye<Se.length;ye+=1)if(!ro(Se[ye],ee))return!1}return!0}(e,this.geometries)}return!1},Wo.prototype.eachChild=function(){},Wo.prototype.outputDefined=function(){return!0},Wo.prototype.serialize=function(){return["within",this.geojson]};var ts=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};ts.parse=function(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new ts(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},ts.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},ts.prototype.eachChild=function(){},ts.prototype.outputDefined=function(){return!1},ts.prototype.serialize=function(){return["var",this.name]};var ks=function(e,t,r,f,d){void 0===t&&(t=[]),void 0===f&&(f=new Rn),void 0===d&&(d=[]),this.registry=e,this.path=t,this.key=t.map(function(x){return"["+x+"]"}).join(""),this.scope=f,this.errors=d,this.expectedType=r};function Qs(e,t){for(var r,f=e.length-1,d=0,x=f,S=0;d<=x;)if((r=e[S=Math.floor((d+x)/2)])<=t){if(S===f||t<e[S+1])return S;d=S+1}else{if(!(r>t))throw new ra("Input is not a number.");x=S-1}return 0}ks.prototype.parse=function(e,t,r,f,d){return void 0===d&&(d={}),t?this.concat(t,r,f)._parse(e,d):this._parse(e,d)},ks.prototype._parse=function(e,t){function r(J,ee,ue){return"assert"===ue?new ma(ee,[J]):"coerce"===ue?new aa(ee,[J]):J}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var f=e[0];if("string"!=typeof f)return this.error("Expression name must be a string, but found "+typeof f+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var d=this.registry[f];if(d){var x=d.parse(e,this);if(!x)return null;if(this.expectedType){var S=this.expectedType,P=x.type;if("string"!==S.kind&&"number"!==S.kind&&"boolean"!==S.kind&&"object"!==S.kind&&"array"!==S.kind||"value"!==P.kind)if("color"!==S.kind&&"formatted"!==S.kind&&"resolvedImage"!==S.kind||"value"!==P.kind&&"string"!==P.kind){if(this.checkSubtype(S,P))return null}else x=r(x,S,t.typeAnnotation||"coerce");else x=r(x,S,t.typeAnnotation||"assert")}if(!(x instanceof Bi)&&"resolvedImage"!==x.type.kind&&function J(ee){if(ee instanceof ts)return J(ee.boundExpression);if(ee instanceof Ya&&"error"===ee.name||ee instanceof $o||ee instanceof Wo)return!1;var ue=ee instanceof aa||ee instanceof ma,ye=!0;return ee.eachChild(function(Se){ye=ue?ye&&J(Se):ye&&Se instanceof Bi}),!!ye&&Qo(ee)&&es(ee,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(x)){var z=new Ma;try{x=new Bi(x.type,x.evaluate(z))}catch(J){return this.error(J.message),null}}return x}return this.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},ks.prototype.concat=function(e,t,r){var f="number"==typeof e?this.path.concat(e):this.path,d=r?this.scope.concat(r):this.scope;return new ks(this.registry,f,t||null,d,this.errors)},ks.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var f=""+this.key+t.map(function(d){return"["+d+"]"}).join("");this.errors.push(new Br(f,e))},ks.prototype.checkSubtype=function(e,t){var r=_a(e,t);return r&&this.error(r),r};var gs=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var f=0,d=r;f<d.length;f+=1){var x=d[f],S=x[1];this.labels.push(x[0]),this.outputs.push(S)}};function Oa(e,t,r){return e*(1-r)+t*r}gs.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,rr);if(!r)return null;var f=[],d=null;t.expectedType&&"value"!==t.expectedType.kind&&(d=t.expectedType);for(var x=1;x<e.length;x+=2){var S=1===x?-1/0:e[x],P=e[x+1],z=x,J=x+1;if("number"!=typeof S)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(f.length&&f[f.length-1][0]>=S)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);var ee=t.parse(P,J,d);if(!ee)return null;d=d||ee.type,f.push([S,ee])}return new gs(d,r,f)},gs.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var f=this.input.evaluate(e);if(f<=t[0])return r[0].evaluate(e);var d=t.length;return f>=t[d-1]?r[d-1].evaluate(e):r[Qs(t,f)].evaluate(e)},gs.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},gs.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},gs.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var ko=Object.freeze({__proto__:null,number:Oa,color:function(e,t,r){return new Xi(Oa(e.r,t.r,r),Oa(e.g,t.g,r),Oa(e.b,t.b,r),Oa(e.a,t.a,r))},array:function(e,t,r){return e.map(function(f,d){return Oa(f,t[d],r)})}}),Ol=6/29*3*(6/29),Ll=Math.PI/180,kl=180/Math.PI;function wc(e){return e>.008856451679035631?Math.pow(e,1/3):e/Ol+4/29}function Rl(e){return e>6/29?e*e*e:Ol*(e-4/29)}function hl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function eu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Dl(e){var t=eu(e.r),r=eu(e.g),f=eu(e.b),d=wc((.4124564*t+.3575761*r+.1804375*f)/.95047),x=wc((.2126729*t+.7151522*r+.072175*f)/1);return{l:116*x-16,a:500*(d-x),b:200*(x-wc((.0193339*t+.119192*r+.9503041*f)/1.08883)),alpha:e.a}}function g(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,f=isNaN(e.b)?t:t-e.b/200;return t=1*Rl(t),r=.95047*Rl(r),f=1.08883*Rl(f),new Xi(hl(3.2404542*r-1.5371385*t-.4985314*f),hl(-.969266*r+1.8760108*t+.041556*f),hl(.0556434*r-.2040259*t+1.0572252*f),e.alpha)}function T(e,t,r){var f=t-e;return e+r*(f>180||f<-180?f-360*Math.round(f/360):f)}var K={forward:Dl,reverse:g,interpolate:function(e,t,r){return{l:Oa(e.l,t.l,r),a:Oa(e.a,t.a,r),b:Oa(e.b,t.b,r),alpha:Oa(e.alpha,t.alpha,r)}}},D={forward:function(e){var t=Dl(e),r=t.l,f=t.a,d=t.b,x=Math.atan2(d,f)*kl;return{h:x<0?x+360:x,c:Math.sqrt(f*f+d*d),l:r,alpha:e.a}},reverse:function(e){var t=e.h*Ll,r=e.c;return g({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:T(e.h,t.h,r),c:Oa(e.c,t.c,r),l:Oa(e.l,t.l,r),alpha:Oa(e.alpha,t.alpha,r)}}},ge=Object.freeze({__proto__:null,lab:K,hcl:D}),Fe=function(e,t,r,f,d){this.type=e,this.operator=t,this.interpolation=r,this.input=f,this.labels=[],this.outputs=[];for(var x=0,S=d;x<S.length;x+=1){var P=S[x],z=P[1];this.labels.push(P[0]),this.outputs.push(z)}};function yt(e,t,r,f){var d=f-r,x=e-r;return 0===d?0:1===t?x/d:(Math.pow(t,x)-1)/(Math.pow(t,d)-1)}Fe.interpolationFactor=function(e,t,r,f){var d=0;if("exponential"===e.name)d=yt(t,e.base,r,f);else if("linear"===e.name)d=yt(t,1,r,f);else if("cubic-bezier"===e.name){var x=e.controlPoints;d=new O(x[0],x[1],x[2],x[3]).solve(yt(t,1,r,f))}return d},Fe.parse=function(e,t){var r=e[0],f=e[1],d=e[2],x=e.slice(3);if(!Array.isArray(f)||0===f.length)return t.error("Expected an interpolation type expression.",1);if("linear"===f[0])f={name:"linear"};else if("exponential"===f[0]){var S=f[1];if("number"!=typeof S)return t.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:S}}else{if("cubic-bezier"!==f[0])return t.error("Unknown interpolation type "+String(f[0]),1,0);var P=f.slice(1);if(4!==P.length||P.some(function(Ct){return"number"!=typeof Ct||Ct<0||Ct>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:P}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(d=t.parse(d,2,rr)))return null;var z=[],J=null;"interpolate-hcl"===r||"interpolate-lab"===r?J=fn:t.expectedType&&"value"!==t.expectedType.kind&&(J=t.expectedType);for(var ee=0;ee<x.length;ee+=2){var ue=x[ee],ye=x[ee+1],Se=ee+3,qe=ee+4;if("number"!=typeof ue)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Se);if(z.length&&z[z.length-1][0]>=ue)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Se);var Je=t.parse(ye,qe,J);if(!Je)return null;J=J||Je.type,z.push([ue,Je])}return"number"===J.kind||"color"===J.kind||"array"===J.kind&&"number"===J.itemType.kind&&"number"==typeof J.N?new Fe(J,r,f,d,z):t.error("Type "+ji(J)+" is not interpolatable.")},Fe.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var f=this.input.evaluate(e);if(f<=t[0])return r[0].evaluate(e);var d=t.length;if(f>=t[d-1])return r[d-1].evaluate(e);var x=Qs(t,f),S=Fe.interpolationFactor(this.interpolation,f,t[x],t[x+1]),P=r[x].evaluate(e),z=r[x+1].evaluate(e);return"interpolate"===this.operator?ko[this.type.kind.toLowerCase()](P,z,S):"interpolate-hcl"===this.operator?D.reverse(D.interpolate(D.forward(P),D.forward(z),S)):K.reverse(K.interpolate(K.forward(P),K.forward(z),S))},Fe.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Fe.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Fe.prototype.serialize=function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var Zt=function(e,t){this.type=e,this.args=t};Zt.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,f=t.expectedType;f&&"value"!==f.kind&&(r=f);for(var d=[],x=0,S=e.slice(1);x<S.length;x+=1){var P=t.parse(S[x],1+d.length,r,void 0,{typeAnnotation:"omit"});if(!P)return null;r=r||P.type,d.push(P)}var z=f&&d.some(function(J){return _a(f,J.type)});return new Zt(z?_n:r,d)},Zt.prototype.evaluate=function(e){for(var t,r=null,f=0,d=0,x=this.args;d<x.length&&(f++,(r=x[d].evaluate(e))&&r instanceof Wi&&!r.available&&(t||(t=r.name),r=null,f===this.args.length&&(r=t)),null===r);d+=1);return r},Zt.prototype.eachChild=function(e){this.args.forEach(e)},Zt.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Zt.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ft=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Ft.prototype.evaluate=function(e){return this.result.evaluate(e)},Ft.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},Ft.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],f=1;f<e.length-1;f+=2){var d=e[f];if("string"!=typeof d)return t.error("Expected string, but found "+typeof d+" instead.",f);if(/[^a-zA-Z0-9_]/.test(d))return t.error("Variable names must contain only alphanumeric characters or '_'.",f);var x=t.parse(e[f+1],f+1);if(!x)return null;r.push([d,x])}var S=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return S?new Ft(r,S):null},Ft.prototype.outputDefined=function(){return this.result.outputDefined()},Ft.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var f=r[t];e.push(f[0],f[1].serialize())}return e.push(this.result.serialize()),e};var Or=function(e,t,r){this.type=e,this.index=t,this.input=r};Or.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,rr),f=t.parse(e[2],2,Ji(t.expectedType||_n));return r&&f?new Or(f.type.itemType,r,f):null},Or.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new ra("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new ra("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new ra("Array index must be an integer, but found "+t+" instead.");return r[t]},Or.prototype.eachChild=function(e){e(this.index),e(this.input)},Or.prototype.outputDefined=function(){return!1},Or.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var zr=function(e,t){this.type=an,this.needle=e,this.haystack=t};zr.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,_n),f=t.parse(e[2],2,_n);return r&&f?Ia(r.type,[an,Sn,rr,Pn,_n])?new zr(r,f):t.error("Expected first argument to be of type boolean, string, number or null, but found "+ji(r.type)+" instead"):null},zr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Gi(t,["boolean","string","number","null"]))throw new ra("Expected first argument to be of type boolean, string, number or null, but found "+ji(Da(t))+" instead.");if(!Gi(r,["string","array"]))throw new ra("Expected second argument to be of type array or string, but found "+ji(Da(r))+" instead.");return r.indexOf(t)>=0},zr.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},zr.prototype.outputDefined=function(){return!0},zr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Jn=function(e,t,r){this.type=rr,this.needle=e,this.haystack=t,this.fromIndex=r};Jn.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,_n),f=t.parse(e[2],2,_n);if(!r||!f)return null;if(!Ia(r.type,[an,Sn,rr,Pn,_n]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+ji(r.type)+" instead");if(4===e.length){var d=t.parse(e[3],3,rr);return d?new Jn(r,f,d):null}return new Jn(r,f)},Jn.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Gi(t,["boolean","string","number","null"]))throw new ra("Expected first argument to be of type boolean, string, number or null, but found "+ji(Da(t))+" instead.");if(!Gi(r,["string","array"]))throw new ra("Expected second argument to be of type array or string, but found "+ji(Da(r))+" instead.");if(this.fromIndex){var f=this.fromIndex.evaluate(e);return r.indexOf(t,f)}return r.indexOf(t)},Jn.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Jn.prototype.outputDefined=function(){return!1},Jn.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var bi=function(e,t,r,f,d,x){this.inputType=e,this.type=t,this.input=r,this.cases=f,this.outputs=d,this.otherwise=x};bi.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,f;t.expectedType&&"value"!==t.expectedType.kind&&(f=t.expectedType);for(var d={},x=[],S=2;S<e.length-1;S+=2){var P=e[S],z=e[S+1];Array.isArray(P)||(P=[P]);var J=t.concat(S);if(0===P.length)return J.error("Expected at least one branch label.");for(var ee=0,ue=P;ee<ue.length;ee+=1){var ye=ue[ee];if("number"!=typeof ye&&"string"!=typeof ye)return J.error("Branch labels must be numbers or strings.");if("number"==typeof ye&&Math.abs(ye)>Number.MAX_SAFE_INTEGER)return J.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof ye&&Math.floor(ye)!==ye)return J.error("Numeric branch labels must be integer values.");if(r){if(J.checkSubtype(r,Da(ye)))return null}else r=Da(ye);if(void 0!==d[String(ye)])return J.error("Branch labels must be unique.");d[String(ye)]=x.length}var Se=t.parse(z,S,f);if(!Se)return null;f=f||Se.type,x.push(Se)}var qe=t.parse(e[1],1,_n);if(!qe)return null;var Je=t.parse(e[e.length-1],e.length-1,f);return Je?"value"!==qe.type.kind&&t.concat(1).checkSubtype(r,qe.type)?null:new bi(r,f,qe,d,x,Je):null},bi.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Da(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},bi.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},bi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},bi.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],f={},d=0,x=Object.keys(this.cases).sort();d<x.length;d+=1){var S=x[d];void 0===(ue=f[this.cases[S]])?(f[this.cases[S]]=r.length,r.push([this.cases[S],[S]])):r[ue][1].push(S)}for(var P=function(Se){return"number"===e.inputType.kind?Number(Se):Se},z=0,J=r;z<J.length;z+=1){var ee=J[z],ue=ee[0],ye=ee[1];t.push(1===ye.length?P(ye[0]):ye.map(P)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var pi=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};pi.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var f=[],d=1;d<e.length-1;d+=2){var x=t.parse(e[d],d,an);if(!x)return null;var S=t.parse(e[d+1],d+1,r);if(!S)return null;f.push([x,S]),r=r||S.type}var P=t.parse(e[e.length-1],e.length-1,r);return P?new pi(r,f,P):null},pi.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var f=r[t],d=f[1];if(f[0].evaluate(e))return d.evaluate(e)}return this.otherwise.evaluate(e)},pi.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var f=r[t],d=f[1];e(f[0]),e(d)}e(this.otherwise)},pi.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},pi.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var oa=function(e,t,r,f){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=f};function Ea(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Fa(e,t,r,f){return 0===f.compare(t,r)}function vi(e,t,r){var f="=="!==e&&"!="!==e;return function(){function d(x,S,P){this.type=an,this.lhs=x,this.rhs=S,this.collator=P,this.hasUntypedArgument="value"===x.type.kind||"value"===S.type.kind}return d.parse=function(x,S){if(3!==x.length&&4!==x.length)return S.error("Expected two or three arguments.");var P=x[0],z=S.parse(x[1],1,_n);if(!z)return null;if(!Ea(P,z.type))return S.concat(1).error('"'+P+"\" comparisons are not supported for type '"+ji(z.type)+"'.");var J=S.parse(x[2],2,_n);if(!J)return null;if(!Ea(P,J.type))return S.concat(2).error('"'+P+"\" comparisons are not supported for type '"+ji(J.type)+"'.");if(z.type.kind!==J.type.kind&&"value"!==z.type.kind&&"value"!==J.type.kind)return S.error("Cannot compare types '"+ji(z.type)+"' and '"+ji(J.type)+"'.");f&&("value"===z.type.kind&&"value"!==J.type.kind?z=new ma(J.type,[z]):"value"!==z.type.kind&&"value"===J.type.kind&&(J=new ma(z.type,[J])));var ee=null;if(4===x.length){if("string"!==z.type.kind&&"string"!==J.type.kind&&"value"!==z.type.kind&&"value"!==J.type.kind)return S.error("Cannot use collator to compare non-string types.");if(!(ee=S.parse(x[3],3,Oi)))return null}return new d(z,J,ee)},d.prototype.evaluate=function(x){var S=this.lhs.evaluate(x),P=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){var z=Da(S),J=Da(P);if(z.kind!==J.kind||"string"!==z.kind&&"number"!==z.kind)throw new ra('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+z.kind+", "+J.kind+") instead.")}if(this.collator&&!f&&this.hasUntypedArgument){var ee=Da(S),ue=Da(P);if("string"!==ee.kind||"string"!==ue.kind)return t(x,S,P)}return this.collator?r(x,S,P,this.collator.evaluate(x)):t(x,S,P)},d.prototype.eachChild=function(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)},d.prototype.outputDefined=function(){return!0},d.prototype.serialize=function(){var x=[e];return this.eachChild(function(S){x.push(S.serialize())}),x},d}()}oa.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,_n),f=t.parse(e[2],2,rr);if(!r||!f)return null;if(!Ia(r.type,[Ji(_n),Sn,_n]))return t.error("Expected first argument to be of type array or string, but found "+ji(r.type)+" instead");if(4===e.length){var d=t.parse(e[3],3,rr);return d?new oa(r.type,r,f,d):null}return new oa(r.type,r,f)},oa.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Gi(t,["string","array"]))throw new ra("Expected first argument to be of type array or string, but found "+ji(Da(t))+" instead.");if(this.endIndex){var f=this.endIndex.evaluate(e);return t.slice(r,f)}return t.slice(r)},oa.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},oa.prototype.outputDefined=function(){return!1},oa.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Xo=vi("==",function(e,t,r){return t===r},Fa),vu=vi("!=",function(e,t,r){return t!==r},function(e,t,r,f){return!Fa(0,t,r,f)}),Tu=vi("<",function(e,t,r){return t<r},function(e,t,r,f){return f.compare(t,r)<0}),Ec=vi(">",function(e,t,r){return t>r},function(e,t,r,f){return f.compare(t,r)>0}),Du=vi("<=",function(e,t,r){return t<=r},function(e,t,r,f){return f.compare(t,r)<=0}),Nl=vi(">=",function(e,t,r){return t>=r},function(e,t,r,f){return f.compare(t,r)>=0}),mu=function(e,t,r,f,d){this.type=Sn,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=f,this.maxFractionDigits=d};mu.parse=function(e,t){if(3!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,rr);if(!r)return null;var f=e[2];if("object"!=typeof f||Array.isArray(f))return t.error("NumberFormat options argument must be an object.");var d=null;if(f.locale&&!(d=t.parse(f.locale,1,Sn)))return null;var x=null;if(f.currency&&!(x=t.parse(f.currency,1,Sn)))return null;var S=null;if(f["min-fraction-digits"]&&!(S=t.parse(f["min-fraction-digits"],1,rr)))return null;var P=null;return f["max-fraction-digits"]&&!(P=t.parse(f["max-fraction-digits"],1,rr))?null:new mu(r,d,x,S,P)},mu.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},mu.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},mu.prototype.outputDefined=function(){return!1},mu.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var gu=function(e){this.type=rr,this.input=e};gu.parse=function(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error("Expected argument of type string or array, but found "+ji(r.type)+" instead."):new gu(r):null},gu.prototype.evaluate=function(e){var t=this.input.evaluate(e);if("string"==typeof t||Array.isArray(t))return t.length;throw new ra("Expected value to be of type string or array, but found "+ji(Da(t))+" instead.")},gu.prototype.eachChild=function(e){e(this.input)},gu.prototype.outputDefined=function(){return!1},gu.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var tu={"==":Xo,"!=":vu,">":Ec,"<":Tu,">=":Nl,"<=":Du,array:ma,at:Or,boolean:ma,case:pi,coalesce:Zt,collator:$o,format:vo,image:Fo,in:zr,"index-of":Jn,interpolate:Fe,"interpolate-hcl":Fe,"interpolate-lab":Fe,length:gu,let:Ft,literal:Bi,match:bi,number:ma,"number-format":mu,object:ma,slice:oa,step:gs,string:ma,"to-boolean":aa,"to-color":aa,"to-number":aa,"to-string":aa,var:ts,within:Wo};function oo(e,t){var r=t[0],f=t[1],d=t[2],x=t[3];r=r.evaluate(e),f=f.evaluate(e),d=d.evaluate(e);var S=x?x.evaluate(e):1,P=va(r,f,d,S);if(P)throw new ra(P);return new Xi(r/255*S,f/255*S,d/255*S,S)}function Tc(e,t){return e in t}function Cc(e,t){var r=t[e];return void 0===r?null:r}function rs(e){return{type:e}}function tc(e){return{result:"success",value:e}}function ru(e){return{result:"error",value:e}}function Rs(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function rc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Nu(e){return!!e.expression&&e.expression.interpolated}function La(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Ju(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Gc(e){return e}function Us(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function nc(e,t,r,f,d){return Us(typeof r===d?f[r]:void 0,e.default,t.default)}function Hc(e,t,r){if("number"!==La(r))return Us(e.default,t.default);var f=e.stops.length;if(1===f||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var d=Qs(e.stops.map(function(x){return x[0]}),r);return e.stops[d][1]}function Ac(e,t,r){var f=void 0!==e.base?e.base:1;if("number"!==La(r))return Us(e.default,t.default);var d=e.stops.length;if(1===d||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[d-1][0])return e.stops[d-1][1];var ye,Se,Je,Ct,x=Qs(e.stops.map(function(ue){return ue[0]}),r),S=(ye=f,Ct=r-(Se=e.stops[x][0]),0==(Je=e.stops[x+1][0]-Se)?0:1===ye?Ct/Je:(Math.pow(ye,Ct)-1)/(Math.pow(ye,Je)-1)),P=e.stops[x][1],z=e.stops[x+1][1],J=ko[t.type]||Gc;if(e.colorSpace&&"rgb"!==e.colorSpace){var ee=ge[e.colorSpace];J=function(ue,ye){return ee.reverse(ee.interpolate(ee.forward(ue),ee.forward(ye),S))}}return"function"==typeof P.evaluate?{evaluate:function(){for(var ue=[],ye=arguments.length;ye--;)ue[ye]=arguments[ye];var Se=P.evaluate.apply(void 0,ue),qe=z.evaluate.apply(void 0,ue);if(void 0!==Se&&void 0!==qe)return J(Se,qe,S)}}:J(P,z,S)}function Bl(e,t,r){return"color"===t.type?r=Xi.parse(r):"formatted"===t.type?r=Za.fromString(r.toString()):"resolvedImage"===t.type?r=Wi.fromString(r.toString()):La(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),Us(r,e.default,t.default)}Ya.register(tu,{error:[{kind:"error"},[Sn],function(e,t){throw new ra(t[0].evaluate(e))}],typeof:[Sn,[_n],function(e,t){return ji(Da(t[0].evaluate(e)))}],"to-rgba":[Ji(rr,4),[fn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[fn,[rr,rr,rr],oo],rgba:[fn,[rr,rr,rr,rr],oo],has:{type:an,overloads:[[[Sn],function(e,t){return Tc(t[0].evaluate(e),e.properties())}],[[Sn,Di],function(e,t){var r=t[1];return Tc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:_n,overloads:[[[Sn],function(e,t){return Cc(t[0].evaluate(e),e.properties())}],[[Sn,Di],function(e,t){var r=t[1];return Cc(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[_n,[Sn],function(e,t){return Cc(t[0].evaluate(e),e.featureState||{})}],properties:[Di,[],function(e){return e.properties()}],"geometry-type":[Sn,[],function(e){return e.geometryType()}],id:[_n,[],function(e){return e.id()}],zoom:[rr,[],function(e){return e.globals.zoom}],"heatmap-density":[rr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[rr,[],function(e){return e.globals.lineProgress||0}],accumulated:[_n,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[rr,rs(rr),function(e,t){for(var r=0,f=0,d=t;f<d.length;f+=1)r+=d[f].evaluate(e);return r}],"*":[rr,rs(rr),function(e,t){for(var r=1,f=0,d=t;f<d.length;f+=1)r*=d[f].evaluate(e);return r}],"-":{type:rr,overloads:[[[rr,rr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[rr],function(e,t){return-t[0].evaluate(e)}]]},"/":[rr,[rr,rr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[rr,[rr,rr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[rr,[],function(){return Math.LN2}],pi:[rr,[],function(){return Math.PI}],e:[rr,[],function(){return Math.E}],"^":[rr,[rr,rr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[rr,[rr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[rr,[rr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[rr,[rr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[rr,[rr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[rr,[rr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[rr,[rr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[rr,[rr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[rr,[rr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[rr,[rr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[rr,[rr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[rr,rs(rr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[rr,rs(rr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[rr,[rr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[rr,[rr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[rr,[rr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[rr,[rr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1];return e.properties()[r.value]===f.value}],"filter-id-==":[an,[_n],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[an,[Sn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1],d=e.properties()[r.value],x=f.value;return typeof d==typeof x&&d<x}],"filter-id-<":[an,[_n],function(e,t){var r=t[0],f=e.id(),d=r.value;return typeof f==typeof d&&f<d}],"filter->":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1],d=e.properties()[r.value],x=f.value;return typeof d==typeof x&&d>x}],"filter-id->":[an,[_n],function(e,t){var r=t[0],f=e.id(),d=r.value;return typeof f==typeof d&&f>d}],"filter-<=":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1],d=e.properties()[r.value],x=f.value;return typeof d==typeof x&&d<=x}],"filter-id-<=":[an,[_n],function(e,t){var r=t[0],f=e.id(),d=r.value;return typeof f==typeof d&&f<=d}],"filter->=":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1],d=e.properties()[r.value],x=f.value;return typeof d==typeof x&&d>=x}],"filter-id->=":[an,[_n],function(e,t){var r=t[0],f=e.id(),d=r.value;return typeof f==typeof d&&f>=d}],"filter-has":[an,[_n],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[an,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[an,[Ji(Sn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[an,[Ji(_n)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[an,[Sn,Ji(_n)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[an,[Sn,Ji(_n)],function(e,t){var r=t[0],f=t[1];return function(d,x,S,P){for(;S<=P;){var z=S+P>>1;if(x[z]===d)return!0;x[z]>d?P=z-1:S=z+1}return!1}(e.properties()[r.value],f.value,0,f.value.length-1)}],all:{type:an,overloads:[[[an,an],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[rs(an),function(e,t){for(var r=0,f=t;r<f.length;r+=1)if(!f[r].evaluate(e))return!1;return!0}]]},any:{type:an,overloads:[[[an,an],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[rs(an),function(e,t){for(var r=0,f=t;r<f.length;r+=1)if(f[r].evaluate(e))return!0;return!1}]]},"!":[an,[an],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[an,[Sn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Sn,[Sn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Sn,[Sn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Sn,rs(_n),function(e,t){return t.map(function(r){return qo(r.evaluate(e))}).join("")}],"resolved-locale":[Sn,[Oi],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var yu=function(e,t){var r;this.expression=e,this._warningHistory={},this._evaluator=new Ma,this._defaultValue=t?"color"===(r=t).type&&Ju(r.default)?new Xi(0,0,0,0):"color"===r.type?Xi.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=t&&"enum"===t.type?t.values:null};function $u(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in tu}function pl(e,t){var d,x,r=new ks(tu,[],t?(x={color:fn,string:Sn,number:rr,enum:Sn,boolean:an,formatted:ta,resolvedImage:oi},"array"===(d=t).type?Ji(x[d.value]||_n,d.length):x[d.type]):void 0),f=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return f?tc(new yu(f,t)):ru(r.errors)}yu.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,d,x){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=f,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)},yu.prototype.evaluate=function(e,t,r,f,d,x){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=f,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=x||null;try{var S=this.expression.evaluate(this._evaluator);if(null==S||"number"==typeof S&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new ra("Expected value to be one of "+Object.keys(this._enumValues).map(function(P){return JSON.stringify(P)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,"undefined"!=typeof console&&console.warn(P.message)),this._defaultValue}};var Qu=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Lo(t.expression)};Qu.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,d,x){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,f,d,x)},Qu.prototype.evaluate=function(e,t,r,f,d,x){return this._styleExpression.evaluate(e,t,r,f,d,x)};var el=function(e,t,r,f){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Lo(t.expression),this.interpolationType=f};function dl(e,t){if("error"===(e=pl(e,t)).result)return e;var r=e.value.expression,f=Qo(r);if(!f&&!Rs(t))return ru([new Br("","data expressions not supported")]);var d=es(r,["zoom"]);if(!d&&!rc(t))return ru([new Br("","zoom expressions not supported")]);var x=function S(P){var z=null;if(P instanceof Ft)z=S(P.result);else if(P instanceof Zt)for(var J=0,ee=P.args;J<ee.length&&!(z=S(ee[J]));J+=1);else(P instanceof gs||P instanceof Fe)&&P.input instanceof Ya&&"zoom"===P.input.name&&(z=P);return z instanceof Br||P.eachChild(function(ue){var ye=S(ue);ye instanceof Br?z=ye:!z&&ye?z=new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):z&&ye&&z!==ye&&(z=new Br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),z}(r);return x||d?x instanceof Br?ru([x]):x instanceof Fe&&!Nu(t)?ru([new Br("",'"interpolate" expressions cannot be used with this property')]):tc(x?new el(f?"camera":"composite",e.value,x.labels,x instanceof Fe?x.interpolation:void 0):new Qu(f?"constant":"source",e.value)):ru([new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}el.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,d,x){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,f,d,x)},el.prototype.evaluate=function(e,t,r,f,d,x){return this._styleExpression.evaluate(e,t,r,f,d,x)},el.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?Fe.interpolationFactor(this.interpolationType,e,t,r):0};var Bu=function(e,t){this._parameters=e,this._specification=t,wr(this,function r(f,d){var x,S,P,z="color"===d.type,J=f.stops&&"object"==typeof f.stops[0][0],ee=J||!(J||void 0!==f.property),ue=f.type||(Nu(d)?"exponential":"interval");if(z&&((f=wr({},f)).stops&&(f.stops=f.stops.map(function(Bn){return[Bn[0],Xi.parse(Bn[1])]})),f.default=Xi.parse(f.default?f.default:d.default)),f.colorSpace&&"rgb"!==f.colorSpace&&!ge[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if("exponential"===ue)x=Ac;else if("interval"===ue)x=Hc;else if("categorical"===ue){x=nc,S=Object.create(null);for(var ye=0,Se=f.stops;ye<Se.length;ye+=1){var qe=Se[ye];S[qe[0]]=qe[1]}P=typeof f.stops[0][0]}else{if("identity"!==ue)throw new Error('Unknown function type "'+ue+'"');x=Bl}if(J){for(var Je={},Ct=[],st=0;st<f.stops.length;st++){var zt=f.stops[st],Qt=zt[0].zoom;void 0===Je[Qt]&&(Je[Qt]={zoom:Qt,type:f.type,property:f.property,default:f.default,stops:[]},Ct.push(Qt)),Je[Qt].stops.push([zt[0].value,zt[1]])}for(var yr=[],Sr=0,Rr=Ct;Sr<Rr.length;Sr+=1){var nn=Rr[Sr];yr.push([Je[nn].zoom,r(Je[nn],d)])}var gn={name:"linear"};return{kind:"composite",interpolationType:gn,interpolationFactor:Fe.interpolationFactor.bind(void 0,gn),zoomStops:yr.map(function(Bn){return Bn[0]}),evaluate:function(Bn,fi){var Zn=Bn.zoom;return Ac({stops:yr,base:f.base},d,Zn).evaluate(Zn,fi)}}}if(ee){var ii="exponential"===ue?{name:"exponential",base:void 0!==f.base?f.base:1}:null;return{kind:"camera",interpolationType:ii,interpolationFactor:Fe.interpolationFactor.bind(void 0,ii),zoomStops:f.stops.map(function(Bn){return Bn[0]}),evaluate:function(Bn){return x(f,d,Bn.zoom,S,P)}}}return{kind:"source",evaluate:function(Bn,fi){var Zn=fi&&fi.properties?fi.properties[f.property]:void 0;return void 0===Zn?Us(f.default,d.default):x(f,d,Zn,S,P)}}}(this._parameters,this._specification))};function Vs(e){var t=e.key,r=e.value,f=e.valueSpec||{},d=e.objectElementValidators||{},x=e.style,S=e.styleSpec,P=[],z=La(r);if("object"!==z)return[new Ae(t,r,"object expected, "+z+" found")];for(var J in r){var ee=J.split(".")[0],ue=f[ee]||f["*"],ye=void 0;if(d[ee])ye=d[ee];else if(f[ee])ye=sa;else if(d["*"])ye=d["*"];else{if(!f["*"]){P.push(new Ae(t,r[J],'unknown property "'+J+'"'));continue}ye=sa}P=P.concat(ye({key:(t&&t+".")+J,value:r[J],valueSpec:ue,style:x,styleSpec:S,object:r,objectKey:J},r))}for(var Se in f)d[Se]||f[Se].required&&void 0===f[Se].default&&void 0===r[Se]&&P.push(new Ae(t,r,'missing required property "'+Se+'"'));return P}function Pc(e){var t=e.value,r=e.valueSpec,f=e.style,d=e.styleSpec,x=e.key,S=e.arrayElementValidator||sa;if("array"!==La(t))return[new Ae(x,t,"array expected, "+La(t)+" found")];if(r.length&&t.length!==r.length)return[new Ae(x,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Ae(x,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var P={type:r.value,values:r.values};d.$version<7&&(P.function=r.function),"object"===La(r.value)&&(P=r.value);for(var z=[],J=0;J<t.length;J++)z=z.concat(S({array:t,arrayIndex:J,value:t[J],valueSpec:P,style:f,styleSpec:d,key:x+"["+J+"]"}));return z}function Ic(e){var t=e.key,r=e.value,f=e.valueSpec,d=La(r);return"number"===d&&r!=r&&(d="NaN"),"number"!==d?[new Ae(t,r,"number expected, "+d+" found")]:"minimum"in f&&r<f.minimum?[new Ae(t,r,r+" is less than the minimum value "+f.minimum)]:"maximum"in f&&r>f.maximum?[new Ae(t,r,r+" is greater than the maximum value "+f.maximum)]:[]}function Wc(e){var t,r,f,d=e.valueSpec,x=Kt(e.value.type),S={},P="categorical"!==x&&void 0===e.value.property,z=!P,J="array"===La(e.value.stops)&&"array"===La(e.value.stops[0])&&"object"===La(e.value.stops[0][0]),ee=Vs({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Se){if("identity"===x)return[new Ae(Se.key,Se.value,'identity function may not have a "stops" property')];var qe=[],Je=Se.value;return qe=qe.concat(Pc({key:Se.key,value:Je,valueSpec:Se.valueSpec,style:Se.style,styleSpec:Se.styleSpec,arrayElementValidator:ue})),"array"===La(Je)&&0===Je.length&&qe.push(new Ae(Se.key,Je,"array must have at least one stop")),qe},default:function(Se){return sa({key:Se.key,value:Se.value,valueSpec:d,style:Se.style,styleSpec:Se.styleSpec})}}});return"identity"===x&&P&&ee.push(new Ae(e.key,e.value,'missing required property "property"')),"identity"===x||e.value.stops||ee.push(new Ae(e.key,e.value,'missing required property "stops"')),"exponential"===x&&e.valueSpec.expression&&!Nu(e.valueSpec)&&ee.push(new Ae(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(z&&!Rs(e.valueSpec)?ee.push(new Ae(e.key,e.value,"property functions not supported")):P&&!rc(e.valueSpec)&&ee.push(new Ae(e.key,e.value,"zoom functions not supported"))),"categorical"!==x&&!J||void 0!==e.value.property||ee.push(new Ae(e.key,e.value,'"property" property is required')),ee;function ue(Se){var qe=[],Je=Se.value,Ct=Se.key;if("array"!==La(Je))return[new Ae(Ct,Je,"array expected, "+La(Je)+" found")];if(2!==Je.length)return[new Ae(Ct,Je,"array length 2 expected, length "+Je.length+" found")];if(J){if("object"!==La(Je[0]))return[new Ae(Ct,Je,"object expected, "+La(Je[0])+" found")];if(void 0===Je[0].zoom)return[new Ae(Ct,Je,"object stop key must have zoom")];if(void 0===Je[0].value)return[new Ae(Ct,Je,"object stop key must have value")];if(f&&f>Kt(Je[0].zoom))return[new Ae(Ct,Je[0].zoom,"stop zoom values must appear in ascending order")];Kt(Je[0].zoom)!==f&&(f=Kt(Je[0].zoom),r=void 0,S={}),qe=qe.concat(Vs({key:Ct+"[0]",value:Je[0],valueSpec:{zoom:{}},style:Se.style,styleSpec:Se.styleSpec,objectElementValidators:{zoom:Ic,value:ye}}))}else qe=qe.concat(ye({key:Ct+"[0]",value:Je[0],valueSpec:{},style:Se.style,styleSpec:Se.styleSpec},Je));return $u(ar(Je[1]))?qe.concat([new Ae(Ct+"[1]",Je[1],"expressions are not allowed in function stops.")]):qe.concat(sa({key:Ct+"[1]",value:Je[1],valueSpec:d,style:Se.style,styleSpec:Se.styleSpec}))}function ye(Se,qe){var Je=La(Se.value),Ct=Kt(Se.value),st=null!==Se.value?Se.value:qe;if(t){if(Je!==t)return[new Ae(Se.key,st,Je+" stop domain type must match previous stop domain type "+t)]}else t=Je;if("number"!==Je&&"string"!==Je&&"boolean"!==Je)return[new Ae(Se.key,st,"stop domain value must be a number, string, or boolean")];if("number"!==Je&&"categorical"!==x){var zt="number expected, "+Je+" found";return Rs(d)&&void 0===x&&(zt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ae(Se.key,st,zt)]}return"categorical"!==x||"number"!==Je||isFinite(Ct)&&Math.floor(Ct)===Ct?"categorical"!==x&&"number"===Je&&void 0!==r&&Ct<r?[new Ae(Se.key,st,"stop domain values must appear in ascending order")]:(r=Ct,"categorical"===x&&Ct in S?[new Ae(Se.key,st,"stop domain values must be unique")]:(S[Ct]=!0,[])):[new Ae(Se.key,st,"integer expected, found "+Ct)]}}function tl(e){var t=("property"===e.expressionContext?dl:pl)(ar(e.value),e.valueSpec);if("error"===t.result)return t.value.map(function(f){return new Ae(""+e.key+f.key,e.value,f.message)});var r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Ae(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Lo(r))return[new Ae(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Lo(r))return[new Ae(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!es(r,["zoom","feature-state"]))return[new Ae(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Qo(r))return[new Ae(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vl(e){var t=e.key,r=e.value,f=e.valueSpec,d=[];return Array.isArray(f.values)?-1===f.values.indexOf(Kt(r))&&d.push(new Ae(t,r,"expected one of ["+f.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(f.values).indexOf(Kt(r))&&d.push(new Ae(t,r,"expected one of ["+Object.keys(f.values).join(", ")+"], "+JSON.stringify(r)+" found")),d}function Fl(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var f=r[t];if(!Fl(f)&&"boolean"!=typeof f)return!1}return!0;default:return!0}}Bu.deserialize=function(e){return new Bu(e._parameters,e._specification)},Bu.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var ic={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fu(e){if(null==e)return{filter:function(){return!0},needGeometry:!1};Fl(e)||(e=Cu(e));var t=pl(e,ic);if("error"===t.result)throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,f,d){return t.value.evaluate(r,f,{},d)},needGeometry:function r(f){if(!Array.isArray(f))return!1;if("within"===f[0])return!0;for(var d=1;d<f.length;d++)if(r(f[d]))return!0;return!1}(e)}}function uf(e,t){return e<t?-1:e>t?1:0}function Cu(e){if(!e)return!0;var t,r=e[0];return e.length<=1?"any"!==r:"=="===r?zu(e[1],e[2],"=="):"!="===r?js(zu(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?zu(e[1],e[2],r):"any"===r?(t=e.slice(1),["any"].concat(t.map(Cu))):"all"===r?["all"].concat(e.slice(1).map(Cu)):"none"===r?["all"].concat(e.slice(1).map(Cu).map(js)):"in"===r?nu(e[1],e.slice(2)):"!in"===r?js(nu(e[1],e.slice(2))):"has"===r?Au(e[1]):"!has"===r?js(Au(e[1])):"within"!==r||e}function zu(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function nu(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(uf)]]:["filter-in-small",e,["literal",t]]}}function Au(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function js(e){return["!",e]}function zl(e){return Fl(ar(e.value))?tl(wr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var f=r.value,d=r.key;if("array"!==La(f))return[new Ae(d,f,"array expected, "+La(f)+" found")];var x,S=r.styleSpec,P=[];if(f.length<1)return[new Ae(d,f,"filter array must have at least 1 element")];switch(P=P.concat(vl({key:d+"[0]",value:f[0],valueSpec:S.filter_operator,style:r.style,styleSpec:r.styleSpec})),Kt(f[0])){case"<":case"<=":case">":case">=":f.length>=2&&"$type"===Kt(f[1])&&P.push(new Ae(d,f,'"$type" cannot be use with operator "'+f[0]+'"'));case"==":case"!=":3!==f.length&&P.push(new Ae(d,f,'filter array for operator "'+f[0]+'" must have 3 elements'));case"in":case"!in":f.length>=2&&"string"!==(x=La(f[1]))&&P.push(new Ae(d+"[1]",f[1],"string expected, "+x+" found"));for(var z=2;z<f.length;z++)x=La(f[z]),"$type"===Kt(f[1])?P=P.concat(vl({key:d+"["+z+"]",value:f[z],valueSpec:S.geometry_type,style:r.style,styleSpec:r.styleSpec})):"string"!==x&&"number"!==x&&"boolean"!==x&&P.push(new Ae(d+"["+z+"]",f[z],"string, number, or boolean expected, "+x+" found"));break;case"any":case"all":case"none":for(var J=1;J<f.length;J++)P=P.concat(t({key:d+"["+J+"]",value:f[J],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":x=La(f[1]),2!==f.length?P.push(new Ae(d,f,'filter array for "'+f[0]+'" operator must have 2 elements')):"string"!==x&&P.push(new Ae(d+"[1]",f[1],"string expected, "+x+" found"));break;case"within":x=La(f[1]),2!==f.length?P.push(new Ae(d,f,'filter array for "'+f[0]+'" operator must have 2 elements')):"object"!==x&&P.push(new Ae(d+"[1]",f[1],"object expected, "+x+" found"))}return P}(e)}function ac(e,t){var r=e.key,f=e.style,d=e.styleSpec,x=e.value,S=e.objectKey,P=d[t+"_"+e.layerType];if(!P)return[];var z=S.match(/^(.*)-transition$/);if("paint"===t&&z&&P[z[1]]&&P[z[1]].transition)return sa({key:r,value:x,valueSpec:d.transition,style:f,styleSpec:d});var J,ee=e.valueSpec||P[S];if(!ee)return[new Ae(r,x,'unknown property "'+S+'"')];if("string"===La(x)&&Rs(ee)&&!ee.tokens&&(J=/^{([^}]+)}$/.exec(x)))return[new Ae(r,x,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(J[1])+" }`.")];var ue=[];return"symbol"===e.layerType&&("text-field"===S&&f&&!f.glyphs&&ue.push(new Ae(r,x,'use of "text-field" requires a style "glyphs" property')),"text-font"===S&&Ju(ar(x))&&"identity"===Kt(x.type)&&ue.push(new Ae(r,x,'"text-font" does not support identity functions'))),ue.concat(sa({key:e.key,value:x,valueSpec:ee,style:f,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:S}))}function oc(e){return ac(e,"paint")}function Zu(e){return ac(e,"layout")}function ns(e){var t=[],r=e.value,f=e.key,d=e.style,x=e.styleSpec;r.type||r.ref||t.push(new Ae(f,r,'either "type" or "ref" is required'));var S,P=Kt(r.type),z=Kt(r.ref);if(r.id)for(var J=Kt(r.id),ee=0;ee<e.arrayIndex;ee++){var ue=d.layers[ee];Kt(ue.id)===J&&t.push(new Ae(f,r.id,'duplicate layer id "'+r.id+'", previously used at line '+ue.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(qe){qe in r&&t.push(new Ae(f,r[qe],'"'+qe+'" is prohibited for ref layers'))}),d.layers.forEach(function(qe){Kt(qe.id)===z&&(S=qe)}),S?S.ref?t.push(new Ae(f,r.ref,"ref cannot reference another ref layer")):P=Kt(S.type):t.push(new Ae(f,r.ref,'ref layer "'+z+'" not found'));else if("background"!==P)if(r.source){var ye=d.sources&&d.sources[r.source],Se=ye&&Kt(ye.type);ye?"vector"===Se&&"raster"===P?t.push(new Ae(f,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===Se&&"raster"!==P?t.push(new Ae(f,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==Se||r["source-layer"]?"raster-dem"===Se&&"hillshade"!==P?t.push(new Ae(f,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==P||!r.paint||!r.paint["line-gradient"]||"geojson"===Se&&ye.lineMetrics||t.push(new Ae(f,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Ae(f,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Ae(f,r.source,'source "'+r.source+'" not found'))}else t.push(new Ae(f,r,'missing required property "source"'));return t=t.concat(Vs({key:f,value:r,valueSpec:x.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return sa({key:f+".type",value:r.type,valueSpec:x.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:zl,layout:function(qe){return Vs({layer:r,key:qe.key,value:qe.value,style:qe.style,styleSpec:qe.styleSpec,objectElementValidators:{"*":function(Je){return Zu(wr({layerType:P},Je))}}})},paint:function(qe){return Vs({layer:r,key:qe.key,value:qe.value,style:qe.style,styleSpec:qe.styleSpec,objectElementValidators:{"*":function(Je){return oc(wr({layerType:P},Je))}}})}}}))}function rl(e){var t=e.value,r=e.key,f=La(t);return"string"!==f?[new Ae(r,t,"string expected, "+f+" found")]:[]}var $a={promoteId:function(e){var t=e.key,r=e.value;if("string"===La(r))return rl({key:t,value:r});var f=[];for(var d in r)f.push.apply(f,rl({key:t+"."+d,value:r[d]}));return f}};function Zl(e){var t=e.value,r=e.key,f=e.styleSpec,d=e.style;if(!t.type)return[new Ae(r,t,'"type" is required')];var x,S=Kt(t.type);switch(S){case"vector":case"raster":case"raster-dem":return Vs({key:r,value:t,valueSpec:f["source_"+S.replace("-","_")],style:e.style,styleSpec:f,objectElementValidators:$a});case"geojson":if(x=Vs({key:r,value:t,valueSpec:f.source_geojson,style:d,styleSpec:f,objectElementValidators:$a}),t.cluster)for(var P in t.clusterProperties){var z=t.clusterProperties[P],J=z[0],ee="string"==typeof J?[J,["accumulated"],["get",P]]:J;x.push.apply(x,tl({key:r+"."+P+".map",value:z[1],expressionContext:"cluster-map"})),x.push.apply(x,tl({key:r+"."+P+".reduce",value:ee,expressionContext:"cluster-reduce"}))}return x;case"video":return Vs({key:r,value:t,valueSpec:f.source_video,style:d,styleSpec:f});case"image":return Vs({key:r,value:t,valueSpec:f.source_image,style:d,styleSpec:f});case"canvas":return[new Ae(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vl({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:f})}}function Gs(e){var t=e.value,r=e.styleSpec,f=r.light,d=e.style,x=[],S=La(t);if(void 0===t)return x;if("object"!==S)return x.concat([new Ae("light",t,"object expected, "+S+" found")]);for(var P in t){var z=P.match(/^(.*)-transition$/);x=x.concat(z&&f[z[1]]&&f[z[1]].transition?sa({key:P,value:t[P],valueSpec:r.transition,style:d,styleSpec:r}):f[P]?sa({key:P,value:t[P],valueSpec:f[P],style:d,styleSpec:r}):[new Ae(P,t[P],'unknown property "'+P+'"')])}return x}var Pu={"*":function(){return[]},array:Pc,boolean:function(e){var t=e.value,r=e.key,f=La(t);return"boolean"!==f?[new Ae(r,t,"boolean expected, "+f+" found")]:[]},number:Ic,color:function(e){var t=e.key,r=e.value,f=La(r);return"string"!==f?[new Ae(t,r,"color expected, "+f+" found")]:null===Ni(r)?[new Ae(t,r,'color expected, "'+r+'" found')]:[]},constants:Tt,enum:vl,filter:zl,function:Wc,layer:ns,object:Vs,source:Zl,light:Gs,string:rl,formatted:function(e){return 0===rl(e).length?[]:tl(e)},resolvedImage:function(e){return 0===rl(e).length?[]:tl(e)}};function sa(e){var t=e.value,r=e.valueSpec,f=e.styleSpec;return r.expression&&Ju(Kt(t))?Wc(e):r.expression&&$u(ar(t))?tl(e):r.type&&Pu[r.type]?Pu[r.type](e):Vs(wr({},e,{valueSpec:r.type?f[r.type]:r}))}function ja(e){var t=e.value,r=e.key,f=rl(e);return f.length||(-1===t.indexOf("{fontstack}")&&f.push(new Ae(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&f.push(new Ae(r,t,'"glyphs" url must include a "{range}" token'))),f}function ws(e,t){void 0===t&&(t=pe);var r=[];return r=r.concat(sa({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:ja,"*":function(){return[]}}})),e.constants&&(r=r.concat(Tt({key:"constants",value:e.constants,style:e,styleSpec:t}))),Ul(r)}function Ul(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Uu(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Ul(e.apply(this,t))}}ws.source=Uu(Zl),ws.light=Uu(Gs),ws.layer=Uu(ns),ws.filter=Uu(zl),ws.paintProperty=Uu(oc),ws.layoutProperty=Uu(Zu);var Mc=ws,Ta=Mc.light,lf=Mc.paintProperty,Vl=Mc.layoutProperty;function ml(e,t){var r=!1;if(t&&t.length)for(var f=0,d=t;f<d.length;f+=1)e.fire(new xe(new Error(d[f].message))),r=!0;return r}var _u=So;function So(e,t,r){var f=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var d=new Int32Array(this.arrayBuffer);e=d[0],this.d=(t=d[1])+2*(r=d[2]);for(var x=0;x<this.d*this.d;x++){var S=d[3+x],P=d[3+x+1];f.push(S===P?null:d.subarray(S,P))}var z=d[3+f.length+1];this.keys=d.subarray(d[3+f.length],z),this.bboxes=d.subarray(z),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var J=0;J<this.d*this.d;J++)f.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var ee=r/t*e;this.min=-ee,this.max=e+ee}So.prototype.insert=function(e,t,r,f,d){this._forEachCell(t,r,f,d,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(f),this.bboxes.push(d)},So.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},So.prototype._insertCell=function(e,t,r,f,d,x){this.cells[d].push(x)},So.prototype.query=function(e,t,r,f,d){var x=this.min,S=this.max;if(e<=x&&t<=x&&S<=r&&S<=f&&!d)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(e,t,r,f,this._queryCell,P,{},d),P},So.prototype._queryCell=function(e,t,r,f,d,x,S,P){var z=this.cells[d];if(null!==z)for(var J=this.keys,ee=this.bboxes,ue=0;ue<z.length;ue++){var ye=z[ue];if(void 0===S[ye]){var Se=4*ye;(P?P(ee[Se+0],ee[Se+1],ee[Se+2],ee[Se+3]):e<=ee[Se+2]&&t<=ee[Se+3]&&r>=ee[Se+0]&&f>=ee[Se+1])?(S[ye]=!0,x.push(J[ye])):S[ye]=!1}}},So.prototype._forEachCell=function(e,t,r,f,d,x,S,P){for(var z=this._convertToCellCoord(e),J=this._convertToCellCoord(t),ee=this._convertToCellCoord(r),ue=this._convertToCellCoord(f),ye=z;ye<=ee;ye++)for(var Se=J;Se<=ue;Se++){var qe=this.d*Se+ye;if((!P||P(this._convertFromCellCoord(ye),this._convertFromCellCoord(Se),this._convertFromCellCoord(ye+1),this._convertFromCellCoord(Se+1)))&&d.call(this,e,t,r,f,qe,x,S,P))return}},So.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},So.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},So.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,f=0;f<this.cells.length;f++)r+=this.cells[f].length;var d=new Int32Array(t+r+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var x=t,S=0;S<e.length;S++){var P=e[S];d[3+S]=x,d.set(P,x),x+=P.length}return d[3+e.length]=x,d.set(this.keys,x),d[3+e.length+1]=x+=this.keys.length,d.set(this.bboxes,x),x+=this.bboxes.length,d.buffer};var gl=j.ImageData,yl=j.ImageBitmap,Ro={};function Fn(e,t,r){void 0===r&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Ro[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var za in Fn("Object",Object),_u.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},_u.deserialize=function(e){return new _u(e.buffer)},Fn("Grid",_u),Fn("Color",Xi),Fn("Error",Error),Fn("ResolvedImage",Wi),Fn("StylePropertyFunction",Bu),Fn("StyleExpression",yu,{omit:["_evaluator"]}),Fn("ZoomDependentExpression",el),Fn("ZoomConstantExpression",Qu),Fn("CompoundExpression",Ya,{omit:["_evaluate"]}),tu)tu[za]._classRegistryKey||Fn("Expression_"+za,tu[za]);function Vu(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function _l(e){return yl&&e instanceof yl}function iu(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Vu(e)||_l(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof gl)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var f=[],d=0,x=e;d<x.length;d+=1)f.push(iu(x[d],t));return f}if("object"==typeof e){var S=e.constructor,P=S._classRegistryKey;if(!P)throw new Error("can't serialize object of unregistered class");var z=S.serialize?S.serialize(e,t):{};if(!S.serialize){for(var J in e)if(e.hasOwnProperty(J)&&!(Ro[P].omit.indexOf(J)>=0)){var ee=e[J];z[J]=Ro[P].shallow.indexOf(J)>=0?ee:iu(ee,t)}e instanceof Error&&(z.message=e.message)}if(z.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==P&&(z.$name=P),z}throw new Error("can't serialize object of type "+typeof e)}function Es(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Vu(e)||_l(e)||ArrayBuffer.isView(e)||e instanceof gl)return e;if(Array.isArray(e))return e.map(Es);if("object"==typeof e){var t=e.$name||"Object",r=Ro[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var f=Object.create(r.prototype),d=0,x=Object.keys(e);d<x.length;d+=1){var S=x[d];if("$name"!==S){var P=e[S];f[S]=Ro[t].shallow.indexOf(S)>=0?P:Es(P)}}return f}throw new Error("can't deserialize object of type "+typeof e)}var Xc=function(){this.first=!0};Xc.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var hn={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Yc(e){for(var t=0,r=e;t<r.length;t+=1)if(Oc(r[t].charCodeAt(0)))return!0;return!1}function Oc(e){return!(746!==e&&747!==e&&(e<4352||!(hn["Bopomofo Extended"](e)||hn.Bopomofo(e)||hn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||hn["CJK Compatibility Ideographs"](e)||hn["CJK Compatibility"](e)||hn["CJK Radicals Supplement"](e)||hn["CJK Strokes"](e)||!(!hn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||hn["CJK Unified Ideographs Extension A"](e)||hn["CJK Unified Ideographs"](e)||hn["Enclosed CJK Letters and Months"](e)||hn["Hangul Compatibility Jamo"](e)||hn["Hangul Jamo Extended-A"](e)||hn["Hangul Jamo Extended-B"](e)||hn["Hangul Jamo"](e)||hn["Hangul Syllables"](e)||hn.Hiragana(e)||hn["Ideographic Description Characters"](e)||hn.Kanbun(e)||hn["Kangxi Radicals"](e)||hn["Katakana Phonetic Extensions"](e)||hn.Katakana(e)&&12540!==e||!(!hn["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!hn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||hn["Unified Canadian Aboriginal Syllabics"](e)||hn["Unified Canadian Aboriginal Syllabics Extended"](e)||hn["Vertical Forms"](e)||hn["Yijing Hexagram Symbols"](e)||hn["Yi Syllables"](e)||hn["Yi Radicals"](e))))}function xl(e){return!(Oc(e)||(t=e,hn["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||hn["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||hn["Letterlike Symbols"](t)||hn["Number Forms"](t)||hn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||hn["Control Pictures"](t)&&9251!==t||hn["Optical Character Recognition"](t)||hn["Enclosed Alphanumerics"](t)||hn["Geometric Shapes"](t)||hn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||hn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||hn["CJK Symbols and Punctuation"](t)||hn.Katakana(t)||hn["Private Use Area"](t)||hn["CJK Compatibility Forms"](t)||hn["Small Form Variants"](t)||hn["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t));var t}function Ga(e){return e>=1424&&e<=2303||hn["Arabic Presentation Forms-A"](e)||hn["Arabic Presentation Forms-B"](e)}function Ts(e,t){return!(!t&&Ga(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||hn.Khmer(e))}function sc(e){for(var t=0,r=e;t<r.length;t+=1)if(Ga(r[t].charCodeAt(0)))return!0;return!1}var au=null,Ds="unavailable",Hs=null,Tf=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Ds="error"),au&&au(e)};function uc(){cf.fire(new oe("pluginStateChange",{pluginStatus:Ds,pluginURL:Hs}))}var cf=new Oe,Lc=function(){return Ds},Ws=function(){if("deferred"!==Ds||!Hs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ds="loading",uc(),Hs&&Pi({url:Hs},function(e){e?Tf(e):(Ds="loaded",uc())})},Cs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Ds||null!=Cs.applyArabicShaping},isLoading:function(){return"loading"===Ds},setState:function(e){Ds=e.pluginStatus,Hs=e.pluginURL},isParsed:function(){return null!=Cs.applyArabicShaping&&null!=Cs.processBidirectionalText&&null!=Cs.processStyledBidirectionalText},getPluginURL:function(){return Hs}},$i=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Xc,this.transition={})};$i.prototype.isSupportedScript=function(e){return function(t,r){for(var f=0,d=t;f<d.length;f+=1)if(!Ts(d[f].charCodeAt(0),r))return!1;return!0}(e,Cs.isLoaded())},$i.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},$i.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var xu=function(e,t){this.property=e,this.value=t,this.expression=function(r,f){if(Ju(r))return new Bu(r,f);if($u(r)){var d=dl(r,f);if("error"===d.result)throw new Error(d.value.map(function(S){return S.key+": "+S.message}).join(", "));return d.value}var x=r;return"string"==typeof r&&"color"===f.type&&(x=Xi.parse(r)),{kind:"constant",evaluate:function(){return x}}}(void 0===t?e.specification.default:t,e.specification)};xu.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},xu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Ns=function(e){this.property=e,this.value=new xu(e,void 0)};Ns.prototype.transitioned=function(e,t){return new nl(this.property,this.value,t,_t({},e.transition,this.transition),e.now)},Ns.prototype.untransitioned=function(){return new nl(this.property,this.value,null,{},0)};var Yo=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Yo.prototype.getValue=function(e){return Ue(this._values[e].value.value)},Yo.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ns(this._values[e].property)),this._values[e].value=new xu(this._values[e].property,null===t?void 0:Ue(t))},Yo.prototype.getTransition=function(e){return Ue(this._values[e].transition)},Yo.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Ns(this._values[e].property)),this._values[e].transition=Ue(t)||void 0},Yo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t],d=this.getValue(f);void 0!==d&&(e[f]=d);var x=this.getTransition(f);void 0!==x&&(e[f+"-transition"]=x)}return e},Yo.prototype.transitioned=function(e,t){for(var r=new bu(this._properties),f=0,d=Object.keys(this._values);f<d.length;f+=1){var x=d[f];r._values[x]=this._values[x].transitioned(e,t._values[x])}return r},Yo.prototype.untransitioned=function(){for(var e=new bu(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t];e._values[f]=this._values[f].untransitioned()}return e};var nl=function(e,t,r,f,d){this.property=e,this.value=t,this.begin=d+f.delay||0,this.end=this.begin+f.duration||0,e.specification.transition&&(f.delay||f.duration)&&(this.prior=r)};nl.prototype.possiblyEvaluate=function(e,t,r){var f=e.now||0,d=this.value.possiblyEvaluate(e,t,r),x=this.prior;if(x){if(f>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(f<this.begin)return x.possiblyEvaluate(e,t,r);var S=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(e,t,r),d,function(P){if(P<=0)return 0;if(P>=1)return 1;var z=P*P,J=z*P;return 4*(P<.5?J:3*(P-z)+J-.75)}(S))}return d};var bu=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};bu.prototype.possiblyEvaluate=function(e,t,r){for(var f=new il(this._properties),d=0,x=Object.keys(this._values);d<x.length;d+=1){var S=x[d];f._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return f},bu.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ou=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ou.prototype.getValue=function(e){return Ue(this._values[e].value)},ou.prototype.setValue=function(e,t){this._values[e]=new xu(this._values[e].property,null===t?void 0:Ue(t))},ou.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t],d=this.getValue(f);void 0!==d&&(e[f]=d)}return e},ou.prototype.possiblyEvaluate=function(e,t,r){for(var f=new il(this._properties),d=0,x=Object.keys(this._values);d<x.length;d+=1){var S=x[d];f._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return f};var mo=function(e,t,r){this.property=e,this.value=t,this.parameters=r};mo.prototype.isConstant=function(){return"constant"===this.value.kind},mo.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},mo.prototype.evaluate=function(e,t,r,f){return this.property.evaluate(this.value,this.parameters,e,t,r,f)};var il=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};il.prototype.get=function(e){return this._values[e]};var ri=function(e){this.specification=e};ri.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},ri.prototype.interpolate=function(e,t,r){var f=ko[this.specification.type];return f?f(e,t,r):e};var In=function(e,t){this.specification=e,this.overrides=t};In.prototype.possiblyEvaluate=function(e,t,r,f){return new mo(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,f)}:e.expression,t)},In.prototype.interpolate=function(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new mo(this,{kind:"constant",value:void 0},e.parameters);var f=ko[this.specification.type];return f?new mo(this,{kind:"constant",value:f(e.value.value,t.value.value,r)},e.parameters):e},In.prototype.evaluate=function(e,t,r,f,d,x){return"constant"===e.kind?e.value:e.evaluate(t,r,f,d,x)};var lc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,f,d,x){if(void 0===r.value)return new mo(this,{kind:"constant",value:void 0},f);if("constant"===r.expression.kind){var S=r.expression.evaluate(f,null,{},d,x),P="resolvedImage"===r.property.specification.type&&"string"!=typeof S?S.name:S,z=this._calculate(P,P,P,f);return new mo(this,{kind:"constant",value:z},f)}if("camera"===r.expression.kind){var J=this._calculate(r.expression.evaluate({zoom:f.zoom-1}),r.expression.evaluate({zoom:f.zoom}),r.expression.evaluate({zoom:f.zoom+1}),f);return new mo(this,{kind:"constant",value:J},f)}return new mo(this,r.expression,f)},t.prototype.evaluate=function(r,f,d,x,S,P){if("source"===r.kind){var z=r.evaluate(f,d,x,S,P);return this._calculate(z,z,z,f)}return"composite"===r.kind?this._calculate(r.evaluate({zoom:Math.floor(f.zoom)-1},d,x),r.evaluate({zoom:Math.floor(f.zoom)},d,x),r.evaluate({zoom:Math.floor(f.zoom)+1},d,x),f):r.value},t.prototype._calculate=function(r,f,d,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:r,to:f}:{from:d,to:f}},t.prototype.interpolate=function(r){return r},t}(In),wo=function(e){this.specification=e};wo.prototype.possiblyEvaluate=function(e,t,r,f){if(void 0!==e.value){if("constant"===e.expression.kind){var d=e.expression.evaluate(t,null,{},r,f);return this._calculate(d,d,d,t)}return this._calculate(e.expression.evaluate(new $i(Math.floor(t.zoom-1),t)),e.expression.evaluate(new $i(Math.floor(t.zoom),t)),e.expression.evaluate(new $i(Math.floor(t.zoom+1),t)),t)}},wo.prototype._calculate=function(e,t,r,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},wo.prototype.interpolate=function(e){return e};var Xs=function(e){this.specification=e};Xs.prototype.possiblyEvaluate=function(e,t,r,f){return!!e.expression.evaluate(t,null,{},r,f)},Xs.prototype.interpolate=function(){return!1};var Po=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var f=this.defaultPropertyValues[t]=new xu(r,void 0),d=this.defaultTransitionablePropertyValues[t]=new Ns(r);this.defaultTransitioningPropertyValues[t]=d.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=f.possiblyEvaluate({})}};Fn("DataDrivenProperty",In),Fn("DataConstantProperty",ri),Fn("CrossFadedDataDrivenProperty",lc),Fn("CrossFadedProperty",wo),Fn("ColorRampProperty",Xs);var fo=function(e){function t(r,f){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==r.type&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),f.layout&&(this._unevaluatedLayout=new ou(f.layout)),f.paint)){for(var d in this._transitionablePaint=new Yo(f.paint),r.paint)this.setPaintProperty(d,r.paint[d],{validate:!1});for(var x in r.layout)this.setLayoutProperty(x,r.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new il(f.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,f,d){void 0===d&&(d={}),null!=f&&this._validate(Vl,"layers."+this.id+".layout."+r,r,f,d)||("visibility"!==r?this._unevaluatedLayout.setValue(r,f):this.visibility=f)},t.prototype.getPaintProperty=function(r){return Q(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,f,d){if(void 0===d&&(d={}),null!=f&&this._validate(lf,"layers."+this.id+".paint."+r,r,f,d))return!1;if(Q(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),f||void 0),!1;var x=this._transitionablePaint._values[r],S="cross-faded-data-driven"===x.property.specification["property-type"],P=x.value.isDataDriven(),z=x.value;this._transitionablePaint.setValue(r,f),this._handleSpecialPaintPropertyUpdate(r);var J=this._transitionablePaint._values[r].value;return J.isDataDriven()||P||S||this._handleOverridablePaintPropertyUpdate(r,z,J)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,f,d){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,f){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,f)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),ot(r,function(f,d){return!(void 0===f||"layout"===d&&!Object.keys(f).length||"paint"===d&&!Object.keys(f).length)})},t.prototype._validate=function(r,f,d,x,S){return void 0===S&&(S={}),(!S||!1!==S.validate)&&ml(this,r.call(Mc,{key:f,layerType:this.type,objectKey:d,value:x,styleSpec:pe,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var f=this.paint.get(r);if(f instanceof mo&&Rs(f.property.specification)&&("source"===f.value.kind||"composite"===f.value.kind)&&f.value.isStateDependent)return!0}return!1},t}(Oe),jl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Gl=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Qi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function zo(e,t){void 0===t&&(t=1);var r=0,f=0;return{members:e.map(function(d){var x=jl[d.type].BYTES_PER_ELEMENT,S=r=ff(r,Math.max(t,x)),P=d.components||1;return f=Math.max(f,x),r+=x*P,{name:d.name,type:d.type,components:P,offset:S}}),size:ff(r,Math.max(f,t)),alignment:t}}function ff(e,t){return Math.ceil(e/t)*t}Qi.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Qi.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Qi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Qi.prototype.clear=function(){this.length=0},Qi.prototype.resize=function(e){this.reserve(e),this.length=e},Qi.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Qi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var As=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var d=this.length;return this.resize(d+1),this.emplace(d,r,f)},t.prototype.emplace=function(r,f,d){var x=2*r;return this.int16[x+0]=f,this.int16[x+1]=d,r},t}(Qi);As.prototype.bytesPerElement=4,Fn("StructArrayLayout2i4",As);var bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x){var S=this.length;return this.resize(S+1),this.emplace(S,r,f,d,x)},t.prototype.emplace=function(r,f,d,x,S){var P=4*r;return this.int16[P+0]=f,this.int16[P+1]=d,this.int16[P+2]=x,this.int16[P+3]=S,r},t}(Qi);bl.prototype.bytesPerElement=8,Fn("StructArrayLayout4i8",bl);var ys=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P){var z=this.length;return this.resize(z+1),this.emplace(z,r,f,d,x,S,P)},t.prototype.emplace=function(r,f,d,x,S,P,z){var J=6*r;return this.int16[J+0]=f,this.int16[J+1]=d,this.int16[J+2]=x,this.int16[J+3]=S,this.int16[J+4]=P,this.int16[J+5]=z,r},t}(Qi);ys.prototype.bytesPerElement=12,Fn("StructArrayLayout2i4i12",ys);var is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P){var z=this.length;return this.resize(z+1),this.emplace(z,r,f,d,x,S,P)},t.prototype.emplace=function(r,f,d,x,S,P,z){var J=4*r,ee=8*r;return this.int16[J+0]=f,this.int16[J+1]=d,this.uint8[ee+4]=x,this.uint8[ee+5]=S,this.uint8[ee+6]=P,this.uint8[ee+7]=z,r},t}(Qi);is.prototype.bytesPerElement=8,Fn("StructArrayLayout2i4ub8",is);var al=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var d=this.length;return this.resize(d+1),this.emplace(d,r,f)},t.prototype.emplace=function(r,f,d){var x=2*r;return this.float32[x+0]=f,this.float32[x+1]=d,r},t}(Qi);al.prototype.bytesPerElement=8,Fn("StructArrayLayout2f8",al);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee,ue){var ye=this.length;return this.resize(ye+1),this.emplace(ye,r,f,d,x,S,P,z,J,ee,ue)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue,ye){var Se=10*r;return this.uint16[Se+0]=f,this.uint16[Se+1]=d,this.uint16[Se+2]=x,this.uint16[Se+3]=S,this.uint16[Se+4]=P,this.uint16[Se+5]=z,this.uint16[Se+6]=J,this.uint16[Se+7]=ee,this.uint16[Se+8]=ue,this.uint16[Se+9]=ye,r},t}(Qi);su.prototype.bytesPerElement=20,Fn("StructArrayLayout10ui20",su);var Hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se){var qe=this.length;return this.resize(qe+1),this.emplace(qe,r,f,d,x,S,P,z,J,ee,ue,ye,Se)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe){var Je=12*r;return this.int16[Je+0]=f,this.int16[Je+1]=d,this.int16[Je+2]=x,this.int16[Je+3]=S,this.uint16[Je+4]=P,this.uint16[Je+5]=z,this.uint16[Je+6]=J,this.uint16[Je+7]=ee,this.int16[Je+8]=ue,this.int16[Je+9]=ye,this.int16[Je+10]=Se,this.int16[Je+11]=qe,r},t}(Qi);Hl.prototype.bytesPerElement=24,Fn("StructArrayLayout4i4ui4i24",Hl);var Sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,d)},t.prototype.emplace=function(r,f,d,x){var S=3*r;return this.float32[S+0]=f,this.float32[S+1]=d,this.float32[S+2]=x,r},t}(Qi);Sl.prototype.bytesPerElement=12,Fn("StructArrayLayout3f12",Sl);var Wl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.uint32[1*r+0]=f,r},t}(Qi);Wl.prototype.bytesPerElement=4,Fn("StructArrayLayout1ul4",Wl);var Kc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee){var ue=this.length;return this.resize(ue+1),this.emplace(ue,r,f,d,x,S,P,z,J,ee)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue){var ye=10*r,Se=5*r;return this.int16[ye+0]=f,this.int16[ye+1]=d,this.int16[ye+2]=x,this.int16[ye+3]=S,this.int16[ye+4]=P,this.int16[ye+5]=z,this.uint32[Se+3]=J,this.uint16[ye+8]=ee,this.uint16[ye+9]=ue,r},t}(Qi);Kc.prototype.bytesPerElement=20,Fn("StructArrayLayout6i1ul2ui20",Kc);var wl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P){var z=this.length;return this.resize(z+1),this.emplace(z,r,f,d,x,S,P)},t.prototype.emplace=function(r,f,d,x,S,P,z){var J=6*r;return this.int16[J+0]=f,this.int16[J+1]=d,this.int16[J+2]=x,this.int16[J+3]=S,this.int16[J+4]=P,this.int16[J+5]=z,r},t}(Qi);wl.prototype.bytesPerElement=12,Fn("StructArrayLayout2i2i2i12",wl);var ol=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S){var P=this.length;return this.resize(P+1),this.emplace(P,r,f,d,x,S)},t.prototype.emplace=function(r,f,d,x,S,P){var z=4*r,J=8*r;return this.float32[z+0]=f,this.float32[z+1]=d,this.float32[z+2]=x,this.int16[J+6]=S,this.int16[J+7]=P,r},t}(Qi);ol.prototype.bytesPerElement=16,Fn("StructArrayLayout2f1f2i16",ol);var kc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x){var S=this.length;return this.resize(S+1),this.emplace(S,r,f,d,x)},t.prototype.emplace=function(r,f,d,x,S){var P=12*r,z=3*r;return this.uint8[P+0]=f,this.uint8[P+1]=d,this.float32[z+1]=x,this.float32[z+2]=S,r},t}(Qi);kc.prototype.bytesPerElement=12,Fn("StructArrayLayout2ub2f12",kc);var sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,d)},t.prototype.emplace=function(r,f,d,x){var S=3*r;return this.uint16[S+0]=f,this.uint16[S+1]=d,this.uint16[S+2]=x,r},t}(Qi);sl.prototype.bytesPerElement=6,Fn("StructArrayLayout3ui6",sl);var ju=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Ct,st,zt){var Qt=this.length;return this.resize(Qt+1),this.emplace(Qt,r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Ct,st,zt)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Ct,st,zt,Qt){var yr=24*r,Sr=12*r,Rr=48*r;return this.int16[yr+0]=f,this.int16[yr+1]=d,this.uint16[yr+2]=x,this.uint16[yr+3]=S,this.uint32[Sr+2]=P,this.uint32[Sr+3]=z,this.uint32[Sr+4]=J,this.uint16[yr+10]=ee,this.uint16[yr+11]=ue,this.uint16[yr+12]=ye,this.float32[Sr+7]=Se,this.float32[Sr+8]=qe,this.uint8[Rr+36]=Je,this.uint8[Rr+37]=Ct,this.uint8[Rr+38]=st,this.uint32[Sr+10]=zt,this.int16[yr+22]=Qt,r},t}(Qi);ju.prototype.bytesPerElement=48,Fn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ju);var Xl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Ct,st,zt,Qt,yr,Sr,Rr,nn,gn,ii,Bn,fi,Zn,na){var wi=this.length;return this.resize(wi+1),this.emplace(wi,r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Ct,st,zt,Qt,yr,Sr,Rr,nn,gn,ii,Bn,fi,Zn,na)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Ct,st,zt,Qt,yr,Sr,Rr,nn,gn,ii,Bn,fi,Zn,na,wi){var Qn=34*r,da=17*r;return this.int16[Qn+0]=f,this.int16[Qn+1]=d,this.int16[Qn+2]=x,this.int16[Qn+3]=S,this.int16[Qn+4]=P,this.int16[Qn+5]=z,this.int16[Qn+6]=J,this.int16[Qn+7]=ee,this.uint16[Qn+8]=ue,this.uint16[Qn+9]=ye,this.uint16[Qn+10]=Se,this.uint16[Qn+11]=qe,this.uint16[Qn+12]=Je,this.uint16[Qn+13]=Ct,this.uint16[Qn+14]=st,this.uint16[Qn+15]=zt,this.uint16[Qn+16]=Qt,this.uint16[Qn+17]=yr,this.uint16[Qn+18]=Sr,this.uint16[Qn+19]=Rr,this.uint16[Qn+20]=nn,this.uint16[Qn+21]=gn,this.uint16[Qn+22]=ii,this.uint32[da+12]=Bn,this.float32[da+13]=fi,this.float32[da+14]=Zn,this.float32[da+15]=na,this.float32[da+16]=wi,r},t}(Qi);Xl.prototype.bytesPerElement=68,Fn("StructArrayLayout8i15ui1ul4f68",Xl);var Gu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.float32[1*r+0]=f,r},t}(Qi);Gu.prototype.bytesPerElement=4,Fn("StructArrayLayout1f4",Gu);var Bs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,d)},t.prototype.emplace=function(r,f,d,x){var S=3*r;return this.int16[S+0]=f,this.int16[S+1]=d,this.int16[S+2]=x,r},t}(Qi);Bs.prototype.bytesPerElement=6,Fn("StructArrayLayout3i6",Bs);var Rc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,d)},t.prototype.emplace=function(r,f,d,x){var S=4*r;return this.uint32[2*r+0]=f,this.uint16[S+2]=d,this.uint16[S+3]=x,r},t}(Qi);Rc.prototype.bytesPerElement=8,Fn("StructArrayLayout1ul2ui8",Rc);var cc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var d=this.length;return this.resize(d+1),this.emplace(d,r,f)},t.prototype.emplace=function(r,f,d){var x=2*r;return this.uint16[x+0]=f,this.uint16[x+1]=d,r},t}(Qi);cc.prototype.bytesPerElement=4,Fn("StructArrayLayout2ui4",cc);var fc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.uint16[1*r+0]=f,r},t}(Qi);fc.prototype.bytesPerElement=2,Fn("StructArrayLayout1ui2",fc);var El=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x){var S=this.length;return this.resize(S+1),this.emplace(S,r,f,d,x)},t.prototype.emplace=function(r,f,d,x,S){var P=4*r;return this.float32[P+0]=f,this.float32[P+1]=d,this.float32[P+2]=x,this.float32[P+3]=S,r},t}(Qi);El.prototype.bytesPerElement=16,Fn("StructArrayLayout4f16",El);var a=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new N(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Gl);a.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new a(this,r)},t}(Kc);Fn("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(f){this._structArray.uint8[this._pos1+37]=f},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(f){this._structArray.uint8[this._pos1+38]=f},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(f){this._structArray.uint32[this._pos4+10]=f},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Gl);o.prototype.size=48;var p=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new o(this,r)},t}(ju);Fn("PlacedSymbolArray",p);var b=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(f){this._structArray.uint32[this._pos4+12]=f},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Gl);b.prototype.size=68;var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new b(this,r)},t}(Xl);Fn("SymbolInstanceArray",E);var A=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Gu);Fn("GlyphOffsetArray",A);var B=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Bs);Fn("SymbolLineVertexArray",B);var $=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Gl);$.prototype.size=8;var he=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new $(this,r)},t}(Rc);Fn("FeatureIndexArray",he);var Ce=zo([{name:"a_pos",components:2,type:"Int16"}],4).members,Me=function(e){void 0===e&&(e=[]),this.segments=e};function ke(e,t){return 256*(e=W(Math.floor(e),0,255))+W(Math.floor(t),0,255)}Me.prototype.prepareSegment=function(e,t,r,f){var d=this.segments[this.segments.length-1];return e>Me.MAX_VERTEX_ARRAY_LENGTH&&Xe("Max vertices per segment is "+Me.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!d||d.vertexLength+e>Me.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==f)&&(d={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==f&&(d.sortKey=f),this.segments.push(d)),d},Me.prototype.get=function(){return this.segments},Me.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var f in r.vaos)r.vaos[f].destroy()}},Me.simpleSegment=function(e,t,r,f){return new Me([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:f,vaos:{},sortKey:0}])},Me.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Fn("SegmentVector",Me);var et=zo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),$e=m(function(e){e.exports=function(t,r){var f,d,x,S,P,z,J,ee;for(d=t.length-(f=3&t.length),x=r,P=3432918353,z=461845907,ee=0;ee<d;)J=255&t.charCodeAt(ee)|(255&t.charCodeAt(++ee))<<8|(255&t.charCodeAt(++ee))<<16|(255&t.charCodeAt(++ee))<<24,++ee,x=27492+(65535&(S=5*(65535&(x=(x^=J=(65535&(J=(J=(65535&J)*P+(((J>>>16)*P&65535)<<16)&4294967295)<<15|J>>>17))*z+(((J>>>16)*z&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(J=0,f){case 3:J^=(255&t.charCodeAt(ee+2))<<16;case 2:J^=(255&t.charCodeAt(ee+1))<<8;case 1:x^=J=(65535&(J=(J=(65535&(J^=255&t.charCodeAt(ee)))*P+(((J>>>16)*P&65535)<<16)&4294967295)<<15|J>>>17))*z+(((J>>>16)*z&65535)<<16)&4294967295}return x^=t.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}}),pt=m(function(e){e.exports=function(t,r){for(var f,d=t.length,x=r^d,S=0;d>=4;)f=1540483477*(65535&(f=255&t.charCodeAt(S)|(255&t.charCodeAt(++S))<<8|(255&t.charCodeAt(++S))<<16|(255&t.charCodeAt(++S))<<24))+((1540483477*(f>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),d-=4,++S;switch(d){case 3:x^=(255&t.charCodeAt(S+2))<<16;case 2:x^=(255&t.charCodeAt(S+1))<<8;case 1:x=1540483477*(65535&(x^=255&t.charCodeAt(S)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}}),Ke=$e,ft=pt;Ke.murmur3=$e,Ke.murmur2=ft;var It=function(){this.ids=[],this.positions=[],this.indexed=!1};It.prototype.add=function(e,t,r,f){this.ids.push(pr(e)),this.positions.push(t,r,f)},It.prototype.getPositions=function(e){for(var t=pr(e),r=0,f=this.ids.length-1;r<f;){var d=r+f>>1;this.ids[d]>=t?f=d:r=d+1}for(var x=[];this.ids[r]===t;)x.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return x},It.serialize=function(e,t){var r=new Float64Array(e.ids),f=new Uint32Array(e.positions);return function d(x,S,P,z){for(;P<z;){for(var J=x[P+z>>1],ee=P-1,ue=z+1;;){do{ee++}while(x[ee]<J);do{ue--}while(x[ue]>J);if(ee>=ue)break;nr(x,ee,ue),nr(S,3*ee,3*ue),nr(S,3*ee+1,3*ue+1),nr(S,3*ee+2,3*ue+2)}ue-P<z-ue?(d(x,S,P,ue),P=ue+1):(d(x,S,ue+1,z),z=ue)}}(r,f,0,r.length-1),t&&t.push(r.buffer,f.buffer),{ids:r,positions:f}},It.deserialize=function(e){var t=new It;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var Wt=Math.pow(2,53)-1;function pr(e){var t=+e;return!isNaN(t)&&t<=Wt?t:Ke(String(e))}function nr(e,t,r){var f=e[t];e[t]=e[r],e[r]=f}Fn("FeaturePositionMap",It);var br=function(e,t){this.gl=e.gl,this.location=t},Dr=function(e){function t(r,f){e.call(this,r,f),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(br),Qr=function(e){function t(r,f){e.call(this,r,f),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(br),Xr=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(br),dn=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(br),qn=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(br),Vn=function(e){function t(r,f){e.call(this,r,f),this.current=Xi.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(br),Nn=new Float32Array(16),Li=function(e){function t(r,f){e.call(this,r,f),this.current=Nn}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var f=1;f<16;f++)if(r[f]!==this.current[f]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(br);function Dn(e){return[ke(255*e.r,255*e.g),ke(255*e.b,255*e.a)]}var gi=function(e,t,r){this.value=e,this.uniformNames=t.map(function(f){return"u_"+f}),this.type=r};gi.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},gi.prototype.getBinding=function(e,t,r){return"color"===this.type?new Vn(e,t):new Qr(e,t)};var Vi=function(e,t){this.uniformNames=t.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Vi.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Vi.prototype.setUniform=function(e,t,r,f){var d="u_pattern_to"===f?this.patternTo:"u_pattern_from"===f?this.patternFrom:"u_pixel_ratio_to"===f?this.pixelRatioTo:"u_pixel_ratio_from"===f?this.pixelRatioFrom:null;d&&e.set(d)},Vi.prototype.getBinding=function(e,t,r){return"u_pattern"===r.substr(0,9)?new qn(e,t):new Qr(e,t)};var li=function(e,t,r,f){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(function(d){return{name:"a_"+d,type:"Float32",components:"color"===r?2:1,offset:0}}),this.paintVertexArray=new f};li.prototype.populatePaintArray=function(e,t,r,f,d){var x=this.paintVertexArray.length,S=this.expression.evaluate(new $i(0),t,{},f,[],d);this.paintVertexArray.resize(e),this._setPaintValue(x,e,S)},li.prototype.updatePaintArray=function(e,t,r,f){var d=this.expression.evaluate({zoom:0},r,f);this._setPaintValue(e,t,d)},li.prototype._setPaintValue=function(e,t,r){if("color"===this.type)for(var f=Dn(r),d=e;d<t;d++)this.paintVertexArray.emplace(d,f[0],f[1]);else{for(var x=e;x<t;x++)this.paintVertexArray.emplace(x,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},li.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},li.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var yi=function(e,t,r,f,d,x){this.expression=e,this.uniformNames=t.map(function(S){return"u_"+S+"_t"}),this.type=r,this.useIntegerZoom=f,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=t.map(function(S){return{name:"a_"+S,type:"Float32",components:"color"===r?4:2,offset:0}}),this.paintVertexArray=new x};yi.prototype.populatePaintArray=function(e,t,r,f,d){var x=this.expression.evaluate(new $i(this.zoom),t,{},f,[],d),S=this.expression.evaluate(new $i(this.zoom+1),t,{},f,[],d),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,x,S)},yi.prototype.updatePaintArray=function(e,t,r,f){var d=this.expression.evaluate({zoom:this.zoom},r,f),x=this.expression.evaluate({zoom:this.zoom+1},r,f);this._setPaintValue(e,t,d,x)},yi.prototype._setPaintValue=function(e,t,r,f){if("color"===this.type)for(var d=Dn(r),x=Dn(f),S=e;S<t;S++)this.paintVertexArray.emplace(S,d[0],d[1],x[0],x[1]);else{for(var P=e;P<t;P++)this.paintVertexArray.emplace(P,r,f);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(f))}},yi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},yi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},yi.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,f=W(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(f)},yi.prototype.getBinding=function(e,t,r){return new Qr(e,t)};var Fi=function(e,t,r,f,d,x){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=f,this.layerId=x,this.zoomInPaintVertexArray=new d,this.zoomOutPaintVertexArray=new d};Fi.prototype.populatePaintArray=function(e,t,r){var f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(f,e,t.patterns&&t.patterns[this.layerId],r)},Fi.prototype.updatePaintArray=function(e,t,r,f,d){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],d)},Fi.prototype._setPaintValues=function(e,t,r,f){if(f&&r){var d=f[r.min],x=f[r.mid],S=f[r.max];if(d&&x&&S)for(var P=e;P<t;P++)this.zoomInPaintVertexArray.emplace(P,x.tl[0],x.tl[1],x.br[0],x.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],x.pixelRatio,d.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,x.tl[0],x.tl[1],x.br[0],x.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],x.pixelRatio,S.pixelRatio)}},Fi.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,et.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,et.members,this.expression.isStateDependent))},Fi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var te=function(e,t,r){this.binders={},this._buffers=[];var f=[];for(var d in e.paint._values)if(r(d)){var x=e.paint.get(d);if(x instanceof mo&&Rs(x.property.specification)){var S=F(d,e.type),P=x.value,z=x.property.specification.type,J=x.property.useIntegerZoom,ee=x.property.specification["property-type"],ue="cross-faded"===ee||"cross-faded-data-driven"===ee;if("constant"===P.kind)this.binders[d]=ue?new Vi(P.value,S):new gi(P.value,S,z),f.push("/u_"+d);else if("source"===P.kind||ue){var ye=U(d,z,"source");this.binders[d]=ue?new Fi(P,z,J,t,ye,e.id):new li(P,S,z,ye),f.push("/a_"+d)}else{var Se=U(d,z,"composite");this.binders[d]=new yi(P,S,z,J,t,Se),f.push("/z_"+d)}}}this.cacheKey=f.sort().join("")};te.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof li||t instanceof yi?t.maxValue:0},te.prototype.populatePaintArrays=function(e,t,r,f,d){for(var x in this.binders){var S=this.binders[x];(S instanceof li||S instanceof yi||S instanceof Fi)&&S.populatePaintArray(e,t,r,f,d)}},te.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var f=this.binders[r];f instanceof Vi&&f.setConstantPatternPositions(e,t)}},te.prototype.updatePaintArrays=function(e,t,r,f,d){var x=!1;for(var S in e)for(var P=0,z=t.getPositions(S);P<z.length;P+=1){var J=z[P],ee=r.feature(J.index);for(var ue in this.binders){var ye=this.binders[ue];if((ye instanceof li||ye instanceof yi||ye instanceof Fi)&&!0===ye.expression.isStateDependent){var Se=f.paint.get(ue);ye.expression=Se.value,ye.updatePaintArray(J.start,J.end,ee,e[S],d),x=!0}}}return x},te.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof gi||r instanceof Vi)&&e.push.apply(e,r.uniformNames.map(function(f){return"#define HAS_UNIFORM_"+f}))}return e},te.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof li||r instanceof yi)for(var f=0;f<r.paintVertexAttributes.length;f++)e.push(r.paintVertexAttributes[f].name);else if(r instanceof Fi)for(var d=0;d<et.members.length;d++)e.push(et.members[d].name)}return e},te.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof gi||r instanceof Vi||r instanceof yi)for(var f=0,d=r.uniformNames;f<d.length;f+=1)e.push(d[f])}return e},te.prototype.getPaintVertexBuffers=function(){return this._buffers},te.prototype.getUniforms=function(e,t){var r=[];for(var f in this.binders){var d=this.binders[f];if(d instanceof gi||d instanceof Vi||d instanceof yi)for(var x=0,S=d.uniformNames;x<S.length;x+=1){var P=S[x];if(t[P]){var z=d.getBinding(e,t[P],P);r.push({name:P,property:f,binding:z})}}}return r},te.prototype.setUniforms=function(e,t,r,f){for(var d=0,x=t;d<x.length;d+=1){var S=x[d],P=S.name,z=S.property;this.binders[z].setUniform(S.binding,f,r.get(z),P)}},te.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Fi){var f=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(r instanceof li||r instanceof yi)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},te.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof li||r instanceof yi||r instanceof Fi)&&r.upload(e)}this.updatePaintBuffers()},te.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof li||t instanceof yi||t instanceof Fi)&&t.destroy()}};var ie=function(e,t,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var f=0,d=e;f<d.length;f+=1){var x=d[f];this.programConfigurations[x.id]=new te(x,t,r)}this.needsUpload=!1,this._featureMap=new It,this._bufferOffset=0};function F(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function U(e,t,r){var d={"line-pattern":{source:su,composite:su},"fill-pattern":{source:su,composite:su},"fill-extrusion-pattern":{source:su,composite:su}}[e];return d&&d[r]||{color:{source:al,composite:El},number:{source:Gu,composite:al}}[t][r]}ie.prototype.populatePaintArrays=function(e,t,r,f,d,x){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,t,f,d,x);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},ie.prototype.updatePaintArrays=function(e,t,r,f){for(var d=0,x=r;d<x.length;d+=1){var S=x[d];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(e,this._featureMap,t,S,f)||this.needsUpload}},ie.prototype.get=function(e){return this.programConfigurations[e]},ie.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},ie.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Fn("ConstantBinder",gi),Fn("CrossFadedConstantBinder",Vi),Fn("SourceExpressionBinder",li),Fn("CrossFadedCompositeBinder",Fi),Fn("CompositeExpressionBinder",yi),Fn("ProgramConfiguration",te,{omit:["_buffers"]}),Fn("ProgramConfigurationSet",ie);var de=Math.pow(2,14)-1,Te=-de-1;function mt(e){for(var t=8192/e.extent,r=e.loadGeometry(),f=0;f<r.length;f++)for(var d=r[f],x=0;x<d.length;x++){var S=d[x],P=Math.round(S.x*t),z=Math.round(S.y*t);S.x=W(P,Te,de),S.y=W(z,Te,de),(P<S.x||P>S.x+1||z<S.y||z>S.y+1)&&Xe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Nt(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?mt(e):[]}}function Lt(e,t,r,f,d){e.emplaceBack(2*t+(f+1)/2,2*r+(d+1)/2)}var lr=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new As,this.indexArray=new sl,this.segments=new Me,this.programConfigurations=new ie(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function jr(e,t){for(var r=0;r<e.length;r++)if(Ha(t,e[r]))return!0;for(var f=0;f<t.length;f++)if(Ha(e,t[f]))return!0;return!!Ci(e,t)}function Ln(e,t,r){return!!Ha(e,t)||!!ea(t,e,r)}function Xn(e,t){if(1===e.length)return ua(t,e[0]);for(var r=0;r<t.length;r++)for(var f=t[r],d=0;d<f.length;d++)if(Ha(e,f[d]))return!0;for(var x=0;x<e.length;x++)if(ua(t,e[x]))return!0;for(var S=0;S<t.length;S++)if(Ci(e,t[S]))return!0;return!1}function ni(e,t,r){if(e.length>1){if(Ci(e,t))return!0;for(var f=0;f<t.length;f++)if(ea(t[f],e,r))return!0}for(var d=0;d<e.length;d++)if(ea(e[d],t,r))return!0;return!1}function Ci(e,t){if(0===e.length||0===t.length)return!1;for(var r=0;r<e.length-1;r++)for(var f=e[r],d=e[r+1],x=0;x<t.length-1;x++)if(Si(f,d,t[x],t[x+1]))return!0;return!1}function Si(e,t,r,f){return Pt(e,r,f)!==Pt(t,r,f)&&Pt(e,t,r)!==Pt(e,t,f)}function ea(e,t,r){var f=r*r;if(1===t.length)return e.distSqr(t[0])<f;for(var d=1;d<t.length;d++)if(xa(e,t[d-1],t[d])<f)return!0;return!1}function xa(e,t,r){var f=t.distSqr(r);if(0===f)return e.distSqr(t);var d=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/f;return e.distSqr(d<0?t:d>1?r:r.sub(t)._mult(d)._add(t))}function ua(e,t){for(var r,f,d,x=!1,S=0;S<e.length;S++)for(var P=0,z=(r=e[S]).length-1;P<r.length;z=P++)(f=r[P]).y>t.y!=(d=r[z]).y>t.y&&t.x<(d.x-f.x)*(t.y-f.y)/(d.y-f.y)+f.x&&(x=!x);return x}function Ha(e,t){for(var r=!1,f=0,d=e.length-1;f<e.length;d=f++){var x=e[f],S=e[d];x.y>t.y!=S.y>t.y&&t.x<(S.x-x.x)*(t.y-x.y)/(S.y-x.y)+x.x&&(r=!r)}return r}function Wa(e,t,r){var f=r[0],d=r[2];if(e.x<f.x&&t.x<f.x||e.x>d.x&&t.x>d.x||e.y<f.y&&t.y<f.y||e.y>d.y&&t.y>d.y)return!1;var x=Pt(e,t,r[0]);return x!==Pt(e,t,r[1])||x!==Pt(e,t,r[2])||x!==Pt(e,t,r[3])}function Ka(e,t,r){var f=t.paint.get(e).value;return"constant"===f.kind?f.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ia(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function ga(e,t,r,f,d){if(!t[0]&&!t[1])return e;var x=N.convert(t)._mult(d);"viewport"===r&&x._rotate(-f);for(var S=[],P=0;P<e.length;P++)S.push(e[P].sub(x));return S}lr.prototype.populate=function(e,t,r){var f=this.layers[0],d=[],x=null;"circle"===f.type&&(x=f.layout.get("circle-sort-key"));for(var S=0,P=e;S<P.length;S+=1){var z=P[S],J=z.feature,ee=z.id,ue=z.index,ye=z.sourceLayerIndex,Se=this.layers[0]._featureFilter.needGeometry,qe=Nt(J,Se);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),qe,r)){var Je=x?x.evaluate(qe,{},r):void 0,Ct={id:ee,properties:J.properties,type:J.type,sourceLayerIndex:ye,index:ue,geometry:Se?qe.geometry:mt(J),patterns:{},sortKey:Je};d.push(Ct)}}x&&d.sort(function(gn,ii){return gn.sortKey-ii.sortKey});for(var st=0,zt=d;st<zt.length;st+=1){var Qt=zt[st],yr=Qt.geometry,Sr=Qt.index,Rr=Qt.sourceLayerIndex,nn=e[Sr].feature;this.addFeature(Qt,yr,Sr,r),t.featureIndex.insert(nn,yr,Sr,Rr,this.index)}},lr.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},lr.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},lr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},lr.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ce),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},lr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},lr.prototype.addFeature=function(e,t,r,f){for(var d=0,x=t;d<x.length;d+=1)for(var S=0,P=x[d];S<P.length;S+=1){var z=P[S],J=z.x,ee=z.y;if(!(J<0||J>=8192||ee<0||ee>=8192)){var ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),ye=ue.vertexLength;Lt(this.layoutVertexArray,J,ee,-1,-1),Lt(this.layoutVertexArray,J,ee,1,-1),Lt(this.layoutVertexArray,J,ee,1,1),Lt(this.layoutVertexArray,J,ee,-1,1),this.indexArray.emplaceBack(ye,ye+1,ye+2),this.indexArray.emplaceBack(ye,ye+3,ye+2),ue.vertexLength+=4,ue.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},f)},Fn("CircleBucket",lr,{omit:["layers"]});var la=new Po({"circle-sort-key":new In(pe.layout_circle["circle-sort-key"])}),no={paint:new Po({"circle-radius":new In(pe.paint_circle["circle-radius"]),"circle-color":new In(pe.paint_circle["circle-color"]),"circle-blur":new In(pe.paint_circle["circle-blur"]),"circle-opacity":new In(pe.paint_circle["circle-opacity"]),"circle-translate":new ri(pe.paint_circle["circle-translate"]),"circle-translate-anchor":new ri(pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ri(pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ri(pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new In(pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new In(pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new In(pe.paint_circle["circle-stroke-opacity"])}),layout:la},ki="undefined"!=typeof Float32Array?Float32Array:Array;function Ca(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ba(e,t,r){var f=t[0],d=t[1],x=t[2],S=t[3],P=t[4],z=t[5],J=t[6],ee=t[7],ue=t[8],ye=t[9],Se=t[10],qe=t[11],Je=t[12],Ct=t[13],st=t[14],zt=t[15],Qt=r[0],yr=r[1],Sr=r[2],Rr=r[3];return e[0]=Qt*f+yr*P+Sr*ue+Rr*Je,e[1]=Qt*d+yr*z+Sr*ye+Rr*Ct,e[2]=Qt*x+yr*J+Sr*Se+Rr*st,e[3]=Qt*S+yr*ee+Sr*qe+Rr*zt,e[4]=(Qt=r[4])*f+(yr=r[5])*P+(Sr=r[6])*ue+(Rr=r[7])*Je,e[5]=Qt*d+yr*z+Sr*ye+Rr*Ct,e[6]=Qt*x+yr*J+Sr*Se+Rr*st,e[7]=Qt*S+yr*ee+Sr*qe+Rr*zt,e[8]=(Qt=r[8])*f+(yr=r[9])*P+(Sr=r[10])*ue+(Rr=r[11])*Je,e[9]=Qt*d+yr*z+Sr*ye+Rr*Ct,e[10]=Qt*x+yr*J+Sr*Se+Rr*st,e[11]=Qt*S+yr*ee+Sr*qe+Rr*zt,e[12]=(Qt=r[12])*f+(yr=r[13])*P+(Sr=r[14])*ue+(Rr=r[15])*Je,e[13]=Qt*d+yr*z+Sr*ye+Rr*Ct,e[14]=Qt*x+yr*J+Sr*Se+Rr*st,e[15]=Qt*S+yr*ee+Sr*qe+Rr*zt,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var go,e,Yl=ba;function uu(e,t,r){var f=t[0],d=t[1],x=t[2],S=t[3];return e[0]=r[0]*f+r[4]*d+r[8]*x+r[12]*S,e[1]=r[1]*f+r[5]*d+r[9]*x+r[13]*S,e[2]=r[2]*f+r[6]*d+r[10]*x+r[14]*S,e[3]=r[3]*f+r[7]*d+r[11]*x+r[15]*S,e}go=new ki(3),ki!=Float32Array&&(go[0]=0,go[1]=0,go[2]=0),e=new ki(4),ki!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0);var Ko=(function(){var e=new ki(2);ki!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,no)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new lr(r)},t.prototype.queryRadius=function(r){var f=r;return Ka("circle-radius",this,f)+Ka("circle-stroke-width",this,f)+ia(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,f,d,x,S,P,z,J){for(var ee=ga(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),P.angle,z),ue=this.paint.get("circle-radius").evaluate(f,d)+this.paint.get("circle-stroke-width").evaluate(f,d),ye="map"===this.paint.get("circle-pitch-alignment"),Se=ye?ee:function(nn,gn){return nn.map(function(ii){return Su(ii,gn)})}(ee,J),qe=ye?ue*z:ue,Je=0,Ct=x;Je<Ct.length;Je+=1)for(var st=0,zt=Ct[Je];st<zt.length;st+=1){var Qt=zt[st],yr=ye?Qt:Su(Qt,J),Sr=qe,Rr=uu([],[Qt.x,Qt.y,0,1],J);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?Sr*=Rr[3]/P.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(Sr*=P.cameraToCenterDistance/Rr[3]),Ln(Se,yr,Sr))return!0}return!1},t}(fo));function Su(e,t){var r=uu([],[e.x,e.y,0,1],t);return new N(r[0]/r[3],r[1]/r[3])}var Hu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(lr);function ul(e,t,r,f){var d=t.width,x=t.height;if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==d*x*r)throw new RangeError("mismatched image size")}else f=new Uint8Array(d*x*r);return e.width=d,e.height=x,e.data=f,e}function Ys(e,t,r){var f=t.width,d=t.height;if(f!==e.width||d!==e.height){var x=ul({},{width:f,height:d},r);Kl(e,x,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,f),height:Math.min(e.height,d)},r),e.width=f,e.height=d,e.data=x.data}}function Kl(e,t,r,f,d,x){if(0===d.width||0===d.height)return t;if(d.width>e.width||d.height>e.height||r.x>e.width-d.width||r.y>e.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||f.x>t.width-d.width||f.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=e.data,P=t.data,z=0;z<d.height;z++)for(var J=((r.y+z)*e.width+r.x)*x,ee=((f.y+z)*t.width+f.x)*x,ue=0;ue<d.width*x;ue++)P[ee+ue]=S[J+ue];return t}Fn("HeatmapBucket",Hu,{omit:["layers"]});var Wu=function(e,t){ul(this,e,1,t)};Wu.prototype.resize=function(e){Ys(this,e,1)},Wu.prototype.clone=function(){return new Wu({width:this.width,height:this.height},new Uint8Array(this.data))},Wu.copy=function(e,t,r,f,d){Kl(e,t,r,f,d,1)};var ca=function(e,t){ul(this,e,4,t)};ca.prototype.resize=function(e){Ys(this,e,4)},ca.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},ca.prototype.clone=function(){return new ca({width:this.width,height:this.height},new Uint8Array(this.data))},ca.copy=function(e,t,r,f,d){Kl(e,t,r,f,d,4)},Fn("AlphaImage",Wu),Fn("RGBAImage",ca);var Hf={paint:new Po({"heatmap-radius":new In(pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new In(pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ri(pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Xs(pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ri(pe.paint_heatmap["heatmap-opacity"])})};function Tl(e){var t={},r=e.resolution||256,f=e.clips?e.clips.length:1,d=e.image||new ca({width:r,height:f}),x=function(qe,Je,Ct){t[e.evaluationKey]=Ct;var st=e.expression.evaluate(t);d.data[qe+Je+0]=Math.floor(255*st.r/st.a),d.data[qe+Je+1]=Math.floor(255*st.g/st.a),d.data[qe+Je+2]=Math.floor(255*st.b/st.a),d.data[qe+Je+3]=Math.floor(255*st.a)};if(e.clips)for(var S=0,P=0;S<f;++S,P+=4*r)for(var z=0,J=0;z<r;z++,J+=4){var ee=z/(r-1),ue=e.clips[S];x(P,J,ue.start*(1-ee)+ue.end*ee)}else for(var ye=0,Se=0;ye<r;ye++,Se+=4)x(0,Se,ye/(r-1));return d}var Wf=function(e){function t(r){e.call(this,r,Hf),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Hu(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){"heatmap-color"===r&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Tl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(fo),Ks={paint:new Po({"hillshade-illumination-direction":new ri(pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ri(pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ri(pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ri(pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ri(pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ri(pe.paint_hillshade["hillshade-accent-color"])})},xh=function(e){function t(r){e.call(this,r,Ks)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(fo),Dc=zo([{name:"a_pos",components:2,type:"Int16"}],4).members,hc=Cf,wp=Cf;function Cf(e,t,r){r=r||2;var f,d,x,S,P,z,J,ee=t&&t.length,ue=ee?t[0]*r:e.length,ye=Xf(e,0,ue,r,!0),Se=[];if(!ye||ye.next===ye.prev)return Se;if(ee&&(ye=function(Je,Ct,st,zt){var Qt,yr,Sr,Rr=[];for(Qt=0,yr=Ct.length;Qt<yr;Qt++)(Sr=Xf(Je,Ct[Qt]*zt,Qt<yr-1?Ct[Qt+1]*zt:Je.length,zt,!1))===Sr.next&&(Sr.steiner=!0),Rr.push(tp(Sr));for(Rr.sort(ep),Qt=0;Qt<Rr.length;Qt++)qs(Rr[Qt],st),st=ll(st,st.next);return st}(e,t,ye,r)),e.length>80*r){f=x=e[0],d=S=e[1];for(var qe=r;qe<ue;qe+=r)(P=e[qe])<f&&(f=P),(z=e[qe+1])<d&&(d=z),P>x&&(x=P),z>S&&(S=z);J=0!==(J=Math.max(x-f,S-d))?1/J:0}return qc(ye,Se,r,f,d,J),Se}function Xf(e,t,r,f,d){var x,S;if(d===Iu(e,t,r,f)>0)for(x=t;x<r;x+=f)S=Pf(x,e[x],e[x+1],S);else for(x=r-f;x>=t;x-=f)S=Pf(x,e[x],e[x+1],S);return S&&pc(S,S.next)&&(Bc(S),S=S.next),S}function ll(e,t){if(!e)return e;t||(t=e);var r,f=e;do{if(r=!1,f.steiner||!pc(f,f.next)&&0!==Eo(f.prev,f,f.next))f=f.next;else{if(Bc(f),(f=t=f.prev)===f.next)break;r=!0}}while(r||f!==t);return t}function qc(e,t,r,f,d,x,S){if(e){!S&&x&&function(ee,ue,ye,Se){var qe=ee;do{null===qe.z&&(qe.z=Sh(qe.x,qe.y,ue,ye,Se)),qe.prevZ=qe.prev,qe.nextZ=qe.next,qe=qe.next}while(qe!==ee);qe.prevZ.nextZ=null,qe.prevZ=null,function(Je){var Ct,st,zt,Qt,yr,Sr,Rr,nn,gn=1;do{for(st=Je,Je=null,yr=null,Sr=0;st;){for(Sr++,zt=st,Rr=0,Ct=0;Ct<gn&&(Rr++,zt=zt.nextZ);Ct++);for(nn=gn;Rr>0||nn>0&&zt;)0!==Rr&&(0===nn||!zt||st.z<=zt.z)?(Qt=st,st=st.nextZ,Rr--):(Qt=zt,zt=zt.nextZ,nn--),yr?yr.nextZ=Qt:Je=Qt,Qt.prevZ=yr,yr=Qt;st=zt}yr.nextZ=null,gn*=2}while(Sr>1)}(qe)}(e,f,d,x);for(var P,z,J=e;e.prev!==e.next;)if(P=e.prev,z=e.next,x?hf(e,f,d,x):$h(e))t.push(P.i/r),t.push(e.i/r),t.push(z.i/r),Bc(e),e=z.next,J=z.next;else if((e=z)===J){S?1===S?qc(e=bh(ll(e),t,r),t,r,f,d,x,2):2===S&&Qh(e,t,r,f,d,x):qc(ll(e),t,r,f,d,x,1);break}}}function $h(e){var t=e.prev,r=e,f=e.next;if(Eo(t,r,f)>=0)return!1;for(var d=e.next.next;d!==e.prev;){if(Jc(t.x,t.y,r.x,r.y,f.x,f.y,d.x,d.y)&&Eo(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function hf(e,t,r,f){var d=e.prev,x=e,S=e.next;if(Eo(d,x,S)>=0)return!1;for(var P=d.x>x.x?d.x>S.x?d.x:S.x:x.x>S.x?x.x:S.x,z=d.y>x.y?d.y>S.y?d.y:S.y:x.y>S.y?x.y:S.y,J=Sh(d.x<x.x?d.x<S.x?d.x:S.x:x.x<S.x?x.x:S.x,d.y<x.y?d.y<S.y?d.y:S.y:x.y<S.y?x.y:S.y,t,r,f),ee=Sh(P,z,t,r,f),ue=e.prevZ,ye=e.nextZ;ue&&ue.z>=J&&ye&&ye.z<=ee;){if(ue!==e.prev&&ue!==e.next&&Jc(d.x,d.y,x.x,x.y,S.x,S.y,ue.x,ue.y)&&Eo(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,ye!==e.prev&&ye!==e.next&&Jc(d.x,d.y,x.x,x.y,S.x,S.y,ye.x,ye.y)&&Eo(ye.prev,ye,ye.next)>=0))return!1;ye=ye.nextZ}for(;ue&&ue.z>=J;){if(ue!==e.prev&&ue!==e.next&&Jc(d.x,d.y,x.x,x.y,S.x,S.y,ue.x,ue.y)&&Eo(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;ye&&ye.z<=ee;){if(ye!==e.prev&&ye!==e.next&&Jc(d.x,d.y,x.x,x.y,S.x,S.y,ye.x,ye.y)&&Eo(ye.prev,ye,ye.next)>=0)return!1;ye=ye.nextZ}return!0}function bh(e,t,r){var f=e;do{var d=f.prev,x=f.next.next;!pc(d,x)&&wh(d,f,f.next,x)&&Nc(d,x)&&Nc(x,d)&&(t.push(d.i/r),t.push(f.i/r),t.push(x.i/r),Bc(f),Bc(f.next),f=e=x),f=f.next}while(f!==e);return ll(f)}function Qh(e,t,r,f,d,x){var S=e;do{for(var P=S.next.next;P!==S.prev;){if(S.i!==P.i&&Tp(S,P)){var z=pf(S,P);return S=ll(S,S.next),z=ll(z,z.next),qc(S,t,r,f,d,x),void qc(z,t,r,f,d,x)}P=P.next}S=S.next}while(S!==e)}function ep(e,t){return e.x-t.x}function qs(e,t){if(t=function(f,d){var x,S=d,P=f.x,z=f.y,J=-1/0;do{if(z<=S.y&&z>=S.next.y&&S.next.y!==S.y){var ee=S.x+(z-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(ee<=P&&ee>J){if(J=ee,ee===P){if(z===S.y)return S;if(z===S.next.y)return S.next}x=S.x<S.next.x?S:S.next}}S=S.next}while(S!==d);if(!x)return null;if(P===J)return x;var ue,ye=x,Se=x.x,qe=x.y,Je=1/0;S=x;do{P>=S.x&&S.x>=Se&&P!==S.x&&Jc(z<qe?P:J,z,Se,qe,z<qe?J:P,z,S.x,S.y)&&(ue=Math.abs(z-S.y)/(P-S.x),Nc(S,f)&&(ue<Je||ue===Je&&(S.x>x.x||S.x===x.x&&Ep(x,S)))&&(x=S,Je=ue)),S=S.next}while(S!==ye);return x}(e,t)){var r=pf(t,e);ll(t,t.next),ll(r,r.next)}}function Ep(e,t){return Eo(e.prev,e,t.prev)<0&&Eo(t.next,e,e.next)<0}function Sh(e,t,r,f,d){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*d)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-f)*d)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function tp(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Jc(e,t,r,f,d,x,S,P){return(d-S)*(t-P)-(e-S)*(x-P)>=0&&(e-S)*(f-P)-(r-S)*(t-P)>=0&&(r-S)*(x-P)-(d-S)*(f-P)>=0}function Tp(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,f){var d=r;do{if(d.i!==r.i&&d.next.i!==r.i&&d.i!==f.i&&d.next.i!==f.i&&wh(d,d.next,r,f))return!0;d=d.next}while(d!==r);return!1}(e,t)&&(Nc(e,t)&&Nc(t,e)&&function(r,f){var d=r,x=!1,S=(r.x+f.x)/2,P=(r.y+f.y)/2;do{d.y>P!=d.next.y>P&&d.next.y!==d.y&&S<(d.next.x-d.x)*(P-d.y)/(d.next.y-d.y)+d.x&&(x=!x),d=d.next}while(d!==r);return x}(e,t)&&(Eo(e.prev,e,t.prev)||Eo(e,t.prev,t))||pc(e,t)&&Eo(e.prev,e,e.next)>0&&Eo(t.prev,t,t.next)>0)}function Eo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function pc(e,t){return e.x===t.x&&e.y===t.y}function wh(e,t,r,f){var d=$c(Eo(e,t,r)),x=$c(Eo(e,t,f)),S=$c(Eo(r,f,e)),P=$c(Eo(r,f,t));return d!==x&&S!==P||!(0!==d||!Af(e,r,t))||!(0!==x||!Af(e,f,t))||!(0!==S||!Af(r,e,f))||!(0!==P||!Af(r,t,f))}function Af(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function $c(e){return e>0?1:e<0?-1:0}function Nc(e,t){return Eo(e.prev,e,e.next)<0?Eo(e,t,e.next)>=0&&Eo(e,e.prev,t)>=0:Eo(e,t,e.prev)<0||Eo(e,e.next,t)<0}function pf(e,t){var r=new df(e.i,e.x,e.y),f=new df(t.i,t.x,t.y),d=e.next,x=t.prev;return e.next=t,t.prev=e,r.next=d,d.prev=r,f.next=r,r.prev=f,x.next=f,f.prev=x,f}function Pf(e,t,r,f){var d=new df(e,t,r);return f?(d.next=f.next,d.prev=f,f.next.prev=d,f.next=d):(d.prev=d,d.next=d),d}function Bc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function df(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Iu(e,t,r,f){for(var d=0,x=t,S=r-f;x<r;x+=f)d+=(e[S]-e[x])*(e[x+1]+e[S+1]),S=x;return d}function Yf(e,t,r,f,d){!function x(S,P,z,J,ee){for(;J>z;){if(J-z>600){var ue=J-z+1,ye=P-z+1,Se=Math.log(ue),qe=.5*Math.exp(2*Se/3),Je=.5*Math.sqrt(Se*qe*(ue-qe)/ue)*(ye-ue/2<0?-1:1);x(S,P,Math.max(z,Math.floor(P-ye*qe/ue+Je)),Math.min(J,Math.floor(P+(ue-ye)*qe/ue+Je)),ee)}var Ct=S[P],st=z,zt=J;for(Cl(S,z,P),ee(S[J],Ct)>0&&Cl(S,z,J);st<zt;){for(Cl(S,st,zt),st++,zt--;ee(S[st],Ct)<0;)st++;for(;ee(S[zt],Ct)>0;)zt--}0===ee(S[z],Ct)?Cl(S,z,zt):Cl(S,++zt,J),zt<=P&&(z=zt+1),P<=zt&&(J=zt-1)}}(e,t,r||0,f||e.length-1,d||Eh)}function Cl(e,t,r){var f=e[t];e[t]=e[r],e[r]=f}function Eh(e,t){return e<t?-1:e>t?1:0}function If(e,t){var r=e.length;if(r<=1)return[e];for(var f,d,x=[],S=0;S<r;S++){var P=kt(e[S]);0!==P&&(e[S].area=Math.abs(P),void 0===d&&(d=P<0),d===P<0?(f&&x.push(f),f=[e[S]]):f.push(e[S]))}if(f&&x.push(f),t>1)for(var z=0;z<x.length;z++)x[z].length<=t||(Yf(x[z],t,1,x[z].length-1,Mf),x[z]=x[z].slice(0,t));return x}function Mf(e,t){return t.area-e.area}function Qc(e,t,r){for(var f=r.patternDependencies,d=!1,x=0,S=t;x<S.length;x+=1){var P=S[x].paint.get(e+"-pattern");P.isConstant()||(d=!0);var z=P.constantOr(null);z&&(d=!0,f[z.to]=!0,f[z.from]=!0)}return d}function vf(e,t,r,f,d){for(var x=d.patternDependencies,S=0,P=t;S<P.length;S+=1){var z=P[S],J=z.paint.get(e+"-pattern").value;if("constant"!==J.kind){var ee=J.evaluate({zoom:f-1},r,{},d.availableImages),ue=J.evaluate({zoom:f},r,{},d.availableImages),ye=J.evaluate({zoom:f+1},r,{},d.availableImages);ue=ue&&ue.name?ue.name:ue,ye=ye&&ye.name?ye.name:ye,x[ee=ee&&ee.name?ee.name:ee]=!0,x[ue]=!0,x[ye]=!0,r.patterns[z.id]={min:ee,mid:ue,max:ye}}}return r}Cf.deviation=function(e,t,r,f){var d=t&&t.length,x=Math.abs(Iu(e,0,d?t[0]*r:e.length,r));if(d)for(var S=0,P=t.length;S<P;S++)x-=Math.abs(Iu(e,t[S]*r,S<P-1?t[S+1]*r:e.length,r));var z=0;for(S=0;S<f.length;S+=3){var J=f[S]*r,ee=f[S+1]*r,ue=f[S+2]*r;z+=Math.abs((e[J]-e[ue])*(e[ee+1]-e[J+1])-(e[J]-e[ee])*(e[ue+1]-e[J+1]))}return 0===x&&0===z?0:Math.abs((z-x)/x)},Cf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},f=0,d=0;d<e.length;d++){for(var x=0;x<e[d].length;x++)for(var S=0;S<t;S++)r.vertices.push(e[d][x][S]);d>0&&r.holes.push(f+=e[d-1].length)}return r},hc.default=wp;var Fs=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new As,this.indexArray=new sl,this.indexArray2=new cc,this.programConfigurations=new ie(e.layers,e.zoom),this.segments=new Me,this.segments2=new Me,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Fs.prototype.populate=function(e,t,r){this.hasPattern=Qc("fill",this.layers,t);for(var f=this.layers[0].layout.get("fill-sort-key"),d=[],x=0,S=e;x<S.length;x+=1){var P=S[x],z=P.feature,J=P.id,ee=P.index,ue=P.sourceLayerIndex,ye=this.layers[0]._featureFilter.needGeometry,Se=Nt(z,ye);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),Se,r)){var qe=f?f.evaluate(Se,{},r,t.availableImages):void 0,Je={id:J,properties:z.properties,type:z.type,sourceLayerIndex:ue,index:ee,geometry:ye?Se.geometry:mt(z),patterns:{},sortKey:qe};d.push(Je)}}f&&d.sort(function(nn,gn){return nn.sortKey-gn.sortKey});for(var Ct=0,st=d;Ct<st.length;Ct+=1){var zt=st[Ct],Qt=zt.geometry,yr=zt.index,Sr=zt.sourceLayerIndex;if(this.hasPattern){var Rr=vf("fill",this.layers,zt,this.zoom,t);this.patternFeatures.push(Rr)}else this.addFeature(zt,Qt,yr,r,{});t.featureIndex.insert(e[yr].feature,Qt,yr,Sr,this.index)}},Fs.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Fs.prototype.addFeatures=function(e,t,r){for(var f=0,d=this.patternFeatures;f<d.length;f+=1){var x=d[f];this.addFeature(x,x.geometry,x.index,t,r)}},Fs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Fs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Fs.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Dc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Fs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Fs.prototype.addFeature=function(e,t,r,f,d){for(var x=0,S=If(t,500);x<S.length;x+=1){for(var P=S[x],z=0,J=0,ee=P;J<ee.length;J+=1)z+=ee[J].length;for(var ue=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),ye=ue.vertexLength,Se=[],qe=[],Je=0,Ct=P;Je<Ct.length;Je+=1){var st=Ct[Je];if(0!==st.length){st!==P[0]&&qe.push(Se.length/2);var zt=this.segments2.prepareSegment(st.length,this.layoutVertexArray,this.indexArray2),Qt=zt.vertexLength;this.layoutVertexArray.emplaceBack(st[0].x,st[0].y),this.indexArray2.emplaceBack(Qt+st.length-1,Qt),Se.push(st[0].x),Se.push(st[0].y);for(var yr=1;yr<st.length;yr++)this.layoutVertexArray.emplaceBack(st[yr].x,st[yr].y),this.indexArray2.emplaceBack(Qt+yr-1,Qt+yr),Se.push(st[yr].x),Se.push(st[yr].y);zt.vertexLength+=st.length,zt.primitiveLength+=st.length}}for(var Sr=hc(Se,qe),Rr=0;Rr<Sr.length;Rr+=3)this.indexArray.emplaceBack(ye+Sr[Rr],ye+Sr[Rr+1],ye+Sr[Rr+2]);ue.vertexLength+=z,ue.primitiveLength+=Sr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,f)},Fn("FillBucket",Fs,{omit:["layers","patternFeatures"]});var Kf=new Po({"fill-sort-key":new In(pe.layout_fill["fill-sort-key"])}),_s={paint:new Po({"fill-antialias":new ri(pe.paint_fill["fill-antialias"]),"fill-opacity":new In(pe.paint_fill["fill-opacity"]),"fill-color":new In(pe.paint_fill["fill-color"]),"fill-outline-color":new In(pe.paint_fill["fill-outline-color"]),"fill-translate":new ri(pe.paint_fill["fill-translate"]),"fill-translate-anchor":new ri(pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new lc(pe.paint_fill["fill-pattern"])}),layout:Kf},ql=function(e){function t(r){e.call(this,r,_s)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,f){e.prototype.recalculate.call(this,r,f);var d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Fs(r)},t.prototype.queryRadius=function(){return ia(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,f,d,x,S,P,z){return Xn(ga(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),P.angle,z),x)},t.prototype.isTileClipped=function(){return!0},t}(fo),mf=zo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ef=Js;function Js(e,t,r,f,d){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=f,this._values=d,e.readFields(Of,this,t)}function Of(e,t,r){1==e?t.id=r.readVarint():2==e?function(f,d){for(var x=f.readVarint()+f.pos;f.pos<x;){var S=d._keys[f.readVarint()],P=d._values[f.readVarint()];d.properties[S]=P}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function qf(e){for(var t,r,f=0,d=0,x=e.length,S=x-1;d<x;S=d++)f+=((r=e[S]).x-(t=e[d]).x)*(t.y+r.y);return f}Js.types=["Unknown","Point","LineString","Polygon"],Js.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,f=1,d=0,x=0,S=0,P=[];e.pos<r;){if(d<=0){var z=e.readVarint();f=7&z,d=z>>3}if(d--,1===f||2===f)x+=e.readSVarint(),S+=e.readSVarint(),1===f&&(t&&P.push(t),t=[]),t.push(new N(x,S));else{if(7!==f)throw new Error("unknown command "+f);t&&t.push(t[0].clone())}}return t&&P.push(t),P},Js.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,f=0,d=0,x=0,S=1/0,P=-1/0,z=1/0,J=-1/0;e.pos<t;){if(f<=0){var ee=e.readVarint();r=7&ee,f=ee>>3}if(f--,1===r||2===r)(d+=e.readSVarint())<S&&(S=d),d>P&&(P=d),(x+=e.readSVarint())<z&&(z=x),x>J&&(J=x);else if(7!==r)throw new Error("unknown command "+r)}return[S,z,P,J]},Js.prototype.toGeoJSON=function(e,t,r){var f,d,x=this.extent*Math.pow(2,r),S=this.extent*e,P=this.extent*t,z=this.loadGeometry(),J=Js.types[this.type];function ee(Se){for(var qe=0;qe<Se.length;qe++){var Je=Se[qe];Se[qe]=[360*(Je.x+S)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(Je.y+P)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var ue=[];for(f=0;f<z.length;f++)ue[f]=z[f][0];ee(z=ue);break;case 2:for(f=0;f<z.length;f++)ee(z[f]);break;case 3:for(z=function(Se){var qe=Se.length;if(qe<=1)return[Se];for(var Je,Ct,st=[],zt=0;zt<qe;zt++){var Qt=qf(Se[zt]);0!==Qt&&(void 0===Ct&&(Ct=Qt<0),Ct===Qt<0?(Je&&st.push(Je),Je=[Se[zt]]):Je.push(Se[zt]))}return Je&&st.push(Je),st}(z),f=0;f<z.length;f++)for(d=0;d<z[f].length;d++)ee(z[f][d])}1===z.length?z=z[0]:J="Multi"+J;var ye={type:"Feature",geometry:{type:J,coordinates:z},properties:this.properties};return"id"in this&&(ye.id=this.id),ye};var Cp=rp;function rp(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(tf,this,t),this.length=this._features.length}function tf(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(f){for(var d=null,x=f.readVarint()+f.pos;f.pos<x;){var S=f.readVarint()>>3;d=1===S?f.readString():2===S?f.readFloat():3===S?f.readDouble():4===S?f.readVarint64():5===S?f.readVarint():6===S?f.readSVarint():7===S?f.readBoolean():null}return d}(r))}function rf(e,t,r){if(3===e){var f=new Cp(r,r.readVarint()+r.pos);f.length&&(t[f.name]=f)}}rp.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ef(this._pbf,t,this.extent,this._keys,this._values)};var gf={VectorTile:function(e,t){this.layers=e.readFields(rf,{},t)},VectorTileFeature:ef,VectorTileLayer:Cp},Th=gf.VectorTileFeature.types,Jf=Math.pow(2,13);function lu(e,t,r,f,d,x,S,P){e.emplaceBack(t,r,2*Math.floor(f*Jf)+S,d*Jf*2,x*Jf*2,Math.round(P))}var Ps=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ys,this.indexArray=new sl,this.programConfigurations=new ie(e.layers,e.zoom),this.segments=new Me,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Fc(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ps.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Qc("fill-extrusion",this.layers,t);for(var f=0,d=e;f<d.length;f+=1){var x=d[f],S=x.feature,P=x.id,z=x.index,J=x.sourceLayerIndex,ee=this.layers[0]._featureFilter.needGeometry,ue=Nt(S,ee);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),ue,r)){var ye={id:P,sourceLayerIndex:J,index:z,geometry:ee?ue.geometry:mt(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(vf("fill-extrusion",this.layers,ye,this.zoom,t)):this.addFeature(ye,ye.geometry,z,r,{}),t.featureIndex.insert(S,ye.geometry,z,J,this.index,!0)}}},Ps.prototype.addFeatures=function(e,t,r){for(var f=0,d=this.features;f<d.length;f+=1){var x=d[f];this.addFeature(x,x.geometry,x.index,t,r)}},Ps.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ps.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ps.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mf),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ps.prototype.addFeature=function(e,t,r,f,d){for(var x=0,S=If(t,500);x<S.length;x+=1){for(var P=S[x],z=0,J=0,ee=P;J<ee.length;J+=1)z+=ee[J].length;for(var ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ye=0,Se=P;ye<Se.length;ye+=1){var qe=Se[ye];if(0!==qe.length&&!((da=qe).every(function(Ki){return Ki.x<0})||da.every(function(Ki){return Ki.x>8192})||da.every(function(Ki){return Ki.y<0})||da.every(function(Ki){return Ki.y>8192})))for(var Je=0,Ct=0;Ct<qe.length;Ct++){var st=qe[Ct];if(Ct>=1){var zt=qe[Ct-1];if(!Fc(st,zt)){ue.vertexLength+4>Me.MAX_VERTEX_ARRAY_LENGTH&&(ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Qt=st.sub(zt)._perp()._unit(),yr=zt.dist(st);Je+yr>32768&&(Je=0),lu(this.layoutVertexArray,st.x,st.y,Qt.x,Qt.y,0,0,Je),lu(this.layoutVertexArray,st.x,st.y,Qt.x,Qt.y,0,1,Je),lu(this.layoutVertexArray,zt.x,zt.y,Qt.x,Qt.y,0,0,Je+=yr),lu(this.layoutVertexArray,zt.x,zt.y,Qt.x,Qt.y,0,1,Je);var Sr=ue.vertexLength;this.indexArray.emplaceBack(Sr,Sr+2,Sr+1),this.indexArray.emplaceBack(Sr+1,Sr+2,Sr+3),ue.vertexLength+=4,ue.primitiveLength+=2}}}}if(ue.vertexLength+z>Me.MAX_VERTEX_ARRAY_LENGTH&&(ue=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),"Polygon"===Th[e.type]){for(var Rr=[],nn=[],gn=ue.vertexLength,ii=0,Bn=P;ii<Bn.length;ii+=1){var fi=Bn[ii];if(0!==fi.length){fi!==P[0]&&nn.push(Rr.length/2);for(var Zn=0;Zn<fi.length;Zn++){var na=fi[Zn];lu(this.layoutVertexArray,na.x,na.y,0,0,1,1,0),Rr.push(na.x),Rr.push(na.y)}}}for(var wi=hc(Rr,nn),Qn=0;Qn<wi.length;Qn+=3)this.indexArray.emplaceBack(gn+wi[Qn],gn+wi[Qn+2],gn+wi[Qn+1]);ue.primitiveLength+=wi.length/3,ue.vertexLength+=z}}var da;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,f)},Fn("FillExtrusionBucket",Ps,{omit:["layers","features"]});var Mu={paint:new Po({"fill-extrusion-opacity":new ri(pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new In(pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ri(pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ri(pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lc(pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new In(pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new In(pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ri(pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Ch=function(e){function t(r){e.call(this,r,Mu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Ps(r)},t.prototype.queryRadius=function(){return ia(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,f,d,x,S,P,z,J){var ee=ga(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),P.angle,z),ue=this.paint.get("fill-extrusion-height").evaluate(f,d),ye=this.paint.get("fill-extrusion-base").evaluate(f,d),Se=function(Je,Ct,st,zt){for(var Qt=[],yr=0,Sr=Je;yr<Sr.length;yr+=1){var Rr=Sr[yr],nn=[Rr.x,Rr.y,0,1];uu(nn,nn,Ct),Qt.push(new N(nn[0]/nn[3],nn[1]/nn[3]))}return Qt}(ee,J),qe=function(Je,Ct,st,zt){for(var Qt=[],yr=[],Sr=zt[8]*Ct,Rr=zt[9]*Ct,nn=zt[10]*Ct,gn=zt[11]*Ct,ii=zt[8]*st,Bn=zt[9]*st,fi=zt[10]*st,Zn=zt[11]*st,na=0,wi=Je;na<wi.length;na+=1){for(var Qn=[],da=[],Ki=0,Aa=wi[na];Ki<Aa.length;Ki+=1){var di=Aa[Ki],Ra=di.x,Co=di.y,Ao=zt[0]*Ra+zt[4]*Co+zt[12],Do=zt[1]*Ra+zt[5]*Co+zt[13],ho=zt[2]*Ra+zt[6]*Co+zt[14],Oo=zt[3]*Ra+zt[7]*Co+zt[15],xs=ho+nn,bs=Oo+gn,fu=Ao+ii,Ms=Do+Bn,hu=ho+fi,No=Oo+Zn,Os=new N((Ao+Sr)/bs,(Do+Rr)/bs);Os.z=xs/bs,Qn.push(Os);var Sa=new N(fu/No,Ms/No);Sa.z=hu/No,da.push(Sa)}Qt.push(Qn),yr.push(da)}return[Qt,yr]}(x,ye,ue,J);return function(Je,Ct,st){var zt=1/0;Xn(st,Ct)&&(zt=Jl(st,Ct[0]));for(var Qt=0;Qt<Ct.length;Qt++)for(var yr=Ct[Qt],Sr=Je[Qt],Rr=0;Rr<yr.length-1;Rr++){var nn=yr[Rr],gn=[nn,yr[Rr+1],Sr[Rr+1],Sr[Rr],nn];jr(st,gn)&&(zt=Math.min(zt,Jl(st,gn)))}return zt!==1/0&&zt}(qe[0],qe[1],Se)},t}(fo);function Al(e,t){return e.x*t.x+e.y*t.y}function Jl(e,t){if(1===e.length){for(var r,f=0,d=t[f++];!r||d.equals(r);)if(!(r=t[f++]))return 1/0;for(;f<t.length;f++){var x=t[f],S=e[0],P=r.sub(d),z=x.sub(d),J=S.sub(d),ee=Al(P,P),ue=Al(P,z),ye=Al(z,z),Se=Al(J,P),qe=Al(J,z),Je=ee*ye-ue*ue,Ct=(ye*Se-ue*qe)/Je,st=(ee*qe-ue*Se)/Je,zt=d.z*(1-Ct-st)+r.z*Ct+x.z*st;if(isFinite(zt))return zt}return 1/0}for(var Qt=1/0,yr=0,Sr=t;yr<Sr.length;yr+=1)Qt=Math.min(Qt,Sr[yr].z);return Qt}var Ah=zo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,$f=zo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,yf=gf.VectorTileFeature.types,Lf=Math.cos(Math.PI/180*37.5),as=Math.pow(2,14)/.5,Zo=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){t.gradients[r.id]={}}),this.layoutVertexArray=new is,this.layoutVertexArray2=new al,this.indexArray=new sl,this.programConfigurations=new ie(e.layers,e.zoom),this.segments=new Me,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Zo.prototype.populate=function(e,t,r){this.hasPattern=Qc("line",this.layers,t);for(var f=this.layers[0].layout.get("line-sort-key"),d=[],x=0,S=e;x<S.length;x+=1){var P=S[x],z=P.feature,J=P.id,ee=P.index,ue=P.sourceLayerIndex,ye=this.layers[0]._featureFilter.needGeometry,Se=Nt(z,ye);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),Se,r)){var qe=f?f.evaluate(Se,{},r):void 0,Je={id:J,properties:z.properties,type:z.type,sourceLayerIndex:ue,index:ee,geometry:ye?Se.geometry:mt(z),patterns:{},sortKey:qe};d.push(Je)}}f&&d.sort(function(nn,gn){return nn.sortKey-gn.sortKey});for(var Ct=0,st=d;Ct<st.length;Ct+=1){var zt=st[Ct],Qt=zt.geometry,yr=zt.index,Sr=zt.sourceLayerIndex;if(this.hasPattern){var Rr=vf("line",this.layers,zt,this.zoom,t);this.patternFeatures.push(Rr)}else this.addFeature(zt,Qt,yr,r,{});t.featureIndex.insert(e[yr].feature,Qt,yr,Sr,this.index)}},Zo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Zo.prototype.addFeatures=function(e,t,r){for(var f=0,d=this.patternFeatures;f<d.length;f+=1){var x=d[f];this.addFeature(x,x.geometry,x.index,t,r)}},Zo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Zo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zo.prototype.upload=function(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,$f)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ah),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Zo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zo.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Zo.prototype.addFeature=function(e,t,r,f,d){var x=this.layers[0].layout,S=x.get("line-join").evaluate(e,{}),P=x.get("line-cap"),z=x.get("line-miter-limit"),J=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var ee=0,ue=t;ee<ue.length;ee+=1)this.addLine(ue[ee],e,S,P,z,J);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,f)},Zo.prototype.addLine=function(e,t,r,f,d,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<e.length-1;S++)this.totalDistance+=e[S].dist(e[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var P="Polygon"===yf[t.type],z=e.length;z>=2&&e[z-1].equals(e[z-2]);)z--;for(var J=0;J<z-1&&e[J].equals(e[J+1]);)J++;if(!(z<(P?3:2))){"bevel"===r&&(d=1.05);var ee,ue=this.overscaling<=16?122880/(512*this.overscaling):0,ye=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray),Se=void 0,qe=void 0,Je=void 0,Ct=void 0;this.e1=this.e2=-1,P&&(Ct=e[J].sub(ee=e[z-2])._unit()._perp());for(var st=J;st<z;st++)if(!(qe=st===z-1?P?e[J+1]:void 0:e[st+1])||!e[st].equals(qe)){Ct&&(Je=Ct),ee&&(Se=ee),ee=e[st],Ct=qe?qe.sub(ee)._unit()._perp():Je;var zt=(Je=Je||Ct).add(Ct);0===zt.x&&0===zt.y||zt._unit();var Qt=Je.x*Ct.x+Je.y*Ct.y,yr=zt.x*Ct.x+zt.y*Ct.y,Sr=0!==yr?1/yr:1/0,Rr=2*Math.sqrt(2-2*yr),nn=yr<Lf&&Se&&qe,gn=Je.x*Ct.y-Je.y*Ct.x>0;if(nn&&st>J){var ii=ee.dist(Se);if(ii>2*ue){var Bn=ee.sub(ee.sub(Se)._mult(ue/ii)._round());this.updateDistance(Se,Bn),this.addCurrentVertex(Bn,Je,0,0,ye),Se=Bn}}var fi=Se&&qe,Zn=fi?r:P?"butt":f;if(fi&&"round"===Zn&&(Sr<x?Zn="miter":Sr<=2&&(Zn="fakeround")),"miter"===Zn&&Sr>d&&(Zn="bevel"),"bevel"===Zn&&(Sr>2&&(Zn="flipbevel"),Sr<d&&(Zn="miter")),Se&&this.updateDistance(Se,ee),"miter"===Zn)zt._mult(Sr),this.addCurrentVertex(ee,zt,0,0,ye);else if("flipbevel"===Zn){if(Sr>100)zt=Ct.mult(-1);else{var na=Sr*Je.add(Ct).mag()/Je.sub(Ct).mag();zt._perp()._mult(na*(gn?-1:1))}this.addCurrentVertex(ee,zt,0,0,ye),this.addCurrentVertex(ee,zt.mult(-1),0,0,ye)}else if("bevel"===Zn||"fakeround"===Zn){var wi=-Math.sqrt(Sr*Sr-1),Qn=gn?wi:0,da=gn?0:wi;if(Se&&this.addCurrentVertex(ee,Je,Qn,da,ye),"fakeround"===Zn)for(var Ki=Math.round(180*Rr/Math.PI/20),Aa=1;Aa<Ki;Aa++){var di=Aa/Ki;if(.5!==di){var Ra=di-.5;di+=di*Ra*(di-1)*((1.0904+Qt*(Qt*(3.55645-1.43519*Qt)-3.2452))*Ra*Ra+(.848013+Qt*(.215638*Qt-1.06021)))}var Co=Ct.sub(Je)._mult(di)._add(Je)._unit()._mult(gn?-1:1);this.addHalfVertex(ee,Co.x,Co.y,!1,gn,0,ye)}qe&&this.addCurrentVertex(ee,Ct,-Qn,-da,ye)}else if("butt"===Zn)this.addCurrentVertex(ee,zt,0,0,ye);else if("square"===Zn){var Ao=Se?1:-1;this.addCurrentVertex(ee,zt,Ao,Ao,ye)}else"round"===Zn&&(Se&&(this.addCurrentVertex(ee,Je,0,0,ye),this.addCurrentVertex(ee,Je,1,1,ye,!0)),qe&&(this.addCurrentVertex(ee,Ct,-1,-1,ye,!0),this.addCurrentVertex(ee,Ct,0,0,ye)));if(nn&&st<z-1){var Do=ee.dist(qe);if(Do>2*ue){var ho=ee.add(qe.sub(ee)._mult(ue/Do)._round());this.updateDistance(ee,ho),this.addCurrentVertex(ho,Ct,0,0,ye),ee=ho}}}}},Zo.prototype.addCurrentVertex=function(e,t,r,f,d,x){void 0===x&&(x=!1);var S=t.y*f-t.x,P=-t.y-t.x*f;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,x,!1,r,d),this.addHalfVertex(e,S,P,x,!0,-f,d),this.distance>as/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,t,r,f,d,x))},Zo.prototype.addHalfVertex=function(e,t,r,f,d,x,S){var P=.5*(this.lineClips?this.scaledDistance*(as-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(f?1:0),(e.y<<1)+(d?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(0===x?0:x<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var z=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),S.primitiveLength++),d?this.e2=z:this.e1=z},Zo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Zo.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Fn("LineBucket",Zo,{omit:["layers","patternFeatures"]});var os=new Po({"line-cap":new ri(pe.layout_line["line-cap"]),"line-join":new In(pe.layout_line["line-join"]),"line-miter-limit":new ri(pe.layout_line["line-miter-limit"]),"line-round-limit":new ri(pe.layout_line["line-round-limit"]),"line-sort-key":new In(pe.layout_line["line-sort-key"])}),cu={paint:new Po({"line-opacity":new In(pe.paint_line["line-opacity"]),"line-color":new In(pe.paint_line["line-color"]),"line-translate":new ri(pe.paint_line["line-translate"]),"line-translate-anchor":new ri(pe.paint_line["line-translate-anchor"]),"line-width":new In(pe.paint_line["line-width"]),"line-gap-width":new In(pe.paint_line["line-gap-width"]),"line-offset":new In(pe.paint_line["line-offset"]),"line-blur":new In(pe.paint_line["line-blur"]),"line-dasharray":new wo(pe.paint_line["line-dasharray"]),"line-pattern":new lc(pe.paint_line["line-pattern"]),"line-gradient":new Xs(pe.paint_line["line-gradient"])}),layout:os},Ph=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,f){return f=new $i(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),e.prototype.possiblyEvaluate.call(this,r,f)},t.prototype.evaluate=function(r,f,d,x){return f=_t({},f,{zoom:Math.floor(f.zoom)}),e.prototype.evaluate.call(this,r,f,d,x)},t}(In))(cu.paint.properties["line-width"].specification);Ph.useIntegerZoom=!0;var Ap=function(e){function t(r){e.call(this,r,cu),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){"line-gradient"===r&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof gs,this.gradientVersion=(this.gradientVersion+1)%be)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,f){e.prototype.recalculate.call(this,r,f),this.paint._values["line-floorwidth"]=Ph.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Zo(r)},t.prototype.queryRadius=function(r){var f=r,d=np(Ka("line-width",this,f),Ka("line-gap-width",this,f)),x=Ka("line-offset",this,f);return d/2+Math.abs(x)+ia(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,f,d,x,S,P,z){var J=ga(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),P.angle,z),ee=z/2*np(this.paint.get("line-width").evaluate(f,d),this.paint.get("line-gap-width").evaluate(f,d)),ue=this.paint.get("line-offset").evaluate(f,d);return ue&&(x=function(ye,Se){for(var qe=[],Je=new N(0,0),Ct=0;Ct<ye.length;Ct++){for(var st=ye[Ct],zt=[],Qt=0;Qt<st.length;Qt++){var yr=st[Qt],Sr=st[Qt+1],Rr=0===Qt?Je:yr.sub(st[Qt-1])._unit()._perp(),nn=Qt===st.length-1?Je:Sr.sub(yr)._unit()._perp(),gn=Rr._add(nn)._unit();gn._mult(1/(gn.x*nn.x+gn.y*nn.y)),zt.push(gn._mult(Se)._add(yr))}qe.push(zt)}return qe}(x,ue*z)),function(ye,Se,qe){for(var Je=0;Je<Se.length;Je++){var Ct=Se[Je];if(ye.length>=3)for(var st=0;st<Ct.length;st++)if(Ha(ye,Ct[st]))return!0;if(ni(ye,Ct,qe))return!0}return!1}(J,x,ee)},t.prototype.isTileClipped=function(){return!0},t}(fo);function np(e,t){return t>0?t+2*e:e}var $p=zo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Qp=zo([{name:"a_projected_pos",components:3,type:"Float32"}],4),Pp=(zo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),zo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Ip=(zo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),zo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Mp=zo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ed(e,t,r){return e.sections.forEach(function(f){var d,S,P;f.text=(d=f.text,S=r,"uppercase"===(P=t.layout.get("text-transform").evaluate(S,{}))?d=d.toLocaleUpperCase():"lowercase"===P&&(d=d.toLocaleLowerCase()),Cs.applyArabicShaping&&(d=Cs.applyArabicShaping(d)),d)}),e}zo([{name:"triangle",components:3,type:"Uint16"}]),zo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),zo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),zo([{type:"Float32",name:"offsetX"}]),zo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var kf={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Op=function(e,t,r,f,d){var x,S,P=8*d-f-1,z=(1<<P)-1,J=z>>1,ee=-7,ue=r?d-1:0,ye=r?-1:1,Se=e[t+ue];for(ue+=ye,x=Se&(1<<-ee)-1,Se>>=-ee,ee+=P;ee>0;x=256*x+e[t+ue],ue+=ye,ee-=8);for(S=x&(1<<-ee)-1,x>>=-ee,ee+=f;ee>0;S=256*S+e[t+ue],ue+=ye,ee-=8);if(0===x)x=1-J;else{if(x===z)return S?NaN:1/0*(Se?-1:1);S+=Math.pow(2,f),x-=J}return(Se?-1:1)*S*Math.pow(2,x-f)},Ih=function(e,t,r,f,d,x){var S,P,z,J=8*x-d-1,ee=(1<<J)-1,ue=ee>>1,ye=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,Se=f?0:x-1,qe=f?1:-1,Je=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(P=isNaN(t)?1:0,S=ee):(S=Math.floor(Math.log(t)/Math.LN2),t*(z=Math.pow(2,-S))<1&&(S--,z*=2),(t+=S+ue>=1?ye/z:ye*Math.pow(2,1-ue))*z>=2&&(S++,z/=2),S+ue>=ee?(P=0,S=ee):S+ue>=1?(P=(t*z-1)*Math.pow(2,d),S+=ue):(P=t*Math.pow(2,ue-1)*Math.pow(2,d),S=0));d>=8;e[r+Se]=255&P,Se+=qe,P/=256,d-=8);for(S=S<<d|P,J+=d;J>0;e[r+Se]=255&S,Se+=qe,S/=256,J-=8);e[r+Se-qe]|=128*Je},zc=io;function io(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}io.Varint=0,io.Fixed64=1,io.Bytes=2,io.Fixed32=5;var ip="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function dc(e){return e.type===io.Bytes?e.readVarint()+e.pos:e.pos+1}function ap(e,t,r){var f=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(f);for(var d=r.pos-1;d>=e;d--)r.buf[d+f]=r.buf[d]}function q(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function De(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function it(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function cr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function kr(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function ur(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Cr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Ur(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Gr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Kr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function qr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function en(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function pn(e,t,r){1===e&&r.readMessage(Hr,t)}function Hr(e,t,r){if(3===e){var f=r.readMessage(tn,{}),d=f.width,x=f.height,S=f.left,P=f.top,z=f.advance;t.push({id:f.id,bitmap:new Wu({width:d+6,height:x+6},f.bitmap),metrics:{width:d,height:x,left:S,top:P,advance:z}})}}function tn(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function Vt(e){for(var t=0,r=0,f=0,d=e;f<d.length;f+=1){var x=d[f];t+=x.w*x.h,r=Math.max(r,x.w)}e.sort(function(Je,Ct){return Ct.h-Je.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],P=0,z=0,J=0,ee=e;J<ee.length;J+=1)for(var ue=ee[J],ye=S.length-1;ye>=0;ye--){var Se=S[ye];if(!(ue.w>Se.w||ue.h>Se.h)){if(ue.x=Se.x,ue.y=Se.y,z=Math.max(z,ue.y+ue.h),P=Math.max(P,ue.x+ue.w),ue.w===Se.w&&ue.h===Se.h){var qe=S.pop();ye<S.length&&(S[ye]=qe)}else ue.h===Se.h?(Se.x+=ue.w,Se.w-=ue.w):ue.w===Se.w?(Se.y+=ue.h,Se.h-=ue.h):(S.push({x:Se.x+ue.w,y:Se.y,w:Se.w-ue.w,h:ue.h}),Se.y+=ue.h,Se.h-=ue.h);break}}return{w:P,h:z,fill:t/(P*z)||0}}io.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var f=this.readVarint(),d=f>>3,x=this.pos;this.type=7&f,e(d,t,this),this.pos===x&&this.skip(f)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Kr(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=en(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Kr(this.buf,this.pos)+4294967296*Kr(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Kr(this.buf,this.pos)+4294967296*en(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Op(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Op(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,f=this.buf;return t=127&(r=f[this.pos++]),r<128?t:(t|=(127&(r=f[this.pos++]))<<7,r<128?t:(t|=(127&(r=f[this.pos++]))<<14,r<128?t:(t|=(127&(r=f[this.pos++]))<<21,r<128?t:function(d,x,S){var P,z,J=S.buf;if(P=(112&(z=J[S.pos++]))>>4,z<128||(P|=(127&(z=J[S.pos++]))<<3,z<128)||(P|=(127&(z=J[S.pos++]))<<10,z<128)||(P|=(127&(z=J[S.pos++]))<<17,z<128)||(P|=(127&(z=J[S.pos++]))<<24,z<128)||(P|=(1&(z=J[S.pos++]))<<31,z<128))return function(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}(d,P,x);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=f[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ip?ip.decode(this.buf.subarray(t,e)):function(r,f,d){for(var x="",S=f;S<d;){var P,z,J,ee=r[S],ue=null,ye=ee>239?4:ee>223?3:ee>191?2:1;if(S+ye>d)break;1===ye?ee<128&&(ue=ee):2===ye?128==(192&(P=r[S+1]))&&(ue=(31&ee)<<6|63&P)<=127&&(ue=null):3===ye?(z=r[S+2],128==(192&(P=r[S+1]))&&128==(192&z)&&((ue=(15&ee)<<12|(63&P)<<6|63&z)<=2047||ue>=55296&&ue<=57343)&&(ue=null)):4===ye&&(z=r[S+2],J=r[S+3],128==(192&(P=r[S+1]))&&128==(192&z)&&128==(192&J)&&((ue=(15&ee)<<18|(63&P)<<12|(63&z)<<6|63&J)<=65535||ue>=1114112)&&(ue=null)),null===ue?(ue=65533,ye=1):ue>65535&&(ue-=65536,x+=String.fromCharCode(ue>>>10&1023|55296),ue=56320|1023&ue),x+=String.fromCharCode(ue),S+=ye}return x}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==io.Bytes)return e.push(this.readVarint(t));var r=dc(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==io.Bytes)return e.push(this.readSVarint());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==io.Bytes)return e.push(this.readBoolean());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==io.Bytes)return e.push(this.readFloat());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==io.Bytes)return e.push(this.readDouble());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==io.Bytes)return e.push(this.readFixed32());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==io.Bytes)return e.push(this.readSFixed32());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==io.Bytes)return e.push(this.readFixed64());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==io.Bytes)return e.push(this.readSFixed64());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===io.Varint)for(;this.buf[this.pos++]>127;);else if(t===io.Bytes)this.pos=this.readVarint()+this.pos;else if(t===io.Fixed32)this.pos+=4;else{if(t!==io.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),qr(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),qr(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),qr(this.buf,-1&e,this.pos),qr(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),qr(this.buf,-1&e,this.pos),qr(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var f,d,x,P;if(t>=0?(f=t%4294967296|0,d=t/4294967296|0):(d=~(-t/4294967296),4294967295^(f=~(-t%4294967296))?f=f+1|0:(f=0,d=d+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),x=f,(P=r).buf[P.pos++]=127&x|128,x>>>=7,P.buf[P.pos++]=127&x|128,x>>>=7,P.buf[P.pos++]=127&x|128,x>>>=7,P.buf[P.pos++]=127&x|128,P.buf[P.pos]=127&(x>>>=7),function(x,S){var P=(7&x)<<4;S.buf[S.pos++]|=P|((x>>>=3)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x)))))}(d,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(f,d,x){for(var S,P,z=0;z<d.length;z++){if((S=d.charCodeAt(z))>55295&&S<57344){if(!P){S>56319||z+1===d.length?(f[x++]=239,f[x++]=191,f[x++]=189):P=S;continue}if(S<56320){f[x++]=239,f[x++]=191,f[x++]=189,P=S;continue}S=P-55296<<10|S-56320|65536,P=null}else P&&(f[x++]=239,f[x++]=191,f[x++]=189,P=null);S<128?f[x++]=S:(S<2048?f[x++]=S>>6|192:(S<65536?f[x++]=S>>12|224:(f[x++]=S>>18|240,f[x++]=S>>12&63|128),f[x++]=S>>6&63|128),f[x++]=63&S|128)}return x}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&ap(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Ih(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Ih(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var f=this.pos-r;f>=128&&ap(r,f,this),this.pos=r-1,this.writeVarint(f),this.pos+=f},writeMessage:function(e,t,r){this.writeTag(e,io.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,q,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,De,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,kr,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,it,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,cr,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,ur,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Cr,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Ur,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Gr,t)},writeBytesField:function(e,t){this.writeTag(e,io.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,io.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,io.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,io.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,io.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,io.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,io.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,io.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,io.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,io.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var _r=function(e,t){var r=t.pixelRatio,f=t.version,d=t.stretchX,x=t.stretchY,S=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=d,this.stretchY=x,this.content=S,this.version=f},Wr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Wr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Wr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Wr.tlbr.get=function(){return this.tl.concat(this.br)},Wr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(_r.prototype,Wr);var An=function(e,t){var r={},f={};this.haveRenderCallbacks=[];var d=[];this.addImages(e,r,d),this.addImages(t,f,d);var x=Vt(d),S=new ca({width:x.w||1,height:x.h||1});for(var P in e){var z=e[P],J=r[P].paddedRect;ca.copy(z.data,S,{x:0,y:0},{x:J.x+1,y:J.y+1},z.data)}for(var ee in t){var ue=t[ee],ye=f[ee].paddedRect,Se=ye.x+1,qe=ye.y+1,Je=ue.data.width,Ct=ue.data.height;ca.copy(ue.data,S,{x:0,y:0},{x:Se,y:qe},ue.data),ca.copy(ue.data,S,{x:0,y:Ct-1},{x:Se,y:qe-1},{width:Je,height:1}),ca.copy(ue.data,S,{x:0,y:0},{x:Se,y:qe+Ct},{width:Je,height:1}),ca.copy(ue.data,S,{x:Je-1,y:0},{x:Se-1,y:qe},{width:1,height:Ct}),ca.copy(ue.data,S,{x:0,y:0},{x:Se+Je,y:qe},{width:1,height:Ct})}this.image=S,this.iconPositions=r,this.patternPositions=f};An.prototype.addImages=function(e,t,r){for(var f in e){var d=e[f],x={x:0,y:0,w:d.data.width+2,h:d.data.height+2};r.push(x),t[f]=new _r(x,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(f)}},An.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},An.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var f=e.tl;r.update(t.data,void 0,{x:f[0],y:f[1]})}},Fn("ImagePosition",_r),Fn("ImageAtlas",An);var Mr={horizontal:1,vertical:2,horizontalOnly:3},wn=function(){this.scale=1,this.fontStack="",this.imageName=null};wn.forText=function(e,t){var r=new wn;return r.scale=e||1,r.fontStack=t,r},wn.forImage=function(e){var t=new wn;return t.imageName=e,t};var rn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function ui(e,t,r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je){var Ct,st=rn.fromFeature(e,d);ue===Mr.vertical&&st.verticalizePunctuation();var zt=Cs.processBidirectionalText,Qt=Cs.processStyledBidirectionalText;if(zt&&1===st.sections.length){Ct=[];for(var yr=0,Sr=zt(st.toString(),En(st,J,x,t,f,Se,qe));yr<Sr.length;yr+=1){var Rr=Sr[yr],nn=new rn;nn.text=Rr,nn.sections=st.sections;for(var gn=0;gn<Rr.length;gn++)nn.sectionIndex.push(0);Ct.push(nn)}}else if(Qt){Ct=[];for(var ii=0,Bn=Qt(st.text,st.sectionIndex,En(st,J,x,t,f,Se,qe));ii<Bn.length;ii+=1){var fi=Bn[ii],Zn=new rn;Zn.text=fi[0],Zn.sectionIndex=fi[1],Zn.sections=st.sections,Ct.push(Zn)}}else Ct=function(Qn,da){for(var Ki=[],Aa=Qn.text,di=0,Ra=0,Co=da;Ra<Co.length;Ra+=1){var Ao=Co[Ra];Ki.push(Qn.substring(di,Ao)),di=Ao}return di<Aa.length&&Ki.push(Qn.substring(di,Aa.length)),Ki}(st,En(st,J,x,t,f,Se,qe));var na=[],wi={positionedLines:na,text:st.toString(),top:ee[1],bottom:ee[1],left:ee[0],right:ee[0],writingMode:ue,iconsInText:!1,verticalizable:!1};return function(Qn,da,Ki,Aa,di,Ra,Co,Ao,Do,ho,Oo,xs){for(var bs=0,fu=-17,Ms=0,hu=0,No="right"===Ao?1:"left"===Ao?0:.5,Os=0,Sa=0,Ja=di;Sa<Ja.length;Sa+=1){var Xa=Ja[Sa];Xa.trim();var qi=Xa.getMaxScale(),$s=24*(qi-1),Zs={positionedGlyphs:[],lineOffset:0};Qn.positionedLines[Os]=Zs;var yo=Zs.positionedGlyphs,fs=0;if(Xa.length()){for(var Ss=0;Ss<Xa.length();Ss++){var Pa=Xa.getSection(Ss),vc=Xa.getSectionIndex(Ss),cl=Xa.getCharCode(Ss),Ml=0,Bo=null,Uc=null,Ku=null,mc=24,Df=!(Do===Mr.horizontal||!Oo&&!Oc(cl)||Oo&&(Lr[cl]||(Vc=cl,hn.Arabic(Vc)||hn["Arabic Supplement"](Vc)||hn["Arabic Extended-A"](Vc)||hn["Arabic Presentation Forms-A"](Vc)||hn["Arabic Presentation Forms-B"](Vc))));if(Pa.imageName){var nh=Aa[Pa.imageName];if(!nh)continue;Ku=Pa.imageName,Qn.iconsInText=Qn.iconsInText||!0,Uc=nh.paddedRect;var af=nh.displaySize;Pa.scale=24*Pa.scale/xs,Ml=$s+(24-af[1]*Pa.scale),mc=(Bo={width:af[0],height:af[1],left:1,top:-3,advance:Df?af[1]:af[0]}).advance;var ih=Df?af[0]*Pa.scale-24*qi:af[1]*Pa.scale-24*qi;ih>0&&ih>fs&&(fs=ih)}else{var Lh=Ki[Pa.fontStack],ah=Lh&&Lh[cl];if(ah&&ah.rect)Uc=ah.rect,Bo=ah.metrics;else{var oh=da[Pa.fontStack],kh=oh&&oh[cl];if(!kh)continue;Bo=kh.metrics}Ml=24*(qi-Pa.scale)}Df?(Qn.verticalizable=!0,yo.push({glyph:cl,imageName:Ku,x:bs,y:fu+Ml,vertical:Df,scale:Pa.scale,fontStack:Pa.fontStack,sectionIndex:vc,metrics:Bo,rect:Uc}),bs+=mc*Pa.scale+ho):(yo.push({glyph:cl,imageName:Ku,x:bs,y:fu+Ml,vertical:Df,scale:Pa.scale,fontStack:Pa.fontStack,sectionIndex:vc,metrics:Bo,rect:Uc}),bs+=Bo.advance*Pa.scale+ho)}0!==yo.length&&(Ms=Math.max(bs-ho,Ms),Ii(yo,0,yo.length-1,No,fs)),bs=0;var Rh=Ra*qi+fs;Zs.lineOffset=Math.max(fs,$s),fu+=Rh,hu=Math.max(Rh,hu),++Os}else fu+=Ra,++Os}var Vc,sh=fu- -17,uh=zi(Co),gc=uh.horizontalAlign,bf=uh.verticalAlign;(function(Dh,up,Nh,Bh,lp,Sf,lh,ch,Fh){var Nf,zh=(up-Nh)*lp;Nf=Sf!==lh?-ch*Bh- -17:(-Bh*Fh+.5)*lh;for(var fh=0,Zh=Dh;fh<Zh.length;fh+=1)for(var Bf=0,Uh=Zh[fh].positionedGlyphs;Bf<Uh.length;Bf+=1){var hh=Uh[Bf];hh.x+=zh,hh.y+=Nf}})(Qn.positionedLines,No,gc,bf,Ms,hu,Ra,sh,di.length),Qn.top+=-bf*sh,Qn.bottom=Qn.top+sh,Qn.left+=-gc*Ms,Qn.right=Qn.left+Ms}(wi,t,r,f,Ct,S,P,z,ue,J,ye,Je),!function(Qn){for(var da=0,Ki=Qn;da<Ki.length;da+=1)if(0!==Ki[da].positionedGlyphs.length)return!1;return!0}(na)&&wi}rn.fromFeature=function(e,t){for(var r=new rn,f=0;f<e.sections.length;f++){var d=e.sections[f];d.image?r.addImageSection(d):r.addTextSection(d,t)}return r},rn.prototype.length=function(){return this.text.length},rn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},rn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},rn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},rn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var f=e.charCodeAt(r+1)||null,d=e.charCodeAt(r-1)||null;t+=f&&xl(f)&&!kf[e[r+1]]||d&&xl(d)&&!kf[e[r-1]]||!kf[e[r]]?e[r]:kf[e[r]]}return t}(this.text)},rn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Lr[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,f=this.text.length-1;f>=0&&f>=e&&Lr[this.text.charCodeAt(f)];f--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},rn.prototype.substring=function(e,t){var r=new rn;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},rn.prototype.toString=function(){return this.text},rn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},rn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(wn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,f=0;f<e.text.length;++f)this.sectionIndex.push(r)},rn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(0!==t.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(wn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Xe("Reached maximum number of images 6401")}else Xe("Can't add FormattedSection with an empty image.")},rn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Lr={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Er={};function Gn(e,t,r,f,d,x){if(t.imageName){var S=f[t.imageName];return S?S.displaySize[0]*t.scale*24/x+d:0}var P=r[t.fontStack],z=P&&P[e];return z?z.metrics.advance*t.scale+d:0}function vn(e,t,r,f){var d=Math.pow(e-t,2);return f?e<t?d/2:2*d:d+Math.abs(r)*r}function Jr(e,t,r){var f=0;return 10===e&&(f-=1e4),r&&(f+=150),40!==e&&65288!==e||(f+=50),41!==t&&65289!==t||(f+=50),f}function xn(e,t,r,f,d,x){for(var S=null,P=vn(t,r,d,x),z=0,J=f;z<J.length;z+=1){var ee=J[z],ue=vn(t-ee.x,r,d,x)+ee.badness;ue<=P&&(S=ee,P=ue)}return{index:e,x:t,priorBreak:S,badness:P}}function En(e,t,r,f,d,x,S){if("point"!==x)return[];if(!e)return[];for(var P,z=[],J=function(Ct,st,zt,Qt,yr,Sr){for(var Rr=0,nn=0;nn<Ct.length();nn++){var gn=Ct.getSection(nn);Rr+=Gn(Ct.getCharCode(nn),gn,Qt,yr,st,Sr)}return Rr/Math.max(1,Math.ceil(Rr/zt))}(e,t,r,f,d,S),ee=e.text.indexOf("\u200b")>=0,ue=0,ye=0;ye<e.length();ye++){var Se=e.getSection(ye),qe=e.getCharCode(ye);if(Lr[qe]||(ue+=Gn(qe,Se,f,d,t,S)),ye<e.length()-1){var Je=!((P=qe)<11904||!(hn["Bopomofo Extended"](P)||hn.Bopomofo(P)||hn["CJK Compatibility Forms"](P)||hn["CJK Compatibility Ideographs"](P)||hn["CJK Compatibility"](P)||hn["CJK Radicals Supplement"](P)||hn["CJK Strokes"](P)||hn["CJK Symbols and Punctuation"](P)||hn["CJK Unified Ideographs Extension A"](P)||hn["CJK Unified Ideographs"](P)||hn["Enclosed CJK Letters and Months"](P)||hn["Halfwidth and Fullwidth Forms"](P)||hn.Hiragana(P)||hn["Ideographic Description Characters"](P)||hn["Kangxi Radicals"](P)||hn["Katakana Phonetic Extensions"](P)||hn.Katakana(P)||hn["Vertical Forms"](P)||hn["Yi Radicals"](P)||hn["Yi Syllables"](P)));(Er[qe]||Je||Se.imageName)&&z.push(xn(ye+1,ue,J,z,Jr(qe,e.getCharCode(ye+1),Je&&ee),!1))}}return function Ct(st){return st?Ct(st.priorBreak).concat(st.index):[]}(xn(e.length(),ue,J,z,0,!0))}function zi(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ii(e,t,r,f,d){if(f||d)for(var x=e[r],S=(e[r].x+x.metrics.advance*x.scale)*f,P=t;P<=r;P++)e[P].x-=S,e[P].y+=d}function Cn(e,t,r,f,d,x){var S,P=e.image;if(P.content){var z=P.content,J=P.pixelRatio||1;S=[z[0]/J,z[1]/J,P.displaySize[0]-z[2]/J,P.displaySize[1]-z[3]/J]}var ee,ue,ye,Se,qe=t.left*x,Je=t.right*x;"width"===r||"both"===r?(Se=d[0]+qe-f[3],ue=d[0]+Je+f[1]):ue=(Se=d[0]+(qe+Je-P.displaySize[0])/2)+P.displaySize[0];var Ct=t.top*x,st=t.bottom*x;return"height"===r||"both"===r?(ee=d[1]+Ct-f[0],ye=d[1]+st+f[2]):ye=(ee=d[1]+(Ct+st-P.displaySize[1])/2)+P.displaySize[1],{image:P,top:ee,right:ue,bottom:ye,left:Se,collisionPadding:S}}Er[10]=!0,Er[32]=!0,Er[38]=!0,Er[40]=!0,Er[41]=!0,Er[43]=!0,Er[45]=!0,Er[47]=!0,Er[173]=!0,Er[183]=!0,Er[8203]=!0,Er[8208]=!0,Er[8211]=!0,Er[8231]=!0;var Tn=function(e){function t(r,f,d,x){e.call(this,r,f),this.angle=d,void 0!==x&&(this.segment=x)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(N);function _i(e,t){var r=t.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new $i(e+1))};if("source"===r.kind)return{kind:"source"};for(var f=r.zoomStops,d=r.interpolationType,x=0;x<f.length&&f[x]<=e;)x++;for(var S=x=Math.max(0,x-1);S<f.length&&f[S]<e+1;)S++;S=Math.min(f.length-1,S);var P=f[x],z=f[S];return"composite"===r.kind?{kind:"composite",minZoom:P,maxZoom:z,interpolationType:d}:{kind:"camera",minZoom:P,maxZoom:z,minSize:r.evaluate(new $i(P)),maxSize:r.evaluate(new $i(z)),interpolationType:d}}function Zi(e,t,r){var f=t.uSize,d=r.lowerSize;return"source"===e.kind?d/128:"composite"===e.kind?Oa(d/128,r.upperSize/128,t.uSizeT):f}function fa(e,t){var r=0,f=0;if("constant"===e.kind)f=e.layoutSize;else if("source"!==e.kind){var d=e.interpolationType,x=d?W(Fe.interpolationFactor(d,t,e.minZoom,e.maxZoom),0,1):0;"camera"===e.kind?f=Oa(e.minSize,e.maxSize,x):r=x}return{uSizeT:r,uSize:f}}Fn("Anchor",Tn);var Io=Object.freeze({__proto__:null,getSizeData:_i,evaluateSizeForFeature:Zi,evaluateSizeForZoom:fa,SIZE_PACK_FACTOR:128});function Mo(e,t,r,f,d){if(void 0===t.segment)return!0;for(var x=t,S=t.segment+1,P=0;P>-r/2;){if(--S<0)return!1;P-=e[S].dist(x),x=e[S]}P+=e[S].dist(e[S+1]),S++;for(var z=[],J=0;P<r/2;){var ee=e[S],ue=e[S+1];if(!ue)return!1;var ye=e[S-1].angleTo(ee)-ee.angleTo(ue);for(ye=Math.abs((ye+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:P,angleDelta:ye}),J+=ye;P-z[0].distance>f;)J-=z.shift().angleDelta;if(J>d)return!1;S++,P+=ee.dist(ue)}return!0}function ha(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function ds(e,t,r){return e?.6*t*r:0}function so(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function vs(e,t,r,f,d,x){for(var S=ds(r,d,x),P=so(r,f)*x,z=0,J=ha(e)/2,ee=0;ee<e.length-1;ee++){var ue=e[ee],ye=e[ee+1],Se=ue.dist(ye);if(z+Se>J){var qe=(J-z)/Se,Je=Oa(ue.x,ye.x,qe),Ct=Oa(ue.y,ye.y,qe),st=new Tn(Je,Ct,ye.angleTo(ue),ee);return st._round(),!S||Mo(e,st,P,S,t)?st:void 0}z+=Se}}function Uo(e,t,r,f,d,x,S,P,z){var J=ds(f,x,S),ee=so(f,d),ue=ee*S,ye=0===e[0].x||e[0].x===z||0===e[0].y||e[0].y===z;return t-ue<t/4&&(t=ue+t/4),function Se(qe,Je,Ct,st,zt,Qt,yr,Sr,Rr){for(var nn=Qt/2,gn=ha(qe),ii=0,Bn=Je-Ct,fi=[],Zn=0;Zn<qe.length-1;Zn++){for(var na=qe[Zn],wi=qe[Zn+1],Qn=na.dist(wi),da=wi.angleTo(na);Bn+Ct<ii+Qn;){var Ki=((Bn+=Ct)-ii)/Qn,Aa=Oa(na.x,wi.x,Ki),di=Oa(na.y,wi.y,Ki);if(Aa>=0&&Aa<Rr&&di>=0&&di<Rr&&Bn-nn>=0&&Bn+nn<=gn){var Ra=new Tn(Aa,di,da,Zn);Ra._round(),st&&!Mo(qe,Ra,Qt,st,zt)||fi.push(Ra)}}ii+=Qn}return Sr||fi.length||yr||(fi=Se(qe,ii/2,Ct,st,zt,Qt,yr,!0,Rr)),fi}(e,ye?t/2*P%t:(ee/2+2*x)*S*P%t,t,J,r,ue,ye,!1,z)}function ss(e,t,r,f,d){for(var x=[],S=0;S<e.length;S++)for(var P=e[S],z=void 0,J=0;J<P.length-1;J++){var ee=P[J],ue=P[J+1];ee.x<t&&ue.x<t||(ee.x<t?ee=new N(t,ee.y+(t-ee.x)/(ue.x-ee.x)*(ue.y-ee.y))._round():ue.x<t&&(ue=new N(t,ee.y+(t-ee.x)/(ue.x-ee.x)*(ue.y-ee.y))._round()),ee.y<r&&ue.y<r||(ee.y<r?ee=new N(ee.x+(r-ee.y)/(ue.y-ee.y)*(ue.x-ee.x),r)._round():ue.y<r&&(ue=new N(ee.x+(r-ee.y)/(ue.y-ee.y)*(ue.x-ee.x),r)._round()),ee.x>=f&&ue.x>=f||(ee.x>=f?ee=new N(f,ee.y+(f-ee.x)/(ue.x-ee.x)*(ue.y-ee.y))._round():ue.x>=f&&(ue=new N(f,ee.y+(f-ee.x)/(ue.x-ee.x)*(ue.y-ee.y))._round()),ee.y>=d&&ue.y>=d||(ee.y>=d?ee=new N(ee.x+(d-ee.y)/(ue.y-ee.y)*(ue.x-ee.x),d)._round():ue.y>=d&&(ue=new N(ee.x+(d-ee.y)/(ue.y-ee.y)*(ue.x-ee.x),d)._round()),z&&ee.equals(z[z.length-1])||x.push(z=[ee]),z.push(ue)))))}return x}function ms(e,t,r,f){var d=[],x=e.image,S=x.pixelRatio,P=x.paddedRect.w-2,z=x.paddedRect.h-2,J=e.right-e.left,ee=e.bottom-e.top,ue=x.stretchX||[[0,P]],ye=x.stretchY||[[0,z]],Se=function(Aa,di){return Aa+di[1]-di[0]},qe=ue.reduce(Se,0),Je=ye.reduce(Se,0),Ct=P-qe,st=z-Je,zt=0,Qt=qe,yr=0,Sr=Je,Rr=0,nn=Ct,gn=0,ii=st;if(x.content&&f){var Bn=x.content;zt=us(ue,0,Bn[0]),yr=us(ye,0,Bn[1]),Qt=us(ue,Bn[0],Bn[2]),Sr=us(ye,Bn[1],Bn[3]),Rr=Bn[0]-zt,gn=Bn[1]-yr,nn=Bn[2]-Bn[0]-Qt,ii=Bn[3]-Bn[1]-Sr}var fi=function(Aa,di,Ra,Co){var Ao=Hi(Aa.stretch-zt,Qt,J,e.left),Do=ls(Aa.fixed-Rr,nn,Aa.stretch,qe),ho=Hi(di.stretch-yr,Sr,ee,e.top),Oo=ls(di.fixed-gn,ii,di.stretch,Je),xs=Hi(Ra.stretch-zt,Qt,J,e.left),bs=ls(Ra.fixed-Rr,nn,Ra.stretch,qe),fu=Hi(Co.stretch-yr,Sr,ee,e.top),Ms=ls(Co.fixed-gn,ii,Co.stretch,Je),hu=new N(Ao,ho),No=new N(xs,ho),Os=new N(xs,fu),Sa=new N(Ao,fu),Ja=new N(Do/S,Oo/S),Xa=new N(bs/S,Ms/S),qi=t*Math.PI/180;if(qi){var $s=Math.sin(qi),Zs=Math.cos(qi),yo=[Zs,-$s,$s,Zs];hu._matMult(yo),No._matMult(yo),Sa._matMult(yo),Os._matMult(yo)}var fs=Aa.stretch+Aa.fixed,Ss=di.stretch+di.fixed;return{tl:hu,tr:No,bl:Sa,br:Os,tex:{x:x.paddedRect.x+1+fs,y:x.paddedRect.y+1+Ss,w:Ra.stretch+Ra.fixed-fs,h:Co.stretch+Co.fixed-Ss},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ja,pixelOffsetBR:Xa,minFontScaleX:nn/S/J,minFontScaleY:ii/S/ee,isSDF:r}};if(f&&(x.stretchX||x.stretchY))for(var Zn=Vo(ue,Ct,qe),na=Vo(ye,st,Je),wi=0;wi<Zn.length-1;wi++)for(var Qn=Zn[wi],da=Zn[wi+1],Ki=0;Ki<na.length-1;Ki++)d.push(fi(Qn,na[Ki],da,na[Ki+1]));else d.push(fi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:z+1}));return d}function us(e,t,r){for(var f=0,d=0,x=e;d<x.length;d+=1){var S=x[d];f+=Math.max(t,Math.min(r,S[1]))-Math.max(t,Math.min(r,S[0]))}return f}function Vo(e,t,r){for(var f=[{fixed:-1,stretch:0}],d=0,x=e;d<x.length;d+=1){var S=x[d],P=S[0],z=S[1],J=f[f.length-1];f.push({fixed:P-J.stretch,stretch:J.stretch}),f.push({fixed:P-J.stretch,stretch:J.stretch+(z-P)})}return f.push({fixed:t+1,stretch:r}),f}function Hi(e,t,r,f){return e/t*r+f}function ls(e,t,r,f){return e-t*r/f}var ka=function(e,t,r,f,d,x,S,P,z,J){if(this.boxStartIndex=e.length,z){var ee=x.top,ue=x.bottom,ye=x.collisionPadding;ye&&(ee-=ye[1],ue+=ye[3]);var Se=ue-ee;Se>0&&(Se=Math.max(10,Se),this.circleDiameter=Se)}else{var qe=x.top*S-P,Je=x.bottom*S+P,Ct=x.left*S-P,st=x.right*S+P,zt=x.collisionPadding;if(zt&&(Ct-=zt[0]*S,qe-=zt[1]*S,st+=zt[2]*S,Je+=zt[3]*S),J){var Qt=new N(Ct,qe),yr=new N(st,qe),Sr=new N(Ct,Je),Rr=new N(st,Je),nn=J*Math.PI/180;Qt._rotate(nn),yr._rotate(nn),Sr._rotate(nn),Rr._rotate(nn),Ct=Math.min(Qt.x,yr.x,Sr.x,Rr.x),st=Math.max(Qt.x,yr.x,Sr.x,Rr.x),qe=Math.min(Qt.y,yr.y,Sr.y,Rr.y),Je=Math.max(Qt.y,yr.y,Sr.y,Rr.y)}e.emplaceBack(t.x,t.y,Ct,qe,st,Je,r,f,d)}this.boxEndIndex=e.length},uo=function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=Ai),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Ai(e,t){return e<t?-1:e>t?1:0}function pa(e,t,r){void 0===t&&(t=1),void 0===r&&(r=!1);for(var f=1/0,d=1/0,x=-1/0,S=-1/0,P=e[0],z=0;z<P.length;z++){var J=P[z];(!z||J.x<f)&&(f=J.x),(!z||J.y<d)&&(d=J.y),(!z||J.x>x)&&(x=J.x),(!z||J.y>S)&&(S=J.y)}var ee=Math.min(x-f,S-d),ue=ee/2,ye=new uo([],Qa);if(0===ee)return new N(f,d);for(var Se=f;Se<x;Se+=ee)for(var qe=d;qe<S;qe+=ee)ye.push(new To(Se+ue,qe+ue,ue,e));for(var Je=function(zt){for(var Qt=0,yr=0,Sr=0,Rr=zt[0],nn=0,gn=Rr.length,ii=gn-1;nn<gn;ii=nn++){var Bn=Rr[nn],fi=Rr[ii],Zn=Bn.x*fi.y-fi.x*Bn.y;yr+=(Bn.x+fi.x)*Zn,Sr+=(Bn.y+fi.y)*Zn,Qt+=3*Zn}return new To(yr/Qt,Sr/Qt,0,zt)}(e),Ct=ye.length;ye.length;){var st=ye.pop();(st.d>Je.d||!Je.d)&&(Je=st,r&&console.log("found best %d after %d probes",Math.round(1e4*st.d)/1e4,Ct)),st.max-Je.d<=t||(ye.push(new To(st.p.x-(ue=st.h/2),st.p.y-ue,ue,e)),ye.push(new To(st.p.x+ue,st.p.y-ue,ue,e)),ye.push(new To(st.p.x-ue,st.p.y+ue,ue,e)),ye.push(new To(st.p.x+ue,st.p.y+ue,ue,e)),Ct+=4)}return r&&(console.log("num probes: "+Ct),console.log("best distance: "+Je.d)),Je.p}function Qa(e,t){return t.max-e.max}function To(e,t,r,f){this.p=new N(e,t),this.h=r,this.d=function(d,x){for(var S=!1,P=1/0,z=0;z<x.length;z++)for(var J=x[z],ee=0,ue=J.length,ye=ue-1;ee<ue;ye=ee++){var Se=J[ee],qe=J[ye];Se.y>d.y!=qe.y>d.y&&d.x<(qe.x-Se.x)*(d.y-Se.y)/(qe.y-Se.y)+Se.x&&(S=!S),P=Math.min(P,xa(d,Se,qe))}return(S?1:-1)*Math.sqrt(P)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}uo.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},uo.prototype.pop=function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},uo.prototype.peek=function(){return this.data[0]},uo.prototype._up=function(e){for(var t=this.data,r=this.compare,f=t[e];e>0;){var d=e-1>>1,x=t[d];if(r(f,x)>=0)break;t[e]=x,e=d}t[e]=f},uo.prototype._down=function(e){for(var t=this.data,r=this.compare,f=this.length>>1,d=t[e];e<f;){var x=1+(e<<1),S=t[x],P=x+1;if(P<this.length&&r(t[P],S)<0&&(x=P,S=t[P]),r(S,d)>=0)break;t[e]=S,e=x}t[e]=d};var Pl=Number.POSITIVE_INFINITY;function Qe(e,t){return t[1]!==Pl?function(r,f,d){var x=0,S=0;switch(f=Math.abs(f),d=Math.abs(d),r){case"top-right":case"top-left":case"top":S=d-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-d}switch(r){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,S]}(e,t[0],t[1]):function(r,f){var d=0,x=0;f<0&&(f=0);var S=f/Math.sqrt(2);switch(r){case"top-right":case"top-left":x=S-7;break;case"bottom-right":case"bottom-left":x=7-S;break;case"bottom":x=7-f;break;case"top":x=f-7}switch(r){case"top-right":case"bottom-right":d=-S;break;case"top-left":case"bottom-left":d=S;break;case"left":d=f;break;case"right":d=-f}return[d,x]}(e,t[0])}function vr(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function tr(e,t,r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe){var Je=function(yr,Sr,Rr,nn,gn,ii,Bn,fi){for(var Zn=nn.layout.get("text-rotate").evaluate(ii,{})*Math.PI/180,na=[],wi=0,Qn=Sr.positionedLines;wi<Qn.length;wi+=1)for(var da=Qn[wi],Ki=0,Aa=da.positionedGlyphs;Ki<Aa.length;Ki+=1){var di=Aa[Ki];if(di.rect){var Ra=di.rect||{},Co=4,Ao=!0,Do=1,ho=0,Oo=(gn||fi)&&di.vertical,xs=di.metrics.advance*di.scale/2;if(fi&&Sr.verticalizable&&(ho=da.lineOffset/2-(di.imageName?-(24-di.metrics.width*di.scale)/2:24*(di.scale-1))),di.imageName){var bs=Bn[di.imageName];Ao=bs.sdf,Co=1/(Do=bs.pixelRatio)}var fu=gn?[di.x+xs,di.y]:[0,0],Ms=gn?[0,0]:[di.x+xs+Rr[0],di.y+Rr[1]-ho],hu=[0,0];Oo&&(hu=Ms,Ms=[0,0]);var No=(di.metrics.left-Co)*di.scale-xs+Ms[0],Os=(-di.metrics.top-Co)*di.scale+Ms[1],Sa=No+Ra.w*di.scale/Do,Ja=Os+Ra.h*di.scale/Do,Xa=new N(No,Os),qi=new N(Sa,Os),$s=new N(No,Ja),Zs=new N(Sa,Ja);if(Oo){var yo=new N(-xs,xs- -17),fs=-Math.PI/2,Ss=12-xs,Pa=new N(22-Ss,-(di.imageName?Ss:0)),vc=new(Function.prototype.bind.apply(N,[null].concat(hu)));Xa._rotateAround(fs,yo)._add(Pa)._add(vc),qi._rotateAround(fs,yo)._add(Pa)._add(vc),$s._rotateAround(fs,yo)._add(Pa)._add(vc),Zs._rotateAround(fs,yo)._add(Pa)._add(vc)}if(Zn){var cl=Math.sin(Zn),Ml=Math.cos(Zn),Bo=[Ml,-cl,cl,Ml];Xa._matMult(Bo),qi._matMult(Bo),$s._matMult(Bo),Zs._matMult(Bo)}var Uc=new N(0,0),Ku=new N(0,0);na.push({tl:Xa,tr:qi,bl:$s,br:Zs,tex:Ra,writingMode:Sr.writingMode,glyphOffset:fu,sectionIndex:di.sectionIndex,isSDF:Ao,pixelOffsetTL:Uc,pixelOffsetBR:Ku,minFontScaleX:0,minFontScaleY:0})}}return na}(0,r,P,d,x,S,f,e.allowVerticalPlacement),Ct=e.textSizeData,st=null;"source"===Ct.kind?(st=[128*d.layout.get("text-size").evaluate(S,{})])[0]>32640&&Xe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Ct.kind&&((st=[128*Se.compositeTextSizes[0].evaluate(S,{},qe),128*Se.compositeTextSizes[1].evaluate(S,{},qe)])[0]>32640||st[1]>32640)&&Xe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Je,st,P,x,S,J,t,z.lineStartIndex,z.lineLength,ye,qe);for(var zt=0,Qt=ee;zt<Qt.length;zt+=1)ue[Qt[zt]]=e.text.placedSymbolArray.length-1;return 4*Je.length}function zn(e){for(var t in e)return e[t];return null}function ya(e,t,r,f){var d=e.compareText;if(t in d){for(var x=d[t],S=x.length-1;S>=0;S--)if(f.dist(x[S])<r)return!0}else d[t]=[];return d[t].push(f),!1}var He=gf.VectorTileFeature.types,Pe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vt(e,t,r,f,d,x,S,P,z,J,ee,ue,ye){var Se=P?Math.min(32640,Math.round(P[0])):0,qe=P?Math.min(32640,Math.round(P[1])):0;e.emplaceBack(t,r,Math.round(32*f),Math.round(32*d),x,S,(Se<<1)+(z?1:0),qe,16*J,16*ee,256*ue,256*ye)}function jt(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function fr(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(sc(r[t].text))return!0;return!1}var At=function(e){this.layoutVertexArray=new Hl,this.indexArray=new sl,this.programConfigurations=e,this.segments=new Me,this.dynamicLayoutVertexArray=new Sl,this.opacityVertexArray=new Wl,this.placedSymbolArray=new p};At.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},At.prototype.upload=function(e,t,r,f){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$p.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Qp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Pe,!0),this.opacityVertexBuffer.itemSize=1),(r||f)&&this.programConfigurations.upload(e))},At.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Fn("SymbolBuffers",At);var bt=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new Me,this.collisionVertexArray=new kc};bt.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Pp.members,!0)},bt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Fn("CollisionBuffers",bt);var dt=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(x){return x.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ca([]),this.placementViewportMatrix=Ca([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=_i(this.zoom,t["text-size"]),this.iconSizeData=_i(this.zoom,t["icon-size"]);var r=this.layers[0].layout,f=r.get("symbol-sort-key"),d=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==d&&void 0!==f.constantOr(1),this.sortFeaturesByY=("viewport-y"===d||"auto"===d&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map(function(x){return Mr[x]})),this.stateDependentLayerIds=this.layers.filter(function(x){return x.isStateDependent()}).map(function(x){return x.id}),this.sourceID=e.sourceID};dt.prototype.createArrays=function(){this.text=new At(new ie(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new At(new ie(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new A,this.lineVertexArray=new B,this.symbolInstances=new E},dt.prototype.calculateGlyphDependencies=function(e,t,r,f,d){for(var x=0;x<e.length;x++)if(t[e.charCodeAt(x)]=!0,(r||f)&&d){var S=kf[e.charAt(x)];S&&(t[S.charCodeAt(0)]=!0)}},dt.prototype.populate=function(e,t,r){var f=this.layers[0],d=f.layout,x=d.get("text-font"),S=d.get("text-field"),P=d.get("icon-image"),z=("constant"!==S.value.kind||S.value.value instanceof Za&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&("constant"!==x.value.kind||x.value.value.length>0),J="constant"!==P.value.kind||!!P.value.value||Object.keys(P.parameters).length>0,ee=d.get("symbol-sort-key");if(this.features=[],z||J){for(var ue=t.iconDependencies,ye=t.glyphDependencies,Se=t.availableImages,qe=new $i(this.zoom),Je=0,Ct=e;Je<Ct.length;Je+=1){var st=Ct[Je],zt=st.feature,Qt=st.id,yr=st.index,Sr=st.sourceLayerIndex,Rr=f._featureFilter.needGeometry,nn=Nt(zt,Rr);if(f._featureFilter.filter(qe,nn,r)){Rr||(nn.geometry=mt(zt));var gn=void 0;if(z){var ii=f.getValueAndResolveTokens("text-field",nn,r,Se),Bn=Za.factory(ii);fr(Bn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Lc()||this.hasRTLText&&Cs.isParsed())&&(gn=ed(Bn,f,nn))}var fi=void 0;if(J){var Zn=f.getValueAndResolveTokens("icon-image",nn,r,Se);fi=Zn instanceof Wi?Zn:Wi.fromString(Zn)}if(gn||fi){var na=this.sortFeaturesByKey?ee.evaluate(nn,{},r):void 0;if(this.features.push({id:Qt,text:gn,icon:fi,index:yr,sourceLayerIndex:Sr,geometry:nn.geometry,properties:zt.properties,type:He[zt.type],sortKey:na}),fi&&(ue[fi.name]=!0),gn){var wi=x.evaluate(nn,{},r).join(","),Qn="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Mr.vertical)>=0;for(var da=0,Ki=gn.sections;da<Ki.length;da+=1){var Aa=Ki[da];if(Aa.image)ue[Aa.image.name]=!0;else{var di=Yc(gn.toString()),Ra=Aa.fontStack||wi,Co=ye[Ra]=ye[Ra]||{};this.calculateGlyphDependencies(Aa.text,Co,Qn,this.allowVerticalPlacement,di)}}}}}}"line"===d.get("symbol-placement")&&(this.features=function(Ao){var Do={},ho={},Oo=[],xs=0;function bs(yo){Oo.push(Ao[yo]),xs++}function fu(yo,fs,Ss){var Pa=ho[yo];return delete ho[yo],ho[fs]=Pa,Oo[Pa].geometry[0].pop(),Oo[Pa].geometry[0]=Oo[Pa].geometry[0].concat(Ss[0]),Pa}function Ms(yo,fs,Ss){var Pa=Do[fs];return delete Do[fs],Do[yo]=Pa,Oo[Pa].geometry[0].shift(),Oo[Pa].geometry[0]=Ss[0].concat(Oo[Pa].geometry[0]),Pa}function hu(yo,fs,Ss){var Pa=Ss?fs[0][fs[0].length-1]:fs[0][0];return yo+":"+Pa.x+":"+Pa.y}for(var No=0;No<Ao.length;No++){var Os=Ao[No],Sa=Os.geometry,Ja=Os.text?Os.text.toString():null;if(Ja){var Xa=hu(Ja,Sa),qi=hu(Ja,Sa,!0);if(Xa in ho&&qi in Do&&ho[Xa]!==Do[qi]){var $s=Ms(Xa,qi,Sa),Zs=fu(Xa,qi,Oo[$s].geometry);delete Do[Xa],delete ho[qi],ho[hu(Ja,Oo[Zs].geometry,!0)]=Zs,Oo[$s].geometry=null}else Xa in ho?fu(Xa,qi,Sa):qi in Do?Ms(Xa,qi,Sa):(bs(No),Do[Xa]=xs-1,ho[qi]=xs-1)}else bs(No)}return Oo.filter(function(yo){return yo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ao,Do){return Ao.sortKey-Do.sortKey})}},dt.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},dt.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},dt.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},dt.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},dt.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},dt.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},dt.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){for(var f=e.dist(t[e.segment+1]),d=e.dist(t[e.segment]),x={},S=e.segment+1;S<t.length;S++)x[S]={x:t[S].x,y:t[S].y,tileUnitDistanceFromAnchor:f},S<t.length-1&&(f+=t[S+1].dist(t[S]));for(var P=e.segment||0;P>=0;P--)x[P]={x:t[P].x,y:t[P].y,tileUnitDistanceFromAnchor:d},P>0&&(d+=t[P-1].dist(t[P]));for(var z=0;z<t.length;z++){var J=x[z];this.lineVertexArray.emplaceBack(J.x,J.y,J.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},dt.prototype.addSymbols=function(e,t,r,f,d,x,S,P,z,J,ee,ue){for(var ye=e.indexArray,Se=e.layoutVertexArray,qe=e.segments.prepareSegment(4*t.length,Se,ye,this.canOverlap?x.sortKey:void 0),Je=this.glyphOffsetArray.length,Ct=qe.vertexLength,st=this.allowVerticalPlacement&&S===Mr.vertical?Math.PI/2:0,zt=x.text&&x.text.sections,Qt=0;Qt<t.length;Qt++){var yr=t[Qt],Sr=yr.tl,Rr=yr.tr,nn=yr.bl,gn=yr.br,ii=yr.tex,Bn=yr.pixelOffsetTL,fi=yr.pixelOffsetBR,Zn=yr.minFontScaleX,na=yr.minFontScaleY,wi=yr.glyphOffset,Qn=yr.isSDF,da=yr.sectionIndex,Ki=qe.vertexLength,Aa=wi[1];vt(Se,P.x,P.y,Sr.x,Aa+Sr.y,ii.x,ii.y,r,Qn,Bn.x,Bn.y,Zn,na),vt(Se,P.x,P.y,Rr.x,Aa+Rr.y,ii.x+ii.w,ii.y,r,Qn,fi.x,Bn.y,Zn,na),vt(Se,P.x,P.y,nn.x,Aa+nn.y,ii.x,ii.y+ii.h,r,Qn,Bn.x,fi.y,Zn,na),vt(Se,P.x,P.y,gn.x,Aa+gn.y,ii.x+ii.w,ii.y+ii.h,r,Qn,fi.x,fi.y,Zn,na),jt(e.dynamicLayoutVertexArray,P,st),ye.emplaceBack(Ki,Ki+1,Ki+2),ye.emplaceBack(Ki+1,Ki+2,Ki+3),qe.vertexLength+=4,qe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(wi[0]),Qt!==t.length-1&&da===t[Qt+1].sectionIndex||e.programConfigurations.populatePaintArrays(Se.length,x,x.index,{},ue,zt&&zt[da])}e.placedSymbolArray.emplaceBack(P.x,P.y,Je,this.glyphOffsetArray.length-Je,Ct,z,J,P.segment,r?r[0]:0,r?r[1]:0,f[0],f[1],S,0,!1,0,ee)},dt.prototype._addCollisionDebugVertex=function(e,t,r,f,d,x){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,f,d,Math.round(x.x),Math.round(x.y))},dt.prototype.addCollisionDebugVertices=function(e,t,r,f,d,x,S){var P=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),z=P.vertexLength,J=d.layoutVertexArray,ee=d.collisionVertexArray,ue=S.anchorX,ye=S.anchorY;this._addCollisionDebugVertex(J,ee,x,ue,ye,new N(e,t)),this._addCollisionDebugVertex(J,ee,x,ue,ye,new N(r,t)),this._addCollisionDebugVertex(J,ee,x,ue,ye,new N(r,f)),this._addCollisionDebugVertex(J,ee,x,ue,ye,new N(e,f)),P.vertexLength+=4;var Se=d.indexArray;Se.emplaceBack(z,z+1),Se.emplaceBack(z+1,z+2),Se.emplaceBack(z+2,z+3),Se.emplaceBack(z+3,z),P.primitiveLength+=4},dt.prototype.addDebugCollisionBoxes=function(e,t,r,f){for(var d=e;d<t;d++){var x=this.collisionBoxArray.get(d);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,f?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,r)}},dt.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new bt(wl,Ip.members,cc),this.iconCollisionBox=new bt(wl,Ip.members,cc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},dt.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,f,d,x,S,P,z){for(var J={},ee=t;ee<r;ee++){var ue=e.get(ee);J.textBox={x1:ue.x1,y1:ue.y1,x2:ue.x2,y2:ue.y2,anchorPointX:ue.anchorPointX,anchorPointY:ue.anchorPointY},J.textFeatureIndex=ue.featureIndex;break}for(var ye=f;ye<d;ye++){var Se=e.get(ye);J.verticalTextBox={x1:Se.x1,y1:Se.y1,x2:Se.x2,y2:Se.y2,anchorPointX:Se.anchorPointX,anchorPointY:Se.anchorPointY},J.verticalTextFeatureIndex=Se.featureIndex;break}for(var qe=x;qe<S;qe++){var Je=e.get(qe);J.iconBox={x1:Je.x1,y1:Je.y1,x2:Je.x2,y2:Je.y2,anchorPointX:Je.anchorPointX,anchorPointY:Je.anchorPointY},J.iconFeatureIndex=Je.featureIndex;break}for(var Ct=P;Ct<z;Ct++){var st=e.get(Ct);J.verticalIconBox={x1:st.x1,y1:st.y1,x2:st.x2,y2:st.y2,anchorPointX:st.anchorPointX,anchorPointY:st.anchorPointY},J.verticalIconFeatureIndex=st.featureIndex;break}return J},dt.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},dt.prototype.hasTextData=function(){return this.text.segments.get().length>0},dt.prototype.hasIconData=function(){return this.icon.segments.get().length>0},dt.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},dt.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},dt.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},dt.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),f=r.vertexStartIndex+4*r.numGlyphs,d=r.vertexStartIndex;d<f;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)},dt.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),f=[],d=[],x=[],S=0;S<this.symbolInstances.length;++S){x.push(S);var P=this.symbolInstances.get(S);f.push(0|Math.round(t*P.anchorX+r*P.anchorY)),d.push(P.featureIndex)}return x.sort(function(z,J){return f[z]-f[J]||d[J]-d[z]}),x},dt.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},dt.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,f=this.symbolInstanceIndexes;r<f.length;r+=1){var d=this.symbolInstances.get(f[r]);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach(function(x,S,P){x>=0&&P.indexOf(x)===S&&t.addIndicesForPlacedSymbol(t.text,x)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Fn("SymbolBucket",dt,{omit:["layers","collisionBoxArray","features","compareText"]}),dt.MAX_GLYPHS=65535,dt.addDynamicAttributes=jt;var ze=new Po({"symbol-placement":new ri(pe.layout_symbol["symbol-placement"]),"symbol-spacing":new ri(pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ri(pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new In(pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ri(pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ri(pe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ri(pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new ri(pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ri(pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new In(pe.layout_symbol["icon-size"]),"icon-text-fit":new ri(pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ri(pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new In(pe.layout_symbol["icon-image"]),"icon-rotate":new In(pe.layout_symbol["icon-rotate"]),"icon-padding":new ri(pe.layout_symbol["icon-padding"]),"icon-keep-upright":new ri(pe.layout_symbol["icon-keep-upright"]),"icon-offset":new In(pe.layout_symbol["icon-offset"]),"icon-anchor":new In(pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ri(pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ri(pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ri(pe.layout_symbol["text-rotation-alignment"]),"text-field":new In(pe.layout_symbol["text-field"]),"text-font":new In(pe.layout_symbol["text-font"]),"text-size":new In(pe.layout_symbol["text-size"]),"text-max-width":new In(pe.layout_symbol["text-max-width"]),"text-line-height":new ri(pe.layout_symbol["text-line-height"]),"text-letter-spacing":new In(pe.layout_symbol["text-letter-spacing"]),"text-justify":new In(pe.layout_symbol["text-justify"]),"text-radial-offset":new In(pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ri(pe.layout_symbol["text-variable-anchor"]),"text-anchor":new In(pe.layout_symbol["text-anchor"]),"text-max-angle":new ri(pe.layout_symbol["text-max-angle"]),"text-writing-mode":new ri(pe.layout_symbol["text-writing-mode"]),"text-rotate":new In(pe.layout_symbol["text-rotate"]),"text-padding":new ri(pe.layout_symbol["text-padding"]),"text-keep-upright":new ri(pe.layout_symbol["text-keep-upright"]),"text-transform":new In(pe.layout_symbol["text-transform"]),"text-offset":new In(pe.layout_symbol["text-offset"]),"text-allow-overlap":new ri(pe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ri(pe.layout_symbol["text-ignore-placement"]),"text-optional":new ri(pe.layout_symbol["text-optional"])}),ht={paint:new Po({"icon-opacity":new In(pe.paint_symbol["icon-opacity"]),"icon-color":new In(pe.paint_symbol["icon-color"]),"icon-halo-color":new In(pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new In(pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new In(pe.paint_symbol["icon-halo-blur"]),"icon-translate":new ri(pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new ri(pe.paint_symbol["icon-translate-anchor"]),"text-opacity":new In(pe.paint_symbol["text-opacity"]),"text-color":new In(pe.paint_symbol["text-color"],{runtimeType:fn,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new In(pe.paint_symbol["text-halo-color"]),"text-halo-width":new In(pe.paint_symbol["text-halo-width"]),"text-halo-blur":new In(pe.paint_symbol["text-halo-blur"]),"text-translate":new ri(pe.paint_symbol["text-translate"]),"text-translate-anchor":new ri(pe.paint_symbol["text-translate-anchor"])}),layout:ze},We=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Pn,this.defaultValue=e};We.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},We.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},We.prototype.outputDefined=function(){return!1},We.prototype.serialize=function(){return null},Fn("FormatSectionOverride",We,{omit:["defaultValue"]});var Ht=function(e){function t(r){e.call(this,r,ht)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,f){if(e.prototype.recalculate.call(this,r,f),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var d=this.layout.get("text-writing-mode");if(d){for(var x=[],S=0,P=d;S<P.length;S+=1){var z=P[S];x.indexOf(z)<0&&x.push(z)}this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,f,d,x){var z,S=this.layout.get(r).evaluate(f,{},d,x),P=this._unevaluatedLayout._values[r];return P.isDataDriven()||$u(P.value)||!S?S:(z=f.properties,S.replace(/{([^{}]+)}/g,function(ee,ue){return ue in z?String(z[ue]):""}))},t.prototype.createBucket=function(r){return new dt(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,f=ht.paint.overridableProperties;r<f.length;r+=1){var d=f[r];if(t.hasPaintOverride(this.layout,d)){var x,S=this.paint.get(d),P=new We(S),z=new yu(P,S.property.specification);x="constant"===S.value.kind||"source"===S.value.kind?new Qu("source",z):new el("composite",z,S.value.zoomStops,S.value._interpolationType),this.paint._values[d]=new mo(S.property,x,S.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,f,d){return!(!this.layout||f.isDataDriven()||d.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,f){var d=r.get("text-field"),x=ht.paint.properties[f],S=!1,P=function(ee){for(var ue=0,ye=ee;ue<ye.length;ue+=1)if(x.overrides&&x.overrides.hasOverride(ye[ue]))return void(S=!0)};if("constant"===d.value.kind&&d.value.value instanceof Za)P(d.value.value.sections);else if("source"===d.value.kind){var z=function(ee){S||(ee instanceof Bi&&Da(ee.value)===ta?P(ee.value.sections):ee instanceof vo?P(ee.sections):ee.eachChild(z))},J=d.value;J._styleExpression&&z(J._styleExpression.expression)}return S},t}(fo),$t={paint:new Po({"background-color":new ri(pe.paint_background["background-color"]),"background-pattern":new wo(pe.paint_background["background-pattern"]),"background-opacity":new ri(pe.paint_background["background-opacity"])})},Zr=function(e){function t(r){e.call(this,r,$t)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(fo),un={paint:new Po({"raster-opacity":new ri(pe.paint_raster["raster-opacity"]),"raster-hue-rotate":new ri(pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ri(pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ri(pe.paint_raster["raster-brightness-max"]),"raster-saturation":new ri(pe.paint_raster["raster-saturation"]),"raster-contrast":new ri(pe.paint_raster["raster-contrast"]),"raster-resampling":new ri(pe.paint_raster["raster-resampling"]),"raster-fade-duration":new ri(pe.paint_raster["raster-fade-duration"])})},ln=function(e){function t(r){e.call(this,r,un)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(fo),bn=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},t.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(fo),on={circle:Ko,heatmap:Wf,hillshade:xh,fill:ql,"fill-extrusion":Ch,line:Ap,symbol:Ht,background:Zr,raster:ln},Yn=j.HTMLImageElement,kn=j.HTMLCanvasElement,jn=j.HTMLVideoElement,Kn=j.ImageData,Hn=j.ImageBitmap,ci=function(e,t,r,f){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,f)};ci.prototype.update=function(e,t,r){var f=e.width,d=e.height,x=!(this.size&&this.size[0]===f&&this.size[1]===d||r),S=this.context,P=S.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!t||!1!==t.premultiply)),x)this.size=[f,d],e instanceof Yn||e instanceof kn||e instanceof jn||e instanceof Kn||Hn&&e instanceof Hn?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,f,d,0,this.format,P.UNSIGNED_BYTE,e.data);else{var z=r||{x:0,y:0},J=z.x,ee=z.y;e instanceof Yn||e instanceof kn||e instanceof jn||e instanceof Kn||Hn&&e instanceof Hn?P.texSubImage2D(P.TEXTURE_2D,0,J,ee,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,J,ee,f,d,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)},ci.prototype.bind=function(e,t,r){var f=this.context.gl;f.bindTexture(f.TEXTURE_2D,this.texture),r!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=f.LINEAR),e!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,t),this.wrap=t)},ci.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ci.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var qa=function(e){var t=this;this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};qa.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},qa.prototype.remove=function(){delete this._channel,this._callback=function(){}};var jo=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Gt(["receive","process"],this),this.invoker=new qa(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=ut()?e:j};function $l(e,t,r){var f=2*Math.PI*6378137/256/Math.pow(2,r);return[e*f-2*Math.PI*6378137/2,t*f-2*Math.PI*6378137/2]}jo.prototype.send=function(e,t,r,f,d){var x=this;void 0===d&&(d=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[S]=r);var P=ce(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:e,hasCallback:!!r,targetMapId:f,mustQueue:d,sourceMapId:this.mapId,data:iu(t,P)},P),{cancel:function(){r&&delete x.callbacks[S],x.target.postMessage({id:S,type:"<cancel>",targetMapId:f,sourceMapId:x.mapId})}}},jo.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];var f=this.cancelCallbacks[r];delete this.cancelCallbacks[r],f&&f()}else ut()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},jo.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},jo.prototype.processTask=function(e,t){var r=this;if("<response>"===t.type){var f=this.callbacks[e];delete this.callbacks[e],f&&(t.error?f(Es(t.error)):f(null,Es(t.data)))}else{var d=!1,x=ce(this.globalScope)?void 0:[],S=t.hasCallback?function(ee,ue){d=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:ee?iu(ee):null,data:iu(ue,x)},x)}:function(ee){d=!0},P=null,z=Es(t.data);if(this.parent[t.type])P=this.parent[t.type](t.sourceMapId,z,S);else if(this.parent.getWorkerSource){var J=t.type.split(".");P=this.parent.getWorkerSource(t.sourceMapId,J[0],z.source)[J[1]](z,S)}else S(new Error("Could not find function "+t.type));!d&&P&&P.cancel&&(this.cancelCallbacks[e]=P.cancel)}},jo.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ao=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};ao.prototype.setNorthEast=function(e){return this._ne=e instanceof Ba?new Ba(e.lng,e.lat):Ba.convert(e),this},ao.prototype.setSouthWest=function(e){return this._sw=e instanceof Ba?new Ba(e.lng,e.lat):Ba.convert(e),this},ao.prototype.extend=function(e){var t,r,f=this._sw,d=this._ne;if(e instanceof Ba)t=e,r=e;else{if(!(e instanceof ao))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(ao.convert(e)):this.extend(Ba.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return f||d?(f.lng=Math.min(t.lng,f.lng),f.lat=Math.min(t.lat,f.lat),d.lng=Math.max(r.lng,d.lng),d.lat=Math.max(r.lat,d.lat)):(this._sw=new Ba(t.lng,t.lat),this._ne=new Ba(r.lng,r.lat)),this},ao.prototype.getCenter=function(){return new Ba((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ao.prototype.getSouthWest=function(){return this._sw},ao.prototype.getNorthEast=function(){return this._ne},ao.prototype.getNorthWest=function(){return new Ba(this.getWest(),this.getNorth())},ao.prototype.getSouthEast=function(){return new Ba(this.getEast(),this.getSouth())},ao.prototype.getWest=function(){return this._sw.lng},ao.prototype.getSouth=function(){return this._sw.lat},ao.prototype.getEast=function(){return this._ne.lng},ao.prototype.getNorth=function(){return this._ne.lat},ao.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ao.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ao.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ao.prototype.contains=function(e){var t=Ba.convert(e),r=t.lng,f=t.lat,d=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&d},ao.convert=function(e){return!e||e instanceof ao?e:new ao(e)};var Ba=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ba.prototype.wrap=function(){return new Ba(Ye(this.lng,-180,180),this.lat)},Ba.prototype.toArray=function(){return[this.lng,this.lat]},Ba.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ba.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,f=e.lat*t,d=Math.sin(r)*Math.sin(f)+Math.cos(r)*Math.cos(f)*Math.cos((e.lng-this.lng)*t);return 6371008.8*Math.acos(Math.min(d,1))},Ba.prototype.toBounds=function(e){void 0===e&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new ao(new Ba(this.lng-r,this.lat-t),new Ba(this.lng+r,this.lat+t))},Ba.convert=function(e){if(e instanceof Ba)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Ba(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Ba(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var zs=2*Math.PI*6371008.8;function Xu(e){return zs*Math.cos(e*Math.PI/180)}function Ou(e){return(180+e)/360}function Mh(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Yu(e,t){return e/Xu(t)}function Qf(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var eh=function(e,t,r){void 0===r&&(r=0),this.x=+e,this.y=+t,this.z=+r};eh.fromLngLat=function(e,t){void 0===t&&(t=0);var r=Ba.convert(e);return new eh(Ou(r.lng),Mh(r.lat),Yu(t,r.lat))},eh.prototype.toLngLat=function(){return new Ba(360*this.x-180,Qf(this.y))},eh.prototype.toAltitude=function(){return this.z*Xu(Qf(this.y))},eh.prototype.meterInMercatorCoordinateUnits=function(){return 1/zs*(e=Qf(this.y),1/Math.cos(e*Math.PI/180));var e};var Zc=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=op(0,e,e,t,r)};Zc.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Zc.prototype.url=function(e,t){var r,f,d,x,S,P=(f=this.y,d=this.z,x=$l(256*(r=this.x),256*(f=Math.pow(2,d)-f-1),d),S=$l(256*(r+1),256*(f+1),d),x[0]+","+x[1]+","+S[0]+","+S[1]),z=function(J,ee,ue){for(var ye,Se="",qe=J;qe>0;qe--)Se+=(ee&(ye=1<<qe-1)?1:0)+(ue&ye?2:0);return Se}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",P)},Zc.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new N(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Zc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var td=function(e,t){this.wrap=e,this.canonical=t,this.key=op(e,t.z,t.z,t.x,t.y)},cs=function(e,t,r,f,d){this.overscaledZ=e,this.wrap=t,this.canonical=new Zc(r,+f,+d),this.key=op(t,e,r,f,d)};function op(e,t,r,f,d){(e*=2)<0&&(e=-1*e-1);var x=1<<r;return(x*x*e+x*d+f).toString(36)+r.toString(36)+t.toString(36)}cs.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},cs.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new cs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new cs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},cs.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?op(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):op(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},cs.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},cs.prototype.children=function(e){if(this.overscaledZ>=e)return[new cs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,f=2*this.canonical.y;return[new cs(t,this.wrap,t,r,f),new cs(t,this.wrap,t,r+1,f),new cs(t,this.wrap,t,r,f+1),new cs(t,this.wrap,t,r+1,f+1)]},cs.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},cs.prototype.wrapped=function(){return new cs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},cs.prototype.unwrapTo=function(e){return new cs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},cs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},cs.prototype.toUnwrapped=function(){return new td(this.wrap,this.canonical)},cs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},cs.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new eh(e.x-this.wrap,e.y))},Fn("CanonicalTileID",Zc),Fn("OverscaledTileID",cs,{omit:["posMatrix"]});var _f=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return Xe('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var f=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var d=0;d<f;d++)this.data[this._idx(-1,d)]=this.data[this._idx(0,d)],this.data[this._idx(f,d)]=this.data[this._idx(f-1,d)],this.data[this._idx(d,-1)]=this.data[this._idx(d,0)],this.data[this._idx(d,f)]=this.data[this._idx(d,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};_f.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),f=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[f],r[f+1],r[f+2])},_f.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},_f.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},_f.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},_f.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},_f.prototype.getPixels=function(){return new ca({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},_f.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var f=t*this.dim,d=t*this.dim+this.dim,x=r*this.dim,S=r*this.dim+this.dim;switch(t){case-1:f=d-1;break;case 1:d=f+1}switch(r){case-1:x=S-1;break;case 1:S=x+1}for(var P=-t*this.dim,z=-r*this.dim,J=x;J<S;J++)for(var ee=f;ee<d;ee++)this.data[this._idx(ee,J)]=e.data[this._idx(ee+P,J+z)]},Fn("DEMData",_f);var th=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};th.prototype.encode=function(e){return this._stringToNumber[e]},th.prototype.decode=function(e){return this._numberToString[e]};var rh=function(e,t,r,f,d){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=f,this.properties=e.properties,this.id=d},Oh={geometry:{configurable:!0}};Oh.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Oh.geometry.set=function(e){this._geometry=e},rh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e},Object.defineProperties(rh.prototype,Oh);var Rf=function(){this.state={},this.stateChanges={},this.deletedStates={}};Rf.prototype.updateState=function(e,t,r){var f=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},_t(this.stateChanges[e][f],r),null===this.deletedStates[e])for(var d in this.deletedStates[e]={},this.state[e])d!==f&&(this.deletedStates[e][d]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][f])for(var x in this.deletedStates[e][f]={},this.state[e][f])r[x]||(this.deletedStates[e][f][x]=null);else for(var S in r)this.deletedStates[e]&&this.deletedStates[e][f]&&null===this.deletedStates[e][f][S]&&delete this.deletedStates[e][f][S]},Rf.prototype.removeFeatureState=function(e,t,r){if(null!==this.deletedStates[e]){var f=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][f]&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][f])for(r in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][r]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}},Rf.prototype.getState=function(e,t){var r=String(t),f=_t({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var d=this.deletedStates[e][t];if(null===d)return{};for(var x in d)delete f[x]}return f},Rf.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Rf.prototype.coalesceChanges=function(e,t){var r={};for(var f in this.stateChanges){this.state[f]=this.state[f]||{};var d={};for(var x in this.stateChanges[f])this.state[f][x]||(this.state[f][x]={}),_t(this.state[f][x],this.stateChanges[f][x]),d[x]=this.state[f][x];r[f]=d}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var P={};if(null===this.deletedStates[S])for(var z in this.state[S])P[z]={},this.state[S][z]={};else for(var J in this.deletedStates[S]){if(null===this.deletedStates[S][J])this.state[S][J]={};else for(var ee=0,ue=Object.keys(this.deletedStates[S][J]);ee<ue.length;ee+=1)delete this.state[S][J][ue[ee]];P[J]=this.state[S][J]}r[S]=r[S]||{},_t(r[S],P)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var ye in e)e[ye].setFeatureState(r,t)};var Ql=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new _u(8192,16,0),this.grid3D=new _u(8192,16,0),this.featureIndexArray=new he,this.promoteId=t};function sp(e,t,r,f,d){return Ut(e,function(x,S){var P=t instanceof il?t.get(S):null;return P&&P.evaluate?P.evaluate(r,f,d):P})}function vd(e){for(var t=1/0,r=1/0,f=-1/0,d=-1/0,x=0,S=e;x<S.length;x+=1){var P=S[x];t=Math.min(t,P.x),r=Math.min(r,P.y),f=Math.max(f,P.x),d=Math.max(d,P.y)}return{minX:t,minY:r,maxX:f,maxY:d}}function Zd(e,t){return t-e}Ql.prototype.insert=function(e,t,r,f,d,x){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,f,d);for(var P=x?this.grid3D:this.grid,z=0;z<t.length;z++){for(var J=t[z],ee=[1/0,1/0,-1/0,-1/0],ue=0;ue<J.length;ue++){var ye=J[ue];ee[0]=Math.min(ee[0],ye.x),ee[1]=Math.min(ee[1],ye.y),ee[2]=Math.max(ee[2],ye.x),ee[3]=Math.max(ee[3],ye.y)}ee[0]<8192&&ee[1]<8192&&ee[2]>=0&&ee[3]>=0&&P.insert(S,ee[0],ee[1],ee[2],ee[3])}},Ql.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new gf.VectorTile(new zc(this.rawTileData)).layers,this.sourceLayerCoder=new th(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ql.prototype.query=function(e,t,r,f){var d=this;this.loadVTLayers();for(var x=e.params||{},S=8192/e.tileSize/e.scale,P=Fu(x.filter),z=e.queryGeometry,J=e.queryPadding*S,ee=vd(z),ue=this.grid.query(ee.minX-J,ee.minY-J,ee.maxX+J,ee.maxY+J),ye=vd(e.cameraQueryGeometry),qe=0,Je=this.grid3D.query(ye.minX-J,ye.minY-J,ye.maxX+J,ye.maxY+J,function(yr,Sr,Rr,nn){return function(gn,ii,Bn,fi,Zn){for(var na=0,wi=gn;na<wi.length;na+=1){var Qn=wi[na];if(ii<=Qn.x&&Bn<=Qn.y&&fi>=Qn.x&&Zn>=Qn.y)return!0}var da=[new N(ii,Bn),new N(ii,Zn),new N(fi,Zn),new N(fi,Bn)];if(gn.length>2)for(var Ki=0,Aa=da;Ki<Aa.length;Ki+=1)if(Ha(gn,Aa[Ki]))return!0;for(var di=0;di<gn.length-1;di++)if(Wa(gn[di],gn[di+1],da))return!0;return!1}(e.cameraQueryGeometry,yr-J,Sr-J,Rr+J,nn+J)});qe<Je.length;qe+=1)ue.push(Je[qe]);ue.sort(Zd);for(var Ct,st={},zt=function(yr){var Sr=ue[yr];if(Sr!==Ct){Ct=Sr;var Rr=d.featureIndexArray.get(Sr),nn=null;d.loadMatchingFeature(st,Rr.bucketIndex,Rr.sourceLayerIndex,Rr.featureIndex,P,x.layers,x.availableImages,t,r,f,function(gn,ii,Bn){return nn||(nn=mt(gn)),ii.queryIntersectsFeature(z,gn,Bn,nn,d.z,e.transform,S,e.pixelPosMatrix)})}},Qt=0;Qt<ue.length;Qt++)zt(Qt);return st},Ql.prototype.loadMatchingFeature=function(e,t,r,f,d,x,S,P,z,J,ee){var ue=this.bucketLayerIDs[t];if(!x||function(gn,ii){for(var Bn=0;Bn<gn.length;Bn++)if(ii.indexOf(gn[Bn])>=0)return!0;return!1}(x,ue)){var ye=this.sourceLayerCoder.decode(r),Se=this.vtLayers[ye].feature(f);if(d.needGeometry){var qe=Nt(Se,!0);if(!d.filter(new $i(this.tileID.overscaledZ),qe,this.tileID.canonical))return}else if(!d.filter(new $i(this.tileID.overscaledZ),Se))return;for(var Je=this.getId(Se,ye),Ct=0;Ct<ue.length;Ct++){var st=ue[Ct];if(!(x&&x.indexOf(st)<0)){var zt=P[st];if(zt){var Qt={};void 0!==Je&&J&&(Qt=J.getState(zt.sourceLayer||"_geojsonTileLayer",Je));var yr=_t({},z[st]);yr.paint=sp(yr.paint,zt.paint,Se,Qt,S),yr.layout=sp(yr.layout,zt.layout,Se,Qt,S);var Sr=!ee||ee(Se,zt,Qt);if(Sr){var Rr=new rh(Se,this.z,this.x,this.y,Je);Rr.layer=yr;var nn=e[st];void 0===nn&&(nn=e[st]=[]),nn.push({featureIndex:f,feature:Rr,intersectionZ:Sr})}}}}}},Ql.prototype.lookupSymbolFeatures=function(e,t,r,f,d,x,S,P){var z={};this.loadVTLayers();for(var J=Fu(d),ee=0,ue=e;ee<ue.length;ee+=1)this.loadMatchingFeature(z,r,f,ue[ee],J,x,S,P,t);return z},Ql.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var f=0,d=r[t];f<d.length;f+=1)if(e===d[f])return!0;return!1},Ql.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&"boolean"==typeof(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(r=Number(r)),r},Fn("FeatureIndex",Ql,{omit:["rawTileData","sourceLayerCoder"]});var Is=function(e,t){this.tileID=e,this.uid=wt(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Is.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Ir.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Is.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Is.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var f in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(J,ee){var ue={};if(!ee)return ue;for(var ye=function(){var Je=qe[Se],Ct=Je.layerIds.map(function(Qt){return ee.getLayer(Qt)}).filter(Boolean);if(0!==Ct.length){Je.layers=Ct,Je.stateDependentLayerIds&&(Je.stateDependentLayers=Je.stateDependentLayerIds.map(function(Qt){return Ct.filter(function(yr){return yr.id===Qt})[0]}));for(var st=0,zt=Ct;st<zt.length;st+=1)ue[zt[st].id]=Je}},Se=0,qe=J;Se<qe.length;Se+=1)ye();return ue}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var d=this.buckets[f];if(d instanceof dt){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var x in this.buckets){var S=this.buckets[x];if(S instanceof dt&&S.hasRTLText){this.hasRTLText=!0,Cs.isLoading()||Cs.isLoaded()||"deferred"!==Lc()||Ws();break}}for(var P in this.queryPadding=0,this.buckets){var z=this.buckets[P];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(P).queryRadius(z))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Is.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Is.prototype.getBucket=function(e){return this.buckets[e.id]},Is.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var f=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ci(e,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ci(e,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)},Is.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Is.prototype.queryRenderedFeatures=function(e,t,r,f,d,x,S,P,z,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:d,scale:x,tileSize:this.tileSize,pixelPosMatrix:J,transform:P,params:S,queryPadding:this.queryPadding*z},e,t,r):{}},Is.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var f=r.loadVTLayers(),d=t?t.sourceLayer:"",x=f._geojsonTileLayer||f[d];if(x)for(var S=Fu(t&&t.filter),P=this.tileID.canonical,z=P.z,J=P.x,ee=P.y,ue={z,x:J,y:ee},ye=0;ye<x.length;ye++){var Se=x.feature(ye);if(S.needGeometry){var qe=Nt(Se,!0);if(!S.filter(new $i(this.tileID.overscaledZ),qe,this.tileID.canonical))continue}else if(!S.filter(new $i(this.tileID.overscaledZ),Se))continue;var Je=r.getId(Se,d),Ct=new rh(Se,z,J,ee,Je);Ct.tile=ue,e.push(Ct)}}},Is.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Is.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Is.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=ir(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var f=Date.now(),d=!1;if(this.expirationTime>f)d=!1;else if(t)if(this.expirationTime<t)d=!0;else{var x=this.expirationTime-t;x?this.expirationTime=f+Math.max(x,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Is.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Is.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var r=this.latestFeatureIndex.loadVTLayers();for(var f in this.buckets)if(t.style.hasLayer(f)){var d=this.buckets[f],x=d.layers[0].sourceLayer||"_geojsonTileLayer",S=r[x],P=e[x];if(S&&P&&0!==Object.keys(P).length){d.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var z=t&&t.style&&t.style.getLayer(f);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(d)))}}}},Is.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Is.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ir.now()},Is.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Is.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Ir.now()+e},Is.prototype.setDependencies=function(e,t){for(var r={},f=0,d=t;f<d.length;f+=1)r[d[f]]=!0;this.dependencies[e]=r},Is.prototype.hasDependency=function(e,t){for(var r=0,f=e;r<f.length;r+=1){var d=this.dependencies[f[r]];if(d)for(var x=0,S=t;x<S.length;x+=1)if(d[S[x]])return!0}return!1};var xf=j.performance,Il=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},xf.mark(this._marks.start)};Il.prototype.finish=function(){xf.mark(this._marks.end);var e=xf.getEntriesByName(this._marks.measure);return 0===e.length&&(xf.measure(this._marks.measure,this._marks.start,this._marks.end),e=xf.getEntriesByName(this._marks.measure),xf.clearMarks(this._marks.start),xf.clearMarks(this._marks.end),xf.clearMeasures(this._marks.measure)),e},l.Actor=jo,l.AlphaImage=Wu,l.CanonicalTileID=Zc,l.CollisionBoxArray=s,l.Color=Xi,l.DEMData=_f,l.DataConstantProperty=ri,l.DictionaryCoder=th,l.EXTENT=8192,l.ErrorEvent=xe,l.EvaluationParameters=$i,l.Event=oe,l.Evented=Oe,l.FeatureIndex=Ql,l.FillBucket=Fs,l.FillExtrusionBucket=Ps,l.ImageAtlas=An,l.ImagePosition=_r,l.LineBucket=Zo,l.LngLat=Ba,l.LngLatBounds=ao,l.MercatorCoordinate=eh,l.ONE_EM=24,l.OverscaledTileID=cs,l.Point=N,l.Point$1=N,l.Properties=Po,l.Protobuf=zc,l.RGBAImage=ca,l.RequestManager=Pr,l.RequestPerformance=Il,l.ResourceType=On,l.SegmentVector=Me,l.SourceFeatureState=Rf,l.StructArrayLayout1ui2=fc,l.StructArrayLayout2f1f2i16=ol,l.StructArrayLayout2i4=As,l.StructArrayLayout3ui6=sl,l.StructArrayLayout4i8=bl,l.SymbolBucket=dt,l.Texture=ci,l.Tile=Is,l.Transitionable=Yo,l.Uniform1f=Qr,l.Uniform1i=Dr,l.Uniform2f=Xr,l.Uniform3f=dn,l.Uniform4f=qn,l.UniformColor=Vn,l.UniformMatrix4f=Li,l.UnwrappedTileID=td,l.ValidationError=Ae,l.WritingMode=Mr,l.ZoomHistory=Xc,l.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},l.addDynamicAttributes=jt,l.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var f=e.length,d=new Array(e.length),x=null;e.forEach(function(S,P){t(S,function(z,J){z&&(x=z),d[P]=J,0==--f&&r(x,d)})})},l.bezier=Ne,l.bindAll=Gt,l.browser=Ir,l.cacheEntryPossiblyAdded=function(e){++dr>mr&&(e.getActor().send("enforceCacheSizeLimit",Tr),dr=0)},l.clamp=W,l.clearTileCache=function(e){var t=j.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},l.clipLine=ss,l.clone=function(e){var t=new ki(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},l.clone$1=Ue,l.clone$2=function(e){var t=new ki(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},l.collisionCircleLayout=Mp,l.config=Ot,l.create=function(){var e=new ki(16);return ki!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},l.create$1=function(){var e=new ki(9);return ki!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},l.create$2=function(){var e=new ki(4);return ki!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},l.createCommonjsModule=m,l.createExpression=pl,l.createLayout=zo,l.createStyleLayer=function(e){return"custom"===e.type?new bn(e):new on[e.type](e)},l.cross=function(e,t,r){var f=t[0],d=t[1],x=t[2],S=r[0],P=r[1],z=r[2];return e[0]=d*z-x*P,e[1]=x*S-f*z,e[2]=f*P-d*S,e},l.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var f=0;f<t.length;f++)if(!e(t[f],r[f]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r||Object.keys(t).length!==Object.keys(r).length)return!1;for(var d in t)if(!e(t[d],r[d]))return!1;return!0}return t===r},l.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},l.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},l.ease=V,l.emitValidationErrors=ml,l.endsWith=Q,l.enforceCacheSizeLimit=function(e){Yt(),xt&&xt.then(function(t){t.keys().then(function(r){for(var f=0;f<r.length-e;f++)t.delete(r[f])})})},l.evaluateSizeForFeature=Zi,l.evaluateSizeForZoom=fa,l.evaluateVariableOffset=Qe,l.evented=cf,l.extend=_t,l.featureFilter=Fu,l.filterObject=ot,l.fromRotation=function(e,t){var r=Math.sin(t),f=Math.cos(t);return e[0]=f,e[1]=r,e[2]=0,e[3]=-r,e[4]=f,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},l.getAnchorAlignment=zi,l.getAnchorJustification=vr,l.getArrayBuffer=Pi,l.getImage=ve,l.getJSON=function(e,t){return Yi(_t(e,{type:"json"}),t)},l.getRTLTextPluginStatus=Lc,l.getReferrer=hi,l.getVideo=function(e,t){var r,f,d=j.document.createElement("video");d.muted=!0,d.onloadstart=function(){t(null,d)};for(var x=0;x<e.length;x++){var S=j.document.createElement("source");r=e[x],f=void 0,(f=j.document.createElement("a")).href=r,(f.protocol!==j.document.location.protocol||f.host!==j.document.location.host)&&(d.crossOrigin="Anonymous"),S.src=e[x],d.appendChild(S)}return{cancel:function(){}}},l.identity=Ca,l.invert=function(e,t){var r=t[0],f=t[1],d=t[2],x=t[3],S=t[4],P=t[5],z=t[6],J=t[7],ee=t[8],ue=t[9],ye=t[10],Se=t[11],qe=t[12],Je=t[13],Ct=t[14],st=t[15],zt=r*P-f*S,Qt=r*z-d*S,yr=r*J-x*S,Sr=f*z-d*P,Rr=f*J-x*P,nn=d*J-x*z,gn=ee*Je-ue*qe,ii=ee*Ct-ye*qe,Bn=ee*st-Se*qe,fi=ue*Ct-ye*Je,Zn=ue*st-Se*Je,na=ye*st-Se*Ct,wi=zt*na-Qt*Zn+yr*fi+Sr*Bn-Rr*ii+nn*gn;return wi?(e[0]=(P*na-z*Zn+J*fi)*(wi=1/wi),e[1]=(d*Zn-f*na-x*fi)*wi,e[2]=(Je*nn-Ct*Rr+st*Sr)*wi,e[3]=(ye*Rr-ue*nn-Se*Sr)*wi,e[4]=(z*Bn-S*na-J*ii)*wi,e[5]=(r*na-d*Bn+x*ii)*wi,e[6]=(Ct*yr-qe*nn-st*Qt)*wi,e[7]=(ee*nn-ye*yr+Se*Qt)*wi,e[8]=(S*Zn-P*Bn+J*gn)*wi,e[9]=(f*Bn-r*Zn-x*gn)*wi,e[10]=(qe*Rr-Je*yr+st*zt)*wi,e[11]=(ue*yr-ee*Rr-Se*zt)*wi,e[12]=(P*ii-S*fi-z*gn)*wi,e[13]=(r*fi-f*ii+d*gn)*wi,e[14]=(Je*Qt-qe*Sr-Ct*zt)*wi,e[15]=(ee*Sr-ue*Qt+ye*zt)*wi,e):null},l.isChar=hn,l.isMapboxURL=er,l.keysDifference=function(e,t){var r=[];for(var f in e)f in t||r.push(f);return r},l.makeRequest=Yi,l.mapObject=Ut,l.mercatorXfromLng=Ou,l.mercatorYfromLat=Mh,l.mercatorZfromAltitude=Yu,l.mul=Yl,l.multiply=ba,l.mvt=gf,l.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},l.normalize=function(e,t){var r=t[0],f=t[1],d=t[2],x=r*r+f*f+d*d;return x>0&&(x=1/Math.sqrt(x)),e[0]=t[0]*x,e[1]=t[1]*x,e[2]=t[2]*x,e},l.number=Oa,l.offscreenCanvasSupported=mn,l.ortho=function(e,t,r,f,d,x,S){var P=1/(t-r),z=1/(f-d),J=1/(x-S);return e[0]=-2*P,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*J,e[11]=0,e[12]=(t+r)*P,e[13]=(d+f)*z,e[14]=(S+x)*J,e[15]=1,e},l.parseGlyphPBF=function(e){return new zc(e).readFields(pn,[])},l.pbf=zc,l.performSymbolLayout=function(e,t,r,f,d,x,S){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var P=e.layers[0].layout,z=e.layers[0]._unevaluatedLayout._values,J={};if("composite"===e.textSizeData.kind){var ee=e.textSizeData,ue=ee.maxZoom;J.compositeTextSizes=[z["text-size"].possiblyEvaluate(new $i(ee.minZoom),S),z["text-size"].possiblyEvaluate(new $i(ue),S)]}if("composite"===e.iconSizeData.kind){var ye=e.iconSizeData,Se=ye.maxZoom;J.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new $i(ye.minZoom),S),z["icon-size"].possiblyEvaluate(new $i(Se),S)]}J.layoutTextSize=z["text-size"].possiblyEvaluate(new $i(e.zoom+1),S),J.layoutIconSize=z["icon-size"].possiblyEvaluate(new $i(e.zoom+1),S),J.textMaxSize=z["text-size"].possiblyEvaluate(new $i(18));for(var qe=24*P.get("text-line-height"),Je="map"===P.get("text-rotation-alignment")&&"point"!==P.get("symbol-placement"),Ct=P.get("text-keep-upright"),st=P.get("text-size"),zt=function(){var Sr=yr[Qt],Rr=P.get("text-font").evaluate(Sr,{},S).join(","),nn=st.evaluate(Sr,{},S),gn=J.layoutTextSize.evaluate(Sr,{},S),ii=J.layoutIconSize.evaluate(Sr,{},S),Bn={horizontal:{},vertical:void 0},fi=Sr.text,Zn=[0,0];if(fi){var na=fi.toString(),wi=24*P.get("text-letter-spacing").evaluate(Sr,{},S),Qn=function(Sa){for(var Ja=0,Xa=Sa;Ja<Xa.length;Ja+=1)if(qi=Xa[Ja].charCodeAt(0),hn.Arabic(qi)||hn["Arabic Supplement"](qi)||hn["Arabic Extended-A"](qi)||hn["Arabic Presentation Forms-A"](qi)||hn["Arabic Presentation Forms-B"](qi))return!1;var qi;return!0}(na)?wi:0,da=P.get("text-anchor").evaluate(Sr,{},S),Ki=P.get("text-variable-anchor");if(!Ki){var Aa=P.get("text-radial-offset").evaluate(Sr,{},S);Zn=Aa?Qe(da,[24*Aa,Pl]):P.get("text-offset").evaluate(Sr,{},S).map(function(Sa){return 24*Sa})}var di=Je?"center":P.get("text-justify").evaluate(Sr,{},S),Ra=P.get("symbol-placement"),Co="point"===Ra?24*P.get("text-max-width").evaluate(Sr,{},S):0,Ao=function(){e.allowVerticalPlacement&&Yc(na)&&(Bn.vertical=ui(fi,t,r,d,Rr,Co,qe,da,"left",Qn,Zn,Mr.vertical,!0,Ra,gn,nn))};if(!Je&&Ki){for(var Do="auto"===di?Ki.map(function(Sa){return vr(Sa)}):[di],ho=!1,Oo=0;Oo<Do.length;Oo++){var xs=Do[Oo];if(!Bn.horizontal[xs])if(ho)Bn.horizontal[xs]=Bn.horizontal[0];else{var bs=ui(fi,t,r,d,Rr,Co,qe,"center",xs,Qn,Zn,Mr.horizontal,!1,Ra,gn,nn);bs&&(Bn.horizontal[xs]=bs,ho=1===bs.positionedLines.length)}}Ao()}else{"auto"===di&&(di=vr(da));var fu=ui(fi,t,r,d,Rr,Co,qe,da,di,Qn,Zn,Mr.horizontal,!1,Ra,gn,nn);fu&&(Bn.horizontal[di]=fu),Ao(),Yc(na)&&Je&&Ct&&(Bn.vertical=ui(fi,t,r,d,Rr,Co,qe,da,di,Qn,Zn,Mr.vertical,!1,Ra,gn,nn))}}var Sa,Ja,qi,$s,Zs,Ms=void 0,hu=!1;if(Sr.icon&&Sr.icon.name){var No=f[Sr.icon.name];No&&(Sa=d[Sr.icon.name],Ja=P.get("icon-offset").evaluate(Sr,{},S),qi=zi(P.get("icon-anchor").evaluate(Sr,{},S)),Ms={image:Sa,top:Zs=Ja[1]-Sa.displaySize[1]*qi.verticalAlign,bottom:Zs+Sa.displaySize[1],left:$s=Ja[0]-Sa.displaySize[0]*qi.horizontalAlign,right:$s+Sa.displaySize[0]},hu=No.sdf,void 0===e.sdfIcons?e.sdfIcons=No.sdf:e.sdfIcons!==No.sdf&&Xe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(No.pixelRatio!==e.pixelRatio||0!==P.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var Os=zn(Bn.horizontal)||Bn.vertical;e.iconsInText=!!Os&&Os.iconsInText,(Os||Ms)&&function(Sa,Ja,Xa,qi,$s,Zs,yo,fs,Ss,Pa,vc){var cl=Zs.textMaxSize.evaluate(Ja,{});void 0===cl&&(cl=yo);var Ml,Bo=Sa.layers[0].layout,Uc=Bo.get("icon-offset").evaluate(Ja,{},vc),Ku=zn(Xa.horizontal),mc=yo/24,Df=Sa.tilePixelRatio*mc,nh=Sa.tilePixelRatio*cl/24,af=Sa.tilePixelRatio*fs,ih=Sa.tilePixelRatio*Bo.get("symbol-spacing"),Lh=Bo.get("text-padding")*Sa.tilePixelRatio,ah=Bo.get("icon-padding")*Sa.tilePixelRatio,oh=Bo.get("text-max-angle")/180*Math.PI,kh="map"===Bo.get("text-rotation-alignment")&&"point"!==Bo.get("symbol-placement"),Rh="map"===Bo.get("icon-rotation-alignment")&&"point"!==Bo.get("symbol-placement"),Vc=Bo.get("symbol-placement"),sh=ih/2,uh=Bo.get("icon-text-fit");qi&&"none"!==uh&&(Sa.allowVerticalPlacement&&Xa.vertical&&(Ml=Cn(qi,Xa.vertical,uh,Bo.get("icon-text-fit-padding"),Uc,mc)),Ku&&(qi=Cn(qi,Ku,uh,Bo.get("icon-text-fit-padding"),Uc,mc)));var gc=function(md,Vh){Vh.x<0||Vh.x>=8192||Vh.y<0||Vh.y>=8192||function(Go,yc,gd,wf,jh,yd,Gh,_c,Hh,Ff,ph,pu,Wh,zf,pp,kp,nd,_d,Xh,dh,qu,Yh,Rp,Lu,Dp){var Kh,Zf,vh,xc,mh,gh=Go.addToLineVertexArray(yc,gd),xd=0,bd=0,Sd=0,wd=0,id=-1,ad=-1,Ef={},Np=Ke(""),qh=0,od=0;if(void 0===_c._unevaluatedLayout.getValue("text-radial-offset")?(qh=(Kh=_c.layout.get("text-offset").evaluate(qu,{},Lu).map(function(mp){return 24*mp}))[0],od=Kh[1]):(qh=24*_c.layout.get("text-radial-offset").evaluate(qu,{},Lu),od=Pl),Go.allowVerticalPlacement&&wf.vertical){var Bp=_c.layout.get("text-rotate").evaluate(qu,{},Lu)+90;xc=new ka(Hh,yc,Ff,ph,pu,wf.vertical,Wh,zf,pp,Bp),Gh&&(mh=new ka(Hh,yc,Ff,ph,pu,Gh,nd,_d,pp,Bp))}if(jh){var Fp=_c.layout.get("icon-rotate").evaluate(qu,{}),Ed="none"!==_c.layout.get("icon-text-fit"),zp=ms(jh,Fp,Rp,Ed),Zp=Gh?ms(Gh,Fp,Rp,Ed):void 0;vh=new ka(Hh,yc,Ff,ph,pu,jh,nd,_d,!1,Fp),xd=4*zp.length;var Td=Go.iconSizeData,yh=null;"source"===Td.kind?(yh=[128*_c.layout.get("icon-size").evaluate(qu,{})])[0]>32640&&Xe(Go.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Td.kind&&((yh=[128*Yh.compositeIconSizes[0].evaluate(qu,{},Lu),128*Yh.compositeIconSizes[1].evaluate(qu,{},Lu)])[0]>32640||yh[1]>32640)&&Xe(Go.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Go.addSymbols(Go.icon,zp,yh,dh,Xh,qu,!1,yc,gh.lineStartIndex,gh.lineLength,-1,Lu),id=Go.icon.placedSymbolArray.length-1,Zp&&(bd=4*Zp.length,Go.addSymbols(Go.icon,Zp,yh,dh,Xh,qu,Mr.vertical,yc,gh.lineStartIndex,gh.lineLength,-1,Lu),ad=Go.icon.placedSymbolArray.length-1)}for(var sd in wf.horizontal){var Up=wf.horizontal[sd];if(!Zf){Np=Ke(Up.text);var dp=_c.layout.get("text-rotate").evaluate(qu,{},Lu);Zf=new ka(Hh,yc,Ff,ph,pu,Up,Wh,zf,pp,dp)}var ud=1===Up.positionedLines.length;if(Sd+=tr(Go,yc,Up,yd,_c,pp,qu,kp,gh,wf.vertical?Mr.horizontal:Mr.horizontalOnly,ud?Object.keys(wf.horizontal):[sd],Ef,id,Yh,Lu),ud)break}wf.vertical&&(wd+=tr(Go,yc,wf.vertical,yd,_c,pp,qu,kp,gh,Mr.vertical,["vertical"],Ef,ad,Yh,Lu));var Ud=Zf?Zf.boxStartIndex:Go.collisionBoxArray.length,Uf=Zf?Zf.boxEndIndex:Go.collisionBoxArray.length,ld=xc?xc.boxStartIndex:Go.collisionBoxArray.length,vp=xc?xc.boxEndIndex:Go.collisionBoxArray.length,Cd=vh?vh.boxStartIndex:Go.collisionBoxArray.length,Ad=vh?vh.boxEndIndex:Go.collisionBoxArray.length,_h=mh?mh.boxStartIndex:Go.collisionBoxArray.length,Pd=mh?mh.boxEndIndex:Go.collisionBoxArray.length,jc=-1,Vp=function(mp,Md){return mp&&mp.circleDiameter?Math.max(mp.circleDiameter,Md):Md};jc=Vp(Zf,jc),jc=Vp(xc,jc),jc=Vp(vh,jc);var Id=(jc=Vp(mh,jc))>-1?1:0;Id&&(jc*=Dp/24),Go.glyphOffsetArray.length>=dt.MAX_GLYPHS&&Xe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==qu.sortKey&&Go.addToSortKeyRanges(Go.symbolInstances.length,qu.sortKey),Go.symbolInstances.emplaceBack(yc.x,yc.y,Ef.right>=0?Ef.right:-1,Ef.center>=0?Ef.center:-1,Ef.left>=0?Ef.left:-1,Ef.vertical||-1,id,ad,Np,Ud,Uf,ld,vp,Cd,Ad,_h,Pd,Ff,Sd,wd,xd,bd,Id,0,Wh,qh,od,jc)}(Sa,Vh,md,Xa,qi,$s,Ml,Sa.layers[0],Sa.collisionBoxArray,Ja.index,Ja.sourceLayerIndex,Sa.index,Df,Lh,kh,Ss,af,ah,Rh,Uc,Ja,Zs,Pa,vc,yo)};if("line"===Vc)for(var bf=0,Dh=ss(Ja.geometry,0,0,8192,8192);bf<Dh.length;bf+=1)for(var up=Dh[bf],Nh=0,Bh=Uo(up,ih,oh,Xa.vertical||Ku,qi,24,nh,Sa.overscaling,8192);Nh<Bh.length;Nh+=1){var lp=Bh[Nh];Ku&&ya(Sa,Ku.text,sh,lp)||gc(up,lp)}else if("line-center"===Vc)for(var Sf=0,lh=Ja.geometry;Sf<lh.length;Sf+=1){var ch=lh[Sf];if(ch.length>1){var Fh=vs(ch,oh,Xa.vertical||Ku,qi,24,nh);Fh&&gc(ch,Fh)}}else if("Polygon"===Ja.type)for(var Nf=0,zh=If(Ja.geometry,0);Nf<zh.length;Nf+=1){var fh=zh[Nf],Zh=pa(fh,16);gc(fh[0],new Tn(Zh.x,Zh.y,0))}else if("LineString"===Ja.type)for(var Bf=0,Uh=Ja.geometry;Bf<Uh.length;Bf+=1){var hh=Uh[Bf];gc(hh,new Tn(hh[0].x,hh[0].y,0))}else if("Point"===Ja.type)for(var cp=0,rd=Ja.geometry;cp<rd.length;cp+=1)for(var fp=0,Lp=rd[cp];fp<Lp.length;fp+=1){var hp=Lp[fp];gc([hp],new Tn(hp.x,hp.y,0))}}(e,Sr,Bn,Ms,f,J,gn,ii,Zn,hu,S)},Qt=0,yr=e.features;Qt<yr.length;Qt+=1)zt();x&&e.generateCollisionDebugBuffers()},l.perspective=function(e,t,r,f,d){var x,S=1/Math.tan(t/2);return e[0]=S/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=S,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=d&&d!==1/0?(e[10]=(d+f)*(x=1/(f-d)),e[14]=2*d*f*x):(e[10]=-1,e[14]=-2*f),e},l.pick=function(e,t){for(var r={},f=0;f<t.length;f++){var d=t[f];d in e&&(r[d]=e[d])}return r},l.plugin=Cs,l.polygonIntersectsPolygon=jr,l.postMapLoadEvent=Jt,l.postTurnstileEvent=Et,l.potpack=Vt,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.register=Fn,l.registerForPluginStateChange=function(e){return e({pluginStatus:Ds,pluginURL:Hs}),cf.on("pluginStateChange",e),e},l.renderColorRamp=Tl,l.rotate=function(e,t,r){var f=t[0],d=t[1],x=t[2],S=t[3],P=Math.sin(r),z=Math.cos(r);return e[0]=f*z+x*P,e[1]=d*z+S*P,e[2]=f*-P+x*z,e[3]=d*-P+S*z,e},l.rotateX=function(e,t,r){var f=Math.sin(r),d=Math.cos(r),x=t[4],S=t[5],P=t[6],z=t[7],J=t[8],ee=t[9],ue=t[10],ye=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=x*d+J*f,e[5]=S*d+ee*f,e[6]=P*d+ue*f,e[7]=z*d+ye*f,e[8]=J*d-x*f,e[9]=ee*d-S*f,e[10]=ue*d-P*f,e[11]=ye*d-z*f,e},l.rotateZ=function(e,t,r){var f=Math.sin(r),d=Math.cos(r),x=t[0],S=t[1],P=t[2],z=t[3],J=t[4],ee=t[5],ue=t[6],ye=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=x*d+J*f,e[1]=S*d+ee*f,e[2]=P*d+ue*f,e[3]=z*d+ye*f,e[4]=J*d-x*f,e[5]=ee*d-S*f,e[6]=ue*d-P*f,e[7]=ye*d-z*f,e},l.scale=function(e,t,r){var f=r[0],d=r[1],x=r[2];return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e[4]=t[4]*d,e[5]=t[5]*d,e[6]=t[6]*d,e[7]=t[7]*d,e[8]=t[8]*x,e[9]=t[9]*x,e[10]=t[10]*x,e[11]=t[11]*x,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},l.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},l.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},l.setCacheLimits=function(e,t){Tr=e,mr=t},l.setRTLTextPlugin=function(e,t,r){if(void 0===r&&(r=!1),"deferred"===Ds||"loading"===Ds||"loaded"===Ds)throw new Error("setRTLTextPlugin cannot be called multiple times.");Hs=Ir.resolveURL(e),Ds="deferred",au=t,uc(),r||Ws()},l.sphericalToCartesian=function(e){var t=e[0],r=e[1],f=e[2];return r+=90,r*=Math.PI/180,f*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(f),y:t*Math.sin(r)*Math.sin(f),z:t*Math.cos(f)}},l.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},l.styleSpec=pe,l.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},l.symbolSize=Io,l.transformMat3=function(e,t,r){var f=t[0],d=t[1],x=t[2];return e[0]=f*r[0]+d*r[3]+x*r[6],e[1]=f*r[1]+d*r[4]+x*r[7],e[2]=f*r[2]+d*r[5]+x*r[8],e},l.transformMat4=uu,l.translate=function(e,t,r){var f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je=r[0],Ct=r[1],st=r[2];return t===e?(e[12]=t[0]*Je+t[4]*Ct+t[8]*st+t[12],e[13]=t[1]*Je+t[5]*Ct+t[9]*st+t[13],e[14]=t[2]*Je+t[6]*Ct+t[10]*st+t[14],e[15]=t[3]*Je+t[7]*Ct+t[11]*st+t[15]):(d=t[1],x=t[2],S=t[3],P=t[4],z=t[5],J=t[6],ee=t[7],ue=t[8],ye=t[9],Se=t[10],qe=t[11],e[0]=f=t[0],e[1]=d,e[2]=x,e[3]=S,e[4]=P,e[5]=z,e[6]=J,e[7]=ee,e[8]=ue,e[9]=ye,e[10]=Se,e[11]=qe,e[12]=f*Je+P*Ct+ue*st+t[12],e[13]=d*Je+z*Ct+ye*st+t[13],e[14]=x*Je+J*Ct+Se*st+t[14],e[15]=S*Je+ee*Ct+qe*st+t[15]),e},l.triggerPluginCompletionEvent=Tf,l.uniqueId=wt,l.validateCustomStyleLayer=function(e){var t=[],r=e.id;return void 0===r&&t.push({message:"layers."+r+': missing required property "id"'}),void 0===e.render&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},l.validateLight=Ta,l.validateStyle=Mc,l.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},l.vectorTile=gf,l.version="1.13.2",l.warnOnce=Xe,l.webpSupported=Le,l.window=j,l.wrap=Ye}),_(0,function(l){function m(re){var ve=typeof re;if("number"===ve||"boolean"===ve||"string"===ve||null==re)return JSON.stringify(re);if(Array.isArray(re)){for(var _e="[",G=0,oe=re;G<oe.length;G+=1)_e+=m(oe[G])+",";return _e+"]"}for(var xe=Object.keys(re).sort(),Oe="{",pe=0;pe<xe.length;pe++)Oe+=JSON.stringify(xe[pe])+":"+m(re[xe[pe]])+",";return Oe+"}"}function O(re){for(var ve="",_e=0,G=l.refProperties;_e<G.length;_e+=1)ve+="/"+m(re[G[_e]]);return ve}var R=function(re){this.keyCache={},re&&this.replace(re)};R.prototype.replace=function(re){this._layerConfigs={},this._layers={},this.update(re,[])},R.prototype.update=function(re,ve){for(var _e=this,G=0,oe=re;G<oe.length;G+=1){var xe=oe[G];this._layerConfigs[xe.id]=xe;var Oe=this._layers[xe.id]=l.createStyleLayer(xe);Oe._featureFilter=l.featureFilter(Oe.filter),this.keyCache[xe.id]&&delete this.keyCache[xe.id]}for(var pe=0,Ae=ve;pe<Ae.length;pe+=1){var Tt=Ae[pe];delete this.keyCache[Tt],delete this._layerConfigs[Tt],delete this._layers[Tt]}this.familiesBySource={};for(var wr=0,Kt=function(an,fn){for(var Di={},_n=0;_n<an.length;_n++){var Oi=fn&&fn[an[_n].id]||O(an[_n]);fn&&(fn[an[_n].id]=Oi);var ta=Di[Oi];ta||(ta=Di[Oi]=[]),ta.push(an[_n])}var oi=[];for(var Ji in Di)oi.push(Di[Ji]);return oi}(l.values(this._layerConfigs),this.keyCache);wr<Kt.length;wr+=1){var ar=Kt[wr].map(function(an){return _e._layers[an.id]}),Br=ar[0];if("none"!==Br.visibility){var Rn=Br.source||"",Pn=this.familiesBySource[Rn];Pn||(Pn=this.familiesBySource[Rn]={});var rr=Br.sourceLayer||"_geojsonTileLayer",Sn=Pn[rr];Sn||(Sn=Pn[rr]=[]),Sn.push(ar)}}};var N=function(re){var ve={},_e=[];for(var G in re){var oe=re[G],xe=ve[G]={};for(var Oe in oe){var pe=oe[+Oe];if(pe&&0!==pe.bitmap.width&&0!==pe.bitmap.height){var Ae={x:0,y:0,w:pe.bitmap.width+2,h:pe.bitmap.height+2};_e.push(Ae),xe[Oe]={rect:Ae,metrics:pe.metrics}}}}var Tt=l.potpack(_e),wr=new l.AlphaImage({width:Tt.w||1,height:Tt.h||1});for(var Kt in re){var ar=re[Kt];for(var Br in ar){var Rn=ar[+Br];if(Rn&&0!==Rn.bitmap.width&&0!==Rn.bitmap.height){var Pn=ve[Kt][Br].rect;l.AlphaImage.copy(Rn.bitmap,wr,{x:0,y:0},{x:Pn.x+1,y:Pn.y+1},Rn.bitmap)}}}this.image=wr,this.positions=ve};l.register("GlyphAtlas",N);var H=function(re){this.tileID=new l.OverscaledTileID(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.uid=re.uid,this.zoom=re.zoom,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=re.showCollisionBoxes,this.collectResourceTiming=!!re.collectResourceTiming,this.returnDependencies=!!re.returnDependencies,this.promoteId=re.promoteId};function j(re,ve,_e){for(var G=new l.EvaluationParameters(ve),oe=0,xe=re;oe<xe.length;oe+=1)xe[oe].recalculate(G,_e)}function be(re,ve){var _e=l.getArrayBuffer(re.request,function(G,oe,xe,Oe){G?ve(G):oe&&ve(null,{vectorTile:new l.vectorTile.VectorTile(new l.pbf(oe)),rawData:oe,cacheControl:xe,expires:Oe})});return function(){_e.cancel(),ve()}}H.prototype.parse=function(re,ve,_e,G,oe){var xe=this;this.status="parsing",this.data=re,this.collisionBoxArray=new l.CollisionBoxArray;var Oe=new l.DictionaryCoder(Object.keys(re.layers).sort()),pe=new l.FeatureIndex(this.tileID,this.promoteId);pe.bucketLayerIDs=[];var Ae,Tt,wr,Kt,ar={},Br={featureIndex:pe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:_e},Rn=ve.familiesBySource[this.source];for(var Pn in Rn){var rr=re.layers[Pn];if(rr){1===rr.version&&l.warnOnce('Vector tile source "'+this.source+'" layer "'+Pn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Sn=Oe.encode(Pn),an=[],fn=0;fn<rr.length;fn++){var Di=rr.feature(fn),_n=pe.getId(Di,Pn);an.push({feature:Di,id:_n,index:fn,sourceLayerIndex:Sn})}for(var Oi=0,ta=Rn[Pn];Oi<ta.length;Oi+=1){var oi=ta[Oi],Ji=oi[0];Ji.minzoom&&this.zoom<Math.floor(Ji.minzoom)||Ji.maxzoom&&this.zoom>=Ji.maxzoom||"none"!==Ji.visibility&&(j(oi,this.zoom,_e),(ar[Ji.id]=Ji.createBucket({index:pe.bucketLayerIDs.length,layers:oi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Sn,sourceID:this.source})).populate(an,Br,this.tileID.canonical),pe.bucketLayerIDs.push(oi.map(function(Gi){return Gi.id})))}}}var ji=l.mapObject(Br.glyphDependencies,function(Gi){return Object.keys(Gi).map(Number)});Object.keys(ji).length?G.send("getGlyphs",{uid:this.uid,stacks:ji},function(Gi,Ni){Ae||(Ae=Gi,Tt=Ni,Ia.call(xe))}):Tt={};var Ti=Object.keys(Br.iconDependencies);Ti.length?G.send("getImages",{icons:Ti,source:this.source,tileID:this.tileID,type:"icons"},function(Gi,Ni){Ae||(Ae=Gi,wr=Ni,Ia.call(xe))}):wr={};var _a=Object.keys(Br.patternDependencies);function Ia(){if(Ae)return oe(Ae);if(Tt&&wr&&Kt){var Gi=new N(Tt),Ni=new l.ImageAtlas(wr,Kt);for(var Xi in ar){var to=ar[Xi];to instanceof l.SymbolBucket?(j(to.layers,this.zoom,_e),l.performSymbolLayout(to,Tt,Gi.positions,wr,Ni.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):to.hasPattern&&(to instanceof l.LineBucket||to instanceof l.FillBucket||to instanceof l.FillExtrusionBucket)&&(j(to.layers,this.zoom,_e),to.addFeatures(Br,this.tileID.canonical,Ni.patternPositions))}this.status="done",oe(null,{buckets:l.values(ar).filter(function(Ho){return!Ho.isEmpty()}),featureIndex:pe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Gi.image,imageAtlas:Ni,glyphMap:this.returnDependencies?Tt:null,iconMap:this.returnDependencies?wr:null,glyphPositions:this.returnDependencies?Gi.positions:null})}}_a.length?G.send("getImages",{icons:_a,source:this.source,tileID:this.tileID,type:"patterns"},function(Gi,Ni){Ae||(Ae=Gi,Kt=Ni,Ia.call(xe))}):Kt={},Ia.call(this)};var Ne=function(re,ve,_e,G){this.actor=re,this.layerIndex=ve,this.availableImages=_e,this.loadVectorData=G||be,this.loading={},this.loaded={}};Ne.prototype.loadTile=function(re,ve){var _e=this,G=re.uid;this.loading||(this.loading={});var oe=!!(re&&re.request&&re.request.collectResourceTiming)&&new l.RequestPerformance(re.request),xe=this.loading[G]=new H(re);xe.abort=this.loadVectorData(re,function(Oe,pe){if(delete _e.loading[G],Oe||!pe)return xe.status="done",_e.loaded[G]=xe,ve(Oe);var Ae=pe.rawData,Tt={};pe.expires&&(Tt.expires=pe.expires),pe.cacheControl&&(Tt.cacheControl=pe.cacheControl);var wr={};if(oe){var Kt=oe.finish();Kt&&(wr.resourceTiming=JSON.parse(JSON.stringify(Kt)))}xe.vectorTile=pe.vectorTile,xe.parse(pe.vectorTile,_e.layerIndex,_e.availableImages,_e.actor,function(ar,Br){if(ar||!Br)return ve(ar);ve(null,l.extend({rawTileData:Ae.slice(0)},Br,Tt,wr))}),_e.loaded=_e.loaded||{},_e.loaded[G]=xe})},Ne.prototype.reloadTile=function(re,ve){var _e=this,G=this.loaded,oe=re.uid,xe=this;if(G&&G[oe]){var Oe=G[oe];Oe.showCollisionBoxes=re.showCollisionBoxes;var pe=function(Ae,Tt){var wr=Oe.reloadCallback;wr&&(delete Oe.reloadCallback,Oe.parse(Oe.vectorTile,xe.layerIndex,_e.availableImages,xe.actor,wr)),ve(Ae,Tt)};"parsing"===Oe.status?Oe.reloadCallback=pe:"done"===Oe.status&&(Oe.vectorTile?Oe.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor,pe):pe())}},Ne.prototype.abortTile=function(re,ve){var _e=this.loading,G=re.uid;_e&&_e[G]&&_e[G].abort&&(_e[G].abort(),delete _e[G]),ve()},Ne.prototype.removeTile=function(re,ve){var _e=this.loaded,G=re.uid;_e&&_e[G]&&delete _e[G],ve()};var V=l.window.ImageBitmap,W=function(){this.loaded={}};function Ye(re,ve){if(0!==re.length){_t(re[0],ve);for(var _e=1;_e<re.length;_e++)_t(re[_e],!ve)}}function _t(re,ve){for(var _e=0,G=0,oe=re.length,xe=oe-1;G<oe;xe=G++)_e+=(re[G][0]-re[xe][0])*(re[xe][1]+re[G][1]);_e>=0!=!!ve&&re.reverse()}W.prototype.loadTile=function(re,ve){var _e=re.uid,G=re.encoding,oe=re.rawImageData,xe=V&&oe instanceof V?this.getImageData(oe):oe,Oe=new l.DEMData(_e,xe,G);this.loaded=this.loaded||{},this.loaded[_e]=Oe,ve(null,Oe)},W.prototype.getImageData=function(re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(re.width,re.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=re.width,this.offscreenCanvas.height=re.height,this.offscreenCanvasContext.drawImage(re,0,0,re.width,re.height);var ve=this.offscreenCanvasContext.getImageData(-1,-1,re.width+2,re.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:ve.width,height:ve.height},ve.data)},W.prototype.removeTile=function(re){var ve=this.loaded,_e=re.uid;ve&&ve[_e]&&delete ve[_e]};var Rt=l.vectorTile.VectorTileFeature.prototype.toGeoJSON,wt=function(re){this._feature=re,this.extent=l.EXTENT,this.type=re.type,this.properties=re.tags,"id"in re&&!isNaN(re.id)&&(this.id=parseInt(re.id,10))};wt.prototype.loadGeometry=function(){if(1===this._feature.type){for(var re=[],ve=0,_e=this._feature.geometry;ve<_e.length;ve+=1){var G=_e[ve];re.push([new l.Point$1(G[0],G[1])])}return re}for(var oe=[],xe=0,Oe=this._feature.geometry;xe<Oe.length;xe+=1){for(var pe=[],Ae=0,Tt=Oe[xe];Ae<Tt.length;Ae+=1){var wr=Tt[Ae];pe.push(new l.Point$1(wr[0],wr[1]))}oe.push(pe)}return oe},wt.prototype.toGeoJSON=function(re,ve,_e){return Rt.call(this,re,ve,_e)};var lt=function(re){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=re.length,this._features=re};lt.prototype.feature=function(re){return new wt(this._features[re])};var tt=l.vectorTile.VectorTileFeature,Gt=Q;function Q(re,ve){this.options=ve||{},this.features=re,this.length=re.length}function Ut(re,ve){this.id="number"==typeof re.id?re.id:void 0,this.type=re.type,this.rawGeometry=1===re.type?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=ve||4096}Q.prototype.feature=function(re){return new Ut(this.features[re],this.options.extent)},Ut.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var ve=0;ve<re.length;ve++){for(var _e=re[ve],G=[],oe=0;oe<_e.length;oe++)G.push(new l.Point$1(_e[oe][0],_e[oe][1]));this.geometry.push(G)}return this.geometry},Ut.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,ve=1/0,_e=-1/0,G=1/0,oe=-1/0,xe=0;xe<re.length;xe++)for(var Oe=re[xe],pe=0;pe<Oe.length;pe++){var Ae=Oe[pe];ve=Math.min(ve,Ae.x),_e=Math.max(_e,Ae.x),G=Math.min(G,Ae.y),oe=Math.max(oe,Ae.y)}return[ve,G,_e,oe]},Ut.prototype.toGeoJSON=tt.prototype.toGeoJSON;var ot=ct,Ue=Gt;function ct(re){var ve=new l.pbf;return function(_e,G){for(var oe in _e.layers)G.writeMessage(3,Xe,_e.layers[oe])}(re,ve),ve.finish()}function Xe(re,ve){var _e;ve.writeVarintField(15,re.version||1),ve.writeStringField(1,re.name||""),ve.writeVarintField(5,re.extent||4096);var G={keys:[],values:[],keycache:{},valuecache:{}};for(_e=0;_e<re.length;_e++)G.feature=re.feature(_e),ve.writeMessage(2,Pt,G);var oe=G.keys;for(_e=0;_e<oe.length;_e++)ve.writeStringField(3,oe[_e]);var xe=G.values;for(_e=0;_e<xe.length;_e++)ve.writeMessage(4,ce,xe[_e])}function Pt(re,ve){var _e=re.feature;void 0!==_e.id&&ve.writeVarintField(1,_e.id),ve.writeMessage(2,kt,re),ve.writeVarintField(3,_e.type),ve.writeMessage(4,le,_e)}function kt(re,ve){var _e=re.feature,G=re.keys,oe=re.values,xe=re.keycache,Oe=re.valuecache;for(var pe in _e.properties){var Ae=xe[pe];void 0===Ae&&(G.push(pe),xe[pe]=Ae=G.length-1),ve.writeVarint(Ae);var Tt=_e.properties[pe],wr=typeof Tt;"string"!==wr&&"boolean"!==wr&&"number"!==wr&&(Tt=JSON.stringify(Tt));var Kt=wr+":"+Tt,ar=Oe[Kt];void 0===ar&&(oe.push(Tt),Oe[Kt]=ar=oe.length-1),ve.writeVarint(ar)}}function ut(re,ve){return(ve<<3)+(7&re)}function ir(re){return re<<1^re>>31}function le(re,ve){for(var _e=re.loadGeometry(),G=re.type,oe=0,xe=0,Oe=_e.length,pe=0;pe<Oe;pe++){var Ae=_e[pe],Tt=1;1===G&&(Tt=Ae.length),ve.writeVarint(ut(1,Tt));for(var wr=3===G?Ae.length-1:Ae.length,Kt=0;Kt<wr;Kt++){1===Kt&&1!==G&&ve.writeVarint(ut(2,wr-1));var ar=Ae[Kt].x-oe,Br=Ae[Kt].y-xe;ve.writeVarint(ir(ar)),ve.writeVarint(ir(Br)),oe+=ar,xe+=Br}3===G&&ve.writeVarint(ut(7,1))}}function ce(re,ve){var _e=typeof re;"string"===_e?ve.writeStringField(1,re):"boolean"===_e?ve.writeBooleanField(7,re):"number"===_e&&(re%1!=0?ve.writeDoubleField(3,re):re<0?ve.writeSVarintField(6,re):ve.writeVarintField(5,re))}function ae(re,ve,_e,G){me(re,_e,G),me(ve,2*_e,2*G),me(ve,2*_e+1,2*G+1)}function me(re,ve,_e){var G=re[ve];re[ve]=re[_e],re[_e]=G}function Ie(re,ve,_e,G){var oe=re-_e,xe=ve-G;return oe*oe+xe*xe}ot.fromVectorTileJs=ct,ot.fromGeojsonVt=function(re,ve){ve=ve||{};var _e={};for(var G in re)_e[G]=new Gt(re[G].features,ve),_e[G].name=G,_e[G].version=ve.version,_e[G].extent=ve.extent;return ct({layers:_e})},ot.GeoJSONWrapper=Ue;var je=function(re){return re[0]},gt=function(re){return re[1]},xr=function(re,ve,_e,G,oe){void 0===ve&&(ve=je),void 0===_e&&(_e=gt),void 0===G&&(G=64),void 0===oe&&(oe=Float64Array),this.nodeSize=G,this.points=re;for(var xe=re.length<65536?Uint16Array:Uint32Array,Oe=this.ids=new xe(re.length),pe=this.coords=new oe(2*re.length),Ae=0;Ae<re.length;Ae++)Oe[Ae]=Ae,pe[2*Ae]=ve(re[Ae]),pe[2*Ae+1]=_e(re[Ae]);!function Tt(wr,Kt,ar,Br,Rn,Pn){if(!(Rn-Br<=ar)){var rr=Br+Rn>>1;(function Sn(an,fn,Di,_n,Oi,ta){for(;Oi>_n;){if(Oi-_n>600){var oi=Oi-_n+1,Ji=Di-_n+1,ji=Math.log(oi),Ti=.5*Math.exp(2*ji/3),_a=.5*Math.sqrt(ji*Ti*(oi-Ti)/oi)*(Ji-oi/2<0?-1:1);Sn(an,fn,Di,Math.max(_n,Math.floor(Di-Ji*Ti/oi+_a)),Math.min(Oi,Math.floor(Di+(oi-Ji)*Ti/oi+_a)),ta)}var Ia=fn[2*Di+ta],Gi=_n,Ni=Oi;for(ae(an,fn,_n,Di),fn[2*Oi+ta]>Ia&&ae(an,fn,_n,Oi);Gi<Ni;){for(ae(an,fn,Gi,Ni),Gi++,Ni--;fn[2*Gi+ta]<Ia;)Gi++;for(;fn[2*Ni+ta]>Ia;)Ni--}fn[2*_n+ta]===Ia?ae(an,fn,_n,Ni):ae(an,fn,++Ni,Oi),Ni<=Di&&(_n=Ni+1),Di<=Ni&&(Oi=Ni-1)}})(wr,Kt,rr,Br,Rn,Pn%2),Tt(wr,Kt,ar,Br,rr-1,Pn+1),Tt(wr,Kt,ar,rr+1,Rn,Pn+1)}}(Oe,pe,G,0,Oe.length-1,0)};xr.prototype.range=function(re,ve,_e,G){return function(oe,xe,Oe,pe,Ae,Tt,wr){for(var Kt,ar,Br=[0,oe.length-1,0],Rn=[];Br.length;){var Pn=Br.pop(),rr=Br.pop(),Sn=Br.pop();if(rr-Sn<=wr)for(var an=Sn;an<=rr;an++)ar=xe[2*an+1],(Kt=xe[2*an])>=Oe&&Kt<=Ae&&ar>=pe&&ar<=Tt&&Rn.push(oe[an]);else{var fn=Math.floor((Sn+rr)/2);ar=xe[2*fn+1],(Kt=xe[2*fn])>=Oe&&Kt<=Ae&&ar>=pe&&ar<=Tt&&Rn.push(oe[fn]);var Di=(Pn+1)%2;(0===Pn?Oe<=Kt:pe<=ar)&&(Br.push(Sn),Br.push(fn-1),Br.push(Di)),(0===Pn?Ae>=Kt:Tt>=ar)&&(Br.push(fn+1),Br.push(rr),Br.push(Di))}}return Rn}(this.ids,this.coords,re,ve,_e,G,this.nodeSize)},xr.prototype.within=function(re,ve,_e){return function(G,oe,xe,Oe,pe,Ae){for(var Tt=[0,G.length-1,0],wr=[],Kt=pe*pe;Tt.length;){var ar=Tt.pop(),Br=Tt.pop(),Rn=Tt.pop();if(Br-Rn<=Ae)for(var Pn=Rn;Pn<=Br;Pn++)Ie(oe[2*Pn],oe[2*Pn+1],xe,Oe)<=Kt&&wr.push(G[Pn]);else{var rr=Math.floor((Rn+Br)/2),Sn=oe[2*rr],an=oe[2*rr+1];Ie(Sn,an,xe,Oe)<=Kt&&wr.push(G[rr]);var fn=(ar+1)%2;(0===ar?xe-pe<=Sn:Oe-pe<=an)&&(Tt.push(Rn),Tt.push(rr-1),Tt.push(fn)),(0===ar?xe+pe>=Sn:Oe+pe>=an)&&(Tt.push(rr+1),Tt.push(Br),Tt.push(fn))}}return wr}(this.ids,this.coords,re,ve,_e,this.nodeSize)};var Fr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(re){return re}},cn=function(re){this.options=qt(Object.create(Fr),re),this.trees=new Array(this.options.maxZoom+1)};function Ir(re,ve,_e,G,oe){return{x:re,y:ve,zoom:1/0,id:_e,parentId:-1,numPoints:G,properties:oe}}function Ot(re,ve){var _e=re.geometry.coordinates,G=_e[1];return{x:at(_e[0]),y:Re(G),zoom:1/0,index:ve,parentId:-1}}function Le(re){return{type:"Feature",id:re.id,properties:we(re),geometry:{type:"Point",coordinates:[(G=re.x,360*(G-.5)),(ve=re.y,_e=(180-360*ve)*Math.PI/180,360*Math.atan(Math.exp(_e))/Math.PI-90)]}};var ve,_e,G}function we(re){var ve=re.numPoints,_e=ve>=1e4?Math.round(ve/1e3)+"k":ve>=1e3?Math.round(ve/100)/10+"k":ve;return qt(qt({},re.properties),{cluster:!0,cluster_id:re.id,point_count:ve,point_count_abbreviated:_e})}function at(re){return re/360+.5}function Re(re){var ve=Math.sin(re*Math.PI/180),_e=.5-.25*Math.log((1+ve)/(1-ve))/Math.PI;return _e<0?0:_e>1?1:_e}function qt(re,ve){for(var _e in ve)re[_e]=ve[_e];return re}function Pr(re){return re.x}function er(re){return re.y}function hr(re,ve,_e,G,oe,xe){var Oe=oe-_e,pe=xe-G;if(0!==Oe||0!==pe){var Ae=((re-_e)*Oe+(ve-G)*pe)/(Oe*Oe+pe*pe);Ae>1?(_e=oe,G=xe):Ae>0&&(_e+=Oe*Ae,G+=pe*Ae)}return(Oe=re-_e)*Oe+(pe=ve-G)*pe}function Nr(re,ve,_e,G){var oe={id:void 0===re?null:re,type:ve,geometry:_e,tags:G,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(xe){var Oe=xe.geometry,pe=xe.type;if("Point"===pe||"MultiPoint"===pe||"LineString"===pe)$r(xe,Oe);else if("Polygon"===pe||"MultiLineString"===pe)for(var Ae=0;Ae<Oe.length;Ae++)$r(xe,Oe[Ae]);else if("MultiPolygon"===pe)for(Ae=0;Ae<Oe.length;Ae++)for(var Tt=0;Tt<Oe[Ae].length;Tt++)$r(xe,Oe[Ae][Tt])}(oe),oe}function $r(re,ve){for(var _e=0;_e<ve.length;_e+=3)re.minX=Math.min(re.minX,ve[_e]),re.minY=Math.min(re.minY,ve[_e+1]),re.maxX=Math.max(re.maxX,ve[_e]),re.maxY=Math.max(re.maxY,ve[_e+1])}function C(re,ve,_e,G){if(ve.geometry){var oe=ve.geometry.coordinates,xe=ve.geometry.type,Oe=Math.pow(_e.tolerance/((1<<_e.maxZoom)*_e.extent),2),pe=[],Ae=ve.id;if(_e.promoteId?Ae=ve.properties[_e.promoteId]:_e.generateId&&(Ae=G||0),"Point"===xe)Y(oe,pe);else if("MultiPoint"===xe)for(var Tt=0;Tt<oe.length;Tt++)Y(oe[Tt],pe);else if("LineString"===xe)Ge(oe,pe,Oe,!1);else if("MultiLineString"===xe){if(_e.lineMetrics){for(Tt=0;Tt<oe.length;Tt++)Ge(oe[Tt],pe=[],Oe,!1),re.push(Nr(Ae,"LineString",pe,ve.properties));return}nt(oe,pe,Oe,!1)}else if("Polygon"===xe)nt(oe,pe,Oe,!0);else{if("MultiPolygon"!==xe){if("GeometryCollection"===xe){for(Tt=0;Tt<ve.geometry.geometries.length;Tt++)C(re,{id:Ae,geometry:ve.geometry.geometries[Tt],properties:ve.properties},_e,G);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Tt=0;Tt<oe.length;Tt++){var wr=[];nt(oe[Tt],wr,Oe,!0),pe.push(wr)}}re.push(Nr(Ae,xe,pe,ve.properties))}}function Y(re,ve){ve.push(xt(re[0])),ve.push(Dt(re[1])),ve.push(0)}function Ge(re,ve,_e,G){for(var oe,xe,Oe=0,pe=0;pe<re.length;pe++){var Ae=xt(re[pe][0]),Tt=Dt(re[pe][1]);ve.push(Ae),ve.push(Tt),ve.push(0),pe>0&&(Oe+=G?(oe*Tt-Ae*xe)/2:Math.sqrt(Math.pow(Ae-oe,2)+Math.pow(Tt-xe,2))),oe=Ae,xe=Tt}var wr=ve.length-3;ve[2]=1,function Kt(ar,Br,Rn,Pn){for(var rr,Sn=Pn,an=Rn-Br>>1,fn=Rn-Br,Di=ar[Br],_n=ar[Br+1],Oi=ar[Rn],ta=ar[Rn+1],oi=Br+3;oi<Rn;oi+=3){var Ji=hr(ar[oi],ar[oi+1],Di,_n,Oi,ta);if(Ji>Sn)rr=oi,Sn=Ji;else if(Ji===Sn){var ji=Math.abs(oi-an);ji<fn&&(rr=oi,fn=ji)}}Sn>Pn&&(rr-Br>3&&Kt(ar,Br,rr,Pn),ar[rr+2]=Sn,Rn-rr>3&&Kt(ar,rr,Rn,Pn))}(ve,0,wr,_e),ve[wr+2]=1,ve.size=Math.abs(Oe),ve.start=0,ve.end=ve.size}function nt(re,ve,_e,G){for(var oe=0;oe<re.length;oe++){var xe=[];Ge(re[oe],xe,_e,G),ve.push(xe)}}function xt(re){return re/360+.5}function Dt(re){var ve=Math.sin(re*Math.PI/180),_e=.5-.25*Math.log((1+ve)/(1-ve))/Math.PI;return _e<0?0:_e>1?1:_e}function Z(re,ve,_e,G,oe,xe,Oe,pe){if(G/=ve,xe>=(_e/=ve)&&Oe<G)return re;if(Oe<_e||xe>=G)return null;for(var Ae=[],Tt=0;Tt<re.length;Tt++){var wr=re[Tt],Kt=wr.geometry,ar=wr.type,Br=0===oe?wr.minX:wr.minY,Rn=0===oe?wr.maxX:wr.maxY;if(Br>=_e&&Rn<G)Ae.push(wr);else if(!(Rn<_e||Br>=G)){var Pn=[];if("Point"===ar||"MultiPoint"===ar)Ze(Kt,Pn,_e,G,oe);else if("LineString"===ar)Et(Kt,Pn,_e,G,oe,!1,pe.lineMetrics);else if("MultiLineString"===ar)Jt(Kt,Pn,_e,G,oe,!1);else if("Polygon"===ar)Jt(Kt,Pn,_e,G,oe,!0);else if("MultiPolygon"===ar)for(var rr=0;rr<Kt.length;rr++){var Sn=[];Jt(Kt[rr],Sn,_e,G,oe,!0),Sn.length&&Pn.push(Sn)}if(Pn.length){if(pe.lineMetrics&&"LineString"===ar){for(rr=0;rr<Pn.length;rr++)Ae.push(Nr(wr.id,ar,Pn[rr],wr.tags));continue}"LineString"!==ar&&"MultiLineString"!==ar||(1===Pn.length?(ar="LineString",Pn=Pn[0]):ar="MultiLineString"),"Point"!==ar&&"MultiPoint"!==ar||(ar=3===Pn.length?"Point":"MultiPoint"),Ae.push(Nr(wr.id,ar,Pn,wr.tags))}}}return Ae.length?Ae:null}function Ze(re,ve,_e,G,oe){for(var xe=0;xe<re.length;xe+=3){var Oe=re[xe+oe];Oe>=_e&&Oe<=G&&(ve.push(re[xe]),ve.push(re[xe+1]),ve.push(re[xe+2]))}}function Et(re,ve,_e,G,oe,xe,Oe){for(var pe,Ae,Tt=Mt(re),wr=0===oe?mr:Yt,Kt=re.start,ar=0;ar<re.length-3;ar+=3){var Br=re[ar],Rn=re[ar+1],Pn=re[ar+2],rr=re[ar+3],Sn=re[ar+4],an=0===oe?Br:Rn,fn=0===oe?rr:Sn,Di=!1;Oe&&(pe=Math.sqrt(Math.pow(Br-rr,2)+Math.pow(Rn-Sn,2))),an<_e?fn>_e&&(Ae=wr(Tt,Br,Rn,rr,Sn,_e),Oe&&(Tt.start=Kt+pe*Ae)):an>G?fn<G&&(Ae=wr(Tt,Br,Rn,rr,Sn,G),Oe&&(Tt.start=Kt+pe*Ae)):Tr(Tt,Br,Rn,Pn),fn<_e&&an>=_e&&(Ae=wr(Tt,Br,Rn,rr,Sn,_e),Di=!0),fn>G&&an<=G&&(Ae=wr(Tt,Br,Rn,rr,Sn,G),Di=!0),!xe&&Di&&(Oe&&(Tt.end=Kt+pe*Ae),ve.push(Tt),Tt=Mt(re)),Oe&&(Kt+=pe)}var _n=re.length-3;Br=re[_n],Rn=re[_n+1],Pn=re[_n+2],(an=0===oe?Br:Rn)>=_e&&an<=G&&Tr(Tt,Br,Rn,Pn),_n=Tt.length-3,xe&&_n>=3&&(Tt[_n]!==Tt[0]||Tt[_n+1]!==Tt[1])&&Tr(Tt,Tt[0],Tt[1],Tt[2]),Tt.length&&ve.push(Tt)}function Mt(re){var ve=[];return ve.size=re.size,ve.start=re.start,ve.end=re.end,ve}function Jt(re,ve,_e,G,oe,xe){for(var Oe=0;Oe<re.length;Oe++)Et(re[Oe],ve,_e,G,oe,xe,!1)}function Tr(re,ve,_e,G){re.push(ve),re.push(_e),re.push(G)}function mr(re,ve,_e,G,oe,xe){var Oe=(xe-ve)/(G-ve);return re.push(xe),re.push(_e+(oe-_e)*Oe),re.push(1),Oe}function Yt(re,ve,_e,G,oe,xe){var Oe=(xe-_e)/(oe-_e);return re.push(ve+(G-ve)*Oe),re.push(xe),re.push(1),Oe}function gr(re,ve){for(var _e=[],G=0;G<re.length;G++){var oe,xe=re[G],Oe=xe.type;if("Point"===Oe||"MultiPoint"===Oe||"LineString"===Oe)oe=sr(xe.geometry,ve);else if("MultiLineString"===Oe||"Polygon"===Oe){oe=[];for(var pe=0;pe<xe.geometry.length;pe++)oe.push(sr(xe.geometry[pe],ve))}else if("MultiPolygon"===Oe)for(oe=[],pe=0;pe<xe.geometry.length;pe++){for(var Ae=[],Tt=0;Tt<xe.geometry[pe].length;Tt++)Ae.push(sr(xe.geometry[pe][Tt],ve));oe.push(Ae)}_e.push(Nr(xe.id,Oe,oe,xe.tags))}return _e}function sr(re,ve){var _e=[];_e.size=re.size,void 0!==re.start&&(_e.start=re.start,_e.end=re.end);for(var G=0;G<re.length;G+=3)_e.push(re[G]+ve,re[G+1],re[G+2]);return _e}function dr(re,ve){if(re.transformed)return re;var _e,G,oe,xe=1<<re.z,Oe=re.x,pe=re.y;for(_e=0;_e<re.features.length;_e++){var Ae=re.features[_e],Tt=Ae.geometry,wr=Ae.type;if(Ae.geometry=[],1===wr)for(G=0;G<Tt.length;G+=2)Ae.geometry.push(mn(Tt[G],Tt[G+1],ve,xe,Oe,pe));else for(G=0;G<Tt.length;G++){var Kt=[];for(oe=0;oe<Tt[G].length;oe+=2)Kt.push(mn(Tt[G][oe],Tt[G][oe+1],ve,xe,Oe,pe));Ae.geometry.push(Kt)}}return re.transformed=!0,re}function mn(re,ve,_e,G,oe,xe){return[Math.round(_e*(re*G-oe)),Math.round(_e*(ve*G-xe))]}function On(re,ve,_e,G,oe){for(var xe=ve===oe.maxZoom?0:oe.tolerance/((1<<ve)*oe.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:_e,y:G,z:ve,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},pe=0;pe<re.length;pe++){Oe.numFeatures++,mi(Oe,re[pe],xe,oe);var Ae=re[pe].minX,Tt=re[pe].minY,wr=re[pe].maxX,Kt=re[pe].maxY;Ae<Oe.minX&&(Oe.minX=Ae),Tt<Oe.minY&&(Oe.minY=Tt),wr>Oe.maxX&&(Oe.maxX=wr),Kt>Oe.maxY&&(Oe.maxY=Kt)}return Oe}function mi(re,ve,_e,G){var oe=ve.geometry,xe=ve.type,Oe=[];if("Point"===xe||"MultiPoint"===xe)for(var pe=0;pe<oe.length;pe+=3)Oe.push(oe[pe]),Oe.push(oe[pe+1]),re.numPoints++,re.numSimplified++;else if("LineString"===xe)hi(Oe,oe,re,_e,!1,!1);else if("MultiLineString"===xe||"Polygon"===xe)for(pe=0;pe<oe.length;pe++)hi(Oe,oe[pe],re,_e,"Polygon"===xe,0===pe);else if("MultiPolygon"===xe)for(var Ae=0;Ae<oe.length;Ae++){var Tt=oe[Ae];for(pe=0;pe<Tt.length;pe++)hi(Oe,Tt[pe],re,_e,!0,0===pe)}if(Oe.length){var wr=ve.tags||null;if("LineString"===xe&&G.lineMetrics){for(var Kt in wr={},ve.tags)wr[Kt]=ve.tags[Kt];wr.mapbox_clip_start=oe.start/oe.size,wr.mapbox_clip_end=oe.end/oe.size}var ar={geometry:Oe,type:"Polygon"===xe||"MultiPolygon"===xe?3:"LineString"===xe||"MultiLineString"===xe?2:1,tags:wr};null!==ve.id&&(ar.id=ve.id),re.features.push(ar)}}function hi(re,ve,_e,G,oe,xe){var Oe=G*G;if(G>0&&ve.size<(oe?Oe:G))_e.numPoints+=ve.length/3;else{for(var pe=[],Ae=0;Ae<ve.length;Ae+=3)(0===G||ve[Ae+2]>Oe)&&(_e.numSimplified++,pe.push(ve[Ae]),pe.push(ve[Ae+1])),_e.numPoints++;oe&&function(Tt,wr){for(var Kt=0,ar=0,Br=Tt.length,Rn=Br-2;ar<Br;Rn=ar,ar+=2)Kt+=(Tt[ar]-Tt[Rn])*(Tt[ar+1]+Tt[Rn+1]);if(Kt>0===wr)for(ar=0,Br=Tt.length;ar<Br/2;ar+=2){var Pn=Tt[ar],rr=Tt[ar+1];Tt[ar]=Tt[Br-2-ar],Tt[ar+1]=Tt[Br-1-ar],Tt[Br-2-ar]=Pn,Tt[Br-1-ar]=rr}}(pe,xe),re.push(pe)}}function si(re,ve){var _e=(ve=this.options=function(oe,xe){for(var Oe in xe)oe[Oe]=xe[Oe];return oe}(Object.create(this.options),ve)).debug;if(_e&&console.time("preprocess data"),ve.maxZoom<0||ve.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ve.promoteId&&ve.generateId)throw new Error("promoteId and generateId cannot be used together.");var oe,xe,Oe,pe,Ae,Tt,G=function(oe,xe){var Oe=[];if("FeatureCollection"===oe.type)for(var pe=0;pe<oe.features.length;pe++)C(Oe,oe.features[pe],xe,pe);else C(Oe,"Feature"===oe.type?oe:{geometry:oe},xe);return Oe}(re,ve);this.tiles={},this.tileCoords=[],_e&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ve.indexMaxZoom,ve.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(oe=G,xe=ve,Oe=xe.buffer/xe.extent,pe=oe,Ae=Z(oe,1,-1-Oe,Oe,0,-1,2,xe),Tt=Z(oe,1,1-Oe,2+Oe,0,-1,2,xe),(Ae||Tt)&&(pe=Z(oe,1,-Oe,1+Oe,0,-1,2,xe)||[],Ae&&(pe=gr(Ae,1).concat(pe)),Tt&&(pe=pe.concat(gr(Tt,-1)))),G=pe).length&&this.splitTile(G,0,0,0),_e&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ai(re,ve,_e){return 32*((1<<re)*_e+ve)+re}function Yi(re,ve){var _e=re.tileID.canonical;if(!this._geoJSONIndex)return ve(null,null);var G=this._geoJSONIndex.getTile(_e.z,_e.x,_e.y);if(!G)return ve(null,null);var oe=new lt(G.features),xe=ot(oe);0===xe.byteOffset&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),ve(null,{vectorTile:oe,rawData:xe.buffer})}cn.prototype.load=function(re){var ve=this.options,_e=ve.log,G=ve.minZoom,oe=ve.maxZoom,xe=ve.nodeSize;_e&&console.time("total time");var Oe="prepare "+re.length+" points";_e&&console.time(Oe),this.points=re;for(var pe=[],Ae=0;Ae<re.length;Ae++)re[Ae].geometry&&pe.push(Ot(re[Ae],Ae));this.trees[oe+1]=new xr(pe,Pr,er,xe,Float32Array),_e&&console.timeEnd(Oe);for(var Tt=oe;Tt>=G;Tt--){var wr=+Date.now();pe=this._cluster(pe,Tt),this.trees[Tt]=new xr(pe,Pr,er,xe,Float32Array),_e&&console.log("z%d: %d clusters in %dms",Tt,pe.length,+Date.now()-wr)}return _e&&console.timeEnd("total time"),this},cn.prototype.getClusters=function(re,ve){var _e=((re[0]+180)%360+360)%360-180,G=Math.max(-90,Math.min(90,re[1])),oe=180===re[2]?180:((re[2]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,re[3]));if(re[2]-re[0]>=360)_e=-180,oe=180;else if(_e>oe){var Oe=this.getClusters([_e,G,180,xe],ve),pe=this.getClusters([-180,G,oe,xe],ve);return Oe.concat(pe)}for(var Ae=this.trees[this._limitZoom(ve)],Tt=[],wr=0,Kt=Ae.range(at(_e),Re(xe),at(oe),Re(G));wr<Kt.length;wr+=1){var ar=Ae.points[Kt[wr]];Tt.push(ar.numPoints?Le(ar):this.points[ar.index])}return Tt},cn.prototype.getChildren=function(re){var ve=this._getOriginId(re),_e=this._getOriginZoom(re),G="No cluster with the specified id.",oe=this.trees[_e];if(!oe)throw new Error(G);var xe=oe.points[ve];if(!xe)throw new Error(G);for(var Oe=this.options.radius/(this.options.extent*Math.pow(2,_e-1)),pe=[],Ae=0,Tt=oe.within(xe.x,xe.y,Oe);Ae<Tt.length;Ae+=1){var wr=oe.points[Tt[Ae]];wr.parentId===re&&pe.push(wr.numPoints?Le(wr):this.points[wr.index])}if(0===pe.length)throw new Error(G);return pe},cn.prototype.getLeaves=function(re,ve,_e){var G=[];return this._appendLeaves(G,re,ve=ve||10,_e=_e||0,0),G},cn.prototype.getTile=function(re,ve,_e){var G=this.trees[this._limitZoom(re)],oe=Math.pow(2,re),xe=this.options,Oe=xe.radius/xe.extent,pe=(_e-Oe)/oe,Ae=(_e+1+Oe)/oe,Tt={features:[]};return this._addTileFeatures(G.range((ve-Oe)/oe,pe,(ve+1+Oe)/oe,Ae),G.points,ve,_e,oe,Tt),0===ve&&this._addTileFeatures(G.range(1-Oe/oe,pe,1,Ae),G.points,oe,_e,oe,Tt),ve===oe-1&&this._addTileFeatures(G.range(0,pe,Oe/oe,Ae),G.points,-1,_e,oe,Tt),Tt.features.length?Tt:null},cn.prototype.getClusterExpansionZoom=function(re){for(var ve=this._getOriginZoom(re)-1;ve<=this.options.maxZoom;){var _e=this.getChildren(re);if(ve++,1!==_e.length)break;re=_e[0].properties.cluster_id}return ve},cn.prototype._appendLeaves=function(re,ve,_e,G,oe){for(var xe=0,Oe=this.getChildren(ve);xe<Oe.length;xe+=1){var pe=Oe[xe],Ae=pe.properties;if(Ae&&Ae.cluster?oe+Ae.point_count<=G?oe+=Ae.point_count:oe=this._appendLeaves(re,Ae.cluster_id,_e,G,oe):oe<G?oe++:re.push(pe),re.length===_e)break}return oe},cn.prototype._addTileFeatures=function(re,ve,_e,G,oe,xe){for(var Oe=0,pe=re;Oe<pe.length;Oe+=1){var Ae=ve[pe[Oe]],Tt=Ae.numPoints,wr={type:1,geometry:[[Math.round(this.options.extent*(Ae.x*oe-_e)),Math.round(this.options.extent*(Ae.y*oe-G))]],tags:Tt?we(Ae):this.points[Ae.index].properties},Kt=void 0;Tt?Kt=Ae.id:this.options.generateId?Kt=Ae.index:this.points[Ae.index].id&&(Kt=this.points[Ae.index].id),void 0!==Kt&&(wr.id=Kt),xe.features.push(wr)}},cn.prototype._limitZoom=function(re){return Math.max(this.options.minZoom,Math.min(+re,this.options.maxZoom+1))},cn.prototype._cluster=function(re,ve){for(var _e=[],G=this.options,oe=G.reduce,xe=G.minPoints,Oe=G.radius/(G.extent*Math.pow(2,ve)),pe=0;pe<re.length;pe++){var Ae=re[pe];if(!(Ae.zoom<=ve)){Ae.zoom=ve;for(var Tt=this.trees[ve+1],wr=Tt.within(Ae.x,Ae.y,Oe),Kt=Ae.numPoints||1,ar=Kt,Br=0,Rn=wr;Br<Rn.length;Br+=1){var Pn=Tt.points[Rn[Br]];Pn.zoom>ve&&(ar+=Pn.numPoints||1)}if(ar>=xe){for(var rr=Ae.x*Kt,Sn=Ae.y*Kt,an=oe&&Kt>1?this._map(Ae,!0):null,fn=(pe<<5)+(ve+1)+this.points.length,Di=0,_n=wr;Di<_n.length;Di+=1){var Oi=Tt.points[_n[Di]];if(!(Oi.zoom<=ve)){Oi.zoom=ve;var ta=Oi.numPoints||1;rr+=Oi.x*ta,Sn+=Oi.y*ta,Oi.parentId=fn,oe&&(an||(an=this._map(Ae,!0)),oe(an,this._map(Oi)))}}Ae.parentId=fn,_e.push(Ir(rr/ar,Sn/ar,fn,ar,an))}else if(_e.push(Ae),ar>1)for(var oi=0,Ji=wr;oi<Ji.length;oi+=1){var ji=Tt.points[Ji[oi]];ji.zoom<=ve||(ji.zoom=ve,_e.push(ji))}}}return _e},cn.prototype._getOriginId=function(re){return re-this.points.length>>5},cn.prototype._getOriginZoom=function(re){return(re-this.points.length)%32},cn.prototype._map=function(re,ve){if(re.numPoints)return ve?qt({},re.properties):re.properties;var _e=this.points[re.index].properties,G=this.options.map(_e);return ve&&G===_e?qt({},G):G},si.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},si.prototype.splitTile=function(re,ve,_e,G,oe,xe,Oe){for(var pe=[re,ve,_e,G],Ae=this.options,Tt=Ae.debug;pe.length;){G=pe.pop(),_e=pe.pop(),ve=pe.pop(),re=pe.pop();var wr=1<<ve,Kt=ai(ve,_e,G),ar=this.tiles[Kt];if(!ar&&(Tt>1&&console.time("creation"),ar=this.tiles[Kt]=On(re,ve,_e,G,Ae),this.tileCoords.push({z:ve,x:_e,y:G}),Tt)){Tt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ve,_e,G,ar.numFeatures,ar.numPoints,ar.numSimplified),console.timeEnd("creation"));var Br="z"+ve;this.stats[Br]=(this.stats[Br]||0)+1,this.total++}if(ar.source=re,oe){if(ve===Ae.maxZoom||ve===oe)continue;var Rn=1<<oe-ve;if(_e!==Math.floor(xe/Rn)||G!==Math.floor(Oe/Rn))continue}else if(ve===Ae.indexMaxZoom||ar.numPoints<=Ae.indexMaxPoints)continue;if(ar.source=null,0!==re.length){Tt>1&&console.time("clipping");var Pn,rr,Sn,an,fn,Di,_n=.5*Ae.buffer/Ae.extent,Oi=.5-_n,ta=.5+_n,oi=1+_n;Pn=rr=Sn=an=null,fn=Z(re,wr,_e-_n,_e+ta,0,ar.minX,ar.maxX,Ae),Di=Z(re,wr,_e+Oi,_e+oi,0,ar.minX,ar.maxX,Ae),re=null,fn&&(Pn=Z(fn,wr,G-_n,G+ta,1,ar.minY,ar.maxY,Ae),rr=Z(fn,wr,G+Oi,G+oi,1,ar.minY,ar.maxY,Ae),fn=null),Di&&(Sn=Z(Di,wr,G-_n,G+ta,1,ar.minY,ar.maxY,Ae),an=Z(Di,wr,G+Oi,G+oi,1,ar.minY,ar.maxY,Ae),Di=null),Tt>1&&console.timeEnd("clipping"),pe.push(Pn||[],ve+1,2*_e,2*G),pe.push(rr||[],ve+1,2*_e,2*G+1),pe.push(Sn||[],ve+1,2*_e+1,2*G),pe.push(an||[],ve+1,2*_e+1,2*G+1)}}},si.prototype.getTile=function(re,ve,_e){var G=this.options,oe=G.extent,xe=G.debug;if(re<0||re>24)return null;var Oe=1<<re,pe=ai(re,ve=(ve%Oe+Oe)%Oe,_e);if(this.tiles[pe])return dr(this.tiles[pe],oe);xe>1&&console.log("drilling down to z%d-%d-%d",re,ve,_e);for(var Ae,Tt=re,wr=ve,Kt=_e;!Ae&&Tt>0;)Tt--,wr=Math.floor(wr/2),Kt=Math.floor(Kt/2),Ae=this.tiles[ai(Tt,wr,Kt)];return Ae&&Ae.source?(xe>1&&console.log("found parent tile z%d-%d-%d",Tt,wr,Kt),xe>1&&console.time("drilling down"),this.splitTile(Ae.source,Tt,wr,Kt,re,ve,_e),xe>1&&console.timeEnd("drilling down"),this.tiles[pe]?dr(this.tiles[pe],oe):null):null};var Pi=function(re){function ve(_e,G,oe,xe){re.call(this,_e,G,oe,Yi),xe&&(this.loadGeoJSON=xe)}return re&&(ve.__proto__=re),(ve.prototype=Object.create(re&&re.prototype)).constructor=ve,ve.prototype.loadData=function(_e,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=G,this._pendingLoadDataParams=_e,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},ve.prototype._loadData=function(){var _e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var G=this._pendingCallback,oe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var xe=!!(oe&&oe.request&&oe.request.collectResourceTiming)&&new l.RequestPerformance(oe.request);this.loadGeoJSON(oe,function(Oe,pe){if(Oe||!pe)return G(Oe);if("object"!=typeof pe)return G(new Error("Input data given to '"+oe.source+"' is not a valid GeoJSON object."));!function ar(Br,Rn){var Pn,rr=Br&&Br.type;if("FeatureCollection"===rr)for(Pn=0;Pn<Br.features.length;Pn++)ar(Br.features[Pn],Rn);else if("GeometryCollection"===rr)for(Pn=0;Pn<Br.geometries.length;Pn++)ar(Br.geometries[Pn],Rn);else if("Feature"===rr)ar(Br.geometry,Rn);else if("Polygon"===rr)Ye(Br.coordinates,Rn);else if("MultiPolygon"===rr)for(Pn=0;Pn<Br.coordinates.length;Pn++)Ye(Br.coordinates[Pn],Rn);return Br}(pe,!0);try{if(oe.filter){var Ae=l.createExpression(oe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ae.result)throw new Error(Ae.value.map(function(ar){return ar.key+": "+ar.message}).join(", "));var Tt=pe.features.filter(function(ar){return Ae.value.evaluate({zoom:0},ar)});pe={type:"FeatureCollection",features:Tt}}_e._geoJSONIndex=oe.cluster?new cn(function(ar){var Br=ar.superclusterOptions,Rn=ar.clusterProperties;if(!Rn||!Br)return Br;for(var Pn={},rr={},Sn={accumulated:null,zoom:0},an={properties:null},fn=Object.keys(Rn),Di=0,_n=fn;Di<_n.length;Di+=1){var Oi=_n[Di],ta=Rn[Oi],oi=ta[0],Ji=l.createExpression(ta[1]),ji=l.createExpression("string"==typeof oi?[oi,["accumulated"],["get",Oi]]:oi);Pn[Oi]=Ji.value,rr[Oi]=ji.value}return Br.map=function(Ti){an.properties=Ti;for(var _a={},Ia=0,Gi=fn;Ia<Gi.length;Ia+=1){var Ni=Gi[Ia];_a[Ni]=Pn[Ni].evaluate(Sn,an)}return _a},Br.reduce=function(Ti,_a){an.properties=_a;for(var Ia=0,Gi=fn;Ia<Gi.length;Ia+=1){var Ni=Gi[Ia];Sn.accumulated=Ti[Ni],Ti[Ni]=rr[Ni].evaluate(Sn,an)}},Br}(oe)).load(pe.features):new si(ar=pe,oe.geojsonVtOptions)}catch(ar){return G(ar)}var ar;_e.loaded={};var wr={};if(xe){var Kt=xe.finish();Kt&&(wr.resourceTiming={},wr.resourceTiming[oe.source]=JSON.parse(JSON.stringify(Kt)))}G(null,wr)})}},ve.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},ve.prototype.reloadTile=function(_e,G){var oe=this.loaded;return oe&&oe[_e.uid]?re.prototype.reloadTile.call(this,_e,G):this.loadTile(_e,G)},ve.prototype.loadGeoJSON=function(_e,G){if(_e.request)l.getJSON(_e.request,G);else{if("string"!=typeof _e.data)return G(new Error("Input data given to '"+_e.source+"' is not a valid GeoJSON object."));try{return G(null,JSON.parse(_e.data))}catch(oe){return G(new Error("Input data given to '"+_e.source+"' is not a valid GeoJSON object."))}}},ve.prototype.removeSource=function(_e,G){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),G()},ve.prototype.getClusterExpansionZoom=function(_e,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(_e.clusterId))}catch(oe){G(oe)}},ve.prototype.getClusterChildren=function(_e,G){try{G(null,this._geoJSONIndex.getChildren(_e.clusterId))}catch(oe){G(oe)}},ve.prototype.getClusterLeaves=function(_e,G){try{G(null,this._geoJSONIndex.getLeaves(_e.clusterId,_e.limit,_e.offset))}catch(oe){G(oe)}},ve}(Ne),Ei=function(re){var ve=this;this.self=re,this.actor=new l.Actor(re,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ne,geojson:Pi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(_e,G){if(ve.workerSourceTypes[_e])throw new Error('Worker source with name "'+_e+'" already registered.');ve.workerSourceTypes[_e]=G},this.self.registerRTLTextPlugin=function(_e){if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=_e.applyArabicShaping,l.plugin.processBidirectionalText=_e.processBidirectionalText,l.plugin.processStyledBidirectionalText=_e.processStyledBidirectionalText}};return Ei.prototype.setReferrer=function(re,ve){this.referrer=ve},Ei.prototype.setImages=function(re,ve,_e){for(var G in this.availableImages[re]=ve,this.workerSources[re]){var oe=this.workerSources[re][G];for(var xe in oe)oe[xe].availableImages=ve}_e()},Ei.prototype.setLayers=function(re,ve,_e){this.getLayerIndex(re).replace(ve),_e()},Ei.prototype.updateLayers=function(re,ve,_e){this.getLayerIndex(re).update(ve.layers,ve.removedIds),_e()},Ei.prototype.loadTile=function(re,ve,_e){this.getWorkerSource(re,ve.type,ve.source).loadTile(ve,_e)},Ei.prototype.loadDEMTile=function(re,ve,_e){this.getDEMWorkerSource(re,ve.source).loadTile(ve,_e)},Ei.prototype.reloadTile=function(re,ve,_e){this.getWorkerSource(re,ve.type,ve.source).reloadTile(ve,_e)},Ei.prototype.abortTile=function(re,ve,_e){this.getWorkerSource(re,ve.type,ve.source).abortTile(ve,_e)},Ei.prototype.removeTile=function(re,ve,_e){this.getWorkerSource(re,ve.type,ve.source).removeTile(ve,_e)},Ei.prototype.removeDEMTile=function(re,ve){this.getDEMWorkerSource(re,ve.source).removeTile(ve)},Ei.prototype.removeSource=function(re,ve,_e){if(this.workerSources[re]&&this.workerSources[re][ve.type]&&this.workerSources[re][ve.type][ve.source]){var G=this.workerSources[re][ve.type][ve.source];delete this.workerSources[re][ve.type][ve.source],void 0!==G.removeSource?G.removeSource(ve,_e):_e()}},Ei.prototype.loadWorkerSource=function(re,ve,_e){try{this.self.importScripts(ve.url),_e()}catch(G){_e(G.toString())}},Ei.prototype.syncRTLPluginState=function(re,ve,_e){try{l.plugin.setState(ve);var G=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&null!=G){this.self.importScripts(G);var oe=l.plugin.isParsed();_e(oe?void 0:new Error("RTL Text Plugin failed to import scripts from "+G),oe)}}catch(xe){_e(xe.toString())}},Ei.prototype.getAvailableImages=function(re){var ve=this.availableImages[re];return ve||(ve=[]),ve},Ei.prototype.getLayerIndex=function(re){var ve=this.layerIndexes[re];return ve||(ve=this.layerIndexes[re]=new R),ve},Ei.prototype.getWorkerSource=function(re,ve,_e){var G=this;return this.workerSources[re]||(this.workerSources[re]={}),this.workerSources[re][ve]||(this.workerSources[re][ve]={}),this.workerSources[re][ve][_e]||(this.workerSources[re][ve][_e]=new this.workerSourceTypes[ve]({send:function(oe,xe,Oe){G.actor.send(oe,xe,Oe,re)}},this.getLayerIndex(re),this.getAvailableImages(re))),this.workerSources[re][ve][_e]},Ei.prototype.getDEMWorkerSource=function(re,ve){return this.demWorkerSources[re]||(this.demWorkerSources[re]={}),this.demWorkerSources[re][ve]||(this.demWorkerSources[re][ve]=new W),this.demWorkerSources[re][ve]},Ei.prototype.enforceCacheSizeLimit=function(re,ve){l.enforceCacheSizeLimit(ve)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ei(self)),Ei}),_(0,function(l){var m=l.createCommonjsModule(function(a){function s(b){return!o(b)}function o(b){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,B,$=new Blob([""],{type:"text/javascript"}),he=URL.createObjectURL($);try{B=new Worker(he),A=!0}catch(Ce){A=!1}return B&&B.terminate(),URL.revokeObjectURL(he),A}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var A=document.createElement("canvas");A.width=A.height=1;var B=A.getContext("2d");if(!B)return!1;var $=B.getImageData(0,0,1,1);return $&&$.width===A.width}()?(void 0===p[E=b&&b.failIfMajorPerformanceCaveat]&&(p[E]=function(A){var he,Ce,Me,B=(he=A,Ce=document.createElement("canvas"),(Me=Object.create(s.webGLContextAttributes)).failIfMajorPerformanceCaveat=he,Ce.probablySupportsContext?Ce.probablySupportsContext("webgl",Me)||Ce.probablySupportsContext("experimental-webgl",Me):Ce.supportsContext?Ce.supportsContext("webgl",Me)||Ce.supportsContext("experimental-webgl",Me):Ce.getContext("webgl",Me)||Ce.getContext("experimental-webgl",Me));if(!B)return!1;var $=B.createShader(B.VERTEX_SHADER);return!(!$||B.isContextLost())&&(B.shaderSource($,"void main() {}"),B.compileShader($),!0===B.getShaderParameter($,B.COMPILE_STATUS))}(E)),p[E]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var E}a.exports?a.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var p={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),O={create:function(a,s,o){var p=l.window.document.createElement(a);return void 0!==s&&(p.className=s),o&&o.appendChild(p),p},createNS:function(a,s){return l.window.document.createElementNS(a,s)}},R=l.window.document&&l.window.document.documentElement.style;function N(a){if(!R)return a[0];for(var s=0;s<a.length;s++)if(a[s]in R)return a[s];return a[0]}var H,j=N(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);O.disableDrag=function(){R&&j&&(H=R[j],R[j]="none")},O.enableDrag=function(){R&&j&&(R[j]=H)};var be=N(["transform","WebkitTransform"]);O.setTransform=function(a,s){a.style[be]=s};var Ne=!1;try{var V=Object.defineProperty({},"passive",{get:function(){Ne=!0}});l.window.addEventListener("test",V,V),l.window.removeEventListener("test",V,V)}catch(a){Ne=!1}O.addEventListener=function(a,s,o,p){void 0===p&&(p={}),a.addEventListener(s,o,"passive"in p&&Ne?p:p.capture)},O.removeEventListener=function(a,s,o,p){void 0===p&&(p={}),a.removeEventListener(s,o,"passive"in p&&Ne?p:p.capture)};var W=function(a){a.preventDefault(),a.stopPropagation(),l.window.removeEventListener("click",W,!0)};function Ye(a){var s=a.userImage;return!!(s&&s.render&&s.render())&&(a.data.replace(new Uint8Array(s.data.buffer)),!0)}O.suppressClick=function(){l.window.addEventListener("click",W,!0),l.window.setTimeout(function(){l.window.removeEventListener("click",W,!0)},0)},O.mousePos=function(a,s){var o=a.getBoundingClientRect();return new l.Point(s.clientX-o.left-a.clientLeft,s.clientY-o.top-a.clientTop)},O.touchPos=function(a,s){for(var o=a.getBoundingClientRect(),p=[],b=0;b<s.length;b++)p.push(new l.Point(s[b].clientX-o.left-a.clientLeft,s[b].clientY-o.top-a.clientTop));return p},O.mouseButton=function(a){return void 0!==l.window.InstallTrigger&&2===a.button&&a.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:a.button},O.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)};var _t=function(a){function s(){a.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var p=0,b=this.requestors;p<b.length;p+=1){var E=b[p];this._notify(E.ids,E.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,p){this._validate(o,p)&&(this.images[o]=p)},s.prototype._validate=function(o,p){var b=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new l.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),b=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new l.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),b=!1),this._validateContent(p.content,p)||(this.fire(new l.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),b=!1),b},s.prototype._validateStretch=function(o,p){if(!o)return!0;for(var b=0,E=0,A=o;E<A.length;E+=1){var B=A[E];if(B[0]<b||B[1]<B[0]||p<B[1])return!1;b=B[1]}return!0},s.prototype._validateContent=function(o,p){return!(o&&(4!==o.length||o[0]<0||p.data.width<o[0]||o[1]<0||p.data.height<o[1]||o[2]<0||p.data.width<o[2]||o[3]<0||p.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,p){p.version=this.images[o].version+1,this.images[o]=p,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var p=this.images[o];delete this.images[o],delete this.patterns[o],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,p){var b=!0;if(!this.isLoaded())for(var E=0,A=o;E<A.length;E+=1)this.images[A[E]]||(b=!1);this.isLoaded()||b?this._notify(o,p):this.requestors.push({ids:o,callback:p})},s.prototype._notify=function(o,p){for(var b={},E=0,A=o;E<A.length;E+=1){var B=A[E];this.images[B]||this.fire(new l.Event("styleimagemissing",{id:B}));var $=this.images[B];$?b[B]={data:$.data.clone(),pixelRatio:$.pixelRatio,sdf:$.sdf,version:$.version,stretchX:$.stretchX,stretchY:$.stretchY,content:$.content,hasRenderCallback:Boolean($.userImage&&$.userImage.render)}:l.warnOnce('Image "'+B+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}p(null,b)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var p=this.patterns[o],b=this.getImage(o);if(!b)return null;if(p&&p.position.version===b.version)return p.position;if(p)p.position.version=b.version;else{var E={w:b.data.width+2,h:b.data.height+2,x:0,y:0},A=new l.ImagePosition(E,b);this.patterns[o]={bin:E,position:A}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var p=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(o,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var p in this.patterns)o.push(this.patterns[p].bin);var b=l.potpack(o),E=b.w,A=b.h,B=this.atlasImage;for(var $ in B.resize({width:E||1,height:A||1}),this.patterns){var he=this.patterns[$].bin,Ce=he.x+1,Me=he.y+1,ke=this.images[$].data,et=ke.width,$e=ke.height;l.RGBAImage.copy(ke,B,{x:0,y:0},{x:Ce,y:Me},{width:et,height:$e}),l.RGBAImage.copy(ke,B,{x:0,y:$e-1},{x:Ce,y:Me-1},{width:et,height:1}),l.RGBAImage.copy(ke,B,{x:0,y:0},{x:Ce,y:Me+$e},{width:et,height:1}),l.RGBAImage.copy(ke,B,{x:et-1,y:0},{x:Ce-1,y:Me},{width:1,height:$e}),l.RGBAImage.copy(ke,B,{x:0,y:0},{x:Ce+et,y:Me},{width:1,height:$e})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var p=0,b=o;p<b.length;p+=1){var E=b[p];if(!this.callbackDispatchedThisFrame[E]){this.callbackDispatchedThisFrame[E]=!0;var A=this.images[E];Ye(A)&&this.updateImage(E,A)}}},s}(l.Evented),Rt=tt,wt=tt,lt=1e20;function tt(a,s,o,p,b,E){this.fontSize=a||24,this.buffer=void 0===s?3:s,this.cutoff=p||.25,this.fontFamily=b||"sans-serif",this.fontWeight=E||"normal",this.radius=o||8;var A=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=A,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.d=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Int16Array(A),this.middle=Math.round(A/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Gt(a,s,o,p,b,E,A){for(var B=0;B<s;B++){for(var $=0;$<o;$++)p[$]=a[$*s+B];for(Q(p,b,E,A,o),$=0;$<o;$++)a[$*s+B]=b[$]}for($=0;$<o;$++){for(B=0;B<s;B++)p[B]=a[$*s+B];for(Q(p,b,E,A,s),B=0;B<s;B++)a[$*s+B]=Math.sqrt(b[B])}}function Q(a,s,o,p,b){o[0]=0,p[0]=-lt,p[1]=+lt;for(var E=1,A=0;E<b;E++){for(var B=(a[E]+E*E-(a[o[A]]+o[A]*o[A]))/(2*E-2*o[A]);B<=p[A];)A--,B=(a[E]+E*E-(a[o[A]]+o[A]*o[A]))/(2*E-2*o[A]);o[++A]=E,p[A]=B,p[A+1]=+lt}for(E=0,A=0;E<b;E++){for(;p[A+1]<E;)A++;s[E]=(E-o[A])*(E-o[A])+a[o[A]]}}tt.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),p=0;p<this.size*this.size;p++){var b=s.data[4*p+3]/255;this.gridOuter[p]=1===b?0:0===b?lt:Math.pow(Math.max(0,.5-b),2),this.gridInner[p]=1===b?lt:0===b?0:Math.pow(Math.max(0,b-.5),2)}for(Gt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Gt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),p=0;p<this.size*this.size;p++)o[p]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[p]-this.gridInner[p])/this.radius+this.cutoff))));return o},Rt.default=wt;var Ut=function(a,s){this.requestManager=a,this.localIdeographFontFamily=s,this.entries={}};Ut.prototype.setURL=function(a){this.url=a},Ut.prototype.getGlyphs=function(a,s){var o=this,p=[];for(var b in a)for(var E=0,A=a[b];E<A.length;E+=1)p.push({stack:b,id:A[E]});l.asyncAll(p,function(B,$){var he=B.stack,Ce=B.id,Me=o.entries[he];Me||(Me=o.entries[he]={glyphs:{},requests:{},ranges:{}});var ke=Me.glyphs[Ce];if(void 0===ke){if(ke=o._tinySDF(Me,he,Ce))return Me.glyphs[Ce]=ke,void $(null,{stack:he,id:Ce,glyph:ke});var et=Math.floor(Ce/256);if(256*et>65535)$(new Error("glyphs > 65535 not supported"));else if(Me.ranges[et])$(null,{stack:he,id:Ce,glyph:ke});else{var $e=Me.requests[et];$e||($e=Me.requests[et]=[],Ut.loadGlyphRange(he,et,o.url,o.requestManager,function(pt,Ke){if(Ke){for(var ft in Ke)o._doesCharSupportLocalGlyph(+ft)||(Me.glyphs[+ft]=Ke[+ft]);Me.ranges[et]=!0}for(var It=0,Wt=$e;It<Wt.length;It+=1)(0,Wt[It])(pt,Ke);delete Me.requests[et]})),$e.push(function(pt,Ke){pt?$(pt):Ke&&$(null,{stack:he,id:Ce,glyph:Ke[Ce]||null})})}}else $(null,{stack:he,id:Ce,glyph:ke})},function(B,$){if(B)s(B);else if($){for(var he={},Ce=0,Me=$;Ce<Me.length;Ce+=1){var ke=Me[Ce],et=ke.stack,$e=ke.id,pt=ke.glyph;(he[et]||(he[et]={}))[$e]=pt&&{id:pt.id,bitmap:pt.bitmap.clone(),metrics:pt.metrics}}s(null,he)}})},Ut.prototype._doesCharSupportLocalGlyph=function(a){return!!this.localIdeographFontFamily&&(l.isChar["CJK Unified Ideographs"](a)||l.isChar["Hangul Syllables"](a)||l.isChar.Hiragana(a)||l.isChar.Katakana(a))},Ut.prototype._tinySDF=function(a,s,o){var p=this.localIdeographFontFamily;if(p&&this._doesCharSupportLocalGlyph(o)){var b=a.tinySDF;if(!b){var E="400";/bold/i.test(s)?E="900":/medium/i.test(s)?E="500":/light/i.test(s)&&(E="200"),b=a.tinySDF=new Ut.TinySDF(24,3,8,.25,p,E)}return{id:o,bitmap:new l.AlphaImage({width:30,height:30},b.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Ut.loadGlyphRange=function(a,s,o,p,b){var E=256*s,A=E+255,B=p.transformRequest(p.normalizeGlyphsURL(o).replace("{fontstack}",a).replace("{range}",E+"-"+A),l.ResourceType.Glyphs);l.getArrayBuffer(B,function($,he){if($)b($);else if(he){for(var Ce={},Me=0,ke=l.parseGlyphPBF(he);Me<ke.length;Me+=1){var et=ke[Me];Ce[et.id]=et}b(null,Ce)}})},Ut.TinySDF=Rt;var ot=function(){this.specification=l.styleSpec.light.position};ot.prototype.possiblyEvaluate=function(a,s){return l.sphericalToCartesian(a.expression.evaluate(s))},ot.prototype.interpolate=function(a,s,o){return{x:l.number(a.x,s.x,o),y:l.number(a.y,s.y,o),z:l.number(a.z,s.z,o)}};var Ue=new l.Properties({anchor:new l.DataConstantProperty(l.styleSpec.light.anchor),position:new ot,color:new l.DataConstantProperty(l.styleSpec.light.color),intensity:new l.DataConstantProperty(l.styleSpec.light.intensity)}),ct=function(a){function s(o){a.call(this),this._transitionable=new l.Transitionable(Ue),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,p){if(void 0===p&&(p={}),!this._validate(l.validateLight,o,p))for(var b in o){var E=o[b];l.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-"-transition".length),E):this._transitionable.setValue(b,E)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,p,b){return(!b||!1!==b.validate)&&l.emitValidationErrors(this,o.call(l.validateStyle,l.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:l.styleSpec})))},s}(l.Evented),Xe=function(a,s){this.width=a,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Xe.prototype.getDash=function(a,s){var o=a.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(a,s)),this.dashEntry[o]},Xe.prototype.getDashRanges=function(a,s,o){var p=[],b=a.length%2==1?-a[a.length-1]*o:0,E=a[0]*o,A=!0;p.push({left:b,right:E,isDash:A,zeroLength:0===a[0]});for(var B=a[0],$=1;$<a.length;$++){var he=a[$];p.push({left:b=B*o,right:E=(B+=he)*o,isDash:A=!A,zeroLength:0===he})}return p},Xe.prototype.addRoundDash=function(a,s,o){for(var p=s/2,b=-o;b<=o;b++)for(var E=this.width*(this.nextRow+o+b),A=0,B=a[A],$=0;$<this.width;$++){$/B.right>1&&(B=a[++A]);var he=Math.abs($-B.left),Ce=Math.abs($-B.right),Me=Math.min(he,Ce),ke=void 0,et=b/o*(p+1);if(B.isDash){var $e=p-Math.abs(et);ke=Math.sqrt(Me*Me+$e*$e)}else ke=p-Math.sqrt(Me*Me+et*et);this.data[E+$]=Math.max(0,Math.min(255,ke+128))}},Xe.prototype.addRegularDash=function(a){for(var s=a.length-1;s>=0;--s){var o=a[s],p=a[s+1];o.zeroLength?a.splice(s,1):p&&p.isDash===o.isDash&&(p.left=o.left,a.splice(s,1))}var b=a[0],E=a[a.length-1];b.isDash===E.isDash&&(b.left=E.left-this.width,E.right=b.right+this.width);for(var A=this.width*this.nextRow,B=0,$=a[B],he=0;he<this.width;he++){he/$.right>1&&($=a[++B]);var Ce=Math.abs(he-$.left),Me=Math.abs(he-$.right),ke=Math.min(Ce,Me);this.data[A+he]=Math.max(0,Math.min(255,($.isDash?ke:-ke)+128))}},Xe.prototype.addDash=function(a,s){var o=s?7:0,p=2*o+1;if(this.nextRow+p>this.height)return l.warnOnce("LineAtlas out of space"),null;for(var b=0,E=0;E<a.length;E++)b+=a[E];if(0!==b){var A=this.width/b,B=this.getDashRanges(a,this.width,A);s?this.addRoundDash(B,A,o):this.addRegularDash(B)}var $={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:b};return this.nextRow+=p,this.dirty=!0,$},Xe.prototype.bind=function(a){var s=a.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var Pt=function a(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=l.uniqueId();for(var p=this.workerPool.acquire(this.id),b=0;b<p.length;b++){var E=new a.Actor(p[b],o,this.id);E.name="Worker "+b,this.actors.push(E)}};function kt(a,s,o){var p=function(b,E){if(b)return o(b);if(E){var A=l.pick(l.extend(E,a),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);E.vector_layers&&(A.vectorLayers=E.vector_layers,A.vectorLayerIds=A.vectorLayers.map(function(B){return B.id})),A.tiles=s.canonicalizeTileset(A,a.url),o(null,A)}};return a.url?l.getJSON(s.transformRequest(s.normalizeSourceURL(a.url),l.ResourceType.Source),p):l.browser.frame(function(){return p(null,a)})}Pt.prototype.broadcast=function(a,s,o){l.asyncAll(this.actors,function(p,b){p.send(a,s,b)},o=o||function(){})},Pt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Pt.prototype.remove=function(){this.actors.forEach(function(a){a.remove()}),this.actors=[],this.workerPool.release(this.id)},Pt.Actor=l.Actor;var ut=function(a,s,o){this.bounds=l.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=s||0,this.maxzoom=o||24};ut.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]},ut.prototype.contains=function(a){var s=Math.pow(2,a.z),o=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*s),p=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*s),b=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*s),E=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*s);return a.x>=o&&a.x<b&&a.y>=p&&a.y<E};var ir=function(a){function s(o,p,b,E){if(a.call(this),this.id=o,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(p,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(E)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=kt(this._options,this.map._requestManager,function(p,b){o._tileJSONRequest=null,o._loaded=!0,p?o.fire(new l.ErrorEvent(p)):b&&(l.extend(o,b),b.bounds&&(o.tileBounds=new ut(b.bounds,o.minzoom,o.maxzoom)),l.postTurnstileEvent(b.tiles,o.map._requestManager._customAccessToken),l.postMapLoadEvent(b.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var p=this;return this.setSourceProperty(function(){p._options.tiles=o}),this},s.prototype.setUrl=function(o){var p=this;return this.setSourceProperty(function(){p.url=o,p._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return l.extend({},this._options)},s.prototype.loadTile=function(o,p){var b=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),E={request:this.map._requestManager.transformRequest(b,l.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function A(B,$){return delete o.request,o.aborted?p(null):B&&404!==B.status?p(B):($&&$.resourceTiming&&(o.resourceTiming=$.resourceTiming),this.map._refreshExpiredTiles&&$&&o.setExpiryData($),o.loadVectorData($,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}E.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state?"loading"===o.state?o.reloadCallback=p:o.request=o.actor.send("reloadTile",E,A.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",E,A.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(l.Evented),le=function(a){function s(o,p,b,E){a.call(this),this.id=o,this.dispatcher=b,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},p),l.extend(this,l.pick(p,["url","scheme","tileSize"]))}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=kt(this._options,this.map._requestManager,function(p,b){o._tileJSONRequest=null,o._loaded=!0,p?o.fire(new l.ErrorEvent(p)):b&&(l.extend(o,b),b.bounds&&(o.tileBounds=new ut(b.bounds,o.minzoom,o.maxzoom)),l.postTurnstileEvent(b.tiles),l.postMapLoadEvent(b.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return l.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,p){var b=this,E=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=l.getImage(this.map._requestManager.transformRequest(E,l.ResourceType.Tile),function(A,B){if(delete o.request,o.aborted)o.state="unloaded",p(null);else if(A)o.state="errored",p(A);else if(B){b.map._refreshExpiredTiles&&o.setExpiryData(B),delete B.cacheControl,delete B.expires;var $=b.map.painter.context,he=$.gl;o.texture=b.map.painter.getTileTexture(B.width),o.texture?o.texture.update(B,{useMipmap:!0}):(o.texture=new l.Texture($,B,he.RGBA,{useMipmap:!0}),o.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST),$.extTextureFilterAnisotropic&&he.texParameterf(he.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax)),o.state="loaded",l.cacheEntryPossiblyAdded(b.dispatcher),p(null)}})},s.prototype.abortTile=function(o,p){o.request&&(o.request.cancel(),delete o.request),p()},s.prototype.unloadTile=function(o,p){o.texture&&this.map.painter.saveTileTexture(o.texture),p()},s.prototype.hasTransition=function(){return!1},s}(l.Evented),ce=function(a){function s(o,p,b,E){a.call(this,o,p,b,E),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox"}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,p){var b=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function E(A,B){A&&(o.state="errored",p(A)),B&&(o.dem=B,o.needsHillshadePrepare=!0,o.state="loaded",p(null))}o.request=l.getImage(this.map._requestManager.transformRequest(b,l.ResourceType.Tile),function(A,B){if(delete o.request,o.aborted)o.state="unloaded",p(null);else if(A)o.state="errored",p(A);else if(B){this.map._refreshExpiredTiles&&o.setExpiryData(B),delete B.cacheControl,delete B.expires;var $=l.window.ImageBitmap&&B instanceof l.window.ImageBitmap&&l.offscreenCanvasSupported()?B:l.browser.getImageData(B,1),he={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:$,encoding:this.encoding};o.actor&&"expired"!==o.state||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",he,E.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var p=o.canonical,b=Math.pow(2,p.z),E=(p.x-1+b)%b,A=0===p.x?o.wrap-1:o.wrap,B=(p.x+1+b)%b,$=p.x+1===b?o.wrap+1:o.wrap,he={};return he[new l.OverscaledTileID(o.overscaledZ,A,p.z,E,p.y).key]={backfilled:!1},he[new l.OverscaledTileID(o.overscaledZ,$,p.z,B,p.y).key]={backfilled:!1},p.y>0&&(he[new l.OverscaledTileID(o.overscaledZ,A,p.z,E,p.y-1).key]={backfilled:!1},he[new l.OverscaledTileID(o.overscaledZ,o.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},he[new l.OverscaledTileID(o.overscaledZ,$,p.z,B,p.y-1).key]={backfilled:!1}),p.y+1<b&&(he[new l.OverscaledTileID(o.overscaledZ,A,p.z,E,p.y+1).key]={backfilled:!1},he[new l.OverscaledTileID(o.overscaledZ,o.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},he[new l.OverscaledTileID(o.overscaledZ,$,p.z,B,p.y+1).key]={backfilled:!1}),he},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(le),ae=function(a){function s(o,p,b,E){a.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=b.getActor(),this.setEventedParent(E),this._data=p.data,this._options=l.extend({},p),this._collectResourceTiming=p.collectResourceTiming,this._resourceTiming=[],void 0!==p.maxzoom&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId;var A=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:(void 0!==p.buffer?p.buffer:128)*A,tolerance:(void 0!==p.tolerance?p.tolerance:.375)*A,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:void 0!==p.clusterMaxZoom?Math.min(p.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,p.clusterMinPoints||2),extent:l.EXTENT,radius:(p.clusterRadius||50)*A,log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(p){if(p)o.fire(new l.ErrorEvent(p));else{var b={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(b.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new l.Event("data",b))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var p=this;return this._data=o,this.fire(new l.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)p.fire(new l.ErrorEvent(b));else{var E={dataType:"source",sourceDataType:"content"};p._collectResourceTiming&&p._resourceTiming&&p._resourceTiming.length>0&&(E.resourceTiming=p._resourceTiming,p._resourceTiming=[]),p.fire(new l.Event("data",E))}}),this},s.prototype.getClusterExpansionZoom=function(o,p){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},p),this},s.prototype.getClusterChildren=function(o,p){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},p),this},s.prototype.getClusterLeaves=function(o,p,b,E){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:p,offset:b},E),this},s.prototype._updateWorkerData=function(o){var p=this;this._loaded=!1;var b=l.extend({},this.workerOptions),E=this._data;"string"==typeof E?(b.request=this.map._requestManager.transformRequest(l.browser.resolveURL(E),l.ResourceType.Source),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(E),this.actor.send(this.type+".loadData",b,function(A,B){p._removed||B&&B.abandoned||(p._loaded=!0,B&&B.resourceTiming&&B.resourceTiming[p.id]&&(p._resourceTiming=B.resourceTiming[p.id].slice(0)),p.actor.send(p.type+".coalesce",{source:b.source},null),o(A))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,p){var b=this,E=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(E,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(A,B){return delete o.request,o.unloadVectorData(),o.aborted?p(null):A?p(A):(o.loadVectorData(B,b.map.painter,"reloadTile"===E),p(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return l.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(l.Evented),me=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Ie=function(a){function s(o,p,b,E){a.call(this),this.id=o,this.dispatcher=b,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=p}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(o,p){var b=this;this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),function(E,A){b._loaded=!0,E?b.fire(new l.ErrorEvent(E)):A&&(b.image=A,o&&(b.coordinates=o),p&&p(),b._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var p=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){p.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var p=this;this.coordinates=o;var b=o.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(A){for(var B=1/0,$=1/0,he=-1/0,Ce=-1/0,Me=0,ke=A;Me<ke.length;Me+=1){var et=ke[Me];B=Math.min(B,et.x),$=Math.min($,et.y),he=Math.max(he,et.x),Ce=Math.max(Ce,et.y)}var $e=Math.max(he-B,Ce-$),pt=Math.max(0,Math.floor(-Math.log($e)/Math.LN2)),Ke=Math.pow(2,pt);return new l.CanonicalTileID(pt,Math.floor((B+he)/2*Ke),Math.floor(($+Ce)/2*Ke))}(b),this.minzoom=this.maxzoom=this.tileID.z;var E=b.map(function(A){return p.tileID.getTilePoint(A)._round()});return this._boundsArray=new l.StructArrayLayout4i8,this._boundsArray.emplaceBack(E[0].x,E[0].y,0,0),this._boundsArray.emplaceBack(E[1].x,E[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(E[3].x,E[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(E[2].x,E[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var o=this.map.painter.context,p=o.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,me.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new l.Texture(o,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this.tiles){var E=this.tiles[b];"loaded"!==E.state&&(E.state="loaded",E.texture=this.texture)}}},s.prototype.loadTile=function(o,p){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},p(null)):(o.state="errored",p(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(l.Evented),je=function(a){function s(o,p,b,E){a.call(this,o,p,b,E),this.roundZoom=!0,this.type="video",this.options=p}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var p=this.options;this.urls=[];for(var b=0,E=p.urls;b<E.length;b+=1)this.urls.push(this.map._requestManager.transformRequest(E[b],l.ResourceType.Source).url);l.getVideo(this.urls,function(A,B){o._loaded=!0,A?o.fire(new l.ErrorEvent(A)):B&&(o.video=B,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var p=this.video.seekable;o<p.start(0)||o>p.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+p.start(0)+" and "+p.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var o=this.map.painter.context,p=o.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,me.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(o,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this.tiles){var E=this.tiles[b];"loaded"!==E.state&&(E.state="loaded",E.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(Ie),gt=function(a){function s(o,p,b,E){a.call(this,o,p,b,E),p.coordinates?Array.isArray(p.coordinates)&&4===p.coordinates.length&&!p.coordinates.some(function(A){return!Array.isArray(A)||2!==A.length||A.some(function(B){return"number"!=typeof B})})||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+o,null,'missing required property "coordinates"'))),p.animate&&"boolean"!=typeof p.animate&&this.fire(new l.ErrorEvent(new l.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),p.canvas?"string"==typeof p.canvas||p.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=p,this.animate=void 0===p.animate||p.animate}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var p=this.map.painter.context,b=p.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,me.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(p,this.canvas,b.RGBA,{premultiply:!0}),this.tiles){var A=this.tiles[E];"loaded"!==A.state&&(A.state="loaded",A.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,p=[this.canvas.width,this.canvas.height];o<p.length;o+=1){var b=p[o];if(isNaN(b)||b<=0)return!0}return!1},s}(Ie),xr={vector:ir,raster:le,"raster-dem":ce,geojson:ae,video:je,image:Ie,canvas:gt};function Fr(a,s){var o=l.identity([]);return l.translate(o,o,[1,1,0]),l.scale(o,o,[.5*a.width,.5*a.height,1]),l.multiply(o,o,a.calculatePosMatrix(s.toUnwrapped()))}function cn(a,s,o,p,b,E){var A=function(pt,Ke,ft){if(pt)for(var It=0,Wt=pt;It<Wt.length;It+=1){var pr=Ke[Wt[It]];if(pr&&pr.source===ft&&"fill-extrusion"===pr.type)return!0}else for(var nr in Ke){var br=Ke[nr];if(br.source===ft&&"fill-extrusion"===br.type)return!0}return!1}(b&&b.layers,s,a.id),B=E.maxPitchScaleFactor(),$=a.tilesIn(p,B,A);$.sort(Ir);for(var he=[],Ce=0,Me=$;Ce<Me.length;Ce+=1){var ke=Me[Ce];he.push({wrappedTileID:ke.tileID.wrapped().key,queryResults:ke.tile.queryRenderedFeatures(s,o,a._state,ke.queryGeometry,ke.cameraQueryGeometry,ke.scale,b,E,B,Fr(a.transform,ke.tileID))})}var et=function(pt){for(var Ke={},ft={},It=0,Wt=pt;It<Wt.length;It+=1){var pr=Wt[It],nr=pr.queryResults,br=pr.wrappedTileID,Dr=ft[br]=ft[br]||{};for(var Qr in nr)for(var Xr=nr[Qr],dn=Dr[Qr]=Dr[Qr]||{},qn=Ke[Qr]=Ke[Qr]||[],Vn=0,Nn=Xr;Vn<Nn.length;Vn+=1){var Li=Nn[Vn];dn[Li.featureIndex]||(dn[Li.featureIndex]=!0,qn.push(Li))}}return Ke}(he);for(var $e in et)et[$e].forEach(function(pt){var Ke=pt.feature,ft=a.getFeatureState(Ke.layer["source-layer"],Ke.id);Ke.source=Ke.layer.source,Ke.layer["source-layer"]&&(Ke.sourceLayer=Ke.layer["source-layer"]),Ke.state=ft});return et}function Ir(a,s){var o=a.tileID,p=s.tileID;return o.overscaledZ-p.overscaledZ||o.canonical.y-p.canonical.y||o.wrap-p.wrap||o.canonical.x-p.canonical.x}var Ot=function(a,s){this.max=a,this.onRemove=s,this.reset()};Ot.prototype.reset=function(){for(var a in this.data)for(var s=0,o=this.data[a];s<o.length;s+=1){var p=o[s];p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value)}return this.data={},this.order=[],this},Ot.prototype.add=function(a,s,o){var p=this,b=a.wrapped().key;void 0===this.data[b]&&(this.data[b]=[]);var E={value:s,timeout:void 0};if(void 0!==o&&(E.timeout=setTimeout(function(){p.remove(a,E)},o)),this.data[b].push(E),this.order.push(b),this.order.length>this.max){var A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this},Ot.prototype.has=function(a){return a.wrapped().key in this.data},Ot.prototype.getAndRemove=function(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null},Ot.prototype._getAndRemoveByKey=function(a){var s=this.data[a].shift();return s.timeout&&clearTimeout(s.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),s.value},Ot.prototype.getByKey=function(a){var s=this.data[a];return s?s[0].value:null},Ot.prototype.get=function(a){return this.has(a)?this.data[a.wrapped().key][0].value:null},Ot.prototype.remove=function(a,s){if(!this.has(a))return this;var o=a.wrapped().key,p=void 0===s?0:this.data[o].indexOf(s),b=this.data[o][p];return this.data[o].splice(p,1),b.timeout&&clearTimeout(b.timeout),0===this.data[o].length&&delete this.data[o],this.onRemove(b.value),this.order.splice(this.order.indexOf(o),1),this},Ot.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Ot.prototype.filter=function(a){var s=[];for(var o in this.data)for(var p=0,b=this.data[o];p<b.length;p+=1){var E=b[p];a(E.value)||s.push(E)}for(var A=0,B=s;A<B.length;A+=1){var $=B[A];this.remove($.value.tileID,$)}};var Le=function(a,s,o){this.context=a;var p=a.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Le.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Le.prototype.updateData=function(a){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},Le.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var we={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},at=function(a,s,o,p){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.context=a;var b=a.gl;this.buffer=b.createBuffer(),a.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};at.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},at.prototype.updateData=function(a){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,a.arrayBuffer)},at.prototype.enableAttributes=function(a,s){for(var o=0;o<this.attributes.length;o++){var p=s.attributes[this.attributes[o].name];void 0!==p&&a.enableVertexAttribArray(p)}},at.prototype.setVertexAttribPointers=function(a,s,o){for(var p=0;p<this.attributes.length;p++){var b=this.attributes[p],E=s.attributes[b.name];void 0!==E&&a.vertexAttribPointer(E,b.components,a[we[b.type]],!1,this.itemSize,b.offset+this.itemSize*(o||0))}},at.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Re=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Re.prototype.get=function(){return this.current},Re.prototype.set=function(a){},Re.prototype.getDefault=function(){return this.default},Re.prototype.setDefault=function(){this.set(this.default)};var qt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return l.Color.transparent},s.prototype.set=function(o){var p=this.current;(o.r!==p.r||o.g!==p.g||o.b!==p.b||o.a!==p.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Re),Pr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Re),er=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Re),hr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||o[2]!==p[2]||o[3]!==p[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Re),Nr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Re),$r=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Re),C=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var p=this.current;(o.func!==p.func||o.ref!==p.ref||o.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Re),Y=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||o[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Re),Ge=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;o?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Re),nt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Re),xt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;o?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Re),Dt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Re),Z=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;o?p.enable(p.BLEND):p.disable(p.BLEND),this.current=o,this.dirty=!1}},s}(Re),Ze=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Re),Et=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return l.Color.transparent},s.prototype.set=function(o){var p=this.current;(o.r!==p.r||o.g!==p.g||o.b!==p.b||o.a!==p.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Re),Mt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Re),Jt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;o?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=o,this.dirty=!1}},s}(Re),Tr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Re),mr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Re),Yt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Re),gr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Re),sr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||o[2]!==p[2]||o[3]!==p[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Re),dr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Re),mn=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Re),On=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.bindTexture(p.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Re),mi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Re),hi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Re),si=function(a){function s(o){a.call(this,o),this.vao=o.extVertexArrayObject}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Re),ai=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Re),Yi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Re),Pi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Re),Ei=function(a){function s(o,p){a.call(this,o),this.context=o,this.parent=p}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Re),re=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(Ei),ve=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Ei),_e=function(a,s,o,p){this.context=a,this.width=s,this.height=o;var b=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new re(a,b),p&&(this.depthAttachment=new ve(a,b))};_e.prototype.destroy=function(){var a=this.context.gl,s=this.colorAttachment.get();if(s&&a.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&a.deleteRenderbuffer(o)}a.deleteFramebuffer(this.framebuffer)};var G=function(a,s,o){this.func=a,this.mask=s,this.range=o};G.ReadOnly=!1,G.ReadWrite=!0,G.disabled=new G(519,G.ReadOnly,[0,1]);var oe=function(a,s,o,p,b,E){this.test=a,this.ref=s,this.mask=o,this.fail=p,this.depthFail=b,this.pass=E};oe.disabled=new oe({func:519,mask:0},0,0,7680,7680,7680);var xe=function(a,s,o){this.blendFunction=a,this.blendColor=s,this.mask=o};xe.disabled=new xe(xe.Replace=[1,0],l.Color.transparent,[!1,!1,!1,!1]),xe.unblended=new xe(xe.Replace,l.Color.transparent,[!0,!0,!0,!0]),xe.alphaBlended=new xe([1,771],l.Color.transparent,[!0,!0,!0,!0]);var Oe=function(a,s,o){this.enable=a,this.mode=s,this.frontFace=o};Oe.disabled=new Oe(!1,1029,2305),Oe.backCCW=new Oe(!0,1029,2305);var pe=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new qt(this),this.clearDepth=new Pr(this),this.clearStencil=new er(this),this.colorMask=new hr(this),this.depthMask=new Nr(this),this.stencilMask=new $r(this),this.stencilFunc=new C(this),this.stencilOp=new Y(this),this.stencilTest=new Ge(this),this.depthRange=new nt(this),this.depthTest=new xt(this),this.depthFunc=new Dt(this),this.blend=new Z(this),this.blendFunc=new Ze(this),this.blendColor=new Et(this),this.blendEquation=new Mt(this),this.cullFace=new Jt(this),this.cullFaceSide=new Tr(this),this.frontFace=new mr(this),this.program=new Yt(this),this.activeTexture=new gr(this),this.viewport=new sr(this),this.bindFramebuffer=new dr(this),this.bindRenderbuffer=new mn(this),this.bindTexture=new On(this),this.bindVertexBuffer=new mi(this),this.bindElementBuffer=new hi(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new si(this),this.pixelStoreUnpack=new ai(this),this.pixelStoreUnpackPremultiplyAlpha=new Yi(this),this.pixelStoreUnpackFlipY=new Pi(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};pe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},pe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},pe.prototype.createIndexBuffer=function(a,s){return new Le(this,a,s)},pe.prototype.createVertexBuffer=function(a,s,o){return new at(this,a,s,o)},pe.prototype.createRenderbuffer=function(a,s,o){var p=this.gl,b=p.createRenderbuffer();return this.bindRenderbuffer.set(b),p.renderbufferStorage(p.RENDERBUFFER,a,s,o),this.bindRenderbuffer.set(null),b},pe.prototype.createFramebuffer=function(a,s,o){return new _e(this,a,s,o)},pe.prototype.clear=function(a){var s=a.color,o=a.depth,p=this.gl,b=0;s&&(b|=p.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),void 0!==o&&(b|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),p.clear(b)},pe.prototype.setCullFace=function(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))},pe.prototype.setDepthMode=function(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)},pe.prototype.setStencilMode=function(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)},pe.prototype.setColorMode=function(a){l.deepEqual(a.blendFunction,xe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)},pe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ae=function(a){function s(o,p,b){var E=this;a.call(this),this.id=o,this.dispatcher=b,this.on("data",function(A){"source"===A.dataType&&"metadata"===A.sourceDataType&&(E._sourceLoaded=!0),E._sourceLoaded&&!E._paused&&"source"===A.dataType&&"content"===A.sourceDataType&&(E.reload(),E.transform&&E.update(E.transform))}),this.on("error",function(){E._sourceErrored=!0}),this._source=function(A,B,$,he){var Ce=new xr[B.type](A,B,$,he);if(Ce.id!==A)throw new Error("Expected Source id to be "+A+" instead of "+Ce.id);return l.bindAll(["load","abort","unload","serialize","prepare"],Ce),Ce}(o,p,b,this),this._tiles={},this._cache=new Ot(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new l.SourceFeatureState}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var p=this._tiles[o];if("loaded"!==p.state&&"errored"!==p.state)return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,p){return this._source.loadTile(o,p)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var p in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var b=this._tiles[p];b.upload(o),b.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return l.values(this._tiles).map(function(o){return o.tileID}).sort(Tt).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var p=this,b=[];for(var E in this._tiles)this._isIdRenderable(E,o)&&b.push(this._tiles[E]);return o?b.sort(function(A,B){var $=A.tileID,he=B.tileID,Ce=new l.Point($.canonical.x,$.canonical.y)._rotate(p.transform.angle),Me=new l.Point(he.canonical.x,he.canonical.y)._rotate(p.transform.angle);return $.overscaledZ-he.overscaledZ||Me.y-Ce.y||Me.x-Ce.x}).map(function(A){return A.tileID.key}):b.map(function(A){return A.tileID}).sort(Tt).map(function(A){return A.key})},s.prototype.hasRenderableParent=function(o){var p=this.findLoadedParent(o,0);return!!p&&this._isIdRenderable(p.tileID.key)},s.prototype._isIdRenderable=function(o,p){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(p||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,p){var b=this._tiles[o];b&&("loading"!==b.state&&(b.state=p),this._loadTile(b,this._tileLoaded.bind(this,b,o,p)))},s.prototype._tileLoaded=function(o,p,b,E){if(E)return o.state="errored",void(404!==E.status?this._source.fire(new l.ErrorEvent(E,{tile:o})):this.update(this.transform));o.timeAdded=l.browser.now(),"expired"===b&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(p,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new l.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var p=this.getRenderableIds(),b=0;b<p.length;b++){var E=p[b];if(o.neighboringTiles&&o.neighboringTiles[E]){var A=this.getTileByID(E);B(o,A),B(A,o)}}function B($,he){$.needsHillshadePrepare=!0;var Ce=he.tileID.canonical.x-$.tileID.canonical.x,Me=he.tileID.canonical.y-$.tileID.canonical.y,ke=Math.pow(2,$.tileID.canonical.z),et=he.tileID.key;0===Ce&&0===Me||Math.abs(Me)>1||(Math.abs(Ce)>1&&(1===Math.abs(Ce+ke)?Ce+=ke:1===Math.abs(Ce-ke)&&(Ce-=ke)),he.dem&&$.dem&&($.dem.backfillBorder(he.dem,Ce,Me),$.neighboringTiles&&$.neighboringTiles[et]&&($.neighboringTiles[et].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,p,b,E){for(var A in this._tiles){var B=this._tiles[A];if(!(E[A]||!B.hasData()||B.tileID.overscaledZ<=p||B.tileID.overscaledZ>b)){for(var $=B.tileID;B&&B.tileID.overscaledZ>p+1;){var he=B.tileID.scaledTo(B.tileID.overscaledZ-1);(B=this._tiles[he.key])&&B.hasData()&&($=he)}for(var Ce=$;Ce.overscaledZ>p;)if(o[(Ce=Ce.scaledTo(Ce.overscaledZ-1)).key]){E[$.key]=$;break}}}},s.prototype.findLoadedParent=function(o,p){if(o.key in this._loadedParentTiles){var b=this._loadedParentTiles[o.key];return b&&b.tileID.overscaledZ>=p?b:null}for(var E=o.overscaledZ-1;E>=p;E--){var A=o.scaledTo(E),B=this._getLoadedTile(A);if(B)return B}},s.prototype._getLoadedTile=function(o){var p=this._tiles[o.key];return p&&p.hasData()?p:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var p=Math.ceil(o.width/this._source.tileSize)+1,b=Math.ceil(o.height/this._source.tileSize)+1,E=Math.floor(p*b*5),A="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(A)},s.prototype.handleWrapJump=function(o){var p=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,p){var b={};for(var E in this._tiles){var A=this._tiles[E];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+p),b[A.tileID.key]=A}for(var B in this._tiles=b,this._timers)clearTimeout(this._timers[B]),delete this._timers[B];for(var $ in this._tiles)this._setTileReloadTimer($,this._tiles[$])}},s.prototype.update=function(o){var p=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var b;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?b=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Dr){return new l.OverscaledTileID(Dr.canonical.z,Dr.wrap,Dr.canonical.z,Dr.canonical.x,Dr.canonical.y)}):(b=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(b=b.filter(function(Dr){return p._source.hasTile(Dr)}))):b=[];var E=o.coveringZoomLevel(this._source),A=Math.max(E-s.maxOverzooming,this._source.minzoom),B=Math.max(E+s.maxUnderzooming,this._source.minzoom),$=this._updateRetainedTiles(b,E);if(wr(this._source.type)){for(var he={},Ce={},Me=0,ke=Object.keys($);Me<ke.length;Me+=1){var et=ke[Me],$e=$[et],pt=this._tiles[et];if(pt&&!(pt.fadeEndTime&&pt.fadeEndTime<=l.browser.now())){var Ke=this.findLoadedParent($e,A);Ke&&(this._addTile(Ke.tileID),he[Ke.tileID.key]=Ke.tileID),Ce[et]=$e}}for(var ft in this._retainLoadedChildren(Ce,E,B,$),he)$[ft]||(this._coveredTiles[ft]=!0,$[ft]=he[ft])}for(var It in $)this._tiles[It].clearFadeHold();for(var Wt=0,pr=l.keysDifference(this._tiles,$);Wt<pr.length;Wt+=1){var nr=pr[Wt],br=this._tiles[nr];br.hasSymbolBuckets&&!br.holdingForFade()?br.setHoldDuration(this.map._fadeDuration):br.hasSymbolBuckets&&!br.symbolFadeFinished()||this._removeTile(nr)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,p){for(var b={},E={},A=Math.max(p-s.maxOverzooming,this._source.minzoom),B=Math.max(p+s.maxUnderzooming,this._source.minzoom),$={},he=0,Ce=o;he<Ce.length;he+=1){var Me=Ce[he],ke=this._addTile(Me);b[Me.key]=Me,ke.hasData()||p<this._source.maxzoom&&($[Me.key]=Me)}this._retainLoadedChildren($,p,B,b);for(var et=0,$e=o;et<$e.length;et+=1){var pt=$e[et],Ke=this._tiles[pt.key];if(!Ke.hasData()){if(p+1>this._source.maxzoom){var ft=pt.children(this._source.maxzoom)[0],It=this.getTile(ft);if(It&&It.hasData()){b[ft.key]=ft;continue}}else{var Wt=pt.children(this._source.maxzoom);if(b[Wt[0].key]&&b[Wt[1].key]&&b[Wt[2].key]&&b[Wt[3].key])continue}for(var pr=Ke.wasRequested(),nr=pt.overscaledZ-1;nr>=A;--nr){var br=pt.scaledTo(nr);if(E[br.key]||(E[br.key]=!0,!(Ke=this.getTile(br))&&pr&&(Ke=this._addTile(br)),Ke&&(b[br.key]=br,pr=Ke.wasRequested(),Ke.hasData())))break}}}return b},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var p=[],b=void 0,E=this._tiles[o].tileID;E.overscaledZ>0;){if(E.key in this._loadedParentTiles){b=this._loadedParentTiles[E.key];break}p.push(E.key);var A=E.scaledTo(E.overscaledZ-1);if(b=this._getLoadedTile(A))break;E=A}for(var B=0,$=p;B<$.length;B+=1)this._loadedParentTiles[$[B]]=b}},s.prototype._addTile=function(o){var p=this._tiles[o.key];if(p)return p;(p=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,p),p.tileID=o,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,p)));var b=Boolean(p);return b||(p=new l.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(p,this._tileLoaded.bind(this,p,o.key,p.state))),p?(p.uses++,this._tiles[o.key]=p,b||this._source.fire(new l.Event("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p):null},s.prototype._setTileReloadTimer=function(o,p){var b=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var E=p.getExpiryTimeout();E&&(this._timers[o]=setTimeout(function(){b._reloadTile(o,"expired"),delete b._timers[o]},E))},s.prototype._removeTile=function(o){var p=this._tiles[o];p&&(p.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),p.uses>0||(p.hasData()&&"reloading"!==p.state?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,p,b){var E=this,A=[],B=this.transform;if(!B)return A;for(var $=b?B.getCameraQueryGeometry(o):o,he=o.map(function(nr){return B.pointCoordinate(nr)}),Ce=$.map(function(nr){return B.pointCoordinate(nr)}),Me=this.getIds(),ke=1/0,et=1/0,$e=-1/0,pt=-1/0,Ke=0,ft=Ce;Ke<ft.length;Ke+=1){var It=ft[Ke];ke=Math.min(ke,It.x),et=Math.min(et,It.y),$e=Math.max($e,It.x),pt=Math.max(pt,It.y)}for(var Wt=function(nr){var br=E._tiles[Me[nr]];if(!br.holdingForFade()){var Dr=br.tileID,Qr=Math.pow(2,B.zoom-br.tileID.overscaledZ),Xr=p*br.queryPadding*l.EXTENT/br.tileSize/Qr,dn=[Dr.getTilePoint(new l.MercatorCoordinate(ke,et)),Dr.getTilePoint(new l.MercatorCoordinate($e,pt))];if(dn[0].x-Xr<l.EXTENT&&dn[0].y-Xr<l.EXTENT&&dn[1].x+Xr>=0&&dn[1].y+Xr>=0){var qn=he.map(function(Nn){return Dr.getTilePoint(Nn)}),Vn=Ce.map(function(Nn){return Dr.getTilePoint(Nn)});A.push({tile:br,tileID:Dr,queryGeometry:qn,cameraQueryGeometry:Vn,scale:Qr})}}},pr=0;pr<Me.length;pr++)Wt(pr);return A},s.prototype.getVisibleCoordinates=function(o){for(var p=this,b=this.getRenderableIds(o).map(function($){return p._tiles[$].tileID}),E=0,A=b;E<A.length;E+=1){var B=A[E];B.posMatrix=this.transform.calculatePosMatrix(B.toUnwrapped())}return b},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(wr(this._source.type))for(var o in this._tiles){var p=this._tiles[o];if(void 0!==p.fadeEndTime&&p.fadeEndTime>=l.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,p,b){this._state.updateState(o=o||"_geojsonTileLayer",p,b)},s.prototype.removeFeatureState=function(o,p,b){this._state.removeFeatureState(o=o||"_geojsonTileLayer",p,b)},s.prototype.getFeatureState=function(o,p){return this._state.getState(o=o||"_geojsonTileLayer",p)},s.prototype.setDependencies=function(o,p,b){var E=this._tiles[o];E&&E.setDependencies(p,b)},s.prototype.reloadTilesForDependencies=function(o,p){for(var b in this._tiles)this._tiles[b].hasDependency(o,p)&&this._reloadTile(b,"reloading");this._cache.filter(function(E){return!E.hasDependency(o,p)})},s}(l.Evented);function Tt(a,s){var o=Math.abs(2*a.wrap)-+(a.wrap<0),p=Math.abs(2*s.wrap)-+(s.wrap<0);return a.overscaledZ-s.overscaledZ||p-o||s.canonical.y-a.canonical.y||s.canonical.x-a.canonical.x}function wr(a){return"raster"===a||"image"===a||"video"===a}function Kt(){return new l.window.Worker(El.workerUrl)}Ae.maxOverzooming=10,Ae.maxUnderzooming=3;var ar="mapboxgl_preloaded_worker_pool",Br=function(){this.active={}};Br.prototype.acquire=function(a){if(!this.workers)for(this.workers=[];this.workers.length<Br.workerCount;)this.workers.push(new Kt);return this.active[a]=!0,this.workers.slice()},Br.prototype.release=function(a){delete this.active[a],0===this.numActive()&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},Br.prototype.isPreloaded=function(){return!!this.active[ar]},Br.prototype.numActive=function(){return Object.keys(this.active).length};var Rn,Pn=Math.floor(l.browser.hardwareConcurrency/2);function rr(){return Rn||(Rn=new Br),Rn}function Sn(a,s){var o={};for(var p in a)"ref"!==p&&(o[p]=a[p]);return l.refProperties.forEach(function(b){b in s&&(o[b]=s[b])}),o}function an(a){a=a.slice();for(var s=Object.create(null),o=0;o<a.length;o++)s[a[o].id]=a[o];for(var p=0;p<a.length;p++)"ref"in a[p]&&(a[p]=Sn(a[p],s[a[p].ref]));return a}Br.workerCount=Math.max(Math.min(Pn,6),1);var fn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Di(a,s,o){o.push({command:fn.addSource,args:[a,s[a]]})}function _n(a,s,o){s.push({command:fn.removeSource,args:[a]}),o[a]=!0}function Oi(a,s,o,p){_n(a,o,p),Di(a,s,o)}function ta(a,s,o){var p;for(p in a[o])if(a[o].hasOwnProperty(p)&&"data"!==p&&!l.deepEqual(a[o][p],s[o][p]))return!1;for(p in s[o])if(s[o].hasOwnProperty(p)&&"data"!==p&&!l.deepEqual(a[o][p],s[o][p]))return!1;return!0}function oi(a,s,o,p,b,E){var A;for(A in s=s||{},a=a||{})a.hasOwnProperty(A)&&(l.deepEqual(a[A],s[A])||o.push({command:E,args:[p,A,s[A],b]}));for(A in s)s.hasOwnProperty(A)&&!a.hasOwnProperty(A)&&(l.deepEqual(a[A],s[A])||o.push({command:E,args:[p,A,s[A],b]}))}function Ji(a){return a.id}function ji(a,s){return a[s.id]=s,a}var Ti=function(a,s){this.reset(a,s)};Ti.prototype.reset=function(a,s){this.points=a||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ti.prototype.lerp=function(a){if(1===this.points.length)return this.points[0];a=l.clamp(a,0,1);for(var s=1,o=this._distances[s],p=a*this.paddedLength+this.padding;o<p&&s<this._distances.length;)o=this._distances[++s];var b=s-1,E=this._distances[b],A=o-E,B=A>0?(p-E)/A:0;return this.points[b].mult(1-B).add(this.points[s].mult(B))};var _a=function(a,s,o){var p=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(a/o),this.yCellCount=Math.ceil(s/o);for(var E=0;E<this.xCellCount*this.yCellCount;E++)p.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=s,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Ia(a,s,o,p,b){var E=l.create();return s?(l.scale(E,E,[1/b,1/b,1]),o||l.rotateZ(E,E,p.angle)):l.multiply(E,p.labelPlaneMatrix,a),E}function Gi(a,s,o,p,b){if(s){var E=l.clone(a);return l.scale(E,E,[b,b,1]),o||l.rotateZ(E,E,-p.angle),E}return p.glCoordMatrix}function Ni(a,s){var o=[a.x,a.y,0,1];ra(o,o,s);var p=o[3];return{point:new l.Point(o[0]/p,o[1]/p),signedDistanceFromCamera:p}}function Xi(a,s){return.5+a/s*.5}function to(a,s){var o=a[0]/a[3],p=a[1]/a[3];return o>=-s[0]&&o<=s[0]&&p>=-s[1]&&p<=s[1]}function Ho(a,s,o,p,b,E,A,B){var $=p?a.textSizeData:a.iconSizeData,he=l.evaluateSizeForZoom($,o.transform.zoom),Ce=[256/o.width*2+1,256/o.height*2+1],Me=p?a.text.dynamicLayoutVertexArray:a.icon.dynamicLayoutVertexArray;Me.clear();for(var ke=a.lineVertexArray,et=p?a.text.placedSymbolArray:a.icon.placedSymbolArray,$e=o.transform.width/o.transform.height,pt=!1,Ke=0;Ke<et.length;Ke++){var ft=et.get(Ke);if(ft.hidden||ft.writingMode===l.WritingMode.vertical&&!pt)Bi(ft.numGlyphs,Me);else{pt=!1;var It=[ft.anchorX,ft.anchorY,0,1];if(l.transformMat4(It,It,s),to(It,Ce)){var Wt=Xi(o.transform.cameraToCenterDistance,It[3]),pr=l.evaluateSizeForFeature($,he,ft),nr=A?pr/Wt:pr*Wt,br=new l.Point(ft.anchorX,ft.anchorY),Dr=Ni(br,b).point,Qr={},Xr=va(ft,nr,!1,B,s,b,E,a.glyphOffsetArray,ke,Me,Dr,br,Qr,$e);pt=Xr.useVertical,(Xr.notEnoughRoom||pt||Xr.needsFlipping&&va(ft,nr,!0,B,s,b,E,a.glyphOffsetArray,ke,Me,Dr,br,Qr,$e).notEnoughRoom)&&Bi(ft.numGlyphs,Me)}else Bi(ft.numGlyphs,Me)}}p?a.text.dynamicLayoutVertexBuffer.updateData(Me):a.icon.dynamicLayoutVertexBuffer.updateData(Me)}function Za(a,s,o,p,b,E,A,B,$,he,Ce){var Me=B.glyphStartIndex+B.numGlyphs,ke=B.lineStartIndex,et=B.lineStartIndex+B.lineLength,$e=s.getoffsetX(B.glyphStartIndex),pt=s.getoffsetX(Me-1),Ke=Da(a*$e,o,p,b,E,A,B.segment,ke,et,$,he,Ce);if(!Ke)return null;var ft=Da(a*pt,o,p,b,E,A,B.segment,ke,et,$,he,Ce);return ft?{first:Ke,last:ft}:null}function Wi(a,s,o,p){return a===l.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*p?{useVertical:!0}:(a===l.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function va(a,s,o,p,b,E,A,B,$,he,Ce,Me,ke,et){var $e,pt=s/24,Ke=a.lineOffsetX*pt,ft=a.lineOffsetY*pt;if(a.numGlyphs>1){var It=a.glyphStartIndex+a.numGlyphs,Wt=a.lineStartIndex,pr=a.lineStartIndex+a.lineLength,nr=Za(pt,B,Ke,ft,o,Ce,Me,a,$,E,ke);if(!nr)return{notEnoughRoom:!0};var br=Ni(nr.first.point,A).point,Dr=Ni(nr.last.point,A).point;if(p&&!o){var Qr=Wi(a.writingMode,br,Dr,et);if(Qr)return Qr}$e=[nr.first];for(var Xr=a.glyphStartIndex+1;Xr<It-1;Xr++)$e.push(Da(pt*B.getoffsetX(Xr),Ke,ft,o,Ce,Me,a.segment,Wt,pr,$,E,ke));$e.push(nr.last)}else{if(p&&!o){var dn=Ni(Me,b).point,qn=a.lineStartIndex+a.segment+1,Vn=new l.Point($.getx(qn),$.gety(qn)),Nn=Ni(Vn,b),Li=Nn.signedDistanceFromCamera>0?Nn.point:wu(Me,Vn,dn,1,b),Dn=Wi(a.writingMode,dn,Li,et);if(Dn)return Dn}var gi=Da(pt*B.getoffsetX(a.glyphStartIndex),Ke,ft,o,Ce,Me,a.segment,a.lineStartIndex,a.lineStartIndex+a.lineLength,$,E,ke);if(!gi)return{notEnoughRoom:!0};$e=[gi]}for(var Vi=0,li=$e;Vi<li.length;Vi+=1){var yi=li[Vi];l.addDynamicAttributes(he,yi.point,yi.angle)}return{}}function wu(a,s,o,p,b){var E=Ni(a.add(a.sub(s)._unit()),b).point,A=o.sub(E);return o.add(A._mult(p/A.mag()))}function Da(a,s,o,p,b,E,A,B,$,he,Ce,Me){var ke=p?a-s:a+s,et=ke>0?1:-1,$e=0;p&&(et*=-1,$e=Math.PI),et<0&&($e+=Math.PI);for(var pt=et>0?B+A:B+A+1,Ke=b,ft=b,It=0,Wt=0,pr=Math.abs(ke),nr=[];It+Wt<=pr;){if((pt+=et)<B||pt>=$)return null;if(ft=Ke,nr.push(Ke),void 0===(Ke=Me[pt])){var br=new l.Point(he.getx(pt),he.gety(pt)),Dr=Ni(br,Ce);if(Dr.signedDistanceFromCamera>0)Ke=Me[pt]=Dr.point;else{var Qr=pt-et;Ke=wu(0===It?E:new l.Point(he.getx(Qr),he.gety(Qr)),br,ft,pr-It+1,Ce)}}It+=Wt,Wt=ft.dist(Ke)}var Xr=(pr-It)/Wt,dn=Ke.sub(ft),qn=dn.mult(Xr)._add(ft);qn._add(dn._unit()._perp()._mult(o*et));var Vn=$e+Math.atan2(Ke.y-ft.y,Ke.x-ft.x);return nr.push(qn),{point:qn,angle:Vn,path:nr}}_a.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},_a.prototype.insert=function(a,s,o,p,b){this._forEachCell(s,o,p,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(p),this.bboxes.push(b)},_a.prototype.insertCircle=function(a,s,o,p){this._forEachCell(s-p,o-p,s+p,o+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(s),this.circles.push(o),this.circles.push(p)},_a.prototype._insertBoxCell=function(a,s,o,p,b,E){this.boxCells[b].push(E)},_a.prototype._insertCircleCell=function(a,s,o,p,b,E){this.circleCells[b].push(E)},_a.prototype._query=function(a,s,o,p,b,E){if(o<0||a>this.width||p<0||s>this.height)return!b&&[];var A=[];if(a<=0&&s<=0&&this.width<=o&&this.height<=p){if(b)return!0;for(var B=0;B<this.boxKeys.length;B++)A.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(var $=0;$<this.circleKeys.length;$++){var he=this.circles[3*$],Ce=this.circles[3*$+1],Me=this.circles[3*$+2];A.push({key:this.circleKeys[$],x1:he-Me,y1:Ce-Me,x2:he+Me,y2:Ce+Me})}return E?A.filter(E):A}return this._forEachCell(a,s,o,p,this._queryCell,A,{hitTest:b,seenUids:{box:{},circle:{}}},E),b?A.length>0:A},_a.prototype._queryCircle=function(a,s,o,p,b){var E=a-o,A=a+o,B=s-o,$=s+o;if(A<0||E>this.width||$<0||B>this.height)return!p&&[];var he=[];return this._forEachCell(E,B,A,$,this._queryCellCircle,he,{hitTest:p,circle:{x:a,y:s,radius:o},seenUids:{box:{},circle:{}}},b),p?he.length>0:he},_a.prototype.query=function(a,s,o,p,b){return this._query(a,s,o,p,!1,b)},_a.prototype.hitTest=function(a,s,o,p,b){return this._query(a,s,o,p,!0,b)},_a.prototype.hitTestCircle=function(a,s,o,p){return this._queryCircle(a,s,o,!0,p)},_a.prototype._queryCell=function(a,s,o,p,b,E,A,B){var $=A.seenUids,he=this.boxCells[b];if(null!==he)for(var Ce=this.bboxes,Me=0,ke=he;Me<ke.length;Me+=1){var et=ke[Me];if(!$.box[et]){$.box[et]=!0;var $e=4*et;if(a<=Ce[$e+2]&&s<=Ce[$e+3]&&o>=Ce[$e+0]&&p>=Ce[$e+1]&&(!B||B(this.boxKeys[et]))){if(A.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[et],x1:Ce[$e],y1:Ce[$e+1],x2:Ce[$e+2],y2:Ce[$e+3]})}}}var pt=this.circleCells[b];if(null!==pt)for(var Ke=this.circles,ft=0,It=pt;ft<It.length;ft+=1){var Wt=It[ft];if(!$.circle[Wt]){$.circle[Wt]=!0;var pr=3*Wt;if(this._circleAndRectCollide(Ke[pr],Ke[pr+1],Ke[pr+2],a,s,o,p)&&(!B||B(this.circleKeys[Wt]))){if(A.hitTest)return E.push(!0),!0;var nr=Ke[pr],br=Ke[pr+1],Dr=Ke[pr+2];E.push({key:this.circleKeys[Wt],x1:nr-Dr,y1:br-Dr,x2:nr+Dr,y2:br+Dr})}}}},_a.prototype._queryCellCircle=function(a,s,o,p,b,E,A,B){var $=A.circle,he=A.seenUids,Ce=this.boxCells[b];if(null!==Ce)for(var Me=this.bboxes,ke=0,et=Ce;ke<et.length;ke+=1){var $e=et[ke];if(!he.box[$e]){he.box[$e]=!0;var pt=4*$e;if(this._circleAndRectCollide($.x,$.y,$.radius,Me[pt+0],Me[pt+1],Me[pt+2],Me[pt+3])&&(!B||B(this.boxKeys[$e])))return E.push(!0),!0}}var Ke=this.circleCells[b];if(null!==Ke)for(var ft=this.circles,It=0,Wt=Ke;It<Wt.length;It+=1){var pr=Wt[It];if(!he.circle[pr]){he.circle[pr]=!0;var nr=3*pr;if(this._circlesCollide(ft[nr],ft[nr+1],ft[nr+2],$.x,$.y,$.radius)&&(!B||B(this.circleKeys[pr])))return E.push(!0),!0}}},_a.prototype._forEachCell=function(a,s,o,p,b,E,A,B){for(var $=this._convertToXCellCoord(a),he=this._convertToYCellCoord(s),Ce=this._convertToXCellCoord(o),Me=this._convertToYCellCoord(p),ke=$;ke<=Ce;ke++)for(var et=he;et<=Me;et++)if(b.call(this,a,s,o,p,this.xCellCount*et+ke,E,A,B))return},_a.prototype._convertToXCellCoord=function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))},_a.prototype._convertToYCellCoord=function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))},_a.prototype._circlesCollide=function(a,s,o,p,b,E){var A=p-a,B=b-s,$=o+E;return $*$>A*A+B*B},_a.prototype._circleAndRectCollide=function(a,s,o,p,b,E,A){var B=(E-p)/2,$=Math.abs(a-(p+B));if($>B+o)return!1;var he=(A-b)/2,Ce=Math.abs(s-(b+he));if(Ce>he+o)return!1;if($<=B||Ce<=he)return!0;var Me=$-B,ke=Ce-he;return Me*Me+ke*ke<=o*o};var qo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Bi(a,s){for(var o=0;o<a;o++){var p=s.length;s.resize(p+4),s.float32.set(qo,3*p)}}function ra(a,s,o){var p=s[0],b=s[1];return a[0]=o[0]*p+o[4]*b+o[12],a[1]=o[1]*p+o[5]*b+o[13],a[3]=o[3]*p+o[7]*b+o[15],a}var bo=function(a,s,o){void 0===s&&(s=new _a(a.width+200,a.height+200,25)),void 0===o&&(o=new _a(a.width+200,a.height+200,25)),this.transform=a,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function ma(a,s,o){return s*(l.EXTENT/(a.tileSize*Math.pow(2,o-a.tileID.overscaledZ)))}bo.prototype.placeCollisionBox=function(a,s,o,p,b){var E=this.projectAndGetPerspectiveRatio(p,a.anchorPointX,a.anchorPointY),A=o*E.perspectiveRatio,B=a.x1*A+E.point.x,$=a.y1*A+E.point.y,he=a.x2*A+E.point.x,Ce=a.y2*A+E.point.y;return!this.isInsideGrid(B,$,he,Ce)||!s&&this.grid.hitTest(B,$,he,Ce,b)?{box:[],offscreen:!1}:{box:[B,$,he,Ce],offscreen:this.isOffscreen(B,$,he,Ce)}},bo.prototype.placeCollisionCircles=function(a,s,o,p,b,E,A,B,$,he,Ce,Me,ke){var et=[],$e=new l.Point(s.anchorX,s.anchorY),pt=Ni($e,E),Ke=Xi(this.transform.cameraToCenterDistance,pt.signedDistanceFromCamera),ft=(he?b/Ke:b*Ke)/l.ONE_EM,It=Ni($e,A).point,Wt=Za(ft,p,s.lineOffsetX*ft,s.lineOffsetY*ft,!1,It,$e,s,o,A,{}),pr=!1,nr=!1,br=!0;if(Wt){for(var Dr=.5*Me*Ke+ke,Qr=new l.Point(-100,-100),Xr=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),dn=new Ti,qn=Wt.first,Vn=Wt.last,Nn=[],Li=qn.path.length-1;Li>=1;Li--)Nn.push(qn.path[Li]);for(var Dn=1;Dn<Vn.path.length;Dn++)Nn.push(Vn.path[Dn]);var gi=2.5*Dr;if(B){var Vi=Nn.map(function(ni){return Ni(ni,B)});Nn=Vi.some(function(ni){return ni.signedDistanceFromCamera<=0})?[]:Vi.map(function(ni){return ni.point})}var li=[];if(Nn.length>0){for(var yi=Nn[0].clone(),Fi=Nn[0].clone(),te=1;te<Nn.length;te++)yi.x=Math.min(yi.x,Nn[te].x),yi.y=Math.min(yi.y,Nn[te].y),Fi.x=Math.max(Fi.x,Nn[te].x),Fi.y=Math.max(Fi.y,Nn[te].y);li=yi.x>=Qr.x&&Fi.x<=Xr.x&&yi.y>=Qr.y&&Fi.y<=Xr.y?[Nn]:Fi.x<Qr.x||yi.x>Xr.x||Fi.y<Qr.y||yi.y>Xr.y?[]:l.clipLine([Nn],Qr.x,Qr.y,Xr.x,Xr.y)}for(var ie=0,F=li;ie<F.length;ie+=1){var U;dn.reset(F[ie],.25*Dr),U=dn.length<=.5*Dr?1:Math.ceil(dn.paddedLength/gi)+1;for(var de=0;de<U;de++){var Te=de/Math.max(U-1,1),mt=dn.lerp(Te),Nt=mt.x+100,Lt=mt.y+100;et.push(Nt,Lt,Dr,0);var lr=Nt-Dr,jr=Lt-Dr,Ln=Nt+Dr,Xn=Lt+Dr;if(br=br&&this.isOffscreen(lr,jr,Ln,Xn),nr=nr||this.isInsideGrid(lr,jr,Ln,Xn),!a&&this.grid.hitTestCircle(Nt,Lt,Dr,Ce)&&(pr=!0,!$))return{circles:[],offscreen:!1,collisionDetected:pr}}}}return{circles:!$&&pr||!nr?[]:et,offscreen:br,collisionDetected:pr}},bo.prototype.queryRenderedSymbols=function(a){if(0===a.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var s=[],o=1/0,p=1/0,b=-1/0,E=-1/0,A=0,B=a;A<B.length;A+=1){var $=B[A],he=new l.Point($.x+100,$.y+100);o=Math.min(o,he.x),p=Math.min(p,he.y),b=Math.max(b,he.x),E=Math.max(E,he.y),s.push(he)}for(var Ce={},Me={},ke=0,et=this.grid.query(o,p,b,E).concat(this.ignoredGrid.query(o,p,b,E));ke<et.length;ke+=1){var $e=et[ke],pt=$e.key;if(void 0===Ce[pt.bucketInstanceId]&&(Ce[pt.bucketInstanceId]={}),!Ce[pt.bucketInstanceId][pt.featureIndex]){var Ke=[new l.Point($e.x1,$e.y1),new l.Point($e.x2,$e.y1),new l.Point($e.x2,$e.y2),new l.Point($e.x1,$e.y2)];l.polygonIntersectsPolygon(s,Ke)&&(Ce[pt.bucketInstanceId][pt.featureIndex]=!0,void 0===Me[pt.bucketInstanceId]&&(Me[pt.bucketInstanceId]=[]),Me[pt.bucketInstanceId].push(pt.featureIndex))}}return Me},bo.prototype.insertCollisionBox=function(a,s,o,p,b){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:p,collisionGroupID:b},a[0],a[1],a[2],a[3])},bo.prototype.insertCollisionCircles=function(a,s,o,p,b){for(var E=s?this.ignoredGrid:this.grid,A={bucketInstanceId:o,featureIndex:p,collisionGroupID:b},B=0;B<a.length;B+=4)E.insertCircle(A,a[B],a[B+1],a[B+2])},bo.prototype.projectAndGetPerspectiveRatio=function(a,s,o){var p=[s,o,0,1];return ra(p,p,a),{point:new l.Point((p[0]/p[3]+1)/2*this.transform.width+100,(-p[1]/p[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/p[3]*.5}},bo.prototype.isOffscreen=function(a,s,o,p){return o<100||a>=this.screenRightBoundary||p<100||s>this.screenBottomBoundary},bo.prototype.isInsideGrid=function(a,s,o,p){return o>=0&&a<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary},bo.prototype.getViewportMatrix=function(){var a=l.identity([]);return l.translate(a,a,[-100,-100,0]),a};var vo=function(a,s,o,p){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?s:-s))):p&&o?1:0,this.placed=o};vo.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var Fo=function(a,s,o,p,b){this.text=new vo(a?a.text:null,s,o,b),this.icon=new vo(a?a.icon:null,s,p,b)};Fo.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ls=function(a,s,o){this.text=a,this.icon=s,this.skipFade=o},aa=function(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]},Jo=function(a,s,o,p,b){this.bucketInstanceId=a,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=p,this.tileID=b},Ma=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function Ya(a,s,o,p,b){var E=l.getAnchorAlignment(a),A=-(E.horizontalAlign-.5)*s,B=-(E.verticalAlign-.5)*o,$=l.evaluateVariableOffset(a,p);return new l.Point(A+$[0]*b,B+$[1]*b)}function $o(a,s,o,p,b,E){var A=a.x1,B=a.x2,$=a.y1,he=a.y2,Ce=a.anchorPointX,Me=a.anchorPointY,ke=new l.Point(s,o);return p&&ke._rotate(b?E:-E),{x1:A+ke.x,y1:$+ke.y,x2:B+ke.x,y2:he+ke.y,anchorPointX:Ce,anchorPointY:Me}}Ma.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var s=++this.maxGroupID;this.collisionGroups[a]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[a]};var Na=function(a,s,o,p){this.transform=a.clone(),this.collisionIndex=new bo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Ma(o),this.collisionCircleArrays={},this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}};function Ee(a,s,o,p,b){a.emplaceBack(s?1:0,o?1:0,p||0,b||0),a.emplaceBack(s?1:0,o?1:0,p||0,b||0),a.emplaceBack(s?1:0,o?1:0,p||0,b||0),a.emplaceBack(s?1:0,o?1:0,p||0,b||0)}Na.prototype.getBucketParts=function(a,s,o,p){var b=o.getBucket(s),E=o.latestFeatureIndex;if(b&&E&&s.id===b.layerIds[0]){var A=o.collisionBoxArray,B=b.layers[0].layout,$=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),he=o.tileSize/l.EXTENT,Ce=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),Me="map"===B.get("text-pitch-alignment"),ke="map"===B.get("text-rotation-alignment"),et=ma(o,1,this.transform.zoom),$e=Ia(Ce,Me,ke,this.transform,et),pt=null;if(Me){var Ke=Gi(Ce,Me,ke,this.transform,et);pt=l.multiply([],this.transform.labelPlaneMatrix,Ke)}this.retainedQueryData[b.bucketInstanceId]=new Jo(b.bucketInstanceId,E,b.sourceLayerIndex,b.index,o.tileID);var ft={bucket:b,layout:B,posMatrix:Ce,textLabelPlaneMatrix:$e,labelToScreenMatrix:pt,scale:$,textPixelRatio:he,holdingForFade:o.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(p)for(var It=0,Wt=b.sortKeyRanges;It<Wt.length;It+=1){var pr=Wt[It];a.push({sortKey:pr.sortKey,symbolInstanceStart:pr.symbolInstanceStart,symbolInstanceEnd:pr.symbolInstanceEnd,parameters:ft})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:ft})}},Na.prototype.attemptAnchorPlacement=function(a,s,o,p,b,E,A,B,$,he,Ce,Me,ke,et,$e){var pt,Ke=[Me.textOffset0,Me.textOffset1],ft=Ya(a,o,p,Ke,b),It=this.collisionIndex.placeCollisionBox($o(s,ft.x,ft.y,E,A,this.transform.angle),Ce,B,$,he.predicate);if(!$e||0!==this.collisionIndex.placeCollisionBox($o($e,ft.x,ft.y,E,A,this.transform.angle),Ce,B,$,he.predicate).box.length)return It.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Me.crossTileID]&&this.prevPlacement.placements[Me.crossTileID]&&this.prevPlacement.placements[Me.crossTileID].text&&(pt=this.prevPlacement.variableOffsets[Me.crossTileID].anchor),this.variableOffsets[Me.crossTileID]={textOffset:Ke,width:o,height:p,anchor:a,textBoxScale:b,prevAnchor:pt},this.markUsedJustification(ke,a,Me,et),ke.allowVerticalPlacement&&(this.markUsedOrientation(ke,et,Me),this.placedOrientations[Me.crossTileID]=et),{shift:ft,placedGlyphBoxes:It}):void 0},Na.prototype.placeLayerBucketPart=function(a,s,o){var p=this,b=a.parameters,E=b.bucket,A=b.layout,B=b.posMatrix,$=b.textLabelPlaneMatrix,he=b.labelToScreenMatrix,Ce=b.textPixelRatio,Me=b.holdingForFade,ke=b.collisionBoxArray,et=b.partiallyEvaluatedTextSize,$e=b.collisionGroup,pt=A.get("text-optional"),Ke=A.get("icon-optional"),ft=A.get("text-allow-overlap"),It=A.get("icon-allow-overlap"),Wt="map"===A.get("text-rotation-alignment"),pr="map"===A.get("text-pitch-alignment"),nr="none"!==A.get("icon-text-fit"),br="viewport-y"===A.get("symbol-z-order"),Dr=ft&&(It||!E.hasIconData()||Ke),Qr=It&&(ft||!E.hasTextData()||pt);!E.collisionArrays&&ke&&E.deserializeCollisionBoxes(ke);var Xr=function(Dn,gi){if(!s[Dn.crossTileID])if(Me)p.placements[Dn.crossTileID]=new Ls(!1,!1,!1);else{var Vi,li=!1,yi=!1,Fi=!0,te=null,ie={box:null,offscreen:null},F={box:null,offscreen:null},U=null,de=null,Te=0,mt=0,Nt=0;gi.textFeatureIndex?Te=gi.textFeatureIndex:Dn.useRuntimeCollisionCircles&&(Te=Dn.featureIndex),gi.verticalTextFeatureIndex&&(mt=gi.verticalTextFeatureIndex);var Lt=gi.textBox;if(Lt){var lr=function(ki){var Ca=l.WritingMode.horizontal;if(E.allowVerticalPlacement&&!ki&&p.prevPlacement){var ba=p.prevPlacement.placedOrientations[Dn.crossTileID];ba&&(p.placedOrientations[Dn.crossTileID]=ba,p.markUsedOrientation(E,Ca=ba,Dn))}return Ca},jr=function(ki,Ca){if(E.allowVerticalPlacement&&Dn.numVerticalGlyphVertices>0&&gi.verticalTextBox)for(var ba=0,go=E.writingModes;ba<go.length&&(go[ba]===l.WritingMode.vertical?(ie=Ca(),F=ie):ie=ki(),!(ie&&ie.box&&ie.box.length));ba+=1);else ie=ki()};if(A.get("text-variable-anchor")){var Ln=A.get("text-variable-anchor");if(p.prevPlacement&&p.prevPlacement.variableOffsets[Dn.crossTileID]){var Xn=p.prevPlacement.variableOffsets[Dn.crossTileID];Ln.indexOf(Xn.anchor)>0&&(Ln=Ln.filter(function(ki){return ki!==Xn.anchor})).unshift(Xn.anchor)}var ni=function(ki,Ca,ba){for(var go=ki.x2-ki.x1,Yl=ki.y2-ki.y1,uu=Dn.textBoxScale,Ko=nr&&!It?Ca:null,Su={box:[],offscreen:!1},Hu=ft?2*Ln.length:Ln.length,ul=0;ul<Hu;++ul){var Ys=p.attemptAnchorPlacement(Ln[ul%Ln.length],ki,go,Yl,uu,Wt,pr,Ce,B,$e,ul>=Ln.length,Dn,E,ba,Ko);if(Ys&&(Su=Ys.placedGlyphBoxes)&&Su.box&&Su.box.length){li=!0,te=Ys.shift;break}}return Su};jr(function(){return ni(Lt,gi.iconBox,l.WritingMode.horizontal)},function(){var ki=gi.verticalTextBox;return E.allowVerticalPlacement&&!(ie&&ie.box&&ie.box.length)&&Dn.numVerticalGlyphVertices>0&&ki?ni(ki,gi.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),ie&&(li=ie.box,Fi=ie.offscreen);var Ci=lr(ie&&ie.box);if(!li&&p.prevPlacement){var Si=p.prevPlacement.variableOffsets[Dn.crossTileID];Si&&(p.variableOffsets[Dn.crossTileID]=Si,p.markUsedJustification(E,Si.anchor,Dn,Ci))}}else{var ea=function(ki,Ca){var ba=p.collisionIndex.placeCollisionBox(ki,ft,Ce,B,$e.predicate);return ba&&ba.box&&ba.box.length&&(p.markUsedOrientation(E,Ca,Dn),p.placedOrientations[Dn.crossTileID]=Ca),ba};jr(function(){return ea(Lt,l.WritingMode.horizontal)},function(){var ki=gi.verticalTextBox;return E.allowVerticalPlacement&&Dn.numVerticalGlyphVertices>0&&ki?ea(ki,l.WritingMode.vertical):{box:null,offscreen:null}}),lr(ie&&ie.box&&ie.box.length)}}if(li=(Vi=ie)&&Vi.box&&Vi.box.length>0,Fi=Vi&&Vi.offscreen,Dn.useRuntimeCollisionCircles){var xa=E.text.placedSymbolArray.get(Dn.centerJustifiedTextSymbolIndex),ua=l.evaluateSizeForFeature(E.textSizeData,et,xa),Ha=A.get("text-padding");U=p.collisionIndex.placeCollisionCircles(ft,xa,E.lineVertexArray,E.glyphOffsetArray,ua,B,$,he,o,pr,$e.predicate,Dn.collisionCircleDiameter,Ha),li=ft||U.circles.length>0&&!U.collisionDetected,Fi=Fi&&U.offscreen}if(gi.iconFeatureIndex&&(Nt=gi.iconFeatureIndex),gi.iconBox){var Wa=function(ki){var Ca=nr&&te?$o(ki,te.x,te.y,Wt,pr,p.transform.angle):ki;return p.collisionIndex.placeCollisionBox(Ca,It,Ce,B,$e.predicate)};yi=F&&F.box&&F.box.length&&gi.verticalIconBox?(de=Wa(gi.verticalIconBox)).box.length>0:(de=Wa(gi.iconBox)).box.length>0,Fi=Fi&&de.offscreen}var Ka=pt||0===Dn.numHorizontalGlyphVertices&&0===Dn.numVerticalGlyphVertices,ia=Ke||0===Dn.numIconVertices;if(Ka||ia?ia?Ka||(yi=yi&&li):li=yi&&li:yi=li=yi&&li,li&&Vi&&Vi.box&&p.collisionIndex.insertCollisionBox(Vi.box,A.get("text-ignore-placement"),E.bucketInstanceId,F&&F.box&&mt?mt:Te,$e.ID),yi&&de&&p.collisionIndex.insertCollisionBox(de.box,A.get("icon-ignore-placement"),E.bucketInstanceId,Nt,$e.ID),U&&(li&&p.collisionIndex.insertCollisionCircles(U.circles,A.get("text-ignore-placement"),E.bucketInstanceId,Te,$e.ID),o)){var ga=E.bucketInstanceId,la=p.collisionCircleArrays[ga];void 0===la&&(la=p.collisionCircleArrays[ga]=new aa);for(var no=0;no<U.circles.length;no+=4)la.circles.push(U.circles[no+0]),la.circles.push(U.circles[no+1]),la.circles.push(U.circles[no+2]),la.circles.push(U.collisionDetected?1:0)}p.placements[Dn.crossTileID]=new Ls(li||Dr,yi||Qr,Fi||E.justReloaded),s[Dn.crossTileID]=!0}};if(br)for(var dn=E.getSortedSymbolIndexes(this.transform.angle),qn=dn.length-1;qn>=0;--qn){var Vn=dn[qn];Xr(E.symbolInstances.get(Vn),E.collisionArrays[Vn])}else for(var Nn=a.symbolInstanceStart;Nn<a.symbolInstanceEnd;Nn++)Xr(E.symbolInstances.get(Nn),E.collisionArrays[Nn]);if(o&&E.bucketInstanceId in this.collisionCircleArrays){var Li=this.collisionCircleArrays[E.bucketInstanceId];l.invert(Li.invProjMatrix,B),Li.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1},Na.prototype.markUsedJustification=function(a,s,o,p){var b;b=p===l.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(s)];for(var E=0,A=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];E<A.length;E+=1){var B=A[E];B>=0&&(a.text.placedSymbolArray.get(B).crossTileID=b>=0&&B!==b?0:o.crossTileID)}},Na.prototype.markUsedOrientation=function(a,s,o){for(var p=s===l.WritingMode.horizontal||s===l.WritingMode.horizontalOnly?s:0,b=s===l.WritingMode.vertical?s:0,E=0,A=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];E<A.length;E+=1)a.text.placedSymbolArray.get(A[E]).placedOrientation=p;o.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=b)},Na.prototype.commit=function(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var p=s?s.symbolFadeChange(a):1,b=s?s.opacities:{},E=s?s.variableOffsets:{},A=s?s.placedOrientations:{};for(var B in this.placements){var $=this.placements[B],he=b[B];he?(this.opacities[B]=new Fo(he,p,$.text,$.icon),o=o||$.text!==he.text.placed||$.icon!==he.icon.placed):(this.opacities[B]=new Fo(null,p,$.text,$.icon,$.skipFade),o=o||$.text||$.icon)}for(var Ce in b){var Me=b[Ce];if(!this.opacities[Ce]){var ke=new Fo(Me,p,!1,!1);ke.isHidden()||(this.opacities[Ce]=ke,o=o||Me.text.placed||Me.icon.placed)}}for(var et in E)this.variableOffsets[et]||!this.opacities[et]||this.opacities[et].isHidden()||(this.variableOffsets[et]=E[et]);for(var $e in A)this.placedOrientations[$e]||!this.opacities[$e]||this.opacities[$e].isHidden()||(this.placedOrientations[$e]=A[$e]);o?this.lastPlacementChangeTime=a:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:a)},Na.prototype.updateLayerOpacities=function(a,s){for(var o={},p=0,b=s;p<b.length;p+=1){var E=b[p],A=E.getBucket(a);A&&E.latestFeatureIndex&&a.id===A.layerIds[0]&&this.updateBucketOpacities(A,o,E.collisionBoxArray)}},Na.prototype.updateBucketOpacities=function(a,s,o){var p=this;a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();var b=a.layers[0].layout,E=new Fo(null,0,!1,!1,!0),A=b.get("text-allow-overlap"),B=b.get("icon-allow-overlap"),$=b.get("text-variable-anchor"),he="map"===b.get("text-rotation-alignment"),Ce="map"===b.get("text-pitch-alignment"),Me="none"!==b.get("icon-text-fit"),ke=new Fo(null,0,A&&(B||!a.hasIconData()||b.get("icon-optional")),B&&(A||!a.hasTextData()||b.get("text-optional")),!0);!a.collisionArrays&&o&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(o);for(var et=function(ft,It,Wt){for(var pr=0;pr<It/4;pr++)ft.opacityVertexArray.emplaceBack(Wt)},$e=function(ft){var It=a.symbolInstances.get(ft),Wt=It.numHorizontalGlyphVertices,pr=It.numVerticalGlyphVertices,nr=It.crossTileID,br=p.opacities[nr];s[nr]?br=E:br||(p.opacities[nr]=br=ke),s[nr]=!0;var Dr=It.numIconVertices>0,Qr=p.placedOrientations[It.crossTileID],Xr=Qr===l.WritingMode.vertical,dn=Qr===l.WritingMode.horizontal||Qr===l.WritingMode.horizontalOnly;if(Wt>0||pr>0){var qn=ro(br.text);et(a.text,Wt,Xr?co:qn),et(a.text,pr,dn?co:qn);var Vn=br.text.isHidden();[It.rightJustifiedTextSymbolIndex,It.centerJustifiedTextSymbolIndex,It.leftJustifiedTextSymbolIndex].forEach(function(ie){ie>=0&&(a.text.placedSymbolArray.get(ie).hidden=Vn||Xr?1:0)}),It.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(It.verticalPlacedTextSymbolIndex).hidden=Vn||dn?1:0);var Nn=p.variableOffsets[It.crossTileID];Nn&&p.markUsedJustification(a,Nn.anchor,It,Qr);var Li=p.placedOrientations[It.crossTileID];Li&&(p.markUsedJustification(a,"left",It,Li),p.markUsedOrientation(a,Li,It))}if(Dr){var Dn=ro(br.icon),gi=!(Me&&It.verticalPlacedIconSymbolIndex&&Xr);It.placedIconSymbolIndex>=0&&(et(a.icon,It.numIconVertices,gi?Dn:co),a.icon.placedSymbolArray.get(It.placedIconSymbolIndex).hidden=br.icon.isHidden()),It.verticalPlacedIconSymbolIndex>=0&&(et(a.icon,It.numVerticalIconVertices,gi?co:Dn),a.icon.placedSymbolArray.get(It.verticalPlacedIconSymbolIndex).hidden=br.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){var Vi=a.collisionArrays[ft];if(Vi){var li=new l.Point(0,0);if(Vi.textBox||Vi.verticalTextBox){var yi=!0;if($){var Fi=p.variableOffsets[nr];Fi?(li=Ya(Fi.anchor,Fi.width,Fi.height,Fi.textOffset,Fi.textBoxScale),he&&li._rotate(Ce?p.transform.angle:-p.transform.angle)):yi=!1}Vi.textBox&&Ee(a.textCollisionBox.collisionVertexArray,br.text.placed,!yi||Xr,li.x,li.y),Vi.verticalTextBox&&Ee(a.textCollisionBox.collisionVertexArray,br.text.placed,!yi||dn,li.x,li.y)}var te=Boolean(!dn&&Vi.verticalIconBox);Vi.iconBox&&Ee(a.iconCollisionBox.collisionVertexArray,br.icon.placed,te,Me?li.x:0,Me?li.y:0),Vi.verticalIconBox&&Ee(a.iconCollisionBox.collisionVertexArray,br.icon.placed,!te,Me?li.x:0,Me?li.y:0)}}},pt=0;pt<a.symbolInstances.length;pt++)$e(pt);if(a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){var Ke=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=Ke.invProjMatrix,a.placementViewportMatrix=Ke.viewportMatrix,a.collisionCircleArray=Ke.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}},Na.prototype.symbolFadeChange=function(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Na.prototype.zoomAdjustment=function(a){return Math.max(0,(this.transform.zoom-a)/1.5)},Na.prototype.hasTransitions=function(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration},Na.prototype.stillRecent=function(a,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>a},Na.prototype.setStale=function(){this.stale=!0};var Ve=Math.pow(2,25),St=Math.pow(2,24),or=Math.pow(2,17),Yr=Math.pow(2,16),$n=Math.pow(2,9),xi=Math.pow(2,8),lo=Math.pow(2,1);function ro(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var s=a.placed?1:0,o=Math.floor(127*a.opacity);return o*Ve+s*St+o*or+s*Yr+o*$n+s*xi+o*lo+s}var co=0,ps=function(a){this._sortAcrossTiles="viewport-y"!==a.layout.get("symbol-z-order")&&void 0!==a.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ps.prototype.continuePlacement=function(a,s,o,p,b){for(var E=this._bucketParts;this._currentTileIndex<a.length;)if(s.getBucketParts(E,p,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort(function(A,B){return A.sortKey-B.sortKey}));this._currentPartIndex<E.length;)if(s.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,b())return!0;return!1};var du=function(a,s,o,p,b,E,A){this.placement=new Na(a,b,E,A),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=p,this._done=!1};du.prototype.isDone=function(){return this._done},du.prototype.continuePlacement=function(a,s,o){for(var p=this,b=l.browser.now(),E=function(){var $=l.browser.now()-b;return!p._forceFullPlacement&&$>2};this._currentPlacementIndex>=0;){var A=s[a[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if("symbol"===A.type&&(!A.minzoom||A.minzoom<=B)&&(!A.maxzoom||A.maxzoom>B)){if(this._inProgressLayer||(this._inProgressLayer=new ps(A)),this._inProgressLayer.continuePlacement(o[A.source],this.placement,this._showCollisionBoxes,A,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},du.prototype.commit=function(a){return this.placement.commit(a),this.placement};var Eu=512/l.EXTENT/2,fl=function(a,s,o){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var p=0;p<s.length;p++){var b=s.get(p),E=b.key;this.indexedSymbolInstances[E]||(this.indexedSymbolInstances[E]=[]),this.indexedSymbolInstances[E].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,a)})}};fl.prototype.getScaledCoordinates=function(a,s){var o=Eu/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*l.EXTENT+a.anchorX)*o),y:Math.floor((s.canonical.y*l.EXTENT+a.anchorY)*o)}},fl.prototype.findMatches=function(a,s,o){for(var p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),b=0;b<a.length;b++){var E=a.get(b);if(!E.crossTileID){var A=this.indexedSymbolInstances[E.key];if(A)for(var B=this.getScaledCoordinates(E,s),$=0,he=A;$<he.length;$+=1){var Ce=he[$];if(Math.abs(Ce.coord.x-B.x)<=p&&Math.abs(Ce.coord.y-B.y)<=p&&!o[Ce.crossTileID]){o[Ce.crossTileID]=!0,E.crossTileID=Ce.crossTileID;break}}}}};var Wo=function(){this.maxCrossTileID=0};Wo.prototype.generate=function(){return++this.maxCrossTileID};var Qo=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Qo.prototype.handleWrapJump=function(a){var s=Math.round((a-this.lng)/360);if(0!==s)for(var o in this.indexes){var p=this.indexes[o],b={};for(var E in p){var A=p[E];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+s),b[A.tileID.key]=A}this.indexes[o]=b}this.lng=a},Qo.prototype.addBucket=function(a,s,o){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(var p=0;p<s.symbolInstances.length;p++)s.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});var b=this.usedCrossTileIDs[a.overscaledZ];for(var E in this.indexes){var A=this.indexes[E];if(Number(E)>a.overscaledZ)for(var B in A){var $=A[B];$.tileID.isChildOf(a)&&$.findMatches(s.symbolInstances,a,b)}else{var he=A[a.scaledTo(Number(E)).key];he&&he.findMatches(s.symbolInstances,a,b)}}for(var Ce=0;Ce<s.symbolInstances.length;Ce++){var Me=s.symbolInstances.get(Ce);Me.crossTileID||(Me.crossTileID=o.generate(),b[Me.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new fl(a,s.symbolInstances,s.bucketInstanceId),!0},Qo.prototype.removeBucketCrossTileIDs=function(a,s){for(var o in s.indexedSymbolInstances)for(var p=0,b=s.indexedSymbolInstances[o];p<b.length;p+=1)delete this.usedCrossTileIDs[a][b[p].crossTileID]},Qo.prototype.removeStaleBuckets=function(a){var s=!1;for(var o in this.indexes){var p=this.indexes[o];for(var b in p)a[p[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,p[b]),delete p[b],s=!0)}return s};var Lo=function(){this.layerIndexes={},this.crossTileIDs=new Wo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Lo.prototype.addLayer=function(a,s,o){var p=this.layerIndexes[a.id];void 0===p&&(p=this.layerIndexes[a.id]=new Qo);var b=!1,E={};p.handleWrapJump(o);for(var A=0,B=s;A<B.length;A+=1){var $=B[A],he=$.getBucket(a);he&&a.id===he.layerIds[0]&&(he.bucketInstanceId||(he.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket($.tileID,he,this.crossTileIDs)&&(b=!0),E[he.bucketInstanceId]=!0)}return p.removeStaleBuckets(E)&&(b=!0),b},Lo.prototype.pruneUnusedLayers=function(a){var s={};for(var o in a.forEach(function(p){s[p]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var es=function(a,s){return l.emitValidationErrors(a,s&&s.filter(function(o){return"source.canvas"!==o.identifier}))},ts=l.pick(fn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ks=l.pick(fn,["setCenter","setZoom","setBearing","setPitch"]),Qs=function(){var a={},s=l.styleSpec.$version;for(var o in l.styleSpec.$root){var p,b=l.styleSpec.$root[o];b.required&&null!=(p="version"===o?s:"array"===b.type?[]:{})&&(a[o]=p)}return a}(),gs=function(a){function s(o,p){var b=this;void 0===p&&(p={}),a.call(this),this.map=o,this.dispatcher=new Pt(rr(),this),this.imageManager=new _t,this.imageManager.setEventedParent(this),this.glyphManager=new Ut(o._requestManager,p.localIdeographFontFamily),this.lineAtlas=new Xe(256,512),this.crossTileSymbolIndex=new Lo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());var E=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(A){E.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:A.pluginStatus,pluginURL:A.pluginURL},function(B,$){if(l.triggerPluginCompletionEvent(B),$&&$.every(function(Ce){return Ce}))for(var he in E.sourceCaches)E.sourceCaches[he].reload()})}),this.on("data",function(A){if("source"===A.dataType&&"metadata"===A.sourceDataType){var B=b.sourceCaches[A.sourceId];if(B){var $=B.getSource();if($&&$.vectorLayerIds)for(var he in b._layers){var Ce=b._layers[he];Ce.source===$.id&&b._validateLayer(Ce)}}}})}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.loadURL=function(o,p){var b=this;void 0===p&&(p={}),this.fire(new l.Event("dataloading",{dataType:"style"}));var E="boolean"==typeof p.validate?p.validate:!l.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,p.accessToken);var A=this.map._requestManager.transformRequest(o,l.ResourceType.Style);this._request=l.getJSON(A,function(B,$){b._request=null,B?b.fire(new l.ErrorEvent(B)):$&&b._load($,E)})},s.prototype.loadJSON=function(o,p){var b=this;void 0===p&&(p={}),this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.browser.frame(function(){b._request=null,b._load(o,!1!==p.validate)})},s.prototype.loadEmpty=function(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(Qs,!1)},s.prototype._load=function(o,p){if(!p||!es(this,l.validateStyle(o))){for(var b in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(b,o.sources[b],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var E=an(this.stylesheet.layers);this._order=E.map(function(he){return he.id}),this._layers={},this._serializedLayers={};for(var A=0,B=E;A<B.length;A+=1){var $=B[A];($=l.createStyleLayer($)).setEventedParent(this,{layer:{id:$.id}}),this._layers[$.id]=$,this._serializedLayers[$.id]=$.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ct(this.stylesheet.light),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}},s.prototype._loadSprite=function(o){var p=this;this._spriteRequest=function(b,E,A){var B,$,he,Ce=l.browser.devicePixelRatio>1?"@2x":"",Me=l.getJSON(E.transformRequest(E.normalizeSpriteURL(b,Ce,".json"),l.ResourceType.SpriteJSON),function($e,pt){Me=null,he||(he=$e,B=pt,et())}),ke=l.getImage(E.transformRequest(E.normalizeSpriteURL(b,Ce,".png"),l.ResourceType.SpriteImage),function($e,pt){ke=null,he||(he=$e,$=pt,et())});function et(){if(he)A(he);else if(B&&$){var $e=l.browser.getImageData($),pt={};for(var Ke in B){var ft=B[Ke],It=ft.width,Wt=ft.height,pr=ft.x,nr=ft.y,br=ft.sdf,Dr=ft.pixelRatio,Qr=ft.stretchX,Xr=ft.stretchY,dn=ft.content,qn=new l.RGBAImage({width:It,height:Wt});l.RGBAImage.copy($e,qn,{x:pr,y:nr},{x:0,y:0},{width:It,height:Wt}),pt[Ke]={data:qn,pixelRatio:Dr,sdf:br,stretchX:Qr,stretchY:Xr,content:dn}}A(null,pt)}}return{cancel:function(){Me&&(Me.cancel(),Me=null),ke&&(ke.cancel(),ke=null)}}}(o,this.map._requestManager,function(b,E){if(p._spriteRequest=null,b)p.fire(new l.ErrorEvent(b));else if(E)for(var A in E)p.imageManager.addImage(A,E[A]);p.imageManager.setLoaded(!0),p._availableImages=p.imageManager.listImages(),p.dispatcher.broadcast("setImages",p._availableImages),p.fire(new l.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var p=this.sourceCaches[o.source];if(p){var b=o.sourceLayer;if(b){var E=p.getSource();("geojson"===E.type||E.vectorLayerIds&&-1===E.vectorLayerIds.indexOf(b))&&this.fire(new l.ErrorEvent(new Error('Source layer "'+b+'" does not exist on source "'+E.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var p=[],b=0,E=o;b<E.length;b+=1){var A=this._layers[E[b]];"custom"!==A.type&&p.push(A.serialize())}return p},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var p in this._layers)if(this._layers[p].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var p=this._changed;if(this._changed){var b=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);for(var A in(b.length||E.length)&&this._updateWorkerLayers(b,E),this._updatedSources){var B=this._updatedSources[A];"reload"===B?this._reloadSource(A):"clear"===B&&this._clearSource(A)}for(var $ in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[$].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var he={};for(var Ce in this.sourceCaches){var Me=this.sourceCaches[Ce];he[Ce]=Me.used,Me.used=!1}for(var ke=0,et=this._order;ke<et.length;ke+=1){var $e=this._layers[et[ke]];$e.recalculate(o,this._availableImages),!$e.isHidden(o.zoom)&&$e.source&&(this.sourceCaches[$e.source].used=!0)}for(var pt in he){var Ke=this.sourceCaches[pt];he[pt]!==Ke.used&&Ke.fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:pt}))}this.light.recalculate(o),this.z=o.zoom,p&&this.fire(new l.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:p})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var p=this;if(this._checkLoaded(),es(this,l.validateStyle(o)))return!1;(o=l.clone$1(o)).layers=an(o.layers);var b=function(A,B){if(!A)return[{command:fn.setStyle,args:[B]}];var $=[];try{if(!l.deepEqual(A.version,B.version))return[{command:fn.setStyle,args:[B]}];l.deepEqual(A.center,B.center)||$.push({command:fn.setCenter,args:[B.center]}),l.deepEqual(A.zoom,B.zoom)||$.push({command:fn.setZoom,args:[B.zoom]}),l.deepEqual(A.bearing,B.bearing)||$.push({command:fn.setBearing,args:[B.bearing]}),l.deepEqual(A.pitch,B.pitch)||$.push({command:fn.setPitch,args:[B.pitch]}),l.deepEqual(A.sprite,B.sprite)||$.push({command:fn.setSprite,args:[B.sprite]}),l.deepEqual(A.glyphs,B.glyphs)||$.push({command:fn.setGlyphs,args:[B.glyphs]}),l.deepEqual(A.transition,B.transition)||$.push({command:fn.setTransition,args:[B.transition]}),l.deepEqual(A.light,B.light)||$.push({command:fn.setLight,args:[B.light]});var he={},Ce=[];!function(ke,et,$e,pt){var Ke;for(Ke in et=et||{},ke=ke||{})ke.hasOwnProperty(Ke)&&(et.hasOwnProperty(Ke)||_n(Ke,$e,pt));for(Ke in et)et.hasOwnProperty(Ke)&&(ke.hasOwnProperty(Ke)?l.deepEqual(ke[Ke],et[Ke])||("geojson"===ke[Ke].type&&"geojson"===et[Ke].type&&ta(ke,et,Ke)?$e.push({command:fn.setGeoJSONSourceData,args:[Ke,et[Ke].data]}):Oi(Ke,et,$e,pt)):Di(Ke,et,$e))}(A.sources,B.sources,Ce,he);var Me=[];A.layers&&A.layers.forEach(function(ke){he[ke.source]?$.push({command:fn.removeLayer,args:[ke.id]}):Me.push(ke)}),$=$.concat(Ce),function(ke,et,$e){et=et||[];var pt,Ke,ft,It,Wt,pr,nr,br=(ke=ke||[]).map(Ji),Dr=et.map(Ji),Qr=ke.reduce(ji,{}),Xr=et.reduce(ji,{}),dn=br.slice(),qn=Object.create(null);for(pt=0,Ke=0;pt<br.length;pt++)Xr.hasOwnProperty(ft=br[pt])?Ke++:($e.push({command:fn.removeLayer,args:[ft]}),dn.splice(dn.indexOf(ft,Ke),1));for(pt=0,Ke=0;pt<Dr.length;pt++)dn[dn.length-1-pt]!==(ft=Dr[Dr.length-1-pt])&&(Qr.hasOwnProperty(ft)?($e.push({command:fn.removeLayer,args:[ft]}),dn.splice(dn.lastIndexOf(ft,dn.length-Ke),1)):Ke++,$e.push({command:fn.addLayer,args:[Xr[ft],pr=dn[dn.length-pt]]}),dn.splice(dn.length-pt,0,ft),qn[ft]=!0);for(pt=0;pt<Dr.length;pt++)if(It=Qr[ft=Dr[pt]],Wt=Xr[ft],!qn[ft]&&!l.deepEqual(It,Wt))if(l.deepEqual(It.source,Wt.source)&&l.deepEqual(It["source-layer"],Wt["source-layer"])&&l.deepEqual(It.type,Wt.type)){for(nr in oi(It.layout,Wt.layout,$e,ft,null,fn.setLayoutProperty),oi(It.paint,Wt.paint,$e,ft,null,fn.setPaintProperty),l.deepEqual(It.filter,Wt.filter)||$e.push({command:fn.setFilter,args:[ft,Wt.filter]}),l.deepEqual(It.minzoom,Wt.minzoom)&&l.deepEqual(It.maxzoom,Wt.maxzoom)||$e.push({command:fn.setLayerZoomRange,args:[ft,Wt.minzoom,Wt.maxzoom]}),It)It.hasOwnProperty(nr)&&"layout"!==nr&&"paint"!==nr&&"filter"!==nr&&"metadata"!==nr&&"minzoom"!==nr&&"maxzoom"!==nr&&(0===nr.indexOf("paint.")?oi(It[nr],Wt[nr],$e,ft,nr.slice(6),fn.setPaintProperty):l.deepEqual(It[nr],Wt[nr])||$e.push({command:fn.setLayerProperty,args:[ft,nr,Wt[nr]]}));for(nr in Wt)Wt.hasOwnProperty(nr)&&!It.hasOwnProperty(nr)&&"layout"!==nr&&"paint"!==nr&&"filter"!==nr&&"metadata"!==nr&&"minzoom"!==nr&&"maxzoom"!==nr&&(0===nr.indexOf("paint.")?oi(It[nr],Wt[nr],$e,ft,nr.slice(6),fn.setPaintProperty):l.deepEqual(It[nr],Wt[nr])||$e.push({command:fn.setLayerProperty,args:[ft,nr,Wt[nr]]}))}else $e.push({command:fn.removeLayer,args:[ft]}),pr=dn[dn.lastIndexOf(ft)+1],$e.push({command:fn.addLayer,args:[Wt,pr]})}(Me,B.layers,$)}catch(ke){console.warn("Unable to compute style diff:",ke),$=[{command:fn.setStyle,args:[B]}]}return $}(this.serialize(),o).filter(function(A){return!(A.command in ks)});if(0===b.length)return!1;var E=b.filter(function(A){return!(A.command in ts)});if(E.length>0)throw new Error("Unimplemented: "+E.map(function(A){return A.command}).join(", ")+".");return b.forEach(function(A){"setTransition"!==A.command&&p[A.command].apply(p,A.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,p){if(this.getImage(o))return this.fire(new l.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,p),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,p){this.imageManager.updateImage(o,p)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new l.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,p,b){var E=this;if(void 0===b&&(b={}),this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error("There is already a source with this ID");if(!p.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(p).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(l.validateStyle.source,"sources."+o,p,null,b))){this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);var A=this.sourceCaches[o]=new Ae(o,p,this.dispatcher);A.style=this,A.setEventedParent(this,function(){return{isSourceLoaded:E.loaded(),source:A.serialize(),sourceId:o}}),A.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(var p in this._layers)if(this._layers[p].source===o)return this.fire(new l.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+p+'" is using it.')));var b=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],b.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),b.setEventedParent(null),b.clearTiles(),b.onRemove&&b.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,p){this._checkLoaded(),this.sourceCaches[o].getSource().setData(p),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,p,b){void 0===b&&(b={}),this._checkLoaded();var E=o.id;if(this.getLayer(E))this.fire(new l.ErrorEvent(new Error('Layer with id "'+E+'" already exists on this map')));else{var A;if("custom"===o.type){if(es(this,l.validateCustomStyleLayer(o)))return;A=l.createStyleLayer(o)}else{if("object"==typeof o.source&&(this.addSource(E,o.source),o=l.clone$1(o),o=l.extend(o,{source:E})),this._validate(l.validateStyle.layer,"layers."+E,o,{arrayIndex:-1},b))return;A=l.createStyleLayer(o),this._validateLayer(A),A.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[A.id]=A.serialize()}var B=p?this._order.indexOf(p):this._order.length;if(p&&-1===B)this.fire(new l.ErrorEvent(new Error('Layer with id "'+p+'" does not exist on this map.')));else{if(this._order.splice(B,0,E),this._layerOrderChanged=!0,this._layers[E]=A,this._removedLayers[E]&&A.source&&"custom"!==A.type){var $=this._removedLayers[E];delete this._removedLayers[E],$.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map)}}},s.prototype.moveLayer=function(o,p){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==p){var b=this._order.indexOf(o);this._order.splice(b,1);var E=p?this._order.indexOf(p):this._order.length;p&&-1===E?this.fire(new l.ErrorEvent(new Error('Layer with id "'+p+'" does not exist on this map.'))):(this._order.splice(E,0,o),this._layerOrderChanged=!0)}}else this.fire(new l.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var p=this._layers[o];if(p){p.setEventedParent(null);var b=this._order.indexOf(o);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=p,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],p.onRemove&&p.onRemove(this.map)}else this.fire(new l.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,p,b){this._checkLoaded();var E=this.getLayer(o);E?E.minzoom===p&&E.maxzoom===b||(null!=p&&(E.minzoom=p),null!=b&&(E.maxzoom=b),this._updateLayer(E)):this.fire(new l.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,p,b){void 0===b&&(b={}),this._checkLoaded();var E=this.getLayer(o);if(E){if(!l.deepEqual(E.filter,p))return null==p?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(l.validateStyle.filter,"layers."+E.id+".filter",p,null,b)||(E.filter=l.clone$1(p),this._updateLayer(E)))}else this.fire(new l.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return l.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,p,b,E){void 0===E&&(E={}),this._checkLoaded();var A=this.getLayer(o);A?l.deepEqual(A.getLayoutProperty(p),b)||(A.setLayoutProperty(p,b,E),this._updateLayer(A)):this.fire(new l.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,p){var b=this.getLayer(o);if(b)return b.getLayoutProperty(p);this.fire(new l.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,p,b,E){void 0===E&&(E={}),this._checkLoaded();var A=this.getLayer(o);A?l.deepEqual(A.getPaintProperty(p),b)||(A.setPaintProperty(p,b,E)&&this._updateLayer(A),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new l.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,p){return this.getLayer(o).getPaintProperty(p)},s.prototype.setFeatureState=function(o,p){this._checkLoaded();var b=o.source,E=o.sourceLayer,A=this.sourceCaches[b];if(void 0!==A){var B=A.getSource().type;"geojson"===B&&E?this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==B||E?(void 0===o.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),A.setFeatureState(E,o.id,p)):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,p){this._checkLoaded();var b=o.source,E=this.sourceCaches[b];if(void 0!==E){var A=E.getSource().type,B="vector"===A?o.sourceLayer:void 0;"vector"!==A||B?p&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):E.removeFeatureState(B,o.id,p):this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var p=o.source,b=o.sourceLayer,E=this.sourceCaches[p];if(void 0!==E){if("vector"!==E.getSource().type||b)return void 0===o.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),E.getFeatureState(b,o.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error("The source '"+p+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:l.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return void 0!==o})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var p=this,b=function(Qr){return"fill-extrusion"===p._layers[Qr].type},E={},A=[],B=this._order.length-1;B>=0;B--){var $=this._order[B];if(b($)){E[$]=B;for(var he=0,Ce=o;he<Ce.length;he+=1){var Me=Ce[he][$];if(Me)for(var ke=0,et=Me;ke<et.length;ke+=1)A.push(et[ke])}}}A.sort(function(Qr,Xr){return Xr.intersectionZ-Qr.intersectionZ});for(var $e=[],pt=this._order.length-1;pt>=0;pt--){var Ke=this._order[pt];if(b(Ke))for(var ft=A.length-1;ft>=0;ft--){var It=A[ft].feature;if(E[It.layer.id]<pt)break;$e.push(It),A.pop()}else for(var Wt=0,pr=o;Wt<pr.length;Wt+=1){var nr=pr[Wt][Ke];if(nr)for(var br=0,Dr=nr;br<Dr.length;br+=1)$e.push(Dr[br].feature)}}return $e},s.prototype.queryRenderedFeatures=function(o,p,b){p&&p.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",p.filter,null,p);var E={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var A=0,B=p.layers;A<B.length;A+=1){var $=B[A],he=this._layers[$];if(!he)return this.fire(new l.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot be queried for features."))),[];E[he.source]=!0}}var Ce=[];for(var Me in p.availableImages=this._availableImages,this.sourceCaches)p.layers&&!E[Me]||Ce.push(cn(this.sourceCaches[Me],this._layers,this._serializedLayers,o,p,b));return this.placement&&Ce.push(function(ke,et,$e,pt,Ke,ft,It){for(var Wt={},pr=ft.queryRenderedSymbols(pt),nr=[],br=0,Dr=Object.keys(pr).map(Number);br<Dr.length;br+=1)nr.push(It[Dr[br]]);nr.sort(Ir);for(var Qr=function(){var Nn=dn[Xr],Li=Nn.featureIndex.lookupSymbolFeatures(pr[Nn.bucketInstanceId],et,Nn.bucketIndex,Nn.sourceLayerIndex,Ke.filter,Ke.layers,Ke.availableImages,ke);for(var Dn in Li){var gi=Wt[Dn]=Wt[Dn]||[],Vi=Li[Dn];Vi.sort(function(Fi,te){var ie=Nn.featureSortOrder;if(ie){var F=ie.indexOf(Fi.featureIndex);return ie.indexOf(te.featureIndex)-F}return te.featureIndex-Fi.featureIndex});for(var li=0,yi=Vi;li<yi.length;li+=1)gi.push(yi[li])}},Xr=0,dn=nr;Xr<dn.length;Xr+=1)Qr();var qn=function(Nn){Wt[Nn].forEach(function(Li){var Dn=Li.feature,gi=$e[ke[Nn].source].getFeatureState(Dn.layer["source-layer"],Dn.id);Dn.source=Dn.layer.source,Dn.layer["source-layer"]&&(Dn.sourceLayer=Dn.layer["source-layer"]),Dn.state=gi})};for(var Vn in Wt)qn(Vn);return Wt}(this._layers,this._serializedLayers,this.sourceCaches,o,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ce)},s.prototype.querySourceFeatures=function(o,p){p&&p.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",p.filter,null,p);var b=this.sourceCaches[o];return b?function(E,A){for(var B=E.getRenderableIds().map(function(et){return E.getTileByID(et)}),$=[],he={},Ce=0;Ce<B.length;Ce++){var Me=B[Ce],ke=Me.tileID.canonical.key;he[ke]||(he[ke]=!0,Me.querySourceFeatures($,A))}return $}(b,p):[]},s.prototype.addSourceType=function(o,p,b){return s.getSourceType(o)?b(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:p.workerSourceURL},b):b(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,p){void 0===p&&(p={}),this._checkLoaded();var b=this.light.getLight(),E=!1;for(var A in o)if(!l.deepEqual(o[A],b[A])){E=!0;break}if(E){var B={now:l.browser.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,p),this.light.updateTransitions(B)}},s.prototype._validate=function(o,p,b,E,A){return void 0===A&&(A={}),(!A||!1!==A.validate)&&es(this,o.call(l.validateStyle,l.extend({key:p,style:this.serialize(),value:b,styleSpec:l.styleSpec},E)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var p in this.sourceCaches)this.sourceCaches[p].clearTiles(),this.sourceCaches[p].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var p in this.sourceCaches)this.sourceCaches[p].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,p,b,E,A){void 0===A&&(A=!1);for(var B=!1,$=!1,he={},Ce=0,Me=this._order;Ce<Me.length;Ce+=1){var ke=this._layers[Me[Ce]];if("symbol"===ke.type){if(!he[ke.source]){var et=this.sourceCaches[ke.source];he[ke.source]=et.getRenderableIds(!0).map(function(It){return et.getTileByID(It)}).sort(function(It,Wt){return Wt.tileID.overscaledZ-It.tileID.overscaledZ||(It.tileID.isLessThan(Wt.tileID)?-1:1)})}var $e=this.crossTileSymbolIndex.addLayer(ke,he[ke.source],o.center.lng);B=B||$e}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((A=A||this._layerOrderChanged||0===b)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.browser.now(),o.zoom))&&(this.pauseablePlacement=new du(o,this._order,A,p,b,E,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,he),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.browser.now()),$=!0),B&&this.pauseablePlacement.placement.setStale()),$||B)for(var pt=0,Ke=this._order;pt<Ke.length;pt+=1){var ft=this._layers[Ke[pt]];"symbol"===ft.type&&this.placement.updateLayerOpacities(ft,he[ft.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,p,b){this.imageManager.getImages(p.icons,b),this._updateTilesForChangedImages();var E=this.sourceCaches[p.source];E&&E.setDependencies(p.tileID.key,p.type,p.icons)},s.prototype.getGlyphs=function(o,p,b){this.glyphManager.getGlyphs(p.stacks,b)},s.prototype.getResource=function(o,p,b){return l.makeRequest(p,b)},s}(l.Evented);gs.getSourceType=function(a){return xr[a]},gs.setSourceType=function(a,s){xr[a]=s},gs.registerForPluginStateChange=l.registerForPluginStateChange;var Oa=l.createLayout([{name:"a_pos",type:"Int16",components:2}]),ko=vi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Ol=vi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ll=vi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),kl=vi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),wc=vi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Rl=vi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),hl=vi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),eu=vi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Dl=vi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),g=vi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),T=vi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),K=vi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),D=vi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ge=vi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Fe=vi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),yt=vi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Zt=vi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ft=vi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Or=vi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),zr=vi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Jn=vi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),bi=vi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),pi=vi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),oa=vi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Ea=vi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Fa=vi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function vi(a,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=s.match(/attribute ([\w]+) ([\w]+)/g),b=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=E?E.concat(b):b,B={};return{fragmentSource:a=a.replace(o,function($,he,Ce,Me,ke){return B[ke]=!0,"define"===he?"\n#ifndef HAS_UNIFORM_u_"+ke+"\nvarying "+Ce+" "+Me+" "+ke+";\n#else\nuniform "+Ce+" "+Me+" u_"+ke+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+ke+"\n    "+Ce+" "+Me+" "+ke+" = u_"+ke+";\n#endif\n"}),vertexSource:s=s.replace(o,function($,he,Ce,Me,ke){var et="float"===Me?"vec2":"vec4",$e=ke.match(/color/)?"color":et;return B[ke]?"define"===he?"\n#ifndef HAS_UNIFORM_u_"+ke+"\nuniform lowp float u_"+ke+"_t;\nattribute "+Ce+" "+et+" a_"+ke+";\nvarying "+Ce+" "+Me+" "+ke+";\n#else\nuniform "+Ce+" "+Me+" u_"+ke+";\n#endif\n":"vec4"===$e?"\n#ifndef HAS_UNIFORM_u_"+ke+"\n    "+ke+" = a_"+ke+";\n#else\n    "+Ce+" "+Me+" "+ke+" = u_"+ke+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+ke+"\n    "+ke+" = unpack_mix_"+$e+"(a_"+ke+", u_"+ke+"_t);\n#else\n    "+Ce+" "+Me+" "+ke+" = u_"+ke+";\n#endif\n":"define"===he?"\n#ifndef HAS_UNIFORM_u_"+ke+"\nuniform lowp float u_"+ke+"_t;\nattribute "+Ce+" "+et+" a_"+ke+";\n#else\nuniform "+Ce+" "+Me+" u_"+ke+";\n#endif\n":"vec4"===$e?"\n#ifndef HAS_UNIFORM_u_"+ke+"\n    "+Ce+" "+Me+" "+ke+" = a_"+ke+";\n#else\n    "+Ce+" "+Me+" "+ke+" = u_"+ke+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+ke+"\n    "+Ce+" "+Me+" "+ke+" = unpack_mix_"+$e+"(a_"+ke+", u_"+ke+"_t);\n#else\n    "+Ce+" "+Me+" "+ke+" = u_"+ke+";\n#endif\n"}),staticAttributes:p,staticUniforms:A}}var Xo=Object.freeze({__proto__:null,prelude:ko,background:Ol,backgroundPattern:Ll,circle:kl,clippingMask:wc,heatmap:Rl,heatmapTexture:hl,collisionBox:eu,collisionCircle:Dl,debug:g,fill:T,fillOutline:K,fillOutlinePattern:D,fillPattern:ge,fillExtrusion:Fe,fillExtrusionPattern:yt,hillshadePrepare:Zt,hillshade:Ft,line:Or,lineGradient:zr,linePattern:Jn,lineSDF:bi,raster:pi,symbolIcon:oa,symbolSDF:Ea,symbolTextAndIcon:Fa}),vu=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Tu(a){for(var s=[],o=0;o<a.length;o++)if(null!==a[o]){var p=a[o].split(" ");s.push(p.pop())}return s}vu.prototype.bind=function(a,s,o,p,b,E,A,B){this.context=a;for(var $=this.boundPaintVertexBuffers.length!==p.length,he=0;!$&&he<p.length;he++)this.boundPaintVertexBuffers[he]!==p[he]&&($=!0);a.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!$&&this.boundIndexBuffer===b&&this.boundVertexOffset===E&&this.boundDynamicVertexBuffer===A&&this.boundDynamicVertexBuffer2===B?(a.bindVertexArrayOES.set(this.vao),A&&A.bind(),b&&b.dynamicDraw&&b.bind(),B&&B.bind()):this.freshBind(s,o,p,b,E,A,B)},vu.prototype.freshBind=function(a,s,o,p,b,E,A){var B,$=a.numAttributes,he=this.context,Ce=he.gl;if(he.extVertexArrayObject)this.vao&&this.destroy(),this.vao=he.extVertexArrayObject.createVertexArrayOES(),he.bindVertexArrayOES.set(this.vao),B=0,this.boundProgram=a,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=p,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=A;else{B=he.currentNumAttributes||0;for(var Me=$;Me<B;Me++)Ce.disableVertexAttribArray(Me)}s.enableAttributes(Ce,a);for(var ke=0,et=o;ke<et.length;ke+=1)et[ke].enableAttributes(Ce,a);E&&E.enableAttributes(Ce,a),A&&A.enableAttributes(Ce,a),s.bind(),s.setVertexAttribPointers(Ce,a,b);for(var $e=0,pt=o;$e<pt.length;$e+=1){var Ke=pt[$e];Ke.bind(),Ke.setVertexAttribPointers(Ce,a,b)}E&&(E.bind(),E.setVertexAttribPointers(Ce,a,b)),p&&p.bind(),A&&(A.bind(),A.setVertexAttribPointers(Ce,a,b)),he.currentNumAttributes=$},vu.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ec=function(a,s,o,p,b,E){var A=a.gl;this.program=A.createProgram();for(var B=Tu(o.staticAttributes),$=p?p.getBinderAttributes():[],he=B.concat($),Ce=o.staticUniforms?Tu(o.staticUniforms):[],Me=p?p.getBinderUniforms():[],ke=[],et=0,$e=Ce.concat(Me);et<$e.length;et+=1){var pt=$e[et];ke.indexOf(pt)<0&&ke.push(pt)}var Ke=p?p.defines():[];E&&Ke.push("#define OVERDRAW_INSPECTOR;");var ft=Ke.concat(ko.fragmentSource,o.fragmentSource).join("\n"),It=Ke.concat(ko.vertexSource,o.vertexSource).join("\n"),Wt=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())this.failedToCreate=!0;else{A.shaderSource(Wt,ft),A.compileShader(Wt),A.attachShader(this.program,Wt);var pr=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())this.failedToCreate=!0;else{A.shaderSource(pr,It),A.compileShader(pr),A.attachShader(this.program,pr),this.attributes={};var nr={};this.numAttributes=he.length;for(var br=0;br<this.numAttributes;br++)he[br]&&(A.bindAttribLocation(this.program,br,he[br]),this.attributes[he[br]]=br);A.linkProgram(this.program),A.deleteShader(pr),A.deleteShader(Wt);for(var Dr=0;Dr<ke.length;Dr++){var Qr=ke[Dr];if(Qr&&!nr[Qr]){var Xr=A.getUniformLocation(this.program,Qr);Xr&&(nr[Qr]=Xr)}}this.fixedUniforms=b(a,nr),this.binderUniforms=p?p.getUniforms(a,nr):[]}}};function Du(a,s,o){var p=1/ma(o,1,s.transform.tileZoom),b=Math.pow(2,o.tileID.overscaledZ),E=o.tileSize*Math.pow(2,s.transform.tileZoom)/b,A=E*(o.tileID.canonical.x+o.tileID.wrap*b),B=E*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[p,a.fromScale,a.toScale],u_fade:a.t,u_pixel_coord_upper:[A>>16,B>>16],u_pixel_coord_lower:[65535&A,65535&B]}}Ec.prototype.draw=function(a,s,o,p,b,E,A,B,$,he,Ce,Me,ke,et,$e,pt){var Ke,ft=a.gl;if(!this.failedToCreate){for(var It in a.program.set(this.program),a.setDepthMode(o),a.setStencilMode(p),a.setColorMode(b),a.setCullFace(E),this.fixedUniforms)this.fixedUniforms[It].set(A[It]);et&&et.setUniforms(a,this.binderUniforms,Me,{zoom:ke});for(var Wt=(Ke={},Ke[ft.LINES]=2,Ke[ft.TRIANGLES]=3,Ke[ft.LINE_STRIP]=1,Ke)[s],pr=0,nr=Ce.get();pr<nr.length;pr+=1){var br=nr[pr],Dr=br.vaos||(br.vaos={});(Dr[B]||(Dr[B]=new vu)).bind(a,this,$,et?et.getPaintVertexBuffers():[],he,br.vertexOffset,$e,pt),ft.drawElements(s,br.primitiveLength*Wt,ft.UNSIGNED_SHORT,br.primitiveOffset*Wt*2)}}};var Nl=function(a,s,o,p){var b=s.style.light,E=b.properties.get("position"),A=[E.x,E.y,E.z],B=l.create$1();"viewport"===b.properties.get("anchor")&&l.fromRotation(B,-s.transform.angle),l.transformMat3(A,A,B);var $=b.properties.get("color");return{u_matrix:a,u_lightpos:A,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_vertical_gradient:+o,u_opacity:p}},mu=function(a,s,o,p,b,E,A){return l.extend(Nl(a,s,o,p),Du(E,s,A),{u_height_factor:-Math.pow(2,b.overscaledZ)/A.tileSize/8})},gu=function(a){return{u_matrix:a}},tu=function(a,s,o,p){return l.extend(gu(a),Du(o,s,p))},oo=function(a,s){return{u_matrix:a,u_world:s}},Tc=function(a,s,o,p,b){return l.extend(tu(a,s,o,p),{u_world:b})},Cc=function(a,s,o,p){var b,E,A=a.transform;if("map"===p.paint.get("circle-pitch-alignment")){var B=ma(o,1,A.zoom);b=!0,E=[B,B]}else b=!1,E=A.pixelsToGLUnits;return{u_camera_to_center_distance:A.cameraToCenterDistance,u_scale_with_map:+("map"===p.paint.get("circle-pitch-scale")),u_matrix:a.translatePosMatrix(s.posMatrix,o,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:l.browser.devicePixelRatio,u_extrude_scale:E}},rs=function(a,s,o){var p=ma(o,1,s.zoom),b=Math.pow(2,s.zoom-o.tileID.overscaledZ),E=o.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[s.pixelsToGLUnits[0]/(p*b),s.pixelsToGLUnits[1]/(p*b)],u_overscale_factor:E}},tc=function(a,s,o){return{u_matrix:a,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},ru=function(a,s,o){return void 0===o&&(o=1),{u_matrix:a,u_color:s,u_overlay:0,u_overlay_scale:o}},Rs=function(a){return{u_matrix:a}},rc=function(a,s,o,p){return{u_matrix:a,u_extrude_scale:ma(s,1,o),u_intensity:p}},Nu=function(a,s,o){var p=a.transform;return{u_matrix:nc(a,s,o),u_ratio:1/ma(s,1,p.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},La=function(a,s,o,p){return l.extend(Nu(a,s,o),{u_image:0,u_image_height:p})},Ju=function(a,s,o,p){var b=a.transform,E=Us(s,b);return{u_matrix:nc(a,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/ma(s,1,b.zoom),u_device_pixel_ratio:l.browser.devicePixelRatio,u_image:0,u_scale:[E,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},Gc=function(a,s,o,p,b){var E=a.lineAtlas,A=Us(s,a.transform),B="round"===o.layout.get("line-cap"),$=E.getDash(p.from,B),he=E.getDash(p.to,B),Ce=$.width*b.fromScale,Me=he.width*b.toScale;return l.extend(Nu(a,s,o),{u_patternscale_a:[A/Ce,-$.height/2],u_patternscale_b:[A/Me,-he.height/2],u_sdfgamma:E.width/(256*Math.min(Ce,Me)*l.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:$.y,u_tex_y_b:he.y,u_mix:b.t})};function Us(a,s){return 1/ma(a,1,s.tileZoom)}function nc(a,s,o){return a.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Hc=function(a,s,o,p,b){return{u_matrix:a,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(A=b.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(E=b.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:Ac(b.paint.get("raster-hue-rotate"))};var E,A};function Ac(a){a*=Math.PI/180;var s=Math.sin(a),o=Math.cos(a);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var Bl,yu=function(a,s,o,p,b,E,A,B,$,he){var Ce=b.transform;return{u_is_size_zoom_constant:+("constant"===a||"source"===a),u_is_size_feature_constant:+("constant"===a||"camera"===a),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Ce.cameraToCenterDistance,u_pitch:Ce.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Ce.width/Ce.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:A,u_coord_matrix:B,u_is_text:+$,u_pitch_with_map:+p,u_texsize:he,u_texture:0}},$u=function(a,s,o,p,b,E,A,B,$,he,Ce){var Me=b.transform;return l.extend(yu(a,s,o,p,b,E,A,B,$,he),{u_gamma_scale:p?Math.cos(Me._pitch)*Me.cameraToCenterDistance:1,u_device_pixel_ratio:l.browser.devicePixelRatio,u_is_halo:+Ce})},pl=function(a,s,o,p,b,E,A,B,$,he){return l.extend($u(a,s,o,p,b,E,A,B,!0,$,!0),{u_texsize_icon:he,u_texture_icon:1})},Qu=function(a,s,o){return{u_matrix:a,u_opacity:s,u_color:o}},el=function(a,s,o,p,b,E){return l.extend((B=E,he=b,Ce=($=o).imageManager.getPattern((A=p).from.toString()),Me=$.imageManager.getPattern(A.to.toString()),et=(ke=$.imageManager.getPixelSize()).width,$e=ke.height,pt=Math.pow(2,he.tileID.overscaledZ),ft=(Ke=he.tileSize*Math.pow(2,$.transform.tileZoom)/pt)*(he.tileID.canonical.x+he.tileID.wrap*pt),It=Ke*he.tileID.canonical.y,{u_image:0,u_pattern_tl_a:Ce.tl,u_pattern_br_a:Ce.br,u_pattern_tl_b:Me.tl,u_pattern_br_b:Me.br,u_texsize:[et,$e],u_mix:B.t,u_pattern_size_a:Ce.displaySize,u_pattern_size_b:Me.displaySize,u_scale_a:B.fromScale,u_scale_b:B.toScale,u_tile_units_to_pixels:1/ma(he,1,$.transform.tileZoom),u_pixel_coord_upper:[ft>>16,It>>16],u_pixel_coord_lower:[65535&ft,65535&It]}),{u_matrix:a,u_opacity:s});var A,B,$,he,Ce,Me,ke,et,$e,pt,Ke,ft,It},dl={fillExtrusion:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_lightpos:new l.Uniform3f(a,s.u_lightpos),u_lightintensity:new l.Uniform1f(a,s.u_lightintensity),u_lightcolor:new l.Uniform3f(a,s.u_lightcolor),u_vertical_gradient:new l.Uniform1f(a,s.u_vertical_gradient),u_opacity:new l.Uniform1f(a,s.u_opacity)}},fillExtrusionPattern:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_lightpos:new l.Uniform3f(a,s.u_lightpos),u_lightintensity:new l.Uniform1f(a,s.u_lightintensity),u_lightcolor:new l.Uniform3f(a,s.u_lightcolor),u_vertical_gradient:new l.Uniform1f(a,s.u_vertical_gradient),u_height_factor:new l.Uniform1f(a,s.u_height_factor),u_image:new l.Uniform1i(a,s.u_image),u_texsize:new l.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new l.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new l.Uniform3f(a,s.u_scale),u_fade:new l.Uniform1f(a,s.u_fade),u_opacity:new l.Uniform1f(a,s.u_opacity)}},fill:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix)}},fillPattern:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_image:new l.Uniform1i(a,s.u_image),u_texsize:new l.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new l.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new l.Uniform3f(a,s.u_scale),u_fade:new l.Uniform1f(a,s.u_fade)}},fillOutline:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_world:new l.Uniform2f(a,s.u_world)}},fillOutlinePattern:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_world:new l.Uniform2f(a,s.u_world),u_image:new l.Uniform1i(a,s.u_image),u_texsize:new l.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new l.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new l.Uniform3f(a,s.u_scale),u_fade:new l.Uniform1f(a,s.u_fade)}},circle:function(a,s){return{u_camera_to_center_distance:new l.Uniform1f(a,s.u_camera_to_center_distance),u_scale_with_map:new l.Uniform1i(a,s.u_scale_with_map),u_pitch_with_map:new l.Uniform1i(a,s.u_pitch_with_map),u_extrude_scale:new l.Uniform2f(a,s.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(a,s.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(a,s.u_matrix)}},collisionBox:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_camera_to_center_distance:new l.Uniform1f(a,s.u_camera_to_center_distance),u_pixels_to_tile_units:new l.Uniform1f(a,s.u_pixels_to_tile_units),u_extrude_scale:new l.Uniform2f(a,s.u_extrude_scale),u_overscale_factor:new l.Uniform1f(a,s.u_overscale_factor)}},collisionCircle:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_inv_matrix:new l.UniformMatrix4f(a,s.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(a,s.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(a,s.u_viewport_size)}},debug:function(a,s){return{u_color:new l.UniformColor(a,s.u_color),u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_overlay:new l.Uniform1i(a,s.u_overlay),u_overlay_scale:new l.Uniform1f(a,s.u_overlay_scale)}},clippingMask:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix)}},heatmap:function(a,s){return{u_extrude_scale:new l.Uniform1f(a,s.u_extrude_scale),u_intensity:new l.Uniform1f(a,s.u_intensity),u_matrix:new l.UniformMatrix4f(a,s.u_matrix)}},heatmapTexture:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_world:new l.Uniform2f(a,s.u_world),u_image:new l.Uniform1i(a,s.u_image),u_color_ramp:new l.Uniform1i(a,s.u_color_ramp),u_opacity:new l.Uniform1f(a,s.u_opacity)}},hillshade:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_image:new l.Uniform1i(a,s.u_image),u_latrange:new l.Uniform2f(a,s.u_latrange),u_light:new l.Uniform2f(a,s.u_light),u_shadow:new l.UniformColor(a,s.u_shadow),u_highlight:new l.UniformColor(a,s.u_highlight),u_accent:new l.UniformColor(a,s.u_accent)}},hillshadePrepare:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_image:new l.Uniform1i(a,s.u_image),u_dimension:new l.Uniform2f(a,s.u_dimension),u_zoom:new l.Uniform1f(a,s.u_zoom),u_unpack:new l.Uniform4f(a,s.u_unpack)}},line:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_ratio:new l.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new l.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(a,s.u_units_to_pixels)}},lineGradient:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_ratio:new l.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new l.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(a,s.u_units_to_pixels),u_image:new l.Uniform1i(a,s.u_image),u_image_height:new l.Uniform1f(a,s.u_image_height)}},linePattern:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_texsize:new l.Uniform2f(a,s.u_texsize),u_ratio:new l.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new l.Uniform1f(a,s.u_device_pixel_ratio),u_image:new l.Uniform1i(a,s.u_image),u_units_to_pixels:new l.Uniform2f(a,s.u_units_to_pixels),u_scale:new l.Uniform3f(a,s.u_scale),u_fade:new l.Uniform1f(a,s.u_fade)}},lineSDF:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_ratio:new l.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new l.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(a,s.u_units_to_pixels),u_patternscale_a:new l.Uniform2f(a,s.u_patternscale_a),u_patternscale_b:new l.Uniform2f(a,s.u_patternscale_b),u_sdfgamma:new l.Uniform1f(a,s.u_sdfgamma),u_image:new l.Uniform1i(a,s.u_image),u_tex_y_a:new l.Uniform1f(a,s.u_tex_y_a),u_tex_y_b:new l.Uniform1f(a,s.u_tex_y_b),u_mix:new l.Uniform1f(a,s.u_mix)}},raster:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_tl_parent:new l.Uniform2f(a,s.u_tl_parent),u_scale_parent:new l.Uniform1f(a,s.u_scale_parent),u_buffer_scale:new l.Uniform1f(a,s.u_buffer_scale),u_fade_t:new l.Uniform1f(a,s.u_fade_t),u_opacity:new l.Uniform1f(a,s.u_opacity),u_image0:new l.Uniform1i(a,s.u_image0),u_image1:new l.Uniform1i(a,s.u_image1),u_brightness_low:new l.Uniform1f(a,s.u_brightness_low),u_brightness_high:new l.Uniform1f(a,s.u_brightness_high),u_saturation_factor:new l.Uniform1f(a,s.u_saturation_factor),u_contrast_factor:new l.Uniform1f(a,s.u_contrast_factor),u_spin_weights:new l.Uniform3f(a,s.u_spin_weights)}},symbolIcon:function(a,s){return{u_is_size_zoom_constant:new l.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new l.Uniform1f(a,s.u_size_t),u_size:new l.Uniform1f(a,s.u_size),u_camera_to_center_distance:new l.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new l.Uniform1f(a,s.u_pitch),u_rotate_symbol:new l.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new l.Uniform1f(a,s.u_fade_change),u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new l.Uniform1i(a,s.u_is_text),u_pitch_with_map:new l.Uniform1i(a,s.u_pitch_with_map),u_texsize:new l.Uniform2f(a,s.u_texsize),u_texture:new l.Uniform1i(a,s.u_texture)}},symbolSDF:function(a,s){return{u_is_size_zoom_constant:new l.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new l.Uniform1f(a,s.u_size_t),u_size:new l.Uniform1f(a,s.u_size),u_camera_to_center_distance:new l.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new l.Uniform1f(a,s.u_pitch),u_rotate_symbol:new l.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new l.Uniform1f(a,s.u_fade_change),u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new l.Uniform1i(a,s.u_is_text),u_pitch_with_map:new l.Uniform1i(a,s.u_pitch_with_map),u_texsize:new l.Uniform2f(a,s.u_texsize),u_texture:new l.Uniform1i(a,s.u_texture),u_gamma_scale:new l.Uniform1f(a,s.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(a,s.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(a,s.u_is_halo)}},symbolTextAndIcon:function(a,s){return{u_is_size_zoom_constant:new l.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new l.Uniform1f(a,s.u_size_t),u_size:new l.Uniform1f(a,s.u_size),u_camera_to_center_distance:new l.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new l.Uniform1f(a,s.u_pitch),u_rotate_symbol:new l.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new l.Uniform1f(a,s.u_fade_change),u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new l.Uniform1i(a,s.u_is_text),u_pitch_with_map:new l.Uniform1i(a,s.u_pitch_with_map),u_texsize:new l.Uniform2f(a,s.u_texsize),u_texsize_icon:new l.Uniform2f(a,s.u_texsize_icon),u_texture:new l.Uniform1i(a,s.u_texture),u_texture_icon:new l.Uniform1i(a,s.u_texture_icon),u_gamma_scale:new l.Uniform1f(a,s.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(a,s.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(a,s.u_is_halo)}},background:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_opacity:new l.Uniform1f(a,s.u_opacity),u_color:new l.UniformColor(a,s.u_color)}},backgroundPattern:function(a,s){return{u_matrix:new l.UniformMatrix4f(a,s.u_matrix),u_opacity:new l.Uniform1f(a,s.u_opacity),u_image:new l.Uniform1i(a,s.u_image),u_pattern_tl_a:new l.Uniform2f(a,s.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(a,s.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(a,s.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(a,s.u_pattern_br_b),u_texsize:new l.Uniform2f(a,s.u_texsize),u_mix:new l.Uniform1f(a,s.u_mix),u_pattern_size_a:new l.Uniform2f(a,s.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(a,s.u_pattern_size_b),u_scale_a:new l.Uniform1f(a,s.u_scale_a),u_scale_b:new l.Uniform1f(a,s.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(a,s.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(a,s.u_tile_units_to_pixels)}}};function Bu(a,s,o,p,b,E,A){for(var B=a.context,$=B.gl,he=a.useProgram("collisionBox"),Ce=[],Me=0,ke=0,et=0;et<p.length;et++){var $e=p[et],pt=s.getTile($e),Ke=pt.getBucket(o);if(Ke){var ft=$e.posMatrix;0===b[0]&&0===b[1]||(ft=a.translatePosMatrix($e.posMatrix,pt,b,E));var It=A?Ke.textCollisionBox:Ke.iconCollisionBox,Wt=Ke.collisionCircleArray;if(Wt.length>0){var pr=l.create(),nr=ft;l.mul(pr,Ke.placementInvProjMatrix,a.transform.glCoordMatrix),l.mul(pr,pr,Ke.placementViewportMatrix),Ce.push({circleArray:Wt,circleOffset:ke,transform:nr,invTransform:pr}),ke=Me+=Wt.length/4}It&&he.draw(B,$.LINES,G.disabled,oe.disabled,a.colorModeForRenderPass(),Oe.disabled,rs(ft,a.transform,pt),o.id,It.layoutVertexBuffer,It.indexBuffer,It.segments,null,a.transform.zoom,null,null,It.collisionVertexBuffer)}}if(A&&Ce.length){var br=a.useProgram("collisionCircle"),Dr=new l.StructArrayLayout2f1f2i16;Dr.resize(4*Me),Dr._trim();for(var Qr=0,Xr=0,dn=Ce;Xr<dn.length;Xr+=1)for(var qn=dn[Xr],Vn=0;Vn<qn.circleArray.length/4;Vn++){var Nn=4*Vn,Li=qn.circleArray[Nn+0],Dn=qn.circleArray[Nn+1],gi=qn.circleArray[Nn+2],Vi=qn.circleArray[Nn+3];Dr.emplace(Qr++,Li,Dn,gi,Vi,0),Dr.emplace(Qr++,Li,Dn,gi,Vi,1),Dr.emplace(Qr++,Li,Dn,gi,Vi,2),Dr.emplace(Qr++,Li,Dn,gi,Vi,3)}(!Bl||Bl.length<2*Me)&&(Bl=function(U){var de=2*U,Te=new l.StructArrayLayout3ui6;Te.resize(de),Te._trim();for(var mt=0;mt<de;mt++){var Nt=6*mt;Te.uint16[Nt+0]=4*mt+0,Te.uint16[Nt+1]=4*mt+1,Te.uint16[Nt+2]=4*mt+2,Te.uint16[Nt+3]=4*mt+2,Te.uint16[Nt+4]=4*mt+3,Te.uint16[Nt+5]=4*mt+0}return Te}(Me));for(var li=B.createIndexBuffer(Bl,!0),yi=B.createVertexBuffer(Dr,l.collisionCircleLayout.members,!0),Fi=0,te=Ce;Fi<te.length;Fi+=1){var ie=te[Fi],F=tc(ie.transform,ie.invTransform,a.transform);br.draw(B,$.TRIANGLES,G.disabled,oe.disabled,a.colorModeForRenderPass(),Oe.disabled,F,o.id,yi,li,l.SegmentVector.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,a.transform.zoom,null,null,null)}yi.destroy(),li.destroy()}}var Vs=l.identity(new Float32Array(16));function Pc(a,s,o,p,b,E){var A=l.getAnchorAlignment(a),B=-(A.horizontalAlign-.5)*s,$=-(A.verticalAlign-.5)*o,he=l.evaluateVariableOffset(a,p);return new l.Point((B/b+he[0])*E,($/b+he[1])*E)}function Ic(a,s,o,p,b,E,A,B,$,he,Ce){var Me=a.text.placedSymbolArray,ke=a.text.dynamicLayoutVertexArray,et=a.icon.dynamicLayoutVertexArray,$e={};ke.clear();for(var pt=0;pt<Me.length;pt++){var Ke=Me.get(pt),ft=Ke.hidden||!Ke.crossTileID||a.allowVerticalPlacement&&!Ke.placedOrientation?null:p[Ke.crossTileID];if(ft){var It=new l.Point(Ke.anchorX,Ke.anchorY),Wt=Ni(It,o?B:A),pr=Xi(E.cameraToCenterDistance,Wt.signedDistanceFromCamera),nr=b.evaluateSizeForFeature(a.textSizeData,he,Ke)*pr/l.ONE_EM;o&&(nr*=a.tilePixelRatio/$);for(var br=Pc(ft.anchor,ft.width,ft.height,ft.textOffset,ft.textBoxScale,nr),Dr=o?Ni(It.add(br),A).point:Wt.point.add(s?br.rotate(-E.angle):br),Qr=a.allowVerticalPlacement&&Ke.placedOrientation===l.WritingMode.vertical?Math.PI/2:0,Xr=0;Xr<Ke.numGlyphs;Xr++)l.addDynamicAttributes(ke,Dr,Qr);Ce&&Ke.associatedIconIndex>=0&&($e[Ke.associatedIconIndex]={shiftedAnchor:Dr,angle:Qr})}else Bi(Ke.numGlyphs,ke)}if(Ce){et.clear();for(var dn=a.icon.placedSymbolArray,qn=0;qn<dn.length;qn++){var Vn=dn.get(qn);if(Vn.hidden)Bi(Vn.numGlyphs,et);else{var Nn=$e[qn];if(Nn)for(var Li=0;Li<Vn.numGlyphs;Li++)l.addDynamicAttributes(et,Nn.shiftedAnchor,Nn.angle);else Bi(Vn.numGlyphs,et)}}a.icon.dynamicLayoutVertexBuffer.updateData(et)}a.text.dynamicLayoutVertexBuffer.updateData(ke)}function Wc(a,s,o){return o.iconsInText&&s?"symbolTextAndIcon":a?"symbolSDF":"symbolIcon"}function tl(a,s,o,p,b,E,A,B,$,he,Ce,Me){for(var ke=a.context,et=ke.gl,$e=a.transform,pt="map"===B,Ke="map"===$,ft=pt&&"point"!==o.layout.get("symbol-placement"),It=pt&&!Ke&&!ft,Wt=void 0!==o.layout.get("symbol-sort-key").constantOr(1),pr=!1,nr=a.depthModeForSublayer(0,G.ReadOnly),br=o.layout.get("text-variable-anchor"),Dr=[],Qr=0,Xr=p;Qr<Xr.length;Qr+=1){var dn=Xr[Qr],qn=s.getTile(dn),Vn=qn.getBucket(o);if(Vn){var Nn=b?Vn.text:Vn.icon;if(Nn&&Nn.segments.get().length){var Li=Nn.programConfigurations.get(o.id),Dn=b||Vn.sdfIcons,gi=b?Vn.textSizeData:Vn.iconSizeData,Vi=Ke||0!==$e.pitch,li=a.useProgram(Wc(Dn,b,Vn),Li),yi=l.evaluateSizeForZoom(gi,$e.zoom),Fi=void 0,te=[0,0],ie=void 0,F=void 0,U=null,de=void 0;if(b)ie=qn.glyphAtlasTexture,F=et.LINEAR,Fi=qn.glyphAtlasTexture.size,Vn.iconsInText&&(te=qn.imageAtlasTexture.size,U=qn.imageAtlasTexture,de=Vi||a.options.rotating||a.options.zooming||"composite"===gi.kind||"camera"===gi.kind?et.LINEAR:et.NEAREST);else{var Te=1!==o.layout.get("icon-size").constantOr(0)||Vn.iconsNeedLinear;ie=qn.imageAtlasTexture,F=Dn||a.options.rotating||a.options.zooming||Te||Vi?et.LINEAR:et.NEAREST,Fi=qn.imageAtlasTexture.size}var mt=ma(qn,1,a.transform.zoom),Nt=Ia(dn.posMatrix,Ke,pt,a.transform,mt),Lt=Gi(dn.posMatrix,Ke,pt,a.transform,mt),lr=br&&Vn.hasTextData(),jr="none"!==o.layout.get("icon-text-fit")&&lr&&Vn.hasIconData();ft&&Ho(Vn,dn.posMatrix,a,b,Nt,Lt,Ke,he);var Ln=a.translatePosMatrix(dn.posMatrix,qn,E,A),Xn=ft||b&&br||jr?Vs:Nt,ni=a.translatePosMatrix(Lt,qn,E,A,!0),Ci=Dn&&0!==o.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1),Si={program:li,buffers:Nn,uniformValues:Dn?Vn.iconsInText?pl(gi.kind,yi,It,Ke,a,Ln,Xn,ni,Fi,te):$u(gi.kind,yi,It,Ke,a,Ln,Xn,ni,b,Fi,!0):yu(gi.kind,yi,It,Ke,a,Ln,Xn,ni,b,Fi),atlasTexture:ie,atlasTextureIcon:U,atlasInterpolation:F,atlasInterpolationIcon:de,isSDF:Dn,hasHalo:Ci};if(Wt&&Vn.canOverlap){pr=!0;for(var ea=0,xa=Nn.segments.get();ea<xa.length;ea+=1){var ua=xa[ea];Dr.push({segments:new l.SegmentVector([ua]),sortKey:ua.sortKey,state:Si})}}else Dr.push({segments:Nn.segments,sortKey:0,state:Si})}}}pr&&Dr.sort(function(la,no){return la.sortKey-no.sortKey});for(var Ha=0,Wa=Dr;Ha<Wa.length;Ha+=1){var Ka=Wa[Ha],ia=Ka.state;if(ke.activeTexture.set(et.TEXTURE0),ia.atlasTexture.bind(ia.atlasInterpolation,et.CLAMP_TO_EDGE),ia.atlasTextureIcon&&(ke.activeTexture.set(et.TEXTURE1),ia.atlasTextureIcon&&ia.atlasTextureIcon.bind(ia.atlasInterpolationIcon,et.CLAMP_TO_EDGE)),ia.isSDF){var ga=ia.uniformValues;ia.hasHalo&&(ga.u_is_halo=1,vl(ia.buffers,Ka.segments,o,a,ia.program,nr,Ce,Me,ga)),ga.u_is_halo=0}vl(ia.buffers,Ka.segments,o,a,ia.program,nr,Ce,Me,ia.uniformValues)}}function vl(a,s,o,p,b,E,A,B,$){var he=p.context;b.draw(he,he.gl.TRIANGLES,E,A,B,Oe.disabled,$,o.id,a.layoutVertexBuffer,a.indexBuffer,s,o.paint,p.transform.zoom,a.programConfigurations.get(o.id),a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer)}function Fl(a,s,o,p,b,E,A){var B,$,he,Ce,Me,ke=a.context.gl,et=o.paint.get("fill-pattern"),$e=et&&et.constantOr(1),pt=o.getCrossfadeParameters();A?($=$e&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=ke.LINES):($=$e?"fillPattern":"fill",B=ke.TRIANGLES);for(var Ke=0,ft=p;Ke<ft.length;Ke+=1){var It=ft[Ke],Wt=s.getTile(It);if(!$e||Wt.patternsLoaded()){var pr=Wt.getBucket(o);if(pr){var nr=pr.programConfigurations.get(o.id),br=a.useProgram($,nr);$e&&(a.context.activeTexture.set(ke.TEXTURE0),Wt.imageAtlasTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),nr.updatePaintBuffers(pt));var Dr=et.constantOr(null);if(Dr&&Wt.imageAtlas){var Qr=Wt.imageAtlas,Xr=Qr.patternPositions[Dr.to.toString()],dn=Qr.patternPositions[Dr.from.toString()];Xr&&dn&&nr.setConstantPatternPositions(Xr,dn)}var qn=a.translatePosMatrix(It.posMatrix,Wt,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(A){Ce=pr.indexBuffer2,Me=pr.segments2;var Vn=[ke.drawingBufferWidth,ke.drawingBufferHeight];he="fillOutlinePattern"===$&&$e?Tc(qn,a,pt,Wt,Vn):oo(qn,Vn)}else Ce=pr.indexBuffer,Me=pr.segments,he=$e?tu(qn,a,pt,Wt):gu(qn);br.draw(a.context,B,b,a.stencilModeForClipping(It),E,Oe.disabled,he,o.id,pr.layoutVertexBuffer,Ce,Me,o.paint,a.transform.zoom,nr)}}}}function ic(a,s,o,p,b,E,A){for(var B=a.context,$=B.gl,he=o.paint.get("fill-extrusion-pattern"),Ce=he.constantOr(1),Me=o.getCrossfadeParameters(),ke=o.paint.get("fill-extrusion-opacity"),et=0,$e=p;et<$e.length;et+=1){var pt=$e[et],Ke=s.getTile(pt),ft=Ke.getBucket(o);if(ft){var It=ft.programConfigurations.get(o.id),Wt=a.useProgram(Ce?"fillExtrusionPattern":"fillExtrusion",It);Ce&&(a.context.activeTexture.set($.TEXTURE0),Ke.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),It.updatePaintBuffers(Me));var pr=he.constantOr(null);if(pr&&Ke.imageAtlas){var nr=Ke.imageAtlas,br=nr.patternPositions[pr.to.toString()],Dr=nr.patternPositions[pr.from.toString()];br&&Dr&&It.setConstantPatternPositions(br,Dr)}var Qr=a.translatePosMatrix(pt.posMatrix,Ke,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Xr=o.paint.get("fill-extrusion-vertical-gradient"),dn=Ce?mu(Qr,a,Xr,ke,pt,Me,Ke):Nl(Qr,a,Xr,ke);Wt.draw(B,B.gl.TRIANGLES,b,E,A,Oe.backCCW,dn,o.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,o.paint,a.transform.zoom,It)}}}function Fu(a,s,o,p,b,E){var A=a.context,B=A.gl,$=s.fbo;if($){var he=a.useProgram("hillshade");A.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,$.colorAttachment.get());var Ce=function(Me,ke,et){var $e=et.paint.get("hillshade-shadow-color"),pt=et.paint.get("hillshade-highlight-color"),Ke=et.paint.get("hillshade-accent-color"),ft=et.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===et.paint.get("hillshade-illumination-anchor")&&(ft-=Me.transform.angle);var It,Wt,pr,nr=!Me.options.moving;return{u_matrix:Me.transform.calculatePosMatrix(ke.tileID.toUnwrapped(),nr),u_image:0,u_latrange:(It=ke.tileID,Wt=Math.pow(2,It.canonical.z),pr=It.canonical.y,[new l.MercatorCoordinate(0,pr/Wt).toLngLat().lat,new l.MercatorCoordinate(0,(pr+1)/Wt).toLngLat().lat]),u_light:[et.paint.get("hillshade-exaggeration"),ft],u_shadow:$e,u_highlight:pt,u_accent:Ke}}(a,s,o);he.draw(A,B.TRIANGLES,p,b,E,Oe.disabled,Ce,o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}}function uf(a,s,o,p,b,E){var pt,Ke,ft,It,A=a.context,B=A.gl,$=s.dem;if($&&$.data){var he=$.dim,Ce=$.stride,Me=$.getPixels();if(A.activeTexture.set(B.TEXTURE1),A.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||a.getTileTexture(Ce),s.demTexture){var ke=s.demTexture;ke.update(Me,{premultiply:!1}),ke.bind(B.NEAREST,B.CLAMP_TO_EDGE)}else s.demTexture=new l.Texture(A,Me,B.RGBA,{premultiply:!1}),s.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE);A.activeTexture.set(B.TEXTURE0);var et=s.fbo;if(!et){var $e=new l.Texture(A,{width:he,height:he,data:null},B.RGBA);$e.bind(B.LINEAR,B.CLAMP_TO_EDGE),(et=s.fbo=A.createFramebuffer(he,he,!0)).colorAttachment.set($e.texture)}A.bindFramebuffer.set(et.framebuffer),A.viewport.set([0,0,he,he]),a.useProgram("hillshadePrepare").draw(A,B.TRIANGLES,p,b,E,Oe.disabled,(pt=s.tileID,ft=(Ke=$).stride,It=l.create(),l.ortho(It,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(It,It,[0,-l.EXTENT,0]),{u_matrix:It,u_image:1,u_dimension:[ft,ft],u_zoom:pt.overscaledZ,u_unpack:Ke.getUnpackVector()}),o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Cu(a,s,o,p,b){var E=p.paint.get("raster-fade-duration");if(E>0){var A=l.browser.now(),B=(A-a.timeAdded)/E,$=s?(A-s.timeAdded)/E:-1,he=o.getSource(),Ce=b.coveringZoomLevel({tileSize:he.tileSize,roundZoom:he.roundZoom}),Me=!s||Math.abs(s.tileID.overscaledZ-Ce)>Math.abs(a.tileID.overscaledZ-Ce),ke=Me&&a.refreshedUponExpiration?1:l.clamp(Me?B:1-$,0,1);return a.refreshedUponExpiration&&B>=1&&(a.refreshedUponExpiration=!1),s?{opacity:1,mix:1-ke}:{opacity:ke,mix:0}}return{opacity:1,mix:0}}var zu=new l.Color(1,0,0,1),nu=new l.Color(0,1,0,1),Au=new l.Color(0,0,1,1),js=new l.Color(1,0,1,1),zl=new l.Color(0,1,1,1);function ac(a,s,o,p){Zu(a,0,s+o/2,a.transform.width,o,p)}function oc(a,s,o,p){Zu(a,s-o/2,0,o,a.transform.height,p)}function Zu(a,s,o,p,b,E){var A=a.context,B=A.gl;B.enable(B.SCISSOR_TEST),B.scissor(s*l.browser.devicePixelRatio,o*l.browser.devicePixelRatio,p*l.browser.devicePixelRatio,b*l.browser.devicePixelRatio),A.clear({color:E}),B.disable(B.SCISSOR_TEST)}function ns(a,s,o){var p=a.context,b=p.gl,E=o.posMatrix,A=a.useProgram("debug"),B=G.disabled,$=oe.disabled,he=a.colorModeForRenderPass();p.activeTexture.set(b.TEXTURE0),a.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),A.draw(p,b.LINE_STRIP,B,$,he,Oe.disabled,ru(E,l.Color.red),"$debug",a.debugBuffer,a.tileBorderIndexBuffer,a.debugSegments);var Ce=s.getTileByID(o.key).latestRawTileData,Me=Math.floor((Ce&&Ce.byteLength||0)/1024),ke=s.getTile(o).tileSize,et=512/Math.min(ke,512)*(o.overscaledZ/a.transform.zoom)*.5,$e=o.canonical.toString();o.overscaledZ!==o.canonical.z&&($e+=" => "+o.overscaledZ),function(pt,Ke){pt.initDebugOverlayCanvas();var ft=pt.debugOverlayCanvas,It=pt.context.gl,Wt=pt.debugOverlayCanvas.getContext("2d");Wt.clearRect(0,0,ft.width,ft.height),Wt.shadowColor="white",Wt.shadowBlur=2,Wt.lineWidth=1.5,Wt.strokeStyle="white",Wt.textBaseline="top",Wt.font="bold 36px Open Sans, sans-serif",Wt.fillText(Ke,5,5),Wt.strokeText(Ke,5,5),pt.debugOverlayTexture.update(ft),pt.debugOverlayTexture.bind(It.LINEAR,It.CLAMP_TO_EDGE)}(a,$e+" "+Me+"kb"),A.draw(p,b.TRIANGLES,B,$,xe.alphaBlended,Oe.disabled,ru(E,l.Color.transparent,et),"$debug",a.debugBuffer,a.quadTriangleIndexBuffer,a.debugSegments)}var rl={symbol:function(a,s,o,p,b){if("translucent"===a.renderPass){var E=oe.disabled,A=a.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(B,$,he,Ce,Me,ke,et){for(var $e=$.transform,pt="map"===Me,Ke="map"===ke,ft=0,It=B;ft<It.length;ft+=1){var Wt=It[ft],pr=Ce.getTile(Wt),nr=pr.getBucket(he);if(nr&&nr.text&&nr.text.segments.get().length){var br=l.evaluateSizeForZoom(nr.textSizeData,$e.zoom),Dr=ma(pr,1,$.transform.zoom),Qr=Ia(Wt.posMatrix,Ke,pt,$.transform,Dr),Xr="none"!==he.layout.get("icon-text-fit")&&nr.hasIconData();if(br){var dn=Math.pow(2,$e.zoom-pr.tileID.overscaledZ);Ic(nr,pt,Ke,et,l.symbolSize,$e,Qr,Wt.posMatrix,dn,br,Xr)}}}}(p,a,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),b),0!==o.paint.get("icon-opacity").constantOr(1)&&tl(a,s,o,p,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),E,A),0!==o.paint.get("text-opacity").constantOr(1)&&tl(a,s,o,p,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),E,A),s.map.showCollisionBoxes&&(Bu(a,s,o,p,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Bu(a,s,o,p,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(a,s,o,p){if("translucent"===a.renderPass){var b=o.paint.get("circle-opacity"),E=o.paint.get("circle-stroke-width"),A=o.paint.get("circle-stroke-opacity"),B=void 0!==o.layout.get("circle-sort-key").constantOr(1);if(0!==b.constantOr(1)||0!==E.constantOr(1)&&0!==A.constantOr(1)){for(var $=a.context,he=$.gl,Ce=a.depthModeForSublayer(0,G.ReadOnly),Me=oe.disabled,ke=a.colorModeForRenderPass(),et=[],$e=0;$e<p.length;$e++){var pt=p[$e],Ke=s.getTile(pt),ft=Ke.getBucket(o);if(ft){var It=ft.programConfigurations.get(o.id),Wt={programConfiguration:It,program:a.useProgram("circle",It),layoutVertexBuffer:ft.layoutVertexBuffer,indexBuffer:ft.indexBuffer,uniformValues:Cc(a,pt,Ke,o)};if(B)for(var pr=0,nr=ft.segments.get();pr<nr.length;pr+=1){var br=nr[pr];et.push({segments:new l.SegmentVector([br]),sortKey:br.sortKey,state:Wt})}else et.push({segments:ft.segments,sortKey:0,state:Wt})}}B&&et.sort(function(qn,Vn){return qn.sortKey-Vn.sortKey});for(var Dr=0,Qr=et;Dr<Qr.length;Dr+=1){var Xr=Qr[Dr],dn=Xr.state;dn.program.draw($,he.TRIANGLES,Ce,Me,ke,Oe.disabled,dn.uniformValues,o.id,dn.layoutVertexBuffer,dn.indexBuffer,Xr.segments,o.paint,a.transform.zoom,dn.programConfiguration)}}}},heatmap:function(a,s,o,p){if(0!==o.paint.get("heatmap-opacity"))if("offscreen"===a.renderPass){var b=a.context,E=b.gl,A=oe.disabled,B=new xe([E.ONE,E.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(et,$e,pt){var Ke=et.gl;et.activeTexture.set(Ke.TEXTURE1),et.viewport.set([0,0,$e.width/4,$e.height/4]);var Wt,pr,nr,br,Dr,ft=pt.heatmapFbo;if(ft)Ke.bindTexture(Ke.TEXTURE_2D,ft.colorAttachment.get()),et.bindFramebuffer.set(ft.framebuffer);else{var It=Ke.createTexture();Ke.bindTexture(Ke.TEXTURE_2D,It),Ke.texParameteri(Ke.TEXTURE_2D,Ke.TEXTURE_WRAP_S,Ke.CLAMP_TO_EDGE),Ke.texParameteri(Ke.TEXTURE_2D,Ke.TEXTURE_WRAP_T,Ke.CLAMP_TO_EDGE),Ke.texParameteri(Ke.TEXTURE_2D,Ke.TEXTURE_MIN_FILTER,Ke.LINEAR),Ke.texParameteri(Ke.TEXTURE_2D,Ke.TEXTURE_MAG_FILTER,Ke.LINEAR),nr=It,br=ft=pt.heatmapFbo=et.createFramebuffer($e.width/4,$e.height/4,!1),(Dr=(Wt=et).gl).texImage2D(Dr.TEXTURE_2D,0,Dr.RGBA,(pr=$e).width/4,pr.height/4,0,Dr.RGBA,Wt.extRenderToTextureHalfFloat?Wt.extTextureHalfFloat.HALF_FLOAT_OES:Dr.UNSIGNED_BYTE,null),br.colorAttachment.set(nr)}})(b,a,o),b.clear({color:l.Color.transparent});for(var $=0;$<p.length;$++){var he=p[$];if(!s.hasRenderableParent(he)){var Ce=s.getTile(he),Me=Ce.getBucket(o);if(Me){var ke=Me.programConfigurations.get(o.id);a.useProgram("heatmap",ke).draw(b,E.TRIANGLES,G.disabled,A,B,Oe.disabled,rc(he.posMatrix,Ce,a.transform.zoom,o.paint.get("heatmap-intensity")),o.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,o.paint,a.transform.zoom,ke)}}}b.viewport.set([0,0,a.width,a.height])}else"translucent"===a.renderPass&&(a.context.setColorMode(a.colorModeForRenderPass()),function(et,$e){var pt=et.context,Ke=pt.gl,ft=$e.heatmapFbo;if(ft){pt.activeTexture.set(Ke.TEXTURE0),Ke.bindTexture(Ke.TEXTURE_2D,ft.colorAttachment.get()),pt.activeTexture.set(Ke.TEXTURE1);var It=$e.colorRampTexture;It||(It=$e.colorRampTexture=new l.Texture(pt,$e.colorRamp,Ke.RGBA)),It.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),et.useProgram("heatmapTexture").draw(pt,Ke.TRIANGLES,G.disabled,oe.disabled,et.colorModeForRenderPass(),Oe.disabled,function(Wt,pr,nr,br){var Dr=l.create();l.ortho(Dr,0,Wt.width,Wt.height,0,0,1);var Qr=Wt.context.gl;return{u_matrix:Dr,u_world:[Qr.drawingBufferWidth,Qr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:pr.paint.get("heatmap-opacity")}}(et,$e),$e.id,et.viewportBuffer,et.quadTriangleIndexBuffer,et.viewportSegments,$e.paint,et.transform.zoom)}}(a,o))},line:function(a,s,o,p){if("translucent"===a.renderPass){var b=o.paint.get("line-opacity"),E=o.paint.get("line-width");if(0!==b.constantOr(1)&&0!==E.constantOr(1))for(var A=a.depthModeForSublayer(0,G.ReadOnly),B=a.colorModeForRenderPass(),$=o.paint.get("line-dasharray"),he=o.paint.get("line-pattern"),Ce=he.constantOr(1),Me=o.paint.get("line-gradient"),ke=o.getCrossfadeParameters(),et=Ce?"linePattern":$?"lineSDF":Me?"lineGradient":"line",$e=a.context,pt=$e.gl,Ke=!0,ft=0,It=p;ft<It.length;ft+=1){var Wt=It[ft],pr=s.getTile(Wt);if(!Ce||pr.patternsLoaded()){var nr=pr.getBucket(o);if(nr){var br=nr.programConfigurations.get(o.id),Dr=a.context.program.get(),Qr=a.useProgram(et,br),Xr=Ke||Qr.program!==Dr,dn=he.constantOr(null);if(dn&&pr.imageAtlas){var qn=pr.imageAtlas,Vn=qn.patternPositions[dn.to.toString()],Nn=qn.patternPositions[dn.from.toString()];Vn&&Nn&&br.setConstantPatternPositions(Vn,Nn)}var Li=Ce?Ju(a,pr,o,ke):$?Gc(a,pr,o,$,ke):Me?La(a,pr,o,nr.lineClipsArray.length):Nu(a,pr,o);if(Ce)$e.activeTexture.set(pt.TEXTURE0),pr.imageAtlasTexture.bind(pt.LINEAR,pt.CLAMP_TO_EDGE),br.updatePaintBuffers(ke);else if($&&(Xr||a.lineAtlas.dirty))$e.activeTexture.set(pt.TEXTURE0),a.lineAtlas.bind($e);else if(Me){var Dn=nr.gradients[o.id],gi=Dn.texture;if(o.gradientVersion!==Dn.version){var Vi=256;if(o.stepInterpolant){var li=s.getSource().maxzoom,yi=Wt.canonical.z===li?Math.ceil(1<<a.transform.maxZoom-Wt.canonical.z):1;Vi=l.clamp(l.nextPowerOfTwo(nr.maxLineLength/l.EXTENT*1024*yi),256,$e.maxTextureSize)}Dn.gradient=l.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Vi,image:Dn.gradient||void 0,clips:nr.lineClipsArray}),Dn.texture?Dn.texture.update(Dn.gradient):Dn.texture=new l.Texture($e,Dn.gradient,pt.RGBA),Dn.version=o.gradientVersion,gi=Dn.texture}$e.activeTexture.set(pt.TEXTURE0),gi.bind(o.stepInterpolant?pt.NEAREST:pt.LINEAR,pt.CLAMP_TO_EDGE)}Qr.draw($e,pt.TRIANGLES,A,a.stencilModeForClipping(Wt),B,Oe.disabled,Li,o.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,o.paint,a.transform.zoom,br,nr.layoutVertexBuffer2),Ke=!1}}}}},fill:function(a,s,o,p){var b=o.paint.get("fill-color"),E=o.paint.get("fill-opacity");if(0!==E.constantOr(1)){var A=a.colorModeForRenderPass(),B=o.paint.get("fill-pattern"),$=a.opaquePassEnabledForLayer()&&!B.constantOr(1)&&1===b.constantOr(l.Color.transparent).a&&1===E.constantOr(0)?"opaque":"translucent";if(a.renderPass===$){var he=a.depthModeForSublayer(1,"opaque"===a.renderPass?G.ReadWrite:G.ReadOnly);Fl(a,s,o,p,he,A,!1)}if("translucent"===a.renderPass&&o.paint.get("fill-antialias")){var Ce=a.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,G.ReadOnly);Fl(a,s,o,p,Ce,A,!0)}}},"fill-extrusion":function(a,s,o,p){var b=o.paint.get("fill-extrusion-opacity");if(0!==b&&"translucent"===a.renderPass){var E=new G(a.context.gl.LEQUAL,G.ReadWrite,a.depthRangeFor3D);if(1!==b||o.paint.get("fill-extrusion-pattern").constantOr(1))ic(a,s,o,p,E,oe.disabled,xe.disabled),ic(a,s,o,p,E,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var A=a.colorModeForRenderPass();ic(a,s,o,p,E,oe.disabled,A)}}},hillshade:function(a,s,o,p){if("offscreen"===a.renderPass||"translucent"===a.renderPass){for(var b=a.context,E=a.depthModeForSublayer(0,G.ReadOnly),A=a.colorModeForRenderPass(),B="translucent"===a.renderPass?a.stencilConfigForOverlap(p):[{},p],$=B[0],he=0,Ce=B[1];he<Ce.length;he+=1){var Me=Ce[he],ke=s.getTile(Me);ke.needsHillshadePrepare&&"offscreen"===a.renderPass?uf(a,ke,o,E,oe.disabled,A):"translucent"===a.renderPass&&Fu(a,ke,o,E,$[Me.overscaledZ],A)}b.viewport.set([0,0,a.width,a.height])}},raster:function(a,s,o,p){if("translucent"===a.renderPass&&0!==o.paint.get("raster-opacity")&&p.length)for(var b=a.context,E=b.gl,A=s.getSource(),B=a.useProgram("raster"),$=a.colorModeForRenderPass(),he=A instanceof Ie?[{},p]:a.stencilConfigForOverlap(p),Ce=he[0],Me=he[1],ke=Me[Me.length-1].overscaledZ,et=!a.options.moving,$e=0,pt=Me;$e<pt.length;$e+=1){var Ke=pt[$e],ft=a.depthModeForSublayer(Ke.overscaledZ-ke,1===o.paint.get("raster-opacity")?G.ReadWrite:G.ReadOnly,E.LESS),It=s.getTile(Ke),Wt=a.transform.calculatePosMatrix(Ke.toUnwrapped(),et);It.registerFadeDuration(o.paint.get("raster-fade-duration"));var pr=s.findLoadedParent(Ke,0),nr=Cu(It,pr,s,o,a.transform),br=void 0,Dr=void 0,Qr="nearest"===o.paint.get("raster-resampling")?E.NEAREST:E.LINEAR;b.activeTexture.set(E.TEXTURE0),It.texture.bind(Qr,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),b.activeTexture.set(E.TEXTURE1),pr?(pr.texture.bind(Qr,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),br=Math.pow(2,pr.tileID.overscaledZ-It.tileID.overscaledZ),Dr=[It.tileID.canonical.x*br%1,It.tileID.canonical.y*br%1]):It.texture.bind(Qr,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST);var Xr=Hc(Wt,Dr||[0,0],br||1,nr,o);A instanceof Ie?B.draw(b,E.TRIANGLES,ft,oe.disabled,$,Oe.disabled,Xr,o.id,A.boundsBuffer,a.quadTriangleIndexBuffer,A.boundsSegments):B.draw(b,E.TRIANGLES,ft,Ce[Ke.overscaledZ],$,Oe.disabled,Xr,o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,s,o){var p=o.paint.get("background-color"),b=o.paint.get("background-opacity");if(0!==b){var E=a.context,A=E.gl,B=a.transform,$=B.tileSize,he=o.paint.get("background-pattern");if(!a.isPatternMissing(he)){var Ce=!he&&1===p.a&&1===b&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===Ce){var Me=oe.disabled,ke=a.depthModeForSublayer(0,"opaque"===Ce?G.ReadWrite:G.ReadOnly),et=a.colorModeForRenderPass(),$e=a.useProgram(he?"backgroundPattern":"background"),pt=B.coveringTiles({tileSize:$});he&&(E.activeTexture.set(A.TEXTURE0),a.imageManager.bind(a.context));for(var Ke=o.getCrossfadeParameters(),ft=0,It=pt;ft<It.length;ft+=1){var Wt=It[ft],pr=a.transform.calculatePosMatrix(Wt.toUnwrapped()),nr=he?el(pr,b,a,he,{tileID:Wt,tileSize:$},Ke):Qu(pr,b,p);$e.draw(E,A.TRIANGLES,ke,Me,et,Oe.disabled,nr,o.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,s,o){for(var p=0;p<o.length;p++)ns(a,s,o[p])},custom:function(a,s,o){var p=a.context,b=o.implementation;if("offscreen"===a.renderPass){var E=b.prerender;E&&(a.setCustomLayerDefaults(),p.setColorMode(a.colorModeForRenderPass()),E.call(b,p.gl,a.transform.customLayerMatrix()),p.setDirty(),a.setBaseState())}else if("translucent"===a.renderPass){a.setCustomLayerDefaults(),p.setColorMode(a.colorModeForRenderPass()),p.setStencilMode(oe.disabled);var A="3d"===b.renderingMode?new G(a.context.gl.LEQUAL,G.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,G.ReadOnly);p.setDepthMode(A),b.render(p.gl,a.transform.customLayerMatrix()),p.setDirty(),a.setBaseState(),p.bindFramebuffer.set(null)}}},$a=function(a,s){this.context=new pe(a),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=Ae.maxUnderzooming+Ae.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Lo,this.gpuTimers={}};$a.prototype.resize=function(a,s){if(this.width=a*l.browser.devicePixelRatio,this.height=s*l.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,p=this.style._order;o<p.length;o+=1)this.style._layers[p[o]].resize()},$a.prototype.setup=function(){var a=this.context,s=new l.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(l.EXTENT,0),s.emplaceBack(0,l.EXTENT),s.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(s,Oa.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);var o=new l.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(l.EXTENT,0),o.emplaceBack(0,l.EXTENT),o.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=a.createVertexBuffer(o,Oa.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);var p=new l.StructArrayLayout4i8;p.emplaceBack(0,0,0,0),p.emplaceBack(l.EXTENT,0,l.EXTENT,0),p.emplaceBack(0,l.EXTENT,0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=a.createVertexBuffer(p,me.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);var b=new l.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(b,Oa.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);var E=new l.StructArrayLayout1ui2;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=a.createIndexBuffer(E);var A=new l.StructArrayLayout3ui6;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(A),this.emptyTexture=new l.Texture(a,{width:1,height:1,data:new Uint8Array([0,0,0,0])},a.gl.RGBA);var B=this.context.gl;this.stencilClearMode=new oe({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO)},$a.prototype.clearStencil=function(){var a=this.context,s=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=l.create();l.ortho(o,0,this.width,this.height,0,0,1),l.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(a,s.TRIANGLES,G.disabled,this.stencilClearMode,xe.disabled,Oe.disabled,Rs(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},$a.prototype._renderTileClippingMasks=function(a,s){if(this.currentStencilSource!==a.source&&a.isTileClipped()&&s&&s.length){this.currentStencilSource=a.source;var o=this.context,p=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(xe.disabled),o.setDepthMode(G.disabled);var b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var E=0,A=s;E<A.length;E+=1){var B=A[E],$=this._tileClippingMaskIDs[B.key]=this.nextStencilID++;b.draw(o,p.TRIANGLES,G.disabled,new oe({func:p.ALWAYS,mask:0},$,255,p.KEEP,p.KEEP,p.REPLACE),xe.disabled,Oe.disabled,Rs(B.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},$a.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var a=this.nextStencilID++,s=this.context.gl;return new oe({func:s.NOTEQUAL,mask:255},a,255,s.KEEP,s.KEEP,s.REPLACE)},$a.prototype.stencilModeForClipping=function(a){var s=this.context.gl;return new oe({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,s.KEEP,s.KEEP,s.REPLACE)},$a.prototype.stencilConfigForOverlap=function(a){var s,o=this.context.gl,p=a.sort(function($,he){return he.overscaledZ-$.overscaledZ}),b=p[p.length-1].overscaledZ,E=p[0].overscaledZ-b+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();for(var A={},B=0;B<E;B++)A[B+b]=new oe({func:o.GEQUAL,mask:255},B+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=E,[A,p]}return[(s={},s[b]=oe.disabled,s),p]},$a.prototype.colorModeForRenderPass=function(){var a=this.context.gl;return this._showOverdrawInspector?new xe([a.CONSTANT_COLOR,a.ONE],new l.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?xe.unblended:xe.alphaBlended},$a.prototype.depthModeForSublayer=function(a,s,o){if(!this.opaquePassEnabledForLayer())return G.disabled;var p=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new G(o||this.context.gl.LEQUAL,s,[p,p])},$a.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},$a.prototype.render=function(a,s){var o=this;this.style=a,this.options=s,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(l.browser.now()),this.imageManager.beginFrame();var p=this.style._order,b=this.style.sourceCaches;for(var E in b){var A=b[E];A.used&&A.prepare(this.context)}var B,$,he={},Ce={},Me={};for(var ke in b){var et=b[ke];he[ke]=et.getVisibleCoordinates(),Ce[ke]=he[ke].slice().reverse(),Me[ke]=et.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var $e=0;$e<p.length;$e++)if(this.style._layers[p[$e]].is3D()){this.opaquePassCutoff=$e;break}this.renderPass="offscreen";for(var pt=0,Ke=p;pt<Ke.length;pt+=1){var ft=this.style._layers[Ke[pt]];if(ft.hasOffscreenPass()&&!ft.isHidden(this.transform.zoom)){var It=Ce[ft.source];("custom"===ft.type||It.length)&&this.renderLayer(this,b[ft.source],ft,It)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(a._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){var Wt=this.style._layers[p[this.currentLayer]],pr=b[Wt.source],nr=he[Wt.source];this._renderTileClippingMasks(Wt,nr),this.renderLayer(this,pr,Wt,nr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){var br=this.style._layers[p[this.currentLayer]],Dr=b[br.source],Qr=("symbol"===br.type?Me:Ce)[br.source];this._renderTileClippingMasks(br,he[br.source]),this.renderLayer(this,Dr,br,Qr)}this.options.showTileBoundaries&&(l.values(this.style._layers).forEach(function(Xr){Xr.source&&!Xr.isHidden(o.transform.zoom)&&(Xr.source!==($&&$.id)&&($=o.style.sourceCaches[Xr.source]),(!B||B.getSource().maxzoom<$.getSource().maxzoom)&&(B=$))}),B&&rl.debug(this,B,B.getVisibleCoordinates())),this.options.showPadding&&function(Xr){var dn=Xr.transform.padding;ac(Xr,Xr.transform.height-(dn.top||0),3,zu),ac(Xr,dn.bottom||0,3,nu),oc(Xr,dn.left||0,3,Au),oc(Xr,Xr.transform.width-(dn.right||0),3,js);var Vn,Nn,Li,Dn,qn=Xr.transform.centerPoint;Zu(Vn=Xr,(Nn=qn.x)-1,(Li=Xr.transform.height-qn.y)-10,2,20,Dn=zl),Zu(Vn,Nn-10,Li-1,20,2,Dn)}(this),this.context.setDefault()},$a.prototype.renderLayer=function(a,s,o,p){o.isHidden(this.transform.zoom)||("background"===o.type||"custom"===o.type||p.length)&&(this.id=o.id,this.gpuTimingStart(o),rl[o.type](a,s,o,p,this.style.placement.variableOffsets),this.gpuTimingEnd())},$a.prototype.gpuTimingStart=function(a){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[a.id];o||(o=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},$a.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}},$a.prototype.collectGpuTimers=function(){var a=this.gpuTimers;return this.gpuTimers={},a},$a.prototype.queryGpuTimers=function(a){var s={};for(var o in a){var p=a[o],b=this.context.extTimerQuery,E=b.getQueryObjectEXT(p.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(p.query),s[o]=E}return s},$a.prototype.translatePosMatrix=function(a,s,o,p,b){if(!o[0]&&!o[1])return a;var E=b?"map"===p?this.transform.angle:0:"viewport"===p?-this.transform.angle:0;if(E){var A=Math.sin(E),B=Math.cos(E);o=[o[0]*B-o[1]*A,o[0]*A+o[1]*B]}var $=[b?o[0]:ma(s,o[0],this.transform.zoom),b?o[1]:ma(s,o[1],this.transform.zoom),0],he=new Float32Array(16);return l.translate(he,a,$),he},$a.prototype.saveTileTexture=function(a){var s=this._tileTextures[a.size[0]];s?s.push(a):this._tileTextures[a.size[0]]=[a]},$a.prototype.getTileTexture=function(a){var s=this._tileTextures[a];return s&&s.length>0?s.pop():null},$a.prototype.isPatternMissing=function(a){if(!a)return!1;if(!a.from||!a.to)return!0;var s=this.imageManager.getPattern(a.from.toString()),o=this.imageManager.getPattern(a.to.toString());return!s||!o},$a.prototype.useProgram=function(a,s){this.cache=this.cache||{};var o=""+a+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new Ec(this.context,a,Xo[a],s,dl[a],this._showOverdrawInspector)),this.cache[o]},$a.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},$a.prototype.setBaseState=function(){var a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)},$a.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},$a.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Zl=function(a,s){this.points=a,this.planes=s};Zl.fromInvProjectionMatrix=function(a,s,o){var p=Math.pow(2,o),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(A){return l.transformMat4([],A,a)}).map(function(A){return l.scale$1([],A,1/A[3]/s*p)}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(A){var B=l.sub([],b[A[0]],b[A[1]]),$=l.sub([],b[A[2]],b[A[1]]),he=l.normalize([],l.cross([],B,$)),Ce=-l.dot(he,b[A[1]]);return he.concat(Ce)});return new Zl(b,E)};var Gs=function(a,s){this.min=a,this.max=s,this.center=l.scale$2([],l.add([],this.min,this.max),.5)};Gs.prototype.quadrant=function(a){for(var s=[a%2==0,a<2],o=l.clone$2(this.min),p=l.clone$2(this.max),b=0;b<s.length;b++)o[b]=s[b]?this.min[b]:this.center[b],p[b]=s[b]?this.center[b]:this.max[b];return p[2]=this.max[2],new Gs(o,p)},Gs.prototype.distanceX=function(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]},Gs.prototype.distanceY=function(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]},Gs.prototype.intersects=function(a){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,p=0;p<a.planes.length;p++){for(var b=a.planes[p],E=0,A=0;A<s.length;A++)E+=l.dot$1(b,s[A])>=0;if(0===E)return 0;E!==s.length&&(o=!1)}if(o)return 2;for(var B=0;B<3;B++){for(var $=Number.MAX_VALUE,he=-Number.MAX_VALUE,Ce=0;Ce<a.points.length;Ce++){var Me=a.points[Ce][B]-this.min[B];$=Math.min($,Me),he=Math.max(he,Me)}if(he<0||$>this.max[B]-this.min[B])return 0}return 1};var Pu=function(a,s,o,p){if(void 0===a&&(a=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===p&&(p=0),isNaN(a)||a<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=s,this.left=o,this.right=p};Pu.prototype.interpolate=function(a,s,o){return null!=s.top&&null!=a.top&&(this.top=l.number(a.top,s.top,o)),null!=s.bottom&&null!=a.bottom&&(this.bottom=l.number(a.bottom,s.bottom,o)),null!=s.left&&null!=a.left&&(this.left=l.number(a.left,s.left,o)),null!=s.right&&null!=a.right&&(this.right=l.number(a.right,s.right,o)),this},Pu.prototype.getCenter=function(a,s){var o=l.clamp((this.left+a-this.right)/2,0,a),p=l.clamp((this.top+s-this.bottom)/2,0,s);return new l.Point(o,p)},Pu.prototype.equals=function(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right},Pu.prototype.clone=function(){return new Pu(this.top,this.bottom,this.left,this.right)},Pu.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var sa=function(a,s,o,p,b){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===b||b,this._minZoom=a||0,this._maxZoom=s||22,this._minPitch=null==o?0:o,this._maxPitch=null==p?60:p,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Pu,this._posMatrixCache={},this._alignedPosMatrixCache={}},ja={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};sa.prototype.clone=function(){var a=new sa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.tileSize=this.tileSize,a.latRange=this.latRange,a.width=this.width,a.height=this.height,a._center=this._center,a.zoom=this.zoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._calcMatrices(),a},ja.minZoom.get=function(){return this._minZoom},ja.minZoom.set=function(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))},ja.maxZoom.get=function(){return this._maxZoom},ja.maxZoom.set=function(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))},ja.minPitch.get=function(){return this._minPitch},ja.minPitch.set=function(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))},ja.maxPitch.get=function(){return this._maxPitch},ja.maxPitch.set=function(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))},ja.renderWorldCopies.get=function(){return this._renderWorldCopies},ja.renderWorldCopies.set=function(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a},ja.worldSize.get=function(){return this.tileSize*this.scale},ja.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ja.size.get=function(){return new l.Point(this.width,this.height)},ja.bearing.get=function(){return-this.angle/Math.PI*180},ja.bearing.set=function(a){var s=-l.wrap(a,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=l.create$2(),l.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ja.pitch.get=function(){return this._pitch/Math.PI*180},ja.pitch.set=function(a){var s=l.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},ja.fov.get=function(){return this._fov/Math.PI*180},ja.fov.set=function(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())},ja.zoom.get=function(){return this._zoom},ja.zoom.set=function(a){var s=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},ja.center.get=function(){return this._center},ja.center.set=function(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())},ja.padding.get=function(){return this._edgeInsets.toJSON()},ja.padding.set=function(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())},ja.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},sa.prototype.isPaddingEqual=function(a){return this._edgeInsets.equals(a)},sa.prototype.interpolatePadding=function(a,s,o){this._unmodified=!1,this._edgeInsets.interpolate(a,s,o),this._constrain(),this._calcMatrices()},sa.prototype.coveringZoomLevel=function(a){var s=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,s)},sa.prototype.getVisibleUnwrappedCoordinates=function(a){var s=[new l.UnwrappedTileID(0,a)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new l.Point(0,0)),p=this.pointCoordinate(new l.Point(this.width,0)),b=this.pointCoordinate(new l.Point(this.width,this.height)),E=this.pointCoordinate(new l.Point(0,this.height)),A=Math.floor(Math.min(o.x,p.x,b.x,E.x)),B=Math.floor(Math.max(o.x,p.x,b.x,E.x)),$=A-1;$<=B+1;$++)0!==$&&s.push(new l.UnwrappedTileID($,a));return s},sa.prototype.coveringTiles=function(a){var s=this.coveringZoomLevel(a),o=s;if(void 0!==a.minzoom&&s<a.minzoom)return[];void 0!==a.maxzoom&&s>a.maxzoom&&(s=a.maxzoom);var p=l.MercatorCoordinate.fromLngLat(this.center),b=Math.pow(2,s),E=[b*p.x,b*p.y,0],A=Zl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),B=a.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(B=s);var $=function(Xr){return{aabb:new Gs([Xr*b,0,0],[(Xr+1)*b,b,0]),zoom:0,x:0,y:0,wrap:Xr,fullyVisible:!1}},he=[],Ce=[],Me=s,ke=a.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var et=1;et<=3;et++)he.push($(-et)),he.push($(et));for(he.push($(0));he.length>0;){var $e=he.pop(),pt=$e.x,Ke=$e.y,ft=$e.fullyVisible;if(!ft){var It=$e.aabb.intersects(A);if(0===It)continue;ft=2===It}var Wt=$e.aabb.distanceX(E),pr=$e.aabb.distanceY(E),nr=Math.max(Math.abs(Wt),Math.abs(pr));if($e.zoom===Me||nr>3+(1<<Me-$e.zoom)-2&&$e.zoom>=B)Ce.push({tileID:new l.OverscaledTileID($e.zoom===Me?ke:$e.zoom,$e.wrap,$e.zoom,pt,Ke),distanceSq:l.sqrLen([E[0]-.5-pt,E[1]-.5-Ke])});else for(var br=0;br<4;br++){var Dr=(pt<<1)+br%2,Qr=(Ke<<1)+(br>>1);he.push({aabb:$e.aabb.quadrant(br),zoom:$e.zoom+1,x:Dr,y:Qr,wrap:$e.wrap,fullyVisible:ft})}}return Ce.sort(function(Xr,dn){return Xr.distanceSq-dn.distanceSq}).map(function(Xr){return Xr.tileID})},sa.prototype.resize=function(a,s){this.width=a,this.height=s,this.pixelsToGLUnits=[2/a,-2/s],this._constrain(),this._calcMatrices()},ja.unmodified.get=function(){return this._unmodified},sa.prototype.zoomScale=function(a){return Math.pow(2,a)},sa.prototype.scaleZoom=function(a){return Math.log(a)/Math.LN2},sa.prototype.project=function(a){var s=l.clamp(a.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.Point(l.mercatorXfromLng(a.lng)*this.worldSize,l.mercatorYfromLat(s)*this.worldSize)},sa.prototype.unproject=function(a){return new l.MercatorCoordinate(a.x/this.worldSize,a.y/this.worldSize).toLngLat()},ja.point.get=function(){return this.project(this.center)},sa.prototype.setLocationAtPoint=function(a,s){var o=this.pointCoordinate(s),p=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(a),E=new l.MercatorCoordinate(b.x-(o.x-p.x),b.y-(o.y-p.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())},sa.prototype.locationPoint=function(a){return this.coordinatePoint(this.locationCoordinate(a))},sa.prototype.pointLocation=function(a){return this.coordinateLocation(this.pointCoordinate(a))},sa.prototype.locationCoordinate=function(a){return l.MercatorCoordinate.fromLngLat(a)},sa.prototype.coordinateLocation=function(a){return a.toLngLat()},sa.prototype.pointCoordinate=function(a){var s=[a.x,a.y,0,1],o=[a.x,a.y,1,1];l.transformMat4(s,s,this.pixelMatrixInverse),l.transformMat4(o,o,this.pixelMatrixInverse);var p=s[3],b=o[3],E=s[1]/p,A=o[1]/b,B=s[2]/p,$=o[2]/b,he=B===$?0:(0-B)/($-B);return new l.MercatorCoordinate(l.number(s[0]/p,o[0]/b,he)/this.worldSize,l.number(E,A,he)/this.worldSize)},sa.prototype.coordinatePoint=function(a){var s=[a.x*this.worldSize,a.y*this.worldSize,0,1];return l.transformMat4(s,s,this.pixelMatrix),new l.Point(s[0]/s[3],s[1]/s[3])},sa.prototype.getBounds=function(){return(new l.LngLatBounds).extend(this.pointLocation(new l.Point(0,0))).extend(this.pointLocation(new l.Point(this.width,0))).extend(this.pointLocation(new l.Point(this.width,this.height))).extend(this.pointLocation(new l.Point(0,this.height)))},sa.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},sa.prototype.setMaxBounds=function(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},sa.prototype.calculatePosMatrix=function(a,s){void 0===s&&(s=!1);var o=a.key,p=s?this._alignedPosMatrixCache:this._posMatrixCache;if(p[o])return p[o];var b=a.canonical,E=this.worldSize/this.zoomScale(b.z),A=b.x+Math.pow(2,b.z)*a.wrap,B=l.identity(new Float64Array(16));return l.translate(B,B,[A*E,b.y*E,0]),l.scale(B,B,[E/l.EXTENT,E/l.EXTENT,1]),l.multiply(B,s?this.alignedProjMatrix:this.projMatrix,B),p[o]=new Float32Array(B),p[o]},sa.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},sa.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var a,s,o,p,b=-90,E=90,A=-180,B=180,$=this.size,he=this._unmodified;if(this.latRange){var Ce=this.latRange;b=l.mercatorYfromLat(Ce[1])*this.worldSize,a=(E=l.mercatorYfromLat(Ce[0])*this.worldSize)-b<$.y?$.y/(E-b):0}if(this.lngRange){var Me=this.lngRange;A=l.mercatorXfromLng(Me[0])*this.worldSize,s=(B=l.mercatorXfromLng(Me[1])*this.worldSize)-A<$.x?$.x/(B-A):0}var ke=this.point,et=Math.max(s||0,a||0);if(et)return this.center=this.unproject(new l.Point(s?(B+A)/2:ke.x,a?(E+b)/2:ke.y)),this.zoom+=this.scaleZoom(et),this._unmodified=he,void(this._constraining=!1);if(this.latRange){var $e=ke.y,pt=$.y/2;$e-pt<b&&(p=b+pt),$e+pt>E&&(p=E-pt)}if(this.lngRange){var Ke=ke.x,ft=$.x/2;Ke-ft<A&&(o=A+ft),Ke+ft>B&&(o=B-ft)}void 0===o&&void 0===p||(this.center=this.unproject(new l.Point(void 0!==o?o:ke.x,void 0!==p?p:ke.y))),this._unmodified=he,this._constraining=!1}},sa.prototype._calcMatrices=function(){if(this.height){var a=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+a.y/this.height),p=Math.sin(o)*this.cameraToCenterDistance/Math.sin(l.clamp(Math.PI-s-o,.01,Math.PI-.01)),b=this.point,E=b.x,A=b.y,B=1.01*(Math.cos(Math.PI/2-this._pitch)*p+this.cameraToCenterDistance),$=this.height/50,he=new Float64Array(16);l.perspective(he,this._fov,this.width/this.height,$,B),he[8]=2*-a.x/this.width,he[9]=2*a.y/this.height,l.scale(he,he,[1,-1,1]),l.translate(he,he,[0,0,-this.cameraToCenterDistance]),l.rotateX(he,he,this._pitch),l.rotateZ(he,he,this.angle),l.translate(he,he,[-E,-A,0]),this.mercatorMatrix=l.scale([],he,[this.worldSize,this.worldSize,this.worldSize]),l.scale(he,he,[1,1,l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=he,this.invProjMatrix=l.invert([],this.projMatrix);var Ce=this.width%2/2,Me=this.height%2/2,ke=Math.cos(this.angle),et=Math.sin(this.angle),$e=E-Math.round(E)+ke*Ce+et*Me,pt=A-Math.round(A)+ke*Me+et*Ce,Ke=new Float64Array(he);if(l.translate(Ke,Ke,[$e>.5?$e-1:$e,pt>.5?pt-1:pt,0]),this.alignedProjMatrix=Ke,he=l.create(),l.scale(he,he,[this.width/2,-this.height/2,1]),l.translate(he,he,[1,-1,0]),this.labelPlaneMatrix=he,he=l.create(),l.scale(he,he,[1,-1,1]),l.translate(he,he,[-1,-1,0]),l.scale(he,he,[2/this.width,2/this.height,1]),this.glCoordMatrix=he,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(he=l.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=he,this._posMatrixCache={},this._alignedPosMatrixCache={}}},sa.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var a=this.pointCoordinate(new l.Point(0,0)),s=[a.x*this.worldSize,a.y*this.worldSize,0,1];return l.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},sa.prototype.getCameraPoint=function(){var a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,a))},sa.prototype.getCameraQueryGeometry=function(a){var s=this.getCameraPoint();if(1===a.length)return[a[0],s];for(var o=s.x,p=s.y,b=s.x,E=s.y,A=0,B=a;A<B.length;A+=1){var $=B[A];o=Math.min(o,$.x),p=Math.min(p,$.y),b=Math.max(b,$.x),E=Math.max(E,$.y)}return[new l.Point(o,p),new l.Point(b,p),new l.Point(b,E),new l.Point(o,E),new l.Point(o,p)]},Object.defineProperties(sa.prototype,ja);var ws=function(a){var s,o,p,b;this._hashName=a&&encodeURIComponent(a),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,p=null,b=function(){p=null,o&&(s(),p=setTimeout(b,300),o=!1)},function(){return o=!0,p||b(),p})};ws.prototype.addTo=function(a){return this._map=a,l.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ws.prototype.remove=function(){return l.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ws.prototype.getHashString=function(a){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,p=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,p),E=Math.round(s.lng*b)/b,A=Math.round(s.lat*b)/b,B=this._map.getBearing(),$=this._map.getPitch(),he="";if(he+=a?"/"+E+"/"+A+"/"+o:o+"/"+A+"/"+E,(B||$)&&(he+="/"+Math.round(10*B)/10),$&&(he+="/"+Math.round($)),this._hashName){var Ce=this._hashName,Me=!1,ke=l.window.location.hash.slice(1).split("&").map(function(et){var $e=et.split("=")[0];return $e===Ce?(Me=!0,$e+"="+he):et}).filter(function(et){return et});return Me||ke.push(Ce+"="+he),"#"+ke.join("&")}return"#"+he},ws.prototype._getCurrentHash=function(){var a,s=this,o=l.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(p){return p.split("=")}).forEach(function(p){p[0]===s._hashName&&(a=p)}),(a&&a[1]||"").split("/")):o.split("/")},ws.prototype._onHashChange=function(){var a=this._getCurrentHash();if(a.length>=3&&!a.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:s,pitch:+(a[4]||0)}),!0}return!1},ws.prototype._updateHashUnthrottled=function(){var a=l.window.location.href.replace(/(#.+)?$/,this.getHashString());try{l.window.history.replaceState(l.window.history.state,null,a)}catch(s){}};var Ul={linearity:.3,easing:l.bezier(0,0,.3,1)},Uu=l.extend({deceleration:2500,maxSpeed:1400},Ul),Mc=l.extend({deceleration:20,maxSpeed:1400},Ul),Ta=l.extend({deceleration:1e3,maxSpeed:360},Ul),lf=l.extend({deceleration:1e3,maxSpeed:90},Ul),Vl=function(a){this._map=a,this.clear()};function ml(a,s){(!a.duration||a.duration<s.duration)&&(a.duration=s.duration,a.easing=s.easing)}function _u(a,s,o){var p=o.maxSpeed,b=o.linearity,E=o.deceleration,A=l.clamp(a*b/(s/1e3),-p,p),B=Math.abs(A)/(E*b);return{easing:o.easing,duration:1e3*B,amount:A*(B/2)}}Vl.prototype.clear=function(){this._inertiaBuffer=[]},Vl.prototype.record=function(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.browser.now(),settings:a})},Vl.prototype._drainInertiaBuffer=function(){for(var a=this._inertiaBuffer,s=l.browser.now();a.length>0&&s-a[0].time>160;)a.shift()},Vl.prototype._onMoveEnd=function(a){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0},o=0,p=this._inertiaBuffer;o<p.length;o+=1){var b=p[o].settings;s.zoom+=b.zoomDelta||0,s.bearing+=b.bearingDelta||0,s.pitch+=b.pitchDelta||0,b.panDelta&&s.pan._add(b.panDelta),b.around&&(s.around=b.around),b.pinchAround&&(s.pinchAround=b.pinchAround)}var E=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,A={};if(s.pan.mag()){var B=_u(s.pan.mag(),E,l.extend({},Uu,a||{}));A.offset=s.pan.mult(B.amount/s.pan.mag()),A.center=this._map.transform.center,ml(A,B)}if(s.zoom){var $=_u(s.zoom,E,Mc);A.zoom=this._map.transform.zoom+$.amount,ml(A,$)}if(s.bearing){var he=_u(s.bearing,E,Ta);A.bearing=this._map.transform.bearing+l.clamp(he.amount,-179,179),ml(A,he)}if(s.pitch){var Ce=_u(s.pitch,E,lf);A.pitch=this._map.transform.pitch+Ce.amount,ml(A,Ce)}if(A.zoom||A.bearing){var Me=void 0===s.pinchAround?s.around:s.pinchAround;A.around=Me?this._map.unproject(Me):this._map.getCenter()}return this.clear(),l.extend(A,{noMoveStart:!0})}};var So=function(a){function s(p,b,E,A){void 0===A&&(A={});var B=O.mousePos(b.getCanvasContainer(),E),$=b.unproject(B);a.call(this,p,l.extend({point:B,lngLat:$,originalEvent:E},A)),this._defaultPrevented=!1,this.target=b}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(l.Event),gl=function(a){function s(p,b,E){var A="touchend"===p?E.changedTouches:E.touches,B=O.touchPos(b.getCanvasContainer(),A),$=B.map(function(Me){return b.unproject(Me)}),he=B.reduce(function(Me,ke,et,$e){return Me.add(ke.div($e.length))},new l.Point(0,0)),Ce=b.unproject(he);a.call(this,p,{points:B,point:he,lngLats:$,lngLat:Ce,originalEvent:E}),this._defaultPrevented=!1}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(l.Event),yl=function(a){function s(p,b,E){a.call(this,p,{originalEvent:E}),this._defaultPrevented=!1}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(l.Event),Ro=function(a,s){this._map=a,this._clickTolerance=s.clickTolerance};Ro.prototype.reset=function(){delete this._mousedownPos},Ro.prototype.wheel=function(a){return this._firePreventable(new yl(a.type,this._map,a))},Ro.prototype.mousedown=function(a,s){return this._mousedownPos=s,this._firePreventable(new So(a.type,this._map,a))},Ro.prototype.mouseup=function(a){this._map.fire(new So(a.type,this._map,a))},Ro.prototype.click=function(a,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new So(a.type,this._map,a))},Ro.prototype.dblclick=function(a){return this._firePreventable(new So(a.type,this._map,a))},Ro.prototype.mouseover=function(a){this._map.fire(new So(a.type,this._map,a))},Ro.prototype.mouseout=function(a){this._map.fire(new So(a.type,this._map,a))},Ro.prototype.touchstart=function(a){return this._firePreventable(new gl(a.type,this._map,a))},Ro.prototype.touchmove=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype.touchend=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype.touchcancel=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype._firePreventable=function(a){if(this._map.fire(a),a.defaultPrevented)return{}},Ro.prototype.isEnabled=function(){return!0},Ro.prototype.isActive=function(){return!1},Ro.prototype.enable=function(){},Ro.prototype.disable=function(){};var Fn=function(a){this._map=a};Fn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Fn.prototype.mousemove=function(a){this._map.fire(new So(a.type,this._map,a))},Fn.prototype.mousedown=function(){this._delayContextMenu=!0},Fn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new So("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Fn.prototype.contextmenu=function(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new So(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()},Fn.prototype.isEnabled=function(){return!0},Fn.prototype.isActive=function(){return!1},Fn.prototype.enable=function(){},Fn.prototype.disable=function(){};var za=function(a,s){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=s.clickTolerance||1};function Vu(a,s){for(var o={},p=0;p<a.length;p++)o[a[p].identifier]=s[p];return o}za.prototype.isEnabled=function(){return!!this._enabled},za.prototype.isActive=function(){return!!this._active},za.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},za.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},za.prototype.mousedown=function(a,s){this.isEnabled()&&a.shiftKey&&0===a.button&&(O.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},za.prototype.mousemoveWindow=function(a,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var p=this._startPos;this._lastPos=o,this._box||(this._box=O.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));var b=Math.min(p.x,o.x),E=Math.max(p.x,o.x),A=Math.min(p.y,o.y),B=Math.max(p.y,o.y);O.setTransform(this._box,"translate("+b+"px,"+A+"px)"),this._box.style.width=E-b+"px",this._box.style.height=B-A+"px"}}},za.prototype.mouseupWindow=function(a,s){var o=this;if(this._active&&0===a.button){var p=this._startPos,b=s;if(this.reset(),O.suppressClick(),p.x!==b.x||p.y!==b.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:function(E){return E.fitScreenCoordinates(p,b,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",a)}},za.prototype.keydown=function(a){this._active&&27===a.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",a))},za.prototype.blur=function(){this.reset()},za.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(O.remove(this._box),this._box=null),O.enableDrag(),delete this._startPos,delete this._lastPos},za.prototype._fireEvent=function(a,s){return this._map.fire(new l.Event(a,{originalEvent:s}))};var _l=function(a){this.reset(),this.numTouches=a.numTouches};_l.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},_l.prototype.touchstart=function(a,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=a.timeStamp),o.length===this.numTouches&&(this.centroid=function(p){for(var b=new l.Point(0,0),E=0,A=p;E<A.length;E+=1)b._add(A[E]);return b.div(p.length)}(s),this.touches=Vu(o,s)))},_l.prototype.touchmove=function(a,s,o){if(!this.aborted&&this.centroid){var p=Vu(o,s);for(var b in this.touches){var E=p[b];(!E||E.dist(this.touches[b])>30)&&(this.aborted=!0)}}},_l.prototype.touchend=function(a,s,o){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),0===o.length){var p=!this.aborted&&this.centroid;if(this.reset(),p)return p}};var iu=function(a){this.singleTap=new _l(a),this.numTaps=a.numTaps,this.reset()};iu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},iu.prototype.touchstart=function(a,s,o){this.singleTap.touchstart(a,s,o)},iu.prototype.touchmove=function(a,s,o){this.singleTap.touchmove(a,s,o)},iu.prototype.touchend=function(a,s,o){var p=this.singleTap.touchend(a,s,o);if(p){var b=a.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(p)<30;if(b&&E||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}};var Es=function(){this._zoomIn=new iu({numTouches:1,numTaps:2}),this._zoomOut=new iu({numTouches:2,numTaps:1}),this.reset()};Es.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Es.prototype.touchstart=function(a,s,o){this._zoomIn.touchstart(a,s,o),this._zoomOut.touchstart(a,s,o)},Es.prototype.touchmove=function(a,s,o){this._zoomIn.touchmove(a,s,o),this._zoomOut.touchmove(a,s,o)},Es.prototype.touchend=function(a,s,o){var p=this,b=this._zoomIn.touchend(a,s,o),E=this._zoomOut.touchend(a,s,o);return b?(this._active=!0,a.preventDefault(),setTimeout(function(){return p.reset()},0),{cameraAnimation:function(A){return A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(b)},{originalEvent:a})}}):E?(this._active=!0,a.preventDefault(),setTimeout(function(){return p.reset()},0),{cameraAnimation:function(A){return A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(E)},{originalEvent:a})}}):void 0},Es.prototype.touchcancel=function(){this.reset()},Es.prototype.enable=function(){this._enabled=!0},Es.prototype.disable=function(){this._enabled=!1,this.reset()},Es.prototype.isEnabled=function(){return this._enabled},Es.prototype.isActive=function(){return this._active};var Xc={0:1,2:2},hn=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};hn.prototype.blur=function(){this.reset()},hn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},hn.prototype._correctButton=function(a,s){return!1},hn.prototype._move=function(a,s){return{}},hn.prototype.mousedown=function(a,s){if(!this._lastPoint){var o=O.mouseButton(a);this._correctButton(a,o)&&(this._lastPoint=s,this._eventButton=o)}},hn.prototype.mousemoveWindow=function(a,s){var p,E,o=this._lastPoint;if(o)if(a.preventDefault(),E=Xc[this._eventButton],void 0===(p=a).buttons||(p.buttons&E)!==E)this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)},hn.prototype.mouseupWindow=function(a){this._lastPoint&&O.mouseButton(a)===this._eventButton&&(this._moved&&O.suppressClick(),this.reset())},hn.prototype.enable=function(){this._enabled=!0},hn.prototype.disable=function(){this._enabled=!1,this.reset()},hn.prototype.isEnabled=function(){return this._enabled},hn.prototype.isActive=function(){return this._active};var Yc=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.mousedown=function(o,p){a.prototype.mousedown.call(this,o,p),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,p){return 0===p&&!o.ctrlKey},s.prototype._move=function(o,p){return{around:p,panDelta:p.sub(o)}},s}(hn),Oc=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype._correctButton=function(o,p){return 0===p&&o.ctrlKey||2===p},s.prototype._move=function(o,p){var b=.8*(p.x-o.x);if(b)return this._active=!0,{bearingDelta:b}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(hn),xl=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype._correctButton=function(o,p){return 0===p&&o.ctrlKey||2===p},s.prototype._move=function(o,p){var b=-.5*(p.y-o.y);if(b)return this._active=!0,{pitchDelta:b}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(hn),Ga=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};Ga.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)},Ga.prototype.touchstart=function(a,s,o){return this._calculateTransform(a,s,o)},Ga.prototype.touchmove=function(a,s,o){if(this._active&&!(o.length<this._minTouches))return a.preventDefault(),this._calculateTransform(a,s,o)},Ga.prototype.touchend=function(a,s,o){this._calculateTransform(a,s,o),this._active&&o.length<this._minTouches&&this.reset()},Ga.prototype.touchcancel=function(){this.reset()},Ga.prototype._calculateTransform=function(a,s,o){o.length>0&&(this._active=!0);var p=Vu(o,s),b=new l.Point(0,0),E=new l.Point(0,0),A=0;for(var B in p){var $=p[B],he=this._touches[B];he&&(b._add($),E._add($.sub(he)),A++,p[B]=$)}if(this._touches=p,!(A<this._minTouches)&&E.mag()){var Ce=E.div(A);if(this._sum._add(Ce),!(this._sum.mag()<this._clickTolerance))return{around:b.div(A),panDelta:Ce}}},Ga.prototype.enable=function(){this._enabled=!0},Ga.prototype.disable=function(){this._enabled=!1,this.reset()},Ga.prototype.isEnabled=function(){return this._enabled},Ga.prototype.isActive=function(){return this._active};var Ts=function(){this.reset()};function sc(a,s,o){for(var p=0;p<a.length;p++)if(a[p].identifier===o)return s[p]}function au(a,s){return Math.log(a/s)/Math.LN2}Ts.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ts.prototype._start=function(a){},Ts.prototype._move=function(a,s,o){return{}},Ts.prototype.touchstart=function(a,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Ts.prototype.touchmove=function(a,s,o){if(this._firstTwoTouches){a.preventDefault();var p=this._firstTwoTouches,b=p[1],E=sc(o,s,p[0]),A=sc(o,s,b);if(E&&A){var B=this._aroundCenter?null:E.add(A).div(2);return this._move([E,A],B,a)}}},Ts.prototype.touchend=function(a,s,o){if(this._firstTwoTouches){var p=this._firstTwoTouches,b=p[1],E=sc(o,s,p[0]),A=sc(o,s,b);E&&A||(this._active&&O.suppressClick(),this.reset())}},Ts.prototype.touchcancel=function(){this.reset()},Ts.prototype.enable=function(a){this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around},Ts.prototype.disable=function(){this._enabled=!1,this.reset()},Ts.prototype.isEnabled=function(){return this._enabled},Ts.prototype.isActive=function(){return this._active};var Ds=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,p){var b=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(au(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:au(this._distance,b),pinchAround:p}},s}(Ts);function Hs(a,s){return 180*a.angleWith(s)/Math.PI}var Tf=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,p){var b=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Hs(this._vector,b),pinchAround:p}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var p=25/(Math.PI*this._minDiameter)*360,b=Hs(o,this._startVector);return Math.abs(b)<p},s}(Ts);function uc(a){return Math.abs(a.y)>Math.abs(a.x)}var cf=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,uc(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,p,b){var E=o[0].sub(this._lastPoints[0]),A=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(E,A,b.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(E.y+A.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,p,b){if(void 0!==this._valid)return this._valid;var E=o.mag()>=2,A=p.mag()>=2;if(E||A){if(!E||!A)return void 0===this._firstMove&&(this._firstMove=b),b-this._firstMove<100&&void 0;var B=o.y>0==p.y>0;return uc(o)&&uc(p)&&B}},s}(Ts),Lc={panStep:100,bearingStep:15,pitchStep:10},Ws=function(){var a=Lc;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1};function Cs(a){return a*(2-a)}Ws.prototype.blur=function(){this.reset()},Ws.prototype.reset=function(){this._active=!1},Ws.prototype.keydown=function(a){var s=this;if(!(a.altKey||a.ctrlKey||a.metaKey)){var o=0,p=0,b=0,E=0,A=0;switch(a.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:a.shiftKey?p=-1:(a.preventDefault(),E=-1);break;case 39:a.shiftKey?p=1:(a.preventDefault(),E=1);break;case 38:a.shiftKey?b=1:(a.preventDefault(),A=-1);break;case 40:a.shiftKey?b=-1:(a.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(p=0,b=0),{cameraAnimation:function(B){var $=B.getZoom();B.easeTo({duration:300,easeId:"keyboardHandler",easing:Cs,zoom:o?Math.round($)+o*(a.shiftKey?2:1):$,bearing:B.getBearing()+p*s._bearingStep,pitch:B.getPitch()+b*s._pitchStep,offset:[-E*s._panStep,-A*s._panStep],center:B.getCenter()},{originalEvent:a})}}}},Ws.prototype.enable=function(){this._enabled=!0},Ws.prototype.disable=function(){this._enabled=!1,this.reset()},Ws.prototype.isEnabled=function(){return this._enabled},Ws.prototype.isActive=function(){return this._active},Ws.prototype.disableRotation=function(){this._rotationDisabled=!0},Ws.prototype.enableRotation=function(){this._rotationDisabled=!1};var $i=function(a,s){this._map=a,this._el=a.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,l.bindAll(["_onTimeout"],this)};$i.prototype.setZoomRate=function(a){this._defaultZoomRate=a},$i.prototype.setWheelZoomRate=function(a){this._wheelZoomRate=a},$i.prototype.isEnabled=function(){return!!this._enabled},$i.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},$i.prototype.isZooming=function(){return!!this._zooming},$i.prototype.enable=function(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},$i.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},$i.prototype.wheel=function(a){if(this.isEnabled()){var s=a.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY,o=l.browser.now(),p=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==s&&s%4.000244140625==0?this._type="wheel":0!==s&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),a.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=a,this._delta-=s,this._active||this._start(a)),a.preventDefault()}},$i.prototype._onTimeout=function(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)},$i.prototype._start=function(a){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=O.mousePos(this._el,a);this._around=l.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},$i.prototype.renderFrame=function(){var a=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(0!==this._delta){var o="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,p=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&0!==p&&(p=1/p);var b="number"==typeof this._targetZoom?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(b*p))),"wheel"===this._type&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var E,A="number"==typeof this._targetZoom?this._targetZoom:s.zoom,B=this._startZoom,$=this._easing,he=!1;if("wheel"===this._type&&B&&$){var Ce=Math.min((l.browser.now()-this._lastWheelEventTime)/200,1),Me=$(Ce);E=l.number(B,A,Me),Ce<1?this._frameId||(this._frameId=!0):he=!0}else E=A,he=!0;return this._active=!0,he&&(this._active=!1,this._finishTimeout=setTimeout(function(){a._zooming=!1,a._handler._triggerRenderFrame(),delete a._targetZoom,delete a._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!he,zoomDelta:E-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},$i.prototype._smoothOutEasing=function(a){var s=l.ease;if(this._prevEase){var o=this._prevEase,p=(l.browser.now()-o.start)/o.duration,b=o.easing(p+.01)-o.easing(p),E=.27/Math.sqrt(b*b+1e-4)*.01,A=Math.sqrt(.0729-E*E);s=l.bezier(E,A,.25,1)}return this._prevEase={start:l.browser.now(),duration:a,easing:s},s},$i.prototype.blur=function(){this.reset()},$i.prototype.reset=function(){this._active=!1};var xu=function(a,s){this._clickZoom=a,this._tapZoom=s};xu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},xu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},xu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},xu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ns=function(){this.reset()};Ns.prototype.reset=function(){this._active=!1},Ns.prototype.blur=function(){this.reset()},Ns.prototype.dblclick=function(a,s){return a.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(a.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:a})}}},Ns.prototype.enable=function(){this._enabled=!0},Ns.prototype.disable=function(){this._enabled=!1,this.reset()},Ns.prototype.isEnabled=function(){return this._enabled},Ns.prototype.isActive=function(){return this._active};var Yo=function(){this._tap=new iu({numTouches:1,numTaps:1}),this.reset()};Yo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Yo.prototype.touchstart=function(a,s,o){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(a,s,o))},Yo.prototype.touchmove=function(a,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var p=s[0],b=p.y-this._swipePoint.y;return this._swipePoint=p,a.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(a,s,o)},Yo.prototype.touchend=function(a,s,o){this._tapTime?this._swipePoint&&0===o.length&&this.reset():this._tap.touchend(a,s,o)&&(this._tapTime=a.timeStamp)},Yo.prototype.touchcancel=function(){this.reset()},Yo.prototype.enable=function(){this._enabled=!0},Yo.prototype.disable=function(){this._enabled=!1,this.reset()},Yo.prototype.isEnabled=function(){return this._enabled},Yo.prototype.isActive=function(){return this._active};var nl=function(a,s,o){this._el=a,this._mousePan=s,this._touchPan=o};nl.prototype.enable=function(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},nl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},nl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},nl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var bu=function(a,s,o){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};bu.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},bu.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},bu.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},bu.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ou=function(a,s,o,p){this._el=a,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0};ou.prototype.enable=function(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ou.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ou.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ou.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ou.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ou.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var mo=function(a){return a.zoom||a.drag||a.pitch||a.rotate},il=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s}(l.Event);function ri(a){return a.panDelta&&a.panDelta.mag()||a.zoomDelta||a.bearingDelta||a.pitchDelta}var In=function(a,s){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Vl(a),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),l.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[l.window,"blur",void 0]];for(var p=0,b=this._listeners;p<b.length;p+=1){var E=b[p],A=E[0];O.addEventListener(A,E[1],A===l.window.document?this.handleWindowEvent:this.handleEvent,E[2])}};In.prototype.destroy=function(){for(var a=0,s=this._listeners;a<s.length;a+=1){var o=s[a],p=o[0];O.removeEventListener(p,o[1],p===l.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},In.prototype._addDefaultHandlers=function(a){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new Ro(s,a));var p=s.boxZoom=new za(s,a);this._add("boxZoom",p);var b=new Es,E=new Ns;s.doubleClickZoom=new xu(E,b),this._add("tapZoom",b),this._add("clickZoom",E);var A=new Yo;this._add("tapDragZoom",A);var B=s.touchPitch=new cf;this._add("touchPitch",B);var $=new Oc(a),he=new xl(a);s.dragRotate=new bu(a,$,he),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",he,["mouseRotate"]);var Ce=new Yc(a),Me=new Ga(a);s.dragPan=new nl(o,Ce,Me),this._add("mousePan",Ce),this._add("touchPan",Me,["touchZoom","touchRotate"]);var ke=new Tf,et=new Ds;s.touchZoomRotate=new ou(o,et,ke,A),this._add("touchRotate",ke,["touchPan","touchZoom"]),this._add("touchZoom",et,["touchPan","touchRotate"]);var $e=s.scrollZoom=new $i(s,this);this._add("scrollZoom",$e,["mousePan"]);var pt=s.keyboard=new Ws;this._add("keyboard",pt),this._add("blockableMapEvent",new Fn(s));for(var Ke=0,ft=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Ke<ft.length;Ke+=1){var It=ft[Ke];a.interactive&&a[It]&&s[It].enable(a[It])}},In.prototype._add=function(a,s,o){this._handlers.push({handlerName:a,handler:s,allowed:o}),this._handlersById[a]=s},In.prototype.stop=function(a){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}},In.prototype.isActive=function(){for(var a=0,s=this._handlers;a<s.length;a+=1)if(s[a].handler.isActive())return!0;return!1},In.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},In.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},In.prototype.isMoving=function(){return Boolean(mo(this._eventsInProgress))||this.isZooming()},In.prototype._blockedByActive=function(a,s,o){for(var p in a)if(p!==o&&(!s||s.indexOf(p)<0))return!0;return!1},In.prototype.handleWindowEvent=function(a){this.handleEvent(a,a.type+"Window")},In.prototype._getMapTouches=function(a){for(var s=[],o=0,p=a;o<p.length;o+=1){var b=p[o];this._el.contains(b.target)&&s.push(b)}return s},In.prototype.handleEvent=function(a,s){this._updatingCamera=!0;for(var o="renderFrame"===a.type?void 0:a,p={needsRenderFrame:!1},b={},E={},A=a.touches?this._getMapTouches(a.touches):void 0,B=A?O.touchPos(this._el,A):O.mousePos(this._el,a),$=0,he=this._handlers;$<he.length;$+=1){var Ce=he[$],Me=Ce.handlerName,ke=Ce.handler,et=Ce.allowed;if(ke.isEnabled()){var $e=void 0;this._blockedByActive(E,et,Me)?ke.reset():ke[s||a.type]&&($e=ke[s||a.type](a,B,A),this.mergeHandlerResult(p,b,$e,Me,o),$e&&$e.needsRenderFrame&&this._triggerRenderFrame()),($e||ke.isActive())&&(E[Me]=ke)}}var pt={};for(var Ke in this._previousActiveHandlers)E[Ke]||(pt[Ke]=o);this._previousActiveHandlers=E,(Object.keys(pt).length||ri(p))&&(this._changes.push([p,b,pt]),this._triggerRenderFrame()),(Object.keys(E).length||ri(p))&&this._map._stop(!0),this._updatingCamera=!1;var ft=p.cameraAnimation;ft&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ft(this._map))},In.prototype.mergeHandlerResult=function(a,s,o,p,b){if(o){l.extend(a,o);var E={handlerName:p,originalEvent:o.originalEvent||b};void 0!==o.zoomDelta&&(s.zoom=E),void 0!==o.panDelta&&(s.drag=E),void 0!==o.pitchDelta&&(s.pitch=E),void 0!==o.bearingDelta&&(s.rotate=E)}},In.prototype._applyChanges=function(){for(var a={},s={},o={},p=0,b=this._changes;p<b.length;p+=1){var E=b[p],A=E[0],B=E[1],$=E[2];A.panDelta&&(a.panDelta=(a.panDelta||new l.Point(0,0))._add(A.panDelta)),A.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+A.zoomDelta),A.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+A.bearingDelta),A.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+A.pitchDelta),void 0!==A.around&&(a.around=A.around),void 0!==A.pinchAround&&(a.pinchAround=A.pinchAround),A.noInertia&&(a.noInertia=A.noInertia),l.extend(s,B),l.extend(o,$)}this._updateMapTransform(a,s,o),this._changes=[]},In.prototype._updateMapTransform=function(a,s,o){var p=this._map,b=p.transform;if(!ri(a))return this._fireEvents(s,o,!0);var E=a.panDelta,A=a.zoomDelta,B=a.bearingDelta,$=a.pitchDelta,he=a.around,Ce=a.pinchAround;void 0!==Ce&&(he=Ce),p._stop(!0),he=he||p.transform.centerPoint;var Me=b.pointLocation(E?he.sub(E):he);B&&(b.bearing+=B),$&&(b.pitch+=$),A&&(b.zoom+=A),b.setLocationAtPoint(Me,he),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(s,o,!0)},In.prototype._fireEvents=function(a,s,o){var p=this,b=mo(this._eventsInProgress),E=mo(a),A={};for(var B in a)this._eventsInProgress[B]||(A[B+"start"]=a[B].originalEvent),this._eventsInProgress[B]=a[B];for(var $ in!b&&E&&this._fireEvent("movestart",E.originalEvent),A)this._fireEvent($,A[$]);for(var he in E&&this._fireEvent("move",E.originalEvent),a)this._fireEvent(he,a[he].originalEvent);var Ce,Me={};for(var ke in this._eventsInProgress){var et=this._eventsInProgress[ke],$e=et.handlerName,pt=et.originalEvent;this._handlersById[$e].isActive()||(delete this._eventsInProgress[ke],Me[ke+"end"]=Ce=s[$e]||pt)}for(var Ke in Me)this._fireEvent(Ke,Me[Ke]);var ft=mo(this._eventsInProgress);if(o&&(b||E)&&!ft){this._updatingCamera=!0;var It=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Wt=function(pr){return 0!==pr&&-p._bearingSnap<pr&&pr<p._bearingSnap};It?(Wt(It.bearing||this._map.getBearing())&&(It.bearing=0),this._map.easeTo(It,{originalEvent:Ce})):(this._map.fire(new l.Event("moveend",{originalEvent:Ce})),Wt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},In.prototype._fireEvent=function(a,s){this._map.fire(new l.Event(a,s?{originalEvent:s}:{}))},In.prototype._requestFrame=function(){var a=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete a._frameId,a.handleEvent(new il("renderFrame",{timeStamp:s})),a._applyChanges()})},In.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var lc=function(a){function s(o,p){a.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=p.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getCenter=function(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,p){return this.jumpTo({center:o},p)},s.prototype.panBy=function(o,p,b){return o=l.Point.convert(o).mult(-1),this.panTo(this.transform.center,l.extend({offset:o},p),b)},s.prototype.panTo=function(o,p,b){return this.easeTo(l.extend({center:o},p),b)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,p){return this.jumpTo({zoom:o},p),this},s.prototype.zoomTo=function(o,p,b){return this.easeTo(l.extend({zoom:o},p),b)},s.prototype.zoomIn=function(o,p){return this.zoomTo(this.getZoom()+1,o,p),this},s.prototype.zoomOut=function(o,p){return this.zoomTo(this.getZoom()-1,o,p),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,p){return this.jumpTo({bearing:o},p),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,p){return this.jumpTo({padding:o},p),this},s.prototype.rotateTo=function(o,p,b){return this.easeTo(l.extend({bearing:o},p),b)},s.prototype.resetNorth=function(o,p){return this.rotateTo(0,l.extend({duration:1e3},o),p),this},s.prototype.resetNorthPitch=function(o,p){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},o),p),this},s.prototype.snapToNorth=function(o,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,p):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,p){return this.jumpTo({pitch:o},p),this},s.prototype.cameraForBounds=function(o,p){o=l.LngLatBounds.convert(o);var b=p&&p.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),b,p)},s.prototype._cameraForBoxAndBearing=function(o,p,b,E){var A={top:0,bottom:0,right:0,left:0};if("number"==typeof(E=l.extend({padding:A,offset:[0,0],maxZoom:this.transform.maxZoom},E)).padding){var B=E.padding;E.padding={top:B,bottom:B,right:B,left:B}}E.padding=l.extend(A,E.padding);var $=this.transform,he=$.padding,Ce=$.project(l.LngLat.convert(o)),Me=$.project(l.LngLat.convert(p)),ke=Ce.rotate(-b*Math.PI/180),et=Me.rotate(-b*Math.PI/180),$e=new l.Point(Math.max(ke.x,et.x),Math.max(ke.y,et.y)),pt=new l.Point(Math.min(ke.x,et.x),Math.min(ke.y,et.y)),Ke=$e.sub(pt),ft=($.width-(he.left+he.right+E.padding.left+E.padding.right))/Ke.x,It=($.height-(he.top+he.bottom+E.padding.top+E.padding.bottom))/Ke.y;if(!(It<0||ft<0)){var Wt=Math.min($.scaleZoom($.scale*Math.min(ft,It)),E.maxZoom),pr="number"==typeof E.offset.x?new l.Point(E.offset.x,E.offset.y):l.Point.convert(E.offset),nr=new l.Point((E.padding.left-E.padding.right)/2,(E.padding.top-E.padding.bottom)/2).rotate(b*Math.PI/180),br=pr.add(nr).mult($.scale/$.zoomScale(Wt));return{center:$.unproject(Ce.add(Me).div(2).sub(br)),zoom:Wt,bearing:b}}l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,p,b){return this._fitInternal(this.cameraForBounds(o,p),p,b)},s.prototype.fitScreenCoordinates=function(o,p,b,E,A){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(l.Point.convert(o)),this.transform.pointLocation(l.Point.convert(p)),b,E),E,A)},s.prototype._fitInternal=function(o,p,b){return o?(delete(p=l.extend(o,p)).padding,p.linear?this.easeTo(p,b):this.flyTo(p,b)):this},s.prototype.jumpTo=function(o,p){this.stop();var b=this.transform,E=!1,A=!1,B=!1;return"zoom"in o&&b.zoom!==+o.zoom&&(E=!0,b.zoom=+o.zoom),void 0!==o.center&&(b.center=l.LngLat.convert(o.center)),"bearing"in o&&b.bearing!==+o.bearing&&(A=!0,b.bearing=+o.bearing),"pitch"in o&&b.pitch!==+o.pitch&&(B=!0,b.pitch=+o.pitch),null==o.padding||b.isPaddingEqual(o.padding)||(b.padding=o.padding),this.fire(new l.Event("movestart",p)).fire(new l.Event("move",p)),E&&this.fire(new l.Event("zoomstart",p)).fire(new l.Event("zoom",p)).fire(new l.Event("zoomend",p)),A&&this.fire(new l.Event("rotatestart",p)).fire(new l.Event("rotate",p)).fire(new l.Event("rotateend",p)),B&&this.fire(new l.Event("pitchstart",p)).fire(new l.Event("pitch",p)).fire(new l.Event("pitchend",p)),this.fire(new l.Event("moveend",p))},s.prototype.easeTo=function(o,p){var b=this;this._stop(!1,o.easeId),(!1===(o=l.extend({offset:[0,0],duration:500,easing:l.ease},o)).animate||!o.essential&&l.browser.prefersReducedMotion)&&(o.duration=0);var E=this.transform,A=this.getZoom(),B=this.getBearing(),$=this.getPitch(),he=this.getPadding(),Ce="zoom"in o?+o.zoom:A,Me="bearing"in o?this._normalizeBearing(o.bearing,B):B,ke="pitch"in o?+o.pitch:$,et="padding"in o?o.padding:E.padding,$e=l.Point.convert(o.offset),pt=E.centerPoint.add($e),Ke=E.pointLocation(pt),ft=l.LngLat.convert(o.center||Ke);this._normalizeCenter(ft);var It,Wt,pr=E.project(Ke),nr=E.project(ft).sub(pr),br=E.zoomScale(Ce-A);o.around&&(It=l.LngLat.convert(o.around),Wt=E.locationPoint(It));var Dr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ce!==A,this._rotating=this._rotating||B!==Me,this._pitching=this._pitching||ke!==$,this._padding=!E.isPaddingEqual(et),this._easeId=o.easeId,this._prepareEase(p,o.noMoveStart,Dr),this._ease(function(Qr){if(b._zooming&&(E.zoom=l.number(A,Ce,Qr)),b._rotating&&(E.bearing=l.number(B,Me,Qr)),b._pitching&&(E.pitch=l.number($,ke,Qr)),b._padding&&(E.interpolatePadding(he,et,Qr),pt=E.centerPoint.add($e)),It)E.setLocationAtPoint(It,Wt);else{var Xr=E.zoomScale(E.zoom-A),dn=Ce>A?Math.min(2,br):Math.max(.5,br),qn=Math.pow(dn,1-Qr),Vn=E.unproject(pr.add(nr.mult(Qr*qn)).mult(Xr));E.setLocationAtPoint(E.renderWorldCopies?Vn.wrap():Vn,pt)}b._fireMoveEvents(p)},function(Qr){b._afterEase(p,Qr)},o),this},s.prototype._prepareEase=function(o,p,b){void 0===b&&(b={}),this._moving=!0,p||b.moving||this.fire(new l.Event("movestart",o)),this._zooming&&!b.zooming&&this.fire(new l.Event("zoomstart",o)),this._rotating&&!b.rotating&&this.fire(new l.Event("rotatestart",o)),this._pitching&&!b.pitching&&this.fire(new l.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new l.Event("move",o)),this._zooming&&this.fire(new l.Event("zoom",o)),this._rotating&&this.fire(new l.Event("rotate",o)),this._pitching&&this.fire(new l.Event("pitch",o))},s.prototype._afterEase=function(o,p){if(!this._easeId||!p||this._easeId!==p){delete this._easeId;var b=this._zooming,E=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new l.Event("zoomend",o)),E&&this.fire(new l.Event("rotateend",o)),A&&this.fire(new l.Event("pitchend",o)),this.fire(new l.Event("moveend",o))}},s.prototype.flyTo=function(o,p){var b=this;if(!o.essential&&l.browser.prefersReducedMotion){var E=l.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(E,p)}this.stop(),o=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},o);var A=this.transform,B=this.getZoom(),$=this.getBearing(),he=this.getPitch(),Ce=this.getPadding(),Me="zoom"in o?l.clamp(+o.zoom,A.minZoom,A.maxZoom):B,ke="bearing"in o?this._normalizeBearing(o.bearing,$):$,et="pitch"in o?+o.pitch:he,$e="padding"in o?o.padding:A.padding,pt=A.zoomScale(Me-B),Ke=l.Point.convert(o.offset),ft=A.centerPoint.add(Ke),It=A.pointLocation(ft),Wt=l.LngLat.convert(o.center||It);this._normalizeCenter(Wt);var pr=A.project(It),nr=A.project(Wt).sub(pr),br=o.curve,Dr=Math.max(A.width,A.height),Qr=Dr/pt,Xr=nr.mag();if("minZoom"in o){var dn=l.clamp(Math.min(o.minZoom,B,Me),A.minZoom,A.maxZoom),qn=Dr/A.zoomScale(dn-B);br=Math.sqrt(qn/Xr*2)}var Vn=br*br;function Nn(te){var ie=(Qr*Qr-Dr*Dr+(te?-1:1)*Vn*Vn*Xr*Xr)/(2*(te?Qr:Dr)*Vn*Xr);return Math.log(Math.sqrt(ie*ie+1)-ie)}function Li(te){return(Math.exp(te)-Math.exp(-te))/2}function Dn(te){return(Math.exp(te)+Math.exp(-te))/2}var gi=Nn(0),Vi=function(te){return Dn(gi)/Dn(gi+br*te)},li=function(te){return Dr*((Dn(gi)*(Li(ie=gi+br*te)/Dn(ie))-Li(gi))/Vn)/Xr;var ie},yi=(Nn(1)-gi)/br;if(Math.abs(Xr)<1e-6||!isFinite(yi)){if(Math.abs(Dr-Qr)<1e-6)return this.easeTo(o,p);var Fi=Qr<Dr?-1:1;yi=Math.abs(Math.log(Qr/Dr))/br,li=function(){return 0},Vi=function(te){return Math.exp(Fi*br*te)}}return o.duration="duration"in o?+o.duration:1e3*yi/("screenSpeed"in o?+o.screenSpeed/br:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=$!==ke,this._pitching=et!==he,this._padding=!A.isPaddingEqual($e),this._prepareEase(p,!1),this._ease(function(te){var ie=te*yi,F=1/Vi(ie);A.zoom=1===te?Me:B+A.scaleZoom(F),b._rotating&&(A.bearing=l.number($,ke,te)),b._pitching&&(A.pitch=l.number(he,et,te)),b._padding&&(A.interpolatePadding(Ce,$e,te),ft=A.centerPoint.add(Ke));var U=1===te?Wt:A.unproject(pr.add(nr.mult(li(ie))).mult(F));A.setLocationAtPoint(A.renderWorldCopies?U.wrap():U,ft),b._fireMoveEvents(p)},function(){return b._afterEase(p)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,p)}if(!o){var E=this.handlers;E&&E.stop(!1)}return this},s.prototype._ease=function(o,p,b){!1===b.animate||0===b.duration?(o(1),p()):(this._easeStart=l.browser.now(),this._easeOptions=b,this._onEaseFrame=o,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((l.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,p){o=l.wrap(o,-180,180);var b=Math.abs(o-p);return Math.abs(o-360-p)<b&&(o-=360),Math.abs(o+360-p)<b&&(o+=360),o},s.prototype._normalizeCenter=function(o){var p=this.transform;if(p.renderWorldCopies&&!p.lngRange){var b=o.lng-p.center.lng;o.lng+=b>180?-360:b<-180?360:0}},s}(l.Evented),wo=function(a){void 0===a&&(a={}),this.options=a,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};wo.prototype.getDefaultPosition=function(){return"bottom-right"},wo.prototype.onAdd=function(a){var s=this.options&&this.options.compact;return this._map=a,this._container=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=O.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=O.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===s&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},wo.prototype.onRemove=function(){O.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},wo.prototype._setElementTitle=function(a,s){var o=this._map._getUIString("AttributionControl."+s);a.title=o,a.setAttribute("aria-label",o)},wo.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},wo.prototype._updateEditLink=function(){var a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(a){var o=s.reduce(function(p,b,E){return b.value&&(p+=b.key+"="+b.value+(E<s.length-1?"&":"")),p},"?");a.href=l.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),a.rel="noopener nofollow",this._setElementTitle(a,"MapFeedback")}},wo.prototype._updateData=function(a){!a||"metadata"!==a.sourceDataType&&"visibility"!==a.sourceDataType&&"style"!==a.dataType||(this._updateAttributions(),this._updateEditLink())},wo.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(function(B){return"string"!=typeof B?"":B})):"string"==typeof this.options.customAttribution&&a.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var p in o){var b=o[p];if(b.used){var E=b.getSource();E.attribution&&a.indexOf(E.attribution)<0&&a.push(E.attribution)}}a.sort(function(B,$){return B.length-$.length});var A=(a=a.filter(function(B,$){for(var he=$+1;he<a.length;he++)if(a[he].indexOf(B)>=0)return!1;return!0})).join(" | ");A!==this._attribHTML&&(this._attribHTML=A,a.length?(this._innerContainer.innerHTML=A,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},wo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Xs=function(){l.bindAll(["_updateLogo"],this),l.bindAll(["_updateCompact"],this)};Xs.prototype.onAdd=function(a){this._map=a,this._container=O.create("div","mapboxgl-ctrl");var s=O.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Xs.prototype.onRemove=function(){O.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Xs.prototype.getDefaultPosition=function(){return"bottom-left"},Xs.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Xs.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var s in a)if(a[s].getSource().mapbox_logo)return!0;return!1}},Xs.prototype._updateCompact=function(){var a=this._container.children;if(a.length){var s=a[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var Po=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Po.prototype.add=function(a){var s=++this._id;return this._queue.push({callback:a,id:s,cancelled:!1}),s},Po.prototype.remove=function(a){for(var s=this._currentlyRunning,o=0,p=s?this._queue.concat(s):this._queue;o<p.length;o+=1){var b=p[o];if(b.id===a)return void(b.cancelled=!0)}},Po.prototype.run=function(a){void 0===a&&(a=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,p=s;o<p.length;o+=1){var b=p[o];if(!b.cancelled&&(b.callback(a),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Po.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var fo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},jl=l.window.HTMLImageElement,Gl=l.window.HTMLElement,Qi=l.window.ImageBitmap,zo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ff=function(a){function s(p){var b=this;if(null!=(p=l.extend({},zo,p)).minZoom&&null!=p.maxZoom&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=p.minPitch&&null!=p.maxPitch&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=p.minPitch&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=p.maxPitch&&p.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var E=new sa(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies);if(a.call(this,E,p),this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new Po,this._controls=[],this._mapId=l.uniqueId(),this._locale=l.extend({},fo,p.locale),this._clickTolerance=p.clickTolerance,this._requestManager=new l.RequestManager(p.transformRequest,p.accessToken),"string"==typeof p.container){if(this._container=l.window.document.getElementById(p.container),!this._container)throw new Error("Container '"+p.container+"' not found.")}else{if(!(p.container instanceof Gl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return b._update(!1)}),this.on("moveend",function(){return b._update(!1)}),this.on("zoom",function(){return b._update(!0)}),void 0!==l.window&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new In(this,p),this._hash=p.hash&&new ws("string"==typeof p.hash&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,l.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new wo({customAttribution:p.customAttribution})),this.addControl(new Xs,p.logoPosition),this.on("style.load",function(){b.transform.unmodified&&b.jumpTo(b.style.stylesheet)}),this.on("data",function(A){b._update("style"===A.dataType),b.fire(new l.Event(A.dataType+"data",A))}),this.on("dataloading",function(A){b.fire(new l.Event(A.dataType+"dataloading",A))})}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(p,b){if(void 0===b&&(b=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var E=p.onAdd(this);this._controls.push(p);var A=this._controlPositions[b];return-1!==b.indexOf("bottom")?A.insertBefore(E,A.firstChild):A.appendChild(E),this},s.prototype.removeControl=function(p){if(!p||!p.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var b=this._controls.indexOf(p);return b>-1&&this._controls.splice(b,1),p.onRemove(this),this},s.prototype.hasControl=function(p){return this._controls.indexOf(p)>-1},s.prototype.resize=function(p){var b=this._containerDimensions(),E=b[0],A=b[1];if(E===this.transform.width&&A===this.transform.height)return this;this._resizeCanvas(E,A),this.transform.resize(E,A),this.painter.resize(E,A);var B=!this._moving;return B&&this.fire(new l.Event("movestart",p)).fire(new l.Event("move",p)),this.fire(new l.Event("resize",p)),B&&this.fire(new l.Event("moveend",p)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(p){return this.transform.setMaxBounds(l.LngLatBounds.convert(p)),this._update()},s.prototype.setMinZoom=function(p){if((p=null==p?-2:p)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(p){if((p=null==p?22:p)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(p){if((p=null==p?0:p)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(p){if((p=null==p?60:p)>60)throw new Error("maxPitch must be less than or equal to 60");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(p){return this.transform.renderWorldCopies=p,this._update()},s.prototype.project=function(p){return this.transform.locationPoint(l.LngLat.convert(p))},s.prototype.unproject=function(p){return this.transform.pointLocation(l.Point.convert(p))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(p,b,E){var A,B=this;if("mouseenter"===p||"mouseover"===p){var $=!1;return{layer:b,listener:E,delegates:{mousemove:function(Ce){var Me=B.getLayer(b)?B.queryRenderedFeatures(Ce.point,{layers:[b]}):[];Me.length?$||($=!0,E.call(B,new So(p,B,Ce.originalEvent,{features:Me}))):$=!1},mouseout:function(){$=!1}}}}if("mouseleave"===p||"mouseout"===p){var he=!1;return{layer:b,listener:E,delegates:{mousemove:function(Ce){(B.getLayer(b)?B.queryRenderedFeatures(Ce.point,{layers:[b]}):[]).length?he=!0:he&&(he=!1,E.call(B,new So(p,B,Ce.originalEvent)))},mouseout:function(Ce){he&&(he=!1,E.call(B,new So(p,B,Ce.originalEvent)))}}}}return{layer:b,listener:E,delegates:(A={},A[p]=function(Ce){var Me=B.getLayer(b)?B.queryRenderedFeatures(Ce.point,{layers:[b]}):[];Me.length&&(Ce.features=Me,E.call(B,Ce),delete Ce.features)},A)}},s.prototype.on=function(p,b,E){if(void 0===E)return a.prototype.on.call(this,p,b);var A=this._createDelegatedListener(p,b,E);for(var B in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(A),A.delegates)this.on(B,A.delegates[B]);return this},s.prototype.once=function(p,b,E){if(void 0===E)return a.prototype.once.call(this,p,b);var A=this._createDelegatedListener(p,b,E);for(var B in A.delegates)this.once(B,A.delegates[B]);return this},s.prototype.off=function(p,b,E){var A=this;return void 0===E?a.prototype.off.call(this,p,b):(this._delegatedListeners&&this._delegatedListeners[p]&&function(B){for(var $=B[p],he=0;he<$.length;he++){var Ce=$[he];if(Ce.layer===b&&Ce.listener===E){for(var Me in Ce.delegates)A.off(Me,Ce.delegates[Me]);return $.splice(he,1),A}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(p,b){if(!this.style)return[];var E;if(void 0!==b||void 0===p||p instanceof l.Point||Array.isArray(p)||(b=p,p=void 0),b=b||{},(p=p||[[0,0],[this.transform.width,this.transform.height]])instanceof l.Point||"number"==typeof p[0])E=[l.Point.convert(p)];else{var A=l.Point.convert(p[0]),B=l.Point.convert(p[1]);E=[A,new l.Point(B.x,A.y),B,new l.Point(A.x,B.y),A]}return this.style.queryRenderedFeatures(E,b,this.transform)},s.prototype.querySourceFeatures=function(p,b){return this.style.querySourceFeatures(p,b)},s.prototype.setStyle=function(p,b){return!1!==(b=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},b)).diff&&b.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,b),this):(this._localIdeographFontFamily=b.localIdeographFontFamily,this._updateStyle(p,b))},s.prototype._getUIString=function(p){var b=this._locale[p];if(null==b)throw new Error("Missing UI string '"+p+"'");return b},s.prototype._updateStyle=function(p,b){return this.style&&(this.style.setEventedParent(null),this.style._remove()),p?(this.style=new gs(this,b||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof p?this.style.loadURL(p):this.style.loadJSON(p),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new gs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(p,b){var E=this;if("string"==typeof p){var A=this._requestManager.normalizeStyleURL(p),B=this._requestManager.transformRequest(A,l.ResourceType.Style);l.getJSON(B,function($,he){$?E.fire(new l.ErrorEvent($)):he&&E._updateDiff(he,b)})}else"object"==typeof p&&this._updateDiff(p,b)},s.prototype._updateDiff=function(p,b){try{this.style.setState(p)&&this._update(!0)}catch(E){l.warnOnce("Unable to perform style diff: "+(E.message||E.error||E)+".  Rebuilding the style from scratch."),this._updateStyle(p,b)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(p,b){return this._lazyInitEmptyStyle(),this.style.addSource(p,b),this._update(!0)},s.prototype.isSourceLoaded=function(p){var b=this.style&&this.style.sourceCaches[p];if(void 0!==b)return b.loaded();this.fire(new l.ErrorEvent(new Error("There is no source with ID '"+p+"'")))},s.prototype.areTilesLoaded=function(){var p=this.style&&this.style.sourceCaches;for(var b in p){var E=p[b]._tiles;for(var A in E){var B=E[A];if("loaded"!==B.state&&"errored"!==B.state)return!1}}return!0},s.prototype.addSourceType=function(p,b,E){return this._lazyInitEmptyStyle(),this.style.addSourceType(p,b,E)},s.prototype.removeSource=function(p){return this.style.removeSource(p),this._update(!0)},s.prototype.getSource=function(p){return this.style.getSource(p)},s.prototype.addImage=function(p,b,E){void 0===E&&(E={});var A=E.pixelRatio;void 0===A&&(A=1);var B=E.sdf;void 0===B&&(B=!1);var $=E.stretchX,he=E.stretchY,Ce=E.content;if(this._lazyInitEmptyStyle(),b instanceof jl||Qi&&b instanceof Qi){var Me=l.browser.getImageData(b);this.style.addImage(p,{data:new l.RGBAImage({width:Me.width,height:Me.height},Me.data),pixelRatio:A,stretchX:$,stretchY:he,content:Ce,sdf:B,version:0})}else{if(void 0===b.width||void 0===b.height)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ke=b;this.style.addImage(p,{data:new l.RGBAImage({width:b.width,height:b.height},new Uint8Array(b.data)),pixelRatio:A,stretchX:$,stretchY:he,content:Ce,sdf:B,version:0,userImage:ke}),ke.onAdd&&ke.onAdd(this,p)}},s.prototype.updateImage=function(p,b){var E=this.style.getImage(p);if(!E)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var A=b instanceof jl||Qi&&b instanceof Qi?l.browser.getImageData(b):b,B=A.width,$=A.height,he=A.data;return void 0===B||void 0===$?this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):B!==E.data.width||$!==E.data.height?this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(E.data.replace(he,!(b instanceof jl||Qi&&b instanceof Qi)),void this.style.updateImage(p,E))},s.prototype.hasImage=function(p){return p?!!this.style.getImage(p):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(p){this.style.removeImage(p)},s.prototype.loadImage=function(p,b){l.getImage(this._requestManager.transformRequest(p,l.ResourceType.Image),b)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(p,b){return this._lazyInitEmptyStyle(),this.style.addLayer(p,b),this._update(!0)},s.prototype.moveLayer=function(p,b){return this.style.moveLayer(p,b),this._update(!0)},s.prototype.removeLayer=function(p){return this.style.removeLayer(p),this._update(!0)},s.prototype.getLayer=function(p){return this.style.getLayer(p)},s.prototype.setLayerZoomRange=function(p,b,E){return this.style.setLayerZoomRange(p,b,E),this._update(!0)},s.prototype.setFilter=function(p,b,E){return void 0===E&&(E={}),this.style.setFilter(p,b,E),this._update(!0)},s.prototype.getFilter=function(p){return this.style.getFilter(p)},s.prototype.setPaintProperty=function(p,b,E,A){return void 0===A&&(A={}),this.style.setPaintProperty(p,b,E,A),this._update(!0)},s.prototype.getPaintProperty=function(p,b){return this.style.getPaintProperty(p,b)},s.prototype.setLayoutProperty=function(p,b,E,A){return void 0===A&&(A={}),this.style.setLayoutProperty(p,b,E,A),this._update(!0)},s.prototype.getLayoutProperty=function(p,b){return this.style.getLayoutProperty(p,b)},s.prototype.setLight=function(p,b){return void 0===b&&(b={}),this._lazyInitEmptyStyle(),this.style.setLight(p,b),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(p,b){return this.style.setFeatureState(p,b),this._update()},s.prototype.removeFeatureState=function(p,b){return this.style.removeFeatureState(p,b),this._update()},s.prototype.getFeatureState=function(p){return this.style.getFeatureState(p)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var p=0,b=0;return this._container&&(p=this._container.clientWidth||400,b=this._container.clientHeight||300),[p,b]},s.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=O.create("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=O.create("div","mapboxgl-canvas-container",p);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=O.create("canvas","mapboxgl-canvas",b),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var E=this._containerDimensions();this._resizeCanvas(E[0],E[1]);var A=this._controlContainer=O.create("div","mapboxgl-control-container",p),B=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function($){B[$]=O.create("div","mapboxgl-ctrl-"+$,A)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(p,b){var E=l.browser.devicePixelRatio||1;this._canvas.width=E*p,this._canvas.height=E*b,this._canvas.style.width=p+"px",this._canvas.style.height=b+"px"},s.prototype._setupPainter=function(){var p=l.extend({},m.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),b=this._canvas.getContext("webgl",p)||this._canvas.getContext("experimental-webgl",p);b?(this.painter=new $a(b,this.transform),l.webpSupported.testSupport(b)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:p}))},s.prototype._contextRestored=function(p){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:p}))},s.prototype._onMapScroll=function(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(p){return this._update(),this._renderTaskQueue.add(p)},s.prototype._cancelRenderFrame=function(p){this._renderTaskQueue.remove(p)},s.prototype._render=function(p){var b,E=this,A=0,B=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(b=B.createQueryEXT(),B.beginQueryEXT(B.TIME_ELAPSED_EXT,b),A=l.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),!this._removed){var $=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var he=this.transform.zoom,Ce=l.browser.now();this.style.zoomHistory.update(he,Ce);var Me=new l.EvaluationParameters(he,{now:Ce,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ke=Me.crossFadingFactor();1===ke&&ke===this._crossFadingFactor||($=!0,this._crossFadingFactor=ke),this.style.update(Me)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||$)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var et=l.browser.now()-A;B.endQueryEXT(B.TIME_ELAPSED_EXT,b),setTimeout(function(){var Ke=B.getQueryObjectEXT(b,B.QUERY_RESULT_EXT)/1e6;B.deleteQueryEXT(b),E.fire(new l.Event("gpu-timing-frame",{cpuTime:et,gpuTime:Ke}))},50)}if(this.listens("gpu-timing-layer")){var $e=this.painter.collectGpuTimers();setTimeout(function(){var Ke=E.painter.queryGpuTimers($e);E.fire(new l.Event("gpu-timing-layer",{layerTimes:Ke}))},50)}var pt=this._sourcesDirty||this._styleDirty||this._placementDirty;return pt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new l.Event("idle")),!this._loaded||this._fullyLoaded||pt||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var p=0,b=this._controls;p<b.length;p+=1)b[p].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==l.window&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1));var E=this.painter.context.gl.getExtension("WEBGL_lose_context");E&&E.loseContext(),As(this._canvasContainer),As(this._controlContainer),As(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new l.Event("remove"))},s.prototype.triggerRepaint=function(){var p=this;this.style&&!this._frame&&(this._frame=l.browser.frame(function(b){p._frame=null,p._render(b)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(p){this._trackResize&&this.resize({originalEvent:p})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(p){this._showPadding!==p&&(this._showPadding=p,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(p){this._vertices=p,this._update()},s.prototype._setCacheLimits=function(p,b){l.setCacheLimits(p,b)},o.version.get=function(){return l.version},Object.defineProperties(s.prototype,o),s}(lc);function As(a){a.parentNode&&a.parentNode.removeChild(a)}var bl={showCompass:!0,showZoom:!0,visualizePitch:!1},ys=function(a){var s=this;this.options=l.extend({},bl,a),this._container=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),O.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),O.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=O.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ys.prototype._updateZoomButtons=function(){var a=this._map.getZoom(),s=a===this._map.getMaxZoom(),o=a===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},ys.prototype._rotateCompassArrow=function(){var a=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=a},ys.prototype.onAdd=function(a){return this._map=a,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new is(this._map,this._compass,this.options.visualizePitch)),this._container},ys.prototype.onRemove=function(){O.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ys.prototype._createButton=function(a,s){var o=O.create("button",a,this._container);return o.type="button",o.addEventListener("click",s),o},ys.prototype._setButtonTitle=function(a,s){var o=this._map._getUIString("NavigationControl."+s);a.title=o,a.setAttribute("aria-label",o)};var is=function(a,s,o){void 0===o&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Oc({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,o&&(this.mousePitch=new xl({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),O.addEventListener(s,"mousedown",this.mousedown),O.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),O.addEventListener(s,"touchmove",this.touchmove),O.addEventListener(s,"touchend",this.touchend),O.addEventListener(s,"touchcancel",this.reset)};function al(a,s,o){if(a=new l.LngLat(a.lng,a.lat),s){var p=new l.LngLat(a.lng-360,a.lat),b=new l.LngLat(a.lng+360,a.lat),E=o.locationPoint(a).distSqr(s);o.locationPoint(p).distSqr(s)<E?a=p:o.locationPoint(b).distSqr(s)<E&&(a=b)}for(;Math.abs(a.lng-o.center.lng)>180;){var A=o.locationPoint(a);if(A.x>=0&&A.y>=0&&A.x<=o.width&&A.y<=o.height)break;a.lng>o.center.lng?a.lng-=360:a.lng+=360}return a}is.prototype.down=function(a,s){this.mouseRotate.mousedown(a,s),this.mousePitch&&this.mousePitch.mousedown(a,s),O.disableDrag()},is.prototype.move=function(a,s){var o=this.map,p=this.mouseRotate.mousemoveWindow(a,s);if(p&&p.bearingDelta&&o.setBearing(o.getBearing()+p.bearingDelta),this.mousePitch){var b=this.mousePitch.mousemoveWindow(a,s);b&&b.pitchDelta&&o.setPitch(o.getPitch()+b.pitchDelta)}},is.prototype.off=function(){var a=this.element;O.removeEventListener(a,"mousedown",this.mousedown),O.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),O.removeEventListener(a,"touchmove",this.touchmove),O.removeEventListener(a,"touchend",this.touchend),O.removeEventListener(a,"touchcancel",this.reset),this.offTemp()},is.prototype.offTemp=function(){O.enableDrag(),O.removeEventListener(l.window,"mousemove",this.mousemove),O.removeEventListener(l.window,"mouseup",this.mouseup)},is.prototype.mousedown=function(a){this.down(l.extend({},a,{ctrlKey:!0,preventDefault:function(){return a.preventDefault()}}),O.mousePos(this.element,a)),O.addEventListener(l.window,"mousemove",this.mousemove),O.addEventListener(l.window,"mouseup",this.mouseup)},is.prototype.mousemove=function(a){this.move(a,O.mousePos(this.element,a))},is.prototype.mouseup=function(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()},is.prototype.touchstart=function(a){1!==a.targetTouches.length?this.reset():(this._startPos=this._lastPos=O.touchPos(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return a.preventDefault()}},this._startPos))},is.prototype.touchmove=function(a){1!==a.targetTouches.length?this.reset():(this._lastPos=O.touchPos(this.element,a.targetTouches)[0],this.move({preventDefault:function(){return a.preventDefault()}},this._lastPos))},is.prototype.touchend=function(a){0===a.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},is.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var su={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Hl(a,s,o){var p=a.classList;for(var b in su)p.remove("mapboxgl-"+o+"-anchor-"+b);p.add("mapboxgl-"+o+"-anchor-"+s)}var Sl,Wl=function(a){function s(o,p){if(a.call(this),(o instanceof l.window.HTMLElement||p)&&(o=l.extend({element:o},p)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=l.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=O.create("div"),this._element.setAttribute("aria-label","Map marker");var b=O.createNS("http://www.w3.org/2000/svg","svg");b.setAttributeNS(null,"display","block"),b.setAttributeNS(null,"height","41px"),b.setAttributeNS(null,"width","27px"),b.setAttributeNS(null,"viewBox","0 0 27 41");var E=O.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");var A=O.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill-rule","nonzero");var B=O.createNS("http://www.w3.org/2000/svg","g");B.setAttributeNS(null,"transform","translate(3.0, 29.0)"),B.setAttributeNS(null,"fill","#000000");for(var $=0,he=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];$<he.length;$+=1){var Ce=he[$],Me=O.createNS("http://www.w3.org/2000/svg","ellipse");Me.setAttributeNS(null,"opacity","0.04"),Me.setAttributeNS(null,"cx","10.5"),Me.setAttributeNS(null,"cy","5.80029008"),Me.setAttributeNS(null,"rx",Ce.rx),Me.setAttributeNS(null,"ry",Ce.ry),B.appendChild(Me)}var ke=O.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"fill",this._color);var et=O.createNS("http://www.w3.org/2000/svg","path");et.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ke.appendChild(et);var $e=O.createNS("http://www.w3.org/2000/svg","g");$e.setAttributeNS(null,"opacity","0.25"),$e.setAttributeNS(null,"fill","#000000");var pt=O.createNS("http://www.w3.org/2000/svg","path");pt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$e.appendChild(pt);var Ke=O.createNS("http://www.w3.org/2000/svg","g");Ke.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ke.setAttributeNS(null,"fill","#FFFFFF");var ft=O.createNS("http://www.w3.org/2000/svg","g");ft.setAttributeNS(null,"transform","translate(8.0, 8.0)");var It=O.createNS("http://www.w3.org/2000/svg","circle");It.setAttributeNS(null,"fill","#000000"),It.setAttributeNS(null,"opacity","0.25"),It.setAttributeNS(null,"cx","5.5"),It.setAttributeNS(null,"cy","5.5"),It.setAttributeNS(null,"r","5.4999962");var Wt=O.createNS("http://www.w3.org/2000/svg","circle");Wt.setAttributeNS(null,"fill","#FFFFFF"),Wt.setAttributeNS(null,"cx","5.5"),Wt.setAttributeNS(null,"cy","5.5"),Wt.setAttributeNS(null,"r","5.4999962"),ft.appendChild(It),ft.appendChild(Wt),A.appendChild(B),A.appendChild(ke),A.appendChild($e),A.appendChild(Ke),A.appendChild(ft),b.appendChild(A),b.setAttributeNS(null,"height",41*this._scale+"px"),b.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(b),this._offset=l.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(pr){pr.preventDefault()}),this._element.addEventListener("mousedown",function(pr){pr.preventDefault()}),Hl(this._element,this._anchor,"marker"),this._popup=null}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),O.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=l.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var p=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(24.6+p)],"bottom-right":[-p,-1*(24.6+p)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var p=o.code,b=o.charCode||o.keyCode;"Space"!==p&&"Enter"!==p&&32!==b&&13!==b||this.togglePopup()},s.prototype._onMapClick=function(o){var p=o.originalEvent.target,b=this._element;this._popup&&(p===b||b.contains(p))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=al(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var p="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?p="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(p="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var b="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?b="rotateX(0deg)":"map"===this._pitchAlignment&&(b="rotateX("+this._map.getPitch()+"deg)"),o&&"moveend"!==o.type||(this._pos=this._pos.round()),O.setTransform(this._element,su[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+b+" "+p)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=l.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var p=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new l.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(l.Evented),Kc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},wl=0,ol=!1,kc=function(a){function s(o){a.call(this),this.options=l.extend({},Kc,o),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.onAdd=function(o){var p;return this._map=o,this._container=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),p=this._setupUI,void 0!==Sl?p(Sl):void 0!==l.window.navigator.permissions?l.window.navigator.permissions.query({name:"geolocation"}).then(function(b){p(Sl="denied"!==b.state)}):p(Sl=!!l.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),O.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,wl=0,ol=!1},s.prototype._isOutOfMapMaxBounds=function(o){var p=this._map.getMaxBounds(),b=o.coords;return p&&(b.longitude<p.getWest()||b.longitude>p.getEast()||b.latitude<p.getSouth()||b.latitude>p.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var p=new l.LngLat(o.coords.longitude,o.coords.latitude),b=o.coords.accuracy,E=this._map.getBearing(),A=l.extend({bearing:E},this.options.fitBoundsOptions);this._map.fitBounds(p.toBounds(b),A,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var p=new l.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(p).addTo(this._map),this._userLocationDotMarker.setLngLat(p).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,p=this._map.unproject([0,o]),b=this._map.unproject([1,o]),E=p.distanceTo(b),A=Math.ceil(2*this._accuracy/E);this._circleElement.style.width=A+"px",this._circleElement.style.height=A+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&ol)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var p=this;if(this._container.addEventListener("contextmenu",function(A){return A.preventDefault()}),this._geolocateButton=O.create("button","mapboxgl-ctrl-geolocate",this._container),O.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===o){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var b=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=b,this._geolocateButton.setAttribute("aria-label",b)}else{var E=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=O.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Wl(this._dotElement),this._circleElement=O.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(A){A.geolocateSource||"ACTIVE_LOCK"!==p._watchState||A.originalEvent&&"resize"===A.originalEvent.type||(p._watchState="BACKGROUND",p._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),p._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),p.fire(new l.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":wl--,ol=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++wl>1?(o={maximumAge:6e5,timeout:0},ol=!0):(o=this.options.positionOptions,ol=!1),this._geolocationWatchID=l.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else l.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(l.Evented),sl={maxWidth:100,unit:"metric"},ju=function(a){this.options=l.extend({},sl,a),l.bindAll(["_onMove","setUnit"],this)};function Xl(a,s,o){var p=o&&o.maxWidth||100,b=a._container.clientHeight/2,E=a.unproject([0,b]),A=a.unproject([p,b]),B=E.distanceTo(A);if(o&&"imperial"===o.unit){var $=3.2808*B;$>5280?Gu(s,p,$/5280,a._getUIString("ScaleControl.Miles")):Gu(s,p,$,a._getUIString("ScaleControl.Feet"))}else o&&"nautical"===o.unit?Gu(s,p,B/1852,a._getUIString("ScaleControl.NauticalMiles")):B>=1e3?Gu(s,p,B/1e3,a._getUIString("ScaleControl.Kilometers")):Gu(s,p,B,a._getUIString("ScaleControl.Meters"))}function Gu(a,s,o,p){var b,E,A,$,he,B=(b=o,(E=Math.pow(10,(""+Math.floor(b)).length-1))*(A=(A=b/E)>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:($=A,he=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10)),Math.round($*he)/he)));a.style.width=s*(B/o)+"px",a.innerHTML=B+"&nbsp;"+p}ju.prototype.getDefaultPosition=function(){return"bottom-left"},ju.prototype._onMove=function(){Xl(this._map,this._container,this.options)},ju.prototype.onAdd=function(a){return this._map=a,this._container=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ju.prototype.onRemove=function(){O.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ju.prototype.setUnit=function(a){this.options.unit=a,Xl(this._map,this._container,this.options)};var Bs=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof l.window.HTMLElement?this._container=a.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in l.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in l.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in l.window.document&&(this._fullscreenchange="MSFullscreenChange")};Bs.prototype.onAdd=function(a){return this._map=a,this._container||(this._container=this._map.getContainer()),this._controlContainer=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Bs.prototype.onRemove=function(){O.remove(this._controlContainer),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Bs.prototype._checkFullscreenSupport=function(){return!!(l.window.document.fullscreenEnabled||l.window.document.mozFullScreenEnabled||l.window.document.msFullscreenEnabled||l.window.document.webkitFullscreenEnabled)},Bs.prototype._setupUI=function(){var a=this._fullscreenButton=O.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);O.create("span","mapboxgl-ctrl-icon",a).setAttribute("aria-hidden",!0),a.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Bs.prototype._updateTitle=function(){var a=this._getTitle();this._fullscreenButton.setAttribute("aria-label",a),this._fullscreenButton.title=a},Bs.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Bs.prototype._isFullscreen=function(){return this._fullscreen},Bs.prototype._changeIcon=function(){(l.window.document.fullscreenElement||l.window.document.mozFullScreenElement||l.window.document.webkitFullscreenElement||l.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Bs.prototype._onClickFullscreen=function(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.mozCancelFullScreen?l.window.document.mozCancelFullScreen():l.window.document.msExitFullscreen?l.window.document.msExitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Rc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},cc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),fc=function(a){function s(o){a.call(this),this.options=l.extend(Object.create(Rc),o),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&O.remove(this._content),this._container&&(O.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=l.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(l.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var p,b=l.window.document.createDocumentFragment(),E=l.window.document.createElement("body");for(E.innerHTML=o;p=E.firstChild;)b.appendChild(p);return this.setDOMContent(b)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=O.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=O.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var p=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=O.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=O.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Me){return p._container.classList.add(Me)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=al(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var b=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),E=this.options.anchor,A=function Me(ke){if(ke){if("number"==typeof ke){var et=Math.round(Math.sqrt(.5*Math.pow(ke,2)));return{center:new l.Point(0,0),top:new l.Point(0,ke),"top-left":new l.Point(et,et),"top-right":new l.Point(-et,et),bottom:new l.Point(0,-ke),"bottom-left":new l.Point(et,-et),"bottom-right":new l.Point(-et,-et),left:new l.Point(ke,0),right:new l.Point(-ke,0)}}if(ke instanceof l.Point||Array.isArray(ke)){var $e=l.Point.convert(ke);return{center:$e,top:$e,"top-left":$e,"top-right":$e,bottom:$e,"bottom-left":$e,"bottom-right":$e,left:$e,right:$e}}return{center:l.Point.convert(ke.center||[0,0]),top:l.Point.convert(ke.top||[0,0]),"top-left":l.Point.convert(ke["top-left"]||[0,0]),"top-right":l.Point.convert(ke["top-right"]||[0,0]),bottom:l.Point.convert(ke.bottom||[0,0]),"bottom-left":l.Point.convert(ke["bottom-left"]||[0,0]),"bottom-right":l.Point.convert(ke["bottom-right"]||[0,0]),left:l.Point.convert(ke.left||[0,0]),right:l.Point.convert(ke.right||[0,0])}}return Me(new l.Point(0,0))}(this.options.offset);if(!E){var B,$=this._container.offsetWidth,he=this._container.offsetHeight;B=b.y+A.bottom.y<he?["top"]:b.y>this._map.transform.height-he?["bottom"]:[],b.x<$/2?B.push("left"):b.x>this._map.transform.width-$/2&&B.push("right"),E=0===B.length?"bottom":B.join("-")}var Ce=b.add(A[E]).round();O.setTransform(this._container,su[E]+" translate("+Ce.x+"px,"+Ce.y+"px)"),Hl(this._container,E,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(cc);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(l.Evented),El={version:l.version,supported:m,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:ff,NavigationControl:ys,GeolocateControl:kc,AttributionControl:wo,ScaleControl:ju,FullscreenControl:Bs,Popup:fc,Marker:Wl,Style:gs,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,Evented:l.Evented,config:l.config,prewarm:function(){rr().acquire(ar)},clearPrewarmedResources:function(){var a=Rn;a&&(a.isPreloaded()&&1===a.numActive()?(a.release(ar),Rn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(a){l.config.ACCESS_TOKEN=a},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(a){l.config.API_URL=a},get workerCount(){return Br.workerCount},set workerCount(a){Br.workerCount=a},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(a){l.config.MAX_PARALLEL_IMAGE_REQUESTS=a},clearStorage:function(a){l.clearTileCache(a)},workerUrl:""};return El}),M}()},76149:(ne,L,y)=>{"use strict";y.d(L,{my:()=>Ue,A2:()=>kt});var M=y(70946),_=y(80521),l=y(37716),m=y(79765),R=(y(20945),y(46782)),N=y(38583),H=y(68178);y(31253),y(96182);let V=(()=>{class ut{}return ut.\u0275fac=function(le){return new(le||ut)},ut.\u0275mod=l.oAB({type:ut}),ut.\u0275inj=l.cJS({imports:[[N.ez]]}),ut})();function W(ut,ir){if(1&ut&&(l.ynx(0),l._uU(1),l.BQk()),2&ut){const le=l.oxw();l.xp6(1),l.Oqu(le.nzTitle)}}function Ye(ut,ir){if(1&ut&&(l.ynx(0),l._uU(1),l.BQk()),2&ut){const le=l.oxw(2);l.xp6(1),l.Oqu(le.nzPrefix)}}function _t(ut,ir){if(1&ut&&(l.TgZ(0,"span",7),l.YNc(1,Ye,2,1,"ng-container",2),l.qZA()),2&ut){const le=l.oxw();l.xp6(1),l.Q6J("nzStringTemplateOutlet",le.nzPrefix)}}function Rt(ut,ir){if(1&ut&&(l.ynx(0),l._uU(1),l.BQk()),2&ut){const le=l.oxw(2);l.xp6(1),l.Oqu(le.nzSuffix)}}function wt(ut,ir){if(1&ut&&(l.TgZ(0,"span",8),l.YNc(1,Rt,2,1,"ng-container",2),l.qZA()),2&ut){const le=l.oxw();l.xp6(1),l.Q6J("nzStringTemplateOutlet",le.nzSuffix)}}const tt=function(ut){return{$implicit:ut}};function Gt(ut,ir){if(1&ut&&l.GkF(0,3),2&ut){const le=l.oxw();l.Q6J("ngTemplateOutlet",le.nzValueTemplate)("ngTemplateOutletContext",l.VKq(2,tt,le.nzValue))}}function Q(ut,ir){if(1&ut&&(l.TgZ(0,"span",6),l._uU(1),l.qZA()),2&ut){const le=l.oxw(2);l.xp6(1),l.Oqu(le.displayInt)}}function Ut(ut,ir){if(1&ut&&(l.TgZ(0,"span",7),l._uU(1),l.qZA()),2&ut){const le=l.oxw(2);l.xp6(1),l.Oqu(le.displayDecimal)}}function ot(ut,ir){if(1&ut&&(l.ynx(0),l.YNc(1,Q,2,1,"span",4),l.YNc(2,Ut,2,1,"span",5),l.BQk()),2&ut){const le=l.oxw();l.xp6(1),l.Q6J("ngIf",le.displayInt),l.xp6(1),l.Q6J("ngIf",le.displayDecimal)}}let Ue=(()=>{class ut{constructor(le,ce){this.cdr=le,this.directionality=ce,this.nzValueStyle={},this.dir="ltr",this.destroy$=new m.xQ}ngOnInit(){var le;null===(le=this.directionality.change)||void 0===le||le.pipe((0,R.R)(this.destroy$)).subscribe(ce=>{this.dir=ce,this.cdr.detectChanges()}),this.dir=this.directionality.value}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return ut.\u0275fac=function(le){return new(le||ut)(l.Y36(l.sBO),l.Y36(M.Is,8))},ut.\u0275cmp=l.Xpm({type:ut,selectors:[["nz-statistic"]],inputs:{nzValueStyle:"nzValueStyle",nzPrefix:"nzPrefix",nzSuffix:"nzSuffix",nzTitle:"nzTitle",nzValue:"nzValue",nzValueTemplate:"nzValueTemplate"},exportAs:["nzStatistic"],decls:7,vars:8,consts:[[1,"ant-statistic"],[1,"ant-statistic-title"],[4,"nzStringTemplateOutlet"],[1,"ant-statistic-content",3,"ngStyle"],["class","ant-statistic-content-prefix",4,"ngIf"],[3,"nzValue","nzValueTemplate"],["class","ant-statistic-content-suffix",4,"ngIf"],[1,"ant-statistic-content-prefix"],[1,"ant-statistic-content-suffix"]],template:function(le,ce){1&le&&(l.TgZ(0,"div",0),l.TgZ(1,"div",1),l.YNc(2,W,2,1,"ng-container",2),l.qZA(),l.TgZ(3,"div",3),l.YNc(4,_t,2,1,"span",4),l._UZ(5,"nz-statistic-number",5),l.YNc(6,wt,2,1,"span",6),l.qZA(),l.qZA()),2&le&&(l.ekj("ant-statistic-rtl","rtl"===ce.dir),l.xp6(2),l.Q6J("nzStringTemplateOutlet",ce.nzTitle),l.xp6(1),l.Q6J("ngStyle",ce.nzValueStyle),l.xp6(1),l.Q6J("ngIf",ce.nzPrefix),l.xp6(1),l.Q6J("nzValue",ce.nzValue)("nzValueTemplate",ce.nzValueTemplate),l.xp6(1),l.Q6J("ngIf",ce.nzSuffix))},directives:function(){return[H.f,N.PC,N.O5,Pt]},encapsulation:2,changeDetection:0}),ut})(),Pt=(()=>{class ut{constructor(le){this.locale_id=le,this.displayInt="",this.displayDecimal=""}ngOnChanges(){this.formatNumber()}formatNumber(){const le="number"==typeof this.nzValue?".":(0,N.dv)(this.locale_id,N.wE.Decimal),ce=String(this.nzValue),[ae,me]=ce.split(le);this.displayInt=ae,this.displayDecimal=me?`${le}${me}`:""}}return ut.\u0275fac=function(le){return new(le||ut)(l.Y36(l.soG))},ut.\u0275cmp=l.Xpm({type:ut,selectors:[["nz-statistic-number"]],inputs:{nzValue:"nzValue",nzValueTemplate:"nzValueTemplate"},exportAs:["nzStatisticNumber"],features:[l.TTD],decls:3,vars:2,consts:[[1,"ant-statistic-content-value"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","ant-statistic-content-value-int",4,"ngIf"],["class","ant-statistic-content-value-decimal",4,"ngIf"],[1,"ant-statistic-content-value-int"],[1,"ant-statistic-content-value-decimal"]],template:function(le,ce){1&le&&(l.TgZ(0,"span",0),l.YNc(1,Gt,1,4,"ng-container",1),l.YNc(2,ot,3,2,"ng-container",2),l.qZA()),2&le&&(l.xp6(1),l.Q6J("ngIf",ce.nzValueTemplate),l.xp6(1),l.Q6J("ngIf",!ce.nzValueTemplate))},directives:[N.O5,N.tP],encapsulation:2,changeDetection:0}),ut})(),kt=(()=>{class ut{}return ut.\u0275fac=function(le){return new(le||ut)},ut.\u0275mod=l.oAB({type:ut}),ut.\u0275inj=l.cJS({imports:[[M.vT,N.ez,_.ud,H.T,V]]}),ut})()},78320:()=>{var ne,L;L=ne||(ne={}),function(y){var M="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),_=l(L);function l(m,O){return function(R,N){"function"!=typeof m[R]&&Object.defineProperty(m,R,{configurable:!0,writable:!0,value:N}),O&&O(R,N)}}void 0===M.Reflect?M.Reflect=L:_=l(M.Reflect,_),function(y){var M=Object.prototype.hasOwnProperty,_="function"==typeof Symbol,l=_&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",m=_&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",O="function"==typeof Object.create,R={__proto__:[]}instanceof Array,N=!O&&!R,H={create:O?function(){return Dt(Object.create(null))}:R?function(){return Dt({__proto__:null})}:function(){return Dt({})},has:N?function(Z,Ze){return M.call(Z,Ze)}:function(Z,Ze){return Ze in Z},get:N?function(Z,Ze){return M.call(Z,Ze)?Z[Ze]:void 0}:function(Z,Ze){return Z[Ze]}},j=Object.getPrototypeOf(Function),be="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Ne=be||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var Z={},Ze=[],Et=function(){function mr(Yt,gr,sr){this._index=0,this._keys=Yt,this._values=gr,this._selector=sr}return mr.prototype["@@iterator"]=function(){return this},mr.prototype[m]=function(){return this},mr.prototype.next=function(){var Yt=this._index;if(Yt>=0&&Yt<this._keys.length){var gr=this._selector(this._keys[Yt],this._values[Yt]);return Yt+1>=this._keys.length?(this._index=-1,this._keys=Ze,this._values=Ze):this._index++,{value:gr,done:!1}}return{value:void 0,done:!0}},mr.prototype.throw=function(Yt){throw this._index>=0&&(this._index=-1,this._keys=Ze,this._values=Ze),Yt},mr.prototype.return=function(Yt){return this._index>=0&&(this._index=-1,this._keys=Ze,this._values=Ze),{value:Yt,done:!0}},mr}();return function(){function mr(){this._keys=[],this._values=[],this._cacheKey=Z,this._cacheIndex=-2}return Object.defineProperty(mr.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),mr.prototype.has=function(Yt){return this._find(Yt,!1)>=0},mr.prototype.get=function(Yt){var gr=this._find(Yt,!1);return gr>=0?this._values[gr]:void 0},mr.prototype.set=function(Yt,gr){var sr=this._find(Yt,!0);return this._values[sr]=gr,this},mr.prototype.delete=function(Yt){var gr=this._find(Yt,!1);if(gr>=0){for(var sr=this._keys.length,dr=gr+1;dr<sr;dr++)this._keys[dr-1]=this._keys[dr],this._values[dr-1]=this._values[dr];return this._keys.length--,this._values.length--,Yt===this._cacheKey&&(this._cacheKey=Z,this._cacheIndex=-2),!0}return!1},mr.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Z,this._cacheIndex=-2},mr.prototype.keys=function(){return new Et(this._keys,this._values,Mt)},mr.prototype.values=function(){return new Et(this._keys,this._values,Jt)},mr.prototype.entries=function(){return new Et(this._keys,this._values,Tr)},mr.prototype["@@iterator"]=function(){return this.entries()},mr.prototype[m]=function(){return this.entries()},mr.prototype._find=function(Yt,gr){return this._cacheKey!==Yt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Yt)),this._cacheIndex<0&&gr&&(this._cacheIndex=this._keys.length,this._keys.push(Yt),this._values.push(void 0)),this._cacheIndex},mr}();function Mt(mr,Yt){return mr}function Jt(mr,Yt){return Yt}function Tr(mr,Yt){return[mr,Yt]}}():Map,V=be||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function Z(){this._map=new Ne}return Object.defineProperty(Z.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Z.prototype.has=function(Ze){return this._map.has(Ze)},Z.prototype.add=function(Ze){return this._map.set(Ze,Ze),this},Z.prototype.delete=function(Ze){return this._map.delete(Ze)},Z.prototype.clear=function(){this._map.clear()},Z.prototype.keys=function(){return this._map.keys()},Z.prototype.values=function(){return this._map.values()},Z.prototype.entries=function(){return this._map.entries()},Z.prototype["@@iterator"]=function(){return this.keys()},Z.prototype[m]=function(){return this.keys()},Z}():Set,Ye=new(be||"function"!=typeof WeakMap?function(){var Ze=H.create(),Et=Mt();return function(){function gr(){this._key=Mt()}return gr.prototype.has=function(sr){var dr=Jt(sr,!1);return void 0!==dr&&H.has(dr,this._key)},gr.prototype.get=function(sr){var dr=Jt(sr,!1);return void 0!==dr?H.get(dr,this._key):void 0},gr.prototype.set=function(sr,dr){return Jt(sr,!0)[this._key]=dr,this},gr.prototype.delete=function(sr){var dr=Jt(sr,!1);return void 0!==dr&&delete dr[this._key]},gr.prototype.clear=function(){this._key=Mt()},gr}();function Mt(){var gr;do{gr="@@WeakMap@@"+Yt()}while(H.has(Ze,gr));return Ze[gr]=!0,gr}function Jt(gr,sr){if(!M.call(gr,Et)){if(!sr)return;Object.defineProperty(gr,Et,{value:H.create()})}return gr[Et]}function Tr(gr,sr){for(var dr=0;dr<sr;++dr)gr[dr]=255*Math.random()|0;return gr}function Yt(){var gr=function(gr){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(gr)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(gr)):Tr(new Uint8Array(gr),gr):Tr(new Array(gr),gr)}(16);gr[6]=79&gr[6]|64,gr[8]=191&gr[8]|128;for(var sr="",dr=0;dr<16;++dr){var mn=gr[dr];(4===dr||6===dr||8===dr)&&(sr+="-"),mn<16&&(sr+="0"),sr+=mn.toString(16).toLowerCase()}return sr}}():WeakMap);function Pt(Z,Ze,Et){var Mt=Ye.get(Z);if(je(Mt)){if(!Et)return;Mt=new Ne,Ye.set(Z,Mt)}var Jt=Mt.get(Ze);if(je(Jt)){if(!Et)return;Jt=new Ne,Mt.set(Ze,Jt)}return Jt}function kt(Z,Ze,Et){if(ut(Z,Ze,Et))return!0;var Jt=Y(Ze);return!gt(Jt)&&kt(Z,Jt,Et)}function ut(Z,Ze,Et){var Mt=Pt(Ze,Et,!1);return!je(Mt)&&function(Z){return!!Z}(Mt.has(Z))}function ir(Z,Ze,Et){if(ut(Z,Ze,Et))return le(Z,Ze,Et);var Jt=Y(Ze);return gt(Jt)?void 0:ir(Z,Jt,Et)}function le(Z,Ze,Et){var Mt=Pt(Ze,Et,!1);if(!je(Mt))return Mt.get(Z)}function ce(Z,Ze,Et,Mt){Pt(Et,Mt,!0).set(Z,Ze)}function ae(Z,Ze){var Et=me(Z,Ze),Mt=Y(Z);if(null===Mt)return Et;var Jt=ae(Mt,Ze);if(Jt.length<=0)return Et;if(Et.length<=0)return Jt;for(var Tr=new V,mr=[],Yt=0,gr=Et;Yt<gr.length;Yt++)Tr.has(sr=gr[Yt])||(Tr.add(sr),mr.push(sr));for(var mn=0,On=Jt;mn<On.length;mn++){var sr;Tr.has(sr=On[mn])||(Tr.add(sr),mr.push(sr))}return mr}function me(Z,Ze){var Et=[],Mt=Pt(Z,Ze,!1);if(je(Mt))return Et;for(var Tr=function(Z){var Ze=er(Z,m);if(!Re(Ze))throw new TypeError;var Et=Ze.call(Z);if(!Fr(Et))throw new TypeError;return Et}(Mt.keys()),mr=0;;){var Yt=$r(Tr);if(!Yt)return Et.length=mr,Et;var gr=Nr(Yt);try{Et[mr]=gr}catch(sr){try{C(Tr)}finally{throw sr}}mr++}}function Ie(Z){if(null===Z)return 1;switch(typeof Z){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===Z?1:6;default:return 6}}function je(Z){return void 0===Z}function gt(Z){return null===Z}function Fr(Z){return"object"==typeof Z?null!==Z:"function"==typeof Z}function cn(Z,Ze){switch(Ie(Z)){case 0:case 1:case 2:case 3:case 4:case 5:return Z}var Et=3===Ze?"string":5===Ze?"number":"default",Mt=er(Z,l);if(void 0!==Mt){var Jt=Mt.call(Z,Et);if(Fr(Jt))throw new TypeError;return Jt}return function(Z,Ze){if("string"===Ze){var Et=Z.toString;if(Re(Et)&&!Fr(Mt=Et.call(Z)))return Mt;if(Re(Jt=Z.valueOf)&&!Fr(Mt=Jt.call(Z)))return Mt}else{var Jt;if(Re(Jt=Z.valueOf)&&!Fr(Mt=Jt.call(Z)))return Mt;var Mt,Tr=Z.toString;if(Re(Tr)&&!Fr(Mt=Tr.call(Z)))return Mt}throw new TypeError}(Z,"default"===Et?"number":Et)}function we(Z){var Ze=cn(Z,3);return function(Z){return"symbol"==typeof Z}(Ze)?Ze:function(Z){return""+Z}(Ze)}function at(Z){return Array.isArray?Array.isArray(Z):Z instanceof Object?Z instanceof Array:"[object Array]"===Object.prototype.toString.call(Z)}function Re(Z){return"function"==typeof Z}function qt(Z){return"function"==typeof Z}function er(Z,Ze){var Et=Z[Ze];if(null!=Et){if(!Re(Et))throw new TypeError;return Et}}function Nr(Z){return Z.value}function $r(Z){var Ze=Z.next();return!Ze.done&&Ze}function C(Z){var Ze=Z.return;Ze&&Ze.call(Z)}function Y(Z){var Ze=Object.getPrototypeOf(Z);if("function"!=typeof Z||Z===j||Ze!==j)return Ze;var Et=Z.prototype,Mt=Et&&Object.getPrototypeOf(Et);if(null==Mt||Mt===Object.prototype)return Ze;var Jt=Mt.constructor;return"function"!=typeof Jt||Jt===Z?Ze:Jt}function Dt(Z){return Z.__=void 0,delete Z.__,Z}y("decorate",function(Z,Ze,Et,Mt){if(je(Et)){if(!at(Z))throw new TypeError;if(!qt(Ze))throw new TypeError;return function(Z,Ze){for(var Et=Z.length-1;Et>=0;--Et){var Jt=(0,Z[Et])(Ze);if(!je(Jt)&&!gt(Jt)){if(!qt(Jt))throw new TypeError;Ze=Jt}}return Ze}(Z,Ze)}if(!at(Z))throw new TypeError;if(!Fr(Ze))throw new TypeError;if(!Fr(Mt)&&!je(Mt)&&!gt(Mt))throw new TypeError;return gt(Mt)&&(Mt=void 0),function(Z,Ze,Et,Mt){for(var Jt=Z.length-1;Jt>=0;--Jt){var mr=(0,Z[Jt])(Ze,Et,Mt);if(!je(mr)&&!gt(mr)){if(!Fr(mr))throw new TypeError;Mt=mr}}return Mt}(Z,Ze,Et=we(Et),Mt)}),y("metadata",function(Z,Ze){return function(Mt,Jt){if(!Fr(Mt))throw new TypeError;if(!je(Jt)&&!function(Z){switch(Ie(Z)){case 3:case 4:return!0;default:return!1}}(Jt))throw new TypeError;ce(Z,Ze,Mt,Jt)}}),y("defineMetadata",function(Z,Ze,Et,Mt){if(!Fr(Et))throw new TypeError;return je(Mt)||(Mt=we(Mt)),ce(Z,Ze,Et,Mt)}),y("hasMetadata",function(Z,Ze,Et){if(!Fr(Ze))throw new TypeError;return je(Et)||(Et=we(Et)),kt(Z,Ze,Et)}),y("hasOwnMetadata",function(Z,Ze,Et){if(!Fr(Ze))throw new TypeError;return je(Et)||(Et=we(Et)),ut(Z,Ze,Et)}),y("getMetadata",function(Z,Ze,Et){if(!Fr(Ze))throw new TypeError;return je(Et)||(Et=we(Et)),ir(Z,Ze,Et)}),y("getOwnMetadata",function(Z,Ze,Et){if(!Fr(Ze))throw new TypeError;return je(Et)||(Et=we(Et)),le(Z,Ze,Et)}),y("getMetadataKeys",function(Z,Ze){if(!Fr(Z))throw new TypeError;return je(Ze)||(Ze=we(Ze)),ae(Z,Ze)}),y("getOwnMetadataKeys",function(Z,Ze){if(!Fr(Z))throw new TypeError;return je(Ze)||(Ze=we(Ze)),me(Z,Ze)}),y("deleteMetadata",function(Z,Ze,Et){if(!Fr(Ze))throw new TypeError;je(Et)||(Et=we(Et));var Mt=Pt(Ze,Et,!1);if(je(Mt)||!Mt.delete(Z))return!1;if(Mt.size>0)return!0;var Jt=Ye.get(Ze);return Jt.delete(Et),Jt.size>0||Ye.delete(Ze),!0})}(_)}()},67941:ne=>{var L=function(y){"use strict";var l,M=Object.prototype,_=M.hasOwnProperty,m="function"==typeof Symbol?Symbol:{},O=m.iterator||"@@iterator",R=m.asyncIterator||"@@asyncIterator",N=m.toStringTag||"@@toStringTag";function H(ce,ae,me){return Object.defineProperty(ce,ae,{value:me,enumerable:!0,configurable:!0,writable:!0}),ce[ae]}try{H({},"")}catch(ce){H=function(ae,me,Ie){return ae[me]=Ie}}function j(ce,ae,me,Ie){var gt=Object.create((ae&&ae.prototype instanceof Rt?ae:Rt).prototype),xr=new ut(Ie||[]);return gt._invoke=function(ce,ae,me){var Ie=Ne;return function(gt,xr){if(Ie===W)throw new Error("Generator is already running");if(Ie===Ye){if("throw"===gt)throw xr;return le()}for(me.method=gt,me.arg=xr;;){var Fr=me.delegate;if(Fr){var cn=Xe(Fr,me);if(cn){if(cn===_t)continue;return cn}}if("next"===me.method)me.sent=me._sent=me.arg;else if("throw"===me.method){if(Ie===Ne)throw Ie=Ye,me.arg;me.dispatchException(me.arg)}else"return"===me.method&&me.abrupt("return",me.arg);Ie=W;var Ir=be(ce,ae,me);if("normal"===Ir.type){if(Ie=me.done?Ye:V,Ir.arg===_t)continue;return{value:Ir.arg,done:me.done}}"throw"===Ir.type&&(Ie=Ye,me.method="throw",me.arg=Ir.arg)}}}(ce,me,xr),gt}function be(ce,ae,me){try{return{type:"normal",arg:ce.call(ae,me)}}catch(Ie){return{type:"throw",arg:Ie}}}y.wrap=j;var Ne="suspendedStart",V="suspendedYield",W="executing",Ye="completed",_t={};function Rt(){}function wt(){}function lt(){}var tt={};H(tt,O,function(){return this});var Gt=Object.getPrototypeOf,Q=Gt&&Gt(Gt(ir([])));Q&&Q!==M&&_.call(Q,O)&&(tt=Q);var Ut=lt.prototype=Rt.prototype=Object.create(tt);function ot(ce){["next","throw","return"].forEach(function(ae){H(ce,ae,function(me){return this._invoke(ae,me)})})}function Ue(ce,ae){function me(gt,xr,Fr,cn){var Ir=be(ce[gt],ce,xr);if("throw"!==Ir.type){var Ot=Ir.arg,Le=Ot.value;return Le&&"object"==typeof Le&&_.call(Le,"__await")?ae.resolve(Le.__await).then(function(we){me("next",we,Fr,cn)},function(we){me("throw",we,Fr,cn)}):ae.resolve(Le).then(function(we){Ot.value=we,Fr(Ot)},function(we){return me("throw",we,Fr,cn)})}cn(Ir.arg)}var Ie;this._invoke=function(gt,xr){function Fr(){return new ae(function(cn,Ir){me(gt,xr,cn,Ir)})}return Ie=Ie?Ie.then(Fr,Fr):Fr()}}function Xe(ce,ae){var me=ce.iterator[ae.method];if(me===l){if(ae.delegate=null,"throw"===ae.method){if(ce.iterator.return&&(ae.method="return",ae.arg=l,Xe(ce,ae),"throw"===ae.method))return _t;ae.method="throw",ae.arg=new TypeError("The iterator does not provide a 'throw' method")}return _t}var Ie=be(me,ce.iterator,ae.arg);if("throw"===Ie.type)return ae.method="throw",ae.arg=Ie.arg,ae.delegate=null,_t;var je=Ie.arg;return je?je.done?(ae[ce.resultName]=je.value,ae.next=ce.nextLoc,"return"!==ae.method&&(ae.method="next",ae.arg=l),ae.delegate=null,_t):je:(ae.method="throw",ae.arg=new TypeError("iterator result is not an object"),ae.delegate=null,_t)}function Pt(ce){var ae={tryLoc:ce[0]};1 in ce&&(ae.catchLoc=ce[1]),2 in ce&&(ae.finallyLoc=ce[2],ae.afterLoc=ce[3]),this.tryEntries.push(ae)}function kt(ce){var ae=ce.completion||{};ae.type="normal",delete ae.arg,ce.completion=ae}function ut(ce){this.tryEntries=[{tryLoc:"root"}],ce.forEach(Pt,this),this.reset(!0)}function ir(ce){if(ce){var ae=ce[O];if(ae)return ae.call(ce);if("function"==typeof ce.next)return ce;if(!isNaN(ce.length)){var me=-1,Ie=function je(){for(;++me<ce.length;)if(_.call(ce,me))return je.value=ce[me],je.done=!1,je;return je.value=l,je.done=!0,je};return Ie.next=Ie}}return{next:le}}function le(){return{value:l,done:!0}}return wt.prototype=lt,H(Ut,"constructor",lt),H(lt,"constructor",wt),wt.displayName=H(lt,N,"GeneratorFunction"),y.isGeneratorFunction=function(ce){var ae="function"==typeof ce&&ce.constructor;return!!ae&&(ae===wt||"GeneratorFunction"===(ae.displayName||ae.name))},y.mark=function(ce){return Object.setPrototypeOf?Object.setPrototypeOf(ce,lt):(ce.__proto__=lt,H(ce,N,"GeneratorFunction")),ce.prototype=Object.create(Ut),ce},y.awrap=function(ce){return{__await:ce}},ot(Ue.prototype),H(Ue.prototype,R,function(){return this}),y.AsyncIterator=Ue,y.async=function(ce,ae,me,Ie,je){void 0===je&&(je=Promise);var gt=new Ue(j(ce,ae,me,Ie),je);return y.isGeneratorFunction(ae)?gt:gt.next().then(function(xr){return xr.done?xr.value:gt.next()})},ot(Ut),H(Ut,N,"Generator"),H(Ut,O,function(){return this}),H(Ut,"toString",function(){return"[object Generator]"}),y.keys=function(ce){var ae=[];for(var me in ce)ae.push(me);return ae.reverse(),function Ie(){for(;ae.length;){var je=ae.pop();if(je in ce)return Ie.value=je,Ie.done=!1,Ie}return Ie.done=!0,Ie}},y.values=ir,ut.prototype={constructor:ut,reset:function(ce){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(kt),!ce)for(var ae in this)"t"===ae.charAt(0)&&_.call(this,ae)&&!isNaN(+ae.slice(1))&&(this[ae]=l)},stop:function(){this.done=!0;var ae=this.tryEntries[0].completion;if("throw"===ae.type)throw ae.arg;return this.rval},dispatchException:function(ce){if(this.done)throw ce;var ae=this;function me(cn,Ir){return gt.type="throw",gt.arg=ce,ae.next=cn,Ir&&(ae.method="next",ae.arg=l),!!Ir}for(var Ie=this.tryEntries.length-1;Ie>=0;--Ie){var je=this.tryEntries[Ie],gt=je.completion;if("root"===je.tryLoc)return me("end");if(je.tryLoc<=this.prev){var xr=_.call(je,"catchLoc"),Fr=_.call(je,"finallyLoc");if(xr&&Fr){if(this.prev<je.catchLoc)return me(je.catchLoc,!0);if(this.prev<je.finallyLoc)return me(je.finallyLoc)}else if(xr){if(this.prev<je.catchLoc)return me(je.catchLoc,!0)}else{if(!Fr)throw new Error("try statement without catch or finally");if(this.prev<je.finallyLoc)return me(je.finallyLoc)}}}},abrupt:function(ce,ae){for(var me=this.tryEntries.length-1;me>=0;--me){var Ie=this.tryEntries[me];if(Ie.tryLoc<=this.prev&&_.call(Ie,"finallyLoc")&&this.prev<Ie.finallyLoc){var je=Ie;break}}je&&("break"===ce||"continue"===ce)&&je.tryLoc<=ae&&ae<=je.finallyLoc&&(je=null);var gt=je?je.completion:{};return gt.type=ce,gt.arg=ae,je?(this.method="next",this.next=je.finallyLoc,_t):this.complete(gt)},complete:function(ce,ae){if("throw"===ce.type)throw ce.arg;return"break"===ce.type||"continue"===ce.type?this.next=ce.arg:"return"===ce.type?(this.rval=this.arg=ce.arg,this.method="return",this.next="end"):"normal"===ce.type&&ae&&(this.next=ae),_t},finish:function(ce){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var me=this.tryEntries[ae];if(me.finallyLoc===ce)return this.complete(me.completion,me.afterLoc),kt(me),_t}},catch:function(ce){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var me=this.tryEntries[ae];if(me.tryLoc===ce){var Ie=me.completion;if("throw"===Ie.type){var je=Ie.arg;kt(me)}return je}}throw new Error("illegal catch attempt")},delegateYield:function(ce,ae,me){return this.delegate={iterator:ir(ce),resultName:ae,nextLoc:me},"next"===this.method&&(this.arg=l),_t}},y}(ne.exports);try{regeneratorRuntime=L}catch(y){"object"==typeof globalThis?globalThis.regeneratorRuntime=L:Function("r","regeneratorRuntime = r")(L)}},20878:function(ne){ne.exports=function(){"use strict";function L(ot,Ue,ct,Xe,Pt,kt){if(!(Pt-Xe<=ct)){var ut=Xe+Pt>>1;y(ot,Ue,ut,Xe,Pt,kt%2),L(ot,Ue,ct,Xe,ut-1,kt+1),L(ot,Ue,ct,ut+1,Pt,kt+1)}}function y(ot,Ue,ct,Xe,Pt,kt){for(;Pt>Xe;){if(Pt-Xe>600){var ut=Pt-Xe+1,ir=ct-Xe+1,le=Math.log(ut),ce=.5*Math.exp(2*le/3),ae=.5*Math.sqrt(le*ce*(ut-ce)/ut)*(ir-ut/2<0?-1:1);y(ot,Ue,ct,Math.max(Xe,Math.floor(ct-ir*ce/ut+ae)),Math.min(Pt,Math.floor(ct+(ut-ir)*ce/ut+ae)),kt)}var je=Ue[2*ct+kt],gt=Xe,xr=Pt;for(M(ot,Ue,Xe,ct),Ue[2*Pt+kt]>je&&M(ot,Ue,Xe,Pt);gt<xr;){for(M(ot,Ue,gt,xr),gt++,xr--;Ue[2*gt+kt]<je;)gt++;for(;Ue[2*xr+kt]>je;)xr--}Ue[2*Xe+kt]===je?M(ot,Ue,Xe,xr):M(ot,Ue,++xr,Pt),xr<=ct&&(Xe=xr+1),ct<=xr&&(Pt=xr-1)}}function M(ot,Ue,ct,Xe){_(ot,ct,Xe),_(Ue,2*ct,2*Xe),_(Ue,2*ct+1,2*Xe+1)}function _(ot,Ue,ct){var Xe=ot[Ue];ot[Ue]=ot[ct],ot[ct]=Xe}function O(ot,Ue,ct,Xe){var Pt=ot-ct,kt=Ue-Xe;return Pt*Pt+kt*kt}var R=function(ot){return ot[0]},N=function(ot){return ot[1]},H=function(Ue,ct,Xe,Pt,kt){void 0===ct&&(ct=R),void 0===Xe&&(Xe=N),void 0===Pt&&(Pt=64),void 0===kt&&(kt=Float64Array),this.nodeSize=Pt,this.points=Ue;for(var ut=Ue.length<65536?Uint16Array:Uint32Array,ir=this.ids=new ut(Ue.length),le=this.coords=new kt(2*Ue.length),ce=0;ce<Ue.length;ce++)ir[ce]=ce,le[2*ce]=ct(Ue[ce]),le[2*ce+1]=Xe(Ue[ce]);L(ir,le,Pt,0,ir.length-1,0)};H.prototype.range=function(Ue,ct,Xe,Pt){return function(ot,Ue,ct,Xe,Pt,kt,ut){for(var ce,ae,ir=[0,ot.length-1,0],le=[];ir.length;){var me=ir.pop(),Ie=ir.pop(),je=ir.pop();if(Ie-je<=ut)for(var gt=je;gt<=Ie;gt++)ae=Ue[2*gt+1],(ce=Ue[2*gt])>=ct&&ce<=Pt&&ae>=Xe&&ae<=kt&&le.push(ot[gt]);else{var xr=Math.floor((je+Ie)/2);ae=Ue[2*xr+1],(ce=Ue[2*xr])>=ct&&ce<=Pt&&ae>=Xe&&ae<=kt&&le.push(ot[xr]);var Fr=(me+1)%2;(0===me?ct<=ce:Xe<=ae)&&(ir.push(je),ir.push(xr-1),ir.push(Fr)),(0===me?Pt>=ce:kt>=ae)&&(ir.push(xr+1),ir.push(Ie),ir.push(Fr))}}return le}(this.ids,this.coords,Ue,ct,Xe,Pt,this.nodeSize)},H.prototype.within=function(Ue,ct,Xe){return function(ot,Ue,ct,Xe,Pt,kt){for(var ut=[0,ot.length-1,0],ir=[],le=Pt*Pt;ut.length;){var ce=ut.pop(),ae=ut.pop(),me=ut.pop();if(ae-me<=kt)for(var Ie=me;Ie<=ae;Ie++)O(Ue[2*Ie],Ue[2*Ie+1],ct,Xe)<=le&&ir.push(ot[Ie]);else{var je=Math.floor((me+ae)/2),gt=Ue[2*je],xr=Ue[2*je+1];O(gt,xr,ct,Xe)<=le&&ir.push(ot[je]);var Fr=(ce+1)%2;(0===ce?ct-Pt<=gt:Xe-Pt<=xr)&&(ut.push(me),ut.push(je-1),ut.push(Fr)),(0===ce?ct+Pt>=gt:Xe+Pt>=xr)&&(ut.push(je+1),ut.push(ae),ut.push(Fr))}}return ir}(this.ids,this.coords,Ue,ct,Xe,this.nodeSize)};var ot,j={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ot){return ot}},be=Math.fround||(ot=new Float32Array(1),function(Ue){return ot[0]=+Ue,ot[0]}),Ne=function(Ue){this.options=Gt(Object.create(j),Ue),this.trees=new Array(this.options.maxZoom+1)};function V(ot,Ue,ct,Xe,Pt){return{x:be(ot),y:be(Ue),zoom:1/0,id:ct,parentId:-1,numPoints:Xe,properties:Pt}}function W(ot,Ue){var ct=ot.geometry.coordinates,Pt=ct[1];return{x:be(Rt(ct[0])),y:be(wt(Pt)),zoom:1/0,index:Ue,parentId:-1}}function Ye(ot){return{type:"Feature",id:ot.id,properties:_t(ot),geometry:{type:"Point",coordinates:[lt(ot.x),tt(ot.y)]}}}function _t(ot){var Ue=ot.numPoints,ct=Ue>=1e4?Math.round(Ue/1e3)+"k":Ue>=1e3?Math.round(Ue/100)/10+"k":Ue;return Gt(Gt({},ot.properties),{cluster:!0,cluster_id:ot.id,point_count:Ue,point_count_abbreviated:ct})}function Rt(ot){return ot/360+.5}function wt(ot){var Ue=Math.sin(ot*Math.PI/180),ct=.5-.25*Math.log((1+Ue)/(1-Ue))/Math.PI;return ct<0?0:ct>1?1:ct}function lt(ot){return 360*(ot-.5)}function tt(ot){var Ue=(180-360*ot)*Math.PI/180;return 360*Math.atan(Math.exp(Ue))/Math.PI-90}function Gt(ot,Ue){for(var ct in Ue)ot[ct]=Ue[ct];return ot}function Q(ot){return ot.x}function Ut(ot){return ot.y}return Ne.prototype.load=function(Ue){var ct=this.options,Xe=ct.log,Pt=ct.minZoom,kt=ct.maxZoom,ut=ct.nodeSize;Xe&&console.time("total time");var ir="prepare "+Ue.length+" points";Xe&&console.time(ir),this.points=Ue;for(var le=[],ce=0;ce<Ue.length;ce++)!Ue[ce].geometry||le.push(W(Ue[ce],ce));this.trees[kt+1]=new H(le,Q,Ut,ut,Float32Array),Xe&&console.timeEnd(ir);for(var ae=kt;ae>=Pt;ae--){var me=+Date.now();le=this._cluster(le,ae),this.trees[ae]=new H(le,Q,Ut,ut,Float32Array),Xe&&console.log("z%d: %d clusters in %dms",ae,le.length,+Date.now()-me)}return Xe&&console.timeEnd("total time"),this},Ne.prototype.getClusters=function(Ue,ct){var Xe=((Ue[0]+180)%360+360)%360-180,Pt=Math.max(-90,Math.min(90,Ue[1])),kt=180===Ue[2]?180:((Ue[2]+180)%360+360)%360-180,ut=Math.max(-90,Math.min(90,Ue[3]));if(Ue[2]-Ue[0]>=360)Xe=-180,kt=180;else if(Xe>kt){var ir=this.getClusters([Xe,Pt,180,ut],ct),le=this.getClusters([-180,Pt,kt,ut],ct);return ir.concat(le)}for(var ce=this.trees[this._limitZoom(ct)],me=[],Ie=0,je=ce.range(Rt(Xe),wt(ut),Rt(kt),wt(Pt));Ie<je.length;Ie+=1){var xr=ce.points[je[Ie]];me.push(xr.numPoints?Ye(xr):this.points[xr.index])}return me},Ne.prototype.getChildren=function(Ue){var ct=this._getOriginId(Ue),Xe=this._getOriginZoom(Ue),Pt="No cluster with the specified id.",kt=this.trees[Xe];if(!kt)throw new Error(Pt);var ut=kt.points[ct];if(!ut)throw new Error(Pt);for(var ir=this.options.radius/(this.options.extent*Math.pow(2,Xe-1)),ce=[],ae=0,me=kt.within(ut.x,ut.y,ir);ae<me.length;ae+=1){var je=kt.points[me[ae]];je.parentId===Ue&&ce.push(je.numPoints?Ye(je):this.points[je.index])}if(0===ce.length)throw new Error(Pt);return ce},Ne.prototype.getLeaves=function(Ue,ct,Xe){var Pt=[];return this._appendLeaves(Pt,Ue,ct=ct||10,Xe=Xe||0,0),Pt},Ne.prototype.getTile=function(Ue,ct,Xe){var Pt=this.trees[this._limitZoom(Ue)],kt=Math.pow(2,Ue),ut=this.options,ce=ut.radius/ut.extent,ae=(Xe-ce)/kt,me=(Xe+1+ce)/kt,Ie={features:[]};return this._addTileFeatures(Pt.range((ct-ce)/kt,ae,(ct+1+ce)/kt,me),Pt.points,ct,Xe,kt,Ie),0===ct&&this._addTileFeatures(Pt.range(1-ce/kt,ae,1,me),Pt.points,kt,Xe,kt,Ie),ct===kt-1&&this._addTileFeatures(Pt.range(0,ae,ce/kt,me),Pt.points,-1,Xe,kt,Ie),Ie.features.length?Ie:null},Ne.prototype.getClusterExpansionZoom=function(Ue){for(var ct=this._getOriginZoom(Ue)-1;ct<=this.options.maxZoom;){var Xe=this.getChildren(Ue);if(ct++,1!==Xe.length)break;Ue=Xe[0].properties.cluster_id}return ct},Ne.prototype._appendLeaves=function(Ue,ct,Xe,Pt,kt){for(var ir=0,le=this.getChildren(ct);ir<le.length;ir+=1){var ce=le[ir],ae=ce.properties;if(ae&&ae.cluster?kt+ae.point_count<=Pt?kt+=ae.point_count:kt=this._appendLeaves(Ue,ae.cluster_id,Xe,Pt,kt):kt<Pt?kt++:Ue.push(ce),Ue.length===Xe)break}return kt},Ne.prototype._addTileFeatures=function(Ue,ct,Xe,Pt,kt,ut){for(var ir=0,le=Ue;ir<le.length;ir+=1){var ae=ct[le[ir]],me=ae.numPoints,Ie=void 0,je=void 0,gt=void 0;if(me)Ie=_t(ae),je=ae.x,gt=ae.y;else{var xr=this.points[ae.index];Ie=xr.properties,je=Rt(xr.geometry.coordinates[0]),gt=wt(xr.geometry.coordinates[1])}var Fr={type:1,geometry:[[Math.round(this.options.extent*(je*kt-Xe)),Math.round(this.options.extent*(gt*kt-Pt))]],tags:Ie},cn=void 0;me?cn=ae.id:this.options.generateId?cn=ae.index:this.points[ae.index].id&&(cn=this.points[ae.index].id),void 0!==cn&&(Fr.id=cn),ut.features.push(Fr)}},Ne.prototype._limitZoom=function(Ue){return Math.max(this.options.minZoom,Math.min(+Ue,this.options.maxZoom+1))},Ne.prototype._cluster=function(Ue,ct){for(var Xe=[],Pt=this.options,ir=Pt.reduce,le=Pt.minPoints,ce=Pt.radius/(Pt.extent*Math.pow(2,ct)),ae=0;ae<Ue.length;ae++){var me=Ue[ae];if(!(me.zoom<=ct)){me.zoom=ct;for(var Ie=this.trees[ct+1],je=Ie.within(me.x,me.y,ce),gt=me.numPoints||1,xr=gt,Fr=0,cn=je;Fr<cn.length;Fr+=1){var Ot=Ie.points[cn[Fr]];Ot.zoom>ct&&(xr+=Ot.numPoints||1)}if(xr>gt&&xr>=le){for(var Le=me.x*gt,we=me.y*gt,at=ir&&gt>1?this._map(me,!0):null,Re=(ae<<5)+(ct+1)+this.points.length,qt=0,Pr=je;qt<Pr.length;qt+=1){var hr=Ie.points[Pr[qt]];if(!(hr.zoom<=ct)){hr.zoom=ct;var Nr=hr.numPoints||1;Le+=hr.x*Nr,we+=hr.y*Nr,hr.parentId=Re,ir&&(at||(at=this._map(me,!0)),ir(at,this._map(hr)))}}me.parentId=Re,Xe.push(V(Le/xr,we/xr,Re,xr,at))}else if(Xe.push(me),xr>1)for(var $r=0,C=je;$r<C.length;$r+=1){var Ge=Ie.points[C[$r]];Ge.zoom<=ct||(Ge.zoom=ct,Xe.push(Ge))}}}return Xe},Ne.prototype._getOriginId=function(Ue){return Ue-this.points.length>>5},Ne.prototype._getOriginZoom=function(Ue){return(Ue-this.points.length)%32},Ne.prototype._map=function(Ue,ct){if(Ue.numPoints)return ct?Gt({},Ue.properties):Ue.properties;var Xe=this.points[Ue.index].properties,Pt=this.options.map(Xe);return ct&&Pt===Xe?Gt({},Pt):Pt},Ne}()},96847:ne=>{ne.exports.RADIUS=6378137,ne.exports.FLATTENING=1/298.257223563,ne.exports.POLAR_RADIUS=6356752.3142},31073:(ne,L,y)=>{"use strict";y.r(L),y.d(L,{DashboardModule:()=>Gg});var M={};y.r(M),y.d(M,{add:()=>si,angle:()=>oi,bezier:()=>rr,ceil:()=>Ei,clone:()=>dr,copy:()=>mi,create:()=>sr,cross:()=>Br,dist:()=>Xi,distance:()=>Oe,div:()=>Ni,divide:()=>Pi,dot:()=>ar,equals:()=>_a,exactEquals:()=>Ti,floor:()=>re,forEach:()=>Wi,fromValues:()=>On,hermite:()=>Pn,inverse:()=>wr,len:()=>Ho,length:()=>mn,lerp:()=>Rn,max:()=>_e,min:()=>ve,mul:()=>Gi,multiply:()=>Yi,negate:()=>Tt,normalize:()=>Kt,random:()=>Sn,rotateX:()=>_n,rotateY:()=>Oi,rotateZ:()=>ta,round:()=>G,scale:()=>oe,scaleAndAdd:()=>xe,set:()=>hi,sqrDist:()=>to,sqrLen:()=>Za,squaredDistance:()=>pe,squaredLength:()=>Ae,str:()=>ji,sub:()=>Ia,subtract:()=>ai,transformMat3:()=>fn,transformMat4:()=>an,transformQuat:()=>Di,zero:()=>Ji});var _=y(38583),l=y(39895),m=y(37716),O=y(16704),R=y(75134),N=y(47289),H=y(66518),j=y(41885),be=y(59553),Ne=y(99187),V=y(93512),W=y(42837),Ye=y(30832),_t=y(42624);function Rt(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function wt(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?Rt(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Rt(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Gt=0,Q=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=c.call(this),(0,V.Z)((0,H.Z)(h),"controlOption",void 0),(0,V.Z)((0,H.Z)(h),"container",void 0),(0,V.Z)((0,H.Z)(h),"sceneContainer",void 0),(0,V.Z)((0,H.Z)(h),"mapsService",void 0),(0,V.Z)((0,H.Z)(h),"renderService",void 0),(0,V.Z)((0,H.Z)(h),"layerService",void 0),(0,V.Z)((0,H.Z)(h),"controlService",void 0),(0,V.Z)((0,H.Z)(h),"isShow",void 0),h.controlOption=wt(wt({},h.getDefault()),u||{}),h}return(0,N.Z)(i,[{key:"getDefault",value:function(){return{position:W.PositionType.TOPRIGHT,name:"".concat(Gt++)}}},{key:"setPosition",value:function(){var h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W.PositionType.BOTTOMRIGHT,v=this.controlService;return v&&v.removeControl(this),this.controlOption.position=h,v&&v.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(h){this.mapsService=h.get(W.vK.IMapService),this.renderService=h.get(W.vK.IRendererService),this.layerService=h.get(W.vK.ILayerService),this.controlService=h.get(W.vK.IControlService),this.sceneContainer=h,this.isShow=!0,this.container=this.onAdd();var v=this.container,w=this.controlOption.position,I=this.controlService.controlCorners[w];return Ye.SO.addClass(v,"l7-control"),-1!==w.indexOf("bottom")?I.insertBefore(v,I.firstChild):I.appendChild(v),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){Ye.SO.addClass(this.container,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){Ye.SO.removeClass(this.container,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;Ye.SO.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(h){if(this.mapsService&&h&&h.screenX>0&&h.screenY>0){var v=this.mapsService.getContainer();null!==v&&v.focus()}}}]),i}(_t.EventEmitter);var Ue=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=c.call(this,u),(0,V.Z)((0,H.Z)(h),"layerControlInputs",void 0),(0,V.Z)((0,H.Z)(h),"layers",void 0),(0,V.Z)((0,H.Z)(h),"lastZIndex",void 0),(0,V.Z)((0,H.Z)(h),"handlingClick",void 0),(0,V.Z)((0,H.Z)(h),"layersLink",void 0),(0,V.Z)((0,H.Z)(h),"baseLayersList",void 0),(0,V.Z)((0,H.Z)(h),"separator",void 0),(0,V.Z)((0,H.Z)(h),"overlaysList",void 0),(0,V.Z)((0,H.Z)(h),"form",void 0),h.layerControlInputs=[],h.layers=[],h.lastZIndex=0,h.handlingClick=!1,h.initLayers(),(0,Ye.Ev)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],(0,H.Z)(h)),h}return(0,N.Z)(i,[{key:"getDefault",value:function(){return{collapsed:!0,position:W.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var h=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(v){v.layer.on("remove",h.onLayerChange),v.layer.on("add",h.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(h,v){return this.addLayer(h,v,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var v=this.renderService.getViewportSize().height;Ye.SO.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var w=v-(this.container.offsetTop+50);return w<this.form.clientHeight?(Ye.SO.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=w+"px"):Ye.SO.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return Ye.SO.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var h=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(v){v.layer.off("remove",h.onLayerChange),v.layer.off("add",h.onLayerChange)}))}},{key:"initLayout",value:function(){var h="l7-control-layers",v=this.container=Ye.SO.create("div",h),w=this.controlOption.collapsed;v.setAttribute("aria-haspopup","true");var I=this.form=Ye.SO.create("form",h+"-list");w&&(this.mapsService.on("click",this.collapse),v.addEventListener("mouseenter",this.expand),v.addEventListener("mouseleave",this.collapse)),this.layersLink=Ye.SO.create("a",h+"-toggle",v),this.layersLink.title="Layers",w||this.expand(),this.baseLayersList=Ye.SO.create("div",h+"-base",I),this.separator=Ye.SO.create("div",h+"-separator",I),this.overlaysList=Ye.SO.create("div",h+"-overlays",I),v.appendChild(I)}},{key:"initLayers",value:function(){var h=this,v=this.controlOption,w=v.baseLayers,I=void 0===w?{}:w,k=v.overlayers,X=void 0===k?{}:k;Object.keys(I).forEach(function(fe,se){h.addLayer(I[fe],fe,!1)}),Object.keys(X).forEach(function(fe,se){h.addLayer(X[fe],fe,!0)})}},{key:"update",value:function(){if(!this.container)return this;Ye.SO.empty(this.baseLayersList),Ye.SO.empty(this.overlaysList),this.layerControlInputs=[];var h,v,w,I,k=0;for(w=0;w<this.layers.length;w++)this.addItem(I=this.layers[w]),v=v||I.overlay,h=h||!I.overlay,k+=I.overlay?0:1;return this.controlOption.hideSingleBase&&(this.baseLayersList.style.display=(h=h&&k>1)?"":"none"),this.separator.style.display=v&&h?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var v,w,h=this.layerControlInputs,I=this.mapsService.getZoom(),k=h.length-1;k>=0;k--)if((w=this.layerService.getLayer((v=h[k]).layerId))&&w.inited){var X=w.getMinZoom(),fe=w.getMaxZoom();v.disabled=I<X||I>fe}}},{key:"addLayer",value:function(h,v,w){this.mapsService&&(h.on("add",this.onLayerChange),h.on("remove",this.onLayerChange)),this.layers.push({layer:h,name:v,overlay:w});var I=this.controlOption,X=I.sortFunction,fe=I.autoZIndex;I.sortLayers&&this.layers.sort(function(se,Be){return X(se.layer,Be.layer,se.name,Be.name)}),fe&&h.setZIndex&&(this.lastZIndex++,h.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(h){this.handlingClick||this.update();var v=this.layerService.getLayer(h.target.layerId),w=null!=v&&v.overlay?"add"===h.type?"overlayadd":"overlayremove":"add"===h.type?"baselayerchange":null;w&&this.emit(w,v)}},{key:"createRadioElement",value:function(h,v){var w='<input type="radio" class="l7-control-layers-selector" name="'+h+'"'+(v?' checked="checked"':"")+"/>",I=document.createElement("div");return I.innerHTML=w,I.firstChild}},{key:"addItem",value:function(h){var k,v=document.createElement("label"),w=this.layerService.getLayer(h.layer.id),I=w&&w.inited&&h.layer.isVisible();h.overlay?((k=document.createElement("input")).type="checkbox",k.className="l7-control-layers-selector",k.defaultChecked=I):k=this.createRadioElement("l7-base-layers",I),this.layerControlInputs.push(k),k.layerId=h.layer.id,k.addEventListener("click",this.onInputClick);var X=document.createElement("span");X.innerHTML=" "+h.name;var fe=document.createElement("div");return v.appendChild(fe),fe.appendChild(k),fe.appendChild(X),(h.overlay?this.overlaysList:this.baseLayersList).appendChild(v),this.checkDisabledLayers(),v}},{key:"onInputClick",value:function(){var v,w,h=this.layerControlInputs,I=[],k=[];this.handlingClick=!0;for(var X=h.length-1;X>=0;X--)w=this.layerService.getLayer((v=h[X]).layerId),v.checked?I.push(w):v.checked||k.push(w);k.forEach(function(fe){fe.hide()}),I.forEach(function(fe){fe.show()}),this.handlingClick=!1}}]),i}(Q);var Pt=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),c.apply(this,arguments)}return(0,N.Z)(i,[{key:"getDefault",value:function(){return{position:W.PositionType.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var v=Ye.SO.create("div","l7-control-logo"),w=Ye.SO.create("a","l7-ctrl-logo");return w.target="_blank",w.rel="noopener nofollow",w.href="https://antv.alipay.com/l7",w.setAttribute("aria-label","AntV logo"),w.setAttribute("rel","noopener nofollow"),v.appendChild(w),v}},{key:"onRemove",value:function(){return null}}]),i}(Q);var ir=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=c.call(this,u),(0,V.Z)((0,H.Z)(h),"mScale",void 0),(0,V.Z)((0,H.Z)(h),"iScale",void 0),(0,Ye.Ev)(["update"],(0,H.Z)(h)),h}return(0,N.Z)(i,[{key:"getDefault",value:function(){return{position:W.PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var h="l7-control-scale",v=Ye.SO.create("div",h);this.addScales(h+"-line",v);var w=this.controlOption.updateWhenIdle;return this.mapsService.on(w?"moveend":"mapmove",this.update),this.mapsService.on(w?"zoomend":"zoomchange",this.update),this.update(),v}},{key:"onRemove",value:function(){var h=this.controlOption.updateWhenIdle;this.mapsService.off(h?"zoomend":"zoomchange",this.update),this.mapsService.off(h?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var h=this.mapsService,v=this.controlOption.maxWidth,w=h.getSize()[1]/2,I=h.containerToLngLat([0,w]),k=h.containerToLngLat([v,w]),X=(0,Ye.yM)([I.lng,I.lat],[k.lng,k.lat]);this.updateScales(X)}},{key:"updateScales",value:function(h){var v=this.controlOption,I=v.imperial;v.metric&&h&&this.updateMetric(h),I&&h&&this.updateImperial(h)}},{key:"updateMetric",value:function(h){var v=this.getRoundNum(h);this.updateScale(this.mScale,v<1e3?v+" m":v/1e3+" km",v/h)}},{key:"updateImperial",value:function(h){var w,I,k,v=3.2808399*h;v>5280?(I=this.getRoundNum(w=v/5280),this.updateScale(this.iScale,I+" mi",I/w)):(k=this.getRoundNum(v),this.updateScale(this.iScale,k+" ft",k/v))}},{key:"updateScale",value:function(h,v,w){h.style.width=Math.round(this.controlOption.maxWidth*w)+"px",h.innerHTML=v}},{key:"getRoundNum",value:function(h){var v=Math.pow(10,(Math.floor(h)+"").length-1),w=h/v;return v*(w>=10?10:w>=5?5:w>=3?3:w>=2?2:1)}},{key:"addScales",value:function(h,v){var w=this.controlOption,k=w.imperial;w.metric&&(this.mScale=Ye.SO.create("div",h,v)),k&&(this.iScale=Ye.SO.create("div",h,v))}}]),i}(Q);var ae=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=c.call(this,u),(0,V.Z)((0,H.Z)(h),"disabled",void 0),(0,V.Z)((0,H.Z)(h),"zoomInButton",void 0),(0,V.Z)((0,H.Z)(h),"zoomOutButton",void 0),(0,Ye.Ev)(["updateDisabled","zoomIn","zoomOut"],(0,H.Z)(h)),h}return(0,N.Z)(i,[{key:"getDefault",value:function(){return{position:W.PositionType.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var h="l7-control-zoom",v=Ye.SO.create("div",h+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,h+"-in",v,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,h+"-out",v,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),v}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(h,v,w,I,k){var X=Ye.SO.create("a",w,I);return X.innerHTML=h,X.title=v,X.href="javascript:void(0)",X.addEventListener("click",k),X}},{key:"updateDisabled",value:function(){var h=this.mapsService,v="l7-disabled";Ye.SO.removeClass(this.zoomInButton,v),Ye.SO.removeClass(this.zoomOutButton,v),(this.disabled||h.getZoom()<=h.getMinZoom())&&Ye.SO.addClass(this.zoomOutButton,v),(this.disabled||h.getZoom()>=h.getMaxZoom())&&Ye.SO.addClass(this.zoomInButton,v)}}]),i}(Q);function me(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Ie(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?me(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):me(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var xr=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=c.call(this),(0,V.Z)((0,H.Z)(h),"markerOption",void 0),(0,V.Z)((0,H.Z)(h),"defaultMarker",void 0),(0,V.Z)((0,H.Z)(h),"popup",void 0),(0,V.Z)((0,H.Z)(h),"mapsService",void 0),(0,V.Z)((0,H.Z)(h),"sceneSerive",void 0),(0,V.Z)((0,H.Z)(h),"lngLat",void 0),(0,V.Z)((0,H.Z)(h),"scene",void 0),(0,V.Z)((0,H.Z)(h),"added",!1),(0,V.Z)((0,H.Z)(h),"eventHandle",function(v){h.emit(v.type,{target:v,data:h.markerOption.extData,lngLat:h.lngLat})}),h.markerOption=Ie(Ie({},h.getDefault()),u),(0,Ye.Ev)(["update","onMove","onUp","addDragHandler","onMapClick"],(0,H.Z)(h)),h.init(),h}return(0,N.Z)(i,[{key:"getDefault",value:function(){return{element:void 0,anchor:Ye.bV.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(h){this.scene=h,this.mapsService=h.get(W.vK.IMapService),this.sceneSerive=h.get(W.vK.ISceneService);var w=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(w),this.registerMarkerEvent(w),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var h=this.markerOption.element;return h&&Ye.SO.remove(h),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(h){return this.lngLat=h,Array.isArray(h)&&(this.lngLat={lng:h[0],lat:h[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(h){var v=this;if(!this.added)return this.once("added",function(){v.setElement(h)}),this;var w=this.markerOption.element;return w&&Ye.SO.remove(w),this.markerOption.element=h,this.init(),this.mapsService.getMarkerContainer().appendChild(h),this.registerMarkerEvent(h),this.update(),this}},{key:"openPopup",value:function(){var h=this;if(!this.added)return this.once("added",function(){h.openPopup()}),this;var v=this.popup;return v?(v.isOpen()||v.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var h=this;this.added||this.once("added",function(){h.closePopup()});var v=this.popup;return v&&v.remove(),this}},{key:"setPopup",value:function(h){return this.popup=h,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var h=this.popup;return h?(h.isOpen()?h.remove():h.addTo(this.scene),this):this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(h){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(h){this.markerOption.extData=h}},{key:"update",value:function(){if(this.mapsService){var h=this.markerOption,v=h.element,w=h.anchor;this.updatePosition(),Ye.SO.setTransform(v,"".concat(Ye.rQ[w]))}}},{key:"onMapClick",value:function(h){this.popup&&this.markerOption.element&&this.togglePopup()}},{key:"updatePosition",value:function(){if(this.mapsService){var h=this.markerOption,v=h.element,w=h.offsets,I=this.lngLat,k=I.lng,X=I.lat,fe=this.mapsService.getBounds(),se=this.mapsService.lngLatToContainer([k,X]);if(v){v.style.display="block";var Be=this.mapsService.getContainer(),rt=0,Bt=0;if(Be&&(rt=Be.scrollWidth,Bt=Be.scrollHeight),Math.abs(fe[0][0])>180||Math.abs(fe[1][0])>180){if(se.x>rt){var Xt=this.mapsService.lngLatToContainer([k-360,X]);se.x=Xt.x}if(se.x<0){var Ar=this.mapsService.lngLatToContainer([k+360,X]);se.x=Ar.x}}(se.x>rt||se.x<0||se.y>Bt||se.y<0)&&(v.style.display="none"),v.style.left=se.x+w[0]+"px",v.style.top=se.y-w[1]+"px"}}}},{key:"init",value:function(){var h=this,v=this.markerOption.element,w=this.markerOption,I=w.color,k=w.anchor;if(!v){this.defaultMarker=!0,v=Ye.SO.create("div"),this.markerOption.element=v;var X=document.createElementNS("http://www.w3.org/2000/svg","svg");X.setAttributeNS(null,"display","block"),X.setAttributeNS(null,"height","48px"),X.setAttributeNS(null,"width","48px"),X.setAttributeNS(null,"viewBox","0 0 1024 1024");var fe=document.createElementNS("http://www.w3.org/2000/svg","path");fe.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),fe.setAttributeNS(null,"fill",I),X.appendChild(fe),v.appendChild(X)}Ye.SO.addClass(v,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(se){var Be,rt,Bt=(null===(Be=h.markerOption)||void 0===Be?void 0:Be.style)&&(null===(rt=h.markerOption)||void 0===rt?void 0:rt.style[se]);v&&(v.style[se]=Bt)}),v.addEventListener("click",function(se){h.onMapClick(se)}),v.addEventListener("click",this.eventHandle),(0,Ye.zi)(v,k,"marker")}},{key:"registerMarkerEvent",value:function(h){h.addEventListener("mousemove",this.eventHandle),h.addEventListener("click",this.eventHandle),h.addEventListener("mousedown",this.eventHandle),h.addEventListener("mouseup",this.eventHandle),h.addEventListener("dblclick",this.eventHandle),h.addEventListener("contextmenu",this.eventHandle),h.addEventListener("mouseover",this.eventHandle),h.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var h=this.getElement();h.removeEventListener("mousemove",this.eventHandle),h.removeEventListener("click",this.eventHandle),h.removeEventListener("mousedown",this.eventHandle),h.removeEventListener("mouseup",this.eventHandle),h.removeEventListener("dblclick",this.eventHandle),h.removeEventListener("contextmenu",this.eventHandle),h.removeEventListener("mouseover",this.eventHandle),h.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(h){throw new Error("Method not implemented.")}},{key:"onUp",value:function(h){throw new Error("Method not implemented.")}}]),i}(_t.EventEmitter),Fr=y(3912),cn=y.n(Fr),Ir=y(20878),Ot=y.n(Ir);function Le(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function we(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?Le(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Le(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Pr(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function er(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?Pr(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Pr(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}!function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h,v;return(0,R.Z)(this,i),v=c.call(this),(0,V.Z)((0,H.Z)(v),"markers",[]),(0,V.Z)((0,H.Z)(v),"markerLayerOption",void 0),(0,V.Z)((0,H.Z)(v),"clusterIndex",void 0),(0,V.Z)((0,H.Z)(v),"points",[]),(0,V.Z)((0,H.Z)(v),"clusterMarkers",[]),(0,V.Z)((0,H.Z)(v),"mapsService",void 0),(0,V.Z)((0,H.Z)(v),"scene",void 0),(0,V.Z)((0,H.Z)(v),"zoom",void 0),(0,V.Z)((0,H.Z)(v),"bbox",void 0),v.markerLayerOption=cn()(v.getDefault(),u),(0,Ye.Ev)(["update"],(0,H.Z)(v)),v.zoom=(null===(h=v.markerLayerOption.clusterOption)||void 0===h?void 0:h.zoom)||-99,v}(0,N.Z)(i,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(h){return this.scene=h,this.mapsService=h.get(W.vK.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(h){this.markerLayerOption.cluster&&this.addPoint(h,this.markers.length),this.markers.push(h)}},{key:"removeMarker",value:function(h){this.markers.indexOf(h);var v=this.markers.indexOf(h);v>-1&&this.markers.splice(v,1)}},{key:"hide",value:function(){this.markers.map(function(h){h.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(h){h.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var h=this;this.getMarkers().forEach(function(v){v.addTo(h.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(h){h.remove()}),this.clusterMarkers.forEach(function(h){h.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(h,v){var w=h.getLnglat(),X={geometry:{type:"Point",coordinates:[w.lng,w.lat]},properties:we(we({},h.getExtData()),{},{marker_id:v})};this.points.push(X)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var h=this.markerLayerOption.clusterOption,v=h.radius,w=h.minZoom,I=void 0===w?0:w,k=h.maxZoom;this.clusterIndex=new(Ot())({radius:v,minZoom:I,maxZoom:k}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(h,v){var w=this,I=h[0].concat(h[1]),k=this.clusterIndex.getClusters(I,v);this.clusterMarkers.forEach(function(X){X.remove()}),this.clusterMarkers=[],k.forEach(function(X){var fe,se=w.markerLayerOption.clusterOption,Be=se.field,rt=se.method;if(X.properties&&null!==(fe=X.properties)&&void 0!==fe&&fe.cluster_id){var Bt,Xt=w.getLeaves(null===(Bt=X.properties)||void 0===Bt?void 0:Bt.cluster_id);if(X.properties.clusterData=Xt,Be&&rt){var Ar=null==Xt?void 0:Xt.map(function(Wn){return(0,V.Z)({},Be,Wn.properties[Be])}),Vr=Ye.a5.getColumn(Ar,Be),sn=Ye.a5.getSatByColumn(rt,Vr);X.properties["point_"+rt]=sn.toFixed(2)}}var Mn=w.clusterMarker(X);w.clusterMarkers.push(Mn),Mn.addTo(w.scene)})}},{key:"getLeaves",value:function(h){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return h?this.clusterIndex.getLeaves(h,v,w):null}},{key:"clusterMarker",value:function(h){var I=this.markerLayerOption.clusterOption.element,k=void 0===I?this.generateElement.bind(this):I;return new xr({element:k(h)}).setLnglat({lng:h.geometry.coordinates[0],lat:h.geometry.coordinates[1]})}},{key:"normalMarker",value:function(h){return this.markers[h.properties.marker_id]}},{key:"update",value:function(){var h=this.mapsService.getZoom(),v=this.mapsService.getBounds();(!this.bbox||Math.abs(h-this.zoom)>=1||!(0,Ye.oO)(this.bbox,v))&&(this.bbox=(0,Ye.yA)(v,.5),this.zoom=Math.floor(h),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(h){var v=Ye.SO.create("div","l7-marker-cluster"),w=Ye.SO.create("div","",v),I=Ye.SO.create("span","",w),k=this.markerLayerOption.clusterOption,X=k.field,fe=k.method;return h.properties.point_count=h.properties.point_count||1,I.textContent=X&&fe?h.properties["point_"+fe]||h.properties[X]:h.properties.point_count,v}}])}(_t.EventEmitter),function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=c.call(this),(0,V.Z)((0,H.Z)(h),"popupOption",void 0),(0,V.Z)((0,H.Z)(h),"mapsService",void 0),(0,V.Z)((0,H.Z)(h),"sceneSerive",void 0),(0,V.Z)((0,H.Z)(h),"lngLat",void 0),(0,V.Z)((0,H.Z)(h),"content",void 0),(0,V.Z)((0,H.Z)(h),"closeButton",void 0),(0,V.Z)((0,H.Z)(h),"timeoutInstance",void 0),(0,V.Z)((0,H.Z)(h),"container",void 0),(0,V.Z)((0,H.Z)(h),"tip",void 0),(0,V.Z)((0,H.Z)(h),"scene",void 0),h.popupOption=er(er({},h.getdefault()),u),(0,Ye.Ev)(["update","onClickClose","remove"],(0,H.Z)(h)),h}(0,N.Z)(i,[{key:"addTo",value:function(h){var v=this;return this.mapsService=h.get(W.vK.IMapService),this.sceneSerive=h.get(W.vK.ISceneService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=h,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){v.mapsService.on("click",v.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(h){var I,v=window.document.createDocumentFragment(),w=window.document.createElement("body");for(w.innerHTML=h;I=w.firstChild;)v.appendChild(I);return this.setDOMContent(v)}},{key:"setLnglat",value:function(h){return this.lngLat=h,Array.isArray(h)&&(this.lngLat={lng:h[0],lat:h[1]}),this.mapsService&&(this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(h){return this.setDOMContent(window.document.createTextNode(h))}},{key:"setMaxWidth",value:function(h){return this.popupOption.maxWidth=h,this.update(),this}},{key:"setDOMContent",value:function(h){return this.createContent(),this.content.appendChild(h),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&Ye.SO.remove(this.content),this.content=Ye.SO.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=Ye.SO.create("button","l7-popup-close-button",this.content),this.popupOption.closeButtonOffsets&&(this.closeButton.style.right=this.popupOption.closeButtonOffsets[0]+"px",this.closeButton.style.top=this.popupOption.closeButtonOffsets[1]+"px"),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(h,v,w){var I=window.document.createElement(h);return void 0!==v&&(I.className=v),w&&w.appendChild(I),I}},{key:"removeDom",value:function(h){h.parentNode&&h.parentNode.removeChild(h)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:Ye.bV.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(h){h.stopPropagation&&h.stopPropagation(),this.remove()}},{key:"update",value:function(){var h=this,w=this.popupOption,I=w.className,k=w.maxWidth,X=w.anchor;if(this.mapsService&&this.lngLat&&this.content){var fe=this.mapsService.getMarkerContainer();!this.container&&fe&&(this.container=this.creatDom("div","l7-popup",fe),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),I&&I.split(" ").forEach(function(Be){return h.container.classList.add(Be)}),this.popupOption.stopPropagation&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Be){h.container.addEventListener(Be,function(rt){rt.stopPropagation()})})),k&&this.container.style.maxWidth!==k&&(this.container.style.maxWidth=k),this.updatePosition(),Ye.SO.setTransform(this.container,"".concat(Ye.rQ[X])),(0,Ye.zi)(this.container,X,"popup")}}},{key:"updatePosition",value:function(){if(this.mapsService){var h=this.lngLat,I=this.popupOption.offsets,k=this.mapsService.lngLatToContainer([h.lng,h.lat]);this.container.style.left=k.x+I[0]+"px",this.container.style.top=k.y-I[1]+"px"}}}])}(_t.EventEmitter),function(n,c){if(c||(c=document),c){var i=c.head||c.getElementsByTagName("head")[0];if(!i){i=c.createElement("head");var u=c.body||c.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):c.documentElement.appendChild(i)}var h=c.createElement("style");h.type="text/css",h.styleSheet?h.styleSheet.cssText=n:h.appendChild(c.createTextNode(n)),i.appendChild(h)}}(".l7-marker-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: absolute;\n}\n\n.l7-marker {\n  position: absolute !important;\n  top: 0;\n  left: 0;\n  z-index: 5;\n  cursor: pointer;\n}\n\n.l7-marker-cluster {\n  background-clip: padding-box;\n  border-radius: 20px;\n  background-color: rgba(181, 226, 140, 0.6);\n  width: 40px;\n  height: 40px;\n}\n.l7-marker-cluster div {\n  width: 30px;\n  height: 30px;\n  margin-left: 5px;\n  margin-top: 5px;\n  text-align: center;\n  border-radius: 15px;\n  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n  background-color: rgba(110, 204, 57, 0.6);\n}\n.l7-marker-cluster span {\n  line-height: 30px;\n}\n\n.l7-popup-anchor-bottom,\n.l7-popup-anchor-bottom-left,\n.l7-popup-anchor-bottom-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: column-reverse;\n          flex-direction: column-reverse;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* layers control */\n\n.l7-control-layers {\n  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);\n  background: #fff;\n  border-radius: 5px;\n}\n.l7-popup-anchor-top,\n.l7-popup-anchor-top-left,\n.l7-popup-anchor-top-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.l7-popup-anchor-left {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n\n.l7-popup-anchor-right {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n}\n.l7-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  will-change: transform;\n  pointer-events: none;\n  z-index: 5;\n}\n.l7-popup-tip {\n  width: 0;\n  height: 0;\n  border: 10px solid transparent;\n  z-index: 1;\n}\n.l7-popup-anchor-top .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-top: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-top: none;\n  border-left: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-top: none;\n  border-right: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-bottom .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-bottom: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-bottom: none;\n  border-left: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-bottom: none;\n  border-right: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-left .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-left: none;\n  border-right-color: #fff;\n}\n\n.l7-popup-anchor-right .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-right: none;\n  border-left-color: #fff;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  padding: 0;\n  font-size: 25px;\n  line-height: 20px;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n.l7-popup-anchor-top-left .l7-popup-content {\n  border-top-left-radius: 0;\n}\n\n.l7-popup-anchor-top-right .l7-popup-content {\n  border-top-right-radius: 0;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-content {\n  border-bottom-left-radius: 0;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-content {\n  border-bottom-right-radius: 0;\n}\n\n.l7-popup-track-pointer {\n  display: none;\n}\n\n.l7-popup-track-pointer * {\n  pointer-events: none;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.l7-map:hover .l7-popup-track-pointer {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n\n.l7-map:active .l7-popup-track-pointer {\n  display: none;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* general toolbar styles */\n\n.l7-bar {\n  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n  border-radius: 4px;\n}\n.l7-bar a,\n.l7-bar a:hover {\n  background-color: #fff;\n  width: 30px;\n  height: 30px;\n  font-size: 20px;\n  display: block;\n  text-align: center;\n  text-decoration: none;\n  color: #8e9dab;\n}\n.l7-bar a,\n.l7-control-layers-toggle {\n  background-position: 50% 50%;\n  background-repeat: no-repeat;\n  display: block;\n}\n.l7-bar a:hover {\n  background-color: #f4f4f4;\n}\n.l7-bar a:first-child {\n  border-top-left-radius: 2px;\n  border-top-right-radius: 2px;\n}\n.l7-bar a:last-child {\n  border-bottom-left-radius: 2px;\n  border-bottom-right-radius: 2px;\n  border-bottom: none;\n}\n.l7-bar a.l7-disabled {\n  cursor: default;\n  background-color: #f4f4f4;\n  color: #bbb;\n}\n\n/* control positioning */\n\n.l7-control-container {\n  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;\n}\n.l7-control-hide {\n  display: none;\n}\n.l7-control {\n  position: relative;\n  z-index: 800;\n  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */\n  pointer-events: auto;\n}\n.l7-control {\n  float: left;\n  clear: both;\n}\n.l7-top,\n.l7-bottom {\n  position: absolute;\n  z-index: 1000;\n  pointer-events: none;\n}\n.l7-top {\n  top: 0;\n}\n.l7-right {\n  right: 0;\n}\n.l7-bottom {\n  bottom: 0;\n}\n.l7-left {\n  left: 0;\n}\n.l7-center {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: absolute;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.l7-bottom.l7-center,\n.l7-top.l7-center {\n  width: 100%;\n}\n.l7-right.l7-center,\n.l7-left.l7-center {\n  height: 100%;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.l7-top.l7-center,\n.l7-left.l7-center {\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start;\n}\n\n.l7-bottom.l7-center,\n.l7-right.l7-center {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n}\n\n.l7-center .l7-control {\n  margin-right: 10px;\n  margin-bottom: 10px;\n}\n\n.l7-control {\n  float: left;\n  clear: both;\n}\n.l7-right .l7-control {\n  float: right;\n}\n.l7-top .l7-control {\n  margin-top: 10px;\n}\n.l7-bottom .l7-control {\n  margin-bottom: 10px;\n}\n.l7-left .l7-control {\n  margin-left: 10px;\n}\n.l7-right .l7-control {\n  margin-right: 10px;\n}\n\n/* attribution and scale controls */\n\n.l7-control-container .l7-control-attribution {\n  background: #fff;\n  background: rgba(255, 255, 255, 0.7);\n  margin: 0;\n}\n.l7-control-attribution,\n.l7-control-scale-line {\n  padding: 0 5px;\n  color: #333;\n}\n.l7-control-attribution a {\n  text-decoration: none;\n}\n.l7-control-attribution a:hover {\n  text-decoration: underline;\n}\n.l7-container .l7-control-attribution,\n.l7-container .l7-control-scale {\n  font-size: 11px;\n  padding: 5px 5px 2px 5px;\n  background: rgba(255, 255, 255, 0.7);\n}\n.l7-left .l7-control-scale {\n  margin-left: 5px;\n}\n.l7-bottom .l7-control-scale {\n  margin-bottom: 5px;\n}\n.l7-control-scale-line {\n  border: 2px solid #000;\n  border-top: none;\n  color: #000;\n  line-height: 1.1;\n  padding: 2px 5px 1px;\n  font-size: 11px;\n  white-space: nowrap;\n  overflow: hidden;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n\n  background: #fff;\n}\n.l7-control-scale-line:not(:first-child) {\n  border-top: 2px solid #777;\n  border-bottom: none;\n  margin-top: -2px;\n}\n.l7-control-scale-line:not(:first-child):not(:last-child) {\n  border-bottom: 2px solid #777;\n}\n\n.l7-touch .l7-control-attribution,\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  -webkit-box-shadow: none;\n          box-shadow: none;\n}\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  border: 2px solid rgba(0, 0, 0, 0.2);\n  background-clip: padding-box;\n}\n/*logo */\n\n.l7-ctrl-logo {\n  background-size: 100% 100%;\n  width: 89px;\n  height: 16px;\n  margin: 0 0 -3px -3px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  background-repeat: no-repeat;\n  cursor: pointer;\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');\n}\n\n/* layers control */\n\n.l7-control-layers {\n  -webkit-box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);\n          box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);\n  background: #fff;\n  border-radius: 2px;\n}\n.l7-control-layers-toggle {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');\n  width: 30px;\n  height: 30px;\n  background-size: 20px 20px;\n}\n\n.l7-touch .l7-control-layers-toggle {\n  width: 44px;\n  height: 44px;\n}\n.l7-control-layers .l7-control-layers-list,\n.l7-control-layers-expanded .l7-control-layers-toggle {\n  display: none;\n}\n.l7-control-layers-expanded .l7-control-layers-list {\n  display: block;\n  position: relative;\n}\n.l7-control-layers-expanded {\n  padding: 6px 10px 6px 6px;\n  color: #59626b;\n  background: #fff;\n}\n.l7-control-layers-scrollbar {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  padding-right: 5px;\n}\n.l7-control-layers-selector {\n  margin-top: 2px;\n  position: relative;\n  top: 1px;\n}\n.l7-control-layers label {\n  display: block;\n  padding: 8px;\n}\n.l7-control-layers label input[type='radio'],\n.l7-control-layers label input[type='checkbox'] {\n  width: 14px;\n  height: 14px;\n  margin: 0;\n}\n.l7-control-layers-separator {\n  height: 0;\n  border-top: 1px solid #d8d8d8;\n  margin: 5px -10px 5px -6px;\n}\n.mapboxgl-ctrl-logo {\n  display: none !important;\n}\n.amap-logo {\n  display: none !important;\n}\n");var nt,xt,Dt,Y=y(32952),Ge=y(56326);function Z(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Ze(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?Z(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Z(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Et=(nt=(0,W.yT)(W.vK.IGlobalConfigService),xt=function(){function n(c){(0,R.Z)(this,n),(0,Y.Z)(this,"configService",Dt,this),(0,V.Z)(this,"config",void 0),this.config=c}return(0,N.Z)(n,[{key:"setContainer",value:function(i,u){i.bind(W.vK.MapConfig).toConstantValue(Ze(Ze({},this.config),{},{id:u})),i.bind(W.vK.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),n}(),Dt=(0,Ge.Z)(xt.prototype,"configService",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt),Mt=y(71189),Jt=y(8239),Tr=y(88774),mr=y.n(Tr),Yt=y(30651),gr=y(14563);function sr(){var n=new gr.WT(3);return gr.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function dr(n){var c=new gr.WT(3);return c[0]=n[0],c[1]=n[1],c[2]=n[2],c}function mn(n){return Math.hypot(n[0],n[1],n[2])}function On(n,c,i){var u=new gr.WT(3);return u[0]=n,u[1]=c,u[2]=i,u}function mi(n,c){return n[0]=c[0],n[1]=c[1],n[2]=c[2],n}function hi(n,c,i,u){return n[0]=c,n[1]=i,n[2]=u,n}function si(n,c,i){return n[0]=c[0]+i[0],n[1]=c[1]+i[1],n[2]=c[2]+i[2],n}function ai(n,c,i){return n[0]=c[0]-i[0],n[1]=c[1]-i[1],n[2]=c[2]-i[2],n}function Yi(n,c,i){return n[0]=c[0]*i[0],n[1]=c[1]*i[1],n[2]=c[2]*i[2],n}function Pi(n,c,i){return n[0]=c[0]/i[0],n[1]=c[1]/i[1],n[2]=c[2]/i[2],n}function Ei(n,c){return n[0]=Math.ceil(c[0]),n[1]=Math.ceil(c[1]),n[2]=Math.ceil(c[2]),n}function re(n,c){return n[0]=Math.floor(c[0]),n[1]=Math.floor(c[1]),n[2]=Math.floor(c[2]),n}function ve(n,c,i){return n[0]=Math.min(c[0],i[0]),n[1]=Math.min(c[1],i[1]),n[2]=Math.min(c[2],i[2]),n}function _e(n,c,i){return n[0]=Math.max(c[0],i[0]),n[1]=Math.max(c[1],i[1]),n[2]=Math.max(c[2],i[2]),n}function G(n,c){return n[0]=Math.round(c[0]),n[1]=Math.round(c[1]),n[2]=Math.round(c[2]),n}function oe(n,c,i){return n[0]=c[0]*i,n[1]=c[1]*i,n[2]=c[2]*i,n}function xe(n,c,i,u){return n[0]=c[0]+i[0]*u,n[1]=c[1]+i[1]*u,n[2]=c[2]+i[2]*u,n}function Oe(n,c){return Math.hypot(c[0]-n[0],c[1]-n[1],c[2]-n[2])}function pe(n,c){var i=c[0]-n[0],u=c[1]-n[1],h=c[2]-n[2];return i*i+u*u+h*h}function Ae(n){var c=n[0],i=n[1],u=n[2];return c*c+i*i+u*u}function Tt(n,c){return n[0]=-c[0],n[1]=-c[1],n[2]=-c[2],n}function wr(n,c){return n[0]=1/c[0],n[1]=1/c[1],n[2]=1/c[2],n}function Kt(n,c){var i=c[0],u=c[1],h=c[2],v=i*i+u*u+h*h;return v>0&&(v=1/Math.sqrt(v)),n[0]=c[0]*v,n[1]=c[1]*v,n[2]=c[2]*v,n}function ar(n,c){return n[0]*c[0]+n[1]*c[1]+n[2]*c[2]}function Br(n,c,i){var u=c[0],h=c[1],v=c[2],w=i[0],I=i[1],k=i[2];return n[0]=h*k-v*I,n[1]=v*w-u*k,n[2]=u*I-h*w,n}function Rn(n,c,i,u){var h=c[0],v=c[1],w=c[2];return n[0]=h+u*(i[0]-h),n[1]=v+u*(i[1]-v),n[2]=w+u*(i[2]-w),n}function Pn(n,c,i,u,h,v){var w=v*v,I=w*(2*v-3)+1,k=w*(v-2)+v,X=w*(v-1),fe=w*(3-2*v);return n[0]=c[0]*I+i[0]*k+u[0]*X+h[0]*fe,n[1]=c[1]*I+i[1]*k+u[1]*X+h[1]*fe,n[2]=c[2]*I+i[2]*k+u[2]*X+h[2]*fe,n}function rr(n,c,i,u,h,v){var w=1-v,I=w*w,k=v*v,X=I*w,fe=3*v*I,se=3*k*w,Be=k*v;return n[0]=c[0]*X+i[0]*fe+u[0]*se+h[0]*Be,n[1]=c[1]*X+i[1]*fe+u[1]*se+h[1]*Be,n[2]=c[2]*X+i[2]*fe+u[2]*se+h[2]*Be,n}function Sn(n,c){c=c||1;var i=2*gr.FD()*Math.PI,u=2*gr.FD()-1,h=Math.sqrt(1-u*u)*c;return n[0]=Math.cos(i)*h,n[1]=Math.sin(i)*h,n[2]=u*c,n}function an(n,c,i){var u=c[0],h=c[1],v=c[2],w=i[3]*u+i[7]*h+i[11]*v+i[15];return n[0]=(i[0]*u+i[4]*h+i[8]*v+i[12])/(w=w||1),n[1]=(i[1]*u+i[5]*h+i[9]*v+i[13])/w,n[2]=(i[2]*u+i[6]*h+i[10]*v+i[14])/w,n}function fn(n,c,i){var u=c[0],h=c[1],v=c[2];return n[0]=u*i[0]+h*i[3]+v*i[6],n[1]=u*i[1]+h*i[4]+v*i[7],n[2]=u*i[2]+h*i[5]+v*i[8],n}function Di(n,c,i){var u=i[0],h=i[1],v=i[2],I=c[0],k=c[1],X=c[2],fe=h*X-v*k,se=v*I-u*X,Be=u*k-h*I,rt=h*Be-v*se,Bt=v*fe-u*Be,Xt=u*se-h*fe,Ar=2*i[3];return se*=Ar,Be*=Ar,Bt*=2,Xt*=2,n[0]=I+(fe*=Ar)+(rt*=2),n[1]=k+se+Bt,n[2]=X+Be+Xt,n}function _n(n,c,i,u){var h=[],v=[];return h[0]=c[0]-i[0],h[1]=c[1]-i[1],h[2]=c[2]-i[2],v[0]=h[0],v[1]=h[1]*Math.cos(u)-h[2]*Math.sin(u),v[2]=h[1]*Math.sin(u)+h[2]*Math.cos(u),n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function Oi(n,c,i,u){var h=[],v=[];return h[0]=c[0]-i[0],h[1]=c[1]-i[1],h[2]=c[2]-i[2],v[0]=h[2]*Math.sin(u)+h[0]*Math.cos(u),v[1]=h[1],v[2]=h[2]*Math.cos(u)-h[0]*Math.sin(u),n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function ta(n,c,i,u){var h=[],v=[];return h[0]=c[0]-i[0],h[1]=c[1]-i[1],h[2]=c[2]-i[2],v[0]=h[0]*Math.cos(u)-h[1]*Math.sin(u),v[1]=h[0]*Math.sin(u)+h[1]*Math.cos(u),v[2]=h[2],n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function oi(n,c){var i=n[0],u=n[1],h=n[2],v=c[0],w=c[1],I=c[2],fe=Math.sqrt(i*i+u*u+h*h)*Math.sqrt(v*v+w*w+I*I),se=fe&&ar(n,c)/fe;return Math.acos(Math.min(Math.max(se,-1),1))}function Ji(n){return n[0]=0,n[1]=0,n[2]=0,n}function ji(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function Ti(n,c){return n[0]===c[0]&&n[1]===c[1]&&n[2]===c[2]}function _a(n,c){var i=n[0],u=n[1],h=n[2],v=c[0],w=c[1],I=c[2];return Math.abs(i-v)<=gr.Ib*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(u-w)<=gr.Ib*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-I)<=gr.Ib*Math.max(1,Math.abs(h),Math.abs(I))}var n,Ia=ai,Gi=Yi,Ni=Pi,Xi=Oe,to=pe,Ho=mn,Za=Ae,Wi=(n=sr(),function(c,i,u,h,v,w){var I,k;for(i||(i=3),u||(u=0),k=h?Math.min(h*i+u,c.length):c.length,I=u;I<k;I+=i)n[0]=c[I],n[1]=c[I+1],n[2]=c[I+2],v(n,n,w),c[I]=n[0],c[I+1]=n[1],c[I+2]=n[2];return c}),va=y(15922),wu=y(82958),Da=y.n(wu),Bi=(y(78320),(()=>(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.L7MAP="L7MAP",n.GLOBEL="GLOBEL"}(Bi||(Bi={})),Bi))()),ra=y(83838),bo=y(58623);function vo(n,c){var i=bo.fF([],c,n);return bo.bA(i,i,1/i[3]),i}function aa(){var n=new gr.WT(2);return gr.WT!=Float32Array&&(n[0]=0,n[1]=0),n}function Ma(n,c){var i=new gr.WT(2);return i[0]=n,i[1]=c,i}function Ya(n,c){return n[0]=c[0],n[1]=c[1],n}function Na(n,c,i){return n[0]=c[0]+i[0],n[1]=c[1]+i[1],n}function Ee(n,c,i){return n[0]=c[0]-i[0],n[1]=c[1]-i[1],n}function Lo(n,c){var i=c[0],u=c[1],h=i*i+u*u;return h>0&&(h=1/Math.sqrt(h)),n[0]=c[0]*h,n[1]=c[1]*h,n}function es(n,c){return n[0]*c[0]+n[1]*c[1]}function ks(n,c,i,u){var h=c[0],v=c[1];return n[0]=h+u*(i[0]-h),n[1]=v+u*(i[1]-v),n}var g=Ee;function Zt(n,c){if(!n)throw new Error(c||"viewport-mercator-project: assertion failed.")}aa();var Ft=Math.PI,Or=Ft/4,zr=Ft/180,Jn=180/Ft;function Ea(n){return Math.pow(2,n)}function vi(n,c){var i=(0,ra.Z)(n,2),u=i[0],h=i[1];return Zt(Number.isFinite(u)&&Number.isFinite(c)),Zt(Number.isFinite(h)&&h>=-90&&h<=90,"invalid latitude"),[(c*=512)*(u*zr+Ft)/(2*Ft),c*(Ft-Math.log(Math.tan(Or+h*zr*.5)))/(2*Ft)]}function Xo(n,c){var i=(0,ra.Z)(n,2),v=i[0]/(c*=512)*(2*Ft)-Ft,w=2*(Math.atan(Math.exp(Ft-i[1]/c*(2*Ft)))-Or);return[v*Jn,w*Jn]}function Tu(n){var c=n.latitude,i=n.longitude,h=n.scale,v=n.highPrecision,w=void 0!==v&&v;h=void 0!==h?h:Ea(n.zoom),Zt(Number.isFinite(c)&&Number.isFinite(i)&&Number.isFinite(h));var I={},k=512*h,X=Math.cos(c*zr),fe=k/360,se=fe/X,Be=k/4003e4/X;if(I.pixelsPerMeter=[Be,-Be,Be],I.metersPerPixel=[1/Be,-1/Be,1/Be],I.pixelsPerDegree=[fe,-se,Be],I.degreesPerPixel=[1/fe,-1/se,1/Be],w){var rt=zr*Math.tan(c*zr)/X,Xt=k/4003e4*rt,Ar=Xt/se*Be;I.pixelsPerDegree2=[0,-fe*rt/2,Xt],I.pixelsPerMeter2=[Ar,0,Ar]}return I}function Du(n){var c=n.height,i=n.pitch,u=n.bearing,v=n.center,w=void 0===v?null:v,I=n.flipY,k=void 0!==I&&I,X=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return Yt.translate(X,X,[0,0,-n.altitude]),Yt.scale(X,X,[1,1,1/c]),Yt.rotateX(X,X,-i*zr),Yt.rotateZ(X,X,u*zr),k&&Yt.scale(X,X,[1,-1,1]),w&&Yt.translate(X,X,Tt([],w)),X}function mu(n){var I=function(n){var c=n.width,i=n.height,u=n.altitude,h=void 0===u?1.5:u,v=n.pitch,I=n.nearZMultiplier,k=void 0===I?1:I,X=n.farZMultiplier,fe=void 0===X?1:X,se=(void 0===v?0:v)*zr,Be=Math.atan(.5/h),rt=Math.sin(Be)*h/Math.sin(Math.PI/2-se-Be),Bt=Math.cos(Math.PI/2-se)*rt+h;return{fov:2*Math.atan(i/2/h),aspect:c/i,focalDistance:h,near:k,far:Bt*fe}}({width:n.width,height:n.height,altitude:n.altitude,pitch:n.pitch,nearZMultiplier:n.nearZMultiplier,farZMultiplier:n.farZMultiplier});return Yt.perspective([],I.fov,I.aspect,I.near,I.far)}function gu(n,c){var i=(0,ra.Z)(n,3),u=i[0],h=i[1],v=i[2],w=void 0===v?0:v;return Zt(Number.isFinite(u)&&Number.isFinite(h)&&Number.isFinite(w)),vo(c,[u,h,w,1])}function tu(n,c){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=(0,ra.Z)(n,3),h=u[0],v=u[1],w=u[2];if(Zt(Number.isFinite(h)&&Number.isFinite(v),"invalid pixel coordinate"),Number.isFinite(w)){var I=vo(c,[h,v,w,1]);return I}var k=vo(c,[h,v,0,1]),X=vo(c,[h,v,1,1]),fe=k[2],se=X[2],Be=fe===se?0:((i||0)-fe)/(se-fe);return ks([],k,X,Be)}var oo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function Cc(n){var c=n.width,i=n.height,h=n.minExtent,v=void 0===h?0:h,w=n.maxZoom,I=void 0===w?24:w,k=n.padding,X=void 0===k?0:k,fe=n.offset,se=void 0===fe?[0,0]:fe,Be=(0,ra.Z)(n.bounds,2),rt=(0,ra.Z)(Be[0],2),Bt=rt[0],Xt=rt[1],Ar=(0,ra.Z)(Be[1],2),Vr=Ar[0],sn=Ar[1];Number.isFinite(X)?X={top:X,bottom:X,left:X,right:X}:Zt(Number.isFinite(X.top)&&Number.isFinite(X.bottom)&&Number.isFinite(X.left)&&Number.isFinite(X.right));var Mn=new rs({width:c,height:i,longitude:0,latitude:0,zoom:0}),Wn=Mn.project([Bt,sn]),ei=Mn.project([Vr,Xt]),ti=[Math.max(Math.abs(ei[0]-Wn[0]),v),Math.max(Math.abs(ei[1]-Wn[1]),v)],Ui=[c-X.left-X.right-2*Math.abs(se[0]),i-X.top-X.bottom-2*Math.abs(se[1])];Zt(Ui[0]>0&&Ui[1]>0);var wa=Ui[0]/ti[0],Ua=Ui[1]/ti[1],Ru=Mn.unproject([(ei[0]+Wn[0])/2+(X.right-X.left)/2/wa,(ei[1]+Wn[1])/2+(X.bottom-X.top)/2/Ua]),_p=Mn.zoom+Math.log2(Math.abs(Math.min(wa,Ua)));return{longitude:Ru[0],latitude:Ru[1],zoom:Math.min(_p,I)}}var Rs,rc,Nu,La,Ju,Gc,Us,nc,Hc,Ac,Bl,rs=function(n){function c(){var i,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=u.width,v=u.height,w=u.latitude,I=void 0===w?0:w,k=u.longitude,X=void 0===k?0:k,fe=u.zoom,se=void 0===fe?0:fe,Be=u.pitch,rt=void 0===Be?0:Be,Bt=u.bearing,Xt=void 0===Bt?0:Bt,Ar=u.altitude,Vr=void 0===Ar?1.5:Ar,sn=u.nearZMultiplier,yn=u.farZMultiplier;(0,R.Z)(this,c),h=h||1,v=v||1;var Mn=Ea(se);Vr=Math.max(.75,Vr);var Wn=vi([X,I],Mn);Wn[2]=0;var ei=mu({width:h,height:v,pitch:rt,bearing:Xt,altitude:Vr,nearZMultiplier:sn||1/v,farZMultiplier:yn||1.01}),ti=Du({height:v,center:Wn,pitch:rt,bearing:Xt,altitude:Vr,flipY:!0});return(i=(0,be.Z)(this,(0,Ne.Z)(c).call(this,{width:h,height:v,viewMatrix:ti,projectionMatrix:ei}))).latitude=I,i.longitude=X,i.zoom=se,i.pitch=rt,i.bearing=Xt,i.altitude=Vr,i.scale=Mn,i.center=Wn,i.pixelsPerMeter=Tu((0,H.Z)((0,H.Z)(i))).pixelsPerMeter[2],Object.freeze((0,H.Z)((0,H.Z)(i))),i}return(0,j.Z)(c,n),(0,N.Z)(c,[{key:"projectFlat",value:function(u){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return vi(u,h)}},{key:"unprojectFlat",value:function(u){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Xo(u,h)}},{key:"getMapCenterByLngLatPosition",value:function(u){var h=u.lngLat,w=tu(u.pos,this.pixelUnprojectionMatrix),k=Na([],vi(h,this.scale),function(n,c){return n[0]=-c[0],n[1]=-c[1],n}([],w));return Xo(Na([],this.center,k),this.scale)}},{key:"getLocationAtPoint",value:function(u){return this.getMapCenterByLngLatPosition({lngLat:u.lngLat,pos:u.pos})}},{key:"fitBounds",value:function(u){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},v=this.width,w=this.height,I=Cc(Object.assign({width:v,height:w,bounds:u},h)),k=I.longitude,X=I.latitude,fe=I.zoom;return new c({width:v,height:w,longitude:k,latitude:X,zoom:fe})}}]),c}(function(){function n(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=c.width,u=c.height,h=c.viewMatrix,v=void 0===h?oo:h,w=c.projectionMatrix,I=void 0===w?oo:w;(0,R.Z)(this,n),this.width=i||1,this.height=u||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=v,this.projectionMatrix=I;var k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Yt.multiply(k,k,this.projectionMatrix),Yt.multiply(k,k,this.viewMatrix),this.viewProjectionMatrix=k;var X=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Yt.scale(X,X,[this.width/2,-this.height/2,1]),Yt.translate(X,X,[1,-1,0]),Yt.multiply(X,X,this.viewProjectionMatrix);var fe=Yt.invert([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X);if(!fe)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=X,this.pixelUnprojectionMatrix=fe,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,N.Z)(n,[{key:"equals",value:function(i){return i instanceof n&&i.width===this.width&&i.height===this.height&&Yt.equals(i.projectionMatrix,this.projectionMatrix)&&Yt.equals(i.viewMatrix,this.viewMatrix)}},{key:"project",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=u.topLeft,v=void 0===h||h,w=this.projectPosition(i),I=gu(w,this.pixelProjectionMatrix),k=(0,ra.Z)(I,2),X=k[0],fe=k[1],se=v?fe:this.height-fe;return 2===i.length?[X,se]:[X,se,I[2]]}},{key:"unproject",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=u.topLeft,v=void 0===h||h,w=u.targetZ,I=(0,ra.Z)(i,3),k=I[0],X=I[1],fe=I[2],se=v?X:this.height-X,Be=w&&w*this.pixelsPerMeter,rt=tu([k,se,fe],this.pixelUnprojectionMatrix,Be),Bt=this.unprojectPosition(rt),Xt=(0,ra.Z)(Bt,3),Ar=Xt[0],Vr=Xt[1],sn=Xt[2];return Number.isFinite(fe)?[Ar,Vr,sn]:Number.isFinite(w)?[Ar,Vr,w]:[Ar,Vr]}},{key:"projectPosition",value:function(i){var u=this.projectFlat(i),h=(0,ra.Z)(u,2);return[h[0],h[1],(i[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(i){var u=this.unprojectFlat(i),h=(0,ra.Z)(u,2);return[h[0],h[1],(i[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(i){return i}},{key:"unprojectFlat",value:function(i){return i}}]),n}()),tc=function(){function n(){(0,R.Z)(this,n),(0,V.Z)(this,"viewport",void 0)}return(0,N.Z)(n,[{key:"syncWithMapCamera",value:function(i){var u=i.center;this.viewport=new rs({width:i.viewportWidth,height:i.viewportHeight,longitude:u&&u[0],latitude:u&&u[1],zoom:i.zoom,pitch:i.pitch,bearing:i.bearing})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(i,u){return this.viewport.projectFlat(i,u)}}]),n}(),ru={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}};function yu(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function $u(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?yu(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):yu(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}(function(n,c){if(c||(c=document),c){var i=c.head||c.getElementsByTagName("head")[0];if(!i){i=c.createElement("head");var u=c.body||c.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):c.documentElement.appendChild(i)}var h=c.createElement("style");h.type="text/css",h.styleSheet?h.styleSheet.cssText=n:h.appendChild(c.createTextNode(n)),i.appendChild(h)}})(".mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}"),window.mapboxgl=Da();var Qu={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},el=0,Bu="pk.eyJ1IjoibHp4dWUiLCJhIjoiY2tvaWZuM2s4MWZuYjJ1dHI5ZGduYTlrdiJ9.DQCfMRbZzx0VSwecQ69McA",Vs=(Rs=(0,va.b2)(),rc=(0,va.f3)(W.vK.MapConfig),Nu=(0,va.f3)(W.vK.IGlobalConfigService),La=(0,va.f3)(W.vK.ICoordinateSystemService),Ju=(0,va.f3)(W.vK.IEventEmitter),Rs((Us=function(){function n(){var c=this;(0,R.Z)(this,n),(0,V.Z)(this,"version",Bi.MAPBOX),(0,V.Z)(this,"map",void 0),(0,V.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,Y.Z)(this,"config",nc,this),(0,Y.Z)(this,"configService",Hc,this),(0,Y.Z)(this,"coordinateSystemService",Ac,this),(0,Y.Z)(this,"eventEmitter",Bl,this),(0,V.Z)(this,"viewport",void 0),(0,V.Z)(this,"markerContainer",void 0),(0,V.Z)(this,"cameraChangedCallback",void 0),(0,V.Z)(this,"$mapContainer",void 0),(0,V.Z)(this,"handleCameraChanged",function(){var i=c.map.getCenter().wrap(),u=i.lat,h=i.lng;c.viewport.syncWithMapCamera({bearing:c.map.getBearing(),center:[h,u],viewportHeight:c.map.transform.height,pitch:c.map.getPitch(),viewportWidth:c.map.transform.width,zoom:c.map.getZoom(),cameraHeight:0});var v=c.config.offsetZoom,w=void 0===v?12:v;c.viewport.getZoom()>w?c.coordinateSystemService.setCoordinateSystem(W.CoordinateSystem.LNGLAT_OFFSET):c.coordinateSystemService.setCoordinateSystem(W.CoordinateSystem.LNGLAT),c.cameraChangedCallback(c.viewport)})}return(0,N.Z)(n,[{key:"setBgColor",value:function(i){this.bgColor=i}},{key:"addMarkerContainer",value:function(){var i=this.map.getCanvasContainer();this.markerContainer=Ye.SO.create("div","l7-marker-container",i),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(i,u){-1!==W.MapServiceEvent.indexOf(i)?this.eventEmitter.on(i,u):this.map.on(Qu[i]||i,u)}},{key:"off",value:function(i,u){this.map.off(Qu[i]||i,u)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var i=this.map.transform;return[i.width,i.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(i){return this.map.setZoom(i)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(i){this.map.setCenter(i)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(i){this.map.setBearing(i)}},{key:"zoomIn",value:function(i,u){this.map.zoomIn(i,u)}},{key:"zoomOut",value:function(i,u){this.map.zoomOut(i,u)}},{key:"setPitch",value:function(i){return this.map.setPitch(i)}},{key:"panTo",value:function(i){this.map.panTo(i)}},{key:"panBy",value:function(i,u){this.panTo([i,u])}},{key:"fitBounds",value:function(i,u){this.map.fitBounds(i,u)}},{key:"setMaxZoom",value:function(i){this.map.setMaxZoom(i)}},{key:"setMinZoom",value:function(i){this.map.setMinZoom(i)}},{key:"setMapStatus",value:function(i){!0===i.doubleClickZoom&&this.map.doubleClickZoom.enable(),!1===i.doubleClickZoom&&this.map.doubleClickZoom.disable(),!1===i.dragEnable&&this.map.dragPan.disable(),!0===i.dragEnable&&this.map.dragPan.enable(),!1===i.rotateEnable&&this.map.dragRotate.disable(),!0===i.rotateEnable&&this.map.dragRotate.enable(),!1===i.keyboardEnable&&this.map.keyboard.disable(),!0===i.keyboardEnable&&this.map.keyboard.enable(),!1===i.zoomEnable&&this.map.scrollZoom.disable(),!0===i.zoomEnable&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(i,u){this.map.flyTo({zoom:i,center:u})}},{key:"setMapStyle",value:function(i){this.map.setStyle(this.getMapStyle(i))}},{key:"pixelToLngLat",value:function(i){return this.map.unproject(i)}},{key:"lngLatToPixel",value:function(i){return this.map.project(i)}},{key:"containerToLngLat",value:function(i){return this.map.unproject(i)}},{key:"lngLatToContainer",value:function(i){return this.map.project(i)}},{key:"lngLatToCoord",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0},h=this.lngLatToMercator(i,0),v=h.x,w=h.y;return[v-u.x,w-u.y]}},{key:"lngLatToMercator",value:function(i,u){var h=window.mapboxgl.MercatorCoordinate.fromLngLat(i,u),v=h.x,I=h.y,X=h.z;return{x:void 0===v?0:v,y:void 0===I?0:I,z:void 0===X?0:X}}},{key:"getModelMatrix",value:function(i,u,h){var v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:0,y:0,z:0},I=window.mapboxgl.MercatorCoordinate.fromLngLat(i,u),k=I.meterInMercatorCoordinateUnits(),X=Yt.create();return Yt.translate(X,X,On(I.x-w.x,I.y-w.y,I.z||0-w.z)),Yt.scale(X,X,On(k*v[0],-k*v[1],k*v[2])),Yt.rotateX(X,X,h[0]),Yt.rotateY(X,X,h[1]),Yt.rotateZ(X,X,h[2]),X}},{key:"init",value:(c=(0,Jt.Z)(mr().mark(function u(){var h,v,w,I,k,X,fe,se,Be,rt,Bt,Xt,Ar;return mr().wrap(function(sn){for(;;)switch(sn.prev=sn.next){case 0:w=void 0===(v=(h=this.config).id)?"map":v,k=void 0!==(I=h.attributionControl)&&I,fe=void 0===(X=h.style)?"light":X,Be=void 0===(se=h.token)?Bu:se,Bt=void 0===(rt=h.rotation)?0:rt,Xt=h.mapInstance,Ar=(0,Mt.Z)(h,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new tc,!Xt&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),Be===Bu&&"blank"!==fe&&!window.mapboxgl.accessToken&&!Xt&&console.warn(this.configService.getSceneWarninfo("MapToken")),!Xt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Be),Xt?(this.map=Xt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(w),this.map=new window.mapboxgl.Map($u({container:this.$mapContainer,style:this.getMapStyle(fe),attributionControl:k,bearing:Bt},Ar))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return sn.stop()}},u,this)})),function(){return c.apply(this,arguments)})},{key:"destroy",value:function(){var i,u;null===(i=this.$mapContainer)||void 0===i||null===(u=i.parentNode)||void 0===u||u.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(i){for(var u,h=arguments.length,v=new Array(h>1?h-1:0),w=1;w<h;w++)v[w-1]=arguments[w];(u=this.eventEmitter).emit.apply(u,[i].concat(v))}},{key:"once",value:function(i){for(var u,h=arguments.length,v=new Array(h>1?h-1:0),w=1;w<h;w++)v[w-1]=arguments[w];(u=this.eventEmitter).once.apply(u,[i].concat(v))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(i){var u=this.map.getCanvas();return"jpg"===i?null==u?void 0:u.toDataURL("image/jpeg"):null==u?void 0:u.toDataURL("image/png")}},{key:"onCameraChanged",value:function(i){this.cameraChangedCallback=i}},{key:"creatAmapContainer",value:function(i){var u=i;"string"==typeof i&&(u=document.getElementById(i));var h=document.createElement("div");return h.style.cssText+="\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 100%;\n    ",h.id="l7_mapbox_div"+el++,u.appendChild(h),h}},{key:"getMapStyle",value:function(i){return"string"!=typeof i?i:ru[i]?ru[i]:i}}]),n;var c}(),nc=(0,Ge.Z)(Us.prototype,"config",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hc=(0,Ge.Z)(Us.prototype,"configService",[Nu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ac=(0,Ge.Z)(Us.prototype,"coordinateSystemService",[La],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bl=(0,Ge.Z)(Us.prototype,"eventEmitter",[Ju],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gc=Us))||Gc);!function(n,c){if(c||(c=document),c){var i=c.head||c.getElementsByTagName("head")[0];if(!i){i=c.createElement("head");var u=c.body||c.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):c.documentElement.appendChild(i)}var h=c.createElement("style");h.type="text/css",h.styleSheet?h.styleSheet.cssText=n:h.appendChild(c.createTextNode(n)),i.appendChild(h)}}(".mapboxgl-ctrl-logo {\n display: none !important;\n}\n");var tl=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),c.apply(this,arguments)}return(0,N.Z)(i,[{key:"getServiceConstructor",value:function(){return Vs}}]),i}(Et),vl={},Fl={},ic=function(c){return Fl[c]},Fu=function(c,i){Fl[c]=i},Cu=function(c,i){vl[c]=i},zu={},nu={};function ac(n){return new Function("d","return {"+n.map(function(c,i){return JSON.stringify(c)+": d["+i+'] || ""'}).join(",")+"}")}function Zu(n){var c=Object.create(null),i=[];return n.forEach(function(u){for(var h in u)h in c||i.push(c[h]=h)}),i}function ns(n,c){var i=n+"",u=i.length;return u<c?new Array(c-u+1).join(0)+i:i}var Pu=function(n){var c=new RegExp('[",\n\r]'),i=n.charCodeAt(0);function h(se,Be){var Vr,rt=[],Bt=se.length,Xt=0,Ar=0,sn=Bt<=0,yn=!1;function Mn(){if(sn)return nu;if(yn)return yn=!1,zu;var ei,Ui,ti=Xt;if(34===se.charCodeAt(ti)){for(;Xt++<Bt&&34!==se.charCodeAt(Xt)||34===se.charCodeAt(++Xt););return(ei=Xt)>=Bt?sn=!0:10===(Ui=se.charCodeAt(Xt++))?yn=!0:13===Ui&&(yn=!0,10===se.charCodeAt(Xt)&&++Xt),se.slice(ti+1,ei-1).replace(/""/g,'"')}for(;Xt<Bt;){if(10===(Ui=se.charCodeAt(ei=Xt++)))yn=!0;else if(13===Ui)yn=!0,10===se.charCodeAt(Xt)&&++Xt;else if(Ui!==i)continue;return se.slice(ti,ei)}return sn=!0,se.slice(ti,Bt)}for(10===se.charCodeAt(Bt-1)&&--Bt,13===se.charCodeAt(Bt-1)&&--Bt;(Vr=Mn())!==nu;){for(var Wn=[];Vr!==zu&&Vr!==nu;)Wn.push(Vr),Vr=Mn();Be&&null==(Wn=Be(Wn,Ar++))||rt.push(Wn)}return rt}function v(se,Be){return se.map(function(rt){return Be.map(function(Bt){return fe(rt[Bt])}).join(n)})}function X(se){return se.map(fe).join(n)}function fe(se){return null==se?"":se instanceof Date?function(n){var c=n.getUTCHours(),i=n.getUTCMinutes(),u=n.getUTCSeconds(),h=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":function(n){return n<0?"-"+ns(-n,6):n>9999?"+"+ns(n,6):ns(n,4)}(n.getUTCFullYear())+"-"+ns(n.getUTCMonth()+1,2)+"-"+ns(n.getUTCDate(),2)+(h?"T"+ns(c,2)+":"+ns(i,2)+":"+ns(u,2)+"."+ns(h,3)+"Z":u?"T"+ns(c,2)+":"+ns(i,2)+":"+ns(u,2)+"Z":i||c?"T"+ns(c,2)+":"+ns(i,2)+"Z":"")}(se):c.test(se+="")?'"'+se.replace(/"/g,'""')+'"':se}return{parse:function(se,Be){var rt,Bt,Xt=h(se,function(Ar,Vr){if(rt)return rt(Ar,Vr-1);Bt=Ar,rt=Be?function(n,c){var i=ac(n);return function(u,h){return c(i(u),h,n)}}(Ar,Be):ac(Ar)});return Xt.columns=Bt||[],Xt},parseRows:h,format:function(se,Be){return null==Be&&(Be=Zu(se)),[Be.map(fe).join(n)].concat(v(se,Be)).join("\n")},formatBody:function(se,Be){return null==Be&&(Be=Zu(se)),v(se,Be).join("\n")},formatRows:function(se){return se.map(X).join("\n")},formatRow:X,formatValue:fe}}(",").parse,Ta=y(96109),lf=y(57452),Vl=y.n(lf);function ml(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function _u(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?ml(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):ml(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function So(n,c){var i=c.x,u=c.y,h=c.x1,v=c.y1,w=c.coordinates,I=[];return n.forEach(function(k,X){var fe=[];if(i&&u&&(fe=[parseFloat(k[i]),parseFloat(k[u])]),i&&u&&h&&v&&(fe=[[parseFloat(k[i]),parseFloat(k[u])],[parseFloat(k[h]),parseFloat(k[v])]]),w){var rt="Polygon";Array.isArray(w[0])||(rt="Point"),Array.isArray(w[0])&&!Array.isArray(w[0][0])&&(rt="LineString");var Bt={type:rt,coordinates:(0,Ta.Z)(k[w])};Vl()(Bt,!0),fe=Bt.coordinates}var Xt=_u(_u({},k),{},{_id:X,coordinates:fe});I.push(Xt)}),{dataArray:I}}var yl=y(70576);function Hs(n,c){!function(n,c){var i,u,h,v,w,I,k,X,fe,se,Be=0,rt="FeatureCollection"===n.type,Bt="Feature"===n.type,Xt=rt?n.features.length:1;for(i=0;i<Xt;i++){for(X=rt?n.features[i].properties:Bt?n.properties:{},fe=rt?n.features[i].bbox:Bt?n.bbox:void 0,se=rt?n.features[i].id:Bt?n.id:void 0,w=(k=!!(I=rt?n.features[i].geometry:Bt?n.geometry:n)&&"GeometryCollection"===I.type)?I.geometries.length:1,h=0;h<w;h++)if(null!==(v=k?I.geometries[h]:I))switch(v.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===c(v,Be,X,fe,se))return!1;break;case"GeometryCollection":for(u=0;u<v.geometries.length;u++)if(!1===c(v.geometries[u],Be,X,fe,se))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===c(null,Be,X,fe,se))return!1;Be++}}(n,function(i,u,h,v,w){var k,I=null===i?null:i.type;switch(I){case null:case"Point":case"LineString":case"Polygon":return!1!==c((0,yl.zL)(i,h,{bbox:v,id:w}),u,0)&&void 0}switch(I){case"MultiPoint":k="Point";break;case"MultiLineString":k="LineString";break;case"MultiPolygon":k="Polygon"}for(var X=0;X<i.coordinates.length;X++)if(!1===c((0,yl.zL)({type:k,coordinates:i.coordinates[X]},h),u,X))return!1})}function xu(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Ns(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?xu(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):xu(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var mo=y(33939),il=y.n(mo),ri=y(64871),In=y.n(ri),lc=y(55836),wo=y.n(lc),Xs=y(37524),Po=y.n(Xs),fo=y(97185);function jl(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Gl(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?jl(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):jl(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Qi(n,c){var i=c.radius,u=void 0===i?40:i,h=c.maxZoom,v=void 0===h?18:h,w=c.minZoom,I=void 0===w?0:w,k=c.zoom;if(n.pointIndex){var fe=n.pointIndex.getClusters(n.extent,Math.floor(void 0===k?2:k));return n.dataArray=function(n){return n.map(function(c,i){return Gl({coordinates:c.geometry.coordinates,_id:i+1},c.properties)})}(fe),n}var se=new(Ot())({radius:u,minZoom:I,maxZoom:v}),Be={type:"FeatureCollection",features:[]};return Be.features=n.dataArray.map(function(rt){return{type:"Feature",geometry:{type:"Point",coordinates:rt.coordinates},properties:Gl({},rt)}}),se.load(Be.features),se}function bl(n){if(0===n.length)return 0;for(var u,c=n[0],i=0,h=1;h<n.length;h++)u=c+1*n[h],Math.abs(c)>=Math.abs(n[h])?i+=c-u+n[h]:i+=n[h]-u+c,c=u;return c+1*i}var is={min:function(n){if(0===n.length)throw new Error("min requires at least one data point");for(var c=n[0],i=1;i<n.length;i++)n[i]<c&&(c=n[i]);return c},max:function(n){if(0===n.length)throw new Error("max requires at least one data point");for(var c=n[0],i=1;i<n.length;i++)n[i]>c&&(c=n[i]);return c},mean:function(n){if(0===n.length)throw new Error("mean requires at least one data point");return bl(n)/n.length},sum:bl};function su(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Hl(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?su(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):su(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Kc(n,c){if(Array.isArray(c))return c}var wl=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u,h){var v;return(0,R.Z)(this,i),v=c.call(this),(0,V.Z)((0,H.Z)(v),"data",void 0),(0,V.Z)((0,H.Z)(v),"extent",void 0),(0,V.Z)((0,H.Z)(v),"hooks",{init:new fo.ni}),(0,V.Z)((0,H.Z)(v),"parser",{type:"geojson"}),(0,V.Z)((0,H.Z)(v),"transforms",[]),(0,V.Z)((0,H.Z)(v),"cluster",!1),(0,V.Z)((0,H.Z)(v),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,V.Z)((0,H.Z)(v),"mapService",void 0),(0,V.Z)((0,H.Z)(v),"invalidExtent",!1),(0,V.Z)((0,H.Z)(v),"originData",void 0),(0,V.Z)((0,H.Z)(v),"rawData",void 0),(0,V.Z)((0,H.Z)(v),"cfg",{}),(0,V.Z)((0,H.Z)(v),"clusterIndex",void 0),v.originData=u,v.initCfg(h),v.hooks.init.tap("parser",function(){v.excuteParser()}),v.hooks.init.tap("cluster",function(){v.initCluster()}),v.hooks.init.tap("transform",function(){v.executeTrans()}),v.init(),v}return(0,N.Z)(i,[{key:"setData",value:function(h,v){this.rawData=h,this.originData=h,this.initCfg(v),this.init(),this.emit("update")}},{key:"getClusters",value:function(h){return this.clusterIndex.getClusters(this.caculClusterExtent(2),h)}},{key:"getClustersLeaves",value:function(h){return this.clusterIndex.getLeaves(h,1/0)}},{key:"updateClusterData",value:function(h){var v=this,w=this.clusterOptions,I=w.method,k=void 0===I?"sum":I,X=w.field,fe=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(h));this.clusterOptions.zoom=h,fe.forEach(function(se){se.id||(se.properties.point_count=1)}),(X||wo()(k))&&(fe=fe.map(function(se){var Be=se.id;if(Be){var Xt,Bt=v.clusterIndex.getLeaves(Be,1/0).map(function(Vr){return Vr.properties});if(In()(k)&&X){var Ar=function(n,c){return n.map(function(i){return 1*i[c]})}(Bt,X);Xt=is[k](Ar)}wo()(k)&&(Xt=k(Bt)),se.properties.stat=Xt}else se.properties.point_count=1;return se})),this.data=ic("geojson")({type:"FeatureCollection",features:fe}),this.executeTrans()}},{key:"getFeatureById",value:function(h){var v=this.parser.type;if("geojson"!==(void 0===v?"geojson":v)||this.cluster)return h<this.data.dataArray.length?this.data.dataArray[h]:"null";var I=h<this.originData.features.length?this.originData.features[h]:"null",k=Po()(I);if(0!==this.transforms.length){var X=this.data.dataArray.find(function(fe){return fe._id===h});k.properties=X}return k}},{key:"getFeatureId",value:function(h,v){var w=this.data.dataArray.find(function(I){return I[h]===name});return null==w?void 0:w._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"caculClusterExtent",value:function(h){var v=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(v=(0,Ye.yA)((0,Ye.ds)(this.extent),h)),v[0].concat(v[1])}},{key:"initCfg",value:function(h){this.cfg=il()(this.cfg,h,Kc);var v=this.cfg;v&&(v.parser&&(this.parser=v.parser),v.transforms&&(this.transforms=v.transforms),this.cluster=v.cluster||!1,v.clusterOptions&&(this.cluster=!0,this.clusterOptions=Hl(Hl({},this.clusterOptions),v.clusterOptions)))}},{key:"excuteParser",value:function(){var h=this.parser,w=ic(h.type||"geojson");this.data=w(this.originData,h),this.extent=(0,Ye.We)(this.data.dataArray),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3]}},{key:"executeTrans",value:function(){var h=this;this.transforms.forEach(function(w){var k=function(c){return vl[c]}(w.type)(h.data,w);Object.assign(h.data,k)})}},{key:"initCluster",value:function(){this.cluster&&(this.clusterIndex=Qi(this.data,this.clusterOptions||{}))}},{key:"init",value:function(){this.hooks.init.call(this)}}]),i}(_t.EventEmitter);function kc(n,c){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,c){if(n){if("string"==typeof n)return ju(n,c);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ju(n,c)}}(n))||c&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}function ju(n,c){(null==c||c>n.length)&&(c=n.length);for(var i=0,u=new Array(c);i<c;i++)u[i]=n[i];return u}var Xl=6378e3,a=Math.PI/3,s=[0,a,2*a,3*a,4*a,5*a];function o(n){return n[0]}function p(n){return n[1]}function E(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function A(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?E(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function he(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Ce(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?he(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):he(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}y(88818);const $e=wl;Fu("geojson",function(n,c){var i=[],u={};return n.features=n.features.filter(function(v){var w=v.geometry;return null!=v&&w&&w.type&&w.coordinates&&w.coordinates.length>0}),Vl()(n,!0),0===n.features.length?{dataArray:[],featureKeys:u}:(Hs(n,function(v,w){var I=function(n){if(Array.isArray(n))return n;if("Feature"===n.type){if(null!==n.geometry)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(v),k=w,X=Ns(Ns({},v.properties),{},{coordinates:I,_id:k});i.push(X)}),{dataArray:i,featureKeys:u})}),Fu("image",function(n,c){var i=c.extent;return{images:new Promise(function(v){!function(n,c){var i=n,u=[];if("string"==typeof i)(0,Ye.gJ)({url:i},function(w,I){u.push(I),c(u)});else{var h=i.length,v=0;i.forEach(function(w){(0,Ye.gJ)({url:w},function(I,k){v++,u.push(k),v===h&&c(u)})})}}(n,function(w){v(w)})}),_id:1,dataArray:[{_id:0,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]}}),Fu("csv",function(n,c){return So(Pu(n),c)}),Fu("json",So),Fu("raster",function(n,c){var i=c.extent,u=c.width,h=c.height,v=c.min,w=c.max;return{_id:1,dataArray:[{_id:1,data:Array.from(n),width:u,height:h,min:v,max:w,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]}}),Cu("cluster",Qi),Cu("filter",function(n,c){var i=c.callback;return i&&(n.dataArray=n.dataArray.filter(i)),n}),Cu("join",function(n,c){var i=c.sourceField,u=c.targetField,v={};return c.data.forEach(function(w){v[w[i]]=w}),n.dataArray=n.dataArray.map(function(w){var I=w[u];return Ce(Ce({},w),v[I])}),n}),Cu("map",function(n,c){var i=c.callback;return i&&(n.dataArray=n.dataArray.map(i)),n}),Cu("grid",function(n,c){var u=c.size,h=void 0===u?10:u,v=h/(2*Math.PI*Xl)*(256<<20)/2,w=function(n,c){var h,w,i=1/0,u=-1/0,v=kc(n);try{for(v.s();!(w=v.n()).done;)h=w.value.coordinates[1],Number.isFinite(h)&&(i=h<i?h:i,u=h>u?h:u)}catch(yn){v.e(yn)}finally{v.f()}var X=function(n,c){return{yOffset:function(n){return n/Xl*(180/Math.PI)}(n),xOffset:function(n,c){return c/Xl*(180/Math.PI)/Math.cos(n*Math.PI/180)}(c,n)}}(c,(i+u)/2);if(X.xOffset<=0||X.yOffset<=0)return{gridHash:{},gridOffset:X};var Be,fe={},se=kc(n);try{for(se.s();!(Be=se.n()).done;){var rt=Be.value,Bt=rt.coordinates[1],Xt=rt.coordinates[0];if(Number.isFinite(Bt)&&Number.isFinite(Xt)){var Ar=Math.floor((Bt+90)/X.yOffset),Vr=Math.floor((Xt+180)/X.xOffset),sn="".concat(Ar,"-").concat(Vr);fe[sn]=fe[sn]||{count:0,points:[]},fe[sn].count+=1,fe[sn].points.push(rt)}}}catch(yn){se.e(yn)}finally{se.f()}return{gridHash:fe,gridOffset:X}}(n.dataArray,h);return{yOffset:v,xOffset:v,radius:v,type:"grid",dataArray:function(n,c,i){return Object.keys(n).reduce(function(u,h,v){var w=h.split("-"),I=parseInt(w[0],10),k=parseInt(w[1],10),X={};if(i.field&&i.method){var fe=Ye.a5.getColumn(n[h].points,i.field);X[i.method]=Ye.a5.statMap[i.method](fe)}return Object.assign(X,{_id:v,coordinates:(0,Ye.Z)([c.xOffset*(k+.5)-180,c.yOffset*(I+.5)-90]),rawData:n[h].points,count:n[h].count}),u.push(X),u},[])}(w.gridHash,w.gridOffset,c)}}),Cu("hexagon",function(n,c){var u=c.size,v=c.method,w=void 0===v?"sum":v,I=(void 0===u?10:u)/(2*Math.PI*6378e3)*(256<<20)/2,k=n.dataArray.map(function(Be){var rt=(0,Ye.Z)(Be.coordinates),Bt=(0,ra.Z)(rt,2),Xt=Bt[0],Ar=Bt[1];return A(A({},Be),{},{coordinates:[Xt,Ar]})});return{dataArray:function(){var w,I,k,n=0,c=0,i=1,u=1,h=o,v=p;function X(se){var Bt,Be={},rt=[],Xt=se.length;for(Bt=0;Bt<Xt;++Bt)if(!isNaN(Vr=+h.call(null,Ar=se[Bt],Bt,se))&&!isNaN(sn=+v.call(null,Ar,Bt,se))){var Ar,Vr,sn,yn=Math.round(sn/=k),Mn=Math.round(Vr=Vr/I-(1&yn)/2),Wn=sn-yn;if(3*Math.abs(Wn)>1){var ei=Vr-Mn,ti=Mn+(Vr<Mn?-1:1)/2,Ui=yn+(sn<yn?-1:1),wa=Vr-ti,Ua=sn-Ui;ei*ei+Wn*Wn>wa*wa+Ua*Ua&&(Mn=ti+(1&yn?1:-1)/2,yn=Ui)}var Mi=Mn+"-"+yn,Va=Be[Mi];Va?Va.push(Ar):(rt.push(Va=Be[Mi]=[Ar]),Va.x=(Mn+(1&yn)/2)*I,Va.y=yn*k)}return rt}function fe(se){var Be=0,rt=0;return s.map(function(Bt){var Xt=Math.sin(Bt)*se,Ar=-Math.cos(Bt)*se,Vr=Xt-Be,sn=Ar-rt;return Be=Xt,rt=Ar,[Vr,sn]})}return X.hexagon=function(se){return"m"+fe(null==se?w:+se).join("l")+"z"},X.centers=function(){for(var se=[],Be=Math.round(c/k),rt=Math.round(n/I),Bt=Be*k;Bt<u+w;Bt+=k,++Be)for(var Xt=rt*I+(1&Be)*I/2;Xt<i+I/2;Xt+=I)se.push([Xt,Bt]);return se},X.mesh=function(){var se=fe(w).slice(0,4).join("l");return X.centers().map(function(Be){return"M"+Be+"m"+se}).join("")},X.x=function(se){return arguments.length?(h=se,X):h},X.y=function(se){return arguments.length?(v=se,X):v},X.radius=function(se){return arguments.length?(I=2*(w=+se)*Math.sin(a),k=1.5*w,X):w},X.size=function(se){return arguments.length?(n=c=0,i=+se[0],u=+se[1],X):[i-n,u-c]},X.extent=function(se){return arguments.length?(n=+se[0][0],c=+se[0][1],i=+se[1][0],u=+se[1][1],X):[[n,c],[i,u]]},X.radius(1)}().radius(I).x(function(Be){return Be.coordinates[0]}).y(function(Be){return Be.coordinates[1]})(k).map(function(Be,rt){var Bt;if(c.field&&w){var Xt=Ye.a5.getColumn(Be,c.field);Be[w]=Ye.a5.statMap[w](Xt)}return(0,V.Z)(Bt={},c.method,Be[w]),(0,V.Z)(Bt,"count",Be.length),(0,V.Z)(Bt,"rawData",Be),(0,V.Z)(Bt,"coordinates",[Be.x,Be.y]),(0,V.Z)(Bt,"_id",rt),Bt}),radius:I,xOffset:I,yOffset:I,type:"hexagon"}});var It,Wt,pr,nr,br,Dr,Qr,Xr,dn,qn,Vn,Nn,Li,Dn,pt=y(35296),Ke=y.n(pt),ft=function(){function n(c,i){(0,R.Z)(this,n),(0,V.Z)(this,"attribute",void 0),(0,V.Z)(this,"buffer",void 0);var u=i.buffer,h=i.offset,v=i.stride,w=i.normalized,I=i.size,k=i.divisor;this.buffer=u,this.attribute={buffer:u.get(),offset:h||0,stride:v||0,normalized:w||!1,divisor:k||0},I&&(this.attribute.size=I)}return(0,N.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(i){this.buffer.subData(i)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),gi=((0,V.Z)(It={},W.gl.POINTS,"points"),(0,V.Z)(It,W.gl.LINES,"lines"),(0,V.Z)(It,W.gl.LINE_LOOP,"line loop"),(0,V.Z)(It,W.gl.LINE_STRIP,"line strip"),(0,V.Z)(It,W.gl.TRIANGLES,"triangles"),(0,V.Z)(It,W.gl.TRIANGLE_FAN,"triangle fan"),(0,V.Z)(It,W.gl.TRIANGLE_STRIP,"triangle strip"),It),Vi=((0,V.Z)(Wt={},W.gl.STATIC_DRAW,"static"),(0,V.Z)(Wt,W.gl.DYNAMIC_DRAW,"dynamic"),(0,V.Z)(Wt,W.gl.STREAM_DRAW,"stream"),Wt),li=((0,V.Z)(pr={},W.gl.BYTE,"int8"),(0,V.Z)(pr,W.gl.UNSIGNED_INT,"int16"),(0,V.Z)(pr,W.gl.INT,"int32"),(0,V.Z)(pr,W.gl.UNSIGNED_BYTE,"uint8"),(0,V.Z)(pr,W.gl.UNSIGNED_SHORT,"uint16"),(0,V.Z)(pr,W.gl.UNSIGNED_INT,"uint32"),(0,V.Z)(pr,W.gl.FLOAT,"float"),pr),yi=((0,V.Z)(nr={},W.gl.ALPHA,"alpha"),(0,V.Z)(nr,W.gl.LUMINANCE,"luminance"),(0,V.Z)(nr,W.gl.LUMINANCE_ALPHA,"luminance alpha"),(0,V.Z)(nr,W.gl.RGB,"rgb"),(0,V.Z)(nr,W.gl.RGBA,"rgba"),(0,V.Z)(nr,W.gl.RGBA4,"rgba4"),(0,V.Z)(nr,W.gl.RGB5_A1,"rgb5 a1"),(0,V.Z)(nr,W.gl.RGB565,"rgb565"),(0,V.Z)(nr,W.gl.DEPTH_COMPONENT,"depth"),(0,V.Z)(nr,W.gl.DEPTH_STENCIL,"depth stencil"),nr),Fi=((0,V.Z)(br={},W.gl.DONT_CARE,"dont care"),(0,V.Z)(br,W.gl.NICEST,"nice"),(0,V.Z)(br,W.gl.FASTEST,"fast"),br),te=((0,V.Z)(Dr={},W.gl.NEAREST,"nearest"),(0,V.Z)(Dr,W.gl.LINEAR,"linear"),(0,V.Z)(Dr,W.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,V.Z)(Dr,W.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,V.Z)(Dr,W.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,V.Z)(Dr,W.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Dr),ie=((0,V.Z)(Qr={},W.gl.REPEAT,"repeat"),(0,V.Z)(Qr,W.gl.CLAMP_TO_EDGE,"clamp"),(0,V.Z)(Qr,W.gl.MIRRORED_REPEAT,"mirror"),Qr),F=((0,V.Z)(Xr={},W.gl.NONE,"none"),(0,V.Z)(Xr,W.gl.BROWSER_DEFAULT_WEBGL,"browser"),Xr),U=((0,V.Z)(dn={},W.gl.NEVER,"never"),(0,V.Z)(dn,W.gl.ALWAYS,"always"),(0,V.Z)(dn,W.gl.LESS,"less"),(0,V.Z)(dn,W.gl.LEQUAL,"lequal"),(0,V.Z)(dn,W.gl.GREATER,"greater"),(0,V.Z)(dn,W.gl.GEQUAL,"gequal"),(0,V.Z)(dn,W.gl.EQUAL,"equal"),(0,V.Z)(dn,W.gl.NOTEQUAL,"notequal"),dn),de=((0,V.Z)(qn={},W.gl.FUNC_ADD,"add"),(0,V.Z)(qn,W.gl.MIN_EXT,"min"),(0,V.Z)(qn,W.gl.MAX_EXT,"max"),(0,V.Z)(qn,W.gl.FUNC_SUBTRACT,"subtract"),(0,V.Z)(qn,W.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),qn),Te=((0,V.Z)(Vn={},W.gl.ZERO,"zero"),(0,V.Z)(Vn,W.gl.ONE,"one"),(0,V.Z)(Vn,W.gl.SRC_COLOR,"src color"),(0,V.Z)(Vn,W.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,V.Z)(Vn,W.gl.SRC_ALPHA,"src alpha"),(0,V.Z)(Vn,W.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,V.Z)(Vn,W.gl.DST_COLOR,"dst color"),(0,V.Z)(Vn,W.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,V.Z)(Vn,W.gl.DST_ALPHA,"dst alpha"),(0,V.Z)(Vn,W.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,V.Z)(Vn,W.gl.CONSTANT_COLOR,"constant color"),(0,V.Z)(Vn,W.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,V.Z)(Vn,W.gl.CONSTANT_ALPHA,"constant alpha"),(0,V.Z)(Vn,W.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,V.Z)(Vn,W.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),Vn),mt=((0,V.Z)(Nn={},W.gl.NEVER,"never"),(0,V.Z)(Nn,W.gl.ALWAYS,"always"),(0,V.Z)(Nn,W.gl.LESS,"less"),(0,V.Z)(Nn,W.gl.LEQUAL,"lequal"),(0,V.Z)(Nn,W.gl.GREATER,"greater"),(0,V.Z)(Nn,W.gl.GEQUAL,"gequal"),(0,V.Z)(Nn,W.gl.EQUAL,"equal"),(0,V.Z)(Nn,W.gl.NOTEQUAL,"notequal"),Nn),Nt=((0,V.Z)(Li={},W.gl.ZERO,"zero"),(0,V.Z)(Li,W.gl.KEEP,"keep"),(0,V.Z)(Li,W.gl.REPLACE,"replace"),(0,V.Z)(Li,W.gl.INVERT,"invert"),(0,V.Z)(Li,W.gl.INCR,"increment"),(0,V.Z)(Li,W.gl.DECR,"decrement"),(0,V.Z)(Li,W.gl.INCR_WRAP,"increment wrap"),(0,V.Z)(Li,W.gl.DECR_WRAP,"decrement wrap"),Li),Lt=((0,V.Z)(Dn={},W.gl.FRONT,"front"),(0,V.Z)(Dn,W.gl.BACK,"back"),Dn),lr=function(){function n(c,i){(0,R.Z)(this,n),(0,V.Z)(this,"buffer",void 0),this.buffer=c.buffer({data:i.data,usage:Vi[i.usage||W.gl.STATIC_DRAW],type:li[i.type||W.gl.UNSIGNED_BYTE]})}return(0,N.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(i){this.buffer.subdata(i.data,i.offset)}}]),n}(),jr=function(){function n(c,i){(0,R.Z)(this,n),(0,V.Z)(this,"elements",void 0),this.elements=c.elements({data:i.data,usage:Vi[i.usage||W.gl.STATIC_DRAW],type:li[i.type||W.gl.UNSIGNED_BYTE],count:i.count})}return(0,N.Z)(n,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(i){this.elements.subdata(i.data)}},{key:"destroy",value:function(){}}]),n}(),Ln=function(){function n(c,i){(0,R.Z)(this,n),(0,V.Z)(this,"framebuffer",void 0);var v=i.color,w=i.colors,X={width:i.width,height:i.height};Array.isArray(w)&&(X.colors=w.map(function(fe){return fe.get()})),v&&"boolean"!=typeof v&&(X.color=v.get()),this.framebuffer=c.framebuffer(X)}return(0,N.Z)(n,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(i){this.framebuffer.resize(i.width,i.height)}}]),n}(),Xn=y(85464),ni=y(47679),Ci=y.n(ni),Si=y(82358),ea=y.n(Si);function xa(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function ua(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?xa(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):xa(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var ia,Ha=function(){function n(c,i){(0,R.Z)(this,n),(0,V.Z)(this,"reGl",void 0),(0,V.Z)(this,"destroyed",!1),(0,V.Z)(this,"drawCommand",void 0),(0,V.Z)(this,"drawParams",void 0),(0,V.Z)(this,"options",void 0),(0,V.Z)(this,"uniforms",{}),this.reGl=c;var u=i.vs,h=i.fs,v=i.attributes,w=i.uniforms,I=i.primitive,k=i.count,X=i.elements,fe=i.depth,se=i.blend,Be=i.stencil,rt=i.cull,Bt=i.instances,Xt={};this.options=i,w&&(this.uniforms=this.extractUniforms(w),Object.keys(w).forEach(function(sn){Xt[sn]=c.prop(sn)}));var Ar={};Object.keys(v).forEach(function(sn){Ar[sn]=v[sn].get()});var Vr={attributes:Ar,frag:h,uniforms:Xt,vert:u,primitive:gi[void 0===I?W.gl.TRIANGLES:I]};Bt&&(Vr.instances=Bt),k&&(Vr.count=k),X&&(Vr.elements=X.get()),this.initDepthDrawParams({depth:fe},Vr),this.initBlendDrawParams({blend:se},Vr),this.initStencilDrawParams({stencil:Be},Vr),this.initCullDrawParams({cull:rt},Vr),this.drawCommand=c(Vr),this.drawParams=Vr}return(0,N.Z)(n,[{key:"addUniforms",value:function(i){this.uniforms=ua(ua({},this.uniforms),this.extractUniforms(i))}},{key:"draw",value:function(i){if(!this.drawParams.attributes||0!==Object.keys(this.drawParams.attributes).length){var u=ua(ua({},this.uniforms),this.extractUniforms(i.uniforms||{})),h={};Object.keys(u).forEach(function(v){var w=(0,Xn.Z)(u[v]);h[v]="boolean"===w||"number"===w||Array.isArray(u[v])||u[v].BYTES_PER_ELEMENT?u[v]:u[v].get()}),this.drawCommand(h)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(i){i.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(i,u){var h=i.depth;h&&(u.depth={enable:void 0===h.enable||!!h.enable,mask:void 0===h.mask||!!h.mask,func:U[h.func||W.gl.LESS],range:h.range||[0,1]})}},{key:"initBlendDrawParams",value:function(i,u){var h=i.blend;if(h){var w=h.func,I=h.equation,k=h.color;u.blend={enable:!!h.enable,func:{srcRGB:Te[w&&w.srcRGB||W.gl.SRC_ALPHA],srcAlpha:Te[w&&w.srcAlpha||W.gl.SRC_ALPHA],dstRGB:Te[w&&w.dstRGB||W.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Te[w&&w.dstAlpha||W.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:de[I&&I.rgb||W.gl.FUNC_ADD],alpha:de[I&&I.alpha||W.gl.FUNC_ADD]},color:void 0===k?[0,0,0,0]:k}}}},{key:"initStencilDrawParams",value:function(i,u){var h=i.stencil;if(h){var w=h.mask,k=h.func,X=void 0===k?{cmp:W.gl.ALWAYS,ref:0,mask:-1}:k,fe=h.opFront,se=void 0===fe?{fail:W.gl.KEEP,zfail:W.gl.KEEP,zpass:W.gl.KEEP}:fe,Be=h.opBack,rt=void 0===Be?{fail:W.gl.KEEP,zfail:W.gl.KEEP,zpass:W.gl.KEEP}:Be;u.stencil={enable:!!h.enable,mask:void 0===w?-1:w,func:ua(ua({},X),{},{cmp:mt[X.cmp]}),opFront:{fail:Nt[se.fail],zfail:Nt[se.zfail],zpass:Nt[se.zpass]},opBack:{fail:Nt[rt.fail],zfail:Nt[rt.zfail],zpass:Nt[rt.zpass]}}}}},{key:"initCullDrawParams",value:function(i,u){var h=i.cull;if(h){var w=h.face;u.cull={enable:!!h.enable,face:Lt[void 0===w?W.gl.BACK:w]}}}},{key:"extractUniforms",value:function(i){var u=this,h={};return Object.keys(i).forEach(function(v){u.extractUniformsRecursively(v,i[v],h,"")}),h}},{key:"extractUniformsRecursively",value:function(i,u,h,v){var w=this;null===u||"number"==typeof u||"boolean"==typeof u||Array.isArray(u)&&"number"==typeof u[0]||Ci()(u)||""===u||"resize"in u?h["".concat(v&&v+".").concat(i)]=u:(ea()(u)&&Object.keys(u).forEach(function(I){w.extractUniformsRecursively(I,u[I],h,"".concat(v&&v+".").concat(i))}),Array.isArray(u)&&u.forEach(function(I,k){Object.keys(I).forEach(function(X){w.extractUniformsRecursively(X,I[X],h,"".concat(v&&v+".").concat(i,"[").concat(k,"]"))})}))}}]),n}(),Wa=function(){function n(c,i){(0,R.Z)(this,n),(0,V.Z)(this,"texture",void 0),(0,V.Z)(this,"width",void 0),(0,V.Z)(this,"height",void 0);var u=i.data,h=i.type,v=void 0===h?W.gl.UNSIGNED_BYTE:h,w=i.width,I=i.height,k=i.flipY,X=void 0!==k&&k,fe=i.format,se=void 0===fe?W.gl.RGBA:fe,Be=i.mipmap,rt=void 0!==Be&&Be,Bt=i.wrapS,Xt=void 0===Bt?W.gl.CLAMP_TO_EDGE:Bt,Ar=i.wrapT,Vr=void 0===Ar?W.gl.CLAMP_TO_EDGE:Ar,sn=i.aniso,yn=void 0===sn?0:sn,Mn=i.alignment,Wn=void 0===Mn?1:Mn,ei=i.premultiplyAlpha,ti=void 0!==ei&&ei,Ui=i.mag,wa=void 0===Ui?W.gl.NEAREST:Ui,Ua=i.min,Mi=void 0===Ua?W.gl.NEAREST:Ua,Va=i.colorSpace,po=void 0===Va?W.gl.BROWSER_DEFAULT_WEBGL:Va;this.width=w,this.height=I;var Ru={width:w,height:I,type:li[v],format:yi[se],wrapS:ie[Xt],wrapT:ie[Vr],mag:te[wa],min:te[Mi],alignment:Wn,flipY:X,colorSpace:F[po],premultiplyAlpha:ti,aniso:yn};u&&(Ru.data=u),"number"==typeof rt?Ru.mipmap=Fi[rt]:"boolean"==typeof rt&&(Ru.mipmap=rt),this.texture=c.texture(Ru)}return(0,N.Z)(n,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.texture(i)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(i){var u=i.width,h=i.height;this.texture.resize(u,h),this.width=u,this.height=h}},{key:"destroy",value:function(){this.texture.destroy()}}]),n}(),ga=(0,va.b2)()(ia=function(){function n(){var c=this;(0,R.Z)(this,n),(0,V.Z)(this,"extensionObject",void 0),(0,V.Z)(this,"gl",void 0),(0,V.Z)(this,"$container",void 0),(0,V.Z)(this,"canvas",void 0),(0,V.Z)(this,"width",void 0),(0,V.Z)(this,"height",void 0),(0,V.Z)(this,"isDirty",void 0),(0,V.Z)(this,"createModel",function(i){return new Ha(c.gl,i)}),(0,V.Z)(this,"createAttribute",function(i){return new ft(c.gl,i)}),(0,V.Z)(this,"createBuffer",function(i){return new lr(c.gl,i)}),(0,V.Z)(this,"createElements",function(i){return new jr(c.gl,i)}),(0,V.Z)(this,"createTexture2D",function(i){return new Wa(c.gl,i)}),(0,V.Z)(this,"createFramebuffer",function(i){return new Ln(c.gl,i)}),(0,V.Z)(this,"useFramebuffer",function(i,u){c.gl({framebuffer:i?i.get():null})(u)}),(0,V.Z)(this,"clear",function(i){var w=i.framebuffer,I=void 0===w?null:w,k={color:i.color,depth:i.depth,stencil:i.stencil};k.framebuffer=null===I?I:I.get(),c.gl.clear(k)}),(0,V.Z)(this,"viewport",function(i){var v=i.width,w=i.height;c.gl._gl.viewport(i.x,i.y,v,w),c.width=v,c.height=w,c.gl._refresh()}),(0,V.Z)(this,"readPixels",function(i){var u=i.framebuffer,k={x:i.x,y:i.y,width:i.width,height:i.height};return u&&(k.framebuffer=u.get()),c.gl.read(k)}),(0,V.Z)(this,"getViewportSize",function(){return{width:c.gl._gl.drawingBufferWidth,height:c.gl._gl.drawingBufferHeight}}),(0,V.Z)(this,"getContainer",function(){var i;return null===(i=c.canvas)||void 0===i?void 0:i.parentElement}),(0,V.Z)(this,"getCanvas",function(){return c.canvas}),(0,V.Z)(this,"getGLContext",function(){return c.gl._gl}),(0,V.Z)(this,"destroy",function(){c.gl.destroy()})}return(0,N.Z)(n,[{key:"init",value:(c=(0,Jt.Z)(mr().mark(function u(h,v){var w=this;return mr().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return this.canvas=h,k.next=3,new Promise(function(X,fe){Ke()({canvas:w.canvas,attributes:{alpha:!0,antialias:v.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:v.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(Be,rt){(Be||!rt)&&fe(Be),X(rt)}})});case 3:this.gl=k.sent,this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 5:case"end":return k.stop()}},u,this)})),function(u,h){return c.apply(this,arguments)})},{key:"testExtension",value:function(i){return!!this.getGLContext().getExtension(i)}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var i=this.getGLContext();i.disable(i.CULL_FACE)}},{key:"setDirty",value:function(i){this.isDirty=i}},{key:"getDirty",value:function(){return this.isDirty}}]),n;var c}())||ia;function la(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function no(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?la(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):la(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var go,Yl,uu,Ko,Su,Ys,Cf,Xf,ll,qc,$h,ki=function(){function n(c){(0,R.Z)(this,n),(0,V.Z)(this,"sceneService",void 0),(0,V.Z)(this,"mapService",void 0),(0,V.Z)(this,"controlService",void 0),(0,V.Z)(this,"layerService",void 0),(0,V.Z)(this,"iconService",void 0),(0,V.Z)(this,"markerService",void 0),(0,V.Z)(this,"popupService",void 0),(0,V.Z)(this,"fontService",void 0),(0,V.Z)(this,"interactionService",void 0),(0,V.Z)(this,"container",void 0);var i=c.id,u=c.map,h=(0,W.Hp)();this.container=h,u.setContainer(h,i),h.bind(W.vK.IRendererService).to(ga).inSingletonScope(),this.sceneService=h.get(W.vK.ISceneService),this.mapService=h.get(W.vK.IMapService),this.iconService=h.get(W.vK.IIconService),this.fontService=h.get(W.vK.IFontService),this.controlService=h.get(W.vK.IControlService),this.layerService=h.get(W.vK.ILayerService),this.markerService=h.get(W.vK.IMarkerService),this.interactionService=h.get(W.vK.IInteractionService),this.popupService=h.get(W.vK.IPopupService),this.initComponent(i),this.sceneService.init(c),this.initControl()}return(0,N.Z)(n,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(i){return this.sceneService.exportPng(i)}},{key:"exportMap",value:function(i){return this.sceneService.exportPng(i)}},{key:"registerRenderService",value:function(i){var u=this;this.sceneService.loaded?new i(this).init():this.on("loaded",function(){new i(u).init()})}},{key:"map",get:function(){return this.mapService.map}},{key:"setBgColor",value:function(i){this.mapService.setBgColor(i)}},{key:"addLayer",value:function(i){var u=(0,W.e7)(this.container);i.setContainer(u),this.sceneService.addLayer(i)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(i){return this.layerService.getLayer(i)}},{key:"getLayerByName",value:function(i){return this.layerService.getLayerByName(i)}},{key:"removeLayer",value:function(i){this.layerService.remove(i)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addIconFont",value:function(i,u){this.fontService.addIconFont(i,u)}},{key:"addIconFonts",value:function(i){var u=this;i.forEach(function(h){var v=(0,ra.Z)(h,2);u.fontService.addIconFont(v[0],v[1])})}},{key:"addFontFace",value:function(i,u){this.sceneService.addFontFace(i,u)}},{key:"addImage",value:function(i,u){this.iconService.addImage(i,u)}},{key:"hasImage",value:function(i){return this.iconService.hasImage(i)}},{key:"removeImage",value:function(i){this.iconService.removeImage(i)}},{key:"addIconFontGlyphs",value:function(i,u){this.fontService.addIconGlyphs(u)}},{key:"addControl",value:function(i){this.controlService.addControl(i,this.container)}},{key:"removeControl",value:function(i){this.controlService.removeControl(i)}},{key:"getControlByName",value:function(i){return this.controlService.getControlByName(i)}},{key:"addMarker",value:function(i){this.markerService.addMarker(i)}},{key:"addMarkerLayer",value:function(i){this.markerService.addMarkerLayer(i)}},{key:"removeMarkerLayer",value:function(i){this.markerService.removeMarkerLayer(i)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(i){this.popupService.addPopup(i)}},{key:"on",value:function(i,u){-1===W.SceneEventList.indexOf(i)?this.mapService.on(i,u):this.sceneService.on(i,u)}},{key:"once",value:function(i,u){-1===W.SceneEventList.indexOf(i)?this.mapService.once(i,u):this.sceneService.once(i,u)}},{key:"off",value:function(i,u){-1===W.SceneEventList.indexOf(i)?this.mapService.off(i,u):this.sceneService.off(i,u)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(i){return this.mapService.getCenter(i)}},{key:"setCenter",value:function(i,u){return this.mapService.setCenter(i,u)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(i){return this.mapService.setPitch(i)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(i){this.mapService.setRotation(i)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(i){this.mapService.panTo(i)}},{key:"panBy",value:function(i,u){this.mapService.panBy(i,u)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(i){this.mapService.setZoom(i)}},{key:"fitBounds",value:function(i,u){var h=this.sceneService.getSceneConfig(),w=h.animate;this.mapService.fitBounds(i,u||no(no({},h.fitBoundsOptions),{},{animate:w}))}},{key:"setZoomAndCenter",value:function(i,u){this.mapService.setZoomAndCenter(i,u)}},{key:"setMapStyle",value:function(i){this.mapService.setMapStyle(i)}},{key:"setMapStatus",value:function(i){this.mapService.setMapStatus(i)}},{key:"pixelToLngLat",value:function(i){return this.mapService.pixelToLngLat(i)}},{key:"lngLatToPixel",value:function(i){return this.mapService.lngLatToPixel(i)}},{key:"containerToLngLat",value:function(i){return this.mapService.containerToLngLat(i)}},{key:"lngLatToContainer",value:function(i){return this.mapService.lngLatToContainer(i)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(i,u){this.container.bind(W.vK.IPostProcessingPass).to(i).whenTargetNamed(u)}},{key:"initComponent",value:function(i){this.controlService.init({container:Ye.SO.getContainer(i)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var i=this.sceneService.getSceneConfig();i.logoVisible&&this.addControl(new Pt({position:i.logoPosition}))}}]),n}(),Ca=y(53867),ba=y.n(Ca),ul=(go=(0,va.b2)(),Yl=(0,va.f3)(W.vK.IGlobalConfigService),go((Ko=function(){function n(){(0,R.Z)(this,n),(0,Y.Z)(this,"configService",Su,this),(0,V.Z)(this,"enabled",void 0)}return(0,N.Z)(n,[{key:"apply",value:function(i,u){var h=this,w=u.postProcessingPassFactory,I=u.normalPassFactory;i.hooks.init.tap("MultiPassRendererPlugin",function(){var k=i.getLayerConfig(),fe=k.passes,se=void 0===fe?[]:fe;h.enabled=!!k.enableMultiPassRenderer&&!1!==i.getLayerConfig().enableMultiPassRenderer,h.enabled&&(i.multiPassRenderer=h.createMultiPassRenderer(i,se,w,I),i.multiPassRenderer.setRenderFlag(!0))}),i.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(i,u,h,v){var w=i.multiPassRenderer;return i.getLayerConfig().enablePicking&&w.add(v("pixelPicking")),w}}]),n}(),Su=(0,Ge.Z)(Ko.prototype,"configService",[Yl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu=Ko))||uu),Kl=((0,V.Z)(Ys={},W.BlendType.additive,{enable:!0,func:{srcRGB:W.gl.ONE,dstRGB:W.gl.ONE,srcAlpha:1,dstAlpha:1}}),(0,V.Z)(Ys,W.BlendType.none,{enable:!1}),(0,V.Z)(Ys,W.BlendType.normal,{enable:!0,func:{srcRGB:W.gl.SRC_ALPHA,dstRGB:W.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,V.Z)(Ys,W.BlendType.subtractive,{enable:!0,func:{srcRGB:W.gl.ONE,dstRGB:W.gl.ONE,srcAlpha:W.gl.ZERO,dstAlpha:W.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:W.gl.FUNC_SUBTRACT,alpha:W.gl.FUNC_SUBTRACT}}),(0,V.Z)(Ys,W.BlendType.max,{enable:!0,func:{srcRGB:W.gl.ONE,dstRGB:W.gl.ONE},equation:{rgb:W.gl.MAX_EXT}}),(0,V.Z)(Ys,W.BlendType.min,{enable:!0,func:{srcRGB:W.gl.ONE,dstRGB:W.gl.ONE},equation:{rgb:W.gl.MIN_EXT}}),Ys),Wu=y(80167),ca=y.n(Wu),Hf=y(81690),Tl=y.n(Hf);function Ks(n,c,i,u,h){c.updateStyleAttribute(n,i,u,h)}function Dc(n,c,i){In()(i)?Ks(n,c,i,function(u){return u}):ca()(i)?Ks(n,c,[i],void 0):Tl()(i)&&2===i.length&&(In()(i[0])&&wo()(i[1])||In()(i[0])&&Tl()(i[1])&&ca()(i[1][0])&&ca()(i[1][1]))?Ks(n,c,i[0],i[1]):Ks(n,c,[1],void 0)}function hc(n,c,i){In()(i)?Ks(n,c,i,function(u){return u}):Tl()(i)&&2===i.length&&In()(i[0])&&wo()(i[1])?Ks(n,c,i[0],i[1]):Tl()(i)&&2===i.length&&ca()(i[0])&&ca()(i[1])?Ks(n,c,i,void 0):Ks(n,c,[0,0],void 0)}function Qh(n,c){(null==c||c>n.length)&&(c=n.length);for(var i=0,u=new Array(c);i<c;i++)u[i]=n[i];return u}function ep(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function qs(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?ep(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):ep(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var wh,Af,$c,Nc,pf,tp=0,Jc=(Cf=(0,W.yT)(W.vK.IGlobalConfigService),Xf=(0,W.yT)(W.vK.IShaderModuleService),ll=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,R.Z)(this,i),u=c.call(this),(0,V.Z)((0,H.Z)(u),"id","".concat(tp++)),(0,V.Z)((0,H.Z)(u),"name","".concat(tp)),(0,V.Z)((0,H.Z)(u),"type",void 0),(0,V.Z)((0,H.Z)(u),"visible",!0),(0,V.Z)((0,H.Z)(u),"zIndex",0),(0,V.Z)((0,H.Z)(u),"minZoom",void 0),(0,V.Z)((0,H.Z)(u),"maxZoom",void 0),(0,V.Z)((0,H.Z)(u),"inited",!1),(0,V.Z)((0,H.Z)(u),"layerModelNeedUpdate",!1),(0,V.Z)((0,H.Z)(u),"pickedFeatureID",null),(0,V.Z)((0,H.Z)(u),"selectedFeatureID",null),(0,V.Z)((0,H.Z)(u),"styleNeedUpdate",!1),(0,V.Z)((0,H.Z)(u),"rendering",void 0),(0,V.Z)((0,H.Z)(u),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,V.Z)((0,H.Z)(u),"hooks",{init:new fo.oI,afterInit:new fo.oI,beforeRender:new fo.oI,beforeRenderData:new fo.gg,afterRender:new fo.ni,beforePickingEncode:new fo.ni,afterPickingEncode:new fo.ni,beforeHighlight:new fo.ni(["pickedColor"]),afterHighlight:new fo.ni,beforeSelect:new fo.ni(["pickedColor"]),afterSelect:new fo.ni,beforeDestroy:new fo.ni,afterDestroy:new fo.ni}),(0,V.Z)((0,H.Z)(u),"models",[]),(0,V.Z)((0,H.Z)(u),"multiPassRenderer",void 0),(0,V.Z)((0,H.Z)(u),"plugins",void 0),(0,V.Z)((0,H.Z)(u),"sourceOption",void 0),(0,V.Z)((0,H.Z)(u),"layerModel",void 0),(0,Y.Z)((0,H.Z)(u),"configService",qc,(0,H.Z)(u)),(0,Y.Z)((0,H.Z)(u),"shaderModuleService",$h,(0,H.Z)(u)),(0,V.Z)((0,H.Z)(u),"cameraService",void 0),(0,V.Z)((0,H.Z)(u),"coordinateService",void 0),(0,V.Z)((0,H.Z)(u),"iconService",void 0),(0,V.Z)((0,H.Z)(u),"fontService",void 0),(0,V.Z)((0,H.Z)(u),"pickingService",void 0),(0,V.Z)((0,H.Z)(u),"rendererService",void 0),(0,V.Z)((0,H.Z)(u),"layerService",void 0),(0,V.Z)((0,H.Z)(u),"interactionService",void 0),(0,V.Z)((0,H.Z)(u),"mapService",void 0),(0,V.Z)((0,H.Z)(u),"styleAttributeService",void 0),(0,V.Z)((0,H.Z)(u),"layerSource",void 0),(0,V.Z)((0,H.Z)(u),"postProcessingPassFactory",void 0),(0,V.Z)((0,H.Z)(u),"normalPassFactory",void 0),(0,V.Z)((0,H.Z)(u),"animateOptions",{enable:!1}),(0,V.Z)((0,H.Z)(u),"container",void 0),(0,V.Z)((0,H.Z)(u),"encodedData",void 0),(0,V.Z)((0,H.Z)(u),"configSchema",void 0),(0,V.Z)((0,H.Z)(u),"currentPickId",null),(0,V.Z)((0,H.Z)(u),"rawConfig",void 0),(0,V.Z)((0,H.Z)(u),"needUpdateConfig",void 0),(0,V.Z)((0,H.Z)(u),"pendingStyleAttributes",[]),(0,V.Z)((0,H.Z)(u),"scaleOptions",{}),(0,V.Z)((0,H.Z)(u),"animateStartTime",void 0),(0,V.Z)((0,H.Z)(u),"aniamateStatus",!1),(0,V.Z)((0,H.Z)(u),"sourceEvent",function(){u.dataState.dataSourceNeedUpdate=!0;var v=u.getLayerConfig();v.autoFit&&u.fitBounds(v.fitBoundsOptions),u.emit("dataUpdate"),u.reRender()}),u.name=h.name||u.id,u.zIndex=h.zIndex||0,u.rawConfig=h,u}return(0,N.Z)(i,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(h){if(this.inited){var v=this.container.get(W.vK.SceneID);(function(n,c){n.opacity&&Dc("opacity",c,n.opacity),n.strokeWidth&&Dc("strokeWidth",c,n.strokeWidth),n.strokeOpacity&&Dc("strokeOpacity",c,n.strokeOpacity),n.stroke&&function(n,c,i){In()(i)?Ks(n,c,i,void 0):Tl()(i)&&2===i.length&&(In()(i[0])&&wo()(i[1])||In()(i[0])&&Tl()(i[1])&&i[1].length>0)?Ks(n,c,i[0],i[1]):Ks(n,c,"#fff",void 0)}("stroke",c,n.stroke),n.offsets&&hc("offsets",c,n.offsets),n.textOffset&&hc("textOffset",c,n.textOffset)})(h,this),this.configService.setLayerConfig(v,this.id,qs(qs(qs({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),h)),this.needUpdateConfig={}}else this.needUpdateConfig=qs(qs({},this.needUpdateConfig),h)}},{key:"setContainer",value:function(h){this.container=h}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(h){return this.plugins.push(h),this}},{key:"init",value:function(){var h=this,v=this.container.get(W.vK.SceneID),w=this.rawConfig.enableMultiPassRenderer;this.configService.setLayerConfig(v,this.id,{enableMultiPassRenderer:void 0!==w&&w}),this.iconService=this.container.get(W.vK.IIconService),this.fontService=this.container.get(W.vK.IFontService),this.rendererService=this.container.get(W.vK.IRendererService),this.layerService=this.container.get(W.vK.ILayerService),this.interactionService=this.container.get(W.vK.IInteractionService),this.pickingService=this.container.get(W.vK.IPickingService),this.mapService=this.container.get(W.vK.IMapService),this.cameraService=this.container.get(W.vK.ICameraService),this.coordinateService=this.container.get(W.vK.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(W.vK.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(W.vK.IFactoryNormalPass),this.styleAttributeService=this.container.get(W.vK.IStyleAttributeService),this.multiPassRenderer=this.container.get(W.vK.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(se){var Be=se.attributeName,Xt=se.updateOptions;h.styleAttributeService.updateStyleAttribute(Be,{scale:qs({field:se.attributeField},h.splitValuesAndCallbackInAttribute(se.attributeValues,h.getLayerConfig()[Be]))},Xt)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(W.vK.ILayerPlugin);var X,k=function(n,c){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,c){if(n){if("string"==typeof n)return Qh(n,c);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Qh(n,c)}}(n))||c&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}(this.plugins);try{for(k.s();!(X=k.n()).done;)X.value.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(se){k.e(se)}finally{k.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(qs(qs({},this.getDefaultConfig()),this.rawConfig));var v=this.getLayerConfig().animateOption;null!=v&&v.enable&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(h,v,w){return this.updateStyleAttribute("color",h,v,w),this}},{key:"texture",value:function(h,v,w){return this.updateStyleAttribute("texture",h,v,w),this}},{key:"rotate",value:function(h,v,w){return this.updateStyleAttribute("rotate",h,v,w),this}},{key:"size",value:function(h,v,w){return this.updateStyleAttribute("size",h,v,w),this}},{key:"filter",value:function(h,v,w){return this.updateStyleAttribute("filter",h,v,w),this}},{key:"shape",value:function(h,v,w){return this.updateStyleAttribute("shape",h,v,w),this}},{key:"label",value:function(h,v,w){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:h,attributeValues:v,updateOptions:w}),this}},{key:"animate",value:function(h){var v={};return ba()(h)?(v.enable=!0,v=qs(qs({},v),h)):v.enable=h,this.updateLayerConfig({animateOption:v}),this}},{key:"source",value:function(h,v){return null!=h&&h.data?(this.setSource(h),this):(this.sourceOption={data:h,options:v},this)}},{key:"setData",value:function(h,v){var w=this;return this.inited?this.layerSource.setData(h,v):this.on("inited",function(){w.layerSource.setData(h,v)}),this}},{key:"style",value:function(h){var v=this,w=h.passes,I=(0,Mt.Z)(h,["passes"]);return w&&function(n){return n.map(function(c){return"string"==typeof c&&(c=[c,{}]),c})}(w).forEach(function(k){var X=v.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(k[0]);X&&X.updateOptions(k[1])}),this.rawConfig=qs(qs({},this.rawConfig),I),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(h,v){return ba()(h)?this.scaleOptions=qs(qs({},this.scaleOptions),h):this.scaleOptions[h]=v,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return 0!==this.getEncodedData().length&&this.renderModels(),this}},{key:"active",value:function(h){var v={};return v.enableHighlight=!!ba()(h)||h,ba()(h)?(v.enableHighlight=!0,h.color&&(v.highlightColor=h.color)):v.enableHighlight=!!h,this.updateLayerConfig(v),this}},{key:"setActive",value:function(h,v){var w=this;if(ba()(h)){var I=h.x,k=void 0===I?0:I,X=h.y,fe=void 0===X?0:X;this.updateLayerConfig({highlightColor:ba()(v)?v.color:this.getLayerConfig().highlightColor}),this.pick({x:k,y:fe})}else this.updateLayerConfig({pickedFeatureID:h,highlightColor:ba()(v)?v.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call((0,Ye.Z6)(h)).then(function(){setTimeout(function(){w.reRender()},1)})}},{key:"select",value:function(h){var v={};return v.enableSelect=!!ba()(h)||h,ba()(h)?(v.enableSelect=!0,h.color&&(v.selectColor=h.color)):v.enableSelect=!!h,this.updateLayerConfig(v),this}},{key:"setSelect",value:function(h,v){var w=this;if(ba()(h)){var I=h.x,k=void 0===I?0:I,X=h.y,fe=void 0===X?0:X;this.updateLayerConfig({selectColor:ba()(v)?v.color:this.getLayerConfig().selectColor}),this.pick({x:k,y:fe})}else this.updateLayerConfig({pickedFeatureID:h,selectColor:ba()(v)?v.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call((0,Ye.Z6)(h)).then(function(){setTimeout(function(){w.reRender()},1)})}},{key:"setBlend",value:function(h){this.updateLayerConfig({blend:h}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(h){return this.zIndex=h,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(h){this.currentPickId=h}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(h){this.selectedFeatureID=h}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var h=this.mapService.getZoom(),v=this.getLayerConfig(),I=v.minZoom,X=v.maxZoom;return!!v.visible&&h>=(void 0===I?-1/0:I)&&h<=(void 0===X?1/0:X)}},{key:"setMinZoom",value:function(h){return this.updateLayerConfig({minZoom:h}),this}},{key:"getMinZoom",value:function(){return this.getLayerConfig().minZoom}},{key:"getMaxZoom",value:function(){return this.getLayerConfig().maxZoom}},{key:"get",value:function(h){return this.getLayerConfig()[h]}},{key:"setMaxZoom",value:function(h){return this.updateLayerConfig({maxZoom:h}),this}},{key:"fitBounds",value:function(h){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var w=this.getSource().extent;return w.some(function(k){return Math.abs(k)===1/0})||this.mapService.fitBounds([[w[0],w[1]],[w[2],w[3]]],h),this}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(h){return h.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(h){return h.needRescale||h.needRemapping||h.needRegenerateVertices}).length}},{key:"setSource",value:function(h){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=h,this.inited&&this.layerSource.cluster){var v=this.mapService.getZoom();this.layerSource.updateClusterData(v)}this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(h){this.encodedData=h}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getLegendItems",value:function(h){var v=this.styleAttributeService.getLayerAttributeScale(h);return v?v.ticks?v.ticks().map(function(k){return(0,V.Z)({value:k},h,v(k))}):v.invertExtent?v.range().map(function(k){return(0,V.Z)({value:v.invertExtent(k)},h,k)}):void 0:[]}},{key:"pick",value:function(h){this.interactionService.triggerHover({x:h.x,y:h.y})}},{key:"boxSelect",value:function(h,v){this.pickingService.boxPickLayer(this,h,v)}},{key:"buildLayerModel",value:function(h){var v=h.moduleName,w=h.vertexShader,I=h.fragmentShader,k=h.triangulation,X=h.segmentNumber,fe=(0,Mt.Z)(h,["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber"]);this.shaderModuleService.registerModule(v,{vs:w,fs:I});var se=this.shaderModuleService.getModule(v),Be=se.vs,rt=se.fs,Bt=se.uniforms,Xt=this.rendererService.createModel,Ar=this.styleAttributeService.createAttributesAndIndices(this.encodedData,k,X);return Xt(qs({attributes:Ar.attributes,uniforms:Bt,fs:rt,vs:Be,elements:Ar.elements,blend:Kl[W.BlendType.normal]},fe))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(h){var v=this.getLayerConfig(),w=v.enableHighlight,I=void 0===w||w,k=v.enableSelect,X=void 0===k||k,fe=-1!==this.eventNames().indexOf(h)||-1!==this.eventNames().indexOf("un"+h);return("click"===h||"dblclick"===h)&&X&&(fe=!0),"mousemove"===h&&(I||-1!==this.eventNames().indexOf("mouseenter")||-1!==this.eventNames().indexOf("unmousemove")||-1!==this.eventNames().indexOf("mouseout"))&&(fe=!0),this.isVisible()&&fe}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var h=this;return this.getEncodedData().length>0&&(this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(v){v.draw({uniforms:h.layerModel.getUninforms()})})),this}},{key:"updateStyleAttribute",value:function(h,v,w,I){this.inited?this.styleAttributeService.updateStyleAttribute(h,{scale:qs({field:v},this.splitValuesAndCallbackInAttribute(w,this.getLayerConfig()[v]))},I):this.pendingStyleAttributes.push({attributeName:h,attributeField:v,attributeValues:w,updateOptions:I})}},{key:"setEarthTime",value:function(h){console.warn("empty fn")}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(h,v){return{values:wo()(h)?void 0:h||v,callback:wo()(h)?h:void 0}}}]),i}(_t.EventEmitter),qc=(0,Ge.Z)(ll.prototype,"configService",[Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=(0,Ge.Z)(ll.prototype,"shaderModuleService",[Xf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ll),Tp=y(49977),Eo=y.n(Tp),pc=y(27859);function df(n,c){(null==c||c>n.length)&&(c=n.length);for(var i=0,u=new Array(c);i<c;i++)u[i]=n[i];return u}var Iu=(wh=(0,W.yT)(W.vK.IGlobalConfigService),Af=(0,W.yT)(W.vK.IShaderModuleService),$c=function(){function n(c){(0,R.Z)(this,n),(0,V.Z)(this,"triangulation",void 0),(0,V.Z)(this,"createTexture2D",void 0),(0,V.Z)(this,"layer",void 0),(0,V.Z)(this,"dataTexture",void 0),(0,V.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,V.Z)(this,"rowCount",void 0),(0,V.Z)(this,"cacheStyleProperties",void 0),(0,V.Z)(this,"cellLength",void 0),(0,V.Z)(this,"cellProperties",void 0),(0,V.Z)(this,"cellTypeLayout",void 0),(0,V.Z)(this,"stylePropertyesExist",void 0),(0,V.Z)(this,"dataTextureTest",void 0),(0,Y.Z)(this,"configService",Nc,this),(0,Y.Z)(this,"shaderModuleService",pf,this),(0,V.Z)(this,"rendererService",void 0),(0,V.Z)(this,"iconService",void 0),(0,V.Z)(this,"fontService",void 0),(0,V.Z)(this,"styleAttributeService",void 0),(0,V.Z)(this,"mapService",void 0),(0,V.Z)(this,"cameraService",void 0),(0,V.Z)(this,"layerService",void 0),this.layer=c,this.rendererService=c.getContainer().get(W.vK.IRendererService),this.styleAttributeService=c.getContainer().get(W.vK.IStyleAttributeService),this.mapService=c.getContainer().get(W.vK.IMapService),this.iconService=c.getContainer().get(W.vK.IIconService),this.fontService=c.getContainer().get(W.vK.IFontService),this.cameraService=c.getContainer().get(W.vK.ICameraService),this.layerService=c.getContainer().get(W.vK.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate(),this.createTexture2D=this.rendererService.createTexture2D,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertyesExist={hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new ImageData(1,1).data,mag:W.gl.NEAREST,min:W.gl.NEAREST,width:1,height:1}))}return(0,N.Z)(n,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertyesExist={hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertyesExist.hasOpacity,this.stylePropertyesExist.hasStrokeOpacity,this.stylePropertyesExist.hasStrokeWidth,this.stylePropertyesExist.hasStroke,this.stylePropertyesExist.hasOffsets,0,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(i){var u=!1;return Eo()(i.opacity,this.cacheStyleProperties.opacity)||(u=!0,this.cacheStyleProperties.opacity=i.opacity),Eo()(i.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(u=!0,this.cacheStyleProperties.strokeOpacity=i.strokeOpacity),Eo()(i.strokeWidth,this.cacheStyleProperties.strokeWidth)||(u=!0,this.cacheStyleProperties.strokeWidth=i.strokeWidth),Eo()(i.stroke,this.cacheStyleProperties.stroke)||(u=!0,this.cacheStyleProperties.stroke=i.stroke),Eo()(i.offsets,this.cacheStyleProperties.offsets)||(u=!0,this.cacheStyleProperties.offsets=i.offsets),void 0===this.dataTexture&&(u=!0),u}},{key:"judgeStyleAttributes",value:function(i){this.clearLastCalRes(),void 0!==i.opacity&&!ca()(i.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertyesExist.hasOpacity=1,this.cellLength+=1),void 0!==i.strokeOpacity&&!ca()(i.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertyesExist.hasStrokeOpacity=1,this.cellLength+=1),void 0!==i.strokeWidth&&!ca()(i.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertyesExist.hasStrokeWidth=1,this.cellLength+=1),void 0!==i.stroke&&!this.isStaticColor(i.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertyesExist.hasStroke=1,this.cellLength+=4),void 0!==i.offsets&&!this.isOffsetStatic(i.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertyesExist.hasOffsets=1,this.cellLength+=2)}},{key:"isStaticColor",value:function(i){return!!In()(i)&&!!(0,pc.ZP)(i)}},{key:"getStrokeColor",value:function(i){if(this.isStaticColor(i)){var u=(0,Ye.CI)(i);return u[0]=u[0]?u[0]:0,u[1]=u[1]?u[1]:0,u[2]=u[2]?u[2]:0,u[3]=u[3]?u[3]:0,u}return[0,0,0,0]}},{key:"isOffsetStatic",value:function(i){return!!(Tl()(i)&&2===i.length&&ca()(i[0])&&ca()(i[1]))}},{key:"patchMod",value:function(i,u){for(var h=0;h<u;h++)i.push(-1)}},{key:"patchData",value:function(i,u,h){var w,v=function(n,c){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,c){if(n){if("string"==typeof n)return df(n,c);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return df(n,c)}}(n))||c&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}(h);try{for(v.s();!(w=v.n()).done;){var I=w.value,k=I.attr,X=I.count,fe=u[k];fe?"stroke"===k?i.push.apply(i,(0,Ta.Z)((0,Ye.CI)(fe))):"offsets"===k?this.isOffsetStatic(fe)?i.push(-fe[0],fe[1]):i.push(0,0):i.push(ca()(fe)?fe:1):this.patchMod(i,X)}}catch(se){v.e(se)}finally{v.f()}}},{key:"calDataFrame",value:function(i,u,h){for(var v=u.length,w=Math.ceil(v*i/this.DATA_TEXTURE_WIDTH),I=w*this.DATA_TEXTURE_WIDTH,k=[],X=0;X<v;X++)this.patchData(k,u[X],h);for(var se=k.length;se<I;se++)k.push(-1);return{data:k,width:this.DATA_TEXTURE_WIDTH,height:w}}},{key:"getBlend",value:function(){var u=this.layer.getLayerConfig().blend;return Kl[W.BlendType[void 0===u?"normal":u]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.duration||4,i.interval||.2,i.trailLength||.1]}},{key:"startModelAnimate",value:function(){this.layer.getLayerConfig().animateOption.enable&&this.layer.setAnimateStartTime()}}]),n}(),Nc=(0,Ge.Z)($c.prototype,"configService",[wh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pf=(0,Ge.Z)($c.prototype,"shaderModuleService",[Af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$c),Yf=y(41604),Cl=y.n(Yf);function Mf(n){return n/180*Math.acos(-1)}function Qc(n){var c=Mf(n[0])+Math.PI/2,i=Mf(n[1]),u=100+.4*Math.random(),h=u*Math.cos(i)*Math.cos(c);return[u*Math.cos(i)*Math.sin(c),u*Math.sin(i),h]}var Fs=aa(),_s=(aa(),aa()),ql=aa(),mf=aa();function ef(n,c,i,u,h){return Na(n,i,u),Lo(n,n),[h/es(c=Ma(-n[1],n[0]),Ma(-i[1],i[0])),c]}function Js(n,c){return function(n,c,i){return n[0]=c,n[1]=i,n}(n,-c[1],c[0])}function Of(n,c,i){return g(n,c,i),Lo(n,n),n}function qf(n,c){return n[0]===c[0]&&n[1]===c[1]}var rp=function(){function n(){var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,R.Z)(this,n),(0,V.Z)(this,"complex",void 0),(0,V.Z)(this,"join",void 0),(0,V.Z)(this,"cap",void 0),(0,V.Z)(this,"miterLimit",void 0),(0,V.Z)(this,"thickness",void 0),(0,V.Z)(this,"normal",void 0),(0,V.Z)(this,"lastFlip",-1),(0,V.Z)(this,"miter",Ma(0,0)),(0,V.Z)(this,"started",!1),(0,V.Z)(this,"dash",!1),(0,V.Z)(this,"totalDistance",0),this.join=c.join||"miter",this.cap=c.cap||"butt",this.miterLimit=c.miterLimit||10,this.thickness=c.thickness||1,this.dash=c.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return(0,N.Z)(n,[{key:"extrude_gaode2",value:function(i,u){var h=this.complex;if(i.length<=1)return h;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var v=i.length,w=h.startIndex,I=1;I<v;I++)w+=this.segment_gaode2(h,w,i[I-1],i[I],I<i.length-1?i[I+1]:null,u[I-1],u[I],I<u.length-1?u[I+1]:null);if(this.dash)for(var Xt=0;Xt<h.positions.length/6;Xt++)h.positions[6*Xt+5]=this.totalDistance;return h.startIndex=h.positions.length/6,h}},{key:"extrude",value:function(i){var u=this.complex;if(i.length<=1)return u;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=i.length,v=u.startIndex,w=1;w<h;w++)v+=this.segment(u,v,i[w-1],i[w],w<i.length-1?i[w+1]:null);if(this.dash)for(var se=0;se<u.positions.length/6;se++)u.positions[6*se+5]=this.totalDistance;return u.startIndex=u.positions.length/6,u}},{key:"segment_gaode2",value:function(i,u,h,v,w,I,k,X){var fe=0,se=i.indices,Be=i.positions,rt=i.normals,Bt="square"===this.cap,Xt="bevel"===this.join,Ar=(0,Ye.Z)([k[0],k[1]]),Vr=(0,Ye.Z)([I[0],I[1]]);Of(_s,v,h);var sn=0;if(this.dash&&(sn=this.lineSegmentDistance(Ar,Vr),this.totalDistance+=sn),this.normal||(this.normal=aa(),Js(this.normal,_s)),!this.started)if(this.started=!0,Bt){var yn=aa(),Mn=aa();Na(yn,this.normal,_s),Na(Mn,this.normal,_s),rt.push(Mn[0],Mn[1],0),rt.push(yn[0],yn[1],0),Be.push(h[0],h[1],0,this.totalDistance-sn,-this.thickness,0),Be.push(h[0],h[1],0,this.totalDistance-sn,this.thickness,0)}else this.extrusions(Be,rt,h,this.normal,this.thickness,this.totalDistance-sn);if(se.push(u+0,u+1,u+2),w){qf(v,w)&&Na(w,v,Lo(w,Ee(w,v,h))),Of(ql,w,v);var ti=ef(mf,aa(),_s,ql,this.thickness),Ui=(0,ra.Z)(ti,2),wa=Ui[0],Ua=Ui[1],Mi=es(mf,this.normal)<0?-1:1,Va=Xt;Va||"miter"!==this.join||wa>this.miterLimit&&(Va=!0),Va?(rt.push(this.normal[0],this.normal[1],0),rt.push(Ua[0],Ua[1],0),Be.push(v[0],v[1],0,this.totalDistance,-this.thickness*Mi,0),Be.push(v[0],v[1],0,this.totalDistance,this.thickness*Mi,0),se.push.apply(se,(0,Ta.Z)(this.lastFlip!==-Mi?[u,u+2,u+3]:[u+2,u+1,u+3])),se.push(u+2,u+3,u+4),Js(Fs,ql),Ya(this.normal,Fs),rt.push(this.normal[0],this.normal[1],0),Be.push(v[0],v[1],0,this.totalDistance,-this.thickness*Mi,0),fe+=3):(this.extrusions(Be,rt,v,Ua,wa,this.totalDistance),se.push.apply(se,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),Mi=-1,Ya(this.normal,Ua),fe+=2),this.lastFlip=Mi}else{if(Js(this.normal,_s),Bt){var Wn=aa(),ei=aa();g(ei,_s,this.normal),Na(Wn,_s,this.normal),rt.push(ei[0],ei[1],0),rt.push(Wn[0],Wn[1],0),Be.push(v[0],v[1],0,this.totalDistance,this.thickness,0),Be.push(v[0],v[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Be,rt,v,this.normal,this.thickness,this.totalDistance);se.push.apply(se,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),fe+=2}return fe}},{key:"segment",value:function(i,u,h,v,w){var I=0,k=i.indices,X=i.positions,fe=i.normals,se="square"===this.cap,Be="bevel"===this.join,rt=(0,Ye.Z)([v[0],v[1]]),Bt=(0,Ye.Z)([h[0],h[1]]);Of(_s,rt,Bt);var Xt=0;if(this.dash&&(Xt=this.lineSegmentDistance(rt,Bt),this.totalDistance+=Xt),this.normal||(this.normal=aa(),Js(this.normal,_s)),!this.started)if(this.started=!0,se){var Ar=aa(),Vr=aa();Na(Ar,this.normal,_s),Na(Vr,this.normal,_s),fe.push(Vr[0],Vr[1],0),fe.push(Ar[0],Ar[1],0),X.push(h[0],h[1],0,this.totalDistance-Xt,-this.thickness,0),X.push(h[0],h[1],0,this.totalDistance-Xt,this.thickness,0)}else this.extrusions(X,fe,h,this.normal,this.thickness,this.totalDistance-Xt);if(k.push(u+0,u+1,u+2),w){var Mn=(0,Ye.Z)([w[0],w[1]]);qf(rt,Mn)&&Na(Mn,rt,Lo(Mn,Ee(Mn,rt,Bt))),Of(ql,Mn,rt);var Wn=ef(mf,aa(),_s,ql,this.thickness),ei=(0,ra.Z)(Wn,2),ti=ei[0],Ui=ei[1],wa=es(mf,this.normal)<0?-1:1,Ua=Be;Ua||"miter"!==this.join||ti>this.miterLimit&&(Ua=!0),Ua?(fe.push(this.normal[0],this.normal[1],0),fe.push(Ui[0],Ui[1],0),X.push(v[0],v[1],0,this.totalDistance,-this.thickness*wa,0),X.push(v[0],v[1],0,this.totalDistance,this.thickness*wa,0),k.push.apply(k,(0,Ta.Z)(this.lastFlip!==-wa?[u,u+2,u+3]:[u+2,u+1,u+3])),k.push(u+2,u+3,u+4),Js(Fs,ql),Ya(this.normal,Fs),fe.push(this.normal[0],this.normal[1],0),X.push(v[0],v[1],0,this.totalDistance,-this.thickness*wa,0),I+=3):(this.extrusions(X,fe,v,Ui,ti,this.totalDistance),k.push.apply(k,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),wa=-1,Ya(this.normal,Ui),I+=2),this.lastFlip=wa}else{if(Js(this.normal,_s),se){var sn=aa(),yn=aa();g(yn,_s,this.normal),Na(sn,_s,this.normal),fe.push(yn[0],yn[1],0),fe.push(sn[0],sn[1],0),X.push(v[0],v[1],0,this.totalDistance,this.thickness,0),X.push(v[0],v[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(X,fe,v,this.normal,this.thickness,this.totalDistance);k.push.apply(k,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),I+=2}return I}},{key:"extrusions",value:function(i,u,h,v,w,I){u.push(v[0],v[1],0),u.push(v[0],v[1],0),i.push(h[0],h[1],0,I,-w,0),i.push(h[0],h[1],0,I,w,0)}},{key:"lineSegmentDistance",value:function(i,u){var h=u[0]-i[0],v=u[1]-i[1];return Math.sqrt(h*h+v*v)}}]),n}();function tf(n){if(ca()(n[0]))return n;if(ca()(n[0][0]))throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8");if(ca()(n[0][0][0])){var i=0,u=0,h=0;return n.forEach(function(v){v.forEach(function(w){i+=w[0],u+=w[1],h++})}),[i/h,u/h,0]}throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8")}function Th(n){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n[0][0],u=n[0][n[0].length-1];i[0]===u[0]&&i[1]===u[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var h=n[0].length,v=Cl().flatten(n),w=v.vertices,I=v.dimensions,k=[],X=[],fe=[],se=0;se<w.length/I;se++)2===I?k.push(w[2*se],w[2*se+1],1,-1,-1):k.push(w[3*se],w[3*se+1],1,-1,-1),fe.push(0,0,1);var Be=Cl()(v.vertices,v.holes,v.dimensions);X.push.apply(X,(0,Ta.Z)(Be));for(var rt=function(Ar){var Vr=v.vertices.slice(Ar*I,(Ar+1)*I),sn=v.vertices.slice((Ar+1)*I,(Ar+2)*I);0===sn.length&&(sn=v.vertices.slice(0,I));var yn=k.length/5;k.push(Vr[0],Vr[1],1,0,0,sn[0],sn[1],1,.1,0,Vr[0],Vr[1],0,0,.8,sn[0],sn[1],0,.1,.8);var Mn=Jf([sn[0],sn[1],1],[Vr[0],Vr[1],0],[Vr[0],Vr[1],1],c);fe.push.apply(fe,(0,Ta.Z)(Mn).concat((0,Ta.Z)(Mn),(0,Ta.Z)(Mn),(0,Ta.Z)(Mn))),X.push.apply(X,(0,Ta.Z)([1,2,0,3,2,1].map(function(Wn){return Wn+yn})))},Bt=0;Bt<h;Bt++)rt(Bt);return{positions:k,index:X,normals:fe}}function Jf(n,c,i){var u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],h=sr(),v=sr(),w=sr();u&&(n=(0,Ye.vP)(n),c=(0,Ye.vP)(c),i=(0,Ye.vP)(i));var I=On.apply(M,(0,Ta.Z)(n)),k=On.apply(M,(0,Ta.Z)(c)),X=On.apply(M,(0,Ta.Z)(i));Ia(h,X,k),Ia(v,I,k),Br(w,h,v);var fe=sr();return Kt(fe,w),fe}var lu,Ps=(()=>(function(n){n.CYLINDER="cylinder",n.SQUARECOLUMN="squareColumn",n.TRIANGLECOLUMN="triangleColumn",n.HEXAGONCOLUMN="hexagonColumn",n.PENTAGONCOLUMN="pentagonColumn"}(Ps||(Ps={})),Ps))(),Fc=(()=>(function(n){n.CIRCLE="circle",n.SQUARE="square",n.TRIANGLE="triangle",n.HEXAGON="hexagon",n.PENTAGON="pentagon"}(Fc||(Fc={})),Fc))();function Mu(n){for(var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=2*Math.PI/n,u=[],h=0;h<n;h++)u.push(i*h+c*Math.PI/12);var v=u.map(function(w){return[Math.sin(w+Math.PI/4),Math.cos(w+Math.PI/4),0]});return v}function Ch(){return Mu(30)}function Al(){return Mu(4)}function Jl(){return Mu(3)}function Ah(){return Mu(6,1)}function $f(){return Mu(5)}var yf=((0,V.Z)(lu={},Fc.CIRCLE,Ch),(0,V.Z)(lu,Fc.HEXAGON,Ah),(0,V.Z)(lu,Fc.TRIANGLE,Jl),(0,V.Z)(lu,Fc.SQUARE,Al),(0,V.Z)(lu,Fc.PENTAGON,$f),(0,V.Z)(lu,Ps.CYLINDER,Ch),(0,V.Z)(lu,Ps.HEXAGONCOLUMN,Ah),(0,V.Z)(lu,Ps.TRIANGLECOLUMN,Jl),(0,V.Z)(lu,Ps.SQUARECOLUMN,Al),(0,V.Z)(lu,Ps.PENTAGONCOLUMN,$f),lu),Lf={};function as(n){var c=tf(n.coordinates);return{vertices:[].concat((0,Ta.Z)(c),(0,Ta.Z)(c),(0,Ta.Z)(c),(0,Ta.Z)(c)),indices:[0,1,2,2,3,0],size:c.length}}function Zo(n){var i=Qc(tf(n.coordinates));return{vertices:[].concat((0,Ta.Z)(i),(0,Ta.Z)(i),(0,Ta.Z)(i),(0,Ta.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function os(n){var i=function(n){var c=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Lf&&Lf[n])return Lf[n];var u=Th([yf[n]?yf[n]():yf.cylinder()],c);return Lf[n]=u,u}(n.shape,!1);return{vertices:i.positions,indices:i.index,normals:i.normals,size:5}}function cu(n){var c=tf(n.coordinates);return{vertices:(0,Ta.Z)(c),indices:[0],size:c.length}}function Ph(n){var c=n.coordinates,i=n.originCoordinates,u=n.version,h=new rp({dash:!0,join:"bevel"});if("GAODE2.x"===u){var v=c;Array.isArray(v[0][0])||(v=[c]);var w=i;Array.isArray(w[0][0])||(w=[i]);for(var I=0;I<v.length;I++)h.extrude_gaode2(v[I],w[I])}else{var fe=c;Array.isArray(fe[0][0])||(fe=[c]),fe.forEach(function(Be){h.extrude(Be)})}var se=h.complex;return{vertices:se.positions,indices:se.indices,normals:se.normals,size:6}}function Ap(n){var c=n.coordinates,i=Cl().flatten(c),u=i.vertices,h=i.dimensions,v=i.holes;return{indices:Cl()(u,v,h),vertices:u,size:h}}function np(n){var i=Th(n.coordinates,!0);return{vertices:i.positions,indices:i.index,normals:i.normals,size:5}}var q=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),c.apply(this,arguments)}return(0,N.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,w=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var I=this.layer.getEncodedData(),k=this.calDataFrame(this.cellLength,I,this.cellProperties),X=k.data,fe=k.width,se=k.height;this.rowCount=se,this.dataTexture=this.createTexture2D(this.cellLength>0&&X.length>0?{flipY:!0,data:X,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:fe,height:se}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:'precision highp float;\n\n#define pi 3.1415926535\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec3 a_Position;\nattribute vec3 a_Pos;\nattribute vec4 a_Color;\nattribute vec3 a_Size;\nattribute vec3 a_Normal;\n\nuniform float u_globel;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if(x > 0.0 && z > 0.0) {\n    return atan(x/z);\n  } else if(x > 0.0 && z <= 0.0){\n    return atan(-z/x) + pi/2.0;\n  } else if(x <= 0.0 && z <= 0.0) {\n    return  pi + atan(x/z); //atan(x/z) + \n  } else {\n    return atan(z/-x) + pi*3.0/2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y/r);\n}\n\nvoid main() {\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  vec3 size = a_Size * a_Position;\n\n  vec2 offset = project_pixel(size.xy);\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n\n  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);\n\n  float lightWeight = calc_lighting(pos);\n  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  // gl_Position = project_common_position_to_clipspace(pos);\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * pos;\n  } else {\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  \n  if(u_globel > 0.0) {\n    // \u5728\u5730\u7403\u6a21\u5f0f\u4e0b\uff0c\u5c06\u539f\u672c\u5782\u76f4\u4e8e xy \u5e73\u9762\u7684\u5706\u67f1\u8c03\u6574\u59ff\u6001\u5230\u9002\u5e94\u5706\u7684\u89d2\u5ea6\n    //\u65cb\u8f6c\u77e9\u9635mx\uff0c\u521b\u5efa\u7ed5x\u8f74\u65cb\u8f6c\u77e9\u9635\n    float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);\n    float xRadian = getXRadian(a_Pos.y, r);\n    float xcos = cos(xRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u4f59\u5f26\u503c\n    float xsin = sin(xRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u6b63\u5f26\u503c\n    mat4 mx = mat4(\n      1,0,0,0,  \n      0,xcos,-xsin,0,  \n      0,xsin,xcos,0,  \n      0,0,0,1);\n\n    //\u65cb\u8f6c\u77e9\u9635my\uff0c\u521b\u5efa\u7ed5y\u8f74\u65cb\u8f6c\u77e9\u9635\n    float yRadian = getYRadian(a_Pos.x, a_Pos.z);\n    float ycos = cos(yRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u4f59\u5f26\u503c\n    float ysin = sin(yRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u6b63\u5f26\u503c\n    mat4 my = mat4(\n      ycos,0,-ysin,0,  \n      0,1,0,0,  \n      ysin,0,ycos,0,  \n      0,0,0,1);\n\n    gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'varying vec4 v_color;\nuniform float u_opacity: 1.0;\n\n#pragma include "picking"\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:os,blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h="GLOBEL"===this.mapService.version;this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(w,I,k,X){var fe=w.size;if(fe){var se=[];return Array.isArray(fe)&&(se=2===fe.length?[fe[0],fe[0],fe[1]]:fe),Array.isArray(fe)||(se=[fe,fe,fe]),se}return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:W.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(w,I,k,X,fe){return fe}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:W.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(w,I){var k=tf(w.coordinates);return h?Qc([k[0],k[1]]):[k[0],k[1],0]}}})}}]),i}(Iu);var ur=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),c.apply(this,arguments)}return(0,N.Z)(i,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=void 0===v?1:v,I=h.strokeOpacity,k=void 0===I?1:I,X=h.strokeWidth,fe=void 0===X?0:X,se=h.stroke,Be=void 0===se?"rgba(0,0,0,0)":se,rt=h.offsets,Bt=void 0===rt?[0,0]:rt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w,strokeOpacity:k,strokeWidth:fe,stroke:Be,offsets:Bt})){this.judgeStyleAttributes({opacity:w,strokeOpacity:k,strokeWidth:fe,stroke:Be,offsets:Bt});var Xt=this.layer.getEncodedData(),Ar=this.calDataFrame(this.cellLength,Xt,this.cellProperties),Vr=Ar.data,sn=Ar.width,yn=Ar.height;this.rowCount=yn,this.dataTexture=this.createTexture2D(this.cellLength>0&&Vr.length>0?{flipY:!0,data:Vr,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:sn,height:yn}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1,u_stroke_opacity:ca()(k)?k:1,u_stroke_width:ca()(fe)?fe:0,u_stroke_color:this.getStrokeColor(Be),u_offsets:this.isOffsetStatic(Bt)?Bt:[0,0]}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig();return{u_aimate:this.animateOption2Array(h.animateOption),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),as)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h="GLOBEL"===this.mapService.version;return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Extrude;\nattribute float a_Size;\nattribute float a_Shape;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\nuniform float u_globel;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\nuniform float u_opacity : 1;\nuniform float u_stroke_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\nuniform vec2 u_offsets;\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  float newSize = setPickingSize(a_Size);\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = strokeOpacityAndOffset.r;\n  textureOffset = strokeOpacityAndOffset.g;\n\n  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n\n  // unpack color(vec2)\n  v_color = a_Color;\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  // TODO: billboard\n  // anti-alias\n  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);\n\n  // construct point coords\n  // TODP: /abs(extrude.x) \u662f\u4e3a\u4e86\u517c\u5bb9\u5730\u7403\u6a21\u5f0f\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n  // vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);\n  vec2 offset = project_pixel(extrude.xy * (newSize + u_stroke_width) + textrueOffsets);\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n  }\n\n  if(u_globel > 0.0) {\n    gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);\n  }\n \n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:"#define Animate 0.0\n\nuniform float u_globel;\nuniform float u_blur : 0;\n// uniform float u_stroke_width : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n \n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  float opacity = styleMappingMat[0][0];\n  float stroke_opacity = styleMappingMat[0][1];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;\n\n  lowp float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  // float r = v_radius / (v_radius + u_stroke_width);\n  float r = v_radius / (v_radius + strokeWidth);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  if(u_globel > 0.0) {\n    // TODO: \u5730\u7403\u6a21\u5f0f\u4e0b\u907f\u514d\u591a\u4f59\u7247\u5143\u7ed8\u5236\uff0c\u540c\u65f6\u4e5f\u80fd\u907f\u514d\u6709\u7528\u7247\u5143\u5728\u900f\u660e\u4e14\u91cd\u53e0\u7684\u60c5\u51b5\u4e0b\u65e0\u6cd5\u5199\u5165\n    // \u4ed8\u51fa\u7684\u4ee3\u4ef7\u662f\u8fb9\u7f18\u4f1a\u6709\u4e00\u4e9b\u952f\u9f7f\n    if(outer_df > antialiased_blur + 0.018) discard;\n  }\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n  \n \n  // float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n  //   antialiased_blur,\n  //   0.0,\n  //   inner_df\n  // );\n   float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);\n\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n  if(u_aimate.x == Animate) {\n    float d = length(v_data.xy);\n    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);\n    gl_FragColor = vec4(gl_FragColor.xyz, intensity);\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n\n  \n\n}\n",triangulation:h?Zo:as,depth:{enable:h},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"animateOption2Array",value:function(h){return[h.enable?0:1,h.speed||1,h.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var h=this,v="GLOBEL"===this.mapService.version;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:W.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(I,k,X,fe){var se;if(v){var Be=(0,ra.Z)(X,3),rt=Be[0],Bt=Be[1],Xt=Be[2],Ar=On(0,0,1),Vr=On(rt,0,Xt),sn=rt>=0?oi(Ar,Vr):2*Math.PI-oi(Ar,Vr),yn=2*Math.PI-Math.asin(Bt/100),Mn=Yt.create();Yt.rotateY(Mn,Mn,sn),Yt.rotateX(Mn,Mn,yn);var Wn=On(1,1,0);an(Wn,Wn,Mn),Kt(Wn,Wn);var ei=On(-1,1,0);an(ei,ei,Mn),Kt(ei,ei);var ti=On(-1,-1,0);an(ti,ti,Mn),Kt(ti,ti);var Ui=On(1,-1,0);an(Ui,Ui,Mn),Kt(Ui,Ui),se=[].concat((0,Ta.Z)(Wn),(0,Ta.Z)(ei),(0,Ta.Z)(ti),(0,Ta.Z)(Ui))}else se=[1,1,0,-1,1,0,-1,-1,0,1,-1,0];var wa=fe%4*3;return[se[wa],se[wa+1],se[wa+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(I,k,X,fe){var se=I.size,Be=void 0===se?5:se;return Array.isArray(Be)?[Be[0]]:[Be]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:W.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(I,k,X,fe){var se=I.shape,Be=void 0===se?2:se;return[h.layer.getLayerConfig().shape2d.indexOf(Be)]}}})}}]),i}(Iu);var qr=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=c.call.apply(c,[this].concat(v)),(0,V.Z)((0,H.Z)(u),"texture",void 0),u}return(0,N.Z)(i,[{key:"getUninforms",value:function(){return{u_opacity:this.layer.getLayerConfig().opacity||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var h=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){h.updateTexture(),h.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_stroke_width : 1;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  //  vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n\n  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);\n    } else {\n      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n    }\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor=texture2D(u_texture,pos);\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n      // gl_FragColor.a =gl_FragColor.a * u_opacity;\n      gl_FragColor.a =gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:cu,primitive:W.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(w,I,k,X){var fe=w.size;return Array.isArray(fe)?[fe[0]]:[fe]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:W.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(w,I,k,X){var rt=h.fontService.mapping[h.fontService.getGlyph(w.shape)];return[rt.x,rt.y]}}})}},{key:"updateTexture",value:function(){var v=this.fontService.canvas;this.texture=(0,this.rendererService.createTexture2D)({data:v,mag:W.gl.LINEAR,min:W.gl.LINEAR,width:v.width,height:v.height})}},{key:"initIconFontGlyphs",value:function(){var h=this,v=this.layer.getLayerConfig(),w=v.fontWeight,I=void 0===w?"normal":w,k=v.fontFamily,X=void 0===k?"sans-serif":k,fe=this.layer.getEncodedData(),se=[];fe.forEach(function(Be){var rt=Be.shape,Bt=void 0===rt?"":rt;Bt=Bt.toString();var Xt=h.fontService.getGlyph(Bt);-1===se.indexOf(Xt)&&se.push(Xt)}),this.fontService.setFontOptions({characterSet:se,fontWeight:I,fontFamily:X,fontSize:48})}}]),i}(Iu);var Vt=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=c.call.apply(c,[this].concat(v)),(0,V.Z)((0,H.Z)(u),"texture",void 0),(0,V.Z)((0,H.Z)(u),"updateTexture",function(){var I=u.rendererService.createTexture2D;if(u.texture)return u.texture.update({data:u.iconService.getCanvas()}),void u.layer.renderLayers();u.texture=I({data:u.iconService.getCanvas(),mag:W.gl.LINEAR,min:W.gl.LINEAR,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})}),u}return(0,N.Z)(i,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=h.offsets,I=void 0===w?[0,0]:w;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:I})){this.judgeStyleAttributes({opacity:v,offsets:I});var k=this.layer.getEncodedData(),X=this.calDataFrame(this.cellLength,k,this.cellProperties),fe=X.data,se=X.width,Be=X.height;this.rowCount=Be,this.dataTexture=this.createTexture2D(this.cellLength>0&&fe.length>0?{flipY:!0,data:fe,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:se,height:Be}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:ca()(v)?v:1,u_offsets:this.isOffsetStatic(I)?I:[0,0]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,v;null===(h=this.texture)||void 0===h||h.destroy(),null===(v=this.dataTexture)||void 0===v||v.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_stroke_width : 1;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  //  vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n\n  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);\n    } else {\n      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n    }\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor=texture2D(u_texture,pos);\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n      // gl_FragColor.a =gl_FragColor.a * u_opacity;\n      gl_FragColor.a =gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:cu,primitive:W.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(w,I,k,X){var fe=w.size,se=void 0===fe?5:fe;return Array.isArray(se)?[se[0]]:[se]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:W.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(w,I,k,X){var Be=h.iconService.getIconMap()[w.shape]||{x:0,y:0};return[Be.x,Be.y]}}})}}]),i}(Iu);function wn(n){var c=n.coordinates;return{vertices:(0,Ta.Z)(c),indices:[0],size:c.length}}var rn=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),c.apply(this,arguments)}return(0,N.Z)(i,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=void 0===v?1:v,I=h.offsets,k=void 0===I?[0,0]:I;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w,offsets:k})){this.judgeStyleAttributes({opacity:w,offsets:k});var X=this.layer.getEncodedData(),fe=this.calDataFrame(this.cellLength,X,this.cellProperties),se=fe.data,Be=fe.width,rt=fe.height;this.rowCount=rt,this.dataTexture=this.createTexture2D(this.cellLength>0&&se.length>0?{flipY:!0,data:se,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:Be,height:rt}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1,u_offsets:this.isOffsetStatic(k)?k:[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:'\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute float a_Size;\nattribute vec4 a_Color;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "project"\nvoid main() {\n  v_color = a_Color;\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n  \n  // vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\\n  // \n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // vec2 offset = project_pixel((u_offsets));\n    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);\n  } else { // else\n    // vec2 offset = project_pixel(u_offsets);\n    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\n  }\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\nvarying vec4 v_color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n\n  gl_FragColor = v_color;\n  // gl_FragColor.a =gl_FragColor.a * u_opacity;\n  gl_FragColor.a =gl_FragColor.a * opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:wn,depth:{enable:!1},primitive:W.gl.POINTS,blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(v,w,I,k){var X=v.size,fe=void 0===X?1:X;return Array.isArray(fe)?[fe[0]]:[fe]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:W.BlendType.additive}}}]),i}(Iu);function Er(n,c){(null==c||c>n.length)&&(c=n.length);for(var i=0,u=new Array(c);i<c;i++)u[i]=n[i];return u}const vn=function(){function n(c,i,u){(0,R.Z)(this,n),(0,V.Z)(this,"boxCells",[]),(0,V.Z)(this,"xCellCount",void 0),(0,V.Z)(this,"yCellCount",void 0),(0,V.Z)(this,"boxKeys",void 0),(0,V.Z)(this,"bboxes",void 0),(0,V.Z)(this,"width",void 0),(0,V.Z)(this,"height",void 0),(0,V.Z)(this,"xScale",void 0),(0,V.Z)(this,"yScale",void 0),(0,V.Z)(this,"boxUid",void 0);var h=this.boxCells;this.xCellCount=Math.ceil(c/u),this.yCellCount=Math.ceil(i/u);for(var v=0;v<this.xCellCount*this.yCellCount;v++)h.push([]);this.boxKeys=[],this.bboxes=[],this.width=c,this.height=i,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/i,this.boxUid=0}return(0,N.Z)(n,[{key:"insert",value:function(i,u,h,v,w){this.forEachCell(u,h,v,w,this.insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(w)}},{key:"query",value:function(i,u,h,v,w){return this.queryHitTest(i,u,h,v,!1,w)}},{key:"hitTest",value:function(i,u,h,v,w){return this.queryHitTest(i,u,h,v,!0,w)}},{key:"insertBoxCell",value:function(i,u,h,v,w,I){this.boxCells[w].push(I)}},{key:"queryHitTest",value:function(i,u,h,v,w,I){if(h<0||i>this.width||v<0||u>this.height)return!w&&[];var k=[];if(i<=0&&u<=0&&this.width<=h&&this.height<=v){if(w)return!0;for(var X=0;X<this.boxKeys.length;X++)k.push({key:this.boxKeys[X],x1:this.bboxes[4*X],y1:this.bboxes[4*X+1],x2:this.bboxes[4*X+2],y2:this.bboxes[4*X+3]});return I?k.filter(I):k}return this.forEachCell(i,u,h,v,this.queryCell,k,{hitTest:w,seenUids:{box:{},circle:{}}},I),w?k.length>0:k}},{key:"queryCell",value:function(i,u,h,v,w,I,k,X){var fe=k.seenUids,se=this.boxCells[w];if(null!==se){var Bt,Be=this.bboxes,rt=function(n,c){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,c){if(n){if("string"==typeof n)return Er(n,c);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Er(n,c)}}(n))||c&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}(se);try{for(rt.s();!(Bt=rt.n()).done;){var Xt=Bt.value;if(!fe.box[Xt]){fe.box[Xt]=!0;var Ar=4*Xt;if(i<=Be[Ar+2]&&u<=Be[Ar+3]&&h>=Be[Ar+0]&&v>=Be[Ar+1]&&(!X||X(this.boxKeys[Xt]))){if(k.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[Xt],x1:Be[Ar],y1:Be[Ar+1],x2:Be[Ar+2],y2:Be[Ar+3]})}}}}catch(Vr){rt.e(Vr)}finally{rt.f()}}return!1}},{key:"forEachCell",value:function(i,u,h,v,w,I,k,X){for(var fe=this.convertToXCellCoord(i),se=this.convertToYCellCoord(u),Be=this.convertToXCellCoord(h),rt=this.convertToYCellCoord(v),Bt=fe;Bt<=Be;Bt++)for(var Xt=se;Xt<=rt;Xt++)if(w.call(this,i,u,h,v,this.xCellCount*Xt+Bt,I,k,X))return}},{key:"convertToXCellCoord",value:function(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}},{key:"convertToYCellCoord",value:function(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}}]),n}();var Jr=function(){function n(c,i){(0,R.Z)(this,n),(0,V.Z)(this,"width",void 0),(0,V.Z)(this,"height",void 0),(0,V.Z)(this,"grid",void 0),(0,V.Z)(this,"viewportPadding",100),(0,V.Z)(this,"screenRightBoundary",void 0),(0,V.Z)(this,"screenBottomBoundary",void 0),(0,V.Z)(this,"gridRightBoundary",void 0),(0,V.Z)(this,"gridBottomBoundary",void 0),this.width=c,this.height=i,this.viewportPadding=Math.max(c,i),this.grid=new vn(c+this.viewportPadding,i+this.viewportPadding,25),this.screenRightBoundary=c+this.viewportPadding,this.screenBottomBoundary=i+this.viewportPadding,this.gridRightBoundary=c+2*this.viewportPadding,this.gridBottomBoundary=i+2*this.viewportPadding}return(0,N.Z)(n,[{key:"placeCollisionBox",value:function(i){var u=i.x1+i.anchorPointX+this.viewportPadding,h=i.y1+i.anchorPointY+this.viewportPadding,v=i.x2+i.anchorPointX+this.viewportPadding,w=i.y2+i.anchorPointY+this.viewportPadding;return!this.isInsideGrid(u,h,v,w)||this.grid.hitTest(u,h,v,w)?{box:[]}:{box:[u,h,v,w]}}},{key:"insertCollisionBox",value:function(i,u){this.grid.insert({featureIndex:u},i[0],i[1],i[2],i[3])}},{key:"project",value:function(i,u,h){var v=bo.al(u,h,0,1),w=bo.Ue(),I=Yt.fromValues.apply(Yt,(0,Ta.Z)(i));return bo.fF(w,v,I),{x:(w[0]/w[3]+1)/2*this.width+this.viewportPadding,y:(-w[1]/w[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(i,u,h,v){return h>=0&&i<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}}]),n}();function xn(n,c){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,c){if(n){if("string"==typeof n)return zi(n,c);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return zi(n,c)}}(n))||c&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}function zi(n,c){(null==c||c>n.length)&&(c=n.length);for(var i=0,u=new Array(c);i<c;i++)u[i]=n[i];return u}function Ii(n){var c=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0;break;default:c=.5}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0;break;default:i=.5}return{horizontalAlign:c,verticalAlign:i}}function Cn(n,c,i,u,h){if(h){var v=n[u],w=v.glyph;if(w)for(var k=(n[u].x+c[w].advance*v.scale)*h,X=i;X<=u;X++)n[X].x-=k}}function Tn(n,c,i,u,h,v,w){var fe,I=(c-i)*h,k=(-u*w+.5)*v,X=xn(n);try{for(X.s();!(fe=X.n()).done;){var se=fe.value;se.x+=I,se.y+=k}}catch(Be){X.e(Be)}finally{X.f()}}function _i(n,c,i,u,h,v,w){var k=0,X=-8,fe=0,se=n.positionedGlyphs,Be="right"===v?1:"left"===v?0:.5,rt=se.length;i.forEach(function(sn){sn.split("").forEach(function(Mn){var Wn=c[Mn];Wn&&(se.push({glyph:Mn,x:k,y:X+0,vertical:!1,scale:1,metrics:Wn}),k+=Wn.advance+w)}),se.length!==rt&&(fe=Math.max(k-w,fe),Cn(se,c,rt,se.length-1,Be)),k=0,X+=u});var Bt=Ii(h),Xt=Bt.horizontalAlign,Ar=Bt.verticalAlign;Tn(se,Be,Xt,Ar,fe,u,i.length);var Vr=X- -8;n.top+=-Ar*Vr,n.bottom=n.top+Vr,n.left+=-Xt*fe,n.right=n.left+fe}function Zi(n,c,i,u,h,v,w){var k=0,X=-8,fe=0,se=n.positionedGlyphs,Be="right"===v?1:"left"===v?0:.5,rt=se.length;i.forEach(function(sn){var yn=c[sn];yn&&(se.push({glyph:sn,x:k,y:X+0,vertical:!1,scale:1,metrics:yn}),k+=yn.advance+w),se.length!==rt&&(fe=Math.max(k-w,fe),Cn(se,c,rt,se.length-1,Be)),k=0,X+=u});var Bt=Ii(h),Xt=Bt.horizontalAlign,Ar=Bt.verticalAlign;Tn(se,Be,Xt,Ar,fe,u,i.length);var Vr=X- -8;n.top+=-Ar*Vr,n.bottom=n.top+Vr,n.left+=-Xt*fe,n.right=n.left+fe}function ds(n,c){(null==c||c>n.length)&&(c=n.length);for(var i=0,u=new Array(c);i<c;i++)u[i]=n[i];return u}var Uo='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\nuniform sampler2D u_sdf_map;\nuniform float u_gamma_scale : 0.5;\n// uniform float u_font_size : 24.0;\nuniform float u_opacity : 1.0;\nuniform vec4 u_stroke_color : [0, 0, 0, 1];\nuniform float u_stroke_width : 2.0;\nuniform float u_halo_blur : 0.5;\nuniform float u_DevicePixelRatio;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main() {\n  // get style data mapping\n  float opacity = styleMappingMat[0][0];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  // get sdf from atlas\n  float dist = texture2D(u_sdf_map, v_uv).a;\n\n  // float fontScale = u_font_size / FONT_SIZE;\n\n  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;\n  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor.a= gl_FragColor.a * alpha;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',ss='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\nattribute vec3 a_Position;\nattribute vec2 a_tex;\nattribute vec2 a_textOffsets;\nattribute vec4 a_Color;\nattribute float a_Size;\nattribute float a_Rotate;\n\nuniform vec2 u_sdf_map_size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying vec4 v_color;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\nuniform float u_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n  \n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  v_color = a_Color;\n  v_uv = a_tex / u_sdf_map_size;\n\n  // \u6587\u672c\u7f29\u653e\u6bd4\u4f8b\n  float fontScale = a_Size / FONT_SIZE;\n  v_fontScale = fontScale;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  highp float angle_sin = sin(a_Rotate);\n  highp float angle_cos = cos(a_Rotate);\n  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n  \n  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n\n  vec4 projected_position;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));\n  } else { // else\n   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n';function ms(n){var c=this,i=n.id,u=[],h=[];if(!c.glyphInfoMap||!c.glyphInfoMap[i])return{vertices:[],indices:[],size:7};var v=c.glyphInfoMap[i].centroid,w=2===v.length?[v[0],v[1],0]:v;return c.glyphInfoMap[i].glyphQuads.forEach(function(I,k){u.push.apply(u,(0,Ta.Z)(w).concat([I.tex.x,I.tex.y+I.tex.height,I.tl.x,I.tl.y],(0,Ta.Z)(w),[I.tex.x+I.tex.width,I.tex.y+I.tex.height,I.tr.x,I.tr.y],(0,Ta.Z)(w),[I.tex.x+I.tex.width,I.tex.y,I.br.x,I.br.y],(0,Ta.Z)(w),[I.tex.x,I.tex.y,I.bl.x,I.bl.y])),h.push(0+4*k,1+4*k,2+4*k,2+4*k,3+4*k,0+4*k)}),{vertices:u,indices:h,size:7}}var us=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=c.call.apply(c,[this].concat(v)),(0,V.Z)((0,H.Z)(u),"glyphInfo",void 0),(0,V.Z)((0,H.Z)(u),"glyphInfoMap",{}),(0,V.Z)((0,H.Z)(u),"texture",void 0),(0,V.Z)((0,H.Z)(u),"currentZoom",-1),(0,V.Z)((0,H.Z)(u),"extent",void 0),(0,V.Z)((0,H.Z)(u),"textureHeight",0),(0,V.Z)((0,H.Z)(u),"textCount",0),(0,V.Z)((0,H.Z)(u),"preTextStyle",{}),(0,V.Z)((0,H.Z)(u),"buildModels",function(){return u.initGlyph(),u.updateTexture(),u.filterGlyphs(),u.reBuildModel(),[u.layer.buildLayerModel({moduleName:"pointText",vertexShader:ss,fragmentShader:Uo,triangulation:ms.bind((0,H.Z)(u)),depth:{enable:!1},blend:u.getBlend()})]}),u}return(0,N.Z)(i,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=void 0===v?1:v,I=h.stroke,k=void 0===I?"#fff":I,X=h.strokeWidth,fe=void 0===X?0:X,se=h.textAnchor,Be=void 0===se?"center":se,rt=h.textAllowOverlap,Bt=void 0!==rt&&rt,Xt=h.halo,Ar=void 0===Xt?.5:Xt,Vr=h.gamma,sn=void 0===Vr?2:Vr,yn=this.fontService,Mn=yn.canvas,Wn=yn.mapping;if(Object.keys(Wn).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Wn).length),this.preTextStyle={textAnchor:Be,textAllowOverlap:Bt},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w,strokeWidth:fe,stroke:k})){this.judgeStyleAttributes({opacity:w,strokeWidth:fe,stroke:k});var ei=this.layer.getEncodedData(),ti=this.calDataFrame(this.cellLength,ei,this.cellProperties),Ui=ti.data,wa=ti.width,Ua=ti.height;this.rowCount=Ua,this.dataTexture=this.createTexture2D(this.cellLength>0&&Ui.length>0?{flipY:!0,data:Ui,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:wa,height:Ua}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1,u_stroke_width:ca()(fe)?fe:0,u_stroke_color:this.getStrokeColor(k),u_sdf_map:this.texture,u_halo_blur:Ar,u_gamma_scale:sn,u_sdf_map_size:[Mn.width,Mn.height]}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var h=this.layer.getLayerConfig(),v=h.textAnchor,I=h.textAllowOverlap;return this.preTextStyle={textAnchor:void 0===v?"center":v,textAllowOverlap:void 0===I||I},this.buildModels()}},{key:"needUpdate",value:function(){var v=this.layer.getLayerConfig().textAllowOverlap,w=void 0!==v&&v,I=this.mapService.getZoom(),k=this.mapService.getBounds(),X=(0,Ye.oO)(this.extent,k);return(!w&&(Math.abs(this.currentZoom-I)>1||!X)||w!==this.preTextStyle.textAllowOverlap)&&(this.reBuildModel(),!0)}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy(),this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:W.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(v,w,I,k){var X=v.rotate,fe=void 0===X?0:X;return Array.isArray(fe)?[fe[0]]:[fe]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:W.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(v,w,I,k){return[I[5],I[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(v,w,I,k){var X=v.size,fe=void 0===X?12:X;return Array.isArray(fe)?[fe[0]]:[fe]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:W.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(v,w,I,k){return[I[3],I[4]]}}})}},{key:"textExtent",value:function(){var h=this.mapService.getBounds();return(0,Ye.yA)(h,.5)}},{key:"initTextFont",value:function(){var h=this.layer.getLayerConfig(),v=h.fontWeight,w=void 0===v?"400":v,I=h.fontFamily,k=void 0===I?"sans-serif":I,X=this.layer.getEncodedData(),fe=[];X.forEach(function(se){var Xt,Be=se.shape,rt=void 0===Be?"":Be,Bt=function(n,c){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,c){if(n){if("string"==typeof n)return ds(n,c);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ds(n,c)}}(n))||c&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}(rt=rt.toString());try{for(Bt.s();!(Xt=Bt.n()).done;){var Ar=Xt.value;-1===fe.indexOf(Ar)&&fe.push(Ar)}}catch(Vr){Bt.e(Vr)}finally{Bt.f()}}),this.fontService.setFontOptions({characterSet:fe,fontWeight:w,fontFamily:k,iconfont:!1})}},{key:"initIconFontTex",value:function(){var h=this.layer.getLayerConfig(),v=h.fontWeight,w=void 0===v?"400":v,I=h.fontFamily,k=void 0===I?"sans-serif":I,X=this.layer.getEncodedData(),fe=[];X.forEach(function(se){var Be=se.shape,rt=void 0===Be?"":Be;rt=rt.toString(),-1===fe.indexOf(rt)&&fe.push(rt)}),this.fontService.setFontOptions({characterSet:fe,fontWeight:w,fontFamily:k,iconfont:!0})}},{key:"generateGlyphLayout",value:function(h){var v=this,w=this.fontService.mapping,I=this.layer.getLayerConfig(),k=I.spacing,X=void 0===k?2:k,fe=I.textAnchor,se=void 0===fe?"center":fe,Be=this.layer.getEncodedData();this.glyphInfo=Be.map(function(rt){var Bt=rt.shape,Ar=rt.id,Vr=rt.size,sn=void 0===Vr?1:Vr,yn=rt.textOffset,Mn=void 0===yn?[0,0]:yn,Wn=function(n,c,i,u,h,v){var w=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0],I=arguments.length>7?arguments[7]:void 0,k=n.split("\n"),X=[],fe={positionedGlyphs:X,top:w[1],bottom:w[1],left:w[0],right:w[0],lineCount:k.length,text:n};return I?Zi(fe,c,k,i,u,h,v):_i(fe,c,k,i,u,h,v),!!X.length&&fe}((void 0===Bt?"":Bt).toString(),w,sn,se,"center",X,Mn,h),ei=function(n){var I,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],i=arguments.length>2?arguments[2]:void 0,u=n.positionedGlyphs,v=[],w=xn(void 0===u?[]:u);try{for(w.s();!(I=w.n()).done;){var k=I.value,X=k.metrics,fe=4,se=X.advance*k.scale/2,rt=i?[0,0]:[k.x+se+c[0],k.y+c[1]],Bt=(0-fe)*k.scale-se+rt[0],Xt=(0-fe)*k.scale+rt[1],Ar=Bt+X.width*k.scale,Vr=Xt+X.height*k.scale;v.push({tl:{x:Bt,y:Xt},tr:{x:Ar,y:Xt},bl:{x:Bt,y:Vr},br:{x:Ar,y:Vr},tex:X,glyphOffset:i?[k.x+se,k.y]:[0,0]})}}catch(ei){w.e(ei)}finally{w.f()}return v}(Wn,Mn,!1);return rt.shaping=Wn,rt.glyphQuads=ei,rt.centroid=tf(rt.coordinates),rt.originCentroid="GAODE2.x"===rt.version?tf(rt.originCoordinates):rt.originCentroid=rt.centroid,v.glyphInfoMap[Ar]={shaping:Wn,glyphQuads:ei,centroid:tf(rt.coordinates)},rt})}},{key:"filterGlyphs",value:function(){var h=this,v=this.layer.getLayerConfig(),w=v.padding,I=void 0===w?[4,4]:w,k=v.textAllowOverlap;if(void 0===k||!k){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var fe=this.rendererService.getViewportSize(),rt=new Jr(fe.width,fe.height);this.glyphInfo.filter(function(Xt){var Ar=Xt.shaping,Vr=Xt.id,sn=void 0===Vr?0:Vr,Wn=Xt.size/24,ei=h.mapService.lngLatToContainer("GAODE2.x"===Xt.version?Xt.originCentroid:Xt.centroid),Ui=rt.placeCollisionBox({x1:Ar.left*Wn-I[0],x2:Ar.right*Wn+I[0],y1:Ar.top*Wn-I[1],y2:Ar.bottom*Wn+I[1],anchorPointX:ei.x,anchorPointY:ei.y}).box;return!(!Ui||!Ui.length||(rt.insertCollisionBox(Ui,sn),0))}).forEach(function(Xt){h.glyphInfoMap[Xt.id]=Xt})}}},{key:"initGlyph",value:function(){var v=this.layer.getLayerConfig().iconfont,w=void 0!==v&&v;w?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(w)}},{key:"updateTexture",value:function(){var h=this.rendererService.createTexture2D,v=this.fontService.canvas;this.textureHeight=v.height,this.texture&&this.texture.destroy(),this.texture=h({data:v,mag:W.gl.LINEAR,min:W.gl.LINEAR,width:v.width,height:v.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:ss,fragmentShader:Uo,triangulation:ms.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),i}(Iu);const Hi={fill:ur,image:Vt,normal:rn,extrude:q,text:us,icon:qr};var uo=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=c.call.apply(c,[this].concat(v)),(0,V.Z)((0,H.Z)(u),"type","PointLayer"),u}return(0,N.Z)(i,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new Hi[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){return{normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}}[this.getModelType()]}},{key:"getModelType",value:function(){var h=this.getEncodedData(),v=this.getLayerConfig(),w=v.shape2d,I=v.shape3d,k=this.iconService.getIconMap(),X=h.find(function(se){return se.hasOwnProperty("shape")});if(X){var fe=X.shape;return"dot"===fe?"normal":-1!==(null==w?void 0:w.indexOf(fe))?"fill":-1!==(null==I?void 0:I.indexOf(fe))?"extrude":k.hasOwnProperty(fe)?"image":""!==this.fontService.getGlyph(fe)?"icon":"text"}return"normal"}}]),i}(Jc);var Pl={solid:0,dash:1},Qe=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=c.call.apply(c,[this].concat(v)),(0,V.Z)((0,H.Z)(u),"texture",void 0),(0,V.Z)((0,H.Z)(u),"updateTexture",function(){var I=u.rendererService.createTexture2D;if(u.texture)return u.texture.update({data:u.iconService.getCanvas()}),void u.layer.render();u.texture=I({data:u.iconService.getCanvas(),mag:W.gl.NEAREST,min:W.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})}),u}return(0,N.Z)(i,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=h.sourceColor,I=h.targetColor,k=h.textureBlend,X=void 0===k?"normal":k,fe=h.lineType,se=void 0===fe?"solid":fe,Be=h.dashArray,rt=void 0===Be?[10,5,0,0]:Be,Bt=h.lineTexture,Xt=void 0!==Bt&&Bt,Ar=h.iconStep,Vr=void 0===Ar?100:Ar;2===rt.length&&rt.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var sn=0,yn=[0,0,0,0],Mn=[0,0,0,0];if(w&&I&&(yn=(0,Ye.CI)(w),Mn=(0,Ye.CI)(I),sn=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Wn=this.layer.getEncodedData(),ei=this.calDataFrame(this.cellLength,Wn,this.cellProperties),ti=ei.data,Ui=ei.width,wa=ei.height;this.rowCount=wa,this.dataTexture=this.createTexture2D(this.cellLength>0&&ti.length>0?{flipY:!0,data:ti,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:Ui,height:wa}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(v)?v:1,u_textureBlend:"normal"===X?0:1,u_line_type:Pl[se],u_dash_array:rt,u_texture:this.texture,u_line_texture:Xt?1:0,u_icon_step:Vr,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:sn,u_sourceColor:yn,u_targetColor:Mn}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig();return{u_aimate:this.animateOption2Array(h.animateOption),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,v;null===(h=this.texture)||void 0===h||h.destroy(),null===(v=this.dataTexture)||void 0===v||v.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\nattribute vec2 a_iconMapUV;\n\n// dash line\nattribute float a_Total_Distance;\nattribute float a_Distance;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nuniform float u_icon_step: 100;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\nvarying vec4 v_dash_array;\nvarying vec2 v_normal;\n\nvarying vec4 v_dataset; // \u6570\u636e\u96c6 - distance_ratio/distance/pixelLen/texV\n// texV \u7ebf\u56fe\u5c42 - \u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\uff08\u7ebf\u7684\u5bbd\u5ea6\u65b9\u5411\uff09\nvarying vec2 v_iconMapUV;\nuniform float u_linearColor: 0;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  float d_distance_ratio; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n  float d_texPixelLen;    // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n\n  v_iconMapUV = a_iconMapUV;\n  d_texPixelLen = project_pixel(u_icon_step);\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    d_texPixelLen *= 10.0;\n  }\n\n  if(u_line_type == LineTypeDash) {\n    d_distance_ratio = a_Distance / a_Total_Distance;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  }\n  if(u_aimate.x == Animate || u_linearColor == 1.0) {\n      d_distance_ratio = a_Distance / a_Total_Distance;\n  }\n  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));\n\n\n  v_color = a_Color;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n\n  vec2 offset = project_pixel(size.xy);\n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7ebf\u6a2a\u5411\u504f\u79fb\u7684\u8ddd\u79bb\uff08\u5411\u4e24\u4fa7\u504f\u79fb\u7684\u548c\uff09\n  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5b9a\u70b9\u4f4d\u7f6e\u504f\u79fb\uff0c\u6309\u5730\u56fe\u7b49\u7ea7\u7f29\u653e\u540e\u7684\u8ddd\u79bb \u5355\u4fa7 * 2\n  float texV = lineOffsetWidth/linePixelSize; // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n  // \u8bbe\u7f6e\u6570\u636e\u96c6\u7684\u53c2\u6570\n  v_dataset.r = d_distance_ratio; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n  v_dataset.g = a_Distance;       // \u5f53\u524d\u9876\u70b9\u7684\u8ddd\u79bb\n  v_dataset.b = d_texPixelLen;    // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n  v_dataset.a = texV;             // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y, 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y / 8.0, 1.0)); // \u989d\u5916\u9664 8.0 \u662f\u4e3a\u4e86\u548cgaode1.x\u7684\u9ad8\u5ea6\u517c\u5bb9\n  } else {\n    float lineHeight = a_Size.y;\n    // \u517c\u5bb9 mapbox \u5728\u7ebf\u9ad8\u5ea6\u4e0a\u7684\u6548\u679c\u8868\u73b0\u57fa\u672c\u4e00\u81f4\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      lineHeight = lineHeight*2.0/pow(2.0, 20.0 - u_Zoom);\n    }\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nuniform float u_blur : 0.99;\nuniform float u_line_type: 0.0;\nuniform float u_opacity : 1.0;\nuniform float u_textureBlend;\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\n// line texture\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\n// dash\nuniform float u_dash_offset : 0.0;\nuniform float u_dash_ratio : 0.1;\nvarying vec4 v_dash_array;\n\nvarying vec4 v_dataset; // \u6570\u636e\u96c6 - distance_ratio/distance/pixelLen/texV\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63a7\u5236\u8fd0\u52a8\n\nvarying mat4 styleMappingMat;\n// [animate, duration, interval, trailLength],\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // \u8fd0\u52a8\u901f\u5ea6\n  float d_distance_ratio = v_dataset.r; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n\n  if(u_linearColor == 1.0) { // \u4f7f\u7528\u6e10\u53d8\u989c\u8272\n    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);\n  } else { // \u4f7f\u7528 color \u65b9\u6cd5\u4f20\u5165\u7684\u989c\u8272\n     gl_FragColor = v_color;\n  }\n\n  // anti-alias\n  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));\n  gl_FragColor.a *= opacity; // \u5168\u5c40\u900f\u660e\u5ea6\n  if(u_aimate.x == Animate) {\n      animateSpeed = u_time / u_aimate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n // dash line\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    float aDistance = v_dataset.g;      // \u5f53\u524d\u9876\u70b9\u7684\u8ddd\u79bb\n    float d_texPixelLen = v_dataset.b;  // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = v_dataset.a;  // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n    v = max(smoothstep(0.95, 1.0, v), v);\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));\n     vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n  // gl_FragColor = filterColor(vec4(1.0, 0.0, 0.0, 1.0));\n \n  // if(rV < r || rV > 1.0 - r) {\n  //   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n  // } \n  // if(v > 0.9) {\n  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);\n  // } else if(v < 0.1) {\n  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);\n  // }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:Ph,primitive:W.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.layer.getLayerConfig(),this.styleAttributeService.registerStyleAttribute({name:"distance",type:W.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(X,fe,se,Be){return[se[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:W.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(X,fe,se,Be){return[se[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(X,fe,se,Be){var rt=X.size,Bt=void 0===rt?1:rt;return Array.isArray(Bt)?[Bt[0],Bt[1]]:[Bt,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:W.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(X,fe,se,Be,rt){return rt}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:W.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(X,fe,se,Be){return[se[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:W.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(X,fe,se,Be){var Xt=h.iconService.getIconMap()[X.texture]||{x:0,y:0};return[Xt.x,Xt.y]}}})}},{key:"loadImage",value:function(h){return new Promise(function(v,w){if(h instanceof HTMLImageElement)v(h);else{var I=new Image;I.crossOrigin="anonymous",I.onload=function(){v(I)},I.onerror=function(){w(new Error("Could not load image at "+h))},I.src=h instanceof File?URL.createObjectURL(h):h}})}}]),i}(Iu);var He=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),c.apply(this,arguments)}return(0,N.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,w=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var I=this.layer.getEncodedData(),k=this.calDataFrame(this.cellLength,I,this.cellProperties),X=k.data,fe=k.width,se=k.height;this.rowCount=se,this.dataTexture=this.createTexture2D(this.cellLength>0&&X.length>0?{flipY:!0,data:X,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:fe,height:se}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:'precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:np})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:W.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(v,w,I,k,X){return X}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(v,w,I,k){var X=v.size,fe=void 0===X?10:X;return Array.isArray(fe)?[fe[0]]:[fe]}}})}}]),i}(Iu);const dt={fill:function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),c.apply(this,arguments)}return(0,N.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,w=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var I=this.layer.getEncodedData(),k=this.calDataFrame(this.cellLength,I,this.cellProperties),X=k.data,fe=k.width,se=k.height;this.rowCount=se,this.dataTexture=this.createTexture2D(this.cellLength>0&&X.length>0?{flipY:!0,data:X,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:fe,height:se}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  v_Color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n\n',fragmentShader:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:Ap,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){}}]),i}(Iu),line:Qe,extrude:He,text:us,point_fill:ur,point_image:Vt,point_normal:rn,point_extrude:q};var Ht,$t,Zr,un,ln,bn,on,Yn,kn,We=function(n){(0,j.Z)(i,n);var c=function(n){var c=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Ne.Z)(n);if(c){var v=(0,Ne.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=c.call.apply(c,[this].concat(v)),(0,V.Z)((0,H.Z)(u),"type","PolygonLayer"),u}return(0,N.Z)(i,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new dt[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var h,v=this.styleAttributeService.getLayerStyleAttribute("shape"),w=null==v||null===(h=v.scale)||void 0===h?void 0:h.field;return"fill"===w?"fill":"extrude"===w?"extrude":"line"===w?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var h=this.getEncodedData(),v=this.getLayerConfig(),w=v.shape2d,I=v.shape3d,k=this.iconService.getIconMap(),X=h.find(function(se){return se.hasOwnProperty("shape")});if(X){var fe=X.shape;return"dot"===fe?"point_normal":-1!==(null==w?void 0:w.indexOf(fe))?"point_fill":-1!==(null==I?void 0:I.indexOf(fe))?"point_extrude":k.hasOwnProperty(fe)?"point_image":"text"}return"fill"}}]),i}(Jc);function jn(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}var qa,Hn=(Ht=(0,va.b2)(),$t=(0,va.f3)(W.vK.IGlobalConfigService),Zr=(0,va.f3)(W.vK.IMapService),un=(0,va.f3)(W.vK.IFontService),Ht((bn=function(){function n(){(0,R.Z)(this,n),(0,Y.Z)(this,"configService",on,this),(0,Y.Z)(this,"mapService",Yn,this),(0,Y.Z)(this,"fontService",kn,this)}return(0,N.Z)(n,[{key:"apply",value:function(i,u){var h=this,v=u.styleAttributeService;i.hooks.init.tap("DataMappingPlugin",function(){h.generateMaping(i,{styleAttributeService:v})}),i.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return i.dataState.dataMappingNeedUpdate=!1,h.generateMaping(i,{styleAttributeService:v}),!0}),i.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!i.layerModelNeedUpdate){var w=v.getLayerStyleAttributes()||[],I=v.getLayerStyleAttribute("filter"),k=i.getSource().data.dataArray,X=w.filter(function(se){return se.needRemapping}),fe=k;null!=I&&I.needRemapping&&null!=I&&I.scale&&(fe=k.filter(function(se){return h.applyAttributeMapping(I,se)[0]})),X.length&&(null!=I&&I.needRemapping?(i.setEncodedData(h.mapping(w,fe)),I.needRemapping=!1):i.setEncodedData(h.mapping(X,fe,i.getEncodedData())),i.emit("remapping",null))}})}},{key:"generateMaping",value:function(i,u){var h=this,v=u.styleAttributeService,w=v.getLayerStyleAttributes()||[],I=v.getLayerStyleAttribute("filter"),k=i.getSource().data.dataArray,X=k;null!=I&&I.scale&&(X=k.filter(function(fe){return h.applyAttributeMapping(I,fe)[0]})),i.setEncodedData(this.mapping(w,X))}},{key:"mapping",value:function(i,u,h){var v=this,w=u.map(function(I,k){var fe=function(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?jn(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):jn(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}({id:I._id,coordinates:I.coordinates},h?h[k]:{});return i.filter(function(se){return void 0!==se.scale}).forEach(function(se){var Be=v.applyAttributeMapping(se,I);se.needRemapping=!1,"color"===se.name&&(Be=Be.map(function(rt){return(0,Ye.CI)(rt)})),fe[se.name]=Array.isArray(Be)&&1===Be.length?Be[0]:Be,"shape"===se.name&&(fe.shape=v.fontService.getIconFontKey(fe[se.name]))}),fe});return w.length>0&&"GAODE2.x"===this.mapService.version&&("number"==typeof w[0].coordinates[0]?w.filter(function(I){return!I.originCoordinates}).map(function(I){I.version="GAODE2.x",I.originCoordinates=Po()(I.coordinates),I.coordinates=v.mapService.lngLatToCoord(I.coordinates)}):w.filter(function(I){return!I.originCoordinates}).map(function(I){I.version="GAODE2.x",I.originCoordinates=Po()(I.coordinates),I.coordinates=v.mapService.lngLatToCoords(I.coordinates)})),w}},{key:"applyAttributeMapping",value:function(i,u){var h;if(!i.scale)return[];var v=(null==i||null===(h=i.scale)||void 0===h?void 0:h.scalers)||[],w=[];return v.forEach(function(I){var k,X=I.field;(u.hasOwnProperty(X)||"variable"===(null===(k=i.scale)||void 0===k?void 0:k.type))&&w.push(u[X])}),i.mapping?i.mapping(w):[]}}]),n}(),on=(0,Ge.Z)(bn.prototype,"configService",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yn=(0,Ge.Z)(bn.prototype,"mapService",[Zr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kn=(0,Ge.Z)(bn.prototype,"fontService",[un],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ln=bn))||ln),jo=(0,va.b2)()(qa=function(){function n(){(0,R.Z)(this,n),(0,V.Z)(this,"mapService",void 0)}return(0,N.Z)(n,[{key:"apply",value:function(i){var u=this;this.mapService=i.getContainer().get(W.vK.IMapService),i.hooks.init.tap("DataSourcePlugin",function(){if(!i.getSource()){var v=i.sourceOption;i.setSource(new $e(v.data,v.options))}u.updateClusterData(i)}),i.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var h=u.updateClusterData(i),v=i.dataState.dataSourceNeedUpdate;return i.dataState.dataSourceNeedUpdate=!1,h||v})}},{key:"updateClusterData",value:function(i){var u=i.getSource(),h=u.cluster,v=u.clusterOptions,w=v.zoom,I=void 0===w?0:w,k=v.maxZoom,X=void 0===k?16:k,fe=this.mapService.getZoom()-1;return!!(h&&(i.dataState.dataSourceNeedUpdate||Math.abs(I-fe)>1)&&X>I)&&(u.updateClusterData(Math.floor(fe)),!0)}}]),n}())||qa,$l=y(72699),ao=y.n($l),Ba=y(28303),zs=y.n(Ba);function Xu(n,c){return n<c?-1:n>c?1:n>=c?0:NaN}function Ou(n){return 1===n.length&&(n=function(n){return function(c,i){return Xu(n(c),i)}}(n)),{left:function(c,i,u,h){for(null==u&&(u=0),null==h&&(h=c.length);u<h;){var v=u+h>>>1;n(c[v],i)<0?u=v+1:h=v}return u},right:function(c,i,u,h){for(null==u&&(u=0),null==h&&(h=c.length);u<h;){var v=u+h>>>1;n(c[v],i)>0?h=v:u=v+1}return u}}}const Zc=Ou(Xu).right;var th=Math.sqrt(50),rh=Math.sqrt(10),Oh=Math.sqrt(2);function Rf(n,c,i){var u,v,w,I,h=-1;if(i=+i,(n=+n)==(c=+c)&&i>0)return[n];if((u=c<n)&&(v=n,n=c,c=v),0===(I=Ql(n,c,i))||!isFinite(I))return[];if(I>0)for(n=Math.ceil(n/I),c=Math.floor(c/I),w=new Array(v=Math.ceil(c-n+1));++h<v;)w[h]=(n+h)*I;else for(n=Math.floor(n*I),c=Math.ceil(c*I),w=new Array(v=Math.ceil(n-c+1));++h<v;)w[h]=(n-h)/I;return u&&w.reverse(),w}function Ql(n,c,i){var u=(c-n)/Math.max(0,i),h=Math.floor(Math.log(u)/Math.LN10),v=u/Math.pow(10,h);return h>=0?(v>=th?10:v>=rh?5:v>=Oh?2:1)*Math.pow(10,h):-Math.pow(10,-h)/(v>=th?10:v>=rh?5:v>=Oh?2:1)}function sp(n,c,i){var u=Math.abs(c-n)/Math.max(0,i),h=Math.pow(10,Math.floor(Math.log(u)/Math.LN10)),v=u/h;return v>=th?h*=10:v>=rh?h*=5:v>=Oh&&(h*=2),c<n?-h:h}function Is(n){return null===n?NaN:+n}function xf(n,c,i){if(null==i&&(i=Is),u=n.length){if((c=+c)<=0||u<2)return+i(n[0],0,n);if(c>=1)return+i(n[u-1],u-1,n);var u,h=(u-1)*c,v=Math.floor(h),w=+i(n[v],v,n);return w+(+i(n[v+1],v+1,n)-w)*(h-v)}}var Il="$";function e(){}function t(n,c){var i=new e;if(n instanceof e)n.each(function(I,k){i.set(k,I)});else if(Array.isArray(n)){var v,u=-1,h=n.length;if(null==c)for(;++u<h;)i.set(u,n[u]);else for(;++u<h;)i.set(c(v=n[u],u,n),v)}else if(n)for(var w in n)i.set(w,n[w]);return i}e.prototype=t.prototype={constructor:e,has:function(n){return Il+n in this},get:function(n){return this[Il+n]},set:function(n,c){return this[Il+n]=c,this},remove:function(n){var c=Il+n;return c in this&&delete this[c]},clear:function(){for(var n in this)n[0]===Il&&delete this[n]},keys:function(){var n=[];for(var c in this)c[0]===Il&&n.push(c.slice(1));return n},values:function(){var n=[];for(var c in this)c[0]===Il&&n.push(this[c]);return n},entries:function(){var n=[];for(var c in this)c[0]===Il&&n.push({key:c.slice(1),value:this[c]});return n},size:function(){var n=0;for(var c in this)c[0]===Il&&++n;return n},empty:function(){for(var n in this)if(n[0]===Il)return!1;return!0},each:function(n){for(var c in this)c[0]===Il&&n(this[c],c.slice(1),this)}};const r=t;function z(){}var J=r.prototype;z.prototype=function(n,c){var i=new z;if(n instanceof z)n.each(function(v){i.add(v)});else if(n){var u=-1,h=n.length;if(null==c)for(;++u<h;)i.add(n[u]);else for(;++u<h;)i.add(c(n[u],u,n))}return i}.prototype={constructor:z,has:J.has,add:function(n){return this[Il+(n+="")]=n,this},remove:J.remove,clear:J.clear,values:J.keys,size:J.size,empty:J.empty,each:J.each};var ye=Array.prototype,Se=ye.map,qe=ye.slice;function Je(n,c){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(c).domain(n)}return this}var st={name:"implicit"};function zt(){var n=r(),c=[],i=[],u=st;function h(v){var w=v+"",I=n.get(w);if(!I){if(u!==st)return u;n.set(w,I=c.push(v))}return i[(I-1)%i.length]}return h.domain=function(v){if(!arguments.length)return c.slice();c=[],n=r();for(var k,X,w=-1,I=v.length;++w<I;)n.has(X=(k=v[w])+"")||n.set(X,c.push(k));return h},h.range=function(v){return arguments.length?(i=qe.call(v),h):i.slice()},h.unknown=function(v){return arguments.length?(u=v,h):u},h.copy=function(){return zt(c,i).unknown(u)},Je.apply(h,arguments),h}function Rr(n,c,i,u,h){var v=n*n,w=v*n;return((1-3*n+3*v-w)*c+(4-6*v+3*w)*i+(1+3*n+3*v-3*w)*u+w*h)/6}function ii(n){return function(){return n}}function wi(n,c){var i=c-n;return i?function(n,c){return function(i){return n+i*c}}(n,i):ii(isNaN(n)?c:n)}const Qn=function n(c){var i=function(n){return 1==(n=+n)?wi:function(c,i){return i-c?function(n,c,i){return n=Math.pow(n,i),c=Math.pow(c,i)-n,i=1/i,function(u){return Math.pow(n+u*c,i)}}(c,i,n):ii(isNaN(c)?i:c)}}(c);function u(h,v){var w=i((h=(0,pc.B8)(h)).r,(v=(0,pc.B8)(v)).r),I=i(h.g,v.g),k=i(h.b,v.b),X=wi(h.opacity,v.opacity);return function(fe){return h.r=w(fe),h.g=I(fe),h.b=k(fe),h.opacity=X(fe),h+""}}return u.gamma=n,u}(1);function da(n){return function(c){var w,I,i=c.length,u=new Array(i),h=new Array(i),v=new Array(i);for(w=0;w<i;++w)I=(0,pc.B8)(c[w]),u[w]=I.r||0,h[w]=I.g||0,v[w]=I.b||0;return u=n(u),h=n(h),v=n(v),I.opacity=1,function(k){return I.r=u(k),I.g=h(k),I.b=v(k),I+""}}}function Ra(n,c){var w,i=c?c.length:0,u=n?Math.min(i,n.length):0,h=new Array(u),v=new Array(i);for(w=0;w<u;++w)h[w]=No(n[w],c[w]);for(;w<i;++w)v[w]=c[w];return function(I){for(w=0;w<u;++w)v[w]=h[w](I);return v}}function Co(n,c){var i=new Date;return n=+n,c=+c,function(u){return i.setTime(n*(1-u)+c*u),i}}function Ao(n,c){return n=+n,c=+c,function(i){return n*(1-i)+c*i}}function Do(n,c){var h,i={},u={};for(h in(null===n||"object"!=typeof n)&&(n={}),(null===c||"object"!=typeof c)&&(c={}),c)h in n?i[h]=No(n[h],c[h]):u[h]=c[h];return function(v){for(h in i)u[h]=i[h](v);return u}}da(function(n){var c=n.length-1;return function(i){var u=i<=0?i=0:i>=1?(i=1,c-1):Math.floor(i*c),h=n[u],v=n[u+1];return Rr((i-u/c)*c,u>0?n[u-1]:2*h-v,h,v,u<c-1?n[u+2]:2*v-h)}}),da(function(n){var c=n.length;return function(i){var u=Math.floor(((i%=1)<0?++i:i)*c);return Rr((i-u/c)*c,n[(u+c-1)%c],n[u%c],n[(u+1)%c],n[(u+2)%c])}});var ho=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Oo=new RegExp(ho.source,"g");function fu(n,c){var u,h,v,i=ho.lastIndex=Oo.lastIndex=0,w=-1,I=[],k=[];for(n+="",c+="";(u=ho.exec(n))&&(h=Oo.exec(c));)(v=h.index)>i&&(v=c.slice(i,v),I[w]?I[w]+=v:I[++w]=v),(u=u[0])===(h=h[0])?I[w]?I[w]+=h:I[++w]=h:(I[++w]=null,k.push({i:w,x:Ao(u,h)})),i=Oo.lastIndex;return i<c.length&&(v=c.slice(i),I[w]?I[w]+=v:I[++w]=v),I.length<2?k[0]?function(n){return function(c){return n(c)+""}}(k[0].x):function(n){return function(){return n}}(c):(c=k.length,function(X){for(var se,fe=0;fe<c;++fe)I[(se=k[fe]).i]=se.x(X);return I.join("")})}function Ms(n,c){c||(c=[]);var h,i=n?Math.min(c.length,n.length):0,u=c.slice();return function(v){for(h=0;h<i;++h)u[h]=n[h]*(1-v)+c[h]*v;return u}}function No(n,c){var u,i=typeof c;return null==c||"boolean"===i?ii(c):("number"===i?Ao:"string"===i?(u=(0,pc.ZP)(c))?(c=u,Qn):fu:c instanceof pc.ZP?Qn:c instanceof Date?Co:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(c)?Ms:Array.isArray(c)?Ra:"function"!=typeof c.valueOf&&"function"!=typeof c.toString||isNaN(c)?Do:Ao)(n,c)}function Os(n,c){return n=+n,c=+c,function(i){return Math.round(n*(1-i)+c*i)}}function Ja(n){return+n}var Xa=[0,1];function qi(n){return n}function $s(n,c){return(c-=n=+n)?function(i){return(i-n)/c}:function(n){return function(){return n}}(isNaN(c)?NaN:.5)}function Zs(n){var u,c=n[0],i=n[n.length-1];return c>i&&(u=c,c=i,i=u),function(h){return Math.max(c,Math.min(i,h))}}function yo(n,c,i){var u=n[0],h=n[1],v=c[0],w=c[1];return h<u?(u=$s(h,u),v=i(w,v)):(u=$s(u,h),v=i(v,w)),function(I){return v(u(I))}}function fs(n,c,i){var u=Math.min(n.length,c.length)-1,h=new Array(u),v=new Array(u),w=-1;for(n[u]<n[0]&&(n=n.slice().reverse(),c=c.slice().reverse());++w<u;)h[w]=$s(n[w],n[w+1]),v[w]=i(c[w],c[w+1]);return function(I){var k=Zc(n,I,1,u)-1;return v[k](h[k](I))}}function Ss(n,c){return c.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function Pa(){var u,h,v,I,k,X,n=Xa,c=Xa,i=No,w=qi;function fe(){return I=Math.min(n.length,c.length)>2?fs:yo,k=X=null,se}function se(Be){return isNaN(Be=+Be)?v:(k||(k=I(n.map(u),c,i)))(u(w(Be)))}return se.invert=function(Be){return w(h((X||(X=I(c,n.map(u),Ao)))(Be)))},se.domain=function(Be){return arguments.length?(n=Se.call(Be,Ja),w===qi||(w=Zs(n)),fe()):n.slice()},se.range=function(Be){return arguments.length?(c=qe.call(Be),fe()):c.slice()},se.rangeRound=function(Be){return c=qe.call(Be),i=Os,fe()},se.clamp=function(Be){return arguments.length?(w=Be?Zs(n):qi,se):w!==qi},se.interpolate=function(Be){return arguments.length?(i=Be,fe()):i},se.unknown=function(Be){return arguments.length?(v=Be,se):v},function(Be,rt){return u=Be,h=rt,fe()}}function vc(n,c){return Pa()(n,c)}var Lh,cl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ml(n){if(!(c=cl.exec(n)))throw new Error("invalid format: "+n);var c;return new Bo({fill:c[1],align:c[2],sign:c[3],symbol:c[4],zero:c[5],width:c[6],comma:c[7],precision:c[8]&&c[8].slice(1),trim:c[9],type:c[10]})}function Bo(n){this.fill=void 0===n.fill?" ":n.fill+"",this.align=void 0===n.align?">":n.align+"",this.sign=void 0===n.sign?"-":n.sign+"",this.symbol=void 0===n.symbol?"":n.symbol+"",this.zero=!!n.zero,this.width=void 0===n.width?void 0:+n.width,this.comma=!!n.comma,this.precision=void 0===n.precision?void 0:+n.precision,this.trim=!!n.trim,this.type=void 0===n.type?"":n.type+""}function Ku(n,c){if((i=(n=c?n.toExponential(c-1):n.toExponential()).indexOf("e"))<0)return null;var i,u=n.slice(0,i);return[u.length>1?u[0]+u.slice(2):u,+n.slice(i+1)]}function mc(n){return(n=Ku(Math.abs(n)))?n[1]:NaN}function oh(n,c){var i=Ku(n,c);if(!i)return n+"";var u=i[0],h=i[1];return h<0?"0."+new Array(-h).join("0")+u:u.length>h+1?u.slice(0,h+1)+"."+u.slice(h+1):u+new Array(h-u.length+2).join("0")}Ml.prototype=Bo.prototype,Bo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const kh={"%":function(n,c){return(100*n).toFixed(c)},b:function(n){return Math.round(n).toString(2)},c:function(n){return n+""},d:function(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)},e:function(n,c){return n.toExponential(c)},f:function(n,c){return n.toFixed(c)},g:function(n,c){return n.toPrecision(c)},o:function(n){return Math.round(n).toString(8)},p:function(n,c){return oh(100*n,c)},r:oh,s:function(n,c){var i=Ku(n,c);if(!i)return n+"";var u=i[0],h=i[1],v=h-(Lh=3*Math.max(-8,Math.min(8,Math.floor(h/3))))+1,w=u.length;return v===w?u:v>w?u+new Array(v-w+1).join("0"):v>0?u.slice(0,v)+"."+u.slice(v):"0."+new Array(1-v).join("0")+Ku(n,Math.max(0,c+v-1))[0]},X:function(n){return Math.round(n).toString(16).toUpperCase()},x:function(n){return Math.round(n).toString(16)}};function Rh(n){return n}var gc,bf,Dh,Vc=Array.prototype.map,sh=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Sf(n){var c=n.domain;return n.ticks=function(i){var u=c();return Rf(u[0],u[u.length-1],null==i?10:i)},n.tickFormat=function(i,u){var h=c();return function(n,c,i,u){var v,h=sp(n,c,i);switch((u=Ml(null==u?",f":u)).type){case"s":var w=Math.max(Math.abs(n),Math.abs(c));return null==u.precision&&!isNaN(v=function(n,c){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mc(c)/3)))-mc(Math.abs(n)))}(h,w))&&(u.precision=v),Dh(u,w);case"":case"e":case"g":case"p":case"r":null==u.precision&&!isNaN(v=function(n,c){return n=Math.abs(n),c=Math.abs(c)-n,Math.max(0,mc(c)-mc(n))+1}(h,Math.max(Math.abs(n),Math.abs(c))))&&(u.precision=v-("e"===u.type));break;case"f":case"%":null==u.precision&&!isNaN(v=function(n){return Math.max(0,-mc(Math.abs(n)))}(h))&&(u.precision=v-2*("%"===u.type))}return bf(u)}(h[0],h[h.length-1],null==i?10:i,u)},n.nice=function(i){null==i&&(i=10);var k,u=c(),h=0,v=u.length-1,w=u[h],I=u[v];return I<w&&(k=w,w=I,I=k,k=h,h=v,v=k),(k=Ql(w,I,i))>0?k=Ql(w=Math.floor(w/k)*k,I=Math.ceil(I/k)*k,i):k<0&&(k=Ql(w=Math.ceil(w*k)/k,I=Math.floor(I*k)/k,i)),k>0?(u[h]=Math.floor(w/k)*k,u[v]=Math.ceil(I/k)*k,c(u)):k<0&&(u[h]=Math.ceil(w*k)/k,u[v]=Math.floor(I*k)/k,c(u)),n},n}function Fh(n,c){var w,i=0,u=(n=n.slice()).length-1,h=n[i],v=n[u];return v<h&&(w=i,i=u,u=w,w=h,h=v,v=w),n[i]=c.floor(h),n[u]=c.ceil(v),n}function Nf(n){return Math.log(n)}function zh(n){return Math.exp(n)}function fh(n){return-Math.log(-n)}function Zh(n){return-Math.exp(-n)}function Bf(n){return isFinite(n)?+("1e"+n):n<0?0:n}function cp(n){return function(c){return-n(-c)}}function rd(n){var h,v,c=n(Nf,zh),i=c.domain,u=10;function w(){return h=function(n){return n===Math.E?Math.log:10===n&&Math.log10||2===n&&Math.log2||(n=Math.log(n),function(c){return Math.log(c)/n})}(u),v=function(n){return 10===n?Bf:n===Math.E?Math.exp:function(c){return Math.pow(n,c)}}(u),i()[0]<0?(h=cp(h),v=cp(v),n(fh,Zh)):n(Nf,zh),c}return c.base=function(I){return arguments.length?(u=+I,w()):u},c.domain=function(I){return arguments.length?(i(I),w()):i()},c.ticks=function(I){var se,k=i(),X=k[0],fe=k[k.length-1];(se=fe<X)&&(Be=X,X=fe,fe=Be);var Bt,Xt,Ar,Be=h(X),rt=h(fe),Vr=null==I?10:+I,sn=[];if(!(u%1)&&rt-Be<Vr){if(Be=Math.round(Be)-1,rt=Math.round(rt)+1,X>0){for(;Be<rt;++Be)for(Xt=1,Bt=v(Be);Xt<u;++Xt)if(!((Ar=Bt*Xt)<X)){if(Ar>fe)break;sn.push(Ar)}}else for(;Be<rt;++Be)for(Xt=u-1,Bt=v(Be);Xt>=1;--Xt)if(!((Ar=Bt*Xt)<X)){if(Ar>fe)break;sn.push(Ar)}}else sn=Rf(Be,rt,Math.min(rt-Be,Vr)).map(v);return se?sn.reverse():sn},c.tickFormat=function(I,k){if(null==k&&(k=10===u?".0e":","),"function"!=typeof k&&(k=bf(k)),I===1/0)return k;null==I&&(I=10);var X=Math.max(1,u*I/c.ticks().length);return function(fe){var se=fe/v(Math.round(h(fe)));return se*u<u-.5&&(se*=u),se<=X?k(fe):""}},c.nice=function(){return i(Fh(i(),{floor:function(I){return v(Math.floor(h(I)))},ceil:function(I){return v(Math.ceil(h(I)))}}))},c}function Go(n){return function(c){return c<0?-Math.pow(-c,n):Math.pow(c,n)}}function yc(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function gd(n){return n<0?-n*n:n*n}function wf(n){var c=n(qi,qi),i=1;function u(){return 1===i?n(qi,qi):.5===i?n(yc,gd):n(Go(i),Go(1/i))}return c.exponent=function(h){return arguments.length?(i=+h,u()):i},Sf(c)}gc=function(n){var c=void 0===n.grouping||void 0===n.thousands?Rh:function(n,c){return function(i,u){for(var h=i.length,v=[],w=0,I=n[0],k=0;h>0&&I>0&&(k+I+1>u&&(I=Math.max(1,u-k)),v.push(i.substring(h-=I,h+I)),!((k+=I+1)>u));)I=n[w=(w+1)%n.length];return v.reverse().join(c)}}(Vc.call(n.grouping,Number),n.thousands+""),i=void 0===n.currency?"":n.currency[0]+"",u=void 0===n.currency?"":n.currency[1]+"",h=void 0===n.decimal?".":n.decimal+"",v=void 0===n.numerals?Rh:function(n){return function(c){return c.replace(/[0-9]/g,function(i){return n[+i]})}}(Vc.call(n.numerals,String)),w=void 0===n.percent?"%":n.percent+"",I=void 0===n.minus?"-":n.minus+"",k=void 0===n.nan?"NaN":n.nan+"";function X(se){var Be=(se=Ml(se)).fill,rt=se.align,Bt=se.sign,Xt=se.symbol,Ar=se.zero,Vr=se.width,sn=se.comma,yn=se.precision,Mn=se.trim,Wn=se.type;"n"===Wn?(sn=!0,Wn="g"):kh[Wn]||(void 0===yn&&(yn=12),Mn=!0,Wn="g"),(Ar||"0"===Be&&"="===rt)&&(Ar=!0,Be="0",rt="=");var ei="$"===Xt?i:"#"===Xt&&/[boxX]/.test(Wn)?"0"+Wn.toLowerCase():"",ti="$"===Xt?u:/[%p]/.test(Wn)?w:"",Ui=kh[Wn],wa=/[defgprs%]/.test(Wn);function Ua(Mi){var Ru,_p,xp,Va=ei,po=ti;if("c"===Wn)po=Ui(Mi)+po,Mi="";else{var bp=(Mi=+Mi)<0||1/Mi<0;if(Mi=isNaN(Mi)?k:Ui(Math.abs(Mi),yn),Mn&&(Mi=function(n){e:for(var h,c=n.length,i=1,u=-1;i<c;++i)switch(n[i]){case".":u=h=i;break;case"0":0===u&&(u=i),h=i;break;default:if(!+n[i])break e;u>0&&(u=0)}return u>0?n.slice(0,u)+n.slice(h+1):n}(Mi)),bp&&0==+Mi&&"+"!==Bt&&(bp=!1),Va=(bp?"("===Bt?Bt:I:"-"===Bt||"("===Bt?"":Bt)+Va,po=("s"===Wn?sh[8+Lh/3]:"")+po+(bp&&"("===Bt?")":""),wa)for(Ru=-1,_p=Mi.length;++Ru<_p;)if(48>(xp=Mi.charCodeAt(Ru))||xp>57){po=(46===xp?h+Mi.slice(Ru+1):Mi.slice(Ru))+po,Mi=Mi.slice(0,Ru);break}}sn&&!Ar&&(Mi=c(Mi,1/0));var Sp=Va.length+Mi.length+po.length,sf=Sp<Vr?new Array(Vr-Sp+1).join(Be):"";switch(sn&&Ar&&(Mi=c(sf+Mi,sf.length?Vr-po.length:1/0),sf=""),rt){case"<":Mi=Va+Mi+po+sf;break;case"=":Mi=Va+sf+Mi+po;break;case"^":Mi=sf.slice(0,Sp=sf.length>>1)+Va+Mi+po+sf.slice(Sp);break;default:Mi=sf+Va+Mi+po}return v(Mi)}return yn=void 0===yn?6:/[gprs]/.test(Wn)?Math.max(1,Math.min(21,yn)):Math.max(0,Math.min(20,yn)),Ua.toString=function(){return se+""},Ua}return{format:X,formatPrefix:function(se,Be){var rt=X(((se=Ml(se)).type="f",se)),Bt=3*Math.max(-8,Math.min(8,Math.floor(mc(Be)/3))),Xt=Math.pow(10,-Bt),Ar=sh[8+Bt/3];return function(Vr){return rt(Xt*Vr)+Ar}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),bf=gc.format,Dh=gc.formatPrefix;var Ff=new Date,ph=new Date;function pu(n,c,i,u){function h(v){return n(v=0===arguments.length?new Date:new Date(+v)),v}return h.floor=function(v){return n(v=new Date(+v)),v},h.ceil=function(v){return n(v=new Date(v-1)),c(v,1),n(v),v},h.round=function(v){var w=h(v),I=h.ceil(v);return v-w<I-v?w:I},h.offset=function(v,w){return c(v=new Date(+v),null==w?1:Math.floor(w)),v},h.range=function(v,w,I){var X,k=[];if(v=h.ceil(v),I=null==I?1:Math.floor(I),!(v<w&&I>0))return k;do{k.push(X=new Date(+v)),c(v,I),n(v)}while(X<v&&v<w);return k},h.filter=function(v){return pu(function(w){if(w>=w)for(;n(w),!v(w);)w.setTime(w-1)},function(w,I){if(w>=w)if(I<0)for(;++I<=0;)for(;c(w,-1),!v(w););else for(;--I>=0;)for(;c(w,1),!v(w););})},i&&(h.count=function(v,w){return Ff.setTime(+v),ph.setTime(+w),n(Ff),n(ph),Math.floor(i(Ff,ph))},h.every=function(v){return v=Math.floor(v),isFinite(v)&&v>0?v>1?h.filter(u?function(w){return u(w)%v==0}:function(w){return h.count(0,w)%v==0}):h:null}),h}var Wh=pu(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,c){n.setFullYear(n.getFullYear()+c)},function(n,c){return c.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});Wh.every=function(n){return isFinite(n=Math.floor(n))&&n>0?pu(function(c){c.setFullYear(Math.floor(c.getFullYear()/n)*n),c.setMonth(0,1),c.setHours(0,0,0,0)},function(c,i){c.setFullYear(c.getFullYear()+i*n)}):null};const zf=Wh;const nd=pu(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,c){n.setMonth(n.getMonth()+c)},function(n,c){return c.getMonth()-n.getMonth()+12*(c.getFullYear()-n.getFullYear())},function(n){return n.getMonth()});var dh=6e4,Rp=6048e5;function Lu(n){return pu(function(c){c.setDate(c.getDate()-(c.getDay()+7-n)%7),c.setHours(0,0,0,0)},function(c,i){c.setDate(c.getDate()+7*i)},function(c,i){return(i-c-(i.getTimezoneOffset()-c.getTimezoneOffset())*dh)/Rp})}var Dp=Lu(0),Kh=Lu(1),xc=(Lu(2),Lu(3),Lu(4));const qh=(Lu(5),Lu(6),pu(function(n){n.setHours(0,0,0,0)},function(n,c){n.setDate(n.getDate()+c)},function(n,c){return(c-n-(c.getTimezoneOffset()-n.getTimezoneOffset())*dh)/864e5},function(n){return n.getDate()-1}));const Fp=pu(function(n){n.setTime(n-n.getMilliseconds()-1e3*n.getSeconds()-n.getMinutes()*dh)},function(n,c){n.setTime(+n+36e5*c)},function(n,c){return(c-n)/36e5},function(n){return n.getHours()});const Zp=pu(function(n){n.setTime(n-n.getMilliseconds()-1e3*n.getSeconds())},function(n,c){n.setTime(+n+c*dh)},function(n,c){return(c-n)/dh},function(n){return n.getMinutes()});const sd=pu(function(n){n.setTime(n-n.getMilliseconds())},function(n,c){n.setTime(+n+1e3*c)},function(n,c){return(c-n)/1e3},function(n){return n.getUTCSeconds()});var dp=pu(function(){},function(n,c){n.setTime(+n+c)},function(n,c){return c-n});dp.every=function(n){return n=Math.floor(n),isFinite(n)&&n>0?n>1?pu(function(c){c.setTime(Math.floor(c/n)*n)},function(c,i){c.setTime(+c+i*n)},function(c,i){return(i-c)/n}):dp:null};const ud=dp;function Uf(n){return pu(function(c){c.setUTCDate(c.getUTCDate()-(c.getUTCDay()+7-n)%7),c.setUTCHours(0,0,0,0)},function(c,i){c.setUTCDate(c.getUTCDate()+7*i)},function(c,i){return(i-c)/Rp})}var ld=Uf(0),vp=Uf(1),_h=(Uf(2),Uf(3),Uf(4));const jd=(Uf(5),Uf(6),pu(function(n){n.setUTCHours(0,0,0,0)},function(n,c){n.setUTCDate(n.getUTCDate()+c)},function(n,c){return(c-n)/864e5},function(n){return n.getUTCDate()-1}));var Od=pu(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,c){n.setUTCFullYear(n.getUTCFullYear()+c)},function(n,c){return c.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});Od.every=function(n){return isFinite(n=Math.floor(n))&&n>0?pu(function(c){c.setUTCFullYear(Math.floor(c.getUTCFullYear()/n)*n),c.setUTCMonth(0,1),c.setUTCHours(0,0,0,0)},function(c,i){c.setUTCFullYear(c.getUTCFullYear()+i*n)}):null};const jp=Od;function Ld(n){if(0<=n.y&&n.y<100){var c=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return c.setFullYear(n.y),c}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function kd(n){if(0<=n.y&&n.y<100){var c=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return c.setUTCFullYear(n.y),c}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function Gp(n,c,i){return{y:n,m:c,d:i,H:0,M:0,S:0,L:0}}var gp,iv,Gd={"-":"",_:" ",0:"0"},ku=/^\s*\d+/,nm=/^%/,im=/[\\^$*+?|[\]().{}]/g;function _o(n,c,i){var u=n<0?"-":"",h=(u?-n:n)+"",v=h.length;return u+(v<i?new Array(i-v+1).join(c)+h:h)}function am(n){return n.replace(im,"\\$&")}function Hp(n){return new RegExp("^(?:"+n.map(am).join("|")+")","i")}function Wp(n){for(var c={},i=-1,u=n.length;++i<u;)c[n[i].toLowerCase()]=i;return c}function om(n,c,i){var u=ku.exec(c.slice(i,i+1));return u?(n.w=+u[0],i+u[0].length):-1}function sm(n,c,i){var u=ku.exec(c.slice(i,i+1));return u?(n.u=+u[0],i+u[0].length):-1}function um(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.U=+u[0],i+u[0].length):-1}function lm(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.V=+u[0],i+u[0].length):-1}function cm(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.W=+u[0],i+u[0].length):-1}function Hd(n,c,i){var u=ku.exec(c.slice(i,i+4));return u?(n.y=+u[0],i+u[0].length):-1}function Wd(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.y=+u[0]+(+u[0]>68?1900:2e3),i+u[0].length):-1}function fm(n,c,i){var u=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(c.slice(i,i+6));return u?(n.Z=u[1]?0:-(u[2]+(u[3]||"00")),i+u[0].length):-1}function hm(n,c,i){var u=ku.exec(c.slice(i,i+1));return u?(n.q=3*u[0]-3,i+u[0].length):-1}function pm(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.m=u[0]-1,i+u[0].length):-1}function Xd(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.d=+u[0],i+u[0].length):-1}function dm(n,c,i){var u=ku.exec(c.slice(i,i+3));return u?(n.m=0,n.d=+u[0],i+u[0].length):-1}function Yd(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.H=+u[0],i+u[0].length):-1}function vm(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.M=+u[0],i+u[0].length):-1}function mm(n,c,i){var u=ku.exec(c.slice(i,i+2));return u?(n.S=+u[0],i+u[0].length):-1}function gm(n,c,i){var u=ku.exec(c.slice(i,i+3));return u?(n.L=+u[0],i+u[0].length):-1}function ym(n,c,i){var u=ku.exec(c.slice(i,i+6));return u?(n.L=Math.floor(u[0]/1e3),i+u[0].length):-1}function _m(n,c,i){var u=nm.exec(c.slice(i,i+1));return u?i+u[0].length:-1}function xm(n,c,i){var u=ku.exec(c.slice(i));return u?(n.Q=+u[0],i+u[0].length):-1}function bm(n,c,i){var u=ku.exec(c.slice(i));return u?(n.s=+u[0],i+u[0].length):-1}function Kd(n,c){return _o(n.getDate(),c,2)}function Sm(n,c){return _o(n.getHours(),c,2)}function wm(n,c){return _o(n.getHours()%12||12,c,2)}function Em(n,c){return _o(1+qh.count(zf(n),n),c,3)}function qd(n,c){return _o(n.getMilliseconds(),c,3)}function Tm(n,c){return qd(n,c)+"000"}function Cm(n,c){return _o(n.getMonth()+1,c,2)}function Am(n,c){return _o(n.getMinutes(),c,2)}function Pm(n,c){return _o(n.getSeconds(),c,2)}function Im(n){var c=n.getDay();return 0===c?7:c}function Mm(n,c){return _o(Dp.count(zf(n)-1,n),c,2)}function Jd(n){var c=n.getDay();return c>=4||0===c?xc(n):xc.ceil(n)}function Om(n,c){return n=Jd(n),_o(xc.count(zf(n),n)+(4===zf(n).getDay()),c,2)}function Lm(n){return n.getDay()}function km(n,c){return _o(Kh.count(zf(n)-1,n),c,2)}function Rm(n,c){return _o(n.getFullYear()%100,c,2)}function Dm(n,c){return _o((n=Jd(n)).getFullYear()%100,c,2)}function Nm(n,c){return _o(n.getFullYear()%1e4,c,4)}function Bm(n,c){var i=n.getDay();return _o((n=i>=4||0===i?xc(n):xc.ceil(n)).getFullYear()%1e4,c,4)}function Fm(n){var c=n.getTimezoneOffset();return(c>0?"-":(c*=-1,"+"))+_o(c/60|0,"0",2)+_o(c%60,"0",2)}function $d(n,c){return _o(n.getUTCDate(),c,2)}function zm(n,c){return _o(n.getUTCHours(),c,2)}function Zm(n,c){return _o(n.getUTCHours()%12||12,c,2)}function Um(n,c){return _o(1+jd.count(jp(n),n),c,3)}function Qd(n,c){return _o(n.getUTCMilliseconds(),c,3)}function Vm(n,c){return Qd(n,c)+"000"}function jm(n,c){return _o(n.getUTCMonth()+1,c,2)}function Gm(n,c){return _o(n.getUTCMinutes(),c,2)}function Hm(n,c){return _o(n.getUTCSeconds(),c,2)}function Wm(n){var c=n.getUTCDay();return 0===c?7:c}function Xm(n,c){return _o(ld.count(jp(n)-1,n),c,2)}function ev(n){var c=n.getUTCDay();return c>=4||0===c?_h(n):_h.ceil(n)}function Ym(n,c){return n=ev(n),_o(_h.count(jp(n),n)+(4===jp(n).getUTCDay()),c,2)}function Km(n){return n.getUTCDay()}function qm(n,c){return _o(vp.count(jp(n)-1,n),c,2)}function Jm(n,c){return _o(n.getUTCFullYear()%100,c,2)}function $m(n,c){return _o((n=ev(n)).getUTCFullYear()%100,c,2)}function Qm(n,c){return _o(n.getUTCFullYear()%1e4,c,4)}function e0(n,c){var i=n.getUTCDay();return _o((n=i>=4||0===i?_h(n):_h.ceil(n)).getUTCFullYear()%1e4,c,4)}function t0(){return"+0000"}function tv(){return"%"}function rv(n){return+n}function nv(n){return Math.floor(+n/1e3)}gp=function(n){var c=n.dateTime,i=n.date,u=n.time,h=n.periods,v=n.days,w=n.shortDays,I=n.months,k=n.shortMonths,X=Hp(h),fe=Wp(h),se=Hp(v),Be=Wp(v),rt=Hp(w),Bt=Wp(w),Xt=Hp(I),Ar=Wp(I),Vr=Hp(k),sn=Wp(k),yn={a:function(Ri){return w[Ri.getDay()]},A:function(Ri){return v[Ri.getDay()]},b:function(Ri){return k[Ri.getMonth()]},B:function(Ri){return I[Ri.getMonth()]},c:null,d:Kd,e:Kd,f:Tm,g:Dm,G:Bm,H:Sm,I:wm,j:Em,L:qd,m:Cm,M:Am,p:function(Ri){return h[+(Ri.getHours()>=12)]},q:function(Ri){return 1+~~(Ri.getMonth()/3)},Q:rv,s:nv,S:Pm,u:Im,U:Mm,V:Om,w:Lm,W:km,x:null,X:null,y:Rm,Y:Nm,Z:Fm,"%":tv},Mn={a:function(Ri){return w[Ri.getUTCDay()]},A:function(Ri){return v[Ri.getUTCDay()]},b:function(Ri){return k[Ri.getUTCMonth()]},B:function(Ri){return I[Ri.getUTCMonth()]},c:null,d:$d,e:$d,f:Vm,g:$m,G:e0,H:zm,I:Zm,j:Um,L:Qd,m:jm,M:Gm,p:function(Ri){return h[+(Ri.getUTCHours()>=12)]},q:function(Ri){return 1+~~(Ri.getUTCMonth()/3)},Q:rv,s:nv,S:Hm,u:Wm,U:Xm,V:Ym,w:Km,W:qm,x:null,X:null,y:Jm,Y:Qm,Z:t0,"%":tv},Wn={a:function(Ri,eo,xo){var Un=rt.exec(eo.slice(xo));return Un?(Ri.w=Bt[Un[0].toLowerCase()],xo+Un[0].length):-1},A:function(Ri,eo,xo){var Un=se.exec(eo.slice(xo));return Un?(Ri.w=Be[Un[0].toLowerCase()],xo+Un[0].length):-1},b:function(Ri,eo,xo){var Un=Vr.exec(eo.slice(xo));return Un?(Ri.m=sn[Un[0].toLowerCase()],xo+Un[0].length):-1},B:function(Ri,eo,xo){var Un=Xt.exec(eo.slice(xo));return Un?(Ri.m=Ar[Un[0].toLowerCase()],xo+Un[0].length):-1},c:function(Ri,eo,xo){return Ui(Ri,c,eo,xo)},d:Xd,e:Xd,f:ym,g:Wd,G:Hd,H:Yd,I:Yd,j:dm,L:gm,m:pm,M:vm,p:function(Ri,eo,xo){var Un=X.exec(eo.slice(xo));return Un?(Ri.p=fe[Un[0].toLowerCase()],xo+Un[0].length):-1},q:hm,Q:xm,s:bm,S:mm,u:sm,U:um,V:lm,w:om,W:cm,x:function(Ri,eo,xo){return Ui(Ri,i,eo,xo)},X:function(Ri,eo,xo){return Ui(Ri,u,eo,xo)},y:Wd,Y:Hd,Z:fm,"%":_m};function ei(Ri,eo){return function(xo){var Sc,Jh,tm,Un=[],ec=-1,hs=0,bc=Ri.length;for(xo instanceof Date||(xo=new Date(+xo));++ec<bc;)37===Ri.charCodeAt(ec)&&(Un.push(Ri.slice(hs,ec)),null!=(Jh=Gd[Sc=Ri.charAt(++ec)])?Sc=Ri.charAt(++ec):Jh="e"===Sc?" ":"0",(tm=eo[Sc])&&(Sc=tm(xo,Jh)),Un.push(Sc),hs=ec+1);return Un.push(Ri.slice(hs,ec)),Un.join("")}}function ti(Ri,eo){return function(xo){var hs,bc,Un=Gp(1900,void 0,1);if(Ui(Un,Ri,xo+="",0)!=xo.length)return null;if("Q"in Un)return new Date(Un.Q);if("s"in Un)return new Date(1e3*Un.s+("L"in Un?Un.L:0));if(eo&&!("Z"in Un)&&(Un.Z=0),"p"in Un&&(Un.H=Un.H%12+12*Un.p),void 0===Un.m&&(Un.m="q"in Un?Un.q:0),"V"in Un){if(Un.V<1||Un.V>53)return null;"w"in Un||(Un.w=1),"Z"in Un?(bc=(hs=kd(Gp(Un.y,0,1))).getUTCDay(),hs=bc>4||0===bc?vp.ceil(hs):vp(hs),hs=jd.offset(hs,7*(Un.V-1)),Un.y=hs.getUTCFullYear(),Un.m=hs.getUTCMonth(),Un.d=hs.getUTCDate()+(Un.w+6)%7):(bc=(hs=Ld(Gp(Un.y,0,1))).getDay(),hs=bc>4||0===bc?Kh.ceil(hs):Kh(hs),hs=qh.offset(hs,7*(Un.V-1)),Un.y=hs.getFullYear(),Un.m=hs.getMonth(),Un.d=hs.getDate()+(Un.w+6)%7)}else("W"in Un||"U"in Un)&&("w"in Un||(Un.w="u"in Un?Un.u%7:"W"in Un?1:0),bc="Z"in Un?kd(Gp(Un.y,0,1)).getUTCDay():Ld(Gp(Un.y,0,1)).getDay(),Un.m=0,Un.d="W"in Un?(Un.w+6)%7+7*Un.W-(bc+5)%7:Un.w+7*Un.U-(bc+6)%7);return"Z"in Un?(Un.H+=Un.Z/100|0,Un.M+=Un.Z%100,kd(Un)):Ld(Un)}}function Ui(Ri,eo,xo,Un){for(var Sc,Jh,ec=0,hs=eo.length,bc=xo.length;ec<hs;){if(Un>=bc)return-1;if(37===(Sc=eo.charCodeAt(ec++))){if(Sc=eo.charAt(ec++),!(Jh=Wn[Sc in Gd?eo.charAt(ec++):Sc])||(Un=Jh(Ri,xo,Un))<0)return-1}else if(Sc!=xo.charCodeAt(Un++))return-1}return Un}return yn.x=ei(i,yn),yn.X=ei(u,yn),yn.c=ei(c,yn),Mn.x=ei(i,Mn),Mn.X=ei(u,Mn),Mn.c=ei(c,Mn),{format:function(Ri){var eo=ei(Ri+="",yn);return eo.toString=function(){return Ri},eo},parse:function(Ri){var eo=ti(Ri+="",!1);return eo.toString=function(){return Ri},eo},utcFormat:function(Ri){var eo=ei(Ri+="",Mn);return eo.toString=function(){return Ri},eo},utcParse:function(Ri){var eo=ti(Ri+="",!0);return eo.toString=function(){return Ri},eo}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),iv=gp.format;var Yp=6e4,Kp=60*Yp,qp=24*Kp,av=30*qp,Rd=365*qp;function s0(n){return new Date(n)}function u0(n){return n instanceof Date?+n:+new Date(+n)}function ov(n,c,i,u,h,v,w,I,k){var X=vc(qi,qi),fe=X.invert,se=X.domain,Be=k(".%L"),rt=k(":%S"),Bt=k("%I:%M"),Xt=k("%I %p"),Ar=k("%a %d"),Vr=k("%b %d"),sn=k("%B"),yn=k("%Y"),Mn=[[w,1,1e3],[w,5,5e3],[w,15,15e3],[w,30,3e4],[v,1,Yp],[v,5,5*Yp],[v,15,15*Yp],[v,30,30*Yp],[h,1,Kp],[h,3,3*Kp],[h,6,6*Kp],[h,12,12*Kp],[u,1,qp],[u,2,2*qp],[i,1,6048e5],[c,1,av],[c,3,3*av],[n,1,Rd]];function Wn(ti){return(w(ti)<ti?Be:v(ti)<ti?rt:h(ti)<ti?Bt:u(ti)<ti?Xt:c(ti)<ti?i(ti)<ti?Ar:Vr:n(ti)<ti?sn:yn)(ti)}function ei(ti,Ui,wa,Ua){if(null==ti&&(ti=10),"number"==typeof ti){var Mi=Math.abs(wa-Ui)/ti,Va=Ou(function(po){return po[2]}).right(Mn,Mi);Va===Mn.length?(Ua=sp(Ui/Rd,wa/Rd,ti),ti=n):Va?(Ua=(Va=Mn[Mi/Mn[Va-1][2]<Mn[Va][2]/Mi?Va-1:Va])[1],ti=Va[0]):(Ua=Math.max(sp(Ui,wa,ti),1),ti=I)}return null==Ua?ti:ti.every(Ua)}return X.invert=function(ti){return new Date(fe(ti))},X.domain=function(ti){return arguments.length?se(Se.call(ti,u0)):se().map(s0)},X.ticks=function(ti,Ui){var po,wa=se(),Ua=wa[0],Mi=wa[wa.length-1],Va=Mi<Ua;return Va&&(po=Ua,Ua=Mi,Mi=po),po=(po=ei(ti,Ua,Mi,Ui))?po.range(Ua,Mi+1):[],Va?po.reverse():po},X.tickFormat=function(ti,Ui){return null==Ui?Wn:k(Ui)},X.nice=function(ti,Ui){var wa=se();return(ti=ei(ti,wa[0],wa[wa.length-1],Ui))?se(Fh(wa,ti)):X},X.copy=function(){return Ss(X,ov(n,c,i,u,h,v,w,I,k))},X}var of,lv,cv,fv,Dd,hv,pv,dv,vv,mv,pd,gv,yv,g0=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,y0=((0,V.Z)(of={},W.ScaleTypes.LINEAR,function lh(){var n=vc(qi,qi);return n.copy=function(){return Ss(n,lh())},Je.apply(n,arguments),Sf(n)}),(0,V.Z)(of,W.ScaleTypes.POWER,function jh(){var n=wf(Pa());return n.copy=function(){return Ss(n,jh()).exponent(n.exponent())},Je.apply(n,arguments),n}),(0,V.Z)(of,W.ScaleTypes.LOG,function fp(){var n=rd(Pa()).domain([1,10]);return n.copy=function(){return Ss(n,fp()).base(n.base())},Je.apply(n,arguments),n}),(0,V.Z)(of,W.ScaleTypes.IDENTITY,function ch(n){var c;function i(u){return isNaN(u=+u)?c:u}return i.invert=i,i.domain=i.range=function(u){return arguments.length?(n=Se.call(u,Ja),i):n.slice()},i.unknown=function(u){return arguments.length?(c=u,i):c},i.copy=function(){return ch(n).unknown(c)},n=arguments.length?Se.call(n,Ja):[0,1],Sf(i)}),(0,V.Z)(of,W.ScaleTypes.TIME,function(){return Je.apply(ov(zf,nd,Dp,qh,Fp,Zp,sd,ud,iv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),(0,V.Z)(of,W.ScaleTypes.QUANTILE,function Gh(){var u,n=[],c=[],i=[];function h(){var w=0,I=Math.max(1,c.length);for(i=new Array(I-1);++w<I;)i[w-1]=xf(n,w/I);return v}function v(w){return isNaN(w=+w)?u:c[Zc(i,w)]}return v.invertExtent=function(w){var I=c.indexOf(w);return I<0?[NaN,NaN]:[I>0?i[I-1]:n[0],I<i.length?i[I]:n[n.length-1]]},v.domain=function(w){if(!arguments.length)return n.slice();n=[];for(var X,I=0,k=w.length;I<k;++I)null!=(X=w[I])&&!isNaN(X=+X)&&n.push(X);return n.sort(Xu),h()},v.range=function(w){return arguments.length?(c=qe.call(w),h()):c.slice()},v.unknown=function(w){return arguments.length?(u=w,v):u},v.quantiles=function(){return i.slice()},v.copy=function(){return Gh().domain(n).range(c).unknown(u)},Je.apply(v,arguments)}),(0,V.Z)(of,W.ScaleTypes.QUANTIZE,function _c(){var v,n=0,c=1,i=1,u=[.5],h=[0,1];function w(k){return k<=k?h[Zc(u,k,0,i)]:v}function I(){var k=-1;for(u=new Array(i);++k<i;)u[k]=((k+1)*c-(k-i)*n)/(i+1);return w}return w.domain=function(k){return arguments.length?(n=+k[0],c=+k[1],I()):[n,c]},w.range=function(k){return arguments.length?(i=(h=qe.call(k)).length-1,I()):h.slice()},w.invertExtent=function(k){var X=h.indexOf(k);return X<0?[NaN,NaN]:X<1?[n,u[0]]:X>=i?[u[i-1],c]:[u[X-1],u[X]]},w.unknown=function(k){return arguments.length&&(v=k),w},w.thresholds=function(){return u.slice()},w.copy=function(){return _c().domain([n,c]).range(h).unknown(v)},Je.apply(Sf(w),arguments)}),(0,V.Z)(of,W.ScaleTypes.THRESHOLD,function Hh(){var i,n=[.5],c=[0,1],u=1;function h(v){return v<=v?c[Zc(n,v,0,u)]:i}return h.domain=function(v){return arguments.length?(n=qe.call(v),u=Math.min(n.length,c.length-1),h):n.slice()},h.range=function(v){return arguments.length?(c=qe.call(v),u=Math.min(n.length,c.length-1),h):c.slice()},h.invertExtent=function(v){var w=c.indexOf(v);return[n[w-1],n[w]]},h.unknown=function(v){return arguments.length?(i=v,h):i},h.copy=function(){return Hh().domain(n).range(c).unknown(i)},Je.apply(h,arguments)}),(0,V.Z)(of,W.ScaleTypes.CAT,zt),of),_0=(lv=(0,va.b2)(),cv=(0,va.f3)(W.vK.IGlobalConfigService),lv((Dd=function(){function n(){(0,R.Z)(this,n),(0,Y.Z)(this,"configService",hv,this),(0,V.Z)(this,"scaleCache",{}),(0,V.Z)(this,"scaleOptions",{})}return(0,N.Z)(n,[{key:"apply",value:function(i,u){var h=this,v=u.styleAttributeService;i.hooks.init.tap("FeatureScalePlugin",function(){h.scaleOptions=i.getScaleOptions();var w=v.getLayerStyleAttributes(),I=i.getSource().data.dataArray;0!==I.length&&h.caculateScalesForAttributes(w||[],I)}),i.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){h.scaleOptions=i.getScaleOptions();var w=v.getLayerStyleAttributes(),I=i.getSource().data.dataArray;return h.caculateScalesForAttributes(w||[],I),i.layerModelNeedUpdate=!0,!0}),i.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!i.layerModelNeedUpdate){h.scaleOptions=i.getScaleOptions();var w=v.getLayerStyleAttributes();if(w){var I=i.getSource().data.dataArray;if(0===I.length)return;var k=w.filter(function(X){return X.needRescale});k.length&&h.caculateScalesForAttributes(k,I)}}})}},{key:"isNumber",value:function(i){return!isNaN(parseFloat(i))&&isFinite(i)}},{key:"caculateScalesForAttributes",value:function(i,u){var h=this;this.scaleCache={},i.forEach(function(v){if(v.scale){var w=v.scale,I=v.name;w.names=h.parseFields(v.scale.field||[]);var k=[];w.names.forEach(function(X){k.push(h.getOrCreateScale(X,v,u))}),k.some(function(X){return X.type===W.StyleScaleType.VARIABLE})?(w.type=W.StyleScaleType.VARIABLE,k.forEach(function(X){var fe;if(!w.callback)if(w.values&&"text"!==w.values){var se;if("linear"===(null===(se=X.option)||void 0===se?void 0:se.type)&&w.values.length>2){var Be=X.scale.ticks(w.values.length);"color"===I&&X.scale.domain(Be)}X.scale.range(w.values)}else"cat"===(null===(fe=X.option)||void 0===fe?void 0:fe.type)&&X.scale.range(X.option.domain)})):(w.type=W.StyleScaleType.CONSTANT,w.defaultValues=k.map(function(X,fe){return X.scale(w.names[fe])})),w.scalers=k.map(function(X){return{field:X.field,func:X.scale,option:X.option}}),v.needRescale=!1}})}},{key:"getOrCreateScale",value:function(i,u,h){[i,u.name].join("_");var v,I=null===(v=u.scale)||void 0===v?void 0:v.values;return this.createScale(i,u.name,I,h)}},{key:"parseFields",value:function(i){return Array.isArray(i)?i:In()(i)?i.split("*"):[i]}},{key:"createScale",value:function(i,u,h,v){var w,I,k=this.scaleOptions[u]&&(null===(w=this.scaleOptions[u])||void 0===w?void 0:w.field)===i?this.scaleOptions[u]:this.scaleOptions[i],X={field:i,scale:void 0,type:W.StyleScaleType.VARIABLE,option:k};if(!v||!v.length)return k&&k.type?X.scale=this.createDefaultScale(k):(X.scale=zt([i]),X.type=W.StyleScaleType.CONSTANT),X;var fe=null===(I=v.find(function(rt){return!zs()(rt[i])}))||void 0===I?void 0:I[i];if(this.isNumber(i)||zs()(fe)&&!k)X.scale=zt([i]),X.type=W.StyleScaleType.CONSTANT;else{var se=k&&k.type||this.getDefaultType(fe);"text"===h&&(se=W.ScaleTypes.CAT);var Be=this.createDefaultScaleConfig(se,i,v);Object.assign(Be,k),X.scale=this.createDefaultScale(Be),X.option=Be}return X}},{key:"getDefaultType",value:function(i){var u=W.ScaleTypes.LINEAR;return"string"==typeof i&&(u=g0.test(i)?W.ScaleTypes.TIME:W.ScaleTypes.CAT),u}},{key:"createDefaultScaleConfig",value:function(i,u,h){var v={type:i},w=(null==h?void 0:h.map(function(I){return I[u]}))||[];return i!==W.ScaleTypes.CAT&&i!==W.ScaleTypes.QUANTILE?v.domain=function(n,c){var h,v,w,i=n.length,u=-1;for(1;++u<i;)if(null!=(h=n[u])&&h>=h)for(v=w=h;++u<i;)null!=(h=n[u])&&(v>h&&(v=h),w<h&&(w=h));return[v,w]}(w):i===W.ScaleTypes.CAT?v.domain=ao()(w):i===W.ScaleTypes.QUANTILE&&(v.domain=w),v}},{key:"createDefaultScale",value:function(i){var h=i.domain,v=y0[i.type]();return h&&v.domain(h),v}}]),n}(),hv=(0,Ge.Z)(Dd.prototype,"configService",[cv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fv=Dd))||fv);function _v(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}var bv,wv,Tv,b0=(pv=(0,va.b2)(),dv=(0,va.f3)(W.vK.ICameraService),vv=(0,va.f3)(W.vK.IRendererService),pv((pd=function(){function n(){(0,R.Z)(this,n),(0,Y.Z)(this,"cameraService",gv,this),(0,Y.Z)(this,"rendererService",yv,this)}return(0,N.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){i.models.forEach(function(u){u.addUniforms(function(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?_v(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):_v(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}({},i.layerModel.getAnimateUniforms()))})})}}]),n}(),gv=(0,Ge.Z)(pd.prototype,"cameraService",[dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yv=(0,Ge.Z)(pd.prototype,"rendererService",[vv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mv=pd))||mv),S0=(0,va.b2)()(bv=function(){function n(){(0,R.Z)(this,n)}return(0,N.Z)(n,[{key:"apply",value:function(i){i.hooks.init.tap("LayerModelPlugin",function(){i.prepareBuildModel(),i.buildModels(),i.styleNeedUpdate=!1}),i.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return i.prepareBuildModel(),i.clearModels(),i.buildModels(),i.layerModelNeedUpdate=!1,!1})}}]),n}())||bv,w0=(0,va.b2)()(wv=function(){function n(){(0,R.Z)(this,n)}return(0,N.Z)(n,[{key:"apply",value:function(i){i.hooks.afterInit.tap("LayerStylePlugin",function(){i.updateLayerConfig({});var u=i.getLayerConfig(),v=u.fitBoundsOptions;u.autoFit&&setTimeout(function(){i.fitBounds(v)},100)})}}]),n}())||wv;function Cv(n,c){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);c&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Jp(n){for(var c=1;c<arguments.length;c++){var i=null!=arguments[c]?arguments[c]:{};c%2?Cv(Object(i),!0).forEach(function(u){(0,V.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Cv(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Iv,Ov,Lv,kv,Rv,Dv,Nv,Bv,yp,Fv,zv,Zv,Uv,jv,Hv,Av={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},E0={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},T0={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},C0={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},P0=(0,va.b2)()(Tv=function(){function n(){(0,R.Z)(this,n)}return(0,N.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("LightingPlugin",function(){i.getLayerConfig().enableLighting&&i.models.forEach(function(v){return v.addUniforms(Jp({},function(n){var c={u_DirectionalLights:new Array(3).fill(Jp({},T0)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Jp({},C0)),u_NumOfSpotLights:0};return(!n||!n.length)&&(n=[E0]),n.forEach(function(i,u){var h=i.type,v=void 0===h?"directional":h,w=(0,Mt.Z)(i,["type"]),I=Av[v].lights,k=Av[v].num,X=c[k];c[I][X]=Jp(Jp({},c[I][X]),w),c[k]++}),c}()))})})}}]),n}())||Tv,I0=(0,va.b2)()(Iv=function(){function n(){(0,R.Z)(this,n)}return(0,N.Z)(n,[{key:"apply",value:function(i,u){var v=u.styleAttributeService;i.hooks.init.tap("PixelPickingPlugin",function(){var I=i.getLayerConfig().enablePicking;v.registerStyleAttribute({name:"pickingColor",type:W.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:W.gl.FLOAT},size:3,update:function(X,fe){return I?(0,Ye.Z6)(X.id):[0,0,0]}}})}),i.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){i.getLayerConfig().enablePicking&&i.isVisible()&&i.models.forEach(function(k){return k.addUniforms({u_PickingStage:1})})}),i.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){i.getLayerConfig().enablePicking&&i.isVisible()&&i.models.forEach(function(k){return k.addUniforms({u_PickingStage:2})})}),i.hooks.beforeHighlight.tap("PixelPickingPlugin",function(w){var k=i.getLayerConfig().highlightColor,X="string"==typeof k?(0,Ye.CI)(k):k||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:(0,Ye.W0)(new Uint8Array(w))}),i.models.forEach(function(fe){return fe.addUniforms({u_PickingStage:2,u_PickingColor:w,u_HighlightColor:X.map(function(se){return 255*se})})})}),i.hooks.beforeSelect.tap("PixelPickingPlugin",function(w){var k=i.getLayerConfig().selectColor,X="string"==typeof k?(0,Ye.CI)(k):k||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:(0,Ye.W0)(new Uint8Array(w))}),i.models.forEach(function(fe){return fe.addUniforms({u_PickingStage:2,u_PickingColor:w,u_HighlightColor:X.map(function(se){return 255*se})})})})}}]),n}())||Iv,M0=(0,va.b2)()(Ov=function(){function n(){(0,R.Z)(this,n)}return(0,N.Z)(n,[{key:"apply",value:function(i,u){var h=this,v=u.styleAttributeService;i.hooks.init.tap("RegisterStyleAttributePlugin",function(){h.registerBuiltinAttributes(v)})}},{key:"registerBuiltinAttributes",value:function(i){i.registerStyleAttribute({name:"position",type:W.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:W.gl.FLOAT},size:3,update:function(h,v,w){return 2===w.length?[w[0],w[1],0]:[w[0],w[1],w[2]]}}}),i.registerStyleAttribute({name:"filter",type:W.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(h,v){return h.filter?[1]:[0]}}}),i.registerStyleAttribute({name:"color",type:W.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:4,update:function(h,v){var w=h.color;return w&&w.length?w:[1,1,1,1]}}}),i.registerStyleAttribute({name:"vertexId",type:W.AttributeType.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(h,v,w,I){return[v]}}})}}]),n}())||Ov,O0=(Lv=(0,va.b2)(),kv=(0,va.f3)(W.vK.ICameraService),Rv=(0,va.f3)(W.vK.ICoordinateSystemService),Dv=(0,va.f3)(W.vK.IRendererService),Nv=(0,va.f3)(W.vK.IMapService),Lv((yp=function(){function n(){(0,R.Z)(this,n),(0,Y.Z)(this,"cameraService",Fv,this),(0,Y.Z)(this,"coordinateSystemService",zv,this),(0,Y.Z)(this,"rendererService",Zv,this),(0,Y.Z)(this,"mapService",Uv,this)}return(0,N.Z)(n,[{key:"apply",value:function(i){var u=this,h=this.mapService.version,v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],w=[0,0];i.hooks.beforeRender.tap("ShaderUniformPlugin",function(){u.coordinateSystemService.refresh(),"GAODE2.x"===h&&(v=u.mapService.map.customCoords.getMVPMatrix(),w=u.mapService.getCustomCoordCenter());var I=u.rendererService.getViewportSize(),k=I.width,X=I.height;i.models.forEach(function(fe){var se;fe.addUniforms(((0,V.Z)(se={},W.CameraUniform.ProjectionMatrix,u.cameraService.getProjectionMatrix()),(0,V.Z)(se,W.CameraUniform.ViewMatrix,u.cameraService.getViewMatrix()),(0,V.Z)(se,W.CameraUniform.ViewProjectionMatrix,u.cameraService.getViewProjectionMatrix()),(0,V.Z)(se,W.CameraUniform.Zoom,u.cameraService.getZoom()),(0,V.Z)(se,W.CameraUniform.ZoomScale,u.cameraService.getZoomScale()),(0,V.Z)(se,W.CameraUniform.FocalDistance,u.cameraService.getFocalDistance()),(0,V.Z)(se,W.CameraUniform.CameraPosition,u.cameraService.getCameraPosition()),(0,V.Z)(se,W.CoordinateUniform.CoordinateSystem,u.coordinateSystemService.getCoordinateSystem()),(0,V.Z)(se,W.CoordinateUniform.ViewportCenter,u.coordinateSystemService.getViewportCenter()),(0,V.Z)(se,W.CoordinateUniform.ViewportCenterProjection,u.coordinateSystemService.getViewportCenterProjection()),(0,V.Z)(se,W.CoordinateUniform.PixelsPerDegree,u.coordinateSystemService.getPixelsPerDegree()),(0,V.Z)(se,W.CoordinateUniform.PixelsPerDegree2,u.coordinateSystemService.getPixelsPerDegree2()),(0,V.Z)(se,W.CoordinateUniform.PixelsPerMeter,u.coordinateSystemService.getPixelsPerMeter()),(0,V.Z)(se,W.CoordinateUniform.Mvp,v),(0,V.Z)(se,"u_SceneCenterMKT",w),(0,V.Z)(se,"u_ViewportSize",[k,X]),(0,V.Z)(se,"u_DevicePixelRatio",window.devicePixelRatio),(0,V.Z)(se,"u_ModelMatrix",u.cameraService.getModelMatrix()),(0,V.Z)(se,"u_PickingBuffer",i.getLayerConfig().pickingBuffer||0),se))})})}}]),n}(),Fv=(0,Ge.Z)(yp.prototype,"cameraService",[kv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zv=(0,Ge.Z)(yp.prototype,"coordinateSystemService",[Rv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zv=(0,Ge.Z)(yp.prototype,"rendererService",[Dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uv=(0,Ge.Z)(yp.prototype,"mapService",[Nv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bv=yp))||Bv),L0=(0,va.b2)()(jv=function(){function n(){(0,R.Z)(this,n)}return(0,N.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("UpdateModelPlugin",function(){i.layerModel&&i.layerModel.needUpdate()})}}]),n}())||jv,k0=(0,va.b2)()(Hv=function(){function n(){(0,R.Z)(this,n)}return(0,N.Z)(n,[{key:"apply",value:function(i,u){var h=this,v=u.styleAttributeService;i.hooks.init.tap("UpdateStyleAttributePlugin",function(){h.initStyleAttribute(i,{styleAttributeService:v})}),i.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){i.layerModelNeedUpdate||h.updateStyleAtrribute(i,{styleAttributeService:v})})}},{key:"updateStyleAtrribute",value:function(i,u){var h=u.styleAttributeService,v=h.getLayerStyleAttributes()||[],w=h.getLayerStyleAttribute("filter"),I=h.getLayerStyleAttribute("shape");if(w&&w.needRegenerateVertices||I&&I.needRegenerateVertices)return i.layerModelNeedUpdate=!0,void v.forEach(function(k){return k.needRegenerateVertices=!1});v.filter(function(k){return k.needRegenerateVertices}).forEach(function(k){h.updateAttributeByFeatureRange(k.name,i.getEncodedData(),k.featureRange.startIndex,k.featureRange.endIndex),k.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(i,u){var h=u.styleAttributeService;(h.getLayerStyleAttributes()||[]).filter(function(w){return w.needRegenerateVertices}).forEach(function(w){h.updateAttributeByFeatureRange(w.name,i.getEncodedData(),w.featureRange.startIndex,w.featureRange.endIndex),w.needRegenerateVertices=!1})}}]),n}())||Hv;W.nC.bind(W.vK.ILayerPlugin).to(jo).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(M0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(_0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(Hn).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(w0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(k0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(L0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(ul).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(O0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(b0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(P0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(I0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(S0).inRequestScope();var Vf=y(25917),jf=y(5304),Gf=y(88002),Nd=y(68939),R0=y(66660),Bd=y(91841);let D0=(()=>{class n{constructor(i){this.http=i}getSearchLockerCabinets(i){return this.http.get("smartlocker-locker/api/v1/locker-cabinets/unpaged?code.contains="+i)}getLockerCabinets(i){return this.http.get("smartlocker-locker/api/v1/locker-cabinets?code.equals="+i)}getAllLockerCabinets(i,u,h,v,w){let I="smartlocker-locker/api/v1/locker-cabinets/unpaged";return i&&""!==i.trim()&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?code.contains=":"&code.contains=",i)),u&&""!==u.trim()&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?maTinh.equals=":"&maTinh.equals=",u)),null!=h&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?maQuanHuyen.equals=":"&maQuanHuyen.equals=",h)),null!=v&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?phuongXaId.equals="+v:"&phuongXaId.equals="+v)),null!=w&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?buuCucId.equals="+w:"&buuCucId.equals="+w)),this.http.get(I)}getAllBuuCucUpgrade(i,u,h,v){let w="smartlocker/api/v1/buu-cucs/unpaged";return i&&""!==i.trim()&&(w=w.concat("smartlocker/api/v1/buu-cucs/unpaged"==w?"?maTinh.equals=":"&maTinh.equals=",i)),null!=u&&(w=w.concat("smartlocker/api/v1/buu-cucs/unpaged"==w?"?maQuanHuyen.equals=":"&maQuanHuyen.equals=",u)),null!=h&&(w=w.concat("smartlocker/api/v1/buu-cucs/unpaged"==w?"?phuongXaId.equals="+h:"&phuongXaId.equals="+h)),null!=v&&(w=w.concat("smartlocker/api/v1/buu-cucs/unpaged"==w?"?id.equals="+v:"&id.equals="+v)),this.http.get(w)}getBuuCuSearch(i=0,u=10,h,v,w){let I="smartlocker/api/v1/buu-cucs?page="+i+"&size="+u;return h&&""!==h.trim()&&(I=I.concat("&maTinh.equals=",h)),null!=v&&(I=I.concat("&maQuanHuyen.equals=",v)),null!=w&&(I=I.concat("&phuongXaId.equals="+w)),this.http.get(I)}getAllProvince(){return this.http.get("smartlocker/api/v1/vtp-tinhs/unpaged")}getProvinceByCode(i){return this.http.get("smartlocker/api/v1/vtp-tinhs?maTinh.contains="+i)}getDistById(i){return this.http.get("smartlocker/api/v1/vtp-quan-huyens?maQuanHuyen.equals="+i)}getWardsById(i){return this.http.get("smartlocker/api/v1/vtp-phuong-xas?id.equals="+i)}getDistByProvince(i){return this.http.get("smartlocker/api/v1/vtp-quan-huyens/unpaged?maTinh.equals="+i)}getWardByDist(i){return this.http.get("smartlocker/api/v1/vtp-phuong-xas/unpaged?quanHuyenId.equals="+i)}findPost(i=null,u=null){return this.http.get(u?"smartlocker/api/v1/buu-cucs?phuongXaId.equals="+u+"&page=0&size=200":"smartlocker/api/v1/buu-cucs?maQuanHuyen.equals="+i+"&page=0&size=200")}getPostOfficeToCode(i){return this.http.get("smartlocker/api/v1/buu-cucs?maBuuCuc.equals="+i)}getPostOfficeById(i){return this.http.get("smartlocker/api/v1/buu-cucs?id.equals="+i)}}return n.\u0275fac=function(i){return new(i||n)(m.LFG(Bd.eN))},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var N0=y(34100),Wv=y(17018),Fd=y(80269),zd=y(3679),Xv=y(14453),B0=y(29374),F0=y(84514),Yv=y(82677),Kv=y(25716),qv=y(76149),Jv=y(36442),$v=y(52496),Qv=y(53599),em=y(93845);let z0=(()=>{class n{transform(i){let u;switch(i){case 0:u="";break;case 1:u="green";break;case 2:u="red";break;case 3:u="#808080";break;case 4:u="gold"}return u}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=m.Yjl({name:"colorStatusDetail",type:n,pure:!0}),n})(),Z0=(()=>{class n{transform(i){let u;switch(i){case 0:u="OFFLINE";break;case 1:u="ONLINE";break;case 2:u="ERROR";break;case 3:u="FULL";break;case 4:u="LOCKED"}return u}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=m.Yjl({name:"textStatusDetail",type:n,pure:!0}),n})(),U0=(()=>{class n{transform(i,u){let h;switch(i){case 10:h=u.toLocaleUpperCase().startsWith("HUB")||u.toLocaleUpperCase().startsWith("CH")?"":"B\u01b0u C\u1ee5c";break;case 30:h=u.toLocaleUpperCase().startsWith("HUB")?"":"HUB";break;case 40:h=u.toLocaleUpperCase().startsWith("TTKNB")?"":"TTKNB";break;case 50:h=u.toLocaleUpperCase().startsWith("TTKT")?"":u.toLocaleUpperCase().startsWith("TTKT 1")||u.toLocaleUpperCase().startsWith("TTKT 2")||u.toLocaleUpperCase().startsWith("TTKT 3")||u.toLocaleUpperCase().startsWith("TTKT 4")?"TTKTL":"TTKT"}return h}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=m.Yjl({name:"levelPost",type:n,pure:!0}),n})();function V0(n,c){if(1&n&&m._UZ(0,"nz-option",45),2&n){const i=c.$implicit;m.Q6J("nzLabel",i.code)("nzValue",i.code)}}function j0(n,c){if(1&n&&m._UZ(0,"nz-option",46),2&n){const i=c.$implicit;m.Q6J("nzValue",i.maTinh)("nzLabel",i.name)}}function G0(n,c){if(1&n&&m._UZ(0,"nz-option",46),2&n){const i=c.$implicit;m.Q6J("nzValue",i.id)("nzLabel",i.tenQuanHuyen)}}function H0(n,c){if(1&n&&m._UZ(0,"nz-option",46),2&n){const i=c.$implicit;m.Q6J("nzValue",i.id)("nzLabel",i.name)}}function W0(n,c){if(1&n&&m._UZ(0,"nz-option",46),2&n){const i=c.$implicit;m.Q6J("nzValue",i.id)("nzLabel",i.name)}}function X0(n,c){1&n&&m._UZ(0,"nz-spin")}function Y0(n,c){if(1&n&&m.YNc(0,X0,1,0,"nz-spin",47),2&n){const i=m.oxw();m.Q6J("ngIf",i.isLoadingScroll)}}function K0(n,c){1&n&&m._UZ(0,"i",48)}function q0(n,c){1&n&&(m.TgZ(0,"h5",49),m._uU(1," T\u1ea5t c\u1ea3 c\xe1c b\u01b0u c\u1ee5c "),m.qZA())}function J0(n,c){1&n&&m._UZ(0,"i",48)}function $0(n,c){if(1&n&&(m.TgZ(0,"h5",49),m._uU(1),m.qZA()),2&n){const i=m.oxw();m.xp6(1),m.hij(" ",i.titleBreadCrumbProvince," ")}}function Q0(n,c){1&n&&m._UZ(0,"i",48)}function eg(n,c){if(1&n&&(m.TgZ(0,"h5",49),m._uU(1),m.qZA()),2&n){const i=m.oxw();m.xp6(1),m.hij(" ",i.titleBreadCrumbDist," ")}}function tg(n,c){1&n&&m._UZ(0,"i",48)}function rg(n,c){if(1&n&&(m.TgZ(0,"h5",49),m._uU(1),m.qZA()),2&n){const i=m.oxw();m.xp6(1),m.hij(" ",i.titleBreadCrumbWard," ")}}function ng(n,c){1&n&&m._UZ(0,"i",48)}function ig(n,c){if(1&n&&(m.TgZ(0,"h5",49),m._uU(1),m.qZA()),2&n){const i=m.oxw();m.xp6(1),m.hij(" ",i.titleBreadCrumbPost," ")}}function ag(n,c){1&n&&m._UZ(0,"i",48)}function og(n,c){if(1&n&&(m.TgZ(0,"h5",49),m._uU(1),m.qZA()),2&n){const i=m.oxw();m.xp6(1),m.hij(" ",i.titleBreadCrumb," ")}}function sg(n,c){1&n&&m._UZ(0,"img",50)}function ug(n,c){1&n&&m._UZ(0,"img",51)}function lg(n,c){1&n&&m._UZ(0,"img",52)}function cg(n,c){1&n&&m._UZ(0,"img",53)}function fg(n,c){1&n&&m._UZ(0,"img",54)}function hg(n,c){1&n&&m._UZ(0,"i",55)}function pg(n,c){1&n&&m._UZ(0,"i",56)}function dg(n,c){if(1&n){const i=m.EpF();m.TgZ(0,"div",57),m.TgZ(1,"h5",58),m._uU(2),m.qZA(),m.TgZ(3,"span",59),m.NdJ("click",function(){return m.CHM(i),m.oxw().clickMe()}),m._UZ(4,"i",60),m.qZA(),m.qZA()}if(2&n){const i=m.oxw();m.xp6(2),m.hij(" ",i.lockerItem&&i.lockerItem.code&&i.lockerItem.title?i.lockerItem.code.concat(" / ",i.lockerItem.title):"-"," ")}}function vg(n,c){if(1&n&&(m.TgZ(0,"nz-tag",78),m.ALo(1,"colorStatusDetail"),m._uU(2),m.ALo(3,"textStatusDetail"),m.qZA()),2&n){const i=m.oxw(2);m.Q6J("nzColor",m.lcZ(1,2,i.lockerItem.status)),m.xp6(2),m.Oqu(m.lcZ(3,4,i.lockerItem.status))}}function mg(n,c){1&n&&(m.TgZ(0,"div",79),m._uU(1," - "),m.qZA())}function gg(n,c){if(1&n&&(m.TgZ(0,"nz-tag",78),m.ALo(1,"colorStatusDetail"),m._uU(2),m.ALo(3,"textStatusDetail"),m.qZA()),2&n){const i=m.oxw(2);m.Q6J("nzColor",i.lockerItem.hardwareStatus.screen?m.lcZ(1,2,i.lockerItem.hardwareStatus.screen):""),m.xp6(2),m.Oqu(null!=i.lockerItem.hardwareStatus.screen?m.lcZ(3,4,i.lockerItem.hardwareStatus.screen):"-")}}function yg(n,c){1&n&&(m.TgZ(0,"span",79),m._uU(1,"-"),m.qZA())}function _g(n,c){if(1&n&&(m.TgZ(0,"nz-tag",78),m.ALo(1,"colorStatusDetail"),m._uU(2),m.ALo(3,"textStatusDetail"),m.qZA()),2&n){const i=m.oxw(2);m.Q6J("nzColor",i.lockerItem.hardwareStatus.firstCamera?m.lcZ(1,2,i.lockerItem.hardwareStatus.firstCamera):""),m.xp6(2),m.Oqu(null!=i.lockerItem.hardwareStatus.firstCamera?m.lcZ(3,4,i.lockerItem.hardwareStatus.firstCamera):"-")}}function xg(n,c){1&n&&(m.TgZ(0,"span",79),m._uU(1,"-"),m.qZA())}function bg(n,c){if(1&n&&(m.TgZ(0,"nz-tag",78),m.ALo(1,"colorStatusDetail"),m._uU(2),m.ALo(3,"textStatusDetail"),m.qZA()),2&n){const i=m.oxw(2);m.Q6J("nzColor",i.lockerItem.hardwareStatus.secondCamera?m.lcZ(1,2,i.lockerItem.hardwareStatus.secondCamera):""),m.xp6(2),m.Oqu(null!=i.lockerItem.hardwareStatus.secondCamera?m.lcZ(3,4,i.lockerItem.hardwareStatus.secondCamera):"-")}}function Sg(n,c){1&n&&(m.TgZ(0,"div",79),m._uU(1," - "),m.qZA())}function wg(n,c){if(1&n&&(m.TgZ(0,"nz-tag",78),m.ALo(1,"colorStatusDetail"),m._uU(2),m.ALo(3,"textStatusDetail"),m.qZA()),2&n){const i=m.oxw(2);m.Q6J("nzColor",i.lockerItem.hardwareStatus.powerMeter?m.lcZ(1,2,i.lockerItem.hardwareStatus.powerMeter):""),m.xp6(2),m.Oqu(null!=i.lockerItem.hardwareStatus.powerMeter?m.lcZ(3,4,i.lockerItem.hardwareStatus.powerMeter):"-")}}function Eg(n,c){1&n&&(m.TgZ(0,"div",79),m._uU(1," - "),m.qZA())}function Tg(n,c){if(1&n&&(m.TgZ(0,"nz-tag",78),m.ALo(1,"colorStatusDetail"),m._uU(2),m.ALo(3,"textStatusDetail"),m.qZA()),2&n){const i=m.oxw(2);m.Q6J("nzColor",i.lockerItem.hardwareStatus.wifi?m.lcZ(1,2,i.lockerItem.hardwareStatus.wifi):""),m.xp6(2),m.Oqu(null!=i.lockerItem.hardwareStatus.wifi?m.lcZ(3,4,i.lockerItem.hardwareStatus.wifi):"-")}}function Cg(n,c){if(1&n){const i=m.EpF();m.TgZ(0,"div",61),m.TgZ(1,"div",14),m.TgZ(2,"div",62),m._UZ(3,"img",63),m.TgZ(4,"span",64),m._uU(5,"B\u01b0u c\u1ee5c :"),m.qZA(),m.qZA(),m.TgZ(6,"div",65),m._uU(7),m.qZA(),m.qZA(),m.TgZ(8,"div",14),m.TgZ(9,"div",62),m._UZ(10,"img",66),m.TgZ(11,"span",64),m._uU(12,"\u0110\u1ecba ch\u1ec9 :"),m.qZA(),m.qZA(),m.TgZ(13,"div",65),m._uU(14),m.qZA(),m.qZA(),m.TgZ(15,"div",14),m.TgZ(16,"div",62),m._UZ(17,"img",67),m.TgZ(18,"span",64),m._uU(19,"Tr\u1ea1ng th\xe1i :"),m.qZA(),m.qZA(),m.TgZ(20,"div",65),m.YNc(21,vg,4,6,"nz-tag",68),m.qZA(),m.qZA(),m.TgZ(22,"div",69),m.TgZ(23,"div",70),m.TgZ(24,"div"),m.TgZ(25,"span",58),m._uU(26,"Giao d\u1ecbch"),m.qZA(),m.qZA(),m.TgZ(27,"div"),m.TgZ(28,"span",71),m._uU(29,"80"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(30,"div",70),m.TgZ(31,"div"),m.TgZ(32,"span",58),m._uU(33,"Ho\xe0n tr\u1ea3"),m.qZA(),m.qZA(),m.TgZ(34,"div"),m.TgZ(35,"span",71),m._uU(36,"80"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(37,"div",70),m.TgZ(38,"div"),m.TgZ(39,"span",58),m._uU(40,"C\xf2n tr\u1ed1ng"),m.qZA(),m.qZA(),m.TgZ(41,"div"),m.TgZ(42,"span",71),m._uU(43,"80"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(44,"div",70),m.TgZ(45,"div"),m.TgZ(46,"span",58),m._uU(47,"\u0110\u1ea7y"),m.qZA(),m.qZA(),m.TgZ(48,"div"),m.TgZ(49,"span",71),m._uU(50,"80"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(51,"div",70),m.TgZ(52,"div"),m.TgZ(53,"span",58),m._uU(54,"l\u1ed7i"),m.qZA(),m.qZA(),m.TgZ(55,"div"),m.TgZ(56,"span",71),m._uU(57,"80"),m.qZA(),m.qZA(),m.qZA(),m.TgZ(58,"div",70),m.TgZ(59,"div"),m.TgZ(60,"span",58),m._uU(61,"\u0110\xf3ng t\u1ee7"),m.qZA(),m.qZA(),m.TgZ(62,"div"),m.TgZ(63,"span",71),m._uU(64,"80"),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.TgZ(65,"div",69),m.TgZ(66,"div",72),m.TgZ(67,"div"),m.TgZ(68,"span",58),m._uU(69,"Phi\xean b\u1ea3n ph\u1ea7n m\u1ec1m"),m.qZA(),m.qZA(),m.TgZ(70,"div"),m.TgZ(71,"span",71),m._uU(72),m.qZA(),m.qZA(),m.qZA(),m.TgZ(73,"div",70),m.TgZ(74,"div"),m.TgZ(75,"span",58),m._uU(76,"M\xe0n h\xecnh"),m.qZA(),m.qZA(),m.TgZ(77,"div"),m.YNc(78,mg,2,0,"div",73),m.YNc(79,gg,4,6,"nz-tag",68),m.qZA(),m.qZA(),m.TgZ(80,"div",62),m.TgZ(81,"div"),m.TgZ(82,"span",58),m._uU(83,"Camera"),m.qZA(),m.qZA(),m.TgZ(84,"div"),m.TgZ(85,"div",74),m.TgZ(86,"span",58),m._uU(87,"Cam 1: "),m.qZA(),m.YNc(88,yg,2,0,"span",73),m.YNc(89,_g,4,6,"nz-tag",68),m.qZA(),m.TgZ(90,"div"),m.TgZ(91,"span",58),m._uU(92,"Cam 2: "),m.qZA(),m.YNc(93,xg,2,0,"span",73),m.YNc(94,bg,4,6,"nz-tag",68),m.qZA(),m.qZA(),m.qZA(),m.TgZ(95,"div",70),m.TgZ(96,"div"),m.TgZ(97,"span",58),m._uU(98,"C\xf4ng t\u01a1 \u0111i\u1ec7n"),m.qZA(),m.qZA(),m.TgZ(99,"div"),m.YNc(100,Sg,2,0,"div",73),m.YNc(101,wg,4,6,"nz-tag",68),m.qZA(),m.qZA(),m.TgZ(102,"div",75),m.TgZ(103,"div"),m.TgZ(104,"span",58),m._uU(105,"Wifi"),m.qZA(),m.qZA(),m.TgZ(106,"div"),m.YNc(107,Eg,2,0,"div",73),m.YNc(108,Tg,4,6,"nz-tag",68),m.qZA(),m.qZA(),m.qZA(),m.TgZ(109,"div",76),m.TgZ(110,"button",77),m.NdJ("click",function(){m.CHM(i);const h=m.oxw();return h.viewDetail(h.lockerItem.id)}),m._uU(111," Xem chi ti\u1ebft "),m.qZA(),m.qZA(),m.qZA()}if(2&n){const i=m.oxw();m.xp6(7),m.hij(" ",i.lockerItem&&i.lockerItem.buuCuc.maBuuCuc?i.lockerItem.buuCuc.maBuuCuc:"-"," "),m.xp6(7),m.hij(" ",i.lockerItem&&i.lockerItem.address&&i.lockerItem.address.detail?i.lockerItem.address.detail.concat(",",i.lockerItem.address.vtpPhuongXa.name,",",i.lockerItem.address.vtpPhuongXa.quanHuyen.tenQuanHuyen,",",i.lockerItem.address.vtpPhuongXa.quanHuyen.tinh.name):"-"," "),m.xp6(7),m.Q6J("ngIf",null!=i.lockerItem.status),m.xp6(51),m.Oqu(i.lockerItem&&i.lockerItem.hardwareStatus&&i.lockerItem.hardwareStatus.softwareVersion?i.lockerItem.hardwareStatus.softwareVersion:"-"),m.xp6(6),m.Q6J("ngIf",null==i.lockerItem.hardwareStatus),m.xp6(1),m.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),m.xp6(9),m.Q6J("ngIf",null==i.lockerItem.hardwareStatus),m.xp6(1),m.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),m.xp6(4),m.Q6J("ngIf",null==i.lockerItem.hardwareStatus),m.xp6(1),m.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),m.xp6(6),m.Q6J("ngIf",null==i.lockerItem.hardwareStatus),m.xp6(1),m.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),m.xp6(6),m.Q6J("ngIf",null==i.lockerItem.hardwareStatus),m.xp6(1),m.Q6J("ngIf",null!=i.lockerItem.hardwareStatus)}}function Ag(n,c){if(1&n){const i=m.EpF();m.TgZ(0,"div",57),m.TgZ(1,"h5",58),m._uU(2),m.ALo(3,"levelPost"),m.qZA(),m.TgZ(4,"span",59),m.NdJ("click",function(){return m.CHM(i),m.oxw().clickMePost()}),m._UZ(5,"i",60),m.qZA(),m.qZA()}if(2&n){const i=m.oxw();m.xp6(2),m.hij(" ",i.itemPostOffice&&i.itemPostOffice.name&&i.itemPostOffice.capBuuCuc?m.xi3(3,1,i.itemPostOffice.capBuuCuc,i.itemPostOffice.name).concat(" ",i.itemPostOffice.name):"-"," ")}}function Pg(n,c){if(1&n&&(m.TgZ(0,"div",80),m.TgZ(1,"div",81),m._UZ(2,"img",82),m.qZA(),m.TgZ(3,"div",14),m.TgZ(4,"div",72),m._UZ(5,"img",63),m.TgZ(6,"span",64),m._uU(7,"M\xe3 B\u01b0u c\u1ee5c :"),m.qZA(),m.qZA(),m.TgZ(8,"div",83),m._uU(9),m.qZA(),m.qZA(),m.TgZ(10,"div",14),m.TgZ(11,"div",72),m._UZ(12,"img",66),m.TgZ(13,"span",64),m._uU(14,"\u0110\u1ecba ch\u1ec9 :"),m.qZA(),m.qZA(),m.TgZ(15,"div",83),m._uU(16),m.qZA(),m.qZA(),m.TgZ(17,"div",84),m.TgZ(18,"div",72),m.TgZ(19,"span",85),m._uU(20,"M\xf4 t\u1ea3 :"),m.qZA(),m.qZA(),m.TgZ(21,"div",83),m._uU(22),m.qZA(),m.qZA(),m.qZA()),2&n){const i=m.oxw();m.xp6(9),m.hij(" ",i.itemPostOffice&&i.itemPostOffice.maBuuCuc?i.itemPostOffice.maBuuCuc:"-"," "),m.xp6(7),m.hij(" ",i.itemPostOffice&&i.itemPostOffice.address?i.itemPostOffice.address:"-"," "),m.xp6(6),m.hij(" ",i.itemPostOffice&&i.itemPostOffice.description?i.itemPostOffice.description:"-"," ")}}const Ig=function(){return[16,16]};let Mg=(()=>{class n{constructor(i,u,h,v){this.httpClient=i,this.mapService=u,this.router=h,this.baseService=v,this.visible=!1,this.countmap=0,this.visiblePost=!1,this.isLoadingMap=!1,this.listOfPostOffice=[],this.listOfHub=[],this.listOfTTKT=[],this.listOfTTB=[],this.listOfCH=[],this.countCH=0,this.countPost=0,this.countTTKT=0,this.countHub=0,this.countTTB=0,this.listOfPost=[],this.isLoadingScroll=!1,this.listOfCabinets=[],this.nzFilterOption=()=>!0,this.pageBuuCuc=0,this.sizeBuuCuc=10,this.totalBuuCuc=0}ngOnInit(){this.getBuuCucSearchLoad(),this.getProvince(),this.getData()}getDataCount(i){this.activeCount=0,this.offCount=0,this.fullCount=0,this.errorCount=0,this.lockerCount=0,i.forEach(u=>{switch(u.status){case 0:this.offCount=this.offCount+1;break;case 1:this.activeCount=+this.activeCount+1;break;case 2:this.errorCount=+this.errorCount+1;break;case 3:this.lockerCount=+this.lockerCount+1;break;case 4:this.fullCount=+this.fullCount+1}})}getCountPost(i){}getData(){this.httpClient.get("/assets/viettelpost.json").subscribe(i=>{this.scene=new ki({id:"map",map:new tl({pitch:0,style:i,center:[105.819746,21.023351],zoom:13,maxZoom:50})}),this.getLoad(),this.getDataLoadAllLocker(),this.getDataLoadAllPost()})}getLoad(){this.scene.on("loaded",()=>{fetch("/assets/map.json").then(h=>h.json()).then(h=>{this.countmap=this.countmap+1;const v=new We({}).source(h).active(!0);this.scene.addLayer(v)}),this.scene.addImage("postoffice","assets/b\u01b0u c\u1ee5c.svg"),this.scene.addImage("hub","assets/hub.svg"),this.scene.addImage("TTKT","assets/5Star.svg"),this.scene.addImage("TTB","assets/trung t\xe2m bay.svg"),this.scene.addImage("CH","assets/c\u1eeda h\xe0ng.svg"),this.scene.addImage("marker0","assets/locker-off.svg"),this.scene.addImage("marker1","assets/locker-onl.svg"),this.scene.addImage("marker2","assets/locker-error.svg"),this.scene.addImage("marker3","assets/locker-locked.svg"),this.scene.addImage("marker4","assets/locker-full.svg");const i=new ae({position:"topright"}),u=new ir({position:"bottomright"});this.scene.addControl(i),this.scene.addControl(u)})}getDataLoadAllLocker(){this.scene.on("loaded",()=>{this.mapService.getAllLockerCabinets(this.codeSearch,this.provinceName,this.distName,this.wardName,this.postId).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(i=>i.data.data)).subscribe(i=>{i.length>0&&(this.totalLocker=i.length,this.getDataCount(i),this.pointLayerLocker=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("status",function(h){let v="";switch(h){case 0:v="marker0";break;case 1:v="marker1";break;case 2:v="marker2";break;case 3:v="marker3";break;case 4:v="marker4"}return v}).size(13).active({color:"blue"}),this.pointLayerLocker.on("mouseup",h=>{this.visible=!1,this.datasend=h,this.clickPoint({bubbles:!0,detail:this.datasend})}),this.pointLayerLocker.on("mouseout",h=>{this.visible=!1}),this.scene.addLayer(this.pointLayerLocker),this.layersControl=new Ue({overlayers:{"T\u1ee7 SmartLocker":this.pointLayerLocker}}),this.scene.addControl(this.layersControl))})})}getDataLoadAllPost(){this.scene.on("loaded",()=>{this.isLoadingMap=!0,this.mapService.getAllBuuCucUpgrade(this.provinceName,this.distName,this.wardName,this.postId).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Nd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{this.totalPost=0,i.length>0&&(this.listOfTTKT=[],this.listOfHub=[],this.listOfPostOffice=[],this.listOfTTB=[],this.countPost=0,this.countTTKT=0,this.countHub=0,this.countTTB=0,this.listOfCH=[],this.countCH=0,i.forEach(u=>{switch(Number(u.capBuuCuc)){case 10:u.name.toLocaleUpperCase().startsWith("HUB")?this.listOfHub.push(u):u.name.toLocaleUpperCase().startsWith("CH")?this.listOfCH.push(u):this.listOfPostOffice.push(u);break;case 30:this.listOfHub.push(u);break;case 40:this.listOfTTB.push(u);break;case 50:this.listOfTTKT.push(u)}}),this.totalPost=this.listOfPostOffice.length,this.totalTTKT=this.listOfTTKT.length,this.totalTTB=this.listOfTTB.length,this.totalHUB=this.listOfHub.length,this.totalCH=this.listOfCH.length,this.pointLayerPost=new uo({}).source(this.listOfPostOffice,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("postoffice").size(14).active({color:"blue"}),this.pointLayerPost.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerPost.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerPost),this.getCountPost(this.scene),this.layersControl.addVisualLayer(this.pointLayerPost,"B\u01b0u C\u1ee5c"),this.getDataLoadAllCH(this.listOfCH),this.getDataLoadAllTTKT(this.listOfTTKT),this.getDataLoadAllTTB(this.listOfTTB),this.getDataLoadAllHUB(this.listOfHub),document.getElementsByClassName("l7-control-layers-selector")[1].addEventListener("click",()=>{this.countPost=this.countPost+1,this.totalPost=0==this.countPost||this.countPost%2==0?this.listOfPostOffice.length:0}),document.getElementsByClassName("l7-control-layers-selector")[2].addEventListener("click",()=>{this.countCH=this.countCH+1,this.totalCH=0==this.countCH||this.countCH%2==0?this.listOfCH.length:0}),document.getElementsByClassName("l7-control-layers-selector")[3].addEventListener("click",()=>{this.countTTKT=this.countTTKT+1,this.totalTTKT=0==this.countTTKT||this.countTTKT%2==0?this.listOfTTKT.length:0}),document.getElementsByClassName("l7-control-layers-selector")[4].addEventListener("click",()=>{this.countTTB=this.countTTB+1,this.totalTTB=0==this.countTTB||this.countTTB%2==0?this.listOfTTB.length:0}),document.getElementsByClassName("l7-control-layers-selector")[5].addEventListener("click",()=>{this.countHub=this.countHub+1,this.totalHUB=0==this.countHub||this.countHub%2==0?this.listOfHub.length:0}))})})}getDataLoadAllCH(i){this.pointLayerCH=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("CH").size(14).active({color:"blue"}),this.pointLayerCH.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerCH.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerCH),this.layersControl.addVisualLayer(this.pointLayerCH,"C\u1eeda h\xe0ng")}getDataLoadAllTTKT(i){this.pointLayerTTKT=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("TTKT").size(14).active({color:"blue"}),this.pointLayerTTKT.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerTTKT.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerTTKT),this.layersControl.addVisualLayer(this.pointLayerTTKT,"Trung T\xe2m Khai Th\xe1c")}getDataLoadAllTTB(i){this.pointLayerTTB=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("TTB").size(14).active({color:"blue"}),this.pointLayerTTB.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerTTB.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerTTB),this.layersControl.addVisualLayer(this.pointLayerTTB,"Trung T\xe2m Bay")}getDataLoadAllHUB(i){this.pointLayerHUB=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("hub").size(14).active({color:"blue"}),this.pointLayerHUB.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerHUB.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerHUB),this.layersControl.addVisualLayer(this.pointLayerHUB,"HUB")}clickPoint(i){this.lockerItem=i.detail.feature;let u=document.getElementById("popoverpoint");u.style.left=i.detail.x+"px",u.style.top=i.detail.y+"px",setTimeout(()=>{this.visible=!0},100)}clickMe(){this.visible=!1}clickPointPost(i){this.itemPostOffice=i.detail.feature;let u=document.getElementById("pointpost");u.style.left=i.detail.x+"px",u.style.top=i.detail.y+"px",setTimeout(()=>{this.visiblePost=!0},100)}clickMePost(){this.visiblePost=!1}change(i){}changePost(i){}viewDetail(i){this.router.navigateByUrl("/lockers/detail/"+i)}getDetailTitleMap(){null==this.provinceId&&(this.titleBreadCrumb="T\u1ea4T C\u1ea2 C\xc1C B\u01afU C\u1ee4C")}searchAll(){this.getDataItemLocker(),this.getDataItemPost()}searchCode(i){this.listOfCabinets=[],null!=i&&""!=i&&this.mapService.getSearchLockerCabinets(i).subscribe(u=>{u.data.data.length>0&&u.data.data.forEach(h=>{let v=new R0.i(h);this.listOfCabinets.push(v)})}),null!=this.codeSearch?this.mapService.getLockerCabinets(this.codeSearch).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{u.length>0&&(this.titleBreadCrumb=u[0].title)}):this.titleBreadCrumb=null,this.getDataItemLocker()}getProvince(){this.mapService.getAllProvince().subscribe(i=>{0==i.error&&(this.listOfProvince=i.data.data)})}pageChange(i){this.page=i,this.getDataItemLocker(),this.getDataItemPost()}getDataItemLocker(){this.isLoadingMap=!0,this.mapService.getAllLockerCabinets(this.codeSearch,this.provinceName,this.distName,this.wardName,this.postId).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Nd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{i.length>0?(this.totalLocker=i.length,this.getDataCount(i),this.pointLayerLocker.setData(i),this.scene.setZoomAndCenter(null!=this.postId?15:9,[i[0].longitude,i[0].latitude])):this.totalLocker=0})}getDataItemPost(){this.isLoadingMap=!0,this.totalPost=0,this.totalCH=0,this.totalHUB=0,this.totalTTB=0,this.totalTTKT=0,this.listOfTTKT=[],this.listOfHub=[],this.listOfPostOffice=[],this.listOfTTB=[],this.listOfCH=[],this.mapService.getAllBuuCucUpgrade(this.provinceName,this.distName,this.wardName,this.postId).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Nd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{i.length>0&&(i.forEach(u=>{switch(Number(u.capBuuCuc)){case 10:u.name.toLocaleUpperCase().startsWith("HUB")?this.listOfHub.push(u):u.name.toLocaleUpperCase().startsWith("CH")?this.listOfCH.push(u):this.listOfPostOffice.push(u);break;case 30:this.listOfHub.push(u);break;case 40:this.listOfTTB.push(u);break;case 50:this.listOfTTKT.push(u)}}),this.totalPost=this.listOfPostOffice.length,this.totalTTKT=this.listOfTTKT.length,this.totalTTB=this.listOfTTB.length,this.totalHUB=this.listOfHub.length,this.totalCH=this.listOfCH.length,this.pointLayerPost.setData(this.listOfPostOffice),this.pointLayerTTKT.setData(this.listOfTTKT),this.pointLayerTTB.setData(this.listOfTTB),this.pointLayerHUB.setData(this.listOfHub),this.pointLayerCH.setData(this.listOfCH),this.scene.setZoomAndCenter(null!=this.postId?15:null!=this.wardId&&null==this.postId?12:null==this.wardId&&null==this.postId&&null!=this.distId?11:9,[i[0].longitude,i[0].latitude]))})}provinceChange(i){this.provinceName=i,null!=i?(this.pageBuuCuc=0,this.listOfPost=[],this.mapService.getProvinceByCode(i).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{u.length>0&&(this.titleBreadCrumbProvince=u[0].name)}),this.mapService.getDistByProvince(i).subscribe(u=>{0==u.error&&(this.listOfWard=[],this.distId=null,this.wardId=null,this.wardName=null,this.distName=null,this.postId=null,this.listOfDist=u.data.data)})):(this.titleBreadCrumbProvince=null,this.titleBreadCrumbPost=null,this.titleBreadCrumbWard=null,this.titleBreadCrumbDist=null,this.pageBuuCuc=0,this.listOfPost=[],this.listOfDist=[],this.listOfWard=[],this.wardName=null,this.distName=null,this.postId=null,this.distId=null,this.wardId=null,this.provinceName=null),this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}distChange(i){if(this.distId=i,null!=i){this.pageBuuCuc=0,this.listOfPost=[];for(let u=0;u<this.listOfDist.length;u++)if(i==this.listOfDist[u].id){this.distName=this.listOfDist[u].maQuanHuyen,this.mapService.getDistById(this.distName).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(h=>h.data.data)).subscribe(h=>{h.length>0&&(this.titleBreadCrumbDist=h[0].tenQuanHuyen)});break}this.mapService.getWardByDist(i).subscribe(u=>{0==u.error&&(this.wardName=null,this.wardId=null,this.postId=null,this.listOfWard=u.data.data)})}else this.titleBreadCrumbDist=null,this.titleBreadCrumbPost=null,this.titleBreadCrumbWard=null,this.pageBuuCuc=0,this.listOfPost=[],this.listOfWard=[],this.wardName=null,this.postId=null,this.distName=null,this.distId=null,this.wardId=null;this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}wardChange(i){if(this.wardId=i,null!=i){this.pageBuuCuc=0,this.listOfPost=[];for(let u=0;u<this.listOfDist.length;u++)if(i==this.listOfWard[u].id){this.postId=null,this.wardName=this.listOfWard[u].id,this.mapService.getWardsById(this.wardName).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(h=>h.data.data)).subscribe(h=>{h.length>0&&(this.titleBreadCrumbWard=h[0].name)});break}}else this.titleBreadCrumbWard=null,this.titleBreadCrumbPost=null,this.pageBuuCuc=0,this.listOfPost=[],this.wardName=null,this.wardId=null,this.postId=null;this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}searchPost(i){this.postId=i,null!=i?this.mapService.getPostOfficeById(i).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{this.titleBreadCrumbPost=u[0].name}):this.titleBreadCrumbPost=null,this.getDataItemLocker(),this.getDataItemPost()}getBuuCucSearchLoad(){this.mapService.getBuuCuSearch(this.pageBuuCuc,this.sizeBuuCuc,this.provinceName,this.distName,this.wardName).subscribe(i=>{this.isLoadingScroll=!1,this.responseProcessBuuCuc(i)},i=>{console.log("Kh\xf4ng g\u01b0i \u0111\u01b0\u1ee3c th\xf4ng tin l\u1ea5y b\u01b0u c\u1ee5c",i)})}responseProcessBuuCuc(i){this.listOfPost=this.listOfPost==[]?i.data.data:this.listOfPost.concat(i.data.data),this.totalBuuCuc=i.data.total}loadMore(){this.totalBuuCuc>this.listOfPost.length&&(this.isLoadingScroll=!0,this.pageBuuCuc=this.pageBuuCuc+1,this.getBuuCucSearchLoad())}}return n.\u0275fac=function(i){return new(i||n)(m.Y36(Bd.eN),m.Y36(D0),m.Y36(l.F0),m.Y36(N0.bQ))},n.\u0275cmp=m.Xpm({type:n,selectors:[["cms-map"]],decls:101,vars:70,consts:[[1,"mt-0","mx-0"],["nz-row","",1,"row-search",3,"nzGutter"],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","4","nzXXl","5",1,"mt-1"],["nzShowSearch","","nzServerSearch","","nzAllowClear","","nzPlaceHolder","Nh\u1eadp m\xe3 locker",1,"width-full",3,"ngModel","nzShowArrow","nzFilterOption","ngModelChange","nzOnSearch"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","4","nzXXl","4",1,"mt-1"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn t\u1ec9nh","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn qu\u1eadn/huy\u1ec7n","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn ph\u01b0\u1eddng/x\xe3","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn b\u01b0u c\u1ee5c","nzAllowClear","",1,"width-full",3,"ngModel","nzDropdownRender","nzScrollToBottom","ngModelChange"],["renderTemplate",""],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","2","nzXXl","2",1,"mt-1"],["nz-button","","nzType","primary",3,"click"],["nz-row","",1,"mt-3"],["nz-col","","nzSpan","24"],["nz-typography","","nzType","secondary"],["nz-icon","","nzType","right","nzTheme","outline","class","next-segment",4,"ngIf"],["nz-typography","","class","mt-0 mb-2 d-inline-block",4,"ngIf"],[3,"nzSpinning"],["nz-row","","nzGutter","16"],["nz-col","","nzXs","24","nzSm","24","nzMd","5","nzLg","5","nzXl","4","nzXXl","3"],["nz-row",""],["nz-col","","nzXs","10","nzSm","11","nzMd","24","nzLg","24","nzXl","24","nzXXl","24",1,"top-statistic"],[3,"nzValue","nzTitle","nzPrefix"],["prefixTplOne",""],["prefixTplOne1",""],["prefixTplOne2",""],["prefixTplOne3",""],["prefixTplOne4",""],["prefixTplOne5",""],["prefixTplOne6",""],[1,"mt-4","status-tag"],["nzStatus","success","nzText","Kh\u1ea3 d\u1ee5ng",1,"d-inline-block","d-md-block","mb-2","ml-2"],["nzStatus","default","nzText","\u0110\u1ea7y",1,"d-inline-block","d-md-block","mb-2","ml-2"],["nzStatus","error","nzText","L\u1ed7i",1,"d-inline-block","d-md-block","ml-2"],["nz-col","","nzXs","24","nzSm","25","nzMd","19","nzLg","19","nzXl","20","nzXXl","21"],["id","map",1,"map-wrapper"],["id","popoverpoint"],["nz-popover","",3,"nzPopoverTitle","nzPopoverVisible","nzPopoverContent","nzPopoverVisibleChange"],["titleTemplate",""],["contentTemplate",""],["id","pointpost"],["titleTemplatePost",""],["contentTemplatePost",""],[3,"nzLabel","nzValue"],[3,"nzValue","nzLabel"],[4,"ngIf"],["nz-icon","","nzType","right","nzTheme","outline",1,"next-segment"],["nz-typography","",1,"mt-0","mb-2","d-inline-block"],["src","/assets/postofficeall.svg","height","18",1,"mr-2"],["src","/assets/locker (2).svg","height","18",1,"mr-2"],["src","/assets/active.svg","height","18",1,"mr-2"],["src","/assets/full.svg","height","18",1,"mr-2"],["src","/assets/error.svg","height","18",1,"mr-2"],["nz-icon","","nzType","lock","nzTheme","outline",1,"mr-2",2,"font-size","20px","color","red"],["nz-icon","","nzType","disconnect","nzTheme","outline",1,"mr-2",2,"font-size","20px","color","#808080"],[1,"pt-2",2,"display","flex","justify-content","space-between"],["nz-typography",""],[2,"cursor","pointer",3,"click"],["nz-icon","","nzType","close","nzTheme","outline"],[1,"ml-2"],["nz-col","","nzSpan","6"],["src","assets/homepost.svg",1,"mr-2"],["nz-col","",1,"text-bold"],["nz-col","","nzSpan","18"],["src","assets/address.svg",1,"mr-2"],["src","assets/active.svg","height","16","width","16",1,"mr-2"],[3,"nzColor",4,"ngIf"],["nz-row","",1,"mt-4"],["nz-col","","nzSpan","4"],[1,"text-bold"],["nz-col","","nzSpan","7"],["class","text-center",4,"ngIf"],[1,"mb-3"],["nz-col","","nzSpan","3"],["nz-row","","nzJustify","center",1,"mb-3","mt-4"],["nz-button","","nzType","primary",2,"cursor","pointer",3,"click"],[3,"nzColor"],[1,"text-center"],[1,"mx-2"],["nz-row","",1,"mt-3",2,"display","flex","justify-content","center"],["src","assets/banner-vtp.png",1,"mb-2",2,"width","100%","height","100%"],["nz-col","","nzSpan","17"],["nz-row","",1,"my-3"],["nz-col","",1,"text-bold","pl-5"]],template:function(i,u){if(1&i&&(m.TgZ(0,"nz-card"),m.TgZ(1,"div",0),m.TgZ(2,"div",1),m.TgZ(3,"div",2),m.TgZ(4,"nz-select",3),m.NdJ("ngModelChange",function(v){return u.codeSearch=v})("nzOnSearch",function(v){return u.searchCode(v)}),m.YNc(5,V0,1,2,"nz-option",4),m.qZA(),m.qZA(),m.TgZ(6,"div",5),m.TgZ(7,"nz-select",6),m.NdJ("ngModelChange",function(v){return u.provinceChange(v)}),m.YNc(8,j0,1,2,"nz-option",7),m.qZA(),m.qZA(),m.TgZ(9,"div",5),m.TgZ(10,"nz-select",8),m.NdJ("ngModelChange",function(v){return u.distChange(v)}),m.YNc(11,G0,1,2,"nz-option",7),m.qZA(),m.qZA(),m.TgZ(12,"div",5),m.TgZ(13,"nz-select",9),m.NdJ("ngModelChange",function(v){return u.wardChange(v)}),m.YNc(14,H0,1,2,"nz-option",7),m.qZA(),m.qZA(),m.TgZ(15,"div",5),m.TgZ(16,"nz-select",10),m.NdJ("nzScrollToBottom",function(){return u.loadMore()})("ngModelChange",function(v){return u.searchPost(v)}),m.YNc(17,W0,1,2,"nz-option",7),m.YNc(18,Y0,1,1,"ng-template",null,11,m.W1O),m.qZA(),m.qZA(),m.TgZ(20,"div",12),m.TgZ(21,"button",13),m.NdJ("click",function(){return u.searchAll()}),m._uU(22," T\xecm ki\u1ebfm "),m.qZA(),m.qZA(),m.qZA(),m.TgZ(23,"div",14),m.TgZ(24,"div",15),m.TgZ(25,"span",16),m._uU(26,"Th\u1ed1ng k\xea"),m.qZA(),m.YNc(27,K0,1,0,"i",17),m.YNc(28,q0,2,0,"h5",18),m.YNc(29,J0,1,0,"i",17),m.YNc(30,$0,2,1,"h5",18),m.YNc(31,Q0,1,0,"i",17),m.YNc(32,eg,2,1,"h5",18),m.YNc(33,tg,1,0,"i",17),m.YNc(34,rg,2,1,"h5",18),m.YNc(35,ng,1,0,"i",17),m.YNc(36,ig,2,1,"h5",18),m.YNc(37,ag,1,0,"i",17),m.YNc(38,og,2,1,"h5",18),m.qZA(),m.qZA(),m.TgZ(39,"nz-spin",19),m.TgZ(40,"div",20),m.TgZ(41,"div",21),m.TgZ(42,"div"),m.TgZ(43,"div",22),m.TgZ(44,"div",23),m._UZ(45,"nz-statistic",24),m.ALo(46,"number"),m.YNc(47,sg,1,0,"ng-template",null,25,m.W1O),m.qZA(),m.TgZ(49,"div",23),m._UZ(50,"nz-statistic",24),m.ALo(51,"number"),m.YNc(52,ug,1,0,"ng-template",null,26,m.W1O),m.qZA(),m.TgZ(54,"div",23),m._UZ(55,"nz-statistic",24),m.ALo(56,"number"),m.YNc(57,lg,1,0,"ng-template",null,27,m.W1O),m.qZA(),m.TgZ(59,"div",23),m._UZ(60,"nz-statistic",24),m.ALo(61,"number"),m.YNc(62,cg,1,0,"ng-template",null,28,m.W1O),m.qZA(),m.TgZ(64,"div",23),m._UZ(65,"nz-statistic",24),m.ALo(66,"number"),m.YNc(67,fg,1,0,"ng-template",null,29,m.W1O),m.qZA(),m.TgZ(69,"div",23),m._UZ(70,"nz-statistic",24),m.ALo(71,"number"),m.YNc(72,hg,1,0,"ng-template",null,30,m.W1O),m.qZA(),m.TgZ(74,"div",23),m._UZ(75,"nz-statistic",24),m.ALo(76,"number"),m.YNc(77,pg,1,0,"ng-template",null,31,m.W1O),m.qZA(),m.qZA(),m.TgZ(79,"div",32),m.TgZ(80,"p",16),m._uU(81,"Qui \u01b0\u1edbc m\xe0u"),m.qZA(),m._UZ(82,"nz-badge",33),m._UZ(83,"nz-badge",34),m._UZ(84,"nz-badge",35),m.qZA(),m.qZA(),m.qZA(),m.TgZ(85,"div",36),m._UZ(86,"div",37),m.TgZ(87,"div"),m.TgZ(88,"div",38),m.TgZ(89,"span",39),m.NdJ("nzPopoverVisibleChange",function(v){return u.change(v)}),m.qZA(),m.YNc(90,dg,5,1,"ng-template",null,40,m.W1O),m.YNc(92,Cg,112,14,"ng-template",null,41,m.W1O),m.qZA(),m.qZA(),m.TgZ(94,"div"),m.TgZ(95,"div",42),m.TgZ(96,"span",39),m.NdJ("nzPopoverVisibleChange",function(v){return u.changePost(v)}),m.qZA(),m.YNc(97,Ag,6,4,"ng-template",null,43,m.W1O),m.YNc(99,Pg,23,3,"ng-template",null,44,m.W1O),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA(),m.qZA()),2&i){const h=m.MAs(19),v=m.MAs(48),w=m.MAs(53),I=m.MAs(58),k=m.MAs(63),X=m.MAs(68),fe=m.MAs(73),se=m.MAs(78),Be=m.MAs(91),rt=m.MAs(93),Bt=m.MAs(98),Xt=m.MAs(100);m.xp6(2),m.Q6J("nzGutter",m.DdM(69,Ig)),m.xp6(2),m.Q6J("ngModel",u.codeSearch)("nzShowArrow",!1)("nzFilterOption",u.nzFilterOption),m.xp6(1),m.Q6J("ngForOf",u.listOfCabinets),m.xp6(2),m.Q6J("ngModel",u.provinceId),m.xp6(1),m.Q6J("ngForOf",u.listOfProvince),m.xp6(2),m.Q6J("ngModel",u.distId),m.xp6(1),m.Q6J("ngForOf",u.listOfDist),m.xp6(2),m.Q6J("ngModel",u.wardId),m.xp6(1),m.Q6J("ngForOf",u.listOfWard),m.xp6(2),m.Q6J("ngModel",u.postId)("nzDropdownRender",h)("nzDropdownRender",h),m.xp6(1),m.Q6J("ngForOf",u.listOfPost),m.xp6(10),m.Q6J("ngIf",null==u.titleBreadCrumbProvince&&null==u.titleBreadCrumbPost&&null==u.titleBreadCrumb),m.xp6(1),m.Q6J("ngIf",null==u.titleBreadCrumbProvince&&null==u.titleBreadCrumbPost&&null==u.titleBreadCrumb),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumbProvince),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumbProvince),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumbDist),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumbDist),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumbWard),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumbWard),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumbPost),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumbPost),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumb),m.xp6(1),m.Q6J("ngIf",null!=u.titleBreadCrumb),m.xp6(1),m.Q6J("nzSpinning",u.isLoadingMap),m.xp6(6),m.Q6J("nzValue",u.totalPost>=0&&u.totalTTB>=0&&u.totalHUB>=0&&u.totalTTKT>=0&&u.totalCH>=0?m.lcZ(46,55,u.totalPost+u.totalTTB+u.totalHUB+u.totalTTKT+u.totalCH):0)("nzTitle","T\u1ed5ng s\u1ed1 b\u01b0u c\u1ee5c")("nzPrefix",v),m.xp6(5),m.Q6J("nzValue",u.totalLocker?m.lcZ(51,57,u.totalLocker):0)("nzTitle","T\u1ed5ng S\u1ed1 Locker")("nzPrefix",w),m.xp6(5),m.Q6J("nzValue",u.activeCount?m.lcZ(56,59,u.activeCount):0)("nzTitle","\u0110ang kh\u1ea3 d\u1ee5ng")("nzPrefix",I),m.xp6(5),m.Q6J("nzValue",u.fullCount?m.lcZ(61,61,u.fullCount):0)("nzTitle","\u0110\u1ea7y")("nzPrefix",k),m.xp6(5),m.Q6J("nzValue",u.errorCount?m.lcZ(66,63,u.errorCount):0)("nzTitle","L\u1ed7i")("nzPrefix",X),m.xp6(5),m.Q6J("nzValue",u.lockerCount?m.lcZ(71,65,u.lockerCount):0)("nzTitle","Kh\xf3a")("nzPrefix",fe),m.xp6(5),m.Q6J("nzValue",u.offCount?m.lcZ(76,67,u.offCount):0)("nzTitle","T\u1eaft")("nzPrefix",se),m.xp6(14),m.Q6J("nzPopoverTitle",Be)("nzPopoverVisible",u.visible)("nzPopoverContent",rt),m.xp6(7),m.Q6J("nzPopoverTitle",Bt)("nzPopoverVisible",u.visiblePost)("nzPopoverContent",Xt)}},directives:[Wv.bd,O.SK,O.t3,Fd.Vq,zd.JJ,zd.On,_.sg,Xv.ix,B0.dQ,F0.w,Yv.ZU,_.O5,Kv.W,qv.my,Jv.x7,$v.lU,Fd.Ip,Qv.Ls,em.j],pipes:[_.JJ,z0,Z0,U0],styles:[".text-align[_ngcontent-%COMP%]{text-align:center}.next-segment[_ngcontent-%COMP%]{font-size:12px;color:#d9d9d9;margin-right:4px}.map-wrapper[_ngcontent-%COMP%]{justify-content:center;position:relative;min-height:calc(100vh - 220px);margin:6px 0 0;border-radius:6px;overflow:hidden}.top-statistic[_ngcontent-%COMP%]{background-color:#f6f6f6;border-radius:6px;margin:6px 16px 0 0;padding:10px 20px 6px}[_nghost-%COMP%]     .status-tag .ant-badge-status-dot{width:12px;height:12px}#popoverpoint[_ngcontent-%COMP%]{position:absolute}#pointpost[_ngcontent-%COMP%]{position:absolute}.width-full[_ngcontent-%COMP%]{width:100%!important}"]}),n})(),Og=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["cms-manager"]],decls:3,vars:0,consts:[["nz-row","",1,"my-4"],["nz-col","","nzXs","24","nzSm","24","nzMd","24","nzLg","24","nzXl","24"]],template:function(i,u){1&i&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m._UZ(2,"cms-map"),m.qZA(),m.qZA())},directives:[O.SK,O.t3,Mg],styles:[""]}),n})();const Lg=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=m.Xpm({type:n,selectors:[["cms-dashboard"]],decls:2,vars:0,consts:[[1,"dashboard-wrapper"]],template:function(i,u){1&i&&(m.TgZ(0,"div",0),m._UZ(1,"cms-manager"),m.qZA())},directives:[Og],styles:["[_nghost-%COMP%]     .date-select-charts{min-width:160px}"]}),n})()}];let kg=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({imports:[[l.Bz.forChild(Lg)],l.Bz]}),n})();var Rg=y(57674),Dg=y(83385),Ng=y(43654),Bg=y(52079),Fg=y(94401),zg=y(49703),Zg=y(87966),Ug=y(26214),Vg=y(39242),jg=y(13791);let Gg=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=m.oAB({type:n}),n.\u0275inj=m.cJS({imports:[[_.ez,kg,Xv.sL,Qv.PV,O.Jb,Rg.o7,Yv.ZJ,Wv.vh,Dg.S,Ng.HQ,Bg.Wr,Fg.b1,zg.Gb,Fd.LV,Zg.Hb,Bd.JF,zd.u5,Ug.Qp,Vg.VchartsModule,qv.A2,Jv.mS,jg.zf,$v.$6,em.X,Kv.j]]}),n})()},66660:(ne,L,y)=>{"use strict";y.d(L,{i:()=>M});class M{constructor(m){this.parse(m)}parse(m){this.id=m.id,this.serial=m.serial,this.code=m.code,this.secret=m.secret,this.address=m.address,this.provinceCode=m.provinceCode,this.districtCode=m.districtCode,this.latitude=m.latitude,this.longitude=m.longitude,this.description=m.description,this.location=m.location,this.buuCuc=m.buuCuc,this.adSchedule=m.adSchedule,this.status=m.status,this.title=m.title,this.category=m.category,this.hardwareStatus=m.hardwareStatus,this.supplier=m.supplier,this.type=m.type,this.buildingClass=m.buildingClass,this.place=m.place}}},88774:(ne,L,y)=>{ne.exports=y(67941)},70576:(ne,L,y)=>{"use strict";y.d(L,{zL:()=>O,DL:()=>tt,Ht:()=>Ue});var M=6371008.8,_={centimeters:100*M,centimetres:100*M,degrees:M/111325,feet:3.28084*M,inches:39.37*M,kilometers:M/1e3,kilometres:M/1e3,meters:M,metres:M,miles:M/1609.344,millimeters:1e3*M,millimetres:1e3*M,nauticalmiles:M/1852,radians:1,yards:1.0936*M};function O(le,ce,ae){void 0===ae&&(ae={});var me={type:"Feature"};return(0===ae.id||ae.id)&&(me.id=ae.id),ae.bbox&&(me.bbox=ae.bbox),me.properties=ce||{},me.geometry=le,me}function tt(le,ce){void 0===ce&&(ce="kilometers");var ae=_[ce];if(!ae)throw new Error(ce+" units is invalid");return le*ae}function Ue(le){return le%360*Math.PI/180}},56326:(ne,L,y)=>{"use strict";function M(_,l,m,O,R){var N={};return Object.keys(O).forEach(function(H){N[H]=O[H]}),N.enumerable=!!N.enumerable,N.configurable=!!N.configurable,("value"in N||N.initializer)&&(N.writable=!0),N=m.slice().reverse().reduce(function(H,j){return j(_,l,H)||H},N),R&&void 0!==N.initializer&&(N.value=N.initializer?N.initializer.call(R):void 0,N.initializer=void 0),void 0===N.initializer&&(Object.defineProperty(_,l,N),N=null),N}y.d(L,{Z:()=>M})},32988:(ne,L,y)=>{"use strict";function M(_,l){(null==l||l>_.length)&&(l=_.length);for(var m=0,O=new Array(l);m<l;m++)O[m]=_[m];return O}y.d(L,{Z:()=>M})},66518:(ne,L,y)=>{"use strict";function M(_){if(void 0===_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}y.d(L,{Z:()=>M})},75134:(ne,L,y)=>{"use strict";function M(_,l){if(!(_ instanceof l))throw new TypeError("Cannot call a class as a function")}y.d(L,{Z:()=>M})},47289:(ne,L,y)=>{"use strict";function M(l,m){for(var O=0;O<m.length;O++){var R=m[O];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(l,R.key,R)}}function _(l,m,O){return m&&M(l.prototype,m),O&&M(l,O),l}y.d(L,{Z:()=>_})},93512:(ne,L,y)=>{"use strict";function M(_,l,m){return l in _?Object.defineProperty(_,l,{value:m,enumerable:!0,configurable:!0,writable:!0}):_[l]=m,_}y.d(L,{Z:()=>M})},99187:(ne,L,y)=>{"use strict";function M(_){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)})(_)}y.d(L,{Z:()=>M})},41885:(ne,L,y)=>{"use strict";y.d(L,{Z:()=>_});var M=y(92007);function _(l,m){if("function"!=typeof m&&null!==m)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(m&&m.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),m&&(0,M.Z)(l,m)}},32952:(ne,L,y)=>{"use strict";function M(_,l,m,O){!m||Object.defineProperty(_,l,{enumerable:m.enumerable,configurable:m.configurable,writable:m.writable,value:m.initializer?m.initializer.call(O):void 0})}y.d(L,{Z:()=>M})},71189:(ne,L,y)=>{"use strict";function _(l,m){if(null==l)return{};var R,N,O=function(l,m){if(null==l)return{};var N,H,O={},R=Object.keys(l);for(H=0;H<R.length;H++)!(m.indexOf(N=R[H])>=0)&&(O[N]=l[N]);return O}(l,m);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(l);for(N=0;N<H.length;N++)!(m.indexOf(R=H[N])>=0)&&(!Object.prototype.propertyIsEnumerable.call(l,R)||(O[R]=l[R]))}return O}y.d(L,{Z:()=>_})},59553:(ne,L,y)=>{"use strict";y.d(L,{Z:()=>l});var M=y(85464),_=y(66518);function l(m,O){return!O||"object"!==(0,M.Z)(O)&&"function"!=typeof O?(0,_.Z)(m):O}},92007:(ne,L,y)=>{"use strict";function M(_,l){return(M=Object.setPrototypeOf||function(O,R){return O.__proto__=R,O})(_,l)}y.d(L,{Z:()=>M})},83838:(ne,L,y)=>{"use strict";y.d(L,{Z:()=>O});var l=y(2491);function O(R,N){return function(R){if(Array.isArray(R))return R}(R)||function(R,N){var H=null==R?null:"undefined"!=typeof Symbol&&R[Symbol.iterator]||R["@@iterator"];if(null!=H){var V,W,j=[],be=!0,Ne=!1;try{for(H=H.call(R);!(be=(V=H.next()).done)&&(j.push(V.value),!N||j.length!==N);be=!0);}catch(Ye){Ne=!0,W=Ye}finally{try{!be&&null!=H.return&&H.return()}finally{if(Ne)throw W}}return j}}(R,N)||(0,l.Z)(R,N)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},96109:(ne,L,y)=>{"use strict";y.d(L,{Z:()=>R});var M=y(32988),m=y(2491);function R(N){return function(N){if(Array.isArray(N))return(0,M.Z)(N)}(N)||function(N){if("undefined"!=typeof Symbol&&null!=N[Symbol.iterator]||null!=N["@@iterator"])return Array.from(N)}(N)||(0,m.Z)(N)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},85464:(ne,L,y)=>{"use strict";function M(_){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m})(_)}y.d(L,{Z:()=>M})},2491:(ne,L,y)=>{"use strict";y.d(L,{Z:()=>_});var M=y(32988);function _(l,m){if(l){if("string"==typeof l)return(0,M.Z)(l,m);var O=Object.prototype.toString.call(l).slice(8,-1);if("Object"===O&&l.constructor&&(O=l.constructor.name),"Map"===O||"Set"===O)return Array.from(l);if("Arguments"===O||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(O))return(0,M.Z)(l,m)}}}}]);