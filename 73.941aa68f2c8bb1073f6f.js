(self.webpackChunksmartlocker_workspace=self.webpackChunksmartlocker_workspace||[]).push([[73],{97185:(ie,L,y)=>{"use strict";function c(Ir,Mt){var Le="function"==typeof Symbol&&Ir[Symbol.iterator];if(!Le)return Ir;var at,qt,we=Le.call(Ir),Re=[];try{for(;(void 0===Mt||Mt-- >0)&&!(at=we.next()).done;)Re.push(at.value)}catch(Pr){qt={error:Pr}}finally{try{at&&!at.done&&(Le=we.return)&&Le.call(we)}finally{if(qt)throw qt.error}}return Re}function O(Ir){return Ir&&Ir.__esModule&&Object.prototype.hasOwnProperty.call(Ir,"default")?Ir.default:Ir}function R(Ir,Mt){return Ir(Mt={exports:{}},Mt.exports),Mt.exports}y.d(L,{zj:()=>Ge,oI:()=>cn,ni:()=>de,gg:()=>Nr});var B=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(we){return we&&"number"==typeof we.length&&we.length>=0&&we.length%1==0},Ir.exports=Mt.default});O(B);var H=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(Le){return function(){for(var we=[],at=arguments.length;at--;)we[at]=arguments[at];var Re=we.pop();return Le.call(this,we,Re)}},Ir.exports=Mt.default});O(H);var G=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.fallback=at,Mt.wrap=Re;var qt,Le=Mt.hasSetImmediate="function"==typeof setImmediate&&setImmediate,we=Mt.hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;function at(Pr){setTimeout(Pr,0)}function Re(Pr){return function(er){for(var fr=[],Br=arguments.length-1;Br-- >0;)fr[Br]=arguments[Br+1];return Pr(function(){return er.apply(void 0,fr)})}}qt=Le?setImmediate:we?process.nextTick:at,Mt.default=Re(qt)});O(G);var Ke=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(er){return(0,xt.isAsync)(er)?function(){for(var fr=[],Br=arguments.length;Br--;)fr[Br]=arguments[Br];var $r=fr.pop(),C=er.apply(this,fr);return qt(C,$r)}:(0,Le.default)(function(fr,Br){var $r;try{$r=er.apply(this,fr)}catch(C){return Br(C)}if($r&&"function"==typeof $r.then)return qt($r,Br);Br(null,$r)})};var Le=at(H),we=at(G);function at(er){return er&&er.__esModule?er:{default:er}}function qt(er,fr){return er.then(function(Br){Pr(fr,null,Br)},function(Br){Pr(fr,Br&&Br.message?Br:new Error(Br))})}function Pr(er,fr,Br){try{er(fr,Br)}catch($r){(0,we.default)(function(C){throw C},$r)}}Ir.exports=Mt.default});O(Ke);var xt=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.isAsyncIterable=Mt.isAsyncGenerator=Mt.isAsync=void 0;var er,Le=(er=Ke)&&er.__esModule?er:{default:er};function at(er){return"AsyncFunction"===er[Symbol.toStringTag]}Mt.default=function(er){if("function"!=typeof er)throw new Error("expected a function");return at(er)?(0,Le.default)(er):er},Mt.isAsync=at,Mt.isAsyncGenerator=function(er){return"AsyncGenerator"===er[Symbol.toStringTag]},Mt.isAsyncIterable=function(er){return"function"==typeof er[Symbol.asyncIterator]}});O(xt);var tt=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(we,at){if(void 0===at&&(at=we.length),!at)throw new Error("arity is undefined");function Re(){for(var qt=this,Pr=[],er=arguments.length;er--;)Pr[er]=arguments[er];return"function"==typeof Pr[at-1]?we.apply(this,Pr):new Promise(function(fr,Br){Pr[at-1]=function($r){for(var C=[],K=arguments.length-1;K-- >0;)C[K]=arguments[K+1];if($r)return Br($r);fr(C.length>1?C:C[0])},we.apply(qt,Pr)})}return Object.defineProperty(Re,"name",{configurable:!0,value:"awaitable("+we.name+")"}),Re},Ir.exports=Mt.default});O(tt);var Gt=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0});var Le=Re(B),we=Re(xt),at=Re(tt);function Re(qt){return qt&&qt.__esModule?qt:{default:qt}}Mt.default=(0,at.default)(function(qt,Pr,er){var fr=(0,Le.default)(Pr)?[]:{};qt(Pr,function(Br,$r,C){(0,we.default)(Br)(function(K){for(var nt=[],yt=arguments.length-1;yt-- >0;)nt[yt]=arguments[yt+1];nt.length<2&&(nt=nt[0]),fr[$r]=nt,C(K)})},function(Br){return er(Br,fr)})},3),Ir.exports=Mt.default});O(Gt);var Q=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(we){function at(){for(var Re=[],qt=arguments.length;qt--;)Re[qt]=arguments[qt];if(null!==we){var Pr=we;we=null,Pr.apply(this,Re)}}return Object.assign(at,we),at},Ir.exports=Mt.default});O(Q);var Vt=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(Le){return Le[Symbol.iterator]&&Le[Symbol.iterator]()},Ir.exports=Mt.default});O(Vt);var ot=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(fr){if((0,Le.default)(fr))return function(fr){var Br=-1,$r=fr.length;return function(){return++Br<$r?{value:fr[Br],key:Br}:null}}(fr);var Br=(0,we.default)(fr);return Br?function(fr){var Br=-1;return function(){var C=fr.next();return C.done?null:(Br++,{value:C.value,key:Br})}}(Br):function(fr){var Br=fr?Object.keys(fr):[],$r=-1,C=Br.length;return function(){var Ve=Br[++$r];return $r<C?{value:fr[Ve],key:Ve}:null}}(fr)};var Le=at(B),we=at(Vt);function at(fr){return fr&&fr.__esModule?fr:{default:fr}}Ir.exports=Mt.default});O(ot);var Ue=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(we){return function(){for(var at=[],Re=arguments.length;Re--;)at[Re]=arguments[Re];if(null===we)throw new Error("Callback was already called.");var qt=we;we=null,qt.apply(this,at)}},Ir.exports=Mt.default});O(Ue);var pt=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default={},Ir.exports=Mt.default});O(pt);var Xe=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(Re,qt,Pr,er){var fr=!1,Br=!1,$r=!1,C=0,K=0;function Ve(){C>=qt||$r||fr||($r=!0,Re.next().then(function(Lt){var Z=Lt.value;if(!Br&&!fr){if($r=!1,Lt.done)return fr=!0,void(C<=0&&er(null));C++,Pr(Z,K,nt),K++,Ve()}}).catch(yt))}function nt(Lt,Z){if(C-=1,!Br){if(Lt)return yt(Lt);if(!1===Lt)return fr=!0,void(Br=!0);if(Z===Le.default||fr&&C<=0)return fr=!0,er(null);Ve()}}function yt(Lt){Br||($r=!1,fr=!0,er(Lt))}Ve()};var Re,Le=(Re=pt)&&Re.__esModule?Re:{default:Re};Ir.exports=Mt.default});O(Xe);var At=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0});var Le=Pr(Q),we=Pr(ot),at=Pr(Ue),Re=Pr(Xe),qt=Pr(pt);function Pr(er){return er&&er.__esModule?er:{default:er}}Mt.default=function(er){return function(fr,Br,$r){if($r=(0,Le.default)($r),er<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!fr)return $r(null);if((0,xt.isAsyncGenerator)(fr))return(0,Re.default)(fr,er,Br,$r);if((0,xt.isAsyncIterable)(fr))return(0,Re.default)(fr[Symbol.asyncIterator](),er,Br,$r);var C=(0,we.default)(fr),K=!1,Ve=!1,nt=0,yt=!1;function Lt(Ze,St){if(!Ve)if(nt-=1,Ze)K=!0,$r(Ze);else if(!1===Ze)K=!0,Ve=!0;else{if(St===qt.default||K&&nt<=0)return K=!0,$r(null);yt||Z()}}function Z(){for(yt=!0;nt<er&&!K;){var Ze=C();if(null===Ze)return K=!0,void(nt<=0&&$r(null));nt+=1,Br(Ze.value,Ze.key,(0,at.default)(Lt))}yt=!1}Z()}},Ir.exports=Mt.default});O(At);var kt=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0});var Le=Re(At),we=Re(xt),at=Re(tt);function Re(Pr){return Pr&&Pr.__esModule?Pr:{default:Pr}}Mt.default=(0,at.default)(function(Pr,er,fr,Br){return(0,Le.default)(er)(Pr,(0,we.default)(fr),Br)},4),Ir.exports=Mt.default});O(kt);var Yt=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0});var Le=at(kt),we=at(tt);function at(qt){return qt&&qt.__esModule?qt:{default:qt}}Mt.default=(0,we.default)(function(qt,Pr,er){return(0,Le.default)(qt,1,Pr,er)},3),Ir.exports=Mt.default});O(Yt);var ge=O(R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(qt,Pr){return(0,Le.default)(we.default,qt,Pr)};var Le=at(Gt),we=at(Yt);function at(qt){return qt&&qt.__esModule?qt:{default:qt}}Ir.exports=Mt.default})),de=function(){function Ir(){for(var Mt=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Mt[we];this.args=[],this.tasks=[]}return Ir.prototype.call=function(){for(var Mt=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Mt[we];return this.args=Le,ge(this.tasks)},Ir.prototype.tap=function(Mt,Le){var we=this;this.tasks.push(function(at){Le.apply(void 0,function(){for(var Ir=[],Mt=0;Mt<arguments.length;Mt++)Ir=Ir.concat(c(arguments[Mt]));return Ir}(we.args)),at(null,Mt)})},Ir}(),oe=R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0});var Le=fr(B),we=fr(pt),at=fr(kt),Re=fr(Q),qt=fr(Ue),Pr=fr(xt),er=fr(tt);function fr(K){return K&&K.__esModule?K:{default:K}}function Br(K,Ve,nt){nt=(0,Re.default)(nt);var yt=0,Lt=0,Z=K.length,Ze=!1;function St(It,Jt){!1===It&&(Ze=!0),!0!==Ze&&(It?nt(It):(++Lt===Z||Jt===we.default)&&nt(null))}for(0===Z&&nt(null);yt<Z;yt++)Ve(K[yt],yt,(0,qt.default)(St))}function $r(K,Ve,nt){return(0,at.default)(K,1/0,Ve,nt)}Mt.default=(0,er.default)(function(K,Ve,nt){return((0,Le.default)(K)?Br:$r)(K,(0,Pr.default)(Ve),nt)},3),Ir.exports=Mt.default});O(oe);var Me=O(R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.default=function(qt,Pr){return(0,we.default)(Le.default,qt,Pr)};var Le=at(oe),we=at(Gt);function at(qt){return qt&&qt.__esModule?qt:{default:qt}}Ir.exports=Mt.default})),Ge=function(){function Ir(){for(var Mt=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Mt[we];this.tasks=[]}return Ir.prototype.promise=function(){for(var Mt=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Mt[we];return Me(this.tasks)},Ir.prototype.tapPromise=function(Mt,Le){var we=this;this.tasks.push(function(at){return function(Ir,Mt,Le,we){return new(Le||(Le=Promise))(function(Re,qt){function Pr(Br){try{fr(we.next(Br))}catch($r){qt($r)}}function er(Br){try{fr(we.throw(Br))}catch($r){qt($r)}}function fr(Br){Br.done?Re(Br.value):function(Re){return Re instanceof Le?Re:new Le(function(qt){qt(Re)})}(Br.value).then(Pr,er)}fr((we=we.apply(Ir,Mt||[])).next())})}(we,void 0,void 0,function(){return function(Ir,Mt){var we,at,Re,qt,Le={label:0,sent:function(){if(1&Re[0])throw Re[1];return Re[1]},trys:[],ops:[]};return qt={next:Pr(0),throw:Pr(1),return:Pr(2)},"function"==typeof Symbol&&(qt[Symbol.iterator]=function(){return this}),qt;function Pr(fr){return function(Br){return function(fr){if(we)throw new TypeError("Generator is already executing.");for(;Le;)try{if(we=1,at&&(Re=2&fr[0]?at.return:fr[0]?at.throw||((Re=at.return)&&Re.call(at),0):at.next)&&!(Re=Re.call(at,fr[1])).done)return Re;switch(at=0,Re&&(fr=[2&fr[0],Re.value]),fr[0]){case 0:case 1:Re=fr;break;case 4:return Le.label++,{value:fr[1],done:!1};case 5:Le.label++,at=fr[1],fr=[0];continue;case 7:fr=Le.ops.pop(),Le.trys.pop();continue;default:if(!(Re=(Re=Le.trys).length>0&&Re[Re.length-1])&&(6===fr[0]||2===fr[0])){Le=0;continue}if(3===fr[0]&&(!Re||fr[1]>Re[0]&&fr[1]<Re[3])){Le.label=fr[1];break}if(6===fr[0]&&Le.label<Re[1]){Le.label=Re[1],Re=fr;break}if(Re&&Le.label<Re[2]){Le.label=Re[2],Le.ops.push(fr);break}Re[2]&&Le.ops.pop(),Le.trys.pop();continue}fr=Mt.call(Ir,Le)}catch(Br){fr=[6,Br],at=0}finally{we=Re=0}if(5&fr[0])throw fr[1];return{value:fr[0]?fr[1]:void 0,done:!0}}([fr,Br])}}}(this,function(Re){switch(Re.label){case 0:return[4,Le()];case 1:return Re.sent(),at(null,Mt),[2]}})})})},Ir}(),br=O(R(function(Ir,Mt){Object.defineProperty(Mt,"__esModule",{value:!0});var Le=qt(Q),we=qt(Ue),at=qt(xt),Re=qt(tt);function qt(er){return er&&er.__esModule?er:{default:er}}Mt.default=(0,Re.default)(function(er,fr){if(fr=(0,Le.default)(fr),!Array.isArray(er))return fr(new Error("First argument to waterfall must be an array of functions"));if(!er.length)return fr();var Br=0;function $r(K){(0,at.default)(er[Br++]).apply(void 0,K.concat([(0,we.default)(C)]))}function C(K){for(var Ve=[],nt=arguments.length-1;nt-- >0;)Ve[nt]=arguments[nt+1];if(!1!==K){if(K||Br===er.length)return fr.apply(void 0,[K].concat(Ve));$r(Ve)}}$r([])}),Ir.exports=Mt.default})),Nr=function(){function Ir(){for(var Mt=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Mt[we];this.tasks=[]}return Ir.prototype.call=function(){for(var Mt=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Mt[we];return br(this.tasks)},Ir.prototype.tap=function(Mt,Le){this.tasks.push(0===this.tasks.length?function(we){var at=Le();we(!!at&&null,at)}:function(we,at){at(!!Le()&&null,Mt)})},Ir}(),cn=function(){function Ir(){for(var Mt=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Mt[we];this.tasks=[]}return Ir.prototype.call=function(){for(var Mt=arguments,Le=[],we=0;we<arguments.length;we++)Le[we]=Mt[we];return ge(this.tasks)},Ir.prototype.tap=function(Mt,Le){this.tasks.push(function(we){we(Le(),Mt)})},Ir}()},42837:(ie,L,y)=>{"use strict";y.d(L,{nC:()=>M.ZP,Hp:()=>M.Hp,e7:()=>M.e7,yT:()=>M.yT,vK:()=>c.v,BlendType:()=>O.h,AttributeType:()=>R.GC,ScaleTypes:()=>R.vY,StyleScaleType:()=>R.ee,MapServiceEvent:()=>G.I,CoordinateSystem:()=>be.l,CoordinateUniform:()=>be.k,CameraUniform:()=>W.l,SceneEventList:()=>Dt.P,PositionType:()=>ot.d,gl:()=>Pr.gl});var M=y(54184),c=(y(20051),y(92444)),O=(y(10120),y(35781)),R=y(39727),B=y(33511);y.o(B,"CameraUniform")&&y.d(L,{CameraUniform:function(){return B.CameraUniform}}),y.o(B,"CoordinateSystem")&&y.d(L,{CoordinateSystem:function(){return B.CoordinateSystem}}),y.o(B,"CoordinateUniform")&&y.d(L,{CoordinateUniform:function(){return B.CoordinateUniform}}),y.o(B,"Layers")&&y.d(L,{Layers:function(){return B.Layers}}),y.o(B,"MapServiceEvent")&&y.d(L,{MapServiceEvent:function(){return B.MapServiceEvent}}),y.o(B,"PointLayer")&&y.d(L,{PointLayer:function(){return B.PointLayer}}),y.o(B,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return B.PolygonLayer}}),y.o(B,"PositionType")&&y.d(L,{PositionType:function(){return B.PositionType}}),y.o(B,"Scene")&&y.d(L,{Scene:function(){return B.Scene}}),y.o(B,"SceneEventList")&&y.d(L,{SceneEventList:function(){return B.SceneEventList}}),y.o(B,"gl")&&y.d(L,{gl:function(){return B.gl}});var G=y(53262),be=y(62306),Be=y(75541);y.o(Be,"CameraUniform")&&y.d(L,{CameraUniform:function(){return Be.CameraUniform}}),y.o(Be,"Layers")&&y.d(L,{Layers:function(){return Be.Layers}}),y.o(Be,"PointLayer")&&y.d(L,{PointLayer:function(){return Be.PointLayer}}),y.o(Be,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Be.PolygonLayer}}),y.o(Be,"PositionType")&&y.d(L,{PositionType:function(){return Be.PositionType}}),y.o(Be,"Scene")&&y.d(L,{Scene:function(){return Be.Scene}}),y.o(Be,"SceneEventList")&&y.d(L,{SceneEventList:function(){return Be.SceneEventList}}),y.o(Be,"gl")&&y.d(L,{gl:function(){return Be.gl}});var W=y(40646),Ke=y(24495);y.o(Ke,"Layers")&&y.d(L,{Layers:function(){return Ke.Layers}}),y.o(Ke,"PointLayer")&&y.d(L,{PointLayer:function(){return Ke.PointLayer}}),y.o(Ke,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Ke.PolygonLayer}}),y.o(Ke,"PositionType")&&y.d(L,{PositionType:function(){return Ke.PositionType}}),y.o(Ke,"Scene")&&y.d(L,{Scene:function(){return Ke.Scene}}),y.o(Ke,"SceneEventList")&&y.d(L,{SceneEventList:function(){return Ke.SceneEventList}}),y.o(Ke,"gl")&&y.d(L,{gl:function(){return Ke.gl}});var Dt=y(80533),Et=y(63877);y.o(Et,"Layers")&&y.d(L,{Layers:function(){return Et.Layers}}),y.o(Et,"PointLayer")&&y.d(L,{PointLayer:function(){return Et.PointLayer}}),y.o(Et,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Et.PolygonLayer}}),y.o(Et,"PositionType")&&y.d(L,{PositionType:function(){return Et.PositionType}}),y.o(Et,"Scene")&&y.d(L,{Scene:function(){return Et.Scene}}),y.o(Et,"gl")&&y.d(L,{gl:function(){return Et.gl}});var tt=y(21236);y.o(tt,"Layers")&&y.d(L,{Layers:function(){return tt.Layers}}),y.o(tt,"PointLayer")&&y.d(L,{PointLayer:function(){return tt.PointLayer}}),y.o(tt,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return tt.PolygonLayer}}),y.o(tt,"PositionType")&&y.d(L,{PositionType:function(){return tt.PositionType}}),y.o(tt,"Scene")&&y.d(L,{Scene:function(){return tt.Scene}}),y.o(tt,"gl")&&y.d(L,{gl:function(){return tt.gl}});var Q=y(22115);y.o(Q,"Layers")&&y.d(L,{Layers:function(){return Q.Layers}}),y.o(Q,"PointLayer")&&y.d(L,{PointLayer:function(){return Q.PointLayer}}),y.o(Q,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Q.PolygonLayer}}),y.o(Q,"PositionType")&&y.d(L,{PositionType:function(){return Q.PositionType}}),y.o(Q,"Scene")&&y.d(L,{Scene:function(){return Q.Scene}}),y.o(Q,"gl")&&y.d(L,{gl:function(){return Q.gl}});var ot=y(59304),Ue=y(35323);y.o(Ue,"Layers")&&y.d(L,{Layers:function(){return Ue.Layers}}),y.o(Ue,"PointLayer")&&y.d(L,{PointLayer:function(){return Ue.PointLayer}}),y.o(Ue,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Ue.PolygonLayer}}),y.o(Ue,"Scene")&&y.d(L,{Scene:function(){return Ue.Scene}}),y.o(Ue,"gl")&&y.d(L,{gl:function(){return Ue.gl}});var Xe=y(35393);y.o(Xe,"Layers")&&y.d(L,{Layers:function(){return Xe.Layers}}),y.o(Xe,"PointLayer")&&y.d(L,{PointLayer:function(){return Xe.PointLayer}}),y.o(Xe,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Xe.PolygonLayer}}),y.o(Xe,"Scene")&&y.d(L,{Scene:function(){return Xe.Scene}}),y.o(Xe,"gl")&&y.d(L,{gl:function(){return Xe.gl}}),y(12260);var Yt=y(25655);y.o(Yt,"Layers")&&y.d(L,{Layers:function(){return Yt.Layers}}),y.o(Yt,"PointLayer")&&y.d(L,{PointLayer:function(){return Yt.PointLayer}}),y.o(Yt,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Yt.PolygonLayer}}),y.o(Yt,"Scene")&&y.d(L,{Scene:function(){return Yt.Scene}}),y.o(Yt,"gl")&&y.d(L,{gl:function(){return Yt.gl}});var ge=y(94671);y.o(ge,"Layers")&&y.d(L,{Layers:function(){return ge.Layers}}),y.o(ge,"PointLayer")&&y.d(L,{PointLayer:function(){return ge.PointLayer}}),y.o(ge,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return ge.PolygonLayer}}),y.o(ge,"Scene")&&y.d(L,{Scene:function(){return ge.Scene}}),y.o(ge,"gl")&&y.d(L,{gl:function(){return ge.gl}});var oe=y(75846);y.o(oe,"Layers")&&y.d(L,{Layers:function(){return oe.Layers}}),y.o(oe,"PointLayer")&&y.d(L,{PointLayer:function(){return oe.PointLayer}}),y.o(oe,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return oe.PolygonLayer}}),y.o(oe,"Scene")&&y.d(L,{Scene:function(){return oe.Scene}}),y.o(oe,"gl")&&y.d(L,{gl:function(){return oe.gl}});var Me=y(81210);y.o(Me,"Layers")&&y.d(L,{Layers:function(){return Me.Layers}}),y.o(Me,"PointLayer")&&y.d(L,{PointLayer:function(){return Me.PointLayer}}),y.o(Me,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Me.PolygonLayer}}),y.o(Me,"Scene")&&y.d(L,{Scene:function(){return Me.Scene}}),y.o(Me,"gl")&&y.d(L,{gl:function(){return Me.gl}});var gt=y(20626);y.o(gt,"Layers")&&y.d(L,{Layers:function(){return gt.Layers}}),y.o(gt,"PointLayer")&&y.d(L,{PointLayer:function(){return gt.PointLayer}}),y.o(gt,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return gt.PolygonLayer}}),y.o(gt,"Scene")&&y.d(L,{Scene:function(){return gt.Scene}}),y.o(gt,"gl")&&y.d(L,{gl:function(){return gt.gl}});var Nr=y(6974);y.o(Nr,"Layers")&&y.d(L,{Layers:function(){return Nr.Layers}}),y.o(Nr,"PointLayer")&&y.d(L,{PointLayer:function(){return Nr.PointLayer}}),y.o(Nr,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Nr.PolygonLayer}}),y.o(Nr,"Scene")&&y.d(L,{Scene:function(){return Nr.Scene}}),y.o(Nr,"gl")&&y.d(L,{gl:function(){return Nr.gl}}),y(55576);var Mt=y(23824);y.o(Mt,"Layers")&&y.d(L,{Layers:function(){return Mt.Layers}}),y.o(Mt,"PointLayer")&&y.d(L,{PointLayer:function(){return Mt.PointLayer}}),y.o(Mt,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Mt.PolygonLayer}}),y.o(Mt,"Scene")&&y.d(L,{Scene:function(){return Mt.Scene}}),y.o(Mt,"gl")&&y.d(L,{gl:function(){return Mt.gl}});var we=y(34710);y.o(we,"Layers")&&y.d(L,{Layers:function(){return we.Layers}}),y.o(we,"PointLayer")&&y.d(L,{PointLayer:function(){return we.PointLayer}}),y.o(we,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return we.PolygonLayer}}),y.o(we,"Scene")&&y.d(L,{Scene:function(){return we.Scene}}),y.o(we,"gl")&&y.d(L,{gl:function(){return we.gl}});var Re=y(27159);y.o(Re,"Layers")&&y.d(L,{Layers:function(){return Re.Layers}}),y.o(Re,"PointLayer")&&y.d(L,{PointLayer:function(){return Re.PointLayer}}),y.o(Re,"PolygonLayer")&&y.d(L,{PolygonLayer:function(){return Re.PolygonLayer}}),y.o(Re,"Scene")&&y.d(L,{Scene:function(){return Re.Scene}}),y.o(Re,"gl")&&y.d(L,{gl:function(){return Re.gl}});var Pr=y(24558)},54184:(ie,L,y)=>{"use strict";y.d(L,{e7:()=>Ni,Hp:()=>yi,ZP:()=>ji,yT:()=>Dn}),y(78320);var Ue,_=y(42624),c=y.n(_),g=y(15922),O=y(43857),R=y(92444),B=y(75134),H=y(47289),G=y(93512),be=y(30832),Be=y(51002),j=y.n(Be);function W(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function Ke(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?W(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):W(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}function xt(te,ne){var N="undefined"!=typeof Symbol&&te[Symbol.iterator]||te["@@iterator"];if(!N){if(Array.isArray(te)||(N=function(te,ne){if(te){if("string"==typeof te)return Et(te,undefined);var N=Object.prototype.toString.call(te).slice(8,-1);if("Object"===N&&te.constructor&&(N=te.constructor.name),"Map"===N||"Set"===N)return Array.from(te);if("Arguments"===N||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return Et(te,undefined)}}(te))||ne&&te&&"number"==typeof te.length){N&&(te=N);var U=0,he=function(){};return{s:he,n:function(){return U>=te.length?{done:!0}:{done:!1,value:te[U++]}},e:function(ur){throw ur},f:he}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Rt,Te=!0,vt=!1;return{s:function(){N=N.call(te)},n:function(){var ur=N.next();return Te=ur.done,ur},e:function(ur){vt=!0,Rt=ur},f:function(){try{!Te&&null!=N.return&&N.return()}finally{if(vt)throw Rt}}}}function Et(te,ne){(null==ne||ne>te.length)&&(ne=te.length);for(var N=0,U=new Array(ne);N<ne;N++)U[N]=te[N];return U}function Q(te,ne,N){var he,U=xt(ne);try{for(U.s();!(he=U.n()).done;){var Te=he.value,vt=Te.icon,Rt=Te.xOffset;te[vt.id]=Ke(Ke({},vt),{},{x:Rt,y:N,image:vt.image,width:vt.width,height:vt.height})}}catch(Ot){U.e(Ot)}finally{U.f()}}function Vt(te){return Math.pow(2,Math.ceil(Math.log2(te)))}function pt(te,ne){var N="undefined"!=typeof Symbol&&te[Symbol.iterator]||te["@@iterator"];if(!N){if(Array.isArray(te)||(N=function(te,ne){if(te){if("string"==typeof te)return At(te,undefined);var N=Object.prototype.toString.call(te).slice(8,-1);if("Object"===N&&te.constructor&&(N=te.constructor.name),"Map"===N||"Set"===N)return Array.from(te);if("Arguments"===N||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return At(te,undefined)}}(te))||ne&&te&&"number"==typeof te.length){N&&(te=N);var U=0,he=function(){};return{s:he,n:function(){return U>=te.length?{done:!0}:{done:!1,value:te[U++]}},e:function(ur){throw ur},f:he}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Rt,Te=!0,vt=!1;return{s:function(){N=N.call(te)},n:function(){var ur=N.next();return Te=ur.done,ur},e:function(ur){vt=!0,Rt=ur},f:function(){try{!Te&&null!=N.return&&N.return()}finally{if(vt)throw Rt}}}}function At(te,ne){(null==ne||ne>te.length)&&(ne=te.length);for(var N=0,U=new Array(ne);N<ne;N++)U[N]=te[N];return U}function kt(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function Yt(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?kt(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):kt(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var Er=function(){for(var te=[],ne=32;ne<128;ne++)te.push(String.fromCharCode(ne));return te}();function Le(te,ne,N,U){te.font="".concat(U," ").concat(N,"px ").concat(ne),te.fillStyle="black",te.textBaseline="middle"}function we(te,ne){for(var N=0;N<te.length;N++)ne.data[4*N+3]=te[N]}var Br,at=(0,g.b2)()(Ue=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"fontAtlas",void 0),(0,G.Z)(this,"iconFontMap",void 0),(0,G.Z)(this,"iconFontGlyphs",{}),(0,G.Z)(this,"fontOptions",void 0),(0,G.Z)(this,"key",void 0),(0,G.Z)(this,"cache",new be.z6(3))}return(0,H.Z)(te,[{key:"scale",get:function(){return 1}},{key:"canvas",get:function(){var N=this.cache.get(this.key);return N&&N.data}},{key:"mapping",get:function(){var N=this.cache.get(this.key);return N&&N.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:"sans-serif",fontWeight:"normal",characterSet:Er,fontSize:24,buffer:3,sdf:!0,cutoff:.25,radius:8,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(N){var U=this;N.forEach(function(he){U.iconFontGlyphs[he.name]=he.unicode})}},{key:"addIconFont",value:function(N,U){this.iconFontMap.set(N,U)}},{key:"getIconFontKey",value:function(N){return this.iconFontMap.get(N)||N}},{key:"getGlyph",value:function(N){return this.iconFontGlyphs[N]?String.fromCharCode(parseInt(this.iconFontGlyphs[N],16)):""}},{key:"setFontOptions",value:function(N){this.fontOptions=Yt(Yt({},this.fontOptions),N),this.key=this.getKey();var U=this.getNewChars(this.key,this.fontOptions.characterSet),he=this.cache.get(this.key);if(!he||0!==U.length){var Te=this.generateFontAtlas(this.key,U,he);this.fontAtlas=Te,this.cache.set(this.key,Te)}}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(N,U,he){var Te=this.fontOptions,vt=Te.fontFamily,Rt=Te.fontWeight,Ot=Te.fontSize,ur=Te.buffer,Vr=Te.sdf,Ln=Te.radius,Xn=Te.cutoff,ni=Te.iconfont,Ci=he&&he.data;Ci||((Ci=document.createElement("canvas")).width=1024);var Si=Ci.getContext("2d");Le(Si,vt,Ot,Rt);var ea=function(te){var N=te.getFontWidth,U=te.fontHeight,he=te.buffer,Te=te.maxCanvasWidth,vt=te.mapping,Rt=void 0===vt?{}:vt,Ot=te.xOffset,Vr=te.yOffset,Ln=void 0===Vr?0:Vr,Xn=0,ni=void 0===Ot?0:Ot;Array.from(te.characterSet).forEach(function(Si,ea){if(!Rt[Si]){var xa=N(Si,ea);ni+30>Te&&(ni=0,Xn++),Rt[Si]={x:ni,y:Ln+30*Xn,width:30,height:30,advance:xa},ni+=30}});var Ci=U+2*he;return{mapping:Rt,xOffset:ni,yOffset:Ln+Xn*Ci,canvasHeight:Vt(Ln+(Xn+1)*Ci)}}(Yt({getFontWidth:function(Su){return Si.measureText(Su).width},fontHeight:1*Ot,buffer:ur,characterSet:U,maxCanvasWidth:1024},he&&{mapping:he.mapping,xOffset:he.xOffset,yOffset:he.yOffset})),xa=ea.mapping,ua=ea.canvasHeight,Ha=ea.xOffset,Wa=ea.yOffset,Ya=Si.getImageData(0,0,Ci.width,Ci.height);if(Ci.height=ua,Si.putImageData(Ya,0,0),Le(Si,vt,Ot,Rt),Vr){var no,ia=new(j())(Ot,ur,Ln,Xn,vt,Rt),ga=Si.getImageData(0,0,ia.size,ia.size),la=pt(U);try{for(la.s();!(no=la.n()).done;){var ki=no.value;if(ni){var Ca=String.fromCharCode(parseInt(ki.replace("&#x","").replace(";",""),16));we(ia.draw(Ca),ga)}else we(ia.draw(ki),ga);Si.putImageData(ga,xa[ki].x,xa[ki].y)}}catch(Yo){la.e(Yo)}finally{la.f()}}else{var Kl,go=pt(U);try{for(go.s();!(Kl=go.n()).done;){var uu=Kl.value;Si.fillText(uu,xa[uu].x,xa[uu].y+1*Ot)}}catch(Yo){go.e(Yo)}finally{go.f()}}return{xOffset:Ha,yOffset:Wa,mapping:xa,data:Ci,width:Ci.width,height:Ci.height}}},{key:"getKey",value:function(){return"key"}},{key:"getNewChars",value:function(N,U){var he=this.cache.get(N);if(!he)return U;var Te=[],Rt=new Set(Object.keys(he.mapping));return new Set(U).forEach(function(ur){Rt.has(ur)||Te.push(ur)}),Te}}]),te}())||Ue,Re=y(66518),qt=y(41885),Pr=y(59553),er=y(99187);var St,Tr,yt=(0,g.b2)()(Br=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){var U;(0,B.Z)(this,N);for(var he=arguments.length,Te=new Array(he),vt=0;vt<he;vt++)Te[vt]=arguments[vt];return U=ne.call.apply(ne,[this].concat(Te)),(0,G.Z)((0,Re.Z)(U),"canvasHeight",128),(0,G.Z)((0,Re.Z)(U),"texture",void 0),(0,G.Z)((0,Re.Z)(U),"canvas",void 0),(0,G.Z)((0,Re.Z)(U),"iconData",void 0),(0,G.Z)((0,Re.Z)(U),"iconMap",void 0),(0,G.Z)((0,Re.Z)(U),"ctx",void 0),(0,G.Z)((0,Re.Z)(U),"loadingImageCount",0),U}return(0,H.Z)(N,[{key:"isLoading",value:function(){return 0===this.loadingImageCount}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(he,Te){var vt=this,Rt=new Image;if(this.loadingImageCount++,this.hasImage(he))throw new Error("Image Id already exists");this.iconData.push({id:he,size:64}),this.updateIconMap(),this.loadImage(Te).then(function(Ot){Rt=Ot;var ur=vt.iconData.find(function(Vr){return Vr.id===he});ur&&(ur.image=Rt,ur.width=Rt.width,ur.height=Rt.height),vt.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(he){return this.iconMap.hasOwnProperty(he)}},{key:"removeImage",value:function(he){this.hasImage(he)&&(this.iconData=this.iconData.filter(function(Te){return Te.id!==he}),delete this.iconMap[he],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,0===this.loadingImageCount&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var he=this;this.canvas.width=1024,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(Te){var vt=he.iconMap[Te],Rt=vt.x,Ot=vt.y,ur=vt.image,Vr=vt.width,Ln=void 0===Vr?64:Vr,Xn=vt.height,ni=void 0===Xn?64:Xn,Si=Math.max(Ln,ni)/64,ea=ni/Si,xa=Ln/Si;ur&&he.ctx.drawImage(ur,Rt+(64-xa)/2,Ot+(64-ea)/2,xa,ea)})}},{key:"updateIconMap",value:function(){var he=function(te,ne,N){var ur,U=0,he=0,Te=0,vt=[],Rt={},Ot=xt(te);try{for(Ot.s();!(ur=Ot.n()).done;){var Vr=ur.value;if(!Rt[Vr.id]){var Ln=Vr.size;U+Ln+3>1024&&(Q(Rt,vt,he),U=0,he=Te+he+3,Te=0,vt=[]),vt.push({icon:Vr,xOffset:U}),U=U+Ln+3,Te=Math.max(Te,Ln)}}}catch(ni){Ot.e(ni)}finally{Ot.f()}return vt.length>0&&Q(Rt,vt,he),{mapping:Rt,canvasHeight:Vt(Te+he+3)}}(this.iconData),vt=he.canvasHeight;this.iconMap=he.mapping,this.canvasHeight=vt}},{key:"loadImage",value:function(he){return new Promise(function(Te,vt){if(he instanceof HTMLImageElement)Te(he);else{var Rt=new Image;Rt.crossOrigin="anonymous",Rt.onload=function(){Te(Rt)},Rt.onerror=function(){vt(new Error("Could not load image at "+he))},Rt.src=he instanceof File?URL.createObjectURL(he):he}})}}]),N}(_.EventEmitter))||Br,Lt=y(83838),Z=y(30651),It=(0,g.b2)()(St=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"viewport",void 0),(0,G.Z)(this,"overridedViewProjectionMatrix",void 0),(0,G.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,G.Z)(this,"jitteredProjectionMatrix",void 0),(0,G.Z)(this,"viewMatrixInverse",void 0),(0,G.Z)(this,"cameraPosition",void 0)}return(0,H.Z)(te,[{key:"init",value:function(){}},{key:"update",value:function(N){this.viewport=N,this.viewMatrixInverse=Z.create(),Z.invert(this.viewMatrixInverse,N.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var N=this.viewport.getCenter(),U=(0,Lt.Z)(N,2);return[U[0],U[1]]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(N,U){return this.viewport.projectFlat(N,U)}},{key:"setViewProjectionMatrix",value:function(N){this.overridedViewProjectionMatrix=N}},{key:"jitterProjectionMatrix",value:function(N,U){var he=Z.fromTranslation(Z.create(),[N,U,0]);this.jitteredProjectionMatrix=Z.multiply(Z.create(),he,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=Z.multiply(Z.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),te}())||St;function mr(te,ne){(null==ne||ne>te.length)&&(ne=te.length);for(var N=0,U=new Array(ne);N<ne;N++)U[N]=te[N];return U}var mn,hi,or=(0,g.b2)()(Tr=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"container",void 0),(0,G.Z)(this,"controlCorners",void 0),(0,G.Z)(this,"controlContainer",void 0),(0,G.Z)(this,"scene",void 0),(0,G.Z)(this,"mapsService",void 0),(0,G.Z)(this,"controls",[]),(0,G.Z)(this,"unAddControls",[])}return(0,H.Z)(te,[{key:"init",value:function(N,U){this.container=N.container,this.scene=U,this.mapsService=U.get(R.v.IMapService),this.initControlPos()}},{key:"addControl",value:function(N,U){U.get(R.v.IMapService).map?(N.addTo(this.scene),this.controls.push(N)):this.unAddControls.push(N)}},{key:"getControlByName",value:function(N){return this.controls.find(function(U){return U.controlOption.name===N})}},{key:"removeControl",value:function(N){var U=this.controls.indexOf(N);return U>-1&&this.controls.splice(U,1),N.remove(),this}},{key:"addControls",value:function(){var N=this;this.unAddControls.forEach(function(U){U.addTo(N.scene),N.controls.push(U)}),this.unAddControls=[]}},{key:"destroy",value:function(){var U,N=function(te,ne){var N="undefined"!=typeof Symbol&&te[Symbol.iterator]||te["@@iterator"];if(!N){if(Array.isArray(te)||(N=function(te,ne){if(te){if("string"==typeof te)return mr(te,void 0);var N=Object.prototype.toString.call(te).slice(8,-1);if("Object"===N&&te.constructor&&(N=te.constructor.name),"Map"===N||"Set"===N)return Array.from(te);if("Arguments"===N||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return mr(te,void 0)}}(te))||ne&&te&&"number"==typeof te.length){N&&(te=N);var U=0,he=function(){};return{s:he,n:function(){return U>=te.length?{done:!0}:{done:!1,value:te[U++]}},e:function(ur){throw ur},f:he}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Rt,Te=!0,vt=!1;return{s:function(){N=N.call(te)},n:function(){var ur=N.next();return Te=ur.done,ur},e:function(ur){vt=!0,Rt=ur},f:function(){try{!Te&&null!=N.return&&N.return()}finally{if(vt)throw Rt}}}}(this.controls);try{for(N.s();!(U=N.n()).done;)U.value.remove()}catch(Te){N.e(Te)}finally{N.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var N=this.controlCorners={},U="l7-",he=this.controlContainer=be.SO.create("div",U+"control-container",this.container);function Te(){var vt=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],Rt=vt.map(function(Ot){return U+Ot}).join(" ");N[vt.join("")]=be.SO.create("div",Rt,he)}Te(["top","left"]),Te(["top","right"]),Te(["bottom","left"]),Te(["bottom","right"]),Te(["top","center"]),Te(["right","center"]),Te(["left","center"]),Te(["bottom","center"])}},{key:"clearControlPos",value:function(){for(var N in this.controlCorners)this.controlCorners[N]&&be.SO.remove(this.controlCorners[N]);this.controlContainer&&be.SO.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),te}())||Tr,On=(0,g.b2)()(mn=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"container",void 0),(0,G.Z)(this,"scene",void 0),(0,G.Z)(this,"mapsService",void 0),(0,G.Z)(this,"markers",[]),(0,G.Z)(this,"markerLayers",[]),(0,G.Z)(this,"unAddMarkers",[]),(0,G.Z)(this,"unAddMarkerLayers",[])}return(0,H.Z)(te,[{key:"addMarkerLayer",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(N),N.addTo(this.scene)):this.unAddMarkerLayers.push(N)}},{key:"removeMarkerLayer",value:function(N){N.destroy(),this.markerLayers.indexOf(N);var U=this.markerLayers.indexOf(N);U>-1&&this.markerLayers.splice(U,1)}},{key:"addMarker",value:function(N){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(N),N.addTo(this.scene)):this.unAddMarkers.push(N)}},{key:"addMarkers",value:function(){var N=this;this.unAddMarkers.forEach(function(U){U.addTo(N.scene),N.markers.push(U)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var N=this;this.unAddMarkerLayers.forEach(function(U){N.markerLayers.push(U),U.addTo(N.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(N){N.remove(),this.markers.indexOf(N);var U=this.markers.indexOf(N);U>-1&&this.markers.splice(U,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(R.v.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(N){N.remove()}),this.markers=[],this.markerLayers.forEach(function(N){N.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(N){N.destroy()}}]),te}())||mn,si=(0,g.b2)()(hi=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"scene",void 0),(0,G.Z)(this,"popup",void 0),(0,G.Z)(this,"mapsService",void 0),(0,G.Z)(this,"unAddPopup",void 0)}return(0,H.Z)(te,[{key:"removePopup",value:function(N){N.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(N){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(N.addTo(this.scene),this.popup=N):this.unAddPopup=N}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(N){this.scene=N,this.mapsService=N.get(R.v.IMapService)}}]),te}())||hi,ai=y(3912),Ki=y.n(ai);const Ei={MapToken:"\u60a8\u6b63\u5728\u4f7f\u7528 Demo\u6d4b\u8bd5\u5730\u56fetoken\uff0c\u5982\u679c\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u53bb\u5bf9\u5e94\u5730\u56fe\u8bf7\u6ce8\u518cToken",SDK:"\u8bf7\u786e\u8ba4\u5f15\u5165\u4e86mapbox-gl api\u4e14\u5728L7\u4e4b\u524d\u5f15\u5165"};var pe;function _e(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function V(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?_e(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):_e(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var ae={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},xe={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Oe=(0,g.b2)()(pe=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"sceneConfigCache",{}),(0,G.Z)(this,"layerConfigCache",{})}return(0,H.Z)(te,[{key:"getSceneConfig",value:function(N){return this.sceneConfigCache[N]}},{key:"getSceneWarninfo",value:function(N){return Ei[N]}},{key:"setSceneConfig",value:function(N,U){this.sceneConfigCache[N]=V(V({},ae),U)}},{key:"getLayerConfig",value:function(N){return this.layerConfigCache[N]}},{key:"setLayerConfig",value:function(N,U,he){this.layerConfigCache[U]=V({},Ki()({},this.sceneConfigCache[N],xe,he))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),te}())||pe,fe=y(32952),Ae=y(56326),wt=y(58623),Sr=Math.PI/180;function Fr(te){var ne=te.latitude,N=void 0===ne?0:ne,U=te.zoom,Te=te.scale,vt=te.highPrecision,Rt=void 0!==vt&&vt,Ot=te.flipY,ur=void 0!==Ot&&Ot,Vr={},Ln=512*(Te=void 0!==Te?Te:Math.pow(2,void 0===U?0:U)),Xn=Math.cos(N*Sr),ni=Ln/360,Ci=ni/Xn,Si=Ln/4003e4/Xn;if(Vr.pixelsPerMeter=[Si,-Si,Si],Vr.metersPerPixel=[1/Si,-1/Si,1/Si],Vr.pixelsPerDegree=[ni,-Ci,Si],Vr.degreesPerPixel=[1/ni,-1/Ci,1/Si],Rt){var ea=Sr*Math.tan(N*Sr)/Xn,ua=Ln/4003e4*ea,Ha=ua/Ci*Si;Vr.pixelsPerDegree2=[0,-ni*ea/2,ua],Vr.pixelsPerMeter2=[Ha,0,Ha],ur&&(Vr.pixelsPerDegree2[1]=-Vr.pixelsPerDegree2[1],Vr.pixelsPerMeter2[1]=-Vr.pixelsPerMeter2[1])}return ur&&(Vr.pixelsPerMeter[1]=-Vr.pixelsPerMeter[1],Vr.metersPerPixel[1]=-Vr.metersPerPixel[1],Vr.pixelsPerDegree[1]=-Vr.pixelsPerDegree[1],Vr.degreesPerPixel[1]=-Vr.degreesPerPixel[1]),Vr}var Pn,rr,Sn,an,fn,Ji,Vi,Ti,_a,Ia,Rn=y(62306),Di=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],_n=(Pn=(0,g.b2)(),rr=(0,g.f3)(R.v.ICameraService),Pn((an=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"needRefresh",!0),(0,fe.Z)(this,"cameraService",fn,this),(0,G.Z)(this,"coordinateSystem",void 0),(0,G.Z)(this,"viewportCenter",void 0),(0,G.Z)(this,"viewportCenterProjection",void 0),(0,G.Z)(this,"pixelsPerDegree",void 0),(0,G.Z)(this,"pixelsPerDegree2",void 0),(0,G.Z)(this,"pixelsPerMeter",void 0)}return(0,H.Z)(te,[{key:"refresh",value:function(){var N=this.cameraService.getZoom(),U=this.cameraService.getZoomScale(),he=this.cameraService.getCenter(),Te=Fr({latitude:he[1],zoom:N}),vt=Te.pixelsPerMeter,Rt=Te.pixelsPerDegree;this.viewportCenter=he,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=vt,this.pixelsPerDegree=Rt,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===Rn.l.LNGLAT||this.coordinateSystem===Rn.l.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===Rn.l.LNGLAT_OFFSET?this.calculateLnglatOffset(he,N):this.coordinateSystem===Rn.l.P20_OFFSET&&this.calculateLnglatOffset(he,N,U,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(N){this.coordinateSystem=N}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(N,U,he,Te){var vt=Fr({latitude:N[1],zoom:U,scale:he,flipY:Te,highPrecision:!0}),Rt=vt.pixelsPerMeter,Ot=vt.pixelsPerDegree,ur=vt.pixelsPerDegree2,Vr=this.cameraService.getViewMatrix(),Ln=this.cameraService.getProjectionMatrix(),Xn=Z.multiply([],Ln,Vr),ni=this.cameraService.projectFlat([Math.fround(N[0]),Math.fround(N[1])],Math.pow(2,U));this.viewportCenterProjection=wt.fF([],[ni[0],ni[1],0,1],Xn),Vr=this.cameraService.getViewMatrixUncentered()||Vr,Xn=Z.multiply([],Ln,Vr),Xn=Z.multiply([],Xn,Di),this.cameraService.setViewProjectionMatrix(Xn),this.pixelsPerMeter=Rt,this.pixelsPerDegree=Ot,this.pixelsPerDegree2=ur}}]),te}(),fn=(0,Ae.Z)(an.prototype,"cameraService",[rr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sn=an))||Sn),Oi=y(11524),ta=y.n(Oi),oi=y(12260);var Xi={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},to=(Ji=(0,g.b2)(),Vi=(0,g.f3)(R.v.IMapService),Ji((_a=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){var U;(0,B.Z)(this,N);for(var he=arguments.length,Te=new Array(he),vt=0;vt<he;vt++)Te[vt]=arguments[vt];return U=ne.call.apply(ne,[this].concat(Te)),(0,fe.Z)((0,Re.Z)(U),"mapService",Ia,(0,Re.Z)(U)),(0,G.Z)((0,Re.Z)(U),"hammertime",void 0),(0,G.Z)((0,Re.Z)(U),"lastClickTime",0),(0,G.Z)((0,Re.Z)(U),"lastClickXY",[-1,-1]),(0,G.Z)((0,Re.Z)(U),"clickTimer",void 0),(0,G.Z)((0,Re.Z)(U),"$containter",void 0),(0,G.Z)((0,Re.Z)(U),"onDrag",function(Rt){var Ot=U.interactionEvent(Rt);Ot.type=Xi[Ot.type],U.emit(oi.s.Drag,Ot)}),(0,G.Z)((0,Re.Z)(U),"onHammer",function(Rt){Rt.srcEvent.stopPropagation();var Ot=U.interactionEvent(Rt);U.emit(oi.s.Hover,Ot)}),(0,G.Z)((0,Re.Z)(U),"onTouch",function(Rt){var Ot=Rt.touches[0];U.onHover({x:Ot.pageX,y:Ot.pageY,type:"touch"})}),(0,G.Z)((0,Re.Z)(U),"onHover",function(Rt){var Vr=Rt.clientX,Ln=Rt.clientY,Xn=Rt.type,ni=U.mapService.getMapContainer();if(ni){var Ci=ni.getBoundingClientRect();Vr=Vr-Ci.left-ni.clientLeft,Ln=Ln-Ci.top-ni.clientTop}var xa=U.mapService.containerToLngLat([Vr,Ln]);if("click"!==Xn)"touch"!==Xn?"click"!==Xn&&"dblclick"!==Xn&&U.emit(oi.s.Hover,{x:Vr,y:Ln,lngLat:xa,type:Xn,target:Rt}):U.isDoubleTap(Vr,Ln,xa);else{if("ontouchstart"in document.documentElement)return;U.isDoubleTap(Vr,Ln,xa)}}),U}return(0,H.Z)(N,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(oi.s.Hover)}},{key:"triggerHover",value:function(he){this.emit(oi.s.Hover,{x:he.x,y:he.y})}},{key:"triggerSelect",value:function(he){this.emit(oi.s.Select,{featureId:he})}},{key:"triggerActive",value:function(he){this.emit(oi.s.Active,{featureId:he})}},{key:"addEventListenerOnMap",value:function(){var he=this.mapService.getMapContainer();if(he){var Te=new(ta().Manager)(he);Te.add(new(ta().Tap)({event:"dblclick",taps:2})),Te.add(new(ta().Tap)({event:"click"})),Te.add(new(ta().Pan)({threshold:0,pointers:0})),Te.add(new(ta().Press)({})),Te.on("dblclick click",this.onHammer),Te.on("panstart panmove panend pancancel",this.onDrag),he.addEventListener("mousemove",this.onHover),he.addEventListener("mousedown",this.onHover,!0),he.addEventListener("mouseup",this.onHover),he.addEventListener("contextmenu",this.onHover),this.hammertime=Te}}},{key:"removeEventListenerOnMap",value:function(){var he=this.mapService.getMapContainer();he&&(he.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),he.removeEventListener("mousedown",this.onHover),he.removeEventListener("mouseup",this.onHover),he.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(he){var Rt,Ot,Te=he.type;"touch"===he.pointerType?(Ot=Math.floor(he.pointers[0].clientY),Rt=Math.floor(he.pointers[0].clientX)):(Ot=Math.floor(he.srcEvent.y),Rt=Math.floor(he.srcEvent.x));var ur=this.mapService.getMapContainer();if(ur){var Vr=ur.getBoundingClientRect();Rt-=Vr.left,Ot-=Vr.top}return{x:Rt,y:Ot,lngLat:this.mapService.containerToLngLat([Rt,Ot]),type:Te,target:he.srcEvent}}},{key:"isDoubleTap",value:function(he,Te,vt){var Rt=this,Ot=(new Date).getTime();Ot-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-he)<10&&Math.abs(this.lastClickXY[1]-Te)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),this.emit(oi.s.Hover,{x:he,y:Te,lngLat:vt,type:"dblclick"})):(this.lastClickTime=Ot,this.lastClickXY=[he,Te],this.clickTimer=setTimeout(function(){Rt.emit(oi.s.Hover,{x:he,y:Te,lngLat:vt,type:"click"})},400))}}]),N}(c()),Ia=(0,Ae.Z)(_a.prototype,"mapService",[Vi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ti=_a))||Ti),Ho=y(8239),Za=y(88774),Wi=y.n(Za),wu=(window,0);function Da(te){var ne=te;if("string"==typeof te&&(ne=document.getElementById(te)),ne){var N=document.createElement("div");return N.style.cssText+="\n      position: absolute;\n      z-index:2;\n      height: 100%;\n      width: 100%;\n      pointer-events: none;\n    ",N.id="l7-scene-".concat(wu++),N.classList.add("l7-scene"),ne.appendChild(N),N}return null}var ra,bo,ma,vo,No,Ls,aa,Jo,Ma,Ka,$o,Fi=y(24558);function Ba(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function Ee(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?Ba(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):Ba(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var ar,Kr,$n,xi,lo,ro,co,ps,du,ts,ks,Qs,gs,Oa,ko,je=(ra=(0,g.b2)(),bo=(0,g.f3)(R.v.IRendererService),ma=(0,g.f3)(R.v.IGlobalConfigService),vo=(0,g.f3)(R.v.IInteractionService),No=(0,g.f3)(R.v.ILayerService),ra((aa=function(){function te(){var ne=this;(0,B.Z)(this,te),(0,fe.Z)(this,"rendererService",Jo,this),(0,fe.Z)(this,"configService",Ma,this),(0,fe.Z)(this,"interactionService",Ka,this),(0,fe.Z)(this,"layerService",$o,this),(0,G.Z)(this,"pickingFBO",void 0),(0,G.Z)(this,"width",0),(0,G.Z)(this,"height",0),(0,G.Z)(this,"alreadyInPicking",!1),(0,G.Z)(this,"pickBufferScale",1),(0,G.Z)(this,"pickFromPickingFBO",function(N,U){var he,Te=U.x,vt=U.y,Rt=U.lngLat,Ot=U.type,ur=U.target,Vr=!1,Ln=ne.rendererService,ni=Ln.readPixels,Si=(0,Ln.getContainer)().getBoundingClientRect(),ea=Si.width,xa=Si.height;ea*=be.SO.DPR,xa*=be.SO.DPR;var ga,ua=N.getLayerConfig(),Ha=ua.enableHighlight,Wa=ua.enableSelect,Ya=Te*be.SO.DPR,ia=vt*be.SO.DPR;if(Ya>ea-1*be.SO.DPR||Ya<0||ia>xa-1*be.SO.DPR||ia<0)return!1;if(0!==(ga=ni({x:Math.floor(Ya/ne.pickBufferScale),y:Math.floor((xa-(vt+1)*be.SO.DPR)/ne.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:ne.pickingFBO}))[0]||0!==ga[1]||0!==ga[2]){var la=(0,be.W0)(ga),no=N.getSource().getFeatureById(la);la!==N.getCurrentPickId()&&"mousemove"===Ot&&(Ot="mouseenter");var ki={x:Te,y:vt,type:Ot,lngLat:Rt,featureId:la,feature:no,target:ur};no&&(Vr=!0,N.setCurrentPickId(la),ne.triggerHoverOnLayer(N,ki))}else{var Ca={x:Te,y:vt,lngLat:Rt,type:null!==N.getCurrentPickId()&&"mousemove"===Ot?"mouseout":"un"+Ot,featureId:null,target:ur,feature:null};ne.triggerHoverOnLayer(N,Ee(Ee({},Ca),{},{type:"unpick"})),ne.triggerHoverOnLayer(N,Ca),N.setCurrentPickId(null)}if(Ha&&ne.highlightPickedFeature(N,ga),Wa&&"click"===Ot&&(null===(he=ga)||void 0===he?void 0:he.toString())!==[0,0,0,0].toString()){var ba=(0,be.W0)(ga);null===N.getCurrentSelectedId()||ba!==N.getCurrentSelectedId()?(ne.selectFeature(N,ga),N.setCurrentSelectedId(ba)):(ne.selectFeature(N,new Uint8Array([0,0,0,0])),N.setCurrentSelectedId(null))}return Vr})}return(0,H.Z)(te,[{key:"init",value:function(N){var U=this.rendererService,he=U.createTexture2D,Te=U.createFramebuffer,Ot=(0,U.getContainer)().getBoundingClientRect(),ur=Ot.width,Vr=Ot.height;ur*=be.SO.DPR,Vr*=be.SO.DPR,this.pickBufferScale=this.configService.getSceneConfig(N).pickBufferScale||1,this.pickingFBO=Te({color:he({width:Math.round(ur/this.pickBufferScale),height:Math.round(Vr/this.pickBufferScale),wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.interactionService.on(oi.s.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:(ne=(0,Ho.Z)(Wi().mark(function U(he,Te,vt){var Ot,ur,Vr,Rt=this;return Wi().wrap(function(ni){for(;;)switch(ni.prev=ni.next){case 0:ur=(Ot=this.rendererService).useFramebuffer,Vr=Ot.clear,this.resizePickingFBO(),ur(this.pickingFBO,function(){Vr({framebuffer:Rt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),he.hooks.beforePickingEncode.call(),he.renderModels(),he.hooks.afterPickingEncode.call();var Ci=Rt.pickBox(he,Te);vt(Ci)});case 3:case"end":return ni.stop()}},U,this)})),function(U,he,Te){return ne.apply(this,arguments)})},{key:"pickBox",value:function(N,U){var he=this,Te=U.map(function(Ca){return Math.floor((Ca<0?0:Ca)*be.SO.DPR/he.pickBufferScale)}),vt=(0,Lt.Z)(Te,4),Rt=vt[0],Ot=vt[1],ur=vt[2],Vr=vt[3],Ln=this.rendererService,ni=Ln.readPixels,Si=(0,Ln.getContainer)().getBoundingClientRect(),ea=Si.width,xa=Si.height;if(xa*=be.SO.DPR,Rt>((ea*=be.SO.DPR)-1)*be.SO.DPR/this.pickBufferScale||ur<0||Ot>(xa-1)*be.SO.DPR/this.pickBufferScale||Vr<0)return[];var ua,Ha=Math.min(ea/this.pickBufferScale,ur)-Rt,Wa=Math.min(xa/this.pickBufferScale,Vr)-Ot;ua=ni({x:Rt,y:Math.floor(xa/this.pickBufferScale-(Vr+1)),width:Ha,height:Wa,data:new Uint8Array(Ha*Wa*4),framebuffer:this.pickingFBO});for(var Ya=[],ia={},ga=0;ga<ua.length/4;ga+=1){var la=ua.slice(4*ga,4*ga+4),no=(0,be.W0)(la);if(-1!==no&&!ia[no]){var ki=N.getSource().getFeatureById(no);Ya.push(ki),ia[no]=!0}}return Ya}},{key:"pickingAllLayer",value:function(){var ne=(0,Ho.Z)(Wi().mark(function U(he){return Wi().wrap(function(vt){for(;;)switch(vt.prev=vt.next){case 0:if(!this.alreadyInPicking&&!this.layerService.alreadyInRendering){vt.next=2;break}return vt.abrupt("return");case 2:return this.alreadyInPicking=!0,vt.next=5,this.pickingLayers(he);case 5:this.layerService.renderLayers("picking"),this.alreadyInPicking=!1;case 7:case"end":return vt.stop()}},U,this)}));return function(U){return ne.apply(this,arguments)}}()},{key:"resizePickingFBO",value:function(){var U=(0,this.rendererService.getContainer)().getBoundingClientRect(),he=U.width,Te=U.height;Te*=be.SO.DPR,(this.width!==(he*=be.SO.DPR)||this.height!==Te)&&(this.pickingFBO.resize({width:Math.round(he/this.pickBufferScale),height:Math.round(Te/this.pickBufferScale)}),this.width=he,this.height=Te)}},{key:"pickingLayers",value:function(){var ne=(0,Ho.Z)(Wi().mark(function U(he){var vt,Ot,ur,Te=this;return Wi().wrap(function(Xn){for(;;)switch(Xn.prev=Xn.next){case 0:Ot=(vt=this.rendererService).useFramebuffer,ur=vt.clear,this.resizePickingFBO(),Ot(this.pickingFBO,function(){Te.layerService.getLayers().filter(function(Ci){return Ci.needPick(he.type)}).reverse().some(function(Ci){return ur({framebuffer:Te.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Ci.hooks.beforePickingEncode.call(),Ci.renderModels(),Ci.hooks.afterPickingEncode.call(),Te.pickFromPickingFBO(Ci,he)&&!Ci.getLayerConfig().enablePropagation})});case 3:case"end":return Xn.stop()}},U,this)}));return function(U){return ne.apply(this,arguments)}}()},{key:"triggerHoverOnLayer",value:function(N,U){(function(te){var ne,N,U=!0;return null==te||null===(ne=te.target)||void 0===ne||null===(N=ne.path)||void 0===N||N.map(function(he){var Te;null!=he&&he.classList&&(null==he||null===(Te=he.classList)||void 0===Te||Te.forEach(function(vt){("l7-marker"===vt||"l7-popup"===vt)&&(U=!1)}))}),U})(U)&&N.emit(U.type,U)}},{key:"highlightPickedFeature",value:function(N,U){var he=(0,Lt.Z)(U,3);N.hooks.beforeHighlight.call([he[0],he[1],he[2]])}},{key:"selectFeature",value:function(N,U){var he=(0,Lt.Z)(U,3);N.hooks.beforeSelect.call([he[0],he[1],he[2]])}}]),te;var ne}(),Jo=(0,Ae.Z)(aa.prototype,"rendererService",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ma=(0,Ae.Z)(aa.prototype,"configService",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ka=(0,Ae.Z)(aa.prototype,"interactionService",[vo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=(0,Ae.Z)(aa.prototype,"layerService",[No],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ls=aa))||Ls),bt=function(){function te(){var ne=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,B.Z)(this,te),(0,G.Z)(this,"autoStart",void 0),(0,G.Z)(this,"startTime",0),(0,G.Z)(this,"oldTime",0),(0,G.Z)(this,"running",!1),(0,G.Z)(this,"elapsedTime",0),this.autoStart=ne}return(0,H.Z)(te,[{key:"start",value:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var N=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var U=("undefined"==typeof performance?Date:performance).now();N=(U-this.oldTime)/1e3,this.oldTime=U,this.elapsedTime+=N}return N}}]),te}(),Eu=(ar=(0,g.b2)(),Kr=(0,g.f3)(R.v.IRendererService),$n=(0,g.f3)(R.v.IMapService),xi=(0,g.f3)(R.v.IGlobalConfigService),ar((ro=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"clock",new bt),(0,G.Z)(this,"alreadyInRendering",!1),(0,G.Z)(this,"layers",[]),(0,G.Z)(this,"layerRenderID",void 0),(0,G.Z)(this,"sceneInited",!1),(0,G.Z)(this,"animateInstanceCount",0),(0,G.Z)(this,"lastRenderType",void 0),(0,G.Z)(this,"lastPickRenderTime",void 0),(0,fe.Z)(this,"renderService",co,this),(0,fe.Z)(this,"mapService",ps,this),(0,fe.Z)(this,"configService",du,this)}return(0,H.Z)(te,[{key:"add",value:function(N){this.sceneInited&&N.init(),this.layers.push(N)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(N){N.inited||N.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(N){return this.layers.find(function(U){return U.id===N})}},{key:"getLayerByName",value:function(N){return this.layers.find(function(U){return U.name===N})}},{key:"remove",value:function(N){var U=this.layers.indexOf(N);U>-1&&this.layers.splice(U,1),N.emit("remove",null),N.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(N){!this.renderTest(N)||this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(U){return U.inited}).filter(function(U){return U.isVisible()}).forEach(function(U){U.hooks.beforeRenderData.call(),U.hooks.beforeRender.call(),U.render(),U.hooks.afterRender.call()}),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(N,U){return N.zIndex-U.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(N){return N.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){0==this.animateInstanceCount++&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){0==--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"renderTest",value:function(N){var he=(new Date).getTime()-this.lastPickRenderTime;if("picking"===N&&(this.lastPickRenderTime=(new Date).getTime()),N)switch(N){case"picking":return"mapRender"===this.lastRenderType||"animate"===this.lastRenderType?(this.lastRenderType="picking",he>48):(this.lastRenderType="picking",!0);case"animate":return"mapRender"===this.lastRenderType?(this.lastRenderType="animate",!1):(this.lastRenderType="animate",!0);case"mapRender":return this.lastRenderType="mapRender",!0;default:return!0}return!0}},{key:"clear",value:function(){var N=(0,be.CI)(this.mapService.bgColor);this.renderService.clear({color:N,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers("animate"),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),te}(),co=(0,Ae.Z)(ro.prototype,"renderService",[Kr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ps=(0,Ae.Z)(ro.prototype,"mapService",[$n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=(0,Ae.Z)(ro.prototype,"configService",[xi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lo=ro))||lo),fl=y(71189),Wo=y(96109),Qo=y(28303),Lo=y.n(Qo),es=function(){function te(ne){var N=this;(0,B.Z)(this,te),(0,G.Z)(this,"name",void 0),(0,G.Z)(this,"type",void 0),(0,G.Z)(this,"scale",void 0),(0,G.Z)(this,"descriptor",void 0),(0,G.Z)(this,"featureBufferLayout",[]),(0,G.Z)(this,"needRescale",!1),(0,G.Z)(this,"needRemapping",!1),(0,G.Z)(this,"needRegenerateVertices",!1),(0,G.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,G.Z)(this,"vertexAttribute",void 0),(0,G.Z)(this,"defaultCallback",function(U){var he;return 0===U.length?(null===(he=N.scale)||void 0===he?void 0:he.defaultValues)||[]:U.map(function(Te,vt){var Rt;return(null===(Rt=N.scale)||void 0===Rt?void 0:Rt.scalers[vt].func)(Te)})}),this.setProps(ne)}return(0,H.Z)(te,[{key:"setProps",value:function(N){Object.assign(this,N)}},{key:"mapping",value:function(N){var U;if(null!==(U=this.scale)&&void 0!==U&&U.callback){var he,Te=null===(he=this.scale)||void 0===he?void 0:he.callback.apply(he,(0,Wo.Z)(N));if(!Lo()(Te))return[Te]}return this.defaultCallback(N)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),te}();function Ol(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function Ll(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?Ol(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):Ol(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var m,T,Y,D,ve,Ne,mt,zt,Ft,Or,zr,Jn,bi,pi,oa,Ea,Na,vi,Xo,vu,Tu,Ec,Du,Bl,mu,gu,tu,oo,Tc,Cc,rs,tc,ru,wc=((0,G.Z)(ts={},Fi.gl.FLOAT,4),(0,G.Z)(ts,Fi.gl.UNSIGNED_BYTE,1),(0,G.Z)(ts,Fi.gl.UNSIGNED_SHORT,2),ts),Rl=(ks=(0,g.b2)(),Qs=(0,g.f3)(R.v.IRendererService),ks((Oa=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"attributesAndIndices",void 0),(0,fe.Z)(this,"rendererService",ko,this),(0,G.Z)(this,"attributes",[]),(0,G.Z)(this,"triangulation",void 0),(0,G.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,H.Z)(te,[{key:"registerStyleAttribute",value:function(N){var U=this.getLayerStyleAttribute(N.name||"");return U?U.setProps(N):(U=new es(N),this.attributes.push(U)),U}},{key:"updateStyleAttribute",value:function(N,U,he){var Te=this.getLayerStyleAttribute(N);Te||(Te=this.registerStyleAttribute(Ll(Ll({},U),{},{name:N})));var vt=U.scale;vt&&Te&&(Te.scale=vt,Te.needRescale=!0,Te.needRemapping=!0,Te.needRegenerateVertices=!0,he&&he.featureRange&&(Te.featureRange=he.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(N){return this.attributes.find(function(U){return U.name===N})}},{key:"getLayerAttributeScale",value:function(N){var U,he=this.getLayerStyleAttribute(N),Te=null==he||null===(U=he.scale)||void 0===U?void 0:U.scalers;return Te&&Te[0]?Te[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(N,U){var he=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,Te=arguments.length>3?arguments[3]:void 0,vt=this.attributes.find(function(Wa){return Wa.name===N});if(vt&&vt.descriptor){var Rt=vt.descriptor,Ot=Rt.update,ur=Rt.buffer,Vr=Rt.size,Ln=void 0===Vr?0:Vr,Xn=wc[ur.type||Fi.gl.FLOAT];if(Ot){var ni=this.featureLayout,Ci=ni.elements,Si=ni.sizePerElement,ea=Ci.slice(he,Te);if(!ea.length)return;var xa=ea[0].offset,ua=xa*Ln*Xn,Ha=ea.map(function(Wa,Ya){for(var ia=Wa.featureIdx,ga=Wa.vertices,la=Wa.normals,no=ga.length/Si,ki=[],Ca=0;Ca<no;Ca++){var ba=la?la.slice(3*Ca,3*Ca+3):[];ki.push.apply(ki,(0,Wo.Z)(Ot(U[ia],ia,ga.slice(Ca*Si,Ca*Si+Si),Ya,ba)))}return ki}).reduce(function(Wa,Ya){return Wa.push.apply(Wa,(0,Wo.Z)(Ya)),Wa},[]);vt.vertexAttribute.updateBuffer({data:Ha,offset:ua})}}}},{key:"createAttributesAndIndices",value:function(N,U,he){var Te=this;this.featureLayout={sizePerElement:0,elements:[]},U&&(this.triangulation=U);var vt=this.attributes.map(function(ua){return ua.resetDescriptor(),ua.descriptor}),Rt=0,ur=[];N.forEach(function(ua,Ha){var Wa=Te.triangulation(ua,he),ia=Wa.vertices,ga=Wa.normals,la=Wa.size;Wa.indices.forEach(function(ba){ur.push(ba+Rt)});var no=ia.length/la;Te.featureLayout.sizePerElement=la,Te.featureLayout.elements.push({featureIdx:Ha,vertices:ia,normals:ga,offset:Rt}),Rt+=no;for(var ki=function(go){var Kl=(null==ga?void 0:ga.slice(3*go,3*go+3))||[],uu=ia.slice(go*la,go*la+la);vt.forEach(function(Yo,Su){var Hu;Yo&&Yo.update&&(Hu=Yo.buffer.data).push.apply(Hu,(0,Wo.Z)(Yo.update(ua,Ha,uu,go,Kl)))})},Ca=0;Ca<no;Ca++)ki(Ca)});var Xn=this.rendererService,ni=Xn.createAttribute,Ci=Xn.createBuffer,Si=Xn.createElements,ea={};vt.forEach(function(ua,Ha){if(ua){var Wa=ua.buffer,ga=(0,fl.Z)(ua,["buffer","update","name"]),la=ni(Ll({buffer:Ci(Wa)},ga));ea[ua.name||""]=la,Te.attributes[Ha].vertexAttribute=la}});var xa=Si({data:ur,type:Fi.gl.UNSIGNED_INT,count:ur.length});return this.attributesAndIndices={attributes:ea,elements:xa},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var N;this.attributes.forEach(function(U){U.vertexAttribute&&U.vertexAttribute.destroy()}),null===(N=this.attributesAndIndices)||void 0===N||N.elements.destroy(),this.attributes=[]}}]),te}(),ko=(0,Ae.Z)(Oa.prototype,"rendererService",[Qs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gs=Oa))||gs),hl=y(97185),eu=y(18660),Dl=y.n(eu);var Ac,Bu=(m=(0,g.b2)(),T=(0,g.f3)(R.v.SceneID),Y=(0,g.f3)(R.v.IIconService),D=(0,g.f3)(R.v.IFontService),ve=(0,g.f3)(R.v.IControlService),Ne=(0,g.f3)(R.v.IGlobalConfigService),mt=(0,g.f3)(R.v.IMapService),zt=(0,g.f3)(R.v.ICoordinateSystemService),Ft=(0,g.f3)(R.v.IRendererService),Or=(0,g.f3)(R.v.ILayerService),zr=(0,g.f3)(R.v.ICameraService),Jn=(0,g.f3)(R.v.IInteractionService),bi=(0,g.f3)(R.v.IPickingService),pi=(0,g.f3)(R.v.IShaderModuleService),oa=(0,g.f3)(R.v.IMarkerService),Ea=(0,g.f3)(R.v.IPopupService),m((vi=function(te){(0,qt.Z)(N,te);var U,ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){var U;return(0,B.Z)(this,N),U=ne.call(this),(0,G.Z)((0,Re.Z)(U),"destroyed",!1),(0,G.Z)((0,Re.Z)(U),"loaded",!1),(0,G.Z)((0,Re.Z)(U),"loadFont",!1),(0,G.Z)((0,Re.Z)(U),"fontFamily",""),(0,fe.Z)((0,Re.Z)(U),"id",Xo,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"iconService",vu,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"fontService",Tu,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"controlService",Ec,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"configService",Du,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"map",Bl,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"coordinateSystemService",mu,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"rendererService",gu,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"layerService",tu,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"cameraService",oo,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"interactionService",Tc,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"pickingService",Cc,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"shaderModuleService",rs,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"markerService",tc,(0,Re.Z)(U)),(0,fe.Z)((0,Re.Z)(U),"popupService",ru,(0,Re.Z)(U)),(0,G.Z)((0,Re.Z)(U),"inited",!1),(0,G.Z)((0,Re.Z)(U),"initPromise",void 0),(0,G.Z)((0,Re.Z)(U),"rendering",!1),(0,G.Z)((0,Re.Z)(U),"$container",void 0),(0,G.Z)((0,Re.Z)(U),"canvas",void 0),(0,G.Z)((0,Re.Z)(U),"markerContainer",void 0),(0,G.Z)((0,Re.Z)(U),"hooks",void 0),(0,G.Z)((0,Re.Z)(U),"handleWindowResized",function(){U.emit("resize"),U.$container&&(U.initContainer(),be.SO.triggerResize(),U.coordinateSystemService.needRefresh=!0,U.render())}),(0,G.Z)((0,Re.Z)(U),"handleMapCameraChanged",function(he){U.cameraService.update(he),U.render("mapRender")}),U.hooks={init:new hl.zj},U}return(0,H.Z)(N,[{key:"init",value:function(he){var Te=this;this.configService.setSceneConfig(this.id,he),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,Ho.Z)(Wi().mark(function vt(){return Wi().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:return Ot.next=2,new Promise(function(ur){Te.map.onCameraChanged(function(Vr){Te.cameraService.init(),Te.cameraService.update(Vr),"GAODE2.x"!==Te.map.version&&ur()}),"GAODE2.x"!==Te.map.version?Te.map.init():ur()});case 2:if("GAODE2.x"!==Te.map.version||!Te.map.initViewPort){Ot.next=6;break}return Ot.next=5,Te.map.init();case 5:Te.map.initViewPort();case 6:Te.map.onCameraChanged(Te.handleMapCameraChanged),Te.map.addMarkerContainer(),Te.markerService.addMarkers(),Te.markerService.addMarkerLayers(),Te.popupService.initPopup(),Te.interactionService.init(),Te.interactionService.on(oi.s.Drag,Te.addSceneEvent.bind(Te));case 13:case"end":return Ot.stop()}},vt)}))),this.hooks.init.tapPromise("initRenderer",(0,Ho.Z)(Wi().mark(function vt(){var Rt;return Wi().wrap(function(ur){for(;;)switch(ur.prev=ur.next){case 0:if(Rt=Da(Te.configService.getSceneConfig(Te.id).id||""),Te.$container=Rt,!Rt){ur.next=11;break}return Te.canvas=be.SO.create("canvas","",Rt),Te.setCanvas(),ur.next=7,Te.rendererService.init(Te.canvas,Te.configService.getSceneConfig(Te.id));case 7:Dl()(Te.$container,Te.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(Te.handleWindowResized),ur.next=12;break;case 11:console.error("\u5bb9\u5668 id \u4e0d\u5b58\u5728");case 12:Te.pickingService.init(Te.id);case 13:case"end":return ur.stop()}},vt)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(he){this.layerService.add(he),this.render()}},{key:"render",value:(U=(0,Ho.Z)(Wi().mark(function Te(vt){return Wi().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:if(!this.rendering&&!this.destroyed){Ot.next=2;break}return Ot.abrupt("return");case 2:if(this.rendering=!0,this.inited){Ot.next=15;break}return Ot.next=6,this.initPromise;case 6:if(this.destroyed&&this.destroy(),!this.loadFont||!document.fonts){Ot.next=10;break}return Ot.next=10,document.fonts.load("24px ".concat(this.fontFamily),"L7text");case 10:this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 15:this.layerService.renderLayers(vt),this.rendering=!1;case 17:case"end":return Ot.stop()}},Te,this)})),function(Te){return U.apply(this,arguments)})},{key:"addFontFace",value:function(he,Te){this.fontFamily=he;var vt=document.createElement("style");vt.type="text/css",vt.innerText="\n        @font-face{\n            font-family: '".concat(he,"';\n            src: url('").concat(Te,"') format('woff2'),\n            url('").concat(Te,"') format('woff'),\n            url('").concat(Te,"') format('truetype');\n        }"),document.getElementsByTagName("head")[0].appendChild(vt),this.loadFont=!0}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(he){var Te,vt=null===(Te=this.$container)||void 0===Te?void 0:Te.getElementsByTagName("canvas")[0];return this.render(),"jpg"===he?null==vt?void 0:vt.toDataURL("image/jpeg"):null==vt?void 0:vt.toDataURL("image/png")}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var he=this.$container.parentElement;null!==he&&(this.markerContainer=be.SO.create("div","l7-marker-container",he))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var he,Te;this.inited?(this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),null===(he=this.$container)||void 0===he||null===(Te=he.parentNode)||void 0===Te||Te.removeChild(this.$container),this.removeAllListeners(),this.inited=!1,(0,eu.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)):this.destroyed=!0}},{key:"initContainer",value:function(){var he,Te,vt=be.SO.DPR,Rt=(null===(he=this.$container)||void 0===he?void 0:he.clientWidth)||400,Ot=(null===(Te=this.$container)||void 0===Te?void 0:Te.clientHeight)||300,ur=this.canvas;ur&&(ur.width=Rt*vt,ur.height=Ot*vt,ur.style.width="".concat(Rt,"px"),ur.style.height="".concat(Ot,"px")),this.rendererService.viewport({x:0,y:0,width:vt*Rt,height:vt*Ot})}},{key:"setCanvas",value:function(){var he,Te,vt=be.SO.DPR,Rt=(null===(he=this.$container)||void 0===he?void 0:he.clientWidth)||400,Ot=(null===(Te=this.$container)||void 0===Te?void 0:Te.clientHeight)||300,ur=this.canvas;ur.width=Rt*vt,ur.height=Ot*vt,ur.style.width="".concat(Rt,"px"),ur.style.height="".concat(Ot,"px")}},{key:"addSceneEvent",value:function(he){this.emit(he.type,he)}}]),N}(_.EventEmitter),Xo=(0,Ae.Z)(vi.prototype,"id",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vu=(0,Ae.Z)(vi.prototype,"iconService",[Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=(0,Ae.Z)(vi.prototype,"fontService",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ec=(0,Ae.Z)(vi.prototype,"controlService",[ve],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Du=(0,Ae.Z)(vi.prototype,"configService",[Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bl=(0,Ae.Z)(vi.prototype,"map",[mt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=(0,Ae.Z)(vi.prototype,"coordinateSystemService",[zt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=(0,Ae.Z)(vi.prototype,"rendererService",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tu=(0,Ae.Z)(vi.prototype,"layerService",[Or],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oo=(0,Ae.Z)(vi.prototype,"cameraService",[zr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tc=(0,Ae.Z)(vi.prototype,"interactionService",[Jn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc=(0,Ae.Z)(vi.prototype,"pickingService",[bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rs=(0,Ae.Z)(vi.prototype,"shaderModuleService",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tc=(0,Ae.Z)(vi.prototype,"markerService",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ru=(0,Ae.Z)(vi.prototype,"popupService",[Ea],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Na=vi))||Na),La=y(72699),Ju=y.n(La),Us=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function nc(te){var ne={};return{content:te=te.replace(Us,function(N,U,he){var Te=he.split(":"),vt=Te[0].trim(),Rt="";switch(Te.length>1&&(Rt=Te[1].trim()),U){case"bool":Rt="true"===Rt;break;case"float":case"int":Rt=Number(Rt);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":Rt=Rt?Rt.replace("[","").replace("]","").split(",").reduce(function(Ot,ur){return Ot.push(Number(ur.trim())),Ot},[]):new Array(function(te){var ne=0;switch(te){case"vec2":case"ivec2":ne=2;break;case"vec3":case"ivec3":ne=3;break;case"vec4":case"ivec4":case"mat2":ne=4;break;case"mat3":ne=9;break;case"mat4":ne=16}return ne}(U)).fill(0)}return ne[vt]=Rt,"uniform ".concat(U," ").concat(vt,";\n")}),uniforms:ne}}function Fl(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function yu(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?Fl(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):Fl(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var $u="#define PI 3.14159265359",ic=/precision\s+(high|low|medium)p\s+float/,uf=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Cu=(0,g.b2)()(Ac=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"moduleCache",{}),(0,G.Z)(this,"rawContentCache",{})}return(0,H.Z)(te,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:$u,fs:$u}),this.registerModule("decode",{vs:"#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",fs:""}),this.registerModule("projection",{vs:"#define TILE_SIZE 512.0\n#define PI 3.1415926536\n#define WORLD_SCALE TILE_SIZE / (PI * 2.0)\n\n#define COORDINATE_SYSTEM_LNGLAT 1.0\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\n#define COORDINATE_SYSTEM_P20_2 8.0\n\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrix;\nuniform float u_Zoom : 1;\nuniform float u_ZoomScale : 1;\n\nuniform float u_CoordinateSystem;\nuniform vec2 u_ViewportCenter;\nuniform vec4 u_ViewportCenterProjection;\nuniform vec3 u_PixelsPerDegree;\nuniform vec3 u_PixelsPerDegree2;\nuniform vec3 u_PixelsPerMeter;\n\nuniform vec2 u_ViewportSize;\nuniform float u_DevicePixelRatio;\nuniform float u_FocalDistance;\nuniform vec3 u_CameraPosition;\n\n// uniform mat4 u_Mvp;\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1., 1.);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01\n    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01\n// reverse Y\nvec3 reverse_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {\n    return vector * vec3(1.0, -1.0, 1.0);\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0\n    return vector;\n  }\n  return vector;\n}\n\nvec4 project_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(vec4(X, Y, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return vec4(\n      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // return vec4(\n    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), \n    //   project_scale(position.z), \n    //   position.w);\n\n     return vec4(\n      position.xy, \n      project_scale(position.z), \n      position.w);\n  }\n  return position;\n\n  // TODO: \u74e6\u7247\u5750\u6807\u7cfb & \u5e38\u89c4\u4e16\u754c\u5750\u6807\u7cfb\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\nfloat project_pixel_allmap(float pixel) {\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    return pixel * pow(2.0, u_Zoom);\n  }\n  return pixel;\n}\n\nfloat project_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));\n  }\n  return pixel;\n}\nvec2 project_pixel(vec2 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));\n  }\n  return pixel * -1.;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n     pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\n\nbool isEqual( float a,  float b) {\n    return  a< b + 0.001 && a > b - 0.001;\n}",fs:""}),this.registerModule("project",{vs:"\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n\n// gaode2.0\nvec2 customProject(vec2 lnglat) { // \u7ecf\u7eac\u5ea6 => \u5e73\u9762\u5750\u6807\n  float t = lnglat.x;\n  float e = lnglat.y;\n  float Sm = 180.0 / PI;\n  float Tm = 6378137.0;\n  float Rm = PI / 180.0;\n  float r = 85.0511287798;\n  e = max(min(r, e), -r);\n  t *= Rm;\n  e *= Rm;\n  e = log(tan(PI / 4.0 + e / 2.0));\n  return vec2(t * Tm, e * Tm);\n}\n\nvec2 unProjCustomCoord(vec2 point) { // \u5e73\u9762\u5750\u6807 => \u7ecf\u7eac\u5ea6\n  float Sm = 57.29577951308232; //180 / Math.PI\n  float Tm = 6378137.0;\n  float t = point.x;\n  float e = point.y;\n  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);\n}\n\n\nfloat customPixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}",fs:""}),this.registerModule("sdf_2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n"}),this.registerModule("lighting",{vs:"// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {\n//   vec3 lightDir = normalize(light.position - fragPos);\n//   // diffuse shading\n//   float diff = max(dot(normal, lightDir), 0.0);\n//   // specular shading\n//   vec3 reflectDir = reflect(-lightDir, normal);\n//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);\n//   // attenuation\n//   float distance = length(light.position - fragPos);\n//   float attenuation = 1.0 / (light.constant + light.linear * distance +\n//           light.quadratic * (distance * distance));\n\n//   vec3 ambient = light.ambient * u_Ambient;\n//   vec3 diffuse = light.diffuse * diff * u_Diffuse;\n//   vec3 specular = light.specular * spec * u_Specular;\n\n//   float spotEffect = dot(normalize(light.direction), -lightDir);\n//   float spotCosCutoff = cos(light.angle / 180.0 * PI);\n//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);\n//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);\n//   if (spotEffect > spotCosCutoff) {\n//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);\n//   } else {\n//     spotEffect = 0.0;\n//   }\n\n//   return ambient + attenuation * (spotEffect * diffuse + specular);\n// }\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {\n  //   if (i >= u_NumOfSpotLights) {\n  //     break;\n  //   }\n  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);\n  // }\n  return weight;\n}\n",fs:""}),this.registerModule("light",{vs:"#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",fs:""}),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n\nfloat setPickingOrder(float z) {\n   bool selected = bool(v_PickingResult.a);\n   return selected ? z + 1. : 0.;\n}\n",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n"}),this.registerModule("styleMapping",{vs:"attribute float a_vertexId;\n\nuniform mat4 u_cellTypeLayout;      // \u63cf\u8ff0\u6570\u636e\u7eb9\u7406 cell \u7ed3\u6784\u7684\u77e9\u9635\nuniform sampler2D u_dataTexture;    // \u6570\u636e\u7eb9\u7406\n\nbool hasOpacity() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 opacity \u7684\u6570\u636e\n  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeOpacity() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 strokeOpacity \u7684\u6570\u636e\n  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeWidth() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 strokeWidth \u7684\u6570\u636e\n  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStroke() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 stroke \u7684\u6570\u636e\n  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasOffsets() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 offsets \u7684\u6570\u636e\n  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\n// \u6839\u636e\u5750\u6807\u4f4d\u7f6e\u5148\u662f\u8ba1\u7b97 uv \uff0c\u7136\u540e\u6839\u636e uv \u4ece\u6570\u636e\u7eb9\u7406\u4e2d\u53d6\u503c\nfloat pos2value(vec2 pos, float columnWidth, float rowHeight) {\n  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;\n  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);\n  return texture2D(u_dataTexture, vec2(u, v)).r;\n}\n\n/*\n  currentRow \u5f53\u524d\u884c\n  currentColumn \u5f53\u524d\u5217\n  columnCount \u6709\u591a\u5c11\u5217\n  nextStep \u9700\u8981\u8ba1\u7b97\u5f53\u524d cell \u540e\u7684\u7b2c\u51e0\u4e2a cell \uff08\u5f53\u524d cell \u5219 nextStep = 0\uff09\n*/\nvec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {\n  float nextColumn = currentColumn;\n  float nextRow = currentRow;\n  if(currentColumn + nextStep <= columnCount){\n    nextColumn = currentColumn + nextStep;\n  } else {\n    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4e0d\u4f1a\u51fa\u73b0\u8de8\u4e24\u884c\n    nextRow = currentRow + 1.0;\n  }\n  return vec2(nextColumn, nextRow);\n}\n\n// \u8ba1\u7b97\u5f53\u524d\u5355\u4e2a cell \u7684\u5927\u5c0f\nfloat calCellCount() { \n  //   u_cellTypeLayout\n  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51e0\u884c\u51e0\u5217\n  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793a\u6709\u6570\u636e\u6620\u5c04\u30010.0 \u8868\u793a\u6ca1\u6709\n  //   1.0, 0.0, 0.0, 0.0, // offsets\n  //   0.0, 0.0, 0.0, 0.0\n  \n  return  u_cellTypeLayout[1][0] +        // opacity\n          u_cellTypeLayout[1][1] +        // strokeOpacity\n          u_cellTypeLayout[1][2] +        // strokeWidth\n          u_cellTypeLayout[1][3] * 4.0 +  // stroke\n          u_cellTypeLayout[2][0] * 2.0;   // offsets\n}",fs:""}),this.registerModule("styleMappingCalOpacity",{vs:"\n// \u8ba1\u7b97 opacity \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasOpacity()) { // \u6570\u636e\u7eb9\u7406\u4e2d\u4e0d\u5b58\u5728 opacity \u7684\u65f6\u5019\u53d6\u9ed8\u8ba4\u503c\uff08\u7528\u6237\u5728 style \u4e2d\u4f20\u5165\u7684\u662f\u5e38\u91cf\uff09\n    return vec2(u_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:"\n// \u8ba1\u7b97 strokeOpaicty \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeOpacity()) {\n    return vec2(u_stroke_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:"\n// \u8ba1\u7b97 strokeWidth \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeWidth()) {\n    return vec2(u_stroke_width, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeWidth, textureOffset + 1.0);\n  }\n}\n",fs:""})}},{key:"registerModule",value:function(N,U){if(!this.rawContentCache[N]){var Te=U.fs,vt=U.uniforms,Rt=nc(U.vs),Ot=Rt.content,ur=Rt.uniforms,Vr=nc(Te),Xn=Vr.uniforms;this.rawContentCache[N]={fs:Vr.content,uniforms:yu(yu(yu({},ur),Xn),vt),vs:Ot}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(N){var U=this;if(this.moduleCache[N])return this.moduleCache[N];var Te=this.rawContentCache[N].fs,vt=this.processModule(this.rawContentCache[N].vs,[],"vs"),Rt=vt.content,Ot=vt.includeList,ur=this.processModule(Te,[],"fs"),Vr=ur.content,Ln=ur.includeList,Xn=Vr,ni=Ju()(Ot.concat(Ln).concat(N)).reduce(function(Ci,Si){return yu(yu({},Ci),U.rawContentCache[Si].uniforms)},{});return ic.test(Vr)||(Xn="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+Vr),this.moduleCache[N]={fs:Xn.trim(),uniforms:ni,vs:Rt.trim()},this.moduleCache[N]}},{key:"processModule",value:function(N,U,he){var Te=this;return{content:N.replace(uf,function(Rt,Ot){var Vr=Ot.split(" ")[0].replace(/"/g,"");if(U.indexOf(Vr)>-1)return"";var Ln=Te.rawContentCache[Vr][he];return U.push(Vr),Te.processModule(Ln,U,he).content}),includeList:U}}}]),te}())||Ac;function nu(te,ne,N){return(nu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(he,Te,vt){var Rt=function(te,ne){for(;!Object.prototype.hasOwnProperty.call(te,ne)&&null!==(te=(0,er.Z)(te)););return te}(he,Te);if(Rt){var Ot=Object.getOwnPropertyDescriptor(Rt,Te);return Ot.get?Ot.get.call(vt):Ot.value}})(te,ne,N||te)}var Vs,zl,ac,oc,Zu,$a,Au=y(55576),ns=(Vs=(0,g.b2)(),zl=(0,g.f3)(R.v.IShaderModuleService),Vs((oc=function(){function te(){(0,B.Z)(this,te),(0,fe.Z)(this,"shaderModuleService",Zu,this),(0,G.Z)(this,"rendererService",void 0),(0,G.Z)(this,"cameraService",void 0),(0,G.Z)(this,"mapService",void 0),(0,G.Z)(this,"interactionService",void 0),(0,G.Z)(this,"layerService",void 0),(0,G.Z)(this,"config",void 0)}return(0,H.Z)(te,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Au.G.Normal}},{key:"init",value:function(N,U){this.config=U,this.rendererService=N.getContainer().get(R.v.IRendererService),this.cameraService=N.getContainer().get(R.v.ICameraService),this.mapService=N.getContainer().get(R.v.IMapService),this.interactionService=N.getContainer().get(R.v.IInteractionService),this.layerService=N.getContainer().get(R.v.ILayerService)}},{key:"render",value:function(N){}}]),te}(),Zu=(0,Ae.Z)(oc.prototype,"shaderModuleService",[zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ac=oc))||ac);var sa,Va,ws,Ul,Uu,Pu=(0,g.b2)()($a=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(he,Te){nu((0,er.Z)(N.prototype),"init",this).call(this,he,Te)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),N}(ns))||$a;function Mc(te,ne){var N="undefined"!=typeof Symbol&&te[Symbol.iterator]||te["@@iterator"];if(!N){if(Array.isArray(te)||(N=function(te,ne){if(te){if("string"==typeof te)return lf(te,undefined);var N=Object.prototype.toString.call(te).slice(8,-1);if("Object"===N&&te.constructor&&(N=te.constructor.name),"Map"===N||"Set"===N)return Array.from(te);if("Arguments"===N||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(N))return lf(te,undefined)}}(te))||ne&&te&&"number"==typeof te.length){N&&(te=N);var U=0,he=function(){};return{s:he,n:function(){return U>=te.length?{done:!0}:{done:!1,value:te[U++]}},e:function(ur){throw ur},f:he}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Rt,Te=!0,vt=!1;return{s:function(){N=N.call(te)},n:function(){var ur=N.next();return Te=ur.done,ur},e:function(ur){vt=!0,Rt=ur},f:function(){try{!Te&&null!=N.return&&N.return()}finally{if(vt)throw Rt}}}}function lf(te,ne){(null==ne||ne>te.length)&&(ne=te.length);for(var N=0,U=new Array(ne);N<ne;N++)U[N]=te[N];return U}var _u,jl=(sa=(0,g.b2)(),Va=(0,g.f3)(R.v.IPostProcessor),sa((Ul=function(){function te(){(0,B.Z)(this,te),(0,G.Z)(this,"passes",[]),(0,fe.Z)(this,"postProcessor",Uu,this),(0,G.Z)(this,"layer",void 0),(0,G.Z)(this,"renderFlag",void 0),(0,G.Z)(this,"width",0),(0,G.Z)(this,"height",0)}return(0,H.Z)(te,[{key:"setLayer",value:function(N){this.layer=N}},{key:"setRenderFlag",value:function(N){this.renderFlag=N}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:(ne=(0,Ho.Z)(Wi().mark(function U(){var he,Te,vt;return Wi().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:he=Mc(this.passes),Ot.prev=1,he.s();case 3:if((Te=he.n()).done){Ot.next=9;break}return vt=Te.value,Ot.next=7,vt.render(this.layer);case 7:Ot.next=3;break;case 9:Ot.next=14;break;case 11:Ot.prev=11,Ot.t0=Ot.catch(1),he.e(Ot.t0);case 14:return Ot.prev=14,he.f(),Ot.finish(14);case 17:this.layer.renderModels();case 18:case"end":return Ot.stop()}},U,this,[[1,11,14,17]])})),function(){return ne.apply(this,arguments)})},{key:"resize",value:function(N,U){(this.width!==N||this.height!==U)&&(this.width=N,this.height=U)}},{key:"add",value:function(N,U){N.getType()===Au.G.PostProcessing?this.postProcessor.add(N,this.layer,U):(N.init(this.layer,U),this.passes.push(N))}},{key:"insert",value:function(N,U,he){N.init(this.layer,U),this.passes.splice(he,0,N)}},{key:"destroy",value:function(){this.passes.length=0}}]),te;var ne}(),Uu=(0,Ae.Z)(Ul.prototype,"postProcessor",[Va],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ws=Ul))||ws);function So(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function gl(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?So(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):So(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var _l,Nn=(0,g.b2)()(_u=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){var U;(0,B.Z)(this,N);for(var he=arguments.length,Te=new Array(he),vt=0;vt<he;vt++)Te[vt]=arguments[vt];return U=ne.call.apply(ne,[this].concat(Te)),(0,G.Z)((0,Re.Z)(U),"pickingFBO",void 0),(0,G.Z)((0,Re.Z)(U),"layer",void 0),(0,G.Z)((0,Re.Z)(U),"width",0),(0,G.Z)((0,Re.Z)(U),"height",0),(0,G.Z)((0,Re.Z)(U),"alreadyInRendering",!1),(0,G.Z)((0,Re.Z)(U),"pickFromPickingFBO",function(Rt){var Ot=Rt.x,ur=Rt.y,Vr=Rt.lngLat,Ln=Rt.type;if(U.layer.isVisible()&&U.layer.needPick(Ln)){var la,Xn=U.rendererService,Ci=Xn.readPixels,Si=Xn.useFramebuffer,ea=(0,Xn.getViewportSize)(),xa=ea.width,ua=ea.height,Ha=U.layer.getLayerConfig(),Wa=Ha.enableHighlight,Ya=Ha.enableSelect,ia=Ot*be.SO.DPR,ga=ur*be.SO.DPR;ia>xa||ia<0||ga>ua||ga<0||Si(U.pickingFBO,function(){var no;if(0!==(la=Ci({x:Math.round(ia),y:Math.round(ua-(ur+1)*be.SO.DPR),width:1,height:1,data:new Uint8Array(4),framebuffer:U.pickingFBO}))[0]||0!==la[1]||0!==la[2]){var ki=(0,be.W0)(la),Ca=U.layer.getSource().getFeatureById(ki),ba={x:Ot,y:ur,type:Ln,lngLat:Vr,featureId:ki,feature:Ca};Ca&&(U.layer.setCurrentPickId(ki),U.triggerHoverOnLayer(ba))}else{var go={x:Ot,y:ur,lngLat:Vr,type:null===U.layer.getCurrentPickId()?"un"+Ln:"mouseout",featureId:null,feature:null};U.triggerHoverOnLayer(gl(gl({},go),{},{type:"unpick"})),U.triggerHoverOnLayer(go),U.layer.setCurrentPickId(null)}Wa&&U.highlightPickedFeature(la),Ya&&"click"===Ln&&(null===(no=la)||void 0===no?void 0:no.toString())!==[0,0,0,0].toString()&&U.selectFeature(la)})}}),U}return(0,H.Z)(N,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(he,Te){nu((0,er.Z)(N.prototype),"init",this).call(this,he,Te),this.layer=he;var vt=this.rendererService,Rt=vt.createTexture2D,Ot=vt.createFramebuffer,Vr=(0,vt.getViewportSize)();this.pickingFBO=Ot({color:Rt({width:Vr.width,height:Vr.height,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.interactionService.on(oi.s.Hover,this.pickFromPickingFBO),this.interactionService.on(oi.s.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(oi.s.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(he){var Te=this;if(!this.alreadyInRendering){var vt=this.rendererService,Ot=vt.useFramebuffer,ur=vt.clear,Vr=(0,vt.getViewportSize)(),Ln=Vr.width,Xn=Vr.height;this.alreadyInRendering=!0,(this.width!==Ln||this.height!==Xn)&&(this.pickingFBO.resize({width:Ln,height:Xn}),this.width=Ln,this.height=Xn),Ot(this.pickingFBO,function(){ur({framebuffer:Te.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var ni=Te.layer.multiPassRenderer.getRenderFlag();Te.layer.multiPassRenderer.setRenderFlag(!1),he.hooks.beforePickingEncode.call(),he.render(),he.hooks.afterPickingEncode.call(),Te.layer.multiPassRenderer.setRenderFlag(ni),Te.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(he){this.layer.emit(he.type,he)}},{key:"highlightPickedFeature",value:function(he){var Te=(0,Lt.Z)(he,3);this.layer.hooks.beforeHighlight.call([Te[0],Te[1],Te[2]]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(he){var Te=(0,Lt.Z)(he,3);this.layer.hooks.beforeSelect.call([Te[0],Te[1],Te[2]]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(he){var vt=(0,be.Z6)(he.featureId);this.selectFeature(new Uint8Array(vt))}},{key:"highlightFeatureHandle",value:function(he){var vt=(0,be.Z6)(he.featureId);this.highlightPickedFeature(new Uint8Array(vt))}}]),N}(ns))||_u,za=y(20051);function iu(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function Es(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?iu(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):iu(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var Ts,xl=(0,g.b2)()(_l=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var he=this.shaderModuleService.getModule("blur-pass"),Te=he.vs,vt=he.fs,Rt=he.uniforms,Ot=this.rendererService.getViewportSize(),ur=Ot.width,Vr=Ot.height;return{vs:Te,fs:vt,uniforms:Es(Es({},Rt),{},{u_ViewportSize:[ur,Vr]})}}},{key:"convertOptionsToUniforms",value:function(he){var Te={};return Lo()(he.blurRadius)||(Te.u_BlurDir=[he.blurRadius,0]),Te}}]),N}(za.Z))||_l;function sc(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function au(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?sc(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):sc(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var Ws,cf=(0,g.b2)()(Ts=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var he=this.shaderModuleService.getModule("blur-pass"),Te=he.vs,vt=he.fs,Rt=he.uniforms,Ot=this.rendererService.getViewportSize(),ur=Ot.width,Vr=Ot.height;return{vs:Te,fs:vt,uniforms:au(au({},Rt),{},{u_ViewportSize:[ur,Vr]})}}},{key:"convertOptionsToUniforms",value:function(he){var Te={};return Lo()(he.blurRadius)||(Te.u_BlurDir=[0,he.blurRadius]),Te}}]),N}(za.Z))||Ts;function Cs(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function $i(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?Cs(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):Cs(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var mo,bu=(0,g.b2)()(Ws=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:'varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}'});var he=this.shaderModuleService.getModule("colorhalftone-pass"),Te=he.vs,vt=he.fs,Rt=he.uniforms,Ot=this.rendererService.getViewportSize(),ur=Ot.width,Vr=Ot.height;return{vs:Te,fs:vt,uniforms:$i($i({},Rt),{},{u_ViewportSize:[ur,Vr]})}}}]),N}(za.Z))||Ws;var Po,wo=(0,g.b2)()(mo=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}"}),this.shaderModuleService.getModule("copy-pass")}}]),N}(za.Z))||mo;function fo(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function Vl(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?fo(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):fo(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var ys,As=(0,g.b2)()(Po=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var he=this.shaderModuleService.getModule("hexagonalpixelate-pass"),Te=he.vs,vt=he.fs,Rt=he.uniforms,Ot=this.rendererService.getViewportSize(),ur=Ot.width,Vr=Ot.height;return{vs:Te,fs:vt,uniforms:Vl(Vl({},Rt),{},{u_ViewportSize:[ur,Vr]})}}}]),N}(za.Z))||Po;function is(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function al(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?is(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):is(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var ol,Yc=(0,g.b2)()(ys=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var he=this.shaderModuleService.getModule("ink-pass"),Te=he.vs,vt=he.fs,Rt=he.uniforms,Ot=this.rendererService.getViewportSize(),ur=Ot.width,Vr=Ot.height;return{vs:Te,fs:vt,uniforms:al(al({},Rt),{},{u_ViewportSize:[ur,Vr]})}}}]),N}(za.Z))||ys;var Rc,Gu=(0,g.b2)()(ol=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}"}),this.shaderModuleService.getModule("noise-pass")}}]),N}(za.Z))||ol;var o,p,b,E,A,F,Ce,s=(0,g.b2)()(Rc=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}"}),this.shaderModuleService.getModule("sepia-pass")}}]),N}(za.Z))||Rc,$=(o=(0,g.b2)(),p=(0,g.f3)(R.v.IRendererService),b=(0,g.zY)(),o((A=function(){function te(){(0,B.Z)(this,te),(0,fe.Z)(this,"rendererService",F,this),(0,G.Z)(this,"passes",[]),(0,G.Z)(this,"readFBO",void 0),(0,G.Z)(this,"writeFBO",void 0)}return(0,H.Z)(te,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:(ne=(0,Ho.Z)(Wi().mark(function U(he){var Te,vt;return Wi().wrap(function(Ot){for(;;)switch(Ot.prev=Ot.next){case 0:Te=0;case 1:if(!(Te<this.passes.length)){Ot.next=10;break}return(vt=this.passes[Te]).setRenderToScreen(this.isLastEnabledPass(Te)),Ot.next=6,vt.render(he);case 6:Te!==this.passes.length-1&&this.swap();case 7:Te++,Ot.next=1;break;case 10:case"end":return Ot.stop()}},U,this)})),function(U){return ne.apply(this,arguments)})},{key:"resize",value:function(N,U){this.readFBO.resize({width:N,height:U}),this.writeFBO.resize({width:N,height:U})}},{key:"add",value:function(N,U,he){N.init(U,he),this.passes.push(N)}},{key:"insert",value:function(N,U,he,Te){N.init(he,Te),this.passes.splice(U,0,N)}},{key:"getPostProcessingPassByName",value:function(N){return this.passes.find(function(U){return U.getName()===N})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(N){for(var U=N+1;U<this.passes.length;U++)if(this.passes[U].isEnabled())return!1;return!0}},{key:"swap",value:function(){var N=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=N}}]),te;var ne}(),F=(0,Ae.Z)(A.prototype,"rendererService",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,Ae.Z)(A.prototype,"init",[b],Object.getOwnPropertyDescriptor(A.prototype,"init"),A.prototype),E=A))||E);var $e,ft,Ye,lt,Pt,et=(0,g.b2)()(Ce=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){return(0,B.Z)(this,N),ne.apply(this,arguments)}return(0,H.Z)(N,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(he,Te){nu((0,er.Z)(N.prototype),"init",this).call(this,he,Te)}},{key:"render",value:function(he){var Te=this.rendererService,Rt=Te.clear;(0,Te.useFramebuffer)(null,function(){Rt({color:[0,0,0,0],depth:1,stencil:0}),he.multiPassRenderer.setRenderFlag(!1),he.render(),he.multiPassRenderer.setRenderFlag(!0)})}}]),N}(ns))||Ce;function Ht(te,ne){var N=Object.keys(te);if(Object.getOwnPropertySymbols){var U=Object.getOwnPropertySymbols(te);ne&&(U=U.filter(function(he){return Object.getOwnPropertyDescriptor(te,he).enumerable})),N.push.apply(N,U)}return N}function hr(te){for(var ne=1;ne<arguments.length;ne++){var N=null!=arguments[ne]?arguments[ne]:{};ne%2?Ht(Object(N),!0).forEach(function(U){(0,G.Z)(te,U,N[U])}):Object.getOwnPropertyDescriptors?Object.defineProperties(te,Object.getOwnPropertyDescriptors(N)):Ht(Object(N)).forEach(function(U){Object.defineProperty(te,U,Object.getOwnPropertyDescriptor(N,U))})}return te}var Qr="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}";function dn(te,ne){for(var N=0,U=1/ne,he=te;he>0;)N+=U*(he%ne),he=Math.floor(he/ne),U/=ne;return N}var qn=1,jn=($e=(0,g.b2)(),ft=(0,g.f3)(R.v.IShaderModuleService),$e((lt=function(te){(0,qt.Z)(N,te);var ne=function(te){var ne=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(te){return!1}}();return function(){var he,U=(0,er.Z)(te);if(ne){var Te=(0,er.Z)(this).constructor;he=Reflect.construct(U,arguments,Te)}else he=U.apply(this,arguments);return(0,Pr.Z)(this,he)}}(N);function N(){var U;(0,B.Z)(this,N);for(var he=arguments.length,Te=new Array(he),vt=0;vt<he;vt++)Te[vt]=arguments[vt];return U=ne.call.apply(ne,[this].concat(Te)),(0,fe.Z)((0,Re.Z)(U),"shaderModuleService",Pt,(0,Re.Z)(U)),(0,G.Z)((0,Re.Z)(U),"haltonSequence",[]),(0,G.Z)((0,Re.Z)(U),"accumulatingId",0),(0,G.Z)((0,Re.Z)(U),"frame",0),(0,G.Z)((0,Re.Z)(U),"timer",void 0),(0,G.Z)((0,Re.Z)(U),"sampleRenderTarget",void 0),(0,G.Z)((0,Re.Z)(U),"prevRenderTarget",void 0),(0,G.Z)((0,Re.Z)(U),"outputRenderTarget",void 0),(0,G.Z)((0,Re.Z)(U),"copyRenderTarget",void 0),(0,G.Z)((0,Re.Z)(U),"blendModel",void 0),(0,G.Z)((0,Re.Z)(U),"outputModel",void 0),(0,G.Z)((0,Re.Z)(U),"copyModel",void 0),U}return(0,H.Z)(N,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(he,Te){nu((0,er.Z)(N.prototype),"init",this).call(this,he,Te);var vt=this.rendererService,Rt=vt.createFramebuffer,Ot=vt.createTexture2D;this.sampleRenderTarget=Rt({color:Ot({width:1,height:1,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.prevRenderTarget=Rt({color:Ot({width:1,height:1,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.outputRenderTarget=Rt({color:Ot({width:1,height:1,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.copyRenderTarget=Rt({color:Ot({width:1,height:1,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})});for(var ur=0;ur<30;ur++)this.haltonSequence.push([dn(ur,2),dn(ur,3)]);this.blendModel=this.createTriangleModel("blend-pass","uniform float u_opacity : 1.0;\nuniform float u_MixRatio : 0.5;\n\nuniform sampler2D u_Diffuse1;\nuniform sampler2D u_Diffuse2;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  vec4 texel1 = texture2D(u_Diffuse1, v_UV);\n  vec4 texel2 = texture2D(u_Diffuse2, v_UV);\n  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);\n}\n"),this.outputModel=this.createTriangleModel("copy-pass",Qr,{blend:{enable:!0,func:{srcRGB:Fi.gl.ONE,dstRGB:Fi.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:Fi.gl.ONE,dstAlpha:Fi.gl.ONE_MINUS_SRC_ALPHA},equation:{rgb:Fi.gl.FUNC_ADD,alpha:Fi.gl.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",Qr)}},{key:"render",value:function(he){var Te=this,vt=this.rendererService,Rt=vt.clear,ur=vt.useFramebuffer,Vr=(0,vt.getViewportSize)(),Ln=Vr.width,Xn=Vr.height;this.sampleRenderTarget.resize({width:Ln,height:Xn}),this.prevRenderTarget.resize({width:Ln,height:Xn}),this.outputRenderTarget.resize({width:Ln,height:Xn}),this.copyRenderTarget.resize({width:Ln,height:Xn}),this.resetFrame(),this.stopAccumulating();var ni=he.multiPassRenderer.getPostProcessor().getReadFBO();ur(ni,function(){Rt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ni}),he.multiPassRenderer.setRenderFlag(!1),he.render(),he.multiPassRenderer.setRenderFlag(!0)});var Ci=function Si(ea){!Te.accumulatingId||ea!==Te.accumulatingId||Te.isFinished()||(Te.doRender(he),requestAnimationFrame(function(){Si(ea)}))};this.accumulatingId=qn++,this.timer=window.setTimeout(function(){Ci(Te.accumulatingId)},50)}},{key:"doRender",value:function(he){var Te=this,vt=this.rendererService,Rt=vt.clear,ur=vt.useFramebuffer,Vr=(0,vt.getViewportSize)(),Ln=Vr.width,Xn=Vr.height,Ci=he.getLayerConfig().jitterScale,Si=void 0===Ci?1:Ci,ea=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((2*ea[0]-1)/Ln*Si,(2*ea[1]-1)/Xn*Si),he.multiPassRenderer.setRenderFlag(!1),he.hooks.beforeRender.call(),ur(this.sampleRenderTarget,function(){Rt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:Te.sampleRenderTarget}),he.render()}),he.hooks.afterRender.call(),he.multiPassRenderer.setRenderFlag(!0);var xa=he.getLayerConfig();ur(this.outputRenderTarget,function(){Te.blendModel.draw({uniforms:{u_opacity:xa.opacity||1,u_MixRatio:0===Te.frame?1:.9,u_Diffuse1:Te.sampleRenderTarget,u_Diffuse2:0===Te.frame?he.multiPassRenderer.getPostProcessor().getReadFBO():Te.prevRenderTarget}})}),0===this.frame&&Rt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(ur(this.copyRenderTarget,function(){Te.outputModel.draw({uniforms:{u_Texture:Te.outputRenderTarget}})}),ur(he.multiPassRenderer.getPostProcessor().getReadFBO(),function(){Te.copyModel.draw({uniforms:{u_Texture:Te.copyRenderTarget}})}),he.multiPassRenderer.getPostProcessor().render(he));var ua=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=ua,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(he,Te,vt){this.shaderModuleService.registerModule(he,{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:Te});var Rt=this.shaderModuleService.getModule(he),Vr=Rt.uniforms,Ln=this.rendererService;return(0,Ln.createModel)(hr({vs:Rt.vs,fs:Rt.fs,attributes:{a_Position:(0,Ln.createAttribute)({buffer:(0,Ln.createBuffer)({data:[-4,-4,4,-4,0,4],type:Fi.gl.FLOAT}),size:2})},uniforms:hr({},Vr),depth:{enable:!1},count:3},vt))}}]),N}(ns),Pt=(0,Ae.Z)(lt.prototype,"shaderModuleService",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ye=lt))||Ye),Bn=new g.W2;Bn.bind(R.v.IGlobalConfigService).to(Oe).inSingletonScope(),Bn.bind(R.v.IShaderModuleService).to(Cu).inSingletonScope(),(0,g.GW)((0,g.b2)(),_.EventEmitter),Bn.bind(R.v.IEventEmitter).to(_.EventEmitter);var Li=(0,O.Z)(Bn,!1),Dn=function(ne){var N=Li.lazyInject(ne);return function(U,he,Te){N.call(this,U,he),Te&&(Te.initializer=function(){return U[he]})}};const ji=Bn;var li=0;function yi(){var te=new g.W2;return te.parent=Bn,te.bind(R.v.SceneID).toConstantValue("".concat(li++)),te.bind(R.v.ILayerService).to(Eu).inSingletonScope(),te.bind(R.v.ISceneService).to(Bu).inSingletonScope(),te.bind(R.v.ICameraService).to(It).inSingletonScope(),te.bind(R.v.ICoordinateSystemService).to(_n).inSingletonScope(),te.bind(R.v.IInteractionService).to(to).inSingletonScope(),te.bind(R.v.IPickingService).to(je).inSingletonScope(),te.bind(R.v.IControlService).to(or).inSingletonScope(),te.bind(R.v.IMarkerService).to(On).inSingletonScope(),te.bind(R.v.IIconService).to(yt).inSingletonScope(),te.bind(R.v.IFontService).to(at).inSingletonScope(),te.bind(R.v.IPopupService).to(si).inSingletonScope(),te.bind(R.v.INormalPass).to(Pu).whenTargetNamed("clear"),te.bind(R.v.INormalPass).to(Nn).whenTargetNamed("pixelPicking"),te.bind(R.v.INormalPass).to(et).whenTargetNamed("render"),te.bind(R.v.INormalPass).to(jn).whenTargetNamed("taa"),te.bind(R.v.IFactoryNormalPass).toFactory(function(ne){return function(N){return ne.container.getNamed(R.v.INormalPass,N)}}),te.bind(R.v.IPostProcessingPass).to(wo).whenTargetNamed("copy"),te.bind(R.v.IPostProcessingPass).to(xl).whenTargetNamed("blurH"),te.bind(R.v.IPostProcessingPass).to(cf).whenTargetNamed("blurV"),te.bind(R.v.IPostProcessingPass).to(Gu).whenTargetNamed("noise"),te.bind(R.v.IPostProcessingPass).to(s).whenTargetNamed("sepia"),te.bind(R.v.IPostProcessingPass).to(bu).whenTargetNamed("colorHalftone"),te.bind(R.v.IPostProcessingPass).to(As).whenTargetNamed("hexagonalPixelate"),te.bind(R.v.IPostProcessingPass).to(Yc).whenTargetNamed("ink"),te.bind(R.v.IFactoryPostProcessingPass).toFactory(function(ne){return function(N){var U=ne.container.getNamed(R.v.IPostProcessingPass,N);return U.setName(N),U}}),te}function Ni(te){var ne=new g.W2;return ne.parent=te,ne.bind(R.v.IStyleAttributeService).to(Rl).inSingletonScope(),ne.bind(R.v.IMultiPassRenderer).to(jl).inSingletonScope(),ne.bind(R.v.IPostProcessor).to($).inSingletonScope(),ne}},22115:()=>{},21236:()=>{},40646:(ie,L,y)=>{"use strict";y.d(L,{l:()=>M});var M={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},59304:(ie,L,y)=>{"use strict";y.d(L,{d:()=>M});var M=(()=>{return(_=M||(M={})).TOPRIGHT="topright",_.TOPLEFT="topleft",_.BOTTOMRIGHT="bottomright",_.BOTTOMLEFT="bottomleft",_.TOPCENTER="topcenter",_.BOTTOMCENTER="bottomcenter",_.LEFTCENTER="leftcenter",_.RIGHTCENTER="rightcenter",M;var _})()},35323:()=>{},35393:()=>{},24495:()=>{},62306:(ie,L,y)=>{"use strict";y.d(L,{l:()=>M,k:()=>_});var M=(()=>{return(c=M||(M={}))[c.LNGLAT=1]="LNGLAT",c[c.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",c[c.VECTOR_TILE=3]="VECTOR_TILE",c[c.IDENTITY=4]="IDENTITY",c[c.P20=5]="P20",c[c.P20_OFFSET=6]="P20_OFFSET",c[c.METER_OFFSET=7]="METER_OFFSET",c[c.P20_2=8]="P20_2",M;var c})(),_={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"}},12260:(ie,L,y)=>{"use strict";y.d(L,{s:()=>M});var M=(()=>{return(_=M||(M={})).Hover="hover",_.Click="click",_.Select="select",_.Active="active",_.Drag="drag",M;var _})()},25655:()=>{},35781:(ie,L,y)=>{"use strict";y.d(L,{h:()=>M});var M=(()=>{return(_=M||(M={})).normal="normal",_.additive="additive",_.subtractive="subtractive",_.min="min",_.max="max",_.none="none",M;var _})()},39727:(ie,L,y)=>{"use strict";y.d(L,{vY:()=>M,ee:()=>_,GC:()=>c});var M=(()=>{return(g=M||(M={})).LINEAR="linear",g.POWER="power",g.LOG="log",g.IDENTITY="identity",g.TIME="time",g.QUANTILE="quantile",g.QUANTIZE="quantize",g.THRESHOLD="threshold",g.CAT="cat",M;var g})(),_=(()=>{return(g=_||(_={})).CONSTANT="constant",g.VARIABLE="variable",_;var g})(),c=(()=>{return(g=c||(c={}))[g.Attribute=0]="Attribute",g[g.InstancedAttribute=1]="InstancedAttribute",g[g.Uniform=2]="Uniform",c;var g})()},53262:(ie,L,y)=>{"use strict";y.d(L,{I:()=>M});var M=["mapload"]},94671:()=>{},75846:()=>{},81210:()=>{},20626:()=>{},6974:()=>{},55576:(ie,L,y)=>{"use strict";y.d(L,{G:()=>M});var M=(()=>{return(_=M||(M={})).Normal="normal",_.PostProcessing="post-processing",M;var _})()},23824:()=>{},75541:()=>{},34710:()=>{},27159:()=>{},24558:(ie,L,y)=>{"use strict";y.d(L,{gl:()=>M});var M=(()=>{return(_=M||(M={}))[_.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",_[_.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",_[_.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",_[_.POINTS=0]="POINTS",_[_.LINES=1]="LINES",_[_.LINE_LOOP=2]="LINE_LOOP",_[_.LINE_STRIP=3]="LINE_STRIP",_[_.TRIANGLES=4]="TRIANGLES",_[_.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",_[_.TRIANGLE_FAN=6]="TRIANGLE_FAN",_[_.ZERO=0]="ZERO",_[_.ONE=1]="ONE",_[_.SRC_COLOR=768]="SRC_COLOR",_[_.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",_[_.SRC_ALPHA=770]="SRC_ALPHA",_[_.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",_[_.DST_ALPHA=772]="DST_ALPHA",_[_.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",_[_.DST_COLOR=774]="DST_COLOR",_[_.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",_[_.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",_[_.FUNC_ADD=32774]="FUNC_ADD",_[_.BLEND_EQUATION=32777]="BLEND_EQUATION",_[_.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",_[_.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",_[_.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",_[_.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",_[_.MAX_EXT=32776]="MAX_EXT",_[_.MIN_EXT=32775]="MIN_EXT",_[_.BLEND_DST_RGB=32968]="BLEND_DST_RGB",_[_.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",_[_.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",_[_.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",_[_.CONSTANT_COLOR=32769]="CONSTANT_COLOR",_[_.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",_[_.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",_[_.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",_[_.BLEND_COLOR=32773]="BLEND_COLOR",_[_.ARRAY_BUFFER=34962]="ARRAY_BUFFER",_[_.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",_[_.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",_[_.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",_[_.STREAM_DRAW=35040]="STREAM_DRAW",_[_.STATIC_DRAW=35044]="STATIC_DRAW",_[_.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",_[_.BUFFER_SIZE=34660]="BUFFER_SIZE",_[_.BUFFER_USAGE=34661]="BUFFER_USAGE",_[_.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",_[_.FRONT=1028]="FRONT",_[_.BACK=1029]="BACK",_[_.FRONT_AND_BACK=1032]="FRONT_AND_BACK",_[_.CULL_FACE=2884]="CULL_FACE",_[_.BLEND=3042]="BLEND",_[_.DITHER=3024]="DITHER",_[_.STENCIL_TEST=2960]="STENCIL_TEST",_[_.DEPTH_TEST=2929]="DEPTH_TEST",_[_.SCISSOR_TEST=3089]="SCISSOR_TEST",_[_.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",_[_.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",_[_.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",_[_.NO_ERROR=0]="NO_ERROR",_[_.INVALID_ENUM=1280]="INVALID_ENUM",_[_.INVALID_VALUE=1281]="INVALID_VALUE",_[_.INVALID_OPERATION=1282]="INVALID_OPERATION",_[_.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",_[_.CW=2304]="CW",_[_.CCW=2305]="CCW",_[_.LINE_WIDTH=2849]="LINE_WIDTH",_[_.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",_[_.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",_[_.CULL_FACE_MODE=2885]="CULL_FACE_MODE",_[_.FRONT_FACE=2886]="FRONT_FACE",_[_.DEPTH_RANGE=2928]="DEPTH_RANGE",_[_.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",_[_.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",_[_.DEPTH_FUNC=2932]="DEPTH_FUNC",_[_.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",_[_.STENCIL_FUNC=2962]="STENCIL_FUNC",_[_.STENCIL_FAIL=2964]="STENCIL_FAIL",_[_.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",_[_.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",_[_.STENCIL_REF=2967]="STENCIL_REF",_[_.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",_[_.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",_[_.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",_[_.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",_[_.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",_[_.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",_[_.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",_[_.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",_[_.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",_[_.VIEWPORT=2978]="VIEWPORT",_[_.SCISSOR_BOX=3088]="SCISSOR_BOX",_[_.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",_[_.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",_[_.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",_[_.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",_[_.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",_[_.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",_[_.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",_[_.RED_BITS=3410]="RED_BITS",_[_.GREEN_BITS=3411]="GREEN_BITS",_[_.BLUE_BITS=3412]="BLUE_BITS",_[_.ALPHA_BITS=3413]="ALPHA_BITS",_[_.DEPTH_BITS=3414]="DEPTH_BITS",_[_.STENCIL_BITS=3415]="STENCIL_BITS",_[_.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",_[_.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",_[_.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",_[_.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",_[_.SAMPLES=32937]="SAMPLES",_[_.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",_[_.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",_[_.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",_[_.DONT_CARE=4352]="DONT_CARE",_[_.FASTEST=4353]="FASTEST",_[_.NICEST=4354]="NICEST",_[_.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",_[_.BYTE=5120]="BYTE",_[_.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",_[_.SHORT=5122]="SHORT",_[_.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",_[_.INT=5124]="INT",_[_.UNSIGNED_INT=5125]="UNSIGNED_INT",_[_.FLOAT=5126]="FLOAT",_[_.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",_[_.ALPHA=6406]="ALPHA",_[_.RGB=6407]="RGB",_[_.RGBA=6408]="RGBA",_[_.LUMINANCE=6409]="LUMINANCE",_[_.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",_[_.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",_[_.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",_[_.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",_[_.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",_[_.VERTEX_SHADER=35633]="VERTEX_SHADER",_[_.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",_[_.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",_[_.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",_[_.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",_[_.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",_[_.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",_[_.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",_[_.SHADER_TYPE=35663]="SHADER_TYPE",_[_.DELETE_STATUS=35712]="DELETE_STATUS",_[_.LINK_STATUS=35714]="LINK_STATUS",_[_.VALIDATE_STATUS=35715]="VALIDATE_STATUS",_[_.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",_[_.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",_[_.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",_[_.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",_[_.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",_[_.NEVER=512]="NEVER",_[_.LESS=513]="LESS",_[_.EQUAL=514]="EQUAL",_[_.LEQUAL=515]="LEQUAL",_[_.GREATER=516]="GREATER",_[_.NOTEQUAL=517]="NOTEQUAL",_[_.GEQUAL=518]="GEQUAL",_[_.ALWAYS=519]="ALWAYS",_[_.KEEP=7680]="KEEP",_[_.REPLACE=7681]="REPLACE",_[_.INCR=7682]="INCR",_[_.DECR=7683]="DECR",_[_.INVERT=5386]="INVERT",_[_.INCR_WRAP=34055]="INCR_WRAP",_[_.DECR_WRAP=34056]="DECR_WRAP",_[_.VENDOR=7936]="VENDOR",_[_.RENDERER=7937]="RENDERER",_[_.VERSION=7938]="VERSION",_[_.NEAREST=9728]="NEAREST",_[_.LINEAR=9729]="LINEAR",_[_.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",_[_.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",_[_.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",_[_.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",_[_.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",_[_.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",_[_.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",_[_.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",_[_.TEXTURE_2D=3553]="TEXTURE_2D",_[_.TEXTURE=5890]="TEXTURE",_[_.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",_[_.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",_[_.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",_[_.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",_[_.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",_[_.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",_[_.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",_[_.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",_[_.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",_[_.TEXTURE0=33984]="TEXTURE0",_[_.TEXTURE1=33985]="TEXTURE1",_[_.TEXTURE2=33986]="TEXTURE2",_[_.TEXTURE3=33987]="TEXTURE3",_[_.TEXTURE4=33988]="TEXTURE4",_[_.TEXTURE5=33989]="TEXTURE5",_[_.TEXTURE6=33990]="TEXTURE6",_[_.TEXTURE7=33991]="TEXTURE7",_[_.TEXTURE8=33992]="TEXTURE8",_[_.TEXTURE9=33993]="TEXTURE9",_[_.TEXTURE10=33994]="TEXTURE10",_[_.TEXTURE11=33995]="TEXTURE11",_[_.TEXTURE12=33996]="TEXTURE12",_[_.TEXTURE13=33997]="TEXTURE13",_[_.TEXTURE14=33998]="TEXTURE14",_[_.TEXTURE15=33999]="TEXTURE15",_[_.TEXTURE16=34e3]="TEXTURE16",_[_.TEXTURE17=34001]="TEXTURE17",_[_.TEXTURE18=34002]="TEXTURE18",_[_.TEXTURE19=34003]="TEXTURE19",_[_.TEXTURE20=34004]="TEXTURE20",_[_.TEXTURE21=34005]="TEXTURE21",_[_.TEXTURE22=34006]="TEXTURE22",_[_.TEXTURE23=34007]="TEXTURE23",_[_.TEXTURE24=34008]="TEXTURE24",_[_.TEXTURE25=34009]="TEXTURE25",_[_.TEXTURE26=34010]="TEXTURE26",_[_.TEXTURE27=34011]="TEXTURE27",_[_.TEXTURE28=34012]="TEXTURE28",_[_.TEXTURE29=34013]="TEXTURE29",_[_.TEXTURE30=34014]="TEXTURE30",_[_.TEXTURE31=34015]="TEXTURE31",_[_.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",_[_.REPEAT=10497]="REPEAT",_[_.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",_[_.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",_[_.FLOAT_VEC2=35664]="FLOAT_VEC2",_[_.FLOAT_VEC3=35665]="FLOAT_VEC3",_[_.FLOAT_VEC4=35666]="FLOAT_VEC4",_[_.INT_VEC2=35667]="INT_VEC2",_[_.INT_VEC3=35668]="INT_VEC3",_[_.INT_VEC4=35669]="INT_VEC4",_[_.BOOL=35670]="BOOL",_[_.BOOL_VEC2=35671]="BOOL_VEC2",_[_.BOOL_VEC3=35672]="BOOL_VEC3",_[_.BOOL_VEC4=35673]="BOOL_VEC4",_[_.FLOAT_MAT2=35674]="FLOAT_MAT2",_[_.FLOAT_MAT3=35675]="FLOAT_MAT3",_[_.FLOAT_MAT4=35676]="FLOAT_MAT4",_[_.SAMPLER_2D=35678]="SAMPLER_2D",_[_.SAMPLER_CUBE=35680]="SAMPLER_CUBE",_[_.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",_[_.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",_[_.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",_[_.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",_[_.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",_[_.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",_[_.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",_[_.COMPILE_STATUS=35713]="COMPILE_STATUS",_[_.LOW_FLOAT=36336]="LOW_FLOAT",_[_.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",_[_.HIGH_FLOAT=36338]="HIGH_FLOAT",_[_.LOW_INT=36339]="LOW_INT",_[_.MEDIUM_INT=36340]="MEDIUM_INT",_[_.HIGH_INT=36341]="HIGH_INT",_[_.FRAMEBUFFER=36160]="FRAMEBUFFER",_[_.RENDERBUFFER=36161]="RENDERBUFFER",_[_.RGBA4=32854]="RGBA4",_[_.RGB5_A1=32855]="RGB5_A1",_[_.RGB565=36194]="RGB565",_[_.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",_[_.STENCIL_INDEX=6401]="STENCIL_INDEX",_[_.STENCIL_INDEX8=36168]="STENCIL_INDEX8",_[_.DEPTH_STENCIL=34041]="DEPTH_STENCIL",_[_.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",_[_.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",_[_.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",_[_.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",_[_.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",_[_.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",_[_.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",_[_.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",_[_.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",_[_.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",_[_.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",_[_.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",_[_.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",_[_.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",_[_.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",_[_.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",_[_.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",_[_.NONE=0]="NONE",_[_.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",_[_.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",_[_.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",_[_.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",_[_.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",_[_.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",_[_.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",_[_.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",_[_.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",_[_.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",_[_.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",_[_.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",_[_.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",_[_.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",M;var _})()},20051:(ie,L,y)=>{"use strict";y.d(L,{Z:()=>Xe});var ut,tt,Gt,Q,Vt,M=y(32952),_=y(75134),c=y(47289),g=y(93512),O=y(56326),R=y(93890),B=y.n(R),H=y(28303),G=y.n(H),be=y(35037),Be=y.n(be),j=y(15922),xt=(y(78320),y(24558)),Dt=y(92444),Et=y(55576);function ot(At,kt){var Yt=Object.keys(At);if(Object.getOwnPropertySymbols){var Er=Object.getOwnPropertySymbols(At);kt&&(Er=Er.filter(function(ge){return Object.getOwnPropertyDescriptor(At,ge).enumerable})),Yt.push.apply(Yt,Er)}return Yt}function Ue(At){for(var kt=1;kt<arguments.length;kt++){var Yt=null!=arguments[kt]?arguments[kt]:{};kt%2?ot(Object(Yt),!0).forEach(function(Er){(0,g.Z)(At,Er,Yt[Er])}):Object.getOwnPropertyDescriptors?Object.defineProperties(At,Object.getOwnPropertyDescriptors(Yt)):ot(Object(Yt)).forEach(function(Er){Object.defineProperty(At,Er,Object.getOwnPropertyDescriptor(Yt,Er))})}return At}var Xe=(ut=(0,j.b2)(),tt=(0,j.f3)(Dt.v.IShaderModuleService),ut((Q=function(){function At(){(0,_.Z)(this,At),(0,M.Z)(this,"shaderModuleService",Vt,this),(0,g.Z)(this,"rendererService",void 0),(0,g.Z)(this,"config",void 0),(0,g.Z)(this,"quad","attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}"),(0,g.Z)(this,"enabled",!0),(0,g.Z)(this,"renderToScreen",!1),(0,g.Z)(this,"model",void 0),(0,g.Z)(this,"name",void 0),(0,g.Z)(this,"optionsToUpdate",{})}return(0,c.Z)(At,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(Yt){this.name=Yt}},{key:"getType",value:function(){return Et.G.PostProcessing}},{key:"init",value:function(Yt,Er){this.config=Er,this.rendererService=Yt.getContainer().get(Dt.v.IRendererService);var ge=this.rendererService,de=ge.createAttribute,oe=ge.createBuffer,me=ge.createModel,Me=this.setupShaders(),br=Me.uniforms;this.model=me({vs:Me.vs,fs:Me.fs,attributes:{a_Position:de({buffer:oe({data:[-4,-4,4,-4,0,4],type:xt.gl.FLOAT}),size:2})},uniforms:Ue(Ue({u_Texture:null},br),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}},{key:"render",value:function(Yt){var Er=this,ge=Yt.multiPassRenderer.getPostProcessor(),de=this.rendererService,oe=de.useFramebuffer,Me=de.clear,Ge=(0,de.getViewportSize)(),gt=Ge.width,br=Ge.height;oe(this.renderToScreen?null:ge.getWriteFBO(),function(){Me({framebuffer:ge.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),Er.model.draw({uniforms:Ue({u_Texture:ge.getReadFBO(),u_ViewportSize:[gt,br]},Er.convertOptionsToUniforms(Er.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(Yt){this.enabled=Yt}},{key:"setRenderToScreen",value:function(Yt){this.renderToScreen=Yt}},{key:"updateOptions",value:function(Yt){this.optionsToUpdate=Ue(Ue({},this.optionsToUpdate),Yt)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(Yt){var Er={};return Object.keys(Yt).forEach(function(ge){G()(Yt[ge])||(Er["u_".concat(B()(Be()(ge)))]=Yt[ge])}),Er}}]),At}(),Vt=(0,O.Z)(Q.prototype,"shaderModuleService",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=Q))||Gt)},80533:(ie,L,y)=>{"use strict";y.d(L,{P:()=>M});var M=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},63877:()=>{},33511:()=>{},92444:(ie,L,y)=>{"use strict";y.d(L,{v:()=>M});var M={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},10120:(ie,L,y)=>{"use strict";y(43770)},88818:()=>{},30832:(ie,L,y)=>{"use strict";y.d(L,{SO:()=>M,z6:()=>Tr,a5:()=>_,Z:()=>yt,rQ:()=>mi,bV:()=>On,zi:()=>hi,ds:()=>Jt,Ev:()=>vr,oO:()=>It,W0:()=>or,Z6:()=>pr,We:()=>Pr,gJ:()=>at,vP:()=>$r,yM:()=>Z,yA:()=>St,CI:()=>mr});var M={};y.r(M),y.d(M,{DPR:()=>Ue,addClass:()=>W,create:()=>Be,empty:()=>ut,getClass:()=>Et,getContainer:()=>B,getViewPortScale:()=>ot,hasClass:()=>xt,printCanvas:()=>Vt,remove:()=>j,removeClass:()=>Ke,setClass:()=>Dt,setTransform:()=>Gt,splitWords:()=>G,triggerResize:()=>Q,trim:()=>H});var _={};y.r(_),y.d(_,{getColumn:()=>pe,getSatByColumn:()=>_e,max:()=>si,mean:()=>Pi,min:()=>ai,mode:()=>Ei,statMap:()=>re,sum:()=>Ki});var O=y(83838),R=window.document.documentElement.style;function B(V){var ae=V;return"string"==typeof V&&(ae=document.getElementById(V)),ae}function H(V){return V.trim?V.trim():V.replace(/^\s+|\s+$/g,"")}function G(V){return H(V).split(/\s+/)}function Be(V,ae,xe){var Oe=document.createElement(V);return Oe.className=ae||"",xe&&xe.appendChild(Oe),Oe}function j(V){var ae=V.parentNode;ae&&ae.removeChild(V)}function W(V,ae){if(void 0!==V.classList)for(var xe=G(ae),Oe=0,fe=xe.length;Oe<fe;Oe++)V.classList.add(xe[Oe]);else if(!xt(V,ae)){var Ae=Et(V);Dt(V,(Ae?Ae+" ":"")+ae)}}function Ke(V,ae){void 0!==V.classList?V.classList.remove(ae):Dt(V,H((" "+Et(V)+" ").replace(" "+ae+" "," ")))}function xt(V,ae){if(void 0!==V.classList)return V.classList.contains(ae);var xe=Et(V);return xe.length>0&&new RegExp("(^|\\s)"+ae+"(\\s|$)").test(xe)}function Dt(V,ae){V instanceof HTMLElement?V.className=ae:V.className.baseVal=ae}function Et(V){return V instanceof SVGElement&&(V=V.correspondingElement),void 0===V.className.baseVal?V.className:V.className.baseVal}function ut(V){for(;V&&V.firstChild;)V.removeChild(V.firstChild)}var tt=function(V){if(!R)return V[0];for(var ae in V)if(V[ae]&&V[ae]in R)return V[ae];return V[0]}(["transform","WebkitTransform"]);function Gt(V,ae){V.style[tt]=ae}function Q(){if("function"==typeof Event)window.dispatchEvent(new Event("resize"));else{var V=window.document.createEvent("UIEvents");V.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(V)}}function Vt(V){var ae=["padding: "+(V.height/2-8)+"px "+V.width/2+"px;","line-height: "+V.height+"px;","background-image: url("+V.toDataURL()+");"];console.log("%c\n",ae.join(""))}function ot(){var V,ae=document.querySelector('meta[name="viewport"]');if(!ae)return 1;var Oe=(null===(V=ae.content)||void 0===V?void 0:V.split(",")).find(function(fe){var Ae=fe.split("=");return"initial-scale"===(0,O.Z)(Ae,2)[0]});return Oe?1*Oe.split("=")[1]:1}var Ue=ot()<1?1:window.devicePixelRatio,pt=y(75134),Xe=y(47289),At=y(66518),kt=y(41885),Yt=y(59553),Er=y(99187),ge=y(92007);function oe(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(V){return!1}}function me(V,ae,xe){return(me=oe()?Reflect.construct:function(fe,Ae,wt){var Sr=[null];Sr.push.apply(Sr,Ae);var ir=new(Function.bind.apply(fe,Sr));return wt&&(0,ge.Z)(ir,wt.prototype),ir}).apply(null,arguments)}function Me(V){var ae="function"==typeof Map?new Map:void 0;return(Me=function(Oe){if(null===Oe||!function(V){return-1!==Function.toString.call(V).indexOf("[native code]")}(Oe))return Oe;if("function"!=typeof Oe)throw new TypeError("Super expression must either be null or a function");if(void 0!==ae){if(ae.has(Oe))return ae.get(Oe);ae.set(Oe,fe)}function fe(){return me(Oe,arguments,(0,Er.Z)(this).constructor)}return fe.prototype=Object.create(Oe.prototype,{constructor:{value:fe,enumerable:!1,writable:!0,configurable:!0}}),(0,ge.Z)(fe,Oe)})(V)}var Ge=y(93512);var Nr=function(V){(0,kt.Z)(xe,V);var ae=function(V){var ae=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(V){return!1}}();return function(){var fe,Oe=(0,Er.Z)(V);if(ae){var Ae=(0,Er.Z)(this).constructor;fe=Reflect.construct(Oe,arguments,Ae)}else fe=Oe.apply(this,arguments);return(0,Yt.Z)(this,fe)}}(xe);function xe(Oe,fe,Ae){var wt;return(0,pt.Z)(this,xe),wt=ae.call(this,Oe),(0,Ge.Z)((0,At.Z)(wt),"status",void 0),(0,Ge.Z)((0,At.Z)(wt),"url",void 0),wt.status=fe,wt.url=Ae,wt.name=wt.constructor.name,wt.message=Oe,wt}return(0,Xe.Z)(xe,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),xe}(Me(Error));var at=function(ae,xe){return function(ae,xe){var Oe=function(V){var ae=new XMLHttpRequest;for(var xe in ae.open("GET",V.url,!0),V.headers)V.headers.hasOwnProperty(xe)&&ae.setRequestHeader(xe,V.headers[xe]);return ae.withCredentials="include"===V.credentials,ae}(ae);return Oe.responseType="arraybuffer",Oe.onerror=function(){xe(new Error(Oe.statusText))},Oe.onload=function(){var fe=Oe.response;if(0===fe.byteLength&&200===Oe.status)return xe(new Error("http status 200 returned without content."));Oe.status>=200&&Oe.status<300&&Oe.response?xe(null,{data:fe,cacheControl:Oe.getResponseHeader("Cache-Control"),expires:Oe.getResponseHeader("Expires")}):xe(new Nr(Oe.statusText,Oe.status,ae.url))},Oe.send(),Oe}(ae,function(Oe,fe){if(Oe)xe(Oe);else if(fe){var Ae=new window.Image;Ae.crossOrigin="anonymous";var wt=window.URL||window.webkitURL;Ae.onload=function(){xe(null,Ae),wt.revokeObjectURL(Ae.src)};var Sr=new window.Blob([new Uint8Array(fe.data)],{type:"image/png"});Ae.src=fe.data.byteLength?wt.createObjectURL(Sr):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},Re=y(70576),qt=2*Math.PI*6378137/2;function Pr(V){var ae=[1/0,1/0,-1/0,-1/0];return V.forEach(function(xe){er(ae,xe.coordinates)}),ae}function er(V,ae){return Array.isArray(ae[0])?ae.forEach(function(xe){er(V,xe)}):(V[0]>ae[0]&&(V[0]=ae[0]),V[1]>ae[1]&&(V[1]=ae[1]),V[2]<ae[0]&&(V[2]=ae[0]),V[3]<ae[1]&&(V[3]=ae[1])),V}function $r(V){var ae=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],xe=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1},Oe=(V=nt(V,ae))[0],fe=V[1],Ae=Oe*qt/180,wt=Math.log(Math.tan((90+fe)*Math.PI/360))/(Math.PI/180);return wt=wt*qt/180,xe.enable&&(Ae=Number(Ae.toFixed(xe.decimal)),wt=Number(wt.toFixed(xe.decimal))),3===V.length?[Ae,wt,V[2]]:[Ae,wt]}function nt(V,ae){if(!1===ae)return V;var xe=function(V){if(null==V)throw new Error("lng is required");return(V>180||V<-180)&&((V%=360)>180&&(V=-360+V),V<-180&&(V=360+V),0===V&&(V=0)),V}(V[0]),Oe=function(V){if(null==V)throw new Error("lat is required");return(V>90||V<-90)&&((V%=180)>90&&(V=-180+V),V<-90&&(V=180+V),0===V&&(V=0)),V}(V[1]);return Oe>85&&(Oe=85),Oe<-85&&(Oe=-85),3===V.length?[xe,Oe,V[2]]:[xe,Oe]}function yt(V){var ae=85.0511287798,xe=Math.max(Math.min(ae,V[1]),-ae),Oe=256<<20,fe=Math.PI/180,Ae=V[0]*fe,wt=xe*fe;return wt=Math.log(Math.tan(Math.PI/4+wt/2)),Ae=Oe*(.5/Math.PI*Ae+.5),wt=Oe*(-.5/Math.PI*wt+(fe=.5)),[Math.floor(Ae),Math.floor(wt)]}function Z(V,ae,xe){var Oe=(0,Re.Ht)(ae[1]-V[1]),fe=(0,Re.Ht)(ae[0]-V[0]),Ae=(0,Re.Ht)(V[1]),wt=(0,Re.Ht)(ae[1]),Sr=Math.pow(Math.sin(Oe/2),2)+Math.pow(Math.sin(fe/2),2)*Math.cos(Ae)*Math.cos(wt);return(0,Re.DL)(2*Math.atan2(Math.sqrt(Sr),Math.sqrt(1-Sr)),"meters")}function St(V,ae){var xe=Math.abs(V[1][1]-V[0][1])*ae,Oe=Math.abs(V[1][0]-V[0][0])*ae;return[[V[0][0]-Oe,V[0][1]-xe],[V[1][0]+Oe,V[1][1]+xe]]}function It(V,ae){return V[0][0]<=ae[0][0]&&V[0][1]<=ae[0][1]&&V[1][0]>=ae[1][0]&&V[1][1]>=ae[1][1]}function Jt(V){return[[V[0],V[1]],[V[2],V[3]]]}var Tr=function(){function V(){var ae=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,xe=arguments.length>1?arguments[1]:void 0;(0,pt.Z)(this,V),(0,Ge.Z)(this,"limit",void 0),(0,Ge.Z)(this,"cache",void 0),(0,Ge.Z)(this,"destroy",void 0),(0,Ge.Z)(this,"order",void 0),this.limit=ae,this.destroy=xe||this.defaultDestroy,this.order=[],this.clear()}return(0,Xe.Z)(V,[{key:"clear",value:function(){var xe=this;this.order.forEach(function(Oe){xe.delete(Oe)}),this.cache={},this.order=[]}},{key:"get",value:function(xe){var Oe=this.cache[xe];return Oe&&(this.deleteOrder(xe),this.appendOrder(xe)),Oe}},{key:"set",value:function(xe,Oe){this.cache[xe]?(this.delete(xe),this.cache[xe]=Oe,this.appendOrder(xe)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[xe]=Oe,this.appendOrder(xe))}},{key:"delete",value:function(xe){var Oe=this.cache[xe];Oe&&(this.deleteCache(xe),this.deleteOrder(xe),this.destroy(Oe,xe))}},{key:"deleteCache",value:function(xe){delete this.cache[xe]}},{key:"deleteOrder",value:function(xe){var Oe=this.order.findIndex(function(fe){return fe===xe});Oe>=0&&this.order.splice(Oe,1)}},{key:"appendOrder",value:function(xe){this.order.push(xe)}},{key:"defaultDestroy",value:function(xe,Oe){return null}}]),V}();function vr(V,ae){V.forEach(function(xe){!ae[xe]||(ae[xe]=ae[xe].bind(ae))})}var Xt=y(27859);function mr(V){var ae=Xt.ZP(V),xe=[0,0,0,0];return null!=ae&&(xe[0]=ae.r/255,xe[1]=ae.g/255,xe[2]=ae.b/255,xe[3]=ae.opacity),xe}function or(V){return(V&&V[0])+256*(V&&V[1])+65536*(V&&V[2])-1}function pr(V){return[V+1&255,V+1>>8&255,V+1>>8>>8&255]}var On=(()=>{return(V=On||(On={})).CENTER="center",V.TOP="top",V["TOP-LEFT"]="top-left",V["TOP-RIGHT"]="top-right",V.BOTTOM="bottom",V["BOTTOM-LEFT"]="bottom-left",V.LEFT="left",V.RIGHT="right",On;var V})(),mi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hi(V,ae,xe){var Oe=V.classList;for(var fe in mi)mi.hasOwnProperty(fe)&&Oe.remove("l7-".concat(xe,"-anchor-").concat(fe));Oe.add("l7-".concat(xe,"-anchor-").concat(ae))}function si(V){if(0===V.length)throw new Error("max requires at least one data point");for(var ae=V[0],xe=1;xe<V.length;xe++)V[xe]>ae&&(ae=V[xe]);return 1*ae}function ai(V){if(0===V.length)throw new Error("min requires at least one data point");for(var ae=V[0],xe=1;xe<V.length;xe++)V[xe]<ae&&(ae=V[xe]);return 1*ae}function Ki(V){if(0===V.length)return 0;for(var ae=1*V[0],xe=1;xe<V.length;xe++)ae+=1*V[xe];return ae}function Pi(V){if(0===V.length)throw new Error("mean requires at least one data point");return Ki(V)/V.length}function Ei(V){if(0===V.length)throw new Error("mean requires at least one data point");if(V.length<3)return V[0];V.sort();for(var ae=V[0],xe=NaN,Oe=0,fe=1,Ae=1;Ae<V.length+1;Ae++)V[Ae]!==ae?(fe>Oe&&(Oe=fe,xe=ae),fe=1,ae=V[Ae]):fe++;return 1*xe}var re={min:ai,max:si,mean:Pi,sum:Ki,mode:Ei};function pe(V,ae){return V.map(function(xe){return xe[ae]})}function _e(V,ae){return re[V](ae)}},97935:(ie,L,y)=>{var M=y(96847);function c(R){var B=0;if(R&&R.length>0){B+=Math.abs(g(R[0]));for(var H=1;H<R.length;H++)B-=Math.abs(g(R[H]))}return B}function g(R){var B,H,be,Be,j,W,Ke=0,xt=R.length;if(xt>2){for(W=0;W<xt;W++)W===xt-2?(be=xt-2,Be=xt-1,j=0):W===xt-1?(be=xt-1,Be=0,j=1):(be=W,Be=W+1,j=W+2),B=R[be],H=R[Be],Ke+=(O(R[j][0])-O(B[0]))*Math.sin(O(H[1]));Ke=Ke*M.RADIUS*M.RADIUS/2}return Ke}function O(R){return R*Math.PI/180}ie.exports.geometry=function _(R){var H,B=0;switch(R.type){case"Polygon":return c(R.coordinates);case"MultiPolygon":for(H=0;H<R.coordinates.length;H++)B+=c(R.coordinates[H]);return B;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(H=0;H<R.geometries.length;H++)B+=_(R.geometries[H]);return B}},ie.exports.ring=g},57452:(ie,L,y)=>{var M=y(97935);function c(H,G){return function(be){return H(be,G)}}function O(H,G){H[0]=R(H[0],G=!!G);for(var be=1;be<H.length;be++)H[be]=R(H[be],!G);return H}function R(H,G){return function(H){return M.ring(H)>=0}(H)===G?H:H.reverse()}ie.exports=function _(H,G){switch(H&&H.type||null){case"FeatureCollection":return H.features=H.features.map(c(_,G)),H;case"GeometryCollection":return H.geometries=H.geometries.map(c(_,G)),H;case"Feature":return H.geometry=_(H.geometry,G),H;case"Polygon":case"MultiPolygon":return function(H,G){return"Polygon"===H.type?H.coordinates=O(H.coordinates,G):"MultiPolygon"===H.type&&(H.coordinates=H.coordinates.map(c(O,G))),H}(H,G);default:return H}}},51002:ie=>{"use strict";ie.exports=y,ie.exports.default=y;var L=1e20;function y(O,R,B,H,G,be){this.fontSize=O||24,this.buffer=void 0===R?3:R,this.cutoff=H||.25,this.fontFamily=G||"sans-serif",this.fontWeight=be||"normal",this.radius=B||8;var Be=this.size=this.fontSize+2*this.buffer,j=Be+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Be,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(j*j),this.gridInner=new Float64Array(j*j),this.f=new Float64Array(j),this.z=new Float64Array(j+1),this.v=new Uint16Array(j),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(Be/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function c(O,R,B,H,G,be){for(var Be=0;Be<R;Be++)g(O,Be,R,B,H,G,be);for(var j=0;j<B;j++)g(O,j*R,1,R,H,G,be)}function g(O,R,B,H,G,be,Be){var j,W,Ke,xt;for(be[0]=0,Be[0]=-L,Be[1]=L,j=0;j<H;j++)G[j]=O[R+j*B];for(j=1,W=0,Ke=0;j<H;j++){do{Ke=(G[j]-G[xt=be[W]]+j*j-xt*xt)/(j-xt)/2}while(Ke<=Be[W]&&--W>-1);be[++W]=j,Be[W]=Ke,Be[W+1]=L}for(j=0,W=0;j<H;j++){for(;Be[W+1]<j;)W++;O[R+j*B]=G[xt=be[W]]+(j-xt)*(j-xt)}}y.prototype._draw=function(O,R){var be,Be,j,W,Ke,xt,Dt,Et,ut,B=this.ctx.measureText(O),H=B.width,G=2*this.buffer;R&&this.useMetrics?(Ke=Math.floor(B.actualBoundingBoxAscent),Et=this.buffer+Math.ceil(B.actualBoundingBoxAscent),xt=this.buffer,Dt=this.buffer,be=(Be=Math.min(this.size,Math.ceil(B.actualBoundingBoxRight-B.actualBoundingBoxLeft)))+G,j=(W=Math.min(this.size-xt,Math.ceil(B.actualBoundingBoxAscent+B.actualBoundingBoxDescent)))+G,this.ctx.textBaseline="alphabetic"):(be=Be=this.size,j=W=this.size,Ke=19*this.fontSize/24,xt=Dt=0,Et=this.middle,this.ctx.textBaseline="middle"),Be&&W&&(this.ctx.clearRect(Dt,xt,Be,W),this.ctx.fillText(O,this.buffer,Et),ut=this.ctx.getImageData(Dt,xt,Be,W));var tt=new Uint8ClampedArray(be*j);return function(O,R,B,H,G,be,Be){be.fill(L,0,R*B),Be.fill(0,0,R*B);for(var j=(R-H)/2,W=0;W<G;W++)for(var Ke=0;Ke<H;Ke++){var xt=(W+j)*R+Ke+j,Dt=O.data[4*(W*H+Ke)+3]/255;if(1===Dt)be[xt]=0,Be[xt]=L;else if(0===Dt)be[xt]=L,Be[xt]=0;else{var Et=Math.max(0,.5-Dt),ut=Math.max(0,Dt-.5);be[xt]=Et*Et,Be[xt]=ut*ut}}}(ut,be,j,Be,W,this.gridOuter,this.gridInner),c(this.gridOuter,be,j,this.f,this.v,this.z),c(this.gridInner,be,j,this.f,this.v,this.z),function(O,R,B,H,G,be,Be){for(var j=0;j<R*B;j++){var W=Math.sqrt(H[j])-Math.sqrt(G[j]);O[j]=Math.round(255-255*(W/be+Be))}}(tt,be,j,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:tt,metrics:{width:Be,height:W,sdfWidth:be,sdfHeight:j,top:Ke,left:0,advance:H}}},y.prototype.draw=function(O){return this._draw(O,!1).data},y.prototype.drawWithMetrics=function(O){return this._draw(O,!0)}},27859:(ie,L,y)=>{"use strict";function M(me,Me,Ge){me.prototype=Me.prototype=Ge,Ge.constructor=me}function _(me,Me){var Ge=Object.create(me.prototype);for(var gt in Me)Ge[gt]=Me[gt];return Ge}function c(){}y.d(L,{ZP:()=>Gt,B8:()=>Ue});var g=.7,O=1/g,R="\\s*([+-]?\\d+)\\s*",B="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",H="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",G=/^#([0-9a-f]{3,8})$/,be=new RegExp("^rgb\\("+[R,R,R]+"\\)$"),Be=new RegExp("^rgb\\("+[H,H,H]+"\\)$"),j=new RegExp("^rgba\\("+[R,R,R,B]+"\\)$"),W=new RegExp("^rgba\\("+[H,H,H,B]+"\\)$"),Ke=new RegExp("^hsl\\("+[B,H,H]+"\\)$"),xt=new RegExp("^hsla\\("+[B,H,H,B]+"\\)$"),Dt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Et(){return this.rgb().formatHex()}function tt(){return this.rgb().formatRgb()}function Gt(me){var Me,Ge;return me=(me+"").trim().toLowerCase(),(Me=G.exec(me))?(Ge=Me[1].length,Me=parseInt(Me[1],16),6===Ge?Q(Me):3===Ge?new pt(Me>>8&15|Me>>4&240,Me>>4&15|240&Me,(15&Me)<<4|15&Me,1):8===Ge?Vt(Me>>24&255,Me>>16&255,Me>>8&255,(255&Me)/255):4===Ge?Vt(Me>>12&15|Me>>8&240,Me>>8&15|Me>>4&240,Me>>4&15|240&Me,((15&Me)<<4|15&Me)/255):null):(Me=be.exec(me))?new pt(Me[1],Me[2],Me[3],1):(Me=Be.exec(me))?new pt(255*Me[1]/100,255*Me[2]/100,255*Me[3]/100,1):(Me=j.exec(me))?Vt(Me[1],Me[2],Me[3],Me[4]):(Me=W.exec(me))?Vt(255*Me[1]/100,255*Me[2]/100,255*Me[3]/100,Me[4]):(Me=Ke.exec(me))?Yt(Me[1],Me[2]/100,Me[3]/100,1):(Me=xt.exec(me))?Yt(Me[1],Me[2]/100,Me[3]/100,Me[4]):Dt.hasOwnProperty(me)?Q(Dt[me]):"transparent"===me?new pt(NaN,NaN,NaN,0):null}function Q(me){return new pt(me>>16&255,me>>8&255,255&me,1)}function Vt(me,Me,Ge,gt){return gt<=0&&(me=Me=Ge=NaN),new pt(me,Me,Ge,gt)}function ot(me){return me instanceof c||(me=Gt(me)),me?new pt((me=me.rgb()).r,me.g,me.b,me.opacity):new pt}function Ue(me,Me,Ge,gt){return 1===arguments.length?ot(me):new pt(me,Me,Ge,null==gt?1:gt)}function pt(me,Me,Ge,gt){this.r=+me,this.g=+Me,this.b=+Ge,this.opacity=+gt}function Xe(){return"#"+kt(this.r)+kt(this.g)+kt(this.b)}function At(){var me=this.opacity;return(1===(me=isNaN(me)?1:Math.max(0,Math.min(1,me)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===me?")":", "+me+")")}function kt(me){return((me=Math.max(0,Math.min(255,Math.round(me)||0)))<16?"0":"")+me.toString(16)}function Yt(me,Me,Ge,gt){return gt<=0?me=Me=Ge=NaN:Ge<=0||Ge>=1?me=Me=NaN:Me<=0&&(me=NaN),new de(me,Me,Ge,gt)}function Er(me){if(me instanceof de)return new de(me.h,me.s,me.l,me.opacity);if(me instanceof c||(me=Gt(me)),!me)return new de;if(me instanceof de)return me;var Me=(me=me.rgb()).r/255,Ge=me.g/255,gt=me.b/255,br=Math.min(Me,Ge,gt),Nr=Math.max(Me,Ge,gt),cn=NaN,Ir=Nr-br,Mt=(Nr+br)/2;return Ir?(cn=Me===Nr?(Ge-gt)/Ir+6*(Ge<gt):Ge===Nr?(gt-Me)/Ir+2:(Me-Ge)/Ir+4,Ir/=Mt<.5?Nr+br:2-Nr-br,cn*=60):Ir=Mt>0&&Mt<1?0:cn,new de(cn,Ir,Mt,me.opacity)}function de(me,Me,Ge,gt){this.h=+me,this.s=+Me,this.l=+Ge,this.opacity=+gt}function oe(me,Me,Ge){return 255*(me<60?Me+(Ge-Me)*me/60:me<180?Ge:me<240?Me+(Ge-Me)*(240-me)/60:Me)}M(c,Gt,{copy:function(me){return Object.assign(new this.constructor,this,me)},displayable:function(){return this.rgb().displayable()},hex:Et,formatHex:Et,formatHsl:function(){return Er(this).formatHsl()},formatRgb:tt,toString:tt}),M(pt,Ue,_(c,{brighter:function(me){return me=null==me?O:Math.pow(O,me),new pt(this.r*me,this.g*me,this.b*me,this.opacity)},darker:function(me){return me=null==me?g:Math.pow(g,me),new pt(this.r*me,this.g*me,this.b*me,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xe,formatHex:Xe,formatRgb:At,toString:At})),M(de,function(me,Me,Ge,gt){return 1===arguments.length?Er(me):new de(me,Me,Ge,null==gt?1:gt)},_(c,{brighter:function(me){return me=null==me?O:Math.pow(O,me),new de(this.h,this.s,this.l*me,this.opacity)},darker:function(me){return me=null==me?g:Math.pow(g,me),new de(this.h,this.s,this.l*me,this.opacity)},rgb:function(){var me=this.h%360+360*(this.h<0),Me=isNaN(me)||isNaN(this.s)?0:this.s,Ge=this.l,gt=Ge+(Ge<.5?Ge:1-Ge)*Me,br=2*Ge-gt;return new pt(oe(me>=240?me-240:me+120,br,gt),oe(me,br,gt),oe(me<120?me+240:me-120,br,gt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var me=this.opacity;return(1===(me=isNaN(me)?1:Math.max(0,Math.min(1,me)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===me?")":", "+me+")")}}))},41604:ie=>{"use strict";function L(ge,de,oe){oe=oe||2;var br,Nr,cn,Ir,Mt,Le,we,me=de&&de.length,Me=me?de[0]*oe:ge.length,Ge=y(ge,0,Me,oe,!0),gt=[];if(!Ge||Ge.next===Ge.prev)return gt;if(me&&(Ge=function(ge,de,oe,me){var Ge,gt,cn,Me=[];for(Ge=0,gt=de.length;Ge<gt;Ge++)(cn=y(ge,de[Ge]*me,Ge<gt-1?de[Ge+1]*me:ge.length,me,!1))===cn.next&&(cn.steiner=!0),Me.push(xt(cn));for(Me.sort(H),Ge=0;Ge<Me.length;Ge++)oe=M(oe=G(Me[Ge],oe),oe.next);return oe}(ge,de,Ge,oe)),ge.length>80*oe){br=cn=ge[0],Nr=Ir=ge[1];for(var at=oe;at<Me;at+=oe)(Mt=ge[at])<br&&(br=Mt),(Le=ge[at+1])<Nr&&(Nr=Le),Mt>cn&&(cn=Mt),Le>Ir&&(Ir=Le);we=0!==(we=Math.max(cn-br,Ir-Nr))?1/we:0}return _(Ge,gt,oe,br,Nr,we),gt}function y(ge,de,oe,me,Me){var Ge,gt;if(Me===Er(ge,de,oe,me)>0)for(Ge=de;Ge<oe;Ge+=me)gt=At(Ge,ge[Ge],ge[Ge+1],gt);else for(Ge=oe-me;Ge>=de;Ge-=me)gt=At(Ge,ge[Ge],ge[Ge+1],gt);return gt&&tt(gt,gt.next)&&(kt(gt),gt=gt.next),gt}function M(ge,de){if(!ge)return ge;de||(de=ge);var me,oe=ge;do{if(me=!1,oe.steiner||!tt(oe,oe.next)&&0!==ut(oe.prev,oe,oe.next))oe=oe.next;else{if(kt(oe),(oe=de=oe.prev)===oe.next)break;me=!0}}while(me||oe!==de);return de}function _(ge,de,oe,me,Me,Ge,gt){if(ge){!gt&&Ge&&function(ge,de,oe,me){var Me=ge;do{null===Me.z&&(Me.z=Ke(Me.x,Me.y,de,oe,me)),Me.prevZ=Me.prev,Me.nextZ=Me.next,Me=Me.next}while(Me!==ge);Me.prevZ.nextZ=null,Me.prevZ=null,function(ge){var de,oe,me,Me,Ge,gt,br,Nr,cn=1;do{for(oe=ge,ge=null,Ge=null,gt=0;oe;){for(gt++,me=oe,br=0,de=0;de<cn&&(br++,me=me.nextZ);de++);for(Nr=cn;br>0||Nr>0&&me;)0!==br&&(0===Nr||!me||oe.z<=me.z)?(Me=oe,oe=oe.nextZ,br--):(Me=me,me=me.nextZ,Nr--),Ge?Ge.nextZ=Me:ge=Me,Me.prevZ=Ge,Ge=Me;oe=me}Ge.nextZ=null,cn*=2}while(gt>1)}(Me)}(ge,me,Me,Ge);for(var Nr,cn,br=ge;ge.prev!==ge.next;)if(Nr=ge.prev,cn=ge.next,Ge?g(ge,me,Me,Ge):c(ge))de.push(Nr.i/oe),de.push(ge.i/oe),de.push(cn.i/oe),kt(ge),ge=cn.next,br=cn.next;else if((ge=cn)===br){gt?1===gt?_(ge=O(M(ge),de,oe),de,oe,me,Me,Ge,2):2===gt&&R(ge,de,oe,me,Me,Ge):_(M(ge),de,oe,me,Me,Ge,1);break}}}function c(ge){var de=ge.prev,oe=ge,me=ge.next;if(ut(de,oe,me)>=0)return!1;for(var Me=ge.next.next;Me!==ge.prev;){if(Dt(de.x,de.y,oe.x,oe.y,me.x,me.y,Me.x,Me.y)&&ut(Me.prev,Me,Me.next)>=0)return!1;Me=Me.next}return!0}function g(ge,de,oe,me){var Me=ge.prev,Ge=ge,gt=ge.next;if(ut(Me,Ge,gt)>=0)return!1;for(var cn=Me.x>Ge.x?Me.x>gt.x?Me.x:gt.x:Ge.x>gt.x?Ge.x:gt.x,Ir=Me.y>Ge.y?Me.y>gt.y?Me.y:gt.y:Ge.y>gt.y?Ge.y:gt.y,Mt=Ke(Me.x<Ge.x?Me.x<gt.x?Me.x:gt.x:Ge.x<gt.x?Ge.x:gt.x,Me.y<Ge.y?Me.y<gt.y?Me.y:gt.y:Ge.y<gt.y?Ge.y:gt.y,de,oe,me),Le=Ke(cn,Ir,de,oe,me),we=ge.prevZ,at=ge.nextZ;we&&we.z>=Mt&&at&&at.z<=Le;){if(we!==ge.prev&&we!==ge.next&&Dt(Me.x,Me.y,Ge.x,Ge.y,gt.x,gt.y,we.x,we.y)&&ut(we.prev,we,we.next)>=0||(we=we.prevZ,at!==ge.prev&&at!==ge.next&&Dt(Me.x,Me.y,Ge.x,Ge.y,gt.x,gt.y,at.x,at.y)&&ut(at.prev,at,at.next)>=0))return!1;at=at.nextZ}for(;we&&we.z>=Mt;){if(we!==ge.prev&&we!==ge.next&&Dt(Me.x,Me.y,Ge.x,Ge.y,gt.x,gt.y,we.x,we.y)&&ut(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;at&&at.z<=Le;){if(at!==ge.prev&&at!==ge.next&&Dt(Me.x,Me.y,Ge.x,Ge.y,gt.x,gt.y,at.x,at.y)&&ut(at.prev,at,at.next)>=0)return!1;at=at.nextZ}return!0}function O(ge,de,oe){var me=ge;do{var Me=me.prev,Ge=me.next.next;!tt(Me,Ge)&&Gt(Me,me,me.next,Ge)&&Ue(Me,Ge)&&Ue(Ge,Me)&&(de.push(Me.i/oe),de.push(me.i/oe),de.push(Ge.i/oe),kt(me),kt(me.next),me=ge=Ge),me=me.next}while(me!==ge);return M(me)}function R(ge,de,oe,me,Me,Ge){var gt=ge;do{for(var br=gt.next.next;br!==gt.prev;){if(gt.i!==br.i&&Et(gt,br)){var Nr=Xe(gt,br);return gt=M(gt,gt.next),Nr=M(Nr,Nr.next),_(gt,de,oe,me,Me,Ge),void _(Nr,de,oe,me,Me,Ge)}br=br.next}gt=gt.next}while(gt!==ge)}function H(ge,de){return ge.x-de.x}function G(ge,de){var oe=function(ge,de){var gt,oe=de,me=ge.x,Me=ge.y,Ge=-1/0;do{if(Me<=oe.y&&Me>=oe.next.y&&oe.next.y!==oe.y){var br=oe.x+(Me-oe.y)*(oe.next.x-oe.x)/(oe.next.y-oe.y);if(br<=me&&br>Ge){if(Ge=br,br===me){if(Me===oe.y)return oe;if(Me===oe.next.y)return oe.next}gt=oe.x<oe.next.x?oe:oe.next}}oe=oe.next}while(oe!==de);if(!gt)return null;if(me===Ge)return gt;var Le,Nr=gt,cn=gt.x,Ir=gt.y,Mt=1/0;oe=gt;do{me>=oe.x&&oe.x>=cn&&me!==oe.x&&Dt(Me<Ir?me:Ge,Me,cn,Ir,Me<Ir?Ge:me,Me,oe.x,oe.y)&&(Le=Math.abs(Me-oe.y)/(me-oe.x),Ue(oe,ge)&&(Le<Mt||Le===Mt&&(oe.x>gt.x||oe.x===gt.x&&Be(gt,oe)))&&(gt=oe,Mt=Le)),oe=oe.next}while(oe!==Nr);return gt}(ge,de);if(!oe)return de;var me=Xe(oe,ge),Me=M(oe,oe.next);return M(me,me.next),de===oe?Me:de}function Be(ge,de){return ut(ge.prev,ge,de.prev)<0&&ut(de.next,ge,ge.next)<0}function Ke(ge,de,oe,me,Me){return(ge=1431655765&((ge=858993459&((ge=252645135&((ge=16711935&((ge=32767*(ge-oe)*Me)|ge<<8))|ge<<4))|ge<<2))|ge<<1))|(de=1431655765&((de=858993459&((de=252645135&((de=16711935&((de=32767*(de-me)*Me)|de<<8))|de<<4))|de<<2))|de<<1))<<1}function xt(ge){var de=ge,oe=ge;do{(de.x<oe.x||de.x===oe.x&&de.y<oe.y)&&(oe=de),de=de.next}while(de!==ge);return oe}function Dt(ge,de,oe,me,Me,Ge,gt,br){return(Me-gt)*(de-br)-(ge-gt)*(Ge-br)>=0&&(ge-gt)*(me-br)-(oe-gt)*(de-br)>=0&&(oe-gt)*(Ge-br)-(Me-gt)*(me-br)>=0}function Et(ge,de){return ge.next.i!==de.i&&ge.prev.i!==de.i&&!function(ge,de){var oe=ge;do{if(oe.i!==ge.i&&oe.next.i!==ge.i&&oe.i!==de.i&&oe.next.i!==de.i&&Gt(oe,oe.next,ge,de))return!0;oe=oe.next}while(oe!==ge);return!1}(ge,de)&&(Ue(ge,de)&&Ue(de,ge)&&function(ge,de){var oe=ge,me=!1,Me=(ge.x+de.x)/2,Ge=(ge.y+de.y)/2;do{oe.y>Ge!=oe.next.y>Ge&&oe.next.y!==oe.y&&Me<(oe.next.x-oe.x)*(Ge-oe.y)/(oe.next.y-oe.y)+oe.x&&(me=!me),oe=oe.next}while(oe!==ge);return me}(ge,de)&&(ut(ge.prev,ge,de.prev)||ut(ge,de.prev,de))||tt(ge,de)&&ut(ge.prev,ge,ge.next)>0&&ut(de.prev,de,de.next)>0)}function ut(ge,de,oe){return(de.y-ge.y)*(oe.x-de.x)-(de.x-ge.x)*(oe.y-de.y)}function tt(ge,de){return ge.x===de.x&&ge.y===de.y}function Gt(ge,de,oe,me){var Me=Vt(ut(ge,de,oe)),Ge=Vt(ut(ge,de,me)),gt=Vt(ut(oe,me,ge)),br=Vt(ut(oe,me,de));return!!(Me!==Ge&&gt!==br||0===Me&&Q(ge,oe,de)||0===Ge&&Q(ge,me,de)||0===gt&&Q(oe,ge,me)||0===br&&Q(oe,de,me))}function Q(ge,de,oe){return de.x<=Math.max(ge.x,oe.x)&&de.x>=Math.min(ge.x,oe.x)&&de.y<=Math.max(ge.y,oe.y)&&de.y>=Math.min(ge.y,oe.y)}function Vt(ge){return ge>0?1:ge<0?-1:0}function Ue(ge,de){return ut(ge.prev,ge,ge.next)<0?ut(ge,de,ge.next)>=0&&ut(ge,ge.prev,de)>=0:ut(ge,de,ge.prev)<0||ut(ge,ge.next,de)<0}function Xe(ge,de){var oe=new Yt(ge.i,ge.x,ge.y),me=new Yt(de.i,de.x,de.y),Me=ge.next,Ge=de.prev;return ge.next=de,de.prev=ge,oe.next=Me,Me.prev=oe,me.next=oe,oe.prev=me,Ge.next=me,me.prev=Ge,me}function At(ge,de,oe,me){var Me=new Yt(ge,de,oe);return me?(Me.next=me.next,Me.prev=me,me.next.prev=Me,me.next=Me):(Me.prev=Me,Me.next=Me),Me}function kt(ge){ge.next.prev=ge.prev,ge.prev.next=ge.next,ge.prevZ&&(ge.prevZ.nextZ=ge.nextZ),ge.nextZ&&(ge.nextZ.prevZ=ge.prevZ)}function Yt(ge,de,oe){this.i=ge,this.x=de,this.y=oe,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Er(ge,de,oe,me){for(var Me=0,Ge=de,gt=oe-me;Ge<oe;Ge+=me)Me+=(ge[gt]-ge[Ge])*(ge[Ge+1]+ge[gt+1]),gt=Ge;return Me}ie.exports=L,ie.exports.default=L,L.deviation=function(ge,de,oe,me){var Me=de&&de.length,gt=Math.abs(Er(ge,0,Me?de[0]*oe:ge.length,oe));if(Me)for(var br=0,Nr=de.length;br<Nr;br++)gt-=Math.abs(Er(ge,de[br]*oe,br<Nr-1?de[br+1]*oe:ge.length,oe));var Mt=0;for(br=0;br<me.length;br+=3){var Le=me[br]*oe,we=me[br+1]*oe,at=me[br+2]*oe;Mt+=Math.abs((ge[Le]-ge[at])*(ge[we+1]-ge[Le+1])-(ge[Le]-ge[we])*(ge[at+1]-ge[Le+1]))}return 0===gt&&0===Mt?0:Math.abs((Mt-gt)/gt)},L.flatten=function(ge){for(var de=ge[0][0].length,oe={vertices:[],holes:[],dimensions:de},me=0,Me=0;Me<ge.length;Me++){for(var Ge=0;Ge<ge[Me].length;Ge++)for(var gt=0;gt<de;gt++)oe.vertices.push(ge[Me][Ge][gt]);Me>0&&oe.holes.push(me+=ge[Me-1].length)}return oe}},18660:ie=>{function L(M){var _=M.target||M.srcElement;_.__resizeRAF__&&cancelAnimationFrame(_.__resizeRAF__),_.__resizeRAF__=requestAnimationFrame(function(){var c=_.__resizeTrigger__,g=c&&c.__resizeListeners__;g&&g.forEach(function(O){O.call(c,M)})})}var y=function(_,c){var R,O=this.document,B=O.attachEvent;if("undefined"!=typeof navigator&&(R=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!_.__resizeListeners__)if(_.__resizeListeners__=[],B)_.__resizeTrigger__=_,_.attachEvent("onresize",L);else{"static"===getComputedStyle(_).position&&(_.style.position="relative");var G=_.__resizeTrigger__=O.createElement("object");G.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),G.setAttribute("class","resize-sensor"),G.setAttribute("tabindex","-1"),G.setAttribute("title",""),G.__resizeElement__=_,G.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",L)},G.type="text/html",R&&_.appendChild(G),G.data="about:blank",R||_.appendChild(G)}_.__resizeListeners__.push(c)};ie.exports="undefined"==typeof window?y:y.bind(window),ie.exports.unbind=function(M,_){var c=document.attachEvent,g=M.__resizeListeners__||[];if(_){var O=g.indexOf(_);-1!==O&&g.splice(O,1)}else g=M.__resizeListeners__=[];if(!g.length){if(c)M.detachEvent("onresize",L);else if(M.__resizeTrigger__){var R=M.__resizeTrigger__.contentDocument,B=R&&R.defaultView;B&&(B.removeEventListener("resize",L),delete B.__resizeTrigger__),M.__resizeTrigger__=!M.removeChild(M.__resizeTrigger__)}delete M.__resizeListeners__}}},42624:ie=>{"use strict";var L=Object.prototype.hasOwnProperty,y="~";function M(){}function _(R,B,H){this.fn=R,this.context=B,this.once=H||!1}function c(R,B,H,G,be){if("function"!=typeof H)throw new TypeError("The listener must be a function");var Be=new _(H,G||R,be),j=y?y+B:B;return R._events[j]?R._events[j].fn?R._events[j]=[R._events[j],Be]:R._events[j].push(Be):(R._events[j]=Be,R._eventsCount++),R}function g(R,B){0==--R._eventsCount?R._events=new M:delete R._events[B]}function O(){this._events=new M,this._eventsCount=0}Object.create&&(M.prototype=Object.create(null),(new M).__proto__||(y=!1)),O.prototype.eventNames=function(){var H,G,B=[];if(0===this._eventsCount)return B;for(G in H=this._events)L.call(H,G)&&B.push(y?G.slice(1):G);return Object.getOwnPropertySymbols?B.concat(Object.getOwnPropertySymbols(H)):B},O.prototype.listeners=function(B){var G=this._events[y?y+B:B];if(!G)return[];if(G.fn)return[G.fn];for(var be=0,Be=G.length,j=new Array(Be);be<Be;be++)j[be]=G[be].fn;return j},O.prototype.listenerCount=function(B){var G=this._events[y?y+B:B];return G?G.fn?1:G.length:0},O.prototype.emit=function(B,H,G,be,Be,j){var W=y?y+B:B;if(!this._events[W])return!1;var Dt,Et,Ke=this._events[W],xt=arguments.length;if(Ke.fn){switch(Ke.once&&this.removeListener(B,Ke.fn,void 0,!0),xt){case 1:return Ke.fn.call(Ke.context),!0;case 2:return Ke.fn.call(Ke.context,H),!0;case 3:return Ke.fn.call(Ke.context,H,G),!0;case 4:return Ke.fn.call(Ke.context,H,G,be),!0;case 5:return Ke.fn.call(Ke.context,H,G,be,Be),!0;case 6:return Ke.fn.call(Ke.context,H,G,be,Be,j),!0}for(Et=1,Dt=new Array(xt-1);Et<xt;Et++)Dt[Et-1]=arguments[Et];Ke.fn.apply(Ke.context,Dt)}else{var tt,ut=Ke.length;for(Et=0;Et<ut;Et++)switch(Ke[Et].once&&this.removeListener(B,Ke[Et].fn,void 0,!0),xt){case 1:Ke[Et].fn.call(Ke[Et].context);break;case 2:Ke[Et].fn.call(Ke[Et].context,H);break;case 3:Ke[Et].fn.call(Ke[Et].context,H,G);break;case 4:Ke[Et].fn.call(Ke[Et].context,H,G,be);break;default:if(!Dt)for(tt=1,Dt=new Array(xt-1);tt<xt;tt++)Dt[tt-1]=arguments[tt];Ke[Et].fn.apply(Ke[Et].context,Dt)}}return!0},O.prototype.on=function(B,H,G){return c(this,B,H,G,!1)},O.prototype.once=function(B,H,G){return c(this,B,H,G,!0)},O.prototype.removeListener=function(B,H,G,be){var Be=y?y+B:B;if(!this._events[Be])return this;if(!H)return g(this,Be),this;var j=this._events[Be];if(j.fn)j.fn===H&&(!be||j.once)&&(!G||j.context===G)&&g(this,Be);else{for(var W=0,Ke=[],xt=j.length;W<xt;W++)(j[W].fn!==H||be&&!j[W].once||G&&j[W].context!==G)&&Ke.push(j[W]);Ke.length?this._events[Be]=1===Ke.length?Ke[0]:Ke:g(this,Be)}return this},O.prototype.removeAllListeners=function(B){var H;return B?this._events[H=y?y+B:B]&&g(this,H):(this._events=new M,this._eventsCount=0),this},O.prototype.off=O.prototype.removeListener,O.prototype.addListener=O.prototype.on,O.prefixed=y,O.EventEmitter=O,ie.exports=O},14563:(ie,L,y)=>{"use strict";y.d(L,{Ib:()=>M,WT:()=>_,FD:()=>c});var M=1e-6,_="undefined"!=typeof Float32Array?Float32Array:Array,c=Math.random;Math,Math.hypot||(Math.hypot=function(){for(var H=0,G=arguments.length;G--;)H+=arguments[G]*arguments[G];return Math.sqrt(H)})},30651:(ie,L,y)=>{"use strict";y.r(L),y.d(L,{create:()=>_,clone:()=>c,copy:()=>g,fromValues:()=>O,set:()=>R,identity:()=>B,transpose:()=>H,invert:()=>G,adjoint:()=>be,determinant:()=>Be,multiply:()=>j,translate:()=>W,scale:()=>Ke,rotate:()=>xt,rotateX:()=>Dt,rotateY:()=>Et,rotateZ:()=>ut,fromTranslation:()=>tt,fromScaling:()=>Gt,fromRotation:()=>Q,fromXRotation:()=>Vt,fromYRotation:()=>ot,fromZRotation:()=>Ue,fromRotationTranslation:()=>pt,fromQuat2:()=>Xe,getTranslation:()=>At,getScaling:()=>kt,getRotation:()=>Yt,fromRotationTranslationScale:()=>Er,fromRotationTranslationScaleOrigin:()=>ge,fromQuat:()=>de,frustum:()=>oe,perspectiveNO:()=>me,perspective:()=>Me,perspectiveZO:()=>Ge,perspectiveFromFieldOfView:()=>gt,orthoNO:()=>br,ortho:()=>Nr,orthoZO:()=>cn,lookAt:()=>Ir,targetTo:()=>Mt,str:()=>Le,frob:()=>we,add:()=>at,subtract:()=>Re,multiplyScalar:()=>qt,multiplyScalarAndAdd:()=>Pr,exactEquals:()=>er,equals:()=>fr,mul:()=>Br,sub:()=>$r});var M=y(14563);function _(){var C=new M.WT(16);return M.WT!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function c(C){var K=new M.WT(16);return K[0]=C[0],K[1]=C[1],K[2]=C[2],K[3]=C[3],K[4]=C[4],K[5]=C[5],K[6]=C[6],K[7]=C[7],K[8]=C[8],K[9]=C[9],K[10]=C[10],K[11]=C[11],K[12]=C[12],K[13]=C[13],K[14]=C[14],K[15]=C[15],K}function g(C,K){return C[0]=K[0],C[1]=K[1],C[2]=K[2],C[3]=K[3],C[4]=K[4],C[5]=K[5],C[6]=K[6],C[7]=K[7],C[8]=K[8],C[9]=K[9],C[10]=K[10],C[11]=K[11],C[12]=K[12],C[13]=K[13],C[14]=K[14],C[15]=K[15],C}function O(C,K,Ve,nt,yt,Lt,Z,Ze,St,It,Jt,Tr,vr,Xt,mr,or){var pr=new M.WT(16);return pr[0]=C,pr[1]=K,pr[2]=Ve,pr[3]=nt,pr[4]=yt,pr[5]=Lt,pr[6]=Z,pr[7]=Ze,pr[8]=St,pr[9]=It,pr[10]=Jt,pr[11]=Tr,pr[12]=vr,pr[13]=Xt,pr[14]=mr,pr[15]=or,pr}function R(C,K,Ve,nt,yt,Lt,Z,Ze,St,It,Jt,Tr,vr,Xt,mr,or,pr){return C[0]=K,C[1]=Ve,C[2]=nt,C[3]=yt,C[4]=Lt,C[5]=Z,C[6]=Ze,C[7]=St,C[8]=It,C[9]=Jt,C[10]=Tr,C[11]=vr,C[12]=Xt,C[13]=mr,C[14]=or,C[15]=pr,C}function B(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function H(C,K){if(C===K){var Ve=K[1],nt=K[2],yt=K[3],Lt=K[6],Z=K[7],Ze=K[11];C[1]=K[4],C[2]=K[8],C[3]=K[12],C[4]=Ve,C[6]=K[9],C[7]=K[13],C[8]=nt,C[9]=Lt,C[11]=K[14],C[12]=yt,C[13]=Z,C[14]=Ze}else C[0]=K[0],C[1]=K[4],C[2]=K[8],C[3]=K[12],C[4]=K[1],C[5]=K[5],C[6]=K[9],C[7]=K[13],C[8]=K[2],C[9]=K[6],C[10]=K[10],C[11]=K[14],C[12]=K[3],C[13]=K[7],C[14]=K[11],C[15]=K[15];return C}function G(C,K){var Ve=K[0],nt=K[1],yt=K[2],Lt=K[3],Z=K[4],Ze=K[5],St=K[6],It=K[7],Jt=K[8],Tr=K[9],vr=K[10],Xt=K[11],mr=K[12],or=K[13],pr=K[14],mn=K[15],On=Ve*Ze-nt*Z,mi=Ve*St-yt*Z,hi=Ve*It-Lt*Z,si=nt*St-yt*Ze,ai=nt*It-Lt*Ze,Ki=yt*It-Lt*St,Pi=Jt*or-Tr*mr,Ei=Jt*pr-vr*mr,re=Jt*mn-Xt*mr,pe=Tr*pr-vr*or,_e=Tr*mn-Xt*or,V=vr*mn-Xt*pr,ae=On*V-mi*_e+hi*pe+si*re-ai*Ei+Ki*Pi;return ae?(C[0]=(Ze*V-St*_e+It*pe)*(ae=1/ae),C[1]=(yt*_e-nt*V-Lt*pe)*ae,C[2]=(or*Ki-pr*ai+mn*si)*ae,C[3]=(vr*ai-Tr*Ki-Xt*si)*ae,C[4]=(St*re-Z*V-It*Ei)*ae,C[5]=(Ve*V-yt*re+Lt*Ei)*ae,C[6]=(pr*hi-mr*Ki-mn*mi)*ae,C[7]=(Jt*Ki-vr*hi+Xt*mi)*ae,C[8]=(Z*_e-Ze*re+It*Pi)*ae,C[9]=(nt*re-Ve*_e-Lt*Pi)*ae,C[10]=(mr*ai-or*hi+mn*On)*ae,C[11]=(Tr*hi-Jt*ai-Xt*On)*ae,C[12]=(Ze*Ei-Z*pe-St*Pi)*ae,C[13]=(Ve*pe-nt*Ei+yt*Pi)*ae,C[14]=(or*mi-mr*si-pr*On)*ae,C[15]=(Jt*si-Tr*mi+vr*On)*ae,C):null}function be(C,K){var Ve=K[0],nt=K[1],yt=K[2],Lt=K[3],Z=K[4],Ze=K[5],St=K[6],It=K[7],Jt=K[8],Tr=K[9],vr=K[10],Xt=K[11],mr=K[12],or=K[13],pr=K[14],mn=K[15];return C[0]=Ze*(vr*mn-Xt*pr)-Tr*(St*mn-It*pr)+or*(St*Xt-It*vr),C[1]=-(nt*(vr*mn-Xt*pr)-Tr*(yt*mn-Lt*pr)+or*(yt*Xt-Lt*vr)),C[2]=nt*(St*mn-It*pr)-Ze*(yt*mn-Lt*pr)+or*(yt*It-Lt*St),C[3]=-(nt*(St*Xt-It*vr)-Ze*(yt*Xt-Lt*vr)+Tr*(yt*It-Lt*St)),C[4]=-(Z*(vr*mn-Xt*pr)-Jt*(St*mn-It*pr)+mr*(St*Xt-It*vr)),C[5]=Ve*(vr*mn-Xt*pr)-Jt*(yt*mn-Lt*pr)+mr*(yt*Xt-Lt*vr),C[6]=-(Ve*(St*mn-It*pr)-Z*(yt*mn-Lt*pr)+mr*(yt*It-Lt*St)),C[7]=Ve*(St*Xt-It*vr)-Z*(yt*Xt-Lt*vr)+Jt*(yt*It-Lt*St),C[8]=Z*(Tr*mn-Xt*or)-Jt*(Ze*mn-It*or)+mr*(Ze*Xt-It*Tr),C[9]=-(Ve*(Tr*mn-Xt*or)-Jt*(nt*mn-Lt*or)+mr*(nt*Xt-Lt*Tr)),C[10]=Ve*(Ze*mn-It*or)-Z*(nt*mn-Lt*or)+mr*(nt*It-Lt*Ze),C[11]=-(Ve*(Ze*Xt-It*Tr)-Z*(nt*Xt-Lt*Tr)+Jt*(nt*It-Lt*Ze)),C[12]=-(Z*(Tr*pr-vr*or)-Jt*(Ze*pr-St*or)+mr*(Ze*vr-St*Tr)),C[13]=Ve*(Tr*pr-vr*or)-Jt*(nt*pr-yt*or)+mr*(nt*vr-yt*Tr),C[14]=-(Ve*(Ze*pr-St*or)-Z*(nt*pr-yt*or)+mr*(nt*St-yt*Ze)),C[15]=Ve*(Ze*vr-St*Tr)-Z*(nt*vr-yt*Tr)+Jt*(nt*St-yt*Ze),C}function Be(C){var K=C[0],Ve=C[1],nt=C[2],yt=C[3],Lt=C[4],Z=C[5],Ze=C[6],St=C[7],It=C[8],Jt=C[9],Tr=C[10],vr=C[11],Xt=C[12],mr=C[13],or=C[14],pr=C[15];return(K*Z-Ve*Lt)*(Tr*pr-vr*or)-(K*Ze-nt*Lt)*(Jt*pr-vr*mr)+(K*St-yt*Lt)*(Jt*or-Tr*mr)+(Ve*Ze-nt*Z)*(It*pr-vr*Xt)-(Ve*St-yt*Z)*(It*or-Tr*Xt)+(nt*St-yt*Ze)*(It*mr-Jt*Xt)}function j(C,K,Ve){var nt=K[0],yt=K[1],Lt=K[2],Z=K[3],Ze=K[4],St=K[5],It=K[6],Jt=K[7],Tr=K[8],vr=K[9],Xt=K[10],mr=K[11],or=K[12],pr=K[13],mn=K[14],On=K[15],mi=Ve[0],hi=Ve[1],si=Ve[2],ai=Ve[3];return C[0]=mi*nt+hi*Ze+si*Tr+ai*or,C[1]=mi*yt+hi*St+si*vr+ai*pr,C[2]=mi*Lt+hi*It+si*Xt+ai*mn,C[3]=mi*Z+hi*Jt+si*mr+ai*On,C[4]=(mi=Ve[4])*nt+(hi=Ve[5])*Ze+(si=Ve[6])*Tr+(ai=Ve[7])*or,C[5]=mi*yt+hi*St+si*vr+ai*pr,C[6]=mi*Lt+hi*It+si*Xt+ai*mn,C[7]=mi*Z+hi*Jt+si*mr+ai*On,C[8]=(mi=Ve[8])*nt+(hi=Ve[9])*Ze+(si=Ve[10])*Tr+(ai=Ve[11])*or,C[9]=mi*yt+hi*St+si*vr+ai*pr,C[10]=mi*Lt+hi*It+si*Xt+ai*mn,C[11]=mi*Z+hi*Jt+si*mr+ai*On,C[12]=(mi=Ve[12])*nt+(hi=Ve[13])*Ze+(si=Ve[14])*Tr+(ai=Ve[15])*or,C[13]=mi*yt+hi*St+si*vr+ai*pr,C[14]=mi*Lt+hi*It+si*Xt+ai*mn,C[15]=mi*Z+hi*Jt+si*mr+ai*On,C}function W(C,K,Ve){var Z,Ze,St,It,Jt,Tr,vr,Xt,mr,or,pr,mn,nt=Ve[0],yt=Ve[1],Lt=Ve[2];return K===C?(C[12]=K[0]*nt+K[4]*yt+K[8]*Lt+K[12],C[13]=K[1]*nt+K[5]*yt+K[9]*Lt+K[13],C[14]=K[2]*nt+K[6]*yt+K[10]*Lt+K[14],C[15]=K[3]*nt+K[7]*yt+K[11]*Lt+K[15]):(Ze=K[1],St=K[2],It=K[3],Jt=K[4],Tr=K[5],vr=K[6],Xt=K[7],mr=K[8],or=K[9],pr=K[10],mn=K[11],C[0]=Z=K[0],C[1]=Ze,C[2]=St,C[3]=It,C[4]=Jt,C[5]=Tr,C[6]=vr,C[7]=Xt,C[8]=mr,C[9]=or,C[10]=pr,C[11]=mn,C[12]=Z*nt+Jt*yt+mr*Lt+K[12],C[13]=Ze*nt+Tr*yt+or*Lt+K[13],C[14]=St*nt+vr*yt+pr*Lt+K[14],C[15]=It*nt+Xt*yt+mn*Lt+K[15]),C}function Ke(C,K,Ve){var nt=Ve[0],yt=Ve[1],Lt=Ve[2];return C[0]=K[0]*nt,C[1]=K[1]*nt,C[2]=K[2]*nt,C[3]=K[3]*nt,C[4]=K[4]*yt,C[5]=K[5]*yt,C[6]=K[6]*yt,C[7]=K[7]*yt,C[8]=K[8]*Lt,C[9]=K[9]*Lt,C[10]=K[10]*Lt,C[11]=K[11]*Lt,C[12]=K[12],C[13]=K[13],C[14]=K[14],C[15]=K[15],C}function xt(C,K,Ve,nt){var St,It,Jt,Tr,vr,Xt,mr,or,pr,mn,On,mi,hi,si,ai,Ki,Pi,Ei,re,pe,_e,V,ae,xe,yt=nt[0],Lt=nt[1],Z=nt[2],Ze=Math.hypot(yt,Lt,Z);return Ze<M.Ib?null:(yt*=Ze=1/Ze,Lt*=Ze,Z*=Ze,St=Math.sin(Ve),It=Math.cos(Ve),vr=K[1],Xt=K[2],mr=K[3],pr=K[5],mn=K[6],On=K[7],hi=K[9],si=K[10],ai=K[11],re=yt*Lt*(Jt=1-It)-Z*St,pe=Lt*Lt*Jt+It,_e=Z*Lt*Jt+yt*St,V=yt*Z*Jt+Lt*St,ae=Lt*Z*Jt-yt*St,xe=Z*Z*Jt+It,C[0]=(Tr=K[0])*(Ki=yt*yt*Jt+It)+(or=K[4])*(Pi=Lt*yt*Jt+Z*St)+(mi=K[8])*(Ei=Z*yt*Jt-Lt*St),C[1]=vr*Ki+pr*Pi+hi*Ei,C[2]=Xt*Ki+mn*Pi+si*Ei,C[3]=mr*Ki+On*Pi+ai*Ei,C[4]=Tr*re+or*pe+mi*_e,C[5]=vr*re+pr*pe+hi*_e,C[6]=Xt*re+mn*pe+si*_e,C[7]=mr*re+On*pe+ai*_e,C[8]=Tr*V+or*ae+mi*xe,C[9]=vr*V+pr*ae+hi*xe,C[10]=Xt*V+mn*ae+si*xe,C[11]=mr*V+On*ae+ai*xe,K!==C&&(C[12]=K[12],C[13]=K[13],C[14]=K[14],C[15]=K[15]),C)}function Dt(C,K,Ve){var nt=Math.sin(Ve),yt=Math.cos(Ve),Lt=K[4],Z=K[5],Ze=K[6],St=K[7],It=K[8],Jt=K[9],Tr=K[10],vr=K[11];return K!==C&&(C[0]=K[0],C[1]=K[1],C[2]=K[2],C[3]=K[3],C[12]=K[12],C[13]=K[13],C[14]=K[14],C[15]=K[15]),C[4]=Lt*yt+It*nt,C[5]=Z*yt+Jt*nt,C[6]=Ze*yt+Tr*nt,C[7]=St*yt+vr*nt,C[8]=It*yt-Lt*nt,C[9]=Jt*yt-Z*nt,C[10]=Tr*yt-Ze*nt,C[11]=vr*yt-St*nt,C}function Et(C,K,Ve){var nt=Math.sin(Ve),yt=Math.cos(Ve),Lt=K[0],Z=K[1],Ze=K[2],St=K[3],It=K[8],Jt=K[9],Tr=K[10],vr=K[11];return K!==C&&(C[4]=K[4],C[5]=K[5],C[6]=K[6],C[7]=K[7],C[12]=K[12],C[13]=K[13],C[14]=K[14],C[15]=K[15]),C[0]=Lt*yt-It*nt,C[1]=Z*yt-Jt*nt,C[2]=Ze*yt-Tr*nt,C[3]=St*yt-vr*nt,C[8]=Lt*nt+It*yt,C[9]=Z*nt+Jt*yt,C[10]=Ze*nt+Tr*yt,C[11]=St*nt+vr*yt,C}function ut(C,K,Ve){var nt=Math.sin(Ve),yt=Math.cos(Ve),Lt=K[0],Z=K[1],Ze=K[2],St=K[3],It=K[4],Jt=K[5],Tr=K[6],vr=K[7];return K!==C&&(C[8]=K[8],C[9]=K[9],C[10]=K[10],C[11]=K[11],C[12]=K[12],C[13]=K[13],C[14]=K[14],C[15]=K[15]),C[0]=Lt*yt+It*nt,C[1]=Z*yt+Jt*nt,C[2]=Ze*yt+Tr*nt,C[3]=St*yt+vr*nt,C[4]=It*yt-Lt*nt,C[5]=Jt*yt-Z*nt,C[6]=Tr*yt-Ze*nt,C[7]=vr*yt-St*nt,C}function tt(C,K){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=K[0],C[13]=K[1],C[14]=K[2],C[15]=1,C}function Gt(C,K){return C[0]=K[0],C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=K[1],C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=K[2],C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Q(C,K,Ve){var Ze,St,It,nt=Ve[0],yt=Ve[1],Lt=Ve[2],Z=Math.hypot(nt,yt,Lt);return Z<M.Ib?null:(nt*=Z=1/Z,yt*=Z,Lt*=Z,Ze=Math.sin(K),St=Math.cos(K),C[0]=nt*nt*(It=1-St)+St,C[1]=yt*nt*It+Lt*Ze,C[2]=Lt*nt*It-yt*Ze,C[3]=0,C[4]=nt*yt*It-Lt*Ze,C[5]=yt*yt*It+St,C[6]=Lt*yt*It+nt*Ze,C[7]=0,C[8]=nt*Lt*It+yt*Ze,C[9]=yt*Lt*It-nt*Ze,C[10]=Lt*Lt*It+St,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C)}function Vt(C,K){var Ve=Math.sin(K),nt=Math.cos(K);return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=nt,C[6]=Ve,C[7]=0,C[8]=0,C[9]=-Ve,C[10]=nt,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ot(C,K){var Ve=Math.sin(K),nt=Math.cos(K);return C[0]=nt,C[1]=0,C[2]=-Ve,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=Ve,C[9]=0,C[10]=nt,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function Ue(C,K){var Ve=Math.sin(K),nt=Math.cos(K);return C[0]=nt,C[1]=Ve,C[2]=0,C[3]=0,C[4]=-Ve,C[5]=nt,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function pt(C,K,Ve){var nt=K[0],yt=K[1],Lt=K[2],Z=K[3],Ze=nt+nt,St=yt+yt,It=Lt+Lt,Jt=nt*Ze,Tr=nt*St,vr=nt*It,Xt=yt*St,mr=yt*It,or=Lt*It,pr=Z*Ze,mn=Z*St,On=Z*It;return C[0]=1-(Xt+or),C[1]=Tr+On,C[2]=vr-mn,C[3]=0,C[4]=Tr-On,C[5]=1-(Jt+or),C[6]=mr+pr,C[7]=0,C[8]=vr+mn,C[9]=mr-pr,C[10]=1-(Jt+Xt),C[11]=0,C[12]=Ve[0],C[13]=Ve[1],C[14]=Ve[2],C[15]=1,C}function Xe(C,K){var Ve=new M.WT(3),nt=-K[0],yt=-K[1],Lt=-K[2],Z=K[3],Ze=K[4],St=K[5],It=K[6],Jt=K[7],Tr=nt*nt+yt*yt+Lt*Lt+Z*Z;return Tr>0?(Ve[0]=2*(Ze*Z+Jt*nt+St*Lt-It*yt)/Tr,Ve[1]=2*(St*Z+Jt*yt+It*nt-Ze*Lt)/Tr,Ve[2]=2*(It*Z+Jt*Lt+Ze*yt-St*nt)/Tr):(Ve[0]=2*(Ze*Z+Jt*nt+St*Lt-It*yt),Ve[1]=2*(St*Z+Jt*yt+It*nt-Ze*Lt),Ve[2]=2*(It*Z+Jt*Lt+Ze*yt-St*nt)),pt(C,K,Ve),C}function At(C,K){return C[0]=K[12],C[1]=K[13],C[2]=K[14],C}function kt(C,K){var Lt=K[4],Z=K[5],Ze=K[6],St=K[8],It=K[9],Jt=K[10];return C[0]=Math.hypot(K[0],K[1],K[2]),C[1]=Math.hypot(Lt,Z,Ze),C[2]=Math.hypot(St,It,Jt),C}function Yt(C,K){var Ve=new M.WT(3);kt(Ve,K);var nt=1/Ve[0],yt=1/Ve[1],Lt=1/Ve[2],Z=K[0]*nt,Ze=K[1]*yt,St=K[2]*Lt,It=K[4]*nt,Jt=K[5]*yt,Tr=K[6]*Lt,vr=K[8]*nt,Xt=K[9]*yt,mr=K[10]*Lt,or=Z+Jt+mr,pr=0;return or>0?(pr=2*Math.sqrt(or+1),C[3]=.25*pr,C[0]=(Tr-Xt)/pr,C[1]=(vr-St)/pr,C[2]=(Ze-It)/pr):Z>Jt&&Z>mr?(pr=2*Math.sqrt(1+Z-Jt-mr),C[3]=(Tr-Xt)/pr,C[0]=.25*pr,C[1]=(Ze+It)/pr,C[2]=(vr+St)/pr):Jt>mr?(pr=2*Math.sqrt(1+Jt-Z-mr),C[3]=(vr-St)/pr,C[0]=(Ze+It)/pr,C[1]=.25*pr,C[2]=(Tr+Xt)/pr):(pr=2*Math.sqrt(1+mr-Z-Jt),C[3]=(Ze-It)/pr,C[0]=(vr+St)/pr,C[1]=(Tr+Xt)/pr,C[2]=.25*pr),C}function Er(C,K,Ve,nt){var yt=K[0],Lt=K[1],Z=K[2],Ze=K[3],St=yt+yt,It=Lt+Lt,Jt=Z+Z,Tr=yt*St,vr=yt*It,Xt=yt*Jt,mr=Lt*It,or=Lt*Jt,pr=Z*Jt,mn=Ze*St,On=Ze*It,mi=Ze*Jt,hi=nt[0],si=nt[1],ai=nt[2];return C[0]=(1-(mr+pr))*hi,C[1]=(vr+mi)*hi,C[2]=(Xt-On)*hi,C[3]=0,C[4]=(vr-mi)*si,C[5]=(1-(Tr+pr))*si,C[6]=(or+mn)*si,C[7]=0,C[8]=(Xt+On)*ai,C[9]=(or-mn)*ai,C[10]=(1-(Tr+mr))*ai,C[11]=0,C[12]=Ve[0],C[13]=Ve[1],C[14]=Ve[2],C[15]=1,C}function ge(C,K,Ve,nt,yt){var Lt=K[0],Z=K[1],Ze=K[2],St=K[3],It=Lt+Lt,Jt=Z+Z,Tr=Ze+Ze,vr=Lt*It,Xt=Lt*Jt,mr=Lt*Tr,or=Z*Jt,pr=Z*Tr,mn=Ze*Tr,On=St*It,mi=St*Jt,hi=St*Tr,si=nt[0],ai=nt[1],Ki=nt[2],Pi=yt[0],Ei=yt[1],re=yt[2],pe=(1-(or+mn))*si,_e=(Xt+hi)*si,V=(mr-mi)*si,ae=(Xt-hi)*ai,xe=(1-(vr+mn))*ai,Oe=(pr+On)*ai,fe=(mr+mi)*Ki,Ae=(pr-On)*Ki,wt=(1-(vr+or))*Ki;return C[0]=pe,C[1]=_e,C[2]=V,C[3]=0,C[4]=ae,C[5]=xe,C[6]=Oe,C[7]=0,C[8]=fe,C[9]=Ae,C[10]=wt,C[11]=0,C[12]=Ve[0]+Pi-(pe*Pi+ae*Ei+fe*re),C[13]=Ve[1]+Ei-(_e*Pi+xe*Ei+Ae*re),C[14]=Ve[2]+re-(V*Pi+Oe*Ei+wt*re),C[15]=1,C}function de(C,K){var Ve=K[0],nt=K[1],yt=K[2],Lt=K[3],Z=Ve+Ve,Ze=nt+nt,St=yt+yt,It=Ve*Z,Jt=nt*Z,Tr=nt*Ze,vr=yt*Z,Xt=yt*Ze,mr=yt*St,or=Lt*Z,pr=Lt*Ze,mn=Lt*St;return C[0]=1-Tr-mr,C[1]=Jt+mn,C[2]=vr-pr,C[3]=0,C[4]=Jt-mn,C[5]=1-It-mr,C[6]=Xt+or,C[7]=0,C[8]=vr+pr,C[9]=Xt-or,C[10]=1-It-Tr,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function oe(C,K,Ve,nt,yt,Lt,Z){var Ze=1/(Ve-K),St=1/(yt-nt),It=1/(Lt-Z);return C[0]=2*Lt*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=2*Lt*St,C[6]=0,C[7]=0,C[8]=(Ve+K)*Ze,C[9]=(yt+nt)*St,C[10]=(Z+Lt)*It,C[11]=-1,C[12]=0,C[13]=0,C[14]=Z*Lt*2*It,C[15]=0,C}function me(C,K,Ve,nt,yt){var Z,Lt=1/Math.tan(K/2);return C[0]=Lt/Ve,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Lt,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,null!=yt&&yt!==1/0?(C[10]=(yt+nt)*(Z=1/(nt-yt)),C[14]=2*yt*nt*Z):(C[10]=-1,C[14]=-2*nt),C}var Me=me;function Ge(C,K,Ve,nt,yt){var Z,Lt=1/Math.tan(K/2);return C[0]=Lt/Ve,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=Lt,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,null!=yt&&yt!==1/0?(C[10]=yt*(Z=1/(nt-yt)),C[14]=yt*nt*Z):(C[10]=-1,C[14]=-nt),C}function gt(C,K,Ve,nt){var yt=Math.tan(K.upDegrees*Math.PI/180),Lt=Math.tan(K.downDegrees*Math.PI/180),Z=Math.tan(K.leftDegrees*Math.PI/180),Ze=Math.tan(K.rightDegrees*Math.PI/180),St=2/(Z+Ze),It=2/(yt+Lt);return C[0]=St,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=It,C[6]=0,C[7]=0,C[8]=-(Z-Ze)*St*.5,C[9]=(yt-Lt)*It*.5,C[10]=nt/(Ve-nt),C[11]=-1,C[12]=0,C[13]=0,C[14]=nt*Ve/(Ve-nt),C[15]=0,C}function br(C,K,Ve,nt,yt,Lt,Z){var Ze=1/(K-Ve),St=1/(nt-yt),It=1/(Lt-Z);return C[0]=-2*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*St,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*It,C[11]=0,C[12]=(K+Ve)*Ze,C[13]=(yt+nt)*St,C[14]=(Z+Lt)*It,C[15]=1,C}var Nr=br;function cn(C,K,Ve,nt,yt,Lt,Z){var Ze=1/(K-Ve),St=1/(nt-yt),It=1/(Lt-Z);return C[0]=-2*Ze,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*St,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=It,C[11]=0,C[12]=(K+Ve)*Ze,C[13]=(yt+nt)*St,C[14]=Lt*It,C[15]=1,C}function Ir(C,K,Ve,nt){var yt,Lt,Z,Ze,St,It,Jt,Tr,vr,Xt,mr=K[0],or=K[1],pr=K[2],mn=nt[0],On=nt[1],mi=nt[2],hi=Ve[0],si=Ve[1],ai=Ve[2];return Math.abs(mr-hi)<M.Ib&&Math.abs(or-si)<M.Ib&&Math.abs(pr-ai)<M.Ib?B(C):(Jt=mr-hi,Tr=or-si,vr=pr-ai,yt=On*(vr*=Xt=1/Math.hypot(Jt,Tr,vr))-mi*(Tr*=Xt),Lt=mi*(Jt*=Xt)-mn*vr,Z=mn*Tr-On*Jt,(Xt=Math.hypot(yt,Lt,Z))?(yt*=Xt=1/Xt,Lt*=Xt,Z*=Xt):(yt=0,Lt=0,Z=0),Ze=Tr*Z-vr*Lt,St=vr*yt-Jt*Z,It=Jt*Lt-Tr*yt,(Xt=Math.hypot(Ze,St,It))?(Ze*=Xt=1/Xt,St*=Xt,It*=Xt):(Ze=0,St=0,It=0),C[0]=yt,C[1]=Ze,C[2]=Jt,C[3]=0,C[4]=Lt,C[5]=St,C[6]=Tr,C[7]=0,C[8]=Z,C[9]=It,C[10]=vr,C[11]=0,C[12]=-(yt*mr+Lt*or+Z*pr),C[13]=-(Ze*mr+St*or+It*pr),C[14]=-(Jt*mr+Tr*or+vr*pr),C[15]=1,C)}function Mt(C,K,Ve,nt){var yt=K[0],Lt=K[1],Z=K[2],Ze=nt[0],St=nt[1],It=nt[2],Jt=yt-Ve[0],Tr=Lt-Ve[1],vr=Z-Ve[2],Xt=Jt*Jt+Tr*Tr+vr*vr;Xt>0&&(Jt*=Xt=1/Math.sqrt(Xt),Tr*=Xt,vr*=Xt);var mr=St*vr-It*Tr,or=It*Jt-Ze*vr,pr=Ze*Tr-St*Jt;return(Xt=mr*mr+or*or+pr*pr)>0&&(mr*=Xt=1/Math.sqrt(Xt),or*=Xt,pr*=Xt),C[0]=mr,C[1]=or,C[2]=pr,C[3]=0,C[4]=Tr*pr-vr*or,C[5]=vr*mr-Jt*pr,C[6]=Jt*or-Tr*mr,C[7]=0,C[8]=Jt,C[9]=Tr,C[10]=vr,C[11]=0,C[12]=yt,C[13]=Lt,C[14]=Z,C[15]=1,C}function Le(C){return"mat4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+", "+C[8]+", "+C[9]+", "+C[10]+", "+C[11]+", "+C[12]+", "+C[13]+", "+C[14]+", "+C[15]+")"}function we(C){return Math.hypot(C[0],C[1],C[2],C[3],C[4],C[5],C[6],C[7],C[8],C[9],C[10],C[11],C[12],C[13],C[14],C[15])}function at(C,K,Ve){return C[0]=K[0]+Ve[0],C[1]=K[1]+Ve[1],C[2]=K[2]+Ve[2],C[3]=K[3]+Ve[3],C[4]=K[4]+Ve[4],C[5]=K[5]+Ve[5],C[6]=K[6]+Ve[6],C[7]=K[7]+Ve[7],C[8]=K[8]+Ve[8],C[9]=K[9]+Ve[9],C[10]=K[10]+Ve[10],C[11]=K[11]+Ve[11],C[12]=K[12]+Ve[12],C[13]=K[13]+Ve[13],C[14]=K[14]+Ve[14],C[15]=K[15]+Ve[15],C}function Re(C,K,Ve){return C[0]=K[0]-Ve[0],C[1]=K[1]-Ve[1],C[2]=K[2]-Ve[2],C[3]=K[3]-Ve[3],C[4]=K[4]-Ve[4],C[5]=K[5]-Ve[5],C[6]=K[6]-Ve[6],C[7]=K[7]-Ve[7],C[8]=K[8]-Ve[8],C[9]=K[9]-Ve[9],C[10]=K[10]-Ve[10],C[11]=K[11]-Ve[11],C[12]=K[12]-Ve[12],C[13]=K[13]-Ve[13],C[14]=K[14]-Ve[14],C[15]=K[15]-Ve[15],C}function qt(C,K,Ve){return C[0]=K[0]*Ve,C[1]=K[1]*Ve,C[2]=K[2]*Ve,C[3]=K[3]*Ve,C[4]=K[4]*Ve,C[5]=K[5]*Ve,C[6]=K[6]*Ve,C[7]=K[7]*Ve,C[8]=K[8]*Ve,C[9]=K[9]*Ve,C[10]=K[10]*Ve,C[11]=K[11]*Ve,C[12]=K[12]*Ve,C[13]=K[13]*Ve,C[14]=K[14]*Ve,C[15]=K[15]*Ve,C}function Pr(C,K,Ve,nt){return C[0]=K[0]+Ve[0]*nt,C[1]=K[1]+Ve[1]*nt,C[2]=K[2]+Ve[2]*nt,C[3]=K[3]+Ve[3]*nt,C[4]=K[4]+Ve[4]*nt,C[5]=K[5]+Ve[5]*nt,C[6]=K[6]+Ve[6]*nt,C[7]=K[7]+Ve[7]*nt,C[8]=K[8]+Ve[8]*nt,C[9]=K[9]+Ve[9]*nt,C[10]=K[10]+Ve[10]*nt,C[11]=K[11]+Ve[11]*nt,C[12]=K[12]+Ve[12]*nt,C[13]=K[13]+Ve[13]*nt,C[14]=K[14]+Ve[14]*nt,C[15]=K[15]+Ve[15]*nt,C}function er(C,K){return C[0]===K[0]&&C[1]===K[1]&&C[2]===K[2]&&C[3]===K[3]&&C[4]===K[4]&&C[5]===K[5]&&C[6]===K[6]&&C[7]===K[7]&&C[8]===K[8]&&C[9]===K[9]&&C[10]===K[10]&&C[11]===K[11]&&C[12]===K[12]&&C[13]===K[13]&&C[14]===K[14]&&C[15]===K[15]}function fr(C,K){var Ve=C[0],nt=C[1],yt=C[2],Lt=C[3],Z=C[4],Ze=C[5],St=C[6],It=C[7],Jt=C[8],Tr=C[9],vr=C[10],Xt=C[11],mr=C[12],or=C[13],pr=C[14],mn=C[15],On=K[0],mi=K[1],hi=K[2],si=K[3],ai=K[4],Ki=K[5],Pi=K[6],Ei=K[7],re=K[8],pe=K[9],_e=K[10],V=K[11],ae=K[12],xe=K[13],Oe=K[14],fe=K[15];return Math.abs(Ve-On)<=M.Ib*Math.max(1,Math.abs(Ve),Math.abs(On))&&Math.abs(nt-mi)<=M.Ib*Math.max(1,Math.abs(nt),Math.abs(mi))&&Math.abs(yt-hi)<=M.Ib*Math.max(1,Math.abs(yt),Math.abs(hi))&&Math.abs(Lt-si)<=M.Ib*Math.max(1,Math.abs(Lt),Math.abs(si))&&Math.abs(Z-ai)<=M.Ib*Math.max(1,Math.abs(Z),Math.abs(ai))&&Math.abs(Ze-Ki)<=M.Ib*Math.max(1,Math.abs(Ze),Math.abs(Ki))&&Math.abs(St-Pi)<=M.Ib*Math.max(1,Math.abs(St),Math.abs(Pi))&&Math.abs(It-Ei)<=M.Ib*Math.max(1,Math.abs(It),Math.abs(Ei))&&Math.abs(Jt-re)<=M.Ib*Math.max(1,Math.abs(Jt),Math.abs(re))&&Math.abs(Tr-pe)<=M.Ib*Math.max(1,Math.abs(Tr),Math.abs(pe))&&Math.abs(vr-_e)<=M.Ib*Math.max(1,Math.abs(vr),Math.abs(_e))&&Math.abs(Xt-V)<=M.Ib*Math.max(1,Math.abs(Xt),Math.abs(V))&&Math.abs(mr-ae)<=M.Ib*Math.max(1,Math.abs(mr),Math.abs(ae))&&Math.abs(or-xe)<=M.Ib*Math.max(1,Math.abs(or),Math.abs(xe))&&Math.abs(pr-Oe)<=M.Ib*Math.max(1,Math.abs(pr),Math.abs(Oe))&&Math.abs(mn-fe)<=M.Ib*Math.max(1,Math.abs(mn),Math.abs(fe))}var Br=j,$r=Re},58623:(ie,L,y)=>{"use strict";y.d(L,{Ue:()=>_,al:()=>g,bA:()=>Dt,fF:()=>Yt});var M=y(14563);function _(){var Le=new M.WT(4);return M.WT!=Float32Array&&(Le[0]=0,Le[1]=0,Le[2]=0,Le[3]=0),Le}function g(Le,we,at,Re){var qt=new M.WT(4);return qt[0]=Le,qt[1]=we,qt[2]=at,qt[3]=Re,qt}function Dt(Le,we,at){return Le[0]=we[0]*at,Le[1]=we[1]*at,Le[2]=we[2]*at,Le[3]=we[3]*at,Le}function Yt(Le,we,at){var Re=we[0],qt=we[1],Pr=we[2],er=we[3];return Le[0]=at[0]*Re+at[4]*qt+at[8]*Pr+at[12]*er,Le[1]=at[1]*Re+at[5]*qt+at[9]*Pr+at[13]*er,Le[2]=at[2]*Re+at[6]*qt+at[10]*Pr+at[14]*er,Le[3]=at[3]*Re+at[7]*qt+at[11]*Pr+at[15]*er,Le}_()},11524:(ie,L,y)=>{var M;!function(_,c,g,O){"use strict";var Dt,R=["","webkit","Moz","MS","ms","o"],B=c.createElement("div"),G=Math.round,be=Math.abs,Be=Date.now;function j(Ee,je,bt){return setTimeout(Gt(Ee,bt),je)}function W(Ee,je,bt){return!!Array.isArray(Ee)&&(Ke(Ee,bt[je],bt),!0)}function Ke(Ee,je,bt){var ar;if(Ee)if(Ee.forEach)Ee.forEach(je,bt);else if(Ee.length!==O)for(ar=0;ar<Ee.length;)je.call(bt,Ee[ar],ar,Ee),ar++;else for(ar in Ee)Ee.hasOwnProperty(ar)&&je.call(bt,Ee[ar],ar,Ee)}function xt(Ee,je,bt){var ar="DEPRECATED METHOD: "+je+"\n"+bt+" AT \n";return function(){var Kr=new Error("get-stack-trace"),$n=Kr&&Kr.stack?Kr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",xi=_.console&&(_.console.warn||_.console.log);return xi&&xi.call(_.console,ar,$n),Ee.apply(this,arguments)}}Dt="function"!=typeof Object.assign?function(je){if(je===O||null===je)throw new TypeError("Cannot convert undefined or null to object");for(var bt=Object(je),ar=1;ar<arguments.length;ar++){var Kr=arguments[ar];if(Kr!==O&&null!==Kr)for(var $n in Kr)Kr.hasOwnProperty($n)&&(bt[$n]=Kr[$n])}return bt}:Object.assign;var Et=xt(function(je,bt,ar){for(var Kr=Object.keys(bt),$n=0;$n<Kr.length;)(!ar||ar&&je[Kr[$n]]===O)&&(je[Kr[$n]]=bt[Kr[$n]]),$n++;return je},"extend","Use `assign`."),ut=xt(function(je,bt){return Et(je,bt,!0)},"merge","Use `assign`.");function tt(Ee,je,bt){var Kr,ar=je.prototype;(Kr=Ee.prototype=Object.create(ar)).constructor=Ee,Kr._super=ar,bt&&Dt(Kr,bt)}function Gt(Ee,je){return function(){return Ee.apply(je,arguments)}}function Q(Ee,je){return"function"==typeof Ee?Ee.apply(je&&je[0]||O,je):Ee}function Vt(Ee,je){return Ee===O?je:Ee}function ot(Ee,je,bt){Ke(At(je),function(ar){Ee.addEventListener(ar,bt,!1)})}function Ue(Ee,je,bt){Ke(At(je),function(ar){Ee.removeEventListener(ar,bt,!1)})}function pt(Ee,je){for(;Ee;){if(Ee==je)return!0;Ee=Ee.parentNode}return!1}function Xe(Ee,je){return Ee.indexOf(je)>-1}function At(Ee){return Ee.trim().split(/\s+/g)}function kt(Ee,je,bt){if(Ee.indexOf&&!bt)return Ee.indexOf(je);for(var ar=0;ar<Ee.length;){if(bt&&Ee[ar][bt]==je||!bt&&Ee[ar]===je)return ar;ar++}return-1}function Yt(Ee){return Array.prototype.slice.call(Ee,0)}function Er(Ee,je,bt){for(var ar=[],Kr=[],$n=0;$n<Ee.length;){var xi=je?Ee[$n][je]:Ee[$n];kt(Kr,xi)<0&&ar.push(Ee[$n]),Kr[$n]=xi,$n++}return bt&&(ar=je?ar.sort(function(ro,co){return ro[je]>co[je]}):ar.sort()),ar}function ge(Ee,je){for(var bt,ar,Kr=je[0].toUpperCase()+je.slice(1),$n=0;$n<R.length;){if((ar=(bt=R[$n])?bt+Kr:je)in Ee)return ar;$n++}return O}var de=1;function me(Ee){var je=Ee.ownerDocument||Ee;return je.defaultView||je.parentWindow||_}var Ge="ontouchstart"in _,gt=ge(_,"PointerEvent")!==O,br=Ge&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Nr="touch",Ir="mouse",nt=["x","y"],yt=["clientX","clientY"];function Lt(Ee,je){var bt=this;this.manager=Ee,this.callback=je,this.element=Ee.element,this.target=Ee.options.inputTarget,this.domHandler=function(ar){Q(Ee.options.enable,[Ee])&&bt.handler(ar)},this.init()}function Ze(Ee,je,bt){var ar=bt.pointers.length,Kr=bt.changedPointers.length,$n=1&je&&ar-Kr==0,xi=12&je&&ar-Kr==0;bt.isFirst=!!$n,bt.isFinal=!!xi,$n&&(Ee.session={}),bt.eventType=je,function(Ee,je){var bt=Ee.session,ar=je.pointers,Kr=ar.length;bt.firstInput||(bt.firstInput=Tr(je)),Kr>1&&!bt.firstMultiple?bt.firstMultiple=Tr(je):1===Kr&&(bt.firstMultiple=!1);var $n=bt.firstInput,xi=bt.firstMultiple,lo=xi?xi.center:$n.center,ro=je.center=vr(ar);je.timeStamp=Be(),je.deltaTime=je.timeStamp-$n.timeStamp,je.angle=pr(lo,ro),je.distance=or(lo,ro),function(Ee,je){var bt=je.center,ar=Ee.offsetDelta||{},Kr=Ee.prevDelta||{},$n=Ee.prevInput||{};(1===je.eventType||4===$n.eventType)&&(Kr=Ee.prevDelta={x:$n.deltaX||0,y:$n.deltaY||0},ar=Ee.offsetDelta={x:bt.x,y:bt.y}),je.deltaX=Kr.x+(bt.x-ar.x),je.deltaY=Kr.y+(bt.y-ar.y)}(bt,je),je.offsetDirection=mr(je.deltaX,je.deltaY);var co=Xt(je.deltaTime,je.deltaX,je.deltaY);je.overallVelocityX=co.x,je.overallVelocityY=co.y,je.overallVelocity=be(co.x)>be(co.y)?co.x:co.y,je.scale=xi?function(Ee,je){return or(je[0],je[1],yt)/or(Ee[0],Ee[1],yt)}(xi.pointers,ar):1,je.rotation=xi?function(Ee,je){return pr(je[1],je[0],yt)+pr(Ee[1],Ee[0],yt)}(xi.pointers,ar):0,je.maxPointers=bt.prevInput?je.pointers.length>bt.prevInput.maxPointers?je.pointers.length:bt.prevInput.maxPointers:je.pointers.length,function(Ee,je){var Kr,$n,xi,lo,bt=Ee.lastInterval||je,ar=je.timeStamp-bt.timeStamp;if(8!=je.eventType&&(ar>25||bt.velocity===O)){var ro=je.deltaX-bt.deltaX,co=je.deltaY-bt.deltaY,ps=Xt(ar,ro,co);$n=ps.x,xi=ps.y,Kr=be(ps.x)>be(ps.y)?ps.x:ps.y,lo=mr(ro,co),Ee.lastInterval=je}else Kr=bt.velocity,$n=bt.velocityX,xi=bt.velocityY,lo=bt.direction;je.velocity=Kr,je.velocityX=$n,je.velocityY=xi,je.direction=lo}(bt,je);var ps=Ee.element;pt(je.srcEvent.target,ps)&&(ps=je.srcEvent.target),je.target=ps}(Ee,bt),Ee.emit("hammer.input",bt),Ee.recognize(bt),Ee.session.prevInput=bt}function Tr(Ee){for(var je=[],bt=0;bt<Ee.pointers.length;)je[bt]={clientX:G(Ee.pointers[bt].clientX),clientY:G(Ee.pointers[bt].clientY)},bt++;return{timeStamp:Be(),pointers:je,center:vr(je),deltaX:Ee.deltaX,deltaY:Ee.deltaY}}function vr(Ee){var je=Ee.length;if(1===je)return{x:G(Ee[0].clientX),y:G(Ee[0].clientY)};for(var bt=0,ar=0,Kr=0;Kr<je;)bt+=Ee[Kr].clientX,ar+=Ee[Kr].clientY,Kr++;return{x:G(bt/je),y:G(ar/je)}}function Xt(Ee,je,bt){return{x:je/Ee||0,y:bt/Ee||0}}function mr(Ee,je){return Ee===je?1:be(Ee)>=be(je)?Ee<0?2:4:je<0?8:16}function or(Ee,je,bt){bt||(bt=nt);var ar=je[bt[0]]-Ee[bt[0]],Kr=je[bt[1]]-Ee[bt[1]];return Math.sqrt(ar*ar+Kr*Kr)}function pr(Ee,je,bt){return bt||(bt=nt),180*Math.atan2(je[bt[1]]-Ee[bt[1]],je[bt[0]]-Ee[bt[0]])/Math.PI}Lt.prototype={handler:function(){},init:function(){this.evEl&&ot(this.element,this.evEl,this.domHandler),this.evTarget&&ot(this.target,this.evTarget,this.domHandler),this.evWin&&ot(me(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Ue(this.element,this.evEl,this.domHandler),this.evTarget&&Ue(this.target,this.evTarget,this.domHandler),this.evWin&&Ue(me(this.element),this.evWin,this.domHandler)}};var mi={mousedown:1,mousemove:2,mouseup:4},hi="mousedown",si="mousemove mouseup";function ai(){this.evEl=hi,this.evWin=si,this.pressed=!1,Lt.apply(this,arguments)}tt(ai,Lt,{handler:function(je){var bt=mi[je.type];1&bt&&0===je.button&&(this.pressed=!0),2&bt&&1!==je.which&&(bt=4),this.pressed&&(4&bt&&(this.pressed=!1),this.callback(this.manager,bt,{pointers:[je],changedPointers:[je],pointerType:Ir,srcEvent:je}))}});var Ki={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Pi={2:Nr,3:"pen",4:Ir,5:"kinect"},Ei="pointerdown",re="pointermove pointerup pointercancel";function pe(){this.evEl=Ei,this.evWin=re,Lt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}_.MSPointerEvent&&!_.PointerEvent&&(Ei="MSPointerDown",re="MSPointerMove MSPointerUp MSPointerCancel"),tt(pe,Lt,{handler:function(je){var bt=this.store,ar=!1,Kr=je.type.toLowerCase().replace("ms",""),$n=Ki[Kr],xi=Pi[je.pointerType]||je.pointerType,lo=xi==Nr,ro=kt(bt,je.pointerId,"pointerId");1&$n&&(0===je.button||lo)?ro<0&&(bt.push(je),ro=bt.length-1):12&$n&&(ar=!0),!(ro<0)&&(bt[ro]=je,this.callback(this.manager,$n,{pointers:bt,changedPointers:[je],pointerType:xi,srcEvent:je}),ar&&bt.splice(ro,1))}});var _e={touchstart:1,touchmove:2,touchend:4,touchcancel:8},V="touchstart",ae="touchstart touchmove touchend touchcancel";function xe(){this.evTarget=V,this.evWin=ae,this.started=!1,Lt.apply(this,arguments)}function Oe(Ee,je){var bt=Yt(Ee.touches),ar=Yt(Ee.changedTouches);return 12&je&&(bt=Er(bt.concat(ar),"identifier",!0)),[bt,ar]}tt(xe,Lt,{handler:function(je){var bt=_e[je.type];if(1===bt&&(this.started=!0),this.started){var ar=Oe.call(this,je,bt);12&bt&&ar[0].length-ar[1].length==0&&(this.started=!1),this.callback(this.manager,bt,{pointers:ar[0],changedPointers:ar[1],pointerType:Nr,srcEvent:je})}}});var fe={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Ae="touchstart touchmove touchend touchcancel";function wt(){this.evTarget=Ae,this.targetIds={},Lt.apply(this,arguments)}function Sr(Ee,je){var bt=Yt(Ee.touches),ar=this.targetIds;if(3&je&&1===bt.length)return ar[bt[0].identifier]=!0,[bt,bt];var Kr,$n,xi=Yt(Ee.changedTouches),lo=[],ro=this.target;if($n=bt.filter(function(co){return pt(co.target,ro)}),1===je)for(Kr=0;Kr<$n.length;)ar[$n[Kr].identifier]=!0,Kr++;for(Kr=0;Kr<xi.length;)ar[xi[Kr].identifier]&&lo.push(xi[Kr]),12&je&&delete ar[xi[Kr].identifier],Kr++;return lo.length?[Er($n.concat(lo),"identifier",!0),lo]:void 0}function Fr(){Lt.apply(this,arguments);var Ee=Gt(this.handler,this);this.touch=new wt(this.manager,Ee),this.mouse=new ai(this.manager,Ee),this.primaryTouch=null,this.lastTouches=[]}function Rn(Ee,je){1&Ee?(this.primaryTouch=je.changedPointers[0].identifier,Pn.call(this,je)):12&Ee&&Pn.call(this,je)}function Pn(Ee){var je=Ee.changedPointers[0];if(je.identifier===this.primaryTouch){var bt={x:je.clientX,y:je.clientY};this.lastTouches.push(bt);var ar=this.lastTouches;setTimeout(function(){var $n=ar.indexOf(bt);$n>-1&&ar.splice($n,1)},2500)}}function rr(Ee){for(var je=Ee.srcEvent.clientX,bt=Ee.srcEvent.clientY,ar=0;ar<this.lastTouches.length;ar++){var Kr=this.lastTouches[ar],$n=Math.abs(je-Kr.x),xi=Math.abs(bt-Kr.y);if($n<=25&&xi<=25)return!0}return!1}tt(wt,Lt,{handler:function(je){var bt=fe[je.type],ar=Sr.call(this,je,bt);!ar||this.callback(this.manager,bt,{pointers:ar[0],changedPointers:ar[1],pointerType:Nr,srcEvent:je})}}),tt(Fr,Lt,{handler:function(je,bt,ar){var $n=ar.pointerType==Ir;if(!($n&&ar.sourceCapabilities&&ar.sourceCapabilities.firesTouchEvents)){if(ar.pointerType==Nr)Rn.call(this,bt,ar);else if($n&&rr.call(this,ar))return;this.callback(je,bt,ar)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Sn=ge(B.style,"touchAction"),an=Sn!==O,fn="compute",_n="manipulation",Oi="none",ta="pan-x",oi="pan-y",Ji=function(){if(!an)return!1;var Ee={},je=_.CSS&&_.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(bt){Ee[bt]=!je||_.CSS.supports("touch-action",bt)}),Ee}();function Vi(Ee,je){this.manager=Ee,this.set(je)}function Wi(Ee){this.options=Dt({},this.defaults,Ee||{}),this.id=de++,this.manager=null,this.options.enable=Vt(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function va(Ee){return 16&Ee?"cancel":8&Ee?"end":4&Ee?"move":2&Ee?"start":""}function wu(Ee){return 16==Ee?"down":8==Ee?"up":2==Ee?"left":4==Ee?"right":""}function Da(Ee,je){var bt=je.manager;return bt?bt.get(Ee):Ee}function qo(){Wi.apply(this,arguments)}function Fi(){qo.apply(this,arguments),this.pX=null,this.pY=null}function ra(){qo.apply(this,arguments)}function bo(){Wi.apply(this,arguments),this._timer=null,this._input=null}function ma(){qo.apply(this,arguments)}function vo(){qo.apply(this,arguments)}function No(){Wi.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ls(Ee,je){return(je=je||{}).recognizers=Vt(je.recognizers,Ls.defaults.preset),new Ma(Ee,je)}function Ma(Ee,je){this.options=Dt({},Ls.defaults,je||{}),this.options.inputTarget=this.options.inputTarget||Ee,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ee,this.input=function(Ee){return new(Ee.options.inputClass||(gt?pe:br?wt:Ge?Fr:ai))(Ee,Ze)}(this),this.touchAction=new Vi(this,this.options.touchAction),Ka(this,!0),Ke(this.options.recognizers,function(bt){var ar=this.add(new bt[0](bt[1]));bt[2]&&ar.recognizeWith(bt[2]),bt[3]&&ar.requireFailure(bt[3])},this)}function Ka(Ee,je){var ar,bt=Ee.element;bt.style&&(Ke(Ee.options.cssProps,function(Kr,$n){ar=ge(bt.style,$n),je?(Ee.oldCssProps[ar]=bt.style[ar],bt.style[ar]=Kr):bt.style[ar]=Ee.oldCssProps[ar]||""}),je||(Ee.oldCssProps={}))}Vi.prototype={set:function(Ee){Ee==fn&&(Ee=this.compute()),an&&this.manager.element.style&&Ji[Ee]&&(this.manager.element.style[Sn]=Ee),this.actions=Ee.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ee=[];return Ke(this.manager.recognizers,function(je){Q(je.options.enable,[je])&&(Ee=Ee.concat(je.getTouchAction()))}),function(Ee){if(Xe(Ee,Oi))return Oi;var je=Xe(Ee,ta),bt=Xe(Ee,oi);return je&&bt?Oi:je||bt?je?ta:oi:Xe(Ee,_n)?_n:"auto"}(Ee.join(" "))},preventDefaults:function(Ee){var je=Ee.srcEvent,bt=Ee.offsetDirection;if(!this.manager.session.prevented){var ar=this.actions,Kr=Xe(ar,Oi)&&!Ji[Oi],$n=Xe(ar,oi)&&!Ji[oi],xi=Xe(ar,ta)&&!Ji[ta];if(Kr&&1===Ee.pointers.length&&Ee.distance<2&&Ee.deltaTime<250)return;return xi&&$n||!(Kr||$n&&6&bt||xi&&24&bt)?void 0:this.preventSrc(je)}je.preventDefault()},preventSrc:function(Ee){this.manager.session.prevented=!0,Ee.preventDefault()}},Wi.prototype={defaults:{},set:function(Ee){return Dt(this.options,Ee),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ee){if(W(Ee,"recognizeWith",this))return this;var je=this.simultaneous;return je[(Ee=Da(Ee,this)).id]||(je[Ee.id]=Ee,Ee.recognizeWith(this)),this},dropRecognizeWith:function(Ee){return W(Ee,"dropRecognizeWith",this)||(Ee=Da(Ee,this),delete this.simultaneous[Ee.id]),this},requireFailure:function(Ee){if(W(Ee,"requireFailure",this))return this;var je=this.requireFail;return-1===kt(je,Ee=Da(Ee,this))&&(je.push(Ee),Ee.requireFailure(this)),this},dropRequireFailure:function(Ee){if(W(Ee,"dropRequireFailure",this))return this;Ee=Da(Ee,this);var je=kt(this.requireFail,Ee);return je>-1&&this.requireFail.splice(je,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ee){return!!this.simultaneous[Ee.id]},emit:function(Ee){var je=this,bt=this.state;function ar(Kr){je.manager.emit(Kr,Ee)}bt<8&&ar(je.options.event+va(bt)),ar(je.options.event),Ee.additionalEvent&&ar(Ee.additionalEvent),bt>=8&&ar(je.options.event+va(bt))},tryEmit:function(Ee){if(this.canEmit())return this.emit(Ee);this.state=32},canEmit:function(){for(var Ee=0;Ee<this.requireFail.length;){if(!(33&this.requireFail[Ee].state))return!1;Ee++}return!0},recognize:function(Ee){var je=Dt({},Ee);if(!Q(this.options.enable,[this,je]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(je),30&this.state&&this.tryEmit(je)},process:function(Ee){},getTouchAction:function(){},reset:function(){}},tt(qo,Wi,{defaults:{pointers:1},attrTest:function(Ee){var je=this.options.pointers;return 0===je||Ee.pointers.length===je},process:function(Ee){var je=this.state,bt=Ee.eventType,ar=6&je,Kr=this.attrTest(Ee);return ar&&(8&bt||!Kr)?16|je:ar||Kr?4&bt?8|je:2&je?4|je:2:32}}),tt(Fi,qo,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var Ee=this.options.direction,je=[];return 6&Ee&&je.push(oi),24&Ee&&je.push(ta),je},directionTest:function(Ee){var je=this.options,bt=!0,ar=Ee.distance,Kr=Ee.direction,$n=Ee.deltaX,xi=Ee.deltaY;return Kr&je.direction||(6&je.direction?(Kr=0===$n?1:$n<0?2:4,bt=$n!=this.pX,ar=Math.abs(Ee.deltaX)):(Kr=0===xi?1:xi<0?8:16,bt=xi!=this.pY,ar=Math.abs(Ee.deltaY))),Ee.direction=Kr,bt&&ar>je.threshold&&Kr&je.direction},attrTest:function(Ee){return qo.prototype.attrTest.call(this,Ee)&&(2&this.state||!(2&this.state)&&this.directionTest(Ee))},emit:function(Ee){this.pX=Ee.deltaX,this.pY=Ee.deltaY;var je=wu(Ee.direction);je&&(Ee.additionalEvent=this.options.event+je),this._super.emit.call(this,Ee)}}),tt(ra,qo,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Oi]},attrTest:function(Ee){return this._super.attrTest.call(this,Ee)&&(Math.abs(Ee.scale-1)>this.options.threshold||2&this.state)},emit:function(Ee){1!==Ee.scale&&(Ee.additionalEvent=this.options.event+(Ee.scale<1?"in":"out")),this._super.emit.call(this,Ee)}}),tt(bo,Wi,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Ee){var je=this.options,bt=Ee.pointers.length===je.pointers,ar=Ee.distance<je.threshold,Kr=Ee.deltaTime>je.time;if(this._input=Ee,!ar||!bt||12&Ee.eventType&&!Kr)this.reset();else if(1&Ee.eventType)this.reset(),this._timer=j(function(){this.state=8,this.tryEmit()},je.time,this);else if(4&Ee.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Ee){8===this.state&&(Ee&&4&Ee.eventType?this.manager.emit(this.options.event+"up",Ee):(this._input.timeStamp=Be(),this.manager.emit(this.options.event,this._input)))}}),tt(ma,qo,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Oi]},attrTest:function(Ee){return this._super.attrTest.call(this,Ee)&&(Math.abs(Ee.rotation)>this.options.threshold||2&this.state)}}),tt(vo,qo,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Fi.prototype.getTouchAction.call(this)},attrTest:function(Ee){var bt,je=this.options.direction;return 30&je?bt=Ee.overallVelocity:6&je?bt=Ee.overallVelocityX:24&je&&(bt=Ee.overallVelocityY),this._super.attrTest.call(this,Ee)&&je&Ee.offsetDirection&&Ee.distance>this.options.threshold&&Ee.maxPointers==this.options.pointers&&be(bt)>this.options.velocity&&4&Ee.eventType},emit:function(Ee){var je=wu(Ee.offsetDirection);je&&this.manager.emit(this.options.event+je,Ee),this.manager.emit(this.options.event,Ee)}}),tt(No,Wi,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[_n]},process:function(Ee){var je=this.options,bt=Ee.pointers.length===je.pointers,ar=Ee.distance<je.threshold,Kr=Ee.deltaTime<je.time;if(this.reset(),1&Ee.eventType&&0===this.count)return this.failTimeout();if(ar&&Kr&&bt){if(4!=Ee.eventType)return this.failTimeout();var $n=!this.pTime||Ee.timeStamp-this.pTime<je.interval,xi=!this.pCenter||or(this.pCenter,Ee.center)<je.posThreshold;if(this.pTime=Ee.timeStamp,this.pCenter=Ee.center,xi&&$n?this.count+=1:this.count=1,this._input=Ee,0==this.count%je.taps)return this.hasRequireFailures()?(this._timer=j(function(){this.state=8,this.tryEmit()},je.interval,this),2):8}return 32},failTimeout:function(){return this._timer=j(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ls.VERSION="2.0.7",Ls.defaults={domEvents:!1,touchAction:fn,enable:!0,inputTarget:null,inputClass:null,preset:[[ma,{enable:!1}],[ra,{enable:!1},["rotate"]],[vo,{direction:6}],[Fi,{direction:6},["swipe"]],[No],[No,{event:"doubletap",taps:2},["tap"]],[bo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ma.prototype={set:function(Ee){return Dt(this.options,Ee),Ee.touchAction&&this.touchAction.update(),Ee.inputTarget&&(this.input.destroy(),this.input.target=Ee.inputTarget,this.input.init()),this},stop:function(Ee){this.session.stopped=Ee?2:1},recognize:function(Ee){var je=this.session;if(!je.stopped){this.touchAction.preventDefaults(Ee);var bt,ar=this.recognizers,Kr=je.curRecognizer;(!Kr||Kr&&8&Kr.state)&&(Kr=je.curRecognizer=null);for(var $n=0;$n<ar.length;)bt=ar[$n],2===je.stopped||Kr&&bt!=Kr&&!bt.canRecognizeWith(Kr)?bt.reset():bt.recognize(Ee),!Kr&&14&bt.state&&(Kr=je.curRecognizer=bt),$n++}},get:function(Ee){if(Ee instanceof Wi)return Ee;for(var je=this.recognizers,bt=0;bt<je.length;bt++)if(je[bt].options.event==Ee)return je[bt];return null},add:function(Ee){if(W(Ee,"add",this))return this;var je=this.get(Ee.options.event);return je&&this.remove(je),this.recognizers.push(Ee),Ee.manager=this,this.touchAction.update(),Ee},remove:function(Ee){if(W(Ee,"remove",this))return this;if(Ee=this.get(Ee)){var je=this.recognizers,bt=kt(je,Ee);-1!==bt&&(je.splice(bt,1),this.touchAction.update())}return this},on:function(Ee,je){if(Ee!==O&&je!==O){var bt=this.handlers;return Ke(At(Ee),function(ar){bt[ar]=bt[ar]||[],bt[ar].push(je)}),this}},off:function(Ee,je){if(Ee!==O){var bt=this.handlers;return Ke(At(Ee),function(ar){je?bt[ar]&&bt[ar].splice(kt(bt[ar],je),1):delete bt[ar]}),this}},emit:function(Ee,je){this.options.domEvents&&function(Ee,je){var bt=c.createEvent("Event");bt.initEvent(Ee,!0,!0),bt.gesture=je,je.target.dispatchEvent(bt)}(Ee,je);var bt=this.handlers[Ee]&&this.handlers[Ee].slice();if(bt&&bt.length){je.type=Ee,je.preventDefault=function(){je.srcEvent.preventDefault()};for(var ar=0;ar<bt.length;)bt[ar](je),ar++}},destroy:function(){this.element&&Ka(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},Dt(Ls,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ma,Input:Lt,TouchAction:Vi,TouchInput:wt,MouseInput:ai,PointerEventInput:pe,TouchMouseInput:Fr,SingleTouchInput:xe,Recognizer:Wi,AttrRecognizer:qo,Tap:No,Pan:Fi,Swipe:vo,Pinch:ra,Rotate:ma,Press:bo,on:ot,off:Ue,each:Ke,merge:ut,extend:Et,assign:Dt,inherit:tt,bindFn:Gt,prefixed:ge}),(void 0!==_?_:"undefined"!=typeof self?self:{}).Hammer=Ls,(M=function(){return Ls}.call(L,y,L,ie))!==O&&(ie.exports=M)}(window,document)},82469:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});var y=Symbol.for("INJECTION");function M(R,B,H,G){Object.defineProperty(R,B,{configurable:!0,enumerable:!0,get:function(){return G&&!Reflect.hasMetadata(y,this,B)&&Reflect.defineMetadata(y,H(),this,B),Reflect.hasMetadata(y,this,B)?Reflect.getMetadata(y,this,B):H()},set:function(j){Reflect.defineMetadata(y,j,this,B)}})}L.makePropertyInjectDecorator=function(R,B){return function(H){return function(G,be){M(G,be,function(){return R.get(H)},B)}}},L.makePropertyInjectNamedDecorator=function(R,B){return function(H,G){return function(be,Be){M(be,Be,function(){return R.getNamed(H,G)},B)}}},L.makePropertyInjectTaggedDecorator=function(R,B){return function(H,G,be){return function(Be,j){M(Be,j,function(){return R.getTagged(H,G,be)},B)}}},L.makePropertyMultiInjectDecorator=function(R,B){return function(H){return function(G,be){M(G,be,function(){return R.getAll(H)},B)}}}},43857:(ie,L,y)=>{"use strict";var _=y(82469);L.Z=function(g,O){return void 0===O&&(O=!0),{lazyInject:_.makePropertyInjectDecorator(g,O),lazyInjectNamed:_.makePropertyInjectNamedDecorator(g,O),lazyInjectTagged:_.makePropertyInjectTaggedDecorator(g,O),lazyMultiInject:_.makePropertyMultiInjectDecorator(g,O)}}},84848:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.tagProperty=L.tagParameter=L.decorate=void 0;var M=y(90640),_=y(7259);function O(G,be,Be,j,W){var Ke={},xt="number"==typeof W,Dt=void 0!==W&&xt?W.toString():Be;if(xt&&void 0!==Be)throw new Error(M.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(G,be)&&(Ke=Reflect.getMetadata(G,be));var Et=Ke[Dt];if(Array.isArray(Et))for(var ut=0,tt=Et;ut<tt.length;ut++){var Gt=tt[ut];if(Gt.key===j.key)throw new Error(M.DUPLICATED_METADATA+" "+Gt.key.toString())}else Et=[];Et.push(j),Ke[Dt]=Et,Reflect.defineMetadata(G,Ke,be)}function R(G,be){Reflect.decorate(G,be)}function B(G,be){return function(Be,j){be(Be,j,G)}}L.tagParameter=function(G,be,Be,j){O(_.TAGGED,G,be,j,Be)},L.tagProperty=function(G,be,Be){O(_.TAGGED_PROP,G.constructor,be,Be)},L.decorate=function(G,be,Be){"number"==typeof Be?R([B(Be,G)],be):"string"==typeof Be?Reflect.decorate([G],be,Be):R([G],be)}},53615:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.inject=L.LazyServiceIdentifer=void 0;var M=y(90640),_=y(7259),c=y(95839),g=y(84848),O=function(){function B(H){this._cb=H}return B.prototype.unwrap=function(){return this._cb()},B}();L.LazyServiceIdentifer=O,L.inject=function(B){return function(H,G,be){if(void 0===B)throw new Error(M.UNDEFINED_INJECT_ANNOTATION(H.name));var Be=new c.Metadata(_.INJECT_TAG,B);"number"==typeof be?g.tagParameter(H,G,be,Be):g.tagProperty(H,G,Be)}}},57549:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.injectable=void 0;var M=y(90640),_=y(7259);L.injectable=function(){return function(g){if(Reflect.hasOwnMetadata(_.PARAM_TYPES,g))throw new Error(M.DUPLICATED_INJECTABLE_DECORATOR);var O=Reflect.getMetadata(_.DESIGN_PARAM_TYPES,g)||[];return Reflect.defineMetadata(_.PARAM_TYPES,O,g),g}}},42048:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.multiInject=void 0;var M=y(7259),_=y(95839),c=y(84848);L.multiInject=function(O){return function(R,B,H){var G=new _.Metadata(M.MULTI_INJECT_TAG,O);"number"==typeof H?c.tagParameter(R,B,H,G):c.tagProperty(R,B,G)}}},35546:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.named=void 0;var M=y(7259),_=y(95839),c=y(84848);L.named=function(O){return function(R,B,H){var G=new _.Metadata(M.NAMED_TAG,O);"number"==typeof H?c.tagParameter(R,B,H,G):c.tagProperty(R,B,G)}}},78098:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.optional=void 0;var M=y(7259),_=y(95839),c=y(84848);L.optional=function(){return function(O,R,B){var H=new _.Metadata(M.OPTIONAL_TAG,!0);"number"==typeof B?c.tagParameter(O,R,B,H):c.tagProperty(O,R,H)}}},18955:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.postConstruct=void 0;var M=y(90640),_=y(7259),c=y(95839);L.postConstruct=function(){return function(O,R,B){var H=new c.Metadata(_.POST_CONSTRUCT,R);if(Reflect.hasOwnMetadata(_.POST_CONSTRUCT,O.constructor))throw new Error(M.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(_.POST_CONSTRUCT,H,O.constructor)}}},43881:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.tagged=void 0;var M=y(95839),_=y(84848);L.tagged=function(g,O){return function(R,B,H){var G=new M.Metadata(g,O);"number"==typeof H?_.tagParameter(R,B,H,G):_.tagProperty(R,B,G)}}},91698:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.targetName=void 0;var M=y(7259),_=y(95839),c=y(84848);L.targetName=function(O){return function(R,B,H){var G=new _.Metadata(M.NAME_TAG,O);c.tagParameter(R,B,H,G)}}},14978:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.unmanaged=void 0;var M=y(7259),_=y(95839),c=y(84848);L.unmanaged=function(){return function(O,R,B){var H=new _.Metadata(M.UNMANAGED_TAG,!0);c.tagParameter(O,R,B,H)}}},31885:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Binding=void 0;var M=y(21785),_=y(16800),c=function(){function g(O,R){this.id=_.id(),this.activated=!1,this.serviceIdentifier=O,this.scope=R,this.type=M.BindingTypeEnum.Invalid,this.constraint=function(B){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return g.prototype.clone=function(){var O=new g(this.serviceIdentifier,this.scope);return O.activated=O.scope===M.BindingScopeEnum.Singleton&&this.activated,O.implementationType=this.implementationType,O.dynamicValue=this.dynamicValue,O.scope=this.scope,O.type=this.type,O.factory=this.factory,O.provider=this.provider,O.constraint=this.constraint,O.onActivation=this.onActivation,O.cache=this.cache,O},g}();L.Binding=c},54046:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingCount=void 0,L.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},90640:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.STACK_OVERFLOW=L.CIRCULAR_DEPENDENCY_IN_FACTORY=L.POST_CONSTRUCT_ERROR=L.MULTIPLE_POST_CONSTRUCT_METHODS=L.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=L.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=L.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=L.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=L.ARGUMENTS_LENGTH_MISMATCH=L.INVALID_DECORATOR_OPERATION=L.INVALID_TO_SELF_VALUE=L.INVALID_FUNCTION_BINDING=L.INVALID_MIDDLEWARE_RETURN=L.NO_MORE_SNAPSHOTS_AVAILABLE=L.INVALID_BINDING_TYPE=L.NOT_IMPLEMENTED=L.CIRCULAR_DEPENDENCY=L.UNDEFINED_INJECT_ANNOTATION=L.MISSING_INJECT_ANNOTATION=L.MISSING_INJECTABLE_ANNOTATION=L.NOT_REGISTERED=L.CANNOT_UNBIND=L.AMBIGUOUS_MATCH=L.KEY_NOT_FOUND=L.NULL_ARGUMENT=L.DUPLICATED_METADATA=L.DUPLICATED_INJECTABLE_DECORATOR=void 0,L.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",L.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",L.NULL_ARGUMENT="NULL argument",L.KEY_NOT_FOUND="Key Not Found",L.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",L.CANNOT_UNBIND="Could not unbind serviceIdentifier:",L.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",L.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",L.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",L.UNDEFINED_INJECT_ANNOTATION=function(g){return"@inject called with undefined this could mean that the class "+g+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},L.CIRCULAR_DEPENDENCY="Circular dependency found:",L.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",L.INVALID_BINDING_TYPE="Invalid binding type:",L.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",L.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",L.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",L.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",L.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",L.ARGUMENTS_LENGTH_MISMATCH=function(){for(var g=[],O=0;O<arguments.length;O++)g[O]=arguments[O];return"The number of constructor arguments in the derived class "+g[0]+" must be >= than the number of constructor arguments of its base class."},L.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",L.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",L.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",L.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",L.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",L.POST_CONSTRUCT_ERROR=function(){for(var g=[],O=0;O<arguments.length;O++)g[O]=arguments[O];return"@postConstruct error in class "+g[0]+": "+g[1]},L.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var g=[],O=0;O<arguments.length;O++)g[O]=arguments[O];return"It looks like there is a circular dependency in one of the '"+g[0]+"' bindings. Please investigate bindings withservice identifier '"+g[1]+"'."},L.STACK_OVERFLOW="Maximum call stack size exceeded"},21785:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.TargetTypeEnum=L.BindingTypeEnum=L.BindingScopeEnum=void 0,L.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"},L.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},L.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},7259:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.NON_CUSTOM_TAG_KEYS=L.POST_CONSTRUCT=L.DESIGN_PARAM_TYPES=L.PARAM_TYPES=L.TAGGED_PROP=L.TAGGED=L.MULTI_INJECT_TAG=L.INJECT_TAG=L.OPTIONAL_TAG=L.UNMANAGED_TAG=L.NAME_TAG=L.NAMED_TAG=void 0,L.NAMED_TAG="named",L.NAME_TAG="name",L.UNMANAGED_TAG="unmanaged",L.OPTIONAL_TAG="optional",L.INJECT_TAG="inject",L.MULTI_INJECT_TAG="multi_inject",L.TAGGED="inversify:tagged",L.TAGGED_PROP="inversify:tagged_props",L.PARAM_TYPES="inversify:paramtypes",L.DESIGN_PARAM_TYPES="design:paramtypes",L.POST_CONSTRUCT="post_construct",L.NON_CUSTOM_TAG_KEYS=[L.INJECT_TAG,L.MULTI_INJECT_TAG,L.NAME_TAG,L.UNMANAGED_TAG,L.NAMED_TAG,L.OPTIONAL_TAG]},93414:function(ie,L,y){"use strict";var M=this&&this.__awaiter||function(Et,ut,tt,Gt){return new(tt||(tt=Promise))(function(Vt,ot){function Ue(At){try{Xe(Gt.next(At))}catch(kt){ot(kt)}}function pt(At){try{Xe(Gt.throw(At))}catch(kt){ot(kt)}}function Xe(At){At.done?Vt(At.value):function(Vt){return Vt instanceof tt?Vt:new tt(function(ot){ot(Vt)})}(At.value).then(Ue,pt)}Xe((Gt=Gt.apply(Et,ut||[])).next())})},_=this&&this.__generator||function(Et,ut){var Gt,Q,Vt,ot,tt={label:0,sent:function(){if(1&Vt[0])throw Vt[1];return Vt[1]},trys:[],ops:[]};return ot={next:Ue(0),throw:Ue(1),return:Ue(2)},"function"==typeof Symbol&&(ot[Symbol.iterator]=function(){return this}),ot;function Ue(Xe){return function(At){return function(Xe){if(Gt)throw new TypeError("Generator is already executing.");for(;tt;)try{if(Gt=1,Q&&(Vt=2&Xe[0]?Q.return:Xe[0]?Q.throw||((Vt=Q.return)&&Vt.call(Q),0):Q.next)&&!(Vt=Vt.call(Q,Xe[1])).done)return Vt;switch(Q=0,Vt&&(Xe=[2&Xe[0],Vt.value]),Xe[0]){case 0:case 1:Vt=Xe;break;case 4:return tt.label++,{value:Xe[1],done:!1};case 5:tt.label++,Q=Xe[1],Xe=[0];continue;case 7:Xe=tt.ops.pop(),tt.trys.pop();continue;default:if(!(Vt=(Vt=tt.trys).length>0&&Vt[Vt.length-1])&&(6===Xe[0]||2===Xe[0])){tt=0;continue}if(3===Xe[0]&&(!Vt||Xe[1]>Vt[0]&&Xe[1]<Vt[3])){tt.label=Xe[1];break}if(6===Xe[0]&&tt.label<Vt[1]){tt.label=Vt[1],Vt=Xe;break}if(Vt&&tt.label<Vt[2]){tt.label=Vt[2],tt.ops.push(Xe);break}Vt[2]&&tt.ops.pop(),tt.trys.pop();continue}Xe=ut.call(Et,tt)}catch(At){Xe=[6,At],Q=0}finally{Gt=Vt=0}if(5&Xe[0])throw Xe[1];return{value:Xe[0]?Xe[1]:void 0,done:!0}}([Xe,At])}}},c=this&&this.__spreadArray||function(Et,ut){for(var tt=0,Gt=ut.length,Q=Et.length;tt<Gt;tt++,Q++)Et[Q]=ut[tt];return Et};Object.defineProperty(L,"__esModule",{value:!0}),L.Container=void 0;var g=y(31885),O=y(90640),R=y(21785),B=y(7259),H=y(28236),G=y(71256),be=y(2739),Be=y(38809),j=y(16800),W=y(48736),Ke=y(8974),xt=y(22377),Dt=function(){function Et(ut){this._appliedMiddleware=[];var tt=ut||{};if("object"!=typeof tt)throw new Error(""+O.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===tt.defaultScope)tt.defaultScope=R.BindingScopeEnum.Transient;else if(tt.defaultScope!==R.BindingScopeEnum.Singleton&&tt.defaultScope!==R.BindingScopeEnum.Transient&&tt.defaultScope!==R.BindingScopeEnum.Request)throw new Error(""+O.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===tt.autoBindInjectable)tt.autoBindInjectable=!1;else if("boolean"!=typeof tt.autoBindInjectable)throw new Error(""+O.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===tt.skipBaseClassChecks)tt.skipBaseClassChecks=!1;else if("boolean"!=typeof tt.skipBaseClassChecks)throw new Error(""+O.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:tt.autoBindInjectable,defaultScope:tt.defaultScope,skipBaseClassChecks:tt.skipBaseClassChecks},this.id=j.id(),this._bindingDictionary=new xt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new H.MetadataReader}return Et.merge=function(ut,tt){for(var Gt=[],Q=2;Q<arguments.length;Q++)Gt[Q-2]=arguments[Q];var Vt=new Et,ot=c([ut,tt],Gt).map(function(Xe){return G.getBindingDictionary(Xe)}),Ue=G.getBindingDictionary(Vt);function pt(Xe,At){Xe.traverse(function(kt,Yt){Yt.forEach(function(Er){At.add(Er.serviceIdentifier,Er.clone())})})}return ot.forEach(function(Xe){pt(Xe,Ue)}),Vt},Et.prototype.load=function(){for(var ut=[],tt=0;tt<arguments.length;tt++)ut[tt]=arguments[tt];for(var Gt=this._getContainerModuleHelpersFactory(),Q=0,Vt=ut;Q<Vt.length;Q++){var ot=Vt[Q],Ue=Gt(ot.id);ot.registry(Ue.bindFunction,Ue.unbindFunction,Ue.isboundFunction,Ue.rebindFunction)}},Et.prototype.loadAsync=function(){for(var ut=[],tt=0;tt<arguments.length;tt++)ut[tt]=arguments[tt];return M(this,void 0,void 0,function(){var Gt,Q,Vt,ot,Ue;return _(this,function(pt){switch(pt.label){case 0:Gt=this._getContainerModuleHelpersFactory(),Q=0,Vt=ut,pt.label=1;case 1:return Q<Vt.length?(Ue=Gt((ot=Vt[Q]).id),[4,ot.registry(Ue.bindFunction,Ue.unbindFunction,Ue.isboundFunction,Ue.rebindFunction)]):[3,4];case 2:pt.sent(),pt.label=3;case 3:return Q++,[3,1];case 4:return[2]}})})},Et.prototype.unload=function(){for(var ut=this,tt=[],Gt=0;Gt<arguments.length;Gt++)tt[Gt]=arguments[Gt];var Q=function(Vt){return function(ot){return ot.moduleId===Vt}};tt.forEach(function(Vt){var ot=Q(Vt.id);ut._bindingDictionary.removeByCondition(ot)})},Et.prototype.bind=function(ut){var Gt=new g.Binding(ut,this.options.defaultScope||R.BindingScopeEnum.Transient);return this._bindingDictionary.add(ut,Gt),new Be.BindingToSyntax(Gt)},Et.prototype.rebind=function(ut){return this.unbind(ut),this.bind(ut)},Et.prototype.unbind=function(ut){try{this._bindingDictionary.remove(ut)}catch(tt){throw new Error(O.CANNOT_UNBIND+" "+W.getServiceIdentifierAsString(ut))}},Et.prototype.unbindAll=function(){this._bindingDictionary=new xt.Lookup},Et.prototype.isBound=function(ut){var tt=this._bindingDictionary.hasKey(ut);return!tt&&this.parent&&(tt=this.parent.isBound(ut)),tt},Et.prototype.isBoundNamed=function(ut,tt){return this.isBoundTagged(ut,B.NAMED_TAG,tt)},Et.prototype.isBoundTagged=function(ut,tt,Gt){var Q=!1;if(this._bindingDictionary.hasKey(ut)){var Vt=this._bindingDictionary.get(ut),ot=G.createMockRequest(this,ut,tt,Gt);Q=Vt.some(function(Ue){return Ue.constraint(ot)})}return!Q&&this.parent&&(Q=this.parent.isBoundTagged(ut,tt,Gt)),Q},Et.prototype.snapshot=function(){this._snapshots.push(Ke.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},Et.prototype.restore=function(){var ut=this._snapshots.pop();if(void 0===ut)throw new Error(O.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=ut.bindings,this._middleware=ut.middleware},Et.prototype.createChild=function(ut){var tt=new Et(ut||this.options);return tt.parent=this,tt},Et.prototype.applyMiddleware=function(){for(var ut=[],tt=0;tt<arguments.length;tt++)ut[tt]=arguments[tt];this._appliedMiddleware=this._appliedMiddleware.concat(ut);var Gt=this._middleware?this._middleware:this._planAndResolve();this._middleware=ut.reduce(function(Q,Vt){return Vt(Q)},Gt)},Et.prototype.applyCustomMetadataReader=function(ut){this._metadataReader=ut},Et.prototype.get=function(ut){return this._get(!1,!1,R.TargetTypeEnum.Variable,ut)},Et.prototype.getTagged=function(ut,tt,Gt){return this._get(!1,!1,R.TargetTypeEnum.Variable,ut,tt,Gt)},Et.prototype.getNamed=function(ut,tt){return this.getTagged(ut,B.NAMED_TAG,tt)},Et.prototype.getAll=function(ut){return this._get(!0,!0,R.TargetTypeEnum.Variable,ut)},Et.prototype.getAllTagged=function(ut,tt,Gt){return this._get(!1,!0,R.TargetTypeEnum.Variable,ut,tt,Gt)},Et.prototype.getAllNamed=function(ut,tt){return this.getAllTagged(ut,B.NAMED_TAG,tt)},Et.prototype.resolve=function(ut){var tt=this.createChild();return tt.bind(ut).toSelf(),this._appliedMiddleware.forEach(function(Gt){tt.applyMiddleware(Gt)}),tt.get(ut)},Et.prototype._getContainerModuleHelpersFactory=function(){var ut=this,tt=function(Ue,pt){Ue._binding.moduleId=pt},Gt=function(Ue){return function(pt){var At=ut.bind.bind(ut)(pt);return tt(At,Ue),At}},ot=function(Ue){return function(pt){var At=ut.rebind.bind(ut)(pt);return tt(At,Ue),At}};return function(Ue){return{bindFunction:Gt(Ue),isboundFunction:function(pt){return ut.isBound.bind(ut)(pt)},rebindFunction:ot(Ue),unbindFunction:function(pt){ut.unbind.bind(ut)(pt)}}}},Et.prototype._get=function(ut,tt,Gt,Q,Vt,ot){var Ue=null,pt={avoidConstraints:ut,contextInterceptor:function(Xe){return Xe},isMultiInject:tt,key:Vt,serviceIdentifier:Q,targetType:Gt,value:ot};if(this._middleware){if(null==(Ue=this._middleware(pt)))throw new Error(O.INVALID_MIDDLEWARE_RETURN)}else Ue=this._planAndResolve()(pt);return Ue},Et.prototype._planAndResolve=function(){var ut=this;return function(tt){var Gt=G.plan(ut._metadataReader,ut,tt.isMultiInject,tt.targetType,tt.serviceIdentifier,tt.key,tt.value,tt.avoidConstraints);return Gt=tt.contextInterceptor(Gt),be.resolve(Gt)}},Et}();L.Container=Dt},6070:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.AsyncContainerModule=L.ContainerModule=void 0;var M=y(16800);L.ContainerModule=function(O){this.id=M.id(),this.registry=O},L.AsyncContainerModule=function(O){this.id=M.id(),this.registry=O}},8974:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.ContainerSnapshot=void 0;var y=function(){function M(){}return M.of=function(_,c){var g=new M;return g.bindings=_,g.middleware=c,g},M}();L.ContainerSnapshot=y},22377:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Lookup=void 0;var M=y(90640),_=function(){function c(){this._map=new Map}return c.prototype.getMap=function(){return this._map},c.prototype.add=function(g,O){if(null==g)throw new Error(M.NULL_ARGUMENT);if(null==O)throw new Error(M.NULL_ARGUMENT);var R=this._map.get(g);void 0!==R?(R.push(O),this._map.set(g,R)):this._map.set(g,[O])},c.prototype.get=function(g){if(null==g)throw new Error(M.NULL_ARGUMENT);var O=this._map.get(g);if(void 0!==O)return O;throw new Error(M.KEY_NOT_FOUND)},c.prototype.remove=function(g){if(null==g)throw new Error(M.NULL_ARGUMENT);if(!this._map.delete(g))throw new Error(M.KEY_NOT_FOUND)},c.prototype.removeByCondition=function(g){var O=this;this._map.forEach(function(R,B){var H=R.filter(function(G){return!g(G)});H.length>0?O._map.set(B,H):O._map.delete(B)})},c.prototype.hasKey=function(g){if(null==g)throw new Error(M.NULL_ARGUMENT);return this._map.has(g)},c.prototype.clone=function(){var g=new c;return this._map.forEach(function(O,R){O.forEach(function(B){return g.add(R,B.clone())})}),g},c.prototype.traverse=function(g){this._map.forEach(function(O,R){g(R,O)})},c}();L.Lookup=_},15922:(ie,L,y)=>{"use strict";L.GW=L.zY=L.f3=L.b2=L.W2=void 0,y(7259);var c=y(93414);Object.defineProperty(L,"W2",{enumerable:!0,get:function(){return c.Container}});y(21785),y(6070);var R=y(57549);Object.defineProperty(L,"b2",{enumerable:!0,get:function(){return R.injectable}});y(43881),y(35546);var G=y(53615);Object.defineProperty(L,"f3",{enumerable:!0,get:function(){return G.inject}});y(78098),y(14978),y(42048),y(91698);var Ke=y(18955);Object.defineProperty(L,"zY",{enumerable:!0,get:function(){return Ke.postConstruct}});y(28236),y(16800);var Et=y(84848);Object.defineProperty(L,"GW",{enumerable:!0,get:function(){return Et.decorate}});y(9446),y(48736),y(85527)},68902:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Context=void 0;var M=y(16800),_=function(){function c(g){this.id=M.id(),this.container=g}return c.prototype.addPlan=function(g){this.plan=g},c.prototype.setCurrentRequest=function(g){this.currentRequest=g},c}();L.Context=_},95839:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Metadata=void 0;var M=y(7259),_=function(){function c(g,O){this.key=g,this.value=O}return c.prototype.toString=function(){return this.key===M.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},c}();L.Metadata=_},28236:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.MetadataReader=void 0;var M=y(7259),_=function(){function c(){}return c.prototype.getConstructorMetadata=function(g){return{compilerGeneratedMetadata:Reflect.getMetadata(M.PARAM_TYPES,g),userGeneratedMetadata:Reflect.getMetadata(M.TAGGED,g)||{}}},c.prototype.getPropertiesMetadata=function(g){return Reflect.getMetadata(M.TAGGED_PROP,g)||[]},c}();L.MetadataReader=_},96742:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Plan=void 0,L.Plan=function(_,c){this.parentContext=_,this.rootRequest=c}},71256:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.getBindingDictionary=L.createMockRequest=L.plan=void 0;var M=y(54046),_=y(90640),c=y(21785),g=y(7259),O=y(61674),R=y(48736),B=y(68902),H=y(95839),G=y(96742),be=y(64479),Be=y(68779),j=y(56407);function W(Q){return Q._bindingDictionary}function xt(Q,Vt,ot,Ue,pt){var At,Xe=ut(ot.container,pt.serviceIdentifier);return Xe.length===M.BindingCount.NoBindingsAvailable&&ot.container.options.autoBindInjectable&&"function"==typeof pt.serviceIdentifier&&Q.getConstructorMetadata(pt.serviceIdentifier).compilerGeneratedMetadata&&(ot.container.bind(pt.serviceIdentifier).toSelf(),Xe=ut(ot.container,pt.serviceIdentifier)),At=Vt?Xe:Xe.filter(function(kt){var Yt=new Be.Request(kt.serviceIdentifier,ot,Ue,kt,pt);return kt.constraint(Yt)}),function(Q,Vt,ot,Ue){switch(Vt.length){case M.BindingCount.NoBindingsAvailable:if(ot.isOptional())return Vt;var pt=R.getServiceIdentifierAsString(Q),Xe=_.NOT_REGISTERED;throw Xe+=R.listMetadataForTarget(pt,ot),Xe+=R.listRegisteredBindingsForServiceIdentifier(Ue,pt,ut),new Error(Xe);case M.BindingCount.OnlyOneBindingAvailable:if(!ot.isArray())return Vt;case M.BindingCount.MultipleBindingsAvailable:default:if(ot.isArray())return Vt;throw pt=R.getServiceIdentifierAsString(Q),Xe=_.AMBIGUOUS_MATCH+" "+pt,Xe+=R.listRegisteredBindingsForServiceIdentifier(Ue,pt,ut),new Error(Xe)}}(pt.serviceIdentifier,At,pt,ot.container),At}function Et(Q,Vt,ot,Ue,pt,Xe){var At,kt;if(null===pt){At=xt(Q,Vt,Ue,null,Xe),kt=new Be.Request(ot,Ue,null,At,Xe);var Yt=new G.Plan(Ue,kt);Ue.addPlan(Yt)}else At=xt(Q,Vt,Ue,pt,Xe),kt=pt.addChildRequest(Xe.serviceIdentifier,At,Xe);At.forEach(function(Er){var ge=null;if(Xe.isArray())ge=kt.addChildRequest(Er.serviceIdentifier,Er,Xe);else{if(Er.cache)return;ge=kt}if(Er.type===c.BindingTypeEnum.Instance&&null!==Er.implementationType){var de=be.getDependencies(Q,Er.implementationType);if(!Ue.container.options.skipBaseClassChecks){var oe=be.getBaseClassDependencyCount(Q,Er.implementationType);if(de.length<oe){var me=_.ARGUMENTS_LENGTH_MISMATCH(be.getFunctionName(Er.implementationType));throw new Error(me)}}de.forEach(function(Me){Et(Q,!1,Me.serviceIdentifier,Ue,ge,Me)})}})}function ut(Q,Vt){var ot=[],Ue=W(Q);return Ue.hasKey(Vt)?ot=Ue.get(Vt):null!==Q.parent&&(ot=ut(Q.parent,Vt)),ot}L.getBindingDictionary=W,L.plan=function(Q,Vt,ot,Ue,pt,Xe,At,kt){void 0===kt&&(kt=!1);var Yt=new B.Context(Vt),Er=function(Q,Vt,ot,Ue,pt,Xe){var kt=new H.Metadata(Q?g.MULTI_INJECT_TAG:g.INJECT_TAG,ot),Yt=new j.Target(Vt,"",ot,kt);if(void 0!==pt){var Er=new H.Metadata(pt,Xe);Yt.metadata.push(Er)}return Yt}(ot,Ue,pt,0,Xe,At);try{return Et(Q,kt,pt,Yt,null,Er),Yt}catch(ge){throw O.isStackOverflowExeption(ge)&&Yt.plan&&R.circularDependencyToException(Yt.plan.rootRequest),ge}},L.createMockRequest=function(Q,Vt,ot,Ue){var pt=new j.Target(c.TargetTypeEnum.Variable,"",Vt,new H.Metadata(ot,Ue)),Xe=new B.Context(Q);return new Be.Request(Vt,Xe,null,[],pt)}},46872:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.QueryableString=void 0;var y=function(){function M(_){this.str=_}return M.prototype.startsWith=function(_){return 0===this.str.indexOf(_)},M.prototype.endsWith=function(_){var c,g=_.split("").reverse().join("");return c=this.str.split("").reverse().join(""),this.startsWith.call({str:c},g)},M.prototype.contains=function(_){return-1!==this.str.indexOf(_)},M.prototype.equals=function(_){return this.str===_},M.prototype.value=function(){return this.str},M}();L.QueryableString=y},64479:function(ie,L,y){"use strict";var M=this&&this.__spreadArray||function(xt,Dt){for(var Et=0,ut=Dt.length,tt=xt.length;Et<ut;Et++,tt++)xt[tt]=Dt[Et];return xt};Object.defineProperty(L,"__esModule",{value:!0}),L.getFunctionName=L.getBaseClassDependencyCount=L.getDependencies=void 0;var _=y(53615),c=y(90640),g=y(21785),O=y(7259),R=y(48736);Object.defineProperty(L,"getFunctionName",{enumerable:!0,get:function(){return R.getFunctionName}});var B=y(56407);function G(xt,Dt,Et,ut){var tt=xt.getConstructorMetadata(Et),Gt=tt.compilerGeneratedMetadata;if(void 0===Gt)throw new Error(c.MISSING_INJECTABLE_ANNOTATION+" "+Dt+".");var Vt=tt.userGeneratedMetadata,ot=Object.keys(Vt),At=function(xt,Dt,Et,ut,tt){for(var Gt=[],Q=0;Q<tt;Q++){var ot=be(Q,xt,Dt,Et,ut);null!==ot&&Gt.push(ot)}return Gt}(ut,Dt,Gt,Vt,0===Et.length&&ot.length>0||ot.length>Et.length?ot.length:Et.length),kt=j(xt,Et);return M(M([],At),kt)}function be(xt,Dt,Et,ut,tt){var Gt=tt[xt.toString()]||[],Q=Ke(Gt),Vt=!0!==Q.unmanaged,ot=ut[xt];if((ot=Q.inject||Q.multiInject||ot)instanceof _.LazyServiceIdentifer&&(ot=ot.unwrap()),Vt){if(!Dt&&(ot===Object||ot===Function||void 0===ot))throw new Error(c.MISSING_INJECT_ANNOTATION+" argument "+xt+" in class "+Et+".");var Er=new B.Target(g.TargetTypeEnum.ConstructorArgument,Q.targetName,ot);return Er.metadata=Gt,Er}return null}function j(xt,Dt){for(var Et=xt.getPropertiesMetadata(Dt),ut=[],Gt=0,Q=Object.keys(Et);Gt<Q.length;Gt++){var Vt=Q[Gt],ot=Et[Vt],Ue=Ke(Et[Vt]),At=new B.Target(g.TargetTypeEnum.ClassProperty,Ue.targetName||Vt,Ue.inject||Ue.multiInject);At.metadata=ot,ut.push(At)}var kt=Object.getPrototypeOf(Dt.prototype).constructor;if(kt!==Object){var Yt=j(xt,kt);ut=M(M([],ut),Yt)}return ut}function Ke(xt){var Dt={};return xt.forEach(function(Et){Dt[Et.key.toString()]=Et.value}),{inject:Dt[O.INJECT_TAG],multiInject:Dt[O.MULTI_INJECT_TAG],targetName:Dt[O.NAME_TAG],unmanaged:Dt[O.UNMANAGED_TAG]}}L.getDependencies=function(xt,Dt){return G(xt,R.getFunctionName(Dt),Dt,!1)},L.getBaseClassDependencyCount=function W(xt,Dt){var Et=Object.getPrototypeOf(Dt.prototype).constructor;if(Et!==Object){var tt=G(xt,R.getFunctionName(Et),Et,!0),Gt=tt.map(function(ot){return ot.metadata.filter(function(Ue){return Ue.key===O.UNMANAGED_TAG})}),Q=[].concat.apply([],Gt).length,Vt=tt.length-Q;return Vt>0?Vt:W(xt,Et)}return 0}},68779:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Request=void 0;var M=y(16800),_=function(){function c(g,O,R,B,H){this.id=M.id(),this.serviceIdentifier=g,this.parentContext=O,this.parentRequest=R,this.target=H,this.childRequests=[],this.bindings=Array.isArray(B)?B:[B],this.requestScope=null===R?new Map:null}return c.prototype.addChildRequest=function(g,O,R){var B=new c(g,this.parentContext,this,O,R);return this.childRequests.push(B),B},c}();L.Request=_},56407:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.Target=void 0;var M=y(7259),_=y(16800),c=y(95839),g=y(46872),O=function(){function R(B,H,G,be){this.id=_.id(),this.type=B,this.serviceIdentifier=G,this.name=new g.QueryableString(H||""),this.metadata=new Array;var Be=null;"string"==typeof be?Be=new c.Metadata(M.NAMED_TAG,be):be instanceof c.Metadata&&(Be=be),null!==Be&&this.metadata.push(Be)}return R.prototype.hasTag=function(B){for(var H=0,G=this.metadata;H<G.length;H++)if(G[H].key===B)return!0;return!1},R.prototype.isArray=function(){return this.hasTag(M.MULTI_INJECT_TAG)},R.prototype.matchesArray=function(B){return this.matchesTag(M.MULTI_INJECT_TAG)(B)},R.prototype.isNamed=function(){return this.hasTag(M.NAMED_TAG)},R.prototype.isTagged=function(){return this.metadata.some(function(B){return M.NON_CUSTOM_TAG_KEYS.every(function(H){return B.key!==H})})},R.prototype.isOptional=function(){return this.matchesTag(M.OPTIONAL_TAG)(!0)},R.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(B){return B.key===M.NAMED_TAG})[0]:null},R.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(B){return M.NON_CUSTOM_TAG_KEYS.every(function(H){return B.key!==H})}):null},R.prototype.matchesNamedTag=function(B){return this.matchesTag(M.NAMED_TAG)(B)},R.prototype.matchesTag=function(B){var H=this;return function(G){for(var be=0,Be=H.metadata;be<Be.length;be++){var j=Be[be];if(j.key===B&&j.value===G)return!0}return!1}},R}();L.Target=O},77661:function(ie,L,y){"use strict";var M=this&&this.__spreadArray||function(G,be){for(var Be=0,j=be.length,W=G.length;Be<j;Be++,W++)G[W]=be[Be];return G};Object.defineProperty(L,"__esModule",{value:!0}),L.resolveInstance=void 0;var _=y(90640),c=y(21785),g=y(7259);L.resolveInstance=function(G,be,Be){var j=null;return j=be.length>0?function(G,be,Be){var j=be.filter(function(Ke){return null!==Ke.target&&Ke.target.type===c.TargetTypeEnum.ClassProperty}),W=j.map(Be);return j.forEach(function(Ke,xt){var Dt;Dt=Ke.target.name.value(),G[Dt]=W[xt]}),G}(j=function(G,be){return new(G.bind.apply(G,M([void 0],be)))}(G,be.filter(function(xt){return null!==xt.target&&xt.target.type===c.TargetTypeEnum.ConstructorArgument}).map(Be)),be,Be):new G,function(G,be){if(Reflect.hasMetadata(g.POST_CONSTRUCT,G)){var Be=Reflect.getMetadata(g.POST_CONSTRUCT,G);try{be[Be.value]()}catch(j){throw new Error(_.POST_CONSTRUCT_ERROR(G.name,j.message))}}}(G,j),j}},2739:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.resolve=void 0;var M=y(90640),_=y(21785),c=y(61674),g=y(48736),O=y(77661),R=function(G,be,Be){try{return Be()}catch(j){throw c.isStackOverflowExeption(j)?new Error(M.CIRCULAR_DEPENDENCY_IN_FACTORY(G,be.toString())):j}},B=function(G){return function(be){be.parentContext.setCurrentRequest(be);var Be=be.bindings,j=be.childRequests,W=be.target&&be.target.isArray(),Ke=!(be.parentRequest&&be.parentRequest.target&&be.target&&be.parentRequest.target.matchesArray(be.target.serviceIdentifier));if(W&&Ke)return j.map(function(Gt){return B(G)(Gt)});var xt=null;if(!be.target.isOptional()||0!==Be.length){var Dt=Be[0],Et=Dt.scope===_.BindingScopeEnum.Singleton,ut=Dt.scope===_.BindingScopeEnum.Request;if(Et&&Dt.activated)return Dt.cache;if(ut&&null!==G&&G.has(Dt.id))return G.get(Dt.id);if(Dt.type===_.BindingTypeEnum.ConstantValue)xt=Dt.cache,Dt.activated=!0;else if(Dt.type===_.BindingTypeEnum.Function)xt=Dt.cache,Dt.activated=!0;else if(Dt.type===_.BindingTypeEnum.Constructor)xt=Dt.implementationType;else if(Dt.type===_.BindingTypeEnum.DynamicValue&&null!==Dt.dynamicValue)xt=R("toDynamicValue",Dt.serviceIdentifier,function(){return Dt.dynamicValue(be.parentContext)});else if(Dt.type===_.BindingTypeEnum.Factory&&null!==Dt.factory)xt=R("toFactory",Dt.serviceIdentifier,function(){return Dt.factory(be.parentContext)});else if(Dt.type===_.BindingTypeEnum.Provider&&null!==Dt.provider)xt=R("toProvider",Dt.serviceIdentifier,function(){return Dt.provider(be.parentContext)});else{if(Dt.type!==_.BindingTypeEnum.Instance||null===Dt.implementationType){var tt=g.getServiceIdentifierAsString(be.serviceIdentifier);throw new Error(M.INVALID_BINDING_TYPE+" "+tt)}xt=O.resolveInstance(Dt.implementationType,j,B(G))}return"function"==typeof Dt.onActivation&&(xt=Dt.onActivation(be.parentContext,xt)),Et&&(Dt.cache=xt,Dt.activated=!0),ut&&null!==G&&!G.has(Dt.id)&&G.set(Dt.id,xt),xt}}};L.resolve=function(G){return B(G.plan.rootRequest.requestScope)(G.plan.rootRequest)}},73504:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingInSyntax=void 0;var M=y(21785),_=y(18564),c=function(){function g(O){this._binding=O}return g.prototype.inRequestScope=function(){return this._binding.scope=M.BindingScopeEnum.Request,new _.BindingWhenOnSyntax(this._binding)},g.prototype.inSingletonScope=function(){return this._binding.scope=M.BindingScopeEnum.Singleton,new _.BindingWhenOnSyntax(this._binding)},g.prototype.inTransientScope=function(){return this._binding.scope=M.BindingScopeEnum.Transient,new _.BindingWhenOnSyntax(this._binding)},g}();L.BindingInSyntax=c},80620:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingInWhenOnSyntax=void 0;var M=y(73504),_=y(17067),c=y(24803),g=function(){function O(R){this._binding=R,this._bindingWhenSyntax=new c.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new _.BindingOnSyntax(this._binding),this._bindingInSyntax=new M.BindingInSyntax(R)}return O.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},O.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},O.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},O.prototype.when=function(R){return this._bindingWhenSyntax.when(R)},O.prototype.whenTargetNamed=function(R){return this._bindingWhenSyntax.whenTargetNamed(R)},O.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},O.prototype.whenTargetTagged=function(R,B){return this._bindingWhenSyntax.whenTargetTagged(R,B)},O.prototype.whenInjectedInto=function(R){return this._bindingWhenSyntax.whenInjectedInto(R)},O.prototype.whenParentNamed=function(R){return this._bindingWhenSyntax.whenParentNamed(R)},O.prototype.whenParentTagged=function(R,B){return this._bindingWhenSyntax.whenParentTagged(R,B)},O.prototype.whenAnyAncestorIs=function(R){return this._bindingWhenSyntax.whenAnyAncestorIs(R)},O.prototype.whenNoAncestorIs=function(R){return this._bindingWhenSyntax.whenNoAncestorIs(R)},O.prototype.whenAnyAncestorNamed=function(R){return this._bindingWhenSyntax.whenAnyAncestorNamed(R)},O.prototype.whenAnyAncestorTagged=function(R,B){return this._bindingWhenSyntax.whenAnyAncestorTagged(R,B)},O.prototype.whenNoAncestorNamed=function(R){return this._bindingWhenSyntax.whenNoAncestorNamed(R)},O.prototype.whenNoAncestorTagged=function(R,B){return this._bindingWhenSyntax.whenNoAncestorTagged(R,B)},O.prototype.whenAnyAncestorMatches=function(R){return this._bindingWhenSyntax.whenAnyAncestorMatches(R)},O.prototype.whenNoAncestorMatches=function(R){return this._bindingWhenSyntax.whenNoAncestorMatches(R)},O.prototype.onActivation=function(R){return this._bindingOnSyntax.onActivation(R)},O}();L.BindingInWhenOnSyntax=g},17067:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingOnSyntax=void 0;var M=y(24803),_=function(){function c(g){this._binding=g}return c.prototype.onActivation=function(g){return this._binding.onActivation=g,new M.BindingWhenSyntax(this._binding)},c}();L.BindingOnSyntax=_},38809:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingToSyntax=void 0;var M=y(90640),_=y(21785),c=y(80620),g=y(18564),O=function(){function R(B){this._binding=B}return R.prototype.to=function(B){return this._binding.type=_.BindingTypeEnum.Instance,this._binding.implementationType=B,new c.BindingInWhenOnSyntax(this._binding)},R.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+M.INVALID_TO_SELF_VALUE);return this.to(this._binding.serviceIdentifier)},R.prototype.toConstantValue=function(B){return this._binding.type=_.BindingTypeEnum.ConstantValue,this._binding.cache=B,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=_.BindingScopeEnum.Singleton,new g.BindingWhenOnSyntax(this._binding)},R.prototype.toDynamicValue=function(B){return this._binding.type=_.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=B,this._binding.implementationType=null,new c.BindingInWhenOnSyntax(this._binding)},R.prototype.toConstructor=function(B){return this._binding.type=_.BindingTypeEnum.Constructor,this._binding.implementationType=B,this._binding.scope=_.BindingScopeEnum.Singleton,new g.BindingWhenOnSyntax(this._binding)},R.prototype.toFactory=function(B){return this._binding.type=_.BindingTypeEnum.Factory,this._binding.factory=B,this._binding.scope=_.BindingScopeEnum.Singleton,new g.BindingWhenOnSyntax(this._binding)},R.prototype.toFunction=function(B){if("function"!=typeof B)throw new Error(M.INVALID_FUNCTION_BINDING);var H=this.toConstantValue(B);return this._binding.type=_.BindingTypeEnum.Function,this._binding.scope=_.BindingScopeEnum.Singleton,H},R.prototype.toAutoFactory=function(B){return this._binding.type=_.BindingTypeEnum.Factory,this._binding.factory=function(H){return function(){return H.container.get(B)}},this._binding.scope=_.BindingScopeEnum.Singleton,new g.BindingWhenOnSyntax(this._binding)},R.prototype.toProvider=function(B){return this._binding.type=_.BindingTypeEnum.Provider,this._binding.provider=B,this._binding.scope=_.BindingScopeEnum.Singleton,new g.BindingWhenOnSyntax(this._binding)},R.prototype.toService=function(B){this.toDynamicValue(function(H){return H.container.get(B)})},R}();L.BindingToSyntax=O},18564:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingWhenOnSyntax=void 0;var M=y(17067),_=y(24803),c=function(){function g(O){this._binding=O,this._bindingWhenSyntax=new _.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new M.BindingOnSyntax(this._binding)}return g.prototype.when=function(O){return this._bindingWhenSyntax.when(O)},g.prototype.whenTargetNamed=function(O){return this._bindingWhenSyntax.whenTargetNamed(O)},g.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},g.prototype.whenTargetTagged=function(O,R){return this._bindingWhenSyntax.whenTargetTagged(O,R)},g.prototype.whenInjectedInto=function(O){return this._bindingWhenSyntax.whenInjectedInto(O)},g.prototype.whenParentNamed=function(O){return this._bindingWhenSyntax.whenParentNamed(O)},g.prototype.whenParentTagged=function(O,R){return this._bindingWhenSyntax.whenParentTagged(O,R)},g.prototype.whenAnyAncestorIs=function(O){return this._bindingWhenSyntax.whenAnyAncestorIs(O)},g.prototype.whenNoAncestorIs=function(O){return this._bindingWhenSyntax.whenNoAncestorIs(O)},g.prototype.whenAnyAncestorNamed=function(O){return this._bindingWhenSyntax.whenAnyAncestorNamed(O)},g.prototype.whenAnyAncestorTagged=function(O,R){return this._bindingWhenSyntax.whenAnyAncestorTagged(O,R)},g.prototype.whenNoAncestorNamed=function(O){return this._bindingWhenSyntax.whenNoAncestorNamed(O)},g.prototype.whenNoAncestorTagged=function(O,R){return this._bindingWhenSyntax.whenNoAncestorTagged(O,R)},g.prototype.whenAnyAncestorMatches=function(O){return this._bindingWhenSyntax.whenAnyAncestorMatches(O)},g.prototype.whenNoAncestorMatches=function(O){return this._bindingWhenSyntax.whenNoAncestorMatches(O)},g.prototype.onActivation=function(O){return this._bindingOnSyntax.onActivation(O)},g}();L.BindingWhenOnSyntax=c},24803:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.BindingWhenSyntax=void 0;var M=y(17067),_=y(9446),c=function(){function g(O){this._binding=O}return g.prototype.when=function(O){return this._binding.constraint=O,new M.BindingOnSyntax(this._binding)},g.prototype.whenTargetNamed=function(O){return this._binding.constraint=_.namedConstraint(O),new M.BindingOnSyntax(this._binding)},g.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(O){return null!==O.target&&!O.target.isNamed()&&!O.target.isTagged()},new M.BindingOnSyntax(this._binding)},g.prototype.whenTargetTagged=function(O,R){return this._binding.constraint=_.taggedConstraint(O)(R),new M.BindingOnSyntax(this._binding)},g.prototype.whenInjectedInto=function(O){return this._binding.constraint=function(R){return _.typeConstraint(O)(R.parentRequest)},new M.BindingOnSyntax(this._binding)},g.prototype.whenParentNamed=function(O){return this._binding.constraint=function(R){return _.namedConstraint(O)(R.parentRequest)},new M.BindingOnSyntax(this._binding)},g.prototype.whenParentTagged=function(O,R){return this._binding.constraint=function(B){return _.taggedConstraint(O)(R)(B.parentRequest)},new M.BindingOnSyntax(this._binding)},g.prototype.whenAnyAncestorIs=function(O){return this._binding.constraint=function(R){return _.traverseAncerstors(R,_.typeConstraint(O))},new M.BindingOnSyntax(this._binding)},g.prototype.whenNoAncestorIs=function(O){return this._binding.constraint=function(R){return!_.traverseAncerstors(R,_.typeConstraint(O))},new M.BindingOnSyntax(this._binding)},g.prototype.whenAnyAncestorNamed=function(O){return this._binding.constraint=function(R){return _.traverseAncerstors(R,_.namedConstraint(O))},new M.BindingOnSyntax(this._binding)},g.prototype.whenNoAncestorNamed=function(O){return this._binding.constraint=function(R){return!_.traverseAncerstors(R,_.namedConstraint(O))},new M.BindingOnSyntax(this._binding)},g.prototype.whenAnyAncestorTagged=function(O,R){return this._binding.constraint=function(B){return _.traverseAncerstors(B,_.taggedConstraint(O)(R))},new M.BindingOnSyntax(this._binding)},g.prototype.whenNoAncestorTagged=function(O,R){return this._binding.constraint=function(B){return!_.traverseAncerstors(B,_.taggedConstraint(O)(R))},new M.BindingOnSyntax(this._binding)},g.prototype.whenAnyAncestorMatches=function(O){return this._binding.constraint=function(R){return _.traverseAncerstors(R,O)},new M.BindingOnSyntax(this._binding)},g.prototype.whenNoAncestorMatches=function(O){return this._binding.constraint=function(R){return!_.traverseAncerstors(R,O)},new M.BindingOnSyntax(this._binding)},g}();L.BindingWhenSyntax=c},9446:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.typeConstraint=L.namedConstraint=L.taggedConstraint=L.traverseAncerstors=void 0;var M=y(7259),_=y(95839),c=function(B,H){var G=B.parentRequest;return null!==G&&(!!H(G)||c(G,H))};L.traverseAncerstors=c;var g=function(B){return function(H){var G=function(be){return null!==be&&null!==be.target&&be.target.matchesTag(B)(H)};return G.metaData=new _.Metadata(B,H),G}};L.taggedConstraint=g;var O=g(M.NAMED_TAG);L.namedConstraint=O,L.typeConstraint=function(B){return function(H){return null!==H&&("string"==typeof B?H.bindings[0].serviceIdentifier===B:B===H.bindings[0].implementationType)}}},85527:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.multiBindToService=void 0,L.multiBindToService=function(M){return function(_){return function(){for(var c=[],g=0;g<arguments.length;g++)c[g]=arguments[g];return c.forEach(function(O){return M.bind(O).toService(_)})}}}},61674:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.isStackOverflowExeption=void 0;var M=y(90640);L.isStackOverflowExeption=function(c){return c instanceof RangeError||c.message===M.STACK_OVERFLOW}},16800:(ie,L)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.id=void 0;var y=0;L.id=function(){return y++}},48736:(ie,L,y)=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0}),L.circularDependencyToException=L.listMetadataForTarget=L.listRegisteredBindingsForServiceIdentifier=L.getServiceIdentifierAsString=L.getFunctionName=void 0;var M=y(90640);function _(G){return"function"==typeof G?G.name:"symbol"==typeof G?G.toString():G}function g(G,be){return null!==G.parentRequest&&(G.parentRequest.serviceIdentifier===be||g(G.parentRequest,be))}function H(G){if(G.name)return G.name;var be=G.toString(),Be=be.match(/^function\s*([^\s(]+)/);return Be?Be[1]:"Anonymous function: "+be}L.getServiceIdentifierAsString=_,L.listRegisteredBindingsForServiceIdentifier=function(G,be,Be){var j="",W=Be(G,be);return 0!==W.length&&(j="\nRegistered bindings:",W.forEach(function(Ke){var xt="Object";null!==Ke.implementationType&&(xt=H(Ke.implementationType)),j=j+"\n "+xt,Ke.constraint.metaData&&(j=j+" - "+Ke.constraint.metaData)})),j},L.circularDependencyToException=function R(G){G.childRequests.forEach(function(be){if(g(be,be.serviceIdentifier)){var Be=function(G){return function be(j,W){void 0===W&&(W=[]);var Ke=_(j.serviceIdentifier);return W.push(Ke),null!==j.parentRequest?be(j.parentRequest,W):W}(G).reverse().join(" --\x3e ")}(be);throw new Error(M.CIRCULAR_DEPENDENCY+" "+Be)}R(be)})},L.listMetadataForTarget=function(G,be){if(be.isTagged()||be.isNamed()){var Be="",j=be.getNamedTag(),W=be.getCustomTags();return null!==j&&(Be+=j.toString()+"\n"),null!==W&&W.forEach(function(Ke){Be+=Ke.toString()+"\n"})," "+G+"\n "+G+" - "+Be}return" "+G},L.getFunctionName=H},88660:(ie,L,y)=>{"use strict";y.r(L),y.d(L,{Function:()=>eu,Interpreter:()=>ko,default:()=>Dl,evaluate:()=>hl,vm:()=>M});var M={};y.r(M),y.d(M,{Script:()=>Rl,compileFunction:()=>Ll,createContext:()=>Ol,runInContext:()=>kl,runInNewContext:()=>wc});var _={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},c="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",g={5:c,"5module":c+" export import",6:c+" const class extends export import super"},O=/^in(stanceof)?$/,R="\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0560-\u0588\u05d0-\u05ea\u05ef-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u0860-\u086a\u08a0-\u08b4\u08b6-\u08c7\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u09fc\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0af9\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58-\u0c5a\u0c60\u0c61\u0c80\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d04-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d54-\u0d56\u0d5f-\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e86-\u0e8a\u0e8c-\u0ea3\u0ea5\u0ea7-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f5\u13f8-\u13fd\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1878\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1c80-\u1c88\u1c90-\u1cba\u1cbd-\u1cbf\u1ce9-\u1cec\u1cee-\u1cf3\u1cf5\u1cf6\u1cfa\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2118-\u211d\u2124\u2126\u2128\u212a-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309b-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312f\u3131-\u318e\u31a0-\u31bf\u31f0-\u31ff\u3400-\u4dbf\u4e00-\u9ffc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua7bf\ua7c2-\ua7ca\ua7f5-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua8fd\ua8fe\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab69\uab70-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",B="\u200c\u200d\xb7\u0300-\u036f\u0387\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u07fd\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08d3-\u08e1\u08e3-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u09fe\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0afa-\u0aff\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b55-\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c00-\u0c04\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d00-\u0d03\u0d3b\u0d3c\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d81-\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19d0-\u19da\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1ab0-\u1abd\u1abf\u1ac0\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf4\u1cf7-\u1cf9\u1dc0-\u1df9\u1dfb-\u1dff\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69e\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua82c\ua880\ua881\ua8b4-\ua8c5\ua8d0-\ua8d9\ua8e0-\ua8f1\ua8ff-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\ua9e5\ua9f0-\ua9f9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b-\uaa7d\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f",H=new RegExp("["+R+"]"),G=new RegExp("["+R+B+"]");R=B=null;var be=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],Be=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function j(m,T){for(var Y=65536,D=0;D<T.length;D+=2){if((Y+=T[D])>m)return!1;if((Y+=T[D+1])>=m)return!0}}function W(m,T){return m<65?36===m:m<91||(m<97?95===m:m<123||(m<=65535?m>=170&&H.test(String.fromCharCode(m)):!1!==T&&j(m,be)))}function Ke(m,T){return m<48?36===m:m<58||!(m<65)&&(m<91||(m<97?95===m:m<123||(m<=65535?m>=170&&G.test(String.fromCharCode(m)):!1!==T&&(j(m,be)||j(m,Be)))))}var xt=function(T,Y){void 0===Y&&(Y={}),this.label=T,this.keyword=Y.keyword,this.beforeExpr=!!Y.beforeExpr,this.startsExpr=!!Y.startsExpr,this.isLoop=!!Y.isLoop,this.isAssign=!!Y.isAssign,this.prefix=!!Y.prefix,this.postfix=!!Y.postfix,this.binop=Y.binop||null,this.updateContext=null};function Dt(m,T){return new xt(m,{beforeExpr:!0,binop:T})}var Et={beforeExpr:!0},ut={startsExpr:!0},tt={};function Gt(m,T){return void 0===T&&(T={}),T.keyword=m,tt[m]=new xt(m,T)}var Q={num:new xt("num",ut),regexp:new xt("regexp",ut),string:new xt("string",ut),name:new xt("name",ut),eof:new xt("eof"),bracketL:new xt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new xt("]"),braceL:new xt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new xt("}"),parenL:new xt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new xt(")"),comma:new xt(",",Et),semi:new xt(";",Et),colon:new xt(":",Et),dot:new xt("."),question:new xt("?",Et),questionDot:new xt("?."),arrow:new xt("=>",Et),template:new xt("template"),invalidTemplate:new xt("invalidTemplate"),ellipsis:new xt("...",Et),backQuote:new xt("`",ut),dollarBraceL:new xt("${",{beforeExpr:!0,startsExpr:!0}),eq:new xt("=",{beforeExpr:!0,isAssign:!0}),assign:new xt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new xt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new xt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Dt("||",1),logicalAND:Dt("&&",2),bitwiseOR:Dt("|",3),bitwiseXOR:Dt("^",4),bitwiseAND:Dt("&",5),equality:Dt("==/!=/===/!==",6),relational:Dt("</>/<=/>=",7),bitShift:Dt("<</>>/>>>",8),plusMin:new xt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Dt("%",10),star:Dt("*",10),slash:Dt("/",10),starstar:new xt("**",{beforeExpr:!0}),coalesce:Dt("??",1),_break:Gt("break"),_case:Gt("case",Et),_catch:Gt("catch"),_continue:Gt("continue"),_debugger:Gt("debugger"),_default:Gt("default",Et),_do:Gt("do",{isLoop:!0,beforeExpr:!0}),_else:Gt("else",Et),_finally:Gt("finally"),_for:Gt("for",{isLoop:!0}),_function:Gt("function",ut),_if:Gt("if"),_return:Gt("return",Et),_switch:Gt("switch"),_throw:Gt("throw",Et),_try:Gt("try"),_var:Gt("var"),_const:Gt("const"),_while:Gt("while",{isLoop:!0}),_with:Gt("with"),_new:Gt("new",{beforeExpr:!0,startsExpr:!0}),_this:Gt("this",ut),_super:Gt("super",ut),_class:Gt("class",ut),_extends:Gt("extends",Et),_export:Gt("export"),_import:Gt("import",ut),_null:Gt("null",ut),_true:Gt("true",ut),_false:Gt("false",ut),_in:Gt("in",{beforeExpr:!0,binop:7}),_instanceof:Gt("instanceof",{beforeExpr:!0,binop:7}),_typeof:Gt("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:Gt("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:Gt("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Vt=/\r\n?|\n|\u2028|\u2029/,ot=new RegExp(Vt.source,"g");function Ue(m,T){return 10===m||13===m||!T&&(8232===m||8233===m)}var pt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Xe=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,At=Object.prototype,kt=At.hasOwnProperty,Yt=At.toString;function Er(m,T){return kt.call(m,T)}var ge=Array.isArray||function(m){return"[object Array]"===Yt.call(m)};function de(m){return new RegExp("^(?:"+m.replace(/ /g,"|")+")$")}var oe=function(T,Y){this.line=T,this.column=Y};oe.prototype.offset=function(T){return new oe(this.line,this.column+T)};var me=function(T,Y,D){this.start=Y,this.end=D,null!==T.sourceFile&&(this.source=T.sourceFile)};function Me(m,T){for(var Y=1,D=0;;){ot.lastIndex=D;var ve=ot.exec(m);if(!(ve&&ve.index<T))return new oe(Y,T-D);++Y,D=ve.index+ve[0].length}}var Ge={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Pr(m,T){return 2|(m?4:0)|(T?8:0)}var Ve=function(T,Y,D){this.options=T=function(m){var T={};for(var Y in Ge)T[Y]=m&&Er(m,Y)?m[Y]:Ge[Y];if(T.ecmaVersion>=2015&&(T.ecmaVersion-=2009),null==T.allowReserved&&(T.allowReserved=T.ecmaVersion<5),ge(T.onToken)){var D=T.onToken;T.onToken=function(ve){return D.push(ve)}}return ge(T.onComment)&&(T.onComment=function(m,T){return function(Y,D,ve,Ne,mt,zt){var Ft={type:Y?"Block":"Line",value:D,start:ve,end:Ne};m.locations&&(Ft.loc=new me(this,mt,zt)),m.ranges&&(Ft.range=[ve,Ne]),T.push(Ft)}}(T,T.onComment)),T}(T),this.sourceFile=T.sourceFile,this.keywords=de(g[T.ecmaVersion>=6?6:"module"===T.sourceType?"5module":5]);var ve="";if(!0!==T.allowReserved){for(var Ne=T.ecmaVersion;!(ve=_[Ne]);Ne--);"module"===T.sourceType&&(ve+=" await")}this.reservedWords=de(ve);var mt=(ve?ve+" ":"")+_.strict;this.reservedWordsStrict=de(mt),this.reservedWordsStrictBind=de(mt+" "+_.strictBind),this.input=String(Y),this.containsEsc=!1,D?(this.pos=D,this.lineStart=this.input.lastIndexOf("\n",D-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Vt).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=Q.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===T.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&T.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},nt={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Ve.prototype.parse=function(){var T=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(T)},nt.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},nt.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},nt.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},nt.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},nt.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},nt.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Ve.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},Ve.extend=function(){for(var T=[],Y=arguments.length;Y--;)T[Y]=arguments[Y];for(var D=this,ve=0;ve<T.length;ve++)D=T[ve](D);return D},Ve.parse=function(T,Y){return new this(Y,T).parse()},Ve.parseExpressionAt=function(T,Y,D){var ve=new this(D,T,Y);return ve.nextToken(),ve.parseExpression()},Ve.tokenizer=function(T,Y){return new this(Y,T)},Object.defineProperties(Ve.prototype,nt);var yt=Ve.prototype,Lt=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function Z(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}yt.strictDirective=function(m){for(;;){Xe.lastIndex=m,m+=Xe.exec(this.input)[0].length;var T=Lt.exec(this.input.slice(m));if(!T)return!1;if("use strict"===(T[1]||T[2])){Xe.lastIndex=m+T[0].length;var Y=Xe.exec(this.input),D=Y.index+Y[0].length,ve=this.input.charAt(D);return";"===ve||"}"===ve||Vt.test(Y[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(ve)||"!"===ve&&"="===this.input.charAt(D+1))}Xe.lastIndex=m+=T[0].length,m+=Xe.exec(this.input)[0].length,";"===this.input[m]&&m++}},yt.eat=function(m){return this.type===m&&(this.next(),!0)},yt.isContextual=function(m){return this.type===Q.name&&this.value===m&&!this.containsEsc},yt.eatContextual=function(m){return!!this.isContextual(m)&&(this.next(),!0)},yt.expectContextual=function(m){this.eatContextual(m)||this.unexpected()},yt.canInsertSemicolon=function(){return this.type===Q.eof||this.type===Q.braceR||Vt.test(this.input.slice(this.lastTokEnd,this.start))},yt.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},yt.semicolon=function(){!this.eat(Q.semi)&&!this.insertSemicolon()&&this.unexpected()},yt.afterTrailingComma=function(m,T){if(this.type===m)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),T||this.next(),!0},yt.expect=function(m){this.eat(m)||this.unexpected()},yt.unexpected=function(m){this.raise(null!=m?m:this.start,"Unexpected token")},yt.checkPatternErrors=function(m,T){if(m){m.trailingComma>-1&&this.raiseRecoverable(m.trailingComma,"Comma is not permitted after the rest element");var Y=T?m.parenthesizedAssign:m.parenthesizedBind;Y>-1&&this.raiseRecoverable(Y,"Parenthesized pattern")}},yt.checkExpressionErrors=function(m,T){if(!m)return!1;var Y=m.shorthandAssign,D=m.doubleProto;if(!T)return Y>=0||D>=0;Y>=0&&this.raise(Y,"Shorthand property assignments are valid only in destructuring patterns"),D>=0&&this.raiseRecoverable(D,"Redefinition of __proto__ property")},yt.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},yt.isSimpleAssignTarget=function(m){return"ParenthesizedExpression"===m.type?this.isSimpleAssignTarget(m.expression):"Identifier"===m.type||"MemberExpression"===m.type};var Ze=Ve.prototype;Ze.parseTopLevel=function(m){var T={};for(m.body||(m.body=[]);this.type!==Q.eof;){var Y=this.parseStatement(null,!0,T);m.body.push(Y)}if(this.inModule)for(var D=0,ve=Object.keys(this.undefinedExports);D<ve.length;D+=1){var Ne=ve[D];this.raiseRecoverable(this.undefinedExports[Ne].start,"Export '"+Ne+"' is not defined")}return this.adaptDirectivePrologue(m.body),this.next(),m.sourceType=this.options.sourceType,this.finishNode(m,"Program")};var St={kind:"loop"},It={kind:"switch"};Ze.isLet=function(m){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Xe.lastIndex=this.pos;var T=Xe.exec(this.input),Y=this.pos+T[0].length,D=this.input.charCodeAt(Y);if(91===D)return!0;if(m)return!1;if(123===D)return!0;if(W(D,!0)){for(var ve=Y+1;Ke(this.input.charCodeAt(ve),!0);)++ve;var Ne=this.input.slice(Y,ve);if(!O.test(Ne))return!0}return!1},Ze.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Xe.lastIndex=this.pos;var m=Xe.exec(this.input),T=this.pos+m[0].length;return!(Vt.test(this.input.slice(this.pos,T))||"function"!==this.input.slice(T,T+8)||T+8!==this.input.length&&Ke(this.input.charAt(T+8)))},Ze.parseStatement=function(m,T,Y){var Ne,D=this.type,ve=this.startNode();switch(this.isLet(m)&&(D=Q._var,Ne="let"),D){case Q._break:case Q._continue:return this.parseBreakContinueStatement(ve,D.keyword);case Q._debugger:return this.parseDebuggerStatement(ve);case Q._do:return this.parseDoStatement(ve);case Q._for:return this.parseForStatement(ve);case Q._function:return m&&(this.strict||"if"!==m&&"label"!==m)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(ve,!1,!m);case Q._class:return m&&this.unexpected(),this.parseClass(ve,!0);case Q._if:return this.parseIfStatement(ve);case Q._return:return this.parseReturnStatement(ve);case Q._switch:return this.parseSwitchStatement(ve);case Q._throw:return this.parseThrowStatement(ve);case Q._try:return this.parseTryStatement(ve);case Q._const:case Q._var:return Ne=Ne||this.value,m&&"var"!==Ne&&this.unexpected(),this.parseVarStatement(ve,Ne);case Q._while:return this.parseWhileStatement(ve);case Q._with:return this.parseWithStatement(ve);case Q.braceL:return this.parseBlock(!0,ve);case Q.semi:return this.parseEmptyStatement(ve);case Q._export:case Q._import:if(this.options.ecmaVersion>10&&D===Q._import){Xe.lastIndex=this.pos;var mt=Xe.exec(this.input),Ft=this.input.charCodeAt(this.pos+mt[0].length);if(40===Ft||46===Ft)return this.parseExpressionStatement(ve,this.parseExpression())}return this.options.allowImportExportEverywhere||(T||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),D===Q._import?this.parseImport(ve):this.parseExport(ve,Y);default:if(this.isAsyncFunction())return m&&this.unexpected(),this.next(),this.parseFunctionStatement(ve,!0,!m);var Or=this.value,zr=this.parseExpression();return D===Q.name&&"Identifier"===zr.type&&this.eat(Q.colon)?this.parseLabeledStatement(ve,Or,zr,m):this.parseExpressionStatement(ve,zr)}},Ze.parseBreakContinueStatement=function(m,T){var Y="break"===T;this.next(),this.eat(Q.semi)||this.insertSemicolon()?m.label=null:this.type!==Q.name?this.unexpected():(m.label=this.parseIdent(),this.semicolon());for(var D=0;D<this.labels.length;++D){var ve=this.labels[D];if((null==m.label||ve.name===m.label.name)&&(null!=ve.kind&&(Y||"loop"===ve.kind)||m.label&&Y))break}return D===this.labels.length&&this.raise(m.start,"Unsyntactic "+T),this.finishNode(m,Y?"BreakStatement":"ContinueStatement")},Ze.parseDebuggerStatement=function(m){return this.next(),this.semicolon(),this.finishNode(m,"DebuggerStatement")},Ze.parseDoStatement=function(m){return this.next(),this.labels.push(St),m.body=this.parseStatement("do"),this.labels.pop(),this.expect(Q._while),m.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(Q.semi):this.semicolon(),this.finishNode(m,"DoWhileStatement")},Ze.parseForStatement=function(m){this.next();var T=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(St),this.enterScope(0),this.expect(Q.parenL),this.type===Q.semi)return T>-1&&this.unexpected(T),this.parseFor(m,null);var Y=this.isLet();if(this.type===Q._var||this.type===Q._const||Y){var D=this.startNode(),ve=Y?"let":this.value;return this.next(),this.parseVar(D,!0,ve),this.finishNode(D,"VariableDeclaration"),(this.type===Q._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===D.declarations.length?(this.options.ecmaVersion>=9&&(this.type===Q._in?T>-1&&this.unexpected(T):m.await=T>-1),this.parseForIn(m,D)):(T>-1&&this.unexpected(T),this.parseFor(m,D))}var Ne=new Z,mt=this.parseExpression(!0,Ne);return this.type===Q._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===Q._in?T>-1&&this.unexpected(T):m.await=T>-1),this.toAssignable(mt,!1,Ne),this.checkLVal(mt),this.parseForIn(m,mt)):(this.checkExpressionErrors(Ne,!0),T>-1&&this.unexpected(T),this.parseFor(m,mt))},Ze.parseFunctionStatement=function(m,T,Y){return this.next(),this.parseFunction(m,Tr|(Y?0:vr),!1,T)},Ze.parseIfStatement=function(m){return this.next(),m.test=this.parseParenExpression(),m.consequent=this.parseStatement("if"),m.alternate=this.eat(Q._else)?this.parseStatement("if"):null,this.finishNode(m,"IfStatement")},Ze.parseReturnStatement=function(m){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(Q.semi)||this.insertSemicolon()?m.argument=null:(m.argument=this.parseExpression(),this.semicolon()),this.finishNode(m,"ReturnStatement")},Ze.parseSwitchStatement=function(m){this.next(),m.discriminant=this.parseParenExpression(),m.cases=[],this.expect(Q.braceL),this.labels.push(It),this.enterScope(0);for(var T,Y=!1;this.type!==Q.braceR;)if(this.type===Q._case||this.type===Q._default){var D=this.type===Q._case;T&&this.finishNode(T,"SwitchCase"),m.cases.push(T=this.startNode()),T.consequent=[],this.next(),D?T.test=this.parseExpression():(Y&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),Y=!0,T.test=null),this.expect(Q.colon)}else T||this.unexpected(),T.consequent.push(this.parseStatement(null));return this.exitScope(),T&&this.finishNode(T,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(m,"SwitchStatement")},Ze.parseThrowStatement=function(m){return this.next(),Vt.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),m.argument=this.parseExpression(),this.semicolon(),this.finishNode(m,"ThrowStatement")};var Jt=[];Ze.parseTryStatement=function(m){if(this.next(),m.block=this.parseBlock(),m.handler=null,this.type===Q._catch){var T=this.startNode();if(this.next(),this.eat(Q.parenL)){T.param=this.parseBindingAtom();var Y="Identifier"===T.param.type;this.enterScope(Y?32:0),this.checkLVal(T.param,Y?4:2),this.expect(Q.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),T.param=null,this.enterScope(0);T.body=this.parseBlock(!1),this.exitScope(),m.handler=this.finishNode(T,"CatchClause")}return m.finalizer=this.eat(Q._finally)?this.parseBlock():null,!m.handler&&!m.finalizer&&this.raise(m.start,"Missing catch or finally clause"),this.finishNode(m,"TryStatement")},Ze.parseVarStatement=function(m,T){return this.next(),this.parseVar(m,!1,T),this.semicolon(),this.finishNode(m,"VariableDeclaration")},Ze.parseWhileStatement=function(m){return this.next(),m.test=this.parseParenExpression(),this.labels.push(St),m.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(m,"WhileStatement")},Ze.parseWithStatement=function(m){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),m.object=this.parseParenExpression(),m.body=this.parseStatement("with"),this.finishNode(m,"WithStatement")},Ze.parseEmptyStatement=function(m){return this.next(),this.finishNode(m,"EmptyStatement")},Ze.parseLabeledStatement=function(m,T,Y,D){for(var ve=0,Ne=this.labels;ve<Ne.length;ve+=1)Ne[ve].name===T&&this.raise(Y.start,"Label '"+T+"' is already declared");for(var zt=this.type.isLoop?"loop":this.type===Q._switch?"switch":null,Ft=this.labels.length-1;Ft>=0;Ft--){var Or=this.labels[Ft];if(Or.statementStart!==m.start)break;Or.statementStart=this.start,Or.kind=zt}return this.labels.push({name:T,kind:zt,statementStart:this.start}),m.body=this.parseStatement(D?-1===D.indexOf("label")?D+"label":D:"label"),this.labels.pop(),m.label=Y,this.finishNode(m,"LabeledStatement")},Ze.parseExpressionStatement=function(m,T){return m.expression=T,this.semicolon(),this.finishNode(m,"ExpressionStatement")},Ze.parseBlock=function(m,T,Y){for(void 0===m&&(m=!0),void 0===T&&(T=this.startNode()),T.body=[],this.expect(Q.braceL),m&&this.enterScope(0);this.type!==Q.braceR;){var D=this.parseStatement(null);T.body.push(D)}return Y&&(this.strict=!1),this.next(),m&&this.exitScope(),this.finishNode(T,"BlockStatement")},Ze.parseFor=function(m,T){return m.init=T,this.expect(Q.semi),m.test=this.type===Q.semi?null:this.parseExpression(),this.expect(Q.semi),m.update=this.type===Q.parenR?null:this.parseExpression(),this.expect(Q.parenR),m.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(m,"ForStatement")},Ze.parseForIn=function(m,T){var Y=this.type===Q._in;return this.next(),"VariableDeclaration"===T.type&&null!=T.declarations[0].init&&(!Y||this.options.ecmaVersion<8||this.strict||"var"!==T.kind||"Identifier"!==T.declarations[0].id.type)?this.raise(T.start,(Y?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===T.type&&this.raise(T.start,"Invalid left-hand side in for-loop"),m.left=T,m.right=Y?this.parseExpression():this.parseMaybeAssign(),this.expect(Q.parenR),m.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(m,Y?"ForInStatement":"ForOfStatement")},Ze.parseVar=function(m,T,Y){for(m.declarations=[],m.kind=Y;;){var D=this.startNode();if(this.parseVarId(D,Y),this.eat(Q.eq)?D.init=this.parseMaybeAssign(T):"const"!==Y||this.type===Q._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===D.id.type||T&&(this.type===Q._in||this.isContextual("of"))?D.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),m.declarations.push(this.finishNode(D,"VariableDeclarator")),!this.eat(Q.comma))break}return m},Ze.parseVarId=function(m,T){m.id=this.parseBindingAtom(),this.checkLVal(m.id,"var"===T?1:2,!1)};var Tr=1,vr=2;Ze.parseFunction=function(m,T,Y,D){this.initFunction(m),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!D)&&(this.type===Q.star&&T&vr&&this.unexpected(),m.generator=this.eat(Q.star)),this.options.ecmaVersion>=8&&(m.async=!!D),T&Tr&&(m.id=4&T&&this.type!==Q.name?null:this.parseIdent(),m.id&&!(T&vr)&&this.checkLVal(m.id,this.strict||m.generator||m.async?this.treatFunctionsAsVar?1:2:3));var ve=this.yieldPos,Ne=this.awaitPos,mt=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Pr(m.async,m.generator)),T&Tr||(m.id=this.type===Q.name?this.parseIdent():null),this.parseFunctionParams(m),this.parseFunctionBody(m,Y,!1),this.yieldPos=ve,this.awaitPos=Ne,this.awaitIdentPos=mt,this.finishNode(m,T&Tr?"FunctionDeclaration":"FunctionExpression")},Ze.parseFunctionParams=function(m){this.expect(Q.parenL),m.params=this.parseBindingList(Q.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},Ze.parseClass=function(m,T){this.next();var Y=this.strict;this.strict=!0,this.parseClassId(m,T),this.parseClassSuper(m);var D=this.startNode(),ve=!1;for(D.body=[],this.expect(Q.braceL);this.type!==Q.braceR;){var Ne=this.parseClassElement(null!==m.superClass);Ne&&(D.body.push(Ne),"MethodDefinition"===Ne.type&&"constructor"===Ne.kind&&(ve&&this.raise(Ne.start,"Duplicate constructor in the same class"),ve=!0))}return this.strict=Y,this.next(),m.body=this.finishNode(D,"ClassBody"),this.finishNode(m,T?"ClassDeclaration":"ClassExpression")},Ze.parseClassElement=function(m){var T=this;if(this.eat(Q.semi))return null;var Y=this.startNode(),D=function(Ft,Or){void 0===Or&&(Or=!1);var zr=T.start,Jn=T.startLoc;return!(!T.eatContextual(Ft)||(T.type===Q.parenL||Or&&T.canInsertSemicolon())&&(Y.key&&T.unexpected(),Y.computed=!1,Y.key=T.startNodeAt(zr,Jn),Y.key.name=Ft,T.finishNode(Y.key,"Identifier"),1))};Y.kind="method",Y.static=D("static");var ve=this.eat(Q.star),Ne=!1;ve||(this.options.ecmaVersion>=8&&D("async",!0)?(Ne=!0,ve=this.options.ecmaVersion>=9&&this.eat(Q.star)):D("get")?Y.kind="get":D("set")&&(Y.kind="set")),Y.key||this.parsePropertyName(Y);var mt=Y.key,zt=!1;return Y.computed||Y.static||!("Identifier"===mt.type&&"constructor"===mt.name||"Literal"===mt.type&&"constructor"===mt.value)?Y.static&&"Identifier"===mt.type&&"prototype"===mt.name&&this.raise(mt.start,"Classes may not have a static property named prototype"):("method"!==Y.kind&&this.raise(mt.start,"Constructor can't have get/set modifier"),ve&&this.raise(mt.start,"Constructor can't be a generator"),Ne&&this.raise(mt.start,"Constructor can't be an async method"),Y.kind="constructor",zt=m),this.parseClassMethod(Y,ve,Ne,zt),"get"===Y.kind&&0!==Y.value.params.length&&this.raiseRecoverable(Y.value.start,"getter should have no params"),"set"===Y.kind&&1!==Y.value.params.length&&this.raiseRecoverable(Y.value.start,"setter should have exactly one param"),"set"===Y.kind&&"RestElement"===Y.value.params[0].type&&this.raiseRecoverable(Y.value.params[0].start,"Setter cannot use rest params"),Y},Ze.parseClassMethod=function(m,T,Y,D){return m.value=this.parseMethod(T,Y,D),this.finishNode(m,"MethodDefinition")},Ze.parseClassId=function(m,T){this.type===Q.name?(m.id=this.parseIdent(),T&&this.checkLVal(m.id,2,!1)):(!0===T&&this.unexpected(),m.id=null)},Ze.parseClassSuper=function(m){m.superClass=this.eat(Q._extends)?this.parseExprSubscripts():null},Ze.parseExport=function(m,T){if(this.next(),this.eat(Q.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(m.exported=this.parseIdent(!0),this.checkExport(T,m.exported.name,this.lastTokStart)):m.exported=null),this.expectContextual("from"),this.type!==Q.string&&this.unexpected(),m.source=this.parseExprAtom(),this.semicolon(),this.finishNode(m,"ExportAllDeclaration");if(this.eat(Q._default)){var Y;if(this.checkExport(T,"default",this.lastTokStart),this.type===Q._function||(Y=this.isAsyncFunction())){var D=this.startNode();this.next(),Y&&this.next(),m.declaration=this.parseFunction(D,4|Tr,!1,Y)}else if(this.type===Q._class){var ve=this.startNode();m.declaration=this.parseClass(ve,"nullableID")}else m.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(m,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())m.declaration=this.parseStatement(null),"VariableDeclaration"===m.declaration.type?this.checkVariableExport(T,m.declaration.declarations):this.checkExport(T,m.declaration.id.name,m.declaration.id.start),m.specifiers=[],m.source=null;else{if(m.declaration=null,m.specifiers=this.parseExportSpecifiers(T),this.eatContextual("from"))this.type!==Q.string&&this.unexpected(),m.source=this.parseExprAtom();else{for(var Ne=0,mt=m.specifiers;Ne<mt.length;Ne+=1){var zt=mt[Ne];this.checkUnreserved(zt.local),this.checkLocalExport(zt.local)}m.source=null}this.semicolon()}return this.finishNode(m,"ExportNamedDeclaration")},Ze.checkExport=function(m,T,Y){!m||(Er(m,T)&&this.raiseRecoverable(Y,"Duplicate export '"+T+"'"),m[T]=!0)},Ze.checkPatternExport=function(m,T){var Y=T.type;if("Identifier"===Y)this.checkExport(m,T.name,T.start);else if("ObjectPattern"===Y)for(var D=0,ve=T.properties;D<ve.length;D+=1)this.checkPatternExport(m,ve[D]);else if("ArrayPattern"===Y)for(var mt=0,zt=T.elements;mt<zt.length;mt+=1){var Ft=zt[mt];Ft&&this.checkPatternExport(m,Ft)}else"Property"===Y?this.checkPatternExport(m,T.value):"AssignmentPattern"===Y?this.checkPatternExport(m,T.left):"RestElement"===Y?this.checkPatternExport(m,T.argument):"ParenthesizedExpression"===Y&&this.checkPatternExport(m,T.expression)},Ze.checkVariableExport=function(m,T){if(m)for(var Y=0,D=T;Y<D.length;Y+=1)this.checkPatternExport(m,D[Y].id)},Ze.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},Ze.parseExportSpecifiers=function(m){var T=[],Y=!0;for(this.expect(Q.braceL);!this.eat(Q.braceR);){if(Y)Y=!1;else if(this.expect(Q.comma),this.afterTrailingComma(Q.braceR))break;var D=this.startNode();D.local=this.parseIdent(!0),D.exported=this.eatContextual("as")?this.parseIdent(!0):D.local,this.checkExport(m,D.exported.name,D.exported.start),T.push(this.finishNode(D,"ExportSpecifier"))}return T},Ze.parseImport=function(m){return this.next(),this.type===Q.string?(m.specifiers=Jt,m.source=this.parseExprAtom()):(m.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),m.source=this.type===Q.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(m,"ImportDeclaration")},Ze.parseImportSpecifiers=function(){var m=[],T=!0;if(this.type===Q.name){var Y=this.startNode();if(Y.local=this.parseIdent(),this.checkLVal(Y.local,2),m.push(this.finishNode(Y,"ImportDefaultSpecifier")),!this.eat(Q.comma))return m}if(this.type===Q.star){var D=this.startNode();return this.next(),this.expectContextual("as"),D.local=this.parseIdent(),this.checkLVal(D.local,2),m.push(this.finishNode(D,"ImportNamespaceSpecifier")),m}for(this.expect(Q.braceL);!this.eat(Q.braceR);){if(T)T=!1;else if(this.expect(Q.comma),this.afterTrailingComma(Q.braceR))break;var ve=this.startNode();ve.imported=this.parseIdent(!0),this.eatContextual("as")?ve.local=this.parseIdent():(this.checkUnreserved(ve.imported),ve.local=ve.imported),this.checkLVal(ve.local,2),m.push(this.finishNode(ve,"ImportSpecifier"))}return m},Ze.adaptDirectivePrologue=function(m){for(var T=0;T<m.length&&this.isDirectiveCandidate(m[T]);++T)m[T].directive=m[T].expression.raw.slice(1,-1)},Ze.isDirectiveCandidate=function(m){return"ExpressionStatement"===m.type&&"Literal"===m.expression.type&&"string"==typeof m.expression.value&&('"'===this.input[m.start]||"'"===this.input[m.start])};var mr=Ve.prototype;mr.toAssignable=function(m,T,Y){if(this.options.ecmaVersion>=6&&m)switch(m.type){case"Identifier":this.inAsync&&"await"===m.name&&this.raise(m.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":m.type="ObjectPattern",Y&&this.checkPatternErrors(Y,!0);for(var D=0,ve=m.properties;D<ve.length;D+=1){var Ne=ve[D];this.toAssignable(Ne,T),"RestElement"===Ne.type&&("ArrayPattern"===Ne.argument.type||"ObjectPattern"===Ne.argument.type)&&this.raise(Ne.argument.start,"Unexpected token")}break;case"Property":"init"!==m.kind&&this.raise(m.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(m.value,T);break;case"ArrayExpression":m.type="ArrayPattern",Y&&this.checkPatternErrors(Y,!0),this.toAssignableList(m.elements,T);break;case"SpreadElement":m.type="RestElement",this.toAssignable(m.argument,T),"AssignmentPattern"===m.argument.type&&this.raise(m.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==m.operator&&this.raise(m.left.end,"Only '=' operator can be used for specifying default value."),m.type="AssignmentPattern",delete m.operator,this.toAssignable(m.left,T);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(m.expression,T,Y);break;case"ChainExpression":this.raiseRecoverable(m.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!T)break;default:this.raise(m.start,"Assigning to rvalue")}else Y&&this.checkPatternErrors(Y,!0);return m},mr.toAssignableList=function(m,T){for(var Y=m.length,D=0;D<Y;D++){var ve=m[D];ve&&this.toAssignable(ve,T)}if(Y){var Ne=m[Y-1];6===this.options.ecmaVersion&&T&&Ne&&"RestElement"===Ne.type&&"Identifier"!==Ne.argument.type&&this.unexpected(Ne.argument.start)}return m},mr.parseSpread=function(m){var T=this.startNode();return this.next(),T.argument=this.parseMaybeAssign(!1,m),this.finishNode(T,"SpreadElement")},mr.parseRestBinding=function(){var m=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==Q.name&&this.unexpected(),m.argument=this.parseBindingAtom(),this.finishNode(m,"RestElement")},mr.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case Q.bracketL:var m=this.startNode();return this.next(),m.elements=this.parseBindingList(Q.bracketR,!0,!0),this.finishNode(m,"ArrayPattern");case Q.braceL:return this.parseObj(!0)}return this.parseIdent()},mr.parseBindingList=function(m,T,Y){for(var D=[],ve=!0;!this.eat(m);)if(ve?ve=!1:this.expect(Q.comma),T&&this.type===Q.comma)D.push(null);else{if(Y&&this.afterTrailingComma(m))break;if(this.type===Q.ellipsis){var Ne=this.parseRestBinding();this.parseBindingListItem(Ne),D.push(Ne),this.type===Q.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(m);break}var mt=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(mt),D.push(mt)}return D},mr.parseBindingListItem=function(m){return m},mr.parseMaybeDefault=function(m,T,Y){if(Y=Y||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(Q.eq))return Y;var D=this.startNodeAt(m,T);return D.left=Y,D.right=this.parseMaybeAssign(),this.finishNode(D,"AssignmentPattern")},mr.checkLVal=function(m,T,Y){switch(void 0===T&&(T=0),m.type){case"Identifier":2===T&&"let"===m.name&&this.raiseRecoverable(m.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(m.name)&&this.raiseRecoverable(m.start,(T?"Binding ":"Assigning to ")+m.name+" in strict mode"),Y&&(Er(Y,m.name)&&this.raiseRecoverable(m.start,"Argument name clash"),Y[m.name]=!0),0!==T&&5!==T&&this.declareName(m.name,T,m.start);break;case"ChainExpression":this.raiseRecoverable(m.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":T&&this.raiseRecoverable(m.start,"Binding member expression");break;case"ObjectPattern":for(var D=0,ve=m.properties;D<ve.length;D+=1)this.checkLVal(ve[D],T,Y);break;case"Property":this.checkLVal(m.value,T,Y);break;case"ArrayPattern":for(var mt=0,zt=m.elements;mt<zt.length;mt+=1){var Ft=zt[mt];Ft&&this.checkLVal(Ft,T,Y)}break;case"AssignmentPattern":this.checkLVal(m.left,T,Y);break;case"RestElement":this.checkLVal(m.argument,T,Y);break;case"ParenthesizedExpression":this.checkLVal(m.expression,T,Y);break;default:this.raise(m.start,(T?"Binding":"Assigning to")+" rvalue")}};var or=Ve.prototype;or.checkPropClash=function(m,T,Y){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===m.type||this.options.ecmaVersion>=6&&(m.computed||m.method||m.shorthand))){var ve,D=m.key;switch(D.type){case"Identifier":ve=D.name;break;case"Literal":ve=String(D.value);break;default:return}var Ne=m.kind;if(this.options.ecmaVersion>=6)return void("__proto__"===ve&&"init"===Ne&&(T.proto&&(Y?Y.doubleProto<0&&(Y.doubleProto=D.start):this.raiseRecoverable(D.start,"Redefinition of __proto__ property")),T.proto=!0));var mt=T[ve="$"+ve];mt?("init"===Ne?this.strict&&mt.init||mt.get||mt.set:mt.init||mt[Ne])&&this.raiseRecoverable(D.start,"Redefinition of property"):mt=T[ve]={init:!1,get:!1,set:!1},mt[Ne]=!0}},or.parseExpression=function(m,T){var Y=this.start,D=this.startLoc,ve=this.parseMaybeAssign(m,T);if(this.type===Q.comma){var Ne=this.startNodeAt(Y,D);for(Ne.expressions=[ve];this.eat(Q.comma);)Ne.expressions.push(this.parseMaybeAssign(m,T));return this.finishNode(Ne,"SequenceExpression")}return ve},or.parseMaybeAssign=function(m,T,Y){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(m);this.exprAllowed=!1}var D=!1,ve=-1,Ne=-1;T?(ve=T.parenthesizedAssign,Ne=T.trailingComma,T.parenthesizedAssign=T.trailingComma=-1):(T=new Z,D=!0);var mt=this.start,zt=this.startLoc;(this.type===Q.parenL||this.type===Q.name)&&(this.potentialArrowAt=this.start);var Ft=this.parseMaybeConditional(m,T);if(Y&&(Ft=Y.call(this,Ft,mt,zt)),this.type.isAssign){var Or=this.startNodeAt(mt,zt);return Or.operator=this.value,Or.left=this.type===Q.eq?this.toAssignable(Ft,!1,T):Ft,D||(T.parenthesizedAssign=T.trailingComma=T.doubleProto=-1),T.shorthandAssign>=Or.left.start&&(T.shorthandAssign=-1),this.checkLVal(Ft),this.next(),Or.right=this.parseMaybeAssign(m),this.finishNode(Or,"AssignmentExpression")}return D&&this.checkExpressionErrors(T,!0),ve>-1&&(T.parenthesizedAssign=ve),Ne>-1&&(T.trailingComma=Ne),Ft},or.parseMaybeConditional=function(m,T){var Y=this.start,D=this.startLoc,ve=this.parseExprOps(m,T);if(this.checkExpressionErrors(T))return ve;if(this.eat(Q.question)){var Ne=this.startNodeAt(Y,D);return Ne.test=ve,Ne.consequent=this.parseMaybeAssign(),this.expect(Q.colon),Ne.alternate=this.parseMaybeAssign(m),this.finishNode(Ne,"ConditionalExpression")}return ve},or.parseExprOps=function(m,T){var Y=this.start,D=this.startLoc,ve=this.parseMaybeUnary(T,!1);return this.checkExpressionErrors(T)||ve.start===Y&&"ArrowFunctionExpression"===ve.type?ve:this.parseExprOp(ve,Y,D,-1,m)},or.parseExprOp=function(m,T,Y,D,ve){var Ne=this.type.binop;if(null!=Ne&&(!ve||this.type!==Q._in)&&Ne>D){var mt=this.type===Q.logicalOR||this.type===Q.logicalAND,zt=this.type===Q.coalesce;zt&&(Ne=Q.logicalAND.binop);var Ft=this.value;this.next();var Or=this.start,zr=this.startLoc,Jn=this.parseExprOp(this.parseMaybeUnary(null,!1),Or,zr,Ne,ve),bi=this.buildBinary(T,Y,m,Jn,Ft,mt||zt);return(mt&&this.type===Q.coalesce||zt&&(this.type===Q.logicalOR||this.type===Q.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(bi,T,Y,D,ve)}return m},or.buildBinary=function(m,T,Y,D,ve,Ne){var mt=this.startNodeAt(m,T);return mt.left=Y,mt.operator=ve,mt.right=D,this.finishNode(mt,Ne?"LogicalExpression":"BinaryExpression")},or.parseMaybeUnary=function(m,T){var ve,Y=this.start,D=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))ve=this.parseAwait(),T=!0;else if(this.type.prefix){var Ne=this.startNode(),mt=this.type===Q.incDec;Ne.operator=this.value,Ne.prefix=!0,this.next(),Ne.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(m,!0),mt?this.checkLVal(Ne.argument):this.strict&&"delete"===Ne.operator&&"Identifier"===Ne.argument.type?this.raiseRecoverable(Ne.start,"Deleting local variable in strict mode"):T=!0,ve=this.finishNode(Ne,mt?"UpdateExpression":"UnaryExpression")}else{if(ve=this.parseExprSubscripts(m),this.checkExpressionErrors(m))return ve;for(;this.type.postfix&&!this.canInsertSemicolon();){var zt=this.startNodeAt(Y,D);zt.operator=this.value,zt.prefix=!1,zt.argument=ve,this.checkLVal(ve),this.next(),ve=this.finishNode(zt,"UpdateExpression")}}return!T&&this.eat(Q.starstar)?this.buildBinary(Y,D,ve,this.parseMaybeUnary(null,!1),"**",!1):ve},or.parseExprSubscripts=function(m){var T=this.start,Y=this.startLoc,D=this.parseExprAtom(m);if("ArrowFunctionExpression"===D.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return D;var ve=this.parseSubscripts(D,T,Y);return m&&"MemberExpression"===ve.type&&(m.parenthesizedAssign>=ve.start&&(m.parenthesizedAssign=-1),m.parenthesizedBind>=ve.start&&(m.parenthesizedBind=-1)),ve},or.parseSubscripts=function(m,T,Y,D){for(var ve=this.options.ecmaVersion>=8&&"Identifier"===m.type&&"async"===m.name&&this.lastTokEnd===m.end&&!this.canInsertSemicolon()&&m.end-m.start==5&&this.potentialArrowAt===m.start,Ne=!1;;){var mt=this.parseSubscript(m,T,Y,D,ve,Ne);if(mt.optional&&(Ne=!0),mt===m||"ArrowFunctionExpression"===mt.type){if(Ne){var zt=this.startNodeAt(T,Y);zt.expression=mt,mt=this.finishNode(zt,"ChainExpression")}return mt}m=mt}},or.parseSubscript=function(m,T,Y,D,ve,Ne){var mt=this.options.ecmaVersion>=11,zt=mt&&this.eat(Q.questionDot);D&&zt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var Ft=this.eat(Q.bracketL);if(Ft||zt&&this.type!==Q.parenL&&this.type!==Q.backQuote||this.eat(Q.dot)){var Or=this.startNodeAt(T,Y);Or.object=m,Or.property=Ft?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),Or.computed=!!Ft,Ft&&this.expect(Q.bracketR),mt&&(Or.optional=zt),m=this.finishNode(Or,"MemberExpression")}else if(!D&&this.eat(Q.parenL)){var zr=new Z,Jn=this.yieldPos,bi=this.awaitPos,pi=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var oa=this.parseExprList(Q.parenR,this.options.ecmaVersion>=8,!1,zr);if(ve&&!zt&&!this.canInsertSemicolon()&&this.eat(Q.arrow))return this.checkPatternErrors(zr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Jn,this.awaitPos=bi,this.awaitIdentPos=pi,this.parseArrowExpression(this.startNodeAt(T,Y),oa,!0);this.checkExpressionErrors(zr,!0),this.yieldPos=Jn||this.yieldPos,this.awaitPos=bi||this.awaitPos,this.awaitIdentPos=pi||this.awaitIdentPos;var Ea=this.startNodeAt(T,Y);Ea.callee=m,Ea.arguments=oa,mt&&(Ea.optional=zt),m=this.finishNode(Ea,"CallExpression")}else if(this.type===Q.backQuote){(zt||Ne)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Na=this.startNodeAt(T,Y);Na.tag=m,Na.quasi=this.parseTemplate({isTagged:!0}),m=this.finishNode(Na,"TaggedTemplateExpression")}return m},or.parseExprAtom=function(m){this.type===Q.slash&&this.readRegexp();var T,Y=this.potentialArrowAt===this.start;switch(this.type){case Q._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),T=this.startNode(),this.next(),this.type===Q.parenL&&!this.allowDirectSuper&&this.raise(T.start,"super() call outside constructor of a subclass"),this.type!==Q.dot&&this.type!==Q.bracketL&&this.type!==Q.parenL&&this.unexpected(),this.finishNode(T,"Super");case Q._this:return T=this.startNode(),this.next(),this.finishNode(T,"ThisExpression");case Q.name:var D=this.start,ve=this.startLoc,Ne=this.containsEsc,mt=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!Ne&&"async"===mt.name&&!this.canInsertSemicolon()&&this.eat(Q._function))return this.parseFunction(this.startNodeAt(D,ve),0,!1,!0);if(Y&&!this.canInsertSemicolon()){if(this.eat(Q.arrow))return this.parseArrowExpression(this.startNodeAt(D,ve),[mt],!1);if(this.options.ecmaVersion>=8&&"async"===mt.name&&this.type===Q.name&&!Ne)return mt=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(Q.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(D,ve),[mt],!0)}return mt;case Q.regexp:var zt=this.value;return(T=this.parseLiteral(zt.value)).regex={pattern:zt.pattern,flags:zt.flags},T;case Q.num:case Q.string:return this.parseLiteral(this.value);case Q._null:case Q._true:case Q._false:return(T=this.startNode()).value=this.type===Q._null?null:this.type===Q._true,T.raw=this.type.keyword,this.next(),this.finishNode(T,"Literal");case Q.parenL:var Ft=this.start,Or=this.parseParenAndDistinguishExpression(Y);return m&&(m.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Or)&&(m.parenthesizedAssign=Ft),m.parenthesizedBind<0&&(m.parenthesizedBind=Ft)),Or;case Q.bracketL:return T=this.startNode(),this.next(),T.elements=this.parseExprList(Q.bracketR,!0,!0,m),this.finishNode(T,"ArrayExpression");case Q.braceL:return this.parseObj(!1,m);case Q._function:return T=this.startNode(),this.next(),this.parseFunction(T,0);case Q._class:return this.parseClass(this.startNode(),!1);case Q._new:return this.parseNew();case Q.backQuote:return this.parseTemplate();case Q._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},or.parseExprImport=function(){var m=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var T=this.parseIdent(!0);switch(this.type){case Q.parenL:return this.parseDynamicImport(m);case Q.dot:return m.meta=T,this.parseImportMeta(m);default:this.unexpected()}},or.parseDynamicImport=function(m){if(this.next(),m.source=this.parseMaybeAssign(),!this.eat(Q.parenR)){var T=this.start;this.eat(Q.comma)&&this.eat(Q.parenR)?this.raiseRecoverable(T,"Trailing comma is not allowed in import()"):this.unexpected(T)}return this.finishNode(m,"ImportExpression")},or.parseImportMeta=function(m){this.next();var T=this.containsEsc;return m.property=this.parseIdent(!0),"meta"!==m.property.name&&this.raiseRecoverable(m.property.start,"The only valid meta property for import is 'import.meta'"),T&&this.raiseRecoverable(m.start,"'import.meta' must not contain escaped characters"),"module"!==this.options.sourceType&&this.raiseRecoverable(m.start,"Cannot use 'import.meta' outside a module"),this.finishNode(m,"MetaProperty")},or.parseLiteral=function(m){var T=this.startNode();return T.value=m,T.raw=this.input.slice(this.start,this.end),110===T.raw.charCodeAt(T.raw.length-1)&&(T.bigint=T.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(T,"Literal")},or.parseParenExpression=function(){this.expect(Q.parenL);var m=this.parseExpression();return this.expect(Q.parenR),m},or.parseParenAndDistinguishExpression=function(m){var D,T=this.start,Y=this.startLoc,ve=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var pi,Ne=this.start,mt=this.startLoc,zt=[],Ft=!0,Or=!1,zr=new Z,Jn=this.yieldPos,bi=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==Q.parenR;){if(Ft?Ft=!1:this.expect(Q.comma),ve&&this.afterTrailingComma(Q.parenR,!0)){Or=!0;break}if(this.type===Q.ellipsis){pi=this.start,zt.push(this.parseParenItem(this.parseRestBinding())),this.type===Q.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}zt.push(this.parseMaybeAssign(!1,zr,this.parseParenItem))}var oa=this.start,Ea=this.startLoc;if(this.expect(Q.parenR),m&&!this.canInsertSemicolon()&&this.eat(Q.arrow))return this.checkPatternErrors(zr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Jn,this.awaitPos=bi,this.parseParenArrowList(T,Y,zt);(!zt.length||Or)&&this.unexpected(this.lastTokStart),pi&&this.unexpected(pi),this.checkExpressionErrors(zr,!0),this.yieldPos=Jn||this.yieldPos,this.awaitPos=bi||this.awaitPos,zt.length>1?((D=this.startNodeAt(Ne,mt)).expressions=zt,this.finishNodeAt(D,"SequenceExpression",oa,Ea)):D=zt[0]}else D=this.parseParenExpression();if(this.options.preserveParens){var Na=this.startNodeAt(T,Y);return Na.expression=D,this.finishNode(Na,"ParenthesizedExpression")}return D},or.parseParenItem=function(m){return m},or.parseParenArrowList=function(m,T,Y){return this.parseArrowExpression(this.startNodeAt(m,T),Y)};var pr=[];or.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var m=this.startNode(),T=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(Q.dot)){m.meta=T;var Y=this.containsEsc;return m.property=this.parseIdent(!0),"target"!==m.property.name&&this.raiseRecoverable(m.property.start,"The only valid meta property for new is 'new.target'"),Y&&this.raiseRecoverable(m.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(m.start,"'new.target' can only be used in functions"),this.finishNode(m,"MetaProperty")}var D=this.start,ve=this.startLoc,Ne=this.type===Q._import;return m.callee=this.parseSubscripts(this.parseExprAtom(),D,ve,!0),Ne&&"ImportExpression"===m.callee.type&&this.raise(D,"Cannot use new with import()"),m.arguments=this.eat(Q.parenL)?this.parseExprList(Q.parenR,this.options.ecmaVersion>=8,!1):pr,this.finishNode(m,"NewExpression")},or.parseTemplateElement=function(m){var T=m.isTagged,Y=this.startNode();return this.type===Q.invalidTemplate?(T||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),Y.value={raw:this.value,cooked:null}):Y.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),Y.tail=this.type===Q.backQuote,this.finishNode(Y,"TemplateElement")},or.parseTemplate=function(m){void 0===m&&(m={});var T=m.isTagged;void 0===T&&(T=!1);var Y=this.startNode();this.next(),Y.expressions=[];var D=this.parseTemplateElement({isTagged:T});for(Y.quasis=[D];!D.tail;)this.type===Q.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(Q.dollarBraceL),Y.expressions.push(this.parseExpression()),this.expect(Q.braceR),Y.quasis.push(D=this.parseTemplateElement({isTagged:T}));return this.next(),this.finishNode(Y,"TemplateLiteral")},or.isAsyncProp=function(m){return!m.computed&&"Identifier"===m.key.type&&"async"===m.key.name&&(this.type===Q.name||this.type===Q.num||this.type===Q.string||this.type===Q.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===Q.star)&&!Vt.test(this.input.slice(this.lastTokEnd,this.start))},or.parseObj=function(m,T){var Y=this.startNode(),D=!0,ve={};for(Y.properties=[],this.next();!this.eat(Q.braceR);){if(D)D=!1;else if(this.expect(Q.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(Q.braceR))break;var Ne=this.parseProperty(m,T);m||this.checkPropClash(Ne,ve,T),Y.properties.push(Ne)}return this.finishNode(Y,m?"ObjectPattern":"ObjectExpression")},or.parseProperty=function(m,T){var D,ve,Ne,mt,Y=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(Q.ellipsis))return m?(Y.argument=this.parseIdent(!1),this.type===Q.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(Y,"RestElement")):(this.type===Q.parenL&&T&&(T.parenthesizedAssign<0&&(T.parenthesizedAssign=this.start),T.parenthesizedBind<0&&(T.parenthesizedBind=this.start)),Y.argument=this.parseMaybeAssign(!1,T),this.type===Q.comma&&T&&T.trailingComma<0&&(T.trailingComma=this.start),this.finishNode(Y,"SpreadElement"));this.options.ecmaVersion>=6&&(Y.method=!1,Y.shorthand=!1,(m||T)&&(Ne=this.start,mt=this.startLoc),m||(D=this.eat(Q.star)));var zt=this.containsEsc;return this.parsePropertyName(Y),!m&&!zt&&this.options.ecmaVersion>=8&&!D&&this.isAsyncProp(Y)?(ve=!0,D=this.options.ecmaVersion>=9&&this.eat(Q.star),this.parsePropertyName(Y,T)):ve=!1,this.parsePropertyValue(Y,m,D,ve,Ne,mt,T,zt),this.finishNode(Y,"Property")},or.parsePropertyValue=function(m,T,Y,D,ve,Ne,mt,zt){if((Y||D)&&this.type===Q.colon&&this.unexpected(),this.eat(Q.colon))m.value=T?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,mt),m.kind="init";else if(this.options.ecmaVersion>=6&&this.type===Q.parenL)T&&this.unexpected(),m.kind="init",m.method=!0,m.value=this.parseMethod(Y,D);else if(T||zt||!(this.options.ecmaVersion>=5)||m.computed||"Identifier"!==m.key.type||"get"!==m.key.name&&"set"!==m.key.name||this.type===Q.comma||this.type===Q.braceR||this.type===Q.eq)this.options.ecmaVersion>=6&&!m.computed&&"Identifier"===m.key.type?((Y||D)&&this.unexpected(),this.checkUnreserved(m.key),"await"===m.key.name&&!this.awaitIdentPos&&(this.awaitIdentPos=ve),m.kind="init",T?m.value=this.parseMaybeDefault(ve,Ne,m.key):this.type===Q.eq&&mt?(mt.shorthandAssign<0&&(mt.shorthandAssign=this.start),m.value=this.parseMaybeDefault(ve,Ne,m.key)):m.value=m.key,m.shorthand=!0):this.unexpected();else{if((Y||D)&&this.unexpected(),m.kind=m.key.name,this.parsePropertyName(m),m.value=this.parseMethod(!1),m.value.params.length!==("get"===m.kind?0:1))this.raiseRecoverable(m.value.start,"get"===m.kind?"getter should have no params":"setter should have exactly one param");else"set"===m.kind&&"RestElement"===m.value.params[0].type&&this.raiseRecoverable(m.value.params[0].start,"Setter cannot use rest params")}},or.parsePropertyName=function(m){if(this.options.ecmaVersion>=6){if(this.eat(Q.bracketL))return m.computed=!0,m.key=this.parseMaybeAssign(),this.expect(Q.bracketR),m.key;m.computed=!1}return m.key=this.type===Q.num||this.type===Q.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},or.initFunction=function(m){m.id=null,this.options.ecmaVersion>=6&&(m.generator=m.expression=!1),this.options.ecmaVersion>=8&&(m.async=!1)},or.parseMethod=function(m,T,Y){var D=this.startNode(),ve=this.yieldPos,Ne=this.awaitPos,mt=this.awaitIdentPos;return this.initFunction(D),this.options.ecmaVersion>=6&&(D.generator=m),this.options.ecmaVersion>=8&&(D.async=!!T),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|Pr(T,D.generator)|(Y?128:0)),this.expect(Q.parenL),D.params=this.parseBindingList(Q.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(D,!1,!0),this.yieldPos=ve,this.awaitPos=Ne,this.awaitIdentPos=mt,this.finishNode(D,"FunctionExpression")},or.parseArrowExpression=function(m,T,Y){var D=this.yieldPos,ve=this.awaitPos,Ne=this.awaitIdentPos;return this.enterScope(16|Pr(Y,!1)),this.initFunction(m),this.options.ecmaVersion>=8&&(m.async=!!Y),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,m.params=this.toAssignableList(T,!0),this.parseFunctionBody(m,!0,!1),this.yieldPos=D,this.awaitPos=ve,this.awaitIdentPos=Ne,this.finishNode(m,"ArrowFunctionExpression")},or.parseFunctionBody=function(m,T,Y){var ve=this.strict,Ne=!1;if(T&&this.type!==Q.braceL)m.body=this.parseMaybeAssign(),m.expression=!0,this.checkParams(m,!1);else{var mt=this.options.ecmaVersion>=7&&!this.isSimpleParamList(m.params);(!ve||mt)&&(Ne=this.strictDirective(this.end))&&mt&&this.raiseRecoverable(m.start,"Illegal 'use strict' directive in function with non-simple parameter list");var zt=this.labels;this.labels=[],Ne&&(this.strict=!0),this.checkParams(m,!ve&&!Ne&&!T&&!Y&&this.isSimpleParamList(m.params)),this.strict&&m.id&&this.checkLVal(m.id,5),m.body=this.parseBlock(!1,void 0,Ne&&!ve),m.expression=!1,this.adaptDirectivePrologue(m.body.body),this.labels=zt}this.exitScope()},or.isSimpleParamList=function(m){for(var T=0,Y=m;T<Y.length;T+=1)if("Identifier"!==Y[T].type)return!1;return!0},or.checkParams=function(m,T){for(var Y={},D=0,ve=m.params;D<ve.length;D+=1)this.checkLVal(ve[D],1,T?null:Y)},or.parseExprList=function(m,T,Y,D){for(var ve=[],Ne=!0;!this.eat(m);){if(Ne)Ne=!1;else if(this.expect(Q.comma),T&&this.afterTrailingComma(m))break;var mt=void 0;Y&&this.type===Q.comma?mt=null:this.type===Q.ellipsis?(mt=this.parseSpread(D),D&&this.type===Q.comma&&D.trailingComma<0&&(D.trailingComma=this.start)):mt=this.parseMaybeAssign(!1,D),ve.push(mt)}return ve},or.checkUnreserved=function(m){var T=m.start,Y=m.end,D=m.name;this.inGenerator&&"yield"===D&&this.raiseRecoverable(T,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===D&&this.raiseRecoverable(T,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(D)&&this.raise(T,"Unexpected keyword '"+D+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(T,Y).indexOf("\\")||(this.strict?this.reservedWordsStrict:this.reservedWords).test(D)&&(!this.inAsync&&"await"===D&&this.raiseRecoverable(T,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(T,"The keyword '"+D+"' is reserved"))},or.parseIdent=function(m,T){var Y=this.startNode();return this.type===Q.name?Y.name=this.value:this.type.keyword?(Y.name=this.type.keyword,("class"===Y.name||"function"===Y.name)&&(this.lastTokEnd!==this.lastTokStart+1||46!==this.input.charCodeAt(this.lastTokStart))&&this.context.pop()):this.unexpected(),this.next(!!m),this.finishNode(Y,"Identifier"),m||(this.checkUnreserved(Y),"await"===Y.name&&!this.awaitIdentPos&&(this.awaitIdentPos=Y.start)),Y},or.parseYield=function(m){this.yieldPos||(this.yieldPos=this.start);var T=this.startNode();return this.next(),this.type===Q.semi||this.canInsertSemicolon()||this.type!==Q.star&&!this.type.startsExpr?(T.delegate=!1,T.argument=null):(T.delegate=this.eat(Q.star),T.argument=this.parseMaybeAssign(m)),this.finishNode(T,"YieldExpression")},or.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var m=this.startNode();return this.next(),m.argument=this.parseMaybeUnary(null,!1),this.finishNode(m,"AwaitExpression")};var mn=Ve.prototype;mn.raise=function(m,T){var Y=Me(this.input,m),D=new SyntaxError(T+=" ("+Y.line+":"+Y.column+")");throw D.pos=m,D.loc=Y,D.raisedAt=this.pos,D},mn.raiseRecoverable=mn.raise,mn.curPosition=function(){if(this.options.locations)return new oe(this.curLine,this.pos-this.lineStart)};var On=Ve.prototype,mi=function(T){this.flags=T,this.var=[],this.lexical=[],this.functions=[]};On.enterScope=function(m){this.scopeStack.push(new mi(m))},On.exitScope=function(){this.scopeStack.pop()},On.treatFunctionsAsVarInScope=function(m){return 2&m.flags||!this.inModule&&1&m.flags},On.declareName=function(m,T,Y){var D=!1;if(2===T){var ve=this.currentScope();D=ve.lexical.indexOf(m)>-1||ve.functions.indexOf(m)>-1||ve.var.indexOf(m)>-1,ve.lexical.push(m),this.inModule&&1&ve.flags&&delete this.undefinedExports[m]}else if(4===T)this.currentScope().lexical.push(m);else if(3===T){var mt=this.currentScope();D=this.treatFunctionsAsVar?mt.lexical.indexOf(m)>-1:mt.lexical.indexOf(m)>-1||mt.var.indexOf(m)>-1,mt.functions.push(m)}else for(var zt=this.scopeStack.length-1;zt>=0;--zt){var Ft=this.scopeStack[zt];if(Ft.lexical.indexOf(m)>-1&&!(32&Ft.flags&&Ft.lexical[0]===m)||!this.treatFunctionsAsVarInScope(Ft)&&Ft.functions.indexOf(m)>-1){D=!0;break}if(Ft.var.push(m),this.inModule&&1&Ft.flags&&delete this.undefinedExports[m],3&Ft.flags)break}D&&this.raiseRecoverable(Y,"Identifier '"+m+"' has already been declared")},On.checkLocalExport=function(m){-1===this.scopeStack[0].lexical.indexOf(m.name)&&-1===this.scopeStack[0].var.indexOf(m.name)&&(this.undefinedExports[m.name]=m)},On.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},On.currentVarScope=function(){for(var m=this.scopeStack.length-1;;m--){var T=this.scopeStack[m];if(3&T.flags)return T}},On.currentThisScope=function(){for(var m=this.scopeStack.length-1;;m--){var T=this.scopeStack[m];if(3&T.flags&&!(16&T.flags))return T}};var hi=function(T,Y,D){this.type="",this.start=Y,this.end=0,T.options.locations&&(this.loc=new me(T,D)),T.options.directSourceFile&&(this.sourceFile=T.options.directSourceFile),T.options.ranges&&(this.range=[Y,0])},si=Ve.prototype;function ai(m,T,Y,D){return m.type=T,m.end=Y,this.options.locations&&(m.loc.end=D),this.options.ranges&&(m.range[1]=Y),m}si.startNode=function(){return new hi(this,this.start,this.startLoc)},si.startNodeAt=function(m,T){return new hi(this,m,T)},si.finishNode=function(m,T){return ai.call(this,m,T,this.lastTokEnd,this.lastTokEndLoc)},si.finishNodeAt=function(m,T,Y,D){return ai.call(this,m,T,Y,D)};var Ki=function(T,Y,D,ve,Ne){this.token=T,this.isExpr=!!Y,this.preserveSpace=!!D,this.override=ve,this.generator=!!Ne},Pi={b_stat:new Ki("{",!1),b_expr:new Ki("{",!0),b_tmpl:new Ki("${",!1),p_stat:new Ki("(",!1),p_expr:new Ki("(",!0),q_tmpl:new Ki("`",!0,!0,function(m){return m.tryReadTemplateToken()}),f_stat:new Ki("function",!1),f_expr:new Ki("function",!0),f_expr_gen:new Ki("function",!0,!1,null,!0),f_gen:new Ki("function",!1,!1,null,!0)},Ei=Ve.prototype;Ei.initialContext=function(){return[Pi.b_stat]},Ei.braceIsBlock=function(m){var T=this.curContext();return T===Pi.f_expr||T===Pi.f_stat||(m!==Q.colon||T!==Pi.b_stat&&T!==Pi.b_expr?m===Q._return||m===Q.name&&this.exprAllowed?Vt.test(this.input.slice(this.lastTokEnd,this.start)):m===Q._else||m===Q.semi||m===Q.eof||m===Q.parenR||m===Q.arrow||(m===Q.braceL?T===Pi.b_stat:m!==Q._var&&m!==Q._const&&m!==Q.name&&!this.exprAllowed):!T.isExpr)},Ei.inGeneratorContext=function(){for(var m=this.context.length-1;m>=1;m--){var T=this.context[m];if("function"===T.token)return T.generator}return!1},Ei.updateContext=function(m){var T,Y=this.type;Y.keyword&&m===Q.dot?this.exprAllowed=!1:(T=Y.updateContext)?T.call(this,m):this.exprAllowed=Y.beforeExpr},Q.parenR.updateContext=Q.braceR.updateContext=function(){if(1!==this.context.length){var m=this.context.pop();m===Pi.b_stat&&"function"===this.curContext().token&&(m=this.context.pop()),this.exprAllowed=!m.isExpr}else this.exprAllowed=!0},Q.braceL.updateContext=function(m){this.context.push(this.braceIsBlock(m)?Pi.b_stat:Pi.b_expr),this.exprAllowed=!0},Q.dollarBraceL.updateContext=function(){this.context.push(Pi.b_tmpl),this.exprAllowed=!0},Q.parenL.updateContext=function(m){this.context.push(m===Q._if||m===Q._for||m===Q._with||m===Q._while?Pi.p_stat:Pi.p_expr),this.exprAllowed=!0},Q.incDec.updateContext=function(){},Q._function.updateContext=Q._class.updateContext=function(m){!m.beforeExpr||m===Q.semi||m===Q._else||m===Q._return&&Vt.test(this.input.slice(this.lastTokEnd,this.start))||(m===Q.colon||m===Q.braceL)&&this.curContext()===Pi.b_stat?this.context.push(Pi.f_stat):this.context.push(Pi.f_expr),this.exprAllowed=!1},Q.backQuote.updateContext=function(){this.curContext()===Pi.q_tmpl?this.context.pop():this.context.push(Pi.q_tmpl),this.exprAllowed=!1},Q.star.updateContext=function(m){if(m===Q._function){var T=this.context.length-1;this.context[T]=this.context[T]===Pi.f_expr?Pi.f_expr_gen:Pi.f_gen}this.exprAllowed=!0},Q.name.updateContext=function(m){var T=!1;this.options.ecmaVersion>=6&&m!==Q.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(T=!0),this.exprAllowed=T};var re="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",V={9:re,10:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic",11:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic"},ae="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",xe="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Ae={9:xe,10:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",11:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},wt={};function Sr(m){var T=wt[m]={binary:de(V[m]+" "+ae),nonBinary:{General_Category:de(ae),Script:de(Ae[m])}};T.nonBinary.Script_Extensions=T.nonBinary.Script,T.nonBinary.gc=T.nonBinary.General_Category,T.nonBinary.sc=T.nonBinary.Script,T.nonBinary.scx=T.nonBinary.Script_Extensions}Sr(9),Sr(10),Sr(11);var Kt=Ve.prototype,ir=function(T){this.parser=T,this.validFlags="gim"+(T.options.ecmaVersion>=6?"uy":"")+(T.options.ecmaVersion>=9?"s":""),this.unicodeProperties=wt[T.options.ecmaVersion>=11?11:T.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function Fr(m){return m<=65535?String.fromCharCode(m):(m-=65536,String.fromCharCode(55296+(m>>10),56320+(1023&m)))}function Rn(m){return 36===m||m>=40&&m<=43||46===m||63===m||m>=91&&m<=94||m>=123&&m<=125}function Sn(m){return m>=65&&m<=90||m>=97&&m<=122}function Di(m){return Sn(m)||95===m}function _n(m){return Di(m)||Oi(m)}function Oi(m){return m>=48&&m<=57}function ta(m){return m>=48&&m<=57||m>=65&&m<=70||m>=97&&m<=102}function oi(m){return m>=65&&m<=70?m-65+10:m>=97&&m<=102?m-97+10:m-48}function Ji(m){return m>=48&&m<=55}ir.prototype.reset=function(T,Y,D){var ve=-1!==D.indexOf("u");this.start=0|T,this.source=Y+"",this.flags=D,this.switchU=ve&&this.parser.options.ecmaVersion>=6,this.switchN=ve&&this.parser.options.ecmaVersion>=9},ir.prototype.raise=function(T){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+T)},ir.prototype.at=function(T,Y){void 0===Y&&(Y=!1);var D=this.source,ve=D.length;if(T>=ve)return-1;var Ne=D.charCodeAt(T);if(!Y&&!this.switchU||Ne<=55295||Ne>=57344||T+1>=ve)return Ne;var mt=D.charCodeAt(T+1);return mt>=56320&&mt<=57343?(Ne<<10)+mt-56613888:Ne},ir.prototype.nextIndex=function(T,Y){void 0===Y&&(Y=!1);var D=this.source,ve=D.length;if(T>=ve)return ve;var mt,Ne=D.charCodeAt(T);return!Y&&!this.switchU||Ne<=55295||Ne>=57344||T+1>=ve||(mt=D.charCodeAt(T+1))<56320||mt>57343?T+1:T+2},ir.prototype.current=function(T){return void 0===T&&(T=!1),this.at(this.pos,T)},ir.prototype.lookahead=function(T){return void 0===T&&(T=!1),this.at(this.nextIndex(this.pos,T),T)},ir.prototype.advance=function(T){void 0===T&&(T=!1),this.pos=this.nextIndex(this.pos,T)},ir.prototype.eat=function(T,Y){return void 0===Y&&(Y=!1),this.current(Y)===T&&(this.advance(Y),!0)},Kt.validateRegExpFlags=function(m){for(var T=m.validFlags,Y=m.flags,D=0;D<Y.length;D++){var ve=Y.charAt(D);-1===T.indexOf(ve)&&this.raise(m.start,"Invalid regular expression flag"),Y.indexOf(ve,D+1)>-1&&this.raise(m.start,"Duplicate regular expression flag")}},Kt.validateRegExpPattern=function(m){this.regexp_pattern(m),!m.switchN&&this.options.ecmaVersion>=9&&m.groupNames.length>0&&(m.switchN=!0,this.regexp_pattern(m))},Kt.regexp_pattern=function(m){m.pos=0,m.lastIntValue=0,m.lastStringValue="",m.lastAssertionIsQuantifiable=!1,m.numCapturingParens=0,m.maxBackReference=0,m.groupNames.length=0,m.backReferenceNames.length=0,this.regexp_disjunction(m),m.pos!==m.source.length&&(m.eat(41)&&m.raise("Unmatched ')'"),(m.eat(93)||m.eat(125))&&m.raise("Lone quantifier brackets")),m.maxBackReference>m.numCapturingParens&&m.raise("Invalid escape");for(var T=0,Y=m.backReferenceNames;T<Y.length;T+=1)-1===m.groupNames.indexOf(Y[T])&&m.raise("Invalid named capture referenced")},Kt.regexp_disjunction=function(m){for(this.regexp_alternative(m);m.eat(124);)this.regexp_alternative(m);this.regexp_eatQuantifier(m,!0)&&m.raise("Nothing to repeat"),m.eat(123)&&m.raise("Lone quantifier brackets")},Kt.regexp_alternative=function(m){for(;m.pos<m.source.length&&this.regexp_eatTerm(m););},Kt.regexp_eatTerm=function(m){return this.regexp_eatAssertion(m)?(m.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(m)&&m.switchU&&m.raise("Invalid quantifier"),!0):!!(m.switchU?this.regexp_eatAtom(m):this.regexp_eatExtendedAtom(m))&&(this.regexp_eatQuantifier(m),!0)},Kt.regexp_eatAssertion=function(m){var T=m.pos;if(m.lastAssertionIsQuantifiable=!1,m.eat(94)||m.eat(36))return!0;if(m.eat(92)){if(m.eat(66)||m.eat(98))return!0;m.pos=T}if(m.eat(40)&&m.eat(63)){var Y=!1;if(this.options.ecmaVersion>=9&&(Y=m.eat(60)),m.eat(61)||m.eat(33))return this.regexp_disjunction(m),m.eat(41)||m.raise("Unterminated group"),m.lastAssertionIsQuantifiable=!Y,!0}return m.pos=T,!1},Kt.regexp_eatQuantifier=function(m,T){return void 0===T&&(T=!1),!!this.regexp_eatQuantifierPrefix(m,T)&&(m.eat(63),!0)},Kt.regexp_eatQuantifierPrefix=function(m,T){return m.eat(42)||m.eat(43)||m.eat(63)||this.regexp_eatBracedQuantifier(m,T)},Kt.regexp_eatBracedQuantifier=function(m,T){var Y=m.pos;if(m.eat(123)){var D=0,ve=-1;if(this.regexp_eatDecimalDigits(m)&&(D=m.lastIntValue,m.eat(44)&&this.regexp_eatDecimalDigits(m)&&(ve=m.lastIntValue),m.eat(125)))return-1!==ve&&ve<D&&!T&&m.raise("numbers out of order in {} quantifier"),!0;m.switchU&&!T&&m.raise("Incomplete quantifier"),m.pos=Y}return!1},Kt.regexp_eatAtom=function(m){return this.regexp_eatPatternCharacters(m)||m.eat(46)||this.regexp_eatReverseSolidusAtomEscape(m)||this.regexp_eatCharacterClass(m)||this.regexp_eatUncapturingGroup(m)||this.regexp_eatCapturingGroup(m)},Kt.regexp_eatReverseSolidusAtomEscape=function(m){var T=m.pos;if(m.eat(92)){if(this.regexp_eatAtomEscape(m))return!0;m.pos=T}return!1},Kt.regexp_eatUncapturingGroup=function(m){var T=m.pos;if(m.eat(40)){if(m.eat(63)&&m.eat(58)){if(this.regexp_disjunction(m),m.eat(41))return!0;m.raise("Unterminated group")}m.pos=T}return!1},Kt.regexp_eatCapturingGroup=function(m){if(m.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(m):63===m.current()&&m.raise("Invalid group"),this.regexp_disjunction(m),m.eat(41))return m.numCapturingParens+=1,!0;m.raise("Unterminated group")}return!1},Kt.regexp_eatExtendedAtom=function(m){return m.eat(46)||this.regexp_eatReverseSolidusAtomEscape(m)||this.regexp_eatCharacterClass(m)||this.regexp_eatUncapturingGroup(m)||this.regexp_eatCapturingGroup(m)||this.regexp_eatInvalidBracedQuantifier(m)||this.regexp_eatExtendedPatternCharacter(m)},Kt.regexp_eatInvalidBracedQuantifier=function(m){return this.regexp_eatBracedQuantifier(m,!0)&&m.raise("Nothing to repeat"),!1},Kt.regexp_eatSyntaxCharacter=function(m){var T=m.current();return!!Rn(T)&&(m.lastIntValue=T,m.advance(),!0)},Kt.regexp_eatPatternCharacters=function(m){for(var T=m.pos,Y=0;-1!==(Y=m.current())&&!Rn(Y);)m.advance();return m.pos!==T},Kt.regexp_eatExtendedPatternCharacter=function(m){var T=m.current();return!(-1===T||36===T||T>=40&&T<=43||46===T||63===T||91===T||94===T||124===T||(m.advance(),0))},Kt.regexp_groupSpecifier=function(m){if(m.eat(63)){if(this.regexp_eatGroupName(m))return-1!==m.groupNames.indexOf(m.lastStringValue)&&m.raise("Duplicate capture group name"),void m.groupNames.push(m.lastStringValue);m.raise("Invalid group")}},Kt.regexp_eatGroupName=function(m){if(m.lastStringValue="",m.eat(60)){if(this.regexp_eatRegExpIdentifierName(m)&&m.eat(62))return!0;m.raise("Invalid capture group name")}return!1},Kt.regexp_eatRegExpIdentifierName=function(m){if(m.lastStringValue="",this.regexp_eatRegExpIdentifierStart(m)){for(m.lastStringValue+=Fr(m.lastIntValue);this.regexp_eatRegExpIdentifierPart(m);)m.lastStringValue+=Fr(m.lastIntValue);return!0}return!1},Kt.regexp_eatRegExpIdentifierStart=function(m){var T=m.pos,Y=this.options.ecmaVersion>=11,D=m.current(Y);return m.advance(Y),92===D&&this.regexp_eatRegExpUnicodeEscapeSequence(m,Y)&&(D=m.lastIntValue),function(m){return W(m,!0)||36===m||95===m}(D)?(m.lastIntValue=D,!0):(m.pos=T,!1)},Kt.regexp_eatRegExpIdentifierPart=function(m){var T=m.pos,Y=this.options.ecmaVersion>=11,D=m.current(Y);return m.advance(Y),92===D&&this.regexp_eatRegExpUnicodeEscapeSequence(m,Y)&&(D=m.lastIntValue),function(m){return Ke(m,!0)||36===m||95===m||8204===m||8205===m}(D)?(m.lastIntValue=D,!0):(m.pos=T,!1)},Kt.regexp_eatAtomEscape=function(m){return!!(this.regexp_eatBackReference(m)||this.regexp_eatCharacterClassEscape(m)||this.regexp_eatCharacterEscape(m)||m.switchN&&this.regexp_eatKGroupName(m))||(m.switchU&&(99===m.current()&&m.raise("Invalid unicode escape"),m.raise("Invalid escape")),!1)},Kt.regexp_eatBackReference=function(m){var T=m.pos;if(this.regexp_eatDecimalEscape(m)){var Y=m.lastIntValue;if(m.switchU)return Y>m.maxBackReference&&(m.maxBackReference=Y),!0;if(Y<=m.numCapturingParens)return!0;m.pos=T}return!1},Kt.regexp_eatKGroupName=function(m){if(m.eat(107)){if(this.regexp_eatGroupName(m))return m.backReferenceNames.push(m.lastStringValue),!0;m.raise("Invalid named reference")}return!1},Kt.regexp_eatCharacterEscape=function(m){return this.regexp_eatControlEscape(m)||this.regexp_eatCControlLetter(m)||this.regexp_eatZero(m)||this.regexp_eatHexEscapeSequence(m)||this.regexp_eatRegExpUnicodeEscapeSequence(m,!1)||!m.switchU&&this.regexp_eatLegacyOctalEscapeSequence(m)||this.regexp_eatIdentityEscape(m)},Kt.regexp_eatCControlLetter=function(m){var T=m.pos;if(m.eat(99)){if(this.regexp_eatControlLetter(m))return!0;m.pos=T}return!1},Kt.regexp_eatZero=function(m){return 48===m.current()&&!Oi(m.lookahead())&&(m.lastIntValue=0,m.advance(),!0)},Kt.regexp_eatControlEscape=function(m){var T=m.current();return 116===T?(m.lastIntValue=9,m.advance(),!0):110===T?(m.lastIntValue=10,m.advance(),!0):118===T?(m.lastIntValue=11,m.advance(),!0):102===T?(m.lastIntValue=12,m.advance(),!0):114===T&&(m.lastIntValue=13,m.advance(),!0)},Kt.regexp_eatControlLetter=function(m){var T=m.current();return!!Sn(T)&&(m.lastIntValue=T%32,m.advance(),!0)},Kt.regexp_eatRegExpUnicodeEscapeSequence=function(m,T){void 0===T&&(T=!1);var Y=m.pos,D=T||m.switchU;if(m.eat(117)){if(this.regexp_eatFixedHexDigits(m,4)){var ve=m.lastIntValue;if(D&&ve>=55296&&ve<=56319){var Ne=m.pos;if(m.eat(92)&&m.eat(117)&&this.regexp_eatFixedHexDigits(m,4)){var mt=m.lastIntValue;if(mt>=56320&&mt<=57343)return m.lastIntValue=1024*(ve-55296)+(mt-56320)+65536,!0}m.pos=Ne,m.lastIntValue=ve}return!0}if(D&&m.eat(123)&&this.regexp_eatHexDigits(m)&&m.eat(125)&&function(m){return m>=0&&m<=1114111}(m.lastIntValue))return!0;D&&m.raise("Invalid unicode escape"),m.pos=Y}return!1},Kt.regexp_eatIdentityEscape=function(m){if(m.switchU)return!!this.regexp_eatSyntaxCharacter(m)||!!m.eat(47)&&(m.lastIntValue=47,!0);var T=m.current();return!(99===T||m.switchN&&107===T||(m.lastIntValue=T,m.advance(),0))},Kt.regexp_eatDecimalEscape=function(m){m.lastIntValue=0;var T=m.current();if(T>=49&&T<=57){do{m.lastIntValue=10*m.lastIntValue+(T-48),m.advance()}while((T=m.current())>=48&&T<=57);return!0}return!1},Kt.regexp_eatCharacterClassEscape=function(m){var T=m.current();if(function(m){return 100===m||68===m||115===m||83===m||119===m||87===m}(T))return m.lastIntValue=-1,m.advance(),!0;if(m.switchU&&this.options.ecmaVersion>=9&&(80===T||112===T)){if(m.lastIntValue=-1,m.advance(),m.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(m)&&m.eat(125))return!0;m.raise("Invalid property name")}return!1},Kt.regexp_eatUnicodePropertyValueExpression=function(m){var T=m.pos;if(this.regexp_eatUnicodePropertyName(m)&&m.eat(61)){var Y=m.lastStringValue;if(this.regexp_eatUnicodePropertyValue(m))return this.regexp_validateUnicodePropertyNameAndValue(m,Y,m.lastStringValue),!0}return m.pos=T,!!this.regexp_eatLoneUnicodePropertyNameOrValue(m)&&(this.regexp_validateUnicodePropertyNameOrValue(m,m.lastStringValue),!0)},Kt.regexp_validateUnicodePropertyNameAndValue=function(m,T,Y){Er(m.unicodeProperties.nonBinary,T)||m.raise("Invalid property name"),m.unicodeProperties.nonBinary[T].test(Y)||m.raise("Invalid property value")},Kt.regexp_validateUnicodePropertyNameOrValue=function(m,T){m.unicodeProperties.binary.test(T)||m.raise("Invalid property name")},Kt.regexp_eatUnicodePropertyName=function(m){var T=0;for(m.lastStringValue="";Di(T=m.current());)m.lastStringValue+=Fr(T),m.advance();return""!==m.lastStringValue},Kt.regexp_eatUnicodePropertyValue=function(m){var T=0;for(m.lastStringValue="";_n(T=m.current());)m.lastStringValue+=Fr(T),m.advance();return""!==m.lastStringValue},Kt.regexp_eatLoneUnicodePropertyNameOrValue=function(m){return this.regexp_eatUnicodePropertyValue(m)},Kt.regexp_eatCharacterClass=function(m){if(m.eat(91)){if(m.eat(94),this.regexp_classRanges(m),m.eat(93))return!0;m.raise("Unterminated character class")}return!1},Kt.regexp_classRanges=function(m){for(;this.regexp_eatClassAtom(m);){var T=m.lastIntValue;if(m.eat(45)&&this.regexp_eatClassAtom(m)){var Y=m.lastIntValue;m.switchU&&(-1===T||-1===Y)&&m.raise("Invalid character class"),-1!==T&&-1!==Y&&T>Y&&m.raise("Range out of order in character class")}}},Kt.regexp_eatClassAtom=function(m){var T=m.pos;if(m.eat(92)){if(this.regexp_eatClassEscape(m))return!0;if(m.switchU){var Y=m.current();(99===Y||Ji(Y))&&m.raise("Invalid class escape"),m.raise("Invalid escape")}m.pos=T}var D=m.current();return 93!==D&&(m.lastIntValue=D,m.advance(),!0)},Kt.regexp_eatClassEscape=function(m){var T=m.pos;if(m.eat(98))return m.lastIntValue=8,!0;if(m.switchU&&m.eat(45))return m.lastIntValue=45,!0;if(!m.switchU&&m.eat(99)){if(this.regexp_eatClassControlLetter(m))return!0;m.pos=T}return this.regexp_eatCharacterClassEscape(m)||this.regexp_eatCharacterEscape(m)},Kt.regexp_eatClassControlLetter=function(m){var T=m.current();return!(!Oi(T)&&95!==T||(m.lastIntValue=T%32,m.advance(),0))},Kt.regexp_eatHexEscapeSequence=function(m){var T=m.pos;if(m.eat(120)){if(this.regexp_eatFixedHexDigits(m,2))return!0;m.switchU&&m.raise("Invalid escape"),m.pos=T}return!1},Kt.regexp_eatDecimalDigits=function(m){var T=m.pos,Y=0;for(m.lastIntValue=0;Oi(Y=m.current());)m.lastIntValue=10*m.lastIntValue+(Y-48),m.advance();return m.pos!==T},Kt.regexp_eatHexDigits=function(m){var T=m.pos,Y=0;for(m.lastIntValue=0;ta(Y=m.current());)m.lastIntValue=16*m.lastIntValue+oi(Y),m.advance();return m.pos!==T},Kt.regexp_eatLegacyOctalEscapeSequence=function(m){if(this.regexp_eatOctalDigit(m)){var T=m.lastIntValue;if(this.regexp_eatOctalDigit(m)){var Y=m.lastIntValue;m.lastIntValue=T<=3&&this.regexp_eatOctalDigit(m)?64*T+8*Y+m.lastIntValue:8*T+Y}else m.lastIntValue=T;return!0}return!1},Kt.regexp_eatOctalDigit=function(m){var T=m.current();return Ji(T)?(m.lastIntValue=T-48,m.advance(),!0):(m.lastIntValue=0,!1)},Kt.regexp_eatFixedHexDigits=function(m,T){var Y=m.pos;m.lastIntValue=0;for(var D=0;D<T;++D){var ve=m.current();if(!ta(ve))return m.pos=Y,!1;m.lastIntValue=16*m.lastIntValue+oi(ve),m.advance()}return!0};var Vi=function(T){this.type=T.type,this.value=T.value,this.start=T.start,this.end=T.end,T.options.locations&&(this.loc=new me(T,T.startLoc,T.endLoc)),T.options.ranges&&(this.range=[T.start,T.end])},Ti=Ve.prototype;function Ia(m){return"function"!=typeof BigInt?null:BigInt(m.replace(/_/g,""))}function Gi(m){return m<=65535?String.fromCharCode(m):(m-=65536,String.fromCharCode(55296+(m>>10),56320+(1023&m)))}Ti.next=function(m){!m&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new Vi(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Ti.getToken=function(){return this.next(),new Vi(this)},"undefined"!=typeof Symbol&&(Ti[Symbol.iterator]=function(){var m=this;return{next:function(){var T=m.getToken();return{done:T.type===Q.eof,value:T}}}}),Ti.curContext=function(){return this.context[this.context.length-1]},Ti.nextToken=function(){var m=this.curContext();return(!m||!m.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(Q.eof):m.override?m.override(this):void this.readToken(this.fullCharCodeAtPos())},Ti.readToken=function(m){return W(m,this.options.ecmaVersion>=6)||92===m?this.readWord():this.getTokenFromCode(m)},Ti.fullCharCodeAtPos=function(){var m=this.input.charCodeAt(this.pos);return m<=55295||m>=57344?m:(m<<10)+this.input.charCodeAt(this.pos+1)-56613888},Ti.skipBlockComment=function(){var m=this.options.onComment&&this.curPosition(),T=this.pos,Y=this.input.indexOf("*/",this.pos+=2);if(-1===Y&&this.raise(this.pos-2,"Unterminated comment"),this.pos=Y+2,this.options.locations){ot.lastIndex=T;for(var D;(D=ot.exec(this.input))&&D.index<this.pos;)++this.curLine,this.lineStart=D.index+D[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(T+2,Y),T,this.pos,m,this.curPosition())},Ti.skipLineComment=function(m){for(var T=this.pos,Y=this.options.onComment&&this.curPosition(),D=this.input.charCodeAt(this.pos+=m);this.pos<this.input.length&&!Ue(D);)D=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(T+m,this.pos),T,this.pos,Y,this.curPosition())},Ti.skipSpace=function(){e:for(;this.pos<this.input.length;){var m=this.input.charCodeAt(this.pos);switch(m){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(m>8&&m<14||m>=5760&&pt.test(String.fromCharCode(m))))break e;++this.pos}}},Ti.finishToken=function(m,T){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var Y=this.type;this.type=m,this.value=T,this.updateContext(Y)},Ti.readToken_dot=function(){var m=this.input.charCodeAt(this.pos+1);if(m>=48&&m<=57)return this.readNumber(!0);var T=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===m&&46===T?(this.pos+=3,this.finishToken(Q.ellipsis)):(++this.pos,this.finishToken(Q.dot))},Ti.readToken_slash=function(){var m=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===m?this.finishOp(Q.assign,2):this.finishOp(Q.slash,1)},Ti.readToken_mult_modulo_exp=function(m){var T=this.input.charCodeAt(this.pos+1),Y=1,D=42===m?Q.star:Q.modulo;return this.options.ecmaVersion>=7&&42===m&&42===T&&(++Y,D=Q.starstar,T=this.input.charCodeAt(this.pos+2)),61===T?this.finishOp(Q.assign,Y+1):this.finishOp(D,Y)},Ti.readToken_pipe_amp=function(m){var T=this.input.charCodeAt(this.pos+1);return T===m?this.options.ecmaVersion>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(Q.assign,3):this.finishOp(124===m?Q.logicalOR:Q.logicalAND,2):61===T?this.finishOp(Q.assign,2):this.finishOp(124===m?Q.bitwiseOR:Q.bitwiseAND,1)},Ti.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(Q.assign,2):this.finishOp(Q.bitwiseXOR,1)},Ti.readToken_plus_min=function(m){var T=this.input.charCodeAt(this.pos+1);return T===m?45!==T||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!Vt.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(Q.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===T?this.finishOp(Q.assign,2):this.finishOp(Q.plusMin,1)},Ti.readToken_lt_gt=function(m){var T=this.input.charCodeAt(this.pos+1),Y=1;return T===m?(Y=62===m&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+Y)?this.finishOp(Q.assign,Y+1):this.finishOp(Q.bitShift,Y)):33!==T||60!==m||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===T&&(Y=2),this.finishOp(Q.relational,Y)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},Ti.readToken_eq_excl=function(m){var T=this.input.charCodeAt(this.pos+1);return 61===T?this.finishOp(Q.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===m&&62===T&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(Q.arrow)):this.finishOp(61===m?Q.eq:Q.prefix,1)},Ti.readToken_question=function(){var m=this.options.ecmaVersion;if(m>=11){var T=this.input.charCodeAt(this.pos+1);if(46===T){var Y=this.input.charCodeAt(this.pos+2);if(Y<48||Y>57)return this.finishOp(Q.questionDot,2)}if(63===T)return m>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(Q.assign,3):this.finishOp(Q.coalesce,2)}return this.finishOp(Q.question,1)},Ti.getTokenFromCode=function(m){switch(m){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(Q.parenL);case 41:return++this.pos,this.finishToken(Q.parenR);case 59:return++this.pos,this.finishToken(Q.semi);case 44:return++this.pos,this.finishToken(Q.comma);case 91:return++this.pos,this.finishToken(Q.bracketL);case 93:return++this.pos,this.finishToken(Q.bracketR);case 123:return++this.pos,this.finishToken(Q.braceL);case 125:return++this.pos,this.finishToken(Q.braceR);case 58:return++this.pos,this.finishToken(Q.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(Q.backQuote);case 48:var T=this.input.charCodeAt(this.pos+1);if(120===T||88===T)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===T||79===T)return this.readRadixNumber(8);if(98===T||66===T)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(m);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(m);case 124:case 38:return this.readToken_pipe_amp(m);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(m);case 60:case 62:return this.readToken_lt_gt(m);case 61:case 33:return this.readToken_eq_excl(m);case 63:return this.readToken_question();case 126:return this.finishOp(Q.prefix,1)}this.raise(this.pos,"Unexpected character '"+Gi(m)+"'")},Ti.finishOp=function(m,T){var Y=this.input.slice(this.pos,this.pos+T);return this.pos+=T,this.finishToken(m,Y)},Ti.readRegexp=function(){for(var m,T,Y=this.pos;;){this.pos>=this.input.length&&this.raise(Y,"Unterminated regular expression");var D=this.input.charAt(this.pos);if(Vt.test(D)&&this.raise(Y,"Unterminated regular expression"),m)m=!1;else{if("["===D)T=!0;else if("]"===D&&T)T=!1;else if("/"===D&&!T)break;m="\\"===D}++this.pos}var ve=this.input.slice(Y,this.pos);++this.pos;var Ne=this.pos,mt=this.readWord1();this.containsEsc&&this.unexpected(Ne);var zt=this.regexpState||(this.regexpState=new ir(this));zt.reset(Y,ve,mt),this.validateRegExpFlags(zt),this.validateRegExpPattern(zt);var Ft=null;try{Ft=new RegExp(ve,mt)}catch(Or){}return this.finishToken(Q.regexp,{pattern:ve,flags:mt,value:Ft})},Ti.readInt=function(m,T,Y){for(var D=this.options.ecmaVersion>=12&&void 0===T,ve=Y&&48===this.input.charCodeAt(this.pos),Ne=this.pos,mt=0,zt=0,Ft=0,Or=null==T?1/0:T;Ft<Or;++Ft,++this.pos){var zr=this.input.charCodeAt(this.pos),Jn=void 0;if(D&&95===zr)ve&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===zt&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===Ft&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),zt=zr;else{if((Jn=zr>=97?zr-97+10:zr>=65?zr-65+10:zr>=48&&zr<=57?zr-48:1/0)>=m)break;zt=zr,mt=mt*m+Jn}}return D&&95===zt&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===Ne||null!=T&&this.pos-Ne!==T?null:mt},Ti.readRadixNumber=function(m){var T=this.pos;this.pos+=2;var Y=this.readInt(m);return null==Y&&this.raise(this.start+2,"Expected number in radix "+m),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(Y=Ia(this.input.slice(T,this.pos)),++this.pos):W(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Q.num,Y)},Ti.readNumber=function(m){var T=this.pos;!m&&null===this.readInt(10,void 0,!0)&&this.raise(T,"Invalid number");var Y=this.pos-T>=2&&48===this.input.charCodeAt(T);Y&&this.strict&&this.raise(T,"Invalid number");var D=this.input.charCodeAt(this.pos);if(!Y&&!m&&this.options.ecmaVersion>=11&&110===D){var ve=Ia(this.input.slice(T,this.pos));return++this.pos,W(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(Q.num,ve)}Y&&/[89]/.test(this.input.slice(T,this.pos))&&(Y=!1),46===D&&!Y&&(++this.pos,this.readInt(10),D=this.input.charCodeAt(this.pos)),(69===D||101===D)&&!Y&&((43===(D=this.input.charCodeAt(++this.pos))||45===D)&&++this.pos,null===this.readInt(10)&&this.raise(T,"Invalid number")),W(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var Ne=function(m,T){return T?parseInt(m,8):parseFloat(m.replace(/_/g,""))}(this.input.slice(T,this.pos),Y);return this.finishToken(Q.num,Ne)},Ti.readCodePoint=function(){var T;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var Y=++this.pos;T=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,T>1114111&&this.invalidStringToken(Y,"Code point out of bounds")}else T=this.readHexChar(4);return T},Ti.readString=function(m){for(var T="",Y=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var D=this.input.charCodeAt(this.pos);if(D===m)break;92===D?(T+=this.input.slice(Y,this.pos),T+=this.readEscapedChar(!1),Y=this.pos):(Ue(D,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return T+=this.input.slice(Y,this.pos++),this.finishToken(Q.string,T)};var Bi={};function Wi(m,T){m.prototype=Object.create(T.prototype),m.prototype.constructor=m,m.__proto__=T}function va(m){var T="function"==typeof Map?new Map:void 0;return(va=function(D){if(null===D||!function(m){return-1!==Function.toString.call(m).indexOf("[native code]")}(D))return D;if("function"!=typeof D)throw new TypeError("Super expression must either be null or a function");if(void 0!==T){if(T.has(D))return T.get(D);T.set(D,ve)}function ve(){return Da(D,arguments,ra(this).constructor)}return ve.prototype=Object.create(D.prototype,{constructor:{value:ve,enumerable:!1,writable:!0,configurable:!0}}),Fi(ve,D)})(m)}function wu(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}function Da(m,T,Y){return(Da=wu()?Reflect.construct:function(ve,Ne,mt){var zt=[null];zt.push.apply(zt,Ne);var Or=new(Function.bind.apply(ve,zt));return mt&&Fi(Or,mt.prototype),Or}).apply(null,arguments)}function Fi(m,T){return(Fi=Object.setPrototypeOf||function(D,ve){return D.__proto__=ve,D})(m,T)}function ra(m){return(ra=Object.setPrototypeOf?Object.getPrototypeOf:function(Y){return Y.__proto__||Object.getPrototypeOf(Y)})(m)}Ti.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(m){if(m!==Bi)throw m;this.readInvalidTemplateToken()}this.inTemplateElement=!1},Ti.invalidStringToken=function(m,T){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Bi;this.raise(m,T)},Ti.readTmplToken=function(){for(var m="",T=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var Y=this.input.charCodeAt(this.pos);if(96===Y||36===Y&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==Q.template&&this.type!==Q.invalidTemplate?(m+=this.input.slice(T,this.pos),this.finishToken(Q.template,m)):36===Y?(this.pos+=2,this.finishToken(Q.dollarBraceL)):(++this.pos,this.finishToken(Q.backQuote));if(92===Y)m+=this.input.slice(T,this.pos),m+=this.readEscapedChar(!0),T=this.pos;else if(Ue(Y)){switch(m+=this.input.slice(T,this.pos),++this.pos,Y){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:m+="\n";break;default:m+=String.fromCharCode(Y)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),T=this.pos}else++this.pos}},Ti.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(Q.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Ti.readEscapedChar=function(m){var T=this.input.charCodeAt(++this.pos);switch(++this.pos,T){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Gi(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(m)return this.invalidStringToken(this.pos-1,"Invalid escape sequence in template string"),null;default:if(T>=48&&T<=55){var D=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],ve=parseInt(D,8);return ve>255&&(D=D.slice(0,-1),ve=parseInt(D,8)),this.pos+=D.length-1,T=this.input.charCodeAt(this.pos),("0"!==D||56===T||57===T)&&(this.strict||m)&&this.invalidStringToken(this.pos-1-D.length,m?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(ve)}return Ue(T)?"":String.fromCharCode(T)}},Ti.readHexChar=function(m){var T=this.pos,Y=this.readInt(16,m);return null===Y&&this.invalidStringToken(T,"Bad character escape sequence"),Y},Ti.readWord1=function(){this.containsEsc=!1;for(var m="",T=!0,Y=this.pos,D=this.options.ecmaVersion>=6;this.pos<this.input.length;){var ve=this.fullCharCodeAtPos();if(Ke(ve,D))this.pos+=ve<=65535?1:2;else{if(92!==ve)break;this.containsEsc=!0,m+=this.input.slice(Y,this.pos);var Ne=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var mt=this.readCodePoint();(T?W:Ke)(mt,D)||this.invalidStringToken(Ne,"Invalid Unicode escape"),m+=Gi(mt),Y=this.pos}T=!1}return m+this.input.slice(Y,this.pos)},Ti.readWord=function(){var m=this.readWord1(),T=Q.name;return this.keywords.test(m)&&(T=tt[m]),this.finishToken(T,m)},Ve.acorn={Parser:Ve,version:"7.4.1",defaultOptions:Ge,Position:oe,SourceLocation:me,getLineInfo:Me,Node:hi,TokenType:xt,tokTypes:Q,keywordTypes:tt,TokContext:Ki,tokContexts:Pi,isIdentifierChar:Ke,isIdentifierStart:W,Token:Vi,isNewLine:Ue,lineBreak:Vt,lineBreakG:ot,nonASCIIwhitespace:pt};var bo=function(m){function T(){return m.apply(this,arguments)||this}return Wi(T,m),T}(va(Error)),ma=function(m){function T(){return m.apply(this,arguments)||this}return Wi(T,m),T}(va(SyntaxError)),vo=function(m){function T(){return m.apply(this,arguments)||this}return Wi(T,m),T}(va(ReferenceError)),No=function(m){function T(){return m.apply(this,arguments)||this}return Wi(T,m),T}(va(TypeError)),Ls=function(m){function T(){return m.apply(this,arguments)||this}return Wi(T,m),T}(bo),aa=function(m){function T(){return m.apply(this,arguments)||this}return Wi(T,m),T}(ma),Jo=function(m){function T(){return m.apply(this,arguments)||this}return Wi(T,m),T}(vo),Ma={UnknownError:[3001,"%0",Ls],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",Ls],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Jo],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Jo],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Jo],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Jo],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Jo],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Jo],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Jo],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Jo],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Jo],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Jo],FunctionUndefinedReferenceError:[2001,"%0 is not a function",vo],VariableUndefinedReferenceError:[2002,"%0 is not defined",vo],IsNotConstructor:[2003,"%0 is not a constructor",No]};function Ka(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}function $o(m,T,Y){return($o=Ka()?Reflect.construct:function(ve,Ne,mt){var zt=[null];zt.push.apply(zt,Ne);var Or=new(Function.bind.apply(ve,zt));return mt&&Ba(Or,mt.prototype),Or}).apply(null,arguments)}function Ba(m,T){return(Ba=Object.setPrototypeOf||function(D,ve){return D.__proto__=ve,D})(m,T)}function je(m,T){Object.defineProperty(m,"name",{value:T,writable:!1,enumerable:!1,configurable:!0})}var bt=Object.prototype.hasOwnProperty,ar=Symbol("Break"),Kr=Symbol("Continue"),$n=Symbol("DefaultCase"),xi=Symbol("EmptyStatementReturn"),lo=Symbol("WithScopeName"),ro=Symbol("SuperScopeName"),co=Symbol("RootScopeName"),ps=Symbol("GlobalScopeName");function du(m){return"function"==typeof m}var Eu=function(){function m(Y){this.interpreter=Y}return m.prototype.generator=function(){var D=this.interpreter;return{getOptions:D.getOptions.bind(D),getCurrentScope:function(){return this.getCurrentScope()}.bind(D),getGlobalScope:function(){return this.getGlobalScope()}.bind(D),getCurrentContext:function(){return this.getCurrentContext()}.bind(D),getExecStartTime:D.getExecStartTime.bind(D)}},m}();function fl(m,T,Y){if(void 0===Y&&(Y=!0),!(m instanceof Eu))throw new Error("Illegal call");if("string"!=typeof T)return T;if(T){var D=m.generator(),Ne={timeout:D.getOptions().timeout,_initEnv:function(){Y||this.setCurrentContext(D.getCurrentContext()),this.execStartTime=D.getExecStartTime(),this.execEndTime=this.execStartTime}},mt=Y?D.getGlobalScope():D.getCurrentScope();return new ko(mt,Ne).evaluate(T)}}function Wo(m){if(!(m instanceof Eu))throw new Error("Illegal call");for(var T=m.generator(),Y=arguments.length,D=new Array(Y>1?Y-1:0),ve=1;ve<Y;ve++)D[ve-1]=arguments[ve];var Ne=D.pop(),mt=new ko(T.getGlobalScope(),T.getOptions()),zt="\n\t\t    (function anonymous("+D.join(",")+"){\n\t\t        "+Ne+"\n\t\t    });\n\t\t    ";return mt.evaluate(zt)}Object.defineProperty(fl,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(Wo,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var Qo=function(T){this.value=T},Lo=function(T){this.value=T},es=function(T){this.value=T},ts=function(T,Y,D){void 0===Y&&(Y=null),this.name=D,this.parent=Y,this.data=T,this.labelStack=[]};function ks(){}function Qs(m,T){return void 0===m&&(m=null),new ts(Object.create(null),m,T)}var Oa={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:fl,Function:Wo};"undefined"!=typeof JSON&&(Oa.JSON=JSON),"undefined"!=typeof Promise&&(Oa.Promise=Promise),"undefined"!=typeof Set&&(Oa.Set=Set),"undefined"!=typeof Map&&(Oa.Map=Map),"undefined"!=typeof Symbol&&(Oa.Symbol=Symbol),"undefined"!=typeof Proxy&&(Oa.Proxy=Proxy),"undefined"!=typeof WeakMap&&(Oa.WeakMap=WeakMap),"undefined"!=typeof WeakSet&&(Oa.WeakSet=WeakSet),"undefined"!=typeof Reflect&&(Oa.Reflect=Reflect);var ko=function(){function m(Y,D){void 0===Y&&(Y=m.global),void 0===D&&(D={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:D.ecmaVersion||m.ecmaVersion,timeout:D.timeout||0,rootContext:D.rootContext,globalContextInFunction:void 0===D.globalContextInFunction?m.globalContextInFunction:D.globalContextInFunction,_initEnv:D._initEnv},this.context=Y||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var T=m.prototype;return T.initEnvironment=function(D){var ve;if(D instanceof ts)ve=D;else{var Ne=null,mt=this.createSuperScope(D);this.options.rootContext&&(Ne=new ts(function(m){return Object.create(m)}(this.options.rootContext),mt,co)),ve=new ts(D,Ne||mt,ps)}this.globalScope=ve,this.currentScope=this.globalScope,this.globalContext=ve.data,this.currentContext=ve.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var zt=this.options._initEnv;zt&&zt.call(this)},T.getExecStartTime=function(){return this.execStartTime},T.getExecutionTime=function(){return this.execEndTime-this.execStartTime},T.setExecTimeout=function(D){void 0===D&&(D=0),this.options.timeout=D},T.getOptions=function(){return this.options},T.getGlobalScope=function(){return this.globalScope},T.getCurrentScope=function(){return this.currentScope},T.getCurrentContext=function(){return this.currentContext},T.isInterruptThrow=function(D){return D instanceof Ls||D instanceof Jo||D instanceof aa},T.createSuperScope=function(D){var ve=Object.assign({},Oa);return Object.keys(ve).forEach(function(mt){mt in D&&delete ve[mt]}),new ts(ve,null,ro)},T.setCurrentContext=function(D){this.currentContext=D},T.setCurrentScope=function(D){this.currentScope=D},T.evaluate=function(D){var ve;if(void 0===D&&(D=""),D)return ve=function(m,T){return Ve.parse(m,T)}(D,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||m.ecmaVersion}),this.evaluateNode(ve,D)},T.appendCode=function(D){return this.evaluate(D)},T.evaluateNode=function(D,ve){void 0===ve&&(ve=""),this.value=void 0,this.source=ve,this.sourceList.push(ve),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var mt=this.getCurrentScope(),zt=this.getCurrentContext(),Ft=mt.labelStack.concat([]),Or=this.callStack.concat([]);try{var Jn=this.createClosure(D);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),Jn()}catch(bi){throw bi}finally{this.setCurrentScope(mt),this.setCurrentContext(zt),mt.labelStack=Ft,this.callStack=Or,this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},T.createErrorMessage=function(D,ve,Ne){var mt=D[1].replace("%0",String(ve));return null!==Ne&&(mt+=this.getNodePosition(Ne||this.lastExecNode)),mt},T.createError=function(D,ve){return new ve(D)},T.createThrowError=function(D,ve){return this.createError(D,ve)},T.createInternalThrowError=function(D,ve,Ne){return this.createError(this.createErrorMessage(D,ve,Ne),D[2])},T.checkTimeout=function(){if(!this.isRunning)return!1;var D=this.options.timeout||0;return Date.now()-this.execStartTime>D},T.getNodePosition=function(D){return D&&D.loc?" ["+D.loc.start.line+":"+D.loc.start.column+"]":""},T.createClosure=function(D){var Ne,ve=this;switch(D.type){case"BinaryExpression":Ne=this.binaryExpressionHandler(D);break;case"LogicalExpression":Ne=this.logicalExpressionHandler(D);break;case"UnaryExpression":Ne=this.unaryExpressionHandler(D);break;case"UpdateExpression":Ne=this.updateExpressionHandler(D);break;case"ObjectExpression":Ne=this.objectExpressionHandler(D);break;case"ArrayExpression":Ne=this.arrayExpressionHandler(D);break;case"CallExpression":Ne=this.callExpressionHandler(D);break;case"NewExpression":Ne=this.newExpressionHandler(D);break;case"MemberExpression":Ne=this.memberExpressionHandler(D);break;case"ThisExpression":Ne=this.thisExpressionHandler(D);break;case"SequenceExpression":Ne=this.sequenceExpressionHandler(D);break;case"Literal":Ne=this.literalHandler(D);break;case"Identifier":Ne=this.identifierHandler(D);break;case"AssignmentExpression":Ne=this.assignmentExpressionHandler(D);break;case"FunctionDeclaration":Ne=this.functionDeclarationHandler(D);break;case"VariableDeclaration":Ne=this.variableDeclarationHandler(D);break;case"BlockStatement":case"Program":Ne=this.programHandler(D);break;case"ExpressionStatement":Ne=this.expressionStatementHandler(D);break;case"EmptyStatement":Ne=this.emptyStatementHandler(D);break;case"ReturnStatement":Ne=this.returnStatementHandler(D);break;case"FunctionExpression":Ne=this.functionExpressionHandler(D);break;case"IfStatement":Ne=this.ifStatementHandler(D);break;case"ConditionalExpression":Ne=this.conditionalExpressionHandler(D);break;case"ForStatement":Ne=this.forStatementHandler(D);break;case"WhileStatement":Ne=this.whileStatementHandler(D);break;case"DoWhileStatement":Ne=this.doWhileStatementHandler(D);break;case"ForInStatement":Ne=this.forInStatementHandler(D);break;case"WithStatement":Ne=this.withStatementHandler(D);break;case"ThrowStatement":Ne=this.throwStatementHandler(D);break;case"TryStatement":Ne=this.tryStatementHandler(D);break;case"ContinueStatement":Ne=this.continueStatementHandler(D);break;case"BreakStatement":Ne=this.breakStatementHandler(D);break;case"SwitchStatement":Ne=this.switchStatementHandler(D);break;case"LabeledStatement":Ne=this.labeledStatementHandler(D);break;case"DebuggerStatement":Ne=this.debuggerStatementHandler(D);break;default:throw this.createInternalThrowError(Ma.NodeTypeSyntaxError,D.type,D)}return function(){var mt=ve.options.timeout;if(mt&&mt>0&&ve.checkTimeout())throw ve.createInternalThrowError(Ma.ExecutionTimeOutError,mt,null);return ve.lastExecNode=D,Ne.apply(void 0,arguments)}},T.binaryExpressionHandler=function(D){var ve=this,Ne=this.createClosure(D.left),mt=this.createClosure(D.right);return function(){var zt=Ne(),Ft=mt();switch(D.operator){case"==":return zt==Ft;case"!=":return zt!=Ft;case"===":return zt===Ft;case"!==":return zt!==Ft;case"<":return zt<Ft;case"<=":return zt<=Ft;case">":return zt>Ft;case">=":return zt>=Ft;case"<<":return zt<<Ft;case">>":return zt>>Ft;case">>>":return zt>>>Ft;case"+":return zt+Ft;case"-":return zt-Ft;case"*":return zt*Ft;case"**":return Math.pow(zt,Ft);case"/":return zt/Ft;case"%":return zt%Ft;case"|":return zt|Ft;case"^":return zt^Ft;case"&":return zt&Ft;case"in":return zt in Ft;case"instanceof":return zt instanceof Ft;default:throw ve.createInternalThrowError(Ma.BinaryOperatorSyntaxError,D.operator,D)}}},T.logicalExpressionHandler=function(D){var ve=this,Ne=this.createClosure(D.left),mt=this.createClosure(D.right);return function(){switch(D.operator){case"||":return Ne()||mt();case"&&":return Ne()&&mt();default:throw ve.createInternalThrowError(Ma.LogicalOperatorSyntaxError,D.operator,D)}}},T.unaryExpressionHandler=function(D){var ve=this;switch(D.operator){case"delete":var Ne=this.createObjectGetter(D.argument),mt=this.createNameGetter(D.argument);return function(){return delete Ne()[mt()]};default:var zt;if("typeof"===D.operator&&"Identifier"===D.argument.type){var Ft=this.createObjectGetter(D.argument),Or=this.createNameGetter(D.argument);zt=function(){return Ft()[Or()]}}else zt=this.createClosure(D.argument);return function(){var zr=zt();switch(D.operator){case"-":return-zr;case"+":return+zr;case"!":return!zr;case"~":return~zr;case"void":return;case"typeof":return typeof zr;default:throw ve.createInternalThrowError(Ma.UnaryOperatorSyntaxError,D.operator,D)}}}},T.updateExpressionHandler=function(D){var ve=this,Ne=this.createObjectGetter(D.argument),mt=this.createNameGetter(D.argument);return function(){var zt=Ne(),Ft=mt();switch(ve.assertVariable(zt,Ft,D),D.operator){case"++":return D.prefix?++zt[Ft]:zt[Ft]++;case"--":return D.prefix?--zt[Ft]:zt[Ft]--;default:throw ve.createInternalThrowError(Ma.UpdateOperatorSyntaxError,D.operator,D)}}},T.objectExpressionHandler=function(D){var ve=this,Ne=[],zt=Object.create(null);return D.properties.forEach(function(Ft){var Or=Ft.kind,zr=function(Ft){return"Identifier"===Ft.type?Ft.name:"Literal"===Ft.type?Ft.value:this.throwError(Ma.ObjectStructureSyntaxError,Ft.type,Ft)}(Ft.key);(!zt[zr]||"init"===Or)&&(zt[zr]={}),zt[zr][Or]=ve.createClosure(Ft.value),Ne.push({key:zr,property:Ft})}),function(){for(var Ft={},Or=Ne.length,zr=0;zr<Or;zr++){var Jn=Ne[zr],bi=Jn.key,pi=zt[bi],oa=pi.init?pi.init():void 0,Ea=pi.get?pi.get():function(){},Na=pi.set?pi.set():function(Tu){};if("set"in pi||"get"in pi)Object.defineProperty(Ft,bi,{configurable:!0,enumerable:!0,get:Ea,set:Na});else{var Xo=Jn.property;"Identifier"===Xo.key.type&&"FunctionExpression"===Xo.value.type&&"init"===Xo.kind&&!Xo.value.id&&je(oa,Xo.key.name),Ft[bi]=oa}}return Ft}},T.arrayExpressionHandler=function(D){var ve=this,Ne=D.elements.map(function(mt){return mt&&ve.createClosure(mt)});return function(){for(var mt=Ne.length,zt=Array(mt),Ft=0;Ft<mt;Ft++){var Or=Ne[Ft];Or&&(zt[Ft]=Or())}return zt}},T.safeObjectGet=function(D,ve,Ne){return D[ve]},T.createCallFunctionGetter=function(D){var ve=this;switch(D.type){case"MemberExpression":var Ne=this.createClosure(D.object),mt=this.createMemberKeyGetter(D),zt=this.source;return function(){var Or=Ne(),zr=mt(),Jn=ve.safeObjectGet(Or,zr,D);if(!Jn||!du(Jn)){var bi=zt.slice(D.start,D.end);throw ve.createInternalThrowError(Ma.FunctionUndefinedReferenceError,bi,D)}return Jn.__IS_EVAL_FUNC?function(pi){return Jn(new Eu(ve),pi,!0)}:Jn.__IS_FUNCTION_FUNC?function(){for(var pi=arguments.length,oa=new Array(pi),Ea=0;Ea<pi;Ea++)oa[Ea]=arguments[Ea];return Jn.apply(void 0,[new Eu(ve)].concat(oa))}:Jn.bind(Or)};default:var Ft=this.createClosure(D);return function(){var Or="";"Identifier"===D.type&&(Or=D.name);var zr=Ft();if(!zr||!du(zr))throw ve.createInternalThrowError(Ma.FunctionUndefinedReferenceError,Or,D);if("Identifier"===D.type&&zr.__IS_EVAL_FUNC&&"eval"===Or)return function(pi){var oa=ve.getScopeFromName(Or,ve.getCurrentScope()),Ea=oa.name===ro||oa.name===ps||oa.name===co;return zr(new Eu(ve),pi,!Ea)};if(zr.__IS_EVAL_FUNC)return function(pi){return zr(new Eu(ve),pi,!0)};if(zr.__IS_FUNCTION_FUNC)return function(){for(var pi=arguments.length,oa=new Array(pi),Ea=0;Ea<pi;Ea++)oa[Ea]=arguments[Ea];return zr.apply(void 0,[new Eu(ve)].concat(oa))};var Jn=ve.options.globalContextInFunction;if("Identifier"===D.type){var bi=ve.getIdentifierScope(D);bi.name===lo&&(Jn=bi.data)}return zr.bind(Jn)}}},T.callExpressionHandler=function(D){var ve=this,Ne=this.createCallFunctionGetter(D.callee),mt=D.arguments.map(function(zt){return ve.createClosure(zt)});return function(){return Ne().apply(void 0,mt.map(function(zt){return zt()}))}},T.functionExpressionHandler=function(D){var ve=this,Ne=this,mt=this.source,zt=this.collectDeclVars,Ft=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Or=D.id?D.id.name:"",zr=D.params.length,Jn=D.params.map(function(Ea){return ve.createParamNameGetter(Ea)}),bi=this.createClosure(D.body),pi=this.collectDeclVars,oa=this.collectDeclFuncs;return this.collectDeclVars=zt,this.collectDeclFuncs=Ft,function(){var Ea=Ne.getCurrentScope(),Na=function vi(){for(var Xo=arguments.length,vu=new Array(Xo),Tu=0;Tu<Xo;Tu++)vu[Tu]=arguments[Tu];Ne.callStack.push(""+Or);var Ec=Ne.getCurrentScope(),Du=Qs(Ea,"FunctionScope("+Or+")");Ne.setCurrentScope(Du),Ne.addDeclarationsToScope(pi,oa,Du),Or&&(Du.data[Or]=vi),Du.data.arguments=arguments,Jn.forEach(function(gu,tu){Du.data[gu()]=vu[tu]});var Bl=Ne.getCurrentContext();Ne.setCurrentContext(this);var mu=bi();if(Ne.setCurrentContext(Bl),Ne.setCurrentScope(Ec),Ne.callStack.pop(),mu instanceof Qo)return mu.value};return je(Na,Or),Object.defineProperty(Na,"length",{value:zr,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Na,"toString",{value:function(){return mt.slice(D.start,D.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Na,"valueOf",{value:function(){return mt.slice(D.start,D.end)},writable:!0,configurable:!0,enumerable:!1}),Na}},T.newExpressionHandler=function(D){var ve=this,Ne=this.source,mt=this.createClosure(D.callee),zt=D.arguments.map(function(Ft){return ve.createClosure(Ft)});return function(){var Ft=mt();if(!du(Ft)||Ft.__IS_EVAL_FUNC){var Or=D.callee,zr=Ne.slice(Or.start,Or.end);throw ve.createInternalThrowError(Ma.IsNotConstructor,zr,D)}return Ft.__IS_FUNCTION_FUNC?Ft.apply(void 0,[new Eu(ve)].concat(zt.map(function(Jn){return Jn()}))):$o(Ft,zt.map(function(Jn){return Jn()}))}},T.memberExpressionHandler=function(D){var ve=this.createClosure(D.object),Ne=this.createMemberKeyGetter(D);return function(){return ve()[Ne()]}},T.thisExpressionHandler=function(D){var ve=this;return function(){return ve.getCurrentContext()}},T.sequenceExpressionHandler=function(D){var ve=this,Ne=D.expressions.map(function(mt){return ve.createClosure(mt)});return function(){for(var mt,zt=Ne.length,Ft=0;Ft<zt;Ft++)mt=(0,Ne[Ft])();return mt}},T.literalHandler=function(D){return function(){return D.regex?new RegExp(D.regex.pattern,D.regex.flags):D.value}},T.identifierHandler=function(D){var ve=this;return function(){var Ne=ve.getCurrentScope(),mt=ve.getScopeDataFromName(D.name,Ne);return ve.assertVariable(mt,D.name,D),mt[D.name]}},T.getIdentifierScope=function(D){var ve=this.getCurrentScope();return this.getScopeFromName(D.name,ve)},T.assignmentExpressionHandler=function(D){var ve=this;"Identifier"===D.left.type&&"FunctionExpression"===D.right.type&&!D.right.id&&(D.right.id={type:"Identifier",name:D.left.name});var Ne=this.createObjectGetter(D.left),mt=this.createNameGetter(D.left),zt=this.createClosure(D.right);return function(){var Ft=Ne(),Or=mt(),zr=zt();switch("="!==D.operator&&ve.assertVariable(Ft,Or,D),D.operator){case"=":return Ft[Or]=zr;case"+=":return Ft[Or]+=zr;case"-=":return Ft[Or]-=zr;case"*=":return Ft[Or]*=zr;case"**=":return Ft[Or]=Math.pow(Ft[Or],zr);case"/=":return Ft[Or]/=zr;case"%=":return Ft[Or]%=zr;case"<<=":return Ft[Or]<<=zr;case">>=":return Ft[Or]>>=zr;case">>>=":return Ft[Or]>>>=zr;case"&=":return Ft[Or]&=zr;case"^=":return Ft[Or]^=zr;case"|=":return Ft[Or]|=zr;default:throw ve.createInternalThrowError(Ma.AssignmentExpressionSyntaxError,D.type,D)}}},T.functionDeclarationHandler=function(D){if(D.id){var ve=this.functionExpressionHandler(D);Object.defineProperty(ve,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(D.id.name,ve)}return function(){return xi}},T.getVariableName=function(D){if("Identifier"===D.type)return D.name;throw this.createInternalThrowError(Ma.VariableTypeSyntaxError,D.type,D)},T.variableDeclarationHandler=function(D){for(var Ne,ve=this,mt=[],zt=0;zt<D.declarations.length;zt++){var Ft=D.declarations[zt];this.varDeclaration(this.getVariableName(Ft.id)),Ft.init&&mt.push({type:"AssignmentExpression",operator:"=",left:Ft.id,right:Ft.init})}return mt.length&&(Ne=this.createClosure({type:"BlockStatement",body:mt})),function(){if(Ne){var Or=ve.isVarDeclMode;ve.isVarDeclMode=!0,Ne(),ve.isVarDeclMode=Or}return xi}},T.assertVariable=function(D,ve,Ne){if(D===this.globalScope.data&&!(ve in D))throw this.createInternalThrowError(Ma.VariableUndefinedReferenceError,ve,Ne)},T.programHandler=function(D){var ve=this,Ne=D.body.map(function(mt){return ve.createClosure(mt)});return function(){for(var mt=xi,zt=0;zt<Ne.length;zt++){var Or=ve.setValue((0,Ne[zt])());if(Or!==xi&&((mt=Or)instanceof Qo||mt instanceof Lo||mt instanceof es||mt===ar||mt===Kr))break}return mt}},T.expressionStatementHandler=function(D){return this.createClosure(D.expression)},T.emptyStatementHandler=function(D){return function(){return xi}},T.returnStatementHandler=function(D){var ve=D.argument?this.createClosure(D.argument):ks;return function(){return new Qo(ve())}},T.ifStatementHandler=function(D){var ve=this.createClosure(D.test),Ne=this.createClosure(D.consequent),mt=D.alternate?this.createClosure(D.alternate):function(){return xi};return function(){return ve()?Ne():mt()}},T.conditionalExpressionHandler=function(D){return this.ifStatementHandler(D)},T.forStatementHandler=function(D){var ve=this,Ne=ks,mt=D.test?this.createClosure(D.test):function(){return!0},zt=ks,Ft=this.createClosure(D.body);return"ForStatement"===D.type&&(Ne=D.init?this.createClosure(D.init):Ne,zt=D.update?this.createClosure(D.update):ks),function(Or){var zr,Jn=xi,bi="DoWhileStatement"===D.type;for(Or&&"LabeledStatement"===Or.type&&(zr=Or.label.name),Ne();bi||mt();zt()){bi=!1;var pi=ve.setValue(Ft());if(pi!==xi&&pi!==Kr){if(pi===ar)break;if((Jn=pi)instanceof es&&Jn.value===zr){Jn=xi;continue}if(Jn instanceof Qo||Jn instanceof Lo||Jn instanceof es)break}}return Jn}},T.whileStatementHandler=function(D){return this.forStatementHandler(D)},T.doWhileStatementHandler=function(D){return this.forStatementHandler(D)},T.forInStatementHandler=function(D){var ve=this,Ne=D.left,mt=this.createClosure(D.right),zt=this.createClosure(D.body);return"VariableDeclaration"===D.left.type&&(this.createClosure(D.left)(),Ne=D.left.declarations[0].id),function(Ft){var Or,Jn,zr=xi;Ft&&"LabeledStatement"===Ft.type&&(Or=Ft.label.name);var bi=mt();for(Jn in bi){ve.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:Ne,right:{type:"Literal",value:Jn}})();var pi=ve.setValue(zt());if(pi!==xi&&pi!==Kr){if(pi===ar)break;if((zr=pi)instanceof es&&zr.value===Or){zr=xi;continue}if(zr instanceof Qo||zr instanceof Lo||zr instanceof es)break}}return zr}},T.withStatementHandler=function(D){var ve=this,Ne=this.createClosure(D.object),mt=this.createClosure(D.body);return function(){var zt=Ne(),Ft=ve.getCurrentScope(),Or=new ts(zt,Ft,lo);ve.setCurrentScope(Or);var zr=ve.setValue(mt());return ve.setCurrentScope(Ft),zr}},T.throwStatementHandler=function(D){var ve=this,Ne=this.createClosure(D.argument);return function(){throw ve.setValue(void 0),Ne()}},T.tryStatementHandler=function(D){var ve=this,Ne=this.createClosure(D.block),mt=D.handler?this.catchClauseHandler(D.handler):null,zt=D.finalizer?this.createClosure(D.finalizer):null;return function(){var pi,oa,Ft=ve.getCurrentScope(),Or=ve.getCurrentContext(),zr=Ft.labelStack.concat([]),Jn=ve.callStack.concat([]),bi=xi,Ea=function(){ve.setCurrentScope(Ft),ve.setCurrentContext(Or),Ft.labelStack=zr,ve.callStack=Jn};try{(bi=ve.setValue(Ne()))instanceof Qo&&(pi=bi)}catch(Na){if(Ea(),ve.isInterruptThrow(Na))throw Na;if(mt)try{(bi=ve.setValue(mt(Na)))instanceof Qo&&(pi=bi)}catch(vi){if(Ea(),ve.isInterruptThrow(vi))throw vi;oa=vi}}if(zt)try{(bi=zt())instanceof Qo&&(pi=bi)}catch(Na){if(Ea(),ve.isInterruptThrow(Na))throw Na;oa=Na}if(oa)throw oa;return pi||bi}},T.catchClauseHandler=function(D){var ve=this,Ne=this.createParamNameGetter(D.param),mt=this.createClosure(D.body);return function(zt){var Ft,zr=ve.getCurrentScope().data,Jn=Ne(),bi=bt.call(zr,Jn),pi=zr[Jn];return zr[Jn]=zt,Ft=mt(),bi?zr[Jn]=pi:delete zr[Jn],Ft}},T.continueStatementHandler=function(D){return function(){return D.label?new es(D.label.name):Kr}},T.breakStatementHandler=function(D){return function(){return D.label?new Lo(D.label.name):ar}},T.switchStatementHandler=function(D){var ve=this,Ne=this.createClosure(D.discriminant),mt=D.cases.map(function(zt){return ve.switchCaseHandler(zt)});return function(){for(var Or,zr,Jn,zt=Ne(),Ft=!1,bi=0;bi<mt.length;bi++){var pi=mt[bi](),oa=pi.testClosure();if(oa!==$n){if(Ft||oa===zt){if(Ft=!0,(zr=ve.setValue(pi.bodyClosure()))===xi)continue;if(zr===ar||(Or=zr)instanceof Qo||Or instanceof Lo||Or instanceof es||Or===Kr)break}}else Jn=pi}return!Ft&&Jn&&((zr=ve.setValue(Jn.bodyClosure()))===xi||zr===ar||zr===Kr||(Or=zr)),Or}},T.switchCaseHandler=function(D){var ve=D.test?this.createClosure(D.test):function(){return $n},Ne=this.createClosure({type:"BlockStatement",body:D.consequent});return function(){return{testClosure:ve,bodyClosure:Ne}}},T.labeledStatementHandler=function(D){var ve=this,Ne=D.label.name,mt=this.createClosure(D.body);return function(){var zt,Ft=ve.getCurrentScope();return Ft.labelStack.push(Ne),(zt=mt(D))instanceof Lo&&zt.value===Ne&&(zt=xi),Ft.labelStack.pop(),zt}},T.debuggerStatementHandler=function(D){return function(){return xi}},T.createParamNameGetter=function(D){if("Identifier"===D.type)return function(){return D.name};throw this.createInternalThrowError(Ma.ParamTypeSyntaxError,D.type,D)},T.createObjectKeyGetter=function(D){var ve;return ve="Identifier"===D.type?function(){return D.name}:this.createClosure(D),function(){return ve()}},T.createMemberKeyGetter=function(D){return D.computed?this.createClosure(D.property):this.createObjectKeyGetter(D.property)},T.createObjectGetter=function(D){var ve=this;switch(D.type){case"Identifier":return function(){return ve.getScopeDataFromName(D.name,ve.getCurrentScope())};case"MemberExpression":return this.createClosure(D.object);default:throw this.createInternalThrowError(Ma.AssignmentTypeSyntaxError,D.type,D)}},T.createNameGetter=function(D){switch(D.type){case"Identifier":return function(){return D.name};case"MemberExpression":return this.createMemberKeyGetter(D);default:throw this.createInternalThrowError(Ma.AssignmentTypeSyntaxError,D.type,D)}},T.varDeclaration=function(D){this.collectDeclVars[D]=void 0},T.funcDeclaration=function(D,ve){this.collectDeclFuncs[D]=ve},T.addDeclarationsToScope=function(D,ve,Ne){var mt=Ne.data;for(var zt in ve){var Ft=ve[zt];mt[zt]=Ft&&Ft()}for(var Or in D)Or in mt||(mt[Or]=void 0)},T.getScopeValue=function(D,ve){return this.getScopeFromName(D,ve).data[D]},T.getScopeDataFromName=function(D,ve){return this.getScopeFromName(D,ve).data},T.getScopeFromName=function(D,ve){var Ne=ve;do{if(D in Ne.data)return Ne}while(Ne=Ne.parent);return this.globalScope},T.setValue=function(D){return this.isVarDeclMode||this.callStack.length||D===xi||D===ar||D===Kr||D instanceof Lo||D instanceof es||(this.value=D instanceof Qo?D.value:D),D},T.getValue=function(){return this.value},m}();function Ol(m){return void 0===m&&(m=Object.create(null)),m}function Ll(m,T,Y){void 0===T&&(T=[]),void 0===Y&&(Y={});var D=Y.parsingContext,ve=void 0===Y.timeout?0:Y.timeout,Ne="\n    (function anonymous("+T.join(",")+"){\n         "+m+"\n    });\n    ";return new ko(D,{ecmaVersion:Y.ecmaVersion,timeout:ve,rootContext:Y.rootContext,globalContextInFunction:Y.globalContextInFunction}).evaluate(Ne)}function kl(m,T,Y){return new ko(T,Y).evaluate(m)}ko.version="0.0.2",ko.eval=fl,ko.Function=Wo,ko.ecmaVersion=5,ko.globalContextInFunction=void 0,ko.global=Object.create(null);var wc=kl,Rl=function(){function m(Y){this._code=Y}var T=m.prototype;return T.runInContext=function(D){return kl(this._code,D)},T.runInNewContext=function(D){return kl(this._code,D)},m}();const hl=function(m,T,Y){return kl(m,T,Y)};function eu(){for(var m=arguments.length,T=new Array(m),Y=0;Y<m;Y++)T[Y]=arguments[Y];var D=T.pop();return Ll(D||"",T)}const Dl=hl},35296:function(ie,L,y){ie.exports=function(M){"use strict";var _=function(q){return q instanceof Uint8Array||q instanceof Uint16Array||q instanceof Uint32Array||q instanceof Int8Array||q instanceof Int16Array||q instanceof Int32Array||q instanceof Float32Array||q instanceof Float64Array||q instanceof Uint8ClampedArray},c=function(q,De){for(var it=Object.keys(De),lr=0;lr<it.length;++lr)q[it[lr]]=De[it[lr]];return q},g="\n";function O(q){return"undefined"!=typeof atob?atob(q):"base64:"+q}function R(q){var De=new Error("(regl) "+q);throw console.error(De),De}function B(q,De){q||R(De)}function H(q){return q?": "+q:""}function Be(q,De){switch(De){case"number":return"number"==typeof q;case"object":return"object"==typeof q;case"string":return"string"==typeof q;case"boolean":return"boolean"==typeof q;case"function":return"function"==typeof q;case"undefined":return void 0===q;case"symbol":return"symbol"==typeof q}}function Ke(q,De,it){De.indexOf(q)<0&&R("invalid value"+H(it)+". must be one of: "+De)}var xt=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Et(q,De){for(q+="";q.length<De;)q=" "+q;return q}function ut(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function tt(q,De){this.number=q,this.line=De,this.errors=[]}function Gt(q,De,it){this.file=q,this.line=De,this.message=it}function Q(){var q=new Error,De=(q.stack||q).toString(),it=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(De);if(it)return it[1];var lr=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(De);return lr?lr[1]:"unknown"}function Vt(){var q=new Error,De=(q.stack||q).toString(),it=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(De);if(it)return it[1];var lr=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(De);return lr?lr[1]:"unknown"}function ot(q,De){var it=q.split("\n"),lr=1,kr=0,sr={unknown:new ut,0:new ut};sr.unknown.name=sr[0].name=De||Q(),sr.unknown.lines.push(new tt(0,""));for(var Cr=0;Cr<it.length;++Cr){var Ur=it[Cr],Gr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Ur);if(Gr)switch(Gr[1]){case"line":var Yr=/(\d+)(\s+\d+)?/.exec(Gr[2]);Yr&&(lr=0|Yr[1],Yr[2]&&((kr=0|Yr[2])in sr||(sr[kr]=new ut)));break;case"define":var qr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Gr[2]);qr&&(sr[kr].name=qr[1]?O(qr[2]):qr[2])}sr[kr].lines.push(new tt(lr++,Ur))}return Object.keys(sr).forEach(function(en){var pn=sr[en];pn.lines.forEach(function(Hr){pn.index[Hr.number]=Hr})}),sr}function kt(q){q._commandRef=Q()}function Er(q,De){var it=Vt();R(q+" in command "+(De||Q())+("unknown"===it?"":" called from "+it))}function oe(q,De,it,lr){Be(q,De)||Er("invalid parameter type"+H(it)+". expected "+De+", got "+typeof q,lr||Q())}var Ge=33071,K={};function Ve(q,De){return 32820===q||32819===q||33635===q?2:34042===q?4:K[q]*De}function nt(q){return!(q&q-1||!q)}K[5120]=K[5121]=1,K[5122]=K[5123]=K[36193]=K[33635]=K[32819]=K[32820]=2,K[5124]=K[5125]=K[5126]=K[34042]=4;var Z=c(B,{optional:function(q){q()},raise:R,commandRaise:Er,command:function(q,De,it){q||Er(De,it||Q())},parameter:function(q,De,it){q in De||R("unknown parameter ("+q+")"+H(it)+". possible values: "+Object.keys(De).join())},commandParameter:function(q,De,it,lr){q in De||Er("unknown parameter ("+q+")"+H(it)+". possible values: "+Object.keys(De).join(),lr||Q())},constructor:function(q){Object.keys(q).forEach(function(De){xt.indexOf(De)<0&&R('invalid regl constructor argument "'+De+'". must be one of '+xt)})},type:function(q,De,it){Be(q,De)||R("invalid parameter type"+H(it)+". expected "+De+", got "+typeof q)},commandType:oe,isTypedArray:function(q,De){_(q)||R("invalid parameter type"+H(De)+". must be a typed array")},nni:function(q,De){q>=0&&(0|q)===q||R("invalid parameter type, ("+q+")"+H(De)+". must be a nonnegative integer")},oneOf:Ke,shaderError:function(q,De,it,lr,kr){if(!q.getShaderParameter(De,q.COMPILE_STATUS)){var sr=q.getShaderInfoLog(De),Cr=lr===q.FRAGMENT_SHADER?"fragment":"vertex";oe(it,"string",Cr+" shader source must be a string",kr);var Ur=ot(it,kr),Gr=function(q){var De=[];return q.split("\n").forEach(function(it){if(!(it.length<5)){var lr=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(it);lr?De.push(new Gt(0|lr[1],0|lr[2],lr[3].trim())):it.length>0&&De.push(new Gt("unknown",0,it))}}),De}(sr);(function(q,De){De.forEach(function(it){var lr=q[it.file];if(lr){var kr=lr.index[it.line];if(kr)return kr.errors.push(it),void(lr.hasErrors=!0)}q.unknown.hasErrors=!0,q.unknown.lines[0].errors.push(it)})})(Ur,Gr),Object.keys(Ur).forEach(function(Yr){var qr=Ur[Yr];if(qr.hasErrors){var en=[""],pn=[""];Hr("file number "+Yr+": "+qr.name+"\n","color:red;text-decoration:underline;font-weight:bold"),qr.lines.forEach(function(tn){if(tn.errors.length>0){Hr(Et(tn.number,4)+"|  ","background-color:yellow; font-weight:bold"),Hr(tn.line+g,"color:red; background-color:yellow; font-weight:bold");var Zt=0;tn.errors.forEach(function(yr){var Wr=yr.message,An=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Wr);if(An){var Mr=An[1];switch(Wr=An[2],Mr){case"assign":Mr="="}Zt=Math.max(tn.line.indexOf(Mr,Zt),0)}else Zt=0;Hr(Et("| ",6)),Hr(Et("^^^",Zt+3)+g,"font-weight:bold"),Hr(Et("| ",6)),Hr(Wr+g,"font-weight:bold")}),Hr(Et("| ",6)+g)}else Hr(Et(tn.number,4)+"|  "),Hr(tn.line+g,"color:red")}),"undefined"==typeof document||window.chrome?console.log(en.join("")):(pn[0]=en.join("%c"),console.log.apply(console,pn))}function Hr(tn,Zt){en.push(tn),pn.push(Zt||"")}}),B.raise("Error compiling "+Cr+" shader, "+Ur[0].name)}},linkError:function(q,De,it,lr,kr){if(!q.getProgramParameter(De,q.LINK_STATUS)){var sr=q.getProgramInfoLog(De),Cr=ot(it,kr),Gr='Error linking program with vertex shader, "'+ot(lr,kr)[0].name+'", and fragment shader "'+Cr[0].name+'"';"undefined"!=typeof document?console.log("%c"+Gr+"\n%c"+sr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Gr+g+sr),B.raise(Gr)}},callSite:Vt,saveCommandRef:kt,saveDrawInfo:function(q,De,it,lr){function kr(Gr){return Gr?lr.id(Gr):0}function sr(Gr,Yr){Object.keys(Yr).forEach(function(qr){Gr[lr.id(qr)]=!0})}kt(q),q._fragId=kr(q.static.frag),q._vertId=kr(q.static.vert);var Cr=q._uniformSet={};sr(Cr,De.static),sr(Cr,De.dynamic);var Ur=q._attributeSet={};sr(Ur,it.static),sr(Ur,it.dynamic),q._hasCount="count"in q.static||"count"in q.dynamic||"elements"in q.static||"elements"in q.dynamic},framebufferFormat:function(q,De,it){q.texture?Ke(q.texture._texture.internalformat,De,"unsupported texture format for attachment"):Ke(q.renderbuffer._renderbuffer.format,it,"unsupported renderbuffer format for attachment")},guessCommand:Q,texture2D:function(q,De,it){var lr,kr=De.width,sr=De.height,Cr=De.channels;B(kr>0&&kr<=it.maxTextureSize&&sr>0&&sr<=it.maxTextureSize,"invalid texture shape"),(q.wrapS!==Ge||q.wrapT!==Ge)&&B(nt(kr)&&nt(sr),"incompatible wrap mode for texture, both width and height must be power of 2"),1===De.mipmask?1!==kr&&1!==sr&&B(9984!==q.minFilter&&9986!==q.minFilter&&9985!==q.minFilter&&9987!==q.minFilter,"min filter requires mipmap"):(B(nt(kr)&&nt(sr),"texture must be a square power of 2 to support mipmapping"),B(De.mipmask===(kr<<1)-1,"missing or incomplete mipmap data")),5126===De.type&&(it.extensions.indexOf("oes_texture_float_linear")<0&&B(9728===q.minFilter&&9728===q.magFilter,"filter not supported, must enable oes_texture_float_linear"),B(!q.genMipmaps,"mipmap generation not supported with float textures"));var Ur=De.images;for(lr=0;lr<16;++lr)if(Ur[lr]){var Gr=kr>>lr,Yr=sr>>lr;B(De.mipmask&1<<lr,"missing mipmap data");var qr=Ur[lr];if(B(qr.width===Gr&&qr.height===Yr,"invalid shape for mip images"),B(qr.format===De.format&&qr.internalformat===De.internalformat&&qr.type===De.type,"incompatible type for mip image"),!qr.compressed&&qr.data){var en=Math.ceil(Ve(qr.type,Cr)*Gr/qr.unpackAlignment)*qr.unpackAlignment;B(qr.data.byteLength===en*Yr,"invalid data for image, buffer size is inconsistent with image format")}}else q.genMipmaps||B(0==(De.mipmask&1<<lr),"extra mipmap data");De.compressed&&B(!q.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(q,De,it,lr){var kr=q.width,sr=q.height,Cr=q.channels;B(kr>0&&kr<=lr.maxTextureSize&&sr>0&&sr<=lr.maxTextureSize,"invalid texture shape"),B(kr===sr,"cube map must be square"),B(De.wrapS===Ge&&De.wrapT===Ge,"wrap mode not supported by cube map");for(var Ur=0;Ur<it.length;++Ur){var Gr=it[Ur];B(Gr.width===kr&&Gr.height===sr,"inconsistent cube map face shape"),De.genMipmaps&&(B(!Gr.compressed,"can not generate mipmap for compressed textures"),B(1===Gr.mipmask,"can not specify mipmaps and generate mipmaps"));for(var Yr=Gr.images,qr=0;qr<16;++qr){var en=Yr[qr];if(en){var pn=kr>>qr,Hr=sr>>qr;B(Gr.mipmask&1<<qr,"missing mipmap data"),B(en.width===pn&&en.height===Hr,"invalid shape for mip images"),B(en.format===q.format&&en.internalformat===q.internalformat&&en.type===q.type,"incompatible type for mip image"),en.compressed||en.data&&B(en.data.byteLength===pn*Hr*Math.max(Ve(en.type,Cr),en.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}}),Ze=0;function Tr(q,De){this.id=Ze++,this.type=q,this.data=De}function vr(q){return q.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function Xt(q){if(0===q.length)return[];var De=q.charAt(0),it=q.charAt(q.length-1);if(q.length>1&&De===it&&('"'===De||"'"===De))return['"'+vr(q.substr(1,q.length-2))+'"'];var lr=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(q);if(lr)return Xt(q.substr(0,lr.index)).concat(Xt(lr[1])).concat(Xt(q.substr(lr.index+lr[0].length)));var kr=q.split(".");if(1===kr.length)return['"'+vr(q)+'"'];for(var sr=[],Cr=0;Cr<kr.length;++Cr)sr=sr.concat(Xt(kr[Cr]));return sr}function mr(q){return"["+Xt(q).join("][")+"]"}var On={DynamicVariable:Tr,define:function(q,De){return new Tr(q,mr(De+""))},isDynamic:function(q){return"function"==typeof q&&!q._reglType||q instanceof Tr},unbox:function mn(q,De){return"function"==typeof q?new Tr(0,q):"number"==typeof q||"boolean"==typeof q?new Tr(5,q):Array.isArray(q)?new Tr(6,q.map(function(it,lr){return mn(it,De+"["+lr+"]")})):q instanceof Tr?q:void Z(!1,"invalid option type in uniform "+De)},accessor:mr},mi={next:"function"==typeof requestAnimationFrame?function(q){return requestAnimationFrame(q)}:function(q){return setTimeout(q,16)},cancel:"function"==typeof cancelAnimationFrame?function(q){return cancelAnimationFrame(q)}:clearTimeout},si="undefined"!=typeof my&&my&&"function"==typeof my.showToast?function(){return+new Date}:"undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function pe(q){return"string"==typeof q?q.split():(Z(Array.isArray(q),"invalid extension array"),q)}function _e(q){return"string"==typeof q?(Z("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(q)):q}function V(q){var it,lr,kr,sr,De=q||{},Cr={},Ur=[],Gr=[],Yr="undefined"==typeof window?1:window.devicePixelRatio,qr=!1,en=function(tn){tn&&Z.raise(tn)},pn=function(){};if("string"==typeof De?(Z("undefined"!=typeof document,"selector queries only supported in DOM environments"),it=document.querySelector(De),Z(it,"invalid query string for element")):"object"==typeof De?function(q){return"string"==typeof q.nodeName&&"function"==typeof q.appendChild&&"function"==typeof q.getBoundingClientRect}(De)?it=De:function(q){return"function"==typeof q.drawArrays||"function"==typeof q.drawElements}(De)?kr=(sr=De).canvas:(Z.constructor(De),"gl"in De?sr=De.gl:"canvas"in De?kr=_e(De.canvas):"container"in De&&(lr=_e(De.container)),"attributes"in De&&Z.type(Cr=De.attributes,"object","invalid context attributes"),"extensions"in De&&(Ur=pe(De.extensions)),"optionalExtensions"in De&&(Gr=pe(De.optionalExtensions)),"onDone"in De&&(Z.type(De.onDone,"function","invalid or missing onDone callback"),en=De.onDone),"profile"in De&&(qr=!!De.profile),"pixelRatio"in De&&Z((Yr=+De.pixelRatio)>0,"invalid pixel ratio")):Z.raise("invalid arguments to regl"),it&&("canvas"===it.nodeName.toLowerCase()?kr=it:lr=it),!sr){if(!kr){Z("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var Hr=function(q,De,it){var sr,lr=document.createElement("canvas");function kr(){var Ur=window.innerWidth,Gr=window.innerHeight;if(q!==document.body){var Yr=lr.getBoundingClientRect();Ur=Yr.right-Yr.left,Gr=Yr.bottom-Yr.top}lr.width=it*Ur,lr.height=it*Gr}return c(lr.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),q.appendChild(lr),q===document.body&&(lr.style.position="absolute",c(q.style,{margin:0,padding:0})),q!==document.body&&"function"==typeof ResizeObserver?(sr=new ResizeObserver(function(){setTimeout(kr)})).observe(q):window.addEventListener("resize",kr,!1),kr(),{canvas:lr,onDestroy:function(){sr?sr.disconnect():window.removeEventListener("resize",kr),q.removeChild(lr)}}}(lr||document.body,0,Yr);if(!Hr)return null;kr=Hr.canvas,pn=Hr.onDestroy}void 0===Cr.premultipliedAlpha&&(Cr.premultipliedAlpha=!0),sr=function(q,De){function it(lr){try{return q.getContext(lr,De)}catch(kr){return null}}return it("webgl")||it("experimental-webgl")||it("webgl-experimental")}(kr,Cr)}return sr?{gl:sr,canvas:kr,container:lr,extensions:Ur,optionalExtensions:Gr,pixelRatio:Yr,profile:qr,onDone:en,onDestroy:pn}:(pn(),en("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ae(q,De){var it={};function lr(Ur){Z.type(Ur,"string","extension name must be string");var Yr,Gr=Ur.toLowerCase();try{Yr=it[Gr]=function(Ur){return q.getExtension(Ur)?q.getExtension(Ur):q.getExtension(Ur.toLowerCase())?q.getExtension(Ur.toLowerCase()):null}(Ur)}catch(qr){}return!!Yr}for(var sr=0;sr<De.extensions.length;++sr){var Cr=De.extensions[sr];if(!lr(Cr))return De.onDestroy(),De.onDone('"'+Cr+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return De.optionalExtensions.forEach(lr),{extensions:it,restore:function(){Object.keys(it).forEach(function(Ur){if(it[Ur]&&!lr(Ur))throw new Error("(regl): error restoring extension "+Ur)})}}}function xe(q,De){for(var it=Array(q),lr=0;lr<q;++lr)it[lr]=De(lr);return it}function Rn(q){var De,it;return De=(q>65535)<<4,De|=it=((q>>>=De)>255)<<3,De|=it=((q>>>=it)>15)<<2,(De|=it=((q>>>=it)>3)<<1)|(q>>>=it)>>1}function Pn(){var q=xe(8,function(){return[]});function De(sr){var Cr=function(q){for(var De=16;De<=1<<28;De*=16)if(q<=De)return De;return 0}(sr),Ur=q[Rn(Cr)>>2];return Ur.length>0?Ur.pop():new ArrayBuffer(Cr)}function it(sr){q[Rn(sr.byteLength)>>2].push(sr)}return{alloc:De,free:it,allocType:function(sr,Cr){var Ur=null;switch(sr){case 5120:Ur=new Int8Array(De(Cr),0,Cr);break;case 5121:Ur=new Uint8Array(De(Cr),0,Cr);break;case 5122:Ur=new Int16Array(De(2*Cr),0,Cr);break;case 5123:Ur=new Uint16Array(De(2*Cr),0,Cr);break;case 5124:Ur=new Int32Array(De(4*Cr),0,Cr);break;case 5125:Ur=new Uint32Array(De(4*Cr),0,Cr);break;case 5126:Ur=new Float32Array(De(4*Cr),0,Cr);break;default:return null}return Ur.length!==Cr?Ur.subarray(0,Cr):Ur},freeType:function(sr){it(sr.buffer)}}}var rr=Pn();rr.zero=Pn();var aa=6408;function bt(q){return!!q&&"object"==typeof q&&Array.isArray(q.shape)&&Array.isArray(q.stride)&&"number"==typeof q.offset&&q.shape.length===q.stride.length&&(Array.isArray(q.data)||_(q.data))}var ar=function(q){return Object.keys(q).map(function(De){return q[De]})},Kr={shape:function(q){for(var De=[],it=q;it.length;it=it[0])De.push(it.length);return De},flatten:function(q,De,it,lr){var kr=1;if(De.length)for(var sr=0;sr<De.length;++sr)kr*=De[sr];else kr=0;var Cr=lr||rr.allocType(it,kr);switch(De.length){case 0:break;case 1:!function(q,De,it){for(var lr=0;lr<De;++lr)it[lr]=q[lr]}(q,De[0],Cr);break;case 2:!function(q,De,it,lr){for(var kr=0,sr=0;sr<De;++sr)for(var Cr=q[sr],Ur=0;Ur<it;++Ur)lr[kr++]=Cr[Ur]}(q,De[0],De[1],Cr);break;case 3:lo(q,De[0],De[1],De[2],Cr,0);break;default:ro(q,De,0,Cr,0)}return Cr}};function lo(q,De,it,lr,kr,sr){for(var Cr=sr,Ur=0;Ur<De;++Ur)for(var Gr=q[Ur],Yr=0;Yr<it;++Yr)for(var qr=Gr[Yr],en=0;en<lr;++en)kr[Cr++]=qr[en]}function ro(q,De,it,lr,kr){for(var sr=1,Cr=it+1;Cr<De.length;++Cr)sr*=De[Cr];var Ur=De[it];if(De.length-it==4){var Gr=De[it+1],Yr=De[it+2],qr=De[it+3];for(Cr=0;Cr<Ur;++Cr)lo(q[Cr],Gr,Yr,qr,lr,kr),kr+=sr}else for(Cr=0;Cr<Ur;++Cr)ro(q[Cr],De,it+1,lr,kr),kr+=sr}var du={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Qs={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ko={dynamic:35048,stream:35040,static:35044},Ol=Kr.flatten,Ll=Kr.shape,eu=[];function Dl(q){return 0|du[Object.prototype.toString.call(q)]}function m(q,De){for(var it=0;it<De.length;++it)q[it]=De[it]}function T(q,De,it,lr,kr,sr,Cr){for(var Ur=0,Gr=0;Gr<it;++Gr)for(var Yr=0;Yr<lr;++Yr)q[Ur++]=De[kr*Gr+sr*Yr+Cr]}eu[5120]=1,eu[5122]=2,eu[5124]=4,eu[5121]=1,eu[5123]=2,eu[5125]=4,eu[5126]=4;var Or={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},oa=5121,Na=5123,Xo=5125;var Bl=new Float32Array(1),mu=new Uint32Array(Bl.buffer);function tu(q){for(var De=rr.allocType(5123,q.length),it=0;it<q.length;++it)if(isNaN(q[it]))De[it]=65535;else if(q[it]===1/0)De[it]=31744;else if(q[it]===-1/0)De[it]=64512;else{Bl[0]=q[it];var lr=mu[0],kr=lr>>>31<<15,sr=(lr<<1>>>24)-127,Cr=lr>>13&1023;De[it]=sr<-24?kr:sr<-14?kr+(Cr+1024>>-14-sr):sr>15?kr+31744:kr+(sr+15<<10)+Cr}return De}function oo(q){return Array.isArray(q)||_(q)}var Tc=function(q){return!(q&q-1||!q)},rs=3553,ru=34069,Rs=6408,La=6409,pl=34041,dl=36193,zu=5121,Vs=5126,yl=33984,Ro=[9984,9986,9985,9987],Nn=[0,La,6410,6407,Rs],za={};function ju(q){return"[object "+q+"]"}za[La]=za[6406]=za[6402]=1,za[pl]=za[6410]=2,za[6407]=za[35904]=3,za[Rs]=za[35906]=4;var _l=ju("HTMLCanvasElement"),iu=ju("OffscreenCanvas"),Es=ju("CanvasRenderingContext2D"),Xc=ju("ImageBitmap"),hn=ju("HTMLImageElement"),Kc=ju("HTMLVideoElement"),Oc=Object.keys(du).concat([_l,iu,Es,Xc,hn,Kc]),xl=[];xl[zu]=1,xl[Vs]=4,xl[dl]=2,xl[5123]=2,xl[5125]=4;var Ga=[];function Ts(q){return Array.isArray(q)&&(0===q.length||"number"==typeof q[0])}function sc(q){return!!Array.isArray(q)&&!(0===q.length||!oo(q[0]))}function au(q){return Object.prototype.toString.call(q)}function Ds(q){return au(q)===_l}function Hs(q){return au(q)===iu}function Ws(q){return!!("undefined"!=typeof my&&my&&"function"==typeof my.showToast&&q&&q.getContext)}function Cs(q){if(!q)return!1;if(Ws(q))return!0;var De=au(q);return Oc.indexOf(De)>=0||Ts(q)||sc(q)||bt(q)}function $i(q){return 0|du[Object.prototype.toString.call(q)]}function Bs(q,De){return rr.allocType(q.type===dl?Vs:q.type,De)}function Ko(q,De){q.type===dl?(q.data=tu(De),rr.freeType(De)):q.data=De}function bu(q,De,it,lr,kr,sr){var Cr;if(Cr=void 0!==Ga[q]?Ga[q]:za[q]*xl[De],sr&&(Cr*=6),kr){for(var Ur=0,Gr=it;Gr>=1;)Ur+=Cr*Gr*Gr,Gr/=2;return Ur}return Cr*it*lr}function ou(q,De,it,lr,kr,sr,Cr){var Ur={"don't care":4352,"dont care":4352,nice:4354,fast:4353},Gr={repeat:10497,clamp:33071,mirror:33648},Yr={nearest:9728,linear:9729},qr=c({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Yr),en={none:0,browser:37444},pn={uint8:zu,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Hr={alpha:6406,luminance:La,"luminance alpha":6410,rgb:6407,rgba:Rs,rgba4:32854,"rgb5 a1":32855,rgb565:36194},tn={};De.ext_srgb&&(Hr.srgb=35904,Hr.srgba=35906),De.oes_texture_float&&(pn.float32=pn.float=Vs),De.oes_texture_half_float&&(pn.float16=pn["half float"]=dl),De.webgl_depth_texture&&(c(Hr,{depth:6402,"depth stencil":pl}),c(pn,{uint16:5123,uint32:5125,"depth stencil":34042})),De.webgl_compressed_texture_s3tc&&c(tn,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),De.webgl_compressed_texture_atc&&c(tn,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),De.webgl_compressed_texture_pvrtc&&c(tn,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),De.webgl_compressed_texture_etc1&&(tn["rgb etc1"]=36196);var Zt=Array.prototype.slice.call(q.getParameter(34467)||new Uint32Array(0));Object.keys(tn).forEach(function(Qe){var dr=tn[Qe];Zt.indexOf(dr)>=0&&(Hr[Qe]=dr)});var yr=Object.keys(Hr);it.textureFormats=yr;var Wr=[];Object.keys(Hr).forEach(function(Qe){Wr[Hr[Qe]]=Qe});var An=[];Object.keys(pn).forEach(function(Qe){An[pn[Qe]]=Qe});var Mr=[];Object.keys(Yr).forEach(function(Qe){Mr[Yr[Qe]]=Qe});var wn=[];Object.keys(qr).forEach(function(Qe){wn[qr[Qe]]=Qe});var rn=[];Object.keys(Gr).forEach(function(Qe){rn[Gr[Qe]]=Qe});var ui=yr.reduce(function(Qe,dr){var tr=Hr[dr];return Qe[tr]=tr===La||6406===tr||tr===La||6410===tr||6402===tr||tr===pl||De.ext_srgb&&(35904===tr||35906===tr)?tr:32855===tr||dr.indexOf("rgba")>=0?Rs:6407,Qe},{});function Lr(){this.internalformat=Rs,this.format=Rs,this.type=zu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function wr(Qe,dr){Qe.internalformat=dr.internalformat,Qe.format=dr.format,Qe.type=dr.type,Qe.compressed=dr.compressed,Qe.premultiplyAlpha=dr.premultiplyAlpha,Qe.flipY=dr.flipY,Qe.unpackAlignment=dr.unpackAlignment,Qe.colorSpace=dr.colorSpace,Qe.width=dr.width,Qe.height=dr.height,Qe.channels=dr.channels}function Gn(Qe,dr){if("object"==typeof dr&&dr){if("premultiplyAlpha"in dr&&(Z.type(dr.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Qe.premultiplyAlpha=dr.premultiplyAlpha),"flipY"in dr&&(Z.type(dr.flipY,"boolean","invalid texture flip"),Qe.flipY=dr.flipY),"alignment"in dr&&(Z.oneOf(dr.alignment,[1,2,4,8],"invalid texture unpack alignment"),Qe.unpackAlignment=dr.alignment),"colorSpace"in dr&&(Z.parameter(dr.colorSpace,en,"invalid colorSpace"),Qe.colorSpace=en[dr.colorSpace]),"type"in dr){var tr=dr.type;Z(De.oes_texture_float||!("float"===tr||"float32"===tr),"you must enable the OES_texture_float extension in order to use floating point textures."),Z(De.oes_texture_half_float||!("half float"===tr||"float16"===tr),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),Z(De.webgl_depth_texture||!("uint16"===tr||"uint32"===tr||"depth stencil"===tr),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Z.parameter(tr,pn,"invalid texture type"),Qe.type=pn[tr]}var zn=Qe.width,ya=Qe.height,He=Qe.channels,Pe=!1;"shape"in dr?(Z(Array.isArray(dr.shape)&&dr.shape.length>=2,"shape must be an array"),zn=dr.shape[0],ya=dr.shape[1],3===dr.shape.length&&(Z((He=dr.shape[2])>0&&He<=4,"invalid number of channels"),Pe=!0),Z(zn>=0&&zn<=it.maxTextureSize,"invalid width"),Z(ya>=0&&ya<=it.maxTextureSize,"invalid height")):("radius"in dr&&(zn=ya=dr.radius,Z(zn>=0&&zn<=it.maxTextureSize,"invalid radius")),"width"in dr&&Z((zn=dr.width)>=0&&zn<=it.maxTextureSize,"invalid width"),"height"in dr&&Z((ya=dr.height)>=0&&ya<=it.maxTextureSize,"invalid height"),"channels"in dr&&(Z((He=dr.channels)>0&&He<=4,"invalid number of channels"),Pe=!0)),Qe.width=0|zn,Qe.height=0|ya,Qe.channels=0|He;var dt=!1;if("format"in dr){var Ut=dr.format;Z(De.webgl_depth_texture||!("depth"===Ut||"depth stencil"===Ut),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),Z.parameter(Ut,Hr,"invalid texture format");var cr=Qe.internalformat=Hr[Ut];Qe.format=ui[cr],Ut in pn&&("type"in dr||(Qe.type=pn[Ut])),Ut in tn&&(Qe.compressed=!0),dt=!0}!Pe&&dt?Qe.channels=za[Qe.format]:Pe&&!dt?Qe.channels!==Nn[Qe.format]&&(Qe.format=Qe.internalformat=Nn[Qe.channels]):dt&&Pe&&Z(Qe.channels===za[Qe.format],"number of channels inconsistent with specified format")}}function vn(Qe){q.pixelStorei(37440,Qe.flipY),q.pixelStorei(37441,Qe.premultiplyAlpha),q.pixelStorei(37443,Qe.colorSpace),q.pixelStorei(3317,Qe.unpackAlignment)}function Jr(){Lr.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function xn(Qe,dr){var tr=null;if(Cs(dr)?tr=dr:dr&&(Z.type(dr,"object","invalid pixel data type"),Gn(Qe,dr),"x"in dr&&(Qe.xOffset=0|dr.x),"y"in dr&&(Qe.yOffset=0|dr.y),Cs(dr.data)&&(tr=dr.data)),Z(!Qe.compressed||tr instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),dr.copy){Z(!tr,"can not specify copy and data field for the same texture");var zn=kr.viewportWidth,ya=kr.viewportHeight;Qe.width=Qe.width||zn-Qe.xOffset,Qe.height=Qe.height||ya-Qe.yOffset,Qe.needsCopy=!0,Z(Qe.xOffset>=0&&Qe.xOffset<zn&&Qe.yOffset>=0&&Qe.yOffset<ya&&Qe.width>0&&Qe.width<=zn&&Qe.height>0&&Qe.height<=ya,"copy texture read out of bounds")}else if(tr){if(_(tr))Qe.channels=Qe.channels||4,Qe.data=tr,!("type"in dr)&&Qe.type===zu&&(Qe.type=$i(tr));else if(Ts(tr))Qe.channels=Qe.channels||4,function(q,De){var it=De.length;switch(q.type){case zu:case 5123:case 5125:case Vs:var lr=rr.allocType(q.type,it);lr.set(De),q.data=lr;break;case dl:q.data=tu(De);break;default:Z.raise("unsupported texture type, must specify a typed array")}}(Qe,tr),Qe.alignment=1,Qe.needsFree=!0;else if(bt(tr)){var He=tr.data;!Array.isArray(He)&&Qe.type===zu&&(Qe.type=$i(He));var Ut,cr,Ct,_t,ht,ze,Pe=tr.shape,dt=tr.stride;3===Pe.length?(Ct=Pe[2],ze=dt[2]):(Z(2===Pe.length,"invalid ndarray pixel data, must be 2 or 3D"),Ct=1,ze=1),Ut=Pe[0],cr=Pe[1],_t=dt[0],ht=dt[1],Qe.alignment=1,Qe.width=Ut,Qe.height=cr,Qe.channels=Ct,Qe.format=Qe.internalformat=Nn[Ct],Qe.needsFree=!0,function(q,De,it,lr,kr,sr){for(var Cr=q.width,Ur=q.height,Gr=q.channels,qr=Bs(q,Cr*Ur*Gr),en=0,pn=0;pn<Ur;++pn)for(var Hr=0;Hr<Cr;++Hr)for(var tn=0;tn<Gr;++tn)qr[en++]=De[it*Hr+lr*pn+kr*tn+sr];Ko(q,qr)}(Qe,He,_t,ht,ze,tr.offset)}else if(Ws(tr)||Ds(tr)||Hs(tr)||function(q){return au(q)===Es}(tr))Qe.element=Ws(tr)||Ds(tr)||Hs(tr)?tr:tr.canvas,Qe.width=Qe.element.width,Qe.height=Qe.element.height,Qe.channels=4;else if(function(q){return au(q)===Xc}(tr))Qe.element=tr,Qe.width=tr.width,Qe.height=tr.height,Qe.channels=4;else if(function(q){return au(q)===hn}(tr))Qe.element=tr,Qe.width=tr.naturalWidth,Qe.height=tr.naturalHeight,Qe.channels=4;else if(function(q){return au(q)===Kc}(tr))Qe.element=tr,Qe.width=tr.videoWidth,Qe.height=tr.videoHeight,Qe.channels=4;else if(sc(tr)){var ct=Qe.width||tr[0].length,We=Qe.height||tr.length,jt=Qe.channels;jt=oo(tr[0][0])?jt||tr[0][0].length:jt||1;for(var $t=Kr.shape(tr),Zr=1,un=0;un<$t.length;++un)Zr*=$t[un];var ln=Bs(Qe,Zr);Kr.flatten(tr,$t,"",ln),Ko(Qe,ln),Qe.alignment=1,Qe.width=ct,Qe.height=We,Qe.channels=jt,Qe.format=Qe.internalformat=Nn[jt],Qe.needsFree=!0}}else Qe.width=Qe.width||1,Qe.height=Qe.height||1,Qe.channels=Qe.channels||4;Qe.type===Vs?Z(it.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Qe.type===dl&&Z(it.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function En(Qe,dr,tr){var zn=Qe.element,ya=Qe.data,He=Qe.internalformat,Pe=Qe.format,dt=Qe.type,Ut=Qe.width,cr=Qe.height;vn(Qe),zn?q.texImage2D(dr,tr,Pe,Pe,dt,zn):Qe.compressed?q.compressedTexImage2D(dr,tr,He,Ut,cr,0,ya):Qe.needsCopy?(lr(),q.copyTexImage2D(dr,tr,Pe,Qe.xOffset,Qe.yOffset,Ut,cr,0)):q.texImage2D(dr,tr,Pe,Ut,cr,0,Pe,dt,ya||null)}function zi(Qe,dr,tr,zn,ya){var He=Qe.element,Pe=Qe.data,dt=Qe.internalformat,Ut=Qe.format,cr=Qe.type,Ct=Qe.width,_t=Qe.height;vn(Qe),He?q.texSubImage2D(dr,ya,tr,zn,Ut,cr,He):Qe.compressed?q.compressedTexSubImage2D(dr,ya,tr,zn,dt,Ct,_t,Pe):Qe.needsCopy?(lr(),q.copyTexSubImage2D(dr,ya,tr,zn,Qe.xOffset,Qe.yOffset,Ct,_t)):q.texSubImage2D(dr,ya,tr,zn,Ct,_t,Ut,cr,Pe)}var Ii=[];function Cn(){return Ii.pop()||new Jr}function Tn(Qe){Qe.needsFree&&rr.freeType(Qe.data),Jr.call(Qe),Ii.push(Qe)}function _i(){Lr.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Zi(Qe,dr,tr){var zn=Qe.images[0]=Cn();Qe.mipmask=1,zn.width=Qe.width=dr,zn.height=Qe.height=tr,zn.channels=Qe.channels=4}function fa(Qe,dr){var tr=null;if(Cs(dr))wr(tr=Qe.images[0]=Cn(),Qe),xn(tr,dr),Qe.mipmask=1;else if(Gn(Qe,dr),Array.isArray(dr.mipmap))for(var zn=dr.mipmap,ya=0;ya<zn.length;++ya)wr(tr=Qe.images[ya]=Cn(),Qe),tr.width>>=ya,tr.height>>=ya,xn(tr,zn[ya]),Qe.mipmask|=1<<ya;else wr(tr=Qe.images[0]=Cn(),Qe),xn(tr,dr),Qe.mipmask=1;wr(Qe,Qe.images[0]),Qe.compressed&&(33776===Qe.internalformat||33777===Qe.internalformat||33778===Qe.internalformat||33779===Qe.internalformat)&&Z(Qe.width%4==0&&Qe.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Io(Qe,dr){for(var tr=Qe.images,zn=0;zn<tr.length;++zn){if(!tr[zn])return;En(tr[zn],dr,zn)}}var Mo=[];function ha(){var Qe=Mo.pop()||new _i;Lr.call(Qe),Qe.mipmask=0;for(var dr=0;dr<16;++dr)Qe.images[dr]=null;return Qe}function ds(Qe){for(var dr=Qe.images,tr=0;tr<dr.length;++tr)dr[tr]&&Tn(dr[tr]),dr[tr]=null;Mo.push(Qe)}function so(){this.minFilter=9728,this.magFilter=9728,this.wrapS=33071,this.wrapT=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function vs(Qe,dr){if("min"in dr){var tr=dr.min;Z.parameter(tr,qr),Qe.minFilter=qr[tr],Ro.indexOf(Qe.minFilter)>=0&&!("faces"in dr)&&(Qe.genMipmaps=!0)}if("mag"in dr){var zn=dr.mag;Z.parameter(zn,Yr),Qe.magFilter=Yr[zn]}var ya=Qe.wrapS,He=Qe.wrapT;if("wrap"in dr){var Pe=dr.wrap;"string"==typeof Pe?(Z.parameter(Pe,Gr),ya=He=Gr[Pe]):Array.isArray(Pe)&&(Z.parameter(Pe[0],Gr),Z.parameter(Pe[1],Gr),ya=Gr[Pe[0]],He=Gr[Pe[1]])}else{if("wrapS"in dr){var dt=dr.wrapS;Z.parameter(dt,Gr),ya=Gr[dt]}if("wrapT"in dr){var Ut=dr.wrapT;Z.parameter(Ut,Gr),He=Gr[Ut]}}if(Qe.wrapS=ya,Qe.wrapT=He,"anisotropic"in dr){var cr=dr.anisotropic;Z("number"==typeof cr&&cr>=1&&cr<=it.maxAnisotropic,"aniso samples must be between 1 and "),Qe.anisotropic=dr.anisotropic}if("mipmap"in dr){var Ct=!1;switch(typeof dr.mipmap){case"string":Z.parameter(dr.mipmap,Ur,"invalid mipmap hint"),Qe.mipmapHint=Ur[dr.mipmap],Qe.genMipmaps=!0,Ct=!0;break;case"boolean":Ct=Qe.genMipmaps=dr.mipmap;break;case"object":Z(Array.isArray(dr.mipmap),"invalid mipmap type"),Qe.genMipmaps=!1,Ct=!0;break;default:Z.raise("invalid mipmap type")}Ct&&!("min"in dr)&&(Qe.minFilter=9984)}}function Uo(Qe,dr){q.texParameteri(dr,10241,Qe.minFilter),q.texParameteri(dr,10240,Qe.magFilter),q.texParameteri(dr,10242,Qe.wrapS),q.texParameteri(dr,10243,Qe.wrapT),De.ext_texture_filter_anisotropic&&q.texParameteri(dr,34046,Qe.anisotropic),Qe.genMipmaps&&(q.hint(33170,Qe.mipmapHint),q.generateMipmap(dr))}var ss=0,ms={},us=it.maxTextureUnits,jo=Array(us).map(function(){return null});function Hi(Qe){Lr.call(this),this.mipmask=0,this.internalformat=Rs,this.id=ss++,this.refCount=1,this.target=Qe,this.texture=q.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new so,Cr.profile&&(this.stats={size:0})}function ls(Qe){q.activeTexture(yl),q.bindTexture(Qe.target,Qe.texture)}function ka(){var Qe=jo[0];Qe?q.bindTexture(Qe.target,Qe.texture):q.bindTexture(rs,null)}function uo(Qe){var dr=Qe.texture;Z(dr,"must not double destroy texture");var tr=Qe.unit,zn=Qe.target;tr>=0&&(q.activeTexture(yl+tr),q.bindTexture(zn,null),jo[tr]=null),q.deleteTexture(dr),Qe.texture=null,Qe.params=null,Qe.pixels=null,Qe.refCount=0,delete ms[Qe.id],sr.textureCount--}return c(Hi.prototype,{bind:function(){var Qe=this;Qe.bindCount+=1;var dr=Qe.unit;if(dr<0){for(var tr=0;tr<us;++tr){var zn=jo[tr];if(zn){if(zn.bindCount>0)continue;zn.unit=-1}jo[tr]=Qe,dr=tr;break}dr>=us&&Z.raise("insufficient number of texture units"),Cr.profile&&sr.maxTextureUnits<dr+1&&(sr.maxTextureUnits=dr+1),Qe.unit=dr,q.activeTexture(yl+dr),q.bindTexture(Qe.target,Qe.texture)}return dr},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&uo(this)}}),Cr.profile&&(sr.getTotalTextureSize=function(){var Qe=0;return Object.keys(ms).forEach(function(dr){Qe+=ms[dr].stats.size}),Qe}),{create2D:function(Qe,dr){var tr=new Hi(rs);function zn(Pe,dt){var Ut=tr.texInfo;so.call(Ut);var cr=ha();return"number"==typeof Pe?Zi(cr,0|Pe,"number"==typeof dt?0|dt:0|Pe):Pe?(Z.type(Pe,"object","invalid arguments to regl.texture"),vs(Ut,Pe),fa(cr,Pe)):Zi(cr,1,1),Ut.genMipmaps&&(cr.mipmask=(cr.width<<1)-1),tr.mipmask=cr.mipmask,wr(tr,cr),Z.texture2D(Ut,cr,it),tr.internalformat=cr.internalformat,zn.width=cr.width,zn.height=cr.height,ls(tr),Io(cr,rs),Uo(Ut,rs),ka(),ds(cr),Cr.profile&&(tr.stats.size=bu(tr.internalformat,tr.type,cr.width,cr.height,Ut.genMipmaps,!1)),zn.format=Wr[tr.internalformat],zn.type=An[tr.type],zn.mag=Mr[Ut.magFilter],zn.min=wn[Ut.minFilter],zn.wrapS=rn[Ut.wrapS],zn.wrapT=rn[Ut.wrapT],zn}return ms[tr.id]=tr,sr.textureCount++,zn(Qe,dr),zn.subimage=function(Pe,dt,Ut,cr){Z(!!Pe,"must specify image data");var Ct=0|dt,_t=0|Ut,ht=0|cr,ze=Cn();return wr(ze,tr),ze.width=0,ze.height=0,xn(ze,Pe),ze.width=ze.width||(tr.width>>ht)-Ct,ze.height=ze.height||(tr.height>>ht)-_t,Z(tr.type===ze.type&&tr.format===ze.format&&tr.internalformat===ze.internalformat,"incompatible format for texture.subimage"),Z(Ct>=0&&_t>=0&&Ct+ze.width<=tr.width&&_t+ze.height<=tr.height,"texture.subimage write out of bounds"),Z(tr.mipmask&1<<ht,"missing mipmap data"),Z(ze.data||ze.element||ze.needsCopy,"missing image data"),ls(tr),zi(ze,rs,Ct,_t,ht),ka(),Tn(ze),zn},zn.resize=function(Pe,dt){var Ut=0|Pe,cr=0|dt||Ut;if(Ut===tr.width&&cr===tr.height)return zn;zn.width=tr.width=Ut,zn.height=tr.height=cr,ls(tr);for(var Ct=0;tr.mipmask>>Ct;++Ct){var _t=Ut>>Ct,ht=cr>>Ct;if(!_t||!ht)break;q.texImage2D(rs,Ct,tr.format,_t,ht,0,tr.format,tr.type,null)}return ka(),Cr.profile&&(tr.stats.size=bu(tr.internalformat,tr.type,Ut,cr,!1,!1)),zn},zn._reglType="texture2d",zn._texture=tr,Cr.profile&&(zn.stats=tr.stats),zn.destroy=function(){tr.decRef()},zn},createCube:function(Qe,dr,tr,zn,ya,He){var Pe=new Hi(34067);ms[Pe.id]=Pe,sr.cubeCount++;var dt=new Array(6);function Ut(_t,ht,ze,ct,We,jt){var $t,Zr=Pe.texInfo;for(so.call(Zr),$t=0;$t<6;++$t)dt[$t]=ha();if("number"!=typeof _t&&_t)if("object"==typeof _t)if(ht)fa(dt[0],_t),fa(dt[1],ht),fa(dt[2],ze),fa(dt[3],ct),fa(dt[4],We),fa(dt[5],jt);else if(vs(Zr,_t),Gn(Pe,_t),"faces"in _t){var ln=_t.faces;for(Z(Array.isArray(ln)&&6===ln.length,"cube faces must be a length 6 array"),$t=0;$t<6;++$t)Z("object"==typeof ln[$t]&&!!ln[$t],"invalid input for cube map face"),wr(dt[$t],Pe),fa(dt[$t],ln[$t])}else for($t=0;$t<6;++$t)fa(dt[$t],_t);else Z.raise("invalid arguments to cube map");else{var un=0|_t||1;for($t=0;$t<6;++$t)Zi(dt[$t],un,un)}for(wr(Pe,dt[0]),Z.optional(function(){it.npotTextureCube||Z(Tc(Pe.width)&&Tc(Pe.height),"your browser does not support non power or two texture dimensions")}),Pe.mipmask=Zr.genMipmaps?(dt[0].width<<1)-1:dt[0].mipmask,Z.textureCube(Pe,Zr,dt,it),Pe.internalformat=dt[0].internalformat,Ut.width=dt[0].width,Ut.height=dt[0].height,ls(Pe),$t=0;$t<6;++$t)Io(dt[$t],ru+$t);for(Uo(Zr,34067),ka(),Cr.profile&&(Pe.stats.size=bu(Pe.internalformat,Pe.type,Ut.width,Ut.height,Zr.genMipmaps,!0)),Ut.format=Wr[Pe.internalformat],Ut.type=An[Pe.type],Ut.mag=Mr[Zr.magFilter],Ut.min=wn[Zr.minFilter],Ut.wrapS=rn[Zr.wrapS],Ut.wrapT=rn[Zr.wrapT],$t=0;$t<6;++$t)ds(dt[$t]);return Ut}return Ut(Qe,dr,tr,zn,ya,He),Ut.subimage=function(_t,ht,ze,ct,We){Z(!!ht,"must specify image data"),Z("number"==typeof _t&&_t===(0|_t)&&_t>=0&&_t<6,"invalid face");var jt=0|ze,$t=0|ct,Zr=0|We,un=Cn();return wr(un,Pe),un.width=0,un.height=0,xn(un,ht),un.width=un.width||(Pe.width>>Zr)-jt,un.height=un.height||(Pe.height>>Zr)-$t,Z(Pe.type===un.type&&Pe.format===un.format&&Pe.internalformat===un.internalformat,"incompatible format for texture.subimage"),Z(jt>=0&&$t>=0&&jt+un.width<=Pe.width&&$t+un.height<=Pe.height,"texture.subimage write out of bounds"),Z(Pe.mipmask&1<<Zr,"missing mipmap data"),Z(un.data||un.element||un.needsCopy,"missing image data"),ls(Pe),zi(un,ru+_t,jt,$t,Zr),ka(),Tn(un),Ut},Ut.resize=function(_t){var ht=0|_t;if(ht!==Pe.width){Ut.width=Pe.width=ht,Ut.height=Pe.height=ht,ls(Pe);for(var ze=0;ze<6;++ze)for(var ct=0;Pe.mipmask>>ct;++ct)q.texImage2D(ru+ze,ct,Pe.format,ht>>ct,ht>>ct,0,Pe.format,Pe.type,null);return ka(),Cr.profile&&(Pe.stats.size=bu(Pe.internalformat,Pe.type,Ut.width,Ut.height,!1,!0)),Ut}},Ut._reglType="textureCube",Ut._texture=Pe,Cr.profile&&(Ut.stats=Pe.stats),Ut.destroy=function(){Pe.decRef()},Ut},clear:function(){for(var Qe=0;Qe<us;++Qe)q.activeTexture(yl+Qe),q.bindTexture(rs,null),jo[Qe]=null;ar(ms).forEach(uo),sr.cubeCount=0,sr.textureCount=0},getTexture:function(Qe){return null},restore:function(){for(var Qe=0;Qe<us;++Qe){var dr=jo[Qe];dr&&(dr.bindCount=0,dr.unit=-1,jo[Qe]=null)}ar(ms).forEach(function(tr){tr.texture=q.createTexture(),q.bindTexture(tr.target,tr.texture);for(var zn=0;zn<32;++zn)if(0!=(tr.mipmask&1<<zn))if(tr.target===rs)q.texImage2D(rs,zn,tr.internalformat,tr.width>>zn,tr.height>>zn,0,tr.internalformat,tr.type,null);else for(var ya=0;ya<6;++ya)q.texImage2D(ru+ya,zn,tr.internalformat,tr.width>>zn,tr.height>>zn,0,tr.internalformat,tr.type,null);Uo(tr.texInfo,tr.target)})},refresh:function(){for(var Qe=0;Qe<us;++Qe){var dr=jo[Qe];dr&&(dr.bindCount=0,dr.unit=-1,jo[Qe]=null),q.activeTexture(yl+Qe),q.bindTexture(rs,null),q.bindTexture(34067,null)}}}}Ga[32854]=2,Ga[32855]=2,Ga[36194]=2,Ga[pl]=4,Ga[33776]=.5,Ga[33777]=.5,Ga[33778]=1,Ga[33779]=1,Ga[35986]=.5,Ga[35987]=1,Ga[34798]=1,Ga[35840]=.5,Ga[35841]=.25,Ga[35842]=.5,Ga[35843]=.25,Ga[36196]=.5;var mo=36161,il=32854,Qi=[];function zo(q,De,it){return Qi[q]*De*it}Qi[il]=2,Qi[32855]=2,Qi[36194]=2,Qi[33189]=2,Qi[36168]=1,Qi[34041]=4,Qi[35907]=4,Qi[34836]=16,Qi[34842]=8,Qi[34843]=6;var As=36160,ys=3553,is=34069,cc=[6407,6408],fc=[];fc[6408]=4,fc[6407]=3;var El=[];El[5121]=1,El[5126]=4,El[36193]=2;var Ce=[32854,32855,36194,35907,34842,34843,34836],Ie={};Ie[36053]="complete",Ie[36054]="incomplete attachment",Ie[36057]="incomplete dimensions",Ie[36055]="incomplete, missing attachment",Ie[36061]="unsupported";var Ye=["attributes","elements","offset","count","primitive","instances"];function lt(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}var Xr=5121;function jn(q,De,it,lr,kr,sr,Cr){function Ur(qr){var en;null===De.next?(Z(kr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),en=Xr):(Z(null!==De.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),en=De.next.colorAttachments[0].texture._texture.type,Z.optional(function(){sr.oes_texture_float?(Z(en===Xr||5126===en,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),5126===en&&Z(Cr.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):Z(en===Xr,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var pn=0,Hr=0,tn=lr.framebufferWidth,Zt=lr.framebufferHeight,yr=null;_(qr)?yr=qr:qr&&(Z.type(qr,"object","invalid arguments to regl.read()"),Hr=0|qr.y,Z((pn=0|qr.x)>=0&&pn<lr.framebufferWidth,"invalid x offset for regl.read"),Z(Hr>=0&&Hr<lr.framebufferHeight,"invalid y offset for regl.read"),tn=0|(qr.width||lr.framebufferWidth-pn),Zt=0|(qr.height||lr.framebufferHeight-Hr),yr=qr.data||null),yr&&(en===Xr?Z(yr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):5126===en&&Z(yr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),Z(tn>0&&tn+pn<=lr.framebufferWidth,"invalid width for read pixels"),Z(Zt>0&&Zt+Hr<=lr.framebufferHeight,"invalid height for read pixels"),it();var Wr=tn*Zt*4;return yr||(en===Xr?yr=new Uint8Array(Wr):5126===en&&(yr=yr||new Float32Array(Wr))),Z.isTypedArray(yr,"data buffer for regl.read() must be a typedarray"),Z(yr.byteLength>=Wr,"data buffer for regl.read() too small"),q.pixelStorei(3333,4),q.readPixels(pn,Hr,tn,Zt,6408,en,yr),yr}return function(qr){return qr&&"framebuffer"in qr?function(qr){var en;return De.setFBO({framebuffer:qr.framebuffer},function(){en=Ur(qr)}),en}(qr):Ur(qr)}}function Bn(q){return Array.prototype.slice.call(q)}function Li(q){return Bn(q).join("")}var gi="xyzw".split(""),Rt="blend.enable",Ot="blend.color",ur="blend.equation",Vr="blend.func",Ln="depth.enable",Xn="depth.func",ni="depth.range",Ci="depth.mask",Si="colorMask",ea="cull.enable",xa="cull.face",ua="frontFace",Ha="lineWidth",Wa="polygonOffset.enable",Ya="polygonOffset.offset",ia="sample.alpha",ga="sample.enable",la="sample.coverage",no="stencil.enable",ki="stencil.mask",Ca="stencil.func",ba="stencil.opFront",go="stencil.opBack",Kl="scissor.enable",uu="scissor.box",Yo="viewport",Su="profile",Hu="framebuffer",ul="vert",Ks="frag",Yl="elements",Wu="primitive",ca="count",Hf="offset",Tl="instances",Wf="vao",Ys="Width",xh="Height",Dc=Hu+Ys,hc=Hu+xh,Xf="drawingBuffer",ll=Xf+Ys,qc=Xf+xh,$h=[Vr,ur,Ca,ba,go,la,Yo,uu,Ya],hf=34962,pf=35664,Pf=35665,Fc=35666,Iu=35667,Kf=35668,Cl=35669,If=35671,Mf=35672,Qc=35673,vf=35674,Ns=35675,Yf=35676,_s=35678,ql=35680,ef=1028,Js=1029,rf=7680,Mu={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ch=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Al={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Jl={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ah={frag:35632,vert:35633},$f={cw:2304,ccw:2305};function yf(q){return Array.isArray(q)||_(q)||bt(q)}function Lf(q){return q.sort(function(De,it){return De===Yo?-1:it===Yo?1:De<it?-1:1})}function as(q,De,it,lr){this.thisDep=q,this.contextDep=De,this.propDep=it,this.append=lr}function Zo(q){return q&&!(q.thisDep||q.contextDep||q.propDep)}function os(q){return new as(!1,!1,!1,q)}function cu(q,De){var it=q.type;if(0===it){var lr=q.data.length;return new as(!0,lr>=1,lr>=2,De)}if(4===it){var kr=q.data;return new as(kr.thisDep,kr.contextDep,kr.propDep,De)}if(5===it)return new as(!1,!1,!1,De);if(6===it){for(var sr=!1,Cr=!1,Ur=!1,Gr=0;Gr<q.data.length;++Gr){var Yr=q.data[Gr];if(1===Yr.type)Ur=!0;else if(2===Yr.type)Cr=!0;else if(3===Yr.type)sr=!0;else if(0===Yr.type){sr=!0;var qr=Yr.data;qr>=1&&(Cr=!0),qr>=2&&(Ur=!0)}else 4===Yr.type&&(sr=sr||Yr.data.thisDep,Cr=Cr||Yr.data.contextDep,Ur=Ur||Yr.data.propDep)}return new as(sr,Cr,Ur,De)}return new as(3===it,2===it,1===it,De)}var Ph=new as(!1,!1,!1,function(){});function Ap(q,De,it,lr,kr,sr,Cr,Ur,Gr,Yr,qr,en,pn,Hr,tn){var Zt=Yr.Record,yr={add:32774,subtract:32778,"reverse subtract":32779};it.ext_blend_minmax&&(yr.min=32775,yr.max=32776);var Wr=it.angle_instanced_arrays,An=it.webgl_draw_buffers,Mr=it.oes_vertex_array_object,wn={dirty:!0,profile:tn.profile},rn={},ui=[],Lr={},wr={};function Gn(He){return He.replace(".","_")}function vn(He,Pe,dt){var Ut=Gn(He);ui.push(He),rn[Ut]=wn[Ut]=!!dt,Lr[Ut]=Pe}function Jr(He,Pe,dt){var Ut=Gn(He);ui.push(He),Array.isArray(dt)?(wn[Ut]=dt.slice(),rn[Ut]=dt.slice()):wn[Ut]=rn[Ut]=dt,wr[Ut]=Pe}vn("dither",3024),vn(Rt,3042),Jr(Ot,"blendColor",[0,0,0,0]),Jr(ur,"blendEquationSeparate",[32774,32774]),Jr(Vr,"blendFuncSeparate",[1,0,1,0]),vn(Ln,2929,!0),Jr(Xn,"depthFunc",513),Jr(ni,"depthRange",[0,1]),Jr(Ci,"depthMask",!0),Jr(Si,Si,[!0,!0,!0,!0]),vn(ea,2884),Jr(xa,"cullFace",Js),Jr(ua,ua,2305),Jr(Ha,Ha,1),vn(Wa,32823),Jr(Ya,"polygonOffset",[0,0]),vn(ia,32926),vn(ga,32928),Jr(la,"sampleCoverage",[1,!1]),vn(no,2960),Jr(ki,"stencilMask",-1),Jr(Ca,"stencilFunc",[519,0,-1]),Jr(ba,"stencilOpSeparate",[ef,rf,rf,rf]),Jr(go,"stencilOpSeparate",[Js,rf,rf,rf]),vn(Kl,3089),Jr(uu,"scissor",[0,0,q.drawingBufferWidth,q.drawingBufferHeight]),Jr(Yo,Yo,[0,0,q.drawingBufferWidth,q.drawingBufferHeight]);var xn={gl:q,context:pn,strings:De,next:rn,current:wn,draw:en,elements:sr,buffer:kr,shader:qr,attributes:Yr.state,vao:Yr,uniforms:Gr,framebuffer:Ur,extensions:it,timer:Hr,isBufferArgs:yf},En={primTypes:Or,compareFuncs:Al,blendFuncs:Mu,blendEquations:yr,stencilOps:Jl,glTypes:Qs,orientationType:$f};Z.optional(function(){xn.isArrayLike=oo}),An&&(En.backBuffer=[Js],En.drawBuffer=xe(lr.maxDrawbuffers,function(He){return 0===He?[0]:xe(He,function(Pe){return 36064+Pe})}));var zi=0;function Ii(){var He=function(){var q=0,De=[],it=[];function kr(){var en=[],Hr=[];return c(function(){en.push.apply(en,Bn(arguments))},{def:function(){var Zt="v"+q++;return Hr.push(Zt),arguments.length>0&&(en.push(Zt,"="),en.push.apply(en,Bn(arguments)),en.push(";")),Zt},toString:function(){return Li([Hr.length>0?"var "+Hr.join(",")+";":"",Li(en)])}})}function sr(){var en=kr(),pn=kr(),Hr=en.toString,tn=pn.toString;function Zt(yr,Wr){pn(yr,Wr,"=",en.def(yr,Wr),";")}return c(function(){en.apply(en,Bn(arguments))},{def:en.def,entry:en,exit:pn,save:Zt,set:function(yr,Wr,An){Zt(yr,Wr),en(yr,Wr,"=",An,";")},toString:function(){return Hr()+tn()}})}var Ur=kr(),Gr={};return{global:Ur,link:function(en){for(var pn=0;pn<it.length;++pn)if(it[pn]===en)return De[pn];var Hr="g"+q++;return De.push(Hr),it.push(en),Hr},block:kr,proc:function(en,pn){var Hr=[];function tn(){var Mr="a"+Hr.length;return Hr.push(Mr),Mr}pn=pn||0;for(var Zt=0;Zt<pn;++Zt)tn();var yr=sr(),Wr=yr.toString;return Gr[en]=c(yr,{arg:tn,toString:function(){return Li(["function(",Hr.join(),"){",Wr(),"}"])}})},scope:sr,cond:function(){var en=Li(arguments),pn=sr(),Hr=sr(),tn=pn.toString,Zt=Hr.toString;return c(pn,{then:function(){return pn.apply(pn,Bn(arguments)),this},else:function(){return Hr.apply(Hr,Bn(arguments)),this},toString:function(){var yr=Zt();return yr&&(yr="else{"+yr+"}"),Li(["if(",en,"){",tn(),"}",yr])}})},compile:function(){var en=['"use strict";',Ur,"return {"];Object.keys(Gr).forEach(function(Zt){en.push('"',Zt,'":',Gr[Zt].toString(),",")}),en.push("}");var pn=Li(en).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return("undefined"!=typeof my&&my&&"function"==typeof my.showToast?M.Function.apply(null,De.concat(pn)):Function.apply(null,De.concat(pn))).apply(null,it)}}}(),Pe=He.link,dt=He.global;He.id=zi++,He.batchId="0";var Ut=Pe(xn),cr=He.shared={props:"a0"};Object.keys(xn).forEach(function(ct){cr[ct]=dt.def(Ut,".",ct)}),Z.optional(function(){He.CHECK=Pe(Z),He.commandStr=Z.guessCommand(),He.command=Pe(He.commandStr),He.assert=function(ct,We,jt){ct("if(!(",We,"))",this.CHECK,".commandRaise(",Pe(jt),",",this.command,");")},En.invalidBlendCombinations=Ch});var Ct=He.next={},_t=He.current={};Object.keys(wr).forEach(function(ct){Array.isArray(wn[ct])&&(Ct[ct]=dt.def(cr.next,".",ct),_t[ct]=dt.def(cr.current,".",ct))});var ht=He.constants={};Object.keys(En).forEach(function(ct){ht[ct]=dt.def(JSON.stringify(En[ct]))}),He.invoke=function(ct,We){switch(We.type){case 0:var jt=["this",cr.context,cr.props,He.batchId];return ct.def(Pe(We.data),".call(",jt.slice(0,Math.max(We.data.length+1,4)),")");case 1:return ct.def(cr.props,We.data);case 2:return ct.def(cr.context,We.data);case 3:return ct.def("this",We.data);case 4:return We.data.append(He,ct),We.data.ref;case 5:return We.data.toString();case 6:return We.data.map(function($t){return He.invoke(ct,$t)})}},He.attribCache={};var ze={};return He.scopeAttrib=function(ct){var We=De.id(ct);if(We in ze)return ze[We];var jt=Yr.scope[We];return jt||(jt=Yr.scope[We]=new Zt),ze[We]=Pe(jt)},He}function vs(He,Pe,dt,Ut,cr){var Ct=He.static,_t=He.dynamic;Z.optional(function(){var kn=[Hu,ul,Ks,Yl,Wu,Hf,ca,Tl,Su,Wf].concat(ui);function Vn(Yn){Object.keys(Yn).forEach(function(Hn){Z.command(kn.indexOf(Hn)>=0,'unknown parameter "'+Hn+'"',cr.commandStr)})}Vn(Ct),Vn(_t)});var ht=function(He,Pe){var dt=He.static;if("string"==typeof dt[Ks]&&"string"==typeof dt[ul]){if(Object.keys(Pe.dynamic).length>0)return null;var cr=Pe.static,Ct=Object.keys(cr);if(Ct.length>0&&"number"==typeof cr[Ct[0]]){for(var _t=[],ht=0;ht<Ct.length;++ht)Z("number"==typeof cr[Ct[ht]],"must specify all vertex attribute locations when using vaos"),_t.push([0|cr[Ct[ht]],Ct[ht]]);return _t}}return null}(He,Pe),ze=function(He,Pe){var dt=He.static,Ut=He.dynamic;if(Hu in dt){var cr=dt[Hu];return cr?(cr=Ur.getFramebuffer(cr),Z.command(cr,"invalid framebuffer object"),os(function(_t,ht){var ze=_t.link(cr),ct=_t.shared;ht.set(ct.framebuffer,".next",ze);var We=ct.context;return ht.set(We,"."+Dc,ze+".width"),ht.set(We,"."+hc,ze+".height"),ze})):os(function(_t,ht){var ze=_t.shared;ht.set(ze.framebuffer,".next","null");var ct=ze.context;return ht.set(ct,"."+Dc,ct+"."+ll),ht.set(ct,"."+hc,ct+"."+qc),"null"})}if(Hu in Ut){var Ct=Ut[Hu];return cu(Ct,function(_t,ht){var ze=_t.invoke(ht,Ct),ct=_t.shared,We=ct.framebuffer,jt=ht.def(We,".getFramebuffer(",ze,")");Z.optional(function(){_t.assert(ht,"!"+ze+"||"+jt,"invalid framebuffer object")}),ht.set(We,".next",jt);var $t=ct.context;return ht.set($t,"."+Dc,jt+"?"+jt+".width:"+$t+"."+ll),ht.set($t,"."+hc,jt+"?"+jt+".height:"+$t+"."+qc),jt})}return null}(He),ct=function(He,Pe,dt){var Ut=He.static,cr=He.dynamic;function Ct(ze){if(ze in Ut){var ct=Ut[ze];Z.commandType(ct,"object","invalid "+ze,dt.commandStr);var Zr,un,We=!0,jt=0|ct.x,$t=0|ct.y;return"width"in ct?Z.command((Zr=0|ct.width)>=0,"invalid "+ze,dt.commandStr):We=!1,"height"in ct?Z.command((un=0|ct.height)>=0,"invalid "+ze,dt.commandStr):We=!1,new as(!We&&Pe&&Pe.thisDep,!We&&Pe&&Pe.contextDep,!We&&Pe&&Pe.propDep,function(on,Kn){var kn=on.shared.context,Vn=Zr;"width"in ct||(Vn=Kn.def(kn,".",Dc,"-",jt));var Yn=un;return"height"in ct||(Yn=Kn.def(kn,".",hc,"-",$t)),[jt,$t,Vn,Yn]})}if(ze in cr){var ln=cr[ze],bn=cu(ln,function(on,Kn){var kn=on.invoke(Kn,ln);Z.optional(function(){on.assert(Kn,kn+"&&typeof "+kn+'==="object"',"invalid "+ze)});var Vn=on.shared.context,Yn=Kn.def(kn,".x|0"),Hn=Kn.def(kn,".y|0"),ci=Kn.def('"width" in ',kn,"?",kn,".width|0:","(",Vn,".",Dc,"-",Yn,")"),qa=Kn.def('"height" in ',kn,"?",kn,".height|0:","(",Vn,".",hc,"-",Hn,")");return Z.optional(function(){on.assert(Kn,ci+">=0&&"+qa+">=0","invalid "+ze)}),[Yn,Hn,ci,qa]});return Pe&&(bn.thisDep=bn.thisDep||Pe.thisDep,bn.contextDep=bn.contextDep||Pe.contextDep,bn.propDep=bn.propDep||Pe.propDep),bn}return Pe?new as(Pe.thisDep,Pe.contextDep,Pe.propDep,function(on,Kn){var kn=on.shared.context;return[0,0,Kn.def(kn,".",Dc),Kn.def(kn,".",hc)]}):null}var _t=Ct(Yo);if(_t){var ht=_t;_t=new as(_t.thisDep,_t.contextDep,_t.propDep,function(ze,ct){var We=ht.append(ze,ct),jt=ze.shared.context;return ct.set(jt,".viewportWidth",We[2]),ct.set(jt,".viewportHeight",We[3]),We})}return{viewport:_t,scissor_box:Ct(uu)}}(He,ze,cr),We=function(He,Pe){var dt=He.static,Ut=He.dynamic,cr={},Ct=!1,ht=function(){if(Wf in dt){var Kn=dt[Wf];return null!==Kn&&null===Yr.getVAO(Kn)&&(Kn=Yr.createVAO(Kn)),Ct=!0,cr.vao=Kn,os(function(Vn){var Yn=Yr.getVAO(Kn);return Yn?Vn.link(Yn):"null"})}if(Wf in Ut){Ct=!0;var kn=Ut[Wf];return cu(kn,function(Vn,Yn){var Hn=Vn.invoke(Yn,kn);return Yn.def(Vn.shared.vao+".getVAO("+Hn+")")})}return null}(),ze=!1,We=function(){if(Yl in dt){var Kn=dt[Yl];if(cr.elements=Kn,yf(Kn)){var kn=cr.elements=sr.create(Kn,!0);Kn=sr.getElements(kn),ze=!0}else Kn&&(Kn=sr.getElements(Kn),ze=!0,Z.command(Kn,"invalid elements",Pe.commandStr));var Vn=os(function(Hn,ci){if(Kn){var qa=Hn.link(Kn);return Hn.ELEMENTS=qa,qa}return Hn.ELEMENTS=null,null});return Vn.value=Kn,Vn}if(Yl in Ut){ze=!0;var Yn=Ut[Yl];return cu(Yn,function(Hn,ci){var qa=Hn.shared,Vo=qa.isBufferArgs,$l=qa.elements,ao=Hn.invoke(ci,Yn),Fa=ci.def("null"),zs=ci.def(Vo,"(",ao,")"),Xu=Hn.cond(zs).then(Fa,"=",$l,".createStream(",ao,");").else(Fa,"=",$l,".getElements(",ao,");");return Z.optional(function(){Hn.assert(Xu.else,"!"+ao+"||"+Fa,"invalid elements")}),ci.entry(Xu),ci.exit(Hn.cond(zs).then($l,".destroyStream(",Fa,");")),Hn.ELEMENTS=Fa,Fa})}return Ct?new as(ht.thisDep,ht.contextDep,ht.propDep,function(Hn,ci){return ci.def(Hn.shared.vao+".currentVAO?"+Hn.shared.elements+".getElements("+Hn.shared.vao+".currentVAO.elements):null")}):null}();function $t(Kn,kn){if(Kn in dt){var Vn=0|dt[Kn];return kn?cr.offset=Vn:cr.instances=Vn,Z.command(!kn||Vn>=0,"invalid "+Kn,Pe.commandStr),os(function(Hn,ci){return kn&&(Hn.OFFSET=Vn),Vn})}if(Kn in Ut){var Yn=Ut[Kn];return cu(Yn,function(Hn,ci){var qa=Hn.invoke(ci,Yn);return kn&&(Hn.OFFSET=qa,Z.optional(function(){Hn.assert(ci,qa+">=0","invalid "+Kn)})),qa})}if(kn){if(ze)return os(function(Hn,ci){return Hn.OFFSET=0,0});if(Ct)return new as(ht.thisDep,ht.contextDep,ht.propDep,function(Hn,ci){return ci.def(Hn.shared.vao+".currentVAO?"+Hn.shared.vao+".currentVAO.offset:0")})}else if(Ct)return new as(ht.thisDep,ht.contextDep,ht.propDep,function(Hn,ci){return ci.def(Hn.shared.vao+".currentVAO?"+Hn.shared.vao+".currentVAO.instances:-1")});return null}var Zr=$t(Hf,!0),ln=function(){if(Wu in dt){var Kn=dt[Wu];return cr.primitive=Kn,Z.commandParameter(Kn,Or,"invalid primitve",Pe.commandStr),os(function(Vn,Yn){return Or[Kn]})}if(Wu in Ut){var kn=Ut[Wu];return cu(kn,function(Vn,Yn){var Hn=Vn.constants.primTypes,ci=Vn.invoke(Yn,kn);return Z.optional(function(){Vn.assert(Yn,ci+" in "+Hn,"invalid primitive, must be one of "+Object.keys(Or))}),Yn.def(Hn,"[",ci,"]")})}return ze?Zo(We)?os(We.value?function(Vn,Yn){return Yn.def(Vn.ELEMENTS,".primType")}:function(){return 4}):new as(We.thisDep,We.contextDep,We.propDep,function(Vn,Yn){var Hn=Vn.ELEMENTS;return Yn.def(Hn,"?",Hn,".primType:",4)}):Ct?new as(ht.thisDep,ht.contextDep,ht.propDep,function(Vn,Yn){return Yn.def(Vn.shared.vao+".currentVAO?"+Vn.shared.vao+".currentVAO.primitive:4")}):null}(),bn=function(){if(ca in dt){var Kn=0|dt[ca];return cr.count=Kn,Z.command("number"==typeof Kn&&Kn>=0,"invalid vertex count",Pe.commandStr),os(function(){return Kn})}if(ca in Ut){var kn=Ut[ca];return cu(kn,function(ci,qa){var Vo=ci.invoke(qa,kn);return Z.optional(function(){ci.assert(qa,"typeof "+Vo+'==="number"&&'+Vo+">=0&&"+Vo+"===("+Vo+"|0)","invalid vertex count")}),Vo})}if(ze){if(Zo(We)){if(We)return Zr?new as(Zr.thisDep,Zr.contextDep,Zr.propDep,function(ci,qa){var Vo=qa.def(ci.ELEMENTS,".vertCount-",ci.OFFSET);return Z.optional(function(){ci.assert(qa,Vo+">=0","invalid vertex offset/element buffer too small")}),Vo}):os(function(ci,qa){return qa.def(ci.ELEMENTS,".vertCount")});var Vn=os(function(){return-1});return Z.optional(function(){Vn.MISSING=!0}),Vn}var Yn=new as(We.thisDep||Zr.thisDep,We.contextDep||Zr.contextDep,We.propDep||Zr.propDep,function(ci,qa){var Vo=ci.ELEMENTS;return ci.OFFSET?qa.def(Vo,"?",Vo,".vertCount-",ci.OFFSET,":-1"):qa.def(Vo,"?",Vo,".vertCount:-1")});return Z.optional(function(){Yn.DYNAMIC=!0}),Yn}return Ct?new as(ht.thisDep,ht.contextDep,ht.propDep,function(ci,qa){return qa.def(ci.shared.vao,".currentVAO?",ci.shared.vao,".currentVAO.count:-1")}):null}(),on=$t(Tl,!1);return{elements:We,primitive:ln,count:bn,instances:on,offset:Zr,vao:ht,vaoActive:Ct,elementsActive:ze,static:cr}}(He,cr),jt=function(He,Pe){var dt=He.static,Ut=He.dynamic,cr={};return ui.forEach(function(Ct){var _t=Gn(Ct);function ht(ze,ct){if(Ct in dt){var We=ze(dt[Ct]);cr[_t]=os(function(){return We})}else if(Ct in Ut){var jt=Ut[Ct];cr[_t]=cu(jt,function($t,Zr){return ct($t,Zr,$t.invoke(Zr,jt))})}}switch(Ct){case ea:case Rt:case"dither":case no:case Ln:case Kl:case Wa:case ia:case ga:case Ci:return ht(function(ze){return Z.commandType(ze,"boolean",Ct,Pe.commandStr),ze},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,"typeof "+We+'==="boolean"',"invalid flag "+Ct,ze.commandStr)}),We});case Xn:return ht(function(ze){return Z.commandParameter(ze,Al,"invalid "+Ct,Pe.commandStr),Al[ze]},function(ze,ct,We){var jt=ze.constants.compareFuncs;return Z.optional(function(){ze.assert(ct,We+" in "+jt,"invalid "+Ct+", must be one of "+Object.keys(Al))}),ct.def(jt,"[",We,"]")});case ni:return ht(function(ze){return Z.command(oo(ze)&&2===ze.length&&"number"==typeof ze[0]&&"number"==typeof ze[1]&&ze[0]<=ze[1],"depth range is 2d array",Pe.commandStr),ze},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,ze.shared.isArrayLike+"("+We+")&&"+We+".length===2&&typeof "+We+'[0]==="number"&&typeof '+We+'[1]==="number"&&'+We+"[0]<="+We+"[1]","depth range must be a 2d array")}),[ct.def("+",We,"[0]"),ct.def("+",We,"[1]")]});case Vr:return ht(function(ze){Z.commandType(ze,"object","blend.func",Pe.commandStr);var ct="srcRGB"in ze?ze.srcRGB:ze.src,We="srcAlpha"in ze?ze.srcAlpha:ze.src,jt="dstRGB"in ze?ze.dstRGB:ze.dst,$t="dstAlpha"in ze?ze.dstAlpha:ze.dst;return Z.commandParameter(ct,Mu,_t+".srcRGB",Pe.commandStr),Z.commandParameter(We,Mu,_t+".srcAlpha",Pe.commandStr),Z.commandParameter(jt,Mu,_t+".dstRGB",Pe.commandStr),Z.commandParameter($t,Mu,_t+".dstAlpha",Pe.commandStr),Z.command(-1===Ch.indexOf(ct+", "+jt),"unallowed blending combination (srcRGB, dstRGB) = ("+ct+", "+jt+")",Pe.commandStr),[Mu[ct],Mu[jt],Mu[We],Mu[$t]]},function(ze,ct,We){var jt=ze.constants.blendFuncs;function $t(kn,Vn){var Yn=ct.def('"',kn,Vn,'" in ',We,"?",We,".",kn,Vn,":",We,".",kn);return Z.optional(function(){ze.assert(ct,Yn+" in "+jt,"invalid "+Ct+"."+kn+Vn+", must be one of "+Object.keys(Mu))}),Yn}Z.optional(function(){ze.assert(ct,We+"&&typeof "+We+'==="object"',"invalid blend func, must be an object")});var Zr=$t("src","RGB"),un=$t("dst","RGB");Z.optional(function(){ze.assert(ct,ze.constants.invalidBlendCombinations+".indexOf("+Zr+'+", "+'+un+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var ln=ct.def(jt,"[",Zr,"]"),bn=ct.def(jt,"[",$t("src","Alpha"),"]");return[ln,ct.def(jt,"[",un,"]"),bn,ct.def(jt,"[",$t("dst","Alpha"),"]")]});case ur:return ht(function(ze){return"string"==typeof ze?(Z.commandParameter(ze,yr,"invalid "+Ct,Pe.commandStr),[yr[ze],yr[ze]]):"object"==typeof ze?(Z.commandParameter(ze.rgb,yr,Ct+".rgb",Pe.commandStr),Z.commandParameter(ze.alpha,yr,Ct+".alpha",Pe.commandStr),[yr[ze.rgb],yr[ze.alpha]]):void Z.commandRaise("invalid blend.equation",Pe.commandStr)},function(ze,ct,We){var jt=ze.constants.blendEquations,$t=ct.def(),Zr=ct.def(),un=ze.cond("typeof ",We,'==="string"');return Z.optional(function(){function ln(bn,on,Kn){ze.assert(bn,Kn+" in "+jt,"invalid "+on+", must be one of "+Object.keys(yr))}ln(un.then,Ct,We),ze.assert(un.else,We+"&&typeof "+We+'==="object"',"invalid "+Ct),ln(un.else,Ct+".rgb",We+".rgb"),ln(un.else,Ct+".alpha",We+".alpha")}),un.then($t,"=",Zr,"=",jt,"[",We,"];"),un.else($t,"=",jt,"[",We,".rgb];",Zr,"=",jt,"[",We,".alpha];"),ct(un),[$t,Zr]});case Ot:return ht(function(ze){return Z.command(oo(ze)&&4===ze.length,"blend.color must be a 4d array",Pe.commandStr),xe(4,function(ct){return+ze[ct]})},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,ze.shared.isArrayLike+"("+We+")&&"+We+".length===4","blend.color must be a 4d array")}),xe(4,function(jt){return ct.def("+",We,"[",jt,"]")})});case ki:return ht(function(ze){return Z.commandType(ze,"number",_t,Pe.commandStr),0|ze},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,"typeof "+We+'==="number"',"invalid stencil.mask")}),ct.def(We,"|0")});case Ca:return ht(function(ze){Z.commandType(ze,"object",_t,Pe.commandStr);var ct=ze.cmp||"keep",We=ze.ref||0,jt="mask"in ze?ze.mask:-1;return Z.commandParameter(ct,Al,Ct+".cmp",Pe.commandStr),Z.commandType(We,"number",Ct+".ref",Pe.commandStr),Z.commandType(jt,"number",Ct+".mask",Pe.commandStr),[Al[ct],We,jt]},function(ze,ct,We){var jt=ze.constants.compareFuncs;return Z.optional(function(){function ln(){ze.assert(ct,Array.prototype.join.call(arguments,""),"invalid stencil.func")}ln(We+"&&typeof ",We,'==="object"'),ln('!("cmp" in ',We,")||(",We,".cmp in ",jt,")")}),[ct.def('"cmp" in ',We,"?",jt,"[",We,".cmp]",":",rf),ct.def(We,".ref|0"),ct.def('"mask" in ',We,"?",We,".mask|0:-1")]});case ba:case go:return ht(function(ze){Z.commandType(ze,"object",_t,Pe.commandStr);var ct=ze.fail||"keep",We=ze.zfail||"keep",jt=ze.zpass||"keep";return Z.commandParameter(ct,Jl,Ct+".fail",Pe.commandStr),Z.commandParameter(We,Jl,Ct+".zfail",Pe.commandStr),Z.commandParameter(jt,Jl,Ct+".zpass",Pe.commandStr),[Ct===go?Js:ef,Jl[ct],Jl[We],Jl[jt]]},function(ze,ct,We){var jt=ze.constants.stencilOps;function $t(Zr){return Z.optional(function(){ze.assert(ct,'!("'+Zr+'" in '+We+")||("+We+"."+Zr+" in "+jt+")","invalid "+Ct+"."+Zr+", must be one of "+Object.keys(Jl))}),ct.def('"',Zr,'" in ',We,"?",jt,"[",We,".",Zr,"]:",rf)}return Z.optional(function(){ze.assert(ct,We+"&&typeof "+We+'==="object"',"invalid "+Ct)}),[Ct===go?Js:ef,$t("fail"),$t("zfail"),$t("zpass")]});case Ya:return ht(function(ze){Z.commandType(ze,"object",_t,Pe.commandStr);var ct=0|ze.factor,We=0|ze.units;return Z.commandType(ct,"number",_t+".factor",Pe.commandStr),Z.commandType(We,"number",_t+".units",Pe.commandStr),[ct,We]},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,We+"&&typeof "+We+'==="object"',"invalid "+Ct)}),[ct.def(We,".factor|0"),ct.def(We,".units|0")]});case xa:return ht(function(ze){var ct=0;return"front"===ze?ct=ef:"back"===ze&&(ct=Js),Z.command(!!ct,_t,Pe.commandStr),ct},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,We+'==="front"||'+We+'==="back"',"invalid cull.face")}),ct.def(We,'==="front"?',ef,":",Js)});case Ha:return ht(function(ze){return Z.command("number"==typeof ze&&ze>=lr.lineWidthDims[0]&&ze<=lr.lineWidthDims[1],"invalid line width, must be a positive number between "+lr.lineWidthDims[0]+" and "+lr.lineWidthDims[1],Pe.commandStr),ze},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,"typeof "+We+'==="number"&&'+We+">="+lr.lineWidthDims[0]+"&&"+We+"<="+lr.lineWidthDims[1],"invalid line width")}),We});case ua:return ht(function(ze){return Z.commandParameter(ze,$f,_t,Pe.commandStr),$f[ze]},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,We+'==="cw"||'+We+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),ct.def(We+'==="cw"?2304:2305')});case Si:return ht(function(ze){return Z.command(oo(ze)&&4===ze.length,"color.mask must be length 4 array",Pe.commandStr),ze.map(function(ct){return!!ct})},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,ze.shared.isArrayLike+"("+We+")&&"+We+".length===4","invalid color.mask")}),xe(4,function(jt){return"!!"+We+"["+jt+"]"})});case la:return ht(function(ze){Z.command("object"==typeof ze&&ze,_t,Pe.commandStr);var ct="value"in ze?ze.value:1,We=!!ze.invert;return Z.command("number"==typeof ct&&ct>=0&&ct<=1,"sample.coverage.value must be a number between 0 and 1",Pe.commandStr),[ct,We]},function(ze,ct,We){return Z.optional(function(){ze.assert(ct,We+"&&typeof "+We+'==="object"',"invalid sample.coverage")}),[ct.def('"value" in ',We,"?+",We,".value:1"),ct.def("!!",We,".invert")]})}}),cr}(He,cr),$t=function(He,Pe,dt){var Ut=He.static,cr=He.dynamic;function Ct(We){if(We in Ut){var jt=De.id(Ut[We]);Z.optional(function(){qr.shader(Ah[We],jt,Z.guessCommand())});var $t=os(function(){return jt});return $t.id=jt,$t}if(We in cr){var Zr=cr[We];return cu(Zr,function(un,ln){var bn=un.invoke(ln,Zr),on=ln.def(un.shared.strings,".id(",bn,")");return Z.optional(function(){ln(un.shared.shader,".shader(",Ah[We],",",on,",",un.command,");")}),on})}return null}var ct,_t=Ct(Ks),ht=Ct(ul),ze=null;return Zo(_t)&&Zo(ht)?(ze=qr.program(ht.id,_t.id,null,dt),ct=os(function(We,jt){return We.link(ze)})):ct=new as(_t&&_t.thisDep||ht&&ht.thisDep,_t&&_t.contextDep||ht&&ht.contextDep,_t&&_t.propDep||ht&&ht.propDep,function(We,jt){var Zr,$t=We.shared.shader;Zr=_t?_t.append(We,jt):jt.def($t,".",Ks);var ln=$t+".program("+(ht?ht.append(We,jt):jt.def($t,".",ul))+","+Zr;return Z.optional(function(){ln+=","+We.command}),jt.def(ln+")")}),{frag:_t,vert:ht,progVar:ct,program:ze}}(He,0,ht);function Zr(kn){var Vn=ct[kn];Vn&&(jt[kn]=Vn)}Zr(Yo),Zr(Gn(uu));var un=Object.keys(jt).length>0,ln={framebuffer:ze,draw:We,shader:$t,state:jt,dirty:un,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(ln.profile=function(He){var Ut,Pe=He.static,dt=He.dynamic;if(Su in Pe){var cr=!!Pe[Su];(Ut=os(function(_t,ht){return cr})).enable=cr}else if(Su in dt){var Ct=dt[Su];Ut=cu(Ct,function(_t,ht){return _t.invoke(ht,Ct)})}return Ut}(He),ln.uniforms=function(He,Pe){var dt=He.static,Ut=He.dynamic,cr={};return Object.keys(dt).forEach(function(Ct){var ht,_t=dt[Ct];if("number"==typeof _t||"boolean"==typeof _t)ht=os(function(){return _t});else if("function"==typeof _t){var ze=_t._reglType;"texture2d"===ze||"textureCube"===ze?ht=os(function(ct){return ct.link(_t)}):"framebuffer"===ze||"framebufferCube"===ze?(Z.command(_t.color.length>0,'missing color attachment for framebuffer sent to uniform "'+Ct+'"',Pe.commandStr),ht=os(function(ct){return ct.link(_t.color[0])})):Z.commandRaise('invalid data for uniform "'+Ct+'"',Pe.commandStr)}else oo(_t)?ht=os(function(ct){return ct.global.def("[",xe(_t.length,function(jt){return Z.command("number"==typeof _t[jt]||"boolean"==typeof _t[jt],"invalid uniform "+Ct,ct.commandStr),_t[jt]}),"]")}):Z.commandRaise('invalid or missing data for uniform "'+Ct+'"',Pe.commandStr);ht.value=_t,cr[Ct]=ht}),Object.keys(Ut).forEach(function(Ct){var _t=Ut[Ct];cr[Ct]=cu(_t,function(ht,ze){return ht.invoke(ze,_t)})}),cr}(dt,cr),ln.drawVAO=ln.scopeVAO=We.vao,!ln.drawVAO&&$t.program&&!ht&&it.angle_instanced_arrays&&We.static.elements){var bn=!0,on=$t.program.attributes.map(function(kn){var Vn=Pe.static[kn];return bn=bn&&!!Vn,Vn});if(bn&&on.length>0){var Kn=Yr.getVAO(Yr.createVAO({attributes:on,elements:We.static.elements}));ln.drawVAO=new as(null,null,null,function(kn,Vn){return kn.link(Kn)}),ln.useVAO=!0}}return ht?ln.useVAO=!0:ln.attributes=function(He,Pe){var dt=He.static,Ut=He.dynamic,cr={};return Object.keys(dt).forEach(function(Ct){var _t=dt[Ct],ht=De.id(Ct),ze=new Zt;if(yf(_t))ze.state=1,ze.buffer=kr.getBuffer(kr.create(_t,hf,!1,!0)),ze.type=0;else{var ct=kr.getBuffer(_t);if(ct)ze.state=1,ze.buffer=ct,ze.type=0;else if(Z.command("object"==typeof _t&&_t,"invalid data for attribute "+Ct,Pe.commandStr),"constant"in _t){var We=_t.constant;ze.buffer="null",ze.state=2,"number"==typeof We?ze.x=We:(Z.command(oo(We)&&We.length>0&&We.length<=4,"invalid constant for attribute "+Ct,Pe.commandStr),gi.forEach(function(on,Kn){Kn<We.length&&(ze[on]=We[Kn])}))}else{ct=yf(_t.buffer)?kr.getBuffer(kr.create(_t.buffer,hf,!1,!0)):kr.getBuffer(_t.buffer),Z.command(!!ct,'missing buffer for attribute "'+Ct+'"',Pe.commandStr);var jt=0|_t.offset;Z.command(jt>=0,'invalid offset for attribute "'+Ct+'"',Pe.commandStr);var $t=0|_t.stride;Z.command($t>=0&&$t<256,'invalid stride for attribute "'+Ct+'", must be integer betweeen [0, 255]',Pe.commandStr);var Zr=0|_t.size;Z.command(!("size"in _t)||Zr>0&&Zr<=4,'invalid size for attribute "'+Ct+'", must be 1,2,3,4',Pe.commandStr);var un=!!_t.normalized,ln=0;"type"in _t&&(Z.commandParameter(_t.type,Qs,"invalid type for attribute "+Ct,Pe.commandStr),ln=Qs[_t.type]);var bn=0|_t.divisor;Z.optional(function(){"divisor"in _t&&(Z.command(0===bn||Wr,'cannot specify divisor for attribute "'+Ct+'", instancing not supported',Pe.commandStr),Z.command(bn>=0,'invalid divisor for attribute "'+Ct+'"',Pe.commandStr));var on=Pe.commandStr,Kn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(_t).forEach(function(kn){Z.command(Kn.indexOf(kn)>=0,'unknown parameter "'+kn+'" for attribute pointer "'+Ct+'" (valid parameters are '+Kn+")",on)})}),ze.buffer=ct,ze.state=1,ze.size=Zr,ze.normalized=un,ze.type=ln||ct.dtype,ze.offset=jt,ze.stride=$t,ze.divisor=bn}}cr[Ct]=os(function(on,Kn){var kn=on.attribCache;if(ht in kn)return kn[ht];var Vn={isStream:!1};return Object.keys(ze).forEach(function(Yn){Vn[Yn]=ze[Yn]}),ze.buffer&&(Vn.buffer=on.link(ze.buffer),Vn.type=Vn.type||Vn.buffer+".dtype"),kn[ht]=Vn,Vn})}),Object.keys(Ut).forEach(function(Ct){var _t=Ut[Ct];cr[Ct]=cu(_t,function(ze,ct){var We=ze.invoke(ct,_t),jt=ze.shared,$t=ze.constants,Zr=jt.isBufferArgs,un=jt.buffer;Z.optional(function(){ze.assert(ct,We+"&&(typeof "+We+'==="object"||typeof '+We+'==="function")&&('+Zr+"("+We+")||"+un+".getBuffer("+We+")||"+un+".getBuffer("+We+".buffer)||"+Zr+"("+We+'.buffer)||("constant" in '+We+"&&(typeof "+We+'.constant==="number"||'+jt.isArrayLike+"("+We+".constant))))",'invalid dynamic attribute "'+Ct+'"')});var ln={isStream:ct.def(!1)},bn=new Zt;bn.state=1,Object.keys(bn).forEach(function(Vn){ln[Vn]=ct.def(""+bn[Vn])});var on=ln.buffer,Kn=ln.type;function kn(Vn){ct(ln[Vn],"=",We,".",Vn,"|0;")}return ct("if(",Zr,"(",We,")){",ln.isStream,"=true;",on,"=",un,".createStream(",hf,",",We,");",Kn,"=",on,".dtype;","}else{",on,"=",un,".getBuffer(",We,");","if(",on,"){",Kn,"=",on,".dtype;",'}else if("constant" in ',We,"){",ln.state,"=",2,";","if(typeof "+We+'.constant === "number"){',ln[gi[0]],"=",We,".constant;",gi.slice(1).map(function(Vn){return ln[Vn]}).join("="),"=0;","}else{",gi.map(function(Vn,Yn){return ln[Vn]+"="+We+".constant.length>"+Yn+"?"+We+".constant["+Yn+"]:0;"}).join(""),"}}else{","if(",Zr,"(",We,".buffer)){",on,"=",un,".createStream(",hf,",",We,".buffer);","}else{",on,"=",un,".getBuffer(",We,".buffer);","}",Kn,'="type" in ',We,"?",$t.glTypes,"[",We,".type]:",on,".dtype;",ln.normalized,"=!!",We,".normalized;"),kn("size"),kn("offset"),kn("stride"),kn("divisor"),ct("}}"),ct.exit("if(",ln.isStream,"){",un,".destroyStream(",on,");","}"),ln})}),cr}(Pe,cr),ln.context=function(He){var Pe=He.static,dt=He.dynamic,Ut={};return Object.keys(Pe).forEach(function(cr){var Ct=Pe[cr];Ut[cr]=os(function(_t,ht){return"number"==typeof Ct||"boolean"==typeof Ct?""+Ct:_t.link(Ct)})}),Object.keys(dt).forEach(function(cr){var Ct=dt[cr];Ut[cr]=cu(Ct,function(_t,ht){return _t.invoke(ht,Ct)})}),Ut}(Ut),ln}function Uo(He,Pe,dt){var cr=He.shared.context,Ct=He.scope();Object.keys(dt).forEach(function(_t){Pe.save(cr,"."+_t);var ze=dt[_t].append(He,Pe);Array.isArray(ze)?Ct(cr,".",_t,"=[",ze.join(),"];"):Ct(cr,".",_t,"=",ze,";")}),Pe(Ct)}function ss(He,Pe,dt,Ut){var ht,cr=He.shared,Ct=cr.gl,_t=cr.framebuffer;An&&(ht=Pe.def(cr.extensions,".webgl_draw_buffers"));var jt,ze=He.constants,ct=ze.drawBuffer,We=ze.backBuffer;jt=dt?dt.append(He,Pe):Pe.def(_t,".next"),Ut||Pe("if(",jt,"!==",_t,".cur){"),Pe("if(",jt,"){",Ct,".bindFramebuffer(",36160,",",jt,".framebuffer);"),An&&Pe(ht,".drawBuffersWEBGL(",ct,"[",jt,".colorAttachments.length]);"),Pe("}else{",Ct,".bindFramebuffer(",36160,",null);"),An&&Pe(ht,".drawBuffersWEBGL(",We,");"),Pe("}",_t,".cur=",jt,";"),Ut||Pe("}")}function ms(He,Pe,dt){var Ut=He.shared,cr=Ut.gl,Ct=He.current,_t=He.next,ht=Ut.current,ze=Ut.next,ct=He.cond(ht,".dirty");ui.forEach(function(We){var $t,Zr,jt=Gn(We);if(!(jt in dt.state))if(jt in _t){$t=_t[jt],Zr=Ct[jt];var un=xe(wn[jt].length,function(bn){return ct.def($t,"[",bn,"]")});ct(He.cond(un.map(function(bn,on){return bn+"!=="+Zr+"["+on+"]"}).join("||")).then(cr,".",wr[jt],"(",un,");",un.map(function(bn,on){return Zr+"["+on+"]="+bn}).join(";"),";"))}else{$t=ct.def(ze,".",jt);var ln=He.cond($t,"!==",ht,".",jt);ct(ln),jt in Lr?ln(He.cond($t).then(cr,".enable(",Lr[jt],");").else(cr,".disable(",Lr[jt],");"),ht,".",jt,"=",$t,";"):ln(cr,".",wr[jt],"(",$t,");",ht,".",jt,"=",$t,";")}}),0===Object.keys(dt.state).length&&ct(ht,".dirty=false;"),Pe(ct)}function us(He,Pe,dt,Ut){var cr=He.shared,Ct=He.current,_t=cr.current,ht=cr.gl;Lf(Object.keys(dt)).forEach(function(ze){var ct=dt[ze];if(!Ut||Ut(ct)){var We=ct.append(He,Pe);if(Lr[ze]){var jt=Lr[ze];Zo(ct)?Pe(ht,We?".enable(":".disable(",jt,");"):Pe(He.cond(We).then(ht,".enable(",jt,");").else(ht,".disable(",jt,");")),Pe(_t,".",ze,"=",We,";")}else if(oo(We)){var $t=Ct[ze];Pe(ht,".",wr[ze],"(",We,");",We.map(function(Zr,un){return $t+"["+un+"]="+Zr}).join(";"),";")}else Pe(ht,".",wr[ze],"(",We,");",_t,".",ze,"=",We,";")}})}function jo(He,Pe){Wr&&(He.instancing=Pe.def(He.shared.extensions,".angle_instanced_arrays"))}function Hi(He,Pe,dt,Ut,cr){var jt,$t,bn,Ct=He.shared,_t=He.stats,ht=Ct.current,ze=Ct.timer,ct=dt.profile;function We(){return"undefined"!=typeof my&&my&&"function"==typeof my.showToast||"undefined"==typeof performance?"Date.now()":"performance.now()"}function Zr(kn){kn(jt=Pe.def(),"=",We(),";"),"string"==typeof cr?kn(_t,".count+=",cr,";"):kn(_t,".count++;"),Hr&&(Ut?kn($t=Pe.def(),"=",ze,".getNumPendingQueries();"):kn(ze,".beginQuery(",_t,");"))}function un(kn){kn(_t,".cpuTime+=",We(),"-",jt,";"),Hr&&(Ut?kn(ze,".pushScopeStats(",$t,",",ze,".getNumPendingQueries(),",_t,");"):kn(ze,".endQuery();"))}function ln(kn){var Vn=Pe.def(ht,".profile");Pe(ht,".profile=",kn,";"),Pe.exit(ht,".profile=",Vn,";")}if(ct){if(Zo(ct))return void(ct.enable?(Zr(Pe),un(Pe.exit),ln("true")):ln("false"));ln(bn=ct.append(He,Pe))}else bn=Pe.def(ht,".profile");var on=He.block();Zr(on),Pe("if(",bn,"){",on,"}");var Kn=He.block();un(Kn),Pe.exit("if(",bn,"){",Kn,"}")}function ls(He,Pe,dt,Ut,cr){var Ct=He.shared;Ut.forEach(function(ze){var jt,ct=ze.name,We=dt.attributes[ct];if(We){if(!cr(We))return;jt=We.append(He,Pe)}else{if(!cr(Ph))return;var $t=He.scopeAttrib(ct);Z.optional(function(){He.assert(Pe,$t+".state","missing attribute "+ct)}),jt={},Object.keys(new Zt).forEach(function(Zr){jt[Zr]=Pe.def($t,".",Zr)})}!function(ze,ct,We){var jt=Ct.gl,$t=Pe.def(ze,".location"),Zr=Pe.def(Ct.attributes,"[",$t,"]"),un=We.state,ln=We.buffer,bn=[We.x,We.y,We.z,We.w],on=["buffer","normalized","offset","stride"];function Kn(){Pe("if(!",Zr,".buffer){",jt,".enableVertexAttribArray(",$t,");}");var Yn,Vn=We.type;if(Yn=We.size?Pe.def(We.size,"||",ct):ct,Pe("if(",Zr,".type!==",Vn,"||",Zr,".size!==",Yn,"||",on.map(function(ci){return Zr+"."+ci+"!=="+We[ci]}).join("||"),"){",jt,".bindBuffer(",hf,",",ln,".buffer);",jt,".vertexAttribPointer(",[$t,Yn,Vn,We.normalized,We.stride,We.offset],");",Zr,".type=",Vn,";",Zr,".size=",Yn,";",on.map(function(ci){return Zr+"."+ci+"="+We[ci]+";"}).join(""),"}"),Wr){var Hn=We.divisor;Pe("if(",Zr,".divisor!==",Hn,"){",He.instancing,".vertexAttribDivisorANGLE(",[$t,Hn],");",Zr,".divisor=",Hn,";}")}}function kn(){Pe("if(",Zr,".buffer){",jt,".disableVertexAttribArray(",$t,");",Zr,".buffer=null;","}if(",gi.map(function(Vn,Yn){return Zr+"."+Vn+"!=="+bn[Yn]}).join("||"),"){",jt,".vertexAttrib4f(",$t,",",bn,");",gi.map(function(Vn,Yn){return Zr+"."+Vn+"="+bn[Yn]+";"}).join(""),"}")}1===un?Kn():2===un?kn():(Pe("if(",un,"===",1,"){"),Kn(),Pe("}else{"),kn(),Pe("}"))}(He.link(ze),function(ze){switch(ze){case pf:case Iu:case If:return 2;case Pf:case Kf:case Mf:return 3;case Fc:case Cl:case Qc:return 4;default:return 1}}(ze.info.type),jt)})}function ka(He,Pe,dt,Ut,cr,Ct){for(var ze,_t=He.shared,ht=_t.gl,ct=0;ct<Ut.length;++ct){var bn,We=Ut[ct],jt=We.name,$t=We.info.type,Zr=dt.uniforms[jt],ln=He.link(We)+".location";if(Zr){if(!cr(Zr))continue;if(Zo(Zr)){var on=Zr.value;if(Z.command(null!=on,'missing uniform "'+jt+'"',He.commandStr),$t===_s||$t===ql){Z.command("function"==typeof on&&($t===_s&&("texture2d"===on._reglType||"framebuffer"===on._reglType)||$t===ql&&("textureCube"===on._reglType||"framebufferCube"===on._reglType)),"invalid texture for uniform "+jt,He.commandStr);var Kn=He.link(on._texture||on.color[0]._texture);Pe(ht,".uniform1i(",ln,",",Kn+".bind());"),Pe.exit(Kn,".unbind();")}else if($t===vf||$t===Ns||$t===Yf){Z.optional(function(){Z.command(oo(on),"invalid matrix for uniform "+jt,He.commandStr),Z.command($t===vf&&4===on.length||$t===Ns&&9===on.length||$t===Yf&&16===on.length,"invalid length for matrix uniform "+jt,He.commandStr)});var kn=He.global.def("new Float32Array(["+Array.prototype.slice.call(on)+"])"),Vn=2;$t===Ns?Vn=3:$t===Yf&&(Vn=4),Pe(ht,".uniformMatrix",Vn,"fv(",ln,",false,",kn,");")}else{switch($t){case 5126:Z.commandType(on,"number","uniform "+jt,He.commandStr),ze="1f";break;case pf:Z.command(oo(on)&&2===on.length,"uniform "+jt,He.commandStr),ze="2f";break;case Pf:Z.command(oo(on)&&3===on.length,"uniform "+jt,He.commandStr),ze="3f";break;case Fc:Z.command(oo(on)&&4===on.length,"uniform "+jt,He.commandStr),ze="4f";break;case 35670:Z.commandType(on,"boolean","uniform "+jt,He.commandStr),ze="1i";break;case 5124:Z.commandType(on,"number","uniform "+jt,He.commandStr),ze="1i";break;case If:case Iu:Z.command(oo(on)&&2===on.length,"uniform "+jt,He.commandStr),ze="2i";break;case Mf:case Kf:Z.command(oo(on)&&3===on.length,"uniform "+jt,He.commandStr),ze="3i";break;case Qc:case Cl:Z.command(oo(on)&&4===on.length,"uniform "+jt,He.commandStr),ze="4i"}Pe(ht,".uniform",ze,"(",ln,",",oo(on)?Array.prototype.slice.call(on):on,");")}continue}bn=Zr.append(He,Pe)}else{if(!cr(Ph))continue;bn=Pe.def(_t.uniforms,"[",De.id(jt),"]")}$t===_s?(Z(!Array.isArray(bn),"must specify a scalar prop for textures"),Pe("if(",bn,"&&",bn,'._reglType==="framebuffer"){',bn,"=",bn,".color[0];","}")):$t===ql&&(Z(!Array.isArray(bn),"must specify a scalar prop for cube maps"),Pe("if(",bn,"&&",bn,'._reglType==="framebufferCube"){',bn,"=",bn,".color[0];","}")),Z.optional(function(){function zs(Ku,Qf){He.assert(Pe,Ku,'bad data or missing for uniform "'+jt+'".  '+Qf)}function Xu(Ku){Z(!Array.isArray(bn),"must not specify an array type for uniform"),zs("typeof "+bn+'==="'+Ku+'"',"invalid type, expected "+Ku)}function Ou(Ku,Qf){Array.isArray(bn)?Z(bn.length===Ku,"must have length "+Ku):zs(_t.isArrayLike+"("+bn+")&&"+bn+".length==="+Ku,"invalid vector, should have length "+Ku)}function Mh(Ku){Z(!Array.isArray(bn),"must not specify a value type"),zs("typeof "+bn+'==="function"&&'+bn+'._reglType==="texture'+(3553===Ku?"2d":"Cube")+'"',"invalid texture type")}switch($t){case 5124:Xu("number");break;case Iu:Ou(2);break;case Kf:Ou(3);break;case Cl:Ou(4);break;case 5126:Xu("number");break;case pf:Ou(2);break;case Pf:Ou(3);break;case Fc:Ou(4);break;case 35670:Xu("boolean");break;case If:Ou(2);break;case Mf:Ou(3);break;case Qc:case vf:Ou(4);break;case Ns:Ou(9);break;case Yf:Ou(16);break;case _s:Mh(3553);break;case ql:Mh(34067)}});var Yn=1;switch($t){case _s:case ql:var Hn=Pe.def(bn,"._texture");Pe(ht,".uniform1i(",ln,",",Hn,".bind());"),Pe.exit(Hn,".unbind();");continue;case 5124:case 35670:ze="1i";break;case Iu:case If:ze="2i",Yn=2;break;case Kf:case Mf:ze="3i",Yn=3;break;case Cl:case Qc:ze="4i",Yn=4;break;case 5126:ze="1f";break;case pf:ze="2f",Yn=2;break;case Pf:ze="3f",Yn=3;break;case Fc:ze="4f",Yn=4;break;case vf:ze="Matrix2fv";break;case Ns:ze="Matrix3fv";break;case Yf:ze="Matrix4fv"}if("M"===ze.charAt(0)){Pe(ht,".uniform",ze,"(",ln,",");var ci=Math.pow($t-vf+2,2),qa=He.global.def("new Float32Array(",ci,")");Array.isArray(bn)?Pe("false,(",xe(ci,function(zs){return qa+"["+zs+"]="+bn[zs]}),",",qa,")"):Pe("false,(Array.isArray(",bn,")||",bn," instanceof Float32Array)?",bn,":(",xe(ci,function(zs){return qa+"["+zs+"]="+bn+"["+zs+"]"}),",",qa,")"),Pe(");")}else if(Yn>1){for(var Vo=[],$l=[],ao=0;ao<Yn;++ao)Array.isArray(bn)?$l.push(bn[ao]):$l.push(Pe.def(bn+"["+ao+"]")),Ct&&Vo.push(Pe.def());Ct&&Pe("if(!",He.batchId,"||",Vo.map(function(zs,Xu){return zs+"!=="+$l[Xu]}).join("||"),"){",Vo.map(function(zs,Xu){return zs+"="+$l[Xu]+";"}).join("")),Pe(ht,".uniform",ze,"(",ln,",",$l.join(","),");"),Ct&&Pe("}")}else{if(Z(!Array.isArray(bn),"uniform value must not be an array"),Ct){var Fa=Pe.def();Pe("if(!",He.batchId,"||",Fa,"!==",bn,"){",Fa,"=",bn,";")}Pe(ht,".uniform",ze,"(",ln,",",bn,");"),Ct&&Pe("}")}}}function uo(He,Pe,dt,Ut){var cr=He.shared,Ct=cr.gl,_t=cr.draw,ht=Ut.draw;var Hn,Yn,ci,We=(ci=Pe,(Yn=ht.elements)?((Yn.contextDep&&Ut.contextDynamic||Yn.propDep)&&(ci=dt),Hn=Yn.append(He,ci),ht.elementsActive&&ci("if("+Hn+")"+Ct+".bindBuffer(34963,"+Hn+".buffer.buffer);")):(Hn=ci.def(),ci(Hn,"=",_t,".",Yl,";","if(",Hn,"){",Ct,".bindBuffer(",34963,",",Hn,".buffer.buffer);}","else if(",cr.vao,".currentVAO){",Hn,"=",He.shared.elements+".getElements("+cr.vao,".currentVAO.elements);",Mr?"":"if("+Hn+")"+Ct+".bindBuffer(34963,"+Hn+".buffer.buffer);","}")),Hn);function jt(Yn){var Hn=ht[Yn];return Hn?Hn.append(He,Hn.contextDep&&Ut.contextDynamic||Hn.propDep?dt:Pe):Pe.def(_t,".",Yn)}var ln,bn,$t=jt(Wu),Zr=jt(Hf),un=function(){var Hn,Yn=ht.count,ci=Pe;return Yn?((Yn.contextDep&&Ut.contextDynamic||Yn.propDep)&&(ci=dt),Hn=Yn.append(He,ci),Z.optional(function(){Yn.MISSING&&He.assert(Pe,"false","missing vertex count"),Yn.DYNAMIC&&He.assert(ci,Hn+">=0","missing vertex count")})):(Hn=ci.def(_t,".",ca),Z.optional(function(){He.assert(ci,Hn+">=0","missing vertex count")})),Hn}();if("number"==typeof un){if(0===un)return}else dt("if(",un,"){"),dt.exit("}");Wr&&(ln=jt(Tl),bn=He.instancing);var on=We+".type",Kn=ht.elements&&Zo(ht.elements)&&!ht.vaoActive;function kn(){function Yn(){dt(bn,".drawElementsInstancedANGLE(",[$t,un,on,Zr+"<<(("+on+"-5121)>>1)",ln],");")}function Hn(){dt(bn,".drawArraysInstancedANGLE(",[$t,Zr,un,ln],");")}We&&"null"!==We?Kn?Yn():(dt("if(",We,"){"),Yn(),dt("}else{"),Hn(),dt("}")):Hn()}function Vn(){function Yn(){dt(Ct+".drawElements("+[$t,un,on,Zr+"<<(("+on+"-5121)>>1)"]+");")}function Hn(){dt(Ct+".drawArrays("+[$t,Zr,un]+");")}We&&"null"!==We?Kn?Yn():(dt("if(",We,"){"),Yn(),dt("}else{"),Hn(),dt("}")):Hn()}Wr&&("number"!=typeof ln||ln>=0)?"string"==typeof ln?(dt("if(",ln,">0){"),kn(),dt("}else if(",ln,"<0){"),Vn(),dt("}")):kn():Vn()}function Ai(He,Pe,dt,Ut,cr){var Ct=Ii(),_t=Ct.proc("body",cr);return Z.optional(function(){Ct.commandStr=Pe.commandStr,Ct.command=Ct.link(Pe.commandStr)}),Wr&&(Ct.instancing=_t.def(Ct.shared.extensions,".angle_instanced_arrays")),He(Ct,_t,dt,Ut),Ct.compile().body}function pa(He,Pe,dt,Ut){jo(He,Pe),dt.useVAO?dt.drawVAO?Pe(He.shared.vao,".setVAO(",dt.drawVAO.append(He,Pe),");"):Pe(He.shared.vao,".setVAO(",He.shared.vao,".targetVAO);"):(Pe(He.shared.vao,".setVAO(null);"),ls(He,Pe,dt,Ut.attributes,function(){return!0})),ka(He,Pe,dt,Ut.uniforms,function(){return!0},!1),uo(He,Pe,Pe,dt)}function To(He,Pe,dt,Ut){function cr(){return!0}He.batchId="a1",jo(He,Pe),ls(He,Pe,dt,Ut.attributes,cr),ka(He,Pe,dt,Ut.uniforms,cr,!1),uo(He,Pe,Pe,dt)}function Pl(He,Pe,dt,Ut){jo(He,Pe);var cr=dt.contextDep,Ct=Pe.def(),ze=Pe.def();He.shared.props=ze,He.batchId=Ct;var ct=He.scope(),We=He.scope();function jt(on){return on.contextDep&&cr||on.propDep}function $t(on){return!jt(on)}if(Pe(ct.entry,"for(",Ct,"=0;",Ct,"<","a1",";++",Ct,"){",ze,"=","a0","[",Ct,"];",We,"}",ct.exit),dt.needsContext&&Uo(He,We,dt.context),dt.needsFramebuffer&&ss(He,We,dt.framebuffer),us(He,We,dt.state,jt),dt.profile&&jt(dt.profile)&&Hi(He,We,dt,!1,!0),Ut)dt.useVAO?dt.drawVAO?jt(dt.drawVAO)?We(He.shared.vao,".setVAO(",dt.drawVAO.append(He,We),");"):ct(He.shared.vao,".setVAO(",dt.drawVAO.append(He,ct),");"):ct(He.shared.vao,".setVAO(",He.shared.vao,".targetVAO);"):(ct(He.shared.vao,".setVAO(null);"),ls(He,ct,dt,Ut.attributes,$t),ls(He,We,dt,Ut.attributes,jt)),ka(He,ct,dt,Ut.uniforms,$t,!1),ka(He,We,dt,Ut.uniforms,jt,!0),uo(He,ct,We,dt);else{var Zr=He.global.def("{}"),un=dt.shader.progVar.append(He,We),ln=We.def(un,".id"),bn=We.def(Zr,"[",ln,"]");We(He.shared.gl,".useProgram(",un,".program);","if(!",bn,"){",bn,"=",Zr,"[",ln,"]=",He.link(function(on){return Ai(To,He,dt,on,2)}),"(",un,");}",bn,".call(this,a0[",Ct,"],",Ct,");")}}function zn(He,Pe,dt){var Ut=Pe.static[dt];if(Ut&&function(He){if("object"==typeof He&&!oo(He)){for(var Pe=Object.keys(He),dt=0;dt<Pe.length;++dt)if(On.isDynamic(He[Pe[dt]]))return!0;return!1}}(Ut)){var cr=He.global,Ct=Object.keys(Ut),_t=!1,ht=!1,ze=!1,ct=He.global.def("{}");Ct.forEach(function(jt){var $t=Ut[jt];if(On.isDynamic($t)){"function"==typeof $t&&($t=Ut[jt]=On.unbox($t));var Zr=cu($t,null);_t=_t||Zr.thisDep,ze=ze||Zr.propDep,ht=ht||Zr.contextDep}else{switch(cr(ct,".",jt,"="),typeof $t){case"number":cr($t);break;case"string":cr('"',$t,'"');break;case"object":Array.isArray($t)&&cr("[",$t.join(),"]");break;default:cr(He.link($t))}cr(";")}}),Pe.dynamic[dt]=new On.DynamicVariable(4,{thisDep:_t,contextDep:ht,propDep:ze,ref:ct,append:function(jt,$t){Ct.forEach(function(Zr){var un=Ut[Zr];if(On.isDynamic(un)){var ln=jt.invoke($t,un);$t(ct,".",Zr,"=",ln,";")}})}}),delete Pe.static[dt]}}return{next:rn,current:wn,procs:function(){var He=Ii(),Pe=He.proc("poll"),dt=He.proc("refresh"),Ut=He.block();Pe(Ut),dt(Ut);var ze,cr=He.shared,Ct=cr.gl,_t=cr.next,ht=cr.current;Ut(ht,".dirty=false;"),ss(He,Pe),ss(He,dt,null,!0),Wr&&(ze=He.link(Wr)),it.oes_vertex_array_object&&dt(He.link(it.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var ct=0;ct<lr.maxAttributes;++ct){var We=dt.def(cr.attributes,"[",ct,"]"),jt=He.cond(We,".buffer");jt.then(Ct,".enableVertexAttribArray(",ct,");",Ct,".bindBuffer(",hf,",",We,".buffer.buffer);",Ct,".vertexAttribPointer(",ct,",",We,".size,",We,".type,",We,".normalized,",We,".stride,",We,".offset);").else(Ct,".disableVertexAttribArray(",ct,");",Ct,".vertexAttrib4f(",ct,",",We,".x,",We,".y,",We,".z,",We,".w);",We,".buffer=null;"),dt(jt),Wr&&dt(ze,".vertexAttribDivisorANGLE(",ct,",",We,".divisor);")}return dt(He.shared.vao,".currentVAO=null;",He.shared.vao,".setVAO(",He.shared.vao,".targetVAO);"),Object.keys(Lr).forEach(function($t){var Zr=Lr[$t],un=Ut.def(_t,".",$t),ln=He.block();ln("if(",un,"){",Ct,".enable(",Zr,")}else{",Ct,".disable(",Zr,")}",ht,".",$t,"=",un,";"),dt(ln),Pe("if(",un,"!==",ht,".",$t,"){",ln,"}")}),Object.keys(wr).forEach(function($t){var ln,bn,Zr=wr[$t],un=wn[$t],on=He.block();if(on(Ct,".",Zr,"("),oo(un)){var Kn=un.length;ln=He.global.def(_t,".",$t),bn=He.global.def(ht,".",$t),on(xe(Kn,function(kn){return ln+"["+kn+"]"}),");",xe(Kn,function(kn){return bn+"["+kn+"]="+ln+"["+kn+"];"}).join("")),Pe("if(",xe(Kn,function(kn){return ln+"["+kn+"]!=="+bn+"["+kn+"]"}).join("||"),"){",on,"}")}else ln=Ut.def(_t,".",$t),bn=Ut.def(ht,".",$t),on(ln,");",ht,".",$t,"=",ln,";"),Pe("if(",ln,"!==",bn,"){",on,"}");dt(on)}),He.compile()}(),compile:function(He,Pe,dt,Ut,cr){var Ct=Ii();Ct.stats=Ct.link(cr),Object.keys(Pe.static).forEach(function(ht){zn(Ct,Pe,ht)}),$h.forEach(function(ht){zn(Ct,He,ht)});var _t=vs(He,Pe,dt,Ut,Ct);return function(He,Pe){var dt=He.proc("draw",1);jo(He,dt),Uo(He,dt,Pe.context),ss(He,dt,Pe.framebuffer),ms(He,dt,Pe),us(He,dt,Pe.state),Hi(He,dt,Pe,!1,!0);var Ut=Pe.shader.progVar.append(He,dt);if(dt(He.shared.gl,".useProgram(",Ut,".program);"),Pe.shader.program)pa(He,dt,Pe,Pe.shader.program);else{dt(He.shared.vao,".setVAO(null);");var cr=He.global.def("{}"),Ct=dt.def(Ut,".id"),_t=dt.def(cr,"[",Ct,"]");dt(He.cond(_t).then(_t,".call(this,a0);").else(_t,"=",cr,"[",Ct,"]=",He.link(function(ht){return Ai(pa,He,Pe,ht,1)}),"(",Ut,");",_t,".call(this,a0);"))}Object.keys(Pe.state).length>0&&dt(He.shared.current,".dirty=true;"),He.shared.vao&&dt(He.shared.vao,".setVAO(null);")}(Ct,_t),function(He,Pe){var dt=He.proc("scope",3);He.batchId="a2";var Ut=He.shared,cr=Ut.current;function Ct(_t){var ht=Pe.shader[_t];ht&&dt.set(Ut.shader,"."+_t,ht.append(He,dt))}Uo(He,dt,Pe.context),Pe.framebuffer&&Pe.framebuffer.append(He,dt),Lf(Object.keys(Pe.state)).forEach(function(_t){var ze=Pe.state[_t].append(He,dt);oo(ze)?ze.forEach(function(ct,We){dt.set(He.next[_t],"["+We+"]",ct)}):dt.set(Ut.next,"."+_t,ze)}),Hi(He,dt,Pe,!0,!0),[Yl,Hf,ca,Tl,Wu].forEach(function(_t){var ht=Pe.draw[_t];!ht||dt.set(Ut.draw,"."+_t,""+ht.append(He,dt))}),Object.keys(Pe.uniforms).forEach(function(_t){var ht=Pe.uniforms[_t].append(He,dt);Array.isArray(ht)&&(ht="["+ht.join()+"]"),dt.set(Ut.uniforms,"["+De.id(_t)+"]",ht)}),Object.keys(Pe.attributes).forEach(function(_t){var ht=Pe.attributes[_t].append(He,dt),ze=He.scopeAttrib(_t);Object.keys(new Zt).forEach(function(ct){dt.set(ze,"."+ct,ht[ct])})}),Pe.scopeVAO&&dt.set(Ut.vao,".targetVAO",Pe.scopeVAO.append(He,dt)),Ct(ul),Ct(Ks),Object.keys(Pe.state).length>0&&(dt(cr,".dirty=true;"),dt.exit(cr,".dirty=true;")),dt("a1(",He.shared.context,",a0,",He.batchId,");")}(Ct,_t),function(He,Pe){var dt=He.proc("batch",2);He.batchId="0",jo(He,dt);var Ut=!1,cr=!0;Object.keys(Pe.context).forEach(function(Zr){Ut=Ut||Pe.context[Zr].propDep}),Ut||(Uo(He,dt,Pe.context),cr=!1);var Ct=Pe.framebuffer,_t=!1;function ht(Zr){return Zr.contextDep&&Ut||Zr.propDep}Ct?(Ct.propDep?Ut=_t=!0:Ct.contextDep&&Ut&&(_t=!0),_t||ss(He,dt,Ct)):ss(He,dt,null),Pe.state.viewport&&Pe.state.viewport.propDep&&(Ut=!0),ms(He,dt,Pe),us(He,dt,Pe.state,function(Zr){return!ht(Zr)}),(!Pe.profile||!ht(Pe.profile))&&Hi(He,dt,Pe,!1,"a1"),Pe.contextDep=Ut,Pe.needsContext=cr,Pe.needsFramebuffer=_t;var ze=Pe.shader.progVar;if(ze.contextDep&&Ut||ze.propDep)Pl(He,dt,Pe,null);else{var ct=ze.append(He,dt);if(dt(He.shared.gl,".useProgram(",ct,".program);"),Pe.shader.program)Pl(He,dt,Pe,Pe.shader.program);else{dt(He.shared.vao,".setVAO(null);");var We=He.global.def("{}"),jt=dt.def(ct,".id"),$t=dt.def(We,"[",jt,"]");dt(He.cond($t).then($t,".call(this,a0,a1);").else($t,"=",We,"[",jt,"]=",He.link(function(Zr){return Ai(Pl,He,Pe,Zr,2)}),"(",ct,");",$t,".call(this,a0,a1);"))}}Object.keys(Pe.state).length>0&&dt(He.shared.current,".dirty=true;"),He.shared.vao&&dt(He.shared.vao,".setVAO(null);")}(Ct,_t),c(Ct.compile(),{destroy:function(){_t.shader.program.destroy()}})}}}var Ip=function(q,De){if(!De.ext_disjoint_timer_query)return null;var it=[];function kr(Wr){it.push(Wr)}var sr=[];function Gr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Yr=[];function en(Wr){Yr.push(Wr)}var pn=[];function Hr(Wr,An,Mr){var wn=Yr.pop()||new Gr;wn.startQueryIndex=Wr,wn.endQueryIndex=An,wn.sum=0,wn.stats=Mr,pn.push(wn)}var tn=[],Zt=[];return{beginQuery:function(Wr){var An=it.pop()||De.ext_disjoint_timer_query.createQueryEXT();De.ext_disjoint_timer_query.beginQueryEXT(35007,An),sr.push(An),Hr(sr.length-1,sr.length,Wr)},endQuery:function(){De.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Hr,update:function(){var Wr,An,Mr=sr.length;if(0!==Mr){Zt.length=Math.max(Zt.length,Mr+1),tn.length=Math.max(tn.length,Mr+1),tn[0]=0,Zt[0]=0;var wn=0;for(Wr=0,An=0;An<sr.length;++An){var rn=sr[An];De.ext_disjoint_timer_query.getQueryObjectEXT(rn,34919)?(wn+=De.ext_disjoint_timer_query.getQueryObjectEXT(rn,34918),kr(rn)):sr[Wr++]=rn,tn[An+1]=wn,Zt[An+1]=Wr}for(sr.length=Wr,Wr=0,An=0;An<pn.length;++An){var ui=pn[An],Lr=ui.startQueryIndex,wr=ui.endQueryIndex;ui.sum+=tn[wr]-tn[Lr];var Gn=Zt[Lr],vn=Zt[wr];vn===Gn?(ui.stats.gpuTime+=ui.sum/1e6,en(ui)):(ui.startQueryIndex=Gn,ui.endQueryIndex=vn,pn[Wr++]=ui)}pn.length=Wr}},getNumPendingQueries:function(){return sr.length},clear:function(){it.push.apply(it,sr);for(var Wr=0;Wr<it.length;Wr++)De.ext_disjoint_timer_query.deleteQueryEXT(it[Wr]);sr.length=0,it.length=0},restore:function(){sr.length=0,it.length=0}}},Ih="webglcontextlost",zc="webglcontextrestored";function nf(q,De){for(var it=0;it<q.length;++it)if(q[it]===De)return it;return-1}return function(q){var De=V(q);if(!De)return null;var it=De.gl,lr=it.getContextAttributes(),kr=it.isContextLost(),sr=ae(it,De);if(!sr)return null;var Cr=function(){var q={"":0},De=[""];return{id:function(it){var lr=q[it];return lr||(lr=q[it]=De.length,De.push(it),lr)},str:function(it){return De[it]}}}(),Ur={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Gr=sr.extensions,Yr=Ip(0,Gr),qr=si(),en=it.drawingBufferWidth,pn=it.drawingBufferHeight,Hr={tick:0,time:0,viewportWidth:en,viewportHeight:pn,framebufferWidth:en,framebufferHeight:pn,drawingBufferWidth:en,drawingBufferHeight:pn,pixelRatio:De.pixelRatio},Zt={elements:null,primitive:4,count:-1,offset:0,instances:-1},yr=function(q,De){var it=1;De.ext_texture_filter_anisotropic&&(it=q.getParameter(34047));var lr=1,kr=1;De.webgl_draw_buffers&&(lr=q.getParameter(34852),kr=q.getParameter(36063));var sr=!!De.oes_texture_float;if(sr){var Cr=q.createTexture();q.bindTexture(3553,Cr),q.texImage2D(3553,0,aa,1,1,0,aa,5126,null);var Ur=q.createFramebuffer();if(q.bindFramebuffer(36160,Ur),q.framebufferTexture2D(36160,36064,3553,Cr,0),q.bindTexture(3553,null),36053!==q.checkFramebufferStatus(36160))sr=!1;else{q.viewport(0,0,1,1),q.clearColor(1,0,0,1),q.clear(16384);var Gr=rr.allocType(5126,4);q.readPixels(0,0,1,1,aa,5126,Gr),q.getError()?sr=!1:(q.deleteFramebuffer(Ur),q.deleteTexture(Cr),sr=1===Gr[0]),rr.freeType(Gr)}}var qr=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var en=q.createTexture(),pn=rr.allocType(5121,36);q.activeTexture(33984),q.bindTexture(34067,en),q.texImage2D(34069,0,aa,3,3,0,aa,5121,pn),rr.freeType(pn),q.bindTexture(34067,null),q.deleteTexture(en),qr=!q.getError()}return{colorBits:[q.getParameter(3410),q.getParameter(3411),q.getParameter(3412),q.getParameter(3413)],depthBits:q.getParameter(3414),stencilBits:q.getParameter(3415),subpixelBits:q.getParameter(3408),extensions:Object.keys(De).filter(function(Hr){return!!De[Hr]}),maxAnisotropic:it,maxDrawbuffers:lr,maxColorAttachments:kr,pointSizeDims:q.getParameter(33901),lineWidthDims:q.getParameter(33902),maxViewportDims:q.getParameter(3386),maxCombinedTextureUnits:q.getParameter(35661),maxCubeMapSize:q.getParameter(34076),maxRenderbufferSize:q.getParameter(34024),maxTextureUnits:q.getParameter(34930),maxTextureSize:q.getParameter(3379),maxAttributes:q.getParameter(34921),maxVertexUniforms:q.getParameter(36347),maxVertexTextureUnits:q.getParameter(35660),maxVaryingVectors:q.getParameter(36348),maxFragmentUniforms:q.getParameter(36349),glsl:q.getParameter(35724),renderer:q.getParameter(7937),vendor:q.getParameter(7936),version:q.getParameter(7938),readFloat:sr,npotTextureCube:qr}}(it,Gr),Wr=function(q,De,it,lr){var kr=0,sr={};function Cr(Zt){this.id=kr++,this.buffer=q.createBuffer(),this.type=Zt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,it.profile&&(this.stats={size:0})}Cr.prototype.bind=function(){q.bindBuffer(this.type,this.buffer)},Cr.prototype.destroy=function(){pn(this)};var Ur=[];function qr(Zt,yr,Wr){Zt.byteLength=yr.byteLength,q.bufferData(Zt.type,yr,Wr)}function en(Zt,yr,Wr,An,Mr,wn){var rn,ui;if(Zt.usage=Wr,Array.isArray(yr)){if(Zt.dtype=An||5126,yr.length>0)if(Array.isArray(yr[0])){rn=Ll(yr);for(var Lr=1,wr=1;wr<rn.length;++wr)Lr*=rn[wr];Zt.dimension=Lr,qr(Zt,ui=Ol(yr,rn,Zt.dtype),Wr),wn?Zt.persistentData=ui:rr.freeType(ui)}else if("number"==typeof yr[0]){Zt.dimension=Mr;var Gn=rr.allocType(Zt.dtype,yr.length);m(Gn,yr),qr(Zt,Gn,Wr),wn?Zt.persistentData=Gn:rr.freeType(Gn)}else _(yr[0])?(Zt.dimension=yr[0].length,Zt.dtype=An||Dl(yr[0])||5126,qr(Zt,ui=Ol(yr,[yr.length,yr[0].length],Zt.dtype),Wr),wn?Zt.persistentData=ui:rr.freeType(ui)):Z.raise("invalid buffer data")}else if(_(yr))Zt.dtype=An||Dl(yr),Zt.dimension=Mr,qr(Zt,yr,Wr),wn&&(Zt.persistentData=new Uint8Array(new Uint8Array(yr.buffer)));else if(bt(yr)){var vn=yr.stride,Jr=yr.offset,xn=0,En=0,zi=0,Ii=0;1===(rn=yr.shape).length?(xn=rn[0],En=1,zi=vn[0],Ii=0):2===rn.length?(xn=rn[0],En=rn[1],zi=vn[0],Ii=vn[1]):Z.raise("invalid shape"),Zt.dtype=An||Dl(yr.data)||5126,Zt.dimension=En;var Cn=rr.allocType(Zt.dtype,xn*En);T(Cn,yr.data,xn,En,zi,Ii,Jr),qr(Zt,Cn,Wr),wn?Zt.persistentData=Cn:rr.freeType(Cn)}else yr instanceof ArrayBuffer?(Zt.dtype=5121,Zt.dimension=Mr,qr(Zt,yr,Wr),wn&&(Zt.persistentData=new Uint8Array(new Uint8Array(yr)))):Z.raise("invalid buffer data")}function pn(Zt){De.bufferCount--,lr(Zt);var yr=Zt.buffer;Z(yr,"buffer must not be deleted already"),q.deleteBuffer(yr),Zt.buffer=null,delete sr[Zt.id]}return it.profile&&(De.getTotalBufferSize=function(){var Zt=0;return Object.keys(sr).forEach(function(yr){Zt+=sr[yr].stats.size}),Zt}),{create:function(Zt,yr,Wr,An){De.bufferCount++;var Mr=new Cr(yr);function wn(Lr){var wr=35044,Gn=null,vn=0,Jr=0,xn=1;return Array.isArray(Lr)||_(Lr)||bt(Lr)||Lr instanceof ArrayBuffer?Gn=Lr:"number"==typeof Lr?vn=0|Lr:Lr&&(Z.type(Lr,"object","buffer arguments must be an object, a number or an array"),"data"in Lr&&(Z(null===Gn||Array.isArray(Gn)||_(Gn)||bt(Gn),"invalid data for buffer"),Gn=Lr.data),"usage"in Lr&&(Z.parameter(Lr.usage,ko,"invalid buffer usage"),wr=ko[Lr.usage]),"type"in Lr&&(Z.parameter(Lr.type,Qs,"invalid buffer type"),Jr=Qs[Lr.type]),"dimension"in Lr&&(Z.type(Lr.dimension,"number","invalid dimension"),xn=0|Lr.dimension),"length"in Lr&&(Z.nni(vn,"buffer length must be a nonnegative integer"),vn=0|Lr.length)),Mr.bind(),Gn?en(Mr,Gn,wr,Jr,xn,An):(vn&&q.bufferData(Mr.type,vn,wr),Mr.dtype=Jr||5121,Mr.usage=wr,Mr.dimension=xn,Mr.byteLength=vn),it.profile&&(Mr.stats.size=Mr.byteLength*eu[Mr.dtype]),wn}function rn(Lr,wr){Z(wr+Lr.byteLength<=Mr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Lr.byteLength+" starting from offset "+wr+" to a buffer of size "+Mr.byteLength),q.bufferSubData(Mr.type,wr,Lr)}return sr[Mr.id]=Mr,Wr||wn(Zt),wn._reglType="buffer",wn._buffer=Mr,wn.subdata=function(Lr,wr){var vn,Gn=0|(wr||0);if(Mr.bind(),_(Lr)||Lr instanceof ArrayBuffer)rn(Lr,Gn);else if(Array.isArray(Lr)){if(Lr.length>0)if("number"==typeof Lr[0]){var Jr=rr.allocType(Mr.dtype,Lr.length);m(Jr,Lr),rn(Jr,Gn),rr.freeType(Jr)}else if(Array.isArray(Lr[0])||_(Lr[0])){vn=Ll(Lr);var xn=Ol(Lr,vn,Mr.dtype);rn(xn,Gn),rr.freeType(xn)}else Z.raise("invalid buffer data")}else if(bt(Lr)){var En=Lr.stride,zi=0,Ii=0,Cn=0,Tn=0;1===(vn=Lr.shape).length?(zi=vn[0],Ii=1,Cn=En[0],Tn=0):2===vn.length?(zi=vn[0],Ii=vn[1],Cn=En[0],Tn=En[1]):Z.raise("invalid shape");var _i=Array.isArray(Lr.data)?Mr.dtype:Dl(Lr.data),Zi=rr.allocType(_i,zi*Ii);T(Zi,Lr.data,zi,Ii,Cn,Tn,Lr.offset),rn(Zi,Gn),rr.freeType(Zi)}else Z.raise("invalid data for buffer subdata");return wn},it.profile&&(wn.stats=Mr.stats),wn.destroy=function(){pn(Mr)},wn},createStream:function(Zt,yr){var Wr=Ur.pop();return Wr||(Wr=new Cr(Zt)),Wr.bind(),en(Wr,yr,35040,0,1,!1),Wr},destroyStream:function(Zt){Ur.push(Zt)},clear:function(){ar(sr).forEach(pn),Ur.forEach(pn)},getBuffer:function(Zt){return Zt&&Zt._buffer instanceof Cr?Zt._buffer:null},restore:function(){ar(sr).forEach(function(Zt){Zt.buffer=q.createBuffer(),q.bindBuffer(Zt.type,Zt.buffer),q.bufferData(Zt.type,Zt.persistentData||Zt.byteLength,Zt.usage)})},_initBuffer:en}}(it,Ur,De,function(Ai){return Mr.destroyBuffer(Ai)}),An=function(q,De,it,lr){var kr={},sr=0,Cr={uint8:oa,uint16:Na};function Ur(tn){this.id=sr++,kr[this.id]=this,this.buffer=tn,this.primType=4,this.vertCount=0,this.type=0}De.oes_element_index_uint&&(Cr.uint32=Xo),Ur.prototype.bind=function(){this.buffer.bind()};var Gr=[];function en(tn,Zt,yr,Wr,An,Mr,wn){var rn;if(tn.buffer.bind(),Zt){var ui=wn;!wn&&(!_(Zt)||bt(Zt)&&!_(Zt.data))&&(ui=De.oes_element_index_uint?Xo:Na),it._initBuffer(tn.buffer,Zt,yr,ui,3)}else q.bufferData(34963,Mr,yr),tn.buffer.dtype=rn||oa,tn.buffer.usage=yr,tn.buffer.dimension=3,tn.buffer.byteLength=Mr;if(rn=wn,!wn){switch(tn.buffer.dtype){case oa:case 5120:rn=oa;break;case Na:case 5122:rn=Na;break;case Xo:case 5124:rn=Xo;break;default:Z.raise("unsupported type for element array")}tn.buffer.dtype=rn}tn.type=rn,Z(rn!==Xo||!!De.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Lr=An;Lr<0&&(Lr=tn.buffer.byteLength,rn===Na?Lr>>=1:rn===Xo&&(Lr>>=2)),tn.vertCount=Lr;var wr=Wr;if(Wr<0){wr=4;var Gn=tn.buffer.dimension;1===Gn&&(wr=0),2===Gn&&(wr=1),3===Gn&&(wr=4)}tn.primType=wr}function pn(tn){lr.elementsCount--,Z(null!==tn.buffer,"must not double destroy elements"),delete kr[tn.id],tn.buffer.destroy(),tn.buffer=null}return{create:function(tn,Zt){var yr=it.create(null,34963,!0),Wr=new Ur(yr._buffer);function An(Mr){if(Mr)if("number"==typeof Mr)yr(Mr),Wr.primType=4,Wr.vertCount=0|Mr,Wr.type=oa;else{var wn=null,rn=35044,ui=-1,Lr=-1,wr=0,Gn=0;Array.isArray(Mr)||_(Mr)||bt(Mr)?wn=Mr:(Z.type(Mr,"object","invalid arguments for elements"),"data"in Mr&&(wn=Mr.data,Z(Array.isArray(wn)||_(wn)||bt(wn),"invalid data for element buffer")),"usage"in Mr&&(Z.parameter(Mr.usage,ko,"invalid element buffer usage"),rn=ko[Mr.usage]),"primitive"in Mr&&(Z.parameter(Mr.primitive,Or,"invalid element buffer primitive"),ui=Or[Mr.primitive]),"count"in Mr&&(Z("number"==typeof Mr.count&&Mr.count>=0,"invalid vertex count for elements"),Lr=0|Mr.count),"type"in Mr&&(Z.parameter(Mr.type,Cr,"invalid buffer type"),Gn=Cr[Mr.type]),"length"in Mr?wr=0|Mr.length:(wr=Lr,Gn===Na||5122===Gn?wr*=2:(Gn===Xo||5124===Gn)&&(wr*=4))),en(Wr,wn,rn,ui,Lr,wr,Gn)}else yr(),Wr.primType=4,Wr.vertCount=0,Wr.type=oa;return An}return lr.elementsCount++,An(tn),An._reglType="elements",An._elements=Wr,An.subdata=function(Mr,wn){return yr.subdata(Mr,wn),An},An.destroy=function(){pn(Wr)},An},createStream:function(tn){var Zt=Gr.pop();return Zt||(Zt=new Ur(it.create(null,34963,!0,!1)._buffer)),en(Zt,tn,35040,-1,-1,0,0),Zt},destroyStream:function(tn){Gr.push(tn)},getElements:function(tn){return"function"==typeof tn&&tn._elements instanceof Ur?tn._elements:null},clear:function(){ar(kr).forEach(pn)}}}(it,Gr,Wr,Ur),Mr=function(q,De,it,lr,kr,sr,Cr){for(var Ur=it.maxAttributes,Gr=new Array(Ur),Yr=0;Yr<Ur;++Yr)Gr[Yr]=new lt;var qr=0,en={},pn={Record:lt,scope:{},state:Gr,currentVAO:null,targetVAO:null,restore:tn()?function(){tn()&&ar(en).forEach(function(wr){wr.refresh()})}:function(){},createVAO:function(Lr){var wr=new wn;function Gn(vn){var Jr;if(Array.isArray(vn))Jr=vn,wr.elements&&wr.ownsElements&&wr.elements.destroy(),wr.elements=null,wr.ownsElements=!1,wr.offset=0,wr.count=0,wr.instances=-1,wr.primitive=4;else{if(Z("object"==typeof vn,"invalid arguments for create vao"),Z("attributes"in vn,"must specify attributes for vao"),vn.elements){var xn=vn.elements;wr.ownsElements?"function"==typeof xn&&"elements"===xn._reglType?(wr.elements.destroy(),wr.ownsElements=!1):(wr.elements(xn),wr.ownsElements=!1):sr.getElements(vn.elements)?(wr.elements=vn.elements,wr.ownsElements=!1):(wr.elements=sr.create(vn.elements),wr.ownsElements=!0)}else wr.elements=null,wr.ownsElements=!1;Jr=vn.attributes,wr.offset=0,wr.count=-1,wr.instances=-1,wr.primitive=4,wr.elements&&(wr.count=wr.elements._elements.vertCount,wr.primitive=wr.elements._elements.primType),"offset"in vn&&(wr.offset=0|vn.offset),"count"in vn&&(wr.count=0|vn.count),"instances"in vn&&(wr.instances=0|vn.instances),"primitive"in vn&&(Z(vn.primitive in Or,"bad primitive type: "+vn.primitive),wr.primitive=Or[vn.primitive]),Z.optional(()=>{for(var Io=Object.keys(vn),Mo=0;Mo<Io.length;++Mo)Z(Ye.indexOf(Io[Mo])>=0,'invalid option for vao: "'+Io[Mo]+'" valid options are '+Ye)}),Z(Array.isArray(Jr),"attributes must be an array")}Z(Jr.length<Ur,"too many attributes"),Z(Jr.length>0,"must specify at least one attribute");var En={},zi=wr.attributes;zi.length=Jr.length;for(var Ii=0;Ii<Jr.length;++Ii){var Zi,Cn=Jr[Ii],Tn=zi[Ii]=new lt,_i=Cn.data||Cn;Array.isArray(_i)||_(_i)||bt(_i)?(wr.buffers[Ii]&&(Zi=wr.buffers[Ii],_(_i)&&Zi._buffer.byteLength>=_i.byteLength?Zi.subdata(_i):(Zi.destroy(),wr.buffers[Ii]=null)),wr.buffers[Ii]||(Zi=wr.buffers[Ii]=kr.create(Cn,34962,!1,!0)),Tn.buffer=kr.getBuffer(Zi),Tn.size=0|Tn.buffer.dimension,Tn.normalized=!1,Tn.type=Tn.buffer.dtype,Tn.offset=0,Tn.stride=0,Tn.divisor=0,Tn.state=1,En[Ii]=1):kr.getBuffer(Cn)?(Tn.buffer=kr.getBuffer(Cn),Tn.size=0|Tn.buffer.dimension,Tn.normalized=!1,Tn.type=Tn.buffer.dtype,Tn.offset=0,Tn.stride=0,Tn.divisor=0,Tn.state=1):kr.getBuffer(Cn.buffer)?(Tn.buffer=kr.getBuffer(Cn.buffer),Tn.size=0|(+Cn.size||Tn.buffer.dimension),Tn.normalized=!!Cn.normalized||!1,"type"in Cn?(Z.parameter(Cn.type,Qs,"invalid buffer type"),Tn.type=Qs[Cn.type]):Tn.type=Tn.buffer.dtype,Tn.offset=0|(Cn.offset||0),Tn.stride=0|(Cn.stride||0),Tn.divisor=0|(Cn.divisor||0),Tn.state=1,Z(Tn.size>=1&&Tn.size<=4,"size must be between 1 and 4"),Z(Tn.offset>=0,"invalid offset"),Z(Tn.stride>=0&&Tn.stride<=255,"stride must be between 0 and 255"),Z(Tn.divisor>=0,"divisor must be positive"),Z(!Tn.divisor||!!De.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in Cn?(Z(Ii>0,"first attribute must not be a constant"),Tn.x=+Cn.x||0,Tn.y=+Cn.y||0,Tn.z=+Cn.z||0,Tn.w=+Cn.w||0,Tn.state=2):Z(!1,"invalid attribute spec for location "+Ii)}for(var fa=0;fa<wr.buffers.length;++fa)!En[fa]&&wr.buffers[fa]&&(wr.buffers[fa].destroy(),wr.buffers[fa]=null);return wr.refresh(),Gn}return lr.vaoCount+=1,Gn.destroy=function(){for(var vn=0;vn<wr.buffers.length;++vn)wr.buffers[vn]&&wr.buffers[vn].destroy();wr.buffers.length=0,wr.ownsElements&&(wr.elements.destroy(),wr.elements=null,wr.ownsElements=!1),wr.destroy()},Gn._vao=wr,Gn._reglType="vao",Gn(Lr)},getVAO:function(Lr){return"function"==typeof Lr&&Lr._vao?Lr._vao:null},destroyBuffer:function(Lr){for(var wr=0;wr<Gr.length;++wr){var Gn=Gr[wr];Gn.buffer===Lr&&(q.disableVertexAttribArray(wr),Gn.buffer=null)}},setVAO:tn()?function(Lr){Lr!==pn.currentVAO&&(tn().bindVertexArrayOES(Lr?Lr.vao:null),pn.currentVAO=Lr)}:function(Lr){if(Lr!==pn.currentVAO){if(Lr)Lr.bindAttrs();else{for(var wr=Zt(),Gn=0;Gn<Gr.length;++Gn){var vn=Gr[Gn];vn.buffer?(q.enableVertexAttribArray(Gn),vn.buffer.bind(),q.vertexAttribPointer(Gn,vn.size,vn.type,vn.normalized,vn.stride,vn.offfset),wr&&vn.divisor&&wr.vertexAttribDivisorANGLE(Gn,vn.divisor)):(q.disableVertexAttribArray(Gn),q.vertexAttrib4f(Gn,vn.x,vn.y,vn.z,vn.w))}q.bindBuffer(34963,Cr.elements?Cr.elements.buffer.buffer:null)}pn.currentVAO=Lr}},clear:tn()?function(){ar(en).forEach(function(Lr){Lr.destroy()})}:function(){}};function tn(){return De.oes_vertex_array_object}function Zt(){return De.angle_instanced_arrays}function wn(){this.id=++qr,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Lr=tn();this.vao=Lr?Lr.createVertexArrayOES():null,en[this.id]=this,this.buffers=[]}return wn.prototype.bindAttrs=function(){for(var Lr=Zt(),wr=this.attributes,Gn=0;Gn<wr.length;++Gn){var vn=wr[Gn];vn.buffer?(q.enableVertexAttribArray(Gn),q.bindBuffer(34962,vn.buffer.buffer),q.vertexAttribPointer(Gn,vn.size,vn.type,vn.normalized,vn.stride,vn.offset),Lr&&vn.divisor&&Lr.vertexAttribDivisorANGLE(Gn,vn.divisor)):(q.disableVertexAttribArray(Gn),q.vertexAttrib4f(Gn,vn.x,vn.y,vn.z,vn.w))}for(var Jr=wr.length;Jr<Ur;++Jr)q.disableVertexAttribArray(Jr);var xn=sr.getElements(this.elements);q.bindBuffer(34963,xn?xn.buffer.buffer:null)},wn.prototype.refresh=function(){var Lr=tn();Lr&&(Lr.bindVertexArrayOES(this.vao),this.bindAttrs(),pn.currentVAO=null,Lr.bindVertexArrayOES(null))},wn.prototype.destroy=function(){if(this.vao){var Lr=tn();this===pn.currentVAO&&(pn.currentVAO=null,Lr.bindVertexArrayOES(null)),Lr.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),en[this.id]&&(delete en[this.id],lr.vaoCount-=1)},pn}(it,Gr,yr,Ur,Wr,An,Zt),rn=function(q,De,it,lr){var kr={},sr={};function Cr(Zt,yr,Wr,An){this.name=Zt,this.id=yr,this.location=Wr,this.info=An}function Ur(Zt,yr){for(var Wr=0;Wr<Zt.length;++Wr)if(Zt[Wr].id===yr.id)return void(Zt[Wr].location=yr.location);Zt.push(yr)}function Gr(Zt,yr,Wr){var An=35632===Zt?kr:sr,Mr=An[yr];if(!Mr){var wn=De.str(yr);Mr=q.createShader(Zt),q.shaderSource(Mr,wn),q.compileShader(Mr),Z.shaderError(q,Mr,wn,Zt,Wr),An[yr]=Mr}return Mr}var Yr={},qr=[],en=0;function pn(Zt,yr){this.id=en++,this.fragId=Zt,this.vertId=yr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,lr.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Hr(Zt,yr,Wr){var An,Mr,wn=Gr(35632,Zt.fragId),rn=Gr(35633,Zt.vertId),ui=Zt.program=q.createProgram();if(q.attachShader(ui,wn),q.attachShader(ui,rn),Wr)for(An=0;An<Wr.length;++An){var Lr=Wr[An];q.bindAttribLocation(ui,Lr[0],Lr[1])}q.linkProgram(ui),Z.linkError(q,ui,De.str(Zt.fragId),De.str(Zt.vertId),yr);var wr=q.getProgramParameter(ui,35718);lr.profile&&(Zt.stats.uniformsCount=wr);var Gn=Zt.uniforms;for(An=0;An<wr;++An)if(Mr=q.getActiveUniform(ui,An))if(Mr.size>1)for(var vn=0;vn<Mr.size;++vn){var Jr=Mr.name.replace("[0]","["+vn+"]");Ur(Gn,new Cr(Jr,De.id(Jr),q.getUniformLocation(ui,Jr),Mr))}else Ur(Gn,new Cr(Mr.name,De.id(Mr.name),q.getUniformLocation(ui,Mr.name),Mr));var xn=q.getProgramParameter(ui,35721);lr.profile&&(Zt.stats.attributesCount=xn);var En=Zt.attributes;for(An=0;An<xn;++An)(Mr=q.getActiveAttrib(ui,An))&&Ur(En,new Cr(Mr.name,De.id(Mr.name),q.getAttribLocation(ui,Mr.name),Mr))}return lr.profile&&(it.getMaxUniformsCount=function(){var Zt=0;return qr.forEach(function(yr){yr.stats.uniformsCount>Zt&&(Zt=yr.stats.uniformsCount)}),Zt},it.getMaxAttributesCount=function(){var Zt=0;return qr.forEach(function(yr){yr.stats.attributesCount>Zt&&(Zt=yr.stats.attributesCount)}),Zt}),{clear:function(){var Zt=q.deleteShader.bind(q);ar(kr).forEach(Zt),kr={},ar(sr).forEach(Zt),sr={},qr.forEach(function(yr){q.deleteProgram(yr.program)}),qr.length=0,Yr={},it.shaderCount=0},program:function(Zt,yr,Wr,An){Z.command(Zt>=0,"missing vertex shader",Wr),Z.command(yr>=0,"missing fragment shader",Wr);var Mr=Yr[yr];Mr||(Mr=Yr[yr]={});var wn=Mr[Zt];if(wn&&(wn.refCount++,!An))return wn;var rn=new pn(yr,Zt);return it.shaderCount++,Hr(rn,Wr,An),wn||(Mr[Zt]=rn),qr.push(rn),c(rn,{destroy:function(){if(rn.refCount--,rn.refCount<=0){q.deleteProgram(rn.program);var ui=qr.indexOf(rn);qr.splice(ui,1),it.shaderCount--}Mr[rn.vertId].refCount<=0&&(q.deleteShader(sr[rn.vertId]),delete sr[rn.vertId],delete Yr[rn.fragId][rn.vertId]),Object.keys(Yr[rn.fragId]).length||(q.deleteShader(kr[rn.fragId]),delete kr[rn.fragId],delete Yr[rn.fragId])}})},restore:function(){kr={},sr={};for(var Zt=0;Zt<qr.length;++Zt)Hr(qr[Zt],null,qr[Zt].attributes.map(function(yr){return[yr.location,yr.name]}))},shader:Gr,frag:-1,vert:-1}}(it,Cr,Ur,De),ui=ou(it,Gr,yr,function(){Gn.procs.poll()},Hr,Ur,De),Lr=function(q,De,it,lr,kr){var sr={rgba4:il,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};De.ext_srgb&&(sr.srgba=35907),De.ext_color_buffer_half_float&&(sr.rgba16f=34842,sr.rgb16f=34843),De.webgl_color_buffer_float&&(sr.rgba32f=34836);var Cr=[];Object.keys(sr).forEach(function(Hr){Cr[sr[Hr]]=Hr});var Ur=0,Gr={};function Yr(Hr){this.id=Ur++,this.refCount=1,this.renderbuffer=Hr,this.format=il,this.width=0,this.height=0,kr.profile&&(this.stats={size:0})}function qr(Hr){var tn=Hr.renderbuffer;Z(tn,"must not double destroy renderbuffer"),q.bindRenderbuffer(mo,null),q.deleteRenderbuffer(tn),Hr.renderbuffer=null,Hr.refCount=0,delete Gr[Hr.id],lr.renderbufferCount--}return Yr.prototype.decRef=function(){--this.refCount<=0&&qr(this)},kr.profile&&(lr.getTotalRenderbufferSize=function(){var Hr=0;return Object.keys(Gr).forEach(function(tn){Hr+=Gr[tn].stats.size}),Hr}),{create:function(Hr,tn){var Zt=new Yr(q.createRenderbuffer());function yr(An,Mr){var wn=0,rn=0,ui=il;if("object"==typeof An&&An){var Lr=An;if("shape"in Lr){var wr=Lr.shape;Z(Array.isArray(wr)&&wr.length>=2,"invalid renderbuffer shape"),wn=0|wr[0],rn=0|wr[1]}else"radius"in Lr&&(wn=rn=0|Lr.radius),"width"in Lr&&(wn=0|Lr.width),"height"in Lr&&(rn=0|Lr.height);"format"in Lr&&(Z.parameter(Lr.format,sr,"invalid renderbuffer format"),ui=sr[Lr.format])}else"number"==typeof An?(wn=0|An,rn="number"==typeof Mr?0|Mr:wn):An?Z.raise("invalid arguments to renderbuffer constructor"):wn=rn=1;if(Z(wn>0&&rn>0&&wn<=it.maxRenderbufferSize&&rn<=it.maxRenderbufferSize,"invalid renderbuffer size"),wn!==Zt.width||rn!==Zt.height||ui!==Zt.format)return yr.width=Zt.width=wn,yr.height=Zt.height=rn,Zt.format=ui,q.bindRenderbuffer(mo,Zt.renderbuffer),q.renderbufferStorage(mo,ui,wn,rn),Z(0===q.getError(),"invalid render buffer format"),kr.profile&&(Zt.stats.size=zo(Zt.format,Zt.width,Zt.height)),yr.format=Cr[Zt.format],yr}return Gr[Zt.id]=Zt,lr.renderbufferCount++,yr(Hr,tn),yr.resize=function(An,Mr){var wn=0|An,rn=0|Mr||wn;return wn===Zt.width&&rn===Zt.height||(Z(wn>0&&rn>0&&wn<=it.maxRenderbufferSize&&rn<=it.maxRenderbufferSize,"invalid renderbuffer size"),yr.width=Zt.width=wn,yr.height=Zt.height=rn,q.bindRenderbuffer(mo,Zt.renderbuffer),q.renderbufferStorage(mo,Zt.format,wn,rn),Z(0===q.getError(),"invalid render buffer format"),kr.profile&&(Zt.stats.size=zo(Zt.format,Zt.width,Zt.height))),yr},yr._reglType="renderbuffer",yr._renderbuffer=Zt,kr.profile&&(yr.stats=Zt.stats),yr.destroy=function(){Zt.decRef()},yr},clear:function(){ar(Gr).forEach(qr)},restore:function(){ar(Gr).forEach(function(Hr){Hr.renderbuffer=q.createRenderbuffer(),q.bindRenderbuffer(mo,Hr.renderbuffer),q.renderbufferStorage(mo,Hr.format,Hr.width,Hr.height)}),q.bindRenderbuffer(mo,null)}}}(it,Gr,yr,Ur,De),wr=function(q,De,it,lr,kr,sr){var Cr={cur:null,next:null,dirty:!1,setFBO:null},Ur=["rgba"],Gr=["rgba4","rgb565","rgb5 a1"];De.ext_srgb&&Gr.push("srgba"),De.ext_color_buffer_half_float&&Gr.push("rgba16f","rgb16f"),De.webgl_color_buffer_float&&Gr.push("rgba32f");var Yr=["uint8"];function qr(Jr,xn,En){this.target=Jr,this.texture=xn,this.renderbuffer=En;var zi=0,Ii=0;xn?(zi=xn.width,Ii=xn.height):En&&(zi=En.width,Ii=En.height),this.width=zi,this.height=Ii}function en(Jr){Jr&&(Jr.texture&&Jr.texture._texture.decRef(),Jr.renderbuffer&&Jr.renderbuffer._renderbuffer.decRef())}function pn(Jr,xn,En){if(Jr)if(Jr.texture){var zi=Jr.texture._texture,Ii=Math.max(1,zi.width),Cn=Math.max(1,zi.height);Z(Ii===xn&&Cn===En,"inconsistent width/height for supplied texture"),zi.refCount+=1}else{var Tn=Jr.renderbuffer._renderbuffer;Z(Tn.width===xn&&Tn.height===En,"inconsistent width/height for renderbuffer"),Tn.refCount+=1}}function Hr(Jr,xn){xn&&(xn.texture?q.framebufferTexture2D(As,Jr,xn.target,xn.texture._texture.texture,0):q.framebufferRenderbuffer(As,Jr,36161,xn.renderbuffer._renderbuffer.renderbuffer))}function tn(Jr){var xn=ys,En=null,zi=null,Ii=Jr;"object"==typeof Jr&&(Ii=Jr.data,"target"in Jr&&(xn=0|Jr.target)),Z.type(Ii,"function","invalid attachment data");var Cn=Ii._reglType;return"texture2d"===Cn?(En=Ii,Z(xn===ys)):"textureCube"===Cn?(En=Ii,Z(xn>=is&&xn<is+6,"invalid cube map target")):"renderbuffer"===Cn?(zi=Ii,xn=36161):Z.raise("invalid regl object for attachment"),new qr(xn,En,zi)}function Zt(Jr,xn,En,zi,Ii){if(En){var Cn=lr.create2D({width:Jr,height:xn,format:zi,type:Ii});return Cn._texture.refCount=0,new qr(ys,Cn,null)}var Tn=kr.create({width:Jr,height:xn,format:zi});return Tn._renderbuffer.refCount=0,new qr(36161,null,Tn)}function yr(Jr){return Jr&&(Jr.texture||Jr.renderbuffer)}function Wr(Jr,xn,En){Jr&&(Jr.texture?Jr.texture.resize(xn,En):Jr.renderbuffer&&Jr.renderbuffer.resize(xn,En),Jr.width=xn,Jr.height=En)}De.oes_texture_half_float&&Yr.push("half float","float16"),De.oes_texture_float&&Yr.push("float","float32");var An=0,Mr={};function wn(){this.id=An++,Mr[this.id]=this,this.framebuffer=q.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function rn(Jr){Jr.colorAttachments.forEach(en),en(Jr.depthAttachment),en(Jr.stencilAttachment),en(Jr.depthStencilAttachment)}function ui(Jr){var xn=Jr.framebuffer;Z(xn,"must not double destroy framebuffer"),q.deleteFramebuffer(xn),Jr.framebuffer=null,sr.framebufferCount--,delete Mr[Jr.id]}function Lr(Jr){var xn;q.bindFramebuffer(As,Jr.framebuffer);var En=Jr.colorAttachments;for(xn=0;xn<En.length;++xn)Hr(36064+xn,En[xn]);for(xn=En.length;xn<it.maxColorAttachments;++xn)q.framebufferTexture2D(As,36064+xn,ys,null,0);q.framebufferTexture2D(As,33306,ys,null,0),q.framebufferTexture2D(As,36096,ys,null,0),q.framebufferTexture2D(As,36128,ys,null,0),Hr(36096,Jr.depthAttachment),Hr(36128,Jr.stencilAttachment),Hr(33306,Jr.depthStencilAttachment);var zi=q.checkFramebufferStatus(As);!q.isContextLost()&&36053!==zi&&Z.raise("framebuffer configuration not supported, status = "+Ie[zi]),q.bindFramebuffer(As,Cr.next?Cr.next.framebuffer:null),Cr.cur=Cr.next,q.getError()}function wr(Jr,xn){var En=new wn;function zi(Cn,Tn){var _i;Z(Cr.next!==En,"can not update framebuffer which is currently in use");var Zi=0,fa=0,Io=!0,Mo=!0,ha=null,ds=!0,so="rgba",vs="uint8",Uo=1,ss=null,ms=null,us=null,jo=!1;if("number"==typeof Cn)Zi=0|Cn,fa=0|Tn||Zi;else if(Cn){Z.type(Cn,"object","invalid arguments for framebuffer");var Hi=Cn;if("shape"in Hi){var ls=Hi.shape;Z(Array.isArray(ls)&&ls.length>=2,"invalid shape for framebuffer"),Zi=ls[0],fa=ls[1]}else"radius"in Hi&&(Zi=fa=Hi.radius),"width"in Hi&&(Zi=Hi.width),"height"in Hi&&(fa=Hi.height);("color"in Hi||"colors"in Hi)&&(ha=Hi.color||Hi.colors,Array.isArray(ha)&&Z(1===ha.length||De.webgl_draw_buffers,"multiple render targets not supported")),ha||("colorCount"in Hi&&Z((Uo=0|Hi.colorCount)>0,"invalid color buffer count"),"colorTexture"in Hi&&(ds=!!Hi.colorTexture,so="rgba4"),"colorType"in Hi&&(vs=Hi.colorType,ds?(Z(De.oes_texture_float||!("float"===vs||"float32"===vs),"you must enable OES_texture_float in order to use floating point framebuffer objects"),Z(De.oes_texture_half_float||!("half float"===vs||"float16"===vs),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===vs||"float16"===vs?(Z(De.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),so="rgba16f"):("float"===vs||"float32"===vs)&&(Z(De.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),so="rgba32f"),Z.oneOf(vs,Yr,"invalid color type")),"colorFormat"in Hi&&(Ur.indexOf(so=Hi.colorFormat)>=0?ds=!0:Gr.indexOf(so)>=0?ds=!1:Z.optional(function(){ds?Z.oneOf(Hi.colorFormat,Ur,"invalid color format for texture"):Z.oneOf(Hi.colorFormat,Gr,"invalid color format for renderbuffer")}))),("depthTexture"in Hi||"depthStencilTexture"in Hi)&&Z(!(jo=!(!Hi.depthTexture&&!Hi.depthStencilTexture))||De.webgl_depth_texture,"webgl_depth_texture extension not supported"),"depth"in Hi&&("boolean"==typeof Hi.depth?Io=Hi.depth:(ss=Hi.depth,Mo=!1)),"stencil"in Hi&&("boolean"==typeof Hi.stencil?Mo=Hi.stencil:(ms=Hi.stencil,Io=!1)),"depthStencil"in Hi&&("boolean"==typeof Hi.depthStencil?Io=Mo=Hi.depthStencil:(us=Hi.depthStencil,Io=!1,Mo=!1))}else Zi=fa=1;var ka=null,uo=null,Ai=null,pa=null;if(Array.isArray(ha))ka=ha.map(tn);else if(ha)ka=[tn(ha)];else for(ka=new Array(Uo),_i=0;_i<Uo;++_i)ka[_i]=Zt(Zi,fa,ds,so,vs);Z(De.webgl_draw_buffers||ka.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),Z(ka.length<=it.maxColorAttachments,"too many color attachments, not supported"),Zi=Zi||ka[0].width,fa=fa||ka[0].height,ss?uo=tn(ss):Io&&!Mo&&(uo=Zt(Zi,fa,jo,"depth","uint32")),ms?Ai=tn(ms):Mo&&!Io&&(Ai=Zt(Zi,fa,!1,"stencil","uint8")),us?pa=tn(us):!ss&&!ms&&Mo&&Io&&(pa=Zt(Zi,fa,jo,"depth stencil","depth stencil")),Z(!!ss+!!ms+!!us<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Qa=null;for(_i=0;_i<ka.length;++_i)if(pn(ka[_i],Zi,fa),Z(!ka[_i]||ka[_i].texture&&cc.indexOf(ka[_i].texture._texture.format)>=0||ka[_i].renderbuffer&&Ce.indexOf(ka[_i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+_i+" is invalid"),ka[_i]&&ka[_i].texture){var To=fc[ka[_i].texture._texture.format]*El[ka[_i].texture._texture.type];null===Qa?Qa=To:Z(Qa===To,"all color attachments much have the same number of bits per pixel.")}return pn(uo,Zi,fa),Z(!uo||uo.texture&&6402===uo.texture._texture.format||uo.renderbuffer&&33189===uo.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),pn(Ai,Zi,fa),Z(!Ai||Ai.renderbuffer&&36168===Ai.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),pn(pa,Zi,fa),Z(!pa||pa.texture&&34041===pa.texture._texture.format||pa.renderbuffer&&34041===pa.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),rn(En),En.width=Zi,En.height=fa,En.colorAttachments=ka,En.depthAttachment=uo,En.stencilAttachment=Ai,En.depthStencilAttachment=pa,zi.color=ka.map(yr),zi.depth=yr(uo),zi.stencil=yr(Ai),zi.depthStencil=yr(pa),zi.width=En.width,zi.height=En.height,Lr(En),zi}return sr.framebufferCount++,zi(Jr,xn),c(zi,{resize:function(Cn,Tn){Z(Cr.next!==En,"can not resize a framebuffer which is currently in use");var _i=Math.max(0|Cn,1),Zi=Math.max(0|Tn||_i,1);if(_i===En.width&&Zi===En.height)return zi;for(var fa=En.colorAttachments,Io=0;Io<fa.length;++Io)Wr(fa[Io],_i,Zi);return Wr(En.depthAttachment,_i,Zi),Wr(En.stencilAttachment,_i,Zi),Wr(En.depthStencilAttachment,_i,Zi),En.width=zi.width=_i,En.height=zi.height=Zi,Lr(En),zi},_reglType:"framebuffer",_framebuffer:En,destroy:function(){ui(En),rn(En)},use:function(Cn){Cr.setFBO({framebuffer:zi},Cn)}})}return c(Cr,{getFramebuffer:function(Jr){if("function"==typeof Jr&&"framebuffer"===Jr._reglType){var xn=Jr._framebuffer;if(xn instanceof wn)return xn}return null},create:wr,createCube:function(Jr){var xn=Array(6);function En(Ii){var Cn;Z(xn.indexOf(Cr.next)<0,"can not update framebuffer which is currently in use");var so,Tn={color:null},_i=0,Zi=null,fa="rgba",Io="uint8",Mo=1;if("number"==typeof Ii)_i=0|Ii;else if(Ii){Z.type(Ii,"object","invalid arguments for framebuffer");var ha=Ii;if("shape"in ha){var ds=ha.shape;Z(Array.isArray(ds)&&ds.length>=2,"invalid shape for framebuffer"),Z(ds[0]===ds[1],"cube framebuffer must be square"),_i=ds[0]}else"radius"in ha&&(_i=0|ha.radius),"width"in ha?(_i=0|ha.width,"height"in ha&&Z(ha.height===_i,"must be square")):"height"in ha&&(_i=0|ha.height);("color"in ha||"colors"in ha)&&(Zi=ha.color||ha.colors,Array.isArray(Zi)&&Z(1===Zi.length||De.webgl_draw_buffers,"multiple render targets not supported")),Zi||("colorCount"in ha&&Z((Mo=0|ha.colorCount)>0,"invalid color buffer count"),"colorType"in ha&&(Z.oneOf(ha.colorType,Yr,"invalid color type"),Io=ha.colorType),"colorFormat"in ha&&(fa=ha.colorFormat,Z.oneOf(ha.colorFormat,Ur,"invalid color format for texture"))),"depth"in ha&&(Tn.depth=ha.depth),"stencil"in ha&&(Tn.stencil=ha.stencil),"depthStencil"in ha&&(Tn.depthStencil=ha.depthStencil)}else _i=1;if(Zi)if(Array.isArray(Zi))for(so=[],Cn=0;Cn<Zi.length;++Cn)so[Cn]=Zi[Cn];else so=[Zi];else{so=Array(Mo);var vs={radius:_i,format:fa,type:Io};for(Cn=0;Cn<Mo;++Cn)so[Cn]=lr.createCube(vs)}for(Tn.color=Array(so.length),Cn=0;Cn<so.length;++Cn){var Uo=so[Cn];Z("function"==typeof Uo&&"textureCube"===Uo._reglType,"invalid cube map"),Z(Uo.width===(_i=_i||Uo.width)&&Uo.height===_i,"invalid cube map shape"),Tn.color[Cn]={target:is,data:so[Cn]}}for(Cn=0;Cn<6;++Cn){for(var ss=0;ss<so.length;++ss)Tn.color[ss].target=is+Cn;Cn>0&&(Tn.depth=xn[0].depth,Tn.stencil=xn[0].stencil,Tn.depthStencil=xn[0].depthStencil),xn[Cn]?xn[Cn](Tn):xn[Cn]=wr(Tn)}return c(En,{width:_i,height:_i,color:so})}return En(Jr),c(En,{faces:xn,resize:function(Ii){var Cn,Tn=0|Ii;if(Z(Tn>0&&Tn<=it.maxCubeMapSize,"invalid radius for cube fbo"),Tn===En.width)return En;var _i=En.color;for(Cn=0;Cn<_i.length;++Cn)_i[Cn].resize(Tn);for(Cn=0;Cn<6;++Cn)xn[Cn].resize(Tn);return En.width=En.height=Tn,En},_reglType:"framebufferCube",destroy:function(){xn.forEach(function(Ii){Ii.destroy()})}})},clear:function(){ar(Mr).forEach(ui)},restore:function(){Cr.cur=null,Cr.next=null,Cr.dirty=!0,ar(Mr).forEach(function(Jr){Jr.framebuffer=q.createFramebuffer(),Lr(Jr)})}})}(it,Gr,yr,ui,Lr,Ur),Gn=Ap(it,Cr,Gr,yr,Wr,An,0,wr,{},Mr,rn,Zt,Hr,Yr,De),vn=jn(it,wr,Gn.procs.poll,Hr,lr,Gr,yr),Jr=Gn.next,xn=it.canvas,En=[],zi=[],Ii=[],Cn=[De.onDestroy],Tn=null;function _i(){if(0===En.length)return Yr&&Yr.update(),void(Tn=null);Tn=mi.next(_i),jo();for(var Ai=En.length-1;Ai>=0;--Ai){var pa=En[Ai];pa&&pa(Hr,null,0)}it.flush(),Yr&&Yr.update()}function Zi(){!Tn&&En.length>0&&(Tn=mi.next(_i))}function fa(){Tn&&(mi.cancel(_i),Tn=null)}function Io(Ai){Ai.preventDefault(),kr=!0,fa(),zi.forEach(function(pa){pa()})}function Mo(Ai){it.getError(),kr=!1,sr.restore(),rn.restore(),Wr.restore(),ui.restore(),Lr.restore(),wr.restore(),Mr.restore(),Yr&&Yr.restore(),Gn.procs.refresh(),Zi(),Ii.forEach(function(pa){pa()})}var ha="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast;function so(Ai){function Qa(Ct,_t){var ht={},ze={};return Object.keys(Ct).forEach(function(ct){var We=Ct[ct];if(On.isDynamic(We))ze[ct]=On.unbox(We,ct);else{if(_t&&Array.isArray(We))for(var jt=0;jt<We.length;++jt)if(On.isDynamic(We[jt]))return void(ze[ct]=On.unbox(We,ct));ht[ct]=We}}),{dynamic:ze,static:ht}}Z(!!Ai,"invalid args to regl({...})"),Z.type(Ai,"object","invalid args to regl({...})");var To=Qa(Ai.context||{},!0),Pl=Qa(Ai.uniforms||{},!0),Qe=Qa(Ai.attributes||{},!1),dr=Qa(function(Ct){var _t=c({},Ct);function ht(ze){if(ze in _t){var ct=_t[ze];delete _t[ze],Object.keys(ct).forEach(function(We){_t[ze+"."+We]=ct[We]})}}return delete _t.uniforms,delete _t.attributes,delete _t.context,delete _t.vao,"stencil"in _t&&_t.stencil.op&&(_t.stencil.opBack=_t.stencil.opFront=_t.stencil.op,delete _t.stencil.op),ht("blend"),ht("depth"),ht("cull"),ht("stencil"),ht("polygonOffset"),ht("scissor"),ht("sample"),"vao"in Ct&&(_t.vao=Ct.vao),_t}(Ai),!1),tr={gpuTime:0,cpuTime:0,count:0},zn=Gn.compile(dr,Qe,Pl,To,tr),ya=zn.draw,He=zn.batch,Pe=zn.scope,dt=[];return c(function(Ct,_t){var ht;if(kr&&Z.raise("context lost"),"function"==typeof Ct)return Pe.call(this,null,Ct,0);if("function"==typeof _t)if("number"==typeof Ct)for(ht=0;ht<Ct;++ht)Pe.call(this,null,_t,ht);else{if(!Array.isArray(Ct))return Pe.call(this,Ct,_t,0);for(ht=0;ht<Ct.length;++ht)Pe.call(this,Ct[ht],_t,ht)}else if("number"==typeof Ct){if(Ct>0)return He.call(this,function(Ct){for(;dt.length<Ct;)dt.push(null);return dt}(0|Ct),0|Ct)}else{if(!Array.isArray(Ct))return ya.call(this,Ct);if(Ct.length)return He.call(this,Ct,Ct.length)}},{stats:tr,destroy:function(){zn.destroy()}})}!ha&&xn&&(xn.addEventListener(Ih,Io,!1),xn.addEventListener(zc,Mo,!1));var vs=wr.setFBO=so({framebuffer:On.define.call(null,1,"framebuffer")});function Uo(Ai,pa){var Qa=0;Gn.procs.poll();var To=pa.color;To&&(it.clearColor(+To[0]||0,+To[1]||0,+To[2]||0,+To[3]||0),Qa|=16384),"depth"in pa&&(it.clearDepth(+pa.depth),Qa|=256),"stencil"in pa&&(it.clearStencil(0|pa.stencil),Qa|=1024),Z(!!Qa,"called regl.clear with no buffer specified"),it.clear(Qa)}function ms(Ai){return Z.type(Ai,"function","regl.frame() callback must be a function"),En.push(Ai),Zi(),{cancel:function(){var Qa=nf(En,Ai);Z(Qa>=0,"cannot cancel a frame twice"),En[Qa]=function To(){var Pl=nf(En,To);En[Pl]=En[En.length-1],En.length-=1,En.length<=0&&fa()}}}}function us(){var Ai=Jr.viewport,pa=Jr.scissor_box;Ai[0]=Ai[1]=pa[0]=pa[1]=0,Hr.viewportWidth=Hr.framebufferWidth=Hr.drawingBufferWidth=Ai[2]=pa[2]=it.drawingBufferWidth,Hr.viewportHeight=Hr.framebufferHeight=Hr.drawingBufferHeight=Ai[3]=pa[3]=it.drawingBufferHeight}function jo(){Hr.tick+=1,Hr.time=ls(),us(),Gn.procs.poll()}function Hi(){ui.refresh(),us(),Gn.procs.refresh(),Yr&&Yr.update()}function ls(){return(si()-qr)/1e3}Hi();var uo=c(so,{clear:function(Ai){if(Z("object"==typeof Ai&&Ai,"regl.clear() takes an object as input"),"framebuffer"in Ai)if(Ai.framebuffer&&"framebufferCube"===Ai.framebuffer_reglType)for(var pa=0;pa<6;++pa)vs(c({framebuffer:Ai.framebuffer.faces[pa]},Ai),Uo);else vs(Ai,Uo);else Uo(0,Ai)},prop:On.define.bind(null,1),context:On.define.bind(null,2),this:On.define.bind(null,3),draw:so({}),buffer:function(Ai){return Wr.create(Ai,34962,!1,!1)},elements:function(Ai){return An.create(Ai,!1)},texture:ui.create2D,cube:ui.createCube,renderbuffer:Lr.create,framebuffer:wr.create,framebufferCube:wr.createCube,vao:Mr.createVAO,attributes:lr,frame:ms,on:function(Ai,pa){var Qa;switch(Z.type(pa,"function","listener callback must be a function"),Ai){case"frame":return ms(pa);case"lost":Qa=zi;break;case"restore":Qa=Ii;break;case"destroy":Qa=Cn;break;default:Z.raise("invalid event, must be one of frame,lost,restore,destroy")}return Qa.push(pa),{cancel:function(){for(var To=0;To<Qa.length;++To)if(Qa[To]===pa)return Qa[To]=Qa[Qa.length-1],void Qa.pop()}}},limits:yr,hasExtension:function(Ai){return yr.extensions.indexOf(Ai.toLowerCase())>=0},read:vn,destroy:function(){En.length=0,fa(),!ha&&xn&&(xn.removeEventListener(Ih,Io),xn.removeEventListener(zc,Mo)),rn.clear(),wr.clear(),Lr.clear(),Mr.clear(),ui.clear(),An.clear(),Wr.clear(),Yr&&Yr.clear(),Cn.forEach(function(Ai){Ai()})},_gl:it,_refresh:Hi,poll:function(){jo(),Yr&&Yr.update()},now:ls,stats:Ur});return De.onDone(null,uo),uo}}(y(88660))},81235:(ie,L,y)=>{var c=y(4153)(y(27038),"DataView");ie.exports=c},41505:(ie,L,y)=>{var M=y(59410),_=y(21143),c=y(604),g=y(80584),O=y(7792);function R(B){var H=-1,G=null==B?0:B.length;for(this.clear();++H<G;){var be=B[H];this.set(be[0],be[1])}}R.prototype.clear=M,R.prototype.delete=_,R.prototype.get=c,R.prototype.has=g,R.prototype.set=O,ie.exports=R},73545:(ie,L,y)=>{var M=y(63391),_=y(68971),c=y(18858),g=y(13913),O=y(68944);function R(B){var H=-1,G=null==B?0:B.length;for(this.clear();++H<G;){var be=B[H];this.set(be[0],be[1])}}R.prototype.clear=M,R.prototype.delete=_,R.prototype.get=c,R.prototype.has=g,R.prototype.set=O,ie.exports=R},39046:(ie,L,y)=>{var c=y(4153)(y(27038),"Map");ie.exports=c},93177:(ie,L,y)=>{var M=y(70536),_=y(61502),c=y(94960),g=y(61539),O=y(34138);function R(B){var H=-1,G=null==B?0:B.length;for(this.clear();++H<G;){var be=B[H];this.set(be[0],be[1])}}R.prototype.clear=M,R.prototype.delete=_,R.prototype.get=c,R.prototype.has=g,R.prototype.set=O,ie.exports=R},97129:(ie,L,y)=>{var c=y(4153)(y(27038),"Promise");ie.exports=c},74918:(ie,L,y)=>{var c=y(4153)(y(27038),"Set");ie.exports=c},48690:(ie,L,y)=>{var M=y(93177),_=y(30365),c=y(58235);function g(O){var R=-1,B=null==O?0:O.length;for(this.__data__=new M;++R<B;)this.add(O[R])}g.prototype.add=g.prototype.push=_,g.prototype.has=c,ie.exports=g},33667:(ie,L,y)=>{var M=y(73545),_=y(18034),c=y(37238),g=y(54384),O=y(81450),R=y(61386);function B(H){var G=this.__data__=new M(H);this.size=G.size}B.prototype.clear=_,B.prototype.delete=c,B.prototype.get=g,B.prototype.has=O,B.prototype.set=R,ie.exports=B},57333:(ie,L,y)=>{var M=y(27038);ie.exports=M.Symbol},96820:(ie,L,y)=>{var M=y(27038);ie.exports=M.Uint8Array},54203:(ie,L,y)=>{var c=y(4153)(y(27038),"WeakMap");ie.exports=c},81638:ie=>{ie.exports=function(y,M,_){switch(_.length){case 0:return y.call(M);case 1:return y.call(M,_[0]);case 2:return y.call(M,_[0],_[1]);case 3:return y.call(M,_[0],_[1],_[2])}return y.apply(M,_)}},4500:ie=>{ie.exports=function(y,M){for(var _=-1,c=null==y?0:y.length;++_<c&&!1!==M(y[_],_,y););return y}},11375:ie=>{ie.exports=function(y,M){for(var _=-1,c=null==y?0:y.length,g=0,O=[];++_<c;){var R=y[_];M(R,_,y)&&(O[g++]=R)}return O}},5242:(ie,L,y)=>{var M=y(2166);ie.exports=function(c,g){return!(null==c||!c.length)&&M(c,g,0)>-1}},80679:ie=>{ie.exports=function(y,M,_){for(var c=-1,g=null==y?0:y.length;++c<g;)if(_(M,y[c]))return!0;return!1}},71890:(ie,L,y)=>{var M=y(48282),_=y(2952),c=y(81690),g=y(84444),O=y(20968),R=y(47679),H=Object.prototype.hasOwnProperty;ie.exports=function(be,Be){var j=c(be),W=!j&&_(be),Ke=!j&&!W&&g(be),xt=!j&&!W&&!Ke&&R(be),Dt=j||W||Ke||xt,Et=Dt?M(be.length,String):[],ut=Et.length;for(var tt in be)(Be||H.call(be,tt))&&(!Dt||!("length"==tt||Ke&&("offset"==tt||"parent"==tt)||xt&&("buffer"==tt||"byteLength"==tt||"byteOffset"==tt)||O(tt,ut)))&&Et.push(tt);return Et}},14992:ie=>{ie.exports=function(y,M){for(var _=-1,c=null==y?0:y.length,g=Array(c);++_<c;)g[_]=M(y[_],_,y);return g}},94165:ie=>{ie.exports=function(y,M){for(var _=-1,c=M.length,g=y.length;++_<c;)y[g+_]=M[_];return y}},89731:ie=>{ie.exports=function(y,M,_,c){var g=-1,O=null==y?0:y.length;for(c&&O&&(_=y[++g]);++g<O;)_=M(_,y[g],g,y);return _}},8141:ie=>{ie.exports=function(y,M){for(var _=-1,c=null==y?0:y.length;++_<c;)if(M(y[_],_,y))return!0;return!1}},87280:ie=>{ie.exports=function(y){return y.split("")}},54561:ie=>{var L=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;ie.exports=function(M){return M.match(L)||[]}},63530:(ie,L,y)=>{var M=y(63581),_=y(71166);ie.exports=function(g,O,R){(void 0!==R&&!_(g[O],R)||void 0===R&&!(O in g))&&M(g,O,R)}},23898:(ie,L,y)=>{var M=y(63581),_=y(71166),g=Object.prototype.hasOwnProperty;ie.exports=function(R,B,H){var G=R[B];(!g.call(R,B)||!_(G,H)||void 0===H&&!(B in R))&&M(R,B,H)}},15758:(ie,L,y)=>{var M=y(71166);ie.exports=function(c,g){for(var O=c.length;O--;)if(M(c[O][0],g))return O;return-1}},22067:(ie,L,y)=>{var M=y(11694),_=y(59108);ie.exports=function(g,O){return g&&M(O,_(O),g)}},70882:(ie,L,y)=>{var M=y(11694),_=y(42970);ie.exports=function(g,O){return g&&M(O,_(O),g)}},63581:(ie,L,y)=>{var M=y(20395);ie.exports=function(c,g,O){"__proto__"==g&&M?M(c,g,{configurable:!0,enumerable:!0,value:O,writable:!0}):c[g]=O}},15820:ie=>{ie.exports=function(y,M,_){return y==y&&(void 0!==_&&(y=y<=_?y:_),void 0!==M&&(y=y>=M?y:M)),y}},77007:(ie,L,y)=>{var M=y(33667),_=y(4500),c=y(23898),g=y(22067),O=y(70882),R=y(50694),B=y(53595),H=y(14746),G=y(78857),be=y(58605),Be=y(51675),j=y(26663),W=y(62963),Ke=y(32143),xt=y(31563),Dt=y(81690),Et=y(84444),ut=y(32e3),tt=y(53867),Gt=y(48855),Q=y(59108),Vt=y(42970),Xe="[object Arguments]",ge="[object Function]",Me="[object Object]",$r={};$r[Xe]=$r["[object Array]"]=$r["[object ArrayBuffer]"]=$r["[object DataView]"]=$r["[object Boolean]"]=$r["[object Date]"]=$r["[object Float32Array]"]=$r["[object Float64Array]"]=$r["[object Int8Array]"]=$r["[object Int16Array]"]=$r["[object Int32Array]"]=$r["[object Map]"]=$r["[object Number]"]=$r[Me]=$r["[object RegExp]"]=$r["[object Set]"]=$r["[object String]"]=$r["[object Symbol]"]=$r["[object Uint8Array]"]=$r["[object Uint8ClampedArray]"]=$r["[object Uint16Array]"]=$r["[object Uint32Array]"]=!0,$r["[object Error]"]=$r[ge]=$r["[object WeakMap]"]=!1,ie.exports=function C(K,Ve,nt,yt,Lt,Z){var Ze,St=1&Ve,It=2&Ve,Jt=4&Ve;if(nt&&(Ze=Lt?nt(K,yt,Lt,Z):nt(K)),void 0!==Ze)return Ze;if(!tt(K))return K;var Tr=Dt(K);if(Tr){if(Ze=W(K),!St)return B(K,Ze)}else{var vr=j(K),Xt=vr==ge||"[object GeneratorFunction]"==vr;if(Et(K))return R(K,St);if(vr==Me||vr==Xe||Xt&&!Lt){if(Ze=It||Xt?{}:xt(K),!St)return It?G(K,O(Ze,K)):H(K,g(Ze,K))}else{if(!$r[vr])return Lt?K:{};Ze=Ke(K,vr,St)}}Z||(Z=new M);var mr=Z.get(K);if(mr)return mr;Z.set(K,Ze),Gt(K)?K.forEach(function(mn){Ze.add(C(mn,Ve,nt,mn,K,Z))}):ut(K)&&K.forEach(function(mn,On){Ze.set(On,C(mn,Ve,nt,On,K,Z))});var pr=Tr?void 0:(Jt?It?Be:be:It?Vt:Q)(K);return _(pr||K,function(mn,On){pr&&(mn=K[On=mn]),c(Ze,On,C(mn,Ve,nt,On,K,Z))}),Ze}},60920:(ie,L,y)=>{var M=y(53867),_=Object.create,c=function(){function g(){}return function(O){if(!M(O))return{};if(_)return _(O);g.prototype=O;var R=new g;return g.prototype=void 0,R}}();ie.exports=c},12229:ie=>{ie.exports=function(y,M,_,c){for(var g=y.length,O=_+(c?1:-1);c?O--:++O<g;)if(M(y[O],O,y))return O;return-1}},75290:(ie,L,y)=>{var _=y(8269)();ie.exports=_},19215:(ie,L,y)=>{var M=y(94165),_=y(81690);ie.exports=function(g,O,R){var B=O(g);return _(g)?B:M(B,R(g))}},72802:(ie,L,y)=>{var M=y(57333),_=y(21613),c=y(81244),R=M?M.toStringTag:void 0;ie.exports=function(H){return null==H?void 0===H?"[object Undefined]":"[object Null]":R&&R in Object(H)?_(H):c(H)}},2166:(ie,L,y)=>{var M=y(12229),_=y(2469),c=y(54299);ie.exports=function(O,R,B){return R==R?c(O,R,B):M(O,_,B)}},77090:(ie,L,y)=>{var M=y(72802),_=y(27503);ie.exports=function(O){return _(O)&&"[object Arguments]"==M(O)}},30696:(ie,L,y)=>{var M=y(36863),_=y(27503);ie.exports=function c(g,O,R,B,H){return g===O||(null==g||null==O||!_(g)&&!_(O)?g!=g&&O!=O:M(g,O,R,B,c,H))}},36863:(ie,L,y)=>{var M=y(33667),_=y(27667),c=y(64630),g=y(70838),O=y(26663),R=y(81690),B=y(84444),H=y(47679),be="[object Arguments]",Be="[object Array]",j="[object Object]",Ke=Object.prototype.hasOwnProperty;ie.exports=function(Dt,Et,ut,tt,Gt,Q){var Vt=R(Dt),ot=R(Et),Ue=Vt?Be:O(Dt),pt=ot?Be:O(Et),Xe=(Ue=Ue==be?j:Ue)==j,At=(pt=pt==be?j:pt)==j,kt=Ue==pt;if(kt&&B(Dt)){if(!B(Et))return!1;Vt=!0,Xe=!1}if(kt&&!Xe)return Q||(Q=new M),Vt||H(Dt)?_(Dt,Et,ut,tt,Gt,Q):c(Dt,Et,Ue,ut,tt,Gt,Q);if(!(1&ut)){var Yt=Xe&&Ke.call(Dt,"__wrapped__"),Er=At&&Ke.call(Et,"__wrapped__");if(Yt||Er){var ge=Yt?Dt.value():Dt,de=Er?Et.value():Et;return Q||(Q=new M),Gt(ge,de,ut,tt,Q)}}return!!kt&&(Q||(Q=new M),g(Dt,Et,ut,tt,Gt,Q))}},63434:(ie,L,y)=>{var M=y(26663),_=y(27503);ie.exports=function(O){return _(O)&&"[object Map]"==M(O)}},2469:ie=>{ie.exports=function(y){return y!=y}},43540:(ie,L,y)=>{var M=y(55836),_=y(38466),c=y(53867),g=y(51217),R=/^\[object .+?Constructor\]$/,Be=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");ie.exports=function(W){return!(!c(W)||_(W))&&(M(W)?Be:R).test(g(W))}},67495:(ie,L,y)=>{var M=y(26663),_=y(27503);ie.exports=function(O){return _(O)&&"[object Set]"==M(O)}},99390:(ie,L,y)=>{var M=y(72802),_=y(8613),c=y(27503),kt={};kt["[object Float32Array]"]=kt["[object Float64Array]"]=kt["[object Int8Array]"]=kt["[object Int16Array]"]=kt["[object Int32Array]"]=kt["[object Uint8Array]"]=kt["[object Uint8ClampedArray]"]=kt["[object Uint16Array]"]=kt["[object Uint32Array]"]=!0,kt["[object Arguments]"]=kt["[object Array]"]=kt["[object ArrayBuffer]"]=kt["[object Boolean]"]=kt["[object DataView]"]=kt["[object Date]"]=kt["[object Error]"]=kt["[object Function]"]=kt["[object Map]"]=kt["[object Number]"]=kt["[object Object]"]=kt["[object RegExp]"]=kt["[object Set]"]=kt["[object String]"]=kt["[object WeakMap]"]=!1,ie.exports=function(Er){return c(Er)&&_(Er.length)&&!!kt[M(Er)]}},92488:(ie,L,y)=>{var M=y(58845),_=y(36700),g=Object.prototype.hasOwnProperty;ie.exports=function(R){if(!M(R))return _(R);var B=[];for(var H in Object(R))g.call(R,H)&&"constructor"!=H&&B.push(H);return B}},50762:(ie,L,y)=>{var M=y(53867),_=y(58845),c=y(25618),O=Object.prototype.hasOwnProperty;ie.exports=function(B){if(!M(B))return c(B);var H=_(B),G=[];for(var be in B)"constructor"==be&&(H||!O.call(B,be))||G.push(be);return G}},9085:(ie,L,y)=>{var M=y(33667),_=y(63530),c=y(75290),g=y(23607),O=y(53867),R=y(42970),B=y(45959);ie.exports=function H(G,be,Be,j,W){G!==be&&c(be,function(Ke,xt){if(W||(W=new M),O(Ke))g(G,be,xt,Be,H,j,W);else{var Dt=j?j(B(G,xt),Ke,xt+"",G,be,W):void 0;void 0===Dt&&(Dt=Ke),_(G,xt,Dt)}},R)}},23607:(ie,L,y)=>{var M=y(63530),_=y(50694),c=y(96282),g=y(53595),O=y(31563),R=y(2952),B=y(81690),H=y(82027),G=y(84444),be=y(55836),Be=y(53867),j=y(82358),W=y(47679),Ke=y(45959),xt=y(31413);ie.exports=function(Et,ut,tt,Gt,Q,Vt,ot){var Ue=Ke(Et,tt),pt=Ke(ut,tt),Xe=ot.get(pt);if(Xe)M(Et,tt,Xe);else{var At=Vt?Vt(Ue,pt,tt+"",Et,ut,ot):void 0,kt=void 0===At;if(kt){var Yt=B(pt),Er=!Yt&&G(pt),ge=!Yt&&!Er&&W(pt);At=pt,Yt||Er||ge?B(Ue)?At=Ue:H(Ue)?At=g(Ue):Er?(kt=!1,At=_(pt,!0)):ge?(kt=!1,At=c(pt,!0)):At=[]:j(pt)||R(pt)?(At=Ue,R(Ue)?At=xt(Ue):(!Be(Ue)||be(Ue))&&(At=O(pt))):kt=!1}kt&&(ot.set(pt,At),Q(At,pt,Gt,Vt,ot),ot.delete(pt)),M(Et,tt,At)}}},17421:ie=>{ie.exports=function(y){return function(M){return null==y?void 0:y[M]}}},84441:(ie,L,y)=>{var M=y(80290),_=y(15529),c=y(39009);ie.exports=function(O,R){return c(_(O,R,M),O+"")}},99372:(ie,L,y)=>{var M=y(45654),_=y(20395),c=y(80290);ie.exports=_?function(O,R){return _(O,"toString",{configurable:!0,enumerable:!1,value:M(R),writable:!0})}:c},63586:ie=>{ie.exports=function(y,M,_){var c=-1,g=y.length;M<0&&(M=-M>g?0:g+M),(_=_>g?g:_)<0&&(_+=g),g=M>_?0:_-M>>>0,M>>>=0;for(var O=Array(g);++c<g;)O[c]=y[c+M];return O}},48282:ie=>{ie.exports=function(y,M){for(var _=-1,c=Array(y);++_<y;)c[_]=M(_);return c}},68166:(ie,L,y)=>{var M=y(57333),_=y(14992),c=y(81690),g=y(7786),R=M?M.prototype:void 0,B=R?R.toString:void 0;ie.exports=function H(G){if("string"==typeof G)return G;if(c(G))return _(G,H)+"";if(g(G))return B?B.call(G):"";var be=G+"";return"0"==be&&1/G==-1/0?"-0":be}},13743:(ie,L,y)=>{var M=y(87478),_=/^\s+/;ie.exports=function(g){return g&&g.slice(0,M(g)+1).replace(_,"")}},70544:ie=>{ie.exports=function(y){return function(M){return y(M)}}},83987:(ie,L,y)=>{var M=y(48690),_=y(5242),c=y(80679),g=y(13747),O=y(52252),R=y(57673);ie.exports=function(G,be,Be){var j=-1,W=_,Ke=G.length,xt=!0,Dt=[],Et=Dt;if(Be)xt=!1,W=c;else if(Ke>=200){var ut=be?null:O(G);if(ut)return R(ut);xt=!1,W=g,Et=new M}else Et=be?[]:Dt;e:for(;++j<Ke;){var tt=G[j],Gt=be?be(tt):tt;if(tt=Be||0!==tt?tt:0,xt&&Gt==Gt){for(var Q=Et.length;Q--;)if(Et[Q]===Gt)continue e;be&&Et.push(Gt),Dt.push(tt)}else W(Et,Gt,Be)||(Et!==Dt&&Et.push(Gt),Dt.push(tt))}return Dt}},13747:ie=>{ie.exports=function(y,M){return y.has(M)}},26477:(ie,L,y)=>{var M=y(63586);ie.exports=function(c,g,O){var R=c.length;return O=void 0===O?R:O,!g&&O>=R?c:M(c,g,O)}},88461:(ie,L,y)=>{var M=y(96820);ie.exports=function(c){var g=new c.constructor(c.byteLength);return new M(g).set(new M(c)),g}},50694:(ie,L,y)=>{ie=y.nmd(ie);var M=y(27038),_=L&&!L.nodeType&&L,c=_&&ie&&!ie.nodeType&&ie,O=c&&c.exports===_?M.Buffer:void 0,R=O?O.allocUnsafe:void 0;ie.exports=function(H,G){if(G)return H.slice();var be=H.length,Be=R?R(be):new H.constructor(be);return H.copy(Be),Be}},59757:(ie,L,y)=>{var M=y(88461);ie.exports=function(c,g){var O=g?M(c.buffer):c.buffer;return new c.constructor(O,c.byteOffset,c.byteLength)}},83615:ie=>{var L=/\w*$/;ie.exports=function(M){var _=new M.constructor(M.source,L.exec(M));return _.lastIndex=M.lastIndex,_}},42282:(ie,L,y)=>{var M=y(57333),_=M?M.prototype:void 0,c=_?_.valueOf:void 0;ie.exports=function(O){return c?Object(c.call(O)):{}}},96282:(ie,L,y)=>{var M=y(88461);ie.exports=function(c,g){var O=g?M(c.buffer):c.buffer;return new c.constructor(O,c.byteOffset,c.length)}},53595:ie=>{ie.exports=function(y,M){var _=-1,c=y.length;for(M||(M=Array(c));++_<c;)M[_]=y[_];return M}},11694:(ie,L,y)=>{var M=y(23898),_=y(63581);ie.exports=function(g,O,R,B){var H=!R;R||(R={});for(var G=-1,be=O.length;++G<be;){var Be=O[G],j=B?B(R[Be],g[Be],Be,R,g):void 0;void 0===j&&(j=g[Be]),H?_(R,Be,j):M(R,Be,j)}return R}},14746:(ie,L,y)=>{var M=y(11694),_=y(10296);ie.exports=function(g,O){return M(g,_(g),O)}},78857:(ie,L,y)=>{var M=y(11694),_=y(29572);ie.exports=function(g,O){return M(g,_(g),O)}},93412:(ie,L,y)=>{var M=y(27038);ie.exports=M["__core-js_shared__"]},30906:(ie,L,y)=>{var M=y(84441),_=y(71100);ie.exports=function(g){return M(function(O,R){var B=-1,H=R.length,G=H>1?R[H-1]:void 0,be=H>2?R[2]:void 0;for(G=g.length>3&&"function"==typeof G?(H--,G):void 0,be&&_(R[0],R[1],be)&&(G=H<3?void 0:G,H=1),O=Object(O);++B<H;){var Be=R[B];Be&&g(O,Be,B,G)}return O})}},8269:ie=>{ie.exports=function(y){return function(M,_,c){for(var g=-1,O=Object(M),R=c(M),B=R.length;B--;){var H=R[y?B:++g];if(!1===_(O[H],H,O))break}return M}}},66803:(ie,L,y)=>{var M=y(26477),_=y(407),c=y(2150),g=y(41233);ie.exports=function(R){return function(B){B=g(B);var H=_(B)?c(B):void 0,G=H?H[0]:B.charAt(0),be=H?M(H,1).join(""):B.slice(1);return G[R]()+be}}},17407:(ie,L,y)=>{var M=y(89731),_=y(75289),c=y(96590),O=RegExp("['\u2019]","g");ie.exports=function(B){return function(H){return M(c(_(H).replace(O,"")),B,"")}}},52252:(ie,L,y)=>{var M=y(74918),_=y(49122),c=y(57673),O=M&&1/c(new M([,-0]))[1]==1/0?function(R){return new M(R)}:_;ie.exports=O},4068:(ie,L,y)=>{var c=y(17421)({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"});ie.exports=c},20395:(ie,L,y)=>{var M=y(4153),_=function(){try{var c=M(Object,"defineProperty");return c({},"",{}),c}catch(g){}}();ie.exports=_},27667:(ie,L,y)=>{var M=y(48690),_=y(8141),c=y(13747);ie.exports=function(B,H,G,be,Be,j){var W=1&G,Ke=B.length,xt=H.length;if(Ke!=xt&&!(W&&xt>Ke))return!1;var Dt=j.get(B),Et=j.get(H);if(Dt&&Et)return Dt==H&&Et==B;var ut=-1,tt=!0,Gt=2&G?new M:void 0;for(j.set(B,H),j.set(H,B);++ut<Ke;){var Q=B[ut],Vt=H[ut];if(be)var ot=W?be(Vt,Q,ut,H,B,j):be(Q,Vt,ut,B,H,j);if(void 0!==ot){if(ot)continue;tt=!1;break}if(Gt){if(!_(H,function(Ue,pt){if(!c(Gt,pt)&&(Q===Ue||Be(Q,Ue,G,be,j)))return Gt.push(pt)})){tt=!1;break}}else if(Q!==Vt&&!Be(Q,Vt,G,be,j)){tt=!1;break}}return j.delete(B),j.delete(H),tt}},64630:(ie,L,y)=>{var M=y(57333),_=y(96820),c=y(71166),g=y(27667),O=y(37461),R=y(57673),Gt=M?M.prototype:void 0,Q=Gt?Gt.valueOf:void 0;ie.exports=function(ot,Ue,pt,Xe,At,kt,Yt){switch(pt){case"[object DataView]":if(ot.byteLength!=Ue.byteLength||ot.byteOffset!=Ue.byteOffset)return!1;ot=ot.buffer,Ue=Ue.buffer;case"[object ArrayBuffer]":return!(ot.byteLength!=Ue.byteLength||!kt(new _(ot),new _(Ue)));case"[object Boolean]":case"[object Date]":case"[object Number]":return c(+ot,+Ue);case"[object Error]":return ot.name==Ue.name&&ot.message==Ue.message;case"[object RegExp]":case"[object String]":return ot==Ue+"";case"[object Map]":var Er=O;case"[object Set]":if(Er||(Er=R),ot.size!=Ue.size&&!(1&Xe))return!1;var de=Yt.get(ot);if(de)return de==Ue;Xe|=2,Yt.set(ot,Ue);var oe=g(Er(ot),Er(Ue),Xe,At,kt,Yt);return Yt.delete(ot),oe;case"[object Symbol]":if(Q)return Q.call(ot)==Q.call(Ue)}return!1}},70838:(ie,L,y)=>{var M=y(58605),g=Object.prototype.hasOwnProperty;ie.exports=function(R,B,H,G,be,Be){var j=1&H,W=M(R),Ke=W.length;if(Ke!=M(B).length&&!j)return!1;for(var Et=Ke;Et--;){var ut=W[Et];if(!(j?ut in B:g.call(B,ut)))return!1}var tt=Be.get(R),Gt=Be.get(B);if(tt&&Gt)return tt==B&&Gt==R;var Q=!0;Be.set(R,B),Be.set(B,R);for(var Vt=j;++Et<Ke;){var ot=R[ut=W[Et]],Ue=B[ut];if(G)var pt=j?G(Ue,ot,ut,B,R,Be):G(ot,Ue,ut,R,B,Be);if(!(void 0===pt?ot===Ue||be(ot,Ue,H,G,Be):pt)){Q=!1;break}Vt||(Vt="constructor"==ut)}if(Q&&!Vt){var Xe=R.constructor,At=B.constructor;Xe!=At&&"constructor"in R&&"constructor"in B&&!("function"==typeof Xe&&Xe instanceof Xe&&"function"==typeof At&&At instanceof At)&&(Q=!1)}return Be.delete(R),Be.delete(B),Q}},61138:ie=>{var L="object"==typeof global&&global&&global.Object===Object&&global;ie.exports=L},58605:(ie,L,y)=>{var M=y(19215),_=y(10296),c=y(59108);ie.exports=function(O){return M(O,c,_)}},51675:(ie,L,y)=>{var M=y(19215),_=y(29572),c=y(42970);ie.exports=function(O){return M(O,c,_)}},85556:(ie,L,y)=>{var M=y(36586);ie.exports=function(c,g){var O=c.__data__;return M(g)?O["string"==typeof g?"string":"hash"]:O.map}},4153:(ie,L,y)=>{var M=y(43540),_=y(36825);ie.exports=function(g,O){var R=_(g,O);return M(R)?R:void 0}},52398:(ie,L,y)=>{var _=y(93332)(Object.getPrototypeOf,Object);ie.exports=_},21613:(ie,L,y)=>{var M=y(57333),_=Object.prototype,c=_.hasOwnProperty,g=_.toString,O=M?M.toStringTag:void 0;ie.exports=function(B){var H=c.call(B,O),G=B[O];try{B[O]=void 0;var be=!0}catch(j){}var Be=g.call(B);return be&&(H?B[O]=G:delete B[O]),Be}},10296:(ie,L,y)=>{var M=y(11375),_=y(65336),g=Object.prototype.propertyIsEnumerable,O=Object.getOwnPropertySymbols;ie.exports=O?function(B){return null==B?[]:(B=Object(B),M(O(B),function(H){return g.call(B,H)}))}:_},29572:(ie,L,y)=>{var M=y(94165),_=y(52398),c=y(10296),g=y(65336);ie.exports=Object.getOwnPropertySymbols?function(B){for(var H=[];B;)M(H,c(B)),B=_(B);return H}:g},26663:(ie,L,y)=>{var M=y(81235),_=y(39046),c=y(97129),g=y(74918),O=y(54203),R=y(72802),B=y(51217),H="[object Map]",be="[object Promise]",Be="[object Set]",j="[object WeakMap]",W="[object DataView]",Ke=B(M),xt=B(_),Dt=B(c),Et=B(g),ut=B(O),tt=R;(M&&tt(new M(new ArrayBuffer(1)))!=W||_&&tt(new _)!=H||c&&tt(c.resolve())!=be||g&&tt(new g)!=Be||O&&tt(new O)!=j)&&(tt=function(Gt){var Q=R(Gt),Vt="[object Object]"==Q?Gt.constructor:void 0,ot=Vt?B(Vt):"";if(ot)switch(ot){case Ke:return W;case xt:return H;case Dt:return be;case Et:return Be;case ut:return j}return Q}),ie.exports=tt},36825:ie=>{ie.exports=function(y,M){return null==y?void 0:y[M]}},407:ie=>{var R=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");ie.exports=function(H){return R.test(H)}},59316:ie=>{var L=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;ie.exports=function(M){return L.test(M)}},59410:(ie,L,y)=>{var M=y(95969);ie.exports=function(){this.__data__=M?M(null):{},this.size=0}},21143:ie=>{ie.exports=function(y){var M=this.has(y)&&delete this.__data__[y];return this.size-=M?1:0,M}},604:(ie,L,y)=>{var M=y(95969),g=Object.prototype.hasOwnProperty;ie.exports=function(R){var B=this.__data__;if(M){var H=B[R];return"__lodash_hash_undefined__"===H?void 0:H}return g.call(B,R)?B[R]:void 0}},80584:(ie,L,y)=>{var M=y(95969),c=Object.prototype.hasOwnProperty;ie.exports=function(O){var R=this.__data__;return M?void 0!==R[O]:c.call(R,O)}},7792:(ie,L,y)=>{var M=y(95969);ie.exports=function(g,O){var R=this.__data__;return this.size+=this.has(g)?0:1,R[g]=M&&void 0===O?"__lodash_hash_undefined__":O,this}},62963:ie=>{var y=Object.prototype.hasOwnProperty;ie.exports=function(_){var c=_.length,g=new _.constructor(c);return c&&"string"==typeof _[0]&&y.call(_,"index")&&(g.index=_.index,g.input=_.input),g}},32143:(ie,L,y)=>{var M=y(88461),_=y(59757),c=y(83615),g=y(42282),O=y(96282);ie.exports=function(Xe,At,kt){var Yt=Xe.constructor;switch(At){case"[object ArrayBuffer]":return M(Xe);case"[object Boolean]":case"[object Date]":return new Yt(+Xe);case"[object DataView]":return _(Xe,kt);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return O(Xe,kt);case"[object Map]":return new Yt;case"[object Number]":case"[object String]":return new Yt(Xe);case"[object RegExp]":return c(Xe);case"[object Set]":return new Yt;case"[object Symbol]":return g(Xe)}}},31563:(ie,L,y)=>{var M=y(60920),_=y(52398),c=y(58845);ie.exports=function(O){return"function"!=typeof O.constructor||c(O)?{}:M(_(O))}},20968:ie=>{var y=/^(?:0|[1-9]\d*)$/;ie.exports=function(_,c){var g=typeof _;return!!(c=null==c?9007199254740991:c)&&("number"==g||"symbol"!=g&&y.test(_))&&_>-1&&_%1==0&&_<c}},71100:(ie,L,y)=>{var M=y(71166),_=y(93406),c=y(20968),g=y(53867);ie.exports=function(R,B,H){if(!g(H))return!1;var G=typeof B;return!!("number"==G?_(H)&&c(B,H.length):"string"==G&&B in H)&&M(H[B],R)}},36586:ie=>{ie.exports=function(y){var M=typeof y;return"string"==M||"number"==M||"symbol"==M||"boolean"==M?"__proto__"!==y:null===y}},38466:(ie,L,y)=>{var g,M=y(93412),_=(g=/[^.]+$/.exec(M&&M.keys&&M.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"";ie.exports=function(g){return!!_&&_ in g}},58845:ie=>{var L=Object.prototype;ie.exports=function(M){var _=M&&M.constructor;return M===("function"==typeof _&&_.prototype||L)}},63391:ie=>{ie.exports=function(){this.__data__=[],this.size=0}},68971:(ie,L,y)=>{var M=y(15758),c=Array.prototype.splice;ie.exports=function(O){var R=this.__data__,B=M(R,O);return!(B<0||(B==R.length-1?R.pop():c.call(R,B,1),--this.size,0))}},18858:(ie,L,y)=>{var M=y(15758);ie.exports=function(c){var g=this.__data__,O=M(g,c);return O<0?void 0:g[O][1]}},13913:(ie,L,y)=>{var M=y(15758);ie.exports=function(c){return M(this.__data__,c)>-1}},68944:(ie,L,y)=>{var M=y(15758);ie.exports=function(c,g){var O=this.__data__,R=M(O,c);return R<0?(++this.size,O.push([c,g])):O[R][1]=g,this}},70536:(ie,L,y)=>{var M=y(41505),_=y(73545),c=y(39046);ie.exports=function(){this.size=0,this.__data__={hash:new M,map:new(c||_),string:new M}}},61502:(ie,L,y)=>{var M=y(85556);ie.exports=function(c){var g=M(this,c).delete(c);return this.size-=g?1:0,g}},94960:(ie,L,y)=>{var M=y(85556);ie.exports=function(c){return M(this,c).get(c)}},61539:(ie,L,y)=>{var M=y(85556);ie.exports=function(c){return M(this,c).has(c)}},34138:(ie,L,y)=>{var M=y(85556);ie.exports=function(c,g){var O=M(this,c),R=O.size;return O.set(c,g),this.size+=O.size==R?0:1,this}},37461:ie=>{ie.exports=function(y){var M=-1,_=Array(y.size);return y.forEach(function(c,g){_[++M]=[g,c]}),_}},95969:(ie,L,y)=>{var _=y(4153)(Object,"create");ie.exports=_},36700:(ie,L,y)=>{var _=y(93332)(Object.keys,Object);ie.exports=_},25618:ie=>{ie.exports=function(y){var M=[];if(null!=y)for(var _ in Object(y))M.push(_);return M}},70938:(ie,L,y)=>{ie=y.nmd(ie);var M=y(61138),_=L&&!L.nodeType&&L,c=_&&ie&&!ie.nodeType&&ie,O=c&&c.exports===_&&M.process,R=function(){try{return c&&c.require&&c.require("util").types||O&&O.binding&&O.binding("util")}catch(H){}}();ie.exports=R},81244:ie=>{var y=Object.prototype.toString;ie.exports=function(_){return y.call(_)}},93332:ie=>{ie.exports=function(y,M){return function(_){return y(M(_))}}},15529:(ie,L,y)=>{var M=y(81638),_=Math.max;ie.exports=function(g,O,R){return O=_(void 0===O?g.length-1:O,0),function(){for(var B=arguments,H=-1,G=_(B.length-O,0),be=Array(G);++H<G;)be[H]=B[O+H];H=-1;for(var Be=Array(O+1);++H<O;)Be[H]=B[H];return Be[O]=R(be),M(g,this,Be)}}},27038:(ie,L,y)=>{var M=y(61138),_="object"==typeof self&&self&&self.Object===Object&&self,c=M||_||Function("return this")();ie.exports=c},45959:ie=>{ie.exports=function(y,M){if(("constructor"!==M||"function"!=typeof y[M])&&"__proto__"!=M)return y[M]}},30365:ie=>{ie.exports=function(M){return this.__data__.set(M,"__lodash_hash_undefined__"),this}},58235:ie=>{ie.exports=function(y){return this.__data__.has(y)}},57673:ie=>{ie.exports=function(y){var M=-1,_=Array(y.size);return y.forEach(function(c){_[++M]=c}),_}},39009:(ie,L,y)=>{var M=y(99372),c=y(44094)(M);ie.exports=c},44094:ie=>{var M=Date.now;ie.exports=function(c){var g=0,O=0;return function(){var R=M(),B=16-(R-O);if(O=R,B>0){if(++g>=800)return arguments[0]}else g=0;return c.apply(void 0,arguments)}}},18034:(ie,L,y)=>{var M=y(73545);ie.exports=function(){this.__data__=new M,this.size=0}},37238:ie=>{ie.exports=function(y){var M=this.__data__,_=M.delete(y);return this.size=M.size,_}},54384:ie=>{ie.exports=function(y){return this.__data__.get(y)}},81450:ie=>{ie.exports=function(y){return this.__data__.has(y)}},61386:(ie,L,y)=>{var M=y(73545),_=y(39046),c=y(93177);ie.exports=function(R,B){var H=this.__data__;if(H instanceof M){var G=H.__data__;if(!_||G.length<199)return G.push([R,B]),this.size=++H.size,this;H=this.__data__=new c(G)}return H.set(R,B),this.size=H.size,this}},54299:ie=>{ie.exports=function(y,M,_){for(var c=_-1,g=y.length;++c<g;)if(y[c]===M)return c;return-1}},2150:(ie,L,y)=>{var M=y(87280),_=y(407),c=y(1879);ie.exports=function(O){return _(O)?c(O):M(O)}},51217:ie=>{var y=Function.prototype.toString;ie.exports=function(_){if(null!=_){try{return y.call(_)}catch(c){}try{return _+""}catch(c){}}return""}},87478:ie=>{var L=/\s/;ie.exports=function(M){for(var _=M.length;_--&&L.test(M.charAt(_)););return _}},1879:ie=>{var L="\\ud800-\\udfff",O="["+L+"]",R="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",B="\\ud83c[\\udffb-\\udfff]",G="[^"+L+"]",be="(?:\\ud83c[\\udde6-\\uddff]){2}",Be="[\\ud800-\\udbff][\\udc00-\\udfff]",W="(?:"+R+"|"+B+")?",Ke="[\\ufe0e\\ufe0f]?",Dt=Ke+W+"(?:\\u200d(?:"+[G,be,Be].join("|")+")"+Ke+W+")*",Et="(?:"+[G+R+"?",R,be,Be,O].join("|")+")",ut=RegExp(B+"(?="+B+")|"+Et+Dt,"g");ie.exports=function(Gt){return Gt.match(ut)||[]}},58863:ie=>{var L="\\ud800-\\udfff",g="\\u2700-\\u27bf",O="a-z\\xdf-\\xf6\\xf8-\\xff",be="A-Z\\xc0-\\xd6\\xd8-\\xde",j="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ke="["+j+"]",Dt="\\d+",Et="["+g+"]",ut="["+O+"]",tt="[^"+L+j+Dt+g+O+be+"]",ot="(?:\\ud83c[\\udde6-\\uddff]){2}",Ue="[\\ud800-\\udbff][\\udc00-\\udfff]",pt="["+be+"]",At="(?:"+ut+"|"+tt+")",kt="(?:"+pt+"|"+tt+")",Yt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Er="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",ge="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",de="[\\ufe0e\\ufe0f]?",Ge=de+ge+"(?:\\u200d(?:"+["[^"+L+"]",ot,Ue].join("|")+")"+de+ge+")*",gt="(?:"+[Et,ot,Ue].join("|")+")"+Ge,br=RegExp([pt+"?"+ut+"+"+Yt+"(?="+[Ke,pt,"$"].join("|")+")",kt+"+"+Er+"(?="+[Ke,pt+At,"$"].join("|")+")",pt+"?"+At+"+"+Yt,pt+"+"+Er,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Dt,gt].join("|"),"g");ie.exports=function(cn){return cn.match(br)||[]}},35037:(ie,L,y)=>{var M=y(76974),c=y(17407)(function(g,O,R){return O=O.toLowerCase(),g+(R?M(O):O)});ie.exports=c},76974:(ie,L,y)=>{var M=y(41233),_=y(93890);ie.exports=function(g){return _(M(g).toLowerCase())}},43770:(ie,L,y)=>{var M=y(15820),_=y(45038);ie.exports=function(g,O,R){return void 0===R&&(R=O,O=void 0),void 0!==R&&(R=(R=_(R))==R?R:0),void 0!==O&&(O=(O=_(O))==O?O:0),M(_(g),O,R)}},37524:(ie,L,y)=>{var M=y(77007);ie.exports=function(O){return M(O,5)}},45654:ie=>{ie.exports=function(y){return function(){return y}}},75289:(ie,L,y)=>{var M=y(4068),_=y(41233),c=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,G=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");ie.exports=function(Be){return(Be=_(Be))&&Be.replace(c,M).replace(G,"")}},71166:ie=>{ie.exports=function(y,M){return y===M||y!=y&&M!=M}},80290:ie=>{ie.exports=function(y){return y}},2952:(ie,L,y)=>{var M=y(77090),_=y(27503),c=Object.prototype,g=c.hasOwnProperty,O=c.propertyIsEnumerable,R=M(function(){return arguments}())?M:function(B){return _(B)&&g.call(B,"callee")&&!O.call(B,"callee")};ie.exports=R},81690:ie=>{ie.exports=Array.isArray},93406:(ie,L,y)=>{var M=y(55836),_=y(8613);ie.exports=function(g){return null!=g&&_(g.length)&&!M(g)}},82027:(ie,L,y)=>{var M=y(93406),_=y(27503);ie.exports=function(g){return _(g)&&M(g)}},84444:(ie,L,y)=>{ie=y.nmd(ie);var M=y(27038),_=y(61711),c=L&&!L.nodeType&&L,g=c&&ie&&!ie.nodeType&&ie,R=g&&g.exports===c?M.Buffer:void 0;ie.exports=(R?R.isBuffer:void 0)||_},49977:(ie,L,y)=>{var M=y(30696);ie.exports=function(c,g){return M(c,g)}},55836:(ie,L,y)=>{var M=y(72802),_=y(53867);ie.exports=function(H){if(!_(H))return!1;var G=M(H);return"[object Function]"==G||"[object GeneratorFunction]"==G||"[object AsyncFunction]"==G||"[object Proxy]"==G}},8613:ie=>{ie.exports=function(M){return"number"==typeof M&&M>-1&&M%1==0&&M<=9007199254740991}},32e3:(ie,L,y)=>{var M=y(63434),_=y(70544),c=y(70938),g=c&&c.isMap,O=g?_(g):M;ie.exports=O},28303:ie=>{ie.exports=function(y){return null==y}},80167:(ie,L,y)=>{var M=y(72802),_=y(27503);ie.exports=function(O){return"number"==typeof O||_(O)&&"[object Number]"==M(O)}},53867:ie=>{ie.exports=function(y){var M=typeof y;return null!=y&&("object"==M||"function"==M)}},27503:ie=>{ie.exports=function(y){return null!=y&&"object"==typeof y}},82358:(ie,L,y)=>{var M=y(72802),_=y(52398),c=y(27503),B=Function.prototype.toString,H=Object.prototype.hasOwnProperty,G=B.call(Object);ie.exports=function(Be){if(!c(Be)||"[object Object]"!=M(Be))return!1;var j=_(Be);if(null===j)return!0;var W=H.call(j,"constructor")&&j.constructor;return"function"==typeof W&&W instanceof W&&B.call(W)==G}},48855:(ie,L,y)=>{var M=y(67495),_=y(70544),c=y(70938),g=c&&c.isSet,O=g?_(g):M;ie.exports=O},64871:(ie,L,y)=>{var M=y(72802),_=y(81690),c=y(27503);ie.exports=function(R){return"string"==typeof R||!_(R)&&c(R)&&"[object String]"==M(R)}},7786:(ie,L,y)=>{var M=y(72802),_=y(27503);ie.exports=function(O){return"symbol"==typeof O||_(O)&&"[object Symbol]"==M(O)}},47679:(ie,L,y)=>{var M=y(99390),_=y(70544),c=y(70938),g=c&&c.isTypedArray,O=g?_(g):M;ie.exports=O},59108:(ie,L,y)=>{var M=y(71890),_=y(92488),c=y(93406);ie.exports=function(O){return c(O)?M(O):_(O)}},42970:(ie,L,y)=>{var M=y(71890),_=y(50762),c=y(93406);ie.exports=function(O){return c(O)?M(O,!0):_(O)}},3912:(ie,L,y)=>{var M=y(9085),c=y(30906)(function(g,O,R){M(g,O,R)});ie.exports=c},33939:(ie,L,y)=>{var M=y(9085),c=y(30906)(function(g,O,R,B){M(g,O,R,B)});ie.exports=c},49122:ie=>{ie.exports=function(){}},65336:ie=>{ie.exports=function(){return[]}},61711:ie=>{ie.exports=function(){return!1}},45038:(ie,L,y)=>{var M=y(13743),_=y(53867),c=y(7786),O=/^[-+]0x[0-9a-f]+$/i,R=/^0b[01]+$/i,B=/^0o[0-7]+$/i,H=parseInt;ie.exports=function(be){if("number"==typeof be)return be;if(c(be))return NaN;if(_(be)){var Be="function"==typeof be.valueOf?be.valueOf():be;be=_(Be)?Be+"":Be}if("string"!=typeof be)return 0===be?be:+be;be=M(be);var j=R.test(be);return j||B.test(be)?H(be.slice(2),j?2:8):O.test(be)?NaN:+be}},31413:(ie,L,y)=>{var M=y(11694),_=y(42970);ie.exports=function(g){return M(g,_(g))}},41233:(ie,L,y)=>{var M=y(68166);ie.exports=function(c){return null==c?"":M(c)}},72699:(ie,L,y)=>{var M=y(83987);ie.exports=function(c){return c&&c.length?M(c):[]}},93890:(ie,L,y)=>{var _=y(66803)("toUpperCase");ie.exports=_},96590:(ie,L,y)=>{var M=y(54561),_=y(59316),c=y(41233),g=y(58863);ie.exports=function(R,B,H){return R=c(R),void 0===(B=H?void 0:B)?_(R)?g(R):M(R):R.match(B)||[]}},82958:function(ie){ie.exports=function(){"use strict";var L,y,M;function _(c,g){if(L)if(y){var O="var sharedChunk = {}; ("+L+")(sharedChunk); ("+y+")(sharedChunk);",R={};L(R),M=g(R),"undefined"!=typeof window&&(M.workerUrl=window.URL.createObjectURL(new Blob([O],{type:"text/javascript"})))}else y=g;else L=g}return _(0,function(c){function g(e,t){return e(t={exports:{}},t.exports),t.exports}var O=R;function R(e,t,r,f){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(f-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=f,this.p2x=r,this.p2y=f}R.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},R.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},R.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},R.prototype.solveCurveX=function(e,t){var r,f,d,x,S;for(void 0===t&&(t=1e-6),d=e,S=0;S<8;S++){if(x=this.sampleCurveX(d)-e,Math.abs(x)<t)return d;var P=this.sampleCurveDerivativeX(d);if(Math.abs(P)<1e-6)break;d-=x/P}if((d=e)<(r=0))return r;if(d>(f=1))return f;for(;r<f;){if(x=this.sampleCurveX(d),Math.abs(x-e)<t)return d;e>x?r=d:f=d,d=.5*(f-r)+r}return d},R.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var B=H;function H(e,t){this.x=e,this.y=t}H.prototype={clone:function(){return new H(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),f=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=f,this},_rotateAround:function(e,t){var r=Math.cos(e),f=Math.sin(e),d=t.y+f*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-f*(this.y-t.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},H.convert=function(e){return e instanceof H?e:Array.isArray(e)?new H(e[0],e[1]):e};var G="undefined"!=typeof self?self:{},be=Math.pow(2,53)-1;function Be(e,t,r,f){var d=new O(e,t,r,f);return function(x){return d.solve(x)}}var j=Be(.25,.1,.25,1);function W(e,t,r){return Math.min(r,Math.max(t,e))}function Ke(e,t,r){var f=r-t,d=((e-t)%f+f)%f+t;return d===t?r:d}function xt(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var f=0,d=t;f<d.length;f+=1){var x=d[f];for(var S in x)e[S]=x[S]}return e}var Dt=1;function Et(){return Dt++}function ut(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function tt(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function Gt(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function Q(e,t){return-1!==e.indexOf(t,e.length-t.length)}function Vt(e,t,r){var f={};for(var d in e)f[d]=t.call(r||this,e[d],d,e);return f}function ot(e,t,r){var f={};for(var d in e)t.call(r||this,e[d],d,e)&&(f[d]=e[d]);return f}function Ue(e){return Array.isArray(e)?e.map(Ue):"object"==typeof e&&e?Vt(e,Ue):e}var pt={};function Xe(e){pt[e]||("undefined"!=typeof console&&console.warn(e),pt[e]=!0)}function At(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function kt(e){for(var t=0,r=0,f=e.length,d=f-1,x=void 0,S=void 0;r<f;d=r++)t+=((S=e[d]).x-(x=e[r]).x)*(x.y+S.y);return t}function Yt(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Er(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(f,d,x,S){var P=x||S;return t[d]=!P||P.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var ge=null;function de(e){if(null==ge){var t=e.navigator?e.navigator.userAgent:null;ge=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ge}function oe(e){try{var t=G[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var me,Me,Ge,gt,br=G.performance&&G.performance.now?G.performance.now.bind(G.performance):Date.now.bind(Date),Nr=G.requestAnimationFrame||G.mozRequestAnimationFrame||G.webkitRequestAnimationFrame||G.msRequestAnimationFrame,cn=G.cancelAnimationFrame||G.mozCancelAnimationFrame||G.webkitCancelAnimationFrame||G.msCancelAnimationFrame,Ir={now:br,frame:function(e){var t=Nr(e);return{cancel:function(){return cn(t)}}},getImageData:function(e,t){void 0===t&&(t=0);var r=G.document.createElement("canvas"),f=r.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,f.drawImage(e,0,0,e.width,e.height),f.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return me||(me=G.document.createElement("a")),me.href=e,me.href},hardwareConcurrency:G.navigator&&G.navigator.hardwareConcurrency||4,get devicePixelRatio(){return G.devicePixelRatio},get prefersReducedMotion(){return!!G.matchMedia&&(null==Me&&(Me=G.matchMedia("(prefers-reduced-motion: reduce)")),Me.matches)}},Mt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Le={supported:!1,testSupport:function(e){!we&&gt&&(at?Re(e):Ge=e)}},we=!1,at=!1;function Re(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,gt),e.isContextLost())return;Le.supported=!0}catch(r){}e.deleteTexture(t),we=!0}G.document&&((gt=G.document.createElement("img")).onload=function(){Ge&&Re(Ge),Ge=null,at=!0},gt.onerror=function(){we=!0,Ge=null},gt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var qt="01",Pr=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function er(e){return 0===e.indexOf("mapbox:")}Pr.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",qt,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Pr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Pr.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Pr.prototype.normalizeStyleURL=function(e,t){if(!er(e))return e;var r=C(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Pr.prototype.normalizeGlyphsURL=function(e,t){if(!er(e))return e;var r=C(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Pr.prototype.normalizeSourceURL=function(e,t){if(!er(e))return e;var r=C(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},Pr.prototype.normalizeSpriteURL=function(e,t,r,f){var d=C(e);return er(e)?(d.path="/styles/v1"+d.path+"/sprite"+t+r,this._makeAPIURL(d,this._customAccessToken||f)):(d.path+=""+t+r,K(d))},Pr.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!er(e))return e;var r=C(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Ir.devicePixelRatio>=2||512===t?"@2x":"")+(Le.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var f=this._customAccessToken||function(d){for(var x=0,S=d;x<S.length;x+=1){var P=S[x].match(/^access_token=(.*)$/);if(P)return P[1]}return null}(r.params)||Mt.ACCESS_TOKEN;return Mt.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,f)},Pr.prototype.canonicalizeTileURL=function(e,t){var r=C(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var f="mapbox://tiles/";f+=r.path.replace("/v4/","");var d=r.params;return t&&(d=d.filter(function(x){return!x.match(/^access_token=/)})),d.length&&(f+="?"+d.join("&")),f},Pr.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&er(t),f=[],d=0,x=e.tiles||[];d<x.length;d+=1){var S=x[d];Br(S)?f.push(this.canonicalizeTileURL(S,r)):f.push(S)}return f},Pr.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",f=C(Mt.API_URL);if(e.protocol=f.protocol,e.authority=f.authority,"http"===e.protocol){var d=e.params.indexOf("secure");d>=0&&e.params.splice(d,1)}if("/"!==f.path&&(e.path=""+f.path+e.path),!Mt.REQUIRE_ACCESS_TOKEN)return K(e);if(!(t=t||Mt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(x){return-1===x.indexOf("access_token")}),e.params.push("access_token="+t),K(e)};var fr=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Br(e){return fr.test(e)}var $r=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function C(e){var t=e.match($r);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function K(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ve(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(G.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var nt=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};nt.prototype.getStorageKey=function(e){var t,r=Ve(Mt.ACCESS_TOKEN);return t=r&&r.u?G.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(f,d){return String.fromCharCode(Number("0x"+d))})):Mt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},nt.prototype.fetchEventData=function(){var e=oe("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var f=G.localStorage.getItem(t);f&&(this.eventData=JSON.parse(f));var d=G.localStorage.getItem(r);d&&(this.anonId=d)}catch(x){Xe("Unable to read from LocalStorage")}},nt.prototype.saveEventData=function(){var e=oe("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{G.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&G.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(f){Xe("Unable to write to LocalStorage")}},nt.prototype.processRequests=function(e){},nt.prototype.postEvent=function(e,t,r,f){var d=this;if(Mt.EVENTS_URL){var x=C(Mt.EVENTS_URL);x.params.push("access_token="+(f||Mt.ACCESS_TOKEN||""));var S={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:qt,userId:this.anonId},P=t?xt(S,t):S,z={url:K(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=Ei(z,function(J){d.pendingRequest=null,r(J),d.saveEventData(),d.processRequests(f)})}},nt.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var yt,Lt,Z=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,f,d,x){this.skuToken=d,(Mt.EVENTS_URL&&x||Mt.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(S){return er(S)||Br(S)}))&&this.queueRequest({id:f,timestamp:Date.now()},x)},t.prototype.processRequests=function(r){var f=this;if(!this.pendingRequest&&0!==this.queue.length){var d=this.queue.shift(),x=d.id,S=d.timestamp;x&&this.success[x]||(this.anonId||this.fetchEventData(),tt(this.anonId)||(this.anonId=ut()),this.postEvent(S,{skuToken:this.skuToken},function(P){P||x&&(f.success[x]=!0)},r))}},t}(nt),Ze=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,f){Mt.EVENTS_URL&&Mt.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(d){return er(d)||Br(d)})&&this.queueRequest(Date.now(),f)},t.prototype.processRequests=function(r){var f=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var d=Ve(Mt.ACCESS_TOKEN),x=d?d.u:Mt.ACCESS_TOKEN,S=x!==this.eventData.tokenU;tt(this.anonId)||(this.anonId=ut(),S=!0);var P=this.queue.shift();if(this.eventData.lastSuccess){var z=new Date(this.eventData.lastSuccess),J=new Date(P),ee=(P-this.eventData.lastSuccess)/864e5;S=S||ee>=1||ee<-1||z.getDate()!==J.getDate()}else S=!0;if(!S)return this.processRequests();this.postEvent(P,{"enabled.telemetry":!1},function(ue){ue||(f.eventData.lastSuccess=P,f.eventData.tokenU=x)},r)}},t}(nt)),St=Ze.postTurnstileEvent.bind(Ze),It=new Z,Jt=It.postMapLoadEvent.bind(It),Tr=500,vr=50;function Xt(){G.caches&&!yt&&(yt=G.caches.open("mapbox-tiles"))}function mr(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var or,pr=1/0;function mn(){return null==or&&(or=G.OffscreenCanvas&&new G.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof G.createImageBitmap),or}var On={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(On);var si,ai,mi=function(e){function t(r,f,d){401===f&&Br(d)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=f,this.url=d,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),hi=Yt()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===G.location.protocol?G.parent:G).location.href},Ki=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(hi())&&!/^\w+:/.test(r))){if(G.fetch&&G.Request&&G.AbortController&&G.Request.prototype.hasOwnProperty("signal"))return function(f,d){var x,S=new G.AbortController,P=new G.Request(f.url,{method:f.method||"GET",body:f.body,credentials:f.credentials,headers:f.headers,referrer:hi(),signal:S.signal}),z=!1,J=!1,ee=(x=P.url).indexOf("sku=")>0&&Br(x);"json"===f.type&&P.headers.set("Accept","application/json");var ue=function(Se,qe,Je){if(!J){if(Se&&"SecurityError"!==Se.message&&Xe(Se),qe&&Je)return ye(qe);var Tt=Date.now();G.fetch(P).then(function(st){if(st.ok){var Nt=ee?st.clone():null;return ye(st,Nt,Tt)}return d(new mi(st.statusText,st.status,f.url))}).catch(function(st){20!==st.code&&d(new Error(st.message))})}},ye=function(Se,qe,Je){("arrayBuffer"===f.type?Se.arrayBuffer():"json"===f.type?Se.json():Se.text()).then(function(Tt){J||(qe&&Je&&function(st,Nt,Qt){if(Xt(),yt){var gr={status:Nt.status,statusText:Nt.statusText,headers:new G.Headers};Nt.headers.forEach(function(Rr,nn){return gr.headers.set(nn,Rr)});var xr=Er(Nt.headers.get("Cache-Control")||"");xr["no-store"]||(xr["max-age"]&&gr.headers.set("Expires",new Date(Qt+1e3*xr["max-age"]).toUTCString()),new Date(gr.headers.get("Expires")).getTime()-Qt<42e4||function(Rr,nn){if(void 0===Lt)try{new Response(new ReadableStream),Lt=!0}catch(gn){Lt=!1}Lt?nn(Rr.body):Rr.blob().then(nn)}(Nt,function(Rr){var nn=new G.Response(Rr,gr);Xt(),yt&&yt.then(function(gn){return gn.put(mr(st.url),nn)}).catch(function(gn){return Xe(gn.message)})}))}}(P,qe,Je),z=!0,d(null,Tt,Se.headers.get("Cache-Control"),Se.headers.get("Expires")))}).catch(function(Tt){J||d(new Error(Tt.message))})};return ee?function(Se,qe){if(Xt(),!yt)return qe(null);var Je=mr(Se.url);yt.then(function(Tt){Tt.match(Je).then(function(st){var Nt=function(Qt){if(!Qt)return!1;var gr=new Date(Qt.headers.get("Expires")||0),xr=Er(Qt.headers.get("Cache-Control")||"");return gr>Date.now()&&!xr["no-cache"]}(st);Tt.delete(Je),Nt&&Tt.put(Je,st.clone()),qe(null,st,Nt)}).catch(qe)}).catch(qe)}(P,ue):ue(null,null),{cancel:function(){J=!0,z||S.abort()}}}(e,t);if(Yt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(f,d){var x=new G.XMLHttpRequest;for(var S in x.open(f.method||"GET",f.url,!0),"arrayBuffer"===f.type&&(x.responseType="arraybuffer"),f.headers)x.setRequestHeader(S,f.headers[S]);return"json"===f.type&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials="include"===f.credentials,x.onerror=function(){d(new Error(x.statusText))},x.onload=function(){if((x.status>=200&&x.status<300||0===x.status)&&null!==x.response){var P=x.response;if("json"===f.type)try{P=JSON.parse(x.response)}catch(z){return d(z)}d(null,P,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else d(new mi(x.statusText,x.status,f.url))},x.send(f.body),{cancel:function(){return x.abort()}}}(e,t)},Pi=function(e,t){return Ki(xt(e,{type:"arrayBuffer"}),t)},Ei=function(e,t){return Ki(xt(e,{method:"POST"}),t)},re="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";si=[],ai=0;var pe=function(e,t){if(Le.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ai>=Mt.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return si.push(r),r}ai++;var f=!1,d=function(){if(!f)for(f=!0,ai--;si.length&&ai<Mt.MAX_PARALLEL_IMAGE_REQUESTS;){var S=si.shift();S.cancelled||(S.cancel=pe(S.requestParameters,S.callback).cancel)}},x=Pi(e,function(S,P,z,J){var ue,ye;d(),S?t(S):P&&(mn()?(ue=t,ye=new G.Blob([new Uint8Array(P)],{type:"image/png"}),G.createImageBitmap(ye).then(function(Se){ue(null,Se)}).catch(function(Se){ue(new Error("Could not load image because of "+Se.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(ee,ue,ye,Se){var qe=new G.Image,Je=G.URL;qe.onload=function(){ue(null,qe),Je.revokeObjectURL(qe.src),qe.onload=null,G.requestAnimationFrame(function(){qe.src=re})},qe.onerror=function(){return ue(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Tt=new G.Blob([new Uint8Array(ee)],{type:"image/png"});qe.cacheControl=ye,qe.expires=Se,qe.src=ee.byteLength?Je.createObjectURL(Tt):re}(P,t,z,J))});return{cancel:function(){x.cancel(),d()}}};function _e(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function V(e,t,r){if(r&&r[e]){var f=r[e].indexOf(t);-1!==f&&r[e].splice(f,1)}}var ae=function(e,t){void 0===t&&(t={}),xt(this,t),this.type=e},xe=function(e){function t(r,f){void 0===f&&(f={}),e.call(this,"error",xt({error:r},f))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ae),Oe=function(){};Oe.prototype.on=function(e,t){return this._listeners=this._listeners||{},_e(e,t,this._listeners),this},Oe.prototype.off=function(e,t){return V(e,t,this._listeners),V(e,t,this._oneTimeListeners),this},Oe.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},_e(e,t,this._oneTimeListeners),this},Oe.prototype.fire=function(e,t){"string"==typeof e&&(e=new ae(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var f=0,d=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];f<d.length;f+=1)d[f].call(this,e);for(var x=0,S=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];x<S.length;x+=1){var P=S[x];V(r,P,this._oneTimeListeners),P.call(this,e)}var z=this._eventedParent;z&&(xt(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),z.fire(e))}else e instanceof xe&&console.error(e.error);return this},Oe.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Oe.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var fe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Ae=function(e,t,r,f){this.message=(e?e+": ":"")+r,f&&(this.identifier=f),null!=t&&t.__line__&&(this.line=t.__line__)};function wt(e){var t=e.value;return t?[new Ae(e.key,t,"constants have been deprecated as of v8")]:[]}function Sr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var f=0,d=t;f<d.length;f+=1){var x=d[f];for(var S in x)e[S]=x[S]}return e}function Kt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function ir(e){if(Array.isArray(e))return e.map(ir);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=ir(e[r]);return t}return Kt(e)}var Fr=function(e){function t(r,f){e.call(this,f),this.message=f,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Rn=function(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var r=0,f=t;r<f.length;r+=1){var d=f[r];this.bindings[d[0]]=d[1]}};Rn.prototype.concat=function(e){return new Rn(this,e)},Rn.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Rn.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Pn={kind:"null"},rr={kind:"number"},Sn={kind:"string"},an={kind:"boolean"},fn={kind:"color"},Di={kind:"object"},_n={kind:"value"},Oi={kind:"collator"},ta={kind:"formatted"},oi={kind:"resolvedImage"};function Ji(e,t){return{kind:"array",itemType:e,N:t}}function Vi(e){if("array"===e.kind){var t=Vi(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}return e.kind}var Ti=[Pn,rr,Sn,an,fn,ta,Di,Ji(_n),oi];function _a(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!_a(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var r=0,f=Ti;r<f.length;r+=1)if(!_a(f[r],t))return null}return"Expected "+Vi(e)+" but found "+Vi(t)+" instead."}function Ia(e,t){return t.some(function(r){return r.kind===e.kind})}function Gi(e,t){return t.some(function(r){return"null"===r?null===e:"array"===r?Array.isArray(e):"object"===r?e&&!Array.isArray(e)&&"object"==typeof e:r===typeof e})}var Bi=g(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function f(P){return(P=Math.round(P))<0?0:P>255?255:P}function d(P){return f("%"===P[P.length-1]?parseFloat(P)/100*255:parseInt(P))}function x(P){return(z="%"===P[P.length-1]?parseFloat(P)/100:parseFloat(P))<0?0:z>1?1:z;var z}function S(P,z,J){return J<0?J+=1:J>1&&(J-=1),6*J<1?P+(z-P)*J*6:2*J<1?z:3*J<2?P+(z-P)*(2/3-J)*6:P}try{t.parseCSSColor=function(P){var z,J=P.replace(/ /g,"").toLowerCase();if(J in r)return r[J].slice();if("#"===J[0])return 4===J.length?(z=parseInt(J.substr(1),16))>=0&&z<=4095?[(3840&z)>>4|(3840&z)>>8,240&z|(240&z)>>4,15&z|(15&z)<<4,1]:null:7===J.length&&(z=parseInt(J.substr(1),16))>=0&&z<=16777215?[(16711680&z)>>16,(65280&z)>>8,255&z,1]:null;var ee=J.indexOf("("),ue=J.indexOf(")");if(-1!==ee&&ue+1===J.length){var ye=J.substr(0,ee),Se=J.substr(ee+1,ue-(ee+1)).split(","),qe=1;switch(ye){case"rgba":if(4!==Se.length)return null;qe=x(Se.pop());case"rgb":return 3!==Se.length?null:[d(Se[0]),d(Se[1]),d(Se[2]),qe];case"hsla":if(4!==Se.length)return null;qe=x(Se.pop());case"hsl":if(3!==Se.length)return null;var Je=(parseFloat(Se[0])%360+360)%360/360,Tt=x(Se[1]),st=x(Se[2]),Nt=st<=.5?st*(Tt+1):st+Tt-st*Tt,Qt=2*st-Nt;return[f(255*S(Qt,Nt,Je+1/3)),f(255*S(Qt,Nt,Je)),f(255*S(Qt,Nt,Je-1/3)),qe];default:return null}}return null}}catch(P){}}).parseCSSColor,Xi=function(e,t,r,f){void 0===f&&(f=1),this.r=e,this.g=t,this.b=r,this.a=f};Xi.parse=function(e){if(e){if(e instanceof Xi)return e;if("string"==typeof e){var t=Bi(e);if(t)return new Xi(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Xi.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],f=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+f+")"},Xi.prototype.toArray=function(){var e=this.a;return 0===e?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Xi.black=new Xi(0,0,0,1),Xi.white=new Xi(1,1,1,1),Xi.transparent=new Xi(0,0,0,0),Xi.red=new Xi(1,0,0,1);var to=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};to.prototype.compare=function(e,t){return this.collator.compare(e,t)},to.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ho=function(e,t,r,f,d){this.text=e,this.image=t,this.scale=r,this.fontStack=f,this.textColor=d},Za=function(e){this.sections=e};Za.fromString=function(e){return new Za([new Ho(e,null,null,null,null)])},Za.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length})},Za.factory=function(e){return e instanceof Za?e:Za.fromString(e)},Za.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(e){return e.text}).join("")},Za.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var f=r[t];if(f.image)e.push(["image",f.image.name]);else{e.push(f.text);var d={};f.fontStack&&(d["text-font"]=["literal",f.fontStack.split(",")]),f.scale&&(d["font-scale"]=f.scale),f.textColor&&(d["text-color"]=["rgba"].concat(f.textColor.toArray())),e.push(d)}}return e};var Wi=function(e){this.name=e.name,this.available=e.available};function va(e,t,r,f){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===f||"number"==typeof f&&f>=0&&f<=1?null:"Invalid rgba value ["+[e,t,r,f].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof f?[e,t,r,f]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function wu(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Xi||e instanceof to||e instanceof Za||e instanceof Wi)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!wu(r[t]))return!1;return!0}if("object"==typeof e){for(var f in e)if(!wu(e[f]))return!1;return!0}return!1}function Da(e){if(null===e)return Pn;if("string"==typeof e)return Sn;if("boolean"==typeof e)return an;if("number"==typeof e)return rr;if(e instanceof Xi)return fn;if(e instanceof to)return Oi;if(e instanceof Za)return ta;if(e instanceof Wi)return oi;if(Array.isArray(e)){for(var t,r=e.length,f=0,d=e;f<d.length;f+=1){var x=Da(d[f]);if(t){if(t===x)continue;t=_n;break}t=x}return Ji(t||_n,r)}return Di}function qo(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Xi||e instanceof Za||e instanceof Wi?e.toString():JSON.stringify(e)}Wi.prototype.toString=function(){return this.name},Wi.fromString=function(e){return e?new Wi({name:e,available:!1}):null},Wi.prototype.serialize=function(){return["image",this.name]};var Fi=function(e,t){this.type=e,this.value=t};Fi.parse=function(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!wu(e[1]))return t.error("invalid value");var r=e[1],f=Da(r),d=t.expectedType;return"array"!==f.kind||0!==f.N||!d||"array"!==d.kind||"number"==typeof d.N&&0!==d.N||(f=d),new Fi(f,r)},Fi.prototype.evaluate=function(){return this.value},Fi.prototype.eachChild=function(){},Fi.prototype.outputDefined=function(){return!0},Fi.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Xi?["rgba"].concat(this.value.toArray()):this.value instanceof Za?this.value.serialize():this.value};var ra=function(e){this.name="ExpressionEvaluationError",this.message=e};ra.prototype.toJSON=function(){return this.message};var bo={string:Sn,number:rr,boolean:an,object:Di},ma=function(e,t){this.type=e,this.args=t};ma.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,f=1,d=e[0];if("array"===d){var x,S;if(e.length>2){var P=e[1];if("string"!=typeof P||!(P in bo)||"object"===P)return t.error('The item type argument of "array" must be one of string, number, boolean',1);x=bo[P],f++}else x=_n;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);S=e[2],f++}r=Ji(x,S)}else r=bo[d];for(var z=[];f<e.length;f++){var J=t.parse(e[f],f,_n);if(!J)return null;z.push(J)}return new ma(r,z)},ma.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!_a(this.type,Da(r)))return r;if(t===this.args.length-1)throw new ra("Expected value to be of type "+Vi(this.type)+", but found "+Vi(Da(r))+" instead.")}return null},ma.prototype.eachChild=function(e){this.args.forEach(e)},ma.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ma.prototype.serialize=function(){var e=this.type,t=[e.kind];if("array"===e.kind){var r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);var f=e.N;("number"==typeof f||this.args.length>1)&&t.push(f)}}return t.concat(this.args.map(function(d){return d.serialize()}))};var vo=function(e){this.type=ta,this.sections=e};vo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");for(var f=[],d=!1,x=1;x<=e.length-1;++x){var S=e[x];if(d&&"object"==typeof S&&!Array.isArray(S)){d=!1;var P=null;if(S["font-scale"]&&!(P=t.parse(S["font-scale"],1,rr)))return null;var z=null;if(S["text-font"]&&!(z=t.parse(S["text-font"],1,Ji(Sn))))return null;var J=null;if(S["text-color"]&&!(J=t.parse(S["text-color"],1,fn)))return null;var ee=f[f.length-1];ee.scale=P,ee.font=z,ee.textColor=J}else{var ue=t.parse(e[x],1,_n);if(!ue)return null;var ye=ue.type.kind;if("string"!==ye&&"value"!==ye&&"null"!==ye&&"resolvedImage"!==ye)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,f.push({content:ue,scale:null,font:null,textColor:null})}}return new vo(f)},vo.prototype.evaluate=function(e){return new Za(this.sections.map(function(t){var r=t.content.evaluate(e);return Da(r)===oi?new Ho("",r,null,null,null):new Ho(qo(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},vo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var f=r[t];e(f.content),f.scale&&e(f.scale),f.font&&e(f.font),f.textColor&&e(f.textColor)}},vo.prototype.outputDefined=function(){return!1},vo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var f=r[t];e.push(f.content.serialize());var d={};f.scale&&(d["font-scale"]=f.scale.serialize()),f.font&&(d["text-font"]=f.font.serialize()),f.textColor&&(d["text-color"]=f.textColor.serialize()),e.push(d)}return e};var No=function(e){this.type=oi,this.input=e};No.parse=function(e,t){if(2!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Sn);return r?new No(r):t.error("No image name provided.")},No.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Wi.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},No.prototype.eachChild=function(e){e(this.input)},No.prototype.outputDefined=function(){return!1},No.prototype.serialize=function(){return["image",this.input.serialize()]};var Ls={"to-boolean":an,"to-color":fn,"to-number":rr,"to-string":Sn},aa=function(e,t){this.type=e,this.args=t};aa.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");for(var f=Ls[r],d=[],x=1;x<e.length;x++){var S=t.parse(e[x],x,_n);if(!S)return null;d.push(S)}return new aa(f,d)},aa.prototype.evaluate=function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){for(var t,r,f=0,d=this.args;f<d.length;f+=1){if(r=null,(t=d[f].evaluate(e))instanceof Xi)return t;if("string"==typeof t){var x=e.parseColor(t);if(x)return x}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":va(t[0],t[1],t[2],t[3])))return new Xi(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ra(r||"Could not parse color from value '"+("string"==typeof t?t:String(JSON.stringify(t)))+"'")}if("number"===this.type.kind){for(var S=null,P=0,z=this.args;P<z.length;P+=1){if(null===(S=z[P].evaluate(e)))return 0;var J=Number(S);if(!isNaN(J))return J}throw new ra("Could not convert "+JSON.stringify(S)+" to number.")}return"formatted"===this.type.kind?Za.fromString(qo(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Wi.fromString(qo(this.args[0].evaluate(e))):qo(this.args[0].evaluate(e))},aa.prototype.eachChild=function(e){this.args.forEach(e)},aa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},aa.prototype.serialize=function(){if("formatted"===this.type.kind)return new vo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new No(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Jo=["Unknown","Point","LineString","Polygon"],Ma=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ma.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ma.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Jo[this.feature.type]:this.feature.type:null},Ma.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ma.prototype.canonicalID=function(){return this.canonical},Ma.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ma.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Xi.parse(e)),t};var Ka=function(e,t,r,f){this.name=e,this.type=t,this._evaluate=r,this.args=f};Ka.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Ka.prototype.eachChild=function(e){this.args.forEach(e)},Ka.prototype.outputDefined=function(){return!1},Ka.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Ka.parse=function(e,t){var r,f=e[0],d=Ka.definitions[f];if(!d)return t.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0);for(var x=Array.isArray(d)?d[0]:d.type,S=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,P=S.filter(function(fi){var Zn=fi[0];return!Array.isArray(Zn)||Zn.length===e.length-1}),z=null,J=0,ee=P;J<ee.length;J+=1){var ue=ee[J],ye=ue[0],Se=ue[1];z=new ks(t.registry,t.path,null,t.scope);for(var qe=[],Je=!1,Tt=1;Tt<e.length;Tt++){var st=e[Tt],Nt=Array.isArray(ye)?ye[Tt-1]:ye.type,Qt=z.parse(st,1+qe.length,Nt);if(!Qt){Je=!0;break}qe.push(Qt)}if(!Je)if(Array.isArray(ye)&&ye.length!==qe.length)z.error("Expected "+ye.length+" arguments, but found "+qe.length+" instead.");else{for(var gr=0;gr<qe.length;gr++){var xr=Array.isArray(ye)?ye[gr]:ye.type,Rr=qe[gr];z.concat(gr+1).checkSubtype(xr,Rr.type)}if(0===z.errors.length)return new Ka(f,x,Se,qe)}}if(1===P.length)(r=t.errors).push.apply(r,z.errors);else{for(var nn=(P.length?P:S).map(function(fi){var Zn;return Zn=fi[0],Array.isArray(Zn)?"("+Zn.map(Vi).join(", ")+")":"("+Vi(Zn.type)+"...)"}).join(" | "),gn=[],ii=1;ii<e.length;ii++){var Fn=t.parse(e[ii],1+gn.length);if(!Fn)return null;gn.push(Vi(Fn.type))}t.error("Expected arguments of type "+nn+", but found ("+gn.join(", ")+") instead.")}return null},Ka.register=function(e,t){for(var r in Ka.definitions=t,t)e[r]=Ka};var $o=function(e,t,r){this.type=Oi,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function Ba(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Ee(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function je(e,t){var r=(180+e[0])/360,f=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(r*d*8192),Math.round(f*d*8192)]}function bt(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function ar(e,t){for(var r,f,d,x,S,P,z,J=!1,ee=0,ue=t.length;ee<ue;ee++)for(var ye=t[ee],Se=0,qe=ye.length;Se<qe-1;Se++){if((x=(r=e)[0]-(f=ye[Se])[0])*(z=r[1]-(d=ye[Se+1])[1])-(P=r[0]-d[0])*(S=r[1]-f[1])==0&&x*P<=0&&S*z<=0)return!1;bt(e,ye[Se],ye[Se+1])&&(J=!J)}return J}function Kr(e,t){for(var r=0;r<t.length;r++)if(ar(e,t[r]))return!0;return!1}function $n(e,t,r,f){var d=f[0]-r[0],x=f[1]-r[1],S=(e[0]-r[0])*x-d*(e[1]-r[1]),P=(t[0]-r[0])*x-d*(t[1]-r[1]);return S>0&&P<0||S<0&&P>0}function xi(e,t,r){for(var f=0,d=r;f<d.length;f+=1)for(var x=d[f],S=0;S<x.length-1;++S)if((ue=[(ee=x[S+1])[0]-(J=x[S])[0],ee[1]-J[1]])[0]*(ye=[(z=t)[0]-(P=e)[0],z[1]-P[1]])[1]-ue[1]*ye[0]!=0&&$n(P,z,J,ee)&&$n(J,ee,P,z))return!0;var P,z,J,ee,ue,ye;return!1}function lo(e,t){for(var r=0;r<e.length;++r)if(!ar(e[r],t))return!1;for(var f=0;f<e.length-1;++f)if(xi(e[f],e[f+1],t))return!1;return!0}function ro(e,t){for(var r=0;r<t.length;r++)if(lo(e,t[r]))return!0;return!1}function co(e,t,r){for(var f=[],d=0;d<e.length;d++){for(var x=[],S=0;S<e[d].length;S++){var P=je(e[d][S],r);Ba(t,P),x.push(P)}f.push(x)}return f}function ps(e,t,r){for(var f=[],d=0;d<e.length;d++){var x=co(e[d],t,r);f.push(x)}return f}function du(e,t,r,f){if(e[0]<r[0]||e[0]>r[2]){var d=.5*f,x=e[0]-r[0]>d?-f:r[0]-e[0]>d?f:0;0===x&&(x=e[0]-r[2]>d?-f:r[2]-e[0]>d?f:0),e[0]+=x}Ba(t,e)}function Eu(e,t,r,f){for(var d=8192*Math.pow(2,f.z),x=[8192*f.x,8192*f.y],S=[],P=0,z=e;P<z.length;P+=1)for(var J=0,ee=z[P];J<ee.length;J+=1){var ue=ee[J],ye=[ue.x+x[0],ue.y+x[1]];du(ye,t,r,d),S.push(ye)}return S}function fl(e,t,r,f){for(var d,x=8192*Math.pow(2,f.z),S=[8192*f.x,8192*f.y],P=[],z=0,J=e;z<J.length;z+=1){for(var ee=[],ue=0,ye=J[z];ue<ye.length;ue+=1){var Se=ye[ue],qe=[Se.x+S[0],Se.y+S[1]];Ba(t,qe),ee.push(qe)}P.push(ee)}if(t[2]-t[0]<=x/2){(d=t)[0]=d[1]=1/0,d[2]=d[3]=-1/0;for(var Je=0,Tt=P;Je<Tt.length;Je+=1)for(var st=0,Nt=Tt[Je];st<Nt.length;st+=1)du(Nt[st],t,r,x)}return P}$o.parse=function(e,t){if(2!==e.length)return t.error("Expected one argument.");var r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");var f=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,an);if(!f)return null;var d=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,an);if(!d)return null;var x=null;return r.locale&&!(x=t.parse(r.locale,1,Sn))?null:new $o(f,d,x)},$o.prototype.evaluate=function(e){return new to(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},$o.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},$o.prototype.outputDefined=function(){return!1},$o.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Wo=function(e,t){this.type=an,this.geojson=e,this.geometries=t};function Qo(e){if(e instanceof Ka&&("get"===e.name&&1===e.args.length||"feature-state"===e.name||"has"===e.name&&1===e.args.length||"properties"===e.name||"geometry-type"===e.name||"id"===e.name||/^filter-/.test(e.name))||e instanceof Wo)return!1;var t=!0;return e.eachChild(function(r){t&&!Qo(r)&&(t=!1)}),t}function Lo(e){if(e instanceof Ka&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild(function(r){t&&!Lo(r)&&(t=!1)}),t}function es(e,t){if(e instanceof Ka&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(f){r&&!es(f,t)&&(r=!1)}),r}Wo.parse=function(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(wu(e[1])){var r=e[1];if("FeatureCollection"===r.type)for(var f=0;f<r.features.length;++f){var d=r.features[f].geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new Wo(r,r.features[f].geometry)}else if("Feature"===r.type){var x=r.geometry.type;if("Polygon"===x||"MultiPolygon"===x)return new Wo(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Wo(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Wo.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(t,r){var f=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],x=t.canonicalID();if("Polygon"===r.type){var S=co(r.coordinates,d,x),P=Eu(t.geometry(),f,d,x);if(!Ee(f,d))return!1;for(var z=0,J=P;z<J.length;z+=1)if(!ar(J[z],S))return!1}if("MultiPolygon"===r.type){var ee=ps(r.coordinates,d,x),ue=Eu(t.geometry(),f,d,x);if(!Ee(f,d))return!1;for(var ye=0,Se=ue;ye<Se.length;ye+=1)if(!Kr(Se[ye],ee))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(t,r){var f=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],x=t.canonicalID();if("Polygon"===r.type){var S=co(r.coordinates,d,x),P=fl(t.geometry(),f,d,x);if(!Ee(f,d))return!1;for(var z=0,J=P;z<J.length;z+=1)if(!lo(J[z],S))return!1}if("MultiPolygon"===r.type){var ee=ps(r.coordinates,d,x),ue=fl(t.geometry(),f,d,x);if(!Ee(f,d))return!1;for(var ye=0,Se=ue;ye<Se.length;ye+=1)if(!ro(Se[ye],ee))return!1}return!0}(e,this.geometries)}return!1},Wo.prototype.eachChild=function(){},Wo.prototype.outputDefined=function(){return!0},Wo.prototype.serialize=function(){return["within",this.geojson]};var ts=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};ts.parse=function(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new ts(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},ts.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},ts.prototype.eachChild=function(){},ts.prototype.outputDefined=function(){return!1},ts.prototype.serialize=function(){return["var",this.name]};var ks=function(e,t,r,f,d){void 0===t&&(t=[]),void 0===f&&(f=new Rn),void 0===d&&(d=[]),this.registry=e,this.path=t,this.key=t.map(function(x){return"["+x+"]"}).join(""),this.scope=f,this.errors=d,this.expectedType=r};function Qs(e,t){for(var r,f=e.length-1,d=0,x=f,S=0;d<=x;)if((r=e[S=Math.floor((d+x)/2)])<=t){if(S===f||t<e[S+1])return S;d=S+1}else{if(!(r>t))throw new ra("Input is not a number.");x=S-1}return 0}ks.prototype.parse=function(e,t,r,f,d){return void 0===d&&(d={}),t?this.concat(t,r,f)._parse(e,d):this._parse(e,d)},ks.prototype._parse=function(e,t){function r(J,ee,ue){return"assert"===ue?new ma(ee,[J]):"coerce"===ue?new aa(ee,[J]):J}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var f=e[0];if("string"!=typeof f)return this.error("Expression name must be a string, but found "+typeof f+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var d=this.registry[f];if(d){var x=d.parse(e,this);if(!x)return null;if(this.expectedType){var S=this.expectedType,P=x.type;if("string"!==S.kind&&"number"!==S.kind&&"boolean"!==S.kind&&"object"!==S.kind&&"array"!==S.kind||"value"!==P.kind)if("color"!==S.kind&&"formatted"!==S.kind&&"resolvedImage"!==S.kind||"value"!==P.kind&&"string"!==P.kind){if(this.checkSubtype(S,P))return null}else x=r(x,S,t.typeAnnotation||"coerce");else x=r(x,S,t.typeAnnotation||"assert")}if(!(x instanceof Fi)&&"resolvedImage"!==x.type.kind&&function J(ee){if(ee instanceof ts)return J(ee.boundExpression);if(ee instanceof Ka&&"error"===ee.name||ee instanceof $o||ee instanceof Wo)return!1;var ue=ee instanceof aa||ee instanceof ma,ye=!0;return ee.eachChild(function(Se){ye=ue?ye&&J(Se):ye&&Se instanceof Fi}),!!ye&&Qo(ee)&&es(ee,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(x)){var z=new Ma;try{x=new Fi(x.type,x.evaluate(z))}catch(J){return this.error(J.message),null}}return x}return this.error('Unknown expression "'+f+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},ks.prototype.concat=function(e,t,r){var f="number"==typeof e?this.path.concat(e):this.path,d=r?this.scope.concat(r):this.scope;return new ks(this.registry,f,t||null,d,this.errors)},ks.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var f=""+this.key+t.map(function(d){return"["+d+"]"}).join("");this.errors.push(new Fr(f,e))},ks.prototype.checkSubtype=function(e,t){var r=_a(e,t);return r&&this.error(r),r};var gs=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var f=0,d=r;f<d.length;f+=1){var x=d[f],S=x[1];this.labels.push(x[0]),this.outputs.push(S)}};function Oa(e,t,r){return e*(1-r)+t*r}gs.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,rr);if(!r)return null;var f=[],d=null;t.expectedType&&"value"!==t.expectedType.kind&&(d=t.expectedType);for(var x=1;x<e.length;x+=2){var S=1===x?-1/0:e[x],P=e[x+1],z=x,J=x+1;if("number"!=typeof S)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(f.length&&f[f.length-1][0]>=S)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);var ee=t.parse(P,J,d);if(!ee)return null;d=d||ee.type,f.push([S,ee])}return new gs(d,r,f)},gs.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var f=this.input.evaluate(e);if(f<=t[0])return r[0].evaluate(e);var d=t.length;return f>=t[d-1]?r[d-1].evaluate(e):r[Qs(t,f)].evaluate(e)},gs.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},gs.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},gs.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var ko=Object.freeze({__proto__:null,number:Oa,color:function(e,t,r){return new Xi(Oa(e.r,t.r,r),Oa(e.g,t.g,r),Oa(e.b,t.b,r),Oa(e.a,t.a,r))},array:function(e,t,r){return e.map(function(f,d){return Oa(f,t[d],r)})}}),Ol=6/29*3*(6/29),Ll=Math.PI/180,kl=180/Math.PI;function wc(e){return e>.008856451679035631?Math.pow(e,1/3):e/Ol+4/29}function Rl(e){return e>6/29?e*e*e:Ol*(e-4/29)}function hl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function eu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Dl(e){var t=eu(e.r),r=eu(e.g),f=eu(e.b),d=wc((.4124564*t+.3575761*r+.1804375*f)/.95047),x=wc((.2126729*t+.7151522*r+.072175*f)/1);return{l:116*x-16,a:500*(d-x),b:200*(x-wc((.0193339*t+.119192*r+.9503041*f)/1.08883)),alpha:e.a}}function m(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,f=isNaN(e.b)?t:t-e.b/200;return t=1*Rl(t),r=.95047*Rl(r),f=1.08883*Rl(f),new Xi(hl(3.2404542*r-1.5371385*t-.4985314*f),hl(-.969266*r+1.8760108*t+.041556*f),hl(.0556434*r-.2040259*t+1.0572252*f),e.alpha)}function T(e,t,r){var f=t-e;return e+r*(f>180||f<-180?f-360*Math.round(f/360):f)}var Y={forward:Dl,reverse:m,interpolate:function(e,t,r){return{l:Oa(e.l,t.l,r),a:Oa(e.a,t.a,r),b:Oa(e.b,t.b,r),alpha:Oa(e.alpha,t.alpha,r)}}},D={forward:function(e){var t=Dl(e),r=t.l,f=t.a,d=t.b,x=Math.atan2(d,f)*kl;return{h:x<0?x+360:x,c:Math.sqrt(f*f+d*d),l:r,alpha:e.a}},reverse:function(e){var t=e.h*Ll,r=e.c;return m({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:T(e.h,t.h,r),c:Oa(e.c,t.c,r),l:Oa(e.l,t.l,r),alpha:Oa(e.alpha,t.alpha,r)}}},ve=Object.freeze({__proto__:null,lab:Y,hcl:D}),Ne=function(e,t,r,f,d){this.type=e,this.operator=t,this.interpolation=r,this.input=f,this.labels=[],this.outputs=[];for(var x=0,S=d;x<S.length;x+=1){var P=S[x],z=P[1];this.labels.push(P[0]),this.outputs.push(z)}};function mt(e,t,r,f){var d=f-r,x=e-r;return 0===d?0:1===t?x/d:(Math.pow(t,x)-1)/(Math.pow(t,d)-1)}Ne.interpolationFactor=function(e,t,r,f){var d=0;if("exponential"===e.name)d=mt(t,e.base,r,f);else if("linear"===e.name)d=mt(t,1,r,f);else if("cubic-bezier"===e.name){var x=e.controlPoints;d=new O(x[0],x[1],x[2],x[3]).solve(mt(t,1,r,f))}return d},Ne.parse=function(e,t){var r=e[0],f=e[1],d=e[2],x=e.slice(3);if(!Array.isArray(f)||0===f.length)return t.error("Expected an interpolation type expression.",1);if("linear"===f[0])f={name:"linear"};else if("exponential"===f[0]){var S=f[1];if("number"!=typeof S)return t.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:S}}else{if("cubic-bezier"!==f[0])return t.error("Unknown interpolation type "+String(f[0]),1,0);var P=f.slice(1);if(4!==P.length||P.some(function(Tt){return"number"!=typeof Tt||Tt<0||Tt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:P}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(d=t.parse(d,2,rr)))return null;var z=[],J=null;"interpolate-hcl"===r||"interpolate-lab"===r?J=fn:t.expectedType&&"value"!==t.expectedType.kind&&(J=t.expectedType);for(var ee=0;ee<x.length;ee+=2){var ue=x[ee],ye=x[ee+1],Se=ee+3,qe=ee+4;if("number"!=typeof ue)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Se);if(z.length&&z[z.length-1][0]>=ue)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Se);var Je=t.parse(ye,qe,J);if(!Je)return null;J=J||Je.type,z.push([ue,Je])}return"number"===J.kind||"color"===J.kind||"array"===J.kind&&"number"===J.itemType.kind&&"number"==typeof J.N?new Ne(J,r,f,d,z):t.error("Type "+Vi(J)+" is not interpolatable.")},Ne.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var f=this.input.evaluate(e);if(f<=t[0])return r[0].evaluate(e);var d=t.length;if(f>=t[d-1])return r[d-1].evaluate(e);var x=Qs(t,f),S=Ne.interpolationFactor(this.interpolation,f,t[x],t[x+1]),P=r[x].evaluate(e),z=r[x+1].evaluate(e);return"interpolate"===this.operator?ko[this.type.kind.toLowerCase()](P,z,S):"interpolate-hcl"===this.operator?D.reverse(D.interpolate(D.forward(P),D.forward(z),S)):Y.reverse(Y.interpolate(Y.forward(P),Y.forward(z),S))},Ne.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Ne.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Ne.prototype.serialize=function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var zt=function(e,t){this.type=e,this.args=t};zt.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,f=t.expectedType;f&&"value"!==f.kind&&(r=f);for(var d=[],x=0,S=e.slice(1);x<S.length;x+=1){var P=t.parse(S[x],1+d.length,r,void 0,{typeAnnotation:"omit"});if(!P)return null;r=r||P.type,d.push(P)}var z=f&&d.some(function(J){return _a(f,J.type)});return new zt(z?_n:r,d)},zt.prototype.evaluate=function(e){for(var t,r=null,f=0,d=0,x=this.args;d<x.length&&(f++,(r=x[d].evaluate(e))&&r instanceof Wi&&!r.available&&(t||(t=r.name),r=null,f===this.args.length&&(r=t)),null===r);d+=1);return r},zt.prototype.eachChild=function(e){this.args.forEach(e)},zt.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},zt.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ft=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Ft.prototype.evaluate=function(e){return this.result.evaluate(e)},Ft.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},Ft.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],f=1;f<e.length-1;f+=2){var d=e[f];if("string"!=typeof d)return t.error("Expected string, but found "+typeof d+" instead.",f);if(/[^a-zA-Z0-9_]/.test(d))return t.error("Variable names must contain only alphanumeric characters or '_'.",f);var x=t.parse(e[f+1],f+1);if(!x)return null;r.push([d,x])}var S=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return S?new Ft(r,S):null},Ft.prototype.outputDefined=function(){return this.result.outputDefined()},Ft.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var f=r[t];e.push(f[0],f[1].serialize())}return e.push(this.result.serialize()),e};var Or=function(e,t,r){this.type=e,this.index=t,this.input=r};Or.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,rr),f=t.parse(e[2],2,Ji(t.expectedType||_n));return r&&f?new Or(f.type.itemType,r,f):null},Or.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new ra("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new ra("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new ra("Array index must be an integer, but found "+t+" instead.");return r[t]},Or.prototype.eachChild=function(e){e(this.index),e(this.input)},Or.prototype.outputDefined=function(){return!1},Or.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var zr=function(e,t){this.type=an,this.needle=e,this.haystack=t};zr.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,_n),f=t.parse(e[2],2,_n);return r&&f?Ia(r.type,[an,Sn,rr,Pn,_n])?new zr(r,f):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Vi(r.type)+" instead"):null},zr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Gi(t,["boolean","string","number","null"]))throw new ra("Expected first argument to be of type boolean, string, number or null, but found "+Vi(Da(t))+" instead.");if(!Gi(r,["string","array"]))throw new ra("Expected second argument to be of type array or string, but found "+Vi(Da(r))+" instead.");return r.indexOf(t)>=0},zr.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},zr.prototype.outputDefined=function(){return!0},zr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Jn=function(e,t,r){this.type=rr,this.needle=e,this.haystack=t,this.fromIndex=r};Jn.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,_n),f=t.parse(e[2],2,_n);if(!r||!f)return null;if(!Ia(r.type,[an,Sn,rr,Pn,_n]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Vi(r.type)+" instead");if(4===e.length){var d=t.parse(e[3],3,rr);return d?new Jn(r,f,d):null}return new Jn(r,f)},Jn.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Gi(t,["boolean","string","number","null"]))throw new ra("Expected first argument to be of type boolean, string, number or null, but found "+Vi(Da(t))+" instead.");if(!Gi(r,["string","array"]))throw new ra("Expected second argument to be of type array or string, but found "+Vi(Da(r))+" instead.");if(this.fromIndex){var f=this.fromIndex.evaluate(e);return r.indexOf(t,f)}return r.indexOf(t)},Jn.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Jn.prototype.outputDefined=function(){return!1},Jn.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var bi=function(e,t,r,f,d,x){this.inputType=e,this.type=t,this.input=r,this.cases=f,this.outputs=d,this.otherwise=x};bi.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,f;t.expectedType&&"value"!==t.expectedType.kind&&(f=t.expectedType);for(var d={},x=[],S=2;S<e.length-1;S+=2){var P=e[S],z=e[S+1];Array.isArray(P)||(P=[P]);var J=t.concat(S);if(0===P.length)return J.error("Expected at least one branch label.");for(var ee=0,ue=P;ee<ue.length;ee+=1){var ye=ue[ee];if("number"!=typeof ye&&"string"!=typeof ye)return J.error("Branch labels must be numbers or strings.");if("number"==typeof ye&&Math.abs(ye)>Number.MAX_SAFE_INTEGER)return J.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof ye&&Math.floor(ye)!==ye)return J.error("Numeric branch labels must be integer values.");if(r){if(J.checkSubtype(r,Da(ye)))return null}else r=Da(ye);if(void 0!==d[String(ye)])return J.error("Branch labels must be unique.");d[String(ye)]=x.length}var Se=t.parse(z,S,f);if(!Se)return null;f=f||Se.type,x.push(Se)}var qe=t.parse(e[1],1,_n);if(!qe)return null;var Je=t.parse(e[e.length-1],e.length-1,f);return Je?"value"!==qe.type.kind&&t.concat(1).checkSubtype(r,qe.type)?null:new bi(r,f,qe,d,x,Je):null},bi.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Da(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},bi.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},bi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},bi.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],f={},d=0,x=Object.keys(this.cases).sort();d<x.length;d+=1){var S=x[d];void 0===(ue=f[this.cases[S]])?(f[this.cases[S]]=r.length,r.push([this.cases[S],[S]])):r[ue][1].push(S)}for(var P=function(Se){return"number"===e.inputType.kind?Number(Se):Se},z=0,J=r;z<J.length;z+=1){var ee=J[z],ue=ee[0],ye=ee[1];t.push(1===ye.length?P(ye[0]):ye.map(P)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var pi=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};pi.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var f=[],d=1;d<e.length-1;d+=2){var x=t.parse(e[d],d,an);if(!x)return null;var S=t.parse(e[d+1],d+1,r);if(!S)return null;f.push([x,S]),r=r||S.type}var P=t.parse(e[e.length-1],e.length-1,r);return P?new pi(r,f,P):null},pi.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var f=r[t],d=f[1];if(f[0].evaluate(e))return d.evaluate(e)}return this.otherwise.evaluate(e)},pi.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var f=r[t],d=f[1];e(f[0]),e(d)}e(this.otherwise)},pi.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},pi.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var oa=function(e,t,r,f){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=f};function Ea(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Na(e,t,r,f){return 0===f.compare(t,r)}function vi(e,t,r){var f="=="!==e&&"!="!==e;return function(){function d(x,S,P){this.type=an,this.lhs=x,this.rhs=S,this.collator=P,this.hasUntypedArgument="value"===x.type.kind||"value"===S.type.kind}return d.parse=function(x,S){if(3!==x.length&&4!==x.length)return S.error("Expected two or three arguments.");var P=x[0],z=S.parse(x[1],1,_n);if(!z)return null;if(!Ea(P,z.type))return S.concat(1).error('"'+P+"\" comparisons are not supported for type '"+Vi(z.type)+"'.");var J=S.parse(x[2],2,_n);if(!J)return null;if(!Ea(P,J.type))return S.concat(2).error('"'+P+"\" comparisons are not supported for type '"+Vi(J.type)+"'.");if(z.type.kind!==J.type.kind&&"value"!==z.type.kind&&"value"!==J.type.kind)return S.error("Cannot compare types '"+Vi(z.type)+"' and '"+Vi(J.type)+"'.");f&&("value"===z.type.kind&&"value"!==J.type.kind?z=new ma(J.type,[z]):"value"!==z.type.kind&&"value"===J.type.kind&&(J=new ma(z.type,[J])));var ee=null;if(4===x.length){if("string"!==z.type.kind&&"string"!==J.type.kind&&"value"!==z.type.kind&&"value"!==J.type.kind)return S.error("Cannot use collator to compare non-string types.");if(!(ee=S.parse(x[3],3,Oi)))return null}return new d(z,J,ee)},d.prototype.evaluate=function(x){var S=this.lhs.evaluate(x),P=this.rhs.evaluate(x);if(f&&this.hasUntypedArgument){var z=Da(S),J=Da(P);if(z.kind!==J.kind||"string"!==z.kind&&"number"!==z.kind)throw new ra('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+z.kind+", "+J.kind+") instead.")}if(this.collator&&!f&&this.hasUntypedArgument){var ee=Da(S),ue=Da(P);if("string"!==ee.kind||"string"!==ue.kind)return t(x,S,P)}return this.collator?r(x,S,P,this.collator.evaluate(x)):t(x,S,P)},d.prototype.eachChild=function(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)},d.prototype.outputDefined=function(){return!0},d.prototype.serialize=function(){var x=[e];return this.eachChild(function(S){x.push(S.serialize())}),x},d}()}oa.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,_n),f=t.parse(e[2],2,rr);if(!r||!f)return null;if(!Ia(r.type,[Ji(_n),Sn,_n]))return t.error("Expected first argument to be of type array or string, but found "+Vi(r.type)+" instead");if(4===e.length){var d=t.parse(e[3],3,rr);return d?new oa(r.type,r,f,d):null}return new oa(r.type,r,f)},oa.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Gi(t,["string","array"]))throw new ra("Expected first argument to be of type array or string, but found "+Vi(Da(t))+" instead.");if(this.endIndex){var f=this.endIndex.evaluate(e);return t.slice(r,f)}return t.slice(r)},oa.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},oa.prototype.outputDefined=function(){return!1},oa.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Xo=vi("==",function(e,t,r){return t===r},Na),vu=vi("!=",function(e,t,r){return t!==r},function(e,t,r,f){return!Na(0,t,r,f)}),Tu=vi("<",function(e,t,r){return t<r},function(e,t,r,f){return f.compare(t,r)<0}),Ec=vi(">",function(e,t,r){return t>r},function(e,t,r,f){return f.compare(t,r)>0}),Du=vi("<=",function(e,t,r){return t<=r},function(e,t,r,f){return f.compare(t,r)<=0}),Bl=vi(">=",function(e,t,r){return t>=r},function(e,t,r,f){return f.compare(t,r)>=0}),mu=function(e,t,r,f,d){this.type=Sn,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=f,this.maxFractionDigits=d};mu.parse=function(e,t){if(3!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,rr);if(!r)return null;var f=e[2];if("object"!=typeof f||Array.isArray(f))return t.error("NumberFormat options argument must be an object.");var d=null;if(f.locale&&!(d=t.parse(f.locale,1,Sn)))return null;var x=null;if(f.currency&&!(x=t.parse(f.currency,1,Sn)))return null;var S=null;if(f["min-fraction-digits"]&&!(S=t.parse(f["min-fraction-digits"],1,rr)))return null;var P=null;return f["max-fraction-digits"]&&!(P=t.parse(f["max-fraction-digits"],1,rr))?null:new mu(r,d,x,S,P)},mu.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},mu.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},mu.prototype.outputDefined=function(){return!1},mu.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var gu=function(e){this.type=rr,this.input=e};gu.parse=function(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error("Expected argument of type string or array, but found "+Vi(r.type)+" instead."):new gu(r):null},gu.prototype.evaluate=function(e){var t=this.input.evaluate(e);if("string"==typeof t||Array.isArray(t))return t.length;throw new ra("Expected value to be of type string or array, but found "+Vi(Da(t))+" instead.")},gu.prototype.eachChild=function(e){e(this.input)},gu.prototype.outputDefined=function(){return!1},gu.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var tu={"==":Xo,"!=":vu,">":Ec,"<":Tu,">=":Bl,"<=":Du,array:ma,at:Or,boolean:ma,case:pi,coalesce:zt,collator:$o,format:vo,image:No,in:zr,"index-of":Jn,interpolate:Ne,"interpolate-hcl":Ne,"interpolate-lab":Ne,length:gu,let:Ft,literal:Fi,match:bi,number:ma,"number-format":mu,object:ma,slice:oa,step:gs,string:ma,"to-boolean":aa,"to-color":aa,"to-number":aa,"to-string":aa,var:ts,within:Wo};function oo(e,t){var r=t[0],f=t[1],d=t[2],x=t[3];r=r.evaluate(e),f=f.evaluate(e),d=d.evaluate(e);var S=x?x.evaluate(e):1,P=va(r,f,d,S);if(P)throw new ra(P);return new Xi(r/255*S,f/255*S,d/255*S,S)}function Tc(e,t){return e in t}function Cc(e,t){var r=t[e];return void 0===r?null:r}function rs(e){return{type:e}}function tc(e){return{result:"success",value:e}}function ru(e){return{result:"error",value:e}}function Rs(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function rc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Bu(e){return!!e.expression&&e.expression.interpolated}function La(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Ju(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Gc(e){return e}function Us(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function nc(e,t,r,f,d){return Us(typeof r===d?f[r]:void 0,e.default,t.default)}function Hc(e,t,r){if("number"!==La(r))return Us(e.default,t.default);var f=e.stops.length;if(1===f||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var d=Qs(e.stops.map(function(x){return x[0]}),r);return e.stops[d][1]}function Ac(e,t,r){var f=void 0!==e.base?e.base:1;if("number"!==La(r))return Us(e.default,t.default);var d=e.stops.length;if(1===d||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[d-1][0])return e.stops[d-1][1];var ye,Se,Je,Tt,x=Qs(e.stops.map(function(ue){return ue[0]}),r),S=(ye=f,Tt=r-(Se=e.stops[x][0]),0==(Je=e.stops[x+1][0]-Se)?0:1===ye?Tt/Je:(Math.pow(ye,Tt)-1)/(Math.pow(ye,Je)-1)),P=e.stops[x][1],z=e.stops[x+1][1],J=ko[t.type]||Gc;if(e.colorSpace&&"rgb"!==e.colorSpace){var ee=ve[e.colorSpace];J=function(ue,ye){return ee.reverse(ee.interpolate(ee.forward(ue),ee.forward(ye),S))}}return"function"==typeof P.evaluate?{evaluate:function(){for(var ue=[],ye=arguments.length;ye--;)ue[ye]=arguments[ye];var Se=P.evaluate.apply(void 0,ue),qe=z.evaluate.apply(void 0,ue);if(void 0!==Se&&void 0!==qe)return J(Se,qe,S)}}:J(P,z,S)}function Fl(e,t,r){return"color"===t.type?r=Xi.parse(r):"formatted"===t.type?r=Za.fromString(r.toString()):"resolvedImage"===t.type?r=Wi.fromString(r.toString()):La(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),Us(r,e.default,t.default)}Ka.register(tu,{error:[{kind:"error"},[Sn],function(e,t){throw new ra(t[0].evaluate(e))}],typeof:[Sn,[_n],function(e,t){return Vi(Da(t[0].evaluate(e)))}],"to-rgba":[Ji(rr,4),[fn],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[fn,[rr,rr,rr],oo],rgba:[fn,[rr,rr,rr,rr],oo],has:{type:an,overloads:[[[Sn],function(e,t){return Tc(t[0].evaluate(e),e.properties())}],[[Sn,Di],function(e,t){var r=t[1];return Tc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:_n,overloads:[[[Sn],function(e,t){return Cc(t[0].evaluate(e),e.properties())}],[[Sn,Di],function(e,t){var r=t[1];return Cc(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[_n,[Sn],function(e,t){return Cc(t[0].evaluate(e),e.featureState||{})}],properties:[Di,[],function(e){return e.properties()}],"geometry-type":[Sn,[],function(e){return e.geometryType()}],id:[_n,[],function(e){return e.id()}],zoom:[rr,[],function(e){return e.globals.zoom}],"heatmap-density":[rr,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[rr,[],function(e){return e.globals.lineProgress||0}],accumulated:[_n,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[rr,rs(rr),function(e,t){for(var r=0,f=0,d=t;f<d.length;f+=1)r+=d[f].evaluate(e);return r}],"*":[rr,rs(rr),function(e,t){for(var r=1,f=0,d=t;f<d.length;f+=1)r*=d[f].evaluate(e);return r}],"-":{type:rr,overloads:[[[rr,rr],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[rr],function(e,t){return-t[0].evaluate(e)}]]},"/":[rr,[rr,rr],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[rr,[rr,rr],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[rr,[],function(){return Math.LN2}],pi:[rr,[],function(){return Math.PI}],e:[rr,[],function(){return Math.E}],"^":[rr,[rr,rr],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[rr,[rr],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[rr,[rr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[rr,[rr],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[rr,[rr],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[rr,[rr],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[rr,[rr],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[rr,[rr],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[rr,[rr],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[rr,[rr],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[rr,[rr],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[rr,rs(rr),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[rr,rs(rr),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[rr,[rr],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[rr,[rr],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[rr,[rr],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[rr,[rr],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1];return e.properties()[r.value]===f.value}],"filter-id-==":[an,[_n],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[an,[Sn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1],d=e.properties()[r.value],x=f.value;return typeof d==typeof x&&d<x}],"filter-id-<":[an,[_n],function(e,t){var r=t[0],f=e.id(),d=r.value;return typeof f==typeof d&&f<d}],"filter->":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1],d=e.properties()[r.value],x=f.value;return typeof d==typeof x&&d>x}],"filter-id->":[an,[_n],function(e,t){var r=t[0],f=e.id(),d=r.value;return typeof f==typeof d&&f>d}],"filter-<=":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1],d=e.properties()[r.value],x=f.value;return typeof d==typeof x&&d<=x}],"filter-id-<=":[an,[_n],function(e,t){var r=t[0],f=e.id(),d=r.value;return typeof f==typeof d&&f<=d}],"filter->=":[an,[Sn,_n],function(e,t){var r=t[0],f=t[1],d=e.properties()[r.value],x=f.value;return typeof d==typeof x&&d>=x}],"filter-id->=":[an,[_n],function(e,t){var r=t[0],f=e.id(),d=r.value;return typeof f==typeof d&&f>=d}],"filter-has":[an,[_n],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[an,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[an,[Ji(Sn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[an,[Ji(_n)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[an,[Sn,Ji(_n)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[an,[Sn,Ji(_n)],function(e,t){var r=t[0],f=t[1];return function(d,x,S,P){for(;S<=P;){var z=S+P>>1;if(x[z]===d)return!0;x[z]>d?P=z-1:S=z+1}return!1}(e.properties()[r.value],f.value,0,f.value.length-1)}],all:{type:an,overloads:[[[an,an],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[rs(an),function(e,t){for(var r=0,f=t;r<f.length;r+=1)if(!f[r].evaluate(e))return!1;return!0}]]},any:{type:an,overloads:[[[an,an],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[rs(an),function(e,t){for(var r=0,f=t;r<f.length;r+=1)if(f[r].evaluate(e))return!0;return!1}]]},"!":[an,[an],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[an,[Sn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Sn,[Sn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Sn,[Sn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Sn,rs(_n),function(e,t){return t.map(function(r){return qo(r.evaluate(e))}).join("")}],"resolved-locale":[Sn,[Oi],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var yu=function(e,t){var r;this.expression=e,this._warningHistory={},this._evaluator=new Ma,this._defaultValue=t?"color"===(r=t).type&&Ju(r.default)?new Xi(0,0,0,0):"color"===r.type?Xi.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=t&&"enum"===t.type?t.values:null};function $u(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in tu}function pl(e,t){var d,x,r=new ks(tu,[],t?(x={color:fn,string:Sn,number:rr,enum:Sn,boolean:an,formatted:ta,resolvedImage:oi},"array"===(d=t).type?Ji(x[d.value]||_n,d.length):x[d.type]):void 0),f=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return f?tc(new yu(f,t)):ru(r.errors)}yu.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,d,x){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=f,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=x,this.expression.evaluate(this._evaluator)},yu.prototype.evaluate=function(e,t,r,f,d,x){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=f,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=x||null;try{var S=this.expression.evaluate(this._evaluator);if(null==S||"number"==typeof S&&S!=S)return this._defaultValue;if(this._enumValues&&!(S in this._enumValues))throw new ra("Expected value to be one of "+Object.keys(this._enumValues).map(function(P){return JSON.stringify(P)}).join(", ")+", but found "+JSON.stringify(S)+" instead.");return S}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,"undefined"!=typeof console&&console.warn(P.message)),this._defaultValue}};var Qu=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!Lo(t.expression)};Qu.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,d,x){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,f,d,x)},Qu.prototype.evaluate=function(e,t,r,f,d,x){return this._styleExpression.evaluate(e,t,r,f,d,x)};var el=function(e,t,r,f){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!Lo(t.expression),this.interpolationType=f};function dl(e,t){if("error"===(e=pl(e,t)).result)return e;var r=e.value.expression,f=Qo(r);if(!f&&!Rs(t))return ru([new Fr("","data expressions not supported")]);var d=es(r,["zoom"]);if(!d&&!rc(t))return ru([new Fr("","zoom expressions not supported")]);var x=function S(P){var z=null;if(P instanceof Ft)z=S(P.result);else if(P instanceof zt)for(var J=0,ee=P.args;J<ee.length&&!(z=S(ee[J]));J+=1);else(P instanceof gs||P instanceof Ne)&&P.input instanceof Ka&&"zoom"===P.input.name&&(z=P);return z instanceof Fr||P.eachChild(function(ue){var ye=S(ue);ye instanceof Fr?z=ye:!z&&ye?z=new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):z&&ye&&z!==ye&&(z=new Fr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),z}(r);return x||d?x instanceof Fr?ru([x]):x instanceof Ne&&!Bu(t)?ru([new Fr("",'"interpolate" expressions cannot be used with this property')]):tc(x?new el(f?"camera":"composite",e.value,x.labels,x instanceof Ne?x.interpolation:void 0):new Qu(f?"constant":"source",e.value)):ru([new Fr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}el.prototype.evaluateWithoutErrorHandling=function(e,t,r,f,d,x){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,f,d,x)},el.prototype.evaluate=function(e,t,r,f,d,x){return this._styleExpression.evaluate(e,t,r,f,d,x)},el.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?Ne.interpolationFactor(this.interpolationType,e,t,r):0};var Fu=function(e,t){this._parameters=e,this._specification=t,Sr(this,function r(f,d){var x,S,P,z="color"===d.type,J=f.stops&&"object"==typeof f.stops[0][0],ee=J||!(J||void 0!==f.property),ue=f.type||(Bu(d)?"exponential":"interval");if(z&&((f=Sr({},f)).stops&&(f.stops=f.stops.map(function(Fn){return[Fn[0],Xi.parse(Fn[1])]})),f.default=Xi.parse(f.default?f.default:d.default)),f.colorSpace&&"rgb"!==f.colorSpace&&!ve[f.colorSpace])throw new Error("Unknown color space: "+f.colorSpace);if("exponential"===ue)x=Ac;else if("interval"===ue)x=Hc;else if("categorical"===ue){x=nc,S=Object.create(null);for(var ye=0,Se=f.stops;ye<Se.length;ye+=1){var qe=Se[ye];S[qe[0]]=qe[1]}P=typeof f.stops[0][0]}else{if("identity"!==ue)throw new Error('Unknown function type "'+ue+'"');x=Fl}if(J){for(var Je={},Tt=[],st=0;st<f.stops.length;st++){var Nt=f.stops[st],Qt=Nt[0].zoom;void 0===Je[Qt]&&(Je[Qt]={zoom:Qt,type:f.type,property:f.property,default:f.default,stops:[]},Tt.push(Qt)),Je[Qt].stops.push([Nt[0].value,Nt[1]])}for(var gr=[],xr=0,Rr=Tt;xr<Rr.length;xr+=1){var nn=Rr[xr];gr.push([Je[nn].zoom,r(Je[nn],d)])}var gn={name:"linear"};return{kind:"composite",interpolationType:gn,interpolationFactor:Ne.interpolationFactor.bind(void 0,gn),zoomStops:gr.map(function(Fn){return Fn[0]}),evaluate:function(Fn,fi){var Zn=Fn.zoom;return Ac({stops:gr,base:f.base},d,Zn).evaluate(Zn,fi)}}}if(ee){var ii="exponential"===ue?{name:"exponential",base:void 0!==f.base?f.base:1}:null;return{kind:"camera",interpolationType:ii,interpolationFactor:Ne.interpolationFactor.bind(void 0,ii),zoomStops:f.stops.map(function(Fn){return Fn[0]}),evaluate:function(Fn){return x(f,d,Fn.zoom,S,P)}}}return{kind:"source",evaluate:function(Fn,fi){var Zn=fi&&fi.properties?fi.properties[f.property]:void 0;return void 0===Zn?Us(f.default,d.default):x(f,d,Zn,S,P)}}}(this._parameters,this._specification))};function js(e){var t=e.key,r=e.value,f=e.valueSpec||{},d=e.objectElementValidators||{},x=e.style,S=e.styleSpec,P=[],z=La(r);if("object"!==z)return[new Ae(t,r,"object expected, "+z+" found")];for(var J in r){var ee=J.split(".")[0],ue=f[ee]||f["*"],ye=void 0;if(d[ee])ye=d[ee];else if(f[ee])ye=sa;else if(d["*"])ye=d["*"];else{if(!f["*"]){P.push(new Ae(t,r[J],'unknown property "'+J+'"'));continue}ye=sa}P=P.concat(ye({key:(t&&t+".")+J,value:r[J],valueSpec:ue,style:x,styleSpec:S,object:r,objectKey:J},r))}for(var Se in f)d[Se]||f[Se].required&&void 0===f[Se].default&&void 0===r[Se]&&P.push(new Ae(t,r,'missing required property "'+Se+'"'));return P}function Pc(e){var t=e.value,r=e.valueSpec,f=e.style,d=e.styleSpec,x=e.key,S=e.arrayElementValidator||sa;if("array"!==La(t))return[new Ae(x,t,"array expected, "+La(t)+" found")];if(r.length&&t.length!==r.length)return[new Ae(x,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Ae(x,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var P={type:r.value,values:r.values};d.$version<7&&(P.function=r.function),"object"===La(r.value)&&(P=r.value);for(var z=[],J=0;J<t.length;J++)z=z.concat(S({array:t,arrayIndex:J,value:t[J],valueSpec:P,style:f,styleSpec:d,key:x+"["+J+"]"}));return z}function Ic(e){var t=e.key,r=e.value,f=e.valueSpec,d=La(r);return"number"===d&&r!=r&&(d="NaN"),"number"!==d?[new Ae(t,r,"number expected, "+d+" found")]:"minimum"in f&&r<f.minimum?[new Ae(t,r,r+" is less than the minimum value "+f.minimum)]:"maximum"in f&&r>f.maximum?[new Ae(t,r,r+" is greater than the maximum value "+f.maximum)]:[]}function Wc(e){var t,r,f,d=e.valueSpec,x=Kt(e.value.type),S={},P="categorical"!==x&&void 0===e.value.property,z=!P,J="array"===La(e.value.stops)&&"array"===La(e.value.stops[0])&&"object"===La(e.value.stops[0][0]),ee=js({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(Se){if("identity"===x)return[new Ae(Se.key,Se.value,'identity function may not have a "stops" property')];var qe=[],Je=Se.value;return qe=qe.concat(Pc({key:Se.key,value:Je,valueSpec:Se.valueSpec,style:Se.style,styleSpec:Se.styleSpec,arrayElementValidator:ue})),"array"===La(Je)&&0===Je.length&&qe.push(new Ae(Se.key,Je,"array must have at least one stop")),qe},default:function(Se){return sa({key:Se.key,value:Se.value,valueSpec:d,style:Se.style,styleSpec:Se.styleSpec})}}});return"identity"===x&&P&&ee.push(new Ae(e.key,e.value,'missing required property "property"')),"identity"===x||e.value.stops||ee.push(new Ae(e.key,e.value,'missing required property "stops"')),"exponential"===x&&e.valueSpec.expression&&!Bu(e.valueSpec)&&ee.push(new Ae(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(z&&!Rs(e.valueSpec)?ee.push(new Ae(e.key,e.value,"property functions not supported")):P&&!rc(e.valueSpec)&&ee.push(new Ae(e.key,e.value,"zoom functions not supported"))),"categorical"!==x&&!J||void 0!==e.value.property||ee.push(new Ae(e.key,e.value,'"property" property is required')),ee;function ue(Se){var qe=[],Je=Se.value,Tt=Se.key;if("array"!==La(Je))return[new Ae(Tt,Je,"array expected, "+La(Je)+" found")];if(2!==Je.length)return[new Ae(Tt,Je,"array length 2 expected, length "+Je.length+" found")];if(J){if("object"!==La(Je[0]))return[new Ae(Tt,Je,"object expected, "+La(Je[0])+" found")];if(void 0===Je[0].zoom)return[new Ae(Tt,Je,"object stop key must have zoom")];if(void 0===Je[0].value)return[new Ae(Tt,Je,"object stop key must have value")];if(f&&f>Kt(Je[0].zoom))return[new Ae(Tt,Je[0].zoom,"stop zoom values must appear in ascending order")];Kt(Je[0].zoom)!==f&&(f=Kt(Je[0].zoom),r=void 0,S={}),qe=qe.concat(js({key:Tt+"[0]",value:Je[0],valueSpec:{zoom:{}},style:Se.style,styleSpec:Se.styleSpec,objectElementValidators:{zoom:Ic,value:ye}}))}else qe=qe.concat(ye({key:Tt+"[0]",value:Je[0],valueSpec:{},style:Se.style,styleSpec:Se.styleSpec},Je));return $u(ir(Je[1]))?qe.concat([new Ae(Tt+"[1]",Je[1],"expressions are not allowed in function stops.")]):qe.concat(sa({key:Tt+"[1]",value:Je[1],valueSpec:d,style:Se.style,styleSpec:Se.styleSpec}))}function ye(Se,qe){var Je=La(Se.value),Tt=Kt(Se.value),st=null!==Se.value?Se.value:qe;if(t){if(Je!==t)return[new Ae(Se.key,st,Je+" stop domain type must match previous stop domain type "+t)]}else t=Je;if("number"!==Je&&"string"!==Je&&"boolean"!==Je)return[new Ae(Se.key,st,"stop domain value must be a number, string, or boolean")];if("number"!==Je&&"categorical"!==x){var Nt="number expected, "+Je+" found";return Rs(d)&&void 0===x&&(Nt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ae(Se.key,st,Nt)]}return"categorical"!==x||"number"!==Je||isFinite(Tt)&&Math.floor(Tt)===Tt?"categorical"!==x&&"number"===Je&&void 0!==r&&Tt<r?[new Ae(Se.key,st,"stop domain values must appear in ascending order")]:(r=Tt,"categorical"===x&&Tt in S?[new Ae(Se.key,st,"stop domain values must be unique")]:(S[Tt]=!0,[])):[new Ae(Se.key,st,"integer expected, found "+Tt)]}}function tl(e){var t=("property"===e.expressionContext?dl:pl)(ir(e.value),e.valueSpec);if("error"===t.result)return t.value.map(function(f){return new Ae(""+e.key+f.key,e.value,f.message)});var r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Ae(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!Lo(r))return[new Ae(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!Lo(r))return[new Ae(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!es(r,["zoom","feature-state"]))return[new Ae(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Qo(r))return[new Ae(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vl(e){var t=e.key,r=e.value,f=e.valueSpec,d=[];return Array.isArray(f.values)?-1===f.values.indexOf(Kt(r))&&d.push(new Ae(t,r,"expected one of ["+f.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(f.values).indexOf(Kt(r))&&d.push(new Ae(t,r,"expected one of ["+Object.keys(f.values).join(", ")+"], "+JSON.stringify(r)+" found")),d}function Nl(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var f=r[t];if(!Nl(f)&&"boolean"!=typeof f)return!1}return!0;default:return!0}}Fu.deserialize=function(e){return new Fu(e._parameters,e._specification)},Fu.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var ic={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Nu(e){if(null==e)return{filter:function(){return!0},needGeometry:!1};Nl(e)||(e=Cu(e));var t=pl(e,ic);if("error"===t.result)throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,f,d){return t.value.evaluate(r,f,{},d)},needGeometry:function r(f){if(!Array.isArray(f))return!1;if("within"===f[0])return!0;for(var d=1;d<f.length;d++)if(r(f[d]))return!0;return!1}(e)}}function uf(e,t){return e<t?-1:e>t?1:0}function Cu(e){if(!e)return!0;var t,r=e[0];return e.length<=1?"any"!==r:"=="===r?zu(e[1],e[2],"=="):"!="===r?Vs(zu(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?zu(e[1],e[2],r):"any"===r?(t=e.slice(1),["any"].concat(t.map(Cu))):"all"===r?["all"].concat(e.slice(1).map(Cu)):"none"===r?["all"].concat(e.slice(1).map(Cu).map(Vs)):"in"===r?nu(e[1],e.slice(2)):"!in"===r?Vs(nu(e[1],e.slice(2))):"has"===r?Au(e[1]):"!has"===r?Vs(Au(e[1])):"within"!==r||e}function zu(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function nu(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(uf)]]:["filter-in-small",e,["literal",t]]}}function Au(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Vs(e){return["!",e]}function zl(e){return Nl(ir(e.value))?tl(Sr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var f=r.value,d=r.key;if("array"!==La(f))return[new Ae(d,f,"array expected, "+La(f)+" found")];var x,S=r.styleSpec,P=[];if(f.length<1)return[new Ae(d,f,"filter array must have at least 1 element")];switch(P=P.concat(vl({key:d+"[0]",value:f[0],valueSpec:S.filter_operator,style:r.style,styleSpec:r.styleSpec})),Kt(f[0])){case"<":case"<=":case">":case">=":f.length>=2&&"$type"===Kt(f[1])&&P.push(new Ae(d,f,'"$type" cannot be use with operator "'+f[0]+'"'));case"==":case"!=":3!==f.length&&P.push(new Ae(d,f,'filter array for operator "'+f[0]+'" must have 3 elements'));case"in":case"!in":f.length>=2&&"string"!==(x=La(f[1]))&&P.push(new Ae(d+"[1]",f[1],"string expected, "+x+" found"));for(var z=2;z<f.length;z++)x=La(f[z]),"$type"===Kt(f[1])?P=P.concat(vl({key:d+"["+z+"]",value:f[z],valueSpec:S.geometry_type,style:r.style,styleSpec:r.styleSpec})):"string"!==x&&"number"!==x&&"boolean"!==x&&P.push(new Ae(d+"["+z+"]",f[z],"string, number, or boolean expected, "+x+" found"));break;case"any":case"all":case"none":for(var J=1;J<f.length;J++)P=P.concat(t({key:d+"["+J+"]",value:f[J],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":x=La(f[1]),2!==f.length?P.push(new Ae(d,f,'filter array for "'+f[0]+'" operator must have 2 elements')):"string"!==x&&P.push(new Ae(d+"[1]",f[1],"string expected, "+x+" found"));break;case"within":x=La(f[1]),2!==f.length?P.push(new Ae(d,f,'filter array for "'+f[0]+'" operator must have 2 elements')):"object"!==x&&P.push(new Ae(d+"[1]",f[1],"object expected, "+x+" found"))}return P}(e)}function ac(e,t){var r=e.key,f=e.style,d=e.styleSpec,x=e.value,S=e.objectKey,P=d[t+"_"+e.layerType];if(!P)return[];var z=S.match(/^(.*)-transition$/);if("paint"===t&&z&&P[z[1]]&&P[z[1]].transition)return sa({key:r,value:x,valueSpec:d.transition,style:f,styleSpec:d});var J,ee=e.valueSpec||P[S];if(!ee)return[new Ae(r,x,'unknown property "'+S+'"')];if("string"===La(x)&&Rs(ee)&&!ee.tokens&&(J=/^{([^}]+)}$/.exec(x)))return[new Ae(r,x,'"'+S+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(J[1])+" }`.")];var ue=[];return"symbol"===e.layerType&&("text-field"===S&&f&&!f.glyphs&&ue.push(new Ae(r,x,'use of "text-field" requires a style "glyphs" property')),"text-font"===S&&Ju(ir(x))&&"identity"===Kt(x.type)&&ue.push(new Ae(r,x,'"text-font" does not support identity functions'))),ue.concat(sa({key:e.key,value:x,valueSpec:ee,style:f,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:S}))}function oc(e){return ac(e,"paint")}function Zu(e){return ac(e,"layout")}function ns(e){var t=[],r=e.value,f=e.key,d=e.style,x=e.styleSpec;r.type||r.ref||t.push(new Ae(f,r,'either "type" or "ref" is required'));var S,P=Kt(r.type),z=Kt(r.ref);if(r.id)for(var J=Kt(r.id),ee=0;ee<e.arrayIndex;ee++){var ue=d.layers[ee];Kt(ue.id)===J&&t.push(new Ae(f,r.id,'duplicate layer id "'+r.id+'", previously used at line '+ue.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(qe){qe in r&&t.push(new Ae(f,r[qe],'"'+qe+'" is prohibited for ref layers'))}),d.layers.forEach(function(qe){Kt(qe.id)===z&&(S=qe)}),S?S.ref?t.push(new Ae(f,r.ref,"ref cannot reference another ref layer")):P=Kt(S.type):t.push(new Ae(f,r.ref,'ref layer "'+z+'" not found'));else if("background"!==P)if(r.source){var ye=d.sources&&d.sources[r.source],Se=ye&&Kt(ye.type);ye?"vector"===Se&&"raster"===P?t.push(new Ae(f,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===Se&&"raster"!==P?t.push(new Ae(f,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==Se||r["source-layer"]?"raster-dem"===Se&&"hillshade"!==P?t.push(new Ae(f,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==P||!r.paint||!r.paint["line-gradient"]||"geojson"===Se&&ye.lineMetrics||t.push(new Ae(f,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Ae(f,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Ae(f,r.source,'source "'+r.source+'" not found'))}else t.push(new Ae(f,r,'missing required property "source"'));return t=t.concat(js({key:f,value:r,valueSpec:x.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return sa({key:f+".type",value:r.type,valueSpec:x.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:zl,layout:function(qe){return js({layer:r,key:qe.key,value:qe.value,style:qe.style,styleSpec:qe.styleSpec,objectElementValidators:{"*":function(Je){return Zu(Sr({layerType:P},Je))}}})},paint:function(qe){return js({layer:r,key:qe.key,value:qe.value,style:qe.style,styleSpec:qe.styleSpec,objectElementValidators:{"*":function(Je){return oc(Sr({layerType:P},Je))}}})}}}))}function rl(e){var t=e.value,r=e.key,f=La(t);return"string"!==f?[new Ae(r,t,"string expected, "+f+" found")]:[]}var $a={promoteId:function(e){var t=e.key,r=e.value;if("string"===La(r))return rl({key:t,value:r});var f=[];for(var d in r)f.push.apply(f,rl({key:t+"."+d,value:r[d]}));return f}};function Zl(e){var t=e.value,r=e.key,f=e.styleSpec,d=e.style;if(!t.type)return[new Ae(r,t,'"type" is required')];var x,S=Kt(t.type);switch(S){case"vector":case"raster":case"raster-dem":return js({key:r,value:t,valueSpec:f["source_"+S.replace("-","_")],style:e.style,styleSpec:f,objectElementValidators:$a});case"geojson":if(x=js({key:r,value:t,valueSpec:f.source_geojson,style:d,styleSpec:f,objectElementValidators:$a}),t.cluster)for(var P in t.clusterProperties){var z=t.clusterProperties[P],J=z[0],ee="string"==typeof J?[J,["accumulated"],["get",P]]:J;x.push.apply(x,tl({key:r+"."+P+".map",value:z[1],expressionContext:"cluster-map"})),x.push.apply(x,tl({key:r+"."+P+".reduce",value:ee,expressionContext:"cluster-reduce"}))}return x;case"video":return js({key:r,value:t,valueSpec:f.source_video,style:d,styleSpec:f});case"image":return js({key:r,value:t,valueSpec:f.source_image,style:d,styleSpec:f});case"canvas":return[new Ae(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vl({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:f})}}function Gs(e){var t=e.value,r=e.styleSpec,f=r.light,d=e.style,x=[],S=La(t);if(void 0===t)return x;if("object"!==S)return x.concat([new Ae("light",t,"object expected, "+S+" found")]);for(var P in t){var z=P.match(/^(.*)-transition$/);x=x.concat(z&&f[z[1]]&&f[z[1]].transition?sa({key:P,value:t[P],valueSpec:r.transition,style:d,styleSpec:r}):f[P]?sa({key:P,value:t[P],valueSpec:f[P],style:d,styleSpec:r}):[new Ae(P,t[P],'unknown property "'+P+'"')])}return x}var Pu={"*":function(){return[]},array:Pc,boolean:function(e){var t=e.value,r=e.key,f=La(t);return"boolean"!==f?[new Ae(r,t,"boolean expected, "+f+" found")]:[]},number:Ic,color:function(e){var t=e.key,r=e.value,f=La(r);return"string"!==f?[new Ae(t,r,"color expected, "+f+" found")]:null===Bi(r)?[new Ae(t,r,'color expected, "'+r+'" found')]:[]},constants:wt,enum:vl,filter:zl,function:Wc,layer:ns,object:js,source:Zl,light:Gs,string:rl,formatted:function(e){return 0===rl(e).length?[]:tl(e)},resolvedImage:function(e){return 0===rl(e).length?[]:tl(e)}};function sa(e){var t=e.value,r=e.valueSpec,f=e.styleSpec;return r.expression&&Ju(Kt(t))?Wc(e):r.expression&&$u(ir(t))?tl(e):r.type&&Pu[r.type]?Pu[r.type](e):js(Sr({},e,{valueSpec:r.type?f[r.type]:r}))}function Va(e){var t=e.value,r=e.key,f=rl(e);return f.length||(-1===t.indexOf("{fontstack}")&&f.push(new Ae(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&f.push(new Ae(r,t,'"glyphs" url must include a "{range}" token'))),f}function ws(e,t){void 0===t&&(t=fe);var r=[];return r=r.concat(sa({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Va,"*":function(){return[]}}})),e.constants&&(r=r.concat(wt({key:"constants",value:e.constants,style:e,styleSpec:t}))),Ul(r)}function Ul(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Uu(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Ul(e.apply(this,t))}}ws.source=Uu(Zl),ws.light=Uu(Gs),ws.layer=Uu(ns),ws.filter=Uu(zl),ws.paintProperty=Uu(oc),ws.layoutProperty=Uu(Zu);var Mc=ws,Ta=Mc.light,lf=Mc.paintProperty,jl=Mc.layoutProperty;function ml(e,t){var r=!1;if(t&&t.length)for(var f=0,d=t;f<d.length;f+=1)e.fire(new xe(new Error(d[f].message))),r=!0;return r}var _u=So;function So(e,t,r){var f=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var d=new Int32Array(this.arrayBuffer);e=d[0],this.d=(t=d[1])+2*(r=d[2]);for(var x=0;x<this.d*this.d;x++){var S=d[3+x],P=d[3+x+1];f.push(S===P?null:d.subarray(S,P))}var z=d[3+f.length+1];this.keys=d.subarray(d[3+f.length],z),this.bboxes=d.subarray(z),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var J=0;J<this.d*this.d;J++)f.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var ee=r/t*e;this.min=-ee,this.max=e+ee}So.prototype.insert=function(e,t,r,f,d){this._forEachCell(t,r,f,d,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(f),this.bboxes.push(d)},So.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},So.prototype._insertCell=function(e,t,r,f,d,x){this.cells[d].push(x)},So.prototype.query=function(e,t,r,f,d){var x=this.min,S=this.max;if(e<=x&&t<=x&&S<=r&&S<=f&&!d)return Array.prototype.slice.call(this.keys);var P=[];return this._forEachCell(e,t,r,f,this._queryCell,P,{},d),P},So.prototype._queryCell=function(e,t,r,f,d,x,S,P){var z=this.cells[d];if(null!==z)for(var J=this.keys,ee=this.bboxes,ue=0;ue<z.length;ue++){var ye=z[ue];if(void 0===S[ye]){var Se=4*ye;(P?P(ee[Se+0],ee[Se+1],ee[Se+2],ee[Se+3]):e<=ee[Se+2]&&t<=ee[Se+3]&&r>=ee[Se+0]&&f>=ee[Se+1])?(S[ye]=!0,x.push(J[ye])):S[ye]=!1}}},So.prototype._forEachCell=function(e,t,r,f,d,x,S,P){for(var z=this._convertToCellCoord(e),J=this._convertToCellCoord(t),ee=this._convertToCellCoord(r),ue=this._convertToCellCoord(f),ye=z;ye<=ee;ye++)for(var Se=J;Se<=ue;Se++){var qe=this.d*Se+ye;if((!P||P(this._convertFromCellCoord(ye),this._convertFromCellCoord(Se),this._convertFromCellCoord(ye+1),this._convertFromCellCoord(Se+1)))&&d.call(this,e,t,r,f,qe,x,S,P))return}},So.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},So.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},So.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,f=0;f<this.cells.length;f++)r+=this.cells[f].length;var d=new Int32Array(t+r+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var x=t,S=0;S<e.length;S++){var P=e[S];d[3+S]=x,d.set(P,x),x+=P.length}return d[3+e.length]=x,d.set(this.keys,x),d[3+e.length+1]=x+=this.keys.length,d.set(this.bboxes,x),x+=this.bboxes.length,d.buffer};var gl=G.ImageData,yl=G.ImageBitmap,Ro={};function Nn(e,t,r){void 0===r&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Ro[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var za in Nn("Object",Object),_u.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},_u.deserialize=function(e){return new _u(e.buffer)},Nn("Grid",_u),Nn("Color",Xi),Nn("Error",Error),Nn("ResolvedImage",Wi),Nn("StylePropertyFunction",Fu),Nn("StyleExpression",yu,{omit:["_evaluator"]}),Nn("ZoomDependentExpression",el),Nn("ZoomConstantExpression",Qu),Nn("CompoundExpression",Ka,{omit:["_evaluate"]}),tu)tu[za]._classRegistryKey||Nn("Expression_"+za,tu[za]);function ju(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function _l(e){return yl&&e instanceof yl}function iu(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(ju(e)||_l(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof gl)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var f=[],d=0,x=e;d<x.length;d+=1)f.push(iu(x[d],t));return f}if("object"==typeof e){var S=e.constructor,P=S._classRegistryKey;if(!P)throw new Error("can't serialize object of unregistered class");var z=S.serialize?S.serialize(e,t):{};if(!S.serialize){for(var J in e)if(e.hasOwnProperty(J)&&!(Ro[P].omit.indexOf(J)>=0)){var ee=e[J];z[J]=Ro[P].shallow.indexOf(J)>=0?ee:iu(ee,t)}e instanceof Error&&(z.message=e.message)}if(z.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==P&&(z.$name=P),z}throw new Error("can't serialize object of type "+typeof e)}function Es(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||ju(e)||_l(e)||ArrayBuffer.isView(e)||e instanceof gl)return e;if(Array.isArray(e))return e.map(Es);if("object"==typeof e){var t=e.$name||"Object",r=Ro[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var f=Object.create(r.prototype),d=0,x=Object.keys(e);d<x.length;d+=1){var S=x[d];if("$name"!==S){var P=e[S];f[S]=Ro[t].shallow.indexOf(S)>=0?P:Es(P)}}return f}throw new Error("can't deserialize object of type "+typeof e)}var Xc=function(){this.first=!0};Xc.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var hn={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Kc(e){for(var t=0,r=e;t<r.length;t+=1)if(Oc(r[t].charCodeAt(0)))return!0;return!1}function Oc(e){return!(746!==e&&747!==e&&(e<4352||!(hn["Bopomofo Extended"](e)||hn.Bopomofo(e)||hn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||hn["CJK Compatibility Ideographs"](e)||hn["CJK Compatibility"](e)||hn["CJK Radicals Supplement"](e)||hn["CJK Strokes"](e)||!(!hn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||hn["CJK Unified Ideographs Extension A"](e)||hn["CJK Unified Ideographs"](e)||hn["Enclosed CJK Letters and Months"](e)||hn["Hangul Compatibility Jamo"](e)||hn["Hangul Jamo Extended-A"](e)||hn["Hangul Jamo Extended-B"](e)||hn["Hangul Jamo"](e)||hn["Hangul Syllables"](e)||hn.Hiragana(e)||hn["Ideographic Description Characters"](e)||hn.Kanbun(e)||hn["Kangxi Radicals"](e)||hn["Katakana Phonetic Extensions"](e)||hn.Katakana(e)&&12540!==e||!(!hn["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!hn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||hn["Unified Canadian Aboriginal Syllabics"](e)||hn["Unified Canadian Aboriginal Syllabics Extended"](e)||hn["Vertical Forms"](e)||hn["Yijing Hexagram Symbols"](e)||hn["Yi Syllables"](e)||hn["Yi Radicals"](e))))}function xl(e){return!(Oc(e)||(t=e,hn["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||hn["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||hn["Letterlike Symbols"](t)||hn["Number Forms"](t)||hn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||hn["Control Pictures"](t)&&9251!==t||hn["Optical Character Recognition"](t)||hn["Enclosed Alphanumerics"](t)||hn["Geometric Shapes"](t)||hn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||hn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||hn["CJK Symbols and Punctuation"](t)||hn.Katakana(t)||hn["Private Use Area"](t)||hn["CJK Compatibility Forms"](t)||hn["Small Form Variants"](t)||hn["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t));var t}function Ga(e){return e>=1424&&e<=2303||hn["Arabic Presentation Forms-A"](e)||hn["Arabic Presentation Forms-B"](e)}function Ts(e,t){return!(!t&&Ga(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||hn.Khmer(e))}function sc(e){for(var t=0,r=e;t<r.length;t+=1)if(Ga(r[t].charCodeAt(0)))return!0;return!1}var au=null,Ds="unavailable",Hs=null,Tf=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Ds="error"),au&&au(e)};function uc(){cf.fire(new ae("pluginStateChange",{pluginStatus:Ds,pluginURL:Hs}))}var cf=new Oe,Lc=function(){return Ds},Ws=function(){if("deferred"!==Ds||!Hs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ds="loading",uc(),Hs&&Pi({url:Hs},function(e){e?Tf(e):(Ds="loaded",uc())})},Cs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Ds||null!=Cs.applyArabicShaping},isLoading:function(){return"loading"===Ds},setState:function(e){Ds=e.pluginStatus,Hs=e.pluginURL},isParsed:function(){return null!=Cs.applyArabicShaping&&null!=Cs.processBidirectionalText&&null!=Cs.processStyledBidirectionalText},getPluginURL:function(){return Hs}},$i=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Xc,this.transition={})};$i.prototype.isSupportedScript=function(e){return function(t,r){for(var f=0,d=t;f<d.length;f+=1)if(!Ts(d[f].charCodeAt(0),r))return!1;return!0}(e,Cs.isLoaded())},$i.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},$i.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var xu=function(e,t){this.property=e,this.value=t,this.expression=function(r,f){if(Ju(r))return new Fu(r,f);if($u(r)){var d=dl(r,f);if("error"===d.result)throw new Error(d.value.map(function(S){return S.key+": "+S.message}).join(", "));return d.value}var x=r;return"string"==typeof r&&"color"===f.type&&(x=Xi.parse(r)),{kind:"constant",evaluate:function(){return x}}}(void 0===t?e.specification.default:t,e.specification)};xu.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},xu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Bs=function(e){this.property=e,this.value=new xu(e,void 0)};Bs.prototype.transitioned=function(e,t){return new nl(this.property,this.value,t,xt({},e.transition,this.transition),e.now)},Bs.prototype.untransitioned=function(){return new nl(this.property,this.value,null,{},0)};var Ko=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Ko.prototype.getValue=function(e){return Ue(this._values[e].value.value)},Ko.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Bs(this._values[e].property)),this._values[e].value=new xu(this._values[e].property,null===t?void 0:Ue(t))},Ko.prototype.getTransition=function(e){return Ue(this._values[e].transition)},Ko.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Bs(this._values[e].property)),this._values[e].transition=Ue(t)||void 0},Ko.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t],d=this.getValue(f);void 0!==d&&(e[f]=d);var x=this.getTransition(f);void 0!==x&&(e[f+"-transition"]=x)}return e},Ko.prototype.transitioned=function(e,t){for(var r=new bu(this._properties),f=0,d=Object.keys(this._values);f<d.length;f+=1){var x=d[f];r._values[x]=this._values[x].transitioned(e,t._values[x])}return r},Ko.prototype.untransitioned=function(){for(var e=new bu(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t];e._values[f]=this._values[f].untransitioned()}return e};var nl=function(e,t,r,f,d){this.property=e,this.value=t,this.begin=d+f.delay||0,this.end=this.begin+f.duration||0,e.specification.transition&&(f.delay||f.duration)&&(this.prior=r)};nl.prototype.possiblyEvaluate=function(e,t,r){var f=e.now||0,d=this.value.possiblyEvaluate(e,t,r),x=this.prior;if(x){if(f>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(f<this.begin)return x.possiblyEvaluate(e,t,r);var S=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(e,t,r),d,function(P){if(P<=0)return 0;if(P>=1)return 1;var z=P*P,J=z*P;return 4*(P<.5?J:3*(P-z)+J-.75)}(S))}return d};var bu=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};bu.prototype.possiblyEvaluate=function(e,t,r){for(var f=new il(this._properties),d=0,x=Object.keys(this._values);d<x.length;d+=1){var S=x[d];f._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return f},bu.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ou=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ou.prototype.getValue=function(e){return Ue(this._values[e].value)},ou.prototype.setValue=function(e,t){this._values[e]=new xu(this._values[e].property,null===t?void 0:Ue(t))},ou.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var f=r[t],d=this.getValue(f);void 0!==d&&(e[f]=d)}return e},ou.prototype.possiblyEvaluate=function(e,t,r){for(var f=new il(this._properties),d=0,x=Object.keys(this._values);d<x.length;d+=1){var S=x[d];f._values[S]=this._values[S].possiblyEvaluate(e,t,r)}return f};var mo=function(e,t,r){this.property=e,this.value=t,this.parameters=r};mo.prototype.isConstant=function(){return"constant"===this.value.kind},mo.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},mo.prototype.evaluate=function(e,t,r,f){return this.property.evaluate(this.value,this.parameters,e,t,r,f)};var il=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};il.prototype.get=function(e){return this._values[e]};var ri=function(e){this.specification=e};ri.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},ri.prototype.interpolate=function(e,t,r){var f=ko[this.specification.type];return f?f(e,t,r):e};var In=function(e,t){this.specification=e,this.overrides=t};In.prototype.possiblyEvaluate=function(e,t,r,f){return new mo(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,f)}:e.expression,t)},In.prototype.interpolate=function(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new mo(this,{kind:"constant",value:void 0},e.parameters);var f=ko[this.specification.type];return f?new mo(this,{kind:"constant",value:f(e.value.value,t.value.value,r)},e.parameters):e},In.prototype.evaluate=function(e,t,r,f,d,x){return"constant"===e.kind?e.value:e.evaluate(t,r,f,d,x)};var lc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,f,d,x){if(void 0===r.value)return new mo(this,{kind:"constant",value:void 0},f);if("constant"===r.expression.kind){var S=r.expression.evaluate(f,null,{},d,x),P="resolvedImage"===r.property.specification.type&&"string"!=typeof S?S.name:S,z=this._calculate(P,P,P,f);return new mo(this,{kind:"constant",value:z},f)}if("camera"===r.expression.kind){var J=this._calculate(r.expression.evaluate({zoom:f.zoom-1}),r.expression.evaluate({zoom:f.zoom}),r.expression.evaluate({zoom:f.zoom+1}),f);return new mo(this,{kind:"constant",value:J},f)}return new mo(this,r.expression,f)},t.prototype.evaluate=function(r,f,d,x,S,P){if("source"===r.kind){var z=r.evaluate(f,d,x,S,P);return this._calculate(z,z,z,f)}return"composite"===r.kind?this._calculate(r.evaluate({zoom:Math.floor(f.zoom)-1},d,x),r.evaluate({zoom:Math.floor(f.zoom)},d,x),r.evaluate({zoom:Math.floor(f.zoom)+1},d,x),f):r.value},t.prototype._calculate=function(r,f,d,x){return x.zoom>x.zoomHistory.lastIntegerZoom?{from:r,to:f}:{from:d,to:f}},t.prototype.interpolate=function(r){return r},t}(In),wo=function(e){this.specification=e};wo.prototype.possiblyEvaluate=function(e,t,r,f){if(void 0!==e.value){if("constant"===e.expression.kind){var d=e.expression.evaluate(t,null,{},r,f);return this._calculate(d,d,d,t)}return this._calculate(e.expression.evaluate(new $i(Math.floor(t.zoom-1),t)),e.expression.evaluate(new $i(Math.floor(t.zoom),t)),e.expression.evaluate(new $i(Math.floor(t.zoom+1),t)),t)}},wo.prototype._calculate=function(e,t,r,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},wo.prototype.interpolate=function(e){return e};var Xs=function(e){this.specification=e};Xs.prototype.possiblyEvaluate=function(e,t,r,f){return!!e.expression.evaluate(t,null,{},r,f)},Xs.prototype.interpolate=function(){return!1};var Po=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var f=this.defaultPropertyValues[t]=new xu(r,void 0),d=this.defaultTransitionablePropertyValues[t]=new Bs(r);this.defaultTransitioningPropertyValues[t]=d.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=f.possiblyEvaluate({})}};Nn("DataDrivenProperty",In),Nn("DataConstantProperty",ri),Nn("CrossFadedDataDrivenProperty",lc),Nn("CrossFadedProperty",wo),Nn("ColorRampProperty",Xs);var fo=function(e){function t(r,f){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==r.type&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),f.layout&&(this._unevaluatedLayout=new ou(f.layout)),f.paint)){for(var d in this._transitionablePaint=new Ko(f.paint),r.paint)this.setPaintProperty(d,r.paint[d],{validate:!1});for(var x in r.layout)this.setLayoutProperty(x,r.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new il(f.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,f,d){void 0===d&&(d={}),null!=f&&this._validate(jl,"layers."+this.id+".layout."+r,r,f,d)||("visibility"!==r?this._unevaluatedLayout.setValue(r,f):this.visibility=f)},t.prototype.getPaintProperty=function(r){return Q(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,f,d){if(void 0===d&&(d={}),null!=f&&this._validate(lf,"layers."+this.id+".paint."+r,r,f,d))return!1;if(Q(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),f||void 0),!1;var x=this._transitionablePaint._values[r],S="cross-faded-data-driven"===x.property.specification["property-type"],P=x.value.isDataDriven(),z=x.value;this._transitionablePaint.setValue(r,f),this._handleSpecialPaintPropertyUpdate(r);var J=this._transitionablePaint._values[r].value;return J.isDataDriven()||P||S||this._handleOverridablePaintPropertyUpdate(r,z,J)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,f,d){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,f){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,f)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),ot(r,function(f,d){return!(void 0===f||"layout"===d&&!Object.keys(f).length||"paint"===d&&!Object.keys(f).length)})},t.prototype._validate=function(r,f,d,x,S){return void 0===S&&(S={}),(!S||!1!==S.validate)&&ml(this,r.call(Mc,{key:f,layerType:this.type,objectKey:d,value:x,styleSpec:fe,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var f=this.paint.get(r);if(f instanceof mo&&Rs(f.property.specification)&&("source"===f.value.kind||"composite"===f.value.kind)&&f.value.isStateDependent)return!0}return!1},t}(Oe),Vl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Gl=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Qi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function zo(e,t){void 0===t&&(t=1);var r=0,f=0;return{members:e.map(function(d){var x=Vl[d.type].BYTES_PER_ELEMENT,S=r=ff(r,Math.max(t,x)),P=d.components||1;return f=Math.max(f,x),r+=x*P,{name:d.name,type:d.type,components:P,offset:S}}),size:ff(r,Math.max(f,t)),alignment:t}}function ff(e,t){return Math.ceil(e/t)*t}Qi.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Qi.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Qi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Qi.prototype.clear=function(){this.length=0},Qi.prototype.resize=function(e){this.reserve(e),this.length=e},Qi.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Qi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var As=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var d=this.length;return this.resize(d+1),this.emplace(d,r,f)},t.prototype.emplace=function(r,f,d){var x=2*r;return this.int16[x+0]=f,this.int16[x+1]=d,r},t}(Qi);As.prototype.bytesPerElement=4,Nn("StructArrayLayout2i4",As);var bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x){var S=this.length;return this.resize(S+1),this.emplace(S,r,f,d,x)},t.prototype.emplace=function(r,f,d,x,S){var P=4*r;return this.int16[P+0]=f,this.int16[P+1]=d,this.int16[P+2]=x,this.int16[P+3]=S,r},t}(Qi);bl.prototype.bytesPerElement=8,Nn("StructArrayLayout4i8",bl);var ys=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P){var z=this.length;return this.resize(z+1),this.emplace(z,r,f,d,x,S,P)},t.prototype.emplace=function(r,f,d,x,S,P,z){var J=6*r;return this.int16[J+0]=f,this.int16[J+1]=d,this.int16[J+2]=x,this.int16[J+3]=S,this.int16[J+4]=P,this.int16[J+5]=z,r},t}(Qi);ys.prototype.bytesPerElement=12,Nn("StructArrayLayout2i4i12",ys);var is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P){var z=this.length;return this.resize(z+1),this.emplace(z,r,f,d,x,S,P)},t.prototype.emplace=function(r,f,d,x,S,P,z){var J=4*r,ee=8*r;return this.int16[J+0]=f,this.int16[J+1]=d,this.uint8[ee+4]=x,this.uint8[ee+5]=S,this.uint8[ee+6]=P,this.uint8[ee+7]=z,r},t}(Qi);is.prototype.bytesPerElement=8,Nn("StructArrayLayout2i4ub8",is);var al=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var d=this.length;return this.resize(d+1),this.emplace(d,r,f)},t.prototype.emplace=function(r,f,d){var x=2*r;return this.float32[x+0]=f,this.float32[x+1]=d,r},t}(Qi);al.prototype.bytesPerElement=8,Nn("StructArrayLayout2f8",al);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee,ue){var ye=this.length;return this.resize(ye+1),this.emplace(ye,r,f,d,x,S,P,z,J,ee,ue)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue,ye){var Se=10*r;return this.uint16[Se+0]=f,this.uint16[Se+1]=d,this.uint16[Se+2]=x,this.uint16[Se+3]=S,this.uint16[Se+4]=P,this.uint16[Se+5]=z,this.uint16[Se+6]=J,this.uint16[Se+7]=ee,this.uint16[Se+8]=ue,this.uint16[Se+9]=ye,r},t}(Qi);su.prototype.bytesPerElement=20,Nn("StructArrayLayout10ui20",su);var Hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se){var qe=this.length;return this.resize(qe+1),this.emplace(qe,r,f,d,x,S,P,z,J,ee,ue,ye,Se)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe){var Je=12*r;return this.int16[Je+0]=f,this.int16[Je+1]=d,this.int16[Je+2]=x,this.int16[Je+3]=S,this.uint16[Je+4]=P,this.uint16[Je+5]=z,this.uint16[Je+6]=J,this.uint16[Je+7]=ee,this.int16[Je+8]=ue,this.int16[Je+9]=ye,this.int16[Je+10]=Se,this.int16[Je+11]=qe,r},t}(Qi);Hl.prototype.bytesPerElement=24,Nn("StructArrayLayout4i4ui4i24",Hl);var Sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,d)},t.prototype.emplace=function(r,f,d,x){var S=3*r;return this.float32[S+0]=f,this.float32[S+1]=d,this.float32[S+2]=x,r},t}(Qi);Sl.prototype.bytesPerElement=12,Nn("StructArrayLayout3f12",Sl);var Wl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.uint32[1*r+0]=f,r},t}(Qi);Wl.prototype.bytesPerElement=4,Nn("StructArrayLayout1ul4",Wl);var Yc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee){var ue=this.length;return this.resize(ue+1),this.emplace(ue,r,f,d,x,S,P,z,J,ee)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue){var ye=10*r,Se=5*r;return this.int16[ye+0]=f,this.int16[ye+1]=d,this.int16[ye+2]=x,this.int16[ye+3]=S,this.int16[ye+4]=P,this.int16[ye+5]=z,this.uint32[Se+3]=J,this.uint16[ye+8]=ee,this.uint16[ye+9]=ue,r},t}(Qi);Yc.prototype.bytesPerElement=20,Nn("StructArrayLayout6i1ul2ui20",Yc);var wl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P){var z=this.length;return this.resize(z+1),this.emplace(z,r,f,d,x,S,P)},t.prototype.emplace=function(r,f,d,x,S,P,z){var J=6*r;return this.int16[J+0]=f,this.int16[J+1]=d,this.int16[J+2]=x,this.int16[J+3]=S,this.int16[J+4]=P,this.int16[J+5]=z,r},t}(Qi);wl.prototype.bytesPerElement=12,Nn("StructArrayLayout2i2i2i12",wl);var ol=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S){var P=this.length;return this.resize(P+1),this.emplace(P,r,f,d,x,S)},t.prototype.emplace=function(r,f,d,x,S,P){var z=4*r,J=8*r;return this.float32[z+0]=f,this.float32[z+1]=d,this.float32[z+2]=x,this.int16[J+6]=S,this.int16[J+7]=P,r},t}(Qi);ol.prototype.bytesPerElement=16,Nn("StructArrayLayout2f1f2i16",ol);var kc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x){var S=this.length;return this.resize(S+1),this.emplace(S,r,f,d,x)},t.prototype.emplace=function(r,f,d,x,S){var P=12*r,z=3*r;return this.uint8[P+0]=f,this.uint8[P+1]=d,this.float32[z+1]=x,this.float32[z+2]=S,r},t}(Qi);kc.prototype.bytesPerElement=12,Nn("StructArrayLayout2ub2f12",kc);var sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,d)},t.prototype.emplace=function(r,f,d,x){var S=3*r;return this.uint16[S+0]=f,this.uint16[S+1]=d,this.uint16[S+2]=x,r},t}(Qi);sl.prototype.bytesPerElement=6,Nn("StructArrayLayout3ui6",sl);var Vu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Tt,st,Nt){var Qt=this.length;return this.resize(Qt+1),this.emplace(Qt,r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Tt,st,Nt)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Tt,st,Nt,Qt){var gr=24*r,xr=12*r,Rr=48*r;return this.int16[gr+0]=f,this.int16[gr+1]=d,this.uint16[gr+2]=x,this.uint16[gr+3]=S,this.uint32[xr+2]=P,this.uint32[xr+3]=z,this.uint32[xr+4]=J,this.uint16[gr+10]=ee,this.uint16[gr+11]=ue,this.uint16[gr+12]=ye,this.float32[xr+7]=Se,this.float32[xr+8]=qe,this.uint8[Rr+36]=Je,this.uint8[Rr+37]=Tt,this.uint8[Rr+38]=st,this.uint32[xr+10]=Nt,this.int16[gr+22]=Qt,r},t}(Qi);Vu.prototype.bytesPerElement=48,Nn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Vu);var Xl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Tt,st,Nt,Qt,gr,xr,Rr,nn,gn,ii,Fn,fi,Zn,na){var wi=this.length;return this.resize(wi+1),this.emplace(wi,r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Tt,st,Nt,Qt,gr,xr,Rr,nn,gn,ii,Fn,fi,Zn,na)},t.prototype.emplace=function(r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je,Tt,st,Nt,Qt,gr,xr,Rr,nn,gn,ii,Fn,fi,Zn,na,wi){var Qn=34*r,da=17*r;return this.int16[Qn+0]=f,this.int16[Qn+1]=d,this.int16[Qn+2]=x,this.int16[Qn+3]=S,this.int16[Qn+4]=P,this.int16[Qn+5]=z,this.int16[Qn+6]=J,this.int16[Qn+7]=ee,this.uint16[Qn+8]=ue,this.uint16[Qn+9]=ye,this.uint16[Qn+10]=Se,this.uint16[Qn+11]=qe,this.uint16[Qn+12]=Je,this.uint16[Qn+13]=Tt,this.uint16[Qn+14]=st,this.uint16[Qn+15]=Nt,this.uint16[Qn+16]=Qt,this.uint16[Qn+17]=gr,this.uint16[Qn+18]=xr,this.uint16[Qn+19]=Rr,this.uint16[Qn+20]=nn,this.uint16[Qn+21]=gn,this.uint16[Qn+22]=ii,this.uint32[da+12]=Fn,this.float32[da+13]=fi,this.float32[da+14]=Zn,this.float32[da+15]=na,this.float32[da+16]=wi,r},t}(Qi);Xl.prototype.bytesPerElement=68,Nn("StructArrayLayout8i15ui1ul4f68",Xl);var Gu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.float32[1*r+0]=f,r},t}(Qi);Gu.prototype.bytesPerElement=4,Nn("StructArrayLayout1f4",Gu);var Fs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,d)},t.prototype.emplace=function(r,f,d,x){var S=3*r;return this.int16[S+0]=f,this.int16[S+1]=d,this.int16[S+2]=x,r},t}(Qi);Fs.prototype.bytesPerElement=6,Nn("StructArrayLayout3i6",Fs);var Rc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d){var x=this.length;return this.resize(x+1),this.emplace(x,r,f,d)},t.prototype.emplace=function(r,f,d,x){var S=4*r;return this.uint32[2*r+0]=f,this.uint16[S+2]=d,this.uint16[S+3]=x,r},t}(Qi);Rc.prototype.bytesPerElement=8,Nn("StructArrayLayout1ul2ui8",Rc);var cc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f){var d=this.length;return this.resize(d+1),this.emplace(d,r,f)},t.prototype.emplace=function(r,f,d){var x=2*r;return this.uint16[x+0]=f,this.uint16[x+1]=d,r},t}(Qi);cc.prototype.bytesPerElement=4,Nn("StructArrayLayout2ui4",cc);var fc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var f=this.length;return this.resize(f+1),this.emplace(f,r)},t.prototype.emplace=function(r,f){return this.uint16[1*r+0]=f,r},t}(Qi);fc.prototype.bytesPerElement=2,Nn("StructArrayLayout1ui2",fc);var El=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,f,d,x){var S=this.length;return this.resize(S+1),this.emplace(S,r,f,d,x)},t.prototype.emplace=function(r,f,d,x,S){var P=4*r;return this.float32[P+0]=f,this.float32[P+1]=d,this.float32[P+2]=x,this.float32[P+3]=S,r},t}(Qi);El.prototype.bytesPerElement=16,Nn("StructArrayLayout4f16",El);var a=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new B(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Gl);a.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new a(this,r)},t}(Yc);Nn("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(f){this._structArray.uint8[this._pos1+37]=f},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(f){this._structArray.uint8[this._pos1+38]=f},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(f){this._structArray.uint32[this._pos4+10]=f},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Gl);o.prototype.size=48;var p=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new o(this,r)},t}(Vu);Nn("PlacedSymbolArray",p);var b=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(f){this._structArray.uint32[this._pos4+12]=f},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Gl);b.prototype.size=68;var E=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new b(this,r)},t}(Xl);Nn("SymbolInstanceArray",E);var A=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Gu);Nn("GlyphOffsetArray",A);var F=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Fs);Nn("SymbolLineVertexArray",F);var $=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Gl);$.prototype.size=8;var ce=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new $(this,r)},t}(Rc);Nn("FeatureIndexArray",ce);var Ce=zo([{name:"a_pos",components:2,type:"Int16"}],4).members,Ie=function(e){void 0===e&&(e=[]),this.segments=e};function ke(e,t){return 256*(e=W(Math.floor(e),0,255))+W(Math.floor(t),0,255)}Ie.prototype.prepareSegment=function(e,t,r,f){var d=this.segments[this.segments.length-1];return e>Ie.MAX_VERTEX_ARRAY_LENGTH&&Xe("Max vertices per segment is "+Ie.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!d||d.vertexLength+e>Ie.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==f)&&(d={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==f&&(d.sortKey=f),this.segments.push(d)),d},Ie.prototype.get=function(){return this.segments},Ie.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var f in r.vaos)r.vaos[f].destroy()}},Ie.simpleSegment=function(e,t,r,f){return new Ie([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:f,vaos:{},sortKey:0}])},Ie.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Nn("SegmentVector",Ie);var et=zo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),$e=g(function(e){e.exports=function(t,r){var f,d,x,S,P,z,J,ee;for(d=t.length-(f=3&t.length),x=r,P=3432918353,z=461845907,ee=0;ee<d;)J=255&t.charCodeAt(ee)|(255&t.charCodeAt(++ee))<<8|(255&t.charCodeAt(++ee))<<16|(255&t.charCodeAt(++ee))<<24,++ee,x=27492+(65535&(S=5*(65535&(x=(x^=J=(65535&(J=(J=(65535&J)*P+(((J>>>16)*P&65535)<<16)&4294967295)<<15|J>>>17))*z+(((J>>>16)*z&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(S>>>16)&65535)<<16);switch(J=0,f){case 3:J^=(255&t.charCodeAt(ee+2))<<16;case 2:J^=(255&t.charCodeAt(ee+1))<<8;case 1:x^=J=(65535&(J=(J=(65535&(J^=255&t.charCodeAt(ee)))*P+(((J>>>16)*P&65535)<<16)&4294967295)<<15|J>>>17))*z+(((J>>>16)*z&65535)<<16)&4294967295}return x^=t.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}}),ft=g(function(e){e.exports=function(t,r){for(var f,d=t.length,x=r^d,S=0;d>=4;)f=1540483477*(65535&(f=255&t.charCodeAt(S)|(255&t.charCodeAt(++S))<<8|(255&t.charCodeAt(++S))<<16|(255&t.charCodeAt(++S))<<24))+((1540483477*(f>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),d-=4,++S;switch(d){case 3:x^=(255&t.charCodeAt(S+2))<<16;case 2:x^=(255&t.charCodeAt(S+1))<<8;case 1:x=1540483477*(65535&(x^=255&t.charCodeAt(S)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}}),Ye=$e,lt=ft;Ye.murmur3=$e,Ye.murmur2=lt;var Pt=function(){this.ids=[],this.positions=[],this.indexed=!1};Pt.prototype.add=function(e,t,r,f){this.ids.push(hr(e)),this.positions.push(t,r,f)},Pt.prototype.getPositions=function(e){for(var t=hr(e),r=0,f=this.ids.length-1;r<f;){var d=r+f>>1;this.ids[d]>=t?f=d:r=d+1}for(var x=[];this.ids[r]===t;)x.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return x},Pt.serialize=function(e,t){var r=new Float64Array(e.ids),f=new Uint32Array(e.positions);return function d(x,S,P,z){for(;P<z;){for(var J=x[P+z>>1],ee=P-1,ue=z+1;;){do{ee++}while(x[ee]<J);do{ue--}while(x[ue]>J);if(ee>=ue)break;nr(x,ee,ue),nr(S,3*ee,3*ue),nr(S,3*ee+1,3*ue+1),nr(S,3*ee+2,3*ue+2)}ue-P<z-ue?(d(x,S,P,ue),P=ue+1):(d(x,S,ue+1,z),z=ue)}}(r,f,0,r.length-1),t&&t.push(r.buffer,f.buffer),{ids:r,positions:f}},Pt.deserialize=function(e){var t=new Pt;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var Ht=Math.pow(2,53)-1;function hr(e){var t=+e;return!isNaN(t)&&t<=Ht?t:Ye(String(e))}function nr(e,t,r){var f=e[t];e[t]=e[r],e[r]=f}Nn("FeaturePositionMap",Pt);var _r=function(e,t){this.gl=e.gl,this.location=t},Dr=function(e){function t(r,f){e.call(this,r,f),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(_r),Qr=function(e){function t(r,f){e.call(this,r,f),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(_r),Xr=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(_r),dn=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(_r),qn=function(e){function t(r,f){e.call(this,r,f),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(_r),jn=function(e){function t(r,f){e.call(this,r,f),this.current=Xi.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(_r),Bn=new Float32Array(16),Li=function(e){function t(r,f){e.call(this,r,f),this.current=Bn}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var f=1;f<16;f++)if(r[f]!==this.current[f]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(_r);function Dn(e){return[ke(255*e.r,255*e.g),ke(255*e.b,255*e.a)]}var gi=function(e,t,r){this.value=e,this.uniformNames=t.map(function(f){return"u_"+f}),this.type=r};gi.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},gi.prototype.getBinding=function(e,t,r){return"color"===this.type?new jn(e,t):new Qr(e,t)};var ji=function(e,t){this.uniformNames=t.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ji.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},ji.prototype.setUniform=function(e,t,r,f){var d="u_pattern_to"===f?this.patternTo:"u_pattern_from"===f?this.patternFrom:"u_pixel_ratio_to"===f?this.pixelRatioTo:"u_pixel_ratio_from"===f?this.pixelRatioFrom:null;d&&e.set(d)},ji.prototype.getBinding=function(e,t,r){return"u_pattern"===r.substr(0,9)?new qn(e,t):new Qr(e,t)};var li=function(e,t,r,f){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(function(d){return{name:"a_"+d,type:"Float32",components:"color"===r?2:1,offset:0}}),this.paintVertexArray=new f};li.prototype.populatePaintArray=function(e,t,r,f,d){var x=this.paintVertexArray.length,S=this.expression.evaluate(new $i(0),t,{},f,[],d);this.paintVertexArray.resize(e),this._setPaintValue(x,e,S)},li.prototype.updatePaintArray=function(e,t,r,f){var d=this.expression.evaluate({zoom:0},r,f);this._setPaintValue(e,t,d)},li.prototype._setPaintValue=function(e,t,r){if("color"===this.type)for(var f=Dn(r),d=e;d<t;d++)this.paintVertexArray.emplace(d,f[0],f[1]);else{for(var x=e;x<t;x++)this.paintVertexArray.emplace(x,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},li.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},li.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var yi=function(e,t,r,f,d,x){this.expression=e,this.uniformNames=t.map(function(S){return"u_"+S+"_t"}),this.type=r,this.useIntegerZoom=f,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=t.map(function(S){return{name:"a_"+S,type:"Float32",components:"color"===r?4:2,offset:0}}),this.paintVertexArray=new x};yi.prototype.populatePaintArray=function(e,t,r,f,d){var x=this.expression.evaluate(new $i(this.zoom),t,{},f,[],d),S=this.expression.evaluate(new $i(this.zoom+1),t,{},f,[],d),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,x,S)},yi.prototype.updatePaintArray=function(e,t,r,f){var d=this.expression.evaluate({zoom:this.zoom},r,f),x=this.expression.evaluate({zoom:this.zoom+1},r,f);this._setPaintValue(e,t,d,x)},yi.prototype._setPaintValue=function(e,t,r,f){if("color"===this.type)for(var d=Dn(r),x=Dn(f),S=e;S<t;S++)this.paintVertexArray.emplace(S,d[0],d[1],x[0],x[1]);else{for(var P=e;P<t;P++)this.paintVertexArray.emplace(P,r,f);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(f))}},yi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},yi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},yi.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,f=W(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(f)},yi.prototype.getBinding=function(e,t,r){return new Qr(e,t)};var Ni=function(e,t,r,f,d,x){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=f,this.layerId=x,this.zoomInPaintVertexArray=new d,this.zoomOutPaintVertexArray=new d};Ni.prototype.populatePaintArray=function(e,t,r){var f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(f,e,t.patterns&&t.patterns[this.layerId],r)},Ni.prototype.updatePaintArray=function(e,t,r,f,d){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],d)},Ni.prototype._setPaintValues=function(e,t,r,f){if(f&&r){var d=f[r.min],x=f[r.mid],S=f[r.max];if(d&&x&&S)for(var P=e;P<t;P++)this.zoomInPaintVertexArray.emplace(P,x.tl[0],x.tl[1],x.br[0],x.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],x.pixelRatio,d.pixelRatio),this.zoomOutPaintVertexArray.emplace(P,x.tl[0],x.tl[1],x.br[0],x.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],x.pixelRatio,S.pixelRatio)}},Ni.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,et.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,et.members,this.expression.isStateDependent))},Ni.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var te=function(e,t,r){this.binders={},this._buffers=[];var f=[];for(var d in e.paint._values)if(r(d)){var x=e.paint.get(d);if(x instanceof mo&&Rs(x.property.specification)){var S=N(d,e.type),P=x.value,z=x.property.specification.type,J=x.property.useIntegerZoom,ee=x.property.specification["property-type"],ue="cross-faded"===ee||"cross-faded-data-driven"===ee;if("constant"===P.kind)this.binders[d]=ue?new ji(P.value,S):new gi(P.value,S,z),f.push("/u_"+d);else if("source"===P.kind||ue){var ye=U(d,z,"source");this.binders[d]=ue?new Ni(P,z,J,t,ye,e.id):new li(P,S,z,ye),f.push("/a_"+d)}else{var Se=U(d,z,"composite");this.binders[d]=new yi(P,S,z,J,t,Se),f.push("/z_"+d)}}}this.cacheKey=f.sort().join("")};te.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof li||t instanceof yi?t.maxValue:0},te.prototype.populatePaintArrays=function(e,t,r,f,d){for(var x in this.binders){var S=this.binders[x];(S instanceof li||S instanceof yi||S instanceof Ni)&&S.populatePaintArray(e,t,r,f,d)}},te.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var f=this.binders[r];f instanceof ji&&f.setConstantPatternPositions(e,t)}},te.prototype.updatePaintArrays=function(e,t,r,f,d){var x=!1;for(var S in e)for(var P=0,z=t.getPositions(S);P<z.length;P+=1){var J=z[P],ee=r.feature(J.index);for(var ue in this.binders){var ye=this.binders[ue];if((ye instanceof li||ye instanceof yi||ye instanceof Ni)&&!0===ye.expression.isStateDependent){var Se=f.paint.get(ue);ye.expression=Se.value,ye.updatePaintArray(J.start,J.end,ee,e[S],d),x=!0}}}return x},te.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof gi||r instanceof ji)&&e.push.apply(e,r.uniformNames.map(function(f){return"#define HAS_UNIFORM_"+f}))}return e},te.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof li||r instanceof yi)for(var f=0;f<r.paintVertexAttributes.length;f++)e.push(r.paintVertexAttributes[f].name);else if(r instanceof Ni)for(var d=0;d<et.members.length;d++)e.push(et.members[d].name)}return e},te.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof gi||r instanceof ji||r instanceof yi)for(var f=0,d=r.uniformNames;f<d.length;f+=1)e.push(d[f])}return e},te.prototype.getPaintVertexBuffers=function(){return this._buffers},te.prototype.getUniforms=function(e,t){var r=[];for(var f in this.binders){var d=this.binders[f];if(d instanceof gi||d instanceof ji||d instanceof yi)for(var x=0,S=d.uniformNames;x<S.length;x+=1){var P=S[x];if(t[P]){var z=d.getBinding(e,t[P],P);r.push({name:P,property:f,binding:z})}}}return r},te.prototype.setUniforms=function(e,t,r,f){for(var d=0,x=t;d<x.length;d+=1){var S=x[d],P=S.name,z=S.property;this.binders[z].setUniform(S.binding,f,r.get(z),P)}},te.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ni){var f=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(r instanceof li||r instanceof yi)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},te.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof li||r instanceof yi||r instanceof Ni)&&r.upload(e)}this.updatePaintBuffers()},te.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof li||t instanceof yi||t instanceof Ni)&&t.destroy()}};var ne=function(e,t,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var f=0,d=e;f<d.length;f+=1){var x=d[f];this.programConfigurations[x.id]=new te(x,t,r)}this.needsUpload=!1,this._featureMap=new Pt,this._bufferOffset=0};function N(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function U(e,t,r){var d={"line-pattern":{source:su,composite:su},"fill-pattern":{source:su,composite:su},"fill-extrusion-pattern":{source:su,composite:su}}[e];return d&&d[r]||{color:{source:al,composite:El},number:{source:Gu,composite:al}}[t][r]}ne.prototype.populatePaintArrays=function(e,t,r,f,d,x){for(var S in this.programConfigurations)this.programConfigurations[S].populatePaintArrays(e,t,f,d,x);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},ne.prototype.updatePaintArrays=function(e,t,r,f){for(var d=0,x=r;d<x.length;d+=1){var S=x[d];this.needsUpload=this.programConfigurations[S.id].updatePaintArrays(e,this._featureMap,t,S,f)||this.needsUpload}},ne.prototype.get=function(e){return this.programConfigurations[e]},ne.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},ne.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Nn("ConstantBinder",gi),Nn("CrossFadedConstantBinder",ji),Nn("SourceExpressionBinder",li),Nn("CrossFadedCompositeBinder",Ni),Nn("CompositeExpressionBinder",yi),Nn("ProgramConfiguration",te,{omit:["_buffers"]}),Nn("ProgramConfigurationSet",ne);var he=Math.pow(2,14)-1,Te=-he-1;function vt(e){for(var t=8192/e.extent,r=e.loadGeometry(),f=0;f<r.length;f++)for(var d=r[f],x=0;x<d.length;x++){var S=d[x],P=Math.round(S.x*t),z=Math.round(S.y*t);S.x=W(P,Te,he),S.y=W(z,Te,he),(P<S.x||P>S.x+1||z<S.y||z>S.y+1)&&Xe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Rt(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?vt(e):[]}}function Ot(e,t,r,f,d){e.emplaceBack(2*t+(f+1)/2,2*r+(d+1)/2)}var ur=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new As,this.indexArray=new sl,this.segments=new Ie,this.programConfigurations=new ne(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Vr(e,t){for(var r=0;r<e.length;r++)if(Ha(t,e[r]))return!0;for(var f=0;f<t.length;f++)if(Ha(e,t[f]))return!0;return!!Ci(e,t)}function Ln(e,t,r){return!!Ha(e,t)||!!ea(t,e,r)}function Xn(e,t){if(1===e.length)return ua(t,e[0]);for(var r=0;r<t.length;r++)for(var f=t[r],d=0;d<f.length;d++)if(Ha(e,f[d]))return!0;for(var x=0;x<e.length;x++)if(ua(t,e[x]))return!0;for(var S=0;S<t.length;S++)if(Ci(e,t[S]))return!0;return!1}function ni(e,t,r){if(e.length>1){if(Ci(e,t))return!0;for(var f=0;f<t.length;f++)if(ea(t[f],e,r))return!0}for(var d=0;d<e.length;d++)if(ea(e[d],t,r))return!0;return!1}function Ci(e,t){if(0===e.length||0===t.length)return!1;for(var r=0;r<e.length-1;r++)for(var f=e[r],d=e[r+1],x=0;x<t.length-1;x++)if(Si(f,d,t[x],t[x+1]))return!0;return!1}function Si(e,t,r,f){return At(e,r,f)!==At(t,r,f)&&At(e,t,r)!==At(e,t,f)}function ea(e,t,r){var f=r*r;if(1===t.length)return e.distSqr(t[0])<f;for(var d=1;d<t.length;d++)if(xa(e,t[d-1],t[d])<f)return!0;return!1}function xa(e,t,r){var f=t.distSqr(r);if(0===f)return e.distSqr(t);var d=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/f;return e.distSqr(d<0?t:d>1?r:r.sub(t)._mult(d)._add(t))}function ua(e,t){for(var r,f,d,x=!1,S=0;S<e.length;S++)for(var P=0,z=(r=e[S]).length-1;P<r.length;z=P++)(f=r[P]).y>t.y!=(d=r[z]).y>t.y&&t.x<(d.x-f.x)*(t.y-f.y)/(d.y-f.y)+f.x&&(x=!x);return x}function Ha(e,t){for(var r=!1,f=0,d=e.length-1;f<e.length;d=f++){var x=e[f],S=e[d];x.y>t.y!=S.y>t.y&&t.x<(S.x-x.x)*(t.y-x.y)/(S.y-x.y)+x.x&&(r=!r)}return r}function Wa(e,t,r){var f=r[0],d=r[2];if(e.x<f.x&&t.x<f.x||e.x>d.x&&t.x>d.x||e.y<f.y&&t.y<f.y||e.y>d.y&&t.y>d.y)return!1;var x=At(e,t,r[0]);return x!==At(e,t,r[1])||x!==At(e,t,r[2])||x!==At(e,t,r[3])}function Ya(e,t,r){var f=t.paint.get(e).value;return"constant"===f.kind?f.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ia(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function ga(e,t,r,f,d){if(!t[0]&&!t[1])return e;var x=B.convert(t)._mult(d);"viewport"===r&&x._rotate(-f);for(var S=[],P=0;P<e.length;P++)S.push(e[P].sub(x));return S}ur.prototype.populate=function(e,t,r){var f=this.layers[0],d=[],x=null;"circle"===f.type&&(x=f.layout.get("circle-sort-key"));for(var S=0,P=e;S<P.length;S+=1){var z=P[S],J=z.feature,ee=z.id,ue=z.index,ye=z.sourceLayerIndex,Se=this.layers[0]._featureFilter.needGeometry,qe=Rt(J,Se);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),qe,r)){var Je=x?x.evaluate(qe,{},r):void 0,Tt={id:ee,properties:J.properties,type:J.type,sourceLayerIndex:ye,index:ue,geometry:Se?qe.geometry:vt(J),patterns:{},sortKey:Je};d.push(Tt)}}x&&d.sort(function(gn,ii){return gn.sortKey-ii.sortKey});for(var st=0,Nt=d;st<Nt.length;st+=1){var Qt=Nt[st],gr=Qt.geometry,xr=Qt.index,Rr=Qt.sourceLayerIndex,nn=e[xr].feature;this.addFeature(Qt,gr,xr,r),t.featureIndex.insert(nn,gr,xr,Rr,this.index)}},ur.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},ur.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},ur.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ur.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ce),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},ur.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ur.prototype.addFeature=function(e,t,r,f){for(var d=0,x=t;d<x.length;d+=1)for(var S=0,P=x[d];S<P.length;S+=1){var z=P[S],J=z.x,ee=z.y;if(!(J<0||J>=8192||ee<0||ee>=8192)){var ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),ye=ue.vertexLength;Ot(this.layoutVertexArray,J,ee,-1,-1),Ot(this.layoutVertexArray,J,ee,1,-1),Ot(this.layoutVertexArray,J,ee,1,1),Ot(this.layoutVertexArray,J,ee,-1,1),this.indexArray.emplaceBack(ye,ye+1,ye+2),this.indexArray.emplaceBack(ye,ye+3,ye+2),ue.vertexLength+=4,ue.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},f)},Nn("CircleBucket",ur,{omit:["layers"]});var la=new Po({"circle-sort-key":new In(fe.layout_circle["circle-sort-key"])}),no={paint:new Po({"circle-radius":new In(fe.paint_circle["circle-radius"]),"circle-color":new In(fe.paint_circle["circle-color"]),"circle-blur":new In(fe.paint_circle["circle-blur"]),"circle-opacity":new In(fe.paint_circle["circle-opacity"]),"circle-translate":new ri(fe.paint_circle["circle-translate"]),"circle-translate-anchor":new ri(fe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ri(fe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ri(fe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new In(fe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new In(fe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new In(fe.paint_circle["circle-stroke-opacity"])}),layout:la},ki="undefined"!=typeof Float32Array?Float32Array:Array;function Ca(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ba(e,t,r){var f=t[0],d=t[1],x=t[2],S=t[3],P=t[4],z=t[5],J=t[6],ee=t[7],ue=t[8],ye=t[9],Se=t[10],qe=t[11],Je=t[12],Tt=t[13],st=t[14],Nt=t[15],Qt=r[0],gr=r[1],xr=r[2],Rr=r[3];return e[0]=Qt*f+gr*P+xr*ue+Rr*Je,e[1]=Qt*d+gr*z+xr*ye+Rr*Tt,e[2]=Qt*x+gr*J+xr*Se+Rr*st,e[3]=Qt*S+gr*ee+xr*qe+Rr*Nt,e[4]=(Qt=r[4])*f+(gr=r[5])*P+(xr=r[6])*ue+(Rr=r[7])*Je,e[5]=Qt*d+gr*z+xr*ye+Rr*Tt,e[6]=Qt*x+gr*J+xr*Se+Rr*st,e[7]=Qt*S+gr*ee+xr*qe+Rr*Nt,e[8]=(Qt=r[8])*f+(gr=r[9])*P+(xr=r[10])*ue+(Rr=r[11])*Je,e[9]=Qt*d+gr*z+xr*ye+Rr*Tt,e[10]=Qt*x+gr*J+xr*Se+Rr*st,e[11]=Qt*S+gr*ee+xr*qe+Rr*Nt,e[12]=(Qt=r[12])*f+(gr=r[13])*P+(xr=r[14])*ue+(Rr=r[15])*Je,e[13]=Qt*d+gr*z+xr*ye+Rr*Tt,e[14]=Qt*x+gr*J+xr*Se+Rr*st,e[15]=Qt*S+gr*ee+xr*qe+Rr*Nt,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var go,e,Kl=ba;function uu(e,t,r){var f=t[0],d=t[1],x=t[2],S=t[3];return e[0]=r[0]*f+r[4]*d+r[8]*x+r[12]*S,e[1]=r[1]*f+r[5]*d+r[9]*x+r[13]*S,e[2]=r[2]*f+r[6]*d+r[10]*x+r[14]*S,e[3]=r[3]*f+r[7]*d+r[11]*x+r[15]*S,e}go=new ki(3),ki!=Float32Array&&(go[0]=0,go[1]=0,go[2]=0),e=new ki(4),ki!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0);var Yo=(function(){var e=new ki(2);ki!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,no)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new ur(r)},t.prototype.queryRadius=function(r){var f=r;return Ya("circle-radius",this,f)+Ya("circle-stroke-width",this,f)+ia(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,f,d,x,S,P,z,J){for(var ee=ga(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),P.angle,z),ue=this.paint.get("circle-radius").evaluate(f,d)+this.paint.get("circle-stroke-width").evaluate(f,d),ye="map"===this.paint.get("circle-pitch-alignment"),Se=ye?ee:function(nn,gn){return nn.map(function(ii){return Su(ii,gn)})}(ee,J),qe=ye?ue*z:ue,Je=0,Tt=x;Je<Tt.length;Je+=1)for(var st=0,Nt=Tt[Je];st<Nt.length;st+=1){var Qt=Nt[st],gr=ye?Qt:Su(Qt,J),xr=qe,Rr=uu([],[Qt.x,Qt.y,0,1],J);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?xr*=Rr[3]/P.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(xr*=P.cameraToCenterDistance/Rr[3]),Ln(Se,gr,xr))return!0}return!1},t}(fo));function Su(e,t){var r=uu([],[e.x,e.y,0,1],t);return new B(r[0]/r[3],r[1]/r[3])}var Hu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(ur);function ul(e,t,r,f){var d=t.width,x=t.height;if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==d*x*r)throw new RangeError("mismatched image size")}else f=new Uint8Array(d*x*r);return e.width=d,e.height=x,e.data=f,e}function Ks(e,t,r){var f=t.width,d=t.height;if(f!==e.width||d!==e.height){var x=ul({},{width:f,height:d},r);Yl(e,x,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,f),height:Math.min(e.height,d)},r),e.width=f,e.height=d,e.data=x.data}}function Yl(e,t,r,f,d,x){if(0===d.width||0===d.height)return t;if(d.width>e.width||d.height>e.height||r.x>e.width-d.width||r.y>e.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||f.x>t.width-d.width||f.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");for(var S=e.data,P=t.data,z=0;z<d.height;z++)for(var J=((r.y+z)*e.width+r.x)*x,ee=((f.y+z)*t.width+f.x)*x,ue=0;ue<d.width*x;ue++)P[ee+ue]=S[J+ue];return t}Nn("HeatmapBucket",Hu,{omit:["layers"]});var Wu=function(e,t){ul(this,e,1,t)};Wu.prototype.resize=function(e){Ks(this,e,1)},Wu.prototype.clone=function(){return new Wu({width:this.width,height:this.height},new Uint8Array(this.data))},Wu.copy=function(e,t,r,f,d){Yl(e,t,r,f,d,1)};var ca=function(e,t){ul(this,e,4,t)};ca.prototype.resize=function(e){Ks(this,e,4)},ca.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},ca.prototype.clone=function(){return new ca({width:this.width,height:this.height},new Uint8Array(this.data))},ca.copy=function(e,t,r,f,d){Yl(e,t,r,f,d,4)},Nn("AlphaImage",Wu),Nn("RGBAImage",ca);var Hf={paint:new Po({"heatmap-radius":new In(fe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new In(fe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ri(fe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Xs(fe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ri(fe.paint_heatmap["heatmap-opacity"])})};function Tl(e){var t={},r=e.resolution||256,f=e.clips?e.clips.length:1,d=e.image||new ca({width:r,height:f}),x=function(qe,Je,Tt){t[e.evaluationKey]=Tt;var st=e.expression.evaluate(t);d.data[qe+Je+0]=Math.floor(255*st.r/st.a),d.data[qe+Je+1]=Math.floor(255*st.g/st.a),d.data[qe+Je+2]=Math.floor(255*st.b/st.a),d.data[qe+Je+3]=Math.floor(255*st.a)};if(e.clips)for(var S=0,P=0;S<f;++S,P+=4*r)for(var z=0,J=0;z<r;z++,J+=4){var ee=z/(r-1),ue=e.clips[S];x(P,J,ue.start*(1-ee)+ue.end*ee)}else for(var ye=0,Se=0;ye<r;ye++,Se+=4)x(0,Se,ye/(r-1));return d}var Wf=function(e){function t(r){e.call(this,r,Hf),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Hu(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){"heatmap-color"===r&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Tl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(fo),Ys={paint:new Po({"hillshade-illumination-direction":new ri(fe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ri(fe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ri(fe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ri(fe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ri(fe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ri(fe.paint_hillshade["hillshade-accent-color"])})},xh=function(e){function t(r){e.call(this,r,Ys)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(fo),Dc=zo([{name:"a_pos",components:2,type:"Int16"}],4).members,hc=Cf,wp=Cf;function Cf(e,t,r){r=r||2;var f,d,x,S,P,z,J,ee=t&&t.length,ue=ee?t[0]*r:e.length,ye=Xf(e,0,ue,r,!0),Se=[];if(!ye||ye.next===ye.prev)return Se;if(ee&&(ye=function(Je,Tt,st,Nt){var Qt,gr,xr,Rr=[];for(Qt=0,gr=Tt.length;Qt<gr;Qt++)(xr=Xf(Je,Tt[Qt]*Nt,Qt<gr-1?Tt[Qt+1]*Nt:Je.length,Nt,!1))===xr.next&&(xr.steiner=!0),Rr.push(tp(xr));for(Rr.sort(ep),Qt=0;Qt<Rr.length;Qt++)qs(Rr[Qt],st),st=ll(st,st.next);return st}(e,t,ye,r)),e.length>80*r){f=x=e[0],d=S=e[1];for(var qe=r;qe<ue;qe+=r)(P=e[qe])<f&&(f=P),(z=e[qe+1])<d&&(d=z),P>x&&(x=P),z>S&&(S=z);J=0!==(J=Math.max(x-f,S-d))?1/J:0}return qc(ye,Se,r,f,d,J),Se}function Xf(e,t,r,f,d){var x,S;if(d===Iu(e,t,r,f)>0)for(x=t;x<r;x+=f)S=Pf(x,e[x],e[x+1],S);else for(x=r-f;x>=t;x-=f)S=Pf(x,e[x],e[x+1],S);return S&&pc(S,S.next)&&(Fc(S),S=S.next),S}function ll(e,t){if(!e)return e;t||(t=e);var r,f=e;do{if(r=!1,f.steiner||!pc(f,f.next)&&0!==Eo(f.prev,f,f.next))f=f.next;else{if(Fc(f),(f=t=f.prev)===f.next)break;r=!0}}while(r||f!==t);return t}function qc(e,t,r,f,d,x,S){if(e){!S&&x&&function(ee,ue,ye,Se){var qe=ee;do{null===qe.z&&(qe.z=Sh(qe.x,qe.y,ue,ye,Se)),qe.prevZ=qe.prev,qe.nextZ=qe.next,qe=qe.next}while(qe!==ee);qe.prevZ.nextZ=null,qe.prevZ=null,function(Je){var Tt,st,Nt,Qt,gr,xr,Rr,nn,gn=1;do{for(st=Je,Je=null,gr=null,xr=0;st;){for(xr++,Nt=st,Rr=0,Tt=0;Tt<gn&&(Rr++,Nt=Nt.nextZ);Tt++);for(nn=gn;Rr>0||nn>0&&Nt;)0!==Rr&&(0===nn||!Nt||st.z<=Nt.z)?(Qt=st,st=st.nextZ,Rr--):(Qt=Nt,Nt=Nt.nextZ,nn--),gr?gr.nextZ=Qt:Je=Qt,Qt.prevZ=gr,gr=Qt;st=Nt}gr.nextZ=null,gn*=2}while(xr>1)}(qe)}(e,f,d,x);for(var P,z,J=e;e.prev!==e.next;)if(P=e.prev,z=e.next,x?hf(e,f,d,x):$h(e))t.push(P.i/r),t.push(e.i/r),t.push(z.i/r),Fc(e),e=z.next,J=z.next;else if((e=z)===J){S?1===S?qc(e=bh(ll(e),t,r),t,r,f,d,x,2):2===S&&Qh(e,t,r,f,d,x):qc(ll(e),t,r,f,d,x,1);break}}}function $h(e){var t=e.prev,r=e,f=e.next;if(Eo(t,r,f)>=0)return!1;for(var d=e.next.next;d!==e.prev;){if(Jc(t.x,t.y,r.x,r.y,f.x,f.y,d.x,d.y)&&Eo(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function hf(e,t,r,f){var d=e.prev,x=e,S=e.next;if(Eo(d,x,S)>=0)return!1;for(var P=d.x>x.x?d.x>S.x?d.x:S.x:x.x>S.x?x.x:S.x,z=d.y>x.y?d.y>S.y?d.y:S.y:x.y>S.y?x.y:S.y,J=Sh(d.x<x.x?d.x<S.x?d.x:S.x:x.x<S.x?x.x:S.x,d.y<x.y?d.y<S.y?d.y:S.y:x.y<S.y?x.y:S.y,t,r,f),ee=Sh(P,z,t,r,f),ue=e.prevZ,ye=e.nextZ;ue&&ue.z>=J&&ye&&ye.z<=ee;){if(ue!==e.prev&&ue!==e.next&&Jc(d.x,d.y,x.x,x.y,S.x,S.y,ue.x,ue.y)&&Eo(ue.prev,ue,ue.next)>=0||(ue=ue.prevZ,ye!==e.prev&&ye!==e.next&&Jc(d.x,d.y,x.x,x.y,S.x,S.y,ye.x,ye.y)&&Eo(ye.prev,ye,ye.next)>=0))return!1;ye=ye.nextZ}for(;ue&&ue.z>=J;){if(ue!==e.prev&&ue!==e.next&&Jc(d.x,d.y,x.x,x.y,S.x,S.y,ue.x,ue.y)&&Eo(ue.prev,ue,ue.next)>=0)return!1;ue=ue.prevZ}for(;ye&&ye.z<=ee;){if(ye!==e.prev&&ye!==e.next&&Jc(d.x,d.y,x.x,x.y,S.x,S.y,ye.x,ye.y)&&Eo(ye.prev,ye,ye.next)>=0)return!1;ye=ye.nextZ}return!0}function bh(e,t,r){var f=e;do{var d=f.prev,x=f.next.next;!pc(d,x)&&wh(d,f,f.next,x)&&Bc(d,x)&&Bc(x,d)&&(t.push(d.i/r),t.push(f.i/r),t.push(x.i/r),Fc(f),Fc(f.next),f=e=x),f=f.next}while(f!==e);return ll(f)}function Qh(e,t,r,f,d,x){var S=e;do{for(var P=S.next.next;P!==S.prev;){if(S.i!==P.i&&Tp(S,P)){var z=pf(S,P);return S=ll(S,S.next),z=ll(z,z.next),qc(S,t,r,f,d,x),void qc(z,t,r,f,d,x)}P=P.next}S=S.next}while(S!==e)}function ep(e,t){return e.x-t.x}function qs(e,t){if(t=function(f,d){var x,S=d,P=f.x,z=f.y,J=-1/0;do{if(z<=S.y&&z>=S.next.y&&S.next.y!==S.y){var ee=S.x+(z-S.y)*(S.next.x-S.x)/(S.next.y-S.y);if(ee<=P&&ee>J){if(J=ee,ee===P){if(z===S.y)return S;if(z===S.next.y)return S.next}x=S.x<S.next.x?S:S.next}}S=S.next}while(S!==d);if(!x)return null;if(P===J)return x;var ue,ye=x,Se=x.x,qe=x.y,Je=1/0;S=x;do{P>=S.x&&S.x>=Se&&P!==S.x&&Jc(z<qe?P:J,z,Se,qe,z<qe?J:P,z,S.x,S.y)&&(ue=Math.abs(z-S.y)/(P-S.x),Bc(S,f)&&(ue<Je||ue===Je&&(S.x>x.x||S.x===x.x&&Ep(x,S)))&&(x=S,Je=ue)),S=S.next}while(S!==ye);return x}(e,t)){var r=pf(t,e);ll(t,t.next),ll(r,r.next)}}function Ep(e,t){return Eo(e.prev,e,t.prev)<0&&Eo(t.next,e,e.next)<0}function Sh(e,t,r,f,d){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*d)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-f)*d)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function tp(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Jc(e,t,r,f,d,x,S,P){return(d-S)*(t-P)-(e-S)*(x-P)>=0&&(e-S)*(f-P)-(r-S)*(t-P)>=0&&(r-S)*(x-P)-(d-S)*(f-P)>=0}function Tp(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,f){var d=r;do{if(d.i!==r.i&&d.next.i!==r.i&&d.i!==f.i&&d.next.i!==f.i&&wh(d,d.next,r,f))return!0;d=d.next}while(d!==r);return!1}(e,t)&&(Bc(e,t)&&Bc(t,e)&&function(r,f){var d=r,x=!1,S=(r.x+f.x)/2,P=(r.y+f.y)/2;do{d.y>P!=d.next.y>P&&d.next.y!==d.y&&S<(d.next.x-d.x)*(P-d.y)/(d.next.y-d.y)+d.x&&(x=!x),d=d.next}while(d!==r);return x}(e,t)&&(Eo(e.prev,e,t.prev)||Eo(e,t.prev,t))||pc(e,t)&&Eo(e.prev,e,e.next)>0&&Eo(t.prev,t,t.next)>0)}function Eo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function pc(e,t){return e.x===t.x&&e.y===t.y}function wh(e,t,r,f){var d=$c(Eo(e,t,r)),x=$c(Eo(e,t,f)),S=$c(Eo(r,f,e)),P=$c(Eo(r,f,t));return d!==x&&S!==P||!(0!==d||!Af(e,r,t))||!(0!==x||!Af(e,f,t))||!(0!==S||!Af(r,e,f))||!(0!==P||!Af(r,t,f))}function Af(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function $c(e){return e>0?1:e<0?-1:0}function Bc(e,t){return Eo(e.prev,e,e.next)<0?Eo(e,t,e.next)>=0&&Eo(e,e.prev,t)>=0:Eo(e,t,e.prev)<0||Eo(e,e.next,t)<0}function pf(e,t){var r=new df(e.i,e.x,e.y),f=new df(t.i,t.x,t.y),d=e.next,x=t.prev;return e.next=t,t.prev=e,r.next=d,d.prev=r,f.next=r,r.prev=f,x.next=f,f.prev=x,f}function Pf(e,t,r,f){var d=new df(e,t,r);return f?(d.next=f.next,d.prev=f,f.next.prev=d,f.next=d):(d.prev=d,d.next=d),d}function Fc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function df(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Iu(e,t,r,f){for(var d=0,x=t,S=r-f;x<r;x+=f)d+=(e[S]-e[x])*(e[x+1]+e[S+1]),S=x;return d}function Kf(e,t,r,f,d){!function x(S,P,z,J,ee){for(;J>z;){if(J-z>600){var ue=J-z+1,ye=P-z+1,Se=Math.log(ue),qe=.5*Math.exp(2*Se/3),Je=.5*Math.sqrt(Se*qe*(ue-qe)/ue)*(ye-ue/2<0?-1:1);x(S,P,Math.max(z,Math.floor(P-ye*qe/ue+Je)),Math.min(J,Math.floor(P+(ue-ye)*qe/ue+Je)),ee)}var Tt=S[P],st=z,Nt=J;for(Cl(S,z,P),ee(S[J],Tt)>0&&Cl(S,z,J);st<Nt;){for(Cl(S,st,Nt),st++,Nt--;ee(S[st],Tt)<0;)st++;for(;ee(S[Nt],Tt)>0;)Nt--}0===ee(S[z],Tt)?Cl(S,z,Nt):Cl(S,++Nt,J),Nt<=P&&(z=Nt+1),P<=Nt&&(J=Nt-1)}}(e,t,r||0,f||e.length-1,d||Eh)}function Cl(e,t,r){var f=e[t];e[t]=e[r],e[r]=f}function Eh(e,t){return e<t?-1:e>t?1:0}function If(e,t){var r=e.length;if(r<=1)return[e];for(var f,d,x=[],S=0;S<r;S++){var P=kt(e[S]);0!==P&&(e[S].area=Math.abs(P),void 0===d&&(d=P<0),d===P<0?(f&&x.push(f),f=[e[S]]):f.push(e[S]))}if(f&&x.push(f),t>1)for(var z=0;z<x.length;z++)x[z].length<=t||(Kf(x[z],t,1,x[z].length-1,Mf),x[z]=x[z].slice(0,t));return x}function Mf(e,t){return t.area-e.area}function Qc(e,t,r){for(var f=r.patternDependencies,d=!1,x=0,S=t;x<S.length;x+=1){var P=S[x].paint.get(e+"-pattern");P.isConstant()||(d=!0);var z=P.constantOr(null);z&&(d=!0,f[z.to]=!0,f[z.from]=!0)}return d}function vf(e,t,r,f,d){for(var x=d.patternDependencies,S=0,P=t;S<P.length;S+=1){var z=P[S],J=z.paint.get(e+"-pattern").value;if("constant"!==J.kind){var ee=J.evaluate({zoom:f-1},r,{},d.availableImages),ue=J.evaluate({zoom:f},r,{},d.availableImages),ye=J.evaluate({zoom:f+1},r,{},d.availableImages);ue=ue&&ue.name?ue.name:ue,ye=ye&&ye.name?ye.name:ye,x[ee=ee&&ee.name?ee.name:ee]=!0,x[ue]=!0,x[ye]=!0,r.patterns[z.id]={min:ee,mid:ue,max:ye}}}return r}Cf.deviation=function(e,t,r,f){var d=t&&t.length,x=Math.abs(Iu(e,0,d?t[0]*r:e.length,r));if(d)for(var S=0,P=t.length;S<P;S++)x-=Math.abs(Iu(e,t[S]*r,S<P-1?t[S+1]*r:e.length,r));var z=0;for(S=0;S<f.length;S+=3){var J=f[S]*r,ee=f[S+1]*r,ue=f[S+2]*r;z+=Math.abs((e[J]-e[ue])*(e[ee+1]-e[J+1])-(e[J]-e[ee])*(e[ue+1]-e[J+1]))}return 0===x&&0===z?0:Math.abs((z-x)/x)},Cf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},f=0,d=0;d<e.length;d++){for(var x=0;x<e[d].length;x++)for(var S=0;S<t;S++)r.vertices.push(e[d][x][S]);d>0&&r.holes.push(f+=e[d-1].length)}return r},hc.default=wp;var Ns=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new As,this.indexArray=new sl,this.indexArray2=new cc,this.programConfigurations=new ne(e.layers,e.zoom),this.segments=new Ie,this.segments2=new Ie,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ns.prototype.populate=function(e,t,r){this.hasPattern=Qc("fill",this.layers,t);for(var f=this.layers[0].layout.get("fill-sort-key"),d=[],x=0,S=e;x<S.length;x+=1){var P=S[x],z=P.feature,J=P.id,ee=P.index,ue=P.sourceLayerIndex,ye=this.layers[0]._featureFilter.needGeometry,Se=Rt(z,ye);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),Se,r)){var qe=f?f.evaluate(Se,{},r,t.availableImages):void 0,Je={id:J,properties:z.properties,type:z.type,sourceLayerIndex:ue,index:ee,geometry:ye?Se.geometry:vt(z),patterns:{},sortKey:qe};d.push(Je)}}f&&d.sort(function(nn,gn){return nn.sortKey-gn.sortKey});for(var Tt=0,st=d;Tt<st.length;Tt+=1){var Nt=st[Tt],Qt=Nt.geometry,gr=Nt.index,xr=Nt.sourceLayerIndex;if(this.hasPattern){var Rr=vf("fill",this.layers,Nt,this.zoom,t);this.patternFeatures.push(Rr)}else this.addFeature(Nt,Qt,gr,r,{});t.featureIndex.insert(e[gr].feature,Qt,gr,xr,this.index)}},Ns.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ns.prototype.addFeatures=function(e,t,r){for(var f=0,d=this.patternFeatures;f<d.length;f+=1){var x=d[f];this.addFeature(x,x.geometry,x.index,t,r)}},Ns.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ns.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ns.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Dc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ns.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ns.prototype.addFeature=function(e,t,r,f,d){for(var x=0,S=If(t,500);x<S.length;x+=1){for(var P=S[x],z=0,J=0,ee=P;J<ee.length;J+=1)z+=ee[J].length;for(var ue=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray),ye=ue.vertexLength,Se=[],qe=[],Je=0,Tt=P;Je<Tt.length;Je+=1){var st=Tt[Je];if(0!==st.length){st!==P[0]&&qe.push(Se.length/2);var Nt=this.segments2.prepareSegment(st.length,this.layoutVertexArray,this.indexArray2),Qt=Nt.vertexLength;this.layoutVertexArray.emplaceBack(st[0].x,st[0].y),this.indexArray2.emplaceBack(Qt+st.length-1,Qt),Se.push(st[0].x),Se.push(st[0].y);for(var gr=1;gr<st.length;gr++)this.layoutVertexArray.emplaceBack(st[gr].x,st[gr].y),this.indexArray2.emplaceBack(Qt+gr-1,Qt+gr),Se.push(st[gr].x),Se.push(st[gr].y);Nt.vertexLength+=st.length,Nt.primitiveLength+=st.length}}for(var xr=hc(Se,qe),Rr=0;Rr<xr.length;Rr+=3)this.indexArray.emplaceBack(ye+xr[Rr],ye+xr[Rr+1],ye+xr[Rr+2]);ue.vertexLength+=z,ue.primitiveLength+=xr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,f)},Nn("FillBucket",Ns,{omit:["layers","patternFeatures"]});var Yf=new Po({"fill-sort-key":new In(fe.layout_fill["fill-sort-key"])}),_s={paint:new Po({"fill-antialias":new ri(fe.paint_fill["fill-antialias"]),"fill-opacity":new In(fe.paint_fill["fill-opacity"]),"fill-color":new In(fe.paint_fill["fill-color"]),"fill-outline-color":new In(fe.paint_fill["fill-outline-color"]),"fill-translate":new ri(fe.paint_fill["fill-translate"]),"fill-translate-anchor":new ri(fe.paint_fill["fill-translate-anchor"]),"fill-pattern":new lc(fe.paint_fill["fill-pattern"])}),layout:Yf},ql=function(e){function t(r){e.call(this,r,_s)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,f){e.prototype.recalculate.call(this,r,f);var d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Ns(r)},t.prototype.queryRadius=function(){return ia(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,f,d,x,S,P,z){return Xn(ga(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),P.angle,z),x)},t.prototype.isTileClipped=function(){return!0},t}(fo),mf=zo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ef=Js;function Js(e,t,r,f,d){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=f,this._values=d,e.readFields(Of,this,t)}function Of(e,t,r){1==e?t.id=r.readVarint():2==e?function(f,d){for(var x=f.readVarint()+f.pos;f.pos<x;){var S=d._keys[f.readVarint()],P=d._values[f.readVarint()];d.properties[S]=P}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function qf(e){for(var t,r,f=0,d=0,x=e.length,S=x-1;d<x;S=d++)f+=((r=e[S]).x-(t=e[d]).x)*(t.y+r.y);return f}Js.types=["Unknown","Point","LineString","Polygon"],Js.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,f=1,d=0,x=0,S=0,P=[];e.pos<r;){if(d<=0){var z=e.readVarint();f=7&z,d=z>>3}if(d--,1===f||2===f)x+=e.readSVarint(),S+=e.readSVarint(),1===f&&(t&&P.push(t),t=[]),t.push(new B(x,S));else{if(7!==f)throw new Error("unknown command "+f);t&&t.push(t[0].clone())}}return t&&P.push(t),P},Js.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,f=0,d=0,x=0,S=1/0,P=-1/0,z=1/0,J=-1/0;e.pos<t;){if(f<=0){var ee=e.readVarint();r=7&ee,f=ee>>3}if(f--,1===r||2===r)(d+=e.readSVarint())<S&&(S=d),d>P&&(P=d),(x+=e.readSVarint())<z&&(z=x),x>J&&(J=x);else if(7!==r)throw new Error("unknown command "+r)}return[S,z,P,J]},Js.prototype.toGeoJSON=function(e,t,r){var f,d,x=this.extent*Math.pow(2,r),S=this.extent*e,P=this.extent*t,z=this.loadGeometry(),J=Js.types[this.type];function ee(Se){for(var qe=0;qe<Se.length;qe++){var Je=Se[qe];Se[qe]=[360*(Je.x+S)/x-180,360/Math.PI*Math.atan(Math.exp((180-360*(Je.y+P)/x)*Math.PI/180))-90]}}switch(this.type){case 1:var ue=[];for(f=0;f<z.length;f++)ue[f]=z[f][0];ee(z=ue);break;case 2:for(f=0;f<z.length;f++)ee(z[f]);break;case 3:for(z=function(Se){var qe=Se.length;if(qe<=1)return[Se];for(var Je,Tt,st=[],Nt=0;Nt<qe;Nt++){var Qt=qf(Se[Nt]);0!==Qt&&(void 0===Tt&&(Tt=Qt<0),Tt===Qt<0?(Je&&st.push(Je),Je=[Se[Nt]]):Je.push(Se[Nt]))}return Je&&st.push(Je),st}(z),f=0;f<z.length;f++)for(d=0;d<z[f].length;d++)ee(z[f][d])}1===z.length?z=z[0]:J="Multi"+J;var ye={type:"Feature",geometry:{type:J,coordinates:z},properties:this.properties};return"id"in this&&(ye.id=this.id),ye};var Cp=rp;function rp(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(tf,this,t),this.length=this._features.length}function tf(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(f){for(var d=null,x=f.readVarint()+f.pos;f.pos<x;){var S=f.readVarint()>>3;d=1===S?f.readString():2===S?f.readFloat():3===S?f.readDouble():4===S?f.readVarint64():5===S?f.readVarint():6===S?f.readSVarint():7===S?f.readBoolean():null}return d}(r))}function rf(e,t,r){if(3===e){var f=new Cp(r,r.readVarint()+r.pos);f.length&&(t[f.name]=f)}}rp.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ef(this._pbf,t,this.extent,this._keys,this._values)};var gf={VectorTile:function(e,t){this.layers=e.readFields(rf,{},t)},VectorTileFeature:ef,VectorTileLayer:Cp},Th=gf.VectorTileFeature.types,Jf=Math.pow(2,13);function lu(e,t,r,f,d,x,S,P){e.emplaceBack(t,r,2*Math.floor(f*Jf)+S,d*Jf*2,x*Jf*2,Math.round(P))}var Ps=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ys,this.indexArray=new sl,this.programConfigurations=new ne(e.layers,e.zoom),this.segments=new Ie,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Nc(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ps.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Qc("fill-extrusion",this.layers,t);for(var f=0,d=e;f<d.length;f+=1){var x=d[f],S=x.feature,P=x.id,z=x.index,J=x.sourceLayerIndex,ee=this.layers[0]._featureFilter.needGeometry,ue=Rt(S,ee);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),ue,r)){var ye={id:P,sourceLayerIndex:J,index:z,geometry:ee?ue.geometry:vt(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(vf("fill-extrusion",this.layers,ye,this.zoom,t)):this.addFeature(ye,ye.geometry,z,r,{}),t.featureIndex.insert(S,ye.geometry,z,J,this.index,!0)}}},Ps.prototype.addFeatures=function(e,t,r){for(var f=0,d=this.features;f<d.length;f+=1){var x=d[f];this.addFeature(x,x.geometry,x.index,t,r)}},Ps.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ps.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ps.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mf),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ps.prototype.addFeature=function(e,t,r,f,d){for(var x=0,S=If(t,500);x<S.length;x+=1){for(var P=S[x],z=0,J=0,ee=P;J<ee.length;J+=1)z+=ee[J].length;for(var ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ye=0,Se=P;ye<Se.length;ye+=1){var qe=Se[ye];if(0!==qe.length&&!((da=qe).every(function(Yi){return Yi.x<0})||da.every(function(Yi){return Yi.x>8192})||da.every(function(Yi){return Yi.y<0})||da.every(function(Yi){return Yi.y>8192})))for(var Je=0,Tt=0;Tt<qe.length;Tt++){var st=qe[Tt];if(Tt>=1){var Nt=qe[Tt-1];if(!Nc(st,Nt)){ue.vertexLength+4>Ie.MAX_VERTEX_ARRAY_LENGTH&&(ue=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Qt=st.sub(Nt)._perp()._unit(),gr=Nt.dist(st);Je+gr>32768&&(Je=0),lu(this.layoutVertexArray,st.x,st.y,Qt.x,Qt.y,0,0,Je),lu(this.layoutVertexArray,st.x,st.y,Qt.x,Qt.y,0,1,Je),lu(this.layoutVertexArray,Nt.x,Nt.y,Qt.x,Qt.y,0,0,Je+=gr),lu(this.layoutVertexArray,Nt.x,Nt.y,Qt.x,Qt.y,0,1,Je);var xr=ue.vertexLength;this.indexArray.emplaceBack(xr,xr+2,xr+1),this.indexArray.emplaceBack(xr+1,xr+2,xr+3),ue.vertexLength+=4,ue.primitiveLength+=2}}}}if(ue.vertexLength+z>Ie.MAX_VERTEX_ARRAY_LENGTH&&(ue=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),"Polygon"===Th[e.type]){for(var Rr=[],nn=[],gn=ue.vertexLength,ii=0,Fn=P;ii<Fn.length;ii+=1){var fi=Fn[ii];if(0!==fi.length){fi!==P[0]&&nn.push(Rr.length/2);for(var Zn=0;Zn<fi.length;Zn++){var na=fi[Zn];lu(this.layoutVertexArray,na.x,na.y,0,0,1,1,0),Rr.push(na.x),Rr.push(na.y)}}}for(var wi=hc(Rr,nn),Qn=0;Qn<wi.length;Qn+=3)this.indexArray.emplaceBack(gn+wi[Qn],gn+wi[Qn+2],gn+wi[Qn+1]);ue.primitiveLength+=wi.length/3,ue.vertexLength+=z}}var da;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,f)},Nn("FillExtrusionBucket",Ps,{omit:["layers","features"]});var Mu={paint:new Po({"fill-extrusion-opacity":new ri(fe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new In(fe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ri(fe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ri(fe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lc(fe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new In(fe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new In(fe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ri(fe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Ch=function(e){function t(r){e.call(this,r,Mu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Ps(r)},t.prototype.queryRadius=function(){return ia(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,f,d,x,S,P,z,J){var ee=ga(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),P.angle,z),ue=this.paint.get("fill-extrusion-height").evaluate(f,d),ye=this.paint.get("fill-extrusion-base").evaluate(f,d),Se=function(Je,Tt,st,Nt){for(var Qt=[],gr=0,xr=Je;gr<xr.length;gr+=1){var Rr=xr[gr],nn=[Rr.x,Rr.y,0,1];uu(nn,nn,Tt),Qt.push(new B(nn[0]/nn[3],nn[1]/nn[3]))}return Qt}(ee,J),qe=function(Je,Tt,st,Nt){for(var Qt=[],gr=[],xr=Nt[8]*Tt,Rr=Nt[9]*Tt,nn=Nt[10]*Tt,gn=Nt[11]*Tt,ii=Nt[8]*st,Fn=Nt[9]*st,fi=Nt[10]*st,Zn=Nt[11]*st,na=0,wi=Je;na<wi.length;na+=1){for(var Qn=[],da=[],Yi=0,Aa=wi[na];Yi<Aa.length;Yi+=1){var di=Aa[Yi],Ra=di.x,Co=di.y,Ao=Nt[0]*Ra+Nt[4]*Co+Nt[12],Do=Nt[1]*Ra+Nt[5]*Co+Nt[13],ho=Nt[2]*Ra+Nt[6]*Co+Nt[14],Oo=Nt[3]*Ra+Nt[7]*Co+Nt[15],xs=ho+nn,bs=Oo+gn,fu=Ao+ii,Ms=Do+Fn,hu=ho+fi,Bo=Oo+Zn,Os=new B((Ao+xr)/bs,(Do+Rr)/bs);Os.z=xs/bs,Qn.push(Os);var Sa=new B(fu/Bo,Ms/Bo);Sa.z=hu/Bo,da.push(Sa)}Qt.push(Qn),gr.push(da)}return[Qt,gr]}(x,ye,ue,J);return function(Je,Tt,st){var Nt=1/0;Xn(st,Tt)&&(Nt=Jl(st,Tt[0]));for(var Qt=0;Qt<Tt.length;Qt++)for(var gr=Tt[Qt],xr=Je[Qt],Rr=0;Rr<gr.length-1;Rr++){var nn=gr[Rr],gn=[nn,gr[Rr+1],xr[Rr+1],xr[Rr],nn];Vr(st,gn)&&(Nt=Math.min(Nt,Jl(st,gn)))}return Nt!==1/0&&Nt}(qe[0],qe[1],Se)},t}(fo);function Al(e,t){return e.x*t.x+e.y*t.y}function Jl(e,t){if(1===e.length){for(var r,f=0,d=t[f++];!r||d.equals(r);)if(!(r=t[f++]))return 1/0;for(;f<t.length;f++){var x=t[f],S=e[0],P=r.sub(d),z=x.sub(d),J=S.sub(d),ee=Al(P,P),ue=Al(P,z),ye=Al(z,z),Se=Al(J,P),qe=Al(J,z),Je=ee*ye-ue*ue,Tt=(ye*Se-ue*qe)/Je,st=(ee*qe-ue*Se)/Je,Nt=d.z*(1-Tt-st)+r.z*Tt+x.z*st;if(isFinite(Nt))return Nt}return 1/0}for(var Qt=1/0,gr=0,xr=t;gr<xr.length;gr+=1)Qt=Math.min(Qt,xr[gr].z);return Qt}var Ah=zo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,$f=zo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,yf=gf.VectorTileFeature.types,Lf=Math.cos(Math.PI/180*37.5),as=Math.pow(2,14)/.5,Zo=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){t.gradients[r.id]={}}),this.layoutVertexArray=new is,this.layoutVertexArray2=new al,this.indexArray=new sl,this.programConfigurations=new ne(e.layers,e.zoom),this.segments=new Ie,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Zo.prototype.populate=function(e,t,r){this.hasPattern=Qc("line",this.layers,t);for(var f=this.layers[0].layout.get("line-sort-key"),d=[],x=0,S=e;x<S.length;x+=1){var P=S[x],z=P.feature,J=P.id,ee=P.index,ue=P.sourceLayerIndex,ye=this.layers[0]._featureFilter.needGeometry,Se=Rt(z,ye);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),Se,r)){var qe=f?f.evaluate(Se,{},r):void 0,Je={id:J,properties:z.properties,type:z.type,sourceLayerIndex:ue,index:ee,geometry:ye?Se.geometry:vt(z),patterns:{},sortKey:qe};d.push(Je)}}f&&d.sort(function(nn,gn){return nn.sortKey-gn.sortKey});for(var Tt=0,st=d;Tt<st.length;Tt+=1){var Nt=st[Tt],Qt=Nt.geometry,gr=Nt.index,xr=Nt.sourceLayerIndex;if(this.hasPattern){var Rr=vf("line",this.layers,Nt,this.zoom,t);this.patternFeatures.push(Rr)}else this.addFeature(Nt,Qt,gr,r,{});t.featureIndex.insert(e[gr].feature,Qt,gr,xr,this.index)}},Zo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Zo.prototype.addFeatures=function(e,t,r){for(var f=0,d=this.patternFeatures;f<d.length;f+=1){var x=d[f];this.addFeature(x,x.geometry,x.index,t,r)}},Zo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Zo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zo.prototype.upload=function(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,$f)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ah),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Zo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zo.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Zo.prototype.addFeature=function(e,t,r,f,d){var x=this.layers[0].layout,S=x.get("line-join").evaluate(e,{}),P=x.get("line-cap"),z=x.get("line-miter-limit"),J=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var ee=0,ue=t;ee<ue.length;ee+=1)this.addLine(ue[ee],e,S,P,z,J);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,f)},Zo.prototype.addLine=function(e,t,r,f,d,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var S=0;S<e.length-1;S++)this.totalDistance+=e[S].dist(e[S+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var P="Polygon"===yf[t.type],z=e.length;z>=2&&e[z-1].equals(e[z-2]);)z--;for(var J=0;J<z-1&&e[J].equals(e[J+1]);)J++;if(!(z<(P?3:2))){"bevel"===r&&(d=1.05);var ee,ue=this.overscaling<=16?122880/(512*this.overscaling):0,ye=this.segments.prepareSegment(10*z,this.layoutVertexArray,this.indexArray),Se=void 0,qe=void 0,Je=void 0,Tt=void 0;this.e1=this.e2=-1,P&&(Tt=e[J].sub(ee=e[z-2])._unit()._perp());for(var st=J;st<z;st++)if(!(qe=st===z-1?P?e[J+1]:void 0:e[st+1])||!e[st].equals(qe)){Tt&&(Je=Tt),ee&&(Se=ee),ee=e[st],Tt=qe?qe.sub(ee)._unit()._perp():Je;var Nt=(Je=Je||Tt).add(Tt);0===Nt.x&&0===Nt.y||Nt._unit();var Qt=Je.x*Tt.x+Je.y*Tt.y,gr=Nt.x*Tt.x+Nt.y*Tt.y,xr=0!==gr?1/gr:1/0,Rr=2*Math.sqrt(2-2*gr),nn=gr<Lf&&Se&&qe,gn=Je.x*Tt.y-Je.y*Tt.x>0;if(nn&&st>J){var ii=ee.dist(Se);if(ii>2*ue){var Fn=ee.sub(ee.sub(Se)._mult(ue/ii)._round());this.updateDistance(Se,Fn),this.addCurrentVertex(Fn,Je,0,0,ye),Se=Fn}}var fi=Se&&qe,Zn=fi?r:P?"butt":f;if(fi&&"round"===Zn&&(xr<x?Zn="miter":xr<=2&&(Zn="fakeround")),"miter"===Zn&&xr>d&&(Zn="bevel"),"bevel"===Zn&&(xr>2&&(Zn="flipbevel"),xr<d&&(Zn="miter")),Se&&this.updateDistance(Se,ee),"miter"===Zn)Nt._mult(xr),this.addCurrentVertex(ee,Nt,0,0,ye);else if("flipbevel"===Zn){if(xr>100)Nt=Tt.mult(-1);else{var na=xr*Je.add(Tt).mag()/Je.sub(Tt).mag();Nt._perp()._mult(na*(gn?-1:1))}this.addCurrentVertex(ee,Nt,0,0,ye),this.addCurrentVertex(ee,Nt.mult(-1),0,0,ye)}else if("bevel"===Zn||"fakeround"===Zn){var wi=-Math.sqrt(xr*xr-1),Qn=gn?wi:0,da=gn?0:wi;if(Se&&this.addCurrentVertex(ee,Je,Qn,da,ye),"fakeround"===Zn)for(var Yi=Math.round(180*Rr/Math.PI/20),Aa=1;Aa<Yi;Aa++){var di=Aa/Yi;if(.5!==di){var Ra=di-.5;di+=di*Ra*(di-1)*((1.0904+Qt*(Qt*(3.55645-1.43519*Qt)-3.2452))*Ra*Ra+(.848013+Qt*(.215638*Qt-1.06021)))}var Co=Tt.sub(Je)._mult(di)._add(Je)._unit()._mult(gn?-1:1);this.addHalfVertex(ee,Co.x,Co.y,!1,gn,0,ye)}qe&&this.addCurrentVertex(ee,Tt,-Qn,-da,ye)}else if("butt"===Zn)this.addCurrentVertex(ee,Nt,0,0,ye);else if("square"===Zn){var Ao=Se?1:-1;this.addCurrentVertex(ee,Nt,Ao,Ao,ye)}else"round"===Zn&&(Se&&(this.addCurrentVertex(ee,Je,0,0,ye),this.addCurrentVertex(ee,Je,1,1,ye,!0)),qe&&(this.addCurrentVertex(ee,Tt,-1,-1,ye,!0),this.addCurrentVertex(ee,Tt,0,0,ye)));if(nn&&st<z-1){var Do=ee.dist(qe);if(Do>2*ue){var ho=ee.add(qe.sub(ee)._mult(ue/Do)._round());this.updateDistance(ee,ho),this.addCurrentVertex(ho,Tt,0,0,ye),ee=ho}}}}},Zo.prototype.addCurrentVertex=function(e,t,r,f,d,x){void 0===x&&(x=!1);var S=t.y*f-t.x,P=-t.y-t.x*f;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,x,!1,r,d),this.addHalfVertex(e,S,P,x,!0,-f,d),this.distance>as/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,t,r,f,d,x))},Zo.prototype.addHalfVertex=function(e,t,r,f,d,x,S){var P=.5*(this.lineClips?this.scaledDistance*(as-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(f?1:0),(e.y<<1)+(d?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(0===x?0:x<0?-1:1)|(63&P)<<2,P>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var z=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),S.primitiveLength++),d?this.e2=z:this.e1=z},Zo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Zo.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Nn("LineBucket",Zo,{omit:["layers","patternFeatures"]});var os=new Po({"line-cap":new ri(fe.layout_line["line-cap"]),"line-join":new In(fe.layout_line["line-join"]),"line-miter-limit":new ri(fe.layout_line["line-miter-limit"]),"line-round-limit":new ri(fe.layout_line["line-round-limit"]),"line-sort-key":new In(fe.layout_line["line-sort-key"])}),cu={paint:new Po({"line-opacity":new In(fe.paint_line["line-opacity"]),"line-color":new In(fe.paint_line["line-color"]),"line-translate":new ri(fe.paint_line["line-translate"]),"line-translate-anchor":new ri(fe.paint_line["line-translate-anchor"]),"line-width":new In(fe.paint_line["line-width"]),"line-gap-width":new In(fe.paint_line["line-gap-width"]),"line-offset":new In(fe.paint_line["line-offset"]),"line-blur":new In(fe.paint_line["line-blur"]),"line-dasharray":new wo(fe.paint_line["line-dasharray"]),"line-pattern":new lc(fe.paint_line["line-pattern"]),"line-gradient":new Xs(fe.paint_line["line-gradient"])}),layout:os},Ph=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,f){return f=new $i(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),e.prototype.possiblyEvaluate.call(this,r,f)},t.prototype.evaluate=function(r,f,d,x){return f=xt({},f,{zoom:Math.floor(f.zoom)}),e.prototype.evaluate.call(this,r,f,d,x)},t}(In))(cu.paint.properties["line-width"].specification);Ph.useIntegerZoom=!0;var Ap=function(e){function t(r){e.call(this,r,cu),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){"line-gradient"===r&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof gs,this.gradientVersion=(this.gradientVersion+1)%be)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,f){e.prototype.recalculate.call(this,r,f),this.paint._values["line-floorwidth"]=Ph.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Zo(r)},t.prototype.queryRadius=function(r){var f=r,d=np(Ya("line-width",this,f),Ya("line-gap-width",this,f)),x=Ya("line-offset",this,f);return d/2+Math.abs(x)+ia(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,f,d,x,S,P,z){var J=ga(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),P.angle,z),ee=z/2*np(this.paint.get("line-width").evaluate(f,d),this.paint.get("line-gap-width").evaluate(f,d)),ue=this.paint.get("line-offset").evaluate(f,d);return ue&&(x=function(ye,Se){for(var qe=[],Je=new B(0,0),Tt=0;Tt<ye.length;Tt++){for(var st=ye[Tt],Nt=[],Qt=0;Qt<st.length;Qt++){var gr=st[Qt],xr=st[Qt+1],Rr=0===Qt?Je:gr.sub(st[Qt-1])._unit()._perp(),nn=Qt===st.length-1?Je:xr.sub(gr)._unit()._perp(),gn=Rr._add(nn)._unit();gn._mult(1/(gn.x*nn.x+gn.y*nn.y)),Nt.push(gn._mult(Se)._add(gr))}qe.push(Nt)}return qe}(x,ue*z)),function(ye,Se,qe){for(var Je=0;Je<Se.length;Je++){var Tt=Se[Je];if(ye.length>=3)for(var st=0;st<Tt.length;st++)if(Ha(ye,Tt[st]))return!0;if(ni(ye,Tt,qe))return!0}return!1}(J,x,ee)},t.prototype.isTileClipped=function(){return!0},t}(fo);function np(e,t){return t>0?t+2*e:e}var $p=zo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Qp=zo([{name:"a_projected_pos",components:3,type:"Float32"}],4),Pp=(zo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),zo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Ip=(zo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),zo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Mp=zo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ed(e,t,r){return e.sections.forEach(function(f){var d,S,P;f.text=(d=f.text,S=r,"uppercase"===(P=t.layout.get("text-transform").evaluate(S,{}))?d=d.toLocaleUpperCase():"lowercase"===P&&(d=d.toLocaleLowerCase()),Cs.applyArabicShaping&&(d=Cs.applyArabicShaping(d)),d)}),e}zo([{name:"triangle",components:3,type:"Uint16"}]),zo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),zo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),zo([{type:"Float32",name:"offsetX"}]),zo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var kf={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Op=function(e,t,r,f,d){var x,S,P=8*d-f-1,z=(1<<P)-1,J=z>>1,ee=-7,ue=r?d-1:0,ye=r?-1:1,Se=e[t+ue];for(ue+=ye,x=Se&(1<<-ee)-1,Se>>=-ee,ee+=P;ee>0;x=256*x+e[t+ue],ue+=ye,ee-=8);for(S=x&(1<<-ee)-1,x>>=-ee,ee+=f;ee>0;S=256*S+e[t+ue],ue+=ye,ee-=8);if(0===x)x=1-J;else{if(x===z)return S?NaN:1/0*(Se?-1:1);S+=Math.pow(2,f),x-=J}return(Se?-1:1)*S*Math.pow(2,x-f)},Ih=function(e,t,r,f,d,x){var S,P,z,J=8*x-d-1,ee=(1<<J)-1,ue=ee>>1,ye=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,Se=f?0:x-1,qe=f?1:-1,Je=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(P=isNaN(t)?1:0,S=ee):(S=Math.floor(Math.log(t)/Math.LN2),t*(z=Math.pow(2,-S))<1&&(S--,z*=2),(t+=S+ue>=1?ye/z:ye*Math.pow(2,1-ue))*z>=2&&(S++,z/=2),S+ue>=ee?(P=0,S=ee):S+ue>=1?(P=(t*z-1)*Math.pow(2,d),S+=ue):(P=t*Math.pow(2,ue-1)*Math.pow(2,d),S=0));d>=8;e[r+Se]=255&P,Se+=qe,P/=256,d-=8);for(S=S<<d|P,J+=d;J>0;e[r+Se]=255&S,Se+=qe,S/=256,J-=8);e[r+Se-qe]|=128*Je},zc=io;function io(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}io.Varint=0,io.Fixed64=1,io.Bytes=2,io.Fixed32=5;var ip="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function dc(e){return e.type===io.Bytes?e.readVarint()+e.pos:e.pos+1}function ap(e,t,r){var f=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(f);for(var d=r.pos-1;d>=e;d--)r.buf[d+f]=r.buf[d]}function q(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function De(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function it(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function lr(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function kr(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function sr(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Cr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Ur(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Gr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Yr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function qr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function en(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function pn(e,t,r){1===e&&r.readMessage(Hr,t)}function Hr(e,t,r){if(3===e){var f=r.readMessage(tn,{}),d=f.width,x=f.height,S=f.left,P=f.top,z=f.advance;t.push({id:f.id,bitmap:new Wu({width:d+6,height:x+6},f.bitmap),metrics:{width:d,height:x,left:S,top:P,advance:z}})}}function tn(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function Zt(e){for(var t=0,r=0,f=0,d=e;f<d.length;f+=1){var x=d[f];t+=x.w*x.h,r=Math.max(r,x.w)}e.sort(function(Je,Tt){return Tt.h-Je.h});for(var S=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],P=0,z=0,J=0,ee=e;J<ee.length;J+=1)for(var ue=ee[J],ye=S.length-1;ye>=0;ye--){var Se=S[ye];if(!(ue.w>Se.w||ue.h>Se.h)){if(ue.x=Se.x,ue.y=Se.y,z=Math.max(z,ue.y+ue.h),P=Math.max(P,ue.x+ue.w),ue.w===Se.w&&ue.h===Se.h){var qe=S.pop();ye<S.length&&(S[ye]=qe)}else ue.h===Se.h?(Se.x+=ue.w,Se.w-=ue.w):ue.w===Se.w?(Se.y+=ue.h,Se.h-=ue.h):(S.push({x:Se.x+ue.w,y:Se.y,w:Se.w-ue.w,h:ue.h}),Se.y+=ue.h,Se.h-=ue.h);break}}return{w:P,h:z,fill:t/(P*z)||0}}io.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var f=this.readVarint(),d=f>>3,x=this.pos;this.type=7&f,e(d,t,this),this.pos===x&&this.skip(f)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Yr(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=en(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Yr(this.buf,this.pos)+4294967296*Yr(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Yr(this.buf,this.pos)+4294967296*en(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Op(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Op(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,f=this.buf;return t=127&(r=f[this.pos++]),r<128?t:(t|=(127&(r=f[this.pos++]))<<7,r<128?t:(t|=(127&(r=f[this.pos++]))<<14,r<128?t:(t|=(127&(r=f[this.pos++]))<<21,r<128?t:function(d,x,S){var P,z,J=S.buf;if(P=(112&(z=J[S.pos++]))>>4,z<128||(P|=(127&(z=J[S.pos++]))<<3,z<128)||(P|=(127&(z=J[S.pos++]))<<10,z<128)||(P|=(127&(z=J[S.pos++]))<<17,z<128)||(P|=(127&(z=J[S.pos++]))<<24,z<128)||(P|=(1&(z=J[S.pos++]))<<31,z<128))return function(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}(d,P,x);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=f[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ip?ip.decode(this.buf.subarray(t,e)):function(r,f,d){for(var x="",S=f;S<d;){var P,z,J,ee=r[S],ue=null,ye=ee>239?4:ee>223?3:ee>191?2:1;if(S+ye>d)break;1===ye?ee<128&&(ue=ee):2===ye?128==(192&(P=r[S+1]))&&(ue=(31&ee)<<6|63&P)<=127&&(ue=null):3===ye?(z=r[S+2],128==(192&(P=r[S+1]))&&128==(192&z)&&((ue=(15&ee)<<12|(63&P)<<6|63&z)<=2047||ue>=55296&&ue<=57343)&&(ue=null)):4===ye&&(z=r[S+2],J=r[S+3],128==(192&(P=r[S+1]))&&128==(192&z)&&128==(192&J)&&((ue=(15&ee)<<18|(63&P)<<12|(63&z)<<6|63&J)<=65535||ue>=1114112)&&(ue=null)),null===ue?(ue=65533,ye=1):ue>65535&&(ue-=65536,x+=String.fromCharCode(ue>>>10&1023|55296),ue=56320|1023&ue),x+=String.fromCharCode(ue),S+=ye}return x}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==io.Bytes)return e.push(this.readVarint(t));var r=dc(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==io.Bytes)return e.push(this.readSVarint());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==io.Bytes)return e.push(this.readBoolean());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==io.Bytes)return e.push(this.readFloat());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==io.Bytes)return e.push(this.readDouble());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==io.Bytes)return e.push(this.readFixed32());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==io.Bytes)return e.push(this.readSFixed32());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==io.Bytes)return e.push(this.readFixed64());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==io.Bytes)return e.push(this.readSFixed64());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===io.Varint)for(;this.buf[this.pos++]>127;);else if(t===io.Bytes)this.pos=this.readVarint()+this.pos;else if(t===io.Fixed32)this.pos+=4;else{if(t!==io.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),qr(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),qr(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),qr(this.buf,-1&e,this.pos),qr(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),qr(this.buf,-1&e,this.pos),qr(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var f,d,x,P;if(t>=0?(f=t%4294967296|0,d=t/4294967296|0):(d=~(-t/4294967296),4294967295^(f=~(-t%4294967296))?f=f+1|0:(f=0,d=d+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),x=f,(P=r).buf[P.pos++]=127&x|128,x>>>=7,P.buf[P.pos++]=127&x|128,x>>>=7,P.buf[P.pos++]=127&x|128,x>>>=7,P.buf[P.pos++]=127&x|128,P.buf[P.pos]=127&(x>>>=7),function(x,S){var P=(7&x)<<4;S.buf[S.pos++]|=P|((x>>>=3)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x|((x>>>=7)?128:0),x&&(S.buf[S.pos++]=127&x)))))}(d,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(f,d,x){for(var S,P,z=0;z<d.length;z++){if((S=d.charCodeAt(z))>55295&&S<57344){if(!P){S>56319||z+1===d.length?(f[x++]=239,f[x++]=191,f[x++]=189):P=S;continue}if(S<56320){f[x++]=239,f[x++]=191,f[x++]=189,P=S;continue}S=P-55296<<10|S-56320|65536,P=null}else P&&(f[x++]=239,f[x++]=191,f[x++]=189,P=null);S<128?f[x++]=S:(S<2048?f[x++]=S>>6|192:(S<65536?f[x++]=S>>12|224:(f[x++]=S>>18|240,f[x++]=S>>12&63|128),f[x++]=S>>6&63|128),f[x++]=63&S|128)}return x}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&ap(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Ih(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Ih(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var f=this.pos-r;f>=128&&ap(r,f,this),this.pos=r-1,this.writeVarint(f),this.pos+=f},writeMessage:function(e,t,r){this.writeTag(e,io.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,q,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,De,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,kr,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,it,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,lr,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,sr,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Cr,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Ur,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Gr,t)},writeBytesField:function(e,t){this.writeTag(e,io.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,io.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,io.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,io.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,io.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,io.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,io.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,io.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,io.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,io.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var yr=function(e,t){var r=t.pixelRatio,f=t.version,d=t.stretchX,x=t.stretchY,S=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=d,this.stretchY=x,this.content=S,this.version=f},Wr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Wr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Wr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Wr.tlbr.get=function(){return this.tl.concat(this.br)},Wr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(yr.prototype,Wr);var An=function(e,t){var r={},f={};this.haveRenderCallbacks=[];var d=[];this.addImages(e,r,d),this.addImages(t,f,d);var x=Zt(d),S=new ca({width:x.w||1,height:x.h||1});for(var P in e){var z=e[P],J=r[P].paddedRect;ca.copy(z.data,S,{x:0,y:0},{x:J.x+1,y:J.y+1},z.data)}for(var ee in t){var ue=t[ee],ye=f[ee].paddedRect,Se=ye.x+1,qe=ye.y+1,Je=ue.data.width,Tt=ue.data.height;ca.copy(ue.data,S,{x:0,y:0},{x:Se,y:qe},ue.data),ca.copy(ue.data,S,{x:0,y:Tt-1},{x:Se,y:qe-1},{width:Je,height:1}),ca.copy(ue.data,S,{x:0,y:0},{x:Se,y:qe+Tt},{width:Je,height:1}),ca.copy(ue.data,S,{x:Je-1,y:0},{x:Se-1,y:qe},{width:1,height:Tt}),ca.copy(ue.data,S,{x:0,y:0},{x:Se+Je,y:qe},{width:1,height:Tt})}this.image=S,this.iconPositions=r,this.patternPositions=f};An.prototype.addImages=function(e,t,r){for(var f in e){var d=e[f],x={x:0,y:0,w:d.data.width+2,h:d.data.height+2};r.push(x),t[f]=new yr(x,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(f)}},An.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},An.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var f=e.tl;r.update(t.data,void 0,{x:f[0],y:f[1]})}},Nn("ImagePosition",yr),Nn("ImageAtlas",An);var Mr={horizontal:1,vertical:2,horizontalOnly:3},wn=function(){this.scale=1,this.fontStack="",this.imageName=null};wn.forText=function(e,t){var r=new wn;return r.scale=e||1,r.fontStack=t,r},wn.forImage=function(e){var t=new wn;return t.imageName=e,t};var rn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function ui(e,t,r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je){var Tt,st=rn.fromFeature(e,d);ue===Mr.vertical&&st.verticalizePunctuation();var Nt=Cs.processBidirectionalText,Qt=Cs.processStyledBidirectionalText;if(Nt&&1===st.sections.length){Tt=[];for(var gr=0,xr=Nt(st.toString(),En(st,J,x,t,f,Se,qe));gr<xr.length;gr+=1){var Rr=xr[gr],nn=new rn;nn.text=Rr,nn.sections=st.sections;for(var gn=0;gn<Rr.length;gn++)nn.sectionIndex.push(0);Tt.push(nn)}}else if(Qt){Tt=[];for(var ii=0,Fn=Qt(st.text,st.sectionIndex,En(st,J,x,t,f,Se,qe));ii<Fn.length;ii+=1){var fi=Fn[ii],Zn=new rn;Zn.text=fi[0],Zn.sectionIndex=fi[1],Zn.sections=st.sections,Tt.push(Zn)}}else Tt=function(Qn,da){for(var Yi=[],Aa=Qn.text,di=0,Ra=0,Co=da;Ra<Co.length;Ra+=1){var Ao=Co[Ra];Yi.push(Qn.substring(di,Ao)),di=Ao}return di<Aa.length&&Yi.push(Qn.substring(di,Aa.length)),Yi}(st,En(st,J,x,t,f,Se,qe));var na=[],wi={positionedLines:na,text:st.toString(),top:ee[1],bottom:ee[1],left:ee[0],right:ee[0],writingMode:ue,iconsInText:!1,verticalizable:!1};return function(Qn,da,Yi,Aa,di,Ra,Co,Ao,Do,ho,Oo,xs){for(var bs=0,fu=-17,Ms=0,hu=0,Bo="right"===Ao?1:"left"===Ao?0:.5,Os=0,Sa=0,Ja=di;Sa<Ja.length;Sa+=1){var Xa=Ja[Sa];Xa.trim();var qi=Xa.getMaxScale(),$s=24*(qi-1),Zs={positionedGlyphs:[],lineOffset:0};Qn.positionedLines[Os]=Zs;var yo=Zs.positionedGlyphs,fs=0;if(Xa.length()){for(var Ss=0;Ss<Xa.length();Ss++){var Pa=Xa.getSection(Ss),vc=Xa.getSectionIndex(Ss),cl=Xa.getCharCode(Ss),Ml=0,Fo=null,Uc=null,Yu=null,mc=24,Df=!(Do===Mr.horizontal||!Oo&&!Oc(cl)||Oo&&(Lr[cl]||(jc=cl,hn.Arabic(jc)||hn["Arabic Supplement"](jc)||hn["Arabic Extended-A"](jc)||hn["Arabic Presentation Forms-A"](jc)||hn["Arabic Presentation Forms-B"](jc))));if(Pa.imageName){var nh=Aa[Pa.imageName];if(!nh)continue;Yu=Pa.imageName,Qn.iconsInText=Qn.iconsInText||!0,Uc=nh.paddedRect;var af=nh.displaySize;Pa.scale=24*Pa.scale/xs,Ml=$s+(24-af[1]*Pa.scale),mc=(Fo={width:af[0],height:af[1],left:1,top:-3,advance:Df?af[1]:af[0]}).advance;var ih=Df?af[0]*Pa.scale-24*qi:af[1]*Pa.scale-24*qi;ih>0&&ih>fs&&(fs=ih)}else{var Lh=Yi[Pa.fontStack],ah=Lh&&Lh[cl];if(ah&&ah.rect)Uc=ah.rect,Fo=ah.metrics;else{var oh=da[Pa.fontStack],kh=oh&&oh[cl];if(!kh)continue;Fo=kh.metrics}Ml=24*(qi-Pa.scale)}Df?(Qn.verticalizable=!0,yo.push({glyph:cl,imageName:Yu,x:bs,y:fu+Ml,vertical:Df,scale:Pa.scale,fontStack:Pa.fontStack,sectionIndex:vc,metrics:Fo,rect:Uc}),bs+=mc*Pa.scale+ho):(yo.push({glyph:cl,imageName:Yu,x:bs,y:fu+Ml,vertical:Df,scale:Pa.scale,fontStack:Pa.fontStack,sectionIndex:vc,metrics:Fo,rect:Uc}),bs+=Fo.advance*Pa.scale+ho)}0!==yo.length&&(Ms=Math.max(bs-ho,Ms),Ii(yo,0,yo.length-1,Bo,fs)),bs=0;var Rh=Ra*qi+fs;Zs.lineOffset=Math.max(fs,$s),fu+=Rh,hu=Math.max(Rh,hu),++Os}else fu+=Ra,++Os}var jc,sh=fu- -17,uh=zi(Co),gc=uh.horizontalAlign,bf=uh.verticalAlign;(function(Dh,up,Bh,Fh,lp,Sf,lh,ch,Nh){var Bf,zh=(up-Bh)*lp;Bf=Sf!==lh?-ch*Fh- -17:(-Fh*Nh+.5)*lh;for(var fh=0,Zh=Dh;fh<Zh.length;fh+=1)for(var Ff=0,Uh=Zh[fh].positionedGlyphs;Ff<Uh.length;Ff+=1){var hh=Uh[Ff];hh.x+=zh,hh.y+=Bf}})(Qn.positionedLines,Bo,gc,bf,Ms,hu,Ra,sh,di.length),Qn.top+=-bf*sh,Qn.bottom=Qn.top+sh,Qn.left+=-gc*Ms,Qn.right=Qn.left+Ms}(wi,t,r,f,Tt,S,P,z,ue,J,ye,Je),!function(Qn){for(var da=0,Yi=Qn;da<Yi.length;da+=1)if(0!==Yi[da].positionedGlyphs.length)return!1;return!0}(na)&&wi}rn.fromFeature=function(e,t){for(var r=new rn,f=0;f<e.sections.length;f++){var d=e.sections[f];d.image?r.addImageSection(d):r.addTextSection(d,t)}return r},rn.prototype.length=function(){return this.text.length},rn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},rn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},rn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},rn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var f=e.charCodeAt(r+1)||null,d=e.charCodeAt(r-1)||null;t+=f&&xl(f)&&!kf[e[r+1]]||d&&xl(d)&&!kf[e[r-1]]||!kf[e[r]]?e[r]:kf[e[r]]}return t}(this.text)},rn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Lr[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,f=this.text.length-1;f>=0&&f>=e&&Lr[this.text.charCodeAt(f)];f--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},rn.prototype.substring=function(e,t){var r=new rn;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},rn.prototype.toString=function(){return this.text},rn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},rn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(wn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,f=0;f<e.text.length;++f)this.sectionIndex.push(r)},rn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(0!==t.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(wn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):Xe("Reached maximum number of images 6401")}else Xe("Can't add FormattedSection with an empty image.")},rn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Lr={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wr={};function Gn(e,t,r,f,d,x){if(t.imageName){var S=f[t.imageName];return S?S.displaySize[0]*t.scale*24/x+d:0}var P=r[t.fontStack],z=P&&P[e];return z?z.metrics.advance*t.scale+d:0}function vn(e,t,r,f){var d=Math.pow(e-t,2);return f?e<t?d/2:2*d:d+Math.abs(r)*r}function Jr(e,t,r){var f=0;return 10===e&&(f-=1e4),r&&(f+=150),40!==e&&65288!==e||(f+=50),41!==t&&65289!==t||(f+=50),f}function xn(e,t,r,f,d,x){for(var S=null,P=vn(t,r,d,x),z=0,J=f;z<J.length;z+=1){var ee=J[z],ue=vn(t-ee.x,r,d,x)+ee.badness;ue<=P&&(S=ee,P=ue)}return{index:e,x:t,priorBreak:S,badness:P}}function En(e,t,r,f,d,x,S){if("point"!==x)return[];if(!e)return[];for(var P,z=[],J=function(Tt,st,Nt,Qt,gr,xr){for(var Rr=0,nn=0;nn<Tt.length();nn++){var gn=Tt.getSection(nn);Rr+=Gn(Tt.getCharCode(nn),gn,Qt,gr,st,xr)}return Rr/Math.max(1,Math.ceil(Rr/Nt))}(e,t,r,f,d,S),ee=e.text.indexOf("\u200b")>=0,ue=0,ye=0;ye<e.length();ye++){var Se=e.getSection(ye),qe=e.getCharCode(ye);if(Lr[qe]||(ue+=Gn(qe,Se,f,d,t,S)),ye<e.length()-1){var Je=!((P=qe)<11904||!(hn["Bopomofo Extended"](P)||hn.Bopomofo(P)||hn["CJK Compatibility Forms"](P)||hn["CJK Compatibility Ideographs"](P)||hn["CJK Compatibility"](P)||hn["CJK Radicals Supplement"](P)||hn["CJK Strokes"](P)||hn["CJK Symbols and Punctuation"](P)||hn["CJK Unified Ideographs Extension A"](P)||hn["CJK Unified Ideographs"](P)||hn["Enclosed CJK Letters and Months"](P)||hn["Halfwidth and Fullwidth Forms"](P)||hn.Hiragana(P)||hn["Ideographic Description Characters"](P)||hn["Kangxi Radicals"](P)||hn["Katakana Phonetic Extensions"](P)||hn.Katakana(P)||hn["Vertical Forms"](P)||hn["Yi Radicals"](P)||hn["Yi Syllables"](P)));(wr[qe]||Je||Se.imageName)&&z.push(xn(ye+1,ue,J,z,Jr(qe,e.getCharCode(ye+1),Je&&ee),!1))}}return function Tt(st){return st?Tt(st.priorBreak).concat(st.index):[]}(xn(e.length(),ue,J,z,0,!0))}function zi(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Ii(e,t,r,f,d){if(f||d)for(var x=e[r],S=(e[r].x+x.metrics.advance*x.scale)*f,P=t;P<=r;P++)e[P].x-=S,e[P].y+=d}function Cn(e,t,r,f,d,x){var S,P=e.image;if(P.content){var z=P.content,J=P.pixelRatio||1;S=[z[0]/J,z[1]/J,P.displaySize[0]-z[2]/J,P.displaySize[1]-z[3]/J]}var ee,ue,ye,Se,qe=t.left*x,Je=t.right*x;"width"===r||"both"===r?(Se=d[0]+qe-f[3],ue=d[0]+Je+f[1]):ue=(Se=d[0]+(qe+Je-P.displaySize[0])/2)+P.displaySize[0];var Tt=t.top*x,st=t.bottom*x;return"height"===r||"both"===r?(ee=d[1]+Tt-f[0],ye=d[1]+st+f[2]):ye=(ee=d[1]+(Tt+st-P.displaySize[1])/2)+P.displaySize[1],{image:P,top:ee,right:ue,bottom:ye,left:Se,collisionPadding:S}}wr[10]=!0,wr[32]=!0,wr[38]=!0,wr[40]=!0,wr[41]=!0,wr[43]=!0,wr[45]=!0,wr[47]=!0,wr[173]=!0,wr[183]=!0,wr[8203]=!0,wr[8208]=!0,wr[8211]=!0,wr[8231]=!0;var Tn=function(e){function t(r,f,d,x){e.call(this,r,f),this.angle=d,void 0!==x&&(this.segment=x)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(B);function _i(e,t){var r=t.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new $i(e+1))};if("source"===r.kind)return{kind:"source"};for(var f=r.zoomStops,d=r.interpolationType,x=0;x<f.length&&f[x]<=e;)x++;for(var S=x=Math.max(0,x-1);S<f.length&&f[S]<e+1;)S++;S=Math.min(f.length-1,S);var P=f[x],z=f[S];return"composite"===r.kind?{kind:"composite",minZoom:P,maxZoom:z,interpolationType:d}:{kind:"camera",minZoom:P,maxZoom:z,minSize:r.evaluate(new $i(P)),maxSize:r.evaluate(new $i(z)),interpolationType:d}}function Zi(e,t,r){var f=t.uSize,d=r.lowerSize;return"source"===e.kind?d/128:"composite"===e.kind?Oa(d/128,r.upperSize/128,t.uSizeT):f}function fa(e,t){var r=0,f=0;if("constant"===e.kind)f=e.layoutSize;else if("source"!==e.kind){var d=e.interpolationType,x=d?W(Ne.interpolationFactor(d,t,e.minZoom,e.maxZoom),0,1):0;"camera"===e.kind?f=Oa(e.minSize,e.maxSize,x):r=x}return{uSizeT:r,uSize:f}}Nn("Anchor",Tn);var Io=Object.freeze({__proto__:null,getSizeData:_i,evaluateSizeForFeature:Zi,evaluateSizeForZoom:fa,SIZE_PACK_FACTOR:128});function Mo(e,t,r,f,d){if(void 0===t.segment)return!0;for(var x=t,S=t.segment+1,P=0;P>-r/2;){if(--S<0)return!1;P-=e[S].dist(x),x=e[S]}P+=e[S].dist(e[S+1]),S++;for(var z=[],J=0;P<r/2;){var ee=e[S],ue=e[S+1];if(!ue)return!1;var ye=e[S-1].angleTo(ee)-ee.angleTo(ue);for(ye=Math.abs((ye+3*Math.PI)%(2*Math.PI)-Math.PI),z.push({distance:P,angleDelta:ye}),J+=ye;P-z[0].distance>f;)J-=z.shift().angleDelta;if(J>d)return!1;S++,P+=ee.dist(ue)}return!0}function ha(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function ds(e,t,r){return e?.6*t*r:0}function so(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function vs(e,t,r,f,d,x){for(var S=ds(r,d,x),P=so(r,f)*x,z=0,J=ha(e)/2,ee=0;ee<e.length-1;ee++){var ue=e[ee],ye=e[ee+1],Se=ue.dist(ye);if(z+Se>J){var qe=(J-z)/Se,Je=Oa(ue.x,ye.x,qe),Tt=Oa(ue.y,ye.y,qe),st=new Tn(Je,Tt,ye.angleTo(ue),ee);return st._round(),!S||Mo(e,st,P,S,t)?st:void 0}z+=Se}}function Uo(e,t,r,f,d,x,S,P,z){var J=ds(f,x,S),ee=so(f,d),ue=ee*S,ye=0===e[0].x||e[0].x===z||0===e[0].y||e[0].y===z;return t-ue<t/4&&(t=ue+t/4),function Se(qe,Je,Tt,st,Nt,Qt,gr,xr,Rr){for(var nn=Qt/2,gn=ha(qe),ii=0,Fn=Je-Tt,fi=[],Zn=0;Zn<qe.length-1;Zn++){for(var na=qe[Zn],wi=qe[Zn+1],Qn=na.dist(wi),da=wi.angleTo(na);Fn+Tt<ii+Qn;){var Yi=((Fn+=Tt)-ii)/Qn,Aa=Oa(na.x,wi.x,Yi),di=Oa(na.y,wi.y,Yi);if(Aa>=0&&Aa<Rr&&di>=0&&di<Rr&&Fn-nn>=0&&Fn+nn<=gn){var Ra=new Tn(Aa,di,da,Zn);Ra._round(),st&&!Mo(qe,Ra,Qt,st,Nt)||fi.push(Ra)}}ii+=Qn}return xr||fi.length||gr||(fi=Se(qe,ii/2,Tt,st,Nt,Qt,gr,!0,Rr)),fi}(e,ye?t/2*P%t:(ee/2+2*x)*S*P%t,t,J,r,ue,ye,!1,z)}function ss(e,t,r,f,d){for(var x=[],S=0;S<e.length;S++)for(var P=e[S],z=void 0,J=0;J<P.length-1;J++){var ee=P[J],ue=P[J+1];ee.x<t&&ue.x<t||(ee.x<t?ee=new B(t,ee.y+(t-ee.x)/(ue.x-ee.x)*(ue.y-ee.y))._round():ue.x<t&&(ue=new B(t,ee.y+(t-ee.x)/(ue.x-ee.x)*(ue.y-ee.y))._round()),ee.y<r&&ue.y<r||(ee.y<r?ee=new B(ee.x+(r-ee.y)/(ue.y-ee.y)*(ue.x-ee.x),r)._round():ue.y<r&&(ue=new B(ee.x+(r-ee.y)/(ue.y-ee.y)*(ue.x-ee.x),r)._round()),ee.x>=f&&ue.x>=f||(ee.x>=f?ee=new B(f,ee.y+(f-ee.x)/(ue.x-ee.x)*(ue.y-ee.y))._round():ue.x>=f&&(ue=new B(f,ee.y+(f-ee.x)/(ue.x-ee.x)*(ue.y-ee.y))._round()),ee.y>=d&&ue.y>=d||(ee.y>=d?ee=new B(ee.x+(d-ee.y)/(ue.y-ee.y)*(ue.x-ee.x),d)._round():ue.y>=d&&(ue=new B(ee.x+(d-ee.y)/(ue.y-ee.y)*(ue.x-ee.x),d)._round()),z&&ee.equals(z[z.length-1])||x.push(z=[ee]),z.push(ue)))))}return x}function ms(e,t,r,f){var d=[],x=e.image,S=x.pixelRatio,P=x.paddedRect.w-2,z=x.paddedRect.h-2,J=e.right-e.left,ee=e.bottom-e.top,ue=x.stretchX||[[0,P]],ye=x.stretchY||[[0,z]],Se=function(Aa,di){return Aa+di[1]-di[0]},qe=ue.reduce(Se,0),Je=ye.reduce(Se,0),Tt=P-qe,st=z-Je,Nt=0,Qt=qe,gr=0,xr=Je,Rr=0,nn=Tt,gn=0,ii=st;if(x.content&&f){var Fn=x.content;Nt=us(ue,0,Fn[0]),gr=us(ye,0,Fn[1]),Qt=us(ue,Fn[0],Fn[2]),xr=us(ye,Fn[1],Fn[3]),Rr=Fn[0]-Nt,gn=Fn[1]-gr,nn=Fn[2]-Fn[0]-Qt,ii=Fn[3]-Fn[1]-xr}var fi=function(Aa,di,Ra,Co){var Ao=Hi(Aa.stretch-Nt,Qt,J,e.left),Do=ls(Aa.fixed-Rr,nn,Aa.stretch,qe),ho=Hi(di.stretch-gr,xr,ee,e.top),Oo=ls(di.fixed-gn,ii,di.stretch,Je),xs=Hi(Ra.stretch-Nt,Qt,J,e.left),bs=ls(Ra.fixed-Rr,nn,Ra.stretch,qe),fu=Hi(Co.stretch-gr,xr,ee,e.top),Ms=ls(Co.fixed-gn,ii,Co.stretch,Je),hu=new B(Ao,ho),Bo=new B(xs,ho),Os=new B(xs,fu),Sa=new B(Ao,fu),Ja=new B(Do/S,Oo/S),Xa=new B(bs/S,Ms/S),qi=t*Math.PI/180;if(qi){var $s=Math.sin(qi),Zs=Math.cos(qi),yo=[Zs,-$s,$s,Zs];hu._matMult(yo),Bo._matMult(yo),Sa._matMult(yo),Os._matMult(yo)}var fs=Aa.stretch+Aa.fixed,Ss=di.stretch+di.fixed;return{tl:hu,tr:Bo,bl:Sa,br:Os,tex:{x:x.paddedRect.x+1+fs,y:x.paddedRect.y+1+Ss,w:Ra.stretch+Ra.fixed-fs,h:Co.stretch+Co.fixed-Ss},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ja,pixelOffsetBR:Xa,minFontScaleX:nn/S/J,minFontScaleY:ii/S/ee,isSDF:r}};if(f&&(x.stretchX||x.stretchY))for(var Zn=jo(ue,Tt,qe),na=jo(ye,st,Je),wi=0;wi<Zn.length-1;wi++)for(var Qn=Zn[wi],da=Zn[wi+1],Yi=0;Yi<na.length-1;Yi++)d.push(fi(Qn,na[Yi],da,na[Yi+1]));else d.push(fi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:P+1},{fixed:0,stretch:z+1}));return d}function us(e,t,r){for(var f=0,d=0,x=e;d<x.length;d+=1){var S=x[d];f+=Math.max(t,Math.min(r,S[1]))-Math.max(t,Math.min(r,S[0]))}return f}function jo(e,t,r){for(var f=[{fixed:-1,stretch:0}],d=0,x=e;d<x.length;d+=1){var S=x[d],P=S[0],z=S[1],J=f[f.length-1];f.push({fixed:P-J.stretch,stretch:J.stretch}),f.push({fixed:P-J.stretch,stretch:J.stretch+(z-P)})}return f.push({fixed:t+1,stretch:r}),f}function Hi(e,t,r,f){return e/t*r+f}function ls(e,t,r,f){return e-t*r/f}var ka=function(e,t,r,f,d,x,S,P,z,J){if(this.boxStartIndex=e.length,z){var ee=x.top,ue=x.bottom,ye=x.collisionPadding;ye&&(ee-=ye[1],ue+=ye[3]);var Se=ue-ee;Se>0&&(Se=Math.max(10,Se),this.circleDiameter=Se)}else{var qe=x.top*S-P,Je=x.bottom*S+P,Tt=x.left*S-P,st=x.right*S+P,Nt=x.collisionPadding;if(Nt&&(Tt-=Nt[0]*S,qe-=Nt[1]*S,st+=Nt[2]*S,Je+=Nt[3]*S),J){var Qt=new B(Tt,qe),gr=new B(st,qe),xr=new B(Tt,Je),Rr=new B(st,Je),nn=J*Math.PI/180;Qt._rotate(nn),gr._rotate(nn),xr._rotate(nn),Rr._rotate(nn),Tt=Math.min(Qt.x,gr.x,xr.x,Rr.x),st=Math.max(Qt.x,gr.x,xr.x,Rr.x),qe=Math.min(Qt.y,gr.y,xr.y,Rr.y),Je=Math.max(Qt.y,gr.y,xr.y,Rr.y)}e.emplaceBack(t.x,t.y,Tt,qe,st,Je,r,f,d)}this.boxEndIndex=e.length},uo=function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=Ai),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Ai(e,t){return e<t?-1:e>t?1:0}function pa(e,t,r){void 0===t&&(t=1),void 0===r&&(r=!1);for(var f=1/0,d=1/0,x=-1/0,S=-1/0,P=e[0],z=0;z<P.length;z++){var J=P[z];(!z||J.x<f)&&(f=J.x),(!z||J.y<d)&&(d=J.y),(!z||J.x>x)&&(x=J.x),(!z||J.y>S)&&(S=J.y)}var ee=Math.min(x-f,S-d),ue=ee/2,ye=new uo([],Qa);if(0===ee)return new B(f,d);for(var Se=f;Se<x;Se+=ee)for(var qe=d;qe<S;qe+=ee)ye.push(new To(Se+ue,qe+ue,ue,e));for(var Je=function(Nt){for(var Qt=0,gr=0,xr=0,Rr=Nt[0],nn=0,gn=Rr.length,ii=gn-1;nn<gn;ii=nn++){var Fn=Rr[nn],fi=Rr[ii],Zn=Fn.x*fi.y-fi.x*Fn.y;gr+=(Fn.x+fi.x)*Zn,xr+=(Fn.y+fi.y)*Zn,Qt+=3*Zn}return new To(gr/Qt,xr/Qt,0,Nt)}(e),Tt=ye.length;ye.length;){var st=ye.pop();(st.d>Je.d||!Je.d)&&(Je=st,r&&console.log("found best %d after %d probes",Math.round(1e4*st.d)/1e4,Tt)),st.max-Je.d<=t||(ye.push(new To(st.p.x-(ue=st.h/2),st.p.y-ue,ue,e)),ye.push(new To(st.p.x+ue,st.p.y-ue,ue,e)),ye.push(new To(st.p.x-ue,st.p.y+ue,ue,e)),ye.push(new To(st.p.x+ue,st.p.y+ue,ue,e)),Tt+=4)}return r&&(console.log("num probes: "+Tt),console.log("best distance: "+Je.d)),Je.p}function Qa(e,t){return t.max-e.max}function To(e,t,r,f){this.p=new B(e,t),this.h=r,this.d=function(d,x){for(var S=!1,P=1/0,z=0;z<x.length;z++)for(var J=x[z],ee=0,ue=J.length,ye=ue-1;ee<ue;ye=ee++){var Se=J[ee],qe=J[ye];Se.y>d.y!=qe.y>d.y&&d.x<(qe.x-Se.x)*(d.y-Se.y)/(qe.y-Se.y)+Se.x&&(S=!S),P=Math.min(P,xa(d,Se,qe))}return(S?1:-1)*Math.sqrt(P)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}uo.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},uo.prototype.pop=function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},uo.prototype.peek=function(){return this.data[0]},uo.prototype._up=function(e){for(var t=this.data,r=this.compare,f=t[e];e>0;){var d=e-1>>1,x=t[d];if(r(f,x)>=0)break;t[e]=x,e=d}t[e]=f},uo.prototype._down=function(e){for(var t=this.data,r=this.compare,f=this.length>>1,d=t[e];e<f;){var x=1+(e<<1),S=t[x],P=x+1;if(P<this.length&&r(t[P],S)<0&&(x=P,S=t[P]),r(S,d)>=0)break;t[e]=S,e=x}t[e]=d};var Pl=Number.POSITIVE_INFINITY;function Qe(e,t){return t[1]!==Pl?function(r,f,d){var x=0,S=0;switch(f=Math.abs(f),d=Math.abs(d),r){case"top-right":case"top-left":case"top":S=d-7;break;case"bottom-right":case"bottom-left":case"bottom":S=7-d}switch(r){case"top-right":case"bottom-right":case"right":x=-f;break;case"top-left":case"bottom-left":case"left":x=f}return[x,S]}(e,t[0],t[1]):function(r,f){var d=0,x=0;f<0&&(f=0);var S=f/Math.sqrt(2);switch(r){case"top-right":case"top-left":x=S-7;break;case"bottom-right":case"bottom-left":x=7-S;break;case"bottom":x=7-f;break;case"top":x=f-7}switch(r){case"top-right":case"bottom-right":d=-S;break;case"top-left":case"bottom-left":d=S;break;case"left":d=f;break;case"right":d=-f}return[d,x]}(e,t[0])}function dr(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function tr(e,t,r,f,d,x,S,P,z,J,ee,ue,ye,Se,qe){var Je=function(gr,xr,Rr,nn,gn,ii,Fn,fi){for(var Zn=nn.layout.get("text-rotate").evaluate(ii,{})*Math.PI/180,na=[],wi=0,Qn=xr.positionedLines;wi<Qn.length;wi+=1)for(var da=Qn[wi],Yi=0,Aa=da.positionedGlyphs;Yi<Aa.length;Yi+=1){var di=Aa[Yi];if(di.rect){var Ra=di.rect||{},Co=4,Ao=!0,Do=1,ho=0,Oo=(gn||fi)&&di.vertical,xs=di.metrics.advance*di.scale/2;if(fi&&xr.verticalizable&&(ho=da.lineOffset/2-(di.imageName?-(24-di.metrics.width*di.scale)/2:24*(di.scale-1))),di.imageName){var bs=Fn[di.imageName];Ao=bs.sdf,Co=1/(Do=bs.pixelRatio)}var fu=gn?[di.x+xs,di.y]:[0,0],Ms=gn?[0,0]:[di.x+xs+Rr[0],di.y+Rr[1]-ho],hu=[0,0];Oo&&(hu=Ms,Ms=[0,0]);var Bo=(di.metrics.left-Co)*di.scale-xs+Ms[0],Os=(-di.metrics.top-Co)*di.scale+Ms[1],Sa=Bo+Ra.w*di.scale/Do,Ja=Os+Ra.h*di.scale/Do,Xa=new B(Bo,Os),qi=new B(Sa,Os),$s=new B(Bo,Ja),Zs=new B(Sa,Ja);if(Oo){var yo=new B(-xs,xs- -17),fs=-Math.PI/2,Ss=12-xs,Pa=new B(22-Ss,-(di.imageName?Ss:0)),vc=new(Function.prototype.bind.apply(B,[null].concat(hu)));Xa._rotateAround(fs,yo)._add(Pa)._add(vc),qi._rotateAround(fs,yo)._add(Pa)._add(vc),$s._rotateAround(fs,yo)._add(Pa)._add(vc),Zs._rotateAround(fs,yo)._add(Pa)._add(vc)}if(Zn){var cl=Math.sin(Zn),Ml=Math.cos(Zn),Fo=[Ml,-cl,cl,Ml];Xa._matMult(Fo),qi._matMult(Fo),$s._matMult(Fo),Zs._matMult(Fo)}var Uc=new B(0,0),Yu=new B(0,0);na.push({tl:Xa,tr:qi,bl:$s,br:Zs,tex:Ra,writingMode:xr.writingMode,glyphOffset:fu,sectionIndex:di.sectionIndex,isSDF:Ao,pixelOffsetTL:Uc,pixelOffsetBR:Yu,minFontScaleX:0,minFontScaleY:0})}}return na}(0,r,P,d,x,S,f,e.allowVerticalPlacement),Tt=e.textSizeData,st=null;"source"===Tt.kind?(st=[128*d.layout.get("text-size").evaluate(S,{})])[0]>32640&&Xe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===Tt.kind&&((st=[128*Se.compositeTextSizes[0].evaluate(S,{},qe),128*Se.compositeTextSizes[1].evaluate(S,{},qe)])[0]>32640||st[1]>32640)&&Xe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Je,st,P,x,S,J,t,z.lineStartIndex,z.lineLength,ye,qe);for(var Nt=0,Qt=ee;Nt<Qt.length;Nt+=1)ue[Qt[Nt]]=e.text.placedSymbolArray.length-1;return 4*Je.length}function zn(e){for(var t in e)return e[t];return null}function ya(e,t,r,f){var d=e.compareText;if(t in d){for(var x=d[t],S=x.length-1;S>=0;S--)if(f.dist(x[S])<r)return!0}else d[t]=[];return d[t].push(f),!1}var He=gf.VectorTileFeature.types,Pe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function dt(e,t,r,f,d,x,S,P,z,J,ee,ue,ye){var Se=P?Math.min(32640,Math.round(P[0])):0,qe=P?Math.min(32640,Math.round(P[1])):0;e.emplaceBack(t,r,Math.round(32*f),Math.round(32*d),x,S,(Se<<1)+(z?1:0),qe,16*J,16*ee,256*ue,256*ye)}function Ut(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function cr(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(sc(r[t].text))return!0;return!1}var Ct=function(e){this.layoutVertexArray=new Hl,this.indexArray=new sl,this.programConfigurations=e,this.segments=new Ie,this.dynamicLayoutVertexArray=new Sl,this.opacityVertexArray=new Wl,this.placedSymbolArray=new p};Ct.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},Ct.prototype.upload=function(e,t,r,f){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$p.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Qp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Pe,!0),this.opacityVertexBuffer.itemSize=1),(r||f)&&this.programConfigurations.upload(e))},Ct.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Nn("SymbolBuffers",Ct);var _t=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new Ie,this.collisionVertexArray=new kc};_t.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Pp.members,!0)},_t.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Nn("CollisionBuffers",_t);var ht=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(x){return x.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ca([]),this.placementViewportMatrix=Ca([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=_i(this.zoom,t["text-size"]),this.iconSizeData=_i(this.zoom,t["icon-size"]);var r=this.layers[0].layout,f=r.get("symbol-sort-key"),d=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==d&&void 0!==f.constantOr(1),this.sortFeaturesByY=("viewport-y"===d||"auto"===d&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map(function(x){return Mr[x]})),this.stateDependentLayerIds=this.layers.filter(function(x){return x.isStateDependent()}).map(function(x){return x.id}),this.sourceID=e.sourceID};ht.prototype.createArrays=function(){this.text=new Ct(new ne(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new Ct(new ne(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new A,this.lineVertexArray=new F,this.symbolInstances=new E},ht.prototype.calculateGlyphDependencies=function(e,t,r,f,d){for(var x=0;x<e.length;x++)if(t[e.charCodeAt(x)]=!0,(r||f)&&d){var S=kf[e.charAt(x)];S&&(t[S.charCodeAt(0)]=!0)}},ht.prototype.populate=function(e,t,r){var f=this.layers[0],d=f.layout,x=d.get("text-font"),S=d.get("text-field"),P=d.get("icon-image"),z=("constant"!==S.value.kind||S.value.value instanceof Za&&!S.value.value.isEmpty()||S.value.value.toString().length>0)&&("constant"!==x.value.kind||x.value.value.length>0),J="constant"!==P.value.kind||!!P.value.value||Object.keys(P.parameters).length>0,ee=d.get("symbol-sort-key");if(this.features=[],z||J){for(var ue=t.iconDependencies,ye=t.glyphDependencies,Se=t.availableImages,qe=new $i(this.zoom),Je=0,Tt=e;Je<Tt.length;Je+=1){var st=Tt[Je],Nt=st.feature,Qt=st.id,gr=st.index,xr=st.sourceLayerIndex,Rr=f._featureFilter.needGeometry,nn=Rt(Nt,Rr);if(f._featureFilter.filter(qe,nn,r)){Rr||(nn.geometry=vt(Nt));var gn=void 0;if(z){var ii=f.getValueAndResolveTokens("text-field",nn,r,Se),Fn=Za.factory(ii);cr(Fn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Lc()||this.hasRTLText&&Cs.isParsed())&&(gn=ed(Fn,f,nn))}var fi=void 0;if(J){var Zn=f.getValueAndResolveTokens("icon-image",nn,r,Se);fi=Zn instanceof Wi?Zn:Wi.fromString(Zn)}if(gn||fi){var na=this.sortFeaturesByKey?ee.evaluate(nn,{},r):void 0;if(this.features.push({id:Qt,text:gn,icon:fi,index:gr,sourceLayerIndex:xr,geometry:nn.geometry,properties:Nt.properties,type:He[Nt.type],sortKey:na}),fi&&(ue[fi.name]=!0),gn){var wi=x.evaluate(nn,{},r).join(","),Qn="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Mr.vertical)>=0;for(var da=0,Yi=gn.sections;da<Yi.length;da+=1){var Aa=Yi[da];if(Aa.image)ue[Aa.image.name]=!0;else{var di=Kc(gn.toString()),Ra=Aa.fontStack||wi,Co=ye[Ra]=ye[Ra]||{};this.calculateGlyphDependencies(Aa.text,Co,Qn,this.allowVerticalPlacement,di)}}}}}}"line"===d.get("symbol-placement")&&(this.features=function(Ao){var Do={},ho={},Oo=[],xs=0;function bs(yo){Oo.push(Ao[yo]),xs++}function fu(yo,fs,Ss){var Pa=ho[yo];return delete ho[yo],ho[fs]=Pa,Oo[Pa].geometry[0].pop(),Oo[Pa].geometry[0]=Oo[Pa].geometry[0].concat(Ss[0]),Pa}function Ms(yo,fs,Ss){var Pa=Do[fs];return delete Do[fs],Do[yo]=Pa,Oo[Pa].geometry[0].shift(),Oo[Pa].geometry[0]=Ss[0].concat(Oo[Pa].geometry[0]),Pa}function hu(yo,fs,Ss){var Pa=Ss?fs[0][fs[0].length-1]:fs[0][0];return yo+":"+Pa.x+":"+Pa.y}for(var Bo=0;Bo<Ao.length;Bo++){var Os=Ao[Bo],Sa=Os.geometry,Ja=Os.text?Os.text.toString():null;if(Ja){var Xa=hu(Ja,Sa),qi=hu(Ja,Sa,!0);if(Xa in ho&&qi in Do&&ho[Xa]!==Do[qi]){var $s=Ms(Xa,qi,Sa),Zs=fu(Xa,qi,Oo[$s].geometry);delete Do[Xa],delete ho[qi],ho[hu(Ja,Oo[Zs].geometry,!0)]=Zs,Oo[$s].geometry=null}else Xa in ho?fu(Xa,qi,Sa):qi in Do?Ms(Xa,qi,Sa):(bs(Bo),Do[Xa]=xs-1,ho[qi]=xs-1)}else bs(Bo)}return Oo.filter(function(yo){return yo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ao,Do){return Ao.sortKey-Do.sortKey})}},ht.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},ht.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},ht.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ht.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ht.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ht.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ht.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){for(var f=e.dist(t[e.segment+1]),d=e.dist(t[e.segment]),x={},S=e.segment+1;S<t.length;S++)x[S]={x:t[S].x,y:t[S].y,tileUnitDistanceFromAnchor:f},S<t.length-1&&(f+=t[S+1].dist(t[S]));for(var P=e.segment||0;P>=0;P--)x[P]={x:t[P].x,y:t[P].y,tileUnitDistanceFromAnchor:d},P>0&&(d+=t[P-1].dist(t[P]));for(var z=0;z<t.length;z++){var J=x[z];this.lineVertexArray.emplaceBack(J.x,J.y,J.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},ht.prototype.addSymbols=function(e,t,r,f,d,x,S,P,z,J,ee,ue){for(var ye=e.indexArray,Se=e.layoutVertexArray,qe=e.segments.prepareSegment(4*t.length,Se,ye,this.canOverlap?x.sortKey:void 0),Je=this.glyphOffsetArray.length,Tt=qe.vertexLength,st=this.allowVerticalPlacement&&S===Mr.vertical?Math.PI/2:0,Nt=x.text&&x.text.sections,Qt=0;Qt<t.length;Qt++){var gr=t[Qt],xr=gr.tl,Rr=gr.tr,nn=gr.bl,gn=gr.br,ii=gr.tex,Fn=gr.pixelOffsetTL,fi=gr.pixelOffsetBR,Zn=gr.minFontScaleX,na=gr.minFontScaleY,wi=gr.glyphOffset,Qn=gr.isSDF,da=gr.sectionIndex,Yi=qe.vertexLength,Aa=wi[1];dt(Se,P.x,P.y,xr.x,Aa+xr.y,ii.x,ii.y,r,Qn,Fn.x,Fn.y,Zn,na),dt(Se,P.x,P.y,Rr.x,Aa+Rr.y,ii.x+ii.w,ii.y,r,Qn,fi.x,Fn.y,Zn,na),dt(Se,P.x,P.y,nn.x,Aa+nn.y,ii.x,ii.y+ii.h,r,Qn,Fn.x,fi.y,Zn,na),dt(Se,P.x,P.y,gn.x,Aa+gn.y,ii.x+ii.w,ii.y+ii.h,r,Qn,fi.x,fi.y,Zn,na),Ut(e.dynamicLayoutVertexArray,P,st),ye.emplaceBack(Yi,Yi+1,Yi+2),ye.emplaceBack(Yi+1,Yi+2,Yi+3),qe.vertexLength+=4,qe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(wi[0]),Qt!==t.length-1&&da===t[Qt+1].sectionIndex||e.programConfigurations.populatePaintArrays(Se.length,x,x.index,{},ue,Nt&&Nt[da])}e.placedSymbolArray.emplaceBack(P.x,P.y,Je,this.glyphOffsetArray.length-Je,Tt,z,J,P.segment,r?r[0]:0,r?r[1]:0,f[0],f[1],S,0,!1,0,ee)},ht.prototype._addCollisionDebugVertex=function(e,t,r,f,d,x){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,f,d,Math.round(x.x),Math.round(x.y))},ht.prototype.addCollisionDebugVertices=function(e,t,r,f,d,x,S){var P=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),z=P.vertexLength,J=d.layoutVertexArray,ee=d.collisionVertexArray,ue=S.anchorX,ye=S.anchorY;this._addCollisionDebugVertex(J,ee,x,ue,ye,new B(e,t)),this._addCollisionDebugVertex(J,ee,x,ue,ye,new B(r,t)),this._addCollisionDebugVertex(J,ee,x,ue,ye,new B(r,f)),this._addCollisionDebugVertex(J,ee,x,ue,ye,new B(e,f)),P.vertexLength+=4;var Se=d.indexArray;Se.emplaceBack(z,z+1),Se.emplaceBack(z+1,z+2),Se.emplaceBack(z+2,z+3),Se.emplaceBack(z+3,z),P.primitiveLength+=4},ht.prototype.addDebugCollisionBoxes=function(e,t,r,f){for(var d=e;d<t;d++){var x=this.collisionBoxArray.get(d);this.addCollisionDebugVertices(x.x1,x.y1,x.x2,x.y2,f?this.textCollisionBox:this.iconCollisionBox,x.anchorPoint,r)}},ht.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _t(wl,Ip.members,cc),this.iconCollisionBox=new _t(wl,Ip.members,cc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},ht.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,f,d,x,S,P,z){for(var J={},ee=t;ee<r;ee++){var ue=e.get(ee);J.textBox={x1:ue.x1,y1:ue.y1,x2:ue.x2,y2:ue.y2,anchorPointX:ue.anchorPointX,anchorPointY:ue.anchorPointY},J.textFeatureIndex=ue.featureIndex;break}for(var ye=f;ye<d;ye++){var Se=e.get(ye);J.verticalTextBox={x1:Se.x1,y1:Se.y1,x2:Se.x2,y2:Se.y2,anchorPointX:Se.anchorPointX,anchorPointY:Se.anchorPointY},J.verticalTextFeatureIndex=Se.featureIndex;break}for(var qe=x;qe<S;qe++){var Je=e.get(qe);J.iconBox={x1:Je.x1,y1:Je.y1,x2:Je.x2,y2:Je.y2,anchorPointX:Je.anchorPointX,anchorPointY:Je.anchorPointY},J.iconFeatureIndex=Je.featureIndex;break}for(var Tt=P;Tt<z;Tt++){var st=e.get(Tt);J.verticalIconBox={x1:st.x1,y1:st.y1,x2:st.x2,y2:st.y2,anchorPointX:st.anchorPointX,anchorPointY:st.anchorPointY},J.verticalIconFeatureIndex=st.featureIndex;break}return J},ht.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},ht.prototype.hasTextData=function(){return this.text.segments.get().length>0},ht.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ht.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ht.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ht.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ht.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),f=r.vertexStartIndex+4*r.numGlyphs,d=r.vertexStartIndex;d<f;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)},ht.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),f=[],d=[],x=[],S=0;S<this.symbolInstances.length;++S){x.push(S);var P=this.symbolInstances.get(S);f.push(0|Math.round(t*P.anchorX+r*P.anchorY)),d.push(P.featureIndex)}return x.sort(function(z,J){return f[z]-f[J]||d[J]-d[z]}),x},ht.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},ht.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,f=this.symbolInstanceIndexes;r<f.length;r+=1){var d=this.symbolInstances.get(f[r]);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach(function(x,S,P){x>=0&&P.indexOf(x)===S&&t.addIndicesForPlacedSymbol(t.text,x)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Nn("SymbolBucket",ht,{omit:["layers","collisionBoxArray","features","compareText"]}),ht.MAX_GLYPHS=65535,ht.addDynamicAttributes=Ut;var ze=new Po({"symbol-placement":new ri(fe.layout_symbol["symbol-placement"]),"symbol-spacing":new ri(fe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ri(fe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new In(fe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ri(fe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ri(fe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ri(fe.layout_symbol["icon-ignore-placement"]),"icon-optional":new ri(fe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ri(fe.layout_symbol["icon-rotation-alignment"]),"icon-size":new In(fe.layout_symbol["icon-size"]),"icon-text-fit":new ri(fe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ri(fe.layout_symbol["icon-text-fit-padding"]),"icon-image":new In(fe.layout_symbol["icon-image"]),"icon-rotate":new In(fe.layout_symbol["icon-rotate"]),"icon-padding":new ri(fe.layout_symbol["icon-padding"]),"icon-keep-upright":new ri(fe.layout_symbol["icon-keep-upright"]),"icon-offset":new In(fe.layout_symbol["icon-offset"]),"icon-anchor":new In(fe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ri(fe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ri(fe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ri(fe.layout_symbol["text-rotation-alignment"]),"text-field":new In(fe.layout_symbol["text-field"]),"text-font":new In(fe.layout_symbol["text-font"]),"text-size":new In(fe.layout_symbol["text-size"]),"text-max-width":new In(fe.layout_symbol["text-max-width"]),"text-line-height":new ri(fe.layout_symbol["text-line-height"]),"text-letter-spacing":new In(fe.layout_symbol["text-letter-spacing"]),"text-justify":new In(fe.layout_symbol["text-justify"]),"text-radial-offset":new In(fe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ri(fe.layout_symbol["text-variable-anchor"]),"text-anchor":new In(fe.layout_symbol["text-anchor"]),"text-max-angle":new ri(fe.layout_symbol["text-max-angle"]),"text-writing-mode":new ri(fe.layout_symbol["text-writing-mode"]),"text-rotate":new In(fe.layout_symbol["text-rotate"]),"text-padding":new ri(fe.layout_symbol["text-padding"]),"text-keep-upright":new ri(fe.layout_symbol["text-keep-upright"]),"text-transform":new In(fe.layout_symbol["text-transform"]),"text-offset":new In(fe.layout_symbol["text-offset"]),"text-allow-overlap":new ri(fe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ri(fe.layout_symbol["text-ignore-placement"]),"text-optional":new ri(fe.layout_symbol["text-optional"])}),ct={paint:new Po({"icon-opacity":new In(fe.paint_symbol["icon-opacity"]),"icon-color":new In(fe.paint_symbol["icon-color"]),"icon-halo-color":new In(fe.paint_symbol["icon-halo-color"]),"icon-halo-width":new In(fe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new In(fe.paint_symbol["icon-halo-blur"]),"icon-translate":new ri(fe.paint_symbol["icon-translate"]),"icon-translate-anchor":new ri(fe.paint_symbol["icon-translate-anchor"]),"text-opacity":new In(fe.paint_symbol["text-opacity"]),"text-color":new In(fe.paint_symbol["text-color"],{runtimeType:fn,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new In(fe.paint_symbol["text-halo-color"]),"text-halo-width":new In(fe.paint_symbol["text-halo-width"]),"text-halo-blur":new In(fe.paint_symbol["text-halo-blur"]),"text-translate":new ri(fe.paint_symbol["text-translate"]),"text-translate-anchor":new ri(fe.paint_symbol["text-translate-anchor"])}),layout:ze},We=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Pn,this.defaultValue=e};We.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},We.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},We.prototype.outputDefined=function(){return!1},We.prototype.serialize=function(){return null},Nn("FormatSectionOverride",We,{omit:["defaultValue"]});var jt=function(e){function t(r){e.call(this,r,ct)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,f){if(e.prototype.recalculate.call(this,r,f),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var d=this.layout.get("text-writing-mode");if(d){for(var x=[],S=0,P=d;S<P.length;S+=1){var z=P[S];x.indexOf(z)<0&&x.push(z)}this.layout._values["text-writing-mode"]=x}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,f,d,x){var z,S=this.layout.get(r).evaluate(f,{},d,x),P=this._unevaluatedLayout._values[r];return P.isDataDriven()||$u(P.value)||!S?S:(z=f.properties,S.replace(/{([^{}]+)}/g,function(ee,ue){return ue in z?String(z[ue]):""}))},t.prototype.createBucket=function(r){return new ht(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,f=ct.paint.overridableProperties;r<f.length;r+=1){var d=f[r];if(t.hasPaintOverride(this.layout,d)){var x,S=this.paint.get(d),P=new We(S),z=new yu(P,S.property.specification);x="constant"===S.value.kind||"source"===S.value.kind?new Qu("source",z):new el("composite",z,S.value.zoomStops,S.value._interpolationType),this.paint._values[d]=new mo(S.property,x,S.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,f,d){return!(!this.layout||f.isDataDriven()||d.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,f){var d=r.get("text-field"),x=ct.paint.properties[f],S=!1,P=function(ee){for(var ue=0,ye=ee;ue<ye.length;ue+=1)if(x.overrides&&x.overrides.hasOverride(ye[ue]))return void(S=!0)};if("constant"===d.value.kind&&d.value.value instanceof Za)P(d.value.value.sections);else if("source"===d.value.kind){var z=function(ee){S||(ee instanceof Fi&&Da(ee.value)===ta?P(ee.value.sections):ee instanceof vo?P(ee.sections):ee.eachChild(z))},J=d.value;J._styleExpression&&z(J._styleExpression.expression)}return S},t}(fo),$t={paint:new Po({"background-color":new ri(fe.paint_background["background-color"]),"background-pattern":new wo(fe.paint_background["background-pattern"]),"background-opacity":new ri(fe.paint_background["background-opacity"])})},Zr=function(e){function t(r){e.call(this,r,$t)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(fo),un={paint:new Po({"raster-opacity":new ri(fe.paint_raster["raster-opacity"]),"raster-hue-rotate":new ri(fe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ri(fe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ri(fe.paint_raster["raster-brightness-max"]),"raster-saturation":new ri(fe.paint_raster["raster-saturation"]),"raster-contrast":new ri(fe.paint_raster["raster-contrast"]),"raster-resampling":new ri(fe.paint_raster["raster-resampling"]),"raster-fade-duration":new ri(fe.paint_raster["raster-fade-duration"])})},ln=function(e){function t(r){e.call(this,r,un)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(fo),bn=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},t.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(fo),on={circle:Yo,heatmap:Wf,hillshade:xh,fill:ql,"fill-extrusion":Ch,line:Ap,symbol:jt,background:Zr,raster:ln},Kn=G.HTMLImageElement,kn=G.HTMLCanvasElement,Vn=G.HTMLVideoElement,Yn=G.ImageData,Hn=G.ImageBitmap,ci=function(e,t,r,f){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,f)};ci.prototype.update=function(e,t,r){var f=e.width,d=e.height,x=!(this.size&&this.size[0]===f&&this.size[1]===d||r),S=this.context,P=S.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),S.pixelStoreUnpackFlipY.set(!1),S.pixelStoreUnpack.set(1),S.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!t||!1!==t.premultiply)),x)this.size=[f,d],e instanceof Kn||e instanceof kn||e instanceof Vn||e instanceof Yn||Hn&&e instanceof Hn?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,f,d,0,this.format,P.UNSIGNED_BYTE,e.data);else{var z=r||{x:0,y:0},J=z.x,ee=z.y;e instanceof Kn||e instanceof kn||e instanceof Vn||e instanceof Yn||Hn&&e instanceof Hn?P.texSubImage2D(P.TEXTURE_2D,0,J,ee,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,J,ee,f,d,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)},ci.prototype.bind=function(e,t,r){var f=this.context.gl;f.bindTexture(f.TEXTURE_2D,this.texture),r!==f.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=f.LINEAR),e!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,t),this.wrap=t)},ci.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ci.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var qa=function(e){var t=this;this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};qa.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},qa.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Vo=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Gt(["receive","process"],this),this.invoker=new qa(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Yt()?e:G};function $l(e,t,r){var f=2*Math.PI*6378137/256/Math.pow(2,r);return[e*f-2*Math.PI*6378137/2,t*f-2*Math.PI*6378137/2]}Vo.prototype.send=function(e,t,r,f,d){var x=this;void 0===d&&(d=!1);var S=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[S]=r);var P=de(this.globalScope)?void 0:[];return this.target.postMessage({id:S,type:e,hasCallback:!!r,targetMapId:f,mustQueue:d,sourceMapId:this.mapId,data:iu(t,P)},P),{cancel:function(){r&&delete x.callbacks[S],x.target.postMessage({id:S,type:"<cancel>",targetMapId:f,sourceMapId:x.mapId})}}},Vo.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];var f=this.cancelCallbacks[r];delete this.cancelCallbacks[r],f&&f()}else Yt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},Vo.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},Vo.prototype.processTask=function(e,t){var r=this;if("<response>"===t.type){var f=this.callbacks[e];delete this.callbacks[e],f&&(t.error?f(Es(t.error)):f(null,Es(t.data)))}else{var d=!1,x=de(this.globalScope)?void 0:[],S=t.hasCallback?function(ee,ue){d=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:ee?iu(ee):null,data:iu(ue,x)},x)}:function(ee){d=!0},P=null,z=Es(t.data);if(this.parent[t.type])P=this.parent[t.type](t.sourceMapId,z,S);else if(this.parent.getWorkerSource){var J=t.type.split(".");P=this.parent.getWorkerSource(t.sourceMapId,J[0],z.source)[J[1]](z,S)}else S(new Error("Could not find function "+t.type));!d&&P&&P.cancel&&(this.cancelCallbacks[e]=P.cancel)}},Vo.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ao=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};ao.prototype.setNorthEast=function(e){return this._ne=e instanceof Fa?new Fa(e.lng,e.lat):Fa.convert(e),this},ao.prototype.setSouthWest=function(e){return this._sw=e instanceof Fa?new Fa(e.lng,e.lat):Fa.convert(e),this},ao.prototype.extend=function(e){var t,r,f=this._sw,d=this._ne;if(e instanceof Fa)t=e,r=e;else{if(!(e instanceof ao))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(ao.convert(e)):this.extend(Fa.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return f||d?(f.lng=Math.min(t.lng,f.lng),f.lat=Math.min(t.lat,f.lat),d.lng=Math.max(r.lng,d.lng),d.lat=Math.max(r.lat,d.lat)):(this._sw=new Fa(t.lng,t.lat),this._ne=new Fa(r.lng,r.lat)),this},ao.prototype.getCenter=function(){return new Fa((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ao.prototype.getSouthWest=function(){return this._sw},ao.prototype.getNorthEast=function(){return this._ne},ao.prototype.getNorthWest=function(){return new Fa(this.getWest(),this.getNorth())},ao.prototype.getSouthEast=function(){return new Fa(this.getEast(),this.getSouth())},ao.prototype.getWest=function(){return this._sw.lng},ao.prototype.getSouth=function(){return this._sw.lat},ao.prototype.getEast=function(){return this._ne.lng},ao.prototype.getNorth=function(){return this._ne.lat},ao.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ao.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ao.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ao.prototype.contains=function(e){var t=Fa.convert(e),r=t.lng,f=t.lat,d=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&d},ao.convert=function(e){return!e||e instanceof ao?e:new ao(e)};var Fa=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Fa.prototype.wrap=function(){return new Fa(Ke(this.lng,-180,180),this.lat)},Fa.prototype.toArray=function(){return[this.lng,this.lat]},Fa.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Fa.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,f=e.lat*t,d=Math.sin(r)*Math.sin(f)+Math.cos(r)*Math.cos(f)*Math.cos((e.lng-this.lng)*t);return 6371008.8*Math.acos(Math.min(d,1))},Fa.prototype.toBounds=function(e){void 0===e&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new ao(new Fa(this.lng-r,this.lat-t),new Fa(this.lng+r,this.lat+t))},Fa.convert=function(e){if(e instanceof Fa)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Fa(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Fa(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var zs=2*Math.PI*6371008.8;function Xu(e){return zs*Math.cos(e*Math.PI/180)}function Ou(e){return(180+e)/360}function Mh(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Ku(e,t){return e/Xu(t)}function Qf(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var eh=function(e,t,r){void 0===r&&(r=0),this.x=+e,this.y=+t,this.z=+r};eh.fromLngLat=function(e,t){void 0===t&&(t=0);var r=Fa.convert(e);return new eh(Ou(r.lng),Mh(r.lat),Ku(t,r.lat))},eh.prototype.toLngLat=function(){return new Fa(360*this.x-180,Qf(this.y))},eh.prototype.toAltitude=function(){return this.z*Xu(Qf(this.y))},eh.prototype.meterInMercatorCoordinateUnits=function(){return 1/zs*(e=Qf(this.y),1/Math.cos(e*Math.PI/180));var e};var Zc=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=op(0,e,e,t,r)};Zc.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Zc.prototype.url=function(e,t){var r,f,d,x,S,P=(f=this.y,d=this.z,x=$l(256*(r=this.x),256*(f=Math.pow(2,d)-f-1),d),S=$l(256*(r+1),256*(f+1),d),x[0]+","+x[1]+","+S[0]+","+S[1]),z=function(J,ee,ue){for(var ye,Se="",qe=J;qe>0;qe--)Se+=(ee&(ye=1<<qe-1)?1:0)+(ue&ye?2:0);return Se}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",P)},Zc.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new B(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Zc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var td=function(e,t){this.wrap=e,this.canonical=t,this.key=op(e,t.z,t.z,t.x,t.y)},cs=function(e,t,r,f,d){this.overscaledZ=e,this.wrap=t,this.canonical=new Zc(r,+f,+d),this.key=op(t,e,r,f,d)};function op(e,t,r,f,d){(e*=2)<0&&(e=-1*e-1);var x=1<<r;return(x*x*e+x*d+f).toString(36)+r.toString(36)+t.toString(36)}cs.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},cs.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new cs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new cs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},cs.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?op(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):op(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},cs.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},cs.prototype.children=function(e){if(this.overscaledZ>=e)return[new cs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,f=2*this.canonical.y;return[new cs(t,this.wrap,t,r,f),new cs(t,this.wrap,t,r+1,f),new cs(t,this.wrap,t,r,f+1),new cs(t,this.wrap,t,r+1,f+1)]},cs.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},cs.prototype.wrapped=function(){return new cs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},cs.prototype.unwrapTo=function(e){return new cs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},cs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},cs.prototype.toUnwrapped=function(){return new td(this.wrap,this.canonical)},cs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},cs.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new eh(e.x-this.wrap,e.y))},Nn("CanonicalTileID",Zc),Nn("OverscaledTileID",cs,{omit:["posMatrix"]});var _f=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return Xe('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var f=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var d=0;d<f;d++)this.data[this._idx(-1,d)]=this.data[this._idx(0,d)],this.data[this._idx(f,d)]=this.data[this._idx(f-1,d)],this.data[this._idx(d,-1)]=this.data[this._idx(d,0)],this.data[this._idx(d,f)]=this.data[this._idx(d,f-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(f,-1)]=this.data[this._idx(f-1,0)],this.data[this._idx(-1,f)]=this.data[this._idx(0,f-1)],this.data[this._idx(f,f)]=this.data[this._idx(f-1,f-1)]};_f.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),f=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[f],r[f+1],r[f+2])},_f.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},_f.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},_f.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},_f.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},_f.prototype.getPixels=function(){return new ca({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},_f.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var f=t*this.dim,d=t*this.dim+this.dim,x=r*this.dim,S=r*this.dim+this.dim;switch(t){case-1:f=d-1;break;case 1:d=f+1}switch(r){case-1:x=S-1;break;case 1:S=x+1}for(var P=-t*this.dim,z=-r*this.dim,J=x;J<S;J++)for(var ee=f;ee<d;ee++)this.data[this._idx(ee,J)]=e.data[this._idx(ee+P,J+z)]},Nn("DEMData",_f);var th=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};th.prototype.encode=function(e){return this._stringToNumber[e]},th.prototype.decode=function(e){return this._numberToString[e]};var rh=function(e,t,r,f,d){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=f,this.properties=e.properties,this.id=d},Oh={geometry:{configurable:!0}};Oh.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Oh.geometry.set=function(e){this._geometry=e},rh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e},Object.defineProperties(rh.prototype,Oh);var Rf=function(){this.state={},this.stateChanges={},this.deletedStates={}};Rf.prototype.updateState=function(e,t,r){var f=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},xt(this.stateChanges[e][f],r),null===this.deletedStates[e])for(var d in this.deletedStates[e]={},this.state[e])d!==f&&(this.deletedStates[e][d]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][f])for(var x in this.deletedStates[e][f]={},this.state[e][f])r[x]||(this.deletedStates[e][f][x]=null);else for(var S in r)this.deletedStates[e]&&this.deletedStates[e][f]&&null===this.deletedStates[e][f][S]&&delete this.deletedStates[e][f][S]},Rf.prototype.removeFeatureState=function(e,t,r){if(null!==this.deletedStates[e]){var f=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][f]&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][f])for(r in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][r]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}},Rf.prototype.getState=function(e,t){var r=String(t),f=xt({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var d=this.deletedStates[e][t];if(null===d)return{};for(var x in d)delete f[x]}return f},Rf.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Rf.prototype.coalesceChanges=function(e,t){var r={};for(var f in this.stateChanges){this.state[f]=this.state[f]||{};var d={};for(var x in this.stateChanges[f])this.state[f][x]||(this.state[f][x]={}),xt(this.state[f][x],this.stateChanges[f][x]),d[x]=this.state[f][x];r[f]=d}for(var S in this.deletedStates){this.state[S]=this.state[S]||{};var P={};if(null===this.deletedStates[S])for(var z in this.state[S])P[z]={},this.state[S][z]={};else for(var J in this.deletedStates[S]){if(null===this.deletedStates[S][J])this.state[S][J]={};else for(var ee=0,ue=Object.keys(this.deletedStates[S][J]);ee<ue.length;ee+=1)delete this.state[S][J][ue[ee]];P[J]=this.state[S][J]}r[S]=r[S]||{},xt(r[S],P)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var ye in e)e[ye].setFeatureState(r,t)};var Ql=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new _u(8192,16,0),this.grid3D=new _u(8192,16,0),this.featureIndexArray=new ce,this.promoteId=t};function sp(e,t,r,f,d){return Vt(e,function(x,S){var P=t instanceof il?t.get(S):null;return P&&P.evaluate?P.evaluate(r,f,d):P})}function vd(e){for(var t=1/0,r=1/0,f=-1/0,d=-1/0,x=0,S=e;x<S.length;x+=1){var P=S[x];t=Math.min(t,P.x),r=Math.min(r,P.y),f=Math.max(f,P.x),d=Math.max(d,P.y)}return{minX:t,minY:r,maxX:f,maxY:d}}function Zd(e,t){return t-e}Ql.prototype.insert=function(e,t,r,f,d,x){var S=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,f,d);for(var P=x?this.grid3D:this.grid,z=0;z<t.length;z++){for(var J=t[z],ee=[1/0,1/0,-1/0,-1/0],ue=0;ue<J.length;ue++){var ye=J[ue];ee[0]=Math.min(ee[0],ye.x),ee[1]=Math.min(ee[1],ye.y),ee[2]=Math.max(ee[2],ye.x),ee[3]=Math.max(ee[3],ye.y)}ee[0]<8192&&ee[1]<8192&&ee[2]>=0&&ee[3]>=0&&P.insert(S,ee[0],ee[1],ee[2],ee[3])}},Ql.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new gf.VectorTile(new zc(this.rawTileData)).layers,this.sourceLayerCoder=new th(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ql.prototype.query=function(e,t,r,f){var d=this;this.loadVTLayers();for(var x=e.params||{},S=8192/e.tileSize/e.scale,P=Nu(x.filter),z=e.queryGeometry,J=e.queryPadding*S,ee=vd(z),ue=this.grid.query(ee.minX-J,ee.minY-J,ee.maxX+J,ee.maxY+J),ye=vd(e.cameraQueryGeometry),qe=0,Je=this.grid3D.query(ye.minX-J,ye.minY-J,ye.maxX+J,ye.maxY+J,function(gr,xr,Rr,nn){return function(gn,ii,Fn,fi,Zn){for(var na=0,wi=gn;na<wi.length;na+=1){var Qn=wi[na];if(ii<=Qn.x&&Fn<=Qn.y&&fi>=Qn.x&&Zn>=Qn.y)return!0}var da=[new B(ii,Fn),new B(ii,Zn),new B(fi,Zn),new B(fi,Fn)];if(gn.length>2)for(var Yi=0,Aa=da;Yi<Aa.length;Yi+=1)if(Ha(gn,Aa[Yi]))return!0;for(var di=0;di<gn.length-1;di++)if(Wa(gn[di],gn[di+1],da))return!0;return!1}(e.cameraQueryGeometry,gr-J,xr-J,Rr+J,nn+J)});qe<Je.length;qe+=1)ue.push(Je[qe]);ue.sort(Zd);for(var Tt,st={},Nt=function(gr){var xr=ue[gr];if(xr!==Tt){Tt=xr;var Rr=d.featureIndexArray.get(xr),nn=null;d.loadMatchingFeature(st,Rr.bucketIndex,Rr.sourceLayerIndex,Rr.featureIndex,P,x.layers,x.availableImages,t,r,f,function(gn,ii,Fn){return nn||(nn=vt(gn)),ii.queryIntersectsFeature(z,gn,Fn,nn,d.z,e.transform,S,e.pixelPosMatrix)})}},Qt=0;Qt<ue.length;Qt++)Nt(Qt);return st},Ql.prototype.loadMatchingFeature=function(e,t,r,f,d,x,S,P,z,J,ee){var ue=this.bucketLayerIDs[t];if(!x||function(gn,ii){for(var Fn=0;Fn<gn.length;Fn++)if(ii.indexOf(gn[Fn])>=0)return!0;return!1}(x,ue)){var ye=this.sourceLayerCoder.decode(r),Se=this.vtLayers[ye].feature(f);if(d.needGeometry){var qe=Rt(Se,!0);if(!d.filter(new $i(this.tileID.overscaledZ),qe,this.tileID.canonical))return}else if(!d.filter(new $i(this.tileID.overscaledZ),Se))return;for(var Je=this.getId(Se,ye),Tt=0;Tt<ue.length;Tt++){var st=ue[Tt];if(!(x&&x.indexOf(st)<0)){var Nt=P[st];if(Nt){var Qt={};void 0!==Je&&J&&(Qt=J.getState(Nt.sourceLayer||"_geojsonTileLayer",Je));var gr=xt({},z[st]);gr.paint=sp(gr.paint,Nt.paint,Se,Qt,S),gr.layout=sp(gr.layout,Nt.layout,Se,Qt,S);var xr=!ee||ee(Se,Nt,Qt);if(xr){var Rr=new rh(Se,this.z,this.x,this.y,Je);Rr.layer=gr;var nn=e[st];void 0===nn&&(nn=e[st]=[]),nn.push({featureIndex:f,feature:Rr,intersectionZ:xr})}}}}}},Ql.prototype.lookupSymbolFeatures=function(e,t,r,f,d,x,S,P){var z={};this.loadVTLayers();for(var J=Nu(d),ee=0,ue=e;ee<ue.length;ee+=1)this.loadMatchingFeature(z,r,f,ue[ee],J,x,S,P,t);return z},Ql.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var f=0,d=r[t];f<d.length;f+=1)if(e===d[f])return!0;return!1},Ql.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&"boolean"==typeof(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(r=Number(r)),r},Nn("FeatureIndex",Ql,{omit:["rawTileData","sourceLayerCoder"]});var Is=function(e,t){this.tileID=e,this.uid=Et(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Is.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Ir.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Is.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Is.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var f in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(J,ee){var ue={};if(!ee)return ue;for(var ye=function(){var Je=qe[Se],Tt=Je.layerIds.map(function(Qt){return ee.getLayer(Qt)}).filter(Boolean);if(0!==Tt.length){Je.layers=Tt,Je.stateDependentLayerIds&&(Je.stateDependentLayers=Je.stateDependentLayerIds.map(function(Qt){return Tt.filter(function(gr){return gr.id===Qt})[0]}));for(var st=0,Nt=Tt;st<Nt.length;st+=1)ue[Nt[st].id]=Je}},Se=0,qe=J;Se<qe.length;Se+=1)ye();return ue}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var d=this.buckets[f];if(d instanceof ht){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var x in this.buckets){var S=this.buckets[x];if(S instanceof ht&&S.hasRTLText){this.hasRTLText=!0,Cs.isLoading()||Cs.isLoaded()||"deferred"!==Lc()||Ws();break}}for(var P in this.queryPadding=0,this.buckets){var z=this.buckets[P];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(P).queryRadius(z))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Is.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Is.prototype.getBucket=function(e){return this.buckets[e.id]},Is.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var f=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ci(e,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ci(e,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null)},Is.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Is.prototype.queryRenderedFeatures=function(e,t,r,f,d,x,S,P,z,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:f,cameraQueryGeometry:d,scale:x,tileSize:this.tileSize,pixelPosMatrix:J,transform:P,params:S,queryPadding:this.queryPadding*z},e,t,r):{}},Is.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var f=r.loadVTLayers(),d=t?t.sourceLayer:"",x=f._geojsonTileLayer||f[d];if(x)for(var S=Nu(t&&t.filter),P=this.tileID.canonical,z=P.z,J=P.x,ee=P.y,ue={z,x:J,y:ee},ye=0;ye<x.length;ye++){var Se=x.feature(ye);if(S.needGeometry){var qe=Rt(Se,!0);if(!S.filter(new $i(this.tileID.overscaledZ),qe,this.tileID.canonical))continue}else if(!S.filter(new $i(this.tileID.overscaledZ),Se))continue;var Je=r.getId(Se,d),Tt=new rh(Se,z,J,ee,Je);Tt.tile=ue,e.push(Tt)}}},Is.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Is.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Is.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=Er(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var f=Date.now(),d=!1;if(this.expirationTime>f)d=!1;else if(t)if(this.expirationTime<t)d=!0;else{var x=this.expirationTime-t;x?this.expirationTime=f+Math.max(x,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Is.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Is.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var r=this.latestFeatureIndex.loadVTLayers();for(var f in this.buckets)if(t.style.hasLayer(f)){var d=this.buckets[f],x=d.layers[0].sourceLayer||"_geojsonTileLayer",S=r[x],P=e[x];if(S&&P&&0!==Object.keys(P).length){d.update(P,S,this.imageAtlas&&this.imageAtlas.patternPositions||{});var z=t&&t.style&&t.style.getLayer(f);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(d)))}}}},Is.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Is.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ir.now()},Is.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Is.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Ir.now()+e},Is.prototype.setDependencies=function(e,t){for(var r={},f=0,d=t;f<d.length;f+=1)r[d[f]]=!0;this.dependencies[e]=r},Is.prototype.hasDependency=function(e,t){for(var r=0,f=e;r<f.length;r+=1){var d=this.dependencies[f[r]];if(d)for(var x=0,S=t;x<S.length;x+=1)if(d[S[x]])return!0}return!1};var xf=G.performance,Il=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},xf.mark(this._marks.start)};Il.prototype.finish=function(){xf.mark(this._marks.end);var e=xf.getEntriesByName(this._marks.measure);return 0===e.length&&(xf.measure(this._marks.measure,this._marks.start,this._marks.end),e=xf.getEntriesByName(this._marks.measure),xf.clearMarks(this._marks.start),xf.clearMarks(this._marks.end),xf.clearMeasures(this._marks.measure)),e},c.Actor=Vo,c.AlphaImage=Wu,c.CanonicalTileID=Zc,c.CollisionBoxArray=s,c.Color=Xi,c.DEMData=_f,c.DataConstantProperty=ri,c.DictionaryCoder=th,c.EXTENT=8192,c.ErrorEvent=xe,c.EvaluationParameters=$i,c.Event=ae,c.Evented=Oe,c.FeatureIndex=Ql,c.FillBucket=Ns,c.FillExtrusionBucket=Ps,c.ImageAtlas=An,c.ImagePosition=yr,c.LineBucket=Zo,c.LngLat=Fa,c.LngLatBounds=ao,c.MercatorCoordinate=eh,c.ONE_EM=24,c.OverscaledTileID=cs,c.Point=B,c.Point$1=B,c.Properties=Po,c.Protobuf=zc,c.RGBAImage=ca,c.RequestManager=Pr,c.RequestPerformance=Il,c.ResourceType=On,c.SegmentVector=Ie,c.SourceFeatureState=Rf,c.StructArrayLayout1ui2=fc,c.StructArrayLayout2f1f2i16=ol,c.StructArrayLayout2i4=As,c.StructArrayLayout3ui6=sl,c.StructArrayLayout4i8=bl,c.SymbolBucket=ht,c.Texture=ci,c.Tile=Is,c.Transitionable=Ko,c.Uniform1f=Qr,c.Uniform1i=Dr,c.Uniform2f=Xr,c.Uniform3f=dn,c.Uniform4f=qn,c.UniformColor=jn,c.UniformMatrix4f=Li,c.UnwrappedTileID=td,c.ValidationError=Ae,c.WritingMode=Mr,c.ZoomHistory=Xc,c.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},c.addDynamicAttributes=Ut,c.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var f=e.length,d=new Array(e.length),x=null;e.forEach(function(S,P){t(S,function(z,J){z&&(x=z),d[P]=J,0==--f&&r(x,d)})})},c.bezier=Be,c.bindAll=Gt,c.browser=Ir,c.cacheEntryPossiblyAdded=function(e){++pr>vr&&(e.getActor().send("enforceCacheSizeLimit",Tr),pr=0)},c.clamp=W,c.clearTileCache=function(e){var t=G.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},c.clipLine=ss,c.clone=function(e){var t=new ki(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},c.clone$1=Ue,c.clone$2=function(e){var t=new ki(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},c.collisionCircleLayout=Mp,c.config=Mt,c.create=function(){var e=new ki(16);return ki!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},c.create$1=function(){var e=new ki(9);return ki!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},c.create$2=function(){var e=new ki(4);return ki!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},c.createCommonjsModule=g,c.createExpression=pl,c.createLayout=zo,c.createStyleLayer=function(e){return"custom"===e.type?new bn(e):new on[e.type](e)},c.cross=function(e,t,r){var f=t[0],d=t[1],x=t[2],S=r[0],P=r[1],z=r[2];return e[0]=d*z-x*P,e[1]=x*S-f*z,e[2]=f*P-d*S,e},c.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var f=0;f<t.length;f++)if(!e(t[f],r[f]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r||Object.keys(t).length!==Object.keys(r).length)return!1;for(var d in t)if(!e(t[d],r[d]))return!1;return!0}return t===r},c.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},c.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},c.ease=j,c.emitValidationErrors=ml,c.endsWith=Q,c.enforceCacheSizeLimit=function(e){Xt(),yt&&yt.then(function(t){t.keys().then(function(r){for(var f=0;f<r.length-e;f++)t.delete(r[f])})})},c.evaluateSizeForFeature=Zi,c.evaluateSizeForZoom=fa,c.evaluateVariableOffset=Qe,c.evented=cf,c.extend=xt,c.featureFilter=Nu,c.filterObject=ot,c.fromRotation=function(e,t){var r=Math.sin(t),f=Math.cos(t);return e[0]=f,e[1]=r,e[2]=0,e[3]=-r,e[4]=f,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},c.getAnchorAlignment=zi,c.getAnchorJustification=dr,c.getArrayBuffer=Pi,c.getImage=pe,c.getJSON=function(e,t){return Ki(xt(e,{type:"json"}),t)},c.getRTLTextPluginStatus=Lc,c.getReferrer=hi,c.getVideo=function(e,t){var r,f,d=G.document.createElement("video");d.muted=!0,d.onloadstart=function(){t(null,d)};for(var x=0;x<e.length;x++){var S=G.document.createElement("source");r=e[x],f=void 0,(f=G.document.createElement("a")).href=r,(f.protocol!==G.document.location.protocol||f.host!==G.document.location.host)&&(d.crossOrigin="Anonymous"),S.src=e[x],d.appendChild(S)}return{cancel:function(){}}},c.identity=Ca,c.invert=function(e,t){var r=t[0],f=t[1],d=t[2],x=t[3],S=t[4],P=t[5],z=t[6],J=t[7],ee=t[8],ue=t[9],ye=t[10],Se=t[11],qe=t[12],Je=t[13],Tt=t[14],st=t[15],Nt=r*P-f*S,Qt=r*z-d*S,gr=r*J-x*S,xr=f*z-d*P,Rr=f*J-x*P,nn=d*J-x*z,gn=ee*Je-ue*qe,ii=ee*Tt-ye*qe,Fn=ee*st-Se*qe,fi=ue*Tt-ye*Je,Zn=ue*st-Se*Je,na=ye*st-Se*Tt,wi=Nt*na-Qt*Zn+gr*fi+xr*Fn-Rr*ii+nn*gn;return wi?(e[0]=(P*na-z*Zn+J*fi)*(wi=1/wi),e[1]=(d*Zn-f*na-x*fi)*wi,e[2]=(Je*nn-Tt*Rr+st*xr)*wi,e[3]=(ye*Rr-ue*nn-Se*xr)*wi,e[4]=(z*Fn-S*na-J*ii)*wi,e[5]=(r*na-d*Fn+x*ii)*wi,e[6]=(Tt*gr-qe*nn-st*Qt)*wi,e[7]=(ee*nn-ye*gr+Se*Qt)*wi,e[8]=(S*Zn-P*Fn+J*gn)*wi,e[9]=(f*Fn-r*Zn-x*gn)*wi,e[10]=(qe*Rr-Je*gr+st*Nt)*wi,e[11]=(ue*gr-ee*Rr-Se*Nt)*wi,e[12]=(P*ii-S*fi-z*gn)*wi,e[13]=(r*fi-f*ii+d*gn)*wi,e[14]=(Je*Qt-qe*xr-Tt*Nt)*wi,e[15]=(ee*xr-ue*Qt+ye*Nt)*wi,e):null},c.isChar=hn,c.isMapboxURL=er,c.keysDifference=function(e,t){var r=[];for(var f in e)f in t||r.push(f);return r},c.makeRequest=Ki,c.mapObject=Vt,c.mercatorXfromLng=Ou,c.mercatorYfromLat=Mh,c.mercatorZfromAltitude=Ku,c.mul=Kl,c.multiply=ba,c.mvt=gf,c.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},c.normalize=function(e,t){var r=t[0],f=t[1],d=t[2],x=r*r+f*f+d*d;return x>0&&(x=1/Math.sqrt(x)),e[0]=t[0]*x,e[1]=t[1]*x,e[2]=t[2]*x,e},c.number=Oa,c.offscreenCanvasSupported=mn,c.ortho=function(e,t,r,f,d,x,S){var P=1/(t-r),z=1/(f-d),J=1/(x-S);return e[0]=-2*P,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*z,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*J,e[11]=0,e[12]=(t+r)*P,e[13]=(d+f)*z,e[14]=(S+x)*J,e[15]=1,e},c.parseGlyphPBF=function(e){return new zc(e).readFields(pn,[])},c.pbf=zc,c.performSymbolLayout=function(e,t,r,f,d,x,S){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var P=e.layers[0].layout,z=e.layers[0]._unevaluatedLayout._values,J={};if("composite"===e.textSizeData.kind){var ee=e.textSizeData,ue=ee.maxZoom;J.compositeTextSizes=[z["text-size"].possiblyEvaluate(new $i(ee.minZoom),S),z["text-size"].possiblyEvaluate(new $i(ue),S)]}if("composite"===e.iconSizeData.kind){var ye=e.iconSizeData,Se=ye.maxZoom;J.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new $i(ye.minZoom),S),z["icon-size"].possiblyEvaluate(new $i(Se),S)]}J.layoutTextSize=z["text-size"].possiblyEvaluate(new $i(e.zoom+1),S),J.layoutIconSize=z["icon-size"].possiblyEvaluate(new $i(e.zoom+1),S),J.textMaxSize=z["text-size"].possiblyEvaluate(new $i(18));for(var qe=24*P.get("text-line-height"),Je="map"===P.get("text-rotation-alignment")&&"point"!==P.get("symbol-placement"),Tt=P.get("text-keep-upright"),st=P.get("text-size"),Nt=function(){var xr=gr[Qt],Rr=P.get("text-font").evaluate(xr,{},S).join(","),nn=st.evaluate(xr,{},S),gn=J.layoutTextSize.evaluate(xr,{},S),ii=J.layoutIconSize.evaluate(xr,{},S),Fn={horizontal:{},vertical:void 0},fi=xr.text,Zn=[0,0];if(fi){var na=fi.toString(),wi=24*P.get("text-letter-spacing").evaluate(xr,{},S),Qn=function(Sa){for(var Ja=0,Xa=Sa;Ja<Xa.length;Ja+=1)if(qi=Xa[Ja].charCodeAt(0),hn.Arabic(qi)||hn["Arabic Supplement"](qi)||hn["Arabic Extended-A"](qi)||hn["Arabic Presentation Forms-A"](qi)||hn["Arabic Presentation Forms-B"](qi))return!1;var qi;return!0}(na)?wi:0,da=P.get("text-anchor").evaluate(xr,{},S),Yi=P.get("text-variable-anchor");if(!Yi){var Aa=P.get("text-radial-offset").evaluate(xr,{},S);Zn=Aa?Qe(da,[24*Aa,Pl]):P.get("text-offset").evaluate(xr,{},S).map(function(Sa){return 24*Sa})}var di=Je?"center":P.get("text-justify").evaluate(xr,{},S),Ra=P.get("symbol-placement"),Co="point"===Ra?24*P.get("text-max-width").evaluate(xr,{},S):0,Ao=function(){e.allowVerticalPlacement&&Kc(na)&&(Fn.vertical=ui(fi,t,r,d,Rr,Co,qe,da,"left",Qn,Zn,Mr.vertical,!0,Ra,gn,nn))};if(!Je&&Yi){for(var Do="auto"===di?Yi.map(function(Sa){return dr(Sa)}):[di],ho=!1,Oo=0;Oo<Do.length;Oo++){var xs=Do[Oo];if(!Fn.horizontal[xs])if(ho)Fn.horizontal[xs]=Fn.horizontal[0];else{var bs=ui(fi,t,r,d,Rr,Co,qe,"center",xs,Qn,Zn,Mr.horizontal,!1,Ra,gn,nn);bs&&(Fn.horizontal[xs]=bs,ho=1===bs.positionedLines.length)}}Ao()}else{"auto"===di&&(di=dr(da));var fu=ui(fi,t,r,d,Rr,Co,qe,da,di,Qn,Zn,Mr.horizontal,!1,Ra,gn,nn);fu&&(Fn.horizontal[di]=fu),Ao(),Kc(na)&&Je&&Tt&&(Fn.vertical=ui(fi,t,r,d,Rr,Co,qe,da,di,Qn,Zn,Mr.vertical,!1,Ra,gn,nn))}}var Sa,Ja,qi,$s,Zs,Ms=void 0,hu=!1;if(xr.icon&&xr.icon.name){var Bo=f[xr.icon.name];Bo&&(Sa=d[xr.icon.name],Ja=P.get("icon-offset").evaluate(xr,{},S),qi=zi(P.get("icon-anchor").evaluate(xr,{},S)),Ms={image:Sa,top:Zs=Ja[1]-Sa.displaySize[1]*qi.verticalAlign,bottom:Zs+Sa.displaySize[1],left:$s=Ja[0]-Sa.displaySize[0]*qi.horizontalAlign,right:$s+Sa.displaySize[0]},hu=Bo.sdf,void 0===e.sdfIcons?e.sdfIcons=Bo.sdf:e.sdfIcons!==Bo.sdf&&Xe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Bo.pixelRatio!==e.pixelRatio||0!==P.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var Os=zn(Fn.horizontal)||Fn.vertical;e.iconsInText=!!Os&&Os.iconsInText,(Os||Ms)&&function(Sa,Ja,Xa,qi,$s,Zs,yo,fs,Ss,Pa,vc){var cl=Zs.textMaxSize.evaluate(Ja,{});void 0===cl&&(cl=yo);var Ml,Fo=Sa.layers[0].layout,Uc=Fo.get("icon-offset").evaluate(Ja,{},vc),Yu=zn(Xa.horizontal),mc=yo/24,Df=Sa.tilePixelRatio*mc,nh=Sa.tilePixelRatio*cl/24,af=Sa.tilePixelRatio*fs,ih=Sa.tilePixelRatio*Fo.get("symbol-spacing"),Lh=Fo.get("text-padding")*Sa.tilePixelRatio,ah=Fo.get("icon-padding")*Sa.tilePixelRatio,oh=Fo.get("text-max-angle")/180*Math.PI,kh="map"===Fo.get("text-rotation-alignment")&&"point"!==Fo.get("symbol-placement"),Rh="map"===Fo.get("icon-rotation-alignment")&&"point"!==Fo.get("symbol-placement"),jc=Fo.get("symbol-placement"),sh=ih/2,uh=Fo.get("icon-text-fit");qi&&"none"!==uh&&(Sa.allowVerticalPlacement&&Xa.vertical&&(Ml=Cn(qi,Xa.vertical,uh,Fo.get("icon-text-fit-padding"),Uc,mc)),Yu&&(qi=Cn(qi,Yu,uh,Fo.get("icon-text-fit-padding"),Uc,mc)));var gc=function(md,jh){jh.x<0||jh.x>=8192||jh.y<0||jh.y>=8192||function(Go,yc,gd,wf,Vh,yd,Gh,_c,Hh,Nf,ph,pu,Wh,zf,pp,kp,nd,_d,Xh,dh,qu,Kh,Rp,Lu,Dp){var Yh,Zf,vh,xc,mh,gh=Go.addToLineVertexArray(yc,gd),xd=0,bd=0,Sd=0,wd=0,id=-1,ad=-1,Ef={},Bp=Ye(""),qh=0,od=0;if(void 0===_c._unevaluatedLayout.getValue("text-radial-offset")?(qh=(Yh=_c.layout.get("text-offset").evaluate(qu,{},Lu).map(function(mp){return 24*mp}))[0],od=Yh[1]):(qh=24*_c.layout.get("text-radial-offset").evaluate(qu,{},Lu),od=Pl),Go.allowVerticalPlacement&&wf.vertical){var Fp=_c.layout.get("text-rotate").evaluate(qu,{},Lu)+90;xc=new ka(Hh,yc,Nf,ph,pu,wf.vertical,Wh,zf,pp,Fp),Gh&&(mh=new ka(Hh,yc,Nf,ph,pu,Gh,nd,_d,pp,Fp))}if(Vh){var Np=_c.layout.get("icon-rotate").evaluate(qu,{}),Ed="none"!==_c.layout.get("icon-text-fit"),zp=ms(Vh,Np,Rp,Ed),Zp=Gh?ms(Gh,Np,Rp,Ed):void 0;vh=new ka(Hh,yc,Nf,ph,pu,Vh,nd,_d,!1,Np),xd=4*zp.length;var Td=Go.iconSizeData,yh=null;"source"===Td.kind?(yh=[128*_c.layout.get("icon-size").evaluate(qu,{})])[0]>32640&&Xe(Go.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Td.kind&&((yh=[128*Kh.compositeIconSizes[0].evaluate(qu,{},Lu),128*Kh.compositeIconSizes[1].evaluate(qu,{},Lu)])[0]>32640||yh[1]>32640)&&Xe(Go.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Go.addSymbols(Go.icon,zp,yh,dh,Xh,qu,!1,yc,gh.lineStartIndex,gh.lineLength,-1,Lu),id=Go.icon.placedSymbolArray.length-1,Zp&&(bd=4*Zp.length,Go.addSymbols(Go.icon,Zp,yh,dh,Xh,qu,Mr.vertical,yc,gh.lineStartIndex,gh.lineLength,-1,Lu),ad=Go.icon.placedSymbolArray.length-1)}for(var sd in wf.horizontal){var Up=wf.horizontal[sd];if(!Zf){Bp=Ye(Up.text);var dp=_c.layout.get("text-rotate").evaluate(qu,{},Lu);Zf=new ka(Hh,yc,Nf,ph,pu,Up,Wh,zf,pp,dp)}var ud=1===Up.positionedLines.length;if(Sd+=tr(Go,yc,Up,yd,_c,pp,qu,kp,gh,wf.vertical?Mr.horizontal:Mr.horizontalOnly,ud?Object.keys(wf.horizontal):[sd],Ef,id,Kh,Lu),ud)break}wf.vertical&&(wd+=tr(Go,yc,wf.vertical,yd,_c,pp,qu,kp,gh,Mr.vertical,["vertical"],Ef,ad,Kh,Lu));var Ud=Zf?Zf.boxStartIndex:Go.collisionBoxArray.length,Uf=Zf?Zf.boxEndIndex:Go.collisionBoxArray.length,ld=xc?xc.boxStartIndex:Go.collisionBoxArray.length,vp=xc?xc.boxEndIndex:Go.collisionBoxArray.length,Cd=vh?vh.boxStartIndex:Go.collisionBoxArray.length,Ad=vh?vh.boxEndIndex:Go.collisionBoxArray.length,_h=mh?mh.boxStartIndex:Go.collisionBoxArray.length,Pd=mh?mh.boxEndIndex:Go.collisionBoxArray.length,Vc=-1,jp=function(mp,Md){return mp&&mp.circleDiameter?Math.max(mp.circleDiameter,Md):Md};Vc=jp(Zf,Vc),Vc=jp(xc,Vc),Vc=jp(vh,Vc);var Id=(Vc=jp(mh,Vc))>-1?1:0;Id&&(Vc*=Dp/24),Go.glyphOffsetArray.length>=ht.MAX_GLYPHS&&Xe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==qu.sortKey&&Go.addToSortKeyRanges(Go.symbolInstances.length,qu.sortKey),Go.symbolInstances.emplaceBack(yc.x,yc.y,Ef.right>=0?Ef.right:-1,Ef.center>=0?Ef.center:-1,Ef.left>=0?Ef.left:-1,Ef.vertical||-1,id,ad,Bp,Ud,Uf,ld,vp,Cd,Ad,_h,Pd,Nf,Sd,wd,xd,bd,Id,0,Wh,qh,od,Vc)}(Sa,jh,md,Xa,qi,$s,Ml,Sa.layers[0],Sa.collisionBoxArray,Ja.index,Ja.sourceLayerIndex,Sa.index,Df,Lh,kh,Ss,af,ah,Rh,Uc,Ja,Zs,Pa,vc,yo)};if("line"===jc)for(var bf=0,Dh=ss(Ja.geometry,0,0,8192,8192);bf<Dh.length;bf+=1)for(var up=Dh[bf],Bh=0,Fh=Uo(up,ih,oh,Xa.vertical||Yu,qi,24,nh,Sa.overscaling,8192);Bh<Fh.length;Bh+=1){var lp=Fh[Bh];Yu&&ya(Sa,Yu.text,sh,lp)||gc(up,lp)}else if("line-center"===jc)for(var Sf=0,lh=Ja.geometry;Sf<lh.length;Sf+=1){var ch=lh[Sf];if(ch.length>1){var Nh=vs(ch,oh,Xa.vertical||Yu,qi,24,nh);Nh&&gc(ch,Nh)}}else if("Polygon"===Ja.type)for(var Bf=0,zh=If(Ja.geometry,0);Bf<zh.length;Bf+=1){var fh=zh[Bf],Zh=pa(fh,16);gc(fh[0],new Tn(Zh.x,Zh.y,0))}else if("LineString"===Ja.type)for(var Ff=0,Uh=Ja.geometry;Ff<Uh.length;Ff+=1){var hh=Uh[Ff];gc(hh,new Tn(hh[0].x,hh[0].y,0))}else if("Point"===Ja.type)for(var cp=0,rd=Ja.geometry;cp<rd.length;cp+=1)for(var fp=0,Lp=rd[cp];fp<Lp.length;fp+=1){var hp=Lp[fp];gc([hp],new Tn(hp.x,hp.y,0))}}(e,xr,Fn,Ms,f,J,gn,ii,Zn,hu,S)},Qt=0,gr=e.features;Qt<gr.length;Qt+=1)Nt();x&&e.generateCollisionDebugBuffers()},c.perspective=function(e,t,r,f,d){var x,S=1/Math.tan(t/2);return e[0]=S/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=S,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=d&&d!==1/0?(e[10]=(d+f)*(x=1/(f-d)),e[14]=2*d*f*x):(e[10]=-1,e[14]=-2*f),e},c.pick=function(e,t){for(var r={},f=0;f<t.length;f++){var d=t[f];d in e&&(r[d]=e[d])}return r},c.plugin=Cs,c.polygonIntersectsPolygon=Vr,c.postMapLoadEvent=Jt,c.postTurnstileEvent=St,c.potpack=Zt,c.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],c.register=Nn,c.registerForPluginStateChange=function(e){return e({pluginStatus:Ds,pluginURL:Hs}),cf.on("pluginStateChange",e),e},c.renderColorRamp=Tl,c.rotate=function(e,t,r){var f=t[0],d=t[1],x=t[2],S=t[3],P=Math.sin(r),z=Math.cos(r);return e[0]=f*z+x*P,e[1]=d*z+S*P,e[2]=f*-P+x*z,e[3]=d*-P+S*z,e},c.rotateX=function(e,t,r){var f=Math.sin(r),d=Math.cos(r),x=t[4],S=t[5],P=t[6],z=t[7],J=t[8],ee=t[9],ue=t[10],ye=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=x*d+J*f,e[5]=S*d+ee*f,e[6]=P*d+ue*f,e[7]=z*d+ye*f,e[8]=J*d-x*f,e[9]=ee*d-S*f,e[10]=ue*d-P*f,e[11]=ye*d-z*f,e},c.rotateZ=function(e,t,r){var f=Math.sin(r),d=Math.cos(r),x=t[0],S=t[1],P=t[2],z=t[3],J=t[4],ee=t[5],ue=t[6],ye=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=x*d+J*f,e[1]=S*d+ee*f,e[2]=P*d+ue*f,e[3]=z*d+ye*f,e[4]=J*d-x*f,e[5]=ee*d-S*f,e[6]=ue*d-P*f,e[7]=ye*d-z*f,e},c.scale=function(e,t,r){var f=r[0],d=r[1],x=r[2];return e[0]=t[0]*f,e[1]=t[1]*f,e[2]=t[2]*f,e[3]=t[3]*f,e[4]=t[4]*d,e[5]=t[5]*d,e[6]=t[6]*d,e[7]=t[7]*d,e[8]=t[8]*x,e[9]=t[9]*x,e[10]=t[10]*x,e[11]=t[11]*x,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},c.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},c.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},c.setCacheLimits=function(e,t){Tr=e,vr=t},c.setRTLTextPlugin=function(e,t,r){if(void 0===r&&(r=!1),"deferred"===Ds||"loading"===Ds||"loaded"===Ds)throw new Error("setRTLTextPlugin cannot be called multiple times.");Hs=Ir.resolveURL(e),Ds="deferred",au=t,uc(),r||Ws()},c.sphericalToCartesian=function(e){var t=e[0],r=e[1],f=e[2];return r+=90,r*=Math.PI/180,f*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(f),y:t*Math.sin(r)*Math.sin(f),z:t*Math.cos(f)}},c.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},c.styleSpec=fe,c.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},c.symbolSize=Io,c.transformMat3=function(e,t,r){var f=t[0],d=t[1],x=t[2];return e[0]=f*r[0]+d*r[3]+x*r[6],e[1]=f*r[1]+d*r[4]+x*r[7],e[2]=f*r[2]+d*r[5]+x*r[8],e},c.transformMat4=uu,c.translate=function(e,t,r){var f,d,x,S,P,z,J,ee,ue,ye,Se,qe,Je=r[0],Tt=r[1],st=r[2];return t===e?(e[12]=t[0]*Je+t[4]*Tt+t[8]*st+t[12],e[13]=t[1]*Je+t[5]*Tt+t[9]*st+t[13],e[14]=t[2]*Je+t[6]*Tt+t[10]*st+t[14],e[15]=t[3]*Je+t[7]*Tt+t[11]*st+t[15]):(d=t[1],x=t[2],S=t[3],P=t[4],z=t[5],J=t[6],ee=t[7],ue=t[8],ye=t[9],Se=t[10],qe=t[11],e[0]=f=t[0],e[1]=d,e[2]=x,e[3]=S,e[4]=P,e[5]=z,e[6]=J,e[7]=ee,e[8]=ue,e[9]=ye,e[10]=Se,e[11]=qe,e[12]=f*Je+P*Tt+ue*st+t[12],e[13]=d*Je+z*Tt+ye*st+t[13],e[14]=x*Je+J*Tt+Se*st+t[14],e[15]=S*Je+ee*Tt+qe*st+t[15]),e},c.triggerPluginCompletionEvent=Tf,c.uniqueId=Et,c.validateCustomStyleLayer=function(e){var t=[],r=e.id;return void 0===r&&t.push({message:"layers."+r+': missing required property "id"'}),void 0===e.render&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},c.validateLight=Ta,c.validateStyle=Mc,c.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},c.vectorTile=gf,c.version="1.13.2",c.warnOnce=Xe,c.webpSupported=Le,c.window=G,c.wrap=Ke}),_(0,function(c){function g(re){var pe=typeof re;if("number"===pe||"boolean"===pe||"string"===pe||null==re)return JSON.stringify(re);if(Array.isArray(re)){for(var _e="[",V=0,ae=re;V<ae.length;V+=1)_e+=g(ae[V])+",";return _e+"]"}for(var xe=Object.keys(re).sort(),Oe="{",fe=0;fe<xe.length;fe++)Oe+=JSON.stringify(xe[fe])+":"+g(re[xe[fe]])+",";return Oe+"}"}function O(re){for(var pe="",_e=0,V=c.refProperties;_e<V.length;_e+=1)pe+="/"+g(re[V[_e]]);return pe}var R=function(re){this.keyCache={},re&&this.replace(re)};R.prototype.replace=function(re){this._layerConfigs={},this._layers={},this.update(re,[])},R.prototype.update=function(re,pe){for(var _e=this,V=0,ae=re;V<ae.length;V+=1){var xe=ae[V];this._layerConfigs[xe.id]=xe;var Oe=this._layers[xe.id]=c.createStyleLayer(xe);Oe._featureFilter=c.featureFilter(Oe.filter),this.keyCache[xe.id]&&delete this.keyCache[xe.id]}for(var fe=0,Ae=pe;fe<Ae.length;fe+=1){var wt=Ae[fe];delete this.keyCache[wt],delete this._layerConfigs[wt],delete this._layers[wt]}this.familiesBySource={};for(var Sr=0,Kt=function(an,fn){for(var Di={},_n=0;_n<an.length;_n++){var Oi=fn&&fn[an[_n].id]||O(an[_n]);fn&&(fn[an[_n].id]=Oi);var ta=Di[Oi];ta||(ta=Di[Oi]=[]),ta.push(an[_n])}var oi=[];for(var Ji in Di)oi.push(Di[Ji]);return oi}(c.values(this._layerConfigs),this.keyCache);Sr<Kt.length;Sr+=1){var ir=Kt[Sr].map(function(an){return _e._layers[an.id]}),Fr=ir[0];if("none"!==Fr.visibility){var Rn=Fr.source||"",Pn=this.familiesBySource[Rn];Pn||(Pn=this.familiesBySource[Rn]={});var rr=Fr.sourceLayer||"_geojsonTileLayer",Sn=Pn[rr];Sn||(Sn=Pn[rr]=[]),Sn.push(ir)}}};var B=function(re){var pe={},_e=[];for(var V in re){var ae=re[V],xe=pe[V]={};for(var Oe in ae){var fe=ae[+Oe];if(fe&&0!==fe.bitmap.width&&0!==fe.bitmap.height){var Ae={x:0,y:0,w:fe.bitmap.width+2,h:fe.bitmap.height+2};_e.push(Ae),xe[Oe]={rect:Ae,metrics:fe.metrics}}}}var wt=c.potpack(_e),Sr=new c.AlphaImage({width:wt.w||1,height:wt.h||1});for(var Kt in re){var ir=re[Kt];for(var Fr in ir){var Rn=ir[+Fr];if(Rn&&0!==Rn.bitmap.width&&0!==Rn.bitmap.height){var Pn=pe[Kt][Fr].rect;c.AlphaImage.copy(Rn.bitmap,Sr,{x:0,y:0},{x:Pn.x+1,y:Pn.y+1},Rn.bitmap)}}}this.image=Sr,this.positions=pe};c.register("GlyphAtlas",B);var H=function(re){this.tileID=new c.OverscaledTileID(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),this.uid=re.uid,this.zoom=re.zoom,this.pixelRatio=re.pixelRatio,this.tileSize=re.tileSize,this.source=re.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=re.showCollisionBoxes,this.collectResourceTiming=!!re.collectResourceTiming,this.returnDependencies=!!re.returnDependencies,this.promoteId=re.promoteId};function G(re,pe,_e){for(var V=new c.EvaluationParameters(pe),ae=0,xe=re;ae<xe.length;ae+=1)xe[ae].recalculate(V,_e)}function be(re,pe){var _e=c.getArrayBuffer(re.request,function(V,ae,xe,Oe){V?pe(V):ae&&pe(null,{vectorTile:new c.vectorTile.VectorTile(new c.pbf(ae)),rawData:ae,cacheControl:xe,expires:Oe})});return function(){_e.cancel(),pe()}}H.prototype.parse=function(re,pe,_e,V,ae){var xe=this;this.status="parsing",this.data=re,this.collisionBoxArray=new c.CollisionBoxArray;var Oe=new c.DictionaryCoder(Object.keys(re.layers).sort()),fe=new c.FeatureIndex(this.tileID,this.promoteId);fe.bucketLayerIDs=[];var Ae,wt,Sr,Kt,ir={},Fr={featureIndex:fe,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:_e},Rn=pe.familiesBySource[this.source];for(var Pn in Rn){var rr=re.layers[Pn];if(rr){1===rr.version&&c.warnOnce('Vector tile source "'+this.source+'" layer "'+Pn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Sn=Oe.encode(Pn),an=[],fn=0;fn<rr.length;fn++){var Di=rr.feature(fn),_n=fe.getId(Di,Pn);an.push({feature:Di,id:_n,index:fn,sourceLayerIndex:Sn})}for(var Oi=0,ta=Rn[Pn];Oi<ta.length;Oi+=1){var oi=ta[Oi],Ji=oi[0];Ji.minzoom&&this.zoom<Math.floor(Ji.minzoom)||Ji.maxzoom&&this.zoom>=Ji.maxzoom||"none"!==Ji.visibility&&(G(oi,this.zoom,_e),(ir[Ji.id]=Ji.createBucket({index:fe.bucketLayerIDs.length,layers:oi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Sn,sourceID:this.source})).populate(an,Fr,this.tileID.canonical),fe.bucketLayerIDs.push(oi.map(function(Gi){return Gi.id})))}}}var Vi=c.mapObject(Fr.glyphDependencies,function(Gi){return Object.keys(Gi).map(Number)});Object.keys(Vi).length?V.send("getGlyphs",{uid:this.uid,stacks:Vi},function(Gi,Bi){Ae||(Ae=Gi,wt=Bi,Ia.call(xe))}):wt={};var Ti=Object.keys(Fr.iconDependencies);Ti.length?V.send("getImages",{icons:Ti,source:this.source,tileID:this.tileID,type:"icons"},function(Gi,Bi){Ae||(Ae=Gi,Sr=Bi,Ia.call(xe))}):Sr={};var _a=Object.keys(Fr.patternDependencies);function Ia(){if(Ae)return ae(Ae);if(wt&&Sr&&Kt){var Gi=new B(wt),Bi=new c.ImageAtlas(Sr,Kt);for(var Xi in ir){var to=ir[Xi];to instanceof c.SymbolBucket?(G(to.layers,this.zoom,_e),c.performSymbolLayout(to,wt,Gi.positions,Sr,Bi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):to.hasPattern&&(to instanceof c.LineBucket||to instanceof c.FillBucket||to instanceof c.FillExtrusionBucket)&&(G(to.layers,this.zoom,_e),to.addFeatures(Fr,this.tileID.canonical,Bi.patternPositions))}this.status="done",ae(null,{buckets:c.values(ir).filter(function(Ho){return!Ho.isEmpty()}),featureIndex:fe,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Gi.image,imageAtlas:Bi,glyphMap:this.returnDependencies?wt:null,iconMap:this.returnDependencies?Sr:null,glyphPositions:this.returnDependencies?Gi.positions:null})}}_a.length?V.send("getImages",{icons:_a,source:this.source,tileID:this.tileID,type:"patterns"},function(Gi,Bi){Ae||(Ae=Gi,Kt=Bi,Ia.call(xe))}):Kt={},Ia.call(this)};var Be=function(re,pe,_e,V){this.actor=re,this.layerIndex=pe,this.availableImages=_e,this.loadVectorData=V||be,this.loading={},this.loaded={}};Be.prototype.loadTile=function(re,pe){var _e=this,V=re.uid;this.loading||(this.loading={});var ae=!!(re&&re.request&&re.request.collectResourceTiming)&&new c.RequestPerformance(re.request),xe=this.loading[V]=new H(re);xe.abort=this.loadVectorData(re,function(Oe,fe){if(delete _e.loading[V],Oe||!fe)return xe.status="done",_e.loaded[V]=xe,pe(Oe);var Ae=fe.rawData,wt={};fe.expires&&(wt.expires=fe.expires),fe.cacheControl&&(wt.cacheControl=fe.cacheControl);var Sr={};if(ae){var Kt=ae.finish();Kt&&(Sr.resourceTiming=JSON.parse(JSON.stringify(Kt)))}xe.vectorTile=fe.vectorTile,xe.parse(fe.vectorTile,_e.layerIndex,_e.availableImages,_e.actor,function(ir,Fr){if(ir||!Fr)return pe(ir);pe(null,c.extend({rawTileData:Ae.slice(0)},Fr,wt,Sr))}),_e.loaded=_e.loaded||{},_e.loaded[V]=xe})},Be.prototype.reloadTile=function(re,pe){var _e=this,V=this.loaded,ae=re.uid,xe=this;if(V&&V[ae]){var Oe=V[ae];Oe.showCollisionBoxes=re.showCollisionBoxes;var fe=function(Ae,wt){var Sr=Oe.reloadCallback;Sr&&(delete Oe.reloadCallback,Oe.parse(Oe.vectorTile,xe.layerIndex,_e.availableImages,xe.actor,Sr)),pe(Ae,wt)};"parsing"===Oe.status?Oe.reloadCallback=fe:"done"===Oe.status&&(Oe.vectorTile?Oe.parse(Oe.vectorTile,this.layerIndex,this.availableImages,this.actor,fe):fe())}},Be.prototype.abortTile=function(re,pe){var _e=this.loading,V=re.uid;_e&&_e[V]&&_e[V].abort&&(_e[V].abort(),delete _e[V]),pe()},Be.prototype.removeTile=function(re,pe){var _e=this.loaded,V=re.uid;_e&&_e[V]&&delete _e[V],pe()};var j=c.window.ImageBitmap,W=function(){this.loaded={}};function Ke(re,pe){if(0!==re.length){xt(re[0],pe);for(var _e=1;_e<re.length;_e++)xt(re[_e],!pe)}}function xt(re,pe){for(var _e=0,V=0,ae=re.length,xe=ae-1;V<ae;xe=V++)_e+=(re[V][0]-re[xe][0])*(re[xe][1]+re[V][1]);_e>=0!=!!pe&&re.reverse()}W.prototype.loadTile=function(re,pe){var _e=re.uid,V=re.encoding,ae=re.rawImageData,xe=j&&ae instanceof j?this.getImageData(ae):ae,Oe=new c.DEMData(_e,xe,V);this.loaded=this.loaded||{},this.loaded[_e]=Oe,pe(null,Oe)},W.prototype.getImageData=function(re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(re.width,re.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=re.width,this.offscreenCanvas.height=re.height,this.offscreenCanvasContext.drawImage(re,0,0,re.width,re.height);var pe=this.offscreenCanvasContext.getImageData(-1,-1,re.width+2,re.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new c.RGBAImage({width:pe.width,height:pe.height},pe.data)},W.prototype.removeTile=function(re){var pe=this.loaded,_e=re.uid;pe&&pe[_e]&&delete pe[_e]};var Dt=c.vectorTile.VectorTileFeature.prototype.toGeoJSON,Et=function(re){this._feature=re,this.extent=c.EXTENT,this.type=re.type,this.properties=re.tags,"id"in re&&!isNaN(re.id)&&(this.id=parseInt(re.id,10))};Et.prototype.loadGeometry=function(){if(1===this._feature.type){for(var re=[],pe=0,_e=this._feature.geometry;pe<_e.length;pe+=1){var V=_e[pe];re.push([new c.Point$1(V[0],V[1])])}return re}for(var ae=[],xe=0,Oe=this._feature.geometry;xe<Oe.length;xe+=1){for(var fe=[],Ae=0,wt=Oe[xe];Ae<wt.length;Ae+=1){var Sr=wt[Ae];fe.push(new c.Point$1(Sr[0],Sr[1]))}ae.push(fe)}return ae},Et.prototype.toGeoJSON=function(re,pe,_e){return Dt.call(this,re,pe,_e)};var ut=function(re){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=c.EXTENT,this.length=re.length,this._features=re};ut.prototype.feature=function(re){return new Et(this._features[re])};var tt=c.vectorTile.VectorTileFeature,Gt=Q;function Q(re,pe){this.options=pe||{},this.features=re,this.length=re.length}function Vt(re,pe){this.id="number"==typeof re.id?re.id:void 0,this.type=re.type,this.rawGeometry=1===re.type?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=pe||4096}Q.prototype.feature=function(re){return new Vt(this.features[re],this.options.extent)},Vt.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var pe=0;pe<re.length;pe++){for(var _e=re[pe],V=[],ae=0;ae<_e.length;ae++)V.push(new c.Point$1(_e[ae][0],_e[ae][1]));this.geometry.push(V)}return this.geometry},Vt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,pe=1/0,_e=-1/0,V=1/0,ae=-1/0,xe=0;xe<re.length;xe++)for(var Oe=re[xe],fe=0;fe<Oe.length;fe++){var Ae=Oe[fe];pe=Math.min(pe,Ae.x),_e=Math.max(_e,Ae.x),V=Math.min(V,Ae.y),ae=Math.max(ae,Ae.y)}return[pe,V,_e,ae]},Vt.prototype.toGeoJSON=tt.prototype.toGeoJSON;var ot=pt,Ue=Gt;function pt(re){var pe=new c.pbf;return function(_e,V){for(var ae in _e.layers)V.writeMessage(3,Xe,_e.layers[ae])}(re,pe),pe.finish()}function Xe(re,pe){var _e;pe.writeVarintField(15,re.version||1),pe.writeStringField(1,re.name||""),pe.writeVarintField(5,re.extent||4096);var V={keys:[],values:[],keycache:{},valuecache:{}};for(_e=0;_e<re.length;_e++)V.feature=re.feature(_e),pe.writeMessage(2,At,V);var ae=V.keys;for(_e=0;_e<ae.length;_e++)pe.writeStringField(3,ae[_e]);var xe=V.values;for(_e=0;_e<xe.length;_e++)pe.writeMessage(4,de,xe[_e])}function At(re,pe){var _e=re.feature;void 0!==_e.id&&pe.writeVarintField(1,_e.id),pe.writeMessage(2,kt,re),pe.writeVarintField(3,_e.type),pe.writeMessage(4,ge,_e)}function kt(re,pe){var _e=re.feature,V=re.keys,ae=re.values,xe=re.keycache,Oe=re.valuecache;for(var fe in _e.properties){var Ae=xe[fe];void 0===Ae&&(V.push(fe),xe[fe]=Ae=V.length-1),pe.writeVarint(Ae);var wt=_e.properties[fe],Sr=typeof wt;"string"!==Sr&&"boolean"!==Sr&&"number"!==Sr&&(wt=JSON.stringify(wt));var Kt=Sr+":"+wt,ir=Oe[Kt];void 0===ir&&(ae.push(wt),Oe[Kt]=ir=ae.length-1),pe.writeVarint(ir)}}function Yt(re,pe){return(pe<<3)+(7&re)}function Er(re){return re<<1^re>>31}function ge(re,pe){for(var _e=re.loadGeometry(),V=re.type,ae=0,xe=0,Oe=_e.length,fe=0;fe<Oe;fe++){var Ae=_e[fe],wt=1;1===V&&(wt=Ae.length),pe.writeVarint(Yt(1,wt));for(var Sr=3===V?Ae.length-1:Ae.length,Kt=0;Kt<Sr;Kt++){1===Kt&&1!==V&&pe.writeVarint(Yt(2,Sr-1));var ir=Ae[Kt].x-ae,Fr=Ae[Kt].y-xe;pe.writeVarint(Er(ir)),pe.writeVarint(Er(Fr)),ae+=ir,xe+=Fr}3===V&&pe.writeVarint(Yt(7,1))}}function de(re,pe){var _e=typeof re;"string"===_e?pe.writeStringField(1,re):"boolean"===_e?pe.writeBooleanField(7,re):"number"===_e&&(re%1!=0?pe.writeDoubleField(3,re):re<0?pe.writeSVarintField(6,re):pe.writeVarintField(5,re))}function oe(re,pe,_e,V){me(re,_e,V),me(pe,2*_e,2*V),me(pe,2*_e+1,2*V+1)}function me(re,pe,_e){var V=re[pe];re[pe]=re[_e],re[_e]=V}function Me(re,pe,_e,V){var ae=re-_e,xe=pe-V;return ae*ae+xe*xe}ot.fromVectorTileJs=pt,ot.fromGeojsonVt=function(re,pe){pe=pe||{};var _e={};for(var V in re)_e[V]=new Gt(re[V].features,pe),_e[V].name=V,_e[V].version=pe.version,_e[V].extent=pe.extent;return pt({layers:_e})},ot.GeoJSONWrapper=Ue;var Ge=function(re){return re[0]},gt=function(re){return re[1]},br=function(re,pe,_e,V,ae){void 0===pe&&(pe=Ge),void 0===_e&&(_e=gt),void 0===V&&(V=64),void 0===ae&&(ae=Float64Array),this.nodeSize=V,this.points=re;for(var xe=re.length<65536?Uint16Array:Uint32Array,Oe=this.ids=new xe(re.length),fe=this.coords=new ae(2*re.length),Ae=0;Ae<re.length;Ae++)Oe[Ae]=Ae,fe[2*Ae]=pe(re[Ae]),fe[2*Ae+1]=_e(re[Ae]);!function wt(Sr,Kt,ir,Fr,Rn,Pn){if(!(Rn-Fr<=ir)){var rr=Fr+Rn>>1;(function Sn(an,fn,Di,_n,Oi,ta){for(;Oi>_n;){if(Oi-_n>600){var oi=Oi-_n+1,Ji=Di-_n+1,Vi=Math.log(oi),Ti=.5*Math.exp(2*Vi/3),_a=.5*Math.sqrt(Vi*Ti*(oi-Ti)/oi)*(Ji-oi/2<0?-1:1);Sn(an,fn,Di,Math.max(_n,Math.floor(Di-Ji*Ti/oi+_a)),Math.min(Oi,Math.floor(Di+(oi-Ji)*Ti/oi+_a)),ta)}var Ia=fn[2*Di+ta],Gi=_n,Bi=Oi;for(oe(an,fn,_n,Di),fn[2*Oi+ta]>Ia&&oe(an,fn,_n,Oi);Gi<Bi;){for(oe(an,fn,Gi,Bi),Gi++,Bi--;fn[2*Gi+ta]<Ia;)Gi++;for(;fn[2*Bi+ta]>Ia;)Bi--}fn[2*_n+ta]===Ia?oe(an,fn,_n,Bi):oe(an,fn,++Bi,Oi),Bi<=Di&&(_n=Bi+1),Di<=Bi&&(Oi=Bi-1)}})(Sr,Kt,rr,Fr,Rn,Pn%2),wt(Sr,Kt,ir,Fr,rr-1,Pn+1),wt(Sr,Kt,ir,rr+1,Rn,Pn+1)}}(Oe,fe,V,0,Oe.length-1,0)};br.prototype.range=function(re,pe,_e,V){return function(ae,xe,Oe,fe,Ae,wt,Sr){for(var Kt,ir,Fr=[0,ae.length-1,0],Rn=[];Fr.length;){var Pn=Fr.pop(),rr=Fr.pop(),Sn=Fr.pop();if(rr-Sn<=Sr)for(var an=Sn;an<=rr;an++)ir=xe[2*an+1],(Kt=xe[2*an])>=Oe&&Kt<=Ae&&ir>=fe&&ir<=wt&&Rn.push(ae[an]);else{var fn=Math.floor((Sn+rr)/2);ir=xe[2*fn+1],(Kt=xe[2*fn])>=Oe&&Kt<=Ae&&ir>=fe&&ir<=wt&&Rn.push(ae[fn]);var Di=(Pn+1)%2;(0===Pn?Oe<=Kt:fe<=ir)&&(Fr.push(Sn),Fr.push(fn-1),Fr.push(Di)),(0===Pn?Ae>=Kt:wt>=ir)&&(Fr.push(fn+1),Fr.push(rr),Fr.push(Di))}}return Rn}(this.ids,this.coords,re,pe,_e,V,this.nodeSize)},br.prototype.within=function(re,pe,_e){return function(V,ae,xe,Oe,fe,Ae){for(var wt=[0,V.length-1,0],Sr=[],Kt=fe*fe;wt.length;){var ir=wt.pop(),Fr=wt.pop(),Rn=wt.pop();if(Fr-Rn<=Ae)for(var Pn=Rn;Pn<=Fr;Pn++)Me(ae[2*Pn],ae[2*Pn+1],xe,Oe)<=Kt&&Sr.push(V[Pn]);else{var rr=Math.floor((Rn+Fr)/2),Sn=ae[2*rr],an=ae[2*rr+1];Me(Sn,an,xe,Oe)<=Kt&&Sr.push(V[rr]);var fn=(ir+1)%2;(0===ir?xe-fe<=Sn:Oe-fe<=an)&&(wt.push(Rn),wt.push(rr-1),wt.push(fn)),(0===ir?xe+fe>=Sn:Oe+fe>=an)&&(wt.push(rr+1),wt.push(Fr),wt.push(fn))}}return Sr}(this.ids,this.coords,re,pe,_e,this.nodeSize)};var Nr={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(re){return re}},cn=function(re){this.options=qt(Object.create(Nr),re),this.trees=new Array(this.options.maxZoom+1)};function Ir(re,pe,_e,V,ae){return{x:re,y:pe,zoom:1/0,id:_e,parentId:-1,numPoints:V,properties:ae}}function Mt(re,pe){var _e=re.geometry.coordinates,V=_e[1];return{x:at(_e[0]),y:Re(V),zoom:1/0,index:pe,parentId:-1}}function Le(re){return{type:"Feature",id:re.id,properties:we(re),geometry:{type:"Point",coordinates:[(V=re.x,360*(V-.5)),(pe=re.y,_e=(180-360*pe)*Math.PI/180,360*Math.atan(Math.exp(_e))/Math.PI-90)]}};var pe,_e,V}function we(re){var pe=re.numPoints,_e=pe>=1e4?Math.round(pe/1e3)+"k":pe>=1e3?Math.round(pe/100)/10+"k":pe;return qt(qt({},re.properties),{cluster:!0,cluster_id:re.id,point_count:pe,point_count_abbreviated:_e})}function at(re){return re/360+.5}function Re(re){var pe=Math.sin(re*Math.PI/180),_e=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return _e<0?0:_e>1?1:_e}function qt(re,pe){for(var _e in pe)re[_e]=pe[_e];return re}function Pr(re){return re.x}function er(re){return re.y}function fr(re,pe,_e,V,ae,xe){var Oe=ae-_e,fe=xe-V;if(0!==Oe||0!==fe){var Ae=((re-_e)*Oe+(pe-V)*fe)/(Oe*Oe+fe*fe);Ae>1?(_e=ae,V=xe):Ae>0&&(_e+=Oe*Ae,V+=fe*Ae)}return(Oe=re-_e)*Oe+(fe=pe-V)*fe}function Br(re,pe,_e,V){var ae={id:void 0===re?null:re,type:pe,geometry:_e,tags:V,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(xe){var Oe=xe.geometry,fe=xe.type;if("Point"===fe||"MultiPoint"===fe||"LineString"===fe)$r(xe,Oe);else if("Polygon"===fe||"MultiLineString"===fe)for(var Ae=0;Ae<Oe.length;Ae++)$r(xe,Oe[Ae]);else if("MultiPolygon"===fe)for(Ae=0;Ae<Oe.length;Ae++)for(var wt=0;wt<Oe[Ae].length;wt++)$r(xe,Oe[Ae][wt])}(ae),ae}function $r(re,pe){for(var _e=0;_e<pe.length;_e+=3)re.minX=Math.min(re.minX,pe[_e]),re.minY=Math.min(re.minY,pe[_e+1]),re.maxX=Math.max(re.maxX,pe[_e]),re.maxY=Math.max(re.maxY,pe[_e+1])}function C(re,pe,_e,V){if(pe.geometry){var ae=pe.geometry.coordinates,xe=pe.geometry.type,Oe=Math.pow(_e.tolerance/((1<<_e.maxZoom)*_e.extent),2),fe=[],Ae=pe.id;if(_e.promoteId?Ae=pe.properties[_e.promoteId]:_e.generateId&&(Ae=V||0),"Point"===xe)K(ae,fe);else if("MultiPoint"===xe)for(var wt=0;wt<ae.length;wt++)K(ae[wt],fe);else if("LineString"===xe)Ve(ae,fe,Oe,!1);else if("MultiLineString"===xe){if(_e.lineMetrics){for(wt=0;wt<ae.length;wt++)Ve(ae[wt],fe=[],Oe,!1),re.push(Br(Ae,"LineString",fe,pe.properties));return}nt(ae,fe,Oe,!1)}else if("Polygon"===xe)nt(ae,fe,Oe,!0);else{if("MultiPolygon"!==xe){if("GeometryCollection"===xe){for(wt=0;wt<pe.geometry.geometries.length;wt++)C(re,{id:Ae,geometry:pe.geometry.geometries[wt],properties:pe.properties},_e,V);return}throw new Error("Input data is not a valid GeoJSON object.")}for(wt=0;wt<ae.length;wt++){var Sr=[];nt(ae[wt],Sr,Oe,!0),fe.push(Sr)}}re.push(Br(Ae,xe,fe,pe.properties))}}function K(re,pe){pe.push(yt(re[0])),pe.push(Lt(re[1])),pe.push(0)}function Ve(re,pe,_e,V){for(var ae,xe,Oe=0,fe=0;fe<re.length;fe++){var Ae=yt(re[fe][0]),wt=Lt(re[fe][1]);pe.push(Ae),pe.push(wt),pe.push(0),fe>0&&(Oe+=V?(ae*wt-Ae*xe)/2:Math.sqrt(Math.pow(Ae-ae,2)+Math.pow(wt-xe,2))),ae=Ae,xe=wt}var Sr=pe.length-3;pe[2]=1,function Kt(ir,Fr,Rn,Pn){for(var rr,Sn=Pn,an=Rn-Fr>>1,fn=Rn-Fr,Di=ir[Fr],_n=ir[Fr+1],Oi=ir[Rn],ta=ir[Rn+1],oi=Fr+3;oi<Rn;oi+=3){var Ji=fr(ir[oi],ir[oi+1],Di,_n,Oi,ta);if(Ji>Sn)rr=oi,Sn=Ji;else if(Ji===Sn){var Vi=Math.abs(oi-an);Vi<fn&&(rr=oi,fn=Vi)}}Sn>Pn&&(rr-Fr>3&&Kt(ir,Fr,rr,Pn),ir[rr+2]=Sn,Rn-rr>3&&Kt(ir,rr,Rn,Pn))}(pe,0,Sr,_e),pe[Sr+2]=1,pe.size=Math.abs(Oe),pe.start=0,pe.end=pe.size}function nt(re,pe,_e,V){for(var ae=0;ae<re.length;ae++){var xe=[];Ve(re[ae],xe,_e,V),pe.push(xe)}}function yt(re){return re/360+.5}function Lt(re){var pe=Math.sin(re*Math.PI/180),_e=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return _e<0?0:_e>1?1:_e}function Z(re,pe,_e,V,ae,xe,Oe,fe){if(V/=pe,xe>=(_e/=pe)&&Oe<V)return re;if(Oe<_e||xe>=V)return null;for(var Ae=[],wt=0;wt<re.length;wt++){var Sr=re[wt],Kt=Sr.geometry,ir=Sr.type,Fr=0===ae?Sr.minX:Sr.minY,Rn=0===ae?Sr.maxX:Sr.maxY;if(Fr>=_e&&Rn<V)Ae.push(Sr);else if(!(Rn<_e||Fr>=V)){var Pn=[];if("Point"===ir||"MultiPoint"===ir)Ze(Kt,Pn,_e,V,ae);else if("LineString"===ir)St(Kt,Pn,_e,V,ae,!1,fe.lineMetrics);else if("MultiLineString"===ir)Jt(Kt,Pn,_e,V,ae,!1);else if("Polygon"===ir)Jt(Kt,Pn,_e,V,ae,!0);else if("MultiPolygon"===ir)for(var rr=0;rr<Kt.length;rr++){var Sn=[];Jt(Kt[rr],Sn,_e,V,ae,!0),Sn.length&&Pn.push(Sn)}if(Pn.length){if(fe.lineMetrics&&"LineString"===ir){for(rr=0;rr<Pn.length;rr++)Ae.push(Br(Sr.id,ir,Pn[rr],Sr.tags));continue}"LineString"!==ir&&"MultiLineString"!==ir||(1===Pn.length?(ir="LineString",Pn=Pn[0]):ir="MultiLineString"),"Point"!==ir&&"MultiPoint"!==ir||(ir=3===Pn.length?"Point":"MultiPoint"),Ae.push(Br(Sr.id,ir,Pn,Sr.tags))}}}return Ae.length?Ae:null}function Ze(re,pe,_e,V,ae){for(var xe=0;xe<re.length;xe+=3){var Oe=re[xe+ae];Oe>=_e&&Oe<=V&&(pe.push(re[xe]),pe.push(re[xe+1]),pe.push(re[xe+2]))}}function St(re,pe,_e,V,ae,xe,Oe){for(var fe,Ae,wt=It(re),Sr=0===ae?vr:Xt,Kt=re.start,ir=0;ir<re.length-3;ir+=3){var Fr=re[ir],Rn=re[ir+1],Pn=re[ir+2],rr=re[ir+3],Sn=re[ir+4],an=0===ae?Fr:Rn,fn=0===ae?rr:Sn,Di=!1;Oe&&(fe=Math.sqrt(Math.pow(Fr-rr,2)+Math.pow(Rn-Sn,2))),an<_e?fn>_e&&(Ae=Sr(wt,Fr,Rn,rr,Sn,_e),Oe&&(wt.start=Kt+fe*Ae)):an>V?fn<V&&(Ae=Sr(wt,Fr,Rn,rr,Sn,V),Oe&&(wt.start=Kt+fe*Ae)):Tr(wt,Fr,Rn,Pn),fn<_e&&an>=_e&&(Ae=Sr(wt,Fr,Rn,rr,Sn,_e),Di=!0),fn>V&&an<=V&&(Ae=Sr(wt,Fr,Rn,rr,Sn,V),Di=!0),!xe&&Di&&(Oe&&(wt.end=Kt+fe*Ae),pe.push(wt),wt=It(re)),Oe&&(Kt+=fe)}var _n=re.length-3;Fr=re[_n],Rn=re[_n+1],Pn=re[_n+2],(an=0===ae?Fr:Rn)>=_e&&an<=V&&Tr(wt,Fr,Rn,Pn),_n=wt.length-3,xe&&_n>=3&&(wt[_n]!==wt[0]||wt[_n+1]!==wt[1])&&Tr(wt,wt[0],wt[1],wt[2]),wt.length&&pe.push(wt)}function It(re){var pe=[];return pe.size=re.size,pe.start=re.start,pe.end=re.end,pe}function Jt(re,pe,_e,V,ae,xe){for(var Oe=0;Oe<re.length;Oe++)St(re[Oe],pe,_e,V,ae,xe,!1)}function Tr(re,pe,_e,V){re.push(pe),re.push(_e),re.push(V)}function vr(re,pe,_e,V,ae,xe){var Oe=(xe-pe)/(V-pe);return re.push(xe),re.push(_e+(ae-_e)*Oe),re.push(1),Oe}function Xt(re,pe,_e,V,ae,xe){var Oe=(xe-_e)/(ae-_e);return re.push(pe+(V-pe)*Oe),re.push(xe),re.push(1),Oe}function mr(re,pe){for(var _e=[],V=0;V<re.length;V++){var ae,xe=re[V],Oe=xe.type;if("Point"===Oe||"MultiPoint"===Oe||"LineString"===Oe)ae=or(xe.geometry,pe);else if("MultiLineString"===Oe||"Polygon"===Oe){ae=[];for(var fe=0;fe<xe.geometry.length;fe++)ae.push(or(xe.geometry[fe],pe))}else if("MultiPolygon"===Oe)for(ae=[],fe=0;fe<xe.geometry.length;fe++){for(var Ae=[],wt=0;wt<xe.geometry[fe].length;wt++)Ae.push(or(xe.geometry[fe][wt],pe));ae.push(Ae)}_e.push(Br(xe.id,Oe,ae,xe.tags))}return _e}function or(re,pe){var _e=[];_e.size=re.size,void 0!==re.start&&(_e.start=re.start,_e.end=re.end);for(var V=0;V<re.length;V+=3)_e.push(re[V]+pe,re[V+1],re[V+2]);return _e}function pr(re,pe){if(re.transformed)return re;var _e,V,ae,xe=1<<re.z,Oe=re.x,fe=re.y;for(_e=0;_e<re.features.length;_e++){var Ae=re.features[_e],wt=Ae.geometry,Sr=Ae.type;if(Ae.geometry=[],1===Sr)for(V=0;V<wt.length;V+=2)Ae.geometry.push(mn(wt[V],wt[V+1],pe,xe,Oe,fe));else for(V=0;V<wt.length;V++){var Kt=[];for(ae=0;ae<wt[V].length;ae+=2)Kt.push(mn(wt[V][ae],wt[V][ae+1],pe,xe,Oe,fe));Ae.geometry.push(Kt)}}return re.transformed=!0,re}function mn(re,pe,_e,V,ae,xe){return[Math.round(_e*(re*V-ae)),Math.round(_e*(pe*V-xe))]}function On(re,pe,_e,V,ae){for(var xe=pe===ae.maxZoom?0:ae.tolerance/((1<<pe)*ae.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:_e,y:V,z:pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},fe=0;fe<re.length;fe++){Oe.numFeatures++,mi(Oe,re[fe],xe,ae);var Ae=re[fe].minX,wt=re[fe].minY,Sr=re[fe].maxX,Kt=re[fe].maxY;Ae<Oe.minX&&(Oe.minX=Ae),wt<Oe.minY&&(Oe.minY=wt),Sr>Oe.maxX&&(Oe.maxX=Sr),Kt>Oe.maxY&&(Oe.maxY=Kt)}return Oe}function mi(re,pe,_e,V){var ae=pe.geometry,xe=pe.type,Oe=[];if("Point"===xe||"MultiPoint"===xe)for(var fe=0;fe<ae.length;fe+=3)Oe.push(ae[fe]),Oe.push(ae[fe+1]),re.numPoints++,re.numSimplified++;else if("LineString"===xe)hi(Oe,ae,re,_e,!1,!1);else if("MultiLineString"===xe||"Polygon"===xe)for(fe=0;fe<ae.length;fe++)hi(Oe,ae[fe],re,_e,"Polygon"===xe,0===fe);else if("MultiPolygon"===xe)for(var Ae=0;Ae<ae.length;Ae++){var wt=ae[Ae];for(fe=0;fe<wt.length;fe++)hi(Oe,wt[fe],re,_e,!0,0===fe)}if(Oe.length){var Sr=pe.tags||null;if("LineString"===xe&&V.lineMetrics){for(var Kt in Sr={},pe.tags)Sr[Kt]=pe.tags[Kt];Sr.mapbox_clip_start=ae.start/ae.size,Sr.mapbox_clip_end=ae.end/ae.size}var ir={geometry:Oe,type:"Polygon"===xe||"MultiPolygon"===xe?3:"LineString"===xe||"MultiLineString"===xe?2:1,tags:Sr};null!==pe.id&&(ir.id=pe.id),re.features.push(ir)}}function hi(re,pe,_e,V,ae,xe){var Oe=V*V;if(V>0&&pe.size<(ae?Oe:V))_e.numPoints+=pe.length/3;else{for(var fe=[],Ae=0;Ae<pe.length;Ae+=3)(0===V||pe[Ae+2]>Oe)&&(_e.numSimplified++,fe.push(pe[Ae]),fe.push(pe[Ae+1])),_e.numPoints++;ae&&function(wt,Sr){for(var Kt=0,ir=0,Fr=wt.length,Rn=Fr-2;ir<Fr;Rn=ir,ir+=2)Kt+=(wt[ir]-wt[Rn])*(wt[ir+1]+wt[Rn+1]);if(Kt>0===Sr)for(ir=0,Fr=wt.length;ir<Fr/2;ir+=2){var Pn=wt[ir],rr=wt[ir+1];wt[ir]=wt[Fr-2-ir],wt[ir+1]=wt[Fr-1-ir],wt[Fr-2-ir]=Pn,wt[Fr-1-ir]=rr}}(fe,xe),re.push(fe)}}function si(re,pe){var _e=(pe=this.options=function(ae,xe){for(var Oe in xe)ae[Oe]=xe[Oe];return ae}(Object.create(this.options),pe)).debug;if(_e&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");var ae,xe,Oe,fe,Ae,wt,V=function(ae,xe){var Oe=[];if("FeatureCollection"===ae.type)for(var fe=0;fe<ae.features.length;fe++)C(Oe,ae.features[fe],xe,fe);else C(Oe,"Feature"===ae.type?ae:{geometry:ae},xe);return Oe}(re,pe);this.tiles={},this.tileCoords=[],_e&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ae=V,xe=pe,Oe=xe.buffer/xe.extent,fe=ae,Ae=Z(ae,1,-1-Oe,Oe,0,-1,2,xe),wt=Z(ae,1,1-Oe,2+Oe,0,-1,2,xe),(Ae||wt)&&(fe=Z(ae,1,-Oe,1+Oe,0,-1,2,xe)||[],Ae&&(fe=mr(Ae,1).concat(fe)),wt&&(fe=fe.concat(mr(wt,-1)))),V=fe).length&&this.splitTile(V,0,0,0),_e&&(V.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ai(re,pe,_e){return 32*((1<<re)*_e+pe)+re}function Ki(re,pe){var _e=re.tileID.canonical;if(!this._geoJSONIndex)return pe(null,null);var V=this._geoJSONIndex.getTile(_e.z,_e.x,_e.y);if(!V)return pe(null,null);var ae=new ut(V.features),xe=ot(ae);0===xe.byteOffset&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),pe(null,{vectorTile:ae,rawData:xe.buffer})}cn.prototype.load=function(re){var pe=this.options,_e=pe.log,V=pe.minZoom,ae=pe.maxZoom,xe=pe.nodeSize;_e&&console.time("total time");var Oe="prepare "+re.length+" points";_e&&console.time(Oe),this.points=re;for(var fe=[],Ae=0;Ae<re.length;Ae++)re[Ae].geometry&&fe.push(Mt(re[Ae],Ae));this.trees[ae+1]=new br(fe,Pr,er,xe,Float32Array),_e&&console.timeEnd(Oe);for(var wt=ae;wt>=V;wt--){var Sr=+Date.now();fe=this._cluster(fe,wt),this.trees[wt]=new br(fe,Pr,er,xe,Float32Array),_e&&console.log("z%d: %d clusters in %dms",wt,fe.length,+Date.now()-Sr)}return _e&&console.timeEnd("total time"),this},cn.prototype.getClusters=function(re,pe){var _e=((re[0]+180)%360+360)%360-180,V=Math.max(-90,Math.min(90,re[1])),ae=180===re[2]?180:((re[2]+180)%360+360)%360-180,xe=Math.max(-90,Math.min(90,re[3]));if(re[2]-re[0]>=360)_e=-180,ae=180;else if(_e>ae){var Oe=this.getClusters([_e,V,180,xe],pe),fe=this.getClusters([-180,V,ae,xe],pe);return Oe.concat(fe)}for(var Ae=this.trees[this._limitZoom(pe)],wt=[],Sr=0,Kt=Ae.range(at(_e),Re(xe),at(ae),Re(V));Sr<Kt.length;Sr+=1){var ir=Ae.points[Kt[Sr]];wt.push(ir.numPoints?Le(ir):this.points[ir.index])}return wt},cn.prototype.getChildren=function(re){var pe=this._getOriginId(re),_e=this._getOriginZoom(re),V="No cluster with the specified id.",ae=this.trees[_e];if(!ae)throw new Error(V);var xe=ae.points[pe];if(!xe)throw new Error(V);for(var Oe=this.options.radius/(this.options.extent*Math.pow(2,_e-1)),fe=[],Ae=0,wt=ae.within(xe.x,xe.y,Oe);Ae<wt.length;Ae+=1){var Sr=ae.points[wt[Ae]];Sr.parentId===re&&fe.push(Sr.numPoints?Le(Sr):this.points[Sr.index])}if(0===fe.length)throw new Error(V);return fe},cn.prototype.getLeaves=function(re,pe,_e){var V=[];return this._appendLeaves(V,re,pe=pe||10,_e=_e||0,0),V},cn.prototype.getTile=function(re,pe,_e){var V=this.trees[this._limitZoom(re)],ae=Math.pow(2,re),xe=this.options,Oe=xe.radius/xe.extent,fe=(_e-Oe)/ae,Ae=(_e+1+Oe)/ae,wt={features:[]};return this._addTileFeatures(V.range((pe-Oe)/ae,fe,(pe+1+Oe)/ae,Ae),V.points,pe,_e,ae,wt),0===pe&&this._addTileFeatures(V.range(1-Oe/ae,fe,1,Ae),V.points,ae,_e,ae,wt),pe===ae-1&&this._addTileFeatures(V.range(0,fe,Oe/ae,Ae),V.points,-1,_e,ae,wt),wt.features.length?wt:null},cn.prototype.getClusterExpansionZoom=function(re){for(var pe=this._getOriginZoom(re)-1;pe<=this.options.maxZoom;){var _e=this.getChildren(re);if(pe++,1!==_e.length)break;re=_e[0].properties.cluster_id}return pe},cn.prototype._appendLeaves=function(re,pe,_e,V,ae){for(var xe=0,Oe=this.getChildren(pe);xe<Oe.length;xe+=1){var fe=Oe[xe],Ae=fe.properties;if(Ae&&Ae.cluster?ae+Ae.point_count<=V?ae+=Ae.point_count:ae=this._appendLeaves(re,Ae.cluster_id,_e,V,ae):ae<V?ae++:re.push(fe),re.length===_e)break}return ae},cn.prototype._addTileFeatures=function(re,pe,_e,V,ae,xe){for(var Oe=0,fe=re;Oe<fe.length;Oe+=1){var Ae=pe[fe[Oe]],wt=Ae.numPoints,Sr={type:1,geometry:[[Math.round(this.options.extent*(Ae.x*ae-_e)),Math.round(this.options.extent*(Ae.y*ae-V))]],tags:wt?we(Ae):this.points[Ae.index].properties},Kt=void 0;wt?Kt=Ae.id:this.options.generateId?Kt=Ae.index:this.points[Ae.index].id&&(Kt=this.points[Ae.index].id),void 0!==Kt&&(Sr.id=Kt),xe.features.push(Sr)}},cn.prototype._limitZoom=function(re){return Math.max(this.options.minZoom,Math.min(+re,this.options.maxZoom+1))},cn.prototype._cluster=function(re,pe){for(var _e=[],V=this.options,ae=V.reduce,xe=V.minPoints,Oe=V.radius/(V.extent*Math.pow(2,pe)),fe=0;fe<re.length;fe++){var Ae=re[fe];if(!(Ae.zoom<=pe)){Ae.zoom=pe;for(var wt=this.trees[pe+1],Sr=wt.within(Ae.x,Ae.y,Oe),Kt=Ae.numPoints||1,ir=Kt,Fr=0,Rn=Sr;Fr<Rn.length;Fr+=1){var Pn=wt.points[Rn[Fr]];Pn.zoom>pe&&(ir+=Pn.numPoints||1)}if(ir>=xe){for(var rr=Ae.x*Kt,Sn=Ae.y*Kt,an=ae&&Kt>1?this._map(Ae,!0):null,fn=(fe<<5)+(pe+1)+this.points.length,Di=0,_n=Sr;Di<_n.length;Di+=1){var Oi=wt.points[_n[Di]];if(!(Oi.zoom<=pe)){Oi.zoom=pe;var ta=Oi.numPoints||1;rr+=Oi.x*ta,Sn+=Oi.y*ta,Oi.parentId=fn,ae&&(an||(an=this._map(Ae,!0)),ae(an,this._map(Oi)))}}Ae.parentId=fn,_e.push(Ir(rr/ir,Sn/ir,fn,ir,an))}else if(_e.push(Ae),ir>1)for(var oi=0,Ji=Sr;oi<Ji.length;oi+=1){var Vi=wt.points[Ji[oi]];Vi.zoom<=pe||(Vi.zoom=pe,_e.push(Vi))}}}return _e},cn.prototype._getOriginId=function(re){return re-this.points.length>>5},cn.prototype._getOriginZoom=function(re){return(re-this.points.length)%32},cn.prototype._map=function(re,pe){if(re.numPoints)return pe?qt({},re.properties):re.properties;var _e=this.points[re.index].properties,V=this.options.map(_e);return pe&&V===_e?qt({},V):V},si.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},si.prototype.splitTile=function(re,pe,_e,V,ae,xe,Oe){for(var fe=[re,pe,_e,V],Ae=this.options,wt=Ae.debug;fe.length;){V=fe.pop(),_e=fe.pop(),pe=fe.pop(),re=fe.pop();var Sr=1<<pe,Kt=ai(pe,_e,V),ir=this.tiles[Kt];if(!ir&&(wt>1&&console.time("creation"),ir=this.tiles[Kt]=On(re,pe,_e,V,Ae),this.tileCoords.push({z:pe,x:_e,y:V}),wt)){wt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,_e,V,ir.numFeatures,ir.numPoints,ir.numSimplified),console.timeEnd("creation"));var Fr="z"+pe;this.stats[Fr]=(this.stats[Fr]||0)+1,this.total++}if(ir.source=re,ae){if(pe===Ae.maxZoom||pe===ae)continue;var Rn=1<<ae-pe;if(_e!==Math.floor(xe/Rn)||V!==Math.floor(Oe/Rn))continue}else if(pe===Ae.indexMaxZoom||ir.numPoints<=Ae.indexMaxPoints)continue;if(ir.source=null,0!==re.length){wt>1&&console.time("clipping");var Pn,rr,Sn,an,fn,Di,_n=.5*Ae.buffer/Ae.extent,Oi=.5-_n,ta=.5+_n,oi=1+_n;Pn=rr=Sn=an=null,fn=Z(re,Sr,_e-_n,_e+ta,0,ir.minX,ir.maxX,Ae),Di=Z(re,Sr,_e+Oi,_e+oi,0,ir.minX,ir.maxX,Ae),re=null,fn&&(Pn=Z(fn,Sr,V-_n,V+ta,1,ir.minY,ir.maxY,Ae),rr=Z(fn,Sr,V+Oi,V+oi,1,ir.minY,ir.maxY,Ae),fn=null),Di&&(Sn=Z(Di,Sr,V-_n,V+ta,1,ir.minY,ir.maxY,Ae),an=Z(Di,Sr,V+Oi,V+oi,1,ir.minY,ir.maxY,Ae),Di=null),wt>1&&console.timeEnd("clipping"),fe.push(Pn||[],pe+1,2*_e,2*V),fe.push(rr||[],pe+1,2*_e,2*V+1),fe.push(Sn||[],pe+1,2*_e+1,2*V),fe.push(an||[],pe+1,2*_e+1,2*V+1)}}},si.prototype.getTile=function(re,pe,_e){var V=this.options,ae=V.extent,xe=V.debug;if(re<0||re>24)return null;var Oe=1<<re,fe=ai(re,pe=(pe%Oe+Oe)%Oe,_e);if(this.tiles[fe])return pr(this.tiles[fe],ae);xe>1&&console.log("drilling down to z%d-%d-%d",re,pe,_e);for(var Ae,wt=re,Sr=pe,Kt=_e;!Ae&&wt>0;)wt--,Sr=Math.floor(Sr/2),Kt=Math.floor(Kt/2),Ae=this.tiles[ai(wt,Sr,Kt)];return Ae&&Ae.source?(xe>1&&console.log("found parent tile z%d-%d-%d",wt,Sr,Kt),xe>1&&console.time("drilling down"),this.splitTile(Ae.source,wt,Sr,Kt,re,pe,_e),xe>1&&console.timeEnd("drilling down"),this.tiles[fe]?pr(this.tiles[fe],ae):null):null};var Pi=function(re){function pe(_e,V,ae,xe){re.call(this,_e,V,ae,Ki),xe&&(this.loadGeoJSON=xe)}return re&&(pe.__proto__=re),(pe.prototype=Object.create(re&&re.prototype)).constructor=pe,pe.prototype.loadData=function(_e,V){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=V,this._pendingLoadDataParams=_e,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},pe.prototype._loadData=function(){var _e=this;if(this._pendingCallback&&this._pendingLoadDataParams){var V=this._pendingCallback,ae=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var xe=!!(ae&&ae.request&&ae.request.collectResourceTiming)&&new c.RequestPerformance(ae.request);this.loadGeoJSON(ae,function(Oe,fe){if(Oe||!fe)return V(Oe);if("object"!=typeof fe)return V(new Error("Input data given to '"+ae.source+"' is not a valid GeoJSON object."));!function ir(Fr,Rn){var Pn,rr=Fr&&Fr.type;if("FeatureCollection"===rr)for(Pn=0;Pn<Fr.features.length;Pn++)ir(Fr.features[Pn],Rn);else if("GeometryCollection"===rr)for(Pn=0;Pn<Fr.geometries.length;Pn++)ir(Fr.geometries[Pn],Rn);else if("Feature"===rr)ir(Fr.geometry,Rn);else if("Polygon"===rr)Ke(Fr.coordinates,Rn);else if("MultiPolygon"===rr)for(Pn=0;Pn<Fr.coordinates.length;Pn++)Ke(Fr.coordinates[Pn],Rn);return Fr}(fe,!0);try{if(ae.filter){var Ae=c.createExpression(ae.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ae.result)throw new Error(Ae.value.map(function(ir){return ir.key+": "+ir.message}).join(", "));var wt=fe.features.filter(function(ir){return Ae.value.evaluate({zoom:0},ir)});fe={type:"FeatureCollection",features:wt}}_e._geoJSONIndex=ae.cluster?new cn(function(ir){var Fr=ir.superclusterOptions,Rn=ir.clusterProperties;if(!Rn||!Fr)return Fr;for(var Pn={},rr={},Sn={accumulated:null,zoom:0},an={properties:null},fn=Object.keys(Rn),Di=0,_n=fn;Di<_n.length;Di+=1){var Oi=_n[Di],ta=Rn[Oi],oi=ta[0],Ji=c.createExpression(ta[1]),Vi=c.createExpression("string"==typeof oi?[oi,["accumulated"],["get",Oi]]:oi);Pn[Oi]=Ji.value,rr[Oi]=Vi.value}return Fr.map=function(Ti){an.properties=Ti;for(var _a={},Ia=0,Gi=fn;Ia<Gi.length;Ia+=1){var Bi=Gi[Ia];_a[Bi]=Pn[Bi].evaluate(Sn,an)}return _a},Fr.reduce=function(Ti,_a){an.properties=_a;for(var Ia=0,Gi=fn;Ia<Gi.length;Ia+=1){var Bi=Gi[Ia];Sn.accumulated=Ti[Bi],Ti[Bi]=rr[Bi].evaluate(Sn,an)}},Fr}(ae)).load(fe.features):new si(ir=fe,ae.geojsonVtOptions)}catch(ir){return V(ir)}var ir;_e.loaded={};var Sr={};if(xe){var Kt=xe.finish();Kt&&(Sr.resourceTiming={},Sr.resourceTiming[ae.source]=JSON.parse(JSON.stringify(Kt)))}V(null,Sr)})}},pe.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},pe.prototype.reloadTile=function(_e,V){var ae=this.loaded;return ae&&ae[_e.uid]?re.prototype.reloadTile.call(this,_e,V):this.loadTile(_e,V)},pe.prototype.loadGeoJSON=function(_e,V){if(_e.request)c.getJSON(_e.request,V);else{if("string"!=typeof _e.data)return V(new Error("Input data given to '"+_e.source+"' is not a valid GeoJSON object."));try{return V(null,JSON.parse(_e.data))}catch(ae){return V(new Error("Input data given to '"+_e.source+"' is not a valid GeoJSON object."))}}},pe.prototype.removeSource=function(_e,V){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),V()},pe.prototype.getClusterExpansionZoom=function(_e,V){try{V(null,this._geoJSONIndex.getClusterExpansionZoom(_e.clusterId))}catch(ae){V(ae)}},pe.prototype.getClusterChildren=function(_e,V){try{V(null,this._geoJSONIndex.getChildren(_e.clusterId))}catch(ae){V(ae)}},pe.prototype.getClusterLeaves=function(_e,V){try{V(null,this._geoJSONIndex.getLeaves(_e.clusterId,_e.limit,_e.offset))}catch(ae){V(ae)}},pe}(Be),Ei=function(re){var pe=this;this.self=re,this.actor=new c.Actor(re,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Be,geojson:Pi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(_e,V){if(pe.workerSourceTypes[_e])throw new Error('Worker source with name "'+_e+'" already registered.');pe.workerSourceTypes[_e]=V},this.self.registerRTLTextPlugin=function(_e){if(c.plugin.isParsed())throw new Error("RTL text plugin already registered.");c.plugin.applyArabicShaping=_e.applyArabicShaping,c.plugin.processBidirectionalText=_e.processBidirectionalText,c.plugin.processStyledBidirectionalText=_e.processStyledBidirectionalText}};return Ei.prototype.setReferrer=function(re,pe){this.referrer=pe},Ei.prototype.setImages=function(re,pe,_e){for(var V in this.availableImages[re]=pe,this.workerSources[re]){var ae=this.workerSources[re][V];for(var xe in ae)ae[xe].availableImages=pe}_e()},Ei.prototype.setLayers=function(re,pe,_e){this.getLayerIndex(re).replace(pe),_e()},Ei.prototype.updateLayers=function(re,pe,_e){this.getLayerIndex(re).update(pe.layers,pe.removedIds),_e()},Ei.prototype.loadTile=function(re,pe,_e){this.getWorkerSource(re,pe.type,pe.source).loadTile(pe,_e)},Ei.prototype.loadDEMTile=function(re,pe,_e){this.getDEMWorkerSource(re,pe.source).loadTile(pe,_e)},Ei.prototype.reloadTile=function(re,pe,_e){this.getWorkerSource(re,pe.type,pe.source).reloadTile(pe,_e)},Ei.prototype.abortTile=function(re,pe,_e){this.getWorkerSource(re,pe.type,pe.source).abortTile(pe,_e)},Ei.prototype.removeTile=function(re,pe,_e){this.getWorkerSource(re,pe.type,pe.source).removeTile(pe,_e)},Ei.prototype.removeDEMTile=function(re,pe){this.getDEMWorkerSource(re,pe.source).removeTile(pe)},Ei.prototype.removeSource=function(re,pe,_e){if(this.workerSources[re]&&this.workerSources[re][pe.type]&&this.workerSources[re][pe.type][pe.source]){var V=this.workerSources[re][pe.type][pe.source];delete this.workerSources[re][pe.type][pe.source],void 0!==V.removeSource?V.removeSource(pe,_e):_e()}},Ei.prototype.loadWorkerSource=function(re,pe,_e){try{this.self.importScripts(pe.url),_e()}catch(V){_e(V.toString())}},Ei.prototype.syncRTLPluginState=function(re,pe,_e){try{c.plugin.setState(pe);var V=c.plugin.getPluginURL();if(c.plugin.isLoaded()&&!c.plugin.isParsed()&&null!=V){this.self.importScripts(V);var ae=c.plugin.isParsed();_e(ae?void 0:new Error("RTL Text Plugin failed to import scripts from "+V),ae)}}catch(xe){_e(xe.toString())}},Ei.prototype.getAvailableImages=function(re){var pe=this.availableImages[re];return pe||(pe=[]),pe},Ei.prototype.getLayerIndex=function(re){var pe=this.layerIndexes[re];return pe||(pe=this.layerIndexes[re]=new R),pe},Ei.prototype.getWorkerSource=function(re,pe,_e){var V=this;return this.workerSources[re]||(this.workerSources[re]={}),this.workerSources[re][pe]||(this.workerSources[re][pe]={}),this.workerSources[re][pe][_e]||(this.workerSources[re][pe][_e]=new this.workerSourceTypes[pe]({send:function(ae,xe,Oe){V.actor.send(ae,xe,Oe,re)}},this.getLayerIndex(re),this.getAvailableImages(re))),this.workerSources[re][pe][_e]},Ei.prototype.getDEMWorkerSource=function(re,pe){return this.demWorkerSources[re]||(this.demWorkerSources[re]={}),this.demWorkerSources[re][pe]||(this.demWorkerSources[re][pe]=new W),this.demWorkerSources[re][pe]},Ei.prototype.enforceCacheSizeLimit=function(re,pe){c.enforceCacheSizeLimit(pe)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ei(self)),Ei}),_(0,function(c){var g=c.createCommonjsModule(function(a){function s(b){return!o(b)}function o(b){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var A,F,$=new Blob([""],{type:"text/javascript"}),ce=URL.createObjectURL($);try{F=new Worker(ce),A=!0}catch(Ce){A=!1}return F&&F.terminate(),URL.revokeObjectURL(ce),A}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var A=document.createElement("canvas");A.width=A.height=1;var F=A.getContext("2d");if(!F)return!1;var $=F.getImageData(0,0,1,1);return $&&$.width===A.width}()?(void 0===p[E=b&&b.failIfMajorPerformanceCaveat]&&(p[E]=function(A){var ce,Ce,Ie,F=(ce=A,Ce=document.createElement("canvas"),(Ie=Object.create(s.webGLContextAttributes)).failIfMajorPerformanceCaveat=ce,Ce.probablySupportsContext?Ce.probablySupportsContext("webgl",Ie)||Ce.probablySupportsContext("experimental-webgl",Ie):Ce.supportsContext?Ce.supportsContext("webgl",Ie)||Ce.supportsContext("experimental-webgl",Ie):Ce.getContext("webgl",Ie)||Ce.getContext("experimental-webgl",Ie));if(!F)return!1;var $=F.createShader(F.VERTEX_SHADER);return!(!$||F.isContextLost())&&(F.shaderSource($,"void main() {}"),F.compileShader($),!0===F.getShaderParameter($,F.COMPILE_STATUS))}(E)),p[E]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var E}a.exports?a.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var p={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),O={create:function(a,s,o){var p=c.window.document.createElement(a);return void 0!==s&&(p.className=s),o&&o.appendChild(p),p},createNS:function(a,s){return c.window.document.createElementNS(a,s)}},R=c.window.document&&c.window.document.documentElement.style;function B(a){if(!R)return a[0];for(var s=0;s<a.length;s++)if(a[s]in R)return a[s];return a[0]}var H,G=B(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);O.disableDrag=function(){R&&G&&(H=R[G],R[G]="none")},O.enableDrag=function(){R&&G&&(R[G]=H)};var be=B(["transform","WebkitTransform"]);O.setTransform=function(a,s){a.style[be]=s};var Be=!1;try{var j=Object.defineProperty({},"passive",{get:function(){Be=!0}});c.window.addEventListener("test",j,j),c.window.removeEventListener("test",j,j)}catch(a){Be=!1}O.addEventListener=function(a,s,o,p){void 0===p&&(p={}),a.addEventListener(s,o,"passive"in p&&Be?p:p.capture)},O.removeEventListener=function(a,s,o,p){void 0===p&&(p={}),a.removeEventListener(s,o,"passive"in p&&Be?p:p.capture)};var W=function(a){a.preventDefault(),a.stopPropagation(),c.window.removeEventListener("click",W,!0)};function Ke(a){var s=a.userImage;return!!(s&&s.render&&s.render())&&(a.data.replace(new Uint8Array(s.data.buffer)),!0)}O.suppressClick=function(){c.window.addEventListener("click",W,!0),c.window.setTimeout(function(){c.window.removeEventListener("click",W,!0)},0)},O.mousePos=function(a,s){var o=a.getBoundingClientRect();return new c.Point(s.clientX-o.left-a.clientLeft,s.clientY-o.top-a.clientTop)},O.touchPos=function(a,s){for(var o=a.getBoundingClientRect(),p=[],b=0;b<s.length;b++)p.push(new c.Point(s[b].clientX-o.left-a.clientLeft,s[b].clientY-o.top-a.clientTop));return p},O.mouseButton=function(a){return void 0!==c.window.InstallTrigger&&2===a.button&&a.ctrlKey&&c.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:a.button},O.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)};var xt=function(a){function s(){a.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.RGBAImage({width:1,height:1}),this.dirty=!0}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var p=0,b=this.requestors;p<b.length;p+=1){var E=b[p];this._notify(E.ids,E.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,p){this._validate(o,p)&&(this.images[o]=p)},s.prototype._validate=function(o,p){var b=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),b=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),b=!1),this._validateContent(p.content,p)||(this.fire(new c.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),b=!1),b},s.prototype._validateStretch=function(o,p){if(!o)return!0;for(var b=0,E=0,A=o;E<A.length;E+=1){var F=A[E];if(F[0]<b||F[1]<F[0]||p<F[1])return!1;b=F[1]}return!0},s.prototype._validateContent=function(o,p){return!(o&&(4!==o.length||o[0]<0||p.data.width<o[0]||o[1]<0||p.data.height<o[1]||o[2]<0||p.data.width<o[2]||o[3]<0||p.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,p){p.version=this.images[o].version+1,this.images[o]=p,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var p=this.images[o];delete this.images[o],delete this.patterns[o],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,p){var b=!0;if(!this.isLoaded())for(var E=0,A=o;E<A.length;E+=1)this.images[A[E]]||(b=!1);this.isLoaded()||b?this._notify(o,p):this.requestors.push({ids:o,callback:p})},s.prototype._notify=function(o,p){for(var b={},E=0,A=o;E<A.length;E+=1){var F=A[E];this.images[F]||this.fire(new c.Event("styleimagemissing",{id:F}));var $=this.images[F];$?b[F]={data:$.data.clone(),pixelRatio:$.pixelRatio,sdf:$.sdf,version:$.version,stretchX:$.stretchX,stretchY:$.stretchY,content:$.content,hasRenderCallback:Boolean($.userImage&&$.userImage.render)}:c.warnOnce('Image "'+F+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}p(null,b)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var p=this.patterns[o],b=this.getImage(o);if(!b)return null;if(p&&p.position.version===b.version)return p.position;if(p)p.position.version=b.version;else{var E={w:b.data.width+2,h:b.data.height+2,x:0,y:0},A=new c.ImagePosition(E,b);this.patterns[o]={bin:E,position:A}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var p=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new c.Texture(o,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var p in this.patterns)o.push(this.patterns[p].bin);var b=c.potpack(o),E=b.w,A=b.h,F=this.atlasImage;for(var $ in F.resize({width:E||1,height:A||1}),this.patterns){var ce=this.patterns[$].bin,Ce=ce.x+1,Ie=ce.y+1,ke=this.images[$].data,et=ke.width,$e=ke.height;c.RGBAImage.copy(ke,F,{x:0,y:0},{x:Ce,y:Ie},{width:et,height:$e}),c.RGBAImage.copy(ke,F,{x:0,y:$e-1},{x:Ce,y:Ie-1},{width:et,height:1}),c.RGBAImage.copy(ke,F,{x:0,y:0},{x:Ce,y:Ie+$e},{width:et,height:1}),c.RGBAImage.copy(ke,F,{x:et-1,y:0},{x:Ce-1,y:Ie},{width:1,height:$e}),c.RGBAImage.copy(ke,F,{x:0,y:0},{x:Ce+et,y:Ie},{width:1,height:$e})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var p=0,b=o;p<b.length;p+=1){var E=b[p];if(!this.callbackDispatchedThisFrame[E]){this.callbackDispatchedThisFrame[E]=!0;var A=this.images[E];Ke(A)&&this.updateImage(E,A)}}},s}(c.Evented),Dt=tt,Et=tt,ut=1e20;function tt(a,s,o,p,b,E){this.fontSize=a||24,this.buffer=void 0===s?3:s,this.cutoff=p||.25,this.fontFamily=b||"sans-serif",this.fontWeight=E||"normal",this.radius=o||8;var A=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=A,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.d=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Int16Array(A),this.middle=Math.round(A/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function Gt(a,s,o,p,b,E,A){for(var F=0;F<s;F++){for(var $=0;$<o;$++)p[$]=a[$*s+F];for(Q(p,b,E,A,o),$=0;$<o;$++)a[$*s+F]=b[$]}for($=0;$<o;$++){for(F=0;F<s;F++)p[F]=a[$*s+F];for(Q(p,b,E,A,s),F=0;F<s;F++)a[$*s+F]=Math.sqrt(b[F])}}function Q(a,s,o,p,b){o[0]=0,p[0]=-ut,p[1]=+ut;for(var E=1,A=0;E<b;E++){for(var F=(a[E]+E*E-(a[o[A]]+o[A]*o[A]))/(2*E-2*o[A]);F<=p[A];)A--,F=(a[E]+E*E-(a[o[A]]+o[A]*o[A]))/(2*E-2*o[A]);o[++A]=E,p[A]=F,p[A+1]=+ut}for(E=0,A=0;E<b;E++){for(;p[A+1]<E;)A++;s[E]=(E-o[A])*(E-o[A])+a[o[A]]}}tt.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),p=0;p<this.size*this.size;p++){var b=s.data[4*p+3]/255;this.gridOuter[p]=1===b?0:0===b?ut:Math.pow(Math.max(0,.5-b),2),this.gridInner[p]=1===b?ut:0===b?0:Math.pow(Math.max(0,b-.5),2)}for(Gt(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),Gt(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),p=0;p<this.size*this.size;p++)o[p]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[p]-this.gridInner[p])/this.radius+this.cutoff))));return o},Dt.default=Et;var Vt=function(a,s){this.requestManager=a,this.localIdeographFontFamily=s,this.entries={}};Vt.prototype.setURL=function(a){this.url=a},Vt.prototype.getGlyphs=function(a,s){var o=this,p=[];for(var b in a)for(var E=0,A=a[b];E<A.length;E+=1)p.push({stack:b,id:A[E]});c.asyncAll(p,function(F,$){var ce=F.stack,Ce=F.id,Ie=o.entries[ce];Ie||(Ie=o.entries[ce]={glyphs:{},requests:{},ranges:{}});var ke=Ie.glyphs[Ce];if(void 0===ke){if(ke=o._tinySDF(Ie,ce,Ce))return Ie.glyphs[Ce]=ke,void $(null,{stack:ce,id:Ce,glyph:ke});var et=Math.floor(Ce/256);if(256*et>65535)$(new Error("glyphs > 65535 not supported"));else if(Ie.ranges[et])$(null,{stack:ce,id:Ce,glyph:ke});else{var $e=Ie.requests[et];$e||($e=Ie.requests[et]=[],Vt.loadGlyphRange(ce,et,o.url,o.requestManager,function(ft,Ye){if(Ye){for(var lt in Ye)o._doesCharSupportLocalGlyph(+lt)||(Ie.glyphs[+lt]=Ye[+lt]);Ie.ranges[et]=!0}for(var Pt=0,Ht=$e;Pt<Ht.length;Pt+=1)(0,Ht[Pt])(ft,Ye);delete Ie.requests[et]})),$e.push(function(ft,Ye){ft?$(ft):Ye&&$(null,{stack:ce,id:Ce,glyph:Ye[Ce]||null})})}}else $(null,{stack:ce,id:Ce,glyph:ke})},function(F,$){if(F)s(F);else if($){for(var ce={},Ce=0,Ie=$;Ce<Ie.length;Ce+=1){var ke=Ie[Ce],et=ke.stack,$e=ke.id,ft=ke.glyph;(ce[et]||(ce[et]={}))[$e]=ft&&{id:ft.id,bitmap:ft.bitmap.clone(),metrics:ft.metrics}}s(null,ce)}})},Vt.prototype._doesCharSupportLocalGlyph=function(a){return!!this.localIdeographFontFamily&&(c.isChar["CJK Unified Ideographs"](a)||c.isChar["Hangul Syllables"](a)||c.isChar.Hiragana(a)||c.isChar.Katakana(a))},Vt.prototype._tinySDF=function(a,s,o){var p=this.localIdeographFontFamily;if(p&&this._doesCharSupportLocalGlyph(o)){var b=a.tinySDF;if(!b){var E="400";/bold/i.test(s)?E="900":/medium/i.test(s)?E="500":/light/i.test(s)&&(E="200"),b=a.tinySDF=new Vt.TinySDF(24,3,8,.25,p,E)}return{id:o,bitmap:new c.AlphaImage({width:30,height:30},b.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Vt.loadGlyphRange=function(a,s,o,p,b){var E=256*s,A=E+255,F=p.transformRequest(p.normalizeGlyphsURL(o).replace("{fontstack}",a).replace("{range}",E+"-"+A),c.ResourceType.Glyphs);c.getArrayBuffer(F,function($,ce){if($)b($);else if(ce){for(var Ce={},Ie=0,ke=c.parseGlyphPBF(ce);Ie<ke.length;Ie+=1){var et=ke[Ie];Ce[et.id]=et}b(null,Ce)}})},Vt.TinySDF=Dt;var ot=function(){this.specification=c.styleSpec.light.position};ot.prototype.possiblyEvaluate=function(a,s){return c.sphericalToCartesian(a.expression.evaluate(s))},ot.prototype.interpolate=function(a,s,o){return{x:c.number(a.x,s.x,o),y:c.number(a.y,s.y,o),z:c.number(a.z,s.z,o)}};var Ue=new c.Properties({anchor:new c.DataConstantProperty(c.styleSpec.light.anchor),position:new ot,color:new c.DataConstantProperty(c.styleSpec.light.color),intensity:new c.DataConstantProperty(c.styleSpec.light.intensity)}),pt=function(a){function s(o){a.call(this),this._transitionable=new c.Transitionable(Ue),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,p){if(void 0===p&&(p={}),!this._validate(c.validateLight,o,p))for(var b in o){var E=o[b];c.endsWith(b,"-transition")?this._transitionable.setTransition(b.slice(0,-"-transition".length),E):this._transitionable.setValue(b,E)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,p,b){return(!b||!1!==b.validate)&&c.emitValidationErrors(this,o.call(c.validateStyle,c.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:c.styleSpec})))},s}(c.Evented),Xe=function(a,s){this.width=a,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Xe.prototype.getDash=function(a,s){var o=a.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(a,s)),this.dashEntry[o]},Xe.prototype.getDashRanges=function(a,s,o){var p=[],b=a.length%2==1?-a[a.length-1]*o:0,E=a[0]*o,A=!0;p.push({left:b,right:E,isDash:A,zeroLength:0===a[0]});for(var F=a[0],$=1;$<a.length;$++){var ce=a[$];p.push({left:b=F*o,right:E=(F+=ce)*o,isDash:A=!A,zeroLength:0===ce})}return p},Xe.prototype.addRoundDash=function(a,s,o){for(var p=s/2,b=-o;b<=o;b++)for(var E=this.width*(this.nextRow+o+b),A=0,F=a[A],$=0;$<this.width;$++){$/F.right>1&&(F=a[++A]);var ce=Math.abs($-F.left),Ce=Math.abs($-F.right),Ie=Math.min(ce,Ce),ke=void 0,et=b/o*(p+1);if(F.isDash){var $e=p-Math.abs(et);ke=Math.sqrt(Ie*Ie+$e*$e)}else ke=p-Math.sqrt(Ie*Ie+et*et);this.data[E+$]=Math.max(0,Math.min(255,ke+128))}},Xe.prototype.addRegularDash=function(a){for(var s=a.length-1;s>=0;--s){var o=a[s],p=a[s+1];o.zeroLength?a.splice(s,1):p&&p.isDash===o.isDash&&(p.left=o.left,a.splice(s,1))}var b=a[0],E=a[a.length-1];b.isDash===E.isDash&&(b.left=E.left-this.width,E.right=b.right+this.width);for(var A=this.width*this.nextRow,F=0,$=a[F],ce=0;ce<this.width;ce++){ce/$.right>1&&($=a[++F]);var Ce=Math.abs(ce-$.left),Ie=Math.abs(ce-$.right),ke=Math.min(Ce,Ie);this.data[A+ce]=Math.max(0,Math.min(255,($.isDash?ke:-ke)+128))}},Xe.prototype.addDash=function(a,s){var o=s?7:0,p=2*o+1;if(this.nextRow+p>this.height)return c.warnOnce("LineAtlas out of space"),null;for(var b=0,E=0;E<a.length;E++)b+=a[E];if(0!==b){var A=this.width/b,F=this.getDashRanges(a,this.width,A);s?this.addRoundDash(F,A,o):this.addRegularDash(F)}var $={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:b};return this.nextRow+=p,this.dirty=!0,$},Xe.prototype.bind=function(a){var s=a.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var At=function a(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=c.uniqueId();for(var p=this.workerPool.acquire(this.id),b=0;b<p.length;b++){var E=new a.Actor(p[b],o,this.id);E.name="Worker "+b,this.actors.push(E)}};function kt(a,s,o){var p=function(b,E){if(b)return o(b);if(E){var A=c.pick(c.extend(E,a),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);E.vector_layers&&(A.vectorLayers=E.vector_layers,A.vectorLayerIds=A.vectorLayers.map(function(F){return F.id})),A.tiles=s.canonicalizeTileset(A,a.url),o(null,A)}};return a.url?c.getJSON(s.transformRequest(s.normalizeSourceURL(a.url),c.ResourceType.Source),p):c.browser.frame(function(){return p(null,a)})}At.prototype.broadcast=function(a,s,o){c.asyncAll(this.actors,function(p,b){p.send(a,s,b)},o=o||function(){})},At.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},At.prototype.remove=function(){this.actors.forEach(function(a){a.remove()}),this.actors=[],this.workerPool.release(this.id)},At.Actor=c.Actor;var Yt=function(a,s,o){this.bounds=c.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=s||0,this.maxzoom=o||24};Yt.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]},Yt.prototype.contains=function(a){var s=Math.pow(2,a.z),o=Math.floor(c.mercatorXfromLng(this.bounds.getWest())*s),p=Math.floor(c.mercatorYfromLat(this.bounds.getNorth())*s),b=Math.ceil(c.mercatorXfromLng(this.bounds.getEast())*s),E=Math.ceil(c.mercatorYfromLat(this.bounds.getSouth())*s);return a.x>=o&&a.x<b&&a.y>=p&&a.y<E};var Er=function(a){function s(o,p,b,E){if(a.call(this),this.id=o,this.dispatcher=b,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.extend(this,c.pick(p,["url","scheme","tileSize","promoteId"])),this._options=c.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(E)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=kt(this._options,this.map._requestManager,function(p,b){o._tileJSONRequest=null,o._loaded=!0,p?o.fire(new c.ErrorEvent(p)):b&&(c.extend(o,b),b.bounds&&(o.tileBounds=new Yt(b.bounds,o.minzoom,o.maxzoom)),c.postTurnstileEvent(b.tiles,o.map._requestManager._customAccessToken),c.postMapLoadEvent(b.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var p=this;return this.setSourceProperty(function(){p._options.tiles=o}),this},s.prototype.setUrl=function(o){var p=this;return this.setSourceProperty(function(){p.url=o,p._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return c.extend({},this._options)},s.prototype.loadTile=function(o,p){var b=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),E={request:this.map._requestManager.transformRequest(b,c.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:c.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function A(F,$){return delete o.request,o.aborted?p(null):F&&404!==F.status?p(F):($&&$.resourceTiming&&(o.resourceTiming=$.resourceTiming),this.map._refreshExpiredTiles&&$&&o.setExpiryData($),o.loadVectorData($,this.map.painter),c.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}E.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state?"loading"===o.state?o.reloadCallback=p:o.request=o.actor.send("reloadTile",E,A.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",E,A.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(c.Evented),ge=function(a){function s(o,p,b,E){a.call(this),this.id=o,this.dispatcher=b,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.extend({type:"raster"},p),c.extend(this,c.pick(p,["url","scheme","tileSize"]))}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=kt(this._options,this.map._requestManager,function(p,b){o._tileJSONRequest=null,o._loaded=!0,p?o.fire(new c.ErrorEvent(p)):b&&(c.extend(o,b),b.bounds&&(o.tileBounds=new Yt(b.bounds,o.minzoom,o.maxzoom)),c.postTurnstileEvent(b.tiles),c.postMapLoadEvent(b.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return c.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,p){var b=this,E=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=c.getImage(this.map._requestManager.transformRequest(E,c.ResourceType.Tile),function(A,F){if(delete o.request,o.aborted)o.state="unloaded",p(null);else if(A)o.state="errored",p(A);else if(F){b.map._refreshExpiredTiles&&o.setExpiryData(F),delete F.cacheControl,delete F.expires;var $=b.map.painter.context,ce=$.gl;o.texture=b.map.painter.getTileTexture(F.width),o.texture?o.texture.update(F,{useMipmap:!0}):(o.texture=new c.Texture($,F,ce.RGBA,{useMipmap:!0}),o.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE,ce.LINEAR_MIPMAP_NEAREST),$.extTextureFilterAnisotropic&&ce.texParameterf(ce.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax)),o.state="loaded",c.cacheEntryPossiblyAdded(b.dispatcher),p(null)}})},s.prototype.abortTile=function(o,p){o.request&&(o.request.cancel(),delete o.request),p()},s.prototype.unloadTile=function(o,p){o.texture&&this.map.painter.saveTileTexture(o.texture),p()},s.prototype.hasTransition=function(){return!1},s}(c.Evented),de=function(a){function s(o,p,b,E){a.call(this,o,p,b,E),this.type="raster-dem",this.maxzoom=22,this._options=c.extend({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox"}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,p){var b=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function E(A,F){A&&(o.state="errored",p(A)),F&&(o.dem=F,o.needsHillshadePrepare=!0,o.state="loaded",p(null))}o.request=c.getImage(this.map._requestManager.transformRequest(b,c.ResourceType.Tile),function(A,F){if(delete o.request,o.aborted)o.state="unloaded",p(null);else if(A)o.state="errored",p(A);else if(F){this.map._refreshExpiredTiles&&o.setExpiryData(F),delete F.cacheControl,delete F.expires;var $=c.window.ImageBitmap&&F instanceof c.window.ImageBitmap&&c.offscreenCanvasSupported()?F:c.browser.getImageData(F,1),ce={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:$,encoding:this.encoding};o.actor&&"expired"!==o.state||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",ce,E.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var p=o.canonical,b=Math.pow(2,p.z),E=(p.x-1+b)%b,A=0===p.x?o.wrap-1:o.wrap,F=(p.x+1+b)%b,$=p.x+1===b?o.wrap+1:o.wrap,ce={};return ce[new c.OverscaledTileID(o.overscaledZ,A,p.z,E,p.y).key]={backfilled:!1},ce[new c.OverscaledTileID(o.overscaledZ,$,p.z,F,p.y).key]={backfilled:!1},p.y>0&&(ce[new c.OverscaledTileID(o.overscaledZ,A,p.z,E,p.y-1).key]={backfilled:!1},ce[new c.OverscaledTileID(o.overscaledZ,o.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},ce[new c.OverscaledTileID(o.overscaledZ,$,p.z,F,p.y-1).key]={backfilled:!1}),p.y+1<b&&(ce[new c.OverscaledTileID(o.overscaledZ,A,p.z,E,p.y+1).key]={backfilled:!1},ce[new c.OverscaledTileID(o.overscaledZ,o.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},ce[new c.OverscaledTileID(o.overscaledZ,$,p.z,F,p.y+1).key]={backfilled:!1}),ce},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(ge),oe=function(a){function s(o,p,b,E){a.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=b.getActor(),this.setEventedParent(E),this._data=p.data,this._options=c.extend({},p),this._collectResourceTiming=p.collectResourceTiming,this._resourceTiming=[],void 0!==p.maxzoom&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId;var A=c.EXTENT/this.tileSize;this.workerOptions=c.extend({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:(void 0!==p.buffer?p.buffer:128)*A,tolerance:(void 0!==p.tolerance?p.tolerance:.375)*A,extent:c.EXTENT,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:void 0!==p.clusterMaxZoom?Math.min(p.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,p.clusterMinPoints||2),extent:c.EXTENT,radius:(p.clusterRadius||50)*A,log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new c.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(p){if(p)o.fire(new c.ErrorEvent(p));else{var b={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(b.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new c.Event("data",b))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var p=this;return this._data=o,this.fire(new c.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(b){if(b)p.fire(new c.ErrorEvent(b));else{var E={dataType:"source",sourceDataType:"content"};p._collectResourceTiming&&p._resourceTiming&&p._resourceTiming.length>0&&(E.resourceTiming=p._resourceTiming,p._resourceTiming=[]),p.fire(new c.Event("data",E))}}),this},s.prototype.getClusterExpansionZoom=function(o,p){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},p),this},s.prototype.getClusterChildren=function(o,p){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},p),this},s.prototype.getClusterLeaves=function(o,p,b,E){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:p,offset:b},E),this},s.prototype._updateWorkerData=function(o){var p=this;this._loaded=!1;var b=c.extend({},this.workerOptions),E=this._data;"string"==typeof E?(b.request=this.map._requestManager.transformRequest(c.browser.resolveURL(E),c.ResourceType.Source),b.request.collectResourceTiming=this._collectResourceTiming):b.data=JSON.stringify(E),this.actor.send(this.type+".loadData",b,function(A,F){p._removed||F&&F.abandoned||(p._loaded=!0,F&&F.resourceTiming&&F.resourceTiming[p.id]&&(p._resourceTiming=F.resourceTiming[p.id].slice(0)),p.actor.send(p.type+".coalesce",{source:b.source},null),o(A))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,p){var b=this,E=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(E,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:c.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(A,F){return delete o.request,o.unloadVectorData(),o.aborted?p(null):A?p(A):(o.loadVectorData(F,b.map.painter,"reloadTile"===E),p(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return c.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(c.Evented),me=c.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Me=function(a){function s(o,p,b,E){a.call(this),this.id=o,this.dispatcher=b,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=p}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(o,p){var b=this;this._loaded=!1,this.fire(new c.Event("dataloading",{dataType:"source"})),this.url=this.options.url,c.getImage(this.map._requestManager.transformRequest(this.url,c.ResourceType.Image),function(E,A){b._loaded=!0,E?b.fire(new c.ErrorEvent(E)):A&&(b.image=A,o&&(b.coordinates=o),p&&p(),b._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var p=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){p.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var p=this;this.coordinates=o;var b=o.map(c.MercatorCoordinate.fromLngLat);this.tileID=function(A){for(var F=1/0,$=1/0,ce=-1/0,Ce=-1/0,Ie=0,ke=A;Ie<ke.length;Ie+=1){var et=ke[Ie];F=Math.min(F,et.x),$=Math.min($,et.y),ce=Math.max(ce,et.x),Ce=Math.max(Ce,et.y)}var $e=Math.max(ce-F,Ce-$),ft=Math.max(0,Math.floor(-Math.log($e)/Math.LN2)),Ye=Math.pow(2,ft);return new c.CanonicalTileID(ft,Math.floor((F+ce)/2*Ye),Math.floor(($+Ce)/2*Ye))}(b),this.minzoom=this.maxzoom=this.tileID.z;var E=b.map(function(A){return p.tileID.getTilePoint(A)._round()});return this._boundsArray=new c.StructArrayLayout4i8,this._boundsArray.emplaceBack(E[0].x,E[0].y,0,0),this._boundsArray.emplaceBack(E[1].x,E[1].y,c.EXTENT,0),this._boundsArray.emplaceBack(E[3].x,E[3].y,0,c.EXTENT),this._boundsArray.emplaceBack(E[2].x,E[2].y,c.EXTENT,c.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new c.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var o=this.map.painter.context,p=o.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,me.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new c.Texture(o,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this.tiles){var E=this.tiles[b];"loaded"!==E.state&&(E.state="loaded",E.texture=this.texture)}}},s.prototype.loadTile=function(o,p){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},p(null)):(o.state="errored",p(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(c.Evented),Ge=function(a){function s(o,p,b,E){a.call(this,o,p,b,E),this.roundZoom=!0,this.type="video",this.options=p}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var p=this.options;this.urls=[];for(var b=0,E=p.urls;b<E.length;b+=1)this.urls.push(this.map._requestManager.transformRequest(E[b],c.ResourceType.Source).url);c.getVideo(this.urls,function(A,F){o._loaded=!0,A?o.fire(new c.ErrorEvent(A)):F&&(o.video=F,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var p=this.video.seekable;o<p.start(0)||o>p.end(0)?this.fire(new c.ErrorEvent(new c.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+p.start(0)+" and "+p.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var o=this.map.painter.context,p=o.gl;for(var b in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,me.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new c.Texture(o,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this.tiles){var E=this.tiles[b];"loaded"!==E.state&&(E.state="loaded",E.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(Me),gt=function(a){function s(o,p,b,E){a.call(this,o,p,b,E),p.coordinates?Array.isArray(p.coordinates)&&4===p.coordinates.length&&!p.coordinates.some(function(A){return!Array.isArray(A)||2!==A.length||A.some(function(F){return"number"!=typeof F})})||this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'missing required property "coordinates"'))),p.animate&&"boolean"!=typeof p.animate&&this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),p.canvas?"string"==typeof p.canvas||p.canvas instanceof c.window.HTMLCanvasElement||this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.ErrorEvent(new c.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=p,this.animate=void 0===p.animate||p.animate}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof c.window.HTMLCanvasElement?this.options.canvas:c.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var p=this.map.painter.context,b=p.gl;for(var E in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,me.members)),this.boundsSegments||(this.boundsSegments=c.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new c.Texture(p,this.canvas,b.RGBA,{premultiply:!0}),this.tiles){var A=this.tiles[E];"loaded"!==A.state&&(A.state="loaded",A.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,p=[this.canvas.width,this.canvas.height];o<p.length;o+=1){var b=p[o];if(isNaN(b)||b<=0)return!0}return!1},s}(Me),br={vector:Er,raster:ge,"raster-dem":de,geojson:oe,video:Ge,image:Me,canvas:gt};function Nr(a,s){var o=c.identity([]);return c.translate(o,o,[1,1,0]),c.scale(o,o,[.5*a.width,.5*a.height,1]),c.multiply(o,o,a.calculatePosMatrix(s.toUnwrapped()))}function cn(a,s,o,p,b,E){var A=function(ft,Ye,lt){if(ft)for(var Pt=0,Ht=ft;Pt<Ht.length;Pt+=1){var hr=Ye[Ht[Pt]];if(hr&&hr.source===lt&&"fill-extrusion"===hr.type)return!0}else for(var nr in Ye){var _r=Ye[nr];if(_r.source===lt&&"fill-extrusion"===_r.type)return!0}return!1}(b&&b.layers,s,a.id),F=E.maxPitchScaleFactor(),$=a.tilesIn(p,F,A);$.sort(Ir);for(var ce=[],Ce=0,Ie=$;Ce<Ie.length;Ce+=1){var ke=Ie[Ce];ce.push({wrappedTileID:ke.tileID.wrapped().key,queryResults:ke.tile.queryRenderedFeatures(s,o,a._state,ke.queryGeometry,ke.cameraQueryGeometry,ke.scale,b,E,F,Nr(a.transform,ke.tileID))})}var et=function(ft){for(var Ye={},lt={},Pt=0,Ht=ft;Pt<Ht.length;Pt+=1){var hr=Ht[Pt],nr=hr.queryResults,_r=hr.wrappedTileID,Dr=lt[_r]=lt[_r]||{};for(var Qr in nr)for(var Xr=nr[Qr],dn=Dr[Qr]=Dr[Qr]||{},qn=Ye[Qr]=Ye[Qr]||[],jn=0,Bn=Xr;jn<Bn.length;jn+=1){var Li=Bn[jn];dn[Li.featureIndex]||(dn[Li.featureIndex]=!0,qn.push(Li))}}return Ye}(ce);for(var $e in et)et[$e].forEach(function(ft){var Ye=ft.feature,lt=a.getFeatureState(Ye.layer["source-layer"],Ye.id);Ye.source=Ye.layer.source,Ye.layer["source-layer"]&&(Ye.sourceLayer=Ye.layer["source-layer"]),Ye.state=lt});return et}function Ir(a,s){var o=a.tileID,p=s.tileID;return o.overscaledZ-p.overscaledZ||o.canonical.y-p.canonical.y||o.wrap-p.wrap||o.canonical.x-p.canonical.x}var Mt=function(a,s){this.max=a,this.onRemove=s,this.reset()};Mt.prototype.reset=function(){for(var a in this.data)for(var s=0,o=this.data[a];s<o.length;s+=1){var p=o[s];p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value)}return this.data={},this.order=[],this},Mt.prototype.add=function(a,s,o){var p=this,b=a.wrapped().key;void 0===this.data[b]&&(this.data[b]=[]);var E={value:s,timeout:void 0};if(void 0!==o&&(E.timeout=setTimeout(function(){p.remove(a,E)},o)),this.data[b].push(E),this.order.push(b),this.order.length>this.max){var A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this},Mt.prototype.has=function(a){return a.wrapped().key in this.data},Mt.prototype.getAndRemove=function(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null},Mt.prototype._getAndRemoveByKey=function(a){var s=this.data[a].shift();return s.timeout&&clearTimeout(s.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),s.value},Mt.prototype.getByKey=function(a){var s=this.data[a];return s?s[0].value:null},Mt.prototype.get=function(a){return this.has(a)?this.data[a.wrapped().key][0].value:null},Mt.prototype.remove=function(a,s){if(!this.has(a))return this;var o=a.wrapped().key,p=void 0===s?0:this.data[o].indexOf(s),b=this.data[o][p];return this.data[o].splice(p,1),b.timeout&&clearTimeout(b.timeout),0===this.data[o].length&&delete this.data[o],this.onRemove(b.value),this.order.splice(this.order.indexOf(o),1),this},Mt.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},Mt.prototype.filter=function(a){var s=[];for(var o in this.data)for(var p=0,b=this.data[o];p<b.length;p+=1){var E=b[p];a(E.value)||s.push(E)}for(var A=0,F=s;A<F.length;A+=1){var $=F[A];this.remove($.value.tileID,$)}};var Le=function(a,s,o){this.context=a;var p=a.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Le.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Le.prototype.updateData=function(a){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},Le.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var we={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},at=function(a,s,o,p){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.context=a;var b=a.gl;this.buffer=b.createBuffer(),a.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};at.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},at.prototype.updateData=function(a){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,a.arrayBuffer)},at.prototype.enableAttributes=function(a,s){for(var o=0;o<this.attributes.length;o++){var p=s.attributes[this.attributes[o].name];void 0!==p&&a.enableVertexAttribArray(p)}},at.prototype.setVertexAttribPointers=function(a,s,o){for(var p=0;p<this.attributes.length;p++){var b=this.attributes[p],E=s.attributes[b.name];void 0!==E&&a.vertexAttribPointer(E,b.components,a[we[b.type]],!1,this.itemSize,b.offset+this.itemSize*(o||0))}},at.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Re=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Re.prototype.get=function(){return this.current},Re.prototype.set=function(a){},Re.prototype.getDefault=function(){return this.default},Re.prototype.setDefault=function(){this.set(this.default)};var qt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return c.Color.transparent},s.prototype.set=function(o){var p=this.current;(o.r!==p.r||o.g!==p.g||o.b!==p.b||o.a!==p.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Re),Pr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Re),er=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Re),fr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||o[2]!==p[2]||o[3]!==p[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Re),Br=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Re),$r=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Re),C=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var p=this.current;(o.func!==p.func||o.ref!==p.ref||o.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Re),K=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||o[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Re),Ve=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;o?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Re),nt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Re),yt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;o?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Re),Lt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Re),Z=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;o?p.enable(p.BLEND):p.disable(p.BLEND),this.current=o,this.dirty=!1}},s}(Re),Ze=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Re),St=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return c.Color.transparent},s.prototype.set=function(o){var p=this.current;(o.r!==p.r||o.g!==p.g||o.b!==p.b||o.a!==p.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Re),It=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Re),Jt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;o?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=o,this.dirty=!1}},s}(Re),Tr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Re),vr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Re),Xt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Re),mr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Re),or=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var p=this.current;(o[0]!==p[0]||o[1]!==p[1]||o[2]!==p[2]||o[3]!==p[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Re),pr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Re),mn=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Re),On=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.bindTexture(p.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Re),mi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Re),hi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Re),si=function(a){function s(o){a.call(this,o),this.vao=o.extVertexArrayObject}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Re),ai=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Re),Ki=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Re),Pi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Re),Ei=function(a){function s(o,p){a.call(this,o),this.context=o,this.parent=p}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Re),re=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(Ei),pe=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Ei),_e=function(a,s,o,p){this.context=a,this.width=s,this.height=o;var b=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new re(a,b),p&&(this.depthAttachment=new pe(a,b))};_e.prototype.destroy=function(){var a=this.context.gl,s=this.colorAttachment.get();if(s&&a.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&a.deleteRenderbuffer(o)}a.deleteFramebuffer(this.framebuffer)};var V=function(a,s,o){this.func=a,this.mask=s,this.range=o};V.ReadOnly=!1,V.ReadWrite=!0,V.disabled=new V(519,V.ReadOnly,[0,1]);var ae=function(a,s,o,p,b,E){this.test=a,this.ref=s,this.mask=o,this.fail=p,this.depthFail=b,this.pass=E};ae.disabled=new ae({func:519,mask:0},0,0,7680,7680,7680);var xe=function(a,s,o){this.blendFunction=a,this.blendColor=s,this.mask=o};xe.disabled=new xe(xe.Replace=[1,0],c.Color.transparent,[!1,!1,!1,!1]),xe.unblended=new xe(xe.Replace,c.Color.transparent,[!0,!0,!0,!0]),xe.alphaBlended=new xe([1,771],c.Color.transparent,[!0,!0,!0,!0]);var Oe=function(a,s,o){this.enable=a,this.mode=s,this.frontFace=o};Oe.disabled=new Oe(!1,1029,2305),Oe.backCCW=new Oe(!0,1029,2305);var fe=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new qt(this),this.clearDepth=new Pr(this),this.clearStencil=new er(this),this.colorMask=new fr(this),this.depthMask=new Br(this),this.stencilMask=new $r(this),this.stencilFunc=new C(this),this.stencilOp=new K(this),this.stencilTest=new Ve(this),this.depthRange=new nt(this),this.depthTest=new yt(this),this.depthFunc=new Lt(this),this.blend=new Z(this),this.blendFunc=new Ze(this),this.blendColor=new St(this),this.blendEquation=new It(this),this.cullFace=new Jt(this),this.cullFaceSide=new Tr(this),this.frontFace=new vr(this),this.program=new Xt(this),this.activeTexture=new mr(this),this.viewport=new or(this),this.bindFramebuffer=new pr(this),this.bindRenderbuffer=new mn(this),this.bindTexture=new On(this),this.bindVertexBuffer=new mi(this),this.bindElementBuffer=new hi(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new si(this),this.pixelStoreUnpack=new ai(this),this.pixelStoreUnpackPremultiplyAlpha=new Ki(this),this.pixelStoreUnpackFlipY=new Pi(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};fe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},fe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},fe.prototype.createIndexBuffer=function(a,s){return new Le(this,a,s)},fe.prototype.createVertexBuffer=function(a,s,o){return new at(this,a,s,o)},fe.prototype.createRenderbuffer=function(a,s,o){var p=this.gl,b=p.createRenderbuffer();return this.bindRenderbuffer.set(b),p.renderbufferStorage(p.RENDERBUFFER,a,s,o),this.bindRenderbuffer.set(null),b},fe.prototype.createFramebuffer=function(a,s,o){return new _e(this,a,s,o)},fe.prototype.clear=function(a){var s=a.color,o=a.depth,p=this.gl,b=0;s&&(b|=p.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),void 0!==o&&(b|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),p.clear(b)},fe.prototype.setCullFace=function(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))},fe.prototype.setDepthMode=function(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)},fe.prototype.setStencilMode=function(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)},fe.prototype.setColorMode=function(a){c.deepEqual(a.blendFunction,xe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)},fe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Ae=function(a){function s(o,p,b){var E=this;a.call(this),this.id=o,this.dispatcher=b,this.on("data",function(A){"source"===A.dataType&&"metadata"===A.sourceDataType&&(E._sourceLoaded=!0),E._sourceLoaded&&!E._paused&&"source"===A.dataType&&"content"===A.sourceDataType&&(E.reload(),E.transform&&E.update(E.transform))}),this.on("error",function(){E._sourceErrored=!0}),this._source=function(A,F,$,ce){var Ce=new br[F.type](A,F,$,ce);if(Ce.id!==A)throw new Error("Expected Source id to be "+A+" instead of "+Ce.id);return c.bindAll(["load","abort","unload","serialize","prepare"],Ce),Ce}(o,p,b,this),this._tiles={},this._cache=new Mt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new c.SourceFeatureState}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var p=this._tiles[o];if("loaded"!==p.state&&"errored"!==p.state)return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,p){return this._source.loadTile(o,p)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var p in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var b=this._tiles[p];b.upload(o),b.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return c.values(this._tiles).map(function(o){return o.tileID}).sort(wt).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var p=this,b=[];for(var E in this._tiles)this._isIdRenderable(E,o)&&b.push(this._tiles[E]);return o?b.sort(function(A,F){var $=A.tileID,ce=F.tileID,Ce=new c.Point($.canonical.x,$.canonical.y)._rotate(p.transform.angle),Ie=new c.Point(ce.canonical.x,ce.canonical.y)._rotate(p.transform.angle);return $.overscaledZ-ce.overscaledZ||Ie.y-Ce.y||Ie.x-Ce.x}).map(function(A){return A.tileID.key}):b.map(function(A){return A.tileID}).sort(wt).map(function(A){return A.key})},s.prototype.hasRenderableParent=function(o){var p=this.findLoadedParent(o,0);return!!p&&this._isIdRenderable(p.tileID.key)},s.prototype._isIdRenderable=function(o,p){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(p||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,p){var b=this._tiles[o];b&&("loading"!==b.state&&(b.state=p),this._loadTile(b,this._tileLoaded.bind(this,b,o,p)))},s.prototype._tileLoaded=function(o,p,b,E){if(E)return o.state="errored",void(404!==E.status?this._source.fire(new c.ErrorEvent(E,{tile:o})):this.update(this.transform));o.timeAdded=c.browser.now(),"expired"===b&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(p,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new c.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var p=this.getRenderableIds(),b=0;b<p.length;b++){var E=p[b];if(o.neighboringTiles&&o.neighboringTiles[E]){var A=this.getTileByID(E);F(o,A),F(A,o)}}function F($,ce){$.needsHillshadePrepare=!0;var Ce=ce.tileID.canonical.x-$.tileID.canonical.x,Ie=ce.tileID.canonical.y-$.tileID.canonical.y,ke=Math.pow(2,$.tileID.canonical.z),et=ce.tileID.key;0===Ce&&0===Ie||Math.abs(Ie)>1||(Math.abs(Ce)>1&&(1===Math.abs(Ce+ke)?Ce+=ke:1===Math.abs(Ce-ke)&&(Ce-=ke)),ce.dem&&$.dem&&($.dem.backfillBorder(ce.dem,Ce,Ie),$.neighboringTiles&&$.neighboringTiles[et]&&($.neighboringTiles[et].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,p,b,E){for(var A in this._tiles){var F=this._tiles[A];if(!(E[A]||!F.hasData()||F.tileID.overscaledZ<=p||F.tileID.overscaledZ>b)){for(var $=F.tileID;F&&F.tileID.overscaledZ>p+1;){var ce=F.tileID.scaledTo(F.tileID.overscaledZ-1);(F=this._tiles[ce.key])&&F.hasData()&&($=ce)}for(var Ce=$;Ce.overscaledZ>p;)if(o[(Ce=Ce.scaledTo(Ce.overscaledZ-1)).key]){E[$.key]=$;break}}}},s.prototype.findLoadedParent=function(o,p){if(o.key in this._loadedParentTiles){var b=this._loadedParentTiles[o.key];return b&&b.tileID.overscaledZ>=p?b:null}for(var E=o.overscaledZ-1;E>=p;E--){var A=o.scaledTo(E),F=this._getLoadedTile(A);if(F)return F}},s.prototype._getLoadedTile=function(o){var p=this._tiles[o.key];return p&&p.hasData()?p:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var p=Math.ceil(o.width/this._source.tileSize)+1,b=Math.ceil(o.height/this._source.tileSize)+1,E=Math.floor(p*b*5),A="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(A)},s.prototype.handleWrapJump=function(o){var p=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,p){var b={};for(var E in this._tiles){var A=this._tiles[E];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+p),b[A.tileID.key]=A}for(var F in this._tiles=b,this._timers)clearTimeout(this._timers[F]),delete this._timers[F];for(var $ in this._tiles)this._setTileReloadTimer($,this._tiles[$])}},s.prototype.update=function(o){var p=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var b;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?b=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Dr){return new c.OverscaledTileID(Dr.canonical.z,Dr.wrap,Dr.canonical.z,Dr.canonical.x,Dr.canonical.y)}):(b=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(b=b.filter(function(Dr){return p._source.hasTile(Dr)}))):b=[];var E=o.coveringZoomLevel(this._source),A=Math.max(E-s.maxOverzooming,this._source.minzoom),F=Math.max(E+s.maxUnderzooming,this._source.minzoom),$=this._updateRetainedTiles(b,E);if(Sr(this._source.type)){for(var ce={},Ce={},Ie=0,ke=Object.keys($);Ie<ke.length;Ie+=1){var et=ke[Ie],$e=$[et],ft=this._tiles[et];if(ft&&!(ft.fadeEndTime&&ft.fadeEndTime<=c.browser.now())){var Ye=this.findLoadedParent($e,A);Ye&&(this._addTile(Ye.tileID),ce[Ye.tileID.key]=Ye.tileID),Ce[et]=$e}}for(var lt in this._retainLoadedChildren(Ce,E,F,$),ce)$[lt]||(this._coveredTiles[lt]=!0,$[lt]=ce[lt])}for(var Pt in $)this._tiles[Pt].clearFadeHold();for(var Ht=0,hr=c.keysDifference(this._tiles,$);Ht<hr.length;Ht+=1){var nr=hr[Ht],_r=this._tiles[nr];_r.hasSymbolBuckets&&!_r.holdingForFade()?_r.setHoldDuration(this.map._fadeDuration):_r.hasSymbolBuckets&&!_r.symbolFadeFinished()||this._removeTile(nr)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,p){for(var b={},E={},A=Math.max(p-s.maxOverzooming,this._source.minzoom),F=Math.max(p+s.maxUnderzooming,this._source.minzoom),$={},ce=0,Ce=o;ce<Ce.length;ce+=1){var Ie=Ce[ce],ke=this._addTile(Ie);b[Ie.key]=Ie,ke.hasData()||p<this._source.maxzoom&&($[Ie.key]=Ie)}this._retainLoadedChildren($,p,F,b);for(var et=0,$e=o;et<$e.length;et+=1){var ft=$e[et],Ye=this._tiles[ft.key];if(!Ye.hasData()){if(p+1>this._source.maxzoom){var lt=ft.children(this._source.maxzoom)[0],Pt=this.getTile(lt);if(Pt&&Pt.hasData()){b[lt.key]=lt;continue}}else{var Ht=ft.children(this._source.maxzoom);if(b[Ht[0].key]&&b[Ht[1].key]&&b[Ht[2].key]&&b[Ht[3].key])continue}for(var hr=Ye.wasRequested(),nr=ft.overscaledZ-1;nr>=A;--nr){var _r=ft.scaledTo(nr);if(E[_r.key]||(E[_r.key]=!0,!(Ye=this.getTile(_r))&&hr&&(Ye=this._addTile(_r)),Ye&&(b[_r.key]=_r,hr=Ye.wasRequested(),Ye.hasData())))break}}}return b},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var p=[],b=void 0,E=this._tiles[o].tileID;E.overscaledZ>0;){if(E.key in this._loadedParentTiles){b=this._loadedParentTiles[E.key];break}p.push(E.key);var A=E.scaledTo(E.overscaledZ-1);if(b=this._getLoadedTile(A))break;E=A}for(var F=0,$=p;F<$.length;F+=1)this._loadedParentTiles[$[F]]=b}},s.prototype._addTile=function(o){var p=this._tiles[o.key];if(p)return p;(p=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,p),p.tileID=o,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,p)));var b=Boolean(p);return b||(p=new c.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(p,this._tileLoaded.bind(this,p,o.key,p.state))),p?(p.uses++,this._tiles[o.key]=p,b||this._source.fire(new c.Event("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p):null},s.prototype._setTileReloadTimer=function(o,p){var b=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var E=p.getExpiryTimeout();E&&(this._timers[o]=setTimeout(function(){b._reloadTile(o,"expired"),delete b._timers[o]},E))},s.prototype._removeTile=function(o){var p=this._tiles[o];p&&(p.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),p.uses>0||(p.hasData()&&"reloading"!==p.state?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,p,b){var E=this,A=[],F=this.transform;if(!F)return A;for(var $=b?F.getCameraQueryGeometry(o):o,ce=o.map(function(nr){return F.pointCoordinate(nr)}),Ce=$.map(function(nr){return F.pointCoordinate(nr)}),Ie=this.getIds(),ke=1/0,et=1/0,$e=-1/0,ft=-1/0,Ye=0,lt=Ce;Ye<lt.length;Ye+=1){var Pt=lt[Ye];ke=Math.min(ke,Pt.x),et=Math.min(et,Pt.y),$e=Math.max($e,Pt.x),ft=Math.max(ft,Pt.y)}for(var Ht=function(nr){var _r=E._tiles[Ie[nr]];if(!_r.holdingForFade()){var Dr=_r.tileID,Qr=Math.pow(2,F.zoom-_r.tileID.overscaledZ),Xr=p*_r.queryPadding*c.EXTENT/_r.tileSize/Qr,dn=[Dr.getTilePoint(new c.MercatorCoordinate(ke,et)),Dr.getTilePoint(new c.MercatorCoordinate($e,ft))];if(dn[0].x-Xr<c.EXTENT&&dn[0].y-Xr<c.EXTENT&&dn[1].x+Xr>=0&&dn[1].y+Xr>=0){var qn=ce.map(function(Bn){return Dr.getTilePoint(Bn)}),jn=Ce.map(function(Bn){return Dr.getTilePoint(Bn)});A.push({tile:_r,tileID:Dr,queryGeometry:qn,cameraQueryGeometry:jn,scale:Qr})}}},hr=0;hr<Ie.length;hr++)Ht(hr);return A},s.prototype.getVisibleCoordinates=function(o){for(var p=this,b=this.getRenderableIds(o).map(function($){return p._tiles[$].tileID}),E=0,A=b;E<A.length;E+=1){var F=A[E];F.posMatrix=this.transform.calculatePosMatrix(F.toUnwrapped())}return b},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Sr(this._source.type))for(var o in this._tiles){var p=this._tiles[o];if(void 0!==p.fadeEndTime&&p.fadeEndTime>=c.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,p,b){this._state.updateState(o=o||"_geojsonTileLayer",p,b)},s.prototype.removeFeatureState=function(o,p,b){this._state.removeFeatureState(o=o||"_geojsonTileLayer",p,b)},s.prototype.getFeatureState=function(o,p){return this._state.getState(o=o||"_geojsonTileLayer",p)},s.prototype.setDependencies=function(o,p,b){var E=this._tiles[o];E&&E.setDependencies(p,b)},s.prototype.reloadTilesForDependencies=function(o,p){for(var b in this._tiles)this._tiles[b].hasDependency(o,p)&&this._reloadTile(b,"reloading");this._cache.filter(function(E){return!E.hasDependency(o,p)})},s}(c.Evented);function wt(a,s){var o=Math.abs(2*a.wrap)-+(a.wrap<0),p=Math.abs(2*s.wrap)-+(s.wrap<0);return a.overscaledZ-s.overscaledZ||p-o||s.canonical.y-a.canonical.y||s.canonical.x-a.canonical.x}function Sr(a){return"raster"===a||"image"===a||"video"===a}function Kt(){return new c.window.Worker(El.workerUrl)}Ae.maxOverzooming=10,Ae.maxUnderzooming=3;var ir="mapboxgl_preloaded_worker_pool",Fr=function(){this.active={}};Fr.prototype.acquire=function(a){if(!this.workers)for(this.workers=[];this.workers.length<Fr.workerCount;)this.workers.push(new Kt);return this.active[a]=!0,this.workers.slice()},Fr.prototype.release=function(a){delete this.active[a],0===this.numActive()&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},Fr.prototype.isPreloaded=function(){return!!this.active[ir]},Fr.prototype.numActive=function(){return Object.keys(this.active).length};var Rn,Pn=Math.floor(c.browser.hardwareConcurrency/2);function rr(){return Rn||(Rn=new Fr),Rn}function Sn(a,s){var o={};for(var p in a)"ref"!==p&&(o[p]=a[p]);return c.refProperties.forEach(function(b){b in s&&(o[b]=s[b])}),o}function an(a){a=a.slice();for(var s=Object.create(null),o=0;o<a.length;o++)s[a[o].id]=a[o];for(var p=0;p<a.length;p++)"ref"in a[p]&&(a[p]=Sn(a[p],s[a[p].ref]));return a}Fr.workerCount=Math.max(Math.min(Pn,6),1);var fn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Di(a,s,o){o.push({command:fn.addSource,args:[a,s[a]]})}function _n(a,s,o){s.push({command:fn.removeSource,args:[a]}),o[a]=!0}function Oi(a,s,o,p){_n(a,o,p),Di(a,s,o)}function ta(a,s,o){var p;for(p in a[o])if(a[o].hasOwnProperty(p)&&"data"!==p&&!c.deepEqual(a[o][p],s[o][p]))return!1;for(p in s[o])if(s[o].hasOwnProperty(p)&&"data"!==p&&!c.deepEqual(a[o][p],s[o][p]))return!1;return!0}function oi(a,s,o,p,b,E){var A;for(A in s=s||{},a=a||{})a.hasOwnProperty(A)&&(c.deepEqual(a[A],s[A])||o.push({command:E,args:[p,A,s[A],b]}));for(A in s)s.hasOwnProperty(A)&&!a.hasOwnProperty(A)&&(c.deepEqual(a[A],s[A])||o.push({command:E,args:[p,A,s[A],b]}))}function Ji(a){return a.id}function Vi(a,s){return a[s.id]=s,a}var Ti=function(a,s){this.reset(a,s)};Ti.prototype.reset=function(a,s){this.points=a||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ti.prototype.lerp=function(a){if(1===this.points.length)return this.points[0];a=c.clamp(a,0,1);for(var s=1,o=this._distances[s],p=a*this.paddedLength+this.padding;o<p&&s<this._distances.length;)o=this._distances[++s];var b=s-1,E=this._distances[b],A=o-E,F=A>0?(p-E)/A:0;return this.points[b].mult(1-F).add(this.points[s].mult(F))};var _a=function(a,s,o){var p=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(a/o),this.yCellCount=Math.ceil(s/o);for(var E=0;E<this.xCellCount*this.yCellCount;E++)p.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=s,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Ia(a,s,o,p,b){var E=c.create();return s?(c.scale(E,E,[1/b,1/b,1]),o||c.rotateZ(E,E,p.angle)):c.multiply(E,p.labelPlaneMatrix,a),E}function Gi(a,s,o,p,b){if(s){var E=c.clone(a);return c.scale(E,E,[b,b,1]),o||c.rotateZ(E,E,-p.angle),E}return p.glCoordMatrix}function Bi(a,s){var o=[a.x,a.y,0,1];ra(o,o,s);var p=o[3];return{point:new c.Point(o[0]/p,o[1]/p),signedDistanceFromCamera:p}}function Xi(a,s){return.5+a/s*.5}function to(a,s){var o=a[0]/a[3],p=a[1]/a[3];return o>=-s[0]&&o<=s[0]&&p>=-s[1]&&p<=s[1]}function Ho(a,s,o,p,b,E,A,F){var $=p?a.textSizeData:a.iconSizeData,ce=c.evaluateSizeForZoom($,o.transform.zoom),Ce=[256/o.width*2+1,256/o.height*2+1],Ie=p?a.text.dynamicLayoutVertexArray:a.icon.dynamicLayoutVertexArray;Ie.clear();for(var ke=a.lineVertexArray,et=p?a.text.placedSymbolArray:a.icon.placedSymbolArray,$e=o.transform.width/o.transform.height,ft=!1,Ye=0;Ye<et.length;Ye++){var lt=et.get(Ye);if(lt.hidden||lt.writingMode===c.WritingMode.vertical&&!ft)Fi(lt.numGlyphs,Ie);else{ft=!1;var Pt=[lt.anchorX,lt.anchorY,0,1];if(c.transformMat4(Pt,Pt,s),to(Pt,Ce)){var Ht=Xi(o.transform.cameraToCenterDistance,Pt[3]),hr=c.evaluateSizeForFeature($,ce,lt),nr=A?hr/Ht:hr*Ht,_r=new c.Point(lt.anchorX,lt.anchorY),Dr=Bi(_r,b).point,Qr={},Xr=va(lt,nr,!1,F,s,b,E,a.glyphOffsetArray,ke,Ie,Dr,_r,Qr,$e);ft=Xr.useVertical,(Xr.notEnoughRoom||ft||Xr.needsFlipping&&va(lt,nr,!0,F,s,b,E,a.glyphOffsetArray,ke,Ie,Dr,_r,Qr,$e).notEnoughRoom)&&Fi(lt.numGlyphs,Ie)}else Fi(lt.numGlyphs,Ie)}}p?a.text.dynamicLayoutVertexBuffer.updateData(Ie):a.icon.dynamicLayoutVertexBuffer.updateData(Ie)}function Za(a,s,o,p,b,E,A,F,$,ce,Ce){var Ie=F.glyphStartIndex+F.numGlyphs,ke=F.lineStartIndex,et=F.lineStartIndex+F.lineLength,$e=s.getoffsetX(F.glyphStartIndex),ft=s.getoffsetX(Ie-1),Ye=Da(a*$e,o,p,b,E,A,F.segment,ke,et,$,ce,Ce);if(!Ye)return null;var lt=Da(a*ft,o,p,b,E,A,F.segment,ke,et,$,ce,Ce);return lt?{first:Ye,last:lt}:null}function Wi(a,s,o,p){return a===c.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*p?{useVertical:!0}:(a===c.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function va(a,s,o,p,b,E,A,F,$,ce,Ce,Ie,ke,et){var $e,ft=s/24,Ye=a.lineOffsetX*ft,lt=a.lineOffsetY*ft;if(a.numGlyphs>1){var Pt=a.glyphStartIndex+a.numGlyphs,Ht=a.lineStartIndex,hr=a.lineStartIndex+a.lineLength,nr=Za(ft,F,Ye,lt,o,Ce,Ie,a,$,E,ke);if(!nr)return{notEnoughRoom:!0};var _r=Bi(nr.first.point,A).point,Dr=Bi(nr.last.point,A).point;if(p&&!o){var Qr=Wi(a.writingMode,_r,Dr,et);if(Qr)return Qr}$e=[nr.first];for(var Xr=a.glyphStartIndex+1;Xr<Pt-1;Xr++)$e.push(Da(ft*F.getoffsetX(Xr),Ye,lt,o,Ce,Ie,a.segment,Ht,hr,$,E,ke));$e.push(nr.last)}else{if(p&&!o){var dn=Bi(Ie,b).point,qn=a.lineStartIndex+a.segment+1,jn=new c.Point($.getx(qn),$.gety(qn)),Bn=Bi(jn,b),Li=Bn.signedDistanceFromCamera>0?Bn.point:wu(Ie,jn,dn,1,b),Dn=Wi(a.writingMode,dn,Li,et);if(Dn)return Dn}var gi=Da(ft*F.getoffsetX(a.glyphStartIndex),Ye,lt,o,Ce,Ie,a.segment,a.lineStartIndex,a.lineStartIndex+a.lineLength,$,E,ke);if(!gi)return{notEnoughRoom:!0};$e=[gi]}for(var ji=0,li=$e;ji<li.length;ji+=1){var yi=li[ji];c.addDynamicAttributes(ce,yi.point,yi.angle)}return{}}function wu(a,s,o,p,b){var E=Bi(a.add(a.sub(s)._unit()),b).point,A=o.sub(E);return o.add(A._mult(p/A.mag()))}function Da(a,s,o,p,b,E,A,F,$,ce,Ce,Ie){var ke=p?a-s:a+s,et=ke>0?1:-1,$e=0;p&&(et*=-1,$e=Math.PI),et<0&&($e+=Math.PI);for(var ft=et>0?F+A:F+A+1,Ye=b,lt=b,Pt=0,Ht=0,hr=Math.abs(ke),nr=[];Pt+Ht<=hr;){if((ft+=et)<F||ft>=$)return null;if(lt=Ye,nr.push(Ye),void 0===(Ye=Ie[ft])){var _r=new c.Point(ce.getx(ft),ce.gety(ft)),Dr=Bi(_r,Ce);if(Dr.signedDistanceFromCamera>0)Ye=Ie[ft]=Dr.point;else{var Qr=ft-et;Ye=wu(0===Pt?E:new c.Point(ce.getx(Qr),ce.gety(Qr)),_r,lt,hr-Pt+1,Ce)}}Pt+=Ht,Ht=lt.dist(Ye)}var Xr=(hr-Pt)/Ht,dn=Ye.sub(lt),qn=dn.mult(Xr)._add(lt);qn._add(dn._unit()._perp()._mult(o*et));var jn=$e+Math.atan2(Ye.y-lt.y,Ye.x-lt.x);return nr.push(qn),{point:qn,angle:jn,path:nr}}_a.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},_a.prototype.insert=function(a,s,o,p,b){this._forEachCell(s,o,p,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(p),this.bboxes.push(b)},_a.prototype.insertCircle=function(a,s,o,p){this._forEachCell(s-p,o-p,s+p,o+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(s),this.circles.push(o),this.circles.push(p)},_a.prototype._insertBoxCell=function(a,s,o,p,b,E){this.boxCells[b].push(E)},_a.prototype._insertCircleCell=function(a,s,o,p,b,E){this.circleCells[b].push(E)},_a.prototype._query=function(a,s,o,p,b,E){if(o<0||a>this.width||p<0||s>this.height)return!b&&[];var A=[];if(a<=0&&s<=0&&this.width<=o&&this.height<=p){if(b)return!0;for(var F=0;F<this.boxKeys.length;F++)A.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(var $=0;$<this.circleKeys.length;$++){var ce=this.circles[3*$],Ce=this.circles[3*$+1],Ie=this.circles[3*$+2];A.push({key:this.circleKeys[$],x1:ce-Ie,y1:Ce-Ie,x2:ce+Ie,y2:Ce+Ie})}return E?A.filter(E):A}return this._forEachCell(a,s,o,p,this._queryCell,A,{hitTest:b,seenUids:{box:{},circle:{}}},E),b?A.length>0:A},_a.prototype._queryCircle=function(a,s,o,p,b){var E=a-o,A=a+o,F=s-o,$=s+o;if(A<0||E>this.width||$<0||F>this.height)return!p&&[];var ce=[];return this._forEachCell(E,F,A,$,this._queryCellCircle,ce,{hitTest:p,circle:{x:a,y:s,radius:o},seenUids:{box:{},circle:{}}},b),p?ce.length>0:ce},_a.prototype.query=function(a,s,o,p,b){return this._query(a,s,o,p,!1,b)},_a.prototype.hitTest=function(a,s,o,p,b){return this._query(a,s,o,p,!0,b)},_a.prototype.hitTestCircle=function(a,s,o,p){return this._queryCircle(a,s,o,!0,p)},_a.prototype._queryCell=function(a,s,o,p,b,E,A,F){var $=A.seenUids,ce=this.boxCells[b];if(null!==ce)for(var Ce=this.bboxes,Ie=0,ke=ce;Ie<ke.length;Ie+=1){var et=ke[Ie];if(!$.box[et]){$.box[et]=!0;var $e=4*et;if(a<=Ce[$e+2]&&s<=Ce[$e+3]&&o>=Ce[$e+0]&&p>=Ce[$e+1]&&(!F||F(this.boxKeys[et]))){if(A.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[et],x1:Ce[$e],y1:Ce[$e+1],x2:Ce[$e+2],y2:Ce[$e+3]})}}}var ft=this.circleCells[b];if(null!==ft)for(var Ye=this.circles,lt=0,Pt=ft;lt<Pt.length;lt+=1){var Ht=Pt[lt];if(!$.circle[Ht]){$.circle[Ht]=!0;var hr=3*Ht;if(this._circleAndRectCollide(Ye[hr],Ye[hr+1],Ye[hr+2],a,s,o,p)&&(!F||F(this.circleKeys[Ht]))){if(A.hitTest)return E.push(!0),!0;var nr=Ye[hr],_r=Ye[hr+1],Dr=Ye[hr+2];E.push({key:this.circleKeys[Ht],x1:nr-Dr,y1:_r-Dr,x2:nr+Dr,y2:_r+Dr})}}}},_a.prototype._queryCellCircle=function(a,s,o,p,b,E,A,F){var $=A.circle,ce=A.seenUids,Ce=this.boxCells[b];if(null!==Ce)for(var Ie=this.bboxes,ke=0,et=Ce;ke<et.length;ke+=1){var $e=et[ke];if(!ce.box[$e]){ce.box[$e]=!0;var ft=4*$e;if(this._circleAndRectCollide($.x,$.y,$.radius,Ie[ft+0],Ie[ft+1],Ie[ft+2],Ie[ft+3])&&(!F||F(this.boxKeys[$e])))return E.push(!0),!0}}var Ye=this.circleCells[b];if(null!==Ye)for(var lt=this.circles,Pt=0,Ht=Ye;Pt<Ht.length;Pt+=1){var hr=Ht[Pt];if(!ce.circle[hr]){ce.circle[hr]=!0;var nr=3*hr;if(this._circlesCollide(lt[nr],lt[nr+1],lt[nr+2],$.x,$.y,$.radius)&&(!F||F(this.circleKeys[hr])))return E.push(!0),!0}}},_a.prototype._forEachCell=function(a,s,o,p,b,E,A,F){for(var $=this._convertToXCellCoord(a),ce=this._convertToYCellCoord(s),Ce=this._convertToXCellCoord(o),Ie=this._convertToYCellCoord(p),ke=$;ke<=Ce;ke++)for(var et=ce;et<=Ie;et++)if(b.call(this,a,s,o,p,this.xCellCount*et+ke,E,A,F))return},_a.prototype._convertToXCellCoord=function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))},_a.prototype._convertToYCellCoord=function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))},_a.prototype._circlesCollide=function(a,s,o,p,b,E){var A=p-a,F=b-s,$=o+E;return $*$>A*A+F*F},_a.prototype._circleAndRectCollide=function(a,s,o,p,b,E,A){var F=(E-p)/2,$=Math.abs(a-(p+F));if($>F+o)return!1;var ce=(A-b)/2,Ce=Math.abs(s-(b+ce));if(Ce>ce+o)return!1;if($<=F||Ce<=ce)return!0;var Ie=$-F,ke=Ce-ce;return Ie*Ie+ke*ke<=o*o};var qo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Fi(a,s){for(var o=0;o<a;o++){var p=s.length;s.resize(p+4),s.float32.set(qo,3*p)}}function ra(a,s,o){var p=s[0],b=s[1];return a[0]=o[0]*p+o[4]*b+o[12],a[1]=o[1]*p+o[5]*b+o[13],a[3]=o[3]*p+o[7]*b+o[15],a}var bo=function(a,s,o){void 0===s&&(s=new _a(a.width+200,a.height+200,25)),void 0===o&&(o=new _a(a.width+200,a.height+200,25)),this.transform=a,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function ma(a,s,o){return s*(c.EXTENT/(a.tileSize*Math.pow(2,o-a.tileID.overscaledZ)))}bo.prototype.placeCollisionBox=function(a,s,o,p,b){var E=this.projectAndGetPerspectiveRatio(p,a.anchorPointX,a.anchorPointY),A=o*E.perspectiveRatio,F=a.x1*A+E.point.x,$=a.y1*A+E.point.y,ce=a.x2*A+E.point.x,Ce=a.y2*A+E.point.y;return!this.isInsideGrid(F,$,ce,Ce)||!s&&this.grid.hitTest(F,$,ce,Ce,b)?{box:[],offscreen:!1}:{box:[F,$,ce,Ce],offscreen:this.isOffscreen(F,$,ce,Ce)}},bo.prototype.placeCollisionCircles=function(a,s,o,p,b,E,A,F,$,ce,Ce,Ie,ke){var et=[],$e=new c.Point(s.anchorX,s.anchorY),ft=Bi($e,E),Ye=Xi(this.transform.cameraToCenterDistance,ft.signedDistanceFromCamera),lt=(ce?b/Ye:b*Ye)/c.ONE_EM,Pt=Bi($e,A).point,Ht=Za(lt,p,s.lineOffsetX*lt,s.lineOffsetY*lt,!1,Pt,$e,s,o,A,{}),hr=!1,nr=!1,_r=!0;if(Ht){for(var Dr=.5*Ie*Ye+ke,Qr=new c.Point(-100,-100),Xr=new c.Point(this.screenRightBoundary,this.screenBottomBoundary),dn=new Ti,qn=Ht.first,jn=Ht.last,Bn=[],Li=qn.path.length-1;Li>=1;Li--)Bn.push(qn.path[Li]);for(var Dn=1;Dn<jn.path.length;Dn++)Bn.push(jn.path[Dn]);var gi=2.5*Dr;if(F){var ji=Bn.map(function(ni){return Bi(ni,F)});Bn=ji.some(function(ni){return ni.signedDistanceFromCamera<=0})?[]:ji.map(function(ni){return ni.point})}var li=[];if(Bn.length>0){for(var yi=Bn[0].clone(),Ni=Bn[0].clone(),te=1;te<Bn.length;te++)yi.x=Math.min(yi.x,Bn[te].x),yi.y=Math.min(yi.y,Bn[te].y),Ni.x=Math.max(Ni.x,Bn[te].x),Ni.y=Math.max(Ni.y,Bn[te].y);li=yi.x>=Qr.x&&Ni.x<=Xr.x&&yi.y>=Qr.y&&Ni.y<=Xr.y?[Bn]:Ni.x<Qr.x||yi.x>Xr.x||Ni.y<Qr.y||yi.y>Xr.y?[]:c.clipLine([Bn],Qr.x,Qr.y,Xr.x,Xr.y)}for(var ne=0,N=li;ne<N.length;ne+=1){var U;dn.reset(N[ne],.25*Dr),U=dn.length<=.5*Dr?1:Math.ceil(dn.paddedLength/gi)+1;for(var he=0;he<U;he++){var Te=he/Math.max(U-1,1),vt=dn.lerp(Te),Rt=vt.x+100,Ot=vt.y+100;et.push(Rt,Ot,Dr,0);var ur=Rt-Dr,Vr=Ot-Dr,Ln=Rt+Dr,Xn=Ot+Dr;if(_r=_r&&this.isOffscreen(ur,Vr,Ln,Xn),nr=nr||this.isInsideGrid(ur,Vr,Ln,Xn),!a&&this.grid.hitTestCircle(Rt,Ot,Dr,Ce)&&(hr=!0,!$))return{circles:[],offscreen:!1,collisionDetected:hr}}}}return{circles:!$&&hr||!nr?[]:et,offscreen:_r,collisionDetected:hr}},bo.prototype.queryRenderedSymbols=function(a){if(0===a.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var s=[],o=1/0,p=1/0,b=-1/0,E=-1/0,A=0,F=a;A<F.length;A+=1){var $=F[A],ce=new c.Point($.x+100,$.y+100);o=Math.min(o,ce.x),p=Math.min(p,ce.y),b=Math.max(b,ce.x),E=Math.max(E,ce.y),s.push(ce)}for(var Ce={},Ie={},ke=0,et=this.grid.query(o,p,b,E).concat(this.ignoredGrid.query(o,p,b,E));ke<et.length;ke+=1){var $e=et[ke],ft=$e.key;if(void 0===Ce[ft.bucketInstanceId]&&(Ce[ft.bucketInstanceId]={}),!Ce[ft.bucketInstanceId][ft.featureIndex]){var Ye=[new c.Point($e.x1,$e.y1),new c.Point($e.x2,$e.y1),new c.Point($e.x2,$e.y2),new c.Point($e.x1,$e.y2)];c.polygonIntersectsPolygon(s,Ye)&&(Ce[ft.bucketInstanceId][ft.featureIndex]=!0,void 0===Ie[ft.bucketInstanceId]&&(Ie[ft.bucketInstanceId]=[]),Ie[ft.bucketInstanceId].push(ft.featureIndex))}}return Ie},bo.prototype.insertCollisionBox=function(a,s,o,p,b){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:p,collisionGroupID:b},a[0],a[1],a[2],a[3])},bo.prototype.insertCollisionCircles=function(a,s,o,p,b){for(var E=s?this.ignoredGrid:this.grid,A={bucketInstanceId:o,featureIndex:p,collisionGroupID:b},F=0;F<a.length;F+=4)E.insertCircle(A,a[F],a[F+1],a[F+2])},bo.prototype.projectAndGetPerspectiveRatio=function(a,s,o){var p=[s,o,0,1];return ra(p,p,a),{point:new c.Point((p[0]/p[3]+1)/2*this.transform.width+100,(-p[1]/p[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/p[3]*.5}},bo.prototype.isOffscreen=function(a,s,o,p){return o<100||a>=this.screenRightBoundary||p<100||s>this.screenBottomBoundary},bo.prototype.isInsideGrid=function(a,s,o,p){return o>=0&&a<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary},bo.prototype.getViewportMatrix=function(){var a=c.identity([]);return c.translate(a,a,[-100,-100,0]),a};var vo=function(a,s,o,p){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?s:-s))):p&&o?1:0,this.placed=o};vo.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var No=function(a,s,o,p,b){this.text=new vo(a?a.text:null,s,o,b),this.icon=new vo(a?a.icon:null,s,p,b)};No.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Ls=function(a,s,o){this.text=a,this.icon=s,this.skipFade=o},aa=function(){this.invProjMatrix=c.create(),this.viewportMatrix=c.create(),this.circles=[]},Jo=function(a,s,o,p,b){this.bucketInstanceId=a,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=p,this.tileID=b},Ma=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function Ka(a,s,o,p,b){var E=c.getAnchorAlignment(a),A=-(E.horizontalAlign-.5)*s,F=-(E.verticalAlign-.5)*o,$=c.evaluateVariableOffset(a,p);return new c.Point(A+$[0]*b,F+$[1]*b)}function $o(a,s,o,p,b,E){var A=a.x1,F=a.x2,$=a.y1,ce=a.y2,Ce=a.anchorPointX,Ie=a.anchorPointY,ke=new c.Point(s,o);return p&&ke._rotate(b?E:-E),{x1:A+ke.x,y1:$+ke.y,x2:F+ke.x,y2:ce+ke.y,anchorPointX:Ce,anchorPointY:Ie}}Ma.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var s=++this.maxGroupID;this.collisionGroups[a]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[a]};var Ba=function(a,s,o,p){this.transform=a.clone(),this.collisionIndex=new bo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Ma(o),this.collisionCircleArrays={},this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}};function Ee(a,s,o,p,b){a.emplaceBack(s?1:0,o?1:0,p||0,b||0),a.emplaceBack(s?1:0,o?1:0,p||0,b||0),a.emplaceBack(s?1:0,o?1:0,p||0,b||0),a.emplaceBack(s?1:0,o?1:0,p||0,b||0)}Ba.prototype.getBucketParts=function(a,s,o,p){var b=o.getBucket(s),E=o.latestFeatureIndex;if(b&&E&&s.id===b.layerIds[0]){var A=o.collisionBoxArray,F=b.layers[0].layout,$=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),ce=o.tileSize/c.EXTENT,Ce=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),Ie="map"===F.get("text-pitch-alignment"),ke="map"===F.get("text-rotation-alignment"),et=ma(o,1,this.transform.zoom),$e=Ia(Ce,Ie,ke,this.transform,et),ft=null;if(Ie){var Ye=Gi(Ce,Ie,ke,this.transform,et);ft=c.multiply([],this.transform.labelPlaneMatrix,Ye)}this.retainedQueryData[b.bucketInstanceId]=new Jo(b.bucketInstanceId,E,b.sourceLayerIndex,b.index,o.tileID);var lt={bucket:b,layout:F,posMatrix:Ce,textLabelPlaneMatrix:$e,labelToScreenMatrix:ft,scale:$,textPixelRatio:ce,holdingForFade:o.holdingForFade(),collisionBoxArray:A,partiallyEvaluatedTextSize:c.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(p)for(var Pt=0,Ht=b.sortKeyRanges;Pt<Ht.length;Pt+=1){var hr=Ht[Pt];a.push({sortKey:hr.sortKey,symbolInstanceStart:hr.symbolInstanceStart,symbolInstanceEnd:hr.symbolInstanceEnd,parameters:lt})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:lt})}},Ba.prototype.attemptAnchorPlacement=function(a,s,o,p,b,E,A,F,$,ce,Ce,Ie,ke,et,$e){var ft,Ye=[Ie.textOffset0,Ie.textOffset1],lt=Ka(a,o,p,Ye,b),Pt=this.collisionIndex.placeCollisionBox($o(s,lt.x,lt.y,E,A,this.transform.angle),Ce,F,$,ce.predicate);if(!$e||0!==this.collisionIndex.placeCollisionBox($o($e,lt.x,lt.y,E,A,this.transform.angle),Ce,F,$,ce.predicate).box.length)return Pt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Ie.crossTileID]&&this.prevPlacement.placements[Ie.crossTileID]&&this.prevPlacement.placements[Ie.crossTileID].text&&(ft=this.prevPlacement.variableOffsets[Ie.crossTileID].anchor),this.variableOffsets[Ie.crossTileID]={textOffset:Ye,width:o,height:p,anchor:a,textBoxScale:b,prevAnchor:ft},this.markUsedJustification(ke,a,Ie,et),ke.allowVerticalPlacement&&(this.markUsedOrientation(ke,et,Ie),this.placedOrientations[Ie.crossTileID]=et),{shift:lt,placedGlyphBoxes:Pt}):void 0},Ba.prototype.placeLayerBucketPart=function(a,s,o){var p=this,b=a.parameters,E=b.bucket,A=b.layout,F=b.posMatrix,$=b.textLabelPlaneMatrix,ce=b.labelToScreenMatrix,Ce=b.textPixelRatio,Ie=b.holdingForFade,ke=b.collisionBoxArray,et=b.partiallyEvaluatedTextSize,$e=b.collisionGroup,ft=A.get("text-optional"),Ye=A.get("icon-optional"),lt=A.get("text-allow-overlap"),Pt=A.get("icon-allow-overlap"),Ht="map"===A.get("text-rotation-alignment"),hr="map"===A.get("text-pitch-alignment"),nr="none"!==A.get("icon-text-fit"),_r="viewport-y"===A.get("symbol-z-order"),Dr=lt&&(Pt||!E.hasIconData()||Ye),Qr=Pt&&(lt||!E.hasTextData()||ft);!E.collisionArrays&&ke&&E.deserializeCollisionBoxes(ke);var Xr=function(Dn,gi){if(!s[Dn.crossTileID])if(Ie)p.placements[Dn.crossTileID]=new Ls(!1,!1,!1);else{var ji,li=!1,yi=!1,Ni=!0,te=null,ne={box:null,offscreen:null},N={box:null,offscreen:null},U=null,he=null,Te=0,vt=0,Rt=0;gi.textFeatureIndex?Te=gi.textFeatureIndex:Dn.useRuntimeCollisionCircles&&(Te=Dn.featureIndex),gi.verticalTextFeatureIndex&&(vt=gi.verticalTextFeatureIndex);var Ot=gi.textBox;if(Ot){var ur=function(ki){var Ca=c.WritingMode.horizontal;if(E.allowVerticalPlacement&&!ki&&p.prevPlacement){var ba=p.prevPlacement.placedOrientations[Dn.crossTileID];ba&&(p.placedOrientations[Dn.crossTileID]=ba,p.markUsedOrientation(E,Ca=ba,Dn))}return Ca},Vr=function(ki,Ca){if(E.allowVerticalPlacement&&Dn.numVerticalGlyphVertices>0&&gi.verticalTextBox)for(var ba=0,go=E.writingModes;ba<go.length&&(go[ba]===c.WritingMode.vertical?(ne=Ca(),N=ne):ne=ki(),!(ne&&ne.box&&ne.box.length));ba+=1);else ne=ki()};if(A.get("text-variable-anchor")){var Ln=A.get("text-variable-anchor");if(p.prevPlacement&&p.prevPlacement.variableOffsets[Dn.crossTileID]){var Xn=p.prevPlacement.variableOffsets[Dn.crossTileID];Ln.indexOf(Xn.anchor)>0&&(Ln=Ln.filter(function(ki){return ki!==Xn.anchor})).unshift(Xn.anchor)}var ni=function(ki,Ca,ba){for(var go=ki.x2-ki.x1,Kl=ki.y2-ki.y1,uu=Dn.textBoxScale,Yo=nr&&!Pt?Ca:null,Su={box:[],offscreen:!1},Hu=lt?2*Ln.length:Ln.length,ul=0;ul<Hu;++ul){var Ks=p.attemptAnchorPlacement(Ln[ul%Ln.length],ki,go,Kl,uu,Ht,hr,Ce,F,$e,ul>=Ln.length,Dn,E,ba,Yo);if(Ks&&(Su=Ks.placedGlyphBoxes)&&Su.box&&Su.box.length){li=!0,te=Ks.shift;break}}return Su};Vr(function(){return ni(Ot,gi.iconBox,c.WritingMode.horizontal)},function(){var ki=gi.verticalTextBox;return E.allowVerticalPlacement&&!(ne&&ne.box&&ne.box.length)&&Dn.numVerticalGlyphVertices>0&&ki?ni(ki,gi.verticalIconBox,c.WritingMode.vertical):{box:null,offscreen:null}}),ne&&(li=ne.box,Ni=ne.offscreen);var Ci=ur(ne&&ne.box);if(!li&&p.prevPlacement){var Si=p.prevPlacement.variableOffsets[Dn.crossTileID];Si&&(p.variableOffsets[Dn.crossTileID]=Si,p.markUsedJustification(E,Si.anchor,Dn,Ci))}}else{var ea=function(ki,Ca){var ba=p.collisionIndex.placeCollisionBox(ki,lt,Ce,F,$e.predicate);return ba&&ba.box&&ba.box.length&&(p.markUsedOrientation(E,Ca,Dn),p.placedOrientations[Dn.crossTileID]=Ca),ba};Vr(function(){return ea(Ot,c.WritingMode.horizontal)},function(){var ki=gi.verticalTextBox;return E.allowVerticalPlacement&&Dn.numVerticalGlyphVertices>0&&ki?ea(ki,c.WritingMode.vertical):{box:null,offscreen:null}}),ur(ne&&ne.box&&ne.box.length)}}if(li=(ji=ne)&&ji.box&&ji.box.length>0,Ni=ji&&ji.offscreen,Dn.useRuntimeCollisionCircles){var xa=E.text.placedSymbolArray.get(Dn.centerJustifiedTextSymbolIndex),ua=c.evaluateSizeForFeature(E.textSizeData,et,xa),Ha=A.get("text-padding");U=p.collisionIndex.placeCollisionCircles(lt,xa,E.lineVertexArray,E.glyphOffsetArray,ua,F,$,ce,o,hr,$e.predicate,Dn.collisionCircleDiameter,Ha),li=lt||U.circles.length>0&&!U.collisionDetected,Ni=Ni&&U.offscreen}if(gi.iconFeatureIndex&&(Rt=gi.iconFeatureIndex),gi.iconBox){var Wa=function(ki){var Ca=nr&&te?$o(ki,te.x,te.y,Ht,hr,p.transform.angle):ki;return p.collisionIndex.placeCollisionBox(Ca,Pt,Ce,F,$e.predicate)};yi=N&&N.box&&N.box.length&&gi.verticalIconBox?(he=Wa(gi.verticalIconBox)).box.length>0:(he=Wa(gi.iconBox)).box.length>0,Ni=Ni&&he.offscreen}var Ya=ft||0===Dn.numHorizontalGlyphVertices&&0===Dn.numVerticalGlyphVertices,ia=Ye||0===Dn.numIconVertices;if(Ya||ia?ia?Ya||(yi=yi&&li):li=yi&&li:yi=li=yi&&li,li&&ji&&ji.box&&p.collisionIndex.insertCollisionBox(ji.box,A.get("text-ignore-placement"),E.bucketInstanceId,N&&N.box&&vt?vt:Te,$e.ID),yi&&he&&p.collisionIndex.insertCollisionBox(he.box,A.get("icon-ignore-placement"),E.bucketInstanceId,Rt,$e.ID),U&&(li&&p.collisionIndex.insertCollisionCircles(U.circles,A.get("text-ignore-placement"),E.bucketInstanceId,Te,$e.ID),o)){var ga=E.bucketInstanceId,la=p.collisionCircleArrays[ga];void 0===la&&(la=p.collisionCircleArrays[ga]=new aa);for(var no=0;no<U.circles.length;no+=4)la.circles.push(U.circles[no+0]),la.circles.push(U.circles[no+1]),la.circles.push(U.circles[no+2]),la.circles.push(U.collisionDetected?1:0)}p.placements[Dn.crossTileID]=new Ls(li||Dr,yi||Qr,Ni||E.justReloaded),s[Dn.crossTileID]=!0}};if(_r)for(var dn=E.getSortedSymbolIndexes(this.transform.angle),qn=dn.length-1;qn>=0;--qn){var jn=dn[qn];Xr(E.symbolInstances.get(jn),E.collisionArrays[jn])}else for(var Bn=a.symbolInstanceStart;Bn<a.symbolInstanceEnd;Bn++)Xr(E.symbolInstances.get(Bn),E.collisionArrays[Bn]);if(o&&E.bucketInstanceId in this.collisionCircleArrays){var Li=this.collisionCircleArrays[E.bucketInstanceId];c.invert(Li.invProjMatrix,F),Li.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1},Ba.prototype.markUsedJustification=function(a,s,o,p){var b;b=p===c.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[c.getAnchorJustification(s)];for(var E=0,A=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];E<A.length;E+=1){var F=A[E];F>=0&&(a.text.placedSymbolArray.get(F).crossTileID=b>=0&&F!==b?0:o.crossTileID)}},Ba.prototype.markUsedOrientation=function(a,s,o){for(var p=s===c.WritingMode.horizontal||s===c.WritingMode.horizontalOnly?s:0,b=s===c.WritingMode.vertical?s:0,E=0,A=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];E<A.length;E+=1)a.text.placedSymbolArray.get(A[E]).placedOrientation=p;o.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=b)},Ba.prototype.commit=function(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var p=s?s.symbolFadeChange(a):1,b=s?s.opacities:{},E=s?s.variableOffsets:{},A=s?s.placedOrientations:{};for(var F in this.placements){var $=this.placements[F],ce=b[F];ce?(this.opacities[F]=new No(ce,p,$.text,$.icon),o=o||$.text!==ce.text.placed||$.icon!==ce.icon.placed):(this.opacities[F]=new No(null,p,$.text,$.icon,$.skipFade),o=o||$.text||$.icon)}for(var Ce in b){var Ie=b[Ce];if(!this.opacities[Ce]){var ke=new No(Ie,p,!1,!1);ke.isHidden()||(this.opacities[Ce]=ke,o=o||Ie.text.placed||Ie.icon.placed)}}for(var et in E)this.variableOffsets[et]||!this.opacities[et]||this.opacities[et].isHidden()||(this.variableOffsets[et]=E[et]);for(var $e in A)this.placedOrientations[$e]||!this.opacities[$e]||this.opacities[$e].isHidden()||(this.placedOrientations[$e]=A[$e]);o?this.lastPlacementChangeTime=a:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:a)},Ba.prototype.updateLayerOpacities=function(a,s){for(var o={},p=0,b=s;p<b.length;p+=1){var E=b[p],A=E.getBucket(a);A&&E.latestFeatureIndex&&a.id===A.layerIds[0]&&this.updateBucketOpacities(A,o,E.collisionBoxArray)}},Ba.prototype.updateBucketOpacities=function(a,s,o){var p=this;a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();var b=a.layers[0].layout,E=new No(null,0,!1,!1,!0),A=b.get("text-allow-overlap"),F=b.get("icon-allow-overlap"),$=b.get("text-variable-anchor"),ce="map"===b.get("text-rotation-alignment"),Ce="map"===b.get("text-pitch-alignment"),Ie="none"!==b.get("icon-text-fit"),ke=new No(null,0,A&&(F||!a.hasIconData()||b.get("icon-optional")),F&&(A||!a.hasTextData()||b.get("text-optional")),!0);!a.collisionArrays&&o&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(o);for(var et=function(lt,Pt,Ht){for(var hr=0;hr<Pt/4;hr++)lt.opacityVertexArray.emplaceBack(Ht)},$e=function(lt){var Pt=a.symbolInstances.get(lt),Ht=Pt.numHorizontalGlyphVertices,hr=Pt.numVerticalGlyphVertices,nr=Pt.crossTileID,_r=p.opacities[nr];s[nr]?_r=E:_r||(p.opacities[nr]=_r=ke),s[nr]=!0;var Dr=Pt.numIconVertices>0,Qr=p.placedOrientations[Pt.crossTileID],Xr=Qr===c.WritingMode.vertical,dn=Qr===c.WritingMode.horizontal||Qr===c.WritingMode.horizontalOnly;if(Ht>0||hr>0){var qn=ro(_r.text);et(a.text,Ht,Xr?co:qn),et(a.text,hr,dn?co:qn);var jn=_r.text.isHidden();[Pt.rightJustifiedTextSymbolIndex,Pt.centerJustifiedTextSymbolIndex,Pt.leftJustifiedTextSymbolIndex].forEach(function(ne){ne>=0&&(a.text.placedSymbolArray.get(ne).hidden=jn||Xr?1:0)}),Pt.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(Pt.verticalPlacedTextSymbolIndex).hidden=jn||dn?1:0);var Bn=p.variableOffsets[Pt.crossTileID];Bn&&p.markUsedJustification(a,Bn.anchor,Pt,Qr);var Li=p.placedOrientations[Pt.crossTileID];Li&&(p.markUsedJustification(a,"left",Pt,Li),p.markUsedOrientation(a,Li,Pt))}if(Dr){var Dn=ro(_r.icon),gi=!(Ie&&Pt.verticalPlacedIconSymbolIndex&&Xr);Pt.placedIconSymbolIndex>=0&&(et(a.icon,Pt.numIconVertices,gi?Dn:co),a.icon.placedSymbolArray.get(Pt.placedIconSymbolIndex).hidden=_r.icon.isHidden()),Pt.verticalPlacedIconSymbolIndex>=0&&(et(a.icon,Pt.numVerticalIconVertices,gi?co:Dn),a.icon.placedSymbolArray.get(Pt.verticalPlacedIconSymbolIndex).hidden=_r.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){var ji=a.collisionArrays[lt];if(ji){var li=new c.Point(0,0);if(ji.textBox||ji.verticalTextBox){var yi=!0;if($){var Ni=p.variableOffsets[nr];Ni?(li=Ka(Ni.anchor,Ni.width,Ni.height,Ni.textOffset,Ni.textBoxScale),ce&&li._rotate(Ce?p.transform.angle:-p.transform.angle)):yi=!1}ji.textBox&&Ee(a.textCollisionBox.collisionVertexArray,_r.text.placed,!yi||Xr,li.x,li.y),ji.verticalTextBox&&Ee(a.textCollisionBox.collisionVertexArray,_r.text.placed,!yi||dn,li.x,li.y)}var te=Boolean(!dn&&ji.verticalIconBox);ji.iconBox&&Ee(a.iconCollisionBox.collisionVertexArray,_r.icon.placed,te,Ie?li.x:0,Ie?li.y:0),ji.verticalIconBox&&Ee(a.iconCollisionBox.collisionVertexArray,_r.icon.placed,!te,Ie?li.x:0,Ie?li.y:0)}}},ft=0;ft<a.symbolInstances.length;ft++)$e(ft);if(a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){var Ye=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=Ye.invProjMatrix,a.placementViewportMatrix=Ye.viewportMatrix,a.collisionCircleArray=Ye.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}},Ba.prototype.symbolFadeChange=function(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ba.prototype.zoomAdjustment=function(a){return Math.max(0,(this.transform.zoom-a)/1.5)},Ba.prototype.hasTransitions=function(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration},Ba.prototype.stillRecent=function(a,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>a},Ba.prototype.setStale=function(){this.stale=!0};var je=Math.pow(2,25),bt=Math.pow(2,24),ar=Math.pow(2,17),Kr=Math.pow(2,16),$n=Math.pow(2,9),xi=Math.pow(2,8),lo=Math.pow(2,1);function ro(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var s=a.placed?1:0,o=Math.floor(127*a.opacity);return o*je+s*bt+o*ar+s*Kr+o*$n+s*xi+o*lo+s}var co=0,ps=function(a){this._sortAcrossTiles="viewport-y"!==a.layout.get("symbol-z-order")&&void 0!==a.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ps.prototype.continuePlacement=function(a,s,o,p,b){for(var E=this._bucketParts;this._currentTileIndex<a.length;)if(s.getBucketParts(E,p,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort(function(A,F){return A.sortKey-F.sortKey}));this._currentPartIndex<E.length;)if(s.placeLayerBucketPart(E[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,b())return!0;return!1};var du=function(a,s,o,p,b,E,A){this.placement=new Ba(a,b,E,A),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=p,this._done=!1};du.prototype.isDone=function(){return this._done},du.prototype.continuePlacement=function(a,s,o){for(var p=this,b=c.browser.now(),E=function(){var $=c.browser.now()-b;return!p._forceFullPlacement&&$>2};this._currentPlacementIndex>=0;){var A=s[a[this._currentPlacementIndex]],F=this.placement.collisionIndex.transform.zoom;if("symbol"===A.type&&(!A.minzoom||A.minzoom<=F)&&(!A.maxzoom||A.maxzoom>F)){if(this._inProgressLayer||(this._inProgressLayer=new ps(A)),this._inProgressLayer.continuePlacement(o[A.source],this.placement,this._showCollisionBoxes,A,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},du.prototype.commit=function(a){return this.placement.commit(a),this.placement};var Eu=512/c.EXTENT/2,fl=function(a,s,o){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var p=0;p<s.length;p++){var b=s.get(p),E=b.key;this.indexedSymbolInstances[E]||(this.indexedSymbolInstances[E]=[]),this.indexedSymbolInstances[E].push({crossTileID:b.crossTileID,coord:this.getScaledCoordinates(b,a)})}};fl.prototype.getScaledCoordinates=function(a,s){var o=Eu/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*c.EXTENT+a.anchorX)*o),y:Math.floor((s.canonical.y*c.EXTENT+a.anchorY)*o)}},fl.prototype.findMatches=function(a,s,o){for(var p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),b=0;b<a.length;b++){var E=a.get(b);if(!E.crossTileID){var A=this.indexedSymbolInstances[E.key];if(A)for(var F=this.getScaledCoordinates(E,s),$=0,ce=A;$<ce.length;$+=1){var Ce=ce[$];if(Math.abs(Ce.coord.x-F.x)<=p&&Math.abs(Ce.coord.y-F.y)<=p&&!o[Ce.crossTileID]){o[Ce.crossTileID]=!0,E.crossTileID=Ce.crossTileID;break}}}}};var Wo=function(){this.maxCrossTileID=0};Wo.prototype.generate=function(){return++this.maxCrossTileID};var Qo=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Qo.prototype.handleWrapJump=function(a){var s=Math.round((a-this.lng)/360);if(0!==s)for(var o in this.indexes){var p=this.indexes[o],b={};for(var E in p){var A=p[E];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+s),b[A.tileID.key]=A}this.indexes[o]=b}this.lng=a},Qo.prototype.addBucket=function(a,s,o){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(var p=0;p<s.symbolInstances.length;p++)s.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});var b=this.usedCrossTileIDs[a.overscaledZ];for(var E in this.indexes){var A=this.indexes[E];if(Number(E)>a.overscaledZ)for(var F in A){var $=A[F];$.tileID.isChildOf(a)&&$.findMatches(s.symbolInstances,a,b)}else{var ce=A[a.scaledTo(Number(E)).key];ce&&ce.findMatches(s.symbolInstances,a,b)}}for(var Ce=0;Ce<s.symbolInstances.length;Ce++){var Ie=s.symbolInstances.get(Ce);Ie.crossTileID||(Ie.crossTileID=o.generate(),b[Ie.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new fl(a,s.symbolInstances,s.bucketInstanceId),!0},Qo.prototype.removeBucketCrossTileIDs=function(a,s){for(var o in s.indexedSymbolInstances)for(var p=0,b=s.indexedSymbolInstances[o];p<b.length;p+=1)delete this.usedCrossTileIDs[a][b[p].crossTileID]},Qo.prototype.removeStaleBuckets=function(a){var s=!1;for(var o in this.indexes){var p=this.indexes[o];for(var b in p)a[p[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,p[b]),delete p[b],s=!0)}return s};var Lo=function(){this.layerIndexes={},this.crossTileIDs=new Wo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Lo.prototype.addLayer=function(a,s,o){var p=this.layerIndexes[a.id];void 0===p&&(p=this.layerIndexes[a.id]=new Qo);var b=!1,E={};p.handleWrapJump(o);for(var A=0,F=s;A<F.length;A+=1){var $=F[A],ce=$.getBucket(a);ce&&a.id===ce.layerIds[0]&&(ce.bucketInstanceId||(ce.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket($.tileID,ce,this.crossTileIDs)&&(b=!0),E[ce.bucketInstanceId]=!0)}return p.removeStaleBuckets(E)&&(b=!0),b},Lo.prototype.pruneUnusedLayers=function(a){var s={};for(var o in a.forEach(function(p){s[p]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var es=function(a,s){return c.emitValidationErrors(a,s&&s.filter(function(o){return"source.canvas"!==o.identifier}))},ts=c.pick(fn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ks=c.pick(fn,["setCenter","setZoom","setBearing","setPitch"]),Qs=function(){var a={},s=c.styleSpec.$version;for(var o in c.styleSpec.$root){var p,b=c.styleSpec.$root[o];b.required&&null!=(p="version"===o?s:"array"===b.type?[]:{})&&(a[o]=p)}return a}(),gs=function(a){function s(o,p){var b=this;void 0===p&&(p={}),a.call(this),this.map=o,this.dispatcher=new At(rr(),this),this.imageManager=new xt,this.imageManager.setEventedParent(this),this.glyphManager=new Vt(o._requestManager,p.localIdeographFontFamily),this.lineAtlas=new Xe(256,512),this.crossTileSymbolIndex=new Lo,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",c.getReferrer());var E=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(A){E.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:A.pluginStatus,pluginURL:A.pluginURL},function(F,$){if(c.triggerPluginCompletionEvent(F),$&&$.every(function(Ce){return Ce}))for(var ce in E.sourceCaches)E.sourceCaches[ce].reload()})}),this.on("data",function(A){if("source"===A.dataType&&"metadata"===A.sourceDataType){var F=b.sourceCaches[A.sourceId];if(F){var $=F.getSource();if($&&$.vectorLayerIds)for(var ce in b._layers){var Ce=b._layers[ce];Ce.source===$.id&&b._validateLayer(Ce)}}}})}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.loadURL=function(o,p){var b=this;void 0===p&&(p={}),this.fire(new c.Event("dataloading",{dataType:"style"}));var E="boolean"==typeof p.validate?p.validate:!c.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,p.accessToken);var A=this.map._requestManager.transformRequest(o,c.ResourceType.Style);this._request=c.getJSON(A,function(F,$){b._request=null,F?b.fire(new c.ErrorEvent(F)):$&&b._load($,E)})},s.prototype.loadJSON=function(o,p){var b=this;void 0===p&&(p={}),this.fire(new c.Event("dataloading",{dataType:"style"})),this._request=c.browser.frame(function(){b._request=null,b._load(o,!1!==p.validate)})},s.prototype.loadEmpty=function(){this.fire(new c.Event("dataloading",{dataType:"style"})),this._load(Qs,!1)},s.prototype._load=function(o,p){if(!p||!es(this,c.validateStyle(o))){for(var b in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(b,o.sources[b],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var E=an(this.stylesheet.layers);this._order=E.map(function(ce){return ce.id}),this._layers={},this._serializedLayers={};for(var A=0,F=E;A<F.length;A+=1){var $=F[A];($=c.createStyleLayer($)).setEventedParent(this,{layer:{id:$.id}}),this._layers[$.id]=$,this._serializedLayers[$.id]=$.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new pt(this.stylesheet.light),this.fire(new c.Event("data",{dataType:"style"})),this.fire(new c.Event("style.load"))}},s.prototype._loadSprite=function(o){var p=this;this._spriteRequest=function(b,E,A){var F,$,ce,Ce=c.browser.devicePixelRatio>1?"@2x":"",Ie=c.getJSON(E.transformRequest(E.normalizeSpriteURL(b,Ce,".json"),c.ResourceType.SpriteJSON),function($e,ft){Ie=null,ce||(ce=$e,F=ft,et())}),ke=c.getImage(E.transformRequest(E.normalizeSpriteURL(b,Ce,".png"),c.ResourceType.SpriteImage),function($e,ft){ke=null,ce||(ce=$e,$=ft,et())});function et(){if(ce)A(ce);else if(F&&$){var $e=c.browser.getImageData($),ft={};for(var Ye in F){var lt=F[Ye],Pt=lt.width,Ht=lt.height,hr=lt.x,nr=lt.y,_r=lt.sdf,Dr=lt.pixelRatio,Qr=lt.stretchX,Xr=lt.stretchY,dn=lt.content,qn=new c.RGBAImage({width:Pt,height:Ht});c.RGBAImage.copy($e,qn,{x:hr,y:nr},{x:0,y:0},{width:Pt,height:Ht}),ft[Ye]={data:qn,pixelRatio:Dr,sdf:_r,stretchX:Qr,stretchY:Xr,content:dn}}A(null,ft)}}return{cancel:function(){Ie&&(Ie.cancel(),Ie=null),ke&&(ke.cancel(),ke=null)}}}(o,this.map._requestManager,function(b,E){if(p._spriteRequest=null,b)p.fire(new c.ErrorEvent(b));else if(E)for(var A in E)p.imageManager.addImage(A,E[A]);p.imageManager.setLoaded(!0),p._availableImages=p.imageManager.listImages(),p.dispatcher.broadcast("setImages",p._availableImages),p.fire(new c.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var p=this.sourceCaches[o.source];if(p){var b=o.sourceLayer;if(b){var E=p.getSource();("geojson"===E.type||E.vectorLayerIds&&-1===E.vectorLayerIds.indexOf(b))&&this.fire(new c.ErrorEvent(new Error('Source layer "'+b+'" does not exist on source "'+E.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var p=[],b=0,E=o;b<E.length;b+=1){var A=this._layers[E[b]];"custom"!==A.type&&p.push(A.serialize())}return p},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var p in this._layers)if(this._layers[p].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var p=this._changed;if(this._changed){var b=Object.keys(this._updatedLayers),E=Object.keys(this._removedLayers);for(var A in(b.length||E.length)&&this._updateWorkerLayers(b,E),this._updatedSources){var F=this._updatedSources[A];"reload"===F?this._reloadSource(A):"clear"===F&&this._clearSource(A)}for(var $ in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[$].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var ce={};for(var Ce in this.sourceCaches){var Ie=this.sourceCaches[Ce];ce[Ce]=Ie.used,Ie.used=!1}for(var ke=0,et=this._order;ke<et.length;ke+=1){var $e=this._layers[et[ke]];$e.recalculate(o,this._availableImages),!$e.isHidden(o.zoom)&&$e.source&&(this.sourceCaches[$e.source].used=!0)}for(var ft in ce){var Ye=this.sourceCaches[ft];ce[ft]!==Ye.used&&Ye.fire(new c.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:ft}))}this.light.recalculate(o),this.z=o.zoom,p&&this.fire(new c.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:p})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var p=this;if(this._checkLoaded(),es(this,c.validateStyle(o)))return!1;(o=c.clone$1(o)).layers=an(o.layers);var b=function(A,F){if(!A)return[{command:fn.setStyle,args:[F]}];var $=[];try{if(!c.deepEqual(A.version,F.version))return[{command:fn.setStyle,args:[F]}];c.deepEqual(A.center,F.center)||$.push({command:fn.setCenter,args:[F.center]}),c.deepEqual(A.zoom,F.zoom)||$.push({command:fn.setZoom,args:[F.zoom]}),c.deepEqual(A.bearing,F.bearing)||$.push({command:fn.setBearing,args:[F.bearing]}),c.deepEqual(A.pitch,F.pitch)||$.push({command:fn.setPitch,args:[F.pitch]}),c.deepEqual(A.sprite,F.sprite)||$.push({command:fn.setSprite,args:[F.sprite]}),c.deepEqual(A.glyphs,F.glyphs)||$.push({command:fn.setGlyphs,args:[F.glyphs]}),c.deepEqual(A.transition,F.transition)||$.push({command:fn.setTransition,args:[F.transition]}),c.deepEqual(A.light,F.light)||$.push({command:fn.setLight,args:[F.light]});var ce={},Ce=[];!function(ke,et,$e,ft){var Ye;for(Ye in et=et||{},ke=ke||{})ke.hasOwnProperty(Ye)&&(et.hasOwnProperty(Ye)||_n(Ye,$e,ft));for(Ye in et)et.hasOwnProperty(Ye)&&(ke.hasOwnProperty(Ye)?c.deepEqual(ke[Ye],et[Ye])||("geojson"===ke[Ye].type&&"geojson"===et[Ye].type&&ta(ke,et,Ye)?$e.push({command:fn.setGeoJSONSourceData,args:[Ye,et[Ye].data]}):Oi(Ye,et,$e,ft)):Di(Ye,et,$e))}(A.sources,F.sources,Ce,ce);var Ie=[];A.layers&&A.layers.forEach(function(ke){ce[ke.source]?$.push({command:fn.removeLayer,args:[ke.id]}):Ie.push(ke)}),$=$.concat(Ce),function(ke,et,$e){et=et||[];var ft,Ye,lt,Pt,Ht,hr,nr,_r=(ke=ke||[]).map(Ji),Dr=et.map(Ji),Qr=ke.reduce(Vi,{}),Xr=et.reduce(Vi,{}),dn=_r.slice(),qn=Object.create(null);for(ft=0,Ye=0;ft<_r.length;ft++)Xr.hasOwnProperty(lt=_r[ft])?Ye++:($e.push({command:fn.removeLayer,args:[lt]}),dn.splice(dn.indexOf(lt,Ye),1));for(ft=0,Ye=0;ft<Dr.length;ft++)dn[dn.length-1-ft]!==(lt=Dr[Dr.length-1-ft])&&(Qr.hasOwnProperty(lt)?($e.push({command:fn.removeLayer,args:[lt]}),dn.splice(dn.lastIndexOf(lt,dn.length-Ye),1)):Ye++,$e.push({command:fn.addLayer,args:[Xr[lt],hr=dn[dn.length-ft]]}),dn.splice(dn.length-ft,0,lt),qn[lt]=!0);for(ft=0;ft<Dr.length;ft++)if(Pt=Qr[lt=Dr[ft]],Ht=Xr[lt],!qn[lt]&&!c.deepEqual(Pt,Ht))if(c.deepEqual(Pt.source,Ht.source)&&c.deepEqual(Pt["source-layer"],Ht["source-layer"])&&c.deepEqual(Pt.type,Ht.type)){for(nr in oi(Pt.layout,Ht.layout,$e,lt,null,fn.setLayoutProperty),oi(Pt.paint,Ht.paint,$e,lt,null,fn.setPaintProperty),c.deepEqual(Pt.filter,Ht.filter)||$e.push({command:fn.setFilter,args:[lt,Ht.filter]}),c.deepEqual(Pt.minzoom,Ht.minzoom)&&c.deepEqual(Pt.maxzoom,Ht.maxzoom)||$e.push({command:fn.setLayerZoomRange,args:[lt,Ht.minzoom,Ht.maxzoom]}),Pt)Pt.hasOwnProperty(nr)&&"layout"!==nr&&"paint"!==nr&&"filter"!==nr&&"metadata"!==nr&&"minzoom"!==nr&&"maxzoom"!==nr&&(0===nr.indexOf("paint.")?oi(Pt[nr],Ht[nr],$e,lt,nr.slice(6),fn.setPaintProperty):c.deepEqual(Pt[nr],Ht[nr])||$e.push({command:fn.setLayerProperty,args:[lt,nr,Ht[nr]]}));for(nr in Ht)Ht.hasOwnProperty(nr)&&!Pt.hasOwnProperty(nr)&&"layout"!==nr&&"paint"!==nr&&"filter"!==nr&&"metadata"!==nr&&"minzoom"!==nr&&"maxzoom"!==nr&&(0===nr.indexOf("paint.")?oi(Pt[nr],Ht[nr],$e,lt,nr.slice(6),fn.setPaintProperty):c.deepEqual(Pt[nr],Ht[nr])||$e.push({command:fn.setLayerProperty,args:[lt,nr,Ht[nr]]}))}else $e.push({command:fn.removeLayer,args:[lt]}),hr=dn[dn.lastIndexOf(lt)+1],$e.push({command:fn.addLayer,args:[Ht,hr]})}(Ie,F.layers,$)}catch(ke){console.warn("Unable to compute style diff:",ke),$=[{command:fn.setStyle,args:[F]}]}return $}(this.serialize(),o).filter(function(A){return!(A.command in ks)});if(0===b.length)return!1;var E=b.filter(function(A){return!(A.command in ts)});if(E.length>0)throw new Error("Unimplemented: "+E.map(function(A){return A.command}).join(", ")+".");return b.forEach(function(A){"setTransition"!==A.command&&p[A.command].apply(p,A.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,p){if(this.getImage(o))return this.fire(new c.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,p),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,p){this.imageManager.updateImage(o,p)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new c.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new c.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,p,b){var E=this;if(void 0===b&&(b={}),this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error("There is already a source with this ID");if(!p.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(p).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(c.validateStyle.source,"sources."+o,p,null,b))){this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);var A=this.sourceCaches[o]=new Ae(o,p,this.dispatcher);A.style=this,A.setEventedParent(this,function(){return{isSourceLoaded:E.loaded(),source:A.serialize(),sourceId:o}}),A.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(var p in this._layers)if(this._layers[p].source===o)return this.fire(new c.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+p+'" is using it.')));var b=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],b.fire(new c.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),b.setEventedParent(null),b.clearTiles(),b.onRemove&&b.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,p){this._checkLoaded(),this.sourceCaches[o].getSource().setData(p),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,p,b){void 0===b&&(b={}),this._checkLoaded();var E=o.id;if(this.getLayer(E))this.fire(new c.ErrorEvent(new Error('Layer with id "'+E+'" already exists on this map')));else{var A;if("custom"===o.type){if(es(this,c.validateCustomStyleLayer(o)))return;A=c.createStyleLayer(o)}else{if("object"==typeof o.source&&(this.addSource(E,o.source),o=c.clone$1(o),o=c.extend(o,{source:E})),this._validate(c.validateStyle.layer,"layers."+E,o,{arrayIndex:-1},b))return;A=c.createStyleLayer(o),this._validateLayer(A),A.setEventedParent(this,{layer:{id:E}}),this._serializedLayers[A.id]=A.serialize()}var F=p?this._order.indexOf(p):this._order.length;if(p&&-1===F)this.fire(new c.ErrorEvent(new Error('Layer with id "'+p+'" does not exist on this map.')));else{if(this._order.splice(F,0,E),this._layerOrderChanged=!0,this._layers[E]=A,this._removedLayers[E]&&A.source&&"custom"!==A.type){var $=this._removedLayers[E];delete this._removedLayers[E],$.type!==A.type?this._updatedSources[A.source]="clear":(this._updatedSources[A.source]="reload",this.sourceCaches[A.source].pause())}this._updateLayer(A),A.onAdd&&A.onAdd(this.map)}}},s.prototype.moveLayer=function(o,p){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==p){var b=this._order.indexOf(o);this._order.splice(b,1);var E=p?this._order.indexOf(p):this._order.length;p&&-1===E?this.fire(new c.ErrorEvent(new Error('Layer with id "'+p+'" does not exist on this map.'))):(this._order.splice(E,0,o),this._layerOrderChanged=!0)}}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var p=this._layers[o];if(p){p.setEventedParent(null);var b=this._order.indexOf(o);this._order.splice(b,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=p,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],p.onRemove&&p.onRemove(this.map)}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,p,b){this._checkLoaded();var E=this.getLayer(o);E?E.minzoom===p&&E.maxzoom===b||(null!=p&&(E.minzoom=p),null!=b&&(E.maxzoom=b),this._updateLayer(E)):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,p,b){void 0===b&&(b={}),this._checkLoaded();var E=this.getLayer(o);if(E){if(!c.deepEqual(E.filter,p))return null==p?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(c.validateStyle.filter,"layers."+E.id+".filter",p,null,b)||(E.filter=c.clone$1(p),this._updateLayer(E)))}else this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return c.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,p,b,E){void 0===E&&(E={}),this._checkLoaded();var A=this.getLayer(o);A?c.deepEqual(A.getLayoutProperty(p),b)||(A.setLayoutProperty(p,b,E),this._updateLayer(A)):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,p){var b=this.getLayer(o);if(b)return b.getLayoutProperty(p);this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,p,b,E){void 0===E&&(E={}),this._checkLoaded();var A=this.getLayer(o);A?c.deepEqual(A.getPaintProperty(p),b)||(A.setPaintProperty(p,b,E)&&this._updateLayer(A),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new c.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,p){return this.getLayer(o).getPaintProperty(p)},s.prototype.setFeatureState=function(o,p){this._checkLoaded();var b=o.source,E=o.sourceLayer,A=this.sourceCaches[b];if(void 0!==A){var F=A.getSource().type;"geojson"===F&&E?this.fire(new c.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==F||E?(void 0===o.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),A.setFeatureState(E,o.id,p)):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,p){this._checkLoaded();var b=o.source,E=this.sourceCaches[b];if(void 0!==E){var A=E.getSource().type,F="vector"===A?o.sourceLayer:void 0;"vector"!==A||F?p&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new c.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):E.removeFeatureState(F,o.id,p):this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+b+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var p=o.source,b=o.sourceLayer,E=this.sourceCaches[p];if(void 0!==E){if("vector"!==E.getSource().type||b)return void 0===o.id&&this.fire(new c.ErrorEvent(new Error("The feature id parameter must be provided."))),E.getFeatureState(b,o.id);this.fire(new c.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new c.ErrorEvent(new Error("The source '"+p+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return c.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return c.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:c.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return void 0!==o})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var p=this,b=function(Qr){return"fill-extrusion"===p._layers[Qr].type},E={},A=[],F=this._order.length-1;F>=0;F--){var $=this._order[F];if(b($)){E[$]=F;for(var ce=0,Ce=o;ce<Ce.length;ce+=1){var Ie=Ce[ce][$];if(Ie)for(var ke=0,et=Ie;ke<et.length;ke+=1)A.push(et[ke])}}}A.sort(function(Qr,Xr){return Xr.intersectionZ-Qr.intersectionZ});for(var $e=[],ft=this._order.length-1;ft>=0;ft--){var Ye=this._order[ft];if(b(Ye))for(var lt=A.length-1;lt>=0;lt--){var Pt=A[lt].feature;if(E[Pt.layer.id]<ft)break;$e.push(Pt),A.pop()}else for(var Ht=0,hr=o;Ht<hr.length;Ht+=1){var nr=hr[Ht][Ye];if(nr)for(var _r=0,Dr=nr;_r<Dr.length;_r+=1)$e.push(Dr[_r].feature)}}return $e},s.prototype.queryRenderedFeatures=function(o,p,b){p&&p.filter&&this._validate(c.validateStyle.filter,"queryRenderedFeatures.filter",p.filter,null,p);var E={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new c.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var A=0,F=p.layers;A<F.length;A+=1){var $=F[A],ce=this._layers[$];if(!ce)return this.fire(new c.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot be queried for features."))),[];E[ce.source]=!0}}var Ce=[];for(var Ie in p.availableImages=this._availableImages,this.sourceCaches)p.layers&&!E[Ie]||Ce.push(cn(this.sourceCaches[Ie],this._layers,this._serializedLayers,o,p,b));return this.placement&&Ce.push(function(ke,et,$e,ft,Ye,lt,Pt){for(var Ht={},hr=lt.queryRenderedSymbols(ft),nr=[],_r=0,Dr=Object.keys(hr).map(Number);_r<Dr.length;_r+=1)nr.push(Pt[Dr[_r]]);nr.sort(Ir);for(var Qr=function(){var Bn=dn[Xr],Li=Bn.featureIndex.lookupSymbolFeatures(hr[Bn.bucketInstanceId],et,Bn.bucketIndex,Bn.sourceLayerIndex,Ye.filter,Ye.layers,Ye.availableImages,ke);for(var Dn in Li){var gi=Ht[Dn]=Ht[Dn]||[],ji=Li[Dn];ji.sort(function(Ni,te){var ne=Bn.featureSortOrder;if(ne){var N=ne.indexOf(Ni.featureIndex);return ne.indexOf(te.featureIndex)-N}return te.featureIndex-Ni.featureIndex});for(var li=0,yi=ji;li<yi.length;li+=1)gi.push(yi[li])}},Xr=0,dn=nr;Xr<dn.length;Xr+=1)Qr();var qn=function(Bn){Ht[Bn].forEach(function(Li){var Dn=Li.feature,gi=$e[ke[Bn].source].getFeatureState(Dn.layer["source-layer"],Dn.id);Dn.source=Dn.layer.source,Dn.layer["source-layer"]&&(Dn.sourceLayer=Dn.layer["source-layer"]),Dn.state=gi})};for(var jn in Ht)qn(jn);return Ht}(this._layers,this._serializedLayers,this.sourceCaches,o,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ce)},s.prototype.querySourceFeatures=function(o,p){p&&p.filter&&this._validate(c.validateStyle.filter,"querySourceFeatures.filter",p.filter,null,p);var b=this.sourceCaches[o];return b?function(E,A){for(var F=E.getRenderableIds().map(function(et){return E.getTileByID(et)}),$=[],ce={},Ce=0;Ce<F.length;Ce++){var Ie=F[Ce],ke=Ie.tileID.canonical.key;ce[ke]||(ce[ke]=!0,Ie.querySourceFeatures($,A))}return $}(b,p):[]},s.prototype.addSourceType=function(o,p,b){return s.getSourceType(o)?b(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:p.workerSourceURL},b):b(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,p){void 0===p&&(p={}),this._checkLoaded();var b=this.light.getLight(),E=!1;for(var A in o)if(!c.deepEqual(o[A],b[A])){E=!0;break}if(E){var F={now:c.browser.now(),transition:c.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,p),this.light.updateTransitions(F)}},s.prototype._validate=function(o,p,b,E,A){return void 0===A&&(A={}),(!A||!1!==A.validate)&&es(this,o.call(c.validateStyle,c.extend({key:p,style:this.serialize(),value:b,styleSpec:c.styleSpec},E)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),c.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var p in this.sourceCaches)this.sourceCaches[p].clearTiles(),this.sourceCaches[p].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var p in this.sourceCaches)this.sourceCaches[p].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,p,b,E,A){void 0===A&&(A=!1);for(var F=!1,$=!1,ce={},Ce=0,Ie=this._order;Ce<Ie.length;Ce+=1){var ke=this._layers[Ie[Ce]];if("symbol"===ke.type){if(!ce[ke.source]){var et=this.sourceCaches[ke.source];ce[ke.source]=et.getRenderableIds(!0).map(function(Pt){return et.getTileByID(Pt)}).sort(function(Pt,Ht){return Ht.tileID.overscaledZ-Pt.tileID.overscaledZ||(Pt.tileID.isLessThan(Ht.tileID)?-1:1)})}var $e=this.crossTileSymbolIndex.addLayer(ke,ce[ke.source],o.center.lng);F=F||$e}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((A=A||this._layerOrderChanged||0===b)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(c.browser.now(),o.zoom))&&(this.pauseablePlacement=new du(o,this._order,A,p,b,E,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ce),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(c.browser.now()),$=!0),F&&this.pauseablePlacement.placement.setStale()),$||F)for(var ft=0,Ye=this._order;ft<Ye.length;ft+=1){var lt=this._layers[Ye[ft]];"symbol"===lt.type&&this.placement.updateLayerOpacities(lt,ce[lt.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(c.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,p,b){this.imageManager.getImages(p.icons,b),this._updateTilesForChangedImages();var E=this.sourceCaches[p.source];E&&E.setDependencies(p.tileID.key,p.type,p.icons)},s.prototype.getGlyphs=function(o,p,b){this.glyphManager.getGlyphs(p.stacks,b)},s.prototype.getResource=function(o,p,b){return c.makeRequest(p,b)},s}(c.Evented);gs.getSourceType=function(a){return br[a]},gs.setSourceType=function(a,s){br[a]=s},gs.registerForPluginStateChange=c.registerForPluginStateChange;var Oa=c.createLayout([{name:"a_pos",type:"Int16",components:2}]),ko=vi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Ol=vi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ll=vi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),kl=vi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),wc=vi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Rl=vi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),hl=vi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),eu=vi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Dl=vi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),m=vi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),T=vi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),Y=vi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),D=vi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),ve=vi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Ne=vi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),mt=vi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),zt=vi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Ft=vi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Or=vi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),zr=vi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Jn=vi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),bi=vi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),pi=vi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),oa=vi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Ea=vi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Na=vi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function vi(a,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=s.match(/attribute ([\w]+) ([\w]+)/g),b=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),E=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),A=E?E.concat(b):b,F={};return{fragmentSource:a=a.replace(o,function($,ce,Ce,Ie,ke){return F[ke]=!0,"define"===ce?"\n#ifndef HAS_UNIFORM_u_"+ke+"\nvarying "+Ce+" "+Ie+" "+ke+";\n#else\nuniform "+Ce+" "+Ie+" u_"+ke+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+ke+"\n    "+Ce+" "+Ie+" "+ke+" = u_"+ke+";\n#endif\n"}),vertexSource:s=s.replace(o,function($,ce,Ce,Ie,ke){var et="float"===Ie?"vec2":"vec4",$e=ke.match(/color/)?"color":et;return F[ke]?"define"===ce?"\n#ifndef HAS_UNIFORM_u_"+ke+"\nuniform lowp float u_"+ke+"_t;\nattribute "+Ce+" "+et+" a_"+ke+";\nvarying "+Ce+" "+Ie+" "+ke+";\n#else\nuniform "+Ce+" "+Ie+" u_"+ke+";\n#endif\n":"vec4"===$e?"\n#ifndef HAS_UNIFORM_u_"+ke+"\n    "+ke+" = a_"+ke+";\n#else\n    "+Ce+" "+Ie+" "+ke+" = u_"+ke+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+ke+"\n    "+ke+" = unpack_mix_"+$e+"(a_"+ke+", u_"+ke+"_t);\n#else\n    "+Ce+" "+Ie+" "+ke+" = u_"+ke+";\n#endif\n":"define"===ce?"\n#ifndef HAS_UNIFORM_u_"+ke+"\nuniform lowp float u_"+ke+"_t;\nattribute "+Ce+" "+et+" a_"+ke+";\n#else\nuniform "+Ce+" "+Ie+" u_"+ke+";\n#endif\n":"vec4"===$e?"\n#ifndef HAS_UNIFORM_u_"+ke+"\n    "+Ce+" "+Ie+" "+ke+" = a_"+ke+";\n#else\n    "+Ce+" "+Ie+" "+ke+" = u_"+ke+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+ke+"\n    "+Ce+" "+Ie+" "+ke+" = unpack_mix_"+$e+"(a_"+ke+", u_"+ke+"_t);\n#else\n    "+Ce+" "+Ie+" "+ke+" = u_"+ke+";\n#endif\n"}),staticAttributes:p,staticUniforms:A}}var Xo=Object.freeze({__proto__:null,prelude:ko,background:Ol,backgroundPattern:Ll,circle:kl,clippingMask:wc,heatmap:Rl,heatmapTexture:hl,collisionBox:eu,collisionCircle:Dl,debug:m,fill:T,fillOutline:Y,fillOutlinePattern:D,fillPattern:ve,fillExtrusion:Ne,fillExtrusionPattern:mt,hillshadePrepare:zt,hillshade:Ft,line:Or,lineGradient:zr,linePattern:Jn,lineSDF:bi,raster:pi,symbolIcon:oa,symbolSDF:Ea,symbolTextAndIcon:Na}),vu=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Tu(a){for(var s=[],o=0;o<a.length;o++)if(null!==a[o]){var p=a[o].split(" ");s.push(p.pop())}return s}vu.prototype.bind=function(a,s,o,p,b,E,A,F){this.context=a;for(var $=this.boundPaintVertexBuffers.length!==p.length,ce=0;!$&&ce<p.length;ce++)this.boundPaintVertexBuffers[ce]!==p[ce]&&($=!0);a.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!$&&this.boundIndexBuffer===b&&this.boundVertexOffset===E&&this.boundDynamicVertexBuffer===A&&this.boundDynamicVertexBuffer2===F?(a.bindVertexArrayOES.set(this.vao),A&&A.bind(),b&&b.dynamicDraw&&b.bind(),F&&F.bind()):this.freshBind(s,o,p,b,E,A,F)},vu.prototype.freshBind=function(a,s,o,p,b,E,A){var F,$=a.numAttributes,ce=this.context,Ce=ce.gl;if(ce.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ce.extVertexArrayObject.createVertexArrayOES(),ce.bindVertexArrayOES.set(this.vao),F=0,this.boundProgram=a,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=p,this.boundVertexOffset=b,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=A;else{F=ce.currentNumAttributes||0;for(var Ie=$;Ie<F;Ie++)Ce.disableVertexAttribArray(Ie)}s.enableAttributes(Ce,a);for(var ke=0,et=o;ke<et.length;ke+=1)et[ke].enableAttributes(Ce,a);E&&E.enableAttributes(Ce,a),A&&A.enableAttributes(Ce,a),s.bind(),s.setVertexAttribPointers(Ce,a,b);for(var $e=0,ft=o;$e<ft.length;$e+=1){var Ye=ft[$e];Ye.bind(),Ye.setVertexAttribPointers(Ce,a,b)}E&&(E.bind(),E.setVertexAttribPointers(Ce,a,b)),p&&p.bind(),A&&(A.bind(),A.setVertexAttribPointers(Ce,a,b)),ce.currentNumAttributes=$},vu.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ec=function(a,s,o,p,b,E){var A=a.gl;this.program=A.createProgram();for(var F=Tu(o.staticAttributes),$=p?p.getBinderAttributes():[],ce=F.concat($),Ce=o.staticUniforms?Tu(o.staticUniforms):[],Ie=p?p.getBinderUniforms():[],ke=[],et=0,$e=Ce.concat(Ie);et<$e.length;et+=1){var ft=$e[et];ke.indexOf(ft)<0&&ke.push(ft)}var Ye=p?p.defines():[];E&&Ye.push("#define OVERDRAW_INSPECTOR;");var lt=Ye.concat(ko.fragmentSource,o.fragmentSource).join("\n"),Pt=Ye.concat(ko.vertexSource,o.vertexSource).join("\n"),Ht=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())this.failedToCreate=!0;else{A.shaderSource(Ht,lt),A.compileShader(Ht),A.attachShader(this.program,Ht);var hr=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())this.failedToCreate=!0;else{A.shaderSource(hr,Pt),A.compileShader(hr),A.attachShader(this.program,hr),this.attributes={};var nr={};this.numAttributes=ce.length;for(var _r=0;_r<this.numAttributes;_r++)ce[_r]&&(A.bindAttribLocation(this.program,_r,ce[_r]),this.attributes[ce[_r]]=_r);A.linkProgram(this.program),A.deleteShader(hr),A.deleteShader(Ht);for(var Dr=0;Dr<ke.length;Dr++){var Qr=ke[Dr];if(Qr&&!nr[Qr]){var Xr=A.getUniformLocation(this.program,Qr);Xr&&(nr[Qr]=Xr)}}this.fixedUniforms=b(a,nr),this.binderUniforms=p?p.getUniforms(a,nr):[]}}};function Du(a,s,o){var p=1/ma(o,1,s.transform.tileZoom),b=Math.pow(2,o.tileID.overscaledZ),E=o.tileSize*Math.pow(2,s.transform.tileZoom)/b,A=E*(o.tileID.canonical.x+o.tileID.wrap*b),F=E*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[p,a.fromScale,a.toScale],u_fade:a.t,u_pixel_coord_upper:[A>>16,F>>16],u_pixel_coord_lower:[65535&A,65535&F]}}Ec.prototype.draw=function(a,s,o,p,b,E,A,F,$,ce,Ce,Ie,ke,et,$e,ft){var Ye,lt=a.gl;if(!this.failedToCreate){for(var Pt in a.program.set(this.program),a.setDepthMode(o),a.setStencilMode(p),a.setColorMode(b),a.setCullFace(E),this.fixedUniforms)this.fixedUniforms[Pt].set(A[Pt]);et&&et.setUniforms(a,this.binderUniforms,Ie,{zoom:ke});for(var Ht=(Ye={},Ye[lt.LINES]=2,Ye[lt.TRIANGLES]=3,Ye[lt.LINE_STRIP]=1,Ye)[s],hr=0,nr=Ce.get();hr<nr.length;hr+=1){var _r=nr[hr],Dr=_r.vaos||(_r.vaos={});(Dr[F]||(Dr[F]=new vu)).bind(a,this,$,et?et.getPaintVertexBuffers():[],ce,_r.vertexOffset,$e,ft),lt.drawElements(s,_r.primitiveLength*Ht,lt.UNSIGNED_SHORT,_r.primitiveOffset*Ht*2)}}};var Bl=function(a,s,o,p){var b=s.style.light,E=b.properties.get("position"),A=[E.x,E.y,E.z],F=c.create$1();"viewport"===b.properties.get("anchor")&&c.fromRotation(F,-s.transform.angle),c.transformMat3(A,A,F);var $=b.properties.get("color");return{u_matrix:a,u_lightpos:A,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_vertical_gradient:+o,u_opacity:p}},mu=function(a,s,o,p,b,E,A){return c.extend(Bl(a,s,o,p),Du(E,s,A),{u_height_factor:-Math.pow(2,b.overscaledZ)/A.tileSize/8})},gu=function(a){return{u_matrix:a}},tu=function(a,s,o,p){return c.extend(gu(a),Du(o,s,p))},oo=function(a,s){return{u_matrix:a,u_world:s}},Tc=function(a,s,o,p,b){return c.extend(tu(a,s,o,p),{u_world:b})},Cc=function(a,s,o,p){var b,E,A=a.transform;if("map"===p.paint.get("circle-pitch-alignment")){var F=ma(o,1,A.zoom);b=!0,E=[F,F]}else b=!1,E=A.pixelsToGLUnits;return{u_camera_to_center_distance:A.cameraToCenterDistance,u_scale_with_map:+("map"===p.paint.get("circle-pitch-scale")),u_matrix:a.translatePosMatrix(s.posMatrix,o,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+b,u_device_pixel_ratio:c.browser.devicePixelRatio,u_extrude_scale:E}},rs=function(a,s,o){var p=ma(o,1,s.zoom),b=Math.pow(2,s.zoom-o.tileID.overscaledZ),E=o.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[s.pixelsToGLUnits[0]/(p*b),s.pixelsToGLUnits[1]/(p*b)],u_overscale_factor:E}},tc=function(a,s,o){return{u_matrix:a,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},ru=function(a,s,o){return void 0===o&&(o=1),{u_matrix:a,u_color:s,u_overlay:0,u_overlay_scale:o}},Rs=function(a){return{u_matrix:a}},rc=function(a,s,o,p){return{u_matrix:a,u_extrude_scale:ma(s,1,o),u_intensity:p}},Bu=function(a,s,o){var p=a.transform;return{u_matrix:nc(a,s,o),u_ratio:1/ma(s,1,p.zoom),u_device_pixel_ratio:c.browser.devicePixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},La=function(a,s,o,p){return c.extend(Bu(a,s,o),{u_image:0,u_image_height:p})},Ju=function(a,s,o,p){var b=a.transform,E=Us(s,b);return{u_matrix:nc(a,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/ma(s,1,b.zoom),u_device_pixel_ratio:c.browser.devicePixelRatio,u_image:0,u_scale:[E,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]]}},Gc=function(a,s,o,p,b){var E=a.lineAtlas,A=Us(s,a.transform),F="round"===o.layout.get("line-cap"),$=E.getDash(p.from,F),ce=E.getDash(p.to,F),Ce=$.width*b.fromScale,Ie=ce.width*b.toScale;return c.extend(Bu(a,s,o),{u_patternscale_a:[A/Ce,-$.height/2],u_patternscale_b:[A/Ie,-ce.height/2],u_sdfgamma:E.width/(256*Math.min(Ce,Ie)*c.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:$.y,u_tex_y_b:ce.y,u_mix:b.t})};function Us(a,s){return 1/ma(a,1,s.tileZoom)}function nc(a,s,o){return a.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Hc=function(a,s,o,p,b){return{u_matrix:a,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(A=b.paint.get("raster-saturation"),A>0?1-1/(1.001-A):-A),u_contrast_factor:(E=b.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:Ac(b.paint.get("raster-hue-rotate"))};var E,A};function Ac(a){a*=Math.PI/180;var s=Math.sin(a),o=Math.cos(a);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var Fl,yu=function(a,s,o,p,b,E,A,F,$,ce){var Ce=b.transform;return{u_is_size_zoom_constant:+("constant"===a||"source"===a),u_is_size_feature_constant:+("constant"===a||"camera"===a),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Ce.cameraToCenterDistance,u_pitch:Ce.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Ce.width/Ce.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:A,u_coord_matrix:F,u_is_text:+$,u_pitch_with_map:+p,u_texsize:ce,u_texture:0}},$u=function(a,s,o,p,b,E,A,F,$,ce,Ce){var Ie=b.transform;return c.extend(yu(a,s,o,p,b,E,A,F,$,ce),{u_gamma_scale:p?Math.cos(Ie._pitch)*Ie.cameraToCenterDistance:1,u_device_pixel_ratio:c.browser.devicePixelRatio,u_is_halo:+Ce})},pl=function(a,s,o,p,b,E,A,F,$,ce){return c.extend($u(a,s,o,p,b,E,A,F,!0,$,!0),{u_texsize_icon:ce,u_texture_icon:1})},Qu=function(a,s,o){return{u_matrix:a,u_opacity:s,u_color:o}},el=function(a,s,o,p,b,E){return c.extend((F=E,ce=b,Ce=($=o).imageManager.getPattern((A=p).from.toString()),Ie=$.imageManager.getPattern(A.to.toString()),et=(ke=$.imageManager.getPixelSize()).width,$e=ke.height,ft=Math.pow(2,ce.tileID.overscaledZ),lt=(Ye=ce.tileSize*Math.pow(2,$.transform.tileZoom)/ft)*(ce.tileID.canonical.x+ce.tileID.wrap*ft),Pt=Ye*ce.tileID.canonical.y,{u_image:0,u_pattern_tl_a:Ce.tl,u_pattern_br_a:Ce.br,u_pattern_tl_b:Ie.tl,u_pattern_br_b:Ie.br,u_texsize:[et,$e],u_mix:F.t,u_pattern_size_a:Ce.displaySize,u_pattern_size_b:Ie.displaySize,u_scale_a:F.fromScale,u_scale_b:F.toScale,u_tile_units_to_pixels:1/ma(ce,1,$.transform.tileZoom),u_pixel_coord_upper:[lt>>16,Pt>>16],u_pixel_coord_lower:[65535&lt,65535&Pt]}),{u_matrix:a,u_opacity:s});var A,F,$,ce,Ce,Ie,ke,et,$e,ft,Ye,lt,Pt},dl={fillExtrusion:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_lightpos:new c.Uniform3f(a,s.u_lightpos),u_lightintensity:new c.Uniform1f(a,s.u_lightintensity),u_lightcolor:new c.Uniform3f(a,s.u_lightcolor),u_vertical_gradient:new c.Uniform1f(a,s.u_vertical_gradient),u_opacity:new c.Uniform1f(a,s.u_opacity)}},fillExtrusionPattern:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_lightpos:new c.Uniform3f(a,s.u_lightpos),u_lightintensity:new c.Uniform1f(a,s.u_lightintensity),u_lightcolor:new c.Uniform3f(a,s.u_lightcolor),u_vertical_gradient:new c.Uniform1f(a,s.u_vertical_gradient),u_height_factor:new c.Uniform1f(a,s.u_height_factor),u_image:new c.Uniform1i(a,s.u_image),u_texsize:new c.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new c.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new c.Uniform3f(a,s.u_scale),u_fade:new c.Uniform1f(a,s.u_fade),u_opacity:new c.Uniform1f(a,s.u_opacity)}},fill:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix)}},fillPattern:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_image:new c.Uniform1i(a,s.u_image),u_texsize:new c.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new c.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new c.Uniform3f(a,s.u_scale),u_fade:new c.Uniform1f(a,s.u_fade)}},fillOutline:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_world:new c.Uniform2f(a,s.u_world)}},fillOutlinePattern:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_world:new c.Uniform2f(a,s.u_world),u_image:new c.Uniform1i(a,s.u_image),u_texsize:new c.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new c.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new c.Uniform3f(a,s.u_scale),u_fade:new c.Uniform1f(a,s.u_fade)}},circle:function(a,s){return{u_camera_to_center_distance:new c.Uniform1f(a,s.u_camera_to_center_distance),u_scale_with_map:new c.Uniform1i(a,s.u_scale_with_map),u_pitch_with_map:new c.Uniform1i(a,s.u_pitch_with_map),u_extrude_scale:new c.Uniform2f(a,s.u_extrude_scale),u_device_pixel_ratio:new c.Uniform1f(a,s.u_device_pixel_ratio),u_matrix:new c.UniformMatrix4f(a,s.u_matrix)}},collisionBox:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_camera_to_center_distance:new c.Uniform1f(a,s.u_camera_to_center_distance),u_pixels_to_tile_units:new c.Uniform1f(a,s.u_pixels_to_tile_units),u_extrude_scale:new c.Uniform2f(a,s.u_extrude_scale),u_overscale_factor:new c.Uniform1f(a,s.u_overscale_factor)}},collisionCircle:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_inv_matrix:new c.UniformMatrix4f(a,s.u_inv_matrix),u_camera_to_center_distance:new c.Uniform1f(a,s.u_camera_to_center_distance),u_viewport_size:new c.Uniform2f(a,s.u_viewport_size)}},debug:function(a,s){return{u_color:new c.UniformColor(a,s.u_color),u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_overlay:new c.Uniform1i(a,s.u_overlay),u_overlay_scale:new c.Uniform1f(a,s.u_overlay_scale)}},clippingMask:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix)}},heatmap:function(a,s){return{u_extrude_scale:new c.Uniform1f(a,s.u_extrude_scale),u_intensity:new c.Uniform1f(a,s.u_intensity),u_matrix:new c.UniformMatrix4f(a,s.u_matrix)}},heatmapTexture:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_world:new c.Uniform2f(a,s.u_world),u_image:new c.Uniform1i(a,s.u_image),u_color_ramp:new c.Uniform1i(a,s.u_color_ramp),u_opacity:new c.Uniform1f(a,s.u_opacity)}},hillshade:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_image:new c.Uniform1i(a,s.u_image),u_latrange:new c.Uniform2f(a,s.u_latrange),u_light:new c.Uniform2f(a,s.u_light),u_shadow:new c.UniformColor(a,s.u_shadow),u_highlight:new c.UniformColor(a,s.u_highlight),u_accent:new c.UniformColor(a,s.u_accent)}},hillshadePrepare:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_image:new c.Uniform1i(a,s.u_image),u_dimension:new c.Uniform2f(a,s.u_dimension),u_zoom:new c.Uniform1f(a,s.u_zoom),u_unpack:new c.Uniform4f(a,s.u_unpack)}},line:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_ratio:new c.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new c.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(a,s.u_units_to_pixels)}},lineGradient:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_ratio:new c.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new c.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(a,s.u_units_to_pixels),u_image:new c.Uniform1i(a,s.u_image),u_image_height:new c.Uniform1f(a,s.u_image_height)}},linePattern:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_texsize:new c.Uniform2f(a,s.u_texsize),u_ratio:new c.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new c.Uniform1f(a,s.u_device_pixel_ratio),u_image:new c.Uniform1i(a,s.u_image),u_units_to_pixels:new c.Uniform2f(a,s.u_units_to_pixels),u_scale:new c.Uniform3f(a,s.u_scale),u_fade:new c.Uniform1f(a,s.u_fade)}},lineSDF:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_ratio:new c.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new c.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new c.Uniform2f(a,s.u_units_to_pixels),u_patternscale_a:new c.Uniform2f(a,s.u_patternscale_a),u_patternscale_b:new c.Uniform2f(a,s.u_patternscale_b),u_sdfgamma:new c.Uniform1f(a,s.u_sdfgamma),u_image:new c.Uniform1i(a,s.u_image),u_tex_y_a:new c.Uniform1f(a,s.u_tex_y_a),u_tex_y_b:new c.Uniform1f(a,s.u_tex_y_b),u_mix:new c.Uniform1f(a,s.u_mix)}},raster:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_tl_parent:new c.Uniform2f(a,s.u_tl_parent),u_scale_parent:new c.Uniform1f(a,s.u_scale_parent),u_buffer_scale:new c.Uniform1f(a,s.u_buffer_scale),u_fade_t:new c.Uniform1f(a,s.u_fade_t),u_opacity:new c.Uniform1f(a,s.u_opacity),u_image0:new c.Uniform1i(a,s.u_image0),u_image1:new c.Uniform1i(a,s.u_image1),u_brightness_low:new c.Uniform1f(a,s.u_brightness_low),u_brightness_high:new c.Uniform1f(a,s.u_brightness_high),u_saturation_factor:new c.Uniform1f(a,s.u_saturation_factor),u_contrast_factor:new c.Uniform1f(a,s.u_contrast_factor),u_spin_weights:new c.Uniform3f(a,s.u_spin_weights)}},symbolIcon:function(a,s){return{u_is_size_zoom_constant:new c.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new c.Uniform1f(a,s.u_size_t),u_size:new c.Uniform1f(a,s.u_size),u_camera_to_center_distance:new c.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new c.Uniform1f(a,s.u_pitch),u_rotate_symbol:new c.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new c.Uniform1f(a,s.u_fade_change),u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new c.Uniform1i(a,s.u_is_text),u_pitch_with_map:new c.Uniform1i(a,s.u_pitch_with_map),u_texsize:new c.Uniform2f(a,s.u_texsize),u_texture:new c.Uniform1i(a,s.u_texture)}},symbolSDF:function(a,s){return{u_is_size_zoom_constant:new c.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new c.Uniform1f(a,s.u_size_t),u_size:new c.Uniform1f(a,s.u_size),u_camera_to_center_distance:new c.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new c.Uniform1f(a,s.u_pitch),u_rotate_symbol:new c.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new c.Uniform1f(a,s.u_fade_change),u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new c.Uniform1i(a,s.u_is_text),u_pitch_with_map:new c.Uniform1i(a,s.u_pitch_with_map),u_texsize:new c.Uniform2f(a,s.u_texsize),u_texture:new c.Uniform1i(a,s.u_texture),u_gamma_scale:new c.Uniform1f(a,s.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(a,s.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(a,s.u_is_halo)}},symbolTextAndIcon:function(a,s){return{u_is_size_zoom_constant:new c.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new c.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new c.Uniform1f(a,s.u_size_t),u_size:new c.Uniform1f(a,s.u_size),u_camera_to_center_distance:new c.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new c.Uniform1f(a,s.u_pitch),u_rotate_symbol:new c.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new c.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new c.Uniform1f(a,s.u_fade_change),u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new c.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new c.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new c.Uniform1i(a,s.u_is_text),u_pitch_with_map:new c.Uniform1i(a,s.u_pitch_with_map),u_texsize:new c.Uniform2f(a,s.u_texsize),u_texsize_icon:new c.Uniform2f(a,s.u_texsize_icon),u_texture:new c.Uniform1i(a,s.u_texture),u_texture_icon:new c.Uniform1i(a,s.u_texture_icon),u_gamma_scale:new c.Uniform1f(a,s.u_gamma_scale),u_device_pixel_ratio:new c.Uniform1f(a,s.u_device_pixel_ratio),u_is_halo:new c.Uniform1i(a,s.u_is_halo)}},background:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_opacity:new c.Uniform1f(a,s.u_opacity),u_color:new c.UniformColor(a,s.u_color)}},backgroundPattern:function(a,s){return{u_matrix:new c.UniformMatrix4f(a,s.u_matrix),u_opacity:new c.Uniform1f(a,s.u_opacity),u_image:new c.Uniform1i(a,s.u_image),u_pattern_tl_a:new c.Uniform2f(a,s.u_pattern_tl_a),u_pattern_br_a:new c.Uniform2f(a,s.u_pattern_br_a),u_pattern_tl_b:new c.Uniform2f(a,s.u_pattern_tl_b),u_pattern_br_b:new c.Uniform2f(a,s.u_pattern_br_b),u_texsize:new c.Uniform2f(a,s.u_texsize),u_mix:new c.Uniform1f(a,s.u_mix),u_pattern_size_a:new c.Uniform2f(a,s.u_pattern_size_a),u_pattern_size_b:new c.Uniform2f(a,s.u_pattern_size_b),u_scale_a:new c.Uniform1f(a,s.u_scale_a),u_scale_b:new c.Uniform1f(a,s.u_scale_b),u_pixel_coord_upper:new c.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new c.Uniform2f(a,s.u_pixel_coord_lower),u_tile_units_to_pixels:new c.Uniform1f(a,s.u_tile_units_to_pixels)}}};function Fu(a,s,o,p,b,E,A){for(var F=a.context,$=F.gl,ce=a.useProgram("collisionBox"),Ce=[],Ie=0,ke=0,et=0;et<p.length;et++){var $e=p[et],ft=s.getTile($e),Ye=ft.getBucket(o);if(Ye){var lt=$e.posMatrix;0===b[0]&&0===b[1]||(lt=a.translatePosMatrix($e.posMatrix,ft,b,E));var Pt=A?Ye.textCollisionBox:Ye.iconCollisionBox,Ht=Ye.collisionCircleArray;if(Ht.length>0){var hr=c.create(),nr=lt;c.mul(hr,Ye.placementInvProjMatrix,a.transform.glCoordMatrix),c.mul(hr,hr,Ye.placementViewportMatrix),Ce.push({circleArray:Ht,circleOffset:ke,transform:nr,invTransform:hr}),ke=Ie+=Ht.length/4}Pt&&ce.draw(F,$.LINES,V.disabled,ae.disabled,a.colorModeForRenderPass(),Oe.disabled,rs(lt,a.transform,ft),o.id,Pt.layoutVertexBuffer,Pt.indexBuffer,Pt.segments,null,a.transform.zoom,null,null,Pt.collisionVertexBuffer)}}if(A&&Ce.length){var _r=a.useProgram("collisionCircle"),Dr=new c.StructArrayLayout2f1f2i16;Dr.resize(4*Ie),Dr._trim();for(var Qr=0,Xr=0,dn=Ce;Xr<dn.length;Xr+=1)for(var qn=dn[Xr],jn=0;jn<qn.circleArray.length/4;jn++){var Bn=4*jn,Li=qn.circleArray[Bn+0],Dn=qn.circleArray[Bn+1],gi=qn.circleArray[Bn+2],ji=qn.circleArray[Bn+3];Dr.emplace(Qr++,Li,Dn,gi,ji,0),Dr.emplace(Qr++,Li,Dn,gi,ji,1),Dr.emplace(Qr++,Li,Dn,gi,ji,2),Dr.emplace(Qr++,Li,Dn,gi,ji,3)}(!Fl||Fl.length<2*Ie)&&(Fl=function(U){var he=2*U,Te=new c.StructArrayLayout3ui6;Te.resize(he),Te._trim();for(var vt=0;vt<he;vt++){var Rt=6*vt;Te.uint16[Rt+0]=4*vt+0,Te.uint16[Rt+1]=4*vt+1,Te.uint16[Rt+2]=4*vt+2,Te.uint16[Rt+3]=4*vt+2,Te.uint16[Rt+4]=4*vt+3,Te.uint16[Rt+5]=4*vt+0}return Te}(Ie));for(var li=F.createIndexBuffer(Fl,!0),yi=F.createVertexBuffer(Dr,c.collisionCircleLayout.members,!0),Ni=0,te=Ce;Ni<te.length;Ni+=1){var ne=te[Ni],N=tc(ne.transform,ne.invTransform,a.transform);_r.draw(F,$.TRIANGLES,V.disabled,ae.disabled,a.colorModeForRenderPass(),Oe.disabled,N,o.id,yi,li,c.SegmentVector.simpleSegment(0,2*ne.circleOffset,ne.circleArray.length,ne.circleArray.length/2),null,a.transform.zoom,null,null,null)}yi.destroy(),li.destroy()}}var js=c.identity(new Float32Array(16));function Pc(a,s,o,p,b,E){var A=c.getAnchorAlignment(a),F=-(A.horizontalAlign-.5)*s,$=-(A.verticalAlign-.5)*o,ce=c.evaluateVariableOffset(a,p);return new c.Point((F/b+ce[0])*E,($/b+ce[1])*E)}function Ic(a,s,o,p,b,E,A,F,$,ce,Ce){var Ie=a.text.placedSymbolArray,ke=a.text.dynamicLayoutVertexArray,et=a.icon.dynamicLayoutVertexArray,$e={};ke.clear();for(var ft=0;ft<Ie.length;ft++){var Ye=Ie.get(ft),lt=Ye.hidden||!Ye.crossTileID||a.allowVerticalPlacement&&!Ye.placedOrientation?null:p[Ye.crossTileID];if(lt){var Pt=new c.Point(Ye.anchorX,Ye.anchorY),Ht=Bi(Pt,o?F:A),hr=Xi(E.cameraToCenterDistance,Ht.signedDistanceFromCamera),nr=b.evaluateSizeForFeature(a.textSizeData,ce,Ye)*hr/c.ONE_EM;o&&(nr*=a.tilePixelRatio/$);for(var _r=Pc(lt.anchor,lt.width,lt.height,lt.textOffset,lt.textBoxScale,nr),Dr=o?Bi(Pt.add(_r),A).point:Ht.point.add(s?_r.rotate(-E.angle):_r),Qr=a.allowVerticalPlacement&&Ye.placedOrientation===c.WritingMode.vertical?Math.PI/2:0,Xr=0;Xr<Ye.numGlyphs;Xr++)c.addDynamicAttributes(ke,Dr,Qr);Ce&&Ye.associatedIconIndex>=0&&($e[Ye.associatedIconIndex]={shiftedAnchor:Dr,angle:Qr})}else Fi(Ye.numGlyphs,ke)}if(Ce){et.clear();for(var dn=a.icon.placedSymbolArray,qn=0;qn<dn.length;qn++){var jn=dn.get(qn);if(jn.hidden)Fi(jn.numGlyphs,et);else{var Bn=$e[qn];if(Bn)for(var Li=0;Li<jn.numGlyphs;Li++)c.addDynamicAttributes(et,Bn.shiftedAnchor,Bn.angle);else Fi(jn.numGlyphs,et)}}a.icon.dynamicLayoutVertexBuffer.updateData(et)}a.text.dynamicLayoutVertexBuffer.updateData(ke)}function Wc(a,s,o){return o.iconsInText&&s?"symbolTextAndIcon":a?"symbolSDF":"symbolIcon"}function tl(a,s,o,p,b,E,A,F,$,ce,Ce,Ie){for(var ke=a.context,et=ke.gl,$e=a.transform,ft="map"===F,Ye="map"===$,lt=ft&&"point"!==o.layout.get("symbol-placement"),Pt=ft&&!Ye&&!lt,Ht=void 0!==o.layout.get("symbol-sort-key").constantOr(1),hr=!1,nr=a.depthModeForSublayer(0,V.ReadOnly),_r=o.layout.get("text-variable-anchor"),Dr=[],Qr=0,Xr=p;Qr<Xr.length;Qr+=1){var dn=Xr[Qr],qn=s.getTile(dn),jn=qn.getBucket(o);if(jn){var Bn=b?jn.text:jn.icon;if(Bn&&Bn.segments.get().length){var Li=Bn.programConfigurations.get(o.id),Dn=b||jn.sdfIcons,gi=b?jn.textSizeData:jn.iconSizeData,ji=Ye||0!==$e.pitch,li=a.useProgram(Wc(Dn,b,jn),Li),yi=c.evaluateSizeForZoom(gi,$e.zoom),Ni=void 0,te=[0,0],ne=void 0,N=void 0,U=null,he=void 0;if(b)ne=qn.glyphAtlasTexture,N=et.LINEAR,Ni=qn.glyphAtlasTexture.size,jn.iconsInText&&(te=qn.imageAtlasTexture.size,U=qn.imageAtlasTexture,he=ji||a.options.rotating||a.options.zooming||"composite"===gi.kind||"camera"===gi.kind?et.LINEAR:et.NEAREST);else{var Te=1!==o.layout.get("icon-size").constantOr(0)||jn.iconsNeedLinear;ne=qn.imageAtlasTexture,N=Dn||a.options.rotating||a.options.zooming||Te||ji?et.LINEAR:et.NEAREST,Ni=qn.imageAtlasTexture.size}var vt=ma(qn,1,a.transform.zoom),Rt=Ia(dn.posMatrix,Ye,ft,a.transform,vt),Ot=Gi(dn.posMatrix,Ye,ft,a.transform,vt),ur=_r&&jn.hasTextData(),Vr="none"!==o.layout.get("icon-text-fit")&&ur&&jn.hasIconData();lt&&Ho(jn,dn.posMatrix,a,b,Rt,Ot,Ye,ce);var Ln=a.translatePosMatrix(dn.posMatrix,qn,E,A),Xn=lt||b&&_r||Vr?js:Rt,ni=a.translatePosMatrix(Ot,qn,E,A,!0),Ci=Dn&&0!==o.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1),Si={program:li,buffers:Bn,uniformValues:Dn?jn.iconsInText?pl(gi.kind,yi,Pt,Ye,a,Ln,Xn,ni,Ni,te):$u(gi.kind,yi,Pt,Ye,a,Ln,Xn,ni,b,Ni,!0):yu(gi.kind,yi,Pt,Ye,a,Ln,Xn,ni,b,Ni),atlasTexture:ne,atlasTextureIcon:U,atlasInterpolation:N,atlasInterpolationIcon:he,isSDF:Dn,hasHalo:Ci};if(Ht&&jn.canOverlap){hr=!0;for(var ea=0,xa=Bn.segments.get();ea<xa.length;ea+=1){var ua=xa[ea];Dr.push({segments:new c.SegmentVector([ua]),sortKey:ua.sortKey,state:Si})}}else Dr.push({segments:Bn.segments,sortKey:0,state:Si})}}}hr&&Dr.sort(function(la,no){return la.sortKey-no.sortKey});for(var Ha=0,Wa=Dr;Ha<Wa.length;Ha+=1){var Ya=Wa[Ha],ia=Ya.state;if(ke.activeTexture.set(et.TEXTURE0),ia.atlasTexture.bind(ia.atlasInterpolation,et.CLAMP_TO_EDGE),ia.atlasTextureIcon&&(ke.activeTexture.set(et.TEXTURE1),ia.atlasTextureIcon&&ia.atlasTextureIcon.bind(ia.atlasInterpolationIcon,et.CLAMP_TO_EDGE)),ia.isSDF){var ga=ia.uniformValues;ia.hasHalo&&(ga.u_is_halo=1,vl(ia.buffers,Ya.segments,o,a,ia.program,nr,Ce,Ie,ga)),ga.u_is_halo=0}vl(ia.buffers,Ya.segments,o,a,ia.program,nr,Ce,Ie,ia.uniformValues)}}function vl(a,s,o,p,b,E,A,F,$){var ce=p.context;b.draw(ce,ce.gl.TRIANGLES,E,A,F,Oe.disabled,$,o.id,a.layoutVertexBuffer,a.indexBuffer,s,o.paint,p.transform.zoom,a.programConfigurations.get(o.id),a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer)}function Nl(a,s,o,p,b,E,A){var F,$,ce,Ce,Ie,ke=a.context.gl,et=o.paint.get("fill-pattern"),$e=et&&et.constantOr(1),ft=o.getCrossfadeParameters();A?($=$e&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=ke.LINES):($=$e?"fillPattern":"fill",F=ke.TRIANGLES);for(var Ye=0,lt=p;Ye<lt.length;Ye+=1){var Pt=lt[Ye],Ht=s.getTile(Pt);if(!$e||Ht.patternsLoaded()){var hr=Ht.getBucket(o);if(hr){var nr=hr.programConfigurations.get(o.id),_r=a.useProgram($,nr);$e&&(a.context.activeTexture.set(ke.TEXTURE0),Ht.imageAtlasTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE),nr.updatePaintBuffers(ft));var Dr=et.constantOr(null);if(Dr&&Ht.imageAtlas){var Qr=Ht.imageAtlas,Xr=Qr.patternPositions[Dr.to.toString()],dn=Qr.patternPositions[Dr.from.toString()];Xr&&dn&&nr.setConstantPatternPositions(Xr,dn)}var qn=a.translatePosMatrix(Pt.posMatrix,Ht,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(A){Ce=hr.indexBuffer2,Ie=hr.segments2;var jn=[ke.drawingBufferWidth,ke.drawingBufferHeight];ce="fillOutlinePattern"===$&&$e?Tc(qn,a,ft,Ht,jn):oo(qn,jn)}else Ce=hr.indexBuffer,Ie=hr.segments,ce=$e?tu(qn,a,ft,Ht):gu(qn);_r.draw(a.context,F,b,a.stencilModeForClipping(Pt),E,Oe.disabled,ce,o.id,hr.layoutVertexBuffer,Ce,Ie,o.paint,a.transform.zoom,nr)}}}}function ic(a,s,o,p,b,E,A){for(var F=a.context,$=F.gl,ce=o.paint.get("fill-extrusion-pattern"),Ce=ce.constantOr(1),Ie=o.getCrossfadeParameters(),ke=o.paint.get("fill-extrusion-opacity"),et=0,$e=p;et<$e.length;et+=1){var ft=$e[et],Ye=s.getTile(ft),lt=Ye.getBucket(o);if(lt){var Pt=lt.programConfigurations.get(o.id),Ht=a.useProgram(Ce?"fillExtrusionPattern":"fillExtrusion",Pt);Ce&&(a.context.activeTexture.set($.TEXTURE0),Ye.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Pt.updatePaintBuffers(Ie));var hr=ce.constantOr(null);if(hr&&Ye.imageAtlas){var nr=Ye.imageAtlas,_r=nr.patternPositions[hr.to.toString()],Dr=nr.patternPositions[hr.from.toString()];_r&&Dr&&Pt.setConstantPatternPositions(_r,Dr)}var Qr=a.translatePosMatrix(ft.posMatrix,Ye,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Xr=o.paint.get("fill-extrusion-vertical-gradient"),dn=Ce?mu(Qr,a,Xr,ke,ft,Ie,Ye):Bl(Qr,a,Xr,ke);Ht.draw(F,F.gl.TRIANGLES,b,E,A,Oe.backCCW,dn,o.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,o.paint,a.transform.zoom,Pt)}}}function Nu(a,s,o,p,b,E){var A=a.context,F=A.gl,$=s.fbo;if($){var ce=a.useProgram("hillshade");A.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,$.colorAttachment.get());var Ce=function(Ie,ke,et){var $e=et.paint.get("hillshade-shadow-color"),ft=et.paint.get("hillshade-highlight-color"),Ye=et.paint.get("hillshade-accent-color"),lt=et.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===et.paint.get("hillshade-illumination-anchor")&&(lt-=Ie.transform.angle);var Pt,Ht,hr,nr=!Ie.options.moving;return{u_matrix:Ie.transform.calculatePosMatrix(ke.tileID.toUnwrapped(),nr),u_image:0,u_latrange:(Pt=ke.tileID,Ht=Math.pow(2,Pt.canonical.z),hr=Pt.canonical.y,[new c.MercatorCoordinate(0,hr/Ht).toLngLat().lat,new c.MercatorCoordinate(0,(hr+1)/Ht).toLngLat().lat]),u_light:[et.paint.get("hillshade-exaggeration"),lt],u_shadow:$e,u_highlight:ft,u_accent:Ye}}(a,s,o);ce.draw(A,F.TRIANGLES,p,b,E,Oe.disabled,Ce,o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}}function uf(a,s,o,p,b,E){var ft,Ye,lt,Pt,A=a.context,F=A.gl,$=s.dem;if($&&$.data){var ce=$.dim,Ce=$.stride,Ie=$.getPixels();if(A.activeTexture.set(F.TEXTURE1),A.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||a.getTileTexture(Ce),s.demTexture){var ke=s.demTexture;ke.update(Ie,{premultiply:!1}),ke.bind(F.NEAREST,F.CLAMP_TO_EDGE)}else s.demTexture=new c.Texture(A,Ie,F.RGBA,{premultiply:!1}),s.demTexture.bind(F.NEAREST,F.CLAMP_TO_EDGE);A.activeTexture.set(F.TEXTURE0);var et=s.fbo;if(!et){var $e=new c.Texture(A,{width:ce,height:ce,data:null},F.RGBA);$e.bind(F.LINEAR,F.CLAMP_TO_EDGE),(et=s.fbo=A.createFramebuffer(ce,ce,!0)).colorAttachment.set($e.texture)}A.bindFramebuffer.set(et.framebuffer),A.viewport.set([0,0,ce,ce]),a.useProgram("hillshadePrepare").draw(A,F.TRIANGLES,p,b,E,Oe.disabled,(ft=s.tileID,lt=(Ye=$).stride,Pt=c.create(),c.ortho(Pt,0,c.EXTENT,-c.EXTENT,0,0,1),c.translate(Pt,Pt,[0,-c.EXTENT,0]),{u_matrix:Pt,u_image:1,u_dimension:[lt,lt],u_zoom:ft.overscaledZ,u_unpack:Ye.getUnpackVector()}),o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Cu(a,s,o,p,b){var E=p.paint.get("raster-fade-duration");if(E>0){var A=c.browser.now(),F=(A-a.timeAdded)/E,$=s?(A-s.timeAdded)/E:-1,ce=o.getSource(),Ce=b.coveringZoomLevel({tileSize:ce.tileSize,roundZoom:ce.roundZoom}),Ie=!s||Math.abs(s.tileID.overscaledZ-Ce)>Math.abs(a.tileID.overscaledZ-Ce),ke=Ie&&a.refreshedUponExpiration?1:c.clamp(Ie?F:1-$,0,1);return a.refreshedUponExpiration&&F>=1&&(a.refreshedUponExpiration=!1),s?{opacity:1,mix:1-ke}:{opacity:ke,mix:0}}return{opacity:1,mix:0}}var zu=new c.Color(1,0,0,1),nu=new c.Color(0,1,0,1),Au=new c.Color(0,0,1,1),Vs=new c.Color(1,0,1,1),zl=new c.Color(0,1,1,1);function ac(a,s,o,p){Zu(a,0,s+o/2,a.transform.width,o,p)}function oc(a,s,o,p){Zu(a,s-o/2,0,o,a.transform.height,p)}function Zu(a,s,o,p,b,E){var A=a.context,F=A.gl;F.enable(F.SCISSOR_TEST),F.scissor(s*c.browser.devicePixelRatio,o*c.browser.devicePixelRatio,p*c.browser.devicePixelRatio,b*c.browser.devicePixelRatio),A.clear({color:E}),F.disable(F.SCISSOR_TEST)}function ns(a,s,o){var p=a.context,b=p.gl,E=o.posMatrix,A=a.useProgram("debug"),F=V.disabled,$=ae.disabled,ce=a.colorModeForRenderPass();p.activeTexture.set(b.TEXTURE0),a.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),A.draw(p,b.LINE_STRIP,F,$,ce,Oe.disabled,ru(E,c.Color.red),"$debug",a.debugBuffer,a.tileBorderIndexBuffer,a.debugSegments);var Ce=s.getTileByID(o.key).latestRawTileData,Ie=Math.floor((Ce&&Ce.byteLength||0)/1024),ke=s.getTile(o).tileSize,et=512/Math.min(ke,512)*(o.overscaledZ/a.transform.zoom)*.5,$e=o.canonical.toString();o.overscaledZ!==o.canonical.z&&($e+=" => "+o.overscaledZ),function(ft,Ye){ft.initDebugOverlayCanvas();var lt=ft.debugOverlayCanvas,Pt=ft.context.gl,Ht=ft.debugOverlayCanvas.getContext("2d");Ht.clearRect(0,0,lt.width,lt.height),Ht.shadowColor="white",Ht.shadowBlur=2,Ht.lineWidth=1.5,Ht.strokeStyle="white",Ht.textBaseline="top",Ht.font="bold 36px Open Sans, sans-serif",Ht.fillText(Ye,5,5),Ht.strokeText(Ye,5,5),ft.debugOverlayTexture.update(lt),ft.debugOverlayTexture.bind(Pt.LINEAR,Pt.CLAMP_TO_EDGE)}(a,$e+" "+Ie+"kb"),A.draw(p,b.TRIANGLES,F,$,xe.alphaBlended,Oe.disabled,ru(E,c.Color.transparent,et),"$debug",a.debugBuffer,a.quadTriangleIndexBuffer,a.debugSegments)}var rl={symbol:function(a,s,o,p,b){if("translucent"===a.renderPass){var E=ae.disabled,A=a.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(F,$,ce,Ce,Ie,ke,et){for(var $e=$.transform,ft="map"===Ie,Ye="map"===ke,lt=0,Pt=F;lt<Pt.length;lt+=1){var Ht=Pt[lt],hr=Ce.getTile(Ht),nr=hr.getBucket(ce);if(nr&&nr.text&&nr.text.segments.get().length){var _r=c.evaluateSizeForZoom(nr.textSizeData,$e.zoom),Dr=ma(hr,1,$.transform.zoom),Qr=Ia(Ht.posMatrix,Ye,ft,$.transform,Dr),Xr="none"!==ce.layout.get("icon-text-fit")&&nr.hasIconData();if(_r){var dn=Math.pow(2,$e.zoom-hr.tileID.overscaledZ);Ic(nr,ft,Ye,et,c.symbolSize,$e,Qr,Ht.posMatrix,dn,_r,Xr)}}}}(p,a,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),b),0!==o.paint.get("icon-opacity").constantOr(1)&&tl(a,s,o,p,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),E,A),0!==o.paint.get("text-opacity").constantOr(1)&&tl(a,s,o,p,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),E,A),s.map.showCollisionBoxes&&(Fu(a,s,o,p,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Fu(a,s,o,p,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(a,s,o,p){if("translucent"===a.renderPass){var b=o.paint.get("circle-opacity"),E=o.paint.get("circle-stroke-width"),A=o.paint.get("circle-stroke-opacity"),F=void 0!==o.layout.get("circle-sort-key").constantOr(1);if(0!==b.constantOr(1)||0!==E.constantOr(1)&&0!==A.constantOr(1)){for(var $=a.context,ce=$.gl,Ce=a.depthModeForSublayer(0,V.ReadOnly),Ie=ae.disabled,ke=a.colorModeForRenderPass(),et=[],$e=0;$e<p.length;$e++){var ft=p[$e],Ye=s.getTile(ft),lt=Ye.getBucket(o);if(lt){var Pt=lt.programConfigurations.get(o.id),Ht={programConfiguration:Pt,program:a.useProgram("circle",Pt),layoutVertexBuffer:lt.layoutVertexBuffer,indexBuffer:lt.indexBuffer,uniformValues:Cc(a,ft,Ye,o)};if(F)for(var hr=0,nr=lt.segments.get();hr<nr.length;hr+=1){var _r=nr[hr];et.push({segments:new c.SegmentVector([_r]),sortKey:_r.sortKey,state:Ht})}else et.push({segments:lt.segments,sortKey:0,state:Ht})}}F&&et.sort(function(qn,jn){return qn.sortKey-jn.sortKey});for(var Dr=0,Qr=et;Dr<Qr.length;Dr+=1){var Xr=Qr[Dr],dn=Xr.state;dn.program.draw($,ce.TRIANGLES,Ce,Ie,ke,Oe.disabled,dn.uniformValues,o.id,dn.layoutVertexBuffer,dn.indexBuffer,Xr.segments,o.paint,a.transform.zoom,dn.programConfiguration)}}}},heatmap:function(a,s,o,p){if(0!==o.paint.get("heatmap-opacity"))if("offscreen"===a.renderPass){var b=a.context,E=b.gl,A=ae.disabled,F=new xe([E.ONE,E.ONE],c.Color.transparent,[!0,!0,!0,!0]);(function(et,$e,ft){var Ye=et.gl;et.activeTexture.set(Ye.TEXTURE1),et.viewport.set([0,0,$e.width/4,$e.height/4]);var Ht,hr,nr,_r,Dr,lt=ft.heatmapFbo;if(lt)Ye.bindTexture(Ye.TEXTURE_2D,lt.colorAttachment.get()),et.bindFramebuffer.set(lt.framebuffer);else{var Pt=Ye.createTexture();Ye.bindTexture(Ye.TEXTURE_2D,Pt),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_WRAP_S,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_WRAP_T,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_MIN_FILTER,Ye.LINEAR),Ye.texParameteri(Ye.TEXTURE_2D,Ye.TEXTURE_MAG_FILTER,Ye.LINEAR),nr=Pt,_r=lt=ft.heatmapFbo=et.createFramebuffer($e.width/4,$e.height/4,!1),(Dr=(Ht=et).gl).texImage2D(Dr.TEXTURE_2D,0,Dr.RGBA,(hr=$e).width/4,hr.height/4,0,Dr.RGBA,Ht.extRenderToTextureHalfFloat?Ht.extTextureHalfFloat.HALF_FLOAT_OES:Dr.UNSIGNED_BYTE,null),_r.colorAttachment.set(nr)}})(b,a,o),b.clear({color:c.Color.transparent});for(var $=0;$<p.length;$++){var ce=p[$];if(!s.hasRenderableParent(ce)){var Ce=s.getTile(ce),Ie=Ce.getBucket(o);if(Ie){var ke=Ie.programConfigurations.get(o.id);a.useProgram("heatmap",ke).draw(b,E.TRIANGLES,V.disabled,A,F,Oe.disabled,rc(ce.posMatrix,Ce,a.transform.zoom,o.paint.get("heatmap-intensity")),o.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,o.paint,a.transform.zoom,ke)}}}b.viewport.set([0,0,a.width,a.height])}else"translucent"===a.renderPass&&(a.context.setColorMode(a.colorModeForRenderPass()),function(et,$e){var ft=et.context,Ye=ft.gl,lt=$e.heatmapFbo;if(lt){ft.activeTexture.set(Ye.TEXTURE0),Ye.bindTexture(Ye.TEXTURE_2D,lt.colorAttachment.get()),ft.activeTexture.set(Ye.TEXTURE1);var Pt=$e.colorRampTexture;Pt||(Pt=$e.colorRampTexture=new c.Texture(ft,$e.colorRamp,Ye.RGBA)),Pt.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE),et.useProgram("heatmapTexture").draw(ft,Ye.TRIANGLES,V.disabled,ae.disabled,et.colorModeForRenderPass(),Oe.disabled,function(Ht,hr,nr,_r){var Dr=c.create();c.ortho(Dr,0,Ht.width,Ht.height,0,0,1);var Qr=Ht.context.gl;return{u_matrix:Dr,u_world:[Qr.drawingBufferWidth,Qr.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:hr.paint.get("heatmap-opacity")}}(et,$e),$e.id,et.viewportBuffer,et.quadTriangleIndexBuffer,et.viewportSegments,$e.paint,et.transform.zoom)}}(a,o))},line:function(a,s,o,p){if("translucent"===a.renderPass){var b=o.paint.get("line-opacity"),E=o.paint.get("line-width");if(0!==b.constantOr(1)&&0!==E.constantOr(1))for(var A=a.depthModeForSublayer(0,V.ReadOnly),F=a.colorModeForRenderPass(),$=o.paint.get("line-dasharray"),ce=o.paint.get("line-pattern"),Ce=ce.constantOr(1),Ie=o.paint.get("line-gradient"),ke=o.getCrossfadeParameters(),et=Ce?"linePattern":$?"lineSDF":Ie?"lineGradient":"line",$e=a.context,ft=$e.gl,Ye=!0,lt=0,Pt=p;lt<Pt.length;lt+=1){var Ht=Pt[lt],hr=s.getTile(Ht);if(!Ce||hr.patternsLoaded()){var nr=hr.getBucket(o);if(nr){var _r=nr.programConfigurations.get(o.id),Dr=a.context.program.get(),Qr=a.useProgram(et,_r),Xr=Ye||Qr.program!==Dr,dn=ce.constantOr(null);if(dn&&hr.imageAtlas){var qn=hr.imageAtlas,jn=qn.patternPositions[dn.to.toString()],Bn=qn.patternPositions[dn.from.toString()];jn&&Bn&&_r.setConstantPatternPositions(jn,Bn)}var Li=Ce?Ju(a,hr,o,ke):$?Gc(a,hr,o,$,ke):Ie?La(a,hr,o,nr.lineClipsArray.length):Bu(a,hr,o);if(Ce)$e.activeTexture.set(ft.TEXTURE0),hr.imageAtlasTexture.bind(ft.LINEAR,ft.CLAMP_TO_EDGE),_r.updatePaintBuffers(ke);else if($&&(Xr||a.lineAtlas.dirty))$e.activeTexture.set(ft.TEXTURE0),a.lineAtlas.bind($e);else if(Ie){var Dn=nr.gradients[o.id],gi=Dn.texture;if(o.gradientVersion!==Dn.version){var ji=256;if(o.stepInterpolant){var li=s.getSource().maxzoom,yi=Ht.canonical.z===li?Math.ceil(1<<a.transform.maxZoom-Ht.canonical.z):1;ji=c.clamp(c.nextPowerOfTwo(nr.maxLineLength/c.EXTENT*1024*yi),256,$e.maxTextureSize)}Dn.gradient=c.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:ji,image:Dn.gradient||void 0,clips:nr.lineClipsArray}),Dn.texture?Dn.texture.update(Dn.gradient):Dn.texture=new c.Texture($e,Dn.gradient,ft.RGBA),Dn.version=o.gradientVersion,gi=Dn.texture}$e.activeTexture.set(ft.TEXTURE0),gi.bind(o.stepInterpolant?ft.NEAREST:ft.LINEAR,ft.CLAMP_TO_EDGE)}Qr.draw($e,ft.TRIANGLES,A,a.stencilModeForClipping(Ht),F,Oe.disabled,Li,o.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,o.paint,a.transform.zoom,_r,nr.layoutVertexBuffer2),Ye=!1}}}}},fill:function(a,s,o,p){var b=o.paint.get("fill-color"),E=o.paint.get("fill-opacity");if(0!==E.constantOr(1)){var A=a.colorModeForRenderPass(),F=o.paint.get("fill-pattern"),$=a.opaquePassEnabledForLayer()&&!F.constantOr(1)&&1===b.constantOr(c.Color.transparent).a&&1===E.constantOr(0)?"opaque":"translucent";if(a.renderPass===$){var ce=a.depthModeForSublayer(1,"opaque"===a.renderPass?V.ReadWrite:V.ReadOnly);Nl(a,s,o,p,ce,A,!1)}if("translucent"===a.renderPass&&o.paint.get("fill-antialias")){var Ce=a.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,V.ReadOnly);Nl(a,s,o,p,Ce,A,!0)}}},"fill-extrusion":function(a,s,o,p){var b=o.paint.get("fill-extrusion-opacity");if(0!==b&&"translucent"===a.renderPass){var E=new V(a.context.gl.LEQUAL,V.ReadWrite,a.depthRangeFor3D);if(1!==b||o.paint.get("fill-extrusion-pattern").constantOr(1))ic(a,s,o,p,E,ae.disabled,xe.disabled),ic(a,s,o,p,E,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var A=a.colorModeForRenderPass();ic(a,s,o,p,E,ae.disabled,A)}}},hillshade:function(a,s,o,p){if("offscreen"===a.renderPass||"translucent"===a.renderPass){for(var b=a.context,E=a.depthModeForSublayer(0,V.ReadOnly),A=a.colorModeForRenderPass(),F="translucent"===a.renderPass?a.stencilConfigForOverlap(p):[{},p],$=F[0],ce=0,Ce=F[1];ce<Ce.length;ce+=1){var Ie=Ce[ce],ke=s.getTile(Ie);ke.needsHillshadePrepare&&"offscreen"===a.renderPass?uf(a,ke,o,E,ae.disabled,A):"translucent"===a.renderPass&&Nu(a,ke,o,E,$[Ie.overscaledZ],A)}b.viewport.set([0,0,a.width,a.height])}},raster:function(a,s,o,p){if("translucent"===a.renderPass&&0!==o.paint.get("raster-opacity")&&p.length)for(var b=a.context,E=b.gl,A=s.getSource(),F=a.useProgram("raster"),$=a.colorModeForRenderPass(),ce=A instanceof Me?[{},p]:a.stencilConfigForOverlap(p),Ce=ce[0],Ie=ce[1],ke=Ie[Ie.length-1].overscaledZ,et=!a.options.moving,$e=0,ft=Ie;$e<ft.length;$e+=1){var Ye=ft[$e],lt=a.depthModeForSublayer(Ye.overscaledZ-ke,1===o.paint.get("raster-opacity")?V.ReadWrite:V.ReadOnly,E.LESS),Pt=s.getTile(Ye),Ht=a.transform.calculatePosMatrix(Ye.toUnwrapped(),et);Pt.registerFadeDuration(o.paint.get("raster-fade-duration"));var hr=s.findLoadedParent(Ye,0),nr=Cu(Pt,hr,s,o,a.transform),_r=void 0,Dr=void 0,Qr="nearest"===o.paint.get("raster-resampling")?E.NEAREST:E.LINEAR;b.activeTexture.set(E.TEXTURE0),Pt.texture.bind(Qr,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),b.activeTexture.set(E.TEXTURE1),hr?(hr.texture.bind(Qr,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST),_r=Math.pow(2,hr.tileID.overscaledZ-Pt.tileID.overscaledZ),Dr=[Pt.tileID.canonical.x*_r%1,Pt.tileID.canonical.y*_r%1]):Pt.texture.bind(Qr,E.CLAMP_TO_EDGE,E.LINEAR_MIPMAP_NEAREST);var Xr=Hc(Ht,Dr||[0,0],_r||1,nr,o);A instanceof Me?F.draw(b,E.TRIANGLES,lt,ae.disabled,$,Oe.disabled,Xr,o.id,A.boundsBuffer,a.quadTriangleIndexBuffer,A.boundsSegments):F.draw(b,E.TRIANGLES,lt,Ce[Ye.overscaledZ],$,Oe.disabled,Xr,o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,s,o){var p=o.paint.get("background-color"),b=o.paint.get("background-opacity");if(0!==b){var E=a.context,A=E.gl,F=a.transform,$=F.tileSize,ce=o.paint.get("background-pattern");if(!a.isPatternMissing(ce)){var Ce=!ce&&1===p.a&&1===b&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===Ce){var Ie=ae.disabled,ke=a.depthModeForSublayer(0,"opaque"===Ce?V.ReadWrite:V.ReadOnly),et=a.colorModeForRenderPass(),$e=a.useProgram(ce?"backgroundPattern":"background"),ft=F.coveringTiles({tileSize:$});ce&&(E.activeTexture.set(A.TEXTURE0),a.imageManager.bind(a.context));for(var Ye=o.getCrossfadeParameters(),lt=0,Pt=ft;lt<Pt.length;lt+=1){var Ht=Pt[lt],hr=a.transform.calculatePosMatrix(Ht.toUnwrapped()),nr=ce?el(hr,b,a,ce,{tileID:Ht,tileSize:$},Ye):Qu(hr,b,p);$e.draw(E,A.TRIANGLES,ke,Ie,et,Oe.disabled,nr,o.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,s,o){for(var p=0;p<o.length;p++)ns(a,s,o[p])},custom:function(a,s,o){var p=a.context,b=o.implementation;if("offscreen"===a.renderPass){var E=b.prerender;E&&(a.setCustomLayerDefaults(),p.setColorMode(a.colorModeForRenderPass()),E.call(b,p.gl,a.transform.customLayerMatrix()),p.setDirty(),a.setBaseState())}else if("translucent"===a.renderPass){a.setCustomLayerDefaults(),p.setColorMode(a.colorModeForRenderPass()),p.setStencilMode(ae.disabled);var A="3d"===b.renderingMode?new V(a.context.gl.LEQUAL,V.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,V.ReadOnly);p.setDepthMode(A),b.render(p.gl,a.transform.customLayerMatrix()),p.setDirty(),a.setBaseState(),p.bindFramebuffer.set(null)}}},$a=function(a,s){this.context=new fe(a),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=Ae.maxUnderzooming+Ae.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Lo,this.gpuTimers={}};$a.prototype.resize=function(a,s){if(this.width=a*c.browser.devicePixelRatio,this.height=s*c.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,p=this.style._order;o<p.length;o+=1)this.style._layers[p[o]].resize()},$a.prototype.setup=function(){var a=this.context,s=new c.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(c.EXTENT,0),s.emplaceBack(0,c.EXTENT),s.emplaceBack(c.EXTENT,c.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(s,Oa.members),this.tileExtentSegments=c.SegmentVector.simpleSegment(0,0,4,2);var o=new c.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(c.EXTENT,0),o.emplaceBack(0,c.EXTENT),o.emplaceBack(c.EXTENT,c.EXTENT),this.debugBuffer=a.createVertexBuffer(o,Oa.members),this.debugSegments=c.SegmentVector.simpleSegment(0,0,4,5);var p=new c.StructArrayLayout4i8;p.emplaceBack(0,0,0,0),p.emplaceBack(c.EXTENT,0,c.EXTENT,0),p.emplaceBack(0,c.EXTENT,0,c.EXTENT),p.emplaceBack(c.EXTENT,c.EXTENT,c.EXTENT,c.EXTENT),this.rasterBoundsBuffer=a.createVertexBuffer(p,me.members),this.rasterBoundsSegments=c.SegmentVector.simpleSegment(0,0,4,2);var b=new c.StructArrayLayout2i4;b.emplaceBack(0,0),b.emplaceBack(1,0),b.emplaceBack(0,1),b.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(b,Oa.members),this.viewportSegments=c.SegmentVector.simpleSegment(0,0,4,2);var E=new c.StructArrayLayout1ui2;E.emplaceBack(0),E.emplaceBack(1),E.emplaceBack(3),E.emplaceBack(2),E.emplaceBack(0),this.tileBorderIndexBuffer=a.createIndexBuffer(E);var A=new c.StructArrayLayout3ui6;A.emplaceBack(0,1,2),A.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(A),this.emptyTexture=new c.Texture(a,{width:1,height:1,data:new Uint8Array([0,0,0,0])},a.gl.RGBA);var F=this.context.gl;this.stencilClearMode=new ae({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO)},$a.prototype.clearStencil=function(){var a=this.context,s=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=c.create();c.ortho(o,0,this.width,this.height,0,0,1),c.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(a,s.TRIANGLES,V.disabled,this.stencilClearMode,xe.disabled,Oe.disabled,Rs(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},$a.prototype._renderTileClippingMasks=function(a,s){if(this.currentStencilSource!==a.source&&a.isTileClipped()&&s&&s.length){this.currentStencilSource=a.source;var o=this.context,p=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(xe.disabled),o.setDepthMode(V.disabled);var b=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var E=0,A=s;E<A.length;E+=1){var F=A[E],$=this._tileClippingMaskIDs[F.key]=this.nextStencilID++;b.draw(o,p.TRIANGLES,V.disabled,new ae({func:p.ALWAYS,mask:0},$,255,p.KEEP,p.KEEP,p.REPLACE),xe.disabled,Oe.disabled,Rs(F.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},$a.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var a=this.nextStencilID++,s=this.context.gl;return new ae({func:s.NOTEQUAL,mask:255},a,255,s.KEEP,s.KEEP,s.REPLACE)},$a.prototype.stencilModeForClipping=function(a){var s=this.context.gl;return new ae({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,s.KEEP,s.KEEP,s.REPLACE)},$a.prototype.stencilConfigForOverlap=function(a){var s,o=this.context.gl,p=a.sort(function($,ce){return ce.overscaledZ-$.overscaledZ}),b=p[p.length-1].overscaledZ,E=p[0].overscaledZ-b+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();for(var A={},F=0;F<E;F++)A[F+b]=new ae({func:o.GEQUAL,mask:255},F+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=E,[A,p]}return[(s={},s[b]=ae.disabled,s),p]},$a.prototype.colorModeForRenderPass=function(){var a=this.context.gl;return this._showOverdrawInspector?new xe([a.CONSTANT_COLOR,a.ONE],new c.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?xe.unblended:xe.alphaBlended},$a.prototype.depthModeForSublayer=function(a,s,o){if(!this.opaquePassEnabledForLayer())return V.disabled;var p=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new V(o||this.context.gl.LEQUAL,s,[p,p])},$a.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},$a.prototype.render=function(a,s){var o=this;this.style=a,this.options=s,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(c.browser.now()),this.imageManager.beginFrame();var p=this.style._order,b=this.style.sourceCaches;for(var E in b){var A=b[E];A.used&&A.prepare(this.context)}var F,$,ce={},Ce={},Ie={};for(var ke in b){var et=b[ke];ce[ke]=et.getVisibleCoordinates(),Ce[ke]=ce[ke].slice().reverse(),Ie[ke]=et.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var $e=0;$e<p.length;$e++)if(this.style._layers[p[$e]].is3D()){this.opaquePassCutoff=$e;break}this.renderPass="offscreen";for(var ft=0,Ye=p;ft<Ye.length;ft+=1){var lt=this.style._layers[Ye[ft]];if(lt.hasOffscreenPass()&&!lt.isHidden(this.transform.zoom)){var Pt=Ce[lt.source];("custom"===lt.type||Pt.length)&&this.renderLayer(this,b[lt.source],lt,Pt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?c.Color.black:c.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(a._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){var Ht=this.style._layers[p[this.currentLayer]],hr=b[Ht.source],nr=ce[Ht.source];this._renderTileClippingMasks(Ht,nr),this.renderLayer(this,hr,Ht,nr)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){var _r=this.style._layers[p[this.currentLayer]],Dr=b[_r.source],Qr=("symbol"===_r.type?Ie:Ce)[_r.source];this._renderTileClippingMasks(_r,ce[_r.source]),this.renderLayer(this,Dr,_r,Qr)}this.options.showTileBoundaries&&(c.values(this.style._layers).forEach(function(Xr){Xr.source&&!Xr.isHidden(o.transform.zoom)&&(Xr.source!==($&&$.id)&&($=o.style.sourceCaches[Xr.source]),(!F||F.getSource().maxzoom<$.getSource().maxzoom)&&(F=$))}),F&&rl.debug(this,F,F.getVisibleCoordinates())),this.options.showPadding&&function(Xr){var dn=Xr.transform.padding;ac(Xr,Xr.transform.height-(dn.top||0),3,zu),ac(Xr,dn.bottom||0,3,nu),oc(Xr,dn.left||0,3,Au),oc(Xr,Xr.transform.width-(dn.right||0),3,Vs);var jn,Bn,Li,Dn,qn=Xr.transform.centerPoint;Zu(jn=Xr,(Bn=qn.x)-1,(Li=Xr.transform.height-qn.y)-10,2,20,Dn=zl),Zu(jn,Bn-10,Li-1,20,2,Dn)}(this),this.context.setDefault()},$a.prototype.renderLayer=function(a,s,o,p){o.isHidden(this.transform.zoom)||("background"===o.type||"custom"===o.type||p.length)&&(this.id=o.id,this.gpuTimingStart(o),rl[o.type](a,s,o,p,this.style.placement.variableOffsets),this.gpuTimingEnd())},$a.prototype.gpuTimingStart=function(a){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[a.id];o||(o=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},$a.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}},$a.prototype.collectGpuTimers=function(){var a=this.gpuTimers;return this.gpuTimers={},a},$a.prototype.queryGpuTimers=function(a){var s={};for(var o in a){var p=a[o],b=this.context.extTimerQuery,E=b.getQueryObjectEXT(p.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(p.query),s[o]=E}return s},$a.prototype.translatePosMatrix=function(a,s,o,p,b){if(!o[0]&&!o[1])return a;var E=b?"map"===p?this.transform.angle:0:"viewport"===p?-this.transform.angle:0;if(E){var A=Math.sin(E),F=Math.cos(E);o=[o[0]*F-o[1]*A,o[0]*A+o[1]*F]}var $=[b?o[0]:ma(s,o[0],this.transform.zoom),b?o[1]:ma(s,o[1],this.transform.zoom),0],ce=new Float32Array(16);return c.translate(ce,a,$),ce},$a.prototype.saveTileTexture=function(a){var s=this._tileTextures[a.size[0]];s?s.push(a):this._tileTextures[a.size[0]]=[a]},$a.prototype.getTileTexture=function(a){var s=this._tileTextures[a];return s&&s.length>0?s.pop():null},$a.prototype.isPatternMissing=function(a){if(!a)return!1;if(!a.from||!a.to)return!0;var s=this.imageManager.getPattern(a.from.toString()),o=this.imageManager.getPattern(a.to.toString());return!s||!o},$a.prototype.useProgram=function(a,s){this.cache=this.cache||{};var o=""+a+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new Ec(this.context,a,Xo[a],s,dl[a],this._showOverdrawInspector)),this.cache[o]},$a.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},$a.prototype.setBaseState=function(){var a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)},$a.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=c.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new c.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},$a.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Zl=function(a,s){this.points=a,this.planes=s};Zl.fromInvProjectionMatrix=function(a,s,o){var p=Math.pow(2,o),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(A){return c.transformMat4([],A,a)}).map(function(A){return c.scale$1([],A,1/A[3]/s*p)}),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(A){var F=c.sub([],b[A[0]],b[A[1]]),$=c.sub([],b[A[2]],b[A[1]]),ce=c.normalize([],c.cross([],F,$)),Ce=-c.dot(ce,b[A[1]]);return ce.concat(Ce)});return new Zl(b,E)};var Gs=function(a,s){this.min=a,this.max=s,this.center=c.scale$2([],c.add([],this.min,this.max),.5)};Gs.prototype.quadrant=function(a){for(var s=[a%2==0,a<2],o=c.clone$2(this.min),p=c.clone$2(this.max),b=0;b<s.length;b++)o[b]=s[b]?this.min[b]:this.center[b],p[b]=s[b]?this.center[b]:this.max[b];return p[2]=this.max[2],new Gs(o,p)},Gs.prototype.distanceX=function(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]},Gs.prototype.distanceY=function(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]},Gs.prototype.intersects=function(a){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,p=0;p<a.planes.length;p++){for(var b=a.planes[p],E=0,A=0;A<s.length;A++)E+=c.dot$1(b,s[A])>=0;if(0===E)return 0;E!==s.length&&(o=!1)}if(o)return 2;for(var F=0;F<3;F++){for(var $=Number.MAX_VALUE,ce=-Number.MAX_VALUE,Ce=0;Ce<a.points.length;Ce++){var Ie=a.points[Ce][F]-this.min[F];$=Math.min($,Ie),ce=Math.max(ce,Ie)}if(ce<0||$>this.max[F]-this.min[F])return 0}return 1};var Pu=function(a,s,o,p){if(void 0===a&&(a=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===p&&(p=0),isNaN(a)||a<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=s,this.left=o,this.right=p};Pu.prototype.interpolate=function(a,s,o){return null!=s.top&&null!=a.top&&(this.top=c.number(a.top,s.top,o)),null!=s.bottom&&null!=a.bottom&&(this.bottom=c.number(a.bottom,s.bottom,o)),null!=s.left&&null!=a.left&&(this.left=c.number(a.left,s.left,o)),null!=s.right&&null!=a.right&&(this.right=c.number(a.right,s.right,o)),this},Pu.prototype.getCenter=function(a,s){var o=c.clamp((this.left+a-this.right)/2,0,a),p=c.clamp((this.top+s-this.bottom)/2,0,s);return new c.Point(o,p)},Pu.prototype.equals=function(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right},Pu.prototype.clone=function(){return new Pu(this.top,this.bottom,this.left,this.right)},Pu.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var sa=function(a,s,o,p,b){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===b||b,this._minZoom=a||0,this._maxZoom=s||22,this._minPitch=null==o?0:o,this._maxPitch=null==p?60:p,this.setMaxBounds(),this.width=0,this.height=0,this._center=new c.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Pu,this._posMatrixCache={},this._alignedPosMatrixCache={}},Va={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};sa.prototype.clone=function(){var a=new sa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.tileSize=this.tileSize,a.latRange=this.latRange,a.width=this.width,a.height=this.height,a._center=this._center,a.zoom=this.zoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._calcMatrices(),a},Va.minZoom.get=function(){return this._minZoom},Va.minZoom.set=function(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))},Va.maxZoom.get=function(){return this._maxZoom},Va.maxZoom.set=function(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))},Va.minPitch.get=function(){return this._minPitch},Va.minPitch.set=function(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))},Va.maxPitch.get=function(){return this._maxPitch},Va.maxPitch.set=function(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))},Va.renderWorldCopies.get=function(){return this._renderWorldCopies},Va.renderWorldCopies.set=function(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a},Va.worldSize.get=function(){return this.tileSize*this.scale},Va.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Va.size.get=function(){return new c.Point(this.width,this.height)},Va.bearing.get=function(){return-this.angle/Math.PI*180},Va.bearing.set=function(a){var s=-c.wrap(a,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=c.create$2(),c.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Va.pitch.get=function(){return this._pitch/Math.PI*180},Va.pitch.set=function(a){var s=c.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},Va.fov.get=function(){return this._fov/Math.PI*180},Va.fov.set=function(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())},Va.zoom.get=function(){return this._zoom},Va.zoom.set=function(a){var s=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},Va.center.get=function(){return this._center},Va.center.set=function(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())},Va.padding.get=function(){return this._edgeInsets.toJSON()},Va.padding.set=function(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())},Va.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},sa.prototype.isPaddingEqual=function(a){return this._edgeInsets.equals(a)},sa.prototype.interpolatePadding=function(a,s,o){this._unmodified=!1,this._edgeInsets.interpolate(a,s,o),this._constrain(),this._calcMatrices()},sa.prototype.coveringZoomLevel=function(a){var s=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,s)},sa.prototype.getVisibleUnwrappedCoordinates=function(a){var s=[new c.UnwrappedTileID(0,a)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new c.Point(0,0)),p=this.pointCoordinate(new c.Point(this.width,0)),b=this.pointCoordinate(new c.Point(this.width,this.height)),E=this.pointCoordinate(new c.Point(0,this.height)),A=Math.floor(Math.min(o.x,p.x,b.x,E.x)),F=Math.floor(Math.max(o.x,p.x,b.x,E.x)),$=A-1;$<=F+1;$++)0!==$&&s.push(new c.UnwrappedTileID($,a));return s},sa.prototype.coveringTiles=function(a){var s=this.coveringZoomLevel(a),o=s;if(void 0!==a.minzoom&&s<a.minzoom)return[];void 0!==a.maxzoom&&s>a.maxzoom&&(s=a.maxzoom);var p=c.MercatorCoordinate.fromLngLat(this.center),b=Math.pow(2,s),E=[b*p.x,b*p.y,0],A=Zl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),F=a.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(F=s);var $=function(Xr){return{aabb:new Gs([Xr*b,0,0],[(Xr+1)*b,b,0]),zoom:0,x:0,y:0,wrap:Xr,fullyVisible:!1}},ce=[],Ce=[],Ie=s,ke=a.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var et=1;et<=3;et++)ce.push($(-et)),ce.push($(et));for(ce.push($(0));ce.length>0;){var $e=ce.pop(),ft=$e.x,Ye=$e.y,lt=$e.fullyVisible;if(!lt){var Pt=$e.aabb.intersects(A);if(0===Pt)continue;lt=2===Pt}var Ht=$e.aabb.distanceX(E),hr=$e.aabb.distanceY(E),nr=Math.max(Math.abs(Ht),Math.abs(hr));if($e.zoom===Ie||nr>3+(1<<Ie-$e.zoom)-2&&$e.zoom>=F)Ce.push({tileID:new c.OverscaledTileID($e.zoom===Ie?ke:$e.zoom,$e.wrap,$e.zoom,ft,Ye),distanceSq:c.sqrLen([E[0]-.5-ft,E[1]-.5-Ye])});else for(var _r=0;_r<4;_r++){var Dr=(ft<<1)+_r%2,Qr=(Ye<<1)+(_r>>1);ce.push({aabb:$e.aabb.quadrant(_r),zoom:$e.zoom+1,x:Dr,y:Qr,wrap:$e.wrap,fullyVisible:lt})}}return Ce.sort(function(Xr,dn){return Xr.distanceSq-dn.distanceSq}).map(function(Xr){return Xr.tileID})},sa.prototype.resize=function(a,s){this.width=a,this.height=s,this.pixelsToGLUnits=[2/a,-2/s],this._constrain(),this._calcMatrices()},Va.unmodified.get=function(){return this._unmodified},sa.prototype.zoomScale=function(a){return Math.pow(2,a)},sa.prototype.scaleZoom=function(a){return Math.log(a)/Math.LN2},sa.prototype.project=function(a){var s=c.clamp(a.lat,-this.maxValidLatitude,this.maxValidLatitude);return new c.Point(c.mercatorXfromLng(a.lng)*this.worldSize,c.mercatorYfromLat(s)*this.worldSize)},sa.prototype.unproject=function(a){return new c.MercatorCoordinate(a.x/this.worldSize,a.y/this.worldSize).toLngLat()},Va.point.get=function(){return this.project(this.center)},sa.prototype.setLocationAtPoint=function(a,s){var o=this.pointCoordinate(s),p=this.pointCoordinate(this.centerPoint),b=this.locationCoordinate(a),E=new c.MercatorCoordinate(b.x-(o.x-p.x),b.y-(o.y-p.y));this.center=this.coordinateLocation(E),this._renderWorldCopies&&(this.center=this.center.wrap())},sa.prototype.locationPoint=function(a){return this.coordinatePoint(this.locationCoordinate(a))},sa.prototype.pointLocation=function(a){return this.coordinateLocation(this.pointCoordinate(a))},sa.prototype.locationCoordinate=function(a){return c.MercatorCoordinate.fromLngLat(a)},sa.prototype.coordinateLocation=function(a){return a.toLngLat()},sa.prototype.pointCoordinate=function(a){var s=[a.x,a.y,0,1],o=[a.x,a.y,1,1];c.transformMat4(s,s,this.pixelMatrixInverse),c.transformMat4(o,o,this.pixelMatrixInverse);var p=s[3],b=o[3],E=s[1]/p,A=o[1]/b,F=s[2]/p,$=o[2]/b,ce=F===$?0:(0-F)/($-F);return new c.MercatorCoordinate(c.number(s[0]/p,o[0]/b,ce)/this.worldSize,c.number(E,A,ce)/this.worldSize)},sa.prototype.coordinatePoint=function(a){var s=[a.x*this.worldSize,a.y*this.worldSize,0,1];return c.transformMat4(s,s,this.pixelMatrix),new c.Point(s[0]/s[3],s[1]/s[3])},sa.prototype.getBounds=function(){return(new c.LngLatBounds).extend(this.pointLocation(new c.Point(0,0))).extend(this.pointLocation(new c.Point(this.width,0))).extend(this.pointLocation(new c.Point(this.width,this.height))).extend(this.pointLocation(new c.Point(0,this.height)))},sa.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new c.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},sa.prototype.setMaxBounds=function(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},sa.prototype.calculatePosMatrix=function(a,s){void 0===s&&(s=!1);var o=a.key,p=s?this._alignedPosMatrixCache:this._posMatrixCache;if(p[o])return p[o];var b=a.canonical,E=this.worldSize/this.zoomScale(b.z),A=b.x+Math.pow(2,b.z)*a.wrap,F=c.identity(new Float64Array(16));return c.translate(F,F,[A*E,b.y*E,0]),c.scale(F,F,[E/c.EXTENT,E/c.EXTENT,1]),c.multiply(F,s?this.alignedProjMatrix:this.projMatrix,F),p[o]=new Float32Array(F),p[o]},sa.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},sa.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var a,s,o,p,b=-90,E=90,A=-180,F=180,$=this.size,ce=this._unmodified;if(this.latRange){var Ce=this.latRange;b=c.mercatorYfromLat(Ce[1])*this.worldSize,a=(E=c.mercatorYfromLat(Ce[0])*this.worldSize)-b<$.y?$.y/(E-b):0}if(this.lngRange){var Ie=this.lngRange;A=c.mercatorXfromLng(Ie[0])*this.worldSize,s=(F=c.mercatorXfromLng(Ie[1])*this.worldSize)-A<$.x?$.x/(F-A):0}var ke=this.point,et=Math.max(s||0,a||0);if(et)return this.center=this.unproject(new c.Point(s?(F+A)/2:ke.x,a?(E+b)/2:ke.y)),this.zoom+=this.scaleZoom(et),this._unmodified=ce,void(this._constraining=!1);if(this.latRange){var $e=ke.y,ft=$.y/2;$e-ft<b&&(p=b+ft),$e+ft>E&&(p=E-ft)}if(this.lngRange){var Ye=ke.x,lt=$.x/2;Ye-lt<A&&(o=A+lt),Ye+lt>F&&(o=F-lt)}void 0===o&&void 0===p||(this.center=this.unproject(new c.Point(void 0!==o?o:ke.x,void 0!==p?p:ke.y))),this._unmodified=ce,this._constraining=!1}},sa.prototype._calcMatrices=function(){if(this.height){var a=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+a.y/this.height),p=Math.sin(o)*this.cameraToCenterDistance/Math.sin(c.clamp(Math.PI-s-o,.01,Math.PI-.01)),b=this.point,E=b.x,A=b.y,F=1.01*(Math.cos(Math.PI/2-this._pitch)*p+this.cameraToCenterDistance),$=this.height/50,ce=new Float64Array(16);c.perspective(ce,this._fov,this.width/this.height,$,F),ce[8]=2*-a.x/this.width,ce[9]=2*a.y/this.height,c.scale(ce,ce,[1,-1,1]),c.translate(ce,ce,[0,0,-this.cameraToCenterDistance]),c.rotateX(ce,ce,this._pitch),c.rotateZ(ce,ce,this.angle),c.translate(ce,ce,[-E,-A,0]),this.mercatorMatrix=c.scale([],ce,[this.worldSize,this.worldSize,this.worldSize]),c.scale(ce,ce,[1,1,c.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ce,this.invProjMatrix=c.invert([],this.projMatrix);var Ce=this.width%2/2,Ie=this.height%2/2,ke=Math.cos(this.angle),et=Math.sin(this.angle),$e=E-Math.round(E)+ke*Ce+et*Ie,ft=A-Math.round(A)+ke*Ie+et*Ce,Ye=new Float64Array(ce);if(c.translate(Ye,Ye,[$e>.5?$e-1:$e,ft>.5?ft-1:ft,0]),this.alignedProjMatrix=Ye,ce=c.create(),c.scale(ce,ce,[this.width/2,-this.height/2,1]),c.translate(ce,ce,[1,-1,0]),this.labelPlaneMatrix=ce,ce=c.create(),c.scale(ce,ce,[1,-1,1]),c.translate(ce,ce,[-1,-1,0]),c.scale(ce,ce,[2/this.width,2/this.height,1]),this.glCoordMatrix=ce,this.pixelMatrix=c.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ce=c.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ce,this._posMatrixCache={},this._alignedPosMatrixCache={}}},sa.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var a=this.pointCoordinate(new c.Point(0,0)),s=[a.x*this.worldSize,a.y*this.worldSize,0,1];return c.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},sa.prototype.getCameraPoint=function(){var a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.Point(0,a))},sa.prototype.getCameraQueryGeometry=function(a){var s=this.getCameraPoint();if(1===a.length)return[a[0],s];for(var o=s.x,p=s.y,b=s.x,E=s.y,A=0,F=a;A<F.length;A+=1){var $=F[A];o=Math.min(o,$.x),p=Math.min(p,$.y),b=Math.max(b,$.x),E=Math.max(E,$.y)}return[new c.Point(o,p),new c.Point(b,p),new c.Point(b,E),new c.Point(o,E),new c.Point(o,p)]},Object.defineProperties(sa.prototype,Va);var ws=function(a){var s,o,p,b;this._hashName=a&&encodeURIComponent(a),c.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,p=null,b=function(){p=null,o&&(s(),p=setTimeout(b,300),o=!1)},function(){return o=!0,p||b(),p})};ws.prototype.addTo=function(a){return this._map=a,c.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},ws.prototype.remove=function(){return c.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},ws.prototype.getHashString=function(a){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,p=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,p),E=Math.round(s.lng*b)/b,A=Math.round(s.lat*b)/b,F=this._map.getBearing(),$=this._map.getPitch(),ce="";if(ce+=a?"/"+E+"/"+A+"/"+o:o+"/"+A+"/"+E,(F||$)&&(ce+="/"+Math.round(10*F)/10),$&&(ce+="/"+Math.round($)),this._hashName){var Ce=this._hashName,Ie=!1,ke=c.window.location.hash.slice(1).split("&").map(function(et){var $e=et.split("=")[0];return $e===Ce?(Ie=!0,$e+"="+ce):et}).filter(function(et){return et});return Ie||ke.push(Ce+"="+ce),"#"+ke.join("&")}return"#"+ce},ws.prototype._getCurrentHash=function(){var a,s=this,o=c.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(p){return p.split("=")}).forEach(function(p){p[0]===s._hashName&&(a=p)}),(a&&a[1]||"").split("/")):o.split("/")},ws.prototype._onHashChange=function(){var a=this._getCurrentHash();if(a.length>=3&&!a.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:s,pitch:+(a[4]||0)}),!0}return!1},ws.prototype._updateHashUnthrottled=function(){var a=c.window.location.href.replace(/(#.+)?$/,this.getHashString());try{c.window.history.replaceState(c.window.history.state,null,a)}catch(s){}};var Ul={linearity:.3,easing:c.bezier(0,0,.3,1)},Uu=c.extend({deceleration:2500,maxSpeed:1400},Ul),Mc=c.extend({deceleration:20,maxSpeed:1400},Ul),Ta=c.extend({deceleration:1e3,maxSpeed:360},Ul),lf=c.extend({deceleration:1e3,maxSpeed:90},Ul),jl=function(a){this._map=a,this.clear()};function ml(a,s){(!a.duration||a.duration<s.duration)&&(a.duration=s.duration,a.easing=s.easing)}function _u(a,s,o){var p=o.maxSpeed,b=o.linearity,E=o.deceleration,A=c.clamp(a*b/(s/1e3),-p,p),F=Math.abs(A)/(E*b);return{easing:o.easing,duration:1e3*F,amount:A*(F/2)}}jl.prototype.clear=function(){this._inertiaBuffer=[]},jl.prototype.record=function(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:c.browser.now(),settings:a})},jl.prototype._drainInertiaBuffer=function(){for(var a=this._inertiaBuffer,s=c.browser.now();a.length>0&&s-a[0].time>160;)a.shift()},jl.prototype._onMoveEnd=function(a){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new c.Point(0,0),pinchAround:void 0,around:void 0},o=0,p=this._inertiaBuffer;o<p.length;o+=1){var b=p[o].settings;s.zoom+=b.zoomDelta||0,s.bearing+=b.bearingDelta||0,s.pitch+=b.pitchDelta||0,b.panDelta&&s.pan._add(b.panDelta),b.around&&(s.around=b.around),b.pinchAround&&(s.pinchAround=b.pinchAround)}var E=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,A={};if(s.pan.mag()){var F=_u(s.pan.mag(),E,c.extend({},Uu,a||{}));A.offset=s.pan.mult(F.amount/s.pan.mag()),A.center=this._map.transform.center,ml(A,F)}if(s.zoom){var $=_u(s.zoom,E,Mc);A.zoom=this._map.transform.zoom+$.amount,ml(A,$)}if(s.bearing){var ce=_u(s.bearing,E,Ta);A.bearing=this._map.transform.bearing+c.clamp(ce.amount,-179,179),ml(A,ce)}if(s.pitch){var Ce=_u(s.pitch,E,lf);A.pitch=this._map.transform.pitch+Ce.amount,ml(A,Ce)}if(A.zoom||A.bearing){var Ie=void 0===s.pinchAround?s.around:s.pinchAround;A.around=Ie?this._map.unproject(Ie):this._map.getCenter()}return this.clear(),c.extend(A,{noMoveStart:!0})}};var So=function(a){function s(p,b,E,A){void 0===A&&(A={});var F=O.mousePos(b.getCanvasContainer(),E),$=b.unproject(F);a.call(this,p,c.extend({point:F,lngLat:$,originalEvent:E},A)),this._defaultPrevented=!1,this.target=b}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(c.Event),gl=function(a){function s(p,b,E){var A="touchend"===p?E.changedTouches:E.touches,F=O.touchPos(b.getCanvasContainer(),A),$=F.map(function(Ie){return b.unproject(Ie)}),ce=F.reduce(function(Ie,ke,et,$e){return Ie.add(ke.div($e.length))},new c.Point(0,0)),Ce=b.unproject(ce);a.call(this,p,{points:F,point:ce,lngLats:$,lngLat:Ce,originalEvent:E}),this._defaultPrevented=!1}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(c.Event),yl=function(a){function s(p,b,E){a.call(this,p,{originalEvent:E}),this._defaultPrevented=!1}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(c.Event),Ro=function(a,s){this._map=a,this._clickTolerance=s.clickTolerance};Ro.prototype.reset=function(){delete this._mousedownPos},Ro.prototype.wheel=function(a){return this._firePreventable(new yl(a.type,this._map,a))},Ro.prototype.mousedown=function(a,s){return this._mousedownPos=s,this._firePreventable(new So(a.type,this._map,a))},Ro.prototype.mouseup=function(a){this._map.fire(new So(a.type,this._map,a))},Ro.prototype.click=function(a,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new So(a.type,this._map,a))},Ro.prototype.dblclick=function(a){return this._firePreventable(new So(a.type,this._map,a))},Ro.prototype.mouseover=function(a){this._map.fire(new So(a.type,this._map,a))},Ro.prototype.mouseout=function(a){this._map.fire(new So(a.type,this._map,a))},Ro.prototype.touchstart=function(a){return this._firePreventable(new gl(a.type,this._map,a))},Ro.prototype.touchmove=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype.touchend=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype.touchcancel=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype._firePreventable=function(a){if(this._map.fire(a),a.defaultPrevented)return{}},Ro.prototype.isEnabled=function(){return!0},Ro.prototype.isActive=function(){return!1},Ro.prototype.enable=function(){},Ro.prototype.disable=function(){};var Nn=function(a){this._map=a};Nn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Nn.prototype.mousemove=function(a){this._map.fire(new So(a.type,this._map,a))},Nn.prototype.mousedown=function(){this._delayContextMenu=!0},Nn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new So("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Nn.prototype.contextmenu=function(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new So(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()},Nn.prototype.isEnabled=function(){return!0},Nn.prototype.isActive=function(){return!1},Nn.prototype.enable=function(){},Nn.prototype.disable=function(){};var za=function(a,s){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=s.clickTolerance||1};function ju(a,s){for(var o={},p=0;p<a.length;p++)o[a[p].identifier]=s[p];return o}za.prototype.isEnabled=function(){return!!this._enabled},za.prototype.isActive=function(){return!!this._active},za.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},za.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},za.prototype.mousedown=function(a,s){this.isEnabled()&&a.shiftKey&&0===a.button&&(O.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},za.prototype.mousemoveWindow=function(a,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var p=this._startPos;this._lastPos=o,this._box||(this._box=O.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));var b=Math.min(p.x,o.x),E=Math.max(p.x,o.x),A=Math.min(p.y,o.y),F=Math.max(p.y,o.y);O.setTransform(this._box,"translate("+b+"px,"+A+"px)"),this._box.style.width=E-b+"px",this._box.style.height=F-A+"px"}}},za.prototype.mouseupWindow=function(a,s){var o=this;if(this._active&&0===a.button){var p=this._startPos,b=s;if(this.reset(),O.suppressClick(),p.x!==b.x||p.y!==b.y)return this._map.fire(new c.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:function(E){return E.fitScreenCoordinates(p,b,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",a)}},za.prototype.keydown=function(a){this._active&&27===a.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",a))},za.prototype.blur=function(){this.reset()},za.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(O.remove(this._box),this._box=null),O.enableDrag(),delete this._startPos,delete this._lastPos},za.prototype._fireEvent=function(a,s){return this._map.fire(new c.Event(a,{originalEvent:s}))};var _l=function(a){this.reset(),this.numTouches=a.numTouches};_l.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},_l.prototype.touchstart=function(a,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=a.timeStamp),o.length===this.numTouches&&(this.centroid=function(p){for(var b=new c.Point(0,0),E=0,A=p;E<A.length;E+=1)b._add(A[E]);return b.div(p.length)}(s),this.touches=ju(o,s)))},_l.prototype.touchmove=function(a,s,o){if(!this.aborted&&this.centroid){var p=ju(o,s);for(var b in this.touches){var E=p[b];(!E||E.dist(this.touches[b])>30)&&(this.aborted=!0)}}},_l.prototype.touchend=function(a,s,o){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),0===o.length){var p=!this.aborted&&this.centroid;if(this.reset(),p)return p}};var iu=function(a){this.singleTap=new _l(a),this.numTaps=a.numTaps,this.reset()};iu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},iu.prototype.touchstart=function(a,s,o){this.singleTap.touchstart(a,s,o)},iu.prototype.touchmove=function(a,s,o){this.singleTap.touchmove(a,s,o)},iu.prototype.touchend=function(a,s,o){var p=this.singleTap.touchend(a,s,o);if(p){var b=a.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(p)<30;if(b&&E||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}};var Es=function(){this._zoomIn=new iu({numTouches:1,numTaps:2}),this._zoomOut=new iu({numTouches:2,numTaps:1}),this.reset()};Es.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Es.prototype.touchstart=function(a,s,o){this._zoomIn.touchstart(a,s,o),this._zoomOut.touchstart(a,s,o)},Es.prototype.touchmove=function(a,s,o){this._zoomIn.touchmove(a,s,o),this._zoomOut.touchmove(a,s,o)},Es.prototype.touchend=function(a,s,o){var p=this,b=this._zoomIn.touchend(a,s,o),E=this._zoomOut.touchend(a,s,o);return b?(this._active=!0,a.preventDefault(),setTimeout(function(){return p.reset()},0),{cameraAnimation:function(A){return A.easeTo({duration:300,zoom:A.getZoom()+1,around:A.unproject(b)},{originalEvent:a})}}):E?(this._active=!0,a.preventDefault(),setTimeout(function(){return p.reset()},0),{cameraAnimation:function(A){return A.easeTo({duration:300,zoom:A.getZoom()-1,around:A.unproject(E)},{originalEvent:a})}}):void 0},Es.prototype.touchcancel=function(){this.reset()},Es.prototype.enable=function(){this._enabled=!0},Es.prototype.disable=function(){this._enabled=!1,this.reset()},Es.prototype.isEnabled=function(){return this._enabled},Es.prototype.isActive=function(){return this._active};var Xc={0:1,2:2},hn=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};hn.prototype.blur=function(){this.reset()},hn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},hn.prototype._correctButton=function(a,s){return!1},hn.prototype._move=function(a,s){return{}},hn.prototype.mousedown=function(a,s){if(!this._lastPoint){var o=O.mouseButton(a);this._correctButton(a,o)&&(this._lastPoint=s,this._eventButton=o)}},hn.prototype.mousemoveWindow=function(a,s){var p,E,o=this._lastPoint;if(o)if(a.preventDefault(),E=Xc[this._eventButton],void 0===(p=a).buttons||(p.buttons&E)!==E)this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)},hn.prototype.mouseupWindow=function(a){this._lastPoint&&O.mouseButton(a)===this._eventButton&&(this._moved&&O.suppressClick(),this.reset())},hn.prototype.enable=function(){this._enabled=!0},hn.prototype.disable=function(){this._enabled=!1,this.reset()},hn.prototype.isEnabled=function(){return this._enabled},hn.prototype.isActive=function(){return this._active};var Kc=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.mousedown=function(o,p){a.prototype.mousedown.call(this,o,p),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,p){return 0===p&&!o.ctrlKey},s.prototype._move=function(o,p){return{around:p,panDelta:p.sub(o)}},s}(hn),Oc=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype._correctButton=function(o,p){return 0===p&&o.ctrlKey||2===p},s.prototype._move=function(o,p){var b=.8*(p.x-o.x);if(b)return this._active=!0,{bearingDelta:b}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(hn),xl=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype._correctButton=function(o,p){return 0===p&&o.ctrlKey||2===p},s.prototype._move=function(o,p){var b=-.5*(p.y-o.y);if(b)return this._active=!0,{pitchDelta:b}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(hn),Ga=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};Ga.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new c.Point(0,0)},Ga.prototype.touchstart=function(a,s,o){return this._calculateTransform(a,s,o)},Ga.prototype.touchmove=function(a,s,o){if(this._active&&!(o.length<this._minTouches))return a.preventDefault(),this._calculateTransform(a,s,o)},Ga.prototype.touchend=function(a,s,o){this._calculateTransform(a,s,o),this._active&&o.length<this._minTouches&&this.reset()},Ga.prototype.touchcancel=function(){this.reset()},Ga.prototype._calculateTransform=function(a,s,o){o.length>0&&(this._active=!0);var p=ju(o,s),b=new c.Point(0,0),E=new c.Point(0,0),A=0;for(var F in p){var $=p[F],ce=this._touches[F];ce&&(b._add($),E._add($.sub(ce)),A++,p[F]=$)}if(this._touches=p,!(A<this._minTouches)&&E.mag()){var Ce=E.div(A);if(this._sum._add(Ce),!(this._sum.mag()<this._clickTolerance))return{around:b.div(A),panDelta:Ce}}},Ga.prototype.enable=function(){this._enabled=!0},Ga.prototype.disable=function(){this._enabled=!1,this.reset()},Ga.prototype.isEnabled=function(){return this._enabled},Ga.prototype.isActive=function(){return this._active};var Ts=function(){this.reset()};function sc(a,s,o){for(var p=0;p<a.length;p++)if(a[p].identifier===o)return s[p]}function au(a,s){return Math.log(a/s)/Math.LN2}Ts.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ts.prototype._start=function(a){},Ts.prototype._move=function(a,s,o){return{}},Ts.prototype.touchstart=function(a,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Ts.prototype.touchmove=function(a,s,o){if(this._firstTwoTouches){a.preventDefault();var p=this._firstTwoTouches,b=p[1],E=sc(o,s,p[0]),A=sc(o,s,b);if(E&&A){var F=this._aroundCenter?null:E.add(A).div(2);return this._move([E,A],F,a)}}},Ts.prototype.touchend=function(a,s,o){if(this._firstTwoTouches){var p=this._firstTwoTouches,b=p[1],E=sc(o,s,p[0]),A=sc(o,s,b);E&&A||(this._active&&O.suppressClick(),this.reset())}},Ts.prototype.touchcancel=function(){this.reset()},Ts.prototype.enable=function(a){this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around},Ts.prototype.disable=function(){this._enabled=!1,this.reset()},Ts.prototype.isEnabled=function(){return this._enabled},Ts.prototype.isActive=function(){return this._active};var Ds=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,p){var b=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(au(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:au(this._distance,b),pinchAround:p}},s}(Ts);function Hs(a,s){return 180*a.angleWith(s)/Math.PI}var Tf=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,p){var b=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Hs(this._vector,b),pinchAround:p}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var p=25/(Math.PI*this._minDiameter)*360,b=Hs(o,this._startVector);return Math.abs(b)<p},s}(Ts);function uc(a){return Math.abs(a.y)>Math.abs(a.x)}var cf=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,uc(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,p,b){var E=o[0].sub(this._lastPoints[0]),A=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(E,A,b.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(E.y+A.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,p,b){if(void 0!==this._valid)return this._valid;var E=o.mag()>=2,A=p.mag()>=2;if(E||A){if(!E||!A)return void 0===this._firstMove&&(this._firstMove=b),b-this._firstMove<100&&void 0;var F=o.y>0==p.y>0;return uc(o)&&uc(p)&&F}},s}(Ts),Lc={panStep:100,bearingStep:15,pitchStep:10},Ws=function(){var a=Lc;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1};function Cs(a){return a*(2-a)}Ws.prototype.blur=function(){this.reset()},Ws.prototype.reset=function(){this._active=!1},Ws.prototype.keydown=function(a){var s=this;if(!(a.altKey||a.ctrlKey||a.metaKey)){var o=0,p=0,b=0,E=0,A=0;switch(a.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:a.shiftKey?p=-1:(a.preventDefault(),E=-1);break;case 39:a.shiftKey?p=1:(a.preventDefault(),E=1);break;case 38:a.shiftKey?b=1:(a.preventDefault(),A=-1);break;case 40:a.shiftKey?b=-1:(a.preventDefault(),A=1);break;default:return}return this._rotationDisabled&&(p=0,b=0),{cameraAnimation:function(F){var $=F.getZoom();F.easeTo({duration:300,easeId:"keyboardHandler",easing:Cs,zoom:o?Math.round($)+o*(a.shiftKey?2:1):$,bearing:F.getBearing()+p*s._bearingStep,pitch:F.getPitch()+b*s._pitchStep,offset:[-E*s._panStep,-A*s._panStep],center:F.getCenter()},{originalEvent:a})}}}},Ws.prototype.enable=function(){this._enabled=!0},Ws.prototype.disable=function(){this._enabled=!1,this.reset()},Ws.prototype.isEnabled=function(){return this._enabled},Ws.prototype.isActive=function(){return this._active},Ws.prototype.disableRotation=function(){this._rotationDisabled=!0},Ws.prototype.enableRotation=function(){this._rotationDisabled=!1};var $i=function(a,s){this._map=a,this._el=a.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,c.bindAll(["_onTimeout"],this)};$i.prototype.setZoomRate=function(a){this._defaultZoomRate=a},$i.prototype.setWheelZoomRate=function(a){this._wheelZoomRate=a},$i.prototype.isEnabled=function(){return!!this._enabled},$i.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},$i.prototype.isZooming=function(){return!!this._zooming},$i.prototype.enable=function(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},$i.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},$i.prototype.wheel=function(a){if(this.isEnabled()){var s=a.deltaMode===c.window.WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY,o=c.browser.now(),p=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==s&&s%4.000244140625==0?this._type="wheel":0!==s&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),a.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=a,this._delta-=s,this._active||this._start(a)),a.preventDefault()}},$i.prototype._onTimeout=function(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)},$i.prototype._start=function(a){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=O.mousePos(this._el,a);this._around=c.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},$i.prototype.renderFrame=function(){var a=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(0!==this._delta){var o="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,p=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&0!==p&&(p=1/p);var b="number"==typeof this._targetZoom?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(b*p))),"wheel"===this._type&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var E,A="number"==typeof this._targetZoom?this._targetZoom:s.zoom,F=this._startZoom,$=this._easing,ce=!1;if("wheel"===this._type&&F&&$){var Ce=Math.min((c.browser.now()-this._lastWheelEventTime)/200,1),Ie=$(Ce);E=c.number(F,A,Ie),Ce<1?this._frameId||(this._frameId=!0):ce=!0}else E=A,ce=!0;return this._active=!0,ce&&(this._active=!1,this._finishTimeout=setTimeout(function(){a._zooming=!1,a._handler._triggerRenderFrame(),delete a._targetZoom,delete a._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ce,zoomDelta:E-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},$i.prototype._smoothOutEasing=function(a){var s=c.ease;if(this._prevEase){var o=this._prevEase,p=(c.browser.now()-o.start)/o.duration,b=o.easing(p+.01)-o.easing(p),E=.27/Math.sqrt(b*b+1e-4)*.01,A=Math.sqrt(.0729-E*E);s=c.bezier(E,A,.25,1)}return this._prevEase={start:c.browser.now(),duration:a,easing:s},s},$i.prototype.blur=function(){this.reset()},$i.prototype.reset=function(){this._active=!1};var xu=function(a,s){this._clickZoom=a,this._tapZoom=s};xu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},xu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},xu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},xu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Bs=function(){this.reset()};Bs.prototype.reset=function(){this._active=!1},Bs.prototype.blur=function(){this.reset()},Bs.prototype.dblclick=function(a,s){return a.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(a.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:a})}}},Bs.prototype.enable=function(){this._enabled=!0},Bs.prototype.disable=function(){this._enabled=!1,this.reset()},Bs.prototype.isEnabled=function(){return this._enabled},Bs.prototype.isActive=function(){return this._active};var Ko=function(){this._tap=new iu({numTouches:1,numTaps:1}),this.reset()};Ko.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Ko.prototype.touchstart=function(a,s,o){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(a,s,o))},Ko.prototype.touchmove=function(a,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var p=s[0],b=p.y-this._swipePoint.y;return this._swipePoint=p,a.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(a,s,o)},Ko.prototype.touchend=function(a,s,o){this._tapTime?this._swipePoint&&0===o.length&&this.reset():this._tap.touchend(a,s,o)&&(this._tapTime=a.timeStamp)},Ko.prototype.touchcancel=function(){this.reset()},Ko.prototype.enable=function(){this._enabled=!0},Ko.prototype.disable=function(){this._enabled=!1,this.reset()},Ko.prototype.isEnabled=function(){return this._enabled},Ko.prototype.isActive=function(){return this._active};var nl=function(a,s,o){this._el=a,this._mousePan=s,this._touchPan=o};nl.prototype.enable=function(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},nl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},nl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},nl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var bu=function(a,s,o){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};bu.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},bu.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},bu.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},bu.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ou=function(a,s,o,p){this._el=a,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0};ou.prototype.enable=function(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ou.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ou.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ou.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ou.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ou.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var mo=function(a){return a.zoom||a.drag||a.pitch||a.rotate},il=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s}(c.Event);function ri(a){return a.panDelta&&a.panDelta.mag()||a.zoomDelta||a.bearingDelta||a.pitchDelta}var In=function(a,s){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new jl(a),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),c.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[c.window.document,"mousemove",{capture:!0}],[c.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[c.window,"blur",void 0]];for(var p=0,b=this._listeners;p<b.length;p+=1){var E=b[p],A=E[0];O.addEventListener(A,E[1],A===c.window.document?this.handleWindowEvent:this.handleEvent,E[2])}};In.prototype.destroy=function(){for(var a=0,s=this._listeners;a<s.length;a+=1){var o=s[a],p=o[0];O.removeEventListener(p,o[1],p===c.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},In.prototype._addDefaultHandlers=function(a){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new Ro(s,a));var p=s.boxZoom=new za(s,a);this._add("boxZoom",p);var b=new Es,E=new Bs;s.doubleClickZoom=new xu(E,b),this._add("tapZoom",b),this._add("clickZoom",E);var A=new Ko;this._add("tapDragZoom",A);var F=s.touchPitch=new cf;this._add("touchPitch",F);var $=new Oc(a),ce=new xl(a);s.dragRotate=new bu(a,$,ce),this._add("mouseRotate",$,["mousePitch"]),this._add("mousePitch",ce,["mouseRotate"]);var Ce=new Kc(a),Ie=new Ga(a);s.dragPan=new nl(o,Ce,Ie),this._add("mousePan",Ce),this._add("touchPan",Ie,["touchZoom","touchRotate"]);var ke=new Tf,et=new Ds;s.touchZoomRotate=new ou(o,et,ke,A),this._add("touchRotate",ke,["touchPan","touchZoom"]),this._add("touchZoom",et,["touchPan","touchRotate"]);var $e=s.scrollZoom=new $i(s,this);this._add("scrollZoom",$e,["mousePan"]);var ft=s.keyboard=new Ws;this._add("keyboard",ft),this._add("blockableMapEvent",new Nn(s));for(var Ye=0,lt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Ye<lt.length;Ye+=1){var Pt=lt[Ye];a.interactive&&a[Pt]&&s[Pt].enable(a[Pt])}},In.prototype._add=function(a,s,o){this._handlers.push({handlerName:a,handler:s,allowed:o}),this._handlersById[a]=s},In.prototype.stop=function(a){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}},In.prototype.isActive=function(){for(var a=0,s=this._handlers;a<s.length;a+=1)if(s[a].handler.isActive())return!0;return!1},In.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},In.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},In.prototype.isMoving=function(){return Boolean(mo(this._eventsInProgress))||this.isZooming()},In.prototype._blockedByActive=function(a,s,o){for(var p in a)if(p!==o&&(!s||s.indexOf(p)<0))return!0;return!1},In.prototype.handleWindowEvent=function(a){this.handleEvent(a,a.type+"Window")},In.prototype._getMapTouches=function(a){for(var s=[],o=0,p=a;o<p.length;o+=1){var b=p[o];this._el.contains(b.target)&&s.push(b)}return s},In.prototype.handleEvent=function(a,s){this._updatingCamera=!0;for(var o="renderFrame"===a.type?void 0:a,p={needsRenderFrame:!1},b={},E={},A=a.touches?this._getMapTouches(a.touches):void 0,F=A?O.touchPos(this._el,A):O.mousePos(this._el,a),$=0,ce=this._handlers;$<ce.length;$+=1){var Ce=ce[$],Ie=Ce.handlerName,ke=Ce.handler,et=Ce.allowed;if(ke.isEnabled()){var $e=void 0;this._blockedByActive(E,et,Ie)?ke.reset():ke[s||a.type]&&($e=ke[s||a.type](a,F,A),this.mergeHandlerResult(p,b,$e,Ie,o),$e&&$e.needsRenderFrame&&this._triggerRenderFrame()),($e||ke.isActive())&&(E[Ie]=ke)}}var ft={};for(var Ye in this._previousActiveHandlers)E[Ye]||(ft[Ye]=o);this._previousActiveHandlers=E,(Object.keys(ft).length||ri(p))&&(this._changes.push([p,b,ft]),this._triggerRenderFrame()),(Object.keys(E).length||ri(p))&&this._map._stop(!0),this._updatingCamera=!1;var lt=p.cameraAnimation;lt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],lt(this._map))},In.prototype.mergeHandlerResult=function(a,s,o,p,b){if(o){c.extend(a,o);var E={handlerName:p,originalEvent:o.originalEvent||b};void 0!==o.zoomDelta&&(s.zoom=E),void 0!==o.panDelta&&(s.drag=E),void 0!==o.pitchDelta&&(s.pitch=E),void 0!==o.bearingDelta&&(s.rotate=E)}},In.prototype._applyChanges=function(){for(var a={},s={},o={},p=0,b=this._changes;p<b.length;p+=1){var E=b[p],A=E[0],F=E[1],$=E[2];A.panDelta&&(a.panDelta=(a.panDelta||new c.Point(0,0))._add(A.panDelta)),A.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+A.zoomDelta),A.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+A.bearingDelta),A.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+A.pitchDelta),void 0!==A.around&&(a.around=A.around),void 0!==A.pinchAround&&(a.pinchAround=A.pinchAround),A.noInertia&&(a.noInertia=A.noInertia),c.extend(s,F),c.extend(o,$)}this._updateMapTransform(a,s,o),this._changes=[]},In.prototype._updateMapTransform=function(a,s,o){var p=this._map,b=p.transform;if(!ri(a))return this._fireEvents(s,o,!0);var E=a.panDelta,A=a.zoomDelta,F=a.bearingDelta,$=a.pitchDelta,ce=a.around,Ce=a.pinchAround;void 0!==Ce&&(ce=Ce),p._stop(!0),ce=ce||p.transform.centerPoint;var Ie=b.pointLocation(E?ce.sub(E):ce);F&&(b.bearing+=F),$&&(b.pitch+=$),A&&(b.zoom+=A),b.setLocationAtPoint(Ie,ce),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(s,o,!0)},In.prototype._fireEvents=function(a,s,o){var p=this,b=mo(this._eventsInProgress),E=mo(a),A={};for(var F in a)this._eventsInProgress[F]||(A[F+"start"]=a[F].originalEvent),this._eventsInProgress[F]=a[F];for(var $ in!b&&E&&this._fireEvent("movestart",E.originalEvent),A)this._fireEvent($,A[$]);for(var ce in E&&this._fireEvent("move",E.originalEvent),a)this._fireEvent(ce,a[ce].originalEvent);var Ce,Ie={};for(var ke in this._eventsInProgress){var et=this._eventsInProgress[ke],$e=et.handlerName,ft=et.originalEvent;this._handlersById[$e].isActive()||(delete this._eventsInProgress[ke],Ie[ke+"end"]=Ce=s[$e]||ft)}for(var Ye in Ie)this._fireEvent(Ye,Ie[Ye]);var lt=mo(this._eventsInProgress);if(o&&(b||E)&&!lt){this._updatingCamera=!0;var Pt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Ht=function(hr){return 0!==hr&&-p._bearingSnap<hr&&hr<p._bearingSnap};Pt?(Ht(Pt.bearing||this._map.getBearing())&&(Pt.bearing=0),this._map.easeTo(Pt,{originalEvent:Ce})):(this._map.fire(new c.Event("moveend",{originalEvent:Ce})),Ht(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},In.prototype._fireEvent=function(a,s){this._map.fire(new c.Event(a,s?{originalEvent:s}:{}))},In.prototype._requestFrame=function(){var a=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete a._frameId,a.handleEvent(new il("renderFrame",{timeStamp:s})),a._applyChanges()})},In.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var lc=function(a){function s(o,p){a.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=p.bearingSnap,c.bindAll(["_renderFrameCallback"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getCenter=function(){return new c.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,p){return this.jumpTo({center:o},p)},s.prototype.panBy=function(o,p,b){return o=c.Point.convert(o).mult(-1),this.panTo(this.transform.center,c.extend({offset:o},p),b)},s.prototype.panTo=function(o,p,b){return this.easeTo(c.extend({center:o},p),b)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,p){return this.jumpTo({zoom:o},p),this},s.prototype.zoomTo=function(o,p,b){return this.easeTo(c.extend({zoom:o},p),b)},s.prototype.zoomIn=function(o,p){return this.zoomTo(this.getZoom()+1,o,p),this},s.prototype.zoomOut=function(o,p){return this.zoomTo(this.getZoom()-1,o,p),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,p){return this.jumpTo({bearing:o},p),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,p){return this.jumpTo({padding:o},p),this},s.prototype.rotateTo=function(o,p,b){return this.easeTo(c.extend({bearing:o},p),b)},s.prototype.resetNorth=function(o,p){return this.rotateTo(0,c.extend({duration:1e3},o),p),this},s.prototype.resetNorthPitch=function(o,p){return this.easeTo(c.extend({bearing:0,pitch:0,duration:1e3},o),p),this},s.prototype.snapToNorth=function(o,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,p):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,p){return this.jumpTo({pitch:o},p),this},s.prototype.cameraForBounds=function(o,p){o=c.LngLatBounds.convert(o);var b=p&&p.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),b,p)},s.prototype._cameraForBoxAndBearing=function(o,p,b,E){var A={top:0,bottom:0,right:0,left:0};if("number"==typeof(E=c.extend({padding:A,offset:[0,0],maxZoom:this.transform.maxZoom},E)).padding){var F=E.padding;E.padding={top:F,bottom:F,right:F,left:F}}E.padding=c.extend(A,E.padding);var $=this.transform,ce=$.padding,Ce=$.project(c.LngLat.convert(o)),Ie=$.project(c.LngLat.convert(p)),ke=Ce.rotate(-b*Math.PI/180),et=Ie.rotate(-b*Math.PI/180),$e=new c.Point(Math.max(ke.x,et.x),Math.max(ke.y,et.y)),ft=new c.Point(Math.min(ke.x,et.x),Math.min(ke.y,et.y)),Ye=$e.sub(ft),lt=($.width-(ce.left+ce.right+E.padding.left+E.padding.right))/Ye.x,Pt=($.height-(ce.top+ce.bottom+E.padding.top+E.padding.bottom))/Ye.y;if(!(Pt<0||lt<0)){var Ht=Math.min($.scaleZoom($.scale*Math.min(lt,Pt)),E.maxZoom),hr="number"==typeof E.offset.x?new c.Point(E.offset.x,E.offset.y):c.Point.convert(E.offset),nr=new c.Point((E.padding.left-E.padding.right)/2,(E.padding.top-E.padding.bottom)/2).rotate(b*Math.PI/180),_r=hr.add(nr).mult($.scale/$.zoomScale(Ht));return{center:$.unproject(Ce.add(Ie).div(2).sub(_r)),zoom:Ht,bearing:b}}c.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,p,b){return this._fitInternal(this.cameraForBounds(o,p),p,b)},s.prototype.fitScreenCoordinates=function(o,p,b,E,A){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(c.Point.convert(o)),this.transform.pointLocation(c.Point.convert(p)),b,E),E,A)},s.prototype._fitInternal=function(o,p,b){return o?(delete(p=c.extend(o,p)).padding,p.linear?this.easeTo(p,b):this.flyTo(p,b)):this},s.prototype.jumpTo=function(o,p){this.stop();var b=this.transform,E=!1,A=!1,F=!1;return"zoom"in o&&b.zoom!==+o.zoom&&(E=!0,b.zoom=+o.zoom),void 0!==o.center&&(b.center=c.LngLat.convert(o.center)),"bearing"in o&&b.bearing!==+o.bearing&&(A=!0,b.bearing=+o.bearing),"pitch"in o&&b.pitch!==+o.pitch&&(F=!0,b.pitch=+o.pitch),null==o.padding||b.isPaddingEqual(o.padding)||(b.padding=o.padding),this.fire(new c.Event("movestart",p)).fire(new c.Event("move",p)),E&&this.fire(new c.Event("zoomstart",p)).fire(new c.Event("zoom",p)).fire(new c.Event("zoomend",p)),A&&this.fire(new c.Event("rotatestart",p)).fire(new c.Event("rotate",p)).fire(new c.Event("rotateend",p)),F&&this.fire(new c.Event("pitchstart",p)).fire(new c.Event("pitch",p)).fire(new c.Event("pitchend",p)),this.fire(new c.Event("moveend",p))},s.prototype.easeTo=function(o,p){var b=this;this._stop(!1,o.easeId),(!1===(o=c.extend({offset:[0,0],duration:500,easing:c.ease},o)).animate||!o.essential&&c.browser.prefersReducedMotion)&&(o.duration=0);var E=this.transform,A=this.getZoom(),F=this.getBearing(),$=this.getPitch(),ce=this.getPadding(),Ce="zoom"in o?+o.zoom:A,Ie="bearing"in o?this._normalizeBearing(o.bearing,F):F,ke="pitch"in o?+o.pitch:$,et="padding"in o?o.padding:E.padding,$e=c.Point.convert(o.offset),ft=E.centerPoint.add($e),Ye=E.pointLocation(ft),lt=c.LngLat.convert(o.center||Ye);this._normalizeCenter(lt);var Pt,Ht,hr=E.project(Ye),nr=E.project(lt).sub(hr),_r=E.zoomScale(Ce-A);o.around&&(Pt=c.LngLat.convert(o.around),Ht=E.locationPoint(Pt));var Dr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ce!==A,this._rotating=this._rotating||F!==Ie,this._pitching=this._pitching||ke!==$,this._padding=!E.isPaddingEqual(et),this._easeId=o.easeId,this._prepareEase(p,o.noMoveStart,Dr),this._ease(function(Qr){if(b._zooming&&(E.zoom=c.number(A,Ce,Qr)),b._rotating&&(E.bearing=c.number(F,Ie,Qr)),b._pitching&&(E.pitch=c.number($,ke,Qr)),b._padding&&(E.interpolatePadding(ce,et,Qr),ft=E.centerPoint.add($e)),Pt)E.setLocationAtPoint(Pt,Ht);else{var Xr=E.zoomScale(E.zoom-A),dn=Ce>A?Math.min(2,_r):Math.max(.5,_r),qn=Math.pow(dn,1-Qr),jn=E.unproject(hr.add(nr.mult(Qr*qn)).mult(Xr));E.setLocationAtPoint(E.renderWorldCopies?jn.wrap():jn,ft)}b._fireMoveEvents(p)},function(Qr){b._afterEase(p,Qr)},o),this},s.prototype._prepareEase=function(o,p,b){void 0===b&&(b={}),this._moving=!0,p||b.moving||this.fire(new c.Event("movestart",o)),this._zooming&&!b.zooming&&this.fire(new c.Event("zoomstart",o)),this._rotating&&!b.rotating&&this.fire(new c.Event("rotatestart",o)),this._pitching&&!b.pitching&&this.fire(new c.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new c.Event("move",o)),this._zooming&&this.fire(new c.Event("zoom",o)),this._rotating&&this.fire(new c.Event("rotate",o)),this._pitching&&this.fire(new c.Event("pitch",o))},s.prototype._afterEase=function(o,p){if(!this._easeId||!p||this._easeId!==p){delete this._easeId;var b=this._zooming,E=this._rotating,A=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,b&&this.fire(new c.Event("zoomend",o)),E&&this.fire(new c.Event("rotateend",o)),A&&this.fire(new c.Event("pitchend",o)),this.fire(new c.Event("moveend",o))}},s.prototype.flyTo=function(o,p){var b=this;if(!o.essential&&c.browser.prefersReducedMotion){var E=c.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(E,p)}this.stop(),o=c.extend({offset:[0,0],speed:1.2,curve:1.42,easing:c.ease},o);var A=this.transform,F=this.getZoom(),$=this.getBearing(),ce=this.getPitch(),Ce=this.getPadding(),Ie="zoom"in o?c.clamp(+o.zoom,A.minZoom,A.maxZoom):F,ke="bearing"in o?this._normalizeBearing(o.bearing,$):$,et="pitch"in o?+o.pitch:ce,$e="padding"in o?o.padding:A.padding,ft=A.zoomScale(Ie-F),Ye=c.Point.convert(o.offset),lt=A.centerPoint.add(Ye),Pt=A.pointLocation(lt),Ht=c.LngLat.convert(o.center||Pt);this._normalizeCenter(Ht);var hr=A.project(Pt),nr=A.project(Ht).sub(hr),_r=o.curve,Dr=Math.max(A.width,A.height),Qr=Dr/ft,Xr=nr.mag();if("minZoom"in o){var dn=c.clamp(Math.min(o.minZoom,F,Ie),A.minZoom,A.maxZoom),qn=Dr/A.zoomScale(dn-F);_r=Math.sqrt(qn/Xr*2)}var jn=_r*_r;function Bn(te){var ne=(Qr*Qr-Dr*Dr+(te?-1:1)*jn*jn*Xr*Xr)/(2*(te?Qr:Dr)*jn*Xr);return Math.log(Math.sqrt(ne*ne+1)-ne)}function Li(te){return(Math.exp(te)-Math.exp(-te))/2}function Dn(te){return(Math.exp(te)+Math.exp(-te))/2}var gi=Bn(0),ji=function(te){return Dn(gi)/Dn(gi+_r*te)},li=function(te){return Dr*((Dn(gi)*(Li(ne=gi+_r*te)/Dn(ne))-Li(gi))/jn)/Xr;var ne},yi=(Bn(1)-gi)/_r;if(Math.abs(Xr)<1e-6||!isFinite(yi)){if(Math.abs(Dr-Qr)<1e-6)return this.easeTo(o,p);var Ni=Qr<Dr?-1:1;yi=Math.abs(Math.log(Qr/Dr))/_r,li=function(){return 0},ji=function(te){return Math.exp(Ni*_r*te)}}return o.duration="duration"in o?+o.duration:1e3*yi/("screenSpeed"in o?+o.screenSpeed/_r:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=$!==ke,this._pitching=et!==ce,this._padding=!A.isPaddingEqual($e),this._prepareEase(p,!1),this._ease(function(te){var ne=te*yi,N=1/ji(ne);A.zoom=1===te?Ie:F+A.scaleZoom(N),b._rotating&&(A.bearing=c.number($,ke,te)),b._pitching&&(A.pitch=c.number(ce,et,te)),b._padding&&(A.interpolatePadding(Ce,$e,te),lt=A.centerPoint.add(Ye));var U=1===te?Ht:A.unproject(hr.add(nr.mult(li(ne))).mult(N));A.setLocationAtPoint(A.renderWorldCopies?U.wrap():U,lt),b._fireMoveEvents(p)},function(){return b._afterEase(p)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var b=this._onEaseEnd;delete this._onEaseEnd,b.call(this,p)}if(!o){var E=this.handlers;E&&E.stop(!1)}return this},s.prototype._ease=function(o,p,b){!1===b.animate||0===b.duration?(o(1),p()):(this._easeStart=c.browser.now(),this._easeOptions=b,this._onEaseFrame=o,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((c.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,p){o=c.wrap(o,-180,180);var b=Math.abs(o-p);return Math.abs(o-360-p)<b&&(o-=360),Math.abs(o+360-p)<b&&(o+=360),o},s.prototype._normalizeCenter=function(o){var p=this.transform;if(p.renderWorldCopies&&!p.lngRange){var b=o.lng-p.center.lng;o.lng+=b>180?-360:b<-180?360:0}},s}(c.Evented),wo=function(a){void 0===a&&(a={}),this.options=a,c.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};wo.prototype.getDefaultPosition=function(){return"bottom-right"},wo.prototype.onAdd=function(a){var s=this.options&&this.options.compact;return this._map=a,this._container=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=O.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=O.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===s&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},wo.prototype.onRemove=function(){O.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},wo.prototype._setElementTitle=function(a,s){var o=this._map._getUIString("AttributionControl."+s);a.title=o,a.setAttribute("aria-label",o)},wo.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},wo.prototype._updateEditLink=function(){var a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||c.config.ACCESS_TOKEN}];if(a){var o=s.reduce(function(p,b,E){return b.value&&(p+=b.key+"="+b.value+(E<s.length-1?"&":"")),p},"?");a.href=c.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),a.rel="noopener nofollow",this._setElementTitle(a,"MapFeedback")}},wo.prototype._updateData=function(a){!a||"metadata"!==a.sourceDataType&&"visibility"!==a.sourceDataType&&"style"!==a.dataType||(this._updateAttributions(),this._updateEditLink())},wo.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(function(F){return"string"!=typeof F?"":F})):"string"==typeof this.options.customAttribution&&a.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var p in o){var b=o[p];if(b.used){var E=b.getSource();E.attribution&&a.indexOf(E.attribution)<0&&a.push(E.attribution)}}a.sort(function(F,$){return F.length-$.length});var A=(a=a.filter(function(F,$){for(var ce=$+1;ce<a.length;ce++)if(a[ce].indexOf(F)>=0)return!1;return!0})).join(" | ");A!==this._attribHTML&&(this._attribHTML=A,a.length?(this._innerContainer.innerHTML=A,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},wo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Xs=function(){c.bindAll(["_updateLogo"],this),c.bindAll(["_updateCompact"],this)};Xs.prototype.onAdd=function(a){this._map=a,this._container=O.create("div","mapboxgl-ctrl");var s=O.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Xs.prototype.onRemove=function(){O.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Xs.prototype.getDefaultPosition=function(){return"bottom-left"},Xs.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Xs.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var s in a)if(a[s].getSource().mapbox_logo)return!0;return!1}},Xs.prototype._updateCompact=function(){var a=this._container.children;if(a.length){var s=a[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var Po=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Po.prototype.add=function(a){var s=++this._id;return this._queue.push({callback:a,id:s,cancelled:!1}),s},Po.prototype.remove=function(a){for(var s=this._currentlyRunning,o=0,p=s?this._queue.concat(s):this._queue;o<p.length;o+=1){var b=p[o];if(b.id===a)return void(b.cancelled=!0)}},Po.prototype.run=function(a){void 0===a&&(a=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,p=s;o<p.length;o+=1){var b=p[o];if(!b.cancelled&&(b.callback(a),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Po.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var fo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Vl=c.window.HTMLImageElement,Gl=c.window.HTMLElement,Qi=c.window.ImageBitmap,zo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ff=function(a){function s(p){var b=this;if(null!=(p=c.extend({},zo,p)).minZoom&&null!=p.maxZoom&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=p.minPitch&&null!=p.maxPitch&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=p.minPitch&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=p.maxPitch&&p.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var E=new sa(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies);if(a.call(this,E,p),this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new Po,this._controls=[],this._mapId=c.uniqueId(),this._locale=c.extend({},fo,p.locale),this._clickTolerance=p.clickTolerance,this._requestManager=new c.RequestManager(p.transformRequest,p.accessToken),"string"==typeof p.container){if(this._container=c.window.document.getElementById(p.container),!this._container)throw new Error("Container '"+p.container+"' not found.")}else{if(!(p.container instanceof Gl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),c.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return b._update(!1)}),this.on("moveend",function(){return b._update(!1)}),this.on("zoom",function(){return b._update(!0)}),void 0!==c.window&&(c.window.addEventListener("online",this._onWindowOnline,!1),c.window.addEventListener("resize",this._onWindowResize,!1),c.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new In(this,p),this._hash=p.hash&&new ws("string"==typeof p.hash&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,c.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new wo({customAttribution:p.customAttribution})),this.addControl(new Xs,p.logoPosition),this.on("style.load",function(){b.transform.unmodified&&b.jumpTo(b.style.stylesheet)}),this.on("data",function(A){b._update("style"===A.dataType),b.fire(new c.Event(A.dataType+"data",A))}),this.on("dataloading",function(A){b.fire(new c.Event(A.dataType+"dataloading",A))})}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(p,b){if(void 0===b&&(b=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var E=p.onAdd(this);this._controls.push(p);var A=this._controlPositions[b];return-1!==b.indexOf("bottom")?A.insertBefore(E,A.firstChild):A.appendChild(E),this},s.prototype.removeControl=function(p){if(!p||!p.onRemove)return this.fire(new c.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var b=this._controls.indexOf(p);return b>-1&&this._controls.splice(b,1),p.onRemove(this),this},s.prototype.hasControl=function(p){return this._controls.indexOf(p)>-1},s.prototype.resize=function(p){var b=this._containerDimensions(),E=b[0],A=b[1];if(E===this.transform.width&&A===this.transform.height)return this;this._resizeCanvas(E,A),this.transform.resize(E,A),this.painter.resize(E,A);var F=!this._moving;return F&&this.fire(new c.Event("movestart",p)).fire(new c.Event("move",p)),this.fire(new c.Event("resize",p)),F&&this.fire(new c.Event("moveend",p)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(p){return this.transform.setMaxBounds(c.LngLatBounds.convert(p)),this._update()},s.prototype.setMinZoom=function(p){if((p=null==p?-2:p)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(p){if((p=null==p?22:p)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(p){if((p=null==p?0:p)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(p){if((p=null==p?60:p)>60)throw new Error("maxPitch must be less than or equal to 60");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(p){return this.transform.renderWorldCopies=p,this._update()},s.prototype.project=function(p){return this.transform.locationPoint(c.LngLat.convert(p))},s.prototype.unproject=function(p){return this.transform.pointLocation(c.Point.convert(p))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(p,b,E){var A,F=this;if("mouseenter"===p||"mouseover"===p){var $=!1;return{layer:b,listener:E,delegates:{mousemove:function(Ce){var Ie=F.getLayer(b)?F.queryRenderedFeatures(Ce.point,{layers:[b]}):[];Ie.length?$||($=!0,E.call(F,new So(p,F,Ce.originalEvent,{features:Ie}))):$=!1},mouseout:function(){$=!1}}}}if("mouseleave"===p||"mouseout"===p){var ce=!1;return{layer:b,listener:E,delegates:{mousemove:function(Ce){(F.getLayer(b)?F.queryRenderedFeatures(Ce.point,{layers:[b]}):[]).length?ce=!0:ce&&(ce=!1,E.call(F,new So(p,F,Ce.originalEvent)))},mouseout:function(Ce){ce&&(ce=!1,E.call(F,new So(p,F,Ce.originalEvent)))}}}}return{layer:b,listener:E,delegates:(A={},A[p]=function(Ce){var Ie=F.getLayer(b)?F.queryRenderedFeatures(Ce.point,{layers:[b]}):[];Ie.length&&(Ce.features=Ie,E.call(F,Ce),delete Ce.features)},A)}},s.prototype.on=function(p,b,E){if(void 0===E)return a.prototype.on.call(this,p,b);var A=this._createDelegatedListener(p,b,E);for(var F in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(A),A.delegates)this.on(F,A.delegates[F]);return this},s.prototype.once=function(p,b,E){if(void 0===E)return a.prototype.once.call(this,p,b);var A=this._createDelegatedListener(p,b,E);for(var F in A.delegates)this.once(F,A.delegates[F]);return this},s.prototype.off=function(p,b,E){var A=this;return void 0===E?a.prototype.off.call(this,p,b):(this._delegatedListeners&&this._delegatedListeners[p]&&function(F){for(var $=F[p],ce=0;ce<$.length;ce++){var Ce=$[ce];if(Ce.layer===b&&Ce.listener===E){for(var Ie in Ce.delegates)A.off(Ie,Ce.delegates[Ie]);return $.splice(ce,1),A}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(p,b){if(!this.style)return[];var E;if(void 0!==b||void 0===p||p instanceof c.Point||Array.isArray(p)||(b=p,p=void 0),b=b||{},(p=p||[[0,0],[this.transform.width,this.transform.height]])instanceof c.Point||"number"==typeof p[0])E=[c.Point.convert(p)];else{var A=c.Point.convert(p[0]),F=c.Point.convert(p[1]);E=[A,new c.Point(F.x,A.y),F,new c.Point(A.x,F.y),A]}return this.style.queryRenderedFeatures(E,b,this.transform)},s.prototype.querySourceFeatures=function(p,b){return this.style.querySourceFeatures(p,b)},s.prototype.setStyle=function(p,b){return!1!==(b=c.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},b)).diff&&b.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,b),this):(this._localIdeographFontFamily=b.localIdeographFontFamily,this._updateStyle(p,b))},s.prototype._getUIString=function(p){var b=this._locale[p];if(null==b)throw new Error("Missing UI string '"+p+"'");return b},s.prototype._updateStyle=function(p,b){return this.style&&(this.style.setEventedParent(null),this.style._remove()),p?(this.style=new gs(this,b||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof p?this.style.loadURL(p):this.style.loadJSON(p),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new gs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(p,b){var E=this;if("string"==typeof p){var A=this._requestManager.normalizeStyleURL(p),F=this._requestManager.transformRequest(A,c.ResourceType.Style);c.getJSON(F,function($,ce){$?E.fire(new c.ErrorEvent($)):ce&&E._updateDiff(ce,b)})}else"object"==typeof p&&this._updateDiff(p,b)},s.prototype._updateDiff=function(p,b){try{this.style.setState(p)&&this._update(!0)}catch(E){c.warnOnce("Unable to perform style diff: "+(E.message||E.error||E)+".  Rebuilding the style from scratch."),this._updateStyle(p,b)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():c.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(p,b){return this._lazyInitEmptyStyle(),this.style.addSource(p,b),this._update(!0)},s.prototype.isSourceLoaded=function(p){var b=this.style&&this.style.sourceCaches[p];if(void 0!==b)return b.loaded();this.fire(new c.ErrorEvent(new Error("There is no source with ID '"+p+"'")))},s.prototype.areTilesLoaded=function(){var p=this.style&&this.style.sourceCaches;for(var b in p){var E=p[b]._tiles;for(var A in E){var F=E[A];if("loaded"!==F.state&&"errored"!==F.state)return!1}}return!0},s.prototype.addSourceType=function(p,b,E){return this._lazyInitEmptyStyle(),this.style.addSourceType(p,b,E)},s.prototype.removeSource=function(p){return this.style.removeSource(p),this._update(!0)},s.prototype.getSource=function(p){return this.style.getSource(p)},s.prototype.addImage=function(p,b,E){void 0===E&&(E={});var A=E.pixelRatio;void 0===A&&(A=1);var F=E.sdf;void 0===F&&(F=!1);var $=E.stretchX,ce=E.stretchY,Ce=E.content;if(this._lazyInitEmptyStyle(),b instanceof Vl||Qi&&b instanceof Qi){var Ie=c.browser.getImageData(b);this.style.addImage(p,{data:new c.RGBAImage({width:Ie.width,height:Ie.height},Ie.data),pixelRatio:A,stretchX:$,stretchY:ce,content:Ce,sdf:F,version:0})}else{if(void 0===b.width||void 0===b.height)return this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ke=b;this.style.addImage(p,{data:new c.RGBAImage({width:b.width,height:b.height},new Uint8Array(b.data)),pixelRatio:A,stretchX:$,stretchY:ce,content:Ce,sdf:F,version:0,userImage:ke}),ke.onAdd&&ke.onAdd(this,p)}},s.prototype.updateImage=function(p,b){var E=this.style.getImage(p);if(!E)return this.fire(new c.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var A=b instanceof Vl||Qi&&b instanceof Qi?c.browser.getImageData(b):b,F=A.width,$=A.height,ce=A.data;return void 0===F||void 0===$?this.fire(new c.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):F!==E.data.width||$!==E.data.height?this.fire(new c.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(E.data.replace(ce,!(b instanceof Vl||Qi&&b instanceof Qi)),void this.style.updateImage(p,E))},s.prototype.hasImage=function(p){return p?!!this.style.getImage(p):(this.fire(new c.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(p){this.style.removeImage(p)},s.prototype.loadImage=function(p,b){c.getImage(this._requestManager.transformRequest(p,c.ResourceType.Image),b)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(p,b){return this._lazyInitEmptyStyle(),this.style.addLayer(p,b),this._update(!0)},s.prototype.moveLayer=function(p,b){return this.style.moveLayer(p,b),this._update(!0)},s.prototype.removeLayer=function(p){return this.style.removeLayer(p),this._update(!0)},s.prototype.getLayer=function(p){return this.style.getLayer(p)},s.prototype.setLayerZoomRange=function(p,b,E){return this.style.setLayerZoomRange(p,b,E),this._update(!0)},s.prototype.setFilter=function(p,b,E){return void 0===E&&(E={}),this.style.setFilter(p,b,E),this._update(!0)},s.prototype.getFilter=function(p){return this.style.getFilter(p)},s.prototype.setPaintProperty=function(p,b,E,A){return void 0===A&&(A={}),this.style.setPaintProperty(p,b,E,A),this._update(!0)},s.prototype.getPaintProperty=function(p,b){return this.style.getPaintProperty(p,b)},s.prototype.setLayoutProperty=function(p,b,E,A){return void 0===A&&(A={}),this.style.setLayoutProperty(p,b,E,A),this._update(!0)},s.prototype.getLayoutProperty=function(p,b){return this.style.getLayoutProperty(p,b)},s.prototype.setLight=function(p,b){return void 0===b&&(b={}),this._lazyInitEmptyStyle(),this.style.setLight(p,b),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(p,b){return this.style.setFeatureState(p,b),this._update()},s.prototype.removeFeatureState=function(p,b){return this.style.removeFeatureState(p,b),this._update()},s.prototype.getFeatureState=function(p){return this.style.getFeatureState(p)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var p=0,b=0;return this._container&&(p=this._container.clientWidth||400,b=this._container.clientHeight||300),[p,b]},s.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==c.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&c.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=O.create("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();var b=this._canvasContainer=O.create("div","mapboxgl-canvas-container",p);this._interactive&&b.classList.add("mapboxgl-interactive"),this._canvas=O.create("canvas","mapboxgl-canvas",b),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var E=this._containerDimensions();this._resizeCanvas(E[0],E[1]);var A=this._controlContainer=O.create("div","mapboxgl-control-container",p),F=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function($){F[$]=O.create("div","mapboxgl-ctrl-"+$,A)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(p,b){var E=c.browser.devicePixelRatio||1;this._canvas.width=E*p,this._canvas.height=E*b,this._canvas.style.width=p+"px",this._canvas.style.height=b+"px"},s.prototype._setupPainter=function(){var p=c.extend({},g.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),b=this._canvas.getContext("webgl",p)||this._canvas.getContext("experimental-webgl",p);b?(this.painter=new $a(b,this.transform),c.webpSupported.testSupport(b)):this.fire(new c.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new c.Event("webglcontextlost",{originalEvent:p}))},s.prototype._contextRestored=function(p){this._setupPainter(),this.resize(),this._update(),this.fire(new c.Event("webglcontextrestored",{originalEvent:p}))},s.prototype._onMapScroll=function(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(p){return this._update(),this._renderTaskQueue.add(p)},s.prototype._cancelRenderFrame=function(p){this._renderTaskQueue.remove(p)},s.prototype._render=function(p){var b,E=this,A=0,F=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(b=F.createQueryEXT(),F.beginQueryEXT(F.TIME_ELAPSED_EXT,b),A=c.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),!this._removed){var $=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var ce=this.transform.zoom,Ce=c.browser.now();this.style.zoomHistory.update(ce,Ce);var Ie=new c.EvaluationParameters(ce,{now:Ce,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ke=Ie.crossFadingFactor();1===ke&&ke===this._crossFadingFactor||($=!0,this._crossFadingFactor=ke),this.style.update(Ie)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new c.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new c.Event("load"))),this.style&&(this.style.hasTransitions()||$)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var et=c.browser.now()-A;F.endQueryEXT(F.TIME_ELAPSED_EXT,b),setTimeout(function(){var Ye=F.getQueryObjectEXT(b,F.QUERY_RESULT_EXT)/1e6;F.deleteQueryEXT(b),E.fire(new c.Event("gpu-timing-frame",{cpuTime:et,gpuTime:Ye}))},50)}if(this.listens("gpu-timing-layer")){var $e=this.painter.collectGpuTimers();setTimeout(function(){var Ye=E.painter.queryGpuTimers($e);E.fire(new c.Event("gpu-timing-layer",{layerTimes:Ye}))},50)}var ft=this._sourcesDirty||this._styleDirty||this._placementDirty;return ft||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.Event("idle")),!this._loaded||this._fullyLoaded||ft||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var p=0,b=this._controls;p<b.length;p+=1)b[p].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==c.window&&(c.window.removeEventListener("resize",this._onWindowResize,!1),c.window.removeEventListener("orientationchange",this._onWindowResize,!1),c.window.removeEventListener("online",this._onWindowOnline,!1));var E=this.painter.context.gl.getExtension("WEBGL_lose_context");E&&E.loseContext(),As(this._canvasContainer),As(this._controlContainer),As(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new c.Event("remove"))},s.prototype.triggerRepaint=function(){var p=this;this.style&&!this._frame&&(this._frame=c.browser.frame(function(b){p._frame=null,p._render(b)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(p){this._trackResize&&this.resize({originalEvent:p})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(p){this._showPadding!==p&&(this._showPadding=p,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(p){this._vertices=p,this._update()},s.prototype._setCacheLimits=function(p,b){c.setCacheLimits(p,b)},o.version.get=function(){return c.version},Object.defineProperties(s.prototype,o),s}(lc);function As(a){a.parentNode&&a.parentNode.removeChild(a)}var bl={showCompass:!0,showZoom:!0,visualizePitch:!1},ys=function(a){var s=this;this.options=c.extend({},bl,a),this._container=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(c.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),O.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),O.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(c.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=O.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ys.prototype._updateZoomButtons=function(){var a=this._map.getZoom(),s=a===this._map.getMaxZoom(),o=a===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},ys.prototype._rotateCompassArrow=function(){var a=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=a},ys.prototype.onAdd=function(a){return this._map=a,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new is(this._map,this._compass,this.options.visualizePitch)),this._container},ys.prototype.onRemove=function(){O.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ys.prototype._createButton=function(a,s){var o=O.create("button",a,this._container);return o.type="button",o.addEventListener("click",s),o},ys.prototype._setButtonTitle=function(a,s){var o=this._map._getUIString("NavigationControl."+s);a.title=o,a.setAttribute("aria-label",o)};var is=function(a,s,o){void 0===o&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Oc({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,o&&(this.mousePitch=new xl({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),c.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),O.addEventListener(s,"mousedown",this.mousedown),O.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),O.addEventListener(s,"touchmove",this.touchmove),O.addEventListener(s,"touchend",this.touchend),O.addEventListener(s,"touchcancel",this.reset)};function al(a,s,o){if(a=new c.LngLat(a.lng,a.lat),s){var p=new c.LngLat(a.lng-360,a.lat),b=new c.LngLat(a.lng+360,a.lat),E=o.locationPoint(a).distSqr(s);o.locationPoint(p).distSqr(s)<E?a=p:o.locationPoint(b).distSqr(s)<E&&(a=b)}for(;Math.abs(a.lng-o.center.lng)>180;){var A=o.locationPoint(a);if(A.x>=0&&A.y>=0&&A.x<=o.width&&A.y<=o.height)break;a.lng>o.center.lng?a.lng-=360:a.lng+=360}return a}is.prototype.down=function(a,s){this.mouseRotate.mousedown(a,s),this.mousePitch&&this.mousePitch.mousedown(a,s),O.disableDrag()},is.prototype.move=function(a,s){var o=this.map,p=this.mouseRotate.mousemoveWindow(a,s);if(p&&p.bearingDelta&&o.setBearing(o.getBearing()+p.bearingDelta),this.mousePitch){var b=this.mousePitch.mousemoveWindow(a,s);b&&b.pitchDelta&&o.setPitch(o.getPitch()+b.pitchDelta)}},is.prototype.off=function(){var a=this.element;O.removeEventListener(a,"mousedown",this.mousedown),O.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),O.removeEventListener(a,"touchmove",this.touchmove),O.removeEventListener(a,"touchend",this.touchend),O.removeEventListener(a,"touchcancel",this.reset),this.offTemp()},is.prototype.offTemp=function(){O.enableDrag(),O.removeEventListener(c.window,"mousemove",this.mousemove),O.removeEventListener(c.window,"mouseup",this.mouseup)},is.prototype.mousedown=function(a){this.down(c.extend({},a,{ctrlKey:!0,preventDefault:function(){return a.preventDefault()}}),O.mousePos(this.element,a)),O.addEventListener(c.window,"mousemove",this.mousemove),O.addEventListener(c.window,"mouseup",this.mouseup)},is.prototype.mousemove=function(a){this.move(a,O.mousePos(this.element,a))},is.prototype.mouseup=function(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()},is.prototype.touchstart=function(a){1!==a.targetTouches.length?this.reset():(this._startPos=this._lastPos=O.touchPos(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return a.preventDefault()}},this._startPos))},is.prototype.touchmove=function(a){1!==a.targetTouches.length?this.reset():(this._lastPos=O.touchPos(this.element,a.targetTouches)[0],this.move({preventDefault:function(){return a.preventDefault()}},this._lastPos))},is.prototype.touchend=function(a){0===a.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},is.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var su={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Hl(a,s,o){var p=a.classList;for(var b in su)p.remove("mapboxgl-"+o+"-anchor-"+b);p.add("mapboxgl-"+o+"-anchor-"+s)}var Sl,Wl=function(a){function s(o,p){if(a.call(this),(o instanceof c.window.HTMLElement||p)&&(o=c.extend({element:o},p)),c.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=c.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=O.create("div"),this._element.setAttribute("aria-label","Map marker");var b=O.createNS("http://www.w3.org/2000/svg","svg");b.setAttributeNS(null,"display","block"),b.setAttributeNS(null,"height","41px"),b.setAttributeNS(null,"width","27px"),b.setAttributeNS(null,"viewBox","0 0 27 41");var E=O.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"stroke","none"),E.setAttributeNS(null,"stroke-width","1"),E.setAttributeNS(null,"fill","none"),E.setAttributeNS(null,"fill-rule","evenodd");var A=O.createNS("http://www.w3.org/2000/svg","g");A.setAttributeNS(null,"fill-rule","nonzero");var F=O.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"transform","translate(3.0, 29.0)"),F.setAttributeNS(null,"fill","#000000");for(var $=0,ce=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];$<ce.length;$+=1){var Ce=ce[$],Ie=O.createNS("http://www.w3.org/2000/svg","ellipse");Ie.setAttributeNS(null,"opacity","0.04"),Ie.setAttributeNS(null,"cx","10.5"),Ie.setAttributeNS(null,"cy","5.80029008"),Ie.setAttributeNS(null,"rx",Ce.rx),Ie.setAttributeNS(null,"ry",Ce.ry),F.appendChild(Ie)}var ke=O.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"fill",this._color);var et=O.createNS("http://www.w3.org/2000/svg","path");et.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),ke.appendChild(et);var $e=O.createNS("http://www.w3.org/2000/svg","g");$e.setAttributeNS(null,"opacity","0.25"),$e.setAttributeNS(null,"fill","#000000");var ft=O.createNS("http://www.w3.org/2000/svg","path");ft.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),$e.appendChild(ft);var Ye=O.createNS("http://www.w3.org/2000/svg","g");Ye.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ye.setAttributeNS(null,"fill","#FFFFFF");var lt=O.createNS("http://www.w3.org/2000/svg","g");lt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Pt=O.createNS("http://www.w3.org/2000/svg","circle");Pt.setAttributeNS(null,"fill","#000000"),Pt.setAttributeNS(null,"opacity","0.25"),Pt.setAttributeNS(null,"cx","5.5"),Pt.setAttributeNS(null,"cy","5.5"),Pt.setAttributeNS(null,"r","5.4999962");var Ht=O.createNS("http://www.w3.org/2000/svg","circle");Ht.setAttributeNS(null,"fill","#FFFFFF"),Ht.setAttributeNS(null,"cx","5.5"),Ht.setAttributeNS(null,"cy","5.5"),Ht.setAttributeNS(null,"r","5.4999962"),lt.appendChild(Pt),lt.appendChild(Ht),A.appendChild(F),A.appendChild(ke),A.appendChild($e),A.appendChild(Ye),A.appendChild(lt),b.appendChild(A),b.setAttributeNS(null,"height",41*this._scale+"px"),b.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(b),this._offset=c.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(hr){hr.preventDefault()}),this._element.addEventListener("mousedown",function(hr){hr.preventDefault()}),Hl(this._element,this._anchor,"marker"),this._popup=null}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),O.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=c.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var p=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(24.6+p)],"bottom-right":[-p,-1*(24.6+p)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var p=o.code,b=o.charCode||o.keyCode;"Space"!==p&&"Enter"!==p&&32!==b&&13!==b||this.togglePopup()},s.prototype._onMapClick=function(o){var p=o.originalEvent.target,b=this._element;this._popup&&(p===b||b.contains(p))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=al(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var p="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?p="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(p="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var b="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?b="rotateX(0deg)":"map"===this._pitchAlignment&&(b="rotateX("+this._map.getPitch()+"deg)"),o&&"moveend"!==o.type||(this._pos=this._pos.round()),O.setTransform(this._element,su[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+b+" "+p)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=c.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var p=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=p}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new c.Event("dragstart"))),this.fire(new c.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new c.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(c.Evented),Yc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},wl=0,ol=!1,kc=function(a){function s(o){a.call(this),this.options=c.extend({},Yc,o),c.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.onAdd=function(o){var p;return this._map=o,this._container=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),p=this._setupUI,void 0!==Sl?p(Sl):void 0!==c.window.navigator.permissions?c.window.navigator.permissions.query({name:"geolocation"}).then(function(b){p(Sl="denied"!==b.state)}):p(Sl=!!c.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(c.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),O.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,wl=0,ol=!1},s.prototype._isOutOfMapMaxBounds=function(o){var p=this._map.getMaxBounds(),b=o.coords;return p&&(b.longitude<p.getWest()||b.longitude>p.getEast()||b.latitude<p.getSouth()||b.latitude>p.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new c.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var p=new c.LngLat(o.coords.longitude,o.coords.latitude),b=o.coords.accuracy,E=this._map.getBearing(),A=c.extend({bearing:E},this.options.fitBoundsOptions);this._map.fitBounds(p.toBounds(b),A,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var p=new c.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(p).addTo(this._map),this._userLocationDotMarker.setLngLat(p).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,p=this._map.unproject([0,o]),b=this._map.unproject([1,o]),E=p.distanceTo(b),A=Math.ceil(2*this._accuracy/E);this._circleElement.style.width=A+"px",this._circleElement.style.height=A+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&ol)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new c.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var p=this;if(this._container.addEventListener("contextmenu",function(A){return A.preventDefault()}),this._geolocateButton=O.create("button","mapboxgl-ctrl-geolocate",this._container),O.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===o){c.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var b=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=b,this._geolocateButton.setAttribute("aria-label",b)}else{var E=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=E,this._geolocateButton.setAttribute("aria-label",E)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=O.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Wl(this._dotElement),this._circleElement=O.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(A){A.geolocateSource||"ACTIVE_LOCK"!==p._watchState||A.originalEvent&&"resize"===A.originalEvent.type||(p._watchState="BACKGROUND",p._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),p._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),p.fire(new c.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return c.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":wl--,ol=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new c.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++wl>1?(o={maximumAge:6e5,timeout:0},ol=!0):(o=this.options.positionOptions,ol=!1),this._geolocationWatchID=c.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else c.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){c.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(c.Evented),sl={maxWidth:100,unit:"metric"},Vu=function(a){this.options=c.extend({},sl,a),c.bindAll(["_onMove","setUnit"],this)};function Xl(a,s,o){var p=o&&o.maxWidth||100,b=a._container.clientHeight/2,E=a.unproject([0,b]),A=a.unproject([p,b]),F=E.distanceTo(A);if(o&&"imperial"===o.unit){var $=3.2808*F;$>5280?Gu(s,p,$/5280,a._getUIString("ScaleControl.Miles")):Gu(s,p,$,a._getUIString("ScaleControl.Feet"))}else o&&"nautical"===o.unit?Gu(s,p,F/1852,a._getUIString("ScaleControl.NauticalMiles")):F>=1e3?Gu(s,p,F/1e3,a._getUIString("ScaleControl.Kilometers")):Gu(s,p,F,a._getUIString("ScaleControl.Meters"))}function Gu(a,s,o,p){var b,E,A,$,ce,F=(b=o,(E=Math.pow(10,(""+Math.floor(b)).length-1))*(A=(A=b/E)>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:($=A,ce=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10)),Math.round($*ce)/ce)));a.style.width=s*(F/o)+"px",a.innerHTML=F+"&nbsp;"+p}Vu.prototype.getDefaultPosition=function(){return"bottom-left"},Vu.prototype._onMove=function(){Xl(this._map,this._container,this.options)},Vu.prototype.onAdd=function(a){return this._map=a,this._container=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vu.prototype.onRemove=function(){O.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vu.prototype.setUnit=function(a){this.options.unit=a,Xl(this._map,this._container,this.options)};var Fs=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof c.window.HTMLElement?this._container=a.container:c.warnOnce("Full screen control 'container' must be a DOM element.")),c.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in c.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in c.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in c.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in c.window.document&&(this._fullscreenchange="MSFullscreenChange")};Fs.prototype.onAdd=function(a){return this._map=a,this._container||(this._container=this._map.getContainer()),this._controlContainer=O.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",c.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Fs.prototype.onRemove=function(){O.remove(this._controlContainer),this._map=null,c.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Fs.prototype._checkFullscreenSupport=function(){return!!(c.window.document.fullscreenEnabled||c.window.document.mozFullScreenEnabled||c.window.document.msFullscreenEnabled||c.window.document.webkitFullscreenEnabled)},Fs.prototype._setupUI=function(){var a=this._fullscreenButton=O.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);O.create("span","mapboxgl-ctrl-icon",a).setAttribute("aria-hidden",!0),a.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),c.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Fs.prototype._updateTitle=function(){var a=this._getTitle();this._fullscreenButton.setAttribute("aria-label",a),this._fullscreenButton.title=a},Fs.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Fs.prototype._isFullscreen=function(){return this._fullscreen},Fs.prototype._changeIcon=function(){(c.window.document.fullscreenElement||c.window.document.mozFullScreenElement||c.window.document.webkitFullscreenElement||c.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Fs.prototype._onClickFullscreen=function(){this._isFullscreen()?c.window.document.exitFullscreen?c.window.document.exitFullscreen():c.window.document.mozCancelFullScreen?c.window.document.mozCancelFullScreen():c.window.document.msExitFullscreen?c.window.document.msExitFullscreen():c.window.document.webkitCancelFullScreen&&c.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Rc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},cc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),fc=function(a){function s(o){a.call(this),this.options=c.extend(Object.create(Rc),o),c.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new c.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&O.remove(this._content),this._container&&(O.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new c.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=c.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(c.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var p,b=c.window.document.createDocumentFragment(),E=c.window.document.createElement("body");for(E.innerHTML=o;p=E.firstChild;)b.appendChild(p);return this.setDOMContent(b)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=O.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=O.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var p=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=O.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=O.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Ie){return p._container.classList.add(Ie)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=al(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var b=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),E=this.options.anchor,A=function Ie(ke){if(ke){if("number"==typeof ke){var et=Math.round(Math.sqrt(.5*Math.pow(ke,2)));return{center:new c.Point(0,0),top:new c.Point(0,ke),"top-left":new c.Point(et,et),"top-right":new c.Point(-et,et),bottom:new c.Point(0,-ke),"bottom-left":new c.Point(et,-et),"bottom-right":new c.Point(-et,-et),left:new c.Point(ke,0),right:new c.Point(-ke,0)}}if(ke instanceof c.Point||Array.isArray(ke)){var $e=c.Point.convert(ke);return{center:$e,top:$e,"top-left":$e,"top-right":$e,bottom:$e,"bottom-left":$e,"bottom-right":$e,left:$e,right:$e}}return{center:c.Point.convert(ke.center||[0,0]),top:c.Point.convert(ke.top||[0,0]),"top-left":c.Point.convert(ke["top-left"]||[0,0]),"top-right":c.Point.convert(ke["top-right"]||[0,0]),bottom:c.Point.convert(ke.bottom||[0,0]),"bottom-left":c.Point.convert(ke["bottom-left"]||[0,0]),"bottom-right":c.Point.convert(ke["bottom-right"]||[0,0]),left:c.Point.convert(ke.left||[0,0]),right:c.Point.convert(ke.right||[0,0])}}return Ie(new c.Point(0,0))}(this.options.offset);if(!E){var F,$=this._container.offsetWidth,ce=this._container.offsetHeight;F=b.y+A.bottom.y<ce?["top"]:b.y>this._map.transform.height-ce?["bottom"]:[],b.x<$/2?F.push("left"):b.x>this._map.transform.width-$/2&&F.push("right"),E=0===F.length?"bottom":F.join("-")}var Ce=b.add(A[E]).round();O.setTransform(this._container,su[E]+" translate("+Ce.x+"px,"+Ce.y+"px)"),Hl(this._container,E,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(cc);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(c.Evented),El={version:c.version,supported:g,setRTLTextPlugin:c.setRTLTextPlugin,getRTLTextPluginStatus:c.getRTLTextPluginStatus,Map:ff,NavigationControl:ys,GeolocateControl:kc,AttributionControl:wo,ScaleControl:Vu,FullscreenControl:Fs,Popup:fc,Marker:Wl,Style:gs,LngLat:c.LngLat,LngLatBounds:c.LngLatBounds,Point:c.Point,MercatorCoordinate:c.MercatorCoordinate,Evented:c.Evented,config:c.config,prewarm:function(){rr().acquire(ir)},clearPrewarmedResources:function(){var a=Rn;a&&(a.isPreloaded()&&1===a.numActive()?(a.release(ir),Rn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return c.config.ACCESS_TOKEN},set accessToken(a){c.config.ACCESS_TOKEN=a},get baseApiUrl(){return c.config.API_URL},set baseApiUrl(a){c.config.API_URL=a},get workerCount(){return Fr.workerCount},set workerCount(a){Fr.workerCount=a},get maxParallelImageRequests(){return c.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(a){c.config.MAX_PARALLEL_IMAGE_REQUESTS=a},clearStorage:function(a){c.clearTileCache(a)},workerUrl:""};return El}),M}()},78320:()=>{var ie,L;L=ie||(ie={}),function(y){var M="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),_=c(L);function c(g,O){return function(R,B){"function"!=typeof g[R]&&Object.defineProperty(g,R,{configurable:!0,writable:!0,value:B}),O&&O(R,B)}}void 0===M.Reflect?M.Reflect=L:_=c(M.Reflect,_),function(y){var M=Object.prototype.hasOwnProperty,_="function"==typeof Symbol,c=_&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",g=_&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",O="function"==typeof Object.create,R={__proto__:[]}instanceof Array,B=!O&&!R,H={create:O?function(){return Lt(Object.create(null))}:R?function(){return Lt({__proto__:null})}:function(){return Lt({})},has:B?function(Z,Ze){return M.call(Z,Ze)}:function(Z,Ze){return Ze in Z},get:B?function(Z,Ze){return M.call(Z,Ze)?Z[Ze]:void 0}:function(Z,Ze){return Z[Ze]}},G=Object.getPrototypeOf(Function),be="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,Be=be||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var Z={},Ze=[],St=function(){function vr(Xt,mr,or){this._index=0,this._keys=Xt,this._values=mr,this._selector=or}return vr.prototype["@@iterator"]=function(){return this},vr.prototype[g]=function(){return this},vr.prototype.next=function(){var Xt=this._index;if(Xt>=0&&Xt<this._keys.length){var mr=this._selector(this._keys[Xt],this._values[Xt]);return Xt+1>=this._keys.length?(this._index=-1,this._keys=Ze,this._values=Ze):this._index++,{value:mr,done:!1}}return{value:void 0,done:!0}},vr.prototype.throw=function(Xt){throw this._index>=0&&(this._index=-1,this._keys=Ze,this._values=Ze),Xt},vr.prototype.return=function(Xt){return this._index>=0&&(this._index=-1,this._keys=Ze,this._values=Ze),{value:Xt,done:!0}},vr}();return function(){function vr(){this._keys=[],this._values=[],this._cacheKey=Z,this._cacheIndex=-2}return Object.defineProperty(vr.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),vr.prototype.has=function(Xt){return this._find(Xt,!1)>=0},vr.prototype.get=function(Xt){var mr=this._find(Xt,!1);return mr>=0?this._values[mr]:void 0},vr.prototype.set=function(Xt,mr){var or=this._find(Xt,!0);return this._values[or]=mr,this},vr.prototype.delete=function(Xt){var mr=this._find(Xt,!1);if(mr>=0){for(var or=this._keys.length,pr=mr+1;pr<or;pr++)this._keys[pr-1]=this._keys[pr],this._values[pr-1]=this._values[pr];return this._keys.length--,this._values.length--,Xt===this._cacheKey&&(this._cacheKey=Z,this._cacheIndex=-2),!0}return!1},vr.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Z,this._cacheIndex=-2},vr.prototype.keys=function(){return new St(this._keys,this._values,It)},vr.prototype.values=function(){return new St(this._keys,this._values,Jt)},vr.prototype.entries=function(){return new St(this._keys,this._values,Tr)},vr.prototype["@@iterator"]=function(){return this.entries()},vr.prototype[g]=function(){return this.entries()},vr.prototype._find=function(Xt,mr){return this._cacheKey!==Xt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Xt)),this._cacheIndex<0&&mr&&(this._cacheIndex=this._keys.length,this._keys.push(Xt),this._values.push(void 0)),this._cacheIndex},vr}();function It(vr,Xt){return vr}function Jt(vr,Xt){return Xt}function Tr(vr,Xt){return[vr,Xt]}}():Map,j=be||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function Z(){this._map=new Be}return Object.defineProperty(Z.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Z.prototype.has=function(Ze){return this._map.has(Ze)},Z.prototype.add=function(Ze){return this._map.set(Ze,Ze),this},Z.prototype.delete=function(Ze){return this._map.delete(Ze)},Z.prototype.clear=function(){this._map.clear()},Z.prototype.keys=function(){return this._map.keys()},Z.prototype.values=function(){return this._map.values()},Z.prototype.entries=function(){return this._map.entries()},Z.prototype["@@iterator"]=function(){return this.keys()},Z.prototype[g]=function(){return this.keys()},Z}():Set,Ke=new(be||"function"!=typeof WeakMap?function(){var Ze=H.create(),St=It();return function(){function mr(){this._key=It()}return mr.prototype.has=function(or){var pr=Jt(or,!1);return void 0!==pr&&H.has(pr,this._key)},mr.prototype.get=function(or){var pr=Jt(or,!1);return void 0!==pr?H.get(pr,this._key):void 0},mr.prototype.set=function(or,pr){return Jt(or,!0)[this._key]=pr,this},mr.prototype.delete=function(or){var pr=Jt(or,!1);return void 0!==pr&&delete pr[this._key]},mr.prototype.clear=function(){this._key=It()},mr}();function It(){var mr;do{mr="@@WeakMap@@"+Xt()}while(H.has(Ze,mr));return Ze[mr]=!0,mr}function Jt(mr,or){if(!M.call(mr,St)){if(!or)return;Object.defineProperty(mr,St,{value:H.create()})}return mr[St]}function Tr(mr,or){for(var pr=0;pr<or;++pr)mr[pr]=255*Math.random()|0;return mr}function Xt(){var mr=function(mr){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(mr)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(mr)):Tr(new Uint8Array(mr),mr):Tr(new Array(mr),mr)}(16);mr[6]=79&mr[6]|64,mr[8]=191&mr[8]|128;for(var or="",pr=0;pr<16;++pr){var mn=mr[pr];(4===pr||6===pr||8===pr)&&(or+="-"),mn<16&&(or+="0"),or+=mn.toString(16).toLowerCase()}return or}}():WeakMap);function At(Z,Ze,St){var It=Ke.get(Z);if(Ge(It)){if(!St)return;It=new Be,Ke.set(Z,It)}var Jt=It.get(Ze);if(Ge(Jt)){if(!St)return;Jt=new Be,It.set(Ze,Jt)}return Jt}function kt(Z,Ze,St){if(Yt(Z,Ze,St))return!0;var Jt=K(Ze);return!gt(Jt)&&kt(Z,Jt,St)}function Yt(Z,Ze,St){var It=At(Ze,St,!1);return!Ge(It)&&function(Z){return!!Z}(It.has(Z))}function Er(Z,Ze,St){if(Yt(Z,Ze,St))return ge(Z,Ze,St);var Jt=K(Ze);return gt(Jt)?void 0:Er(Z,Jt,St)}function ge(Z,Ze,St){var It=At(Ze,St,!1);if(!Ge(It))return It.get(Z)}function de(Z,Ze,St,It){At(St,It,!0).set(Z,Ze)}function oe(Z,Ze){var St=me(Z,Ze),It=K(Z);if(null===It)return St;var Jt=oe(It,Ze);if(Jt.length<=0)return St;if(St.length<=0)return Jt;for(var Tr=new j,vr=[],Xt=0,mr=St;Xt<mr.length;Xt++)Tr.has(or=mr[Xt])||(Tr.add(or),vr.push(or));for(var mn=0,On=Jt;mn<On.length;mn++){var or;Tr.has(or=On[mn])||(Tr.add(or),vr.push(or))}return vr}function me(Z,Ze){var St=[],It=At(Z,Ze,!1);if(Ge(It))return St;for(var Tr=function(Z){var Ze=er(Z,g);if(!Re(Ze))throw new TypeError;var St=Ze.call(Z);if(!Nr(St))throw new TypeError;return St}(It.keys()),vr=0;;){var Xt=$r(Tr);if(!Xt)return St.length=vr,St;var mr=Br(Xt);try{St[vr]=mr}catch(or){try{C(Tr)}finally{throw or}}vr++}}function Me(Z){if(null===Z)return 1;switch(typeof Z){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===Z?1:6;default:return 6}}function Ge(Z){return void 0===Z}function gt(Z){return null===Z}function Nr(Z){return"object"==typeof Z?null!==Z:"function"==typeof Z}function cn(Z,Ze){switch(Me(Z)){case 0:case 1:case 2:case 3:case 4:case 5:return Z}var St=3===Ze?"string":5===Ze?"number":"default",It=er(Z,c);if(void 0!==It){var Jt=It.call(Z,St);if(Nr(Jt))throw new TypeError;return Jt}return function(Z,Ze){if("string"===Ze){var St=Z.toString;if(Re(St)&&!Nr(It=St.call(Z)))return It;if(Re(Jt=Z.valueOf)&&!Nr(It=Jt.call(Z)))return It}else{var Jt;if(Re(Jt=Z.valueOf)&&!Nr(It=Jt.call(Z)))return It;var It,Tr=Z.toString;if(Re(Tr)&&!Nr(It=Tr.call(Z)))return It}throw new TypeError}(Z,"default"===St?"number":St)}function we(Z){var Ze=cn(Z,3);return function(Z){return"symbol"==typeof Z}(Ze)?Ze:function(Z){return""+Z}(Ze)}function at(Z){return Array.isArray?Array.isArray(Z):Z instanceof Object?Z instanceof Array:"[object Array]"===Object.prototype.toString.call(Z)}function Re(Z){return"function"==typeof Z}function qt(Z){return"function"==typeof Z}function er(Z,Ze){var St=Z[Ze];if(null!=St){if(!Re(St))throw new TypeError;return St}}function Br(Z){return Z.value}function $r(Z){var Ze=Z.next();return!Ze.done&&Ze}function C(Z){var Ze=Z.return;Ze&&Ze.call(Z)}function K(Z){var Ze=Object.getPrototypeOf(Z);if("function"!=typeof Z||Z===G||Ze!==G)return Ze;var St=Z.prototype,It=St&&Object.getPrototypeOf(St);if(null==It||It===Object.prototype)return Ze;var Jt=It.constructor;return"function"!=typeof Jt||Jt===Z?Ze:Jt}function Lt(Z){return Z.__=void 0,delete Z.__,Z}y("decorate",function(Z,Ze,St,It){if(Ge(St)){if(!at(Z))throw new TypeError;if(!qt(Ze))throw new TypeError;return function(Z,Ze){for(var St=Z.length-1;St>=0;--St){var Jt=(0,Z[St])(Ze);if(!Ge(Jt)&&!gt(Jt)){if(!qt(Jt))throw new TypeError;Ze=Jt}}return Ze}(Z,Ze)}if(!at(Z))throw new TypeError;if(!Nr(Ze))throw new TypeError;if(!Nr(It)&&!Ge(It)&&!gt(It))throw new TypeError;return gt(It)&&(It=void 0),function(Z,Ze,St,It){for(var Jt=Z.length-1;Jt>=0;--Jt){var vr=(0,Z[Jt])(Ze,St,It);if(!Ge(vr)&&!gt(vr)){if(!Nr(vr))throw new TypeError;It=vr}}return It}(Z,Ze,St=we(St),It)}),y("metadata",function(Z,Ze){return function(It,Jt){if(!Nr(It))throw new TypeError;if(!Ge(Jt)&&!function(Z){switch(Me(Z)){case 3:case 4:return!0;default:return!1}}(Jt))throw new TypeError;de(Z,Ze,It,Jt)}}),y("defineMetadata",function(Z,Ze,St,It){if(!Nr(St))throw new TypeError;return Ge(It)||(It=we(It)),de(Z,Ze,St,It)}),y("hasMetadata",function(Z,Ze,St){if(!Nr(Ze))throw new TypeError;return Ge(St)||(St=we(St)),kt(Z,Ze,St)}),y("hasOwnMetadata",function(Z,Ze,St){if(!Nr(Ze))throw new TypeError;return Ge(St)||(St=we(St)),Yt(Z,Ze,St)}),y("getMetadata",function(Z,Ze,St){if(!Nr(Ze))throw new TypeError;return Ge(St)||(St=we(St)),Er(Z,Ze,St)}),y("getOwnMetadata",function(Z,Ze,St){if(!Nr(Ze))throw new TypeError;return Ge(St)||(St=we(St)),ge(Z,Ze,St)}),y("getMetadataKeys",function(Z,Ze){if(!Nr(Z))throw new TypeError;return Ge(Ze)||(Ze=we(Ze)),oe(Z,Ze)}),y("getOwnMetadataKeys",function(Z,Ze){if(!Nr(Z))throw new TypeError;return Ge(Ze)||(Ze=we(Ze)),me(Z,Ze)}),y("deleteMetadata",function(Z,Ze,St){if(!Nr(Ze))throw new TypeError;Ge(St)||(St=we(St));var It=At(Ze,St,!1);if(Ge(It)||!It.delete(Z))return!1;if(It.size>0)return!0;var Jt=Ke.get(Ze);return Jt.delete(St),Jt.size>0||Ke.delete(Ze),!0})}(_)}()},67941:ie=>{var L=function(y){"use strict";var c,M=Object.prototype,_=M.hasOwnProperty,g="function"==typeof Symbol?Symbol:{},O=g.iterator||"@@iterator",R=g.asyncIterator||"@@asyncIterator",B=g.toStringTag||"@@toStringTag";function H(de,oe,me){return Object.defineProperty(de,oe,{value:me,enumerable:!0,configurable:!0,writable:!0}),de[oe]}try{H({},"")}catch(de){H=function(oe,me,Me){return oe[me]=Me}}function G(de,oe,me,Me){var gt=Object.create((oe&&oe.prototype instanceof Dt?oe:Dt).prototype),br=new Yt(Me||[]);return gt._invoke=function(de,oe,me){var Me=Be;return function(gt,br){if(Me===W)throw new Error("Generator is already running");if(Me===Ke){if("throw"===gt)throw br;return ge()}for(me.method=gt,me.arg=br;;){var Nr=me.delegate;if(Nr){var cn=Xe(Nr,me);if(cn){if(cn===xt)continue;return cn}}if("next"===me.method)me.sent=me._sent=me.arg;else if("throw"===me.method){if(Me===Be)throw Me=Ke,me.arg;me.dispatchException(me.arg)}else"return"===me.method&&me.abrupt("return",me.arg);Me=W;var Ir=be(de,oe,me);if("normal"===Ir.type){if(Me=me.done?Ke:j,Ir.arg===xt)continue;return{value:Ir.arg,done:me.done}}"throw"===Ir.type&&(Me=Ke,me.method="throw",me.arg=Ir.arg)}}}(de,me,br),gt}function be(de,oe,me){try{return{type:"normal",arg:de.call(oe,me)}}catch(Me){return{type:"throw",arg:Me}}}y.wrap=G;var Be="suspendedStart",j="suspendedYield",W="executing",Ke="completed",xt={};function Dt(){}function Et(){}function ut(){}var tt={};H(tt,O,function(){return this});var Gt=Object.getPrototypeOf,Q=Gt&&Gt(Gt(Er([])));Q&&Q!==M&&_.call(Q,O)&&(tt=Q);var Vt=ut.prototype=Dt.prototype=Object.create(tt);function ot(de){["next","throw","return"].forEach(function(oe){H(de,oe,function(me){return this._invoke(oe,me)})})}function Ue(de,oe){function me(gt,br,Nr,cn){var Ir=be(de[gt],de,br);if("throw"!==Ir.type){var Mt=Ir.arg,Le=Mt.value;return Le&&"object"==typeof Le&&_.call(Le,"__await")?oe.resolve(Le.__await).then(function(we){me("next",we,Nr,cn)},function(we){me("throw",we,Nr,cn)}):oe.resolve(Le).then(function(we){Mt.value=we,Nr(Mt)},function(we){return me("throw",we,Nr,cn)})}cn(Ir.arg)}var Me;this._invoke=function(gt,br){function Nr(){return new oe(function(cn,Ir){me(gt,br,cn,Ir)})}return Me=Me?Me.then(Nr,Nr):Nr()}}function Xe(de,oe){var me=de.iterator[oe.method];if(me===c){if(oe.delegate=null,"throw"===oe.method){if(de.iterator.return&&(oe.method="return",oe.arg=c,Xe(de,oe),"throw"===oe.method))return xt;oe.method="throw",oe.arg=new TypeError("The iterator does not provide a 'throw' method")}return xt}var Me=be(me,de.iterator,oe.arg);if("throw"===Me.type)return oe.method="throw",oe.arg=Me.arg,oe.delegate=null,xt;var Ge=Me.arg;return Ge?Ge.done?(oe[de.resultName]=Ge.value,oe.next=de.nextLoc,"return"!==oe.method&&(oe.method="next",oe.arg=c),oe.delegate=null,xt):Ge:(oe.method="throw",oe.arg=new TypeError("iterator result is not an object"),oe.delegate=null,xt)}function At(de){var oe={tryLoc:de[0]};1 in de&&(oe.catchLoc=de[1]),2 in de&&(oe.finallyLoc=de[2],oe.afterLoc=de[3]),this.tryEntries.push(oe)}function kt(de){var oe=de.completion||{};oe.type="normal",delete oe.arg,de.completion=oe}function Yt(de){this.tryEntries=[{tryLoc:"root"}],de.forEach(At,this),this.reset(!0)}function Er(de){if(de){var oe=de[O];if(oe)return oe.call(de);if("function"==typeof de.next)return de;if(!isNaN(de.length)){var me=-1,Me=function Ge(){for(;++me<de.length;)if(_.call(de,me))return Ge.value=de[me],Ge.done=!1,Ge;return Ge.value=c,Ge.done=!0,Ge};return Me.next=Me}}return{next:ge}}function ge(){return{value:c,done:!0}}return Et.prototype=ut,H(Vt,"constructor",ut),H(ut,"constructor",Et),Et.displayName=H(ut,B,"GeneratorFunction"),y.isGeneratorFunction=function(de){var oe="function"==typeof de&&de.constructor;return!!oe&&(oe===Et||"GeneratorFunction"===(oe.displayName||oe.name))},y.mark=function(de){return Object.setPrototypeOf?Object.setPrototypeOf(de,ut):(de.__proto__=ut,H(de,B,"GeneratorFunction")),de.prototype=Object.create(Vt),de},y.awrap=function(de){return{__await:de}},ot(Ue.prototype),H(Ue.prototype,R,function(){return this}),y.AsyncIterator=Ue,y.async=function(de,oe,me,Me,Ge){void 0===Ge&&(Ge=Promise);var gt=new Ue(G(de,oe,me,Me),Ge);return y.isGeneratorFunction(oe)?gt:gt.next().then(function(br){return br.done?br.value:gt.next()})},ot(Vt),H(Vt,B,"Generator"),H(Vt,O,function(){return this}),H(Vt,"toString",function(){return"[object Generator]"}),y.keys=function(de){var oe=[];for(var me in de)oe.push(me);return oe.reverse(),function Me(){for(;oe.length;){var Ge=oe.pop();if(Ge in de)return Me.value=Ge,Me.done=!1,Me}return Me.done=!0,Me}},y.values=Er,Yt.prototype={constructor:Yt,reset:function(de){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(kt),!de)for(var oe in this)"t"===oe.charAt(0)&&_.call(this,oe)&&!isNaN(+oe.slice(1))&&(this[oe]=c)},stop:function(){this.done=!0;var oe=this.tryEntries[0].completion;if("throw"===oe.type)throw oe.arg;return this.rval},dispatchException:function(de){if(this.done)throw de;var oe=this;function me(cn,Ir){return gt.type="throw",gt.arg=de,oe.next=cn,Ir&&(oe.method="next",oe.arg=c),!!Ir}for(var Me=this.tryEntries.length-1;Me>=0;--Me){var Ge=this.tryEntries[Me],gt=Ge.completion;if("root"===Ge.tryLoc)return me("end");if(Ge.tryLoc<=this.prev){var br=_.call(Ge,"catchLoc"),Nr=_.call(Ge,"finallyLoc");if(br&&Nr){if(this.prev<Ge.catchLoc)return me(Ge.catchLoc,!0);if(this.prev<Ge.finallyLoc)return me(Ge.finallyLoc)}else if(br){if(this.prev<Ge.catchLoc)return me(Ge.catchLoc,!0)}else{if(!Nr)throw new Error("try statement without catch or finally");if(this.prev<Ge.finallyLoc)return me(Ge.finallyLoc)}}}},abrupt:function(de,oe){for(var me=this.tryEntries.length-1;me>=0;--me){var Me=this.tryEntries[me];if(Me.tryLoc<=this.prev&&_.call(Me,"finallyLoc")&&this.prev<Me.finallyLoc){var Ge=Me;break}}Ge&&("break"===de||"continue"===de)&&Ge.tryLoc<=oe&&oe<=Ge.finallyLoc&&(Ge=null);var gt=Ge?Ge.completion:{};return gt.type=de,gt.arg=oe,Ge?(this.method="next",this.next=Ge.finallyLoc,xt):this.complete(gt)},complete:function(de,oe){if("throw"===de.type)throw de.arg;return"break"===de.type||"continue"===de.type?this.next=de.arg:"return"===de.type?(this.rval=this.arg=de.arg,this.method="return",this.next="end"):"normal"===de.type&&oe&&(this.next=oe),xt},finish:function(de){for(var oe=this.tryEntries.length-1;oe>=0;--oe){var me=this.tryEntries[oe];if(me.finallyLoc===de)return this.complete(me.completion,me.afterLoc),kt(me),xt}},catch:function(de){for(var oe=this.tryEntries.length-1;oe>=0;--oe){var me=this.tryEntries[oe];if(me.tryLoc===de){var Me=me.completion;if("throw"===Me.type){var Ge=Me.arg;kt(me)}return Ge}}throw new Error("illegal catch attempt")},delegateYield:function(de,oe,me){return this.delegate={iterator:Er(de),resultName:oe,nextLoc:me},"next"===this.method&&(this.arg=c),xt}},y}(ie.exports);try{regeneratorRuntime=L}catch(y){"object"==typeof globalThis?globalThis.regeneratorRuntime=L:Function("r","regeneratorRuntime = r")(L)}},20878:function(ie){ie.exports=function(){"use strict";function L(ot,Ue,pt,Xe,At,kt){if(!(At-Xe<=pt)){var Yt=Xe+At>>1;y(ot,Ue,Yt,Xe,At,kt%2),L(ot,Ue,pt,Xe,Yt-1,kt+1),L(ot,Ue,pt,Yt+1,At,kt+1)}}function y(ot,Ue,pt,Xe,At,kt){for(;At>Xe;){if(At-Xe>600){var Yt=At-Xe+1,Er=pt-Xe+1,ge=Math.log(Yt),de=.5*Math.exp(2*ge/3),oe=.5*Math.sqrt(ge*de*(Yt-de)/Yt)*(Er-Yt/2<0?-1:1);y(ot,Ue,pt,Math.max(Xe,Math.floor(pt-Er*de/Yt+oe)),Math.min(At,Math.floor(pt+(Yt-Er)*de/Yt+oe)),kt)}var Ge=Ue[2*pt+kt],gt=Xe,br=At;for(M(ot,Ue,Xe,pt),Ue[2*At+kt]>Ge&&M(ot,Ue,Xe,At);gt<br;){for(M(ot,Ue,gt,br),gt++,br--;Ue[2*gt+kt]<Ge;)gt++;for(;Ue[2*br+kt]>Ge;)br--}Ue[2*Xe+kt]===Ge?M(ot,Ue,Xe,br):M(ot,Ue,++br,At),br<=pt&&(Xe=br+1),pt<=br&&(At=br-1)}}function M(ot,Ue,pt,Xe){_(ot,pt,Xe),_(Ue,2*pt,2*Xe),_(Ue,2*pt+1,2*Xe+1)}function _(ot,Ue,pt){var Xe=ot[Ue];ot[Ue]=ot[pt],ot[pt]=Xe}function O(ot,Ue,pt,Xe){var At=ot-pt,kt=Ue-Xe;return At*At+kt*kt}var R=function(ot){return ot[0]},B=function(ot){return ot[1]},H=function(Ue,pt,Xe,At,kt){void 0===pt&&(pt=R),void 0===Xe&&(Xe=B),void 0===At&&(At=64),void 0===kt&&(kt=Float64Array),this.nodeSize=At,this.points=Ue;for(var Yt=Ue.length<65536?Uint16Array:Uint32Array,Er=this.ids=new Yt(Ue.length),ge=this.coords=new kt(2*Ue.length),de=0;de<Ue.length;de++)Er[de]=de,ge[2*de]=pt(Ue[de]),ge[2*de+1]=Xe(Ue[de]);L(Er,ge,At,0,Er.length-1,0)};H.prototype.range=function(Ue,pt,Xe,At){return function(ot,Ue,pt,Xe,At,kt,Yt){for(var de,oe,Er=[0,ot.length-1,0],ge=[];Er.length;){var me=Er.pop(),Me=Er.pop(),Ge=Er.pop();if(Me-Ge<=Yt)for(var gt=Ge;gt<=Me;gt++)oe=Ue[2*gt+1],(de=Ue[2*gt])>=pt&&de<=At&&oe>=Xe&&oe<=kt&&ge.push(ot[gt]);else{var br=Math.floor((Ge+Me)/2);oe=Ue[2*br+1],(de=Ue[2*br])>=pt&&de<=At&&oe>=Xe&&oe<=kt&&ge.push(ot[br]);var Nr=(me+1)%2;(0===me?pt<=de:Xe<=oe)&&(Er.push(Ge),Er.push(br-1),Er.push(Nr)),(0===me?At>=de:kt>=oe)&&(Er.push(br+1),Er.push(Me),Er.push(Nr))}}return ge}(this.ids,this.coords,Ue,pt,Xe,At,this.nodeSize)},H.prototype.within=function(Ue,pt,Xe){return function(ot,Ue,pt,Xe,At,kt){for(var Yt=[0,ot.length-1,0],Er=[],ge=At*At;Yt.length;){var de=Yt.pop(),oe=Yt.pop(),me=Yt.pop();if(oe-me<=kt)for(var Me=me;Me<=oe;Me++)O(Ue[2*Me],Ue[2*Me+1],pt,Xe)<=ge&&Er.push(ot[Me]);else{var Ge=Math.floor((me+oe)/2),gt=Ue[2*Ge],br=Ue[2*Ge+1];O(gt,br,pt,Xe)<=ge&&Er.push(ot[Ge]);var Nr=(de+1)%2;(0===de?pt-At<=gt:Xe-At<=br)&&(Yt.push(me),Yt.push(Ge-1),Yt.push(Nr)),(0===de?pt+At>=gt:Xe+At>=br)&&(Yt.push(Ge+1),Yt.push(oe),Yt.push(Nr))}}return Er}(this.ids,this.coords,Ue,pt,Xe,this.nodeSize)};var ot,G={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(ot){return ot}},be=Math.fround||(ot=new Float32Array(1),function(Ue){return ot[0]=+Ue,ot[0]}),Be=function(Ue){this.options=Gt(Object.create(G),Ue),this.trees=new Array(this.options.maxZoom+1)};function j(ot,Ue,pt,Xe,At){return{x:be(ot),y:be(Ue),zoom:1/0,id:pt,parentId:-1,numPoints:Xe,properties:At}}function W(ot,Ue){var pt=ot.geometry.coordinates,At=pt[1];return{x:be(Dt(pt[0])),y:be(Et(At)),zoom:1/0,index:Ue,parentId:-1}}function Ke(ot){return{type:"Feature",id:ot.id,properties:xt(ot),geometry:{type:"Point",coordinates:[ut(ot.x),tt(ot.y)]}}}function xt(ot){var Ue=ot.numPoints,pt=Ue>=1e4?Math.round(Ue/1e3)+"k":Ue>=1e3?Math.round(Ue/100)/10+"k":Ue;return Gt(Gt({},ot.properties),{cluster:!0,cluster_id:ot.id,point_count:Ue,point_count_abbreviated:pt})}function Dt(ot){return ot/360+.5}function Et(ot){var Ue=Math.sin(ot*Math.PI/180),pt=.5-.25*Math.log((1+Ue)/(1-Ue))/Math.PI;return pt<0?0:pt>1?1:pt}function ut(ot){return 360*(ot-.5)}function tt(ot){var Ue=(180-360*ot)*Math.PI/180;return 360*Math.atan(Math.exp(Ue))/Math.PI-90}function Gt(ot,Ue){for(var pt in Ue)ot[pt]=Ue[pt];return ot}function Q(ot){return ot.x}function Vt(ot){return ot.y}return Be.prototype.load=function(Ue){var pt=this.options,Xe=pt.log,At=pt.minZoom,kt=pt.maxZoom,Yt=pt.nodeSize;Xe&&console.time("total time");var Er="prepare "+Ue.length+" points";Xe&&console.time(Er),this.points=Ue;for(var ge=[],de=0;de<Ue.length;de++)!Ue[de].geometry||ge.push(W(Ue[de],de));this.trees[kt+1]=new H(ge,Q,Vt,Yt,Float32Array),Xe&&console.timeEnd(Er);for(var oe=kt;oe>=At;oe--){var me=+Date.now();ge=this._cluster(ge,oe),this.trees[oe]=new H(ge,Q,Vt,Yt,Float32Array),Xe&&console.log("z%d: %d clusters in %dms",oe,ge.length,+Date.now()-me)}return Xe&&console.timeEnd("total time"),this},Be.prototype.getClusters=function(Ue,pt){var Xe=((Ue[0]+180)%360+360)%360-180,At=Math.max(-90,Math.min(90,Ue[1])),kt=180===Ue[2]?180:((Ue[2]+180)%360+360)%360-180,Yt=Math.max(-90,Math.min(90,Ue[3]));if(Ue[2]-Ue[0]>=360)Xe=-180,kt=180;else if(Xe>kt){var Er=this.getClusters([Xe,At,180,Yt],pt),ge=this.getClusters([-180,At,kt,Yt],pt);return Er.concat(ge)}for(var de=this.trees[this._limitZoom(pt)],me=[],Me=0,Ge=de.range(Dt(Xe),Et(Yt),Dt(kt),Et(At));Me<Ge.length;Me+=1){var br=de.points[Ge[Me]];me.push(br.numPoints?Ke(br):this.points[br.index])}return me},Be.prototype.getChildren=function(Ue){var pt=this._getOriginId(Ue),Xe=this._getOriginZoom(Ue),At="No cluster with the specified id.",kt=this.trees[Xe];if(!kt)throw new Error(At);var Yt=kt.points[pt];if(!Yt)throw new Error(At);for(var Er=this.options.radius/(this.options.extent*Math.pow(2,Xe-1)),de=[],oe=0,me=kt.within(Yt.x,Yt.y,Er);oe<me.length;oe+=1){var Ge=kt.points[me[oe]];Ge.parentId===Ue&&de.push(Ge.numPoints?Ke(Ge):this.points[Ge.index])}if(0===de.length)throw new Error(At);return de},Be.prototype.getLeaves=function(Ue,pt,Xe){var At=[];return this._appendLeaves(At,Ue,pt=pt||10,Xe=Xe||0,0),At},Be.prototype.getTile=function(Ue,pt,Xe){var At=this.trees[this._limitZoom(Ue)],kt=Math.pow(2,Ue),Yt=this.options,de=Yt.radius/Yt.extent,oe=(Xe-de)/kt,me=(Xe+1+de)/kt,Me={features:[]};return this._addTileFeatures(At.range((pt-de)/kt,oe,(pt+1+de)/kt,me),At.points,pt,Xe,kt,Me),0===pt&&this._addTileFeatures(At.range(1-de/kt,oe,1,me),At.points,kt,Xe,kt,Me),pt===kt-1&&this._addTileFeatures(At.range(0,oe,de/kt,me),At.points,-1,Xe,kt,Me),Me.features.length?Me:null},Be.prototype.getClusterExpansionZoom=function(Ue){for(var pt=this._getOriginZoom(Ue)-1;pt<=this.options.maxZoom;){var Xe=this.getChildren(Ue);if(pt++,1!==Xe.length)break;Ue=Xe[0].properties.cluster_id}return pt},Be.prototype._appendLeaves=function(Ue,pt,Xe,At,kt){for(var Er=0,ge=this.getChildren(pt);Er<ge.length;Er+=1){var de=ge[Er],oe=de.properties;if(oe&&oe.cluster?kt+oe.point_count<=At?kt+=oe.point_count:kt=this._appendLeaves(Ue,oe.cluster_id,Xe,At,kt):kt<At?kt++:Ue.push(de),Ue.length===Xe)break}return kt},Be.prototype._addTileFeatures=function(Ue,pt,Xe,At,kt,Yt){for(var Er=0,ge=Ue;Er<ge.length;Er+=1){var oe=pt[ge[Er]],me=oe.numPoints,Me=void 0,Ge=void 0,gt=void 0;if(me)Me=xt(oe),Ge=oe.x,gt=oe.y;else{var br=this.points[oe.index];Me=br.properties,Ge=Dt(br.geometry.coordinates[0]),gt=Et(br.geometry.coordinates[1])}var Nr={type:1,geometry:[[Math.round(this.options.extent*(Ge*kt-Xe)),Math.round(this.options.extent*(gt*kt-At))]],tags:Me},cn=void 0;me?cn=oe.id:this.options.generateId?cn=oe.index:this.points[oe.index].id&&(cn=this.points[oe.index].id),void 0!==cn&&(Nr.id=cn),Yt.features.push(Nr)}},Be.prototype._limitZoom=function(Ue){return Math.max(this.options.minZoom,Math.min(+Ue,this.options.maxZoom+1))},Be.prototype._cluster=function(Ue,pt){for(var Xe=[],At=this.options,Er=At.reduce,ge=At.minPoints,de=At.radius/(At.extent*Math.pow(2,pt)),oe=0;oe<Ue.length;oe++){var me=Ue[oe];if(!(me.zoom<=pt)){me.zoom=pt;for(var Me=this.trees[pt+1],Ge=Me.within(me.x,me.y,de),gt=me.numPoints||1,br=gt,Nr=0,cn=Ge;Nr<cn.length;Nr+=1){var Mt=Me.points[cn[Nr]];Mt.zoom>pt&&(br+=Mt.numPoints||1)}if(br>gt&&br>=ge){for(var Le=me.x*gt,we=me.y*gt,at=Er&&gt>1?this._map(me,!0):null,Re=(oe<<5)+(pt+1)+this.points.length,qt=0,Pr=Ge;qt<Pr.length;qt+=1){var fr=Me.points[Pr[qt]];if(!(fr.zoom<=pt)){fr.zoom=pt;var Br=fr.numPoints||1;Le+=fr.x*Br,we+=fr.y*Br,fr.parentId=Re,Er&&(at||(at=this._map(me,!0)),Er(at,this._map(fr)))}}me.parentId=Re,Xe.push(j(Le/br,we/br,Re,br,at))}else if(Xe.push(me),br>1)for(var $r=0,C=Ge;$r<C.length;$r+=1){var Ve=Me.points[C[$r]];Ve.zoom<=pt||(Ve.zoom=pt,Xe.push(Ve))}}}return Xe},Be.prototype._getOriginId=function(Ue){return Ue-this.points.length>>5},Be.prototype._getOriginZoom=function(Ue){return(Ue-this.points.length)%32},Be.prototype._map=function(Ue,pt){if(Ue.numPoints)return pt?Gt({},Ue.properties):Ue.properties;var Xe=this.points[Ue.index].properties,At=this.options.map(Xe);return pt&&At===Xe?Gt({},At):At},Be}()},96847:ie=>{ie.exports.RADIUS=6378137,ie.exports.FLATTENING=1/298.257223563,ie.exports.POLAR_RADIUS=6356752.3142},31073:(ie,L,y)=>{"use strict";y.r(L),y.d(L,{DashboardModule:()=>Gg});var M={};y.r(M),y.d(M,{add:()=>si,angle:()=>oi,bezier:()=>rr,ceil:()=>Ei,clone:()=>pr,copy:()=>mi,create:()=>or,cross:()=>Fr,dist:()=>Xi,distance:()=>Oe,div:()=>Bi,divide:()=>Pi,dot:()=>ir,equals:()=>_a,exactEquals:()=>Ti,floor:()=>re,forEach:()=>Wi,fromValues:()=>On,hermite:()=>Pn,inverse:()=>Sr,len:()=>Ho,length:()=>mn,lerp:()=>Rn,max:()=>_e,min:()=>pe,mul:()=>Gi,multiply:()=>Ki,negate:()=>wt,normalize:()=>Kt,random:()=>Sn,rotateX:()=>_n,rotateY:()=>Oi,rotateZ:()=>ta,round:()=>V,scale:()=>ae,scaleAndAdd:()=>xe,set:()=>hi,sqrDist:()=>to,sqrLen:()=>Za,squaredDistance:()=>fe,squaredLength:()=>Ae,str:()=>Vi,sub:()=>Ia,subtract:()=>ai,transformMat3:()=>fn,transformMat4:()=>an,transformQuat:()=>Di,zero:()=>Ji});var _=y(38583),c=y(39895),g=y(37716),O=y(16704),R=y(75134),B=y(47289),H=y(66518),G=y(41885),be=y(59553),Be=y(99187),j=y(93512),W=y(42837),Ke=y(30832),xt=y(42624);function Dt(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Et(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Dt(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Dt(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Gt=0,Q=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=l.call(this),(0,j.Z)((0,H.Z)(h),"controlOption",void 0),(0,j.Z)((0,H.Z)(h),"container",void 0),(0,j.Z)((0,H.Z)(h),"sceneContainer",void 0),(0,j.Z)((0,H.Z)(h),"mapsService",void 0),(0,j.Z)((0,H.Z)(h),"renderService",void 0),(0,j.Z)((0,H.Z)(h),"layerService",void 0),(0,j.Z)((0,H.Z)(h),"controlService",void 0),(0,j.Z)((0,H.Z)(h),"isShow",void 0),h.controlOption=Et(Et({},h.getDefault()),u||{}),h}return(0,B.Z)(i,[{key:"getDefault",value:function(){return{position:W.PositionType.TOPRIGHT,name:"".concat(Gt++)}}},{key:"setPosition",value:function(){var h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W.PositionType.BOTTOMRIGHT,v=this.controlService;return v&&v.removeControl(this),this.controlOption.position=h,v&&v.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(h){this.mapsService=h.get(W.vK.IMapService),this.renderService=h.get(W.vK.IRendererService),this.layerService=h.get(W.vK.ILayerService),this.controlService=h.get(W.vK.IControlService),this.sceneContainer=h,this.isShow=!0,this.container=this.onAdd();var v=this.container,w=this.controlOption.position,I=this.controlService.controlCorners[w];return Ke.SO.addClass(v,"l7-control"),-1!==w.indexOf("bottom")?I.insertBefore(v,I.firstChild):I.appendChild(v),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){Ke.SO.addClass(this.container,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){Ke.SO.removeClass(this.container,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;Ke.SO.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(h){if(this.mapsService&&h&&h.screenX>0&&h.screenY>0){var v=this.mapsService.getContainer();null!==v&&v.focus()}}}]),i}(xt.EventEmitter);var Ue=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=l.call(this,u),(0,j.Z)((0,H.Z)(h),"layerControlInputs",void 0),(0,j.Z)((0,H.Z)(h),"layers",void 0),(0,j.Z)((0,H.Z)(h),"lastZIndex",void 0),(0,j.Z)((0,H.Z)(h),"handlingClick",void 0),(0,j.Z)((0,H.Z)(h),"layersLink",void 0),(0,j.Z)((0,H.Z)(h),"baseLayersList",void 0),(0,j.Z)((0,H.Z)(h),"separator",void 0),(0,j.Z)((0,H.Z)(h),"overlaysList",void 0),(0,j.Z)((0,H.Z)(h),"form",void 0),h.layerControlInputs=[],h.layers=[],h.lastZIndex=0,h.handlingClick=!1,h.initLayers(),(0,Ke.Ev)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],(0,H.Z)(h)),h}return(0,B.Z)(i,[{key:"getDefault",value:function(){return{collapsed:!0,position:W.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var h=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(v){v.layer.on("remove",h.onLayerChange),v.layer.on("add",h.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(h,v){return this.addLayer(h,v,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var v=this.renderService.getViewportSize().height;Ke.SO.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var w=v-(this.container.offsetTop+50);return w<this.form.clientHeight?(Ke.SO.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=w+"px"):Ke.SO.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return Ke.SO.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var h=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(v){v.layer.off("remove",h.onLayerChange),v.layer.off("add",h.onLayerChange)}))}},{key:"initLayout",value:function(){var h="l7-control-layers",v=this.container=Ke.SO.create("div",h),w=this.controlOption.collapsed;v.setAttribute("aria-haspopup","true");var I=this.form=Ke.SO.create("form",h+"-list");w&&(this.mapsService.on("click",this.collapse),v.addEventListener("mouseenter",this.expand),v.addEventListener("mouseleave",this.collapse)),this.layersLink=Ke.SO.create("a",h+"-toggle",v),this.layersLink.title="Layers",w||this.expand(),this.baseLayersList=Ke.SO.create("div",h+"-base",I),this.separator=Ke.SO.create("div",h+"-separator",I),this.overlaysList=Ke.SO.create("div",h+"-overlays",I),v.appendChild(I)}},{key:"initLayers",value:function(){var h=this,v=this.controlOption,w=v.baseLayers,I=void 0===w?{}:w,k=v.overlayers,X=void 0===k?{}:k;Object.keys(I).forEach(function(le,se){h.addLayer(I[le],le,!1)}),Object.keys(X).forEach(function(le,se){h.addLayer(X[le],le,!0)})}},{key:"update",value:function(){if(!this.container)return this;Ke.SO.empty(this.baseLayersList),Ke.SO.empty(this.overlaysList),this.layerControlInputs=[];var h,v,w,I,k=0;for(w=0;w<this.layers.length;w++)this.addItem(I=this.layers[w]),v=v||I.overlay,h=h||!I.overlay,k+=I.overlay?0:1;return this.controlOption.hideSingleBase&&(this.baseLayersList.style.display=(h=h&&k>1)?"":"none"),this.separator.style.display=v&&h?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var v,w,h=this.layerControlInputs,I=this.mapsService.getZoom(),k=h.length-1;k>=0;k--)if((w=this.layerService.getLayer((v=h[k]).layerId))&&w.inited){var X=w.getMinZoom(),le=w.getMaxZoom();v.disabled=I<X||I>le}}},{key:"addLayer",value:function(h,v,w){this.mapsService&&(h.on("add",this.onLayerChange),h.on("remove",this.onLayerChange)),this.layers.push({layer:h,name:v,overlay:w});var I=this.controlOption,X=I.sortFunction,le=I.autoZIndex;I.sortLayers&&this.layers.sort(function(se,Fe){return X(se.layer,Fe.layer,se.name,Fe.name)}),le&&h.setZIndex&&(this.lastZIndex++,h.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(h){this.handlingClick||this.update();var v=this.layerService.getLayer(h.target.layerId),w=null!=v&&v.overlay?"add"===h.type?"overlayadd":"overlayremove":"add"===h.type?"baselayerchange":null;w&&this.emit(w,v)}},{key:"createRadioElement",value:function(h,v){var w='<input type="radio" class="l7-control-layers-selector" name="'+h+'"'+(v?' checked="checked"':"")+"/>",I=document.createElement("div");return I.innerHTML=w,I.firstChild}},{key:"addItem",value:function(h){var k,v=document.createElement("label"),w=this.layerService.getLayer(h.layer.id),I=w&&w.inited&&h.layer.isVisible();h.overlay?((k=document.createElement("input")).type="checkbox",k.className="l7-control-layers-selector",k.defaultChecked=I):k=this.createRadioElement("l7-base-layers",I),this.layerControlInputs.push(k),k.layerId=h.layer.id,k.addEventListener("click",this.onInputClick);var X=document.createElement("span");X.innerHTML=" "+h.name;var le=document.createElement("div");return v.appendChild(le),le.appendChild(k),le.appendChild(X),(h.overlay?this.overlaysList:this.baseLayersList).appendChild(v),this.checkDisabledLayers(),v}},{key:"onInputClick",value:function(){var v,w,h=this.layerControlInputs,I=[],k=[];this.handlingClick=!0;for(var X=h.length-1;X>=0;X--)w=this.layerService.getLayer((v=h[X]).layerId),v.checked?I.push(w):v.checked||k.push(w);k.forEach(function(le){le.hide()}),I.forEach(function(le){le.show()}),this.handlingClick=!1}}]),i}(Q);var At=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),l.apply(this,arguments)}return(0,B.Z)(i,[{key:"getDefault",value:function(){return{position:W.PositionType.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var v=Ke.SO.create("div","l7-control-logo"),w=Ke.SO.create("a","l7-ctrl-logo");return w.target="_blank",w.rel="noopener nofollow",w.href="https://antv.alipay.com/l7",w.setAttribute("aria-label","AntV logo"),w.setAttribute("rel","noopener nofollow"),v.appendChild(w),v}},{key:"onRemove",value:function(){return null}}]),i}(Q);var Er=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=l.call(this,u),(0,j.Z)((0,H.Z)(h),"mScale",void 0),(0,j.Z)((0,H.Z)(h),"iScale",void 0),(0,Ke.Ev)(["update"],(0,H.Z)(h)),h}return(0,B.Z)(i,[{key:"getDefault",value:function(){return{position:W.PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var h="l7-control-scale",v=Ke.SO.create("div",h);this.addScales(h+"-line",v);var w=this.controlOption.updateWhenIdle;return this.mapsService.on(w?"moveend":"mapmove",this.update),this.mapsService.on(w?"zoomend":"zoomchange",this.update),this.update(),v}},{key:"onRemove",value:function(){var h=this.controlOption.updateWhenIdle;this.mapsService.off(h?"zoomend":"zoomchange",this.update),this.mapsService.off(h?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var h=this.mapsService,v=this.controlOption.maxWidth,w=h.getSize()[1]/2,I=h.containerToLngLat([0,w]),k=h.containerToLngLat([v,w]),X=(0,Ke.yM)([I.lng,I.lat],[k.lng,k.lat]);this.updateScales(X)}},{key:"updateScales",value:function(h){var v=this.controlOption,I=v.imperial;v.metric&&h&&this.updateMetric(h),I&&h&&this.updateImperial(h)}},{key:"updateMetric",value:function(h){var v=this.getRoundNum(h);this.updateScale(this.mScale,v<1e3?v+" m":v/1e3+" km",v/h)}},{key:"updateImperial",value:function(h){var w,I,k,v=3.2808399*h;v>5280?(I=this.getRoundNum(w=v/5280),this.updateScale(this.iScale,I+" mi",I/w)):(k=this.getRoundNum(v),this.updateScale(this.iScale,k+" ft",k/v))}},{key:"updateScale",value:function(h,v,w){h.style.width=Math.round(this.controlOption.maxWidth*w)+"px",h.innerHTML=v}},{key:"getRoundNum",value:function(h){var v=Math.pow(10,(Math.floor(h)+"").length-1),w=h/v;return v*(w>=10?10:w>=5?5:w>=3?3:w>=2?2:1)}},{key:"addScales",value:function(h,v){var w=this.controlOption,k=w.imperial;w.metric&&(this.mScale=Ke.SO.create("div",h,v)),k&&(this.iScale=Ke.SO.create("div",h,v))}}]),i}(Q);var oe=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=l.call(this,u),(0,j.Z)((0,H.Z)(h),"disabled",void 0),(0,j.Z)((0,H.Z)(h),"zoomInButton",void 0),(0,j.Z)((0,H.Z)(h),"zoomOutButton",void 0),(0,Ke.Ev)(["updateDisabled","zoomIn","zoomOut"],(0,H.Z)(h)),h}return(0,B.Z)(i,[{key:"getDefault",value:function(){return{position:W.PositionType.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var h="l7-control-zoom",v=Ke.SO.create("div",h+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,h+"-in",v,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,h+"-out",v,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),v}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(h,v,w,I,k){var X=Ke.SO.create("a",w,I);return X.innerHTML=h,X.title=v,X.href="javascript:void(0)",X.addEventListener("click",k),X}},{key:"updateDisabled",value:function(){var h=this.mapsService,v="l7-disabled";Ke.SO.removeClass(this.zoomInButton,v),Ke.SO.removeClass(this.zoomOutButton,v),(this.disabled||h.getZoom()<=h.getMinZoom())&&Ke.SO.addClass(this.zoomOutButton,v),(this.disabled||h.getZoom()>=h.getMaxZoom())&&Ke.SO.addClass(this.zoomInButton,v)}}]),i}(Q);function me(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Me(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?me(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):me(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var br=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=l.call(this),(0,j.Z)((0,H.Z)(h),"markerOption",void 0),(0,j.Z)((0,H.Z)(h),"defaultMarker",void 0),(0,j.Z)((0,H.Z)(h),"popup",void 0),(0,j.Z)((0,H.Z)(h),"mapsService",void 0),(0,j.Z)((0,H.Z)(h),"sceneSerive",void 0),(0,j.Z)((0,H.Z)(h),"lngLat",void 0),(0,j.Z)((0,H.Z)(h),"scene",void 0),(0,j.Z)((0,H.Z)(h),"added",!1),(0,j.Z)((0,H.Z)(h),"eventHandle",function(v){h.emit(v.type,{target:v,data:h.markerOption.extData,lngLat:h.lngLat})}),h.markerOption=Me(Me({},h.getDefault()),u),(0,Ke.Ev)(["update","onMove","onUp","addDragHandler","onMapClick"],(0,H.Z)(h)),h.init(),h}return(0,B.Z)(i,[{key:"getDefault",value:function(){return{element:void 0,anchor:Ke.bV.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(h){this.scene=h,this.mapsService=h.get(W.vK.IMapService),this.sceneSerive=h.get(W.vK.ISceneService);var w=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(w),this.registerMarkerEvent(w),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var h=this.markerOption.element;return h&&Ke.SO.remove(h),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(h){return this.lngLat=h,Array.isArray(h)&&(this.lngLat={lng:h[0],lat:h[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(h){var v=this;if(!this.added)return this.once("added",function(){v.setElement(h)}),this;var w=this.markerOption.element;return w&&Ke.SO.remove(w),this.markerOption.element=h,this.init(),this.mapsService.getMarkerContainer().appendChild(h),this.registerMarkerEvent(h),this.update(),this}},{key:"openPopup",value:function(){var h=this;if(!this.added)return this.once("added",function(){h.openPopup()}),this;var v=this.popup;return v?(v.isOpen()||v.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var h=this;this.added||this.once("added",function(){h.closePopup()});var v=this.popup;return v&&v.remove(),this}},{key:"setPopup",value:function(h){return this.popup=h,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var h=this.popup;return h?(h.isOpen()?h.remove():h.addTo(this.scene),this):this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(h){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(h){this.markerOption.extData=h}},{key:"update",value:function(){if(this.mapsService){var h=this.markerOption,v=h.element,w=h.anchor;this.updatePosition(),Ke.SO.setTransform(v,"".concat(Ke.rQ[w]))}}},{key:"onMapClick",value:function(h){this.popup&&this.markerOption.element&&this.togglePopup()}},{key:"updatePosition",value:function(){if(this.mapsService){var h=this.markerOption,v=h.element,w=h.offsets,I=this.lngLat,k=I.lng,X=I.lat,le=this.mapsService.getBounds(),se=this.mapsService.lngLatToContainer([k,X]);if(v){v.style.display="block";var Fe=this.mapsService.getContainer(),rt=0,Bt=0;if(Fe&&(rt=Fe.scrollWidth,Bt=Fe.scrollHeight),Math.abs(le[0][0])>180||Math.abs(le[1][0])>180){if(se.x>rt){var Wt=this.mapsService.lngLatToContainer([k-360,X]);se.x=Wt.x}if(se.x<0){var Ar=this.mapsService.lngLatToContainer([k+360,X]);se.x=Ar.x}}(se.x>rt||se.x<0||se.y>Bt||se.y<0)&&(v.style.display="none"),v.style.left=se.x+w[0]+"px",v.style.top=se.y-w[1]+"px"}}}},{key:"init",value:function(){var h=this,v=this.markerOption.element,w=this.markerOption,I=w.color,k=w.anchor;if(!v){this.defaultMarker=!0,v=Ke.SO.create("div"),this.markerOption.element=v;var X=document.createElementNS("http://www.w3.org/2000/svg","svg");X.setAttributeNS(null,"display","block"),X.setAttributeNS(null,"height","48px"),X.setAttributeNS(null,"width","48px"),X.setAttributeNS(null,"viewBox","0 0 1024 1024");var le=document.createElementNS("http://www.w3.org/2000/svg","path");le.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),le.setAttributeNS(null,"fill",I),X.appendChild(le),v.appendChild(X)}Ke.SO.addClass(v,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(se){var Fe,rt,Bt=(null===(Fe=h.markerOption)||void 0===Fe?void 0:Fe.style)&&(null===(rt=h.markerOption)||void 0===rt?void 0:rt.style[se]);v&&(v.style[se]=Bt)}),v.addEventListener("click",function(se){h.onMapClick(se)}),v.addEventListener("click",this.eventHandle),(0,Ke.zi)(v,k,"marker")}},{key:"registerMarkerEvent",value:function(h){h.addEventListener("mousemove",this.eventHandle),h.addEventListener("click",this.eventHandle),h.addEventListener("mousedown",this.eventHandle),h.addEventListener("mouseup",this.eventHandle),h.addEventListener("dblclick",this.eventHandle),h.addEventListener("contextmenu",this.eventHandle),h.addEventListener("mouseover",this.eventHandle),h.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var h=this.getElement();h.removeEventListener("mousemove",this.eventHandle),h.removeEventListener("click",this.eventHandle),h.removeEventListener("mousedown",this.eventHandle),h.removeEventListener("mouseup",this.eventHandle),h.removeEventListener("dblclick",this.eventHandle),h.removeEventListener("contextmenu",this.eventHandle),h.removeEventListener("mouseover",this.eventHandle),h.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(h){throw new Error("Method not implemented.")}},{key:"onUp",value:function(h){throw new Error("Method not implemented.")}}]),i}(xt.EventEmitter),Nr=y(3912),cn=y.n(Nr),Ir=y(20878),Mt=y.n(Ir);function Le(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function we(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Le(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Le(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Pr(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function er(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Pr(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Pr(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}!function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h,v;return(0,R.Z)(this,i),v=l.call(this),(0,j.Z)((0,H.Z)(v),"markers",[]),(0,j.Z)((0,H.Z)(v),"markerLayerOption",void 0),(0,j.Z)((0,H.Z)(v),"clusterIndex",void 0),(0,j.Z)((0,H.Z)(v),"points",[]),(0,j.Z)((0,H.Z)(v),"clusterMarkers",[]),(0,j.Z)((0,H.Z)(v),"mapsService",void 0),(0,j.Z)((0,H.Z)(v),"scene",void 0),(0,j.Z)((0,H.Z)(v),"zoom",void 0),(0,j.Z)((0,H.Z)(v),"bbox",void 0),v.markerLayerOption=cn()(v.getDefault(),u),(0,Ke.Ev)(["update"],(0,H.Z)(v)),v.zoom=(null===(h=v.markerLayerOption.clusterOption)||void 0===h?void 0:h.zoom)||-99,v}(0,B.Z)(i,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(h){return this.scene=h,this.mapsService=h.get(W.vK.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(h){this.markerLayerOption.cluster&&this.addPoint(h,this.markers.length),this.markers.push(h)}},{key:"removeMarker",value:function(h){this.markers.indexOf(h);var v=this.markers.indexOf(h);v>-1&&this.markers.splice(v,1)}},{key:"hide",value:function(){this.markers.map(function(h){h.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(h){h.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var h=this;this.getMarkers().forEach(function(v){v.addTo(h.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(h){h.remove()}),this.clusterMarkers.forEach(function(h){h.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(h,v){var w=h.getLnglat(),X={geometry:{type:"Point",coordinates:[w.lng,w.lat]},properties:we(we({},h.getExtData()),{},{marker_id:v})};this.points.push(X)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var h=this.markerLayerOption.clusterOption,v=h.radius,w=h.minZoom,I=void 0===w?0:w,k=h.maxZoom;this.clusterIndex=new(Mt())({radius:v,minZoom:I,maxZoom:k}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(h,v){var w=this,I=h[0].concat(h[1]),k=this.clusterIndex.getClusters(I,v);this.clusterMarkers.forEach(function(X){X.remove()}),this.clusterMarkers=[],k.forEach(function(X){var le,se=w.markerLayerOption.clusterOption,Fe=se.field,rt=se.method;if(X.properties&&null!==(le=X.properties)&&void 0!==le&&le.cluster_id){var Bt,Wt=w.getLeaves(null===(Bt=X.properties)||void 0===Bt?void 0:Bt.cluster_id);if(X.properties.clusterData=Wt,Fe&&rt){var Ar=null==Wt?void 0:Wt.map(function(Wn){return(0,j.Z)({},Fe,Wn.properties[Fe])}),jr=Ke.a5.getColumn(Ar,Fe),sn=Ke.a5.getSatByColumn(rt,jr);X.properties["point_"+rt]=sn.toFixed(2)}}var Mn=w.clusterMarker(X);w.clusterMarkers.push(Mn),Mn.addTo(w.scene)})}},{key:"getLeaves",value:function(h){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return h?this.clusterIndex.getLeaves(h,v,w):null}},{key:"clusterMarker",value:function(h){var I=this.markerLayerOption.clusterOption.element,k=void 0===I?this.generateElement.bind(this):I;return new br({element:k(h)}).setLnglat({lng:h.geometry.coordinates[0],lat:h.geometry.coordinates[1]})}},{key:"normalMarker",value:function(h){return this.markers[h.properties.marker_id]}},{key:"update",value:function(){var h=this.mapsService.getZoom(),v=this.mapsService.getBounds();(!this.bbox||Math.abs(h-this.zoom)>=1||!(0,Ke.oO)(this.bbox,v))&&(this.bbox=(0,Ke.yA)(v,.5),this.zoom=Math.floor(h),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(h){var v=Ke.SO.create("div","l7-marker-cluster"),w=Ke.SO.create("div","",v),I=Ke.SO.create("span","",w),k=this.markerLayerOption.clusterOption,X=k.field,le=k.method;return h.properties.point_count=h.properties.point_count||1,I.textContent=X&&le?h.properties["point_"+le]||h.properties[X]:h.properties.point_count,v}}])}(xt.EventEmitter),function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u){var h;return(0,R.Z)(this,i),h=l.call(this),(0,j.Z)((0,H.Z)(h),"popupOption",void 0),(0,j.Z)((0,H.Z)(h),"mapsService",void 0),(0,j.Z)((0,H.Z)(h),"sceneSerive",void 0),(0,j.Z)((0,H.Z)(h),"lngLat",void 0),(0,j.Z)((0,H.Z)(h),"content",void 0),(0,j.Z)((0,H.Z)(h),"closeButton",void 0),(0,j.Z)((0,H.Z)(h),"timeoutInstance",void 0),(0,j.Z)((0,H.Z)(h),"container",void 0),(0,j.Z)((0,H.Z)(h),"tip",void 0),(0,j.Z)((0,H.Z)(h),"scene",void 0),h.popupOption=er(er({},h.getdefault()),u),(0,Ke.Ev)(["update","onClickClose","remove"],(0,H.Z)(h)),h}(0,B.Z)(i,[{key:"addTo",value:function(h){var v=this;return this.mapsService=h.get(W.vK.IMapService),this.sceneSerive=h.get(W.vK.ISceneService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=h,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){v.mapsService.on("click",v.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(h){var I,v=window.document.createDocumentFragment(),w=window.document.createElement("body");for(w.innerHTML=h;I=w.firstChild;)v.appendChild(I);return this.setDOMContent(v)}},{key:"setLnglat",value:function(h){return this.lngLat=h,Array.isArray(h)&&(this.lngLat={lng:h[0],lat:h[1]}),this.mapsService&&(this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(h){return this.setDOMContent(window.document.createTextNode(h))}},{key:"setMaxWidth",value:function(h){return this.popupOption.maxWidth=h,this.update(),this}},{key:"setDOMContent",value:function(h){return this.createContent(),this.content.appendChild(h),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&Ke.SO.remove(this.content),this.content=Ke.SO.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=Ke.SO.create("button","l7-popup-close-button",this.content),this.popupOption.closeButtonOffsets&&(this.closeButton.style.right=this.popupOption.closeButtonOffsets[0]+"px",this.closeButton.style.top=this.popupOption.closeButtonOffsets[1]+"px"),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(h,v,w){var I=window.document.createElement(h);return void 0!==v&&(I.className=v),w&&w.appendChild(I),I}},{key:"removeDom",value:function(h){h.parentNode&&h.parentNode.removeChild(h)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:Ke.bV.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(h){h.stopPropagation&&h.stopPropagation(),this.remove()}},{key:"update",value:function(){var h=this,w=this.popupOption,I=w.className,k=w.maxWidth,X=w.anchor;if(this.mapsService&&this.lngLat&&this.content){var le=this.mapsService.getMarkerContainer();!this.container&&le&&(this.container=this.creatDom("div","l7-popup",le),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),I&&I.split(" ").forEach(function(Fe){return h.container.classList.add(Fe)}),this.popupOption.stopPropagation&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Fe){h.container.addEventListener(Fe,function(rt){rt.stopPropagation()})})),k&&this.container.style.maxWidth!==k&&(this.container.style.maxWidth=k),this.updatePosition(),Ke.SO.setTransform(this.container,"".concat(Ke.rQ[X])),(0,Ke.zi)(this.container,X,"popup")}}},{key:"updatePosition",value:function(){if(this.mapsService){var h=this.lngLat,I=this.popupOption.offsets,k=this.mapsService.lngLatToContainer([h.lng,h.lat]);this.container.style.left=k.x+I[0]+"px",this.container.style.top=k.y-I[1]+"px"}}}])}(xt.EventEmitter),function(n,l){if(l||(l=document),l){var i=l.head||l.getElementsByTagName("head")[0];if(!i){i=l.createElement("head");var u=l.body||l.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):l.documentElement.appendChild(i)}var h=l.createElement("style");h.type="text/css",h.styleSheet?h.styleSheet.cssText=n:h.appendChild(l.createTextNode(n)),i.appendChild(h)}}(".l7-marker-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: absolute;\n}\n\n.l7-marker {\n  position: absolute !important;\n  top: 0;\n  left: 0;\n  z-index: 5;\n  cursor: pointer;\n}\n\n.l7-marker-cluster {\n  background-clip: padding-box;\n  border-radius: 20px;\n  background-color: rgba(181, 226, 140, 0.6);\n  width: 40px;\n  height: 40px;\n}\n.l7-marker-cluster div {\n  width: 30px;\n  height: 30px;\n  margin-left: 5px;\n  margin-top: 5px;\n  text-align: center;\n  border-radius: 15px;\n  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n  background-color: rgba(110, 204, 57, 0.6);\n}\n.l7-marker-cluster span {\n  line-height: 30px;\n}\n\n.l7-popup-anchor-bottom,\n.l7-popup-anchor-bottom-left,\n.l7-popup-anchor-bottom-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: column-reverse;\n          flex-direction: column-reverse;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* layers control */\n\n.l7-control-layers {\n  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);\n  background: #fff;\n  border-radius: 5px;\n}\n.l7-popup-anchor-top,\n.l7-popup-anchor-top-left,\n.l7-popup-anchor-top-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.l7-popup-anchor-left {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n\n.l7-popup-anchor-right {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n}\n.l7-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  will-change: transform;\n  pointer-events: none;\n  z-index: 5;\n}\n.l7-popup-tip {\n  width: 0;\n  height: 0;\n  border: 10px solid transparent;\n  z-index: 1;\n}\n.l7-popup-anchor-top .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-top: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-top: none;\n  border-left: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-top: none;\n  border-right: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-bottom .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-bottom: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-bottom: none;\n  border-left: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-bottom: none;\n  border-right: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-left .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-left: none;\n  border-right-color: #fff;\n}\n\n.l7-popup-anchor-right .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-right: none;\n  border-left-color: #fff;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  padding: 0;\n  font-size: 25px;\n  line-height: 20px;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n.l7-popup-anchor-top-left .l7-popup-content {\n  border-top-left-radius: 0;\n}\n\n.l7-popup-anchor-top-right .l7-popup-content {\n  border-top-right-radius: 0;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-content {\n  border-bottom-left-radius: 0;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-content {\n  border-bottom-right-radius: 0;\n}\n\n.l7-popup-track-pointer {\n  display: none;\n}\n\n.l7-popup-track-pointer * {\n  pointer-events: none;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.l7-map:hover .l7-popup-track-pointer {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n\n.l7-map:active .l7-popup-track-pointer {\n  display: none;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* general toolbar styles */\n\n.l7-bar {\n  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n  border-radius: 4px;\n}\n.l7-bar a,\n.l7-bar a:hover {\n  background-color: #fff;\n  width: 30px;\n  height: 30px;\n  font-size: 20px;\n  display: block;\n  text-align: center;\n  text-decoration: none;\n  color: #8e9dab;\n}\n.l7-bar a,\n.l7-control-layers-toggle {\n  background-position: 50% 50%;\n  background-repeat: no-repeat;\n  display: block;\n}\n.l7-bar a:hover {\n  background-color: #f4f4f4;\n}\n.l7-bar a:first-child {\n  border-top-left-radius: 2px;\n  border-top-right-radius: 2px;\n}\n.l7-bar a:last-child {\n  border-bottom-left-radius: 2px;\n  border-bottom-right-radius: 2px;\n  border-bottom: none;\n}\n.l7-bar a.l7-disabled {\n  cursor: default;\n  background-color: #f4f4f4;\n  color: #bbb;\n}\n\n/* control positioning */\n\n.l7-control-container {\n  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;\n}\n.l7-control-hide {\n  display: none;\n}\n.l7-control {\n  position: relative;\n  z-index: 800;\n  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */\n  pointer-events: auto;\n}\n.l7-control {\n  float: left;\n  clear: both;\n}\n.l7-top,\n.l7-bottom {\n  position: absolute;\n  z-index: 1000;\n  pointer-events: none;\n}\n.l7-top {\n  top: 0;\n}\n.l7-right {\n  right: 0;\n}\n.l7-bottom {\n  bottom: 0;\n}\n.l7-left {\n  left: 0;\n}\n.l7-center {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: absolute;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.l7-bottom.l7-center,\n.l7-top.l7-center {\n  width: 100%;\n}\n.l7-right.l7-center,\n.l7-left.l7-center {\n  height: 100%;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.l7-top.l7-center,\n.l7-left.l7-center {\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start;\n}\n\n.l7-bottom.l7-center,\n.l7-right.l7-center {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n}\n\n.l7-center .l7-control {\n  margin-right: 10px;\n  margin-bottom: 10px;\n}\n\n.l7-control {\n  float: left;\n  clear: both;\n}\n.l7-right .l7-control {\n  float: right;\n}\n.l7-top .l7-control {\n  margin-top: 10px;\n}\n.l7-bottom .l7-control {\n  margin-bottom: 10px;\n}\n.l7-left .l7-control {\n  margin-left: 10px;\n}\n.l7-right .l7-control {\n  margin-right: 10px;\n}\n\n/* attribution and scale controls */\n\n.l7-control-container .l7-control-attribution {\n  background: #fff;\n  background: rgba(255, 255, 255, 0.7);\n  margin: 0;\n}\n.l7-control-attribution,\n.l7-control-scale-line {\n  padding: 0 5px;\n  color: #333;\n}\n.l7-control-attribution a {\n  text-decoration: none;\n}\n.l7-control-attribution a:hover {\n  text-decoration: underline;\n}\n.l7-container .l7-control-attribution,\n.l7-container .l7-control-scale {\n  font-size: 11px;\n  padding: 5px 5px 2px 5px;\n  background: rgba(255, 255, 255, 0.7);\n}\n.l7-left .l7-control-scale {\n  margin-left: 5px;\n}\n.l7-bottom .l7-control-scale {\n  margin-bottom: 5px;\n}\n.l7-control-scale-line {\n  border: 2px solid #000;\n  border-top: none;\n  color: #000;\n  line-height: 1.1;\n  padding: 2px 5px 1px;\n  font-size: 11px;\n  white-space: nowrap;\n  overflow: hidden;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n\n  background: #fff;\n}\n.l7-control-scale-line:not(:first-child) {\n  border-top: 2px solid #777;\n  border-bottom: none;\n  margin-top: -2px;\n}\n.l7-control-scale-line:not(:first-child):not(:last-child) {\n  border-bottom: 2px solid #777;\n}\n\n.l7-touch .l7-control-attribution,\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  -webkit-box-shadow: none;\n          box-shadow: none;\n}\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  border: 2px solid rgba(0, 0, 0, 0.2);\n  background-clip: padding-box;\n}\n/*logo */\n\n.l7-ctrl-logo {\n  background-size: 100% 100%;\n  width: 89px;\n  height: 16px;\n  margin: 0 0 -3px -3px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  background-repeat: no-repeat;\n  cursor: pointer;\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');\n}\n\n/* layers control */\n\n.l7-control-layers {\n  -webkit-box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);\n          box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);\n  background: #fff;\n  border-radius: 2px;\n}\n.l7-control-layers-toggle {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');\n  width: 30px;\n  height: 30px;\n  background-size: 20px 20px;\n}\n\n.l7-touch .l7-control-layers-toggle {\n  width: 44px;\n  height: 44px;\n}\n.l7-control-layers .l7-control-layers-list,\n.l7-control-layers-expanded .l7-control-layers-toggle {\n  display: none;\n}\n.l7-control-layers-expanded .l7-control-layers-list {\n  display: block;\n  position: relative;\n}\n.l7-control-layers-expanded {\n  padding: 6px 10px 6px 6px;\n  color: #59626b;\n  background: #fff;\n}\n.l7-control-layers-scrollbar {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  padding-right: 5px;\n}\n.l7-control-layers-selector {\n  margin-top: 2px;\n  position: relative;\n  top: 1px;\n}\n.l7-control-layers label {\n  display: block;\n  padding: 8px;\n}\n.l7-control-layers label input[type='radio'],\n.l7-control-layers label input[type='checkbox'] {\n  width: 14px;\n  height: 14px;\n  margin: 0;\n}\n.l7-control-layers-separator {\n  height: 0;\n  border-top: 1px solid #d8d8d8;\n  margin: 5px -10px 5px -6px;\n}\n.mapboxgl-ctrl-logo {\n  display: none !important;\n}\n.amap-logo {\n  display: none !important;\n}\n");var nt,yt,Lt,K=y(32952),Ve=y(56326);function Z(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Ze(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Z(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Z(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var St=(nt=(0,W.yT)(W.vK.IGlobalConfigService),yt=function(){function n(l){(0,R.Z)(this,n),(0,K.Z)(this,"configService",Lt,this),(0,j.Z)(this,"config",void 0),this.config=l}return(0,B.Z)(n,[{key:"setContainer",value:function(i,u){i.bind(W.vK.MapConfig).toConstantValue(Ze(Ze({},this.config),{},{id:u})),i.bind(W.vK.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),n}(),Lt=(0,Ve.Z)(yt.prototype,"configService",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt),It=y(71189),Jt=y(8239),Tr=y(88774),vr=y.n(Tr),Xt=y(30651),mr=y(14563);function or(){var n=new mr.WT(3);return mr.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function pr(n){var l=new mr.WT(3);return l[0]=n[0],l[1]=n[1],l[2]=n[2],l}function mn(n){return Math.hypot(n[0],n[1],n[2])}function On(n,l,i){var u=new mr.WT(3);return u[0]=n,u[1]=l,u[2]=i,u}function mi(n,l){return n[0]=l[0],n[1]=l[1],n[2]=l[2],n}function hi(n,l,i,u){return n[0]=l,n[1]=i,n[2]=u,n}function si(n,l,i){return n[0]=l[0]+i[0],n[1]=l[1]+i[1],n[2]=l[2]+i[2],n}function ai(n,l,i){return n[0]=l[0]-i[0],n[1]=l[1]-i[1],n[2]=l[2]-i[2],n}function Ki(n,l,i){return n[0]=l[0]*i[0],n[1]=l[1]*i[1],n[2]=l[2]*i[2],n}function Pi(n,l,i){return n[0]=l[0]/i[0],n[1]=l[1]/i[1],n[2]=l[2]/i[2],n}function Ei(n,l){return n[0]=Math.ceil(l[0]),n[1]=Math.ceil(l[1]),n[2]=Math.ceil(l[2]),n}function re(n,l){return n[0]=Math.floor(l[0]),n[1]=Math.floor(l[1]),n[2]=Math.floor(l[2]),n}function pe(n,l,i){return n[0]=Math.min(l[0],i[0]),n[1]=Math.min(l[1],i[1]),n[2]=Math.min(l[2],i[2]),n}function _e(n,l,i){return n[0]=Math.max(l[0],i[0]),n[1]=Math.max(l[1],i[1]),n[2]=Math.max(l[2],i[2]),n}function V(n,l){return n[0]=Math.round(l[0]),n[1]=Math.round(l[1]),n[2]=Math.round(l[2]),n}function ae(n,l,i){return n[0]=l[0]*i,n[1]=l[1]*i,n[2]=l[2]*i,n}function xe(n,l,i,u){return n[0]=l[0]+i[0]*u,n[1]=l[1]+i[1]*u,n[2]=l[2]+i[2]*u,n}function Oe(n,l){return Math.hypot(l[0]-n[0],l[1]-n[1],l[2]-n[2])}function fe(n,l){var i=l[0]-n[0],u=l[1]-n[1],h=l[2]-n[2];return i*i+u*u+h*h}function Ae(n){var l=n[0],i=n[1],u=n[2];return l*l+i*i+u*u}function wt(n,l){return n[0]=-l[0],n[1]=-l[1],n[2]=-l[2],n}function Sr(n,l){return n[0]=1/l[0],n[1]=1/l[1],n[2]=1/l[2],n}function Kt(n,l){var i=l[0],u=l[1],h=l[2],v=i*i+u*u+h*h;return v>0&&(v=1/Math.sqrt(v)),n[0]=l[0]*v,n[1]=l[1]*v,n[2]=l[2]*v,n}function ir(n,l){return n[0]*l[0]+n[1]*l[1]+n[2]*l[2]}function Fr(n,l,i){var u=l[0],h=l[1],v=l[2],w=i[0],I=i[1],k=i[2];return n[0]=h*k-v*I,n[1]=v*w-u*k,n[2]=u*I-h*w,n}function Rn(n,l,i,u){var h=l[0],v=l[1],w=l[2];return n[0]=h+u*(i[0]-h),n[1]=v+u*(i[1]-v),n[2]=w+u*(i[2]-w),n}function Pn(n,l,i,u,h,v){var w=v*v,I=w*(2*v-3)+1,k=w*(v-2)+v,X=w*(v-1),le=w*(3-2*v);return n[0]=l[0]*I+i[0]*k+u[0]*X+h[0]*le,n[1]=l[1]*I+i[1]*k+u[1]*X+h[1]*le,n[2]=l[2]*I+i[2]*k+u[2]*X+h[2]*le,n}function rr(n,l,i,u,h,v){var w=1-v,I=w*w,k=v*v,X=I*w,le=3*v*I,se=3*k*w,Fe=k*v;return n[0]=l[0]*X+i[0]*le+u[0]*se+h[0]*Fe,n[1]=l[1]*X+i[1]*le+u[1]*se+h[1]*Fe,n[2]=l[2]*X+i[2]*le+u[2]*se+h[2]*Fe,n}function Sn(n,l){l=l||1;var i=2*mr.FD()*Math.PI,u=2*mr.FD()-1,h=Math.sqrt(1-u*u)*l;return n[0]=Math.cos(i)*h,n[1]=Math.sin(i)*h,n[2]=u*l,n}function an(n,l,i){var u=l[0],h=l[1],v=l[2],w=i[3]*u+i[7]*h+i[11]*v+i[15];return n[0]=(i[0]*u+i[4]*h+i[8]*v+i[12])/(w=w||1),n[1]=(i[1]*u+i[5]*h+i[9]*v+i[13])/w,n[2]=(i[2]*u+i[6]*h+i[10]*v+i[14])/w,n}function fn(n,l,i){var u=l[0],h=l[1],v=l[2];return n[0]=u*i[0]+h*i[3]+v*i[6],n[1]=u*i[1]+h*i[4]+v*i[7],n[2]=u*i[2]+h*i[5]+v*i[8],n}function Di(n,l,i){var u=i[0],h=i[1],v=i[2],I=l[0],k=l[1],X=l[2],le=h*X-v*k,se=v*I-u*X,Fe=u*k-h*I,rt=h*Fe-v*se,Bt=v*le-u*Fe,Wt=u*se-h*le,Ar=2*i[3];return se*=Ar,Fe*=Ar,Bt*=2,Wt*=2,n[0]=I+(le*=Ar)+(rt*=2),n[1]=k+se+Bt,n[2]=X+Fe+Wt,n}function _n(n,l,i,u){var h=[],v=[];return h[0]=l[0]-i[0],h[1]=l[1]-i[1],h[2]=l[2]-i[2],v[0]=h[0],v[1]=h[1]*Math.cos(u)-h[2]*Math.sin(u),v[2]=h[1]*Math.sin(u)+h[2]*Math.cos(u),n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function Oi(n,l,i,u){var h=[],v=[];return h[0]=l[0]-i[0],h[1]=l[1]-i[1],h[2]=l[2]-i[2],v[0]=h[2]*Math.sin(u)+h[0]*Math.cos(u),v[1]=h[1],v[2]=h[2]*Math.cos(u)-h[0]*Math.sin(u),n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function ta(n,l,i,u){var h=[],v=[];return h[0]=l[0]-i[0],h[1]=l[1]-i[1],h[2]=l[2]-i[2],v[0]=h[0]*Math.cos(u)-h[1]*Math.sin(u),v[1]=h[0]*Math.sin(u)+h[1]*Math.cos(u),v[2]=h[2],n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function oi(n,l){var i=n[0],u=n[1],h=n[2],v=l[0],w=l[1],I=l[2],le=Math.sqrt(i*i+u*u+h*h)*Math.sqrt(v*v+w*w+I*I),se=le&&ir(n,l)/le;return Math.acos(Math.min(Math.max(se,-1),1))}function Ji(n){return n[0]=0,n[1]=0,n[2]=0,n}function Vi(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function Ti(n,l){return n[0]===l[0]&&n[1]===l[1]&&n[2]===l[2]}function _a(n,l){var i=n[0],u=n[1],h=n[2],v=l[0],w=l[1],I=l[2];return Math.abs(i-v)<=mr.Ib*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(u-w)<=mr.Ib*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(h-I)<=mr.Ib*Math.max(1,Math.abs(h),Math.abs(I))}var n,Ia=ai,Gi=Ki,Bi=Pi,Xi=Oe,to=fe,Ho=mn,Za=Ae,Wi=(n=or(),function(l,i,u,h,v,w){var I,k;for(i||(i=3),u||(u=0),k=h?Math.min(h*i+u,l.length):l.length,I=u;I<k;I+=i)n[0]=l[I],n[1]=l[I+1],n[2]=l[I+2],v(n,n,w),l[I]=n[0],l[I+1]=n[1],l[I+2]=n[2];return l}),va=y(15922),wu=y(82958),Da=y.n(wu),Fi=(y(78320),(()=>(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.L7MAP="L7MAP",n.GLOBEL="GLOBEL"}(Fi||(Fi={})),Fi))()),ra=y(83838),bo=y(58623);function vo(n,l){var i=bo.fF([],l,n);return bo.bA(i,i,1/i[3]),i}function aa(){var n=new mr.WT(2);return mr.WT!=Float32Array&&(n[0]=0,n[1]=0),n}function Ma(n,l){var i=new mr.WT(2);return i[0]=n,i[1]=l,i}function Ka(n,l){return n[0]=l[0],n[1]=l[1],n}function Ba(n,l,i){return n[0]=l[0]+i[0],n[1]=l[1]+i[1],n}function Ee(n,l,i){return n[0]=l[0]-i[0],n[1]=l[1]-i[1],n}function Lo(n,l){var i=l[0],u=l[1],h=i*i+u*u;return h>0&&(h=1/Math.sqrt(h)),n[0]=l[0]*h,n[1]=l[1]*h,n}function es(n,l){return n[0]*l[0]+n[1]*l[1]}function ks(n,l,i,u){var h=l[0],v=l[1];return n[0]=h+u*(i[0]-h),n[1]=v+u*(i[1]-v),n}var m=Ee;function zt(n,l){if(!n)throw new Error(l||"viewport-mercator-project: assertion failed.")}aa();var Ft=Math.PI,Or=Ft/4,zr=Ft/180,Jn=180/Ft;function Ea(n){return Math.pow(2,n)}function vi(n,l){var i=(0,ra.Z)(n,2),u=i[0],h=i[1];return zt(Number.isFinite(u)&&Number.isFinite(l)),zt(Number.isFinite(h)&&h>=-90&&h<=90,"invalid latitude"),[(l*=512)*(u*zr+Ft)/(2*Ft),l*(Ft-Math.log(Math.tan(Or+h*zr*.5)))/(2*Ft)]}function Xo(n,l){var i=(0,ra.Z)(n,2),v=i[0]/(l*=512)*(2*Ft)-Ft,w=2*(Math.atan(Math.exp(Ft-i[1]/l*(2*Ft)))-Or);return[v*Jn,w*Jn]}function Tu(n){var l=n.latitude,i=n.longitude,h=n.scale,v=n.highPrecision,w=void 0!==v&&v;h=void 0!==h?h:Ea(n.zoom),zt(Number.isFinite(l)&&Number.isFinite(i)&&Number.isFinite(h));var I={},k=512*h,X=Math.cos(l*zr),le=k/360,se=le/X,Fe=k/4003e4/X;if(I.pixelsPerMeter=[Fe,-Fe,Fe],I.metersPerPixel=[1/Fe,-1/Fe,1/Fe],I.pixelsPerDegree=[le,-se,Fe],I.degreesPerPixel=[1/le,-1/se,1/Fe],w){var rt=zr*Math.tan(l*zr)/X,Wt=k/4003e4*rt,Ar=Wt/se*Fe;I.pixelsPerDegree2=[0,-le*rt/2,Wt],I.pixelsPerMeter2=[Ar,0,Ar]}return I}function Du(n){var l=n.height,i=n.pitch,u=n.bearing,v=n.center,w=void 0===v?null:v,I=n.flipY,k=void 0!==I&&I,X=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return Xt.translate(X,X,[0,0,-n.altitude]),Xt.scale(X,X,[1,1,1/l]),Xt.rotateX(X,X,-i*zr),Xt.rotateZ(X,X,u*zr),k&&Xt.scale(X,X,[1,-1,1]),w&&Xt.translate(X,X,wt([],w)),X}function mu(n){var I=function(n){var l=n.width,i=n.height,u=n.altitude,h=void 0===u?1.5:u,v=n.pitch,I=n.nearZMultiplier,k=void 0===I?1:I,X=n.farZMultiplier,le=void 0===X?1:X,se=(void 0===v?0:v)*zr,Fe=Math.atan(.5/h),rt=Math.sin(Fe)*h/Math.sin(Math.PI/2-se-Fe),Bt=Math.cos(Math.PI/2-se)*rt+h;return{fov:2*Math.atan(i/2/h),aspect:l/i,focalDistance:h,near:k,far:Bt*le}}({width:n.width,height:n.height,altitude:n.altitude,pitch:n.pitch,nearZMultiplier:n.nearZMultiplier,farZMultiplier:n.farZMultiplier});return Xt.perspective([],I.fov,I.aspect,I.near,I.far)}function gu(n,l){var i=(0,ra.Z)(n,3),u=i[0],h=i[1],v=i[2],w=void 0===v?0:v;return zt(Number.isFinite(u)&&Number.isFinite(h)&&Number.isFinite(w)),vo(l,[u,h,w,1])}function tu(n,l){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=(0,ra.Z)(n,3),h=u[0],v=u[1],w=u[2];if(zt(Number.isFinite(h)&&Number.isFinite(v),"invalid pixel coordinate"),Number.isFinite(w)){var I=vo(l,[h,v,w,1]);return I}var k=vo(l,[h,v,0,1]),X=vo(l,[h,v,1,1]),le=k[2],se=X[2],Fe=le===se?0:((i||0)-le)/(se-le);return ks([],k,X,Fe)}var oo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function Cc(n){var l=n.width,i=n.height,h=n.minExtent,v=void 0===h?0:h,w=n.maxZoom,I=void 0===w?24:w,k=n.padding,X=void 0===k?0:k,le=n.offset,se=void 0===le?[0,0]:le,Fe=(0,ra.Z)(n.bounds,2),rt=(0,ra.Z)(Fe[0],2),Bt=rt[0],Wt=rt[1],Ar=(0,ra.Z)(Fe[1],2),jr=Ar[0],sn=Ar[1];Number.isFinite(X)?X={top:X,bottom:X,left:X,right:X}:zt(Number.isFinite(X.top)&&Number.isFinite(X.bottom)&&Number.isFinite(X.left)&&Number.isFinite(X.right));var Mn=new rs({width:l,height:i,longitude:0,latitude:0,zoom:0}),Wn=Mn.project([Bt,sn]),ei=Mn.project([jr,Wt]),ti=[Math.max(Math.abs(ei[0]-Wn[0]),v),Math.max(Math.abs(ei[1]-Wn[1]),v)],Ui=[l-X.left-X.right-2*Math.abs(se[0]),i-X.top-X.bottom-2*Math.abs(se[1])];zt(Ui[0]>0&&Ui[1]>0);var wa=Ui[0]/ti[0],Ua=Ui[1]/ti[1],Ru=Mn.unproject([(ei[0]+Wn[0])/2+(X.right-X.left)/2/wa,(ei[1]+Wn[1])/2+(X.bottom-X.top)/2/Ua]),_p=Mn.zoom+Math.log2(Math.abs(Math.min(wa,Ua)));return{longitude:Ru[0],latitude:Ru[1],zoom:Math.min(_p,I)}}var Rs,rc,Bu,La,Ju,Gc,Us,nc,Hc,Ac,Fl,rs=function(n){function l(){var i,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=u.width,v=u.height,w=u.latitude,I=void 0===w?0:w,k=u.longitude,X=void 0===k?0:k,le=u.zoom,se=void 0===le?0:le,Fe=u.pitch,rt=void 0===Fe?0:Fe,Bt=u.bearing,Wt=void 0===Bt?0:Bt,Ar=u.altitude,jr=void 0===Ar?1.5:Ar,sn=u.nearZMultiplier,yn=u.farZMultiplier;(0,R.Z)(this,l),h=h||1,v=v||1;var Mn=Ea(se);jr=Math.max(.75,jr);var Wn=vi([X,I],Mn);Wn[2]=0;var ei=mu({width:h,height:v,pitch:rt,bearing:Wt,altitude:jr,nearZMultiplier:sn||1/v,farZMultiplier:yn||1.01}),ti=Du({height:v,center:Wn,pitch:rt,bearing:Wt,altitude:jr,flipY:!0});return(i=(0,be.Z)(this,(0,Be.Z)(l).call(this,{width:h,height:v,viewMatrix:ti,projectionMatrix:ei}))).latitude=I,i.longitude=X,i.zoom=se,i.pitch=rt,i.bearing=Wt,i.altitude=jr,i.scale=Mn,i.center=Wn,i.pixelsPerMeter=Tu((0,H.Z)((0,H.Z)(i))).pixelsPerMeter[2],Object.freeze((0,H.Z)((0,H.Z)(i))),i}return(0,G.Z)(l,n),(0,B.Z)(l,[{key:"projectFlat",value:function(u){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return vi(u,h)}},{key:"unprojectFlat",value:function(u){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Xo(u,h)}},{key:"getMapCenterByLngLatPosition",value:function(u){var h=u.lngLat,w=tu(u.pos,this.pixelUnprojectionMatrix),k=Ba([],vi(h,this.scale),function(n,l){return n[0]=-l[0],n[1]=-l[1],n}([],w));return Xo(Ba([],this.center,k),this.scale)}},{key:"getLocationAtPoint",value:function(u){return this.getMapCenterByLngLatPosition({lngLat:u.lngLat,pos:u.pos})}},{key:"fitBounds",value:function(u){var h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},v=this.width,w=this.height,I=Cc(Object.assign({width:v,height:w,bounds:u},h)),k=I.longitude,X=I.latitude,le=I.zoom;return new l({width:v,height:w,longitude:k,latitude:X,zoom:le})}}]),l}(function(){function n(){var l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=l.width,u=l.height,h=l.viewMatrix,v=void 0===h?oo:h,w=l.projectionMatrix,I=void 0===w?oo:w;(0,R.Z)(this,n),this.width=i||1,this.height=u||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=v,this.projectionMatrix=I;var k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Xt.multiply(k,k,this.projectionMatrix),Xt.multiply(k,k,this.viewMatrix),this.viewProjectionMatrix=k;var X=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Xt.scale(X,X,[this.width/2,-this.height/2,1]),Xt.translate(X,X,[1,-1,0]),Xt.multiply(X,X,this.viewProjectionMatrix);var le=Xt.invert([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X);if(!le)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=X,this.pixelUnprojectionMatrix=le,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,B.Z)(n,[{key:"equals",value:function(i){return i instanceof n&&i.width===this.width&&i.height===this.height&&Xt.equals(i.projectionMatrix,this.projectionMatrix)&&Xt.equals(i.viewMatrix,this.viewMatrix)}},{key:"project",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=u.topLeft,v=void 0===h||h,w=this.projectPosition(i),I=gu(w,this.pixelProjectionMatrix),k=(0,ra.Z)(I,2),X=k[0],le=k[1],se=v?le:this.height-le;return 2===i.length?[X,se]:[X,se,I[2]]}},{key:"unproject",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},h=u.topLeft,v=void 0===h||h,w=u.targetZ,I=(0,ra.Z)(i,3),k=I[0],X=I[1],le=I[2],se=v?X:this.height-X,Fe=w&&w*this.pixelsPerMeter,rt=tu([k,se,le],this.pixelUnprojectionMatrix,Fe),Bt=this.unprojectPosition(rt),Wt=(0,ra.Z)(Bt,3),Ar=Wt[0],jr=Wt[1],sn=Wt[2];return Number.isFinite(le)?[Ar,jr,sn]:Number.isFinite(w)?[Ar,jr,w]:[Ar,jr]}},{key:"projectPosition",value:function(i){var u=this.projectFlat(i),h=(0,ra.Z)(u,2);return[h[0],h[1],(i[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(i){var u=this.unprojectFlat(i),h=(0,ra.Z)(u,2);return[h[0],h[1],(i[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(i){return i}},{key:"unprojectFlat",value:function(i){return i}}]),n}()),tc=function(){function n(){(0,R.Z)(this,n),(0,j.Z)(this,"viewport",void 0)}return(0,B.Z)(n,[{key:"syncWithMapCamera",value:function(i){var u=i.center;this.viewport=new rs({width:i.viewportWidth,height:i.viewportHeight,longitude:u&&u[0],latitude:u&&u[1],zoom:i.zoom,pitch:i.pitch,bearing:i.bearing})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(i,u){return this.viewport.projectFlat(i,u)}}]),n}(),ru={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}};function yu(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function $u(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?yu(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):yu(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}(function(n,l){if(l||(l=document),l){var i=l.head||l.getElementsByTagName("head")[0];if(!i){i=l.createElement("head");var u=l.body||l.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):l.documentElement.appendChild(i)}var h=l.createElement("style");h.type="text/css",h.styleSheet?h.styleSheet.cssText=n:h.appendChild(l.createTextNode(n)),i.appendChild(h)}})(".mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}"),window.mapboxgl=Da();var Qu={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},el=0,Fu="pk.eyJ1IjoibHp4dWUiLCJhIjoiY2tvaWZuM2s4MWZuYjJ1dHI5ZGduYTlrdiJ9.DQCfMRbZzx0VSwecQ69McA",js=(Rs=(0,va.b2)(),rc=(0,va.f3)(W.vK.MapConfig),Bu=(0,va.f3)(W.vK.IGlobalConfigService),La=(0,va.f3)(W.vK.ICoordinateSystemService),Ju=(0,va.f3)(W.vK.IEventEmitter),Rs((Us=function(){function n(){var l=this;(0,R.Z)(this,n),(0,j.Z)(this,"version",Fi.MAPBOX),(0,j.Z)(this,"map",void 0),(0,j.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,K.Z)(this,"config",nc,this),(0,K.Z)(this,"configService",Hc,this),(0,K.Z)(this,"coordinateSystemService",Ac,this),(0,K.Z)(this,"eventEmitter",Fl,this),(0,j.Z)(this,"viewport",void 0),(0,j.Z)(this,"markerContainer",void 0),(0,j.Z)(this,"cameraChangedCallback",void 0),(0,j.Z)(this,"$mapContainer",void 0),(0,j.Z)(this,"handleCameraChanged",function(){var i=l.map.getCenter().wrap(),u=i.lat,h=i.lng;l.viewport.syncWithMapCamera({bearing:l.map.getBearing(),center:[h,u],viewportHeight:l.map.transform.height,pitch:l.map.getPitch(),viewportWidth:l.map.transform.width,zoom:l.map.getZoom(),cameraHeight:0});var v=l.config.offsetZoom,w=void 0===v?12:v;l.viewport.getZoom()>w?l.coordinateSystemService.setCoordinateSystem(W.CoordinateSystem.LNGLAT_OFFSET):l.coordinateSystemService.setCoordinateSystem(W.CoordinateSystem.LNGLAT),l.cameraChangedCallback(l.viewport)})}return(0,B.Z)(n,[{key:"setBgColor",value:function(i){this.bgColor=i}},{key:"addMarkerContainer",value:function(){var i=this.map.getCanvasContainer();this.markerContainer=Ke.SO.create("div","l7-marker-container",i),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(i,u){-1!==W.MapServiceEvent.indexOf(i)?this.eventEmitter.on(i,u):this.map.on(Qu[i]||i,u)}},{key:"off",value:function(i,u){this.map.off(Qu[i]||i,u)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var i=this.map.transform;return[i.width,i.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(i){return this.map.setZoom(i)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(i){this.map.setCenter(i)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(i){this.map.setBearing(i)}},{key:"zoomIn",value:function(i,u){this.map.zoomIn(i,u)}},{key:"zoomOut",value:function(i,u){this.map.zoomOut(i,u)}},{key:"setPitch",value:function(i){return this.map.setPitch(i)}},{key:"panTo",value:function(i){this.map.panTo(i)}},{key:"panBy",value:function(i,u){this.panTo([i,u])}},{key:"fitBounds",value:function(i,u){this.map.fitBounds(i,u)}},{key:"setMaxZoom",value:function(i){this.map.setMaxZoom(i)}},{key:"setMinZoom",value:function(i){this.map.setMinZoom(i)}},{key:"setMapStatus",value:function(i){!0===i.doubleClickZoom&&this.map.doubleClickZoom.enable(),!1===i.doubleClickZoom&&this.map.doubleClickZoom.disable(),!1===i.dragEnable&&this.map.dragPan.disable(),!0===i.dragEnable&&this.map.dragPan.enable(),!1===i.rotateEnable&&this.map.dragRotate.disable(),!0===i.rotateEnable&&this.map.dragRotate.enable(),!1===i.keyboardEnable&&this.map.keyboard.disable(),!0===i.keyboardEnable&&this.map.keyboard.enable(),!1===i.zoomEnable&&this.map.scrollZoom.disable(),!0===i.zoomEnable&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(i,u){this.map.flyTo({zoom:i,center:u})}},{key:"setMapStyle",value:function(i){this.map.setStyle(this.getMapStyle(i))}},{key:"pixelToLngLat",value:function(i){return this.map.unproject(i)}},{key:"lngLatToPixel",value:function(i){return this.map.project(i)}},{key:"containerToLngLat",value:function(i){return this.map.unproject(i)}},{key:"lngLatToContainer",value:function(i){return this.map.project(i)}},{key:"lngLatToCoord",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0},h=this.lngLatToMercator(i,0),v=h.x,w=h.y;return[v-u.x,w-u.y]}},{key:"lngLatToMercator",value:function(i,u){var h=window.mapboxgl.MercatorCoordinate.fromLngLat(i,u),v=h.x,I=h.y,X=h.z;return{x:void 0===v?0:v,y:void 0===I?0:I,z:void 0===X?0:X}}},{key:"getModelMatrix",value:function(i,u,h){var v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],w=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:0,y:0,z:0},I=window.mapboxgl.MercatorCoordinate.fromLngLat(i,u),k=I.meterInMercatorCoordinateUnits(),X=Xt.create();return Xt.translate(X,X,On(I.x-w.x,I.y-w.y,I.z||0-w.z)),Xt.scale(X,X,On(k*v[0],-k*v[1],k*v[2])),Xt.rotateX(X,X,h[0]),Xt.rotateY(X,X,h[1]),Xt.rotateZ(X,X,h[2]),X}},{key:"init",value:(l=(0,Jt.Z)(vr().mark(function u(){var h,v,w,I,k,X,le,se,Fe,rt,Bt,Wt,Ar;return vr().wrap(function(sn){for(;;)switch(sn.prev=sn.next){case 0:w=void 0===(v=(h=this.config).id)?"map":v,k=void 0!==(I=h.attributionControl)&&I,le=void 0===(X=h.style)?"light":X,Fe=void 0===(se=h.token)?Fu:se,Bt=void 0===(rt=h.rotation)?0:rt,Wt=h.mapInstance,Ar=(0,It.Z)(h,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new tc,!Wt&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),Fe===Fu&&"blank"!==le&&!window.mapboxgl.accessToken&&!Wt&&console.warn(this.configService.getSceneWarninfo("MapToken")),!Wt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Fe),Wt?(this.map=Wt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(w),this.map=new window.mapboxgl.Map($u({container:this.$mapContainer,style:this.getMapStyle(le),attributionControl:k,bearing:Bt},Ar))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return sn.stop()}},u,this)})),function(){return l.apply(this,arguments)})},{key:"destroy",value:function(){var i,u;null===(i=this.$mapContainer)||void 0===i||null===(u=i.parentNode)||void 0===u||u.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(i){for(var u,h=arguments.length,v=new Array(h>1?h-1:0),w=1;w<h;w++)v[w-1]=arguments[w];(u=this.eventEmitter).emit.apply(u,[i].concat(v))}},{key:"once",value:function(i){for(var u,h=arguments.length,v=new Array(h>1?h-1:0),w=1;w<h;w++)v[w-1]=arguments[w];(u=this.eventEmitter).once.apply(u,[i].concat(v))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(i){var u=this.map.getCanvas();return"jpg"===i?null==u?void 0:u.toDataURL("image/jpeg"):null==u?void 0:u.toDataURL("image/png")}},{key:"onCameraChanged",value:function(i){this.cameraChangedCallback=i}},{key:"creatAmapContainer",value:function(i){var u=i;"string"==typeof i&&(u=document.getElementById(i));var h=document.createElement("div");return h.style.cssText+="\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 100%;\n    ",h.id="l7_mapbox_div"+el++,u.appendChild(h),h}},{key:"getMapStyle",value:function(i){return"string"!=typeof i?i:ru[i]?ru[i]:i}}]),n;var l}(),nc=(0,Ve.Z)(Us.prototype,"config",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hc=(0,Ve.Z)(Us.prototype,"configService",[Bu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ac=(0,Ve.Z)(Us.prototype,"coordinateSystemService",[La],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fl=(0,Ve.Z)(Us.prototype,"eventEmitter",[Ju],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gc=Us))||Gc);!function(n,l){if(l||(l=document),l){var i=l.head||l.getElementsByTagName("head")[0];if(!i){i=l.createElement("head");var u=l.body||l.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):l.documentElement.appendChild(i)}var h=l.createElement("style");h.type="text/css",h.styleSheet?h.styleSheet.cssText=n:h.appendChild(l.createTextNode(n)),i.appendChild(h)}}(".mapboxgl-ctrl-logo {\n display: none !important;\n}\n");var tl=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),l.apply(this,arguments)}return(0,B.Z)(i,[{key:"getServiceConstructor",value:function(){return js}}]),i}(St),vl={},Nl={},ic=function(l){return Nl[l]},Nu=function(l,i){Nl[l]=i},Cu=function(l,i){vl[l]=i},zu={},nu={};function ac(n){return new Function("d","return {"+n.map(function(l,i){return JSON.stringify(l)+": d["+i+'] || ""'}).join(",")+"}")}function Zu(n){var l=Object.create(null),i=[];return n.forEach(function(u){for(var h in u)h in l||i.push(l[h]=h)}),i}function ns(n,l){var i=n+"",u=i.length;return u<l?new Array(l-u+1).join(0)+i:i}var Pu=function(n){var l=new RegExp('[",\n\r]'),i=n.charCodeAt(0);function h(se,Fe){var jr,rt=[],Bt=se.length,Wt=0,Ar=0,sn=Bt<=0,yn=!1;function Mn(){if(sn)return nu;if(yn)return yn=!1,zu;var ei,Ui,ti=Wt;if(34===se.charCodeAt(ti)){for(;Wt++<Bt&&34!==se.charCodeAt(Wt)||34===se.charCodeAt(++Wt););return(ei=Wt)>=Bt?sn=!0:10===(Ui=se.charCodeAt(Wt++))?yn=!0:13===Ui&&(yn=!0,10===se.charCodeAt(Wt)&&++Wt),se.slice(ti+1,ei-1).replace(/""/g,'"')}for(;Wt<Bt;){if(10===(Ui=se.charCodeAt(ei=Wt++)))yn=!0;else if(13===Ui)yn=!0,10===se.charCodeAt(Wt)&&++Wt;else if(Ui!==i)continue;return se.slice(ti,ei)}return sn=!0,se.slice(ti,Bt)}for(10===se.charCodeAt(Bt-1)&&--Bt,13===se.charCodeAt(Bt-1)&&--Bt;(jr=Mn())!==nu;){for(var Wn=[];jr!==zu&&jr!==nu;)Wn.push(jr),jr=Mn();Fe&&null==(Wn=Fe(Wn,Ar++))||rt.push(Wn)}return rt}function v(se,Fe){return se.map(function(rt){return Fe.map(function(Bt){return le(rt[Bt])}).join(n)})}function X(se){return se.map(le).join(n)}function le(se){return null==se?"":se instanceof Date?function(n){var l=n.getUTCHours(),i=n.getUTCMinutes(),u=n.getUTCSeconds(),h=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":function(n){return n<0?"-"+ns(-n,6):n>9999?"+"+ns(n,6):ns(n,4)}(n.getUTCFullYear())+"-"+ns(n.getUTCMonth()+1,2)+"-"+ns(n.getUTCDate(),2)+(h?"T"+ns(l,2)+":"+ns(i,2)+":"+ns(u,2)+"."+ns(h,3)+"Z":u?"T"+ns(l,2)+":"+ns(i,2)+":"+ns(u,2)+"Z":i||l?"T"+ns(l,2)+":"+ns(i,2)+"Z":"")}(se):l.test(se+="")?'"'+se.replace(/"/g,'""')+'"':se}return{parse:function(se,Fe){var rt,Bt,Wt=h(se,function(Ar,jr){if(rt)return rt(Ar,jr-1);Bt=Ar,rt=Fe?function(n,l){var i=ac(n);return function(u,h){return l(i(u),h,n)}}(Ar,Fe):ac(Ar)});return Wt.columns=Bt||[],Wt},parseRows:h,format:function(se,Fe){return null==Fe&&(Fe=Zu(se)),[Fe.map(le).join(n)].concat(v(se,Fe)).join("\n")},formatBody:function(se,Fe){return null==Fe&&(Fe=Zu(se)),v(se,Fe).join("\n")},formatRows:function(se){return se.map(X).join("\n")},formatRow:X,formatValue:le}}(",").parse,Ta=y(96109),lf=y(57452),jl=y.n(lf);function ml(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function _u(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?ml(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):ml(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function So(n,l){var i=l.x,u=l.y,h=l.x1,v=l.y1,w=l.coordinates,I=[];return n.forEach(function(k,X){var le=[];if(i&&u&&(le=[parseFloat(k[i]),parseFloat(k[u])]),i&&u&&h&&v&&(le=[[parseFloat(k[i]),parseFloat(k[u])],[parseFloat(k[h]),parseFloat(k[v])]]),w){var rt="Polygon";Array.isArray(w[0])||(rt="Point"),Array.isArray(w[0])&&!Array.isArray(w[0][0])&&(rt="LineString");var Bt={type:rt,coordinates:(0,Ta.Z)(k[w])};jl()(Bt,!0),le=Bt.coordinates}var Wt=_u(_u({},k),{},{_id:X,coordinates:le});I.push(Wt)}),{dataArray:I}}var yl=y(70576);function Hs(n,l){!function(n,l){var i,u,h,v,w,I,k,X,le,se,Fe=0,rt="FeatureCollection"===n.type,Bt="Feature"===n.type,Wt=rt?n.features.length:1;for(i=0;i<Wt;i++){for(X=rt?n.features[i].properties:Bt?n.properties:{},le=rt?n.features[i].bbox:Bt?n.bbox:void 0,se=rt?n.features[i].id:Bt?n.id:void 0,w=(k=!!(I=rt?n.features[i].geometry:Bt?n.geometry:n)&&"GeometryCollection"===I.type)?I.geometries.length:1,h=0;h<w;h++)if(null!==(v=k?I.geometries[h]:I))switch(v.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===l(v,Fe,X,le,se))return!1;break;case"GeometryCollection":for(u=0;u<v.geometries.length;u++)if(!1===l(v.geometries[u],Fe,X,le,se))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===l(null,Fe,X,le,se))return!1;Fe++}}(n,function(i,u,h,v,w){var k,I=null===i?null:i.type;switch(I){case null:case"Point":case"LineString":case"Polygon":return!1!==l((0,yl.zL)(i,h,{bbox:v,id:w}),u,0)&&void 0}switch(I){case"MultiPoint":k="Point";break;case"MultiLineString":k="LineString";break;case"MultiPolygon":k="Polygon"}for(var X=0;X<i.coordinates.length;X++)if(!1===l((0,yl.zL)({type:k,coordinates:i.coordinates[X]},h),u,X))return!1})}function xu(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Bs(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?xu(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):xu(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var mo=y(33939),il=y.n(mo),ri=y(64871),In=y.n(ri),lc=y(55836),wo=y.n(lc),Xs=y(37524),Po=y.n(Xs),fo=y(97185);function Vl(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Gl(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Vl(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Vl(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Qi(n,l){var i=l.radius,u=void 0===i?40:i,h=l.maxZoom,v=void 0===h?18:h,w=l.minZoom,I=void 0===w?0:w,k=l.zoom;if(n.pointIndex){var le=n.pointIndex.getClusters(n.extent,Math.floor(void 0===k?2:k));return n.dataArray=function(n){return n.map(function(l,i){return Gl({coordinates:l.geometry.coordinates,_id:i+1},l.properties)})}(le),n}var se=new(Mt())({radius:u,minZoom:I,maxZoom:v}),Fe={type:"FeatureCollection",features:[]};return Fe.features=n.dataArray.map(function(rt){return{type:"Feature",geometry:{type:"Point",coordinates:rt.coordinates},properties:Gl({},rt)}}),se.load(Fe.features),se}function bl(n){if(0===n.length)return 0;for(var u,l=n[0],i=0,h=1;h<n.length;h++)u=l+1*n[h],Math.abs(l)>=Math.abs(n[h])?i+=l-u+n[h]:i+=n[h]-u+l,l=u;return l+1*i}var is={min:function(n){if(0===n.length)throw new Error("min requires at least one data point");for(var l=n[0],i=1;i<n.length;i++)n[i]<l&&(l=n[i]);return l},max:function(n){if(0===n.length)throw new Error("max requires at least one data point");for(var l=n[0],i=1;i<n.length;i++)n[i]>l&&(l=n[i]);return l},mean:function(n){if(0===n.length)throw new Error("mean requires at least one data point");return bl(n)/n.length},sum:bl};function su(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Hl(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?su(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):su(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Yc(n,l){if(Array.isArray(l))return l}var wl=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(u,h){var v;return(0,R.Z)(this,i),v=l.call(this),(0,j.Z)((0,H.Z)(v),"data",void 0),(0,j.Z)((0,H.Z)(v),"extent",void 0),(0,j.Z)((0,H.Z)(v),"hooks",{init:new fo.ni}),(0,j.Z)((0,H.Z)(v),"parser",{type:"geojson"}),(0,j.Z)((0,H.Z)(v),"transforms",[]),(0,j.Z)((0,H.Z)(v),"cluster",!1),(0,j.Z)((0,H.Z)(v),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,j.Z)((0,H.Z)(v),"mapService",void 0),(0,j.Z)((0,H.Z)(v),"invalidExtent",!1),(0,j.Z)((0,H.Z)(v),"originData",void 0),(0,j.Z)((0,H.Z)(v),"rawData",void 0),(0,j.Z)((0,H.Z)(v),"cfg",{}),(0,j.Z)((0,H.Z)(v),"clusterIndex",void 0),v.originData=u,v.initCfg(h),v.hooks.init.tap("parser",function(){v.excuteParser()}),v.hooks.init.tap("cluster",function(){v.initCluster()}),v.hooks.init.tap("transform",function(){v.executeTrans()}),v.init(),v}return(0,B.Z)(i,[{key:"setData",value:function(h,v){this.rawData=h,this.originData=h,this.initCfg(v),this.init(),this.emit("update")}},{key:"getClusters",value:function(h){return this.clusterIndex.getClusters(this.caculClusterExtent(2),h)}},{key:"getClustersLeaves",value:function(h){return this.clusterIndex.getLeaves(h,1/0)}},{key:"updateClusterData",value:function(h){var v=this,w=this.clusterOptions,I=w.method,k=void 0===I?"sum":I,X=w.field,le=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(h));this.clusterOptions.zoom=h,le.forEach(function(se){se.id||(se.properties.point_count=1)}),(X||wo()(k))&&(le=le.map(function(se){var Fe=se.id;if(Fe){var Wt,Bt=v.clusterIndex.getLeaves(Fe,1/0).map(function(jr){return jr.properties});if(In()(k)&&X){var Ar=function(n,l){return n.map(function(i){return 1*i[l]})}(Bt,X);Wt=is[k](Ar)}wo()(k)&&(Wt=k(Bt)),se.properties.stat=Wt}else se.properties.point_count=1;return se})),this.data=ic("geojson")({type:"FeatureCollection",features:le}),this.executeTrans()}},{key:"getFeatureById",value:function(h){var v=this.parser.type;if("geojson"!==(void 0===v?"geojson":v)||this.cluster)return h<this.data.dataArray.length?this.data.dataArray[h]:"null";var I=h<this.originData.features.length?this.originData.features[h]:"null",k=Po()(I);if(0!==this.transforms.length){var X=this.data.dataArray.find(function(le){return le._id===h});k.properties=X}return k}},{key:"getFeatureId",value:function(h,v){var w=this.data.dataArray.find(function(I){return I[h]===name});return null==w?void 0:w._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"caculClusterExtent",value:function(h){var v=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(v=(0,Ke.yA)((0,Ke.ds)(this.extent),h)),v[0].concat(v[1])}},{key:"initCfg",value:function(h){this.cfg=il()(this.cfg,h,Yc);var v=this.cfg;v&&(v.parser&&(this.parser=v.parser),v.transforms&&(this.transforms=v.transforms),this.cluster=v.cluster||!1,v.clusterOptions&&(this.cluster=!0,this.clusterOptions=Hl(Hl({},this.clusterOptions),v.clusterOptions)))}},{key:"excuteParser",value:function(){var h=this.parser,w=ic(h.type||"geojson");this.data=w(this.originData,h),this.extent=(0,Ke.We)(this.data.dataArray),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3]}},{key:"executeTrans",value:function(){var h=this;this.transforms.forEach(function(w){var k=function(l){return vl[l]}(w.type)(h.data,w);Object.assign(h.data,k)})}},{key:"initCluster",value:function(){this.cluster&&(this.clusterIndex=Qi(this.data,this.clusterOptions||{}))}},{key:"init",value:function(){this.hooks.init.call(this)}}]),i}(xt.EventEmitter);function kc(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return Vu(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Vu(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}function Vu(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}var Xl=6378e3,a=Math.PI/3,s=[0,a,2*a,3*a,4*a,5*a];function o(n){return n[0]}function p(n){return n[1]}function E(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function A(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?E(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function ce(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Ce(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?ce(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):ce(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}y(88818);const $e=wl;Nu("geojson",function(n,l){var i=[],u={};return n.features=n.features.filter(function(v){var w=v.geometry;return null!=v&&w&&w.type&&w.coordinates&&w.coordinates.length>0}),jl()(n,!0),0===n.features.length?{dataArray:[],featureKeys:u}:(Hs(n,function(v,w){var I=function(n){if(Array.isArray(n))return n;if("Feature"===n.type){if(null!==n.geometry)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(v),k=w,X=Bs(Bs({},v.properties),{},{coordinates:I,_id:k});i.push(X)}),{dataArray:i,featureKeys:u})}),Nu("image",function(n,l){var i=l.extent;return{images:new Promise(function(v){!function(n,l){var i=n,u=[];if("string"==typeof i)(0,Ke.gJ)({url:i},function(w,I){u.push(I),l(u)});else{var h=i.length,v=0;i.forEach(function(w){(0,Ke.gJ)({url:w},function(I,k){v++,u.push(k),v===h&&l(u)})})}}(n,function(w){v(w)})}),_id:1,dataArray:[{_id:0,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]}}),Nu("csv",function(n,l){return So(Pu(n),l)}),Nu("json",So),Nu("raster",function(n,l){var i=l.extent,u=l.width,h=l.height,v=l.min,w=l.max;return{_id:1,dataArray:[{_id:1,data:Array.from(n),width:u,height:h,min:v,max:w,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]}}),Cu("cluster",Qi),Cu("filter",function(n,l){var i=l.callback;return i&&(n.dataArray=n.dataArray.filter(i)),n}),Cu("join",function(n,l){var i=l.sourceField,u=l.targetField,v={};return l.data.forEach(function(w){v[w[i]]=w}),n.dataArray=n.dataArray.map(function(w){var I=w[u];return Ce(Ce({},w),v[I])}),n}),Cu("map",function(n,l){var i=l.callback;return i&&(n.dataArray=n.dataArray.map(i)),n}),Cu("grid",function(n,l){var u=l.size,h=void 0===u?10:u,v=h/(2*Math.PI*Xl)*(256<<20)/2,w=function(n,l){var h,w,i=1/0,u=-1/0,v=kc(n);try{for(v.s();!(w=v.n()).done;)h=w.value.coordinates[1],Number.isFinite(h)&&(i=h<i?h:i,u=h>u?h:u)}catch(yn){v.e(yn)}finally{v.f()}var X=function(n,l){return{yOffset:function(n){return n/Xl*(180/Math.PI)}(n),xOffset:function(n,l){return l/Xl*(180/Math.PI)/Math.cos(n*Math.PI/180)}(l,n)}}(l,(i+u)/2);if(X.xOffset<=0||X.yOffset<=0)return{gridHash:{},gridOffset:X};var Fe,le={},se=kc(n);try{for(se.s();!(Fe=se.n()).done;){var rt=Fe.value,Bt=rt.coordinates[1],Wt=rt.coordinates[0];if(Number.isFinite(Bt)&&Number.isFinite(Wt)){var Ar=Math.floor((Bt+90)/X.yOffset),jr=Math.floor((Wt+180)/X.xOffset),sn="".concat(Ar,"-").concat(jr);le[sn]=le[sn]||{count:0,points:[]},le[sn].count+=1,le[sn].points.push(rt)}}}catch(yn){se.e(yn)}finally{se.f()}return{gridHash:le,gridOffset:X}}(n.dataArray,h);return{yOffset:v,xOffset:v,radius:v,type:"grid",dataArray:function(n,l,i){return Object.keys(n).reduce(function(u,h,v){var w=h.split("-"),I=parseInt(w[0],10),k=parseInt(w[1],10),X={};if(i.field&&i.method){var le=Ke.a5.getColumn(n[h].points,i.field);X[i.method]=Ke.a5.statMap[i.method](le)}return Object.assign(X,{_id:v,coordinates:(0,Ke.Z)([l.xOffset*(k+.5)-180,l.yOffset*(I+.5)-90]),rawData:n[h].points,count:n[h].count}),u.push(X),u},[])}(w.gridHash,w.gridOffset,l)}}),Cu("hexagon",function(n,l){var u=l.size,v=l.method,w=void 0===v?"sum":v,I=(void 0===u?10:u)/(2*Math.PI*6378e3)*(256<<20)/2,k=n.dataArray.map(function(Fe){var rt=(0,Ke.Z)(Fe.coordinates),Bt=(0,ra.Z)(rt,2),Wt=Bt[0],Ar=Bt[1];return A(A({},Fe),{},{coordinates:[Wt,Ar]})});return{dataArray:function(){var w,I,k,n=0,l=0,i=1,u=1,h=o,v=p;function X(se){var Bt,Fe={},rt=[],Wt=se.length;for(Bt=0;Bt<Wt;++Bt)if(!isNaN(jr=+h.call(null,Ar=se[Bt],Bt,se))&&!isNaN(sn=+v.call(null,Ar,Bt,se))){var Ar,jr,sn,yn=Math.round(sn/=k),Mn=Math.round(jr=jr/I-(1&yn)/2),Wn=sn-yn;if(3*Math.abs(Wn)>1){var ei=jr-Mn,ti=Mn+(jr<Mn?-1:1)/2,Ui=yn+(sn<yn?-1:1),wa=jr-ti,Ua=sn-Ui;ei*ei+Wn*Wn>wa*wa+Ua*Ua&&(Mn=ti+(1&yn?1:-1)/2,yn=Ui)}var Mi=Mn+"-"+yn,ja=Fe[Mi];ja?ja.push(Ar):(rt.push(ja=Fe[Mi]=[Ar]),ja.x=(Mn+(1&yn)/2)*I,ja.y=yn*k)}return rt}function le(se){var Fe=0,rt=0;return s.map(function(Bt){var Wt=Math.sin(Bt)*se,Ar=-Math.cos(Bt)*se,jr=Wt-Fe,sn=Ar-rt;return Fe=Wt,rt=Ar,[jr,sn]})}return X.hexagon=function(se){return"m"+le(null==se?w:+se).join("l")+"z"},X.centers=function(){for(var se=[],Fe=Math.round(l/k),rt=Math.round(n/I),Bt=Fe*k;Bt<u+w;Bt+=k,++Fe)for(var Wt=rt*I+(1&Fe)*I/2;Wt<i+I/2;Wt+=I)se.push([Wt,Bt]);return se},X.mesh=function(){var se=le(w).slice(0,4).join("l");return X.centers().map(function(Fe){return"M"+Fe+"m"+se}).join("")},X.x=function(se){return arguments.length?(h=se,X):h},X.y=function(se){return arguments.length?(v=se,X):v},X.radius=function(se){return arguments.length?(I=2*(w=+se)*Math.sin(a),k=1.5*w,X):w},X.size=function(se){return arguments.length?(n=l=0,i=+se[0],u=+se[1],X):[i-n,u-l]},X.extent=function(se){return arguments.length?(n=+se[0][0],l=+se[0][1],i=+se[1][0],u=+se[1][1],X):[[n,l],[i,u]]},X.radius(1)}().radius(I).x(function(Fe){return Fe.coordinates[0]}).y(function(Fe){return Fe.coordinates[1]})(k).map(function(Fe,rt){var Bt;if(l.field&&w){var Wt=Ke.a5.getColumn(Fe,l.field);Fe[w]=Ke.a5.statMap[w](Wt)}return(0,j.Z)(Bt={},l.method,Fe[w]),(0,j.Z)(Bt,"count",Fe.length),(0,j.Z)(Bt,"rawData",Fe),(0,j.Z)(Bt,"coordinates",[Fe.x,Fe.y]),(0,j.Z)(Bt,"_id",rt),Bt}),radius:I,xOffset:I,yOffset:I,type:"hexagon"}});var Pt,Ht,hr,nr,_r,Dr,Qr,Xr,dn,qn,jn,Bn,Li,Dn,ft=y(35296),Ye=y.n(ft),lt=function(){function n(l,i){(0,R.Z)(this,n),(0,j.Z)(this,"attribute",void 0),(0,j.Z)(this,"buffer",void 0);var u=i.buffer,h=i.offset,v=i.stride,w=i.normalized,I=i.size,k=i.divisor;this.buffer=u,this.attribute={buffer:u.get(),offset:h||0,stride:v||0,normalized:w||!1,divisor:k||0},I&&(this.attribute.size=I)}return(0,B.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(i){this.buffer.subData(i)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),gi=((0,j.Z)(Pt={},W.gl.POINTS,"points"),(0,j.Z)(Pt,W.gl.LINES,"lines"),(0,j.Z)(Pt,W.gl.LINE_LOOP,"line loop"),(0,j.Z)(Pt,W.gl.LINE_STRIP,"line strip"),(0,j.Z)(Pt,W.gl.TRIANGLES,"triangles"),(0,j.Z)(Pt,W.gl.TRIANGLE_FAN,"triangle fan"),(0,j.Z)(Pt,W.gl.TRIANGLE_STRIP,"triangle strip"),Pt),ji=((0,j.Z)(Ht={},W.gl.STATIC_DRAW,"static"),(0,j.Z)(Ht,W.gl.DYNAMIC_DRAW,"dynamic"),(0,j.Z)(Ht,W.gl.STREAM_DRAW,"stream"),Ht),li=((0,j.Z)(hr={},W.gl.BYTE,"int8"),(0,j.Z)(hr,W.gl.UNSIGNED_INT,"int16"),(0,j.Z)(hr,W.gl.INT,"int32"),(0,j.Z)(hr,W.gl.UNSIGNED_BYTE,"uint8"),(0,j.Z)(hr,W.gl.UNSIGNED_SHORT,"uint16"),(0,j.Z)(hr,W.gl.UNSIGNED_INT,"uint32"),(0,j.Z)(hr,W.gl.FLOAT,"float"),hr),yi=((0,j.Z)(nr={},W.gl.ALPHA,"alpha"),(0,j.Z)(nr,W.gl.LUMINANCE,"luminance"),(0,j.Z)(nr,W.gl.LUMINANCE_ALPHA,"luminance alpha"),(0,j.Z)(nr,W.gl.RGB,"rgb"),(0,j.Z)(nr,W.gl.RGBA,"rgba"),(0,j.Z)(nr,W.gl.RGBA4,"rgba4"),(0,j.Z)(nr,W.gl.RGB5_A1,"rgb5 a1"),(0,j.Z)(nr,W.gl.RGB565,"rgb565"),(0,j.Z)(nr,W.gl.DEPTH_COMPONENT,"depth"),(0,j.Z)(nr,W.gl.DEPTH_STENCIL,"depth stencil"),nr),Ni=((0,j.Z)(_r={},W.gl.DONT_CARE,"dont care"),(0,j.Z)(_r,W.gl.NICEST,"nice"),(0,j.Z)(_r,W.gl.FASTEST,"fast"),_r),te=((0,j.Z)(Dr={},W.gl.NEAREST,"nearest"),(0,j.Z)(Dr,W.gl.LINEAR,"linear"),(0,j.Z)(Dr,W.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,j.Z)(Dr,W.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,j.Z)(Dr,W.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,j.Z)(Dr,W.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Dr),ne=((0,j.Z)(Qr={},W.gl.REPEAT,"repeat"),(0,j.Z)(Qr,W.gl.CLAMP_TO_EDGE,"clamp"),(0,j.Z)(Qr,W.gl.MIRRORED_REPEAT,"mirror"),Qr),N=((0,j.Z)(Xr={},W.gl.NONE,"none"),(0,j.Z)(Xr,W.gl.BROWSER_DEFAULT_WEBGL,"browser"),Xr),U=((0,j.Z)(dn={},W.gl.NEVER,"never"),(0,j.Z)(dn,W.gl.ALWAYS,"always"),(0,j.Z)(dn,W.gl.LESS,"less"),(0,j.Z)(dn,W.gl.LEQUAL,"lequal"),(0,j.Z)(dn,W.gl.GREATER,"greater"),(0,j.Z)(dn,W.gl.GEQUAL,"gequal"),(0,j.Z)(dn,W.gl.EQUAL,"equal"),(0,j.Z)(dn,W.gl.NOTEQUAL,"notequal"),dn),he=((0,j.Z)(qn={},W.gl.FUNC_ADD,"add"),(0,j.Z)(qn,W.gl.MIN_EXT,"min"),(0,j.Z)(qn,W.gl.MAX_EXT,"max"),(0,j.Z)(qn,W.gl.FUNC_SUBTRACT,"subtract"),(0,j.Z)(qn,W.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),qn),Te=((0,j.Z)(jn={},W.gl.ZERO,"zero"),(0,j.Z)(jn,W.gl.ONE,"one"),(0,j.Z)(jn,W.gl.SRC_COLOR,"src color"),(0,j.Z)(jn,W.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,j.Z)(jn,W.gl.SRC_ALPHA,"src alpha"),(0,j.Z)(jn,W.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,j.Z)(jn,W.gl.DST_COLOR,"dst color"),(0,j.Z)(jn,W.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,j.Z)(jn,W.gl.DST_ALPHA,"dst alpha"),(0,j.Z)(jn,W.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,j.Z)(jn,W.gl.CONSTANT_COLOR,"constant color"),(0,j.Z)(jn,W.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,j.Z)(jn,W.gl.CONSTANT_ALPHA,"constant alpha"),(0,j.Z)(jn,W.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,j.Z)(jn,W.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),jn),vt=((0,j.Z)(Bn={},W.gl.NEVER,"never"),(0,j.Z)(Bn,W.gl.ALWAYS,"always"),(0,j.Z)(Bn,W.gl.LESS,"less"),(0,j.Z)(Bn,W.gl.LEQUAL,"lequal"),(0,j.Z)(Bn,W.gl.GREATER,"greater"),(0,j.Z)(Bn,W.gl.GEQUAL,"gequal"),(0,j.Z)(Bn,W.gl.EQUAL,"equal"),(0,j.Z)(Bn,W.gl.NOTEQUAL,"notequal"),Bn),Rt=((0,j.Z)(Li={},W.gl.ZERO,"zero"),(0,j.Z)(Li,W.gl.KEEP,"keep"),(0,j.Z)(Li,W.gl.REPLACE,"replace"),(0,j.Z)(Li,W.gl.INVERT,"invert"),(0,j.Z)(Li,W.gl.INCR,"increment"),(0,j.Z)(Li,W.gl.DECR,"decrement"),(0,j.Z)(Li,W.gl.INCR_WRAP,"increment wrap"),(0,j.Z)(Li,W.gl.DECR_WRAP,"decrement wrap"),Li),Ot=((0,j.Z)(Dn={},W.gl.FRONT,"front"),(0,j.Z)(Dn,W.gl.BACK,"back"),Dn),ur=function(){function n(l,i){(0,R.Z)(this,n),(0,j.Z)(this,"buffer",void 0),this.buffer=l.buffer({data:i.data,usage:ji[i.usage||W.gl.STATIC_DRAW],type:li[i.type||W.gl.UNSIGNED_BYTE]})}return(0,B.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(i){this.buffer.subdata(i.data,i.offset)}}]),n}(),Vr=function(){function n(l,i){(0,R.Z)(this,n),(0,j.Z)(this,"elements",void 0),this.elements=l.elements({data:i.data,usage:ji[i.usage||W.gl.STATIC_DRAW],type:li[i.type||W.gl.UNSIGNED_BYTE],count:i.count})}return(0,B.Z)(n,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(i){this.elements.subdata(i.data)}},{key:"destroy",value:function(){}}]),n}(),Ln=function(){function n(l,i){(0,R.Z)(this,n),(0,j.Z)(this,"framebuffer",void 0);var v=i.color,w=i.colors,X={width:i.width,height:i.height};Array.isArray(w)&&(X.colors=w.map(function(le){return le.get()})),v&&"boolean"!=typeof v&&(X.color=v.get()),this.framebuffer=l.framebuffer(X)}return(0,B.Z)(n,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(i){this.framebuffer.resize(i.width,i.height)}}]),n}(),Xn=y(85464),ni=y(47679),Ci=y.n(ni),Si=y(82358),ea=y.n(Si);function xa(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function ua(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?xa(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):xa(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var ia,Ha=function(){function n(l,i){(0,R.Z)(this,n),(0,j.Z)(this,"reGl",void 0),(0,j.Z)(this,"destroyed",!1),(0,j.Z)(this,"drawCommand",void 0),(0,j.Z)(this,"drawParams",void 0),(0,j.Z)(this,"options",void 0),(0,j.Z)(this,"uniforms",{}),this.reGl=l;var u=i.vs,h=i.fs,v=i.attributes,w=i.uniforms,I=i.primitive,k=i.count,X=i.elements,le=i.depth,se=i.blend,Fe=i.stencil,rt=i.cull,Bt=i.instances,Wt={};this.options=i,w&&(this.uniforms=this.extractUniforms(w),Object.keys(w).forEach(function(sn){Wt[sn]=l.prop(sn)}));var Ar={};Object.keys(v).forEach(function(sn){Ar[sn]=v[sn].get()});var jr={attributes:Ar,frag:h,uniforms:Wt,vert:u,primitive:gi[void 0===I?W.gl.TRIANGLES:I]};Bt&&(jr.instances=Bt),k&&(jr.count=k),X&&(jr.elements=X.get()),this.initDepthDrawParams({depth:le},jr),this.initBlendDrawParams({blend:se},jr),this.initStencilDrawParams({stencil:Fe},jr),this.initCullDrawParams({cull:rt},jr),this.drawCommand=l(jr),this.drawParams=jr}return(0,B.Z)(n,[{key:"addUniforms",value:function(i){this.uniforms=ua(ua({},this.uniforms),this.extractUniforms(i))}},{key:"draw",value:function(i){if(!this.drawParams.attributes||0!==Object.keys(this.drawParams.attributes).length){var u=ua(ua({},this.uniforms),this.extractUniforms(i.uniforms||{})),h={};Object.keys(u).forEach(function(v){var w=(0,Xn.Z)(u[v]);h[v]="boolean"===w||"number"===w||Array.isArray(u[v])||u[v].BYTES_PER_ELEMENT?u[v]:u[v].get()}),this.drawCommand(h)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(i){i.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(i,u){var h=i.depth;h&&(u.depth={enable:void 0===h.enable||!!h.enable,mask:void 0===h.mask||!!h.mask,func:U[h.func||W.gl.LESS],range:h.range||[0,1]})}},{key:"initBlendDrawParams",value:function(i,u){var h=i.blend;if(h){var w=h.func,I=h.equation,k=h.color;u.blend={enable:!!h.enable,func:{srcRGB:Te[w&&w.srcRGB||W.gl.SRC_ALPHA],srcAlpha:Te[w&&w.srcAlpha||W.gl.SRC_ALPHA],dstRGB:Te[w&&w.dstRGB||W.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Te[w&&w.dstAlpha||W.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:he[I&&I.rgb||W.gl.FUNC_ADD],alpha:he[I&&I.alpha||W.gl.FUNC_ADD]},color:void 0===k?[0,0,0,0]:k}}}},{key:"initStencilDrawParams",value:function(i,u){var h=i.stencil;if(h){var w=h.mask,k=h.func,X=void 0===k?{cmp:W.gl.ALWAYS,ref:0,mask:-1}:k,le=h.opFront,se=void 0===le?{fail:W.gl.KEEP,zfail:W.gl.KEEP,zpass:W.gl.KEEP}:le,Fe=h.opBack,rt=void 0===Fe?{fail:W.gl.KEEP,zfail:W.gl.KEEP,zpass:W.gl.KEEP}:Fe;u.stencil={enable:!!h.enable,mask:void 0===w?-1:w,func:ua(ua({},X),{},{cmp:vt[X.cmp]}),opFront:{fail:Rt[se.fail],zfail:Rt[se.zfail],zpass:Rt[se.zpass]},opBack:{fail:Rt[rt.fail],zfail:Rt[rt.zfail],zpass:Rt[rt.zpass]}}}}},{key:"initCullDrawParams",value:function(i,u){var h=i.cull;if(h){var w=h.face;u.cull={enable:!!h.enable,face:Ot[void 0===w?W.gl.BACK:w]}}}},{key:"extractUniforms",value:function(i){var u=this,h={};return Object.keys(i).forEach(function(v){u.extractUniformsRecursively(v,i[v],h,"")}),h}},{key:"extractUniformsRecursively",value:function(i,u,h,v){var w=this;null===u||"number"==typeof u||"boolean"==typeof u||Array.isArray(u)&&"number"==typeof u[0]||Ci()(u)||""===u||"resize"in u?h["".concat(v&&v+".").concat(i)]=u:(ea()(u)&&Object.keys(u).forEach(function(I){w.extractUniformsRecursively(I,u[I],h,"".concat(v&&v+".").concat(i))}),Array.isArray(u)&&u.forEach(function(I,k){Object.keys(I).forEach(function(X){w.extractUniformsRecursively(X,I[X],h,"".concat(v&&v+".").concat(i,"[").concat(k,"]"))})}))}}]),n}(),Wa=function(){function n(l,i){(0,R.Z)(this,n),(0,j.Z)(this,"texture",void 0),(0,j.Z)(this,"width",void 0),(0,j.Z)(this,"height",void 0);var u=i.data,h=i.type,v=void 0===h?W.gl.UNSIGNED_BYTE:h,w=i.width,I=i.height,k=i.flipY,X=void 0!==k&&k,le=i.format,se=void 0===le?W.gl.RGBA:le,Fe=i.mipmap,rt=void 0!==Fe&&Fe,Bt=i.wrapS,Wt=void 0===Bt?W.gl.CLAMP_TO_EDGE:Bt,Ar=i.wrapT,jr=void 0===Ar?W.gl.CLAMP_TO_EDGE:Ar,sn=i.aniso,yn=void 0===sn?0:sn,Mn=i.alignment,Wn=void 0===Mn?1:Mn,ei=i.premultiplyAlpha,ti=void 0!==ei&&ei,Ui=i.mag,wa=void 0===Ui?W.gl.NEAREST:Ui,Ua=i.min,Mi=void 0===Ua?W.gl.NEAREST:Ua,ja=i.colorSpace,po=void 0===ja?W.gl.BROWSER_DEFAULT_WEBGL:ja;this.width=w,this.height=I;var Ru={width:w,height:I,type:li[v],format:yi[se],wrapS:ne[Wt],wrapT:ne[jr],mag:te[wa],min:te[Mi],alignment:Wn,flipY:X,colorSpace:N[po],premultiplyAlpha:ti,aniso:yn};u&&(Ru.data=u),"number"==typeof rt?Ru.mipmap=Ni[rt]:"boolean"==typeof rt&&(Ru.mipmap=rt),this.texture=l.texture(Ru)}return(0,B.Z)(n,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.texture(i)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(i){var u=i.width,h=i.height;this.texture.resize(u,h),this.width=u,this.height=h}},{key:"destroy",value:function(){this.texture.destroy()}}]),n}(),ga=(0,va.b2)()(ia=function(){function n(){var l=this;(0,R.Z)(this,n),(0,j.Z)(this,"extensionObject",void 0),(0,j.Z)(this,"gl",void 0),(0,j.Z)(this,"$container",void 0),(0,j.Z)(this,"canvas",void 0),(0,j.Z)(this,"width",void 0),(0,j.Z)(this,"height",void 0),(0,j.Z)(this,"isDirty",void 0),(0,j.Z)(this,"createModel",function(i){return new Ha(l.gl,i)}),(0,j.Z)(this,"createAttribute",function(i){return new lt(l.gl,i)}),(0,j.Z)(this,"createBuffer",function(i){return new ur(l.gl,i)}),(0,j.Z)(this,"createElements",function(i){return new Vr(l.gl,i)}),(0,j.Z)(this,"createTexture2D",function(i){return new Wa(l.gl,i)}),(0,j.Z)(this,"createFramebuffer",function(i){return new Ln(l.gl,i)}),(0,j.Z)(this,"useFramebuffer",function(i,u){l.gl({framebuffer:i?i.get():null})(u)}),(0,j.Z)(this,"clear",function(i){var w=i.framebuffer,I=void 0===w?null:w,k={color:i.color,depth:i.depth,stencil:i.stencil};k.framebuffer=null===I?I:I.get(),l.gl.clear(k)}),(0,j.Z)(this,"viewport",function(i){var v=i.width,w=i.height;l.gl._gl.viewport(i.x,i.y,v,w),l.width=v,l.height=w,l.gl._refresh()}),(0,j.Z)(this,"readPixels",function(i){var u=i.framebuffer,k={x:i.x,y:i.y,width:i.width,height:i.height};return u&&(k.framebuffer=u.get()),l.gl.read(k)}),(0,j.Z)(this,"getViewportSize",function(){return{width:l.gl._gl.drawingBufferWidth,height:l.gl._gl.drawingBufferHeight}}),(0,j.Z)(this,"getContainer",function(){var i;return null===(i=l.canvas)||void 0===i?void 0:i.parentElement}),(0,j.Z)(this,"getCanvas",function(){return l.canvas}),(0,j.Z)(this,"getGLContext",function(){return l.gl._gl}),(0,j.Z)(this,"destroy",function(){l.gl.destroy()})}return(0,B.Z)(n,[{key:"init",value:(l=(0,Jt.Z)(vr().mark(function u(h,v){var w=this;return vr().wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return this.canvas=h,k.next=3,new Promise(function(X,le){Ye()({canvas:w.canvas,attributes:{alpha:!0,antialias:v.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:v.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(Fe,rt){(Fe||!rt)&&le(Fe),X(rt)}})});case 3:this.gl=k.sent,this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 5:case"end":return k.stop()}},u,this)})),function(u,h){return l.apply(this,arguments)})},{key:"testExtension",value:function(i){return!!this.getGLContext().getExtension(i)}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var i=this.getGLContext();i.disable(i.CULL_FACE)}},{key:"setDirty",value:function(i){this.isDirty=i}},{key:"getDirty",value:function(){return this.isDirty}}]),n;var l}())||ia;function la(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function no(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?la(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):la(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var go,Kl,uu,Yo,Su,Ks,Cf,Xf,ll,qc,$h,ki=function(){function n(l){(0,R.Z)(this,n),(0,j.Z)(this,"sceneService",void 0),(0,j.Z)(this,"mapService",void 0),(0,j.Z)(this,"controlService",void 0),(0,j.Z)(this,"layerService",void 0),(0,j.Z)(this,"iconService",void 0),(0,j.Z)(this,"markerService",void 0),(0,j.Z)(this,"popupService",void 0),(0,j.Z)(this,"fontService",void 0),(0,j.Z)(this,"interactionService",void 0),(0,j.Z)(this,"container",void 0);var i=l.id,u=l.map,h=(0,W.Hp)();this.container=h,u.setContainer(h,i),h.bind(W.vK.IRendererService).to(ga).inSingletonScope(),this.sceneService=h.get(W.vK.ISceneService),this.mapService=h.get(W.vK.IMapService),this.iconService=h.get(W.vK.IIconService),this.fontService=h.get(W.vK.IFontService),this.controlService=h.get(W.vK.IControlService),this.layerService=h.get(W.vK.ILayerService),this.markerService=h.get(W.vK.IMarkerService),this.interactionService=h.get(W.vK.IInteractionService),this.popupService=h.get(W.vK.IPopupService),this.initComponent(i),this.sceneService.init(l),this.initControl()}return(0,B.Z)(n,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(i){return this.sceneService.exportPng(i)}},{key:"exportMap",value:function(i){return this.sceneService.exportPng(i)}},{key:"registerRenderService",value:function(i){var u=this;this.sceneService.loaded?new i(this).init():this.on("loaded",function(){new i(u).init()})}},{key:"map",get:function(){return this.mapService.map}},{key:"setBgColor",value:function(i){this.mapService.setBgColor(i)}},{key:"addLayer",value:function(i){var u=(0,W.e7)(this.container);i.setContainer(u),this.sceneService.addLayer(i)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(i){return this.layerService.getLayer(i)}},{key:"getLayerByName",value:function(i){return this.layerService.getLayerByName(i)}},{key:"removeLayer",value:function(i){this.layerService.remove(i)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addIconFont",value:function(i,u){this.fontService.addIconFont(i,u)}},{key:"addIconFonts",value:function(i){var u=this;i.forEach(function(h){var v=(0,ra.Z)(h,2);u.fontService.addIconFont(v[0],v[1])})}},{key:"addFontFace",value:function(i,u){this.sceneService.addFontFace(i,u)}},{key:"addImage",value:function(i,u){this.iconService.addImage(i,u)}},{key:"hasImage",value:function(i){return this.iconService.hasImage(i)}},{key:"removeImage",value:function(i){this.iconService.removeImage(i)}},{key:"addIconFontGlyphs",value:function(i,u){this.fontService.addIconGlyphs(u)}},{key:"addControl",value:function(i){this.controlService.addControl(i,this.container)}},{key:"removeControl",value:function(i){this.controlService.removeControl(i)}},{key:"getControlByName",value:function(i){return this.controlService.getControlByName(i)}},{key:"addMarker",value:function(i){this.markerService.addMarker(i)}},{key:"addMarkerLayer",value:function(i){this.markerService.addMarkerLayer(i)}},{key:"removeMarkerLayer",value:function(i){this.markerService.removeMarkerLayer(i)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(i){this.popupService.addPopup(i)}},{key:"on",value:function(i,u){-1===W.SceneEventList.indexOf(i)?this.mapService.on(i,u):this.sceneService.on(i,u)}},{key:"once",value:function(i,u){-1===W.SceneEventList.indexOf(i)?this.mapService.once(i,u):this.sceneService.once(i,u)}},{key:"off",value:function(i,u){-1===W.SceneEventList.indexOf(i)?this.mapService.off(i,u):this.sceneService.off(i,u)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(i){return this.mapService.getCenter(i)}},{key:"setCenter",value:function(i,u){return this.mapService.setCenter(i,u)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(i){return this.mapService.setPitch(i)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(i){this.mapService.setRotation(i)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(i){this.mapService.panTo(i)}},{key:"panBy",value:function(i,u){this.mapService.panBy(i,u)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(i){this.mapService.setZoom(i)}},{key:"fitBounds",value:function(i,u){var h=this.sceneService.getSceneConfig(),w=h.animate;this.mapService.fitBounds(i,u||no(no({},h.fitBoundsOptions),{},{animate:w}))}},{key:"setZoomAndCenter",value:function(i,u){this.mapService.setZoomAndCenter(i,u)}},{key:"setMapStyle",value:function(i){this.mapService.setMapStyle(i)}},{key:"setMapStatus",value:function(i){this.mapService.setMapStatus(i)}},{key:"pixelToLngLat",value:function(i){return this.mapService.pixelToLngLat(i)}},{key:"lngLatToPixel",value:function(i){return this.mapService.lngLatToPixel(i)}},{key:"containerToLngLat",value:function(i){return this.mapService.containerToLngLat(i)}},{key:"lngLatToContainer",value:function(i){return this.mapService.lngLatToContainer(i)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(i,u){this.container.bind(W.vK.IPostProcessingPass).to(i).whenTargetNamed(u)}},{key:"initComponent",value:function(i){this.controlService.init({container:Ke.SO.getContainer(i)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var i=this.sceneService.getSceneConfig();i.logoVisible&&this.addControl(new At({position:i.logoPosition}))}}]),n}(),Ca=y(53867),ba=y.n(Ca),ul=(go=(0,va.b2)(),Kl=(0,va.f3)(W.vK.IGlobalConfigService),go((Yo=function(){function n(){(0,R.Z)(this,n),(0,K.Z)(this,"configService",Su,this),(0,j.Z)(this,"enabled",void 0)}return(0,B.Z)(n,[{key:"apply",value:function(i,u){var h=this,w=u.postProcessingPassFactory,I=u.normalPassFactory;i.hooks.init.tap("MultiPassRendererPlugin",function(){var k=i.getLayerConfig(),le=k.passes,se=void 0===le?[]:le;h.enabled=!!k.enableMultiPassRenderer&&!1!==i.getLayerConfig().enableMultiPassRenderer,h.enabled&&(i.multiPassRenderer=h.createMultiPassRenderer(i,se,w,I),i.multiPassRenderer.setRenderFlag(!0))}),i.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(i,u,h,v){var w=i.multiPassRenderer;return i.getLayerConfig().enablePicking&&w.add(v("pixelPicking")),w}}]),n}(),Su=(0,Ve.Z)(Yo.prototype,"configService",[Kl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu=Yo))||uu),Yl=((0,j.Z)(Ks={},W.BlendType.additive,{enable:!0,func:{srcRGB:W.gl.ONE,dstRGB:W.gl.ONE,srcAlpha:1,dstAlpha:1}}),(0,j.Z)(Ks,W.BlendType.none,{enable:!1}),(0,j.Z)(Ks,W.BlendType.normal,{enable:!0,func:{srcRGB:W.gl.SRC_ALPHA,dstRGB:W.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,j.Z)(Ks,W.BlendType.subtractive,{enable:!0,func:{srcRGB:W.gl.ONE,dstRGB:W.gl.ONE,srcAlpha:W.gl.ZERO,dstAlpha:W.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:W.gl.FUNC_SUBTRACT,alpha:W.gl.FUNC_SUBTRACT}}),(0,j.Z)(Ks,W.BlendType.max,{enable:!0,func:{srcRGB:W.gl.ONE,dstRGB:W.gl.ONE},equation:{rgb:W.gl.MAX_EXT}}),(0,j.Z)(Ks,W.BlendType.min,{enable:!0,func:{srcRGB:W.gl.ONE,dstRGB:W.gl.ONE},equation:{rgb:W.gl.MIN_EXT}}),Ks),Wu=y(80167),ca=y.n(Wu),Hf=y(81690),Tl=y.n(Hf);function Ys(n,l,i,u,h){l.updateStyleAttribute(n,i,u,h)}function Dc(n,l,i){In()(i)?Ys(n,l,i,function(u){return u}):ca()(i)?Ys(n,l,[i],void 0):Tl()(i)&&2===i.length&&(In()(i[0])&&wo()(i[1])||In()(i[0])&&Tl()(i[1])&&ca()(i[1][0])&&ca()(i[1][1]))?Ys(n,l,i[0],i[1]):Ys(n,l,[1],void 0)}function hc(n,l,i){In()(i)?Ys(n,l,i,function(u){return u}):Tl()(i)&&2===i.length&&In()(i[0])&&wo()(i[1])?Ys(n,l,i[0],i[1]):Tl()(i)&&2===i.length&&ca()(i[0])&&ca()(i[1])?Ys(n,l,i,void 0):Ys(n,l,[0,0],void 0)}function Qh(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}function ep(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function qs(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?ep(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):ep(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var wh,Af,$c,Bc,pf,tp=0,Jc=(Cf=(0,W.yT)(W.vK.IGlobalConfigService),Xf=(0,W.yT)(W.vK.IShaderModuleService),ll=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,R.Z)(this,i),u=l.call(this),(0,j.Z)((0,H.Z)(u),"id","".concat(tp++)),(0,j.Z)((0,H.Z)(u),"name","".concat(tp)),(0,j.Z)((0,H.Z)(u),"type",void 0),(0,j.Z)((0,H.Z)(u),"visible",!0),(0,j.Z)((0,H.Z)(u),"zIndex",0),(0,j.Z)((0,H.Z)(u),"minZoom",void 0),(0,j.Z)((0,H.Z)(u),"maxZoom",void 0),(0,j.Z)((0,H.Z)(u),"inited",!1),(0,j.Z)((0,H.Z)(u),"layerModelNeedUpdate",!1),(0,j.Z)((0,H.Z)(u),"pickedFeatureID",null),(0,j.Z)((0,H.Z)(u),"selectedFeatureID",null),(0,j.Z)((0,H.Z)(u),"styleNeedUpdate",!1),(0,j.Z)((0,H.Z)(u),"rendering",void 0),(0,j.Z)((0,H.Z)(u),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,j.Z)((0,H.Z)(u),"hooks",{init:new fo.oI,afterInit:new fo.oI,beforeRender:new fo.oI,beforeRenderData:new fo.gg,afterRender:new fo.ni,beforePickingEncode:new fo.ni,afterPickingEncode:new fo.ni,beforeHighlight:new fo.ni(["pickedColor"]),afterHighlight:new fo.ni,beforeSelect:new fo.ni(["pickedColor"]),afterSelect:new fo.ni,beforeDestroy:new fo.ni,afterDestroy:new fo.ni}),(0,j.Z)((0,H.Z)(u),"models",[]),(0,j.Z)((0,H.Z)(u),"multiPassRenderer",void 0),(0,j.Z)((0,H.Z)(u),"plugins",void 0),(0,j.Z)((0,H.Z)(u),"sourceOption",void 0),(0,j.Z)((0,H.Z)(u),"layerModel",void 0),(0,K.Z)((0,H.Z)(u),"configService",qc,(0,H.Z)(u)),(0,K.Z)((0,H.Z)(u),"shaderModuleService",$h,(0,H.Z)(u)),(0,j.Z)((0,H.Z)(u),"cameraService",void 0),(0,j.Z)((0,H.Z)(u),"coordinateService",void 0),(0,j.Z)((0,H.Z)(u),"iconService",void 0),(0,j.Z)((0,H.Z)(u),"fontService",void 0),(0,j.Z)((0,H.Z)(u),"pickingService",void 0),(0,j.Z)((0,H.Z)(u),"rendererService",void 0),(0,j.Z)((0,H.Z)(u),"layerService",void 0),(0,j.Z)((0,H.Z)(u),"interactionService",void 0),(0,j.Z)((0,H.Z)(u),"mapService",void 0),(0,j.Z)((0,H.Z)(u),"styleAttributeService",void 0),(0,j.Z)((0,H.Z)(u),"layerSource",void 0),(0,j.Z)((0,H.Z)(u),"postProcessingPassFactory",void 0),(0,j.Z)((0,H.Z)(u),"normalPassFactory",void 0),(0,j.Z)((0,H.Z)(u),"animateOptions",{enable:!1}),(0,j.Z)((0,H.Z)(u),"container",void 0),(0,j.Z)((0,H.Z)(u),"encodedData",void 0),(0,j.Z)((0,H.Z)(u),"configSchema",void 0),(0,j.Z)((0,H.Z)(u),"currentPickId",null),(0,j.Z)((0,H.Z)(u),"rawConfig",void 0),(0,j.Z)((0,H.Z)(u),"needUpdateConfig",void 0),(0,j.Z)((0,H.Z)(u),"pendingStyleAttributes",[]),(0,j.Z)((0,H.Z)(u),"scaleOptions",{}),(0,j.Z)((0,H.Z)(u),"animateStartTime",void 0),(0,j.Z)((0,H.Z)(u),"aniamateStatus",!1),(0,j.Z)((0,H.Z)(u),"sourceEvent",function(){u.dataState.dataSourceNeedUpdate=!0;var v=u.getLayerConfig();v.autoFit&&u.fitBounds(v.fitBoundsOptions),u.emit("dataUpdate"),u.reRender()}),u.name=h.name||u.id,u.zIndex=h.zIndex||0,u.rawConfig=h,u}return(0,B.Z)(i,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(h){if(this.inited){var v=this.container.get(W.vK.SceneID);(function(n,l){n.opacity&&Dc("opacity",l,n.opacity),n.strokeWidth&&Dc("strokeWidth",l,n.strokeWidth),n.strokeOpacity&&Dc("strokeOpacity",l,n.strokeOpacity),n.stroke&&function(n,l,i){In()(i)?Ys(n,l,i,void 0):Tl()(i)&&2===i.length&&(In()(i[0])&&wo()(i[1])||In()(i[0])&&Tl()(i[1])&&i[1].length>0)?Ys(n,l,i[0],i[1]):Ys(n,l,"#fff",void 0)}("stroke",l,n.stroke),n.offsets&&hc("offsets",l,n.offsets),n.textOffset&&hc("textOffset",l,n.textOffset)})(h,this),this.configService.setLayerConfig(v,this.id,qs(qs(qs({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),h)),this.needUpdateConfig={}}else this.needUpdateConfig=qs(qs({},this.needUpdateConfig),h)}},{key:"setContainer",value:function(h){this.container=h}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(h){return this.plugins.push(h),this}},{key:"init",value:function(){var h=this,v=this.container.get(W.vK.SceneID),w=this.rawConfig.enableMultiPassRenderer;this.configService.setLayerConfig(v,this.id,{enableMultiPassRenderer:void 0!==w&&w}),this.iconService=this.container.get(W.vK.IIconService),this.fontService=this.container.get(W.vK.IFontService),this.rendererService=this.container.get(W.vK.IRendererService),this.layerService=this.container.get(W.vK.ILayerService),this.interactionService=this.container.get(W.vK.IInteractionService),this.pickingService=this.container.get(W.vK.IPickingService),this.mapService=this.container.get(W.vK.IMapService),this.cameraService=this.container.get(W.vK.ICameraService),this.coordinateService=this.container.get(W.vK.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(W.vK.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(W.vK.IFactoryNormalPass),this.styleAttributeService=this.container.get(W.vK.IStyleAttributeService),this.multiPassRenderer=this.container.get(W.vK.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(se){var Fe=se.attributeName,Wt=se.updateOptions;h.styleAttributeService.updateStyleAttribute(Fe,{scale:qs({field:se.attributeField},h.splitValuesAndCallbackInAttribute(se.attributeValues,h.getLayerConfig()[Fe]))},Wt)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(W.vK.ILayerPlugin);var X,k=function(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return Qh(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Qh(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}(this.plugins);try{for(k.s();!(X=k.n()).done;)X.value.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(se){k.e(se)}finally{k.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(qs(qs({},this.getDefaultConfig()),this.rawConfig));var v=this.getLayerConfig().animateOption;null!=v&&v.enable&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(h,v,w){return this.updateStyleAttribute("color",h,v,w),this}},{key:"texture",value:function(h,v,w){return this.updateStyleAttribute("texture",h,v,w),this}},{key:"rotate",value:function(h,v,w){return this.updateStyleAttribute("rotate",h,v,w),this}},{key:"size",value:function(h,v,w){return this.updateStyleAttribute("size",h,v,w),this}},{key:"filter",value:function(h,v,w){return this.updateStyleAttribute("filter",h,v,w),this}},{key:"shape",value:function(h,v,w){return this.updateStyleAttribute("shape",h,v,w),this}},{key:"label",value:function(h,v,w){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:h,attributeValues:v,updateOptions:w}),this}},{key:"animate",value:function(h){var v={};return ba()(h)?(v.enable=!0,v=qs(qs({},v),h)):v.enable=h,this.updateLayerConfig({animateOption:v}),this}},{key:"source",value:function(h,v){return null!=h&&h.data?(this.setSource(h),this):(this.sourceOption={data:h,options:v},this)}},{key:"setData",value:function(h,v){var w=this;return this.inited?this.layerSource.setData(h,v):this.on("inited",function(){w.layerSource.setData(h,v)}),this}},{key:"style",value:function(h){var v=this,w=h.passes,I=(0,It.Z)(h,["passes"]);return w&&function(n){return n.map(function(l){return"string"==typeof l&&(l=[l,{}]),l})}(w).forEach(function(k){var X=v.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(k[0]);X&&X.updateOptions(k[1])}),this.rawConfig=qs(qs({},this.rawConfig),I),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(h,v){return ba()(h)?this.scaleOptions=qs(qs({},this.scaleOptions),h):this.scaleOptions[h]=v,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return 0!==this.getEncodedData().length&&this.renderModels(),this}},{key:"active",value:function(h){var v={};return v.enableHighlight=!!ba()(h)||h,ba()(h)?(v.enableHighlight=!0,h.color&&(v.highlightColor=h.color)):v.enableHighlight=!!h,this.updateLayerConfig(v),this}},{key:"setActive",value:function(h,v){var w=this;if(ba()(h)){var I=h.x,k=void 0===I?0:I,X=h.y,le=void 0===X?0:X;this.updateLayerConfig({highlightColor:ba()(v)?v.color:this.getLayerConfig().highlightColor}),this.pick({x:k,y:le})}else this.updateLayerConfig({pickedFeatureID:h,highlightColor:ba()(v)?v.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call((0,Ke.Z6)(h)).then(function(){setTimeout(function(){w.reRender()},1)})}},{key:"select",value:function(h){var v={};return v.enableSelect=!!ba()(h)||h,ba()(h)?(v.enableSelect=!0,h.color&&(v.selectColor=h.color)):v.enableSelect=!!h,this.updateLayerConfig(v),this}},{key:"setSelect",value:function(h,v){var w=this;if(ba()(h)){var I=h.x,k=void 0===I?0:I,X=h.y,le=void 0===X?0:X;this.updateLayerConfig({selectColor:ba()(v)?v.color:this.getLayerConfig().selectColor}),this.pick({x:k,y:le})}else this.updateLayerConfig({pickedFeatureID:h,selectColor:ba()(v)?v.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call((0,Ke.Z6)(h)).then(function(){setTimeout(function(){w.reRender()},1)})}},{key:"setBlend",value:function(h){this.updateLayerConfig({blend:h}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(h){return this.zIndex=h,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(h){this.currentPickId=h}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(h){this.selectedFeatureID=h}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var h=this.mapService.getZoom(),v=this.getLayerConfig(),I=v.minZoom,X=v.maxZoom;return!!v.visible&&h>=(void 0===I?-1/0:I)&&h<=(void 0===X?1/0:X)}},{key:"setMinZoom",value:function(h){return this.updateLayerConfig({minZoom:h}),this}},{key:"getMinZoom",value:function(){return this.getLayerConfig().minZoom}},{key:"getMaxZoom",value:function(){return this.getLayerConfig().maxZoom}},{key:"get",value:function(h){return this.getLayerConfig()[h]}},{key:"setMaxZoom",value:function(h){return this.updateLayerConfig({maxZoom:h}),this}},{key:"fitBounds",value:function(h){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var w=this.getSource().extent;return w.some(function(k){return Math.abs(k)===1/0})||this.mapService.fitBounds([[w[0],w[1]],[w[2],w[3]]],h),this}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(h){return h.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(h){return h.needRescale||h.needRemapping||h.needRegenerateVertices}).length}},{key:"setSource",value:function(h){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=h,this.inited&&this.layerSource.cluster){var v=this.mapService.getZoom();this.layerSource.updateClusterData(v)}this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(h){this.encodedData=h}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getLegendItems",value:function(h){var v=this.styleAttributeService.getLayerAttributeScale(h);return v?v.ticks?v.ticks().map(function(k){return(0,j.Z)({value:k},h,v(k))}):v.invertExtent?v.range().map(function(k){return(0,j.Z)({value:v.invertExtent(k)},h,k)}):void 0:[]}},{key:"pick",value:function(h){this.interactionService.triggerHover({x:h.x,y:h.y})}},{key:"boxSelect",value:function(h,v){this.pickingService.boxPickLayer(this,h,v)}},{key:"buildLayerModel",value:function(h){var v=h.moduleName,w=h.vertexShader,I=h.fragmentShader,k=h.triangulation,X=h.segmentNumber,le=(0,It.Z)(h,["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber"]);this.shaderModuleService.registerModule(v,{vs:w,fs:I});var se=this.shaderModuleService.getModule(v),Fe=se.vs,rt=se.fs,Bt=se.uniforms,Wt=this.rendererService.createModel,Ar=this.styleAttributeService.createAttributesAndIndices(this.encodedData,k,X);return Wt(qs({attributes:Ar.attributes,uniforms:Bt,fs:rt,vs:Fe,elements:Ar.elements,blend:Yl[W.BlendType.normal]},le))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(h){var v=this.getLayerConfig(),w=v.enableHighlight,I=void 0===w||w,k=v.enableSelect,X=void 0===k||k,le=-1!==this.eventNames().indexOf(h)||-1!==this.eventNames().indexOf("un"+h);return("click"===h||"dblclick"===h)&&X&&(le=!0),"mousemove"===h&&(I||-1!==this.eventNames().indexOf("mouseenter")||-1!==this.eventNames().indexOf("unmousemove")||-1!==this.eventNames().indexOf("mouseout"))&&(le=!0),this.isVisible()&&le}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var h=this;return this.getEncodedData().length>0&&(this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(v){v.draw({uniforms:h.layerModel.getUninforms()})})),this}},{key:"updateStyleAttribute",value:function(h,v,w,I){this.inited?this.styleAttributeService.updateStyleAttribute(h,{scale:qs({field:v},this.splitValuesAndCallbackInAttribute(w,this.getLayerConfig()[v]))},I):this.pendingStyleAttributes.push({attributeName:h,attributeField:v,attributeValues:w,updateOptions:I})}},{key:"setEarthTime",value:function(h){console.warn("empty fn")}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(h,v){return{values:wo()(h)?void 0:h||v,callback:wo()(h)?h:void 0}}}]),i}(xt.EventEmitter),qc=(0,Ve.Z)(ll.prototype,"configService",[Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=(0,Ve.Z)(ll.prototype,"shaderModuleService",[Xf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ll),Tp=y(49977),Eo=y.n(Tp),pc=y(27859);function df(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}var Iu=(wh=(0,W.yT)(W.vK.IGlobalConfigService),Af=(0,W.yT)(W.vK.IShaderModuleService),$c=function(){function n(l){(0,R.Z)(this,n),(0,j.Z)(this,"triangulation",void 0),(0,j.Z)(this,"createTexture2D",void 0),(0,j.Z)(this,"layer",void 0),(0,j.Z)(this,"dataTexture",void 0),(0,j.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,j.Z)(this,"rowCount",void 0),(0,j.Z)(this,"cacheStyleProperties",void 0),(0,j.Z)(this,"cellLength",void 0),(0,j.Z)(this,"cellProperties",void 0),(0,j.Z)(this,"cellTypeLayout",void 0),(0,j.Z)(this,"stylePropertyesExist",void 0),(0,j.Z)(this,"dataTextureTest",void 0),(0,K.Z)(this,"configService",Bc,this),(0,K.Z)(this,"shaderModuleService",pf,this),(0,j.Z)(this,"rendererService",void 0),(0,j.Z)(this,"iconService",void 0),(0,j.Z)(this,"fontService",void 0),(0,j.Z)(this,"styleAttributeService",void 0),(0,j.Z)(this,"mapService",void 0),(0,j.Z)(this,"cameraService",void 0),(0,j.Z)(this,"layerService",void 0),this.layer=l,this.rendererService=l.getContainer().get(W.vK.IRendererService),this.styleAttributeService=l.getContainer().get(W.vK.IStyleAttributeService),this.mapService=l.getContainer().get(W.vK.IMapService),this.iconService=l.getContainer().get(W.vK.IIconService),this.fontService=l.getContainer().get(W.vK.IFontService),this.cameraService=l.getContainer().get(W.vK.ICameraService),this.layerService=l.getContainer().get(W.vK.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate(),this.createTexture2D=this.rendererService.createTexture2D,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertyesExist={hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new ImageData(1,1).data,mag:W.gl.NEAREST,min:W.gl.NEAREST,width:1,height:1}))}return(0,B.Z)(n,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertyesExist={hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertyesExist.hasOpacity,this.stylePropertyesExist.hasStrokeOpacity,this.stylePropertyesExist.hasStrokeWidth,this.stylePropertyesExist.hasStroke,this.stylePropertyesExist.hasOffsets,0,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(i){var u=!1;return Eo()(i.opacity,this.cacheStyleProperties.opacity)||(u=!0,this.cacheStyleProperties.opacity=i.opacity),Eo()(i.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(u=!0,this.cacheStyleProperties.strokeOpacity=i.strokeOpacity),Eo()(i.strokeWidth,this.cacheStyleProperties.strokeWidth)||(u=!0,this.cacheStyleProperties.strokeWidth=i.strokeWidth),Eo()(i.stroke,this.cacheStyleProperties.stroke)||(u=!0,this.cacheStyleProperties.stroke=i.stroke),Eo()(i.offsets,this.cacheStyleProperties.offsets)||(u=!0,this.cacheStyleProperties.offsets=i.offsets),void 0===this.dataTexture&&(u=!0),u}},{key:"judgeStyleAttributes",value:function(i){this.clearLastCalRes(),void 0!==i.opacity&&!ca()(i.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertyesExist.hasOpacity=1,this.cellLength+=1),void 0!==i.strokeOpacity&&!ca()(i.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertyesExist.hasStrokeOpacity=1,this.cellLength+=1),void 0!==i.strokeWidth&&!ca()(i.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertyesExist.hasStrokeWidth=1,this.cellLength+=1),void 0!==i.stroke&&!this.isStaticColor(i.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertyesExist.hasStroke=1,this.cellLength+=4),void 0!==i.offsets&&!this.isOffsetStatic(i.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertyesExist.hasOffsets=1,this.cellLength+=2)}},{key:"isStaticColor",value:function(i){return!!In()(i)&&!!(0,pc.ZP)(i)}},{key:"getStrokeColor",value:function(i){if(this.isStaticColor(i)){var u=(0,Ke.CI)(i);return u[0]=u[0]?u[0]:0,u[1]=u[1]?u[1]:0,u[2]=u[2]?u[2]:0,u[3]=u[3]?u[3]:0,u}return[0,0,0,0]}},{key:"isOffsetStatic",value:function(i){return!!(Tl()(i)&&2===i.length&&ca()(i[0])&&ca()(i[1]))}},{key:"patchMod",value:function(i,u){for(var h=0;h<u;h++)i.push(-1)}},{key:"patchData",value:function(i,u,h){var w,v=function(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return df(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return df(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}(h);try{for(v.s();!(w=v.n()).done;){var I=w.value,k=I.attr,X=I.count,le=u[k];le?"stroke"===k?i.push.apply(i,(0,Ta.Z)((0,Ke.CI)(le))):"offsets"===k?this.isOffsetStatic(le)?i.push(-le[0],le[1]):i.push(0,0):i.push(ca()(le)?le:1):this.patchMod(i,X)}}catch(se){v.e(se)}finally{v.f()}}},{key:"calDataFrame",value:function(i,u,h){for(var v=u.length,w=Math.ceil(v*i/this.DATA_TEXTURE_WIDTH),I=w*this.DATA_TEXTURE_WIDTH,k=[],X=0;X<v;X++)this.patchData(k,u[X],h);for(var se=k.length;se<I;se++)k.push(-1);return{data:k,width:this.DATA_TEXTURE_WIDTH,height:w}}},{key:"getBlend",value:function(){var u=this.layer.getLayerConfig().blend;return Yl[W.BlendType[void 0===u?"normal":u]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.duration||4,i.interval||.2,i.trailLength||.1]}},{key:"startModelAnimate",value:function(){this.layer.getLayerConfig().animateOption.enable&&this.layer.setAnimateStartTime()}}]),n}(),Bc=(0,Ve.Z)($c.prototype,"configService",[wh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pf=(0,Ve.Z)($c.prototype,"shaderModuleService",[Af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$c),Kf=y(41604),Cl=y.n(Kf);function Mf(n){return n/180*Math.acos(-1)}function Qc(n){var l=Mf(n[0])+Math.PI/2,i=Mf(n[1]),u=100+.4*Math.random(),h=u*Math.cos(i)*Math.cos(l);return[u*Math.cos(i)*Math.sin(l),u*Math.sin(i),h]}var Ns=aa(),_s=(aa(),aa()),ql=aa(),mf=aa();function ef(n,l,i,u,h){return Ba(n,i,u),Lo(n,n),[h/es(l=Ma(-n[1],n[0]),Ma(-i[1],i[0])),l]}function Js(n,l){return function(n,l,i){return n[0]=l,n[1]=i,n}(n,-l[1],l[0])}function Of(n,l,i){return m(n,l,i),Lo(n,n),n}function qf(n,l){return n[0]===l[0]&&n[1]===l[1]}var rp=function(){function n(){var l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,R.Z)(this,n),(0,j.Z)(this,"complex",void 0),(0,j.Z)(this,"join",void 0),(0,j.Z)(this,"cap",void 0),(0,j.Z)(this,"miterLimit",void 0),(0,j.Z)(this,"thickness",void 0),(0,j.Z)(this,"normal",void 0),(0,j.Z)(this,"lastFlip",-1),(0,j.Z)(this,"miter",Ma(0,0)),(0,j.Z)(this,"started",!1),(0,j.Z)(this,"dash",!1),(0,j.Z)(this,"totalDistance",0),this.join=l.join||"miter",this.cap=l.cap||"butt",this.miterLimit=l.miterLimit||10,this.thickness=l.thickness||1,this.dash=l.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return(0,B.Z)(n,[{key:"extrude_gaode2",value:function(i,u){var h=this.complex;if(i.length<=1)return h;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var v=i.length,w=h.startIndex,I=1;I<v;I++)w+=this.segment_gaode2(h,w,i[I-1],i[I],I<i.length-1?i[I+1]:null,u[I-1],u[I],I<u.length-1?u[I+1]:null);if(this.dash)for(var Wt=0;Wt<h.positions.length/6;Wt++)h.positions[6*Wt+5]=this.totalDistance;return h.startIndex=h.positions.length/6,h}},{key:"extrude",value:function(i){var u=this.complex;if(i.length<=1)return u;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var h=i.length,v=u.startIndex,w=1;w<h;w++)v+=this.segment(u,v,i[w-1],i[w],w<i.length-1?i[w+1]:null);if(this.dash)for(var se=0;se<u.positions.length/6;se++)u.positions[6*se+5]=this.totalDistance;return u.startIndex=u.positions.length/6,u}},{key:"segment_gaode2",value:function(i,u,h,v,w,I,k,X){var le=0,se=i.indices,Fe=i.positions,rt=i.normals,Bt="square"===this.cap,Wt="bevel"===this.join,Ar=(0,Ke.Z)([k[0],k[1]]),jr=(0,Ke.Z)([I[0],I[1]]);Of(_s,v,h);var sn=0;if(this.dash&&(sn=this.lineSegmentDistance(Ar,jr),this.totalDistance+=sn),this.normal||(this.normal=aa(),Js(this.normal,_s)),!this.started)if(this.started=!0,Bt){var yn=aa(),Mn=aa();Ba(yn,this.normal,_s),Ba(Mn,this.normal,_s),rt.push(Mn[0],Mn[1],0),rt.push(yn[0],yn[1],0),Fe.push(h[0],h[1],0,this.totalDistance-sn,-this.thickness,0),Fe.push(h[0],h[1],0,this.totalDistance-sn,this.thickness,0)}else this.extrusions(Fe,rt,h,this.normal,this.thickness,this.totalDistance-sn);if(se.push(u+0,u+1,u+2),w){qf(v,w)&&Ba(w,v,Lo(w,Ee(w,v,h))),Of(ql,w,v);var ti=ef(mf,aa(),_s,ql,this.thickness),Ui=(0,ra.Z)(ti,2),wa=Ui[0],Ua=Ui[1],Mi=es(mf,this.normal)<0?-1:1,ja=Wt;ja||"miter"!==this.join||wa>this.miterLimit&&(ja=!0),ja?(rt.push(this.normal[0],this.normal[1],0),rt.push(Ua[0],Ua[1],0),Fe.push(v[0],v[1],0,this.totalDistance,-this.thickness*Mi,0),Fe.push(v[0],v[1],0,this.totalDistance,this.thickness*Mi,0),se.push.apply(se,(0,Ta.Z)(this.lastFlip!==-Mi?[u,u+2,u+3]:[u+2,u+1,u+3])),se.push(u+2,u+3,u+4),Js(Ns,ql),Ka(this.normal,Ns),rt.push(this.normal[0],this.normal[1],0),Fe.push(v[0],v[1],0,this.totalDistance,-this.thickness*Mi,0),le+=3):(this.extrusions(Fe,rt,v,Ua,wa,this.totalDistance),se.push.apply(se,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),Mi=-1,Ka(this.normal,Ua),le+=2),this.lastFlip=Mi}else{if(Js(this.normal,_s),Bt){var Wn=aa(),ei=aa();m(ei,_s,this.normal),Ba(Wn,_s,this.normal),rt.push(ei[0],ei[1],0),rt.push(Wn[0],Wn[1],0),Fe.push(v[0],v[1],0,this.totalDistance,this.thickness,0),Fe.push(v[0],v[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Fe,rt,v,this.normal,this.thickness,this.totalDistance);se.push.apply(se,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),le+=2}return le}},{key:"segment",value:function(i,u,h,v,w){var I=0,k=i.indices,X=i.positions,le=i.normals,se="square"===this.cap,Fe="bevel"===this.join,rt=(0,Ke.Z)([v[0],v[1]]),Bt=(0,Ke.Z)([h[0],h[1]]);Of(_s,rt,Bt);var Wt=0;if(this.dash&&(Wt=this.lineSegmentDistance(rt,Bt),this.totalDistance+=Wt),this.normal||(this.normal=aa(),Js(this.normal,_s)),!this.started)if(this.started=!0,se){var Ar=aa(),jr=aa();Ba(Ar,this.normal,_s),Ba(jr,this.normal,_s),le.push(jr[0],jr[1],0),le.push(Ar[0],Ar[1],0),X.push(h[0],h[1],0,this.totalDistance-Wt,-this.thickness,0),X.push(h[0],h[1],0,this.totalDistance-Wt,this.thickness,0)}else this.extrusions(X,le,h,this.normal,this.thickness,this.totalDistance-Wt);if(k.push(u+0,u+1,u+2),w){var Mn=(0,Ke.Z)([w[0],w[1]]);qf(rt,Mn)&&Ba(Mn,rt,Lo(Mn,Ee(Mn,rt,Bt))),Of(ql,Mn,rt);var Wn=ef(mf,aa(),_s,ql,this.thickness),ei=(0,ra.Z)(Wn,2),ti=ei[0],Ui=ei[1],wa=es(mf,this.normal)<0?-1:1,Ua=Fe;Ua||"miter"!==this.join||ti>this.miterLimit&&(Ua=!0),Ua?(le.push(this.normal[0],this.normal[1],0),le.push(Ui[0],Ui[1],0),X.push(v[0],v[1],0,this.totalDistance,-this.thickness*wa,0),X.push(v[0],v[1],0,this.totalDistance,this.thickness*wa,0),k.push.apply(k,(0,Ta.Z)(this.lastFlip!==-wa?[u,u+2,u+3]:[u+2,u+1,u+3])),k.push(u+2,u+3,u+4),Js(Ns,ql),Ka(this.normal,Ns),le.push(this.normal[0],this.normal[1],0),X.push(v[0],v[1],0,this.totalDistance,-this.thickness*wa,0),I+=3):(this.extrusions(X,le,v,Ui,ti,this.totalDistance),k.push.apply(k,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),wa=-1,Ka(this.normal,Ui),I+=2),this.lastFlip=wa}else{if(Js(this.normal,_s),se){var sn=aa(),yn=aa();m(yn,_s,this.normal),Ba(sn,_s,this.normal),le.push(yn[0],yn[1],0),le.push(sn[0],sn[1],0),X.push(v[0],v[1],0,this.totalDistance,this.thickness,0),X.push(v[0],v[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(X,le,v,this.normal,this.thickness,this.totalDistance);k.push.apply(k,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),I+=2}return I}},{key:"extrusions",value:function(i,u,h,v,w,I){u.push(v[0],v[1],0),u.push(v[0],v[1],0),i.push(h[0],h[1],0,I,-w,0),i.push(h[0],h[1],0,I,w,0)}},{key:"lineSegmentDistance",value:function(i,u){var h=u[0]-i[0],v=u[1]-i[1];return Math.sqrt(h*h+v*v)}}]),n}();function tf(n){if(ca()(n[0]))return n;if(ca()(n[0][0]))throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8");if(ca()(n[0][0][0])){var i=0,u=0,h=0;return n.forEach(function(v){v.forEach(function(w){i+=w[0],u+=w[1],h++})}),[i/h,u/h,0]}throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8")}function Th(n){var l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n[0][0],u=n[0][n[0].length-1];i[0]===u[0]&&i[1]===u[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var h=n[0].length,v=Cl().flatten(n),w=v.vertices,I=v.dimensions,k=[],X=[],le=[],se=0;se<w.length/I;se++)2===I?k.push(w[2*se],w[2*se+1],1,-1,-1):k.push(w[3*se],w[3*se+1],1,-1,-1),le.push(0,0,1);var Fe=Cl()(v.vertices,v.holes,v.dimensions);X.push.apply(X,(0,Ta.Z)(Fe));for(var rt=function(Ar){var jr=v.vertices.slice(Ar*I,(Ar+1)*I),sn=v.vertices.slice((Ar+1)*I,(Ar+2)*I);0===sn.length&&(sn=v.vertices.slice(0,I));var yn=k.length/5;k.push(jr[0],jr[1],1,0,0,sn[0],sn[1],1,.1,0,jr[0],jr[1],0,0,.8,sn[0],sn[1],0,.1,.8);var Mn=Jf([sn[0],sn[1],1],[jr[0],jr[1],0],[jr[0],jr[1],1],l);le.push.apply(le,(0,Ta.Z)(Mn).concat((0,Ta.Z)(Mn),(0,Ta.Z)(Mn),(0,Ta.Z)(Mn))),X.push.apply(X,(0,Ta.Z)([1,2,0,3,2,1].map(function(Wn){return Wn+yn})))},Bt=0;Bt<h;Bt++)rt(Bt);return{positions:k,index:X,normals:le}}function Jf(n,l,i){var u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],h=or(),v=or(),w=or();u&&(n=(0,Ke.vP)(n),l=(0,Ke.vP)(l),i=(0,Ke.vP)(i));var I=On.apply(M,(0,Ta.Z)(n)),k=On.apply(M,(0,Ta.Z)(l)),X=On.apply(M,(0,Ta.Z)(i));Ia(h,X,k),Ia(v,I,k),Fr(w,h,v);var le=or();return Kt(le,w),le}var lu,Ps=(()=>(function(n){n.CYLINDER="cylinder",n.SQUARECOLUMN="squareColumn",n.TRIANGLECOLUMN="triangleColumn",n.HEXAGONCOLUMN="hexagonColumn",n.PENTAGONCOLUMN="pentagonColumn"}(Ps||(Ps={})),Ps))(),Nc=(()=>(function(n){n.CIRCLE="circle",n.SQUARE="square",n.TRIANGLE="triangle",n.HEXAGON="hexagon",n.PENTAGON="pentagon"}(Nc||(Nc={})),Nc))();function Mu(n){for(var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=2*Math.PI/n,u=[],h=0;h<n;h++)u.push(i*h+l*Math.PI/12);var v=u.map(function(w){return[Math.sin(w+Math.PI/4),Math.cos(w+Math.PI/4),0]});return v}function Ch(){return Mu(30)}function Al(){return Mu(4)}function Jl(){return Mu(3)}function Ah(){return Mu(6,1)}function $f(){return Mu(5)}var yf=((0,j.Z)(lu={},Nc.CIRCLE,Ch),(0,j.Z)(lu,Nc.HEXAGON,Ah),(0,j.Z)(lu,Nc.TRIANGLE,Jl),(0,j.Z)(lu,Nc.SQUARE,Al),(0,j.Z)(lu,Nc.PENTAGON,$f),(0,j.Z)(lu,Ps.CYLINDER,Ch),(0,j.Z)(lu,Ps.HEXAGONCOLUMN,Ah),(0,j.Z)(lu,Ps.TRIANGLECOLUMN,Jl),(0,j.Z)(lu,Ps.SQUARECOLUMN,Al),(0,j.Z)(lu,Ps.PENTAGONCOLUMN,$f),lu),Lf={};function as(n){var l=tf(n.coordinates);return{vertices:[].concat((0,Ta.Z)(l),(0,Ta.Z)(l),(0,Ta.Z)(l),(0,Ta.Z)(l)),indices:[0,1,2,2,3,0],size:l.length}}function Zo(n){var i=Qc(tf(n.coordinates));return{vertices:[].concat((0,Ta.Z)(i),(0,Ta.Z)(i),(0,Ta.Z)(i),(0,Ta.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function os(n){var i=function(n){var l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Lf&&Lf[n])return Lf[n];var u=Th([yf[n]?yf[n]():yf.cylinder()],l);return Lf[n]=u,u}(n.shape,!1);return{vertices:i.positions,indices:i.index,normals:i.normals,size:5}}function cu(n){var l=tf(n.coordinates);return{vertices:(0,Ta.Z)(l),indices:[0],size:l.length}}function Ph(n){var l=n.coordinates,i=n.originCoordinates,u=n.version,h=new rp({dash:!0,join:"bevel"});if("GAODE2.x"===u){var v=l;Array.isArray(v[0][0])||(v=[l]);var w=i;Array.isArray(w[0][0])||(w=[i]);for(var I=0;I<v.length;I++)h.extrude_gaode2(v[I],w[I])}else{var le=l;Array.isArray(le[0][0])||(le=[l]),le.forEach(function(Fe){h.extrude(Fe)})}var se=h.complex;return{vertices:se.positions,indices:se.indices,normals:se.normals,size:6}}function Ap(n){var l=n.coordinates,i=Cl().flatten(l),u=i.vertices,h=i.dimensions,v=i.holes;return{indices:Cl()(u,v,h),vertices:u,size:h}}function np(n){var i=Th(n.coordinates,!0);return{vertices:i.positions,indices:i.index,normals:i.normals,size:5}}var q=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),l.apply(this,arguments)}return(0,B.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,w=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var I=this.layer.getEncodedData(),k=this.calDataFrame(this.cellLength,I,this.cellProperties),X=k.data,le=k.width,se=k.height;this.rowCount=se,this.dataTexture=this.createTexture2D(this.cellLength>0&&X.length>0?{flipY:!0,data:X,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:le,height:se}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:'precision highp float;\n\n#define pi 3.1415926535\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec3 a_Position;\nattribute vec3 a_Pos;\nattribute vec4 a_Color;\nattribute vec3 a_Size;\nattribute vec3 a_Normal;\n\nuniform float u_globel;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if(x > 0.0 && z > 0.0) {\n    return atan(x/z);\n  } else if(x > 0.0 && z <= 0.0){\n    return atan(-z/x) + pi/2.0;\n  } else if(x <= 0.0 && z <= 0.0) {\n    return  pi + atan(x/z); //atan(x/z) + \n  } else {\n    return atan(z/-x) + pi*3.0/2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y/r);\n}\n\nvoid main() {\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  vec3 size = a_Size * a_Position;\n\n  vec2 offset = project_pixel(size.xy);\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n\n  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);\n\n  float lightWeight = calc_lighting(pos);\n  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  // gl_Position = project_common_position_to_clipspace(pos);\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * pos;\n  } else {\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  \n  if(u_globel > 0.0) {\n    // \u5728\u5730\u7403\u6a21\u5f0f\u4e0b\uff0c\u5c06\u539f\u672c\u5782\u76f4\u4e8e xy \u5e73\u9762\u7684\u5706\u67f1\u8c03\u6574\u59ff\u6001\u5230\u9002\u5e94\u5706\u7684\u89d2\u5ea6\n    //\u65cb\u8f6c\u77e9\u9635mx\uff0c\u521b\u5efa\u7ed5x\u8f74\u65cb\u8f6c\u77e9\u9635\n    float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);\n    float xRadian = getXRadian(a_Pos.y, r);\n    float xcos = cos(xRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u4f59\u5f26\u503c\n    float xsin = sin(xRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u6b63\u5f26\u503c\n    mat4 mx = mat4(\n      1,0,0,0,  \n      0,xcos,-xsin,0,  \n      0,xsin,xcos,0,  \n      0,0,0,1);\n\n    //\u65cb\u8f6c\u77e9\u9635my\uff0c\u521b\u5efa\u7ed5y\u8f74\u65cb\u8f6c\u77e9\u9635\n    float yRadian = getYRadian(a_Pos.x, a_Pos.z);\n    float ycos = cos(yRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u4f59\u5f26\u503c\n    float ysin = sin(yRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u6b63\u5f26\u503c\n    mat4 my = mat4(\n      ycos,0,-ysin,0,  \n      0,1,0,0,  \n      ysin,0,ycos,0,  \n      0,0,0,1);\n\n    gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'varying vec4 v_color;\nuniform float u_opacity: 1.0;\n\n#pragma include "picking"\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:os,blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h="GLOBEL"===this.mapService.version;this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(w,I,k,X){var le=w.size;if(le){var se=[];return Array.isArray(le)&&(se=2===le.length?[le[0],le[0],le[1]]:le),Array.isArray(le)||(se=[le,le,le]),se}return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:W.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(w,I,k,X,le){return le}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:W.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(w,I){var k=tf(w.coordinates);return h?Qc([k[0],k[1]]):[k[0],k[1],0]}}})}}]),i}(Iu);var sr=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),l.apply(this,arguments)}return(0,B.Z)(i,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=void 0===v?1:v,I=h.strokeOpacity,k=void 0===I?1:I,X=h.strokeWidth,le=void 0===X?0:X,se=h.stroke,Fe=void 0===se?"rgba(0,0,0,0)":se,rt=h.offsets,Bt=void 0===rt?[0,0]:rt;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w,strokeOpacity:k,strokeWidth:le,stroke:Fe,offsets:Bt})){this.judgeStyleAttributes({opacity:w,strokeOpacity:k,strokeWidth:le,stroke:Fe,offsets:Bt});var Wt=this.layer.getEncodedData(),Ar=this.calDataFrame(this.cellLength,Wt,this.cellProperties),jr=Ar.data,sn=Ar.width,yn=Ar.height;this.rowCount=yn,this.dataTexture=this.createTexture2D(this.cellLength>0&&jr.length>0?{flipY:!0,data:jr,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:sn,height:yn}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1,u_stroke_opacity:ca()(k)?k:1,u_stroke_width:ca()(le)?le:0,u_stroke_color:this.getStrokeColor(Fe),u_offsets:this.isOffsetStatic(Bt)?Bt:[0,0]}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig();return{u_aimate:this.animateOption2Array(h.animateOption),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),as)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var h="GLOBEL"===this.mapService.version;return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Extrude;\nattribute float a_Size;\nattribute float a_Shape;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\nuniform float u_globel;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\nuniform float u_opacity : 1;\nuniform float u_stroke_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\nuniform vec2 u_offsets;\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  float newSize = setPickingSize(a_Size);\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = strokeOpacityAndOffset.r;\n  textureOffset = strokeOpacityAndOffset.g;\n\n  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n\n  // unpack color(vec2)\n  v_color = a_Color;\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  // TODO: billboard\n  // anti-alias\n  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);\n\n  // construct point coords\n  // TODP: /abs(extrude.x) \u662f\u4e3a\u4e86\u517c\u5bb9\u5730\u7403\u6a21\u5f0f\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n  // vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);\n  vec2 offset = project_pixel(extrude.xy * (newSize + u_stroke_width) + textrueOffsets);\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n  }\n\n  if(u_globel > 0.0) {\n    gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);\n  }\n \n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:"#define Animate 0.0\n\nuniform float u_globel;\nuniform float u_blur : 0;\n// uniform float u_stroke_width : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n \n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  float opacity = styleMappingMat[0][0];\n  float stroke_opacity = styleMappingMat[0][1];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;\n\n  lowp float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  // float r = v_radius / (v_radius + u_stroke_width);\n  float r = v_radius / (v_radius + strokeWidth);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  if(u_globel > 0.0) {\n    // TODO: \u5730\u7403\u6a21\u5f0f\u4e0b\u907f\u514d\u591a\u4f59\u7247\u5143\u7ed8\u5236\uff0c\u540c\u65f6\u4e5f\u80fd\u907f\u514d\u6709\u7528\u7247\u5143\u5728\u900f\u660e\u4e14\u91cd\u53e0\u7684\u60c5\u51b5\u4e0b\u65e0\u6cd5\u5199\u5165\n    // \u4ed8\u51fa\u7684\u4ee3\u4ef7\u662f\u8fb9\u7f18\u4f1a\u6709\u4e00\u4e9b\u952f\u9f7f\n    if(outer_df > antialiased_blur + 0.018) discard;\n  }\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n  \n \n  // float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n  //   antialiased_blur,\n  //   0.0,\n  //   inner_df\n  // );\n   float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);\n\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n  if(u_aimate.x == Animate) {\n    float d = length(v_data.xy);\n    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);\n    gl_FragColor = vec4(gl_FragColor.xyz, intensity);\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n\n  \n\n}\n",triangulation:h?Zo:as,depth:{enable:h},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"animateOption2Array",value:function(h){return[h.enable?0:1,h.speed||1,h.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var h=this,v="GLOBEL"===this.mapService.version;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:W.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(I,k,X,le){var se;if(v){var Fe=(0,ra.Z)(X,3),rt=Fe[0],Bt=Fe[1],Wt=Fe[2],Ar=On(0,0,1),jr=On(rt,0,Wt),sn=rt>=0?oi(Ar,jr):2*Math.PI-oi(Ar,jr),yn=2*Math.PI-Math.asin(Bt/100),Mn=Xt.create();Xt.rotateY(Mn,Mn,sn),Xt.rotateX(Mn,Mn,yn);var Wn=On(1,1,0);an(Wn,Wn,Mn),Kt(Wn,Wn);var ei=On(-1,1,0);an(ei,ei,Mn),Kt(ei,ei);var ti=On(-1,-1,0);an(ti,ti,Mn),Kt(ti,ti);var Ui=On(1,-1,0);an(Ui,Ui,Mn),Kt(Ui,Ui),se=[].concat((0,Ta.Z)(Wn),(0,Ta.Z)(ei),(0,Ta.Z)(ti),(0,Ta.Z)(Ui))}else se=[1,1,0,-1,1,0,-1,-1,0,1,-1,0];var wa=le%4*3;return[se[wa],se[wa+1],se[wa+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(I,k,X,le){var se=I.size,Fe=void 0===se?5:se;return Array.isArray(Fe)?[Fe[0]]:[Fe]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:W.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(I,k,X,le){var se=I.shape,Fe=void 0===se?2:se;return[h.layer.getLayerConfig().shape2d.indexOf(Fe)]}}})}}]),i}(Iu);var qr=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=l.call.apply(l,[this].concat(v)),(0,j.Z)((0,H.Z)(u),"texture",void 0),u}return(0,B.Z)(i,[{key:"getUninforms",value:function(){return{u_opacity:this.layer.getLayerConfig().opacity||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var h=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){h.updateTexture(),h.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_stroke_width : 1;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  //  vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n\n  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);\n    } else {\n      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n    }\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor=texture2D(u_texture,pos);\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n      // gl_FragColor.a =gl_FragColor.a * u_opacity;\n      gl_FragColor.a =gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:cu,primitive:W.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(w,I,k,X){var le=w.size;return Array.isArray(le)?[le[0]]:[le]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:W.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(w,I,k,X){var rt=h.fontService.mapping[h.fontService.getGlyph(w.shape)];return[rt.x,rt.y]}}})}},{key:"updateTexture",value:function(){var v=this.fontService.canvas;this.texture=(0,this.rendererService.createTexture2D)({data:v,mag:W.gl.LINEAR,min:W.gl.LINEAR,width:v.width,height:v.height})}},{key:"initIconFontGlyphs",value:function(){var h=this,v=this.layer.getLayerConfig(),w=v.fontWeight,I=void 0===w?"normal":w,k=v.fontFamily,X=void 0===k?"sans-serif":k,le=this.layer.getEncodedData(),se=[];le.forEach(function(Fe){var rt=Fe.shape,Bt=void 0===rt?"":rt;Bt=Bt.toString();var Wt=h.fontService.getGlyph(Bt);-1===se.indexOf(Wt)&&se.push(Wt)}),this.fontService.setFontOptions({characterSet:se,fontWeight:I,fontFamily:X,fontSize:48})}}]),i}(Iu);var Zt=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=l.call.apply(l,[this].concat(v)),(0,j.Z)((0,H.Z)(u),"texture",void 0),(0,j.Z)((0,H.Z)(u),"updateTexture",function(){var I=u.rendererService.createTexture2D;if(u.texture)return u.texture.update({data:u.iconService.getCanvas()}),void u.layer.renderLayers();u.texture=I({data:u.iconService.getCanvas(),mag:W.gl.LINEAR,min:W.gl.LINEAR,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})}),u}return(0,B.Z)(i,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=h.offsets,I=void 0===w?[0,0]:w;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:I})){this.judgeStyleAttributes({opacity:v,offsets:I});var k=this.layer.getEncodedData(),X=this.calDataFrame(this.cellLength,k,this.cellProperties),le=X.data,se=X.width,Fe=X.height;this.rowCount=Fe,this.dataTexture=this.createTexture2D(this.cellLength>0&&le.length>0?{flipY:!0,data:le,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:se,height:Fe}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:ca()(v)?v:1,u_offsets:this.isOffsetStatic(I)?I:[0,0]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,v;null===(h=this.texture)||void 0===h||h.destroy(),null===(v=this.dataTexture)||void 0===v||v.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_stroke_width : 1;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  //  vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n\n  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);\n    } else {\n      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n    }\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor=texture2D(u_texture,pos);\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n      // gl_FragColor.a =gl_FragColor.a * u_opacity;\n      gl_FragColor.a =gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:cu,primitive:W.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(w,I,k,X){var le=w.size,se=void 0===le?5:le;return Array.isArray(se)?[se[0]]:[se]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:W.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(w,I,k,X){var Fe=h.iconService.getIconMap()[w.shape]||{x:0,y:0};return[Fe.x,Fe.y]}}})}}]),i}(Iu);function wn(n){var l=n.coordinates;return{vertices:(0,Ta.Z)(l),indices:[0],size:l.length}}var rn=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),l.apply(this,arguments)}return(0,B.Z)(i,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=void 0===v?1:v,I=h.offsets,k=void 0===I?[0,0]:I;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w,offsets:k})){this.judgeStyleAttributes({opacity:w,offsets:k});var X=this.layer.getEncodedData(),le=this.calDataFrame(this.cellLength,X,this.cellProperties),se=le.data,Fe=le.width,rt=le.height;this.rowCount=rt,this.dataTexture=this.createTexture2D(this.cellLength>0&&se.length>0?{flipY:!0,data:se,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:Fe,height:rt}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1,u_offsets:this.isOffsetStatic(k)?k:[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:'\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute float a_Size;\nattribute vec4 a_Color;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "project"\nvoid main() {\n  v_color = a_Color;\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n  \n  // vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\\n  // \n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // vec2 offset = project_pixel((u_offsets));\n    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);\n  } else { // else\n    // vec2 offset = project_pixel(u_offsets);\n    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\n  }\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\nvarying vec4 v_color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n\n  gl_FragColor = v_color;\n  // gl_FragColor.a =gl_FragColor.a * u_opacity;\n  gl_FragColor.a =gl_FragColor.a * opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:wn,depth:{enable:!1},primitive:W.gl.POINTS,blend:this.getBlend()})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(v,w,I,k){var X=v.size,le=void 0===X?1:X;return Array.isArray(le)?[le[0]]:[le]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:W.BlendType.additive}}}]),i}(Iu);function wr(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}const vn=function(){function n(l,i,u){(0,R.Z)(this,n),(0,j.Z)(this,"boxCells",[]),(0,j.Z)(this,"xCellCount",void 0),(0,j.Z)(this,"yCellCount",void 0),(0,j.Z)(this,"boxKeys",void 0),(0,j.Z)(this,"bboxes",void 0),(0,j.Z)(this,"width",void 0),(0,j.Z)(this,"height",void 0),(0,j.Z)(this,"xScale",void 0),(0,j.Z)(this,"yScale",void 0),(0,j.Z)(this,"boxUid",void 0);var h=this.boxCells;this.xCellCount=Math.ceil(l/u),this.yCellCount=Math.ceil(i/u);for(var v=0;v<this.xCellCount*this.yCellCount;v++)h.push([]);this.boxKeys=[],this.bboxes=[],this.width=l,this.height=i,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/i,this.boxUid=0}return(0,B.Z)(n,[{key:"insert",value:function(i,u,h,v,w){this.forEachCell(u,h,v,w,this.insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(h),this.bboxes.push(v),this.bboxes.push(w)}},{key:"query",value:function(i,u,h,v,w){return this.queryHitTest(i,u,h,v,!1,w)}},{key:"hitTest",value:function(i,u,h,v,w){return this.queryHitTest(i,u,h,v,!0,w)}},{key:"insertBoxCell",value:function(i,u,h,v,w,I){this.boxCells[w].push(I)}},{key:"queryHitTest",value:function(i,u,h,v,w,I){if(h<0||i>this.width||v<0||u>this.height)return!w&&[];var k=[];if(i<=0&&u<=0&&this.width<=h&&this.height<=v){if(w)return!0;for(var X=0;X<this.boxKeys.length;X++)k.push({key:this.boxKeys[X],x1:this.bboxes[4*X],y1:this.bboxes[4*X+1],x2:this.bboxes[4*X+2],y2:this.bboxes[4*X+3]});return I?k.filter(I):k}return this.forEachCell(i,u,h,v,this.queryCell,k,{hitTest:w,seenUids:{box:{},circle:{}}},I),w?k.length>0:k}},{key:"queryCell",value:function(i,u,h,v,w,I,k,X){var le=k.seenUids,se=this.boxCells[w];if(null!==se){var Bt,Fe=this.bboxes,rt=function(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return wr(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return wr(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}(se);try{for(rt.s();!(Bt=rt.n()).done;){var Wt=Bt.value;if(!le.box[Wt]){le.box[Wt]=!0;var Ar=4*Wt;if(i<=Fe[Ar+2]&&u<=Fe[Ar+3]&&h>=Fe[Ar+0]&&v>=Fe[Ar+1]&&(!X||X(this.boxKeys[Wt]))){if(k.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[Wt],x1:Fe[Ar],y1:Fe[Ar+1],x2:Fe[Ar+2],y2:Fe[Ar+3]})}}}}catch(jr){rt.e(jr)}finally{rt.f()}}return!1}},{key:"forEachCell",value:function(i,u,h,v,w,I,k,X){for(var le=this.convertToXCellCoord(i),se=this.convertToYCellCoord(u),Fe=this.convertToXCellCoord(h),rt=this.convertToYCellCoord(v),Bt=le;Bt<=Fe;Bt++)for(var Wt=se;Wt<=rt;Wt++)if(w.call(this,i,u,h,v,this.xCellCount*Wt+Bt,I,k,X))return}},{key:"convertToXCellCoord",value:function(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}},{key:"convertToYCellCoord",value:function(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}}]),n}();var Jr=function(){function n(l,i){(0,R.Z)(this,n),(0,j.Z)(this,"width",void 0),(0,j.Z)(this,"height",void 0),(0,j.Z)(this,"grid",void 0),(0,j.Z)(this,"viewportPadding",100),(0,j.Z)(this,"screenRightBoundary",void 0),(0,j.Z)(this,"screenBottomBoundary",void 0),(0,j.Z)(this,"gridRightBoundary",void 0),(0,j.Z)(this,"gridBottomBoundary",void 0),this.width=l,this.height=i,this.viewportPadding=Math.max(l,i),this.grid=new vn(l+this.viewportPadding,i+this.viewportPadding,25),this.screenRightBoundary=l+this.viewportPadding,this.screenBottomBoundary=i+this.viewportPadding,this.gridRightBoundary=l+2*this.viewportPadding,this.gridBottomBoundary=i+2*this.viewportPadding}return(0,B.Z)(n,[{key:"placeCollisionBox",value:function(i){var u=i.x1+i.anchorPointX+this.viewportPadding,h=i.y1+i.anchorPointY+this.viewportPadding,v=i.x2+i.anchorPointX+this.viewportPadding,w=i.y2+i.anchorPointY+this.viewportPadding;return!this.isInsideGrid(u,h,v,w)||this.grid.hitTest(u,h,v,w)?{box:[]}:{box:[u,h,v,w]}}},{key:"insertCollisionBox",value:function(i,u){this.grid.insert({featureIndex:u},i[0],i[1],i[2],i[3])}},{key:"project",value:function(i,u,h){var v=bo.al(u,h,0,1),w=bo.Ue(),I=Xt.fromValues.apply(Xt,(0,Ta.Z)(i));return bo.fF(w,v,I),{x:(w[0]/w[3]+1)/2*this.width+this.viewportPadding,y:(-w[1]/w[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(i,u,h,v){return h>=0&&i<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}}]),n}();function xn(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return zi(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return zi(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}function zi(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}function Ii(n){var l=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0;break;default:l=.5}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0;break;default:i=.5}return{horizontalAlign:l,verticalAlign:i}}function Cn(n,l,i,u,h){if(h){var v=n[u],w=v.glyph;if(w)for(var k=(n[u].x+l[w].advance*v.scale)*h,X=i;X<=u;X++)n[X].x-=k}}function Tn(n,l,i,u,h,v,w){var le,I=(l-i)*h,k=(-u*w+.5)*v,X=xn(n);try{for(X.s();!(le=X.n()).done;){var se=le.value;se.x+=I,se.y+=k}}catch(Fe){X.e(Fe)}finally{X.f()}}function _i(n,l,i,u,h,v,w){var k=0,X=-8,le=0,se=n.positionedGlyphs,Fe="right"===v?1:"left"===v?0:.5,rt=se.length;i.forEach(function(sn){sn.split("").forEach(function(Mn){var Wn=l[Mn];Wn&&(se.push({glyph:Mn,x:k,y:X+0,vertical:!1,scale:1,metrics:Wn}),k+=Wn.advance+w)}),se.length!==rt&&(le=Math.max(k-w,le),Cn(se,l,rt,se.length-1,Fe)),k=0,X+=u});var Bt=Ii(h),Wt=Bt.horizontalAlign,Ar=Bt.verticalAlign;Tn(se,Fe,Wt,Ar,le,u,i.length);var jr=X- -8;n.top+=-Ar*jr,n.bottom=n.top+jr,n.left+=-Wt*le,n.right=n.left+le}function Zi(n,l,i,u,h,v,w){var k=0,X=-8,le=0,se=n.positionedGlyphs,Fe="right"===v?1:"left"===v?0:.5,rt=se.length;i.forEach(function(sn){var yn=l[sn];yn&&(se.push({glyph:sn,x:k,y:X+0,vertical:!1,scale:1,metrics:yn}),k+=yn.advance+w),se.length!==rt&&(le=Math.max(k-w,le),Cn(se,l,rt,se.length-1,Fe)),k=0,X+=u});var Bt=Ii(h),Wt=Bt.horizontalAlign,Ar=Bt.verticalAlign;Tn(se,Fe,Wt,Ar,le,u,i.length);var jr=X- -8;n.top+=-Ar*jr,n.bottom=n.top+jr,n.left+=-Wt*le,n.right=n.left+le}function ds(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}var Uo='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\nuniform sampler2D u_sdf_map;\nuniform float u_gamma_scale : 0.5;\n// uniform float u_font_size : 24.0;\nuniform float u_opacity : 1.0;\nuniform vec4 u_stroke_color : [0, 0, 0, 1];\nuniform float u_stroke_width : 2.0;\nuniform float u_halo_blur : 0.5;\nuniform float u_DevicePixelRatio;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main() {\n  // get style data mapping\n  float opacity = styleMappingMat[0][0];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  // get sdf from atlas\n  float dist = texture2D(u_sdf_map, v_uv).a;\n\n  // float fontScale = u_font_size / FONT_SIZE;\n\n  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;\n  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor.a= gl_FragColor.a * alpha;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',ss='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\nattribute vec3 a_Position;\nattribute vec2 a_tex;\nattribute vec2 a_textOffsets;\nattribute vec4 a_Color;\nattribute float a_Size;\nattribute float a_Rotate;\n\nuniform vec2 u_sdf_map_size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying vec4 v_color;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\nuniform float u_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n  \n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  v_color = a_Color;\n  v_uv = a_tex / u_sdf_map_size;\n\n  // \u6587\u672c\u7f29\u653e\u6bd4\u4f8b\n  float fontScale = a_Size / FONT_SIZE;\n  v_fontScale = fontScale;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  highp float angle_sin = sin(a_Rotate);\n  highp float angle_cos = cos(a_Rotate);\n  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n  \n  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n\n  vec4 projected_position;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));\n  } else { // else\n   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n';function ms(n){var l=this,i=n.id,u=[],h=[];if(!l.glyphInfoMap||!l.glyphInfoMap[i])return{vertices:[],indices:[],size:7};var v=l.glyphInfoMap[i].centroid,w=2===v.length?[v[0],v[1],0]:v;return l.glyphInfoMap[i].glyphQuads.forEach(function(I,k){u.push.apply(u,(0,Ta.Z)(w).concat([I.tex.x,I.tex.y+I.tex.height,I.tl.x,I.tl.y],(0,Ta.Z)(w),[I.tex.x+I.tex.width,I.tex.y+I.tex.height,I.tr.x,I.tr.y],(0,Ta.Z)(w),[I.tex.x+I.tex.width,I.tex.y,I.br.x,I.br.y],(0,Ta.Z)(w),[I.tex.x,I.tex.y,I.bl.x,I.bl.y])),h.push(0+4*k,1+4*k,2+4*k,2+4*k,3+4*k,0+4*k)}),{vertices:u,indices:h,size:7}}var us=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=l.call.apply(l,[this].concat(v)),(0,j.Z)((0,H.Z)(u),"glyphInfo",void 0),(0,j.Z)((0,H.Z)(u),"glyphInfoMap",{}),(0,j.Z)((0,H.Z)(u),"texture",void 0),(0,j.Z)((0,H.Z)(u),"currentZoom",-1),(0,j.Z)((0,H.Z)(u),"extent",void 0),(0,j.Z)((0,H.Z)(u),"textureHeight",0),(0,j.Z)((0,H.Z)(u),"textCount",0),(0,j.Z)((0,H.Z)(u),"preTextStyle",{}),(0,j.Z)((0,H.Z)(u),"buildModels",function(){return u.initGlyph(),u.updateTexture(),u.filterGlyphs(),u.reBuildModel(),[u.layer.buildLayerModel({moduleName:"pointText",vertexShader:ss,fragmentShader:Uo,triangulation:ms.bind((0,H.Z)(u)),depth:{enable:!1},blend:u.getBlend()})]}),u}return(0,B.Z)(i,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=void 0===v?1:v,I=h.stroke,k=void 0===I?"#fff":I,X=h.strokeWidth,le=void 0===X?0:X,se=h.textAnchor,Fe=void 0===se?"center":se,rt=h.textAllowOverlap,Bt=void 0!==rt&&rt,Wt=h.halo,Ar=void 0===Wt?.5:Wt,jr=h.gamma,sn=void 0===jr?2:jr,yn=this.fontService,Mn=yn.canvas,Wn=yn.mapping;if(Object.keys(Wn).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Wn).length),this.preTextStyle={textAnchor:Fe,textAllowOverlap:Bt},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w,strokeWidth:le,stroke:k})){this.judgeStyleAttributes({opacity:w,strokeWidth:le,stroke:k});var ei=this.layer.getEncodedData(),ti=this.calDataFrame(this.cellLength,ei,this.cellProperties),Ui=ti.data,wa=ti.width,Ua=ti.height;this.rowCount=Ua,this.dataTexture=this.createTexture2D(this.cellLength>0&&Ui.length>0?{flipY:!0,data:Ui,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:wa,height:Ua}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1,u_stroke_width:ca()(le)?le:0,u_stroke_color:this.getStrokeColor(k),u_sdf_map:this.texture,u_halo_blur:Ar,u_gamma_scale:sn,u_sdf_map_size:[Mn.width,Mn.height]}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var h=this.layer.getLayerConfig(),v=h.textAnchor,I=h.textAllowOverlap;return this.preTextStyle={textAnchor:void 0===v?"center":v,textAllowOverlap:void 0===I||I},this.buildModels()}},{key:"needUpdate",value:function(){var v=this.layer.getLayerConfig().textAllowOverlap,w=void 0!==v&&v,I=this.mapService.getZoom(),k=this.mapService.getBounds(),X=(0,Ke.oO)(this.extent,k);return(!w&&(Math.abs(this.currentZoom-I)>1||!X)||w!==this.preTextStyle.textAllowOverlap)&&(this.reBuildModel(),!0)}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy(),this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:W.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(v,w,I,k){var X=v.rotate,le=void 0===X?0:X;return Array.isArray(le)?[le[0]]:[le]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:W.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(v,w,I,k){return[I[5],I[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(v,w,I,k){var X=v.size,le=void 0===X?12:X;return Array.isArray(le)?[le[0]]:[le]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:W.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(v,w,I,k){return[I[3],I[4]]}}})}},{key:"textExtent",value:function(){var h=this.mapService.getBounds();return(0,Ke.yA)(h,.5)}},{key:"initTextFont",value:function(){var h=this.layer.getLayerConfig(),v=h.fontWeight,w=void 0===v?"400":v,I=h.fontFamily,k=void 0===I?"sans-serif":I,X=this.layer.getEncodedData(),le=[];X.forEach(function(se){var Wt,Fe=se.shape,rt=void 0===Fe?"":Fe,Bt=function(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return ds(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ds(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,h=function(){};return{s:h,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(X){throw X},f:h}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var I,v=!0,w=!1;return{s:function(){i=i.call(n)},n:function(){var X=i.next();return v=X.done,X},e:function(X){w=!0,I=X},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(w)throw I}}}}(rt=rt.toString());try{for(Bt.s();!(Wt=Bt.n()).done;){var Ar=Wt.value;-1===le.indexOf(Ar)&&le.push(Ar)}}catch(jr){Bt.e(jr)}finally{Bt.f()}}),this.fontService.setFontOptions({characterSet:le,fontWeight:w,fontFamily:k,iconfont:!1})}},{key:"initIconFontTex",value:function(){var h=this.layer.getLayerConfig(),v=h.fontWeight,w=void 0===v?"400":v,I=h.fontFamily,k=void 0===I?"sans-serif":I,X=this.layer.getEncodedData(),le=[];X.forEach(function(se){var Fe=se.shape,rt=void 0===Fe?"":Fe;rt=rt.toString(),-1===le.indexOf(rt)&&le.push(rt)}),this.fontService.setFontOptions({characterSet:le,fontWeight:w,fontFamily:k,iconfont:!0})}},{key:"generateGlyphLayout",value:function(h){var v=this,w=this.fontService.mapping,I=this.layer.getLayerConfig(),k=I.spacing,X=void 0===k?2:k,le=I.textAnchor,se=void 0===le?"center":le,Fe=this.layer.getEncodedData();this.glyphInfo=Fe.map(function(rt){var Bt=rt.shape,Ar=rt.id,jr=rt.size,sn=void 0===jr?1:jr,yn=rt.textOffset,Mn=void 0===yn?[0,0]:yn,Wn=function(n,l,i,u,h,v){var w=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0],I=arguments.length>7?arguments[7]:void 0,k=n.split("\n"),X=[],le={positionedGlyphs:X,top:w[1],bottom:w[1],left:w[0],right:w[0],lineCount:k.length,text:n};return I?Zi(le,l,k,i,u,h,v):_i(le,l,k,i,u,h,v),!!X.length&&le}((void 0===Bt?"":Bt).toString(),w,sn,se,"center",X,Mn,h),ei=function(n){var I,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],i=arguments.length>2?arguments[2]:void 0,u=n.positionedGlyphs,v=[],w=xn(void 0===u?[]:u);try{for(w.s();!(I=w.n()).done;){var k=I.value,X=k.metrics,le=4,se=X.advance*k.scale/2,rt=i?[0,0]:[k.x+se+l[0],k.y+l[1]],Bt=(0-le)*k.scale-se+rt[0],Wt=(0-le)*k.scale+rt[1],Ar=Bt+X.width*k.scale,jr=Wt+X.height*k.scale;v.push({tl:{x:Bt,y:Wt},tr:{x:Ar,y:Wt},bl:{x:Bt,y:jr},br:{x:Ar,y:jr},tex:X,glyphOffset:i?[k.x+se,k.y]:[0,0]})}}catch(ei){w.e(ei)}finally{w.f()}return v}(Wn,Mn,!1);return rt.shaping=Wn,rt.glyphQuads=ei,rt.centroid=tf(rt.coordinates),rt.originCentroid="GAODE2.x"===rt.version?tf(rt.originCoordinates):rt.originCentroid=rt.centroid,v.glyphInfoMap[Ar]={shaping:Wn,glyphQuads:ei,centroid:tf(rt.coordinates)},rt})}},{key:"filterGlyphs",value:function(){var h=this,v=this.layer.getLayerConfig(),w=v.padding,I=void 0===w?[4,4]:w,k=v.textAllowOverlap;if(void 0===k||!k){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var le=this.rendererService.getViewportSize(),rt=new Jr(le.width,le.height);this.glyphInfo.filter(function(Wt){var Ar=Wt.shaping,jr=Wt.id,sn=void 0===jr?0:jr,Wn=Wt.size/24,ei=h.mapService.lngLatToContainer("GAODE2.x"===Wt.version?Wt.originCentroid:Wt.centroid),Ui=rt.placeCollisionBox({x1:Ar.left*Wn-I[0],x2:Ar.right*Wn+I[0],y1:Ar.top*Wn-I[1],y2:Ar.bottom*Wn+I[1],anchorPointX:ei.x,anchorPointY:ei.y}).box;return!(!Ui||!Ui.length||(rt.insertCollisionBox(Ui,sn),0))}).forEach(function(Wt){h.glyphInfoMap[Wt.id]=Wt})}}},{key:"initGlyph",value:function(){var v=this.layer.getLayerConfig().iconfont,w=void 0!==v&&v;w?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(w)}},{key:"updateTexture",value:function(){var h=this.rendererService.createTexture2D,v=this.fontService.canvas;this.textureHeight=v.height,this.texture&&this.texture.destroy(),this.texture=h({data:v,mag:W.gl.LINEAR,min:W.gl.LINEAR,width:v.width,height:v.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:ss,fragmentShader:Uo,triangulation:ms.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),i}(Iu);const Hi={fill:sr,image:Zt,normal:rn,extrude:q,text:us,icon:qr};var uo=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=l.call.apply(l,[this].concat(v)),(0,j.Z)((0,H.Z)(u),"type","PointLayer"),u}return(0,B.Z)(i,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new Hi[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){return{normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}}[this.getModelType()]}},{key:"getModelType",value:function(){var h=this.getEncodedData(),v=this.getLayerConfig(),w=v.shape2d,I=v.shape3d,k=this.iconService.getIconMap(),X=h.find(function(se){return se.hasOwnProperty("shape")});if(X){var le=X.shape;return"dot"===le?"normal":-1!==(null==w?void 0:w.indexOf(le))?"fill":-1!==(null==I?void 0:I.indexOf(le))?"extrude":k.hasOwnProperty(le)?"image":""!==this.fontService.getGlyph(le)?"icon":"text"}return"normal"}}]),i}(Jc);var Pl={solid:0,dash:1},Qe=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=l.call.apply(l,[this].concat(v)),(0,j.Z)((0,H.Z)(u),"texture",void 0),(0,j.Z)((0,H.Z)(u),"updateTexture",function(){var I=u.rendererService.createTexture2D;if(u.texture)return u.texture.update({data:u.iconService.getCanvas()}),void u.layer.render();u.texture=I({data:u.iconService.getCanvas(),mag:W.gl.NEAREST,min:W.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})}),u}return(0,B.Z)(i,[{key:"getUninforms",value:function(){var h=this.layer.getLayerConfig(),v=h.opacity,w=h.sourceColor,I=h.targetColor,k=h.textureBlend,X=void 0===k?"normal":k,le=h.lineType,se=void 0===le?"solid":le,Fe=h.dashArray,rt=void 0===Fe?[10,5,0,0]:Fe,Bt=h.lineTexture,Wt=void 0!==Bt&&Bt,Ar=h.iconStep,jr=void 0===Ar?100:Ar;2===rt.length&&rt.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var sn=0,yn=[0,0,0,0],Mn=[0,0,0,0];if(w&&I&&(yn=(0,Ke.CI)(w),Mn=(0,Ke.CI)(I),sn=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Wn=this.layer.getEncodedData(),ei=this.calDataFrame(this.cellLength,Wn,this.cellProperties),ti=ei.data,Ui=ei.width,wa=ei.height;this.rowCount=wa,this.dataTexture=this.createTexture2D(this.cellLength>0&&ti.length>0?{flipY:!0,data:ti,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:Ui,height:wa}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(v)?v:1,u_textureBlend:"normal"===X?0:1,u_line_type:Pl[se],u_dash_array:rt,u_texture:this.texture,u_line_texture:Wt?1:0,u_icon_step:jr,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:sn,u_sourceColor:yn,u_targetColor:Mn}}},{key:"getAnimateUniforms",value:function(){var h=this.layer.getLayerConfig();return{u_aimate:this.animateOption2Array(h.animateOption),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var h,v;null===(h=this.texture)||void 0===h||h.destroy(),null===(v=this.dataTexture)||void 0===v||v.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\nattribute vec2 a_iconMapUV;\n\n// dash line\nattribute float a_Total_Distance;\nattribute float a_Distance;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nuniform float u_icon_step: 100;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\nvarying vec4 v_dash_array;\nvarying vec2 v_normal;\n\nvarying vec4 v_dataset; // \u6570\u636e\u96c6 - distance_ratio/distance/pixelLen/texV\n// texV \u7ebf\u56fe\u5c42 - \u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\uff08\u7ebf\u7684\u5bbd\u5ea6\u65b9\u5411\uff09\nvarying vec2 v_iconMapUV;\nuniform float u_linearColor: 0;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  float d_distance_ratio; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n  float d_texPixelLen;    // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n\n  v_iconMapUV = a_iconMapUV;\n  d_texPixelLen = project_pixel(u_icon_step);\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    d_texPixelLen *= 10.0;\n  }\n\n  if(u_line_type == LineTypeDash) {\n    d_distance_ratio = a_Distance / a_Total_Distance;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  }\n  if(u_aimate.x == Animate || u_linearColor == 1.0) {\n      d_distance_ratio = a_Distance / a_Total_Distance;\n  }\n  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));\n\n\n  v_color = a_Color;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n\n  vec2 offset = project_pixel(size.xy);\n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7ebf\u6a2a\u5411\u504f\u79fb\u7684\u8ddd\u79bb\uff08\u5411\u4e24\u4fa7\u504f\u79fb\u7684\u548c\uff09\n  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5b9a\u70b9\u4f4d\u7f6e\u504f\u79fb\uff0c\u6309\u5730\u56fe\u7b49\u7ea7\u7f29\u653e\u540e\u7684\u8ddd\u79bb \u5355\u4fa7 * 2\n  float texV = lineOffsetWidth/linePixelSize; // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n  // \u8bbe\u7f6e\u6570\u636e\u96c6\u7684\u53c2\u6570\n  v_dataset.r = d_distance_ratio; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n  v_dataset.g = a_Distance;       // \u5f53\u524d\u9876\u70b9\u7684\u8ddd\u79bb\n  v_dataset.b = d_texPixelLen;    // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n  v_dataset.a = texV;             // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y, 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y / 8.0, 1.0)); // \u989d\u5916\u9664 8.0 \u662f\u4e3a\u4e86\u548cgaode1.x\u7684\u9ad8\u5ea6\u517c\u5bb9\n  } else {\n    float lineHeight = a_Size.y;\n    // \u517c\u5bb9 mapbox \u5728\u7ebf\u9ad8\u5ea6\u4e0a\u7684\u6548\u679c\u8868\u73b0\u57fa\u672c\u4e00\u81f4\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      lineHeight = lineHeight*2.0/pow(2.0, 20.0 - u_Zoom);\n    }\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nuniform float u_blur : 0.99;\nuniform float u_line_type: 0.0;\nuniform float u_opacity : 1.0;\nuniform float u_textureBlend;\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\n// line texture\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\n// dash\nuniform float u_dash_offset : 0.0;\nuniform float u_dash_ratio : 0.1;\nvarying vec4 v_dash_array;\n\nvarying vec4 v_dataset; // \u6570\u636e\u96c6 - distance_ratio/distance/pixelLen/texV\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63a7\u5236\u8fd0\u52a8\n\nvarying mat4 styleMappingMat;\n// [animate, duration, interval, trailLength],\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // \u8fd0\u52a8\u901f\u5ea6\n  float d_distance_ratio = v_dataset.r; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n\n  if(u_linearColor == 1.0) { // \u4f7f\u7528\u6e10\u53d8\u989c\u8272\n    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);\n  } else { // \u4f7f\u7528 color \u65b9\u6cd5\u4f20\u5165\u7684\u989c\u8272\n     gl_FragColor = v_color;\n  }\n\n  // anti-alias\n  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));\n  gl_FragColor.a *= opacity; // \u5168\u5c40\u900f\u660e\u5ea6\n  if(u_aimate.x == Animate) {\n      animateSpeed = u_time / u_aimate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n // dash line\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    float aDistance = v_dataset.g;      // \u5f53\u524d\u9876\u70b9\u7684\u8ddd\u79bb\n    float d_texPixelLen = v_dataset.b;  // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = v_dataset.a;  // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n    v = max(smoothstep(0.95, 1.0, v), v);\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));\n     vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n  // gl_FragColor = filterColor(vec4(1.0, 0.0, 0.0, 1.0));\n \n  // if(rV < r || rV > 1.0 - r) {\n  //   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n  // } \n  // if(v > 0.9) {\n  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);\n  // } else if(v < 0.1) {\n  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);\n  // }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:Ph,primitive:W.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var h=this;this.layer.getLayerConfig(),this.styleAttributeService.registerStyleAttribute({name:"distance",type:W.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(X,le,se,Fe){return[se[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:W.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(X,le,se,Fe){return[se[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(X,le,se,Fe){var rt=X.size,Bt=void 0===rt?1:rt;return Array.isArray(Bt)?[Bt[0],Bt[1]]:[Bt,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:W.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(X,le,se,Fe,rt){return rt}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:W.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(X,le,se,Fe){return[se[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:W.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:2,update:function(X,le,se,Fe){var Wt=h.iconService.getIconMap()[X.texture]||{x:0,y:0};return[Wt.x,Wt.y]}}})}},{key:"loadImage",value:function(h){return new Promise(function(v,w){if(h instanceof HTMLImageElement)v(h);else{var I=new Image;I.crossOrigin="anonymous",I.onload=function(){v(I)},I.onerror=function(){w(new Error("Could not load image at "+h))},I.src=h instanceof File?URL.createObjectURL(h):h}})}}]),i}(Iu);var He=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),l.apply(this,arguments)}return(0,B.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,w=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var I=this.layer.getEncodedData(),k=this.calDataFrame(this.cellLength,I,this.cellProperties),X=k.data,le=k.width,se=k.height;this.rowCount=se,this.dataTexture=this.createTexture2D(this.cellLength>0&&X.length>0?{flipY:!0,data:X,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:le,height:se}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:'precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:np})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:W.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:W.gl.STATIC_DRAW,data:[],type:W.gl.FLOAT},size:3,update:function(v,w,I,k,X){return X}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:W.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(v,w,I,k){var X=v.size,le=void 0===X?10:X;return Array.isArray(le)?[le[0]]:[le]}}})}}]),i}(Iu);const ht={fill:function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){return(0,R.Z)(this,i),l.apply(this,arguments)}return(0,B.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,w=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:w})){this.judgeStyleAttributes({opacity:w});var I=this.layer.getEncodedData(),k=this.calDataFrame(this.cellLength,I,this.cellProperties),X=k.data,le=k.width,se=k.height;this.rowCount=se,this.dataTexture=this.createTexture2D(this.cellLength>0&&X.length>0?{flipY:!0,data:X,format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:le,height:se}:{flipY:!0,data:[1],format:W.gl.LUMINANCE,type:W.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(w)?w:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  v_Color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n\n',fragmentShader:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:Ap,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"clearModels",value:function(){var h;null===(h=this.dataTexture)||void 0===h||h.destroy()}},{key:"registerBuiltinAttributes",value:function(){}}]),i}(Iu),line:Qe,extrude:He,text:us,point_fill:sr,point_image:Zt,point_normal:rn,point_extrude:q};var jt,$t,Zr,un,ln,bn,on,Kn,kn,We=function(n){(0,G.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var h,u=(0,Be.Z)(n);if(l){var v=(0,Be.Z)(this).constructor;h=Reflect.construct(u,arguments,v)}else h=u.apply(this,arguments);return(0,be.Z)(this,h)}}(i);function i(){var u;(0,R.Z)(this,i);for(var h=arguments.length,v=new Array(h),w=0;w<h;w++)v[w]=arguments[w];return u=l.call.apply(l,[this].concat(v)),(0,j.Z)((0,H.Z)(u),"type","PolygonLayer"),u}return(0,B.Z)(i,[{key:"buildModels",value:function(){var h=this.getModelType();this.layerModel=new ht[h](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var h,v=this.styleAttributeService.getLayerStyleAttribute("shape"),w=null==v||null===(h=v.scale)||void 0===h?void 0:h.field;return"fill"===w?"fill":"extrude"===w?"extrude":"line"===w?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var h=this.getEncodedData(),v=this.getLayerConfig(),w=v.shape2d,I=v.shape3d,k=this.iconService.getIconMap(),X=h.find(function(se){return se.hasOwnProperty("shape")});if(X){var le=X.shape;return"dot"===le?"point_normal":-1!==(null==w?void 0:w.indexOf(le))?"point_fill":-1!==(null==I?void 0:I.indexOf(le))?"point_extrude":k.hasOwnProperty(le)?"point_image":"text"}return"fill"}}]),i}(Jc);function Vn(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}var qa,Hn=(jt=(0,va.b2)(),$t=(0,va.f3)(W.vK.IGlobalConfigService),Zr=(0,va.f3)(W.vK.IMapService),un=(0,va.f3)(W.vK.IFontService),jt((bn=function(){function n(){(0,R.Z)(this,n),(0,K.Z)(this,"configService",on,this),(0,K.Z)(this,"mapService",Kn,this),(0,K.Z)(this,"fontService",kn,this)}return(0,B.Z)(n,[{key:"apply",value:function(i,u){var h=this,v=u.styleAttributeService;i.hooks.init.tap("DataMappingPlugin",function(){h.generateMaping(i,{styleAttributeService:v})}),i.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return i.dataState.dataMappingNeedUpdate=!1,h.generateMaping(i,{styleAttributeService:v}),!0}),i.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!i.layerModelNeedUpdate){var w=v.getLayerStyleAttributes()||[],I=v.getLayerStyleAttribute("filter"),k=i.getSource().data.dataArray,X=w.filter(function(se){return se.needRemapping}),le=k;null!=I&&I.needRemapping&&null!=I&&I.scale&&(le=k.filter(function(se){return h.applyAttributeMapping(I,se)[0]})),X.length&&(null!=I&&I.needRemapping?(i.setEncodedData(h.mapping(w,le)),I.needRemapping=!1):i.setEncodedData(h.mapping(X,le,i.getEncodedData())),i.emit("remapping",null))}})}},{key:"generateMaping",value:function(i,u){var h=this,v=u.styleAttributeService,w=v.getLayerStyleAttributes()||[],I=v.getLayerStyleAttribute("filter"),k=i.getSource().data.dataArray,X=k;null!=I&&I.scale&&(X=k.filter(function(le){return h.applyAttributeMapping(I,le)[0]})),i.setEncodedData(this.mapping(w,X))}},{key:"mapping",value:function(i,u,h){var v=this,w=u.map(function(I,k){var le=function(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Vn(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Vn(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}({id:I._id,coordinates:I.coordinates},h?h[k]:{});return i.filter(function(se){return void 0!==se.scale}).forEach(function(se){var Fe=v.applyAttributeMapping(se,I);se.needRemapping=!1,"color"===se.name&&(Fe=Fe.map(function(rt){return(0,Ke.CI)(rt)})),le[se.name]=Array.isArray(Fe)&&1===Fe.length?Fe[0]:Fe,"shape"===se.name&&(le.shape=v.fontService.getIconFontKey(le[se.name]))}),le});return w.length>0&&"GAODE2.x"===this.mapService.version&&("number"==typeof w[0].coordinates[0]?w.filter(function(I){return!I.originCoordinates}).map(function(I){I.version="GAODE2.x",I.originCoordinates=Po()(I.coordinates),I.coordinates=v.mapService.lngLatToCoord(I.coordinates)}):w.filter(function(I){return!I.originCoordinates}).map(function(I){I.version="GAODE2.x",I.originCoordinates=Po()(I.coordinates),I.coordinates=v.mapService.lngLatToCoords(I.coordinates)})),w}},{key:"applyAttributeMapping",value:function(i,u){var h;if(!i.scale)return[];var v=(null==i||null===(h=i.scale)||void 0===h?void 0:h.scalers)||[],w=[];return v.forEach(function(I){var k,X=I.field;(u.hasOwnProperty(X)||"variable"===(null===(k=i.scale)||void 0===k?void 0:k.type))&&w.push(u[X])}),i.mapping?i.mapping(w):[]}}]),n}(),on=(0,Ve.Z)(bn.prototype,"configService",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kn=(0,Ve.Z)(bn.prototype,"mapService",[Zr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kn=(0,Ve.Z)(bn.prototype,"fontService",[un],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ln=bn))||ln),Vo=(0,va.b2)()(qa=function(){function n(){(0,R.Z)(this,n),(0,j.Z)(this,"mapService",void 0)}return(0,B.Z)(n,[{key:"apply",value:function(i){var u=this;this.mapService=i.getContainer().get(W.vK.IMapService),i.hooks.init.tap("DataSourcePlugin",function(){if(!i.getSource()){var v=i.sourceOption;i.setSource(new $e(v.data,v.options))}u.updateClusterData(i)}),i.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var h=u.updateClusterData(i),v=i.dataState.dataSourceNeedUpdate;return i.dataState.dataSourceNeedUpdate=!1,h||v})}},{key:"updateClusterData",value:function(i){var u=i.getSource(),h=u.cluster,v=u.clusterOptions,w=v.zoom,I=void 0===w?0:w,k=v.maxZoom,X=void 0===k?16:k,le=this.mapService.getZoom()-1;return!!(h&&(i.dataState.dataSourceNeedUpdate||Math.abs(I-le)>1)&&X>I)&&(u.updateClusterData(Math.floor(le)),!0)}}]),n}())||qa,$l=y(72699),ao=y.n($l),Fa=y(28303),zs=y.n(Fa);function Xu(n,l){return n<l?-1:n>l?1:n>=l?0:NaN}function Ou(n){return 1===n.length&&(n=function(n){return function(l,i){return Xu(n(l),i)}}(n)),{left:function(l,i,u,h){for(null==u&&(u=0),null==h&&(h=l.length);u<h;){var v=u+h>>>1;n(l[v],i)<0?u=v+1:h=v}return u},right:function(l,i,u,h){for(null==u&&(u=0),null==h&&(h=l.length);u<h;){var v=u+h>>>1;n(l[v],i)>0?h=v:u=v+1}return u}}}const Zc=Ou(Xu).right;var th=Math.sqrt(50),rh=Math.sqrt(10),Oh=Math.sqrt(2);function Rf(n,l,i){var u,v,w,I,h=-1;if(i=+i,(n=+n)==(l=+l)&&i>0)return[n];if((u=l<n)&&(v=n,n=l,l=v),0===(I=Ql(n,l,i))||!isFinite(I))return[];if(I>0)for(n=Math.ceil(n/I),l=Math.floor(l/I),w=new Array(v=Math.ceil(l-n+1));++h<v;)w[h]=(n+h)*I;else for(n=Math.floor(n*I),l=Math.ceil(l*I),w=new Array(v=Math.ceil(n-l+1));++h<v;)w[h]=(n-h)/I;return u&&w.reverse(),w}function Ql(n,l,i){var u=(l-n)/Math.max(0,i),h=Math.floor(Math.log(u)/Math.LN10),v=u/Math.pow(10,h);return h>=0?(v>=th?10:v>=rh?5:v>=Oh?2:1)*Math.pow(10,h):-Math.pow(10,-h)/(v>=th?10:v>=rh?5:v>=Oh?2:1)}function sp(n,l,i){var u=Math.abs(l-n)/Math.max(0,i),h=Math.pow(10,Math.floor(Math.log(u)/Math.LN10)),v=u/h;return v>=th?h*=10:v>=rh?h*=5:v>=Oh&&(h*=2),l<n?-h:h}function Is(n){return null===n?NaN:+n}function xf(n,l,i){if(null==i&&(i=Is),u=n.length){if((l=+l)<=0||u<2)return+i(n[0],0,n);if(l>=1)return+i(n[u-1],u-1,n);var u,h=(u-1)*l,v=Math.floor(h),w=+i(n[v],v,n);return w+(+i(n[v+1],v+1,n)-w)*(h-v)}}var Il="$";function e(){}function t(n,l){var i=new e;if(n instanceof e)n.each(function(I,k){i.set(k,I)});else if(Array.isArray(n)){var v,u=-1,h=n.length;if(null==l)for(;++u<h;)i.set(u,n[u]);else for(;++u<h;)i.set(l(v=n[u],u,n),v)}else if(n)for(var w in n)i.set(w,n[w]);return i}e.prototype=t.prototype={constructor:e,has:function(n){return Il+n in this},get:function(n){return this[Il+n]},set:function(n,l){return this[Il+n]=l,this},remove:function(n){var l=Il+n;return l in this&&delete this[l]},clear:function(){for(var n in this)n[0]===Il&&delete this[n]},keys:function(){var n=[];for(var l in this)l[0]===Il&&n.push(l.slice(1));return n},values:function(){var n=[];for(var l in this)l[0]===Il&&n.push(this[l]);return n},entries:function(){var n=[];for(var l in this)l[0]===Il&&n.push({key:l.slice(1),value:this[l]});return n},size:function(){var n=0;for(var l in this)l[0]===Il&&++n;return n},empty:function(){for(var n in this)if(n[0]===Il)return!1;return!0},each:function(n){for(var l in this)l[0]===Il&&n(this[l],l.slice(1),this)}};const r=t;function z(){}var J=r.prototype;z.prototype=function(n,l){var i=new z;if(n instanceof z)n.each(function(v){i.add(v)});else if(n){var u=-1,h=n.length;if(null==l)for(;++u<h;)i.add(n[u]);else for(;++u<h;)i.add(l(n[u],u,n))}return i}.prototype={constructor:z,has:J.has,add:function(n){return this[Il+(n+="")]=n,this},remove:J.remove,clear:J.clear,values:J.keys,size:J.size,empty:J.empty,each:J.each};var ye=Array.prototype,Se=ye.map,qe=ye.slice;function Je(n,l){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(l).domain(n)}return this}var st={name:"implicit"};function Nt(){var n=r(),l=[],i=[],u=st;function h(v){var w=v+"",I=n.get(w);if(!I){if(u!==st)return u;n.set(w,I=l.push(v))}return i[(I-1)%i.length]}return h.domain=function(v){if(!arguments.length)return l.slice();l=[],n=r();for(var k,X,w=-1,I=v.length;++w<I;)n.has(X=(k=v[w])+"")||n.set(X,l.push(k));return h},h.range=function(v){return arguments.length?(i=qe.call(v),h):i.slice()},h.unknown=function(v){return arguments.length?(u=v,h):u},h.copy=function(){return Nt(l,i).unknown(u)},Je.apply(h,arguments),h}function Rr(n,l,i,u,h){var v=n*n,w=v*n;return((1-3*n+3*v-w)*l+(4-6*v+3*w)*i+(1+3*n+3*v-3*w)*u+w*h)/6}function ii(n){return function(){return n}}function wi(n,l){var i=l-n;return i?function(n,l){return function(i){return n+i*l}}(n,i):ii(isNaN(n)?l:n)}const Qn=function n(l){var i=function(n){return 1==(n=+n)?wi:function(l,i){return i-l?function(n,l,i){return n=Math.pow(n,i),l=Math.pow(l,i)-n,i=1/i,function(u){return Math.pow(n+u*l,i)}}(l,i,n):ii(isNaN(l)?i:l)}}(l);function u(h,v){var w=i((h=(0,pc.B8)(h)).r,(v=(0,pc.B8)(v)).r),I=i(h.g,v.g),k=i(h.b,v.b),X=wi(h.opacity,v.opacity);return function(le){return h.r=w(le),h.g=I(le),h.b=k(le),h.opacity=X(le),h+""}}return u.gamma=n,u}(1);function da(n){return function(l){var w,I,i=l.length,u=new Array(i),h=new Array(i),v=new Array(i);for(w=0;w<i;++w)I=(0,pc.B8)(l[w]),u[w]=I.r||0,h[w]=I.g||0,v[w]=I.b||0;return u=n(u),h=n(h),v=n(v),I.opacity=1,function(k){return I.r=u(k),I.g=h(k),I.b=v(k),I+""}}}function Ra(n,l){var w,i=l?l.length:0,u=n?Math.min(i,n.length):0,h=new Array(u),v=new Array(i);for(w=0;w<u;++w)h[w]=Bo(n[w],l[w]);for(;w<i;++w)v[w]=l[w];return function(I){for(w=0;w<u;++w)v[w]=h[w](I);return v}}function Co(n,l){var i=new Date;return n=+n,l=+l,function(u){return i.setTime(n*(1-u)+l*u),i}}function Ao(n,l){return n=+n,l=+l,function(i){return n*(1-i)+l*i}}function Do(n,l){var h,i={},u={};for(h in(null===n||"object"!=typeof n)&&(n={}),(null===l||"object"!=typeof l)&&(l={}),l)h in n?i[h]=Bo(n[h],l[h]):u[h]=l[h];return function(v){for(h in i)u[h]=i[h](v);return u}}da(function(n){var l=n.length-1;return function(i){var u=i<=0?i=0:i>=1?(i=1,l-1):Math.floor(i*l),h=n[u],v=n[u+1];return Rr((i-u/l)*l,u>0?n[u-1]:2*h-v,h,v,u<l-1?n[u+2]:2*v-h)}}),da(function(n){var l=n.length;return function(i){var u=Math.floor(((i%=1)<0?++i:i)*l);return Rr((i-u/l)*l,n[(u+l-1)%l],n[u%l],n[(u+1)%l],n[(u+2)%l])}});var ho=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Oo=new RegExp(ho.source,"g");function fu(n,l){var u,h,v,i=ho.lastIndex=Oo.lastIndex=0,w=-1,I=[],k=[];for(n+="",l+="";(u=ho.exec(n))&&(h=Oo.exec(l));)(v=h.index)>i&&(v=l.slice(i,v),I[w]?I[w]+=v:I[++w]=v),(u=u[0])===(h=h[0])?I[w]?I[w]+=h:I[++w]=h:(I[++w]=null,k.push({i:w,x:Ao(u,h)})),i=Oo.lastIndex;return i<l.length&&(v=l.slice(i),I[w]?I[w]+=v:I[++w]=v),I.length<2?k[0]?function(n){return function(l){return n(l)+""}}(k[0].x):function(n){return function(){return n}}(l):(l=k.length,function(X){for(var se,le=0;le<l;++le)I[(se=k[le]).i]=se.x(X);return I.join("")})}function Ms(n,l){l||(l=[]);var h,i=n?Math.min(l.length,n.length):0,u=l.slice();return function(v){for(h=0;h<i;++h)u[h]=n[h]*(1-v)+l[h]*v;return u}}function Bo(n,l){var u,i=typeof l;return null==l||"boolean"===i?ii(l):("number"===i?Ao:"string"===i?(u=(0,pc.ZP)(l))?(l=u,Qn):fu:l instanceof pc.ZP?Qn:l instanceof Date?Co:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(l)?Ms:Array.isArray(l)?Ra:"function"!=typeof l.valueOf&&"function"!=typeof l.toString||isNaN(l)?Do:Ao)(n,l)}function Os(n,l){return n=+n,l=+l,function(i){return Math.round(n*(1-i)+l*i)}}function Ja(n){return+n}var Xa=[0,1];function qi(n){return n}function $s(n,l){return(l-=n=+n)?function(i){return(i-n)/l}:function(n){return function(){return n}}(isNaN(l)?NaN:.5)}function Zs(n){var u,l=n[0],i=n[n.length-1];return l>i&&(u=l,l=i,i=u),function(h){return Math.max(l,Math.min(i,h))}}function yo(n,l,i){var u=n[0],h=n[1],v=l[0],w=l[1];return h<u?(u=$s(h,u),v=i(w,v)):(u=$s(u,h),v=i(v,w)),function(I){return v(u(I))}}function fs(n,l,i){var u=Math.min(n.length,l.length)-1,h=new Array(u),v=new Array(u),w=-1;for(n[u]<n[0]&&(n=n.slice().reverse(),l=l.slice().reverse());++w<u;)h[w]=$s(n[w],n[w+1]),v[w]=i(l[w],l[w+1]);return function(I){var k=Zc(n,I,1,u)-1;return v[k](h[k](I))}}function Ss(n,l){return l.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function Pa(){var u,h,v,I,k,X,n=Xa,l=Xa,i=Bo,w=qi;function le(){return I=Math.min(n.length,l.length)>2?fs:yo,k=X=null,se}function se(Fe){return isNaN(Fe=+Fe)?v:(k||(k=I(n.map(u),l,i)))(u(w(Fe)))}return se.invert=function(Fe){return w(h((X||(X=I(l,n.map(u),Ao)))(Fe)))},se.domain=function(Fe){return arguments.length?(n=Se.call(Fe,Ja),w===qi||(w=Zs(n)),le()):n.slice()},se.range=function(Fe){return arguments.length?(l=qe.call(Fe),le()):l.slice()},se.rangeRound=function(Fe){return l=qe.call(Fe),i=Os,le()},se.clamp=function(Fe){return arguments.length?(w=Fe?Zs(n):qi,se):w!==qi},se.interpolate=function(Fe){return arguments.length?(i=Fe,le()):i},se.unknown=function(Fe){return arguments.length?(v=Fe,se):v},function(Fe,rt){return u=Fe,h=rt,le()}}function vc(n,l){return Pa()(n,l)}var Lh,cl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ml(n){if(!(l=cl.exec(n)))throw new Error("invalid format: "+n);var l;return new Fo({fill:l[1],align:l[2],sign:l[3],symbol:l[4],zero:l[5],width:l[6],comma:l[7],precision:l[8]&&l[8].slice(1),trim:l[9],type:l[10]})}function Fo(n){this.fill=void 0===n.fill?" ":n.fill+"",this.align=void 0===n.align?">":n.align+"",this.sign=void 0===n.sign?"-":n.sign+"",this.symbol=void 0===n.symbol?"":n.symbol+"",this.zero=!!n.zero,this.width=void 0===n.width?void 0:+n.width,this.comma=!!n.comma,this.precision=void 0===n.precision?void 0:+n.precision,this.trim=!!n.trim,this.type=void 0===n.type?"":n.type+""}function Yu(n,l){if((i=(n=l?n.toExponential(l-1):n.toExponential()).indexOf("e"))<0)return null;var i,u=n.slice(0,i);return[u.length>1?u[0]+u.slice(2):u,+n.slice(i+1)]}function mc(n){return(n=Yu(Math.abs(n)))?n[1]:NaN}function oh(n,l){var i=Yu(n,l);if(!i)return n+"";var u=i[0],h=i[1];return h<0?"0."+new Array(-h).join("0")+u:u.length>h+1?u.slice(0,h+1)+"."+u.slice(h+1):u+new Array(h-u.length+2).join("0")}Ml.prototype=Fo.prototype,Fo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const kh={"%":function(n,l){return(100*n).toFixed(l)},b:function(n){return Math.round(n).toString(2)},c:function(n){return n+""},d:function(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)},e:function(n,l){return n.toExponential(l)},f:function(n,l){return n.toFixed(l)},g:function(n,l){return n.toPrecision(l)},o:function(n){return Math.round(n).toString(8)},p:function(n,l){return oh(100*n,l)},r:oh,s:function(n,l){var i=Yu(n,l);if(!i)return n+"";var u=i[0],h=i[1],v=h-(Lh=3*Math.max(-8,Math.min(8,Math.floor(h/3))))+1,w=u.length;return v===w?u:v>w?u+new Array(v-w+1).join("0"):v>0?u.slice(0,v)+"."+u.slice(v):"0."+new Array(1-v).join("0")+Yu(n,Math.max(0,l+v-1))[0]},X:function(n){return Math.round(n).toString(16).toUpperCase()},x:function(n){return Math.round(n).toString(16)}};function Rh(n){return n}var gc,bf,Dh,jc=Array.prototype.map,sh=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Sf(n){var l=n.domain;return n.ticks=function(i){var u=l();return Rf(u[0],u[u.length-1],null==i?10:i)},n.tickFormat=function(i,u){var h=l();return function(n,l,i,u){var v,h=sp(n,l,i);switch((u=Ml(null==u?",f":u)).type){case"s":var w=Math.max(Math.abs(n),Math.abs(l));return null==u.precision&&!isNaN(v=function(n,l){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mc(l)/3)))-mc(Math.abs(n)))}(h,w))&&(u.precision=v),Dh(u,w);case"":case"e":case"g":case"p":case"r":null==u.precision&&!isNaN(v=function(n,l){return n=Math.abs(n),l=Math.abs(l)-n,Math.max(0,mc(l)-mc(n))+1}(h,Math.max(Math.abs(n),Math.abs(l))))&&(u.precision=v-("e"===u.type));break;case"f":case"%":null==u.precision&&!isNaN(v=function(n){return Math.max(0,-mc(Math.abs(n)))}(h))&&(u.precision=v-2*("%"===u.type))}return bf(u)}(h[0],h[h.length-1],null==i?10:i,u)},n.nice=function(i){null==i&&(i=10);var k,u=l(),h=0,v=u.length-1,w=u[h],I=u[v];return I<w&&(k=w,w=I,I=k,k=h,h=v,v=k),(k=Ql(w,I,i))>0?k=Ql(w=Math.floor(w/k)*k,I=Math.ceil(I/k)*k,i):k<0&&(k=Ql(w=Math.ceil(w*k)/k,I=Math.floor(I*k)/k,i)),k>0?(u[h]=Math.floor(w/k)*k,u[v]=Math.ceil(I/k)*k,l(u)):k<0&&(u[h]=Math.ceil(w*k)/k,u[v]=Math.floor(I*k)/k,l(u)),n},n}function Nh(n,l){var w,i=0,u=(n=n.slice()).length-1,h=n[i],v=n[u];return v<h&&(w=i,i=u,u=w,w=h,h=v,v=w),n[i]=l.floor(h),n[u]=l.ceil(v),n}function Bf(n){return Math.log(n)}function zh(n){return Math.exp(n)}function fh(n){return-Math.log(-n)}function Zh(n){return-Math.exp(-n)}function Ff(n){return isFinite(n)?+("1e"+n):n<0?0:n}function cp(n){return function(l){return-n(-l)}}function rd(n){var h,v,l=n(Bf,zh),i=l.domain,u=10;function w(){return h=function(n){return n===Math.E?Math.log:10===n&&Math.log10||2===n&&Math.log2||(n=Math.log(n),function(l){return Math.log(l)/n})}(u),v=function(n){return 10===n?Ff:n===Math.E?Math.exp:function(l){return Math.pow(n,l)}}(u),i()[0]<0?(h=cp(h),v=cp(v),n(fh,Zh)):n(Bf,zh),l}return l.base=function(I){return arguments.length?(u=+I,w()):u},l.domain=function(I){return arguments.length?(i(I),w()):i()},l.ticks=function(I){var se,k=i(),X=k[0],le=k[k.length-1];(se=le<X)&&(Fe=X,X=le,le=Fe);var Bt,Wt,Ar,Fe=h(X),rt=h(le),jr=null==I?10:+I,sn=[];if(!(u%1)&&rt-Fe<jr){if(Fe=Math.round(Fe)-1,rt=Math.round(rt)+1,X>0){for(;Fe<rt;++Fe)for(Wt=1,Bt=v(Fe);Wt<u;++Wt)if(!((Ar=Bt*Wt)<X)){if(Ar>le)break;sn.push(Ar)}}else for(;Fe<rt;++Fe)for(Wt=u-1,Bt=v(Fe);Wt>=1;--Wt)if(!((Ar=Bt*Wt)<X)){if(Ar>le)break;sn.push(Ar)}}else sn=Rf(Fe,rt,Math.min(rt-Fe,jr)).map(v);return se?sn.reverse():sn},l.tickFormat=function(I,k){if(null==k&&(k=10===u?".0e":","),"function"!=typeof k&&(k=bf(k)),I===1/0)return k;null==I&&(I=10);var X=Math.max(1,u*I/l.ticks().length);return function(le){var se=le/v(Math.round(h(le)));return se*u<u-.5&&(se*=u),se<=X?k(le):""}},l.nice=function(){return i(Nh(i(),{floor:function(I){return v(Math.floor(h(I)))},ceil:function(I){return v(Math.ceil(h(I)))}}))},l}function Go(n){return function(l){return l<0?-Math.pow(-l,n):Math.pow(l,n)}}function yc(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function gd(n){return n<0?-n*n:n*n}function wf(n){var l=n(qi,qi),i=1;function u(){return 1===i?n(qi,qi):.5===i?n(yc,gd):n(Go(i),Go(1/i))}return l.exponent=function(h){return arguments.length?(i=+h,u()):i},Sf(l)}gc=function(n){var l=void 0===n.grouping||void 0===n.thousands?Rh:function(n,l){return function(i,u){for(var h=i.length,v=[],w=0,I=n[0],k=0;h>0&&I>0&&(k+I+1>u&&(I=Math.max(1,u-k)),v.push(i.substring(h-=I,h+I)),!((k+=I+1)>u));)I=n[w=(w+1)%n.length];return v.reverse().join(l)}}(jc.call(n.grouping,Number),n.thousands+""),i=void 0===n.currency?"":n.currency[0]+"",u=void 0===n.currency?"":n.currency[1]+"",h=void 0===n.decimal?".":n.decimal+"",v=void 0===n.numerals?Rh:function(n){return function(l){return l.replace(/[0-9]/g,function(i){return n[+i]})}}(jc.call(n.numerals,String)),w=void 0===n.percent?"%":n.percent+"",I=void 0===n.minus?"-":n.minus+"",k=void 0===n.nan?"NaN":n.nan+"";function X(se){var Fe=(se=Ml(se)).fill,rt=se.align,Bt=se.sign,Wt=se.symbol,Ar=se.zero,jr=se.width,sn=se.comma,yn=se.precision,Mn=se.trim,Wn=se.type;"n"===Wn?(sn=!0,Wn="g"):kh[Wn]||(void 0===yn&&(yn=12),Mn=!0,Wn="g"),(Ar||"0"===Fe&&"="===rt)&&(Ar=!0,Fe="0",rt="=");var ei="$"===Wt?i:"#"===Wt&&/[boxX]/.test(Wn)?"0"+Wn.toLowerCase():"",ti="$"===Wt?u:/[%p]/.test(Wn)?w:"",Ui=kh[Wn],wa=/[defgprs%]/.test(Wn);function Ua(Mi){var Ru,_p,xp,ja=ei,po=ti;if("c"===Wn)po=Ui(Mi)+po,Mi="";else{var bp=(Mi=+Mi)<0||1/Mi<0;if(Mi=isNaN(Mi)?k:Ui(Math.abs(Mi),yn),Mn&&(Mi=function(n){e:for(var h,l=n.length,i=1,u=-1;i<l;++i)switch(n[i]){case".":u=h=i;break;case"0":0===u&&(u=i),h=i;break;default:if(!+n[i])break e;u>0&&(u=0)}return u>0?n.slice(0,u)+n.slice(h+1):n}(Mi)),bp&&0==+Mi&&"+"!==Bt&&(bp=!1),ja=(bp?"("===Bt?Bt:I:"-"===Bt||"("===Bt?"":Bt)+ja,po=("s"===Wn?sh[8+Lh/3]:"")+po+(bp&&"("===Bt?")":""),wa)for(Ru=-1,_p=Mi.length;++Ru<_p;)if(48>(xp=Mi.charCodeAt(Ru))||xp>57){po=(46===xp?h+Mi.slice(Ru+1):Mi.slice(Ru))+po,Mi=Mi.slice(0,Ru);break}}sn&&!Ar&&(Mi=l(Mi,1/0));var Sp=ja.length+Mi.length+po.length,sf=Sp<jr?new Array(jr-Sp+1).join(Fe):"";switch(sn&&Ar&&(Mi=l(sf+Mi,sf.length?jr-po.length:1/0),sf=""),rt){case"<":Mi=ja+Mi+po+sf;break;case"=":Mi=ja+sf+Mi+po;break;case"^":Mi=sf.slice(0,Sp=sf.length>>1)+ja+Mi+po+sf.slice(Sp);break;default:Mi=sf+ja+Mi+po}return v(Mi)}return yn=void 0===yn?6:/[gprs]/.test(Wn)?Math.max(1,Math.min(21,yn)):Math.max(0,Math.min(20,yn)),Ua.toString=function(){return se+""},Ua}return{format:X,formatPrefix:function(se,Fe){var rt=X(((se=Ml(se)).type="f",se)),Bt=3*Math.max(-8,Math.min(8,Math.floor(mc(Fe)/3))),Wt=Math.pow(10,-Bt),Ar=sh[8+Bt/3];return function(jr){return rt(Wt*jr)+Ar}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),bf=gc.format,Dh=gc.formatPrefix;var Nf=new Date,ph=new Date;function pu(n,l,i,u){function h(v){return n(v=0===arguments.length?new Date:new Date(+v)),v}return h.floor=function(v){return n(v=new Date(+v)),v},h.ceil=function(v){return n(v=new Date(v-1)),l(v,1),n(v),v},h.round=function(v){var w=h(v),I=h.ceil(v);return v-w<I-v?w:I},h.offset=function(v,w){return l(v=new Date(+v),null==w?1:Math.floor(w)),v},h.range=function(v,w,I){var X,k=[];if(v=h.ceil(v),I=null==I?1:Math.floor(I),!(v<w&&I>0))return k;do{k.push(X=new Date(+v)),l(v,I),n(v)}while(X<v&&v<w);return k},h.filter=function(v){return pu(function(w){if(w>=w)for(;n(w),!v(w);)w.setTime(w-1)},function(w,I){if(w>=w)if(I<0)for(;++I<=0;)for(;l(w,-1),!v(w););else for(;--I>=0;)for(;l(w,1),!v(w););})},i&&(h.count=function(v,w){return Nf.setTime(+v),ph.setTime(+w),n(Nf),n(ph),Math.floor(i(Nf,ph))},h.every=function(v){return v=Math.floor(v),isFinite(v)&&v>0?v>1?h.filter(u?function(w){return u(w)%v==0}:function(w){return h.count(0,w)%v==0}):h:null}),h}var Wh=pu(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,l){n.setFullYear(n.getFullYear()+l)},function(n,l){return l.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});Wh.every=function(n){return isFinite(n=Math.floor(n))&&n>0?pu(function(l){l.setFullYear(Math.floor(l.getFullYear()/n)*n),l.setMonth(0,1),l.setHours(0,0,0,0)},function(l,i){l.setFullYear(l.getFullYear()+i*n)}):null};const zf=Wh;const nd=pu(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,l){n.setMonth(n.getMonth()+l)},function(n,l){return l.getMonth()-n.getMonth()+12*(l.getFullYear()-n.getFullYear())},function(n){return n.getMonth()});var dh=6e4,Rp=6048e5;function Lu(n){return pu(function(l){l.setDate(l.getDate()-(l.getDay()+7-n)%7),l.setHours(0,0,0,0)},function(l,i){l.setDate(l.getDate()+7*i)},function(l,i){return(i-l-(i.getTimezoneOffset()-l.getTimezoneOffset())*dh)/Rp})}var Dp=Lu(0),Yh=Lu(1),xc=(Lu(2),Lu(3),Lu(4));const qh=(Lu(5),Lu(6),pu(function(n){n.setHours(0,0,0,0)},function(n,l){n.setDate(n.getDate()+l)},function(n,l){return(l-n-(l.getTimezoneOffset()-n.getTimezoneOffset())*dh)/864e5},function(n){return n.getDate()-1}));const Np=pu(function(n){n.setTime(n-n.getMilliseconds()-1e3*n.getSeconds()-n.getMinutes()*dh)},function(n,l){n.setTime(+n+36e5*l)},function(n,l){return(l-n)/36e5},function(n){return n.getHours()});const Zp=pu(function(n){n.setTime(n-n.getMilliseconds()-1e3*n.getSeconds())},function(n,l){n.setTime(+n+l*dh)},function(n,l){return(l-n)/dh},function(n){return n.getMinutes()});const sd=pu(function(n){n.setTime(n-n.getMilliseconds())},function(n,l){n.setTime(+n+1e3*l)},function(n,l){return(l-n)/1e3},function(n){return n.getUTCSeconds()});var dp=pu(function(){},function(n,l){n.setTime(+n+l)},function(n,l){return l-n});dp.every=function(n){return n=Math.floor(n),isFinite(n)&&n>0?n>1?pu(function(l){l.setTime(Math.floor(l/n)*n)},function(l,i){l.setTime(+l+i*n)},function(l,i){return(i-l)/n}):dp:null};const ud=dp;function Uf(n){return pu(function(l){l.setUTCDate(l.getUTCDate()-(l.getUTCDay()+7-n)%7),l.setUTCHours(0,0,0,0)},function(l,i){l.setUTCDate(l.getUTCDate()+7*i)},function(l,i){return(i-l)/Rp})}var ld=Uf(0),vp=Uf(1),_h=(Uf(2),Uf(3),Uf(4));const Vd=(Uf(5),Uf(6),pu(function(n){n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCDate(n.getUTCDate()+l)},function(n,l){return(l-n)/864e5},function(n){return n.getUTCDate()-1}));var Od=pu(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCFullYear(n.getUTCFullYear()+l)},function(n,l){return l.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});Od.every=function(n){return isFinite(n=Math.floor(n))&&n>0?pu(function(l){l.setUTCFullYear(Math.floor(l.getUTCFullYear()/n)*n),l.setUTCMonth(0,1),l.setUTCHours(0,0,0,0)},function(l,i){l.setUTCFullYear(l.getUTCFullYear()+i*n)}):null};const Vp=Od;function Ld(n){if(0<=n.y&&n.y<100){var l=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return l.setFullYear(n.y),l}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function kd(n){if(0<=n.y&&n.y<100){var l=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return l.setUTCFullYear(n.y),l}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function Gp(n,l,i){return{y:n,m:l,d:i,H:0,M:0,S:0,L:0}}var gp,iv,Gd={"-":"",_:" ",0:"0"},ku=/^\s*\d+/,nm=/^%/,im=/[\\^$*+?|[\]().{}]/g;function _o(n,l,i){var u=n<0?"-":"",h=(u?-n:n)+"",v=h.length;return u+(v<i?new Array(i-v+1).join(l)+h:h)}function am(n){return n.replace(im,"\\$&")}function Hp(n){return new RegExp("^(?:"+n.map(am).join("|")+")","i")}function Wp(n){for(var l={},i=-1,u=n.length;++i<u;)l[n[i].toLowerCase()]=i;return l}function om(n,l,i){var u=ku.exec(l.slice(i,i+1));return u?(n.w=+u[0],i+u[0].length):-1}function sm(n,l,i){var u=ku.exec(l.slice(i,i+1));return u?(n.u=+u[0],i+u[0].length):-1}function um(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.U=+u[0],i+u[0].length):-1}function lm(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.V=+u[0],i+u[0].length):-1}function cm(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.W=+u[0],i+u[0].length):-1}function Hd(n,l,i){var u=ku.exec(l.slice(i,i+4));return u?(n.y=+u[0],i+u[0].length):-1}function Wd(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.y=+u[0]+(+u[0]>68?1900:2e3),i+u[0].length):-1}function fm(n,l,i){var u=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(l.slice(i,i+6));return u?(n.Z=u[1]?0:-(u[2]+(u[3]||"00")),i+u[0].length):-1}function hm(n,l,i){var u=ku.exec(l.slice(i,i+1));return u?(n.q=3*u[0]-3,i+u[0].length):-1}function pm(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.m=u[0]-1,i+u[0].length):-1}function Xd(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.d=+u[0],i+u[0].length):-1}function dm(n,l,i){var u=ku.exec(l.slice(i,i+3));return u?(n.m=0,n.d=+u[0],i+u[0].length):-1}function Kd(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.H=+u[0],i+u[0].length):-1}function vm(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.M=+u[0],i+u[0].length):-1}function mm(n,l,i){var u=ku.exec(l.slice(i,i+2));return u?(n.S=+u[0],i+u[0].length):-1}function gm(n,l,i){var u=ku.exec(l.slice(i,i+3));return u?(n.L=+u[0],i+u[0].length):-1}function ym(n,l,i){var u=ku.exec(l.slice(i,i+6));return u?(n.L=Math.floor(u[0]/1e3),i+u[0].length):-1}function _m(n,l,i){var u=nm.exec(l.slice(i,i+1));return u?i+u[0].length:-1}function xm(n,l,i){var u=ku.exec(l.slice(i));return u?(n.Q=+u[0],i+u[0].length):-1}function bm(n,l,i){var u=ku.exec(l.slice(i));return u?(n.s=+u[0],i+u[0].length):-1}function Yd(n,l){return _o(n.getDate(),l,2)}function Sm(n,l){return _o(n.getHours(),l,2)}function wm(n,l){return _o(n.getHours()%12||12,l,2)}function Em(n,l){return _o(1+qh.count(zf(n),n),l,3)}function qd(n,l){return _o(n.getMilliseconds(),l,3)}function Tm(n,l){return qd(n,l)+"000"}function Cm(n,l){return _o(n.getMonth()+1,l,2)}function Am(n,l){return _o(n.getMinutes(),l,2)}function Pm(n,l){return _o(n.getSeconds(),l,2)}function Im(n){var l=n.getDay();return 0===l?7:l}function Mm(n,l){return _o(Dp.count(zf(n)-1,n),l,2)}function Jd(n){var l=n.getDay();return l>=4||0===l?xc(n):xc.ceil(n)}function Om(n,l){return n=Jd(n),_o(xc.count(zf(n),n)+(4===zf(n).getDay()),l,2)}function Lm(n){return n.getDay()}function km(n,l){return _o(Yh.count(zf(n)-1,n),l,2)}function Rm(n,l){return _o(n.getFullYear()%100,l,2)}function Dm(n,l){return _o((n=Jd(n)).getFullYear()%100,l,2)}function Bm(n,l){return _o(n.getFullYear()%1e4,l,4)}function Fm(n,l){var i=n.getDay();return _o((n=i>=4||0===i?xc(n):xc.ceil(n)).getFullYear()%1e4,l,4)}function Nm(n){var l=n.getTimezoneOffset();return(l>0?"-":(l*=-1,"+"))+_o(l/60|0,"0",2)+_o(l%60,"0",2)}function $d(n,l){return _o(n.getUTCDate(),l,2)}function zm(n,l){return _o(n.getUTCHours(),l,2)}function Zm(n,l){return _o(n.getUTCHours()%12||12,l,2)}function Um(n,l){return _o(1+Vd.count(Vp(n),n),l,3)}function Qd(n,l){return _o(n.getUTCMilliseconds(),l,3)}function jm(n,l){return Qd(n,l)+"000"}function Vm(n,l){return _o(n.getUTCMonth()+1,l,2)}function Gm(n,l){return _o(n.getUTCMinutes(),l,2)}function Hm(n,l){return _o(n.getUTCSeconds(),l,2)}function Wm(n){var l=n.getUTCDay();return 0===l?7:l}function Xm(n,l){return _o(ld.count(Vp(n)-1,n),l,2)}function ev(n){var l=n.getUTCDay();return l>=4||0===l?_h(n):_h.ceil(n)}function Km(n,l){return n=ev(n),_o(_h.count(Vp(n),n)+(4===Vp(n).getUTCDay()),l,2)}function Ym(n){return n.getUTCDay()}function qm(n,l){return _o(vp.count(Vp(n)-1,n),l,2)}function Jm(n,l){return _o(n.getUTCFullYear()%100,l,2)}function $m(n,l){return _o((n=ev(n)).getUTCFullYear()%100,l,2)}function Qm(n,l){return _o(n.getUTCFullYear()%1e4,l,4)}function e0(n,l){var i=n.getUTCDay();return _o((n=i>=4||0===i?_h(n):_h.ceil(n)).getUTCFullYear()%1e4,l,4)}function t0(){return"+0000"}function tv(){return"%"}function rv(n){return+n}function nv(n){return Math.floor(+n/1e3)}gp=function(n){var l=n.dateTime,i=n.date,u=n.time,h=n.periods,v=n.days,w=n.shortDays,I=n.months,k=n.shortMonths,X=Hp(h),le=Wp(h),se=Hp(v),Fe=Wp(v),rt=Hp(w),Bt=Wp(w),Wt=Hp(I),Ar=Wp(I),jr=Hp(k),sn=Wp(k),yn={a:function(Ri){return w[Ri.getDay()]},A:function(Ri){return v[Ri.getDay()]},b:function(Ri){return k[Ri.getMonth()]},B:function(Ri){return I[Ri.getMonth()]},c:null,d:Yd,e:Yd,f:Tm,g:Dm,G:Fm,H:Sm,I:wm,j:Em,L:qd,m:Cm,M:Am,p:function(Ri){return h[+(Ri.getHours()>=12)]},q:function(Ri){return 1+~~(Ri.getMonth()/3)},Q:rv,s:nv,S:Pm,u:Im,U:Mm,V:Om,w:Lm,W:km,x:null,X:null,y:Rm,Y:Bm,Z:Nm,"%":tv},Mn={a:function(Ri){return w[Ri.getUTCDay()]},A:function(Ri){return v[Ri.getUTCDay()]},b:function(Ri){return k[Ri.getUTCMonth()]},B:function(Ri){return I[Ri.getUTCMonth()]},c:null,d:$d,e:$d,f:jm,g:$m,G:e0,H:zm,I:Zm,j:Um,L:Qd,m:Vm,M:Gm,p:function(Ri){return h[+(Ri.getUTCHours()>=12)]},q:function(Ri){return 1+~~(Ri.getUTCMonth()/3)},Q:rv,s:nv,S:Hm,u:Wm,U:Xm,V:Km,w:Ym,W:qm,x:null,X:null,y:Jm,Y:Qm,Z:t0,"%":tv},Wn={a:function(Ri,eo,xo){var Un=rt.exec(eo.slice(xo));return Un?(Ri.w=Bt[Un[0].toLowerCase()],xo+Un[0].length):-1},A:function(Ri,eo,xo){var Un=se.exec(eo.slice(xo));return Un?(Ri.w=Fe[Un[0].toLowerCase()],xo+Un[0].length):-1},b:function(Ri,eo,xo){var Un=jr.exec(eo.slice(xo));return Un?(Ri.m=sn[Un[0].toLowerCase()],xo+Un[0].length):-1},B:function(Ri,eo,xo){var Un=Wt.exec(eo.slice(xo));return Un?(Ri.m=Ar[Un[0].toLowerCase()],xo+Un[0].length):-1},c:function(Ri,eo,xo){return Ui(Ri,l,eo,xo)},d:Xd,e:Xd,f:ym,g:Wd,G:Hd,H:Kd,I:Kd,j:dm,L:gm,m:pm,M:vm,p:function(Ri,eo,xo){var Un=X.exec(eo.slice(xo));return Un?(Ri.p=le[Un[0].toLowerCase()],xo+Un[0].length):-1},q:hm,Q:xm,s:bm,S:mm,u:sm,U:um,V:lm,w:om,W:cm,x:function(Ri,eo,xo){return Ui(Ri,i,eo,xo)},X:function(Ri,eo,xo){return Ui(Ri,u,eo,xo)},y:Wd,Y:Hd,Z:fm,"%":_m};function ei(Ri,eo){return function(xo){var Sc,Jh,tm,Un=[],ec=-1,hs=0,bc=Ri.length;for(xo instanceof Date||(xo=new Date(+xo));++ec<bc;)37===Ri.charCodeAt(ec)&&(Un.push(Ri.slice(hs,ec)),null!=(Jh=Gd[Sc=Ri.charAt(++ec)])?Sc=Ri.charAt(++ec):Jh="e"===Sc?" ":"0",(tm=eo[Sc])&&(Sc=tm(xo,Jh)),Un.push(Sc),hs=ec+1);return Un.push(Ri.slice(hs,ec)),Un.join("")}}function ti(Ri,eo){return function(xo){var hs,bc,Un=Gp(1900,void 0,1);if(Ui(Un,Ri,xo+="",0)!=xo.length)return null;if("Q"in Un)return new Date(Un.Q);if("s"in Un)return new Date(1e3*Un.s+("L"in Un?Un.L:0));if(eo&&!("Z"in Un)&&(Un.Z=0),"p"in Un&&(Un.H=Un.H%12+12*Un.p),void 0===Un.m&&(Un.m="q"in Un?Un.q:0),"V"in Un){if(Un.V<1||Un.V>53)return null;"w"in Un||(Un.w=1),"Z"in Un?(bc=(hs=kd(Gp(Un.y,0,1))).getUTCDay(),hs=bc>4||0===bc?vp.ceil(hs):vp(hs),hs=Vd.offset(hs,7*(Un.V-1)),Un.y=hs.getUTCFullYear(),Un.m=hs.getUTCMonth(),Un.d=hs.getUTCDate()+(Un.w+6)%7):(bc=(hs=Ld(Gp(Un.y,0,1))).getDay(),hs=bc>4||0===bc?Yh.ceil(hs):Yh(hs),hs=qh.offset(hs,7*(Un.V-1)),Un.y=hs.getFullYear(),Un.m=hs.getMonth(),Un.d=hs.getDate()+(Un.w+6)%7)}else("W"in Un||"U"in Un)&&("w"in Un||(Un.w="u"in Un?Un.u%7:"W"in Un?1:0),bc="Z"in Un?kd(Gp(Un.y,0,1)).getUTCDay():Ld(Gp(Un.y,0,1)).getDay(),Un.m=0,Un.d="W"in Un?(Un.w+6)%7+7*Un.W-(bc+5)%7:Un.w+7*Un.U-(bc+6)%7);return"Z"in Un?(Un.H+=Un.Z/100|0,Un.M+=Un.Z%100,kd(Un)):Ld(Un)}}function Ui(Ri,eo,xo,Un){for(var Sc,Jh,ec=0,hs=eo.length,bc=xo.length;ec<hs;){if(Un>=bc)return-1;if(37===(Sc=eo.charCodeAt(ec++))){if(Sc=eo.charAt(ec++),!(Jh=Wn[Sc in Gd?eo.charAt(ec++):Sc])||(Un=Jh(Ri,xo,Un))<0)return-1}else if(Sc!=xo.charCodeAt(Un++))return-1}return Un}return yn.x=ei(i,yn),yn.X=ei(u,yn),yn.c=ei(l,yn),Mn.x=ei(i,Mn),Mn.X=ei(u,Mn),Mn.c=ei(l,Mn),{format:function(Ri){var eo=ei(Ri+="",yn);return eo.toString=function(){return Ri},eo},parse:function(Ri){var eo=ti(Ri+="",!1);return eo.toString=function(){return Ri},eo},utcFormat:function(Ri){var eo=ei(Ri+="",Mn);return eo.toString=function(){return Ri},eo},utcParse:function(Ri){var eo=ti(Ri+="",!0);return eo.toString=function(){return Ri},eo}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),iv=gp.format;var Kp=6e4,Yp=60*Kp,qp=24*Yp,av=30*qp,Rd=365*qp;function s0(n){return new Date(n)}function u0(n){return n instanceof Date?+n:+new Date(+n)}function ov(n,l,i,u,h,v,w,I,k){var X=vc(qi,qi),le=X.invert,se=X.domain,Fe=k(".%L"),rt=k(":%S"),Bt=k("%I:%M"),Wt=k("%I %p"),Ar=k("%a %d"),jr=k("%b %d"),sn=k("%B"),yn=k("%Y"),Mn=[[w,1,1e3],[w,5,5e3],[w,15,15e3],[w,30,3e4],[v,1,Kp],[v,5,5*Kp],[v,15,15*Kp],[v,30,30*Kp],[h,1,Yp],[h,3,3*Yp],[h,6,6*Yp],[h,12,12*Yp],[u,1,qp],[u,2,2*qp],[i,1,6048e5],[l,1,av],[l,3,3*av],[n,1,Rd]];function Wn(ti){return(w(ti)<ti?Fe:v(ti)<ti?rt:h(ti)<ti?Bt:u(ti)<ti?Wt:l(ti)<ti?i(ti)<ti?Ar:jr:n(ti)<ti?sn:yn)(ti)}function ei(ti,Ui,wa,Ua){if(null==ti&&(ti=10),"number"==typeof ti){var Mi=Math.abs(wa-Ui)/ti,ja=Ou(function(po){return po[2]}).right(Mn,Mi);ja===Mn.length?(Ua=sp(Ui/Rd,wa/Rd,ti),ti=n):ja?(Ua=(ja=Mn[Mi/Mn[ja-1][2]<Mn[ja][2]/Mi?ja-1:ja])[1],ti=ja[0]):(Ua=Math.max(sp(Ui,wa,ti),1),ti=I)}return null==Ua?ti:ti.every(Ua)}return X.invert=function(ti){return new Date(le(ti))},X.domain=function(ti){return arguments.length?se(Se.call(ti,u0)):se().map(s0)},X.ticks=function(ti,Ui){var po,wa=se(),Ua=wa[0],Mi=wa[wa.length-1],ja=Mi<Ua;return ja&&(po=Ua,Ua=Mi,Mi=po),po=(po=ei(ti,Ua,Mi,Ui))?po.range(Ua,Mi+1):[],ja?po.reverse():po},X.tickFormat=function(ti,Ui){return null==Ui?Wn:k(Ui)},X.nice=function(ti,Ui){var wa=se();return(ti=ei(ti,wa[0],wa[wa.length-1],Ui))?se(Nh(wa,ti)):X},X.copy=function(){return Ss(X,ov(n,l,i,u,h,v,w,I,k))},X}var of,lv,cv,fv,Dd,hv,pv,dv,vv,mv,pd,gv,yv,g0=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,y0=((0,j.Z)(of={},W.ScaleTypes.LINEAR,function lh(){var n=vc(qi,qi);return n.copy=function(){return Ss(n,lh())},Je.apply(n,arguments),Sf(n)}),(0,j.Z)(of,W.ScaleTypes.POWER,function Vh(){var n=wf(Pa());return n.copy=function(){return Ss(n,Vh()).exponent(n.exponent())},Je.apply(n,arguments),n}),(0,j.Z)(of,W.ScaleTypes.LOG,function fp(){var n=rd(Pa()).domain([1,10]);return n.copy=function(){return Ss(n,fp()).base(n.base())},Je.apply(n,arguments),n}),(0,j.Z)(of,W.ScaleTypes.IDENTITY,function ch(n){var l;function i(u){return isNaN(u=+u)?l:u}return i.invert=i,i.domain=i.range=function(u){return arguments.length?(n=Se.call(u,Ja),i):n.slice()},i.unknown=function(u){return arguments.length?(l=u,i):l},i.copy=function(){return ch(n).unknown(l)},n=arguments.length?Se.call(n,Ja):[0,1],Sf(i)}),(0,j.Z)(of,W.ScaleTypes.TIME,function(){return Je.apply(ov(zf,nd,Dp,qh,Np,Zp,sd,ud,iv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),(0,j.Z)(of,W.ScaleTypes.QUANTILE,function Gh(){var u,n=[],l=[],i=[];function h(){var w=0,I=Math.max(1,l.length);for(i=new Array(I-1);++w<I;)i[w-1]=xf(n,w/I);return v}function v(w){return isNaN(w=+w)?u:l[Zc(i,w)]}return v.invertExtent=function(w){var I=l.indexOf(w);return I<0?[NaN,NaN]:[I>0?i[I-1]:n[0],I<i.length?i[I]:n[n.length-1]]},v.domain=function(w){if(!arguments.length)return n.slice();n=[];for(var X,I=0,k=w.length;I<k;++I)null!=(X=w[I])&&!isNaN(X=+X)&&n.push(X);return n.sort(Xu),h()},v.range=function(w){return arguments.length?(l=qe.call(w),h()):l.slice()},v.unknown=function(w){return arguments.length?(u=w,v):u},v.quantiles=function(){return i.slice()},v.copy=function(){return Gh().domain(n).range(l).unknown(u)},Je.apply(v,arguments)}),(0,j.Z)(of,W.ScaleTypes.QUANTIZE,function _c(){var v,n=0,l=1,i=1,u=[.5],h=[0,1];function w(k){return k<=k?h[Zc(u,k,0,i)]:v}function I(){var k=-1;for(u=new Array(i);++k<i;)u[k]=((k+1)*l-(k-i)*n)/(i+1);return w}return w.domain=function(k){return arguments.length?(n=+k[0],l=+k[1],I()):[n,l]},w.range=function(k){return arguments.length?(i=(h=qe.call(k)).length-1,I()):h.slice()},w.invertExtent=function(k){var X=h.indexOf(k);return X<0?[NaN,NaN]:X<1?[n,u[0]]:X>=i?[u[i-1],l]:[u[X-1],u[X]]},w.unknown=function(k){return arguments.length&&(v=k),w},w.thresholds=function(){return u.slice()},w.copy=function(){return _c().domain([n,l]).range(h).unknown(v)},Je.apply(Sf(w),arguments)}),(0,j.Z)(of,W.ScaleTypes.THRESHOLD,function Hh(){var i,n=[.5],l=[0,1],u=1;function h(v){return v<=v?l[Zc(n,v,0,u)]:i}return h.domain=function(v){return arguments.length?(n=qe.call(v),u=Math.min(n.length,l.length-1),h):n.slice()},h.range=function(v){return arguments.length?(l=qe.call(v),u=Math.min(n.length,l.length-1),h):l.slice()},h.invertExtent=function(v){var w=l.indexOf(v);return[n[w-1],n[w]]},h.unknown=function(v){return arguments.length?(i=v,h):i},h.copy=function(){return Hh().domain(n).range(l).unknown(i)},Je.apply(h,arguments)}),(0,j.Z)(of,W.ScaleTypes.CAT,Nt),of),_0=(lv=(0,va.b2)(),cv=(0,va.f3)(W.vK.IGlobalConfigService),lv((Dd=function(){function n(){(0,R.Z)(this,n),(0,K.Z)(this,"configService",hv,this),(0,j.Z)(this,"scaleCache",{}),(0,j.Z)(this,"scaleOptions",{})}return(0,B.Z)(n,[{key:"apply",value:function(i,u){var h=this,v=u.styleAttributeService;i.hooks.init.tap("FeatureScalePlugin",function(){h.scaleOptions=i.getScaleOptions();var w=v.getLayerStyleAttributes(),I=i.getSource().data.dataArray;0!==I.length&&h.caculateScalesForAttributes(w||[],I)}),i.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){h.scaleOptions=i.getScaleOptions();var w=v.getLayerStyleAttributes(),I=i.getSource().data.dataArray;return h.caculateScalesForAttributes(w||[],I),i.layerModelNeedUpdate=!0,!0}),i.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!i.layerModelNeedUpdate){h.scaleOptions=i.getScaleOptions();var w=v.getLayerStyleAttributes();if(w){var I=i.getSource().data.dataArray;if(0===I.length)return;var k=w.filter(function(X){return X.needRescale});k.length&&h.caculateScalesForAttributes(k,I)}}})}},{key:"isNumber",value:function(i){return!isNaN(parseFloat(i))&&isFinite(i)}},{key:"caculateScalesForAttributes",value:function(i,u){var h=this;this.scaleCache={},i.forEach(function(v){if(v.scale){var w=v.scale,I=v.name;w.names=h.parseFields(v.scale.field||[]);var k=[];w.names.forEach(function(X){k.push(h.getOrCreateScale(X,v,u))}),k.some(function(X){return X.type===W.StyleScaleType.VARIABLE})?(w.type=W.StyleScaleType.VARIABLE,k.forEach(function(X){var le;if(!w.callback)if(w.values&&"text"!==w.values){var se;if("linear"===(null===(se=X.option)||void 0===se?void 0:se.type)&&w.values.length>2){var Fe=X.scale.ticks(w.values.length);"color"===I&&X.scale.domain(Fe)}X.scale.range(w.values)}else"cat"===(null===(le=X.option)||void 0===le?void 0:le.type)&&X.scale.range(X.option.domain)})):(w.type=W.StyleScaleType.CONSTANT,w.defaultValues=k.map(function(X,le){return X.scale(w.names[le])})),w.scalers=k.map(function(X){return{field:X.field,func:X.scale,option:X.option}}),v.needRescale=!1}})}},{key:"getOrCreateScale",value:function(i,u,h){[i,u.name].join("_");var v,I=null===(v=u.scale)||void 0===v?void 0:v.values;return this.createScale(i,u.name,I,h)}},{key:"parseFields",value:function(i){return Array.isArray(i)?i:In()(i)?i.split("*"):[i]}},{key:"createScale",value:function(i,u,h,v){var w,I,k=this.scaleOptions[u]&&(null===(w=this.scaleOptions[u])||void 0===w?void 0:w.field)===i?this.scaleOptions[u]:this.scaleOptions[i],X={field:i,scale:void 0,type:W.StyleScaleType.VARIABLE,option:k};if(!v||!v.length)return k&&k.type?X.scale=this.createDefaultScale(k):(X.scale=Nt([i]),X.type=W.StyleScaleType.CONSTANT),X;var le=null===(I=v.find(function(rt){return!zs()(rt[i])}))||void 0===I?void 0:I[i];if(this.isNumber(i)||zs()(le)&&!k)X.scale=Nt([i]),X.type=W.StyleScaleType.CONSTANT;else{var se=k&&k.type||this.getDefaultType(le);"text"===h&&(se=W.ScaleTypes.CAT);var Fe=this.createDefaultScaleConfig(se,i,v);Object.assign(Fe,k),X.scale=this.createDefaultScale(Fe),X.option=Fe}return X}},{key:"getDefaultType",value:function(i){var u=W.ScaleTypes.LINEAR;return"string"==typeof i&&(u=g0.test(i)?W.ScaleTypes.TIME:W.ScaleTypes.CAT),u}},{key:"createDefaultScaleConfig",value:function(i,u,h){var v={type:i},w=(null==h?void 0:h.map(function(I){return I[u]}))||[];return i!==W.ScaleTypes.CAT&&i!==W.ScaleTypes.QUANTILE?v.domain=function(n,l){var h,v,w,i=n.length,u=-1;for(1;++u<i;)if(null!=(h=n[u])&&h>=h)for(v=w=h;++u<i;)null!=(h=n[u])&&(v>h&&(v=h),w<h&&(w=h));return[v,w]}(w):i===W.ScaleTypes.CAT?v.domain=ao()(w):i===W.ScaleTypes.QUANTILE&&(v.domain=w),v}},{key:"createDefaultScale",value:function(i){var h=i.domain,v=y0[i.type]();return h&&v.domain(h),v}}]),n}(),hv=(0,Ve.Z)(Dd.prototype,"configService",[cv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fv=Dd))||fv);function _v(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}var bv,wv,Tv,b0=(pv=(0,va.b2)(),dv=(0,va.f3)(W.vK.ICameraService),vv=(0,va.f3)(W.vK.IRendererService),pv((pd=function(){function n(){(0,R.Z)(this,n),(0,K.Z)(this,"cameraService",gv,this),(0,K.Z)(this,"rendererService",yv,this)}return(0,B.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){i.models.forEach(function(u){u.addUniforms(function(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?_v(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):_v(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}({},i.layerModel.getAnimateUniforms()))})})}}]),n}(),gv=(0,Ve.Z)(pd.prototype,"cameraService",[dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yv=(0,Ve.Z)(pd.prototype,"rendererService",[vv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mv=pd))||mv),S0=(0,va.b2)()(bv=function(){function n(){(0,R.Z)(this,n)}return(0,B.Z)(n,[{key:"apply",value:function(i){i.hooks.init.tap("LayerModelPlugin",function(){i.prepareBuildModel(),i.buildModels(),i.styleNeedUpdate=!1}),i.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return i.prepareBuildModel(),i.clearModels(),i.buildModels(),i.layerModelNeedUpdate=!1,!1})}}]),n}())||bv,w0=(0,va.b2)()(wv=function(){function n(){(0,R.Z)(this,n)}return(0,B.Z)(n,[{key:"apply",value:function(i){i.hooks.afterInit.tap("LayerStylePlugin",function(){i.updateLayerConfig({});var u=i.getLayerConfig(),v=u.fitBoundsOptions;u.autoFit&&setTimeout(function(){i.fitBounds(v)},100)})}}]),n}())||wv;function Cv(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(h){return Object.getOwnPropertyDescriptor(n,h).enumerable})),i.push.apply(i,u)}return i}function Jp(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Cv(Object(i),!0).forEach(function(u){(0,j.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Cv(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Iv,Ov,Lv,kv,Rv,Dv,Bv,Fv,yp,Nv,zv,Zv,Uv,Vv,Hv,Av={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},E0={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},T0={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},C0={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},P0=(0,va.b2)()(Tv=function(){function n(){(0,R.Z)(this,n)}return(0,B.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("LightingPlugin",function(){i.getLayerConfig().enableLighting&&i.models.forEach(function(v){return v.addUniforms(Jp({},function(n){var l={u_DirectionalLights:new Array(3).fill(Jp({},T0)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Jp({},C0)),u_NumOfSpotLights:0};return(!n||!n.length)&&(n=[E0]),n.forEach(function(i,u){var h=i.type,v=void 0===h?"directional":h,w=(0,It.Z)(i,["type"]),I=Av[v].lights,k=Av[v].num,X=l[k];l[I][X]=Jp(Jp({},l[I][X]),w),l[k]++}),l}()))})})}}]),n}())||Tv,I0=(0,va.b2)()(Iv=function(){function n(){(0,R.Z)(this,n)}return(0,B.Z)(n,[{key:"apply",value:function(i,u){var v=u.styleAttributeService;i.hooks.init.tap("PixelPickingPlugin",function(){var I=i.getLayerConfig().enablePicking;v.registerStyleAttribute({name:"pickingColor",type:W.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:W.gl.FLOAT},size:3,update:function(X,le){return I?(0,Ke.Z6)(X.id):[0,0,0]}}})}),i.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){i.getLayerConfig().enablePicking&&i.isVisible()&&i.models.forEach(function(k){return k.addUniforms({u_PickingStage:1})})}),i.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){i.getLayerConfig().enablePicking&&i.isVisible()&&i.models.forEach(function(k){return k.addUniforms({u_PickingStage:2})})}),i.hooks.beforeHighlight.tap("PixelPickingPlugin",function(w){var k=i.getLayerConfig().highlightColor,X="string"==typeof k?(0,Ke.CI)(k):k||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:(0,Ke.W0)(new Uint8Array(w))}),i.models.forEach(function(le){return le.addUniforms({u_PickingStage:2,u_PickingColor:w,u_HighlightColor:X.map(function(se){return 255*se})})})}),i.hooks.beforeSelect.tap("PixelPickingPlugin",function(w){var k=i.getLayerConfig().selectColor,X="string"==typeof k?(0,Ke.CI)(k):k||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:(0,Ke.W0)(new Uint8Array(w))}),i.models.forEach(function(le){return le.addUniforms({u_PickingStage:2,u_PickingColor:w,u_HighlightColor:X.map(function(se){return 255*se})})})})}}]),n}())||Iv,M0=(0,va.b2)()(Ov=function(){function n(){(0,R.Z)(this,n)}return(0,B.Z)(n,[{key:"apply",value:function(i,u){var h=this,v=u.styleAttributeService;i.hooks.init.tap("RegisterStyleAttributePlugin",function(){h.registerBuiltinAttributes(v)})}},{key:"registerBuiltinAttributes",value:function(i){i.registerStyleAttribute({name:"position",type:W.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:W.gl.FLOAT},size:3,update:function(h,v,w){return 2===w.length?[w[0],w[1],0]:[w[0],w[1],w[2]]}}}),i.registerStyleAttribute({name:"filter",type:W.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(h,v){return h.filter?[1]:[0]}}}),i.registerStyleAttribute({name:"color",type:W.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:4,update:function(h,v){var w=h.color;return w&&w.length?w:[1,1,1,1]}}}),i.registerStyleAttribute({name:"vertexId",type:W.AttributeType.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:W.gl.DYNAMIC_DRAW,data:[],type:W.gl.FLOAT},size:1,update:function(h,v,w,I){return[v]}}})}}]),n}())||Ov,O0=(Lv=(0,va.b2)(),kv=(0,va.f3)(W.vK.ICameraService),Rv=(0,va.f3)(W.vK.ICoordinateSystemService),Dv=(0,va.f3)(W.vK.IRendererService),Bv=(0,va.f3)(W.vK.IMapService),Lv((yp=function(){function n(){(0,R.Z)(this,n),(0,K.Z)(this,"cameraService",Nv,this),(0,K.Z)(this,"coordinateSystemService",zv,this),(0,K.Z)(this,"rendererService",Zv,this),(0,K.Z)(this,"mapService",Uv,this)}return(0,B.Z)(n,[{key:"apply",value:function(i){var u=this,h=this.mapService.version,v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],w=[0,0];i.hooks.beforeRender.tap("ShaderUniformPlugin",function(){u.coordinateSystemService.refresh(),"GAODE2.x"===h&&(v=u.mapService.map.customCoords.getMVPMatrix(),w=u.mapService.getCustomCoordCenter());var I=u.rendererService.getViewportSize(),k=I.width,X=I.height;i.models.forEach(function(le){var se;le.addUniforms(((0,j.Z)(se={},W.CameraUniform.ProjectionMatrix,u.cameraService.getProjectionMatrix()),(0,j.Z)(se,W.CameraUniform.ViewMatrix,u.cameraService.getViewMatrix()),(0,j.Z)(se,W.CameraUniform.ViewProjectionMatrix,u.cameraService.getViewProjectionMatrix()),(0,j.Z)(se,W.CameraUniform.Zoom,u.cameraService.getZoom()),(0,j.Z)(se,W.CameraUniform.ZoomScale,u.cameraService.getZoomScale()),(0,j.Z)(se,W.CameraUniform.FocalDistance,u.cameraService.getFocalDistance()),(0,j.Z)(se,W.CameraUniform.CameraPosition,u.cameraService.getCameraPosition()),(0,j.Z)(se,W.CoordinateUniform.CoordinateSystem,u.coordinateSystemService.getCoordinateSystem()),(0,j.Z)(se,W.CoordinateUniform.ViewportCenter,u.coordinateSystemService.getViewportCenter()),(0,j.Z)(se,W.CoordinateUniform.ViewportCenterProjection,u.coordinateSystemService.getViewportCenterProjection()),(0,j.Z)(se,W.CoordinateUniform.PixelsPerDegree,u.coordinateSystemService.getPixelsPerDegree()),(0,j.Z)(se,W.CoordinateUniform.PixelsPerDegree2,u.coordinateSystemService.getPixelsPerDegree2()),(0,j.Z)(se,W.CoordinateUniform.PixelsPerMeter,u.coordinateSystemService.getPixelsPerMeter()),(0,j.Z)(se,W.CoordinateUniform.Mvp,v),(0,j.Z)(se,"u_SceneCenterMKT",w),(0,j.Z)(se,"u_ViewportSize",[k,X]),(0,j.Z)(se,"u_DevicePixelRatio",window.devicePixelRatio),(0,j.Z)(se,"u_ModelMatrix",u.cameraService.getModelMatrix()),(0,j.Z)(se,"u_PickingBuffer",i.getLayerConfig().pickingBuffer||0),se))})})}}]),n}(),Nv=(0,Ve.Z)(yp.prototype,"cameraService",[kv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zv=(0,Ve.Z)(yp.prototype,"coordinateSystemService",[Rv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zv=(0,Ve.Z)(yp.prototype,"rendererService",[Dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uv=(0,Ve.Z)(yp.prototype,"mapService",[Bv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fv=yp))||Fv),L0=(0,va.b2)()(Vv=function(){function n(){(0,R.Z)(this,n)}return(0,B.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("UpdateModelPlugin",function(){i.layerModel&&i.layerModel.needUpdate()})}}]),n}())||Vv,k0=(0,va.b2)()(Hv=function(){function n(){(0,R.Z)(this,n)}return(0,B.Z)(n,[{key:"apply",value:function(i,u){var h=this,v=u.styleAttributeService;i.hooks.init.tap("UpdateStyleAttributePlugin",function(){h.initStyleAttribute(i,{styleAttributeService:v})}),i.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){i.layerModelNeedUpdate||h.updateStyleAtrribute(i,{styleAttributeService:v})})}},{key:"updateStyleAtrribute",value:function(i,u){var h=u.styleAttributeService,v=h.getLayerStyleAttributes()||[],w=h.getLayerStyleAttribute("filter"),I=h.getLayerStyleAttribute("shape");if(w&&w.needRegenerateVertices||I&&I.needRegenerateVertices)return i.layerModelNeedUpdate=!0,void v.forEach(function(k){return k.needRegenerateVertices=!1});v.filter(function(k){return k.needRegenerateVertices}).forEach(function(k){h.updateAttributeByFeatureRange(k.name,i.getEncodedData(),k.featureRange.startIndex,k.featureRange.endIndex),k.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(i,u){var h=u.styleAttributeService;(h.getLayerStyleAttributes()||[]).filter(function(w){return w.needRegenerateVertices}).forEach(function(w){h.updateAttributeByFeatureRange(w.name,i.getEncodedData(),w.featureRange.startIndex,w.featureRange.endIndex),w.needRegenerateVertices=!1})}}]),n}())||Hv;W.nC.bind(W.vK.ILayerPlugin).to(Vo).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(M0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(_0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(Hn).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(w0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(k0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(L0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(ul).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(O0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(b0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(P0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(I0).inRequestScope(),W.nC.bind(W.vK.ILayerPlugin).to(S0).inRequestScope();var jf=y(25917),Vf=y(5304),Gf=y(88002),Bd=y(68939),R0=y(66660),Fd=y(91841);let D0=(()=>{class n{constructor(i){this.http=i}getSearchLockerCabinets(i){return this.http.get("smartlocker-locker/api/v1/locker-cabinets/unpaged?code.contains="+i)}getLockerCabinets(i){return this.http.get("smartlocker-locker/api/v1/locker-cabinets?code.equals="+i)}getAllLockerCabinets(i,u,h,v,w){let I="smartlocker-locker/api/v1/locker-cabinets/unpaged";return i&&""!==i.trim()&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?code.contains=":"&code.contains=",i)),u&&""!==u.trim()&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?maTinh.equals=":"&maTinh.equals=",u)),null!=h&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?maQuanHuyen.equals=":"&maQuanHuyen.equals=",h)),null!=v&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?phuongXaId.equals="+v:"&phuongXaId.equals="+v)),null!=w&&(I=I.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==I?"?buuCucId.equals="+w:"&buuCucId.equals="+w)),this.http.get(I)}getAllBuuCucUpgrade(i,u,h,v){let w="smartlocker/api/v1/buu-cucs/unpaged";return i&&""!==i.trim()&&(w=w.concat("smartlocker/api/v1/buu-cucs/unpaged"==w?"?maTinh.equals=":"&maTinh.equals=",i)),null!=u&&(w=w.concat("smartlocker/api/v1/buu-cucs/unpaged"==w?"?maQuanHuyen.equals=":"&maQuanHuyen.equals=",u)),null!=h&&(w=w.concat("smartlocker/api/v1/buu-cucs/unpaged"==w?"?phuongXaId.equals="+h:"&phuongXaId.equals="+h)),null!=v&&(w=w.concat("smartlocker/api/v1/buu-cucs/unpaged"==w?"?id.equals="+v:"&id.equals="+v)),this.http.get(w)}getBuuCuSearch(i=0,u=10,h,v,w){let I="smartlocker/api/v1/buu-cucs?page="+i+"&size="+u;return h&&""!==h.trim()&&(I=I.concat("&maTinh.equals=",h)),null!=v&&(I=I.concat("&maQuanHuyen.equals=",v)),null!=w&&(I=I.concat("&phuongXaId.equals="+w)),this.http.get(I)}getAllProvince(){return this.http.get("smartlocker/api/v1/vtp-tinhs/unpaged")}getProvinceByCode(i){return this.http.get("smartlocker/api/v1/vtp-tinhs?maTinh.contains="+i)}getDistById(i){return this.http.get("smartlocker/api/v1/vtp-quan-huyens?maQuanHuyen.equals="+i)}getWardsById(i){return this.http.get("smartlocker/api/v1/vtp-phuong-xas?id.equals="+i)}getDistByProvince(i){return this.http.get("smartlocker/api/v1/vtp-quan-huyens/unpaged?maTinh.equals="+i)}getWardByDist(i){return this.http.get("smartlocker/api/v1/vtp-phuong-xas/unpaged?quanHuyenId.equals="+i)}findPost(i=null,u=null){return this.http.get(u?"smartlocker/api/v1/buu-cucs?phuongXaId.equals="+u+"&page=0&size=200":"smartlocker/api/v1/buu-cucs?maQuanHuyen.equals="+i+"&page=0&size=200")}getPostOfficeToCode(i){return this.http.get("smartlocker/api/v1/buu-cucs?maBuuCuc.equals="+i)}getPostOfficeById(i){return this.http.get("smartlocker/api/v1/buu-cucs?id.equals="+i)}}return n.\u0275fac=function(i){return new(i||n)(g.LFG(Fd.eN))},n.\u0275prov=g.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var B0=y(34100),Wv=y(17018),Nd=y(80269),zd=y(3679),Xv=y(14453),F0=y(29374),N0=y(84514),Kv=y(82677),Yv=y(25716),qv=y(76149),Jv=y(36442),$v=y(52496),Qv=y(53599),em=y(93845);let z0=(()=>{class n{transform(i){let u;switch(i){case 0:u="";break;case 1:u="green";break;case 2:u="red";break;case 3:u="#808080";break;case 4:u="gold"}return u}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=g.Yjl({name:"colorStatusDetail",type:n,pure:!0}),n})(),Z0=(()=>{class n{transform(i){let u;switch(i){case 0:u="OFFLINE";break;case 1:u="ONLINE";break;case 2:u="ERROR";break;case 3:u="FULL";break;case 4:u="LOCKED"}return u}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=g.Yjl({name:"textStatusDetail",type:n,pure:!0}),n})(),U0=(()=>{class n{transform(i,u){let h;switch(i){case 10:h=u.toLocaleUpperCase().startsWith("HUB")||u.toLocaleUpperCase().startsWith("CH")?"":"B\u01b0u C\u1ee5c";break;case 30:h=u.toLocaleUpperCase().startsWith("HUB")?"":"HUB";break;case 40:h=u.toLocaleUpperCase().startsWith("TTKNB")?"":"TTKNB";break;case 50:h=u.toLocaleUpperCase().startsWith("TTKT")?"":u.toLocaleUpperCase().startsWith("TTKT 1")||u.toLocaleUpperCase().startsWith("TTKT 2")||u.toLocaleUpperCase().startsWith("TTKT 3")||u.toLocaleUpperCase().startsWith("TTKT 4")?"TTKTL":"TTKT"}return h}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=g.Yjl({name:"levelPost",type:n,pure:!0}),n})();function j0(n,l){if(1&n&&g._UZ(0,"nz-option",45),2&n){const i=l.$implicit;g.Q6J("nzLabel",i.code)("nzValue",i.code)}}function V0(n,l){if(1&n&&g._UZ(0,"nz-option",46),2&n){const i=l.$implicit;g.Q6J("nzValue",i.maTinh)("nzLabel",i.name)}}function G0(n,l){if(1&n&&g._UZ(0,"nz-option",46),2&n){const i=l.$implicit;g.Q6J("nzValue",i.id)("nzLabel",i.tenQuanHuyen)}}function H0(n,l){if(1&n&&g._UZ(0,"nz-option",46),2&n){const i=l.$implicit;g.Q6J("nzValue",i.id)("nzLabel",i.name)}}function W0(n,l){if(1&n&&g._UZ(0,"nz-option",46),2&n){const i=l.$implicit;g.Q6J("nzValue",i.id)("nzLabel",i.name)}}function X0(n,l){1&n&&g._UZ(0,"nz-spin")}function K0(n,l){if(1&n&&g.YNc(0,X0,1,0,"nz-spin",47),2&n){const i=g.oxw();g.Q6J("ngIf",i.isLoadingScroll)}}function Y0(n,l){1&n&&g._UZ(0,"i",48)}function q0(n,l){1&n&&(g.TgZ(0,"h5",49),g._uU(1," T\u1ea5t c\u1ea3 c\xe1c b\u01b0u c\u1ee5c "),g.qZA())}function J0(n,l){1&n&&g._UZ(0,"i",48)}function $0(n,l){if(1&n&&(g.TgZ(0,"h5",49),g._uU(1),g.qZA()),2&n){const i=g.oxw();g.xp6(1),g.hij(" ",i.titleBreadCrumbProvince," ")}}function Q0(n,l){1&n&&g._UZ(0,"i",48)}function eg(n,l){if(1&n&&(g.TgZ(0,"h5",49),g._uU(1),g.qZA()),2&n){const i=g.oxw();g.xp6(1),g.hij(" ",i.titleBreadCrumbDist," ")}}function tg(n,l){1&n&&g._UZ(0,"i",48)}function rg(n,l){if(1&n&&(g.TgZ(0,"h5",49),g._uU(1),g.qZA()),2&n){const i=g.oxw();g.xp6(1),g.hij(" ",i.titleBreadCrumbWard," ")}}function ng(n,l){1&n&&g._UZ(0,"i",48)}function ig(n,l){if(1&n&&(g.TgZ(0,"h5",49),g._uU(1),g.qZA()),2&n){const i=g.oxw();g.xp6(1),g.hij(" ",i.titleBreadCrumbPost," ")}}function ag(n,l){1&n&&g._UZ(0,"i",48)}function og(n,l){if(1&n&&(g.TgZ(0,"h5",49),g._uU(1),g.qZA()),2&n){const i=g.oxw();g.xp6(1),g.hij(" ",i.titleBreadCrumb," ")}}function sg(n,l){1&n&&g._UZ(0,"img",50)}function ug(n,l){1&n&&g._UZ(0,"img",51)}function lg(n,l){1&n&&g._UZ(0,"img",52)}function cg(n,l){1&n&&g._UZ(0,"img",53)}function fg(n,l){1&n&&g._UZ(0,"img",54)}function hg(n,l){1&n&&g._UZ(0,"i",55)}function pg(n,l){1&n&&g._UZ(0,"i",56)}function dg(n,l){if(1&n){const i=g.EpF();g.TgZ(0,"div",57),g.TgZ(1,"h5",58),g._uU(2),g.qZA(),g.TgZ(3,"span",59),g.NdJ("click",function(){return g.CHM(i),g.oxw().clickMe()}),g._UZ(4,"i",60),g.qZA(),g.qZA()}if(2&n){const i=g.oxw();g.xp6(2),g.hij(" ",i.lockerItem&&i.lockerItem.code&&i.lockerItem.title?i.lockerItem.code.concat(" / ",i.lockerItem.title):"-"," ")}}function vg(n,l){if(1&n&&(g.TgZ(0,"nz-tag",78),g.ALo(1,"colorStatusDetail"),g._uU(2),g.ALo(3,"textStatusDetail"),g.qZA()),2&n){const i=g.oxw(2);g.Q6J("nzColor",g.lcZ(1,2,i.lockerItem.status)),g.xp6(2),g.Oqu(g.lcZ(3,4,i.lockerItem.status))}}function mg(n,l){1&n&&(g.TgZ(0,"div",79),g._uU(1," - "),g.qZA())}function gg(n,l){if(1&n&&(g.TgZ(0,"nz-tag",78),g.ALo(1,"colorStatusDetail"),g._uU(2),g.ALo(3,"textStatusDetail"),g.qZA()),2&n){const i=g.oxw(2);g.Q6J("nzColor",i.lockerItem.hardwareStatus.screen?g.lcZ(1,2,i.lockerItem.hardwareStatus.screen):""),g.xp6(2),g.Oqu(null!=i.lockerItem.hardwareStatus.screen?g.lcZ(3,4,i.lockerItem.hardwareStatus.screen):"-")}}function yg(n,l){1&n&&(g.TgZ(0,"span",79),g._uU(1,"-"),g.qZA())}function _g(n,l){if(1&n&&(g.TgZ(0,"nz-tag",78),g.ALo(1,"colorStatusDetail"),g._uU(2),g.ALo(3,"textStatusDetail"),g.qZA()),2&n){const i=g.oxw(2);g.Q6J("nzColor",i.lockerItem.hardwareStatus.firstCamera?g.lcZ(1,2,i.lockerItem.hardwareStatus.firstCamera):""),g.xp6(2),g.Oqu(null!=i.lockerItem.hardwareStatus.firstCamera?g.lcZ(3,4,i.lockerItem.hardwareStatus.firstCamera):"-")}}function xg(n,l){1&n&&(g.TgZ(0,"span",79),g._uU(1,"-"),g.qZA())}function bg(n,l){if(1&n&&(g.TgZ(0,"nz-tag",78),g.ALo(1,"colorStatusDetail"),g._uU(2),g.ALo(3,"textStatusDetail"),g.qZA()),2&n){const i=g.oxw(2);g.Q6J("nzColor",i.lockerItem.hardwareStatus.secondCamera?g.lcZ(1,2,i.lockerItem.hardwareStatus.secondCamera):""),g.xp6(2),g.Oqu(null!=i.lockerItem.hardwareStatus.secondCamera?g.lcZ(3,4,i.lockerItem.hardwareStatus.secondCamera):"-")}}function Sg(n,l){1&n&&(g.TgZ(0,"div",79),g._uU(1," - "),g.qZA())}function wg(n,l){if(1&n&&(g.TgZ(0,"nz-tag",78),g.ALo(1,"colorStatusDetail"),g._uU(2),g.ALo(3,"textStatusDetail"),g.qZA()),2&n){const i=g.oxw(2);g.Q6J("nzColor",i.lockerItem.hardwareStatus.powerMeter?g.lcZ(1,2,i.lockerItem.hardwareStatus.powerMeter):""),g.xp6(2),g.Oqu(null!=i.lockerItem.hardwareStatus.powerMeter?g.lcZ(3,4,i.lockerItem.hardwareStatus.powerMeter):"-")}}function Eg(n,l){1&n&&(g.TgZ(0,"div",79),g._uU(1," - "),g.qZA())}function Tg(n,l){if(1&n&&(g.TgZ(0,"nz-tag",78),g.ALo(1,"colorStatusDetail"),g._uU(2),g.ALo(3,"textStatusDetail"),g.qZA()),2&n){const i=g.oxw(2);g.Q6J("nzColor",i.lockerItem.hardwareStatus.wifi?g.lcZ(1,2,i.lockerItem.hardwareStatus.wifi):""),g.xp6(2),g.Oqu(null!=i.lockerItem.hardwareStatus.wifi?g.lcZ(3,4,i.lockerItem.hardwareStatus.wifi):"-")}}function Cg(n,l){if(1&n){const i=g.EpF();g.TgZ(0,"div",61),g.TgZ(1,"div",14),g.TgZ(2,"div",62),g._UZ(3,"img",63),g.TgZ(4,"span",64),g._uU(5,"B\u01b0u c\u1ee5c :"),g.qZA(),g.qZA(),g.TgZ(6,"div",65),g._uU(7),g.qZA(),g.qZA(),g.TgZ(8,"div",14),g.TgZ(9,"div",62),g._UZ(10,"img",66),g.TgZ(11,"span",64),g._uU(12,"\u0110\u1ecba ch\u1ec9 :"),g.qZA(),g.qZA(),g.TgZ(13,"div",65),g._uU(14),g.qZA(),g.qZA(),g.TgZ(15,"div",14),g.TgZ(16,"div",62),g._UZ(17,"img",67),g.TgZ(18,"span",64),g._uU(19,"Tr\u1ea1ng th\xe1i :"),g.qZA(),g.qZA(),g.TgZ(20,"div",65),g.YNc(21,vg,4,6,"nz-tag",68),g.qZA(),g.qZA(),g.TgZ(22,"div",69),g.TgZ(23,"div",70),g.TgZ(24,"div"),g.TgZ(25,"span",58),g._uU(26,"Giao d\u1ecbch"),g.qZA(),g.qZA(),g.TgZ(27,"div"),g.TgZ(28,"span",71),g._uU(29,"80"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(30,"div",70),g.TgZ(31,"div"),g.TgZ(32,"span",58),g._uU(33,"Ho\xe0n tr\u1ea3"),g.qZA(),g.qZA(),g.TgZ(34,"div"),g.TgZ(35,"span",71),g._uU(36,"80"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(37,"div",70),g.TgZ(38,"div"),g.TgZ(39,"span",58),g._uU(40,"C\xf2n tr\u1ed1ng"),g.qZA(),g.qZA(),g.TgZ(41,"div"),g.TgZ(42,"span",71),g._uU(43,"80"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(44,"div",70),g.TgZ(45,"div"),g.TgZ(46,"span",58),g._uU(47,"\u0110\u1ea7y"),g.qZA(),g.qZA(),g.TgZ(48,"div"),g.TgZ(49,"span",71),g._uU(50,"80"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(51,"div",70),g.TgZ(52,"div"),g.TgZ(53,"span",58),g._uU(54,"l\u1ed7i"),g.qZA(),g.qZA(),g.TgZ(55,"div"),g.TgZ(56,"span",71),g._uU(57,"80"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(58,"div",70),g.TgZ(59,"div"),g.TgZ(60,"span",58),g._uU(61,"\u0110\xf3ng t\u1ee7"),g.qZA(),g.qZA(),g.TgZ(62,"div"),g.TgZ(63,"span",71),g._uU(64,"80"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(65,"div",69),g.TgZ(66,"div",72),g.TgZ(67,"div"),g.TgZ(68,"span",58),g._uU(69,"Phi\xean b\u1ea3n ph\u1ea7n m\u1ec1m"),g.qZA(),g.qZA(),g.TgZ(70,"div"),g.TgZ(71,"span",71),g._uU(72),g.qZA(),g.qZA(),g.qZA(),g.TgZ(73,"div",70),g.TgZ(74,"div"),g.TgZ(75,"span",58),g._uU(76,"M\xe0n h\xecnh"),g.qZA(),g.qZA(),g.TgZ(77,"div"),g.YNc(78,mg,2,0,"div",73),g.YNc(79,gg,4,6,"nz-tag",68),g.qZA(),g.qZA(),g.TgZ(80,"div",62),g.TgZ(81,"div"),g.TgZ(82,"span",58),g._uU(83,"Camera"),g.qZA(),g.qZA(),g.TgZ(84,"div"),g.TgZ(85,"div",74),g.TgZ(86,"span",58),g._uU(87,"Cam 1: "),g.qZA(),g.YNc(88,yg,2,0,"span",73),g.YNc(89,_g,4,6,"nz-tag",68),g.qZA(),g.TgZ(90,"div"),g.TgZ(91,"span",58),g._uU(92,"Cam 2: "),g.qZA(),g.YNc(93,xg,2,0,"span",73),g.YNc(94,bg,4,6,"nz-tag",68),g.qZA(),g.qZA(),g.qZA(),g.TgZ(95,"div",70),g.TgZ(96,"div"),g.TgZ(97,"span",58),g._uU(98,"C\xf4ng t\u01a1 \u0111i\u1ec7n"),g.qZA(),g.qZA(),g.TgZ(99,"div"),g.YNc(100,Sg,2,0,"div",73),g.YNc(101,wg,4,6,"nz-tag",68),g.qZA(),g.qZA(),g.TgZ(102,"div",75),g.TgZ(103,"div"),g.TgZ(104,"span",58),g._uU(105,"Wifi"),g.qZA(),g.qZA(),g.TgZ(106,"div"),g.YNc(107,Eg,2,0,"div",73),g.YNc(108,Tg,4,6,"nz-tag",68),g.qZA(),g.qZA(),g.qZA(),g.TgZ(109,"div",76),g.TgZ(110,"button",77),g.NdJ("click",function(){g.CHM(i);const h=g.oxw();return h.viewDetail(h.lockerItem.id)}),g._uU(111," Xem chi ti\u1ebft "),g.qZA(),g.qZA(),g.qZA()}if(2&n){const i=g.oxw();g.xp6(7),g.hij(" ",i.lockerItem&&i.lockerItem.buuCuc.maBuuCuc?i.lockerItem.buuCuc.maBuuCuc:"-"," "),g.xp6(7),g.hij(" ",i.lockerItem&&i.lockerItem.address&&i.lockerItem.address.detail?i.lockerItem.address.detail.concat(",",i.lockerItem.address.vtpPhuongXa.name,",",i.lockerItem.address.vtpPhuongXa.quanHuyen.tenQuanHuyen,",",i.lockerItem.address.vtpPhuongXa.quanHuyen.tinh.name):"-"," "),g.xp6(7),g.Q6J("ngIf",null!=i.lockerItem.status),g.xp6(51),g.Oqu(i.lockerItem&&i.lockerItem.hardwareStatus&&i.lockerItem.hardwareStatus.softwareVersion?i.lockerItem.hardwareStatus.softwareVersion:"-"),g.xp6(6),g.Q6J("ngIf",null==i.lockerItem.hardwareStatus),g.xp6(1),g.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),g.xp6(9),g.Q6J("ngIf",null==i.lockerItem.hardwareStatus),g.xp6(1),g.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),g.xp6(4),g.Q6J("ngIf",null==i.lockerItem.hardwareStatus),g.xp6(1),g.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),g.xp6(6),g.Q6J("ngIf",null==i.lockerItem.hardwareStatus),g.xp6(1),g.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),g.xp6(6),g.Q6J("ngIf",null==i.lockerItem.hardwareStatus),g.xp6(1),g.Q6J("ngIf",null!=i.lockerItem.hardwareStatus)}}function Ag(n,l){if(1&n){const i=g.EpF();g.TgZ(0,"div",57),g.TgZ(1,"h5",58),g._uU(2),g.ALo(3,"levelPost"),g.qZA(),g.TgZ(4,"span",59),g.NdJ("click",function(){return g.CHM(i),g.oxw().clickMePost()}),g._UZ(5,"i",60),g.qZA(),g.qZA()}if(2&n){const i=g.oxw();g.xp6(2),g.hij(" ",i.itemPostOffice&&i.itemPostOffice.name&&i.itemPostOffice.capBuuCuc?g.xi3(3,1,i.itemPostOffice.capBuuCuc,i.itemPostOffice.name).concat(" ",i.itemPostOffice.name):"-"," ")}}function Pg(n,l){if(1&n&&(g.TgZ(0,"div",80),g.TgZ(1,"div",81),g._UZ(2,"img",82),g.qZA(),g.TgZ(3,"div",14),g.TgZ(4,"div",72),g._UZ(5,"img",63),g.TgZ(6,"span",64),g._uU(7,"M\xe3 B\u01b0u c\u1ee5c :"),g.qZA(),g.qZA(),g.TgZ(8,"div",83),g._uU(9),g.qZA(),g.qZA(),g.TgZ(10,"div",14),g.TgZ(11,"div",72),g._UZ(12,"img",66),g.TgZ(13,"span",64),g._uU(14,"\u0110\u1ecba ch\u1ec9 :"),g.qZA(),g.qZA(),g.TgZ(15,"div",83),g._uU(16),g.qZA(),g.qZA(),g.TgZ(17,"div",84),g.TgZ(18,"div",72),g.TgZ(19,"span",85),g._uU(20,"M\xf4 t\u1ea3 :"),g.qZA(),g.qZA(),g.TgZ(21,"div",83),g._uU(22),g.qZA(),g.qZA(),g.qZA()),2&n){const i=g.oxw();g.xp6(9),g.hij(" ",i.itemPostOffice&&i.itemPostOffice.maBuuCuc?i.itemPostOffice.maBuuCuc:"-"," "),g.xp6(7),g.hij(" ",i.itemPostOffice&&i.itemPostOffice.address?i.itemPostOffice.address:"-"," "),g.xp6(6),g.hij(" ",i.itemPostOffice&&i.itemPostOffice.description?i.itemPostOffice.description:"-"," ")}}const Ig=function(){return[16,16]};let Mg=(()=>{class n{constructor(i,u,h,v){this.httpClient=i,this.mapService=u,this.router=h,this.baseService=v,this.visible=!1,this.countmap=0,this.visiblePost=!1,this.isLoadingMap=!1,this.listOfPostOffice=[],this.listOfHub=[],this.listOfTTKT=[],this.listOfTTB=[],this.listOfCH=[],this.countCH=0,this.countPost=0,this.countTTKT=0,this.countHub=0,this.countTTB=0,this.listOfPost=[],this.isLoadingScroll=!1,this.listOfCabinets=[],this.nzFilterOption=()=>!0,this.pageBuuCuc=0,this.sizeBuuCuc=10,this.totalBuuCuc=0}ngOnInit(){this.getBuuCucSearchLoad(),this.getProvince(),this.getData()}getDataCount(i){this.activeCount=0,this.offCount=0,this.fullCount=0,this.errorCount=0,this.lockerCount=0,i.forEach(u=>{switch(u.status){case 0:this.offCount=this.offCount+1;break;case 1:this.activeCount=+this.activeCount+1;break;case 2:this.errorCount=+this.errorCount+1;break;case 3:this.lockerCount=+this.lockerCount+1;break;case 4:this.fullCount=+this.fullCount+1}})}getCountPost(i){}getData(){this.httpClient.get("/assets/viettelpost.json").subscribe(i=>{this.scene=new ki({id:"map",map:new tl({pitch:0,style:i,center:[105.819746,21.023351],zoom:13,maxZoom:50})}),this.getLoad(),this.getDataLoadAllLocker(),this.getDataLoadAllPost()})}getLoad(){this.scene.on("loaded",()=>{fetch("/assets/map.json").then(h=>h.json()).then(h=>{this.countmap=this.countmap+1;const v=new We({}).source(h).active(!0);this.scene.addLayer(v)}),this.scene.addImage("postoffice","assets/b\u01b0u c\u1ee5c.svg"),this.scene.addImage("hub","assets/hub.svg"),this.scene.addImage("TTKT","assets/5Star.svg"),this.scene.addImage("TTB","assets/trung t\xe2m bay.svg"),this.scene.addImage("CH","assets/c\u1eeda h\xe0ng.svg"),this.scene.addImage("marker0","assets/locker-off.svg"),this.scene.addImage("marker1","assets/locker-onl.svg"),this.scene.addImage("marker2","assets/locker-error.svg"),this.scene.addImage("marker3","assets/locker-locked.svg"),this.scene.addImage("marker4","assets/locker-full.svg");const i=new oe({position:"topright"}),u=new Er({position:"bottomright"});this.scene.addControl(i),this.scene.addControl(u)})}getDataLoadAllLocker(){this.scene.on("loaded",()=>{this.mapService.getAllLockerCabinets(this.codeSearch,this.provinceName,this.distName,this.wardName,this.postId).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(i=>i.data.data)).subscribe(i=>{i.length>0&&(this.totalLocker=i.length,this.getDataCount(i),this.pointLayerLocker=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("status",function(h){let v="";switch(h){case 0:v="marker0";break;case 1:v="marker1";break;case 2:v="marker2";break;case 3:v="marker3";break;case 4:v="marker4"}return v}).size(13).active({color:"blue"}),this.pointLayerLocker.on("mouseup",h=>{this.visible=!1,this.datasend=h,this.clickPoint({bubbles:!0,detail:this.datasend})}),this.pointLayerLocker.on("mouseout",h=>{this.visible=!1}),this.scene.addLayer(this.pointLayerLocker),this.layersControl=new Ue({overlayers:{"T\u1ee7 SmartLocker":this.pointLayerLocker}}),this.scene.addControl(this.layersControl))})})}getDataLoadAllPost(){this.scene.on("loaded",()=>{this.isLoadingMap=!0,this.mapService.getAllBuuCucUpgrade(this.provinceName,this.distName,this.wardName,this.postId).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Bd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{this.totalPost=0,i.length>0&&(this.listOfTTKT=[],this.listOfHub=[],this.listOfPostOffice=[],this.listOfTTB=[],this.countPost=0,this.countTTKT=0,this.countHub=0,this.countTTB=0,this.listOfCH=[],this.countCH=0,i.forEach(u=>{switch(Number(u.capBuuCuc)){case 10:u.name.toLocaleUpperCase().startsWith("HUB")?this.listOfHub.push(u):u.name.toLocaleUpperCase().startsWith("CH")?this.listOfCH.push(u):this.listOfPostOffice.push(u);break;case 30:this.listOfHub.push(u);break;case 40:this.listOfTTB.push(u);break;case 50:this.listOfTTKT.push(u)}}),this.totalPost=this.listOfPostOffice.length,this.totalTTKT=this.listOfTTKT.length,this.totalTTB=this.listOfTTB.length,this.totalHUB=this.listOfHub.length,this.totalCH=this.listOfCH.length,this.pointLayerPost=new uo({}).source(this.listOfPostOffice,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("postoffice").size(14).active({color:"blue"}),this.pointLayerPost.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerPost.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerPost),this.getCountPost(this.scene),this.layersControl.addVisualLayer(this.pointLayerPost,"B\u01b0u C\u1ee5c"),this.getDataLoadAllCH(this.listOfCH),this.getDataLoadAllTTKT(this.listOfTTKT),this.getDataLoadAllTTB(this.listOfTTB),this.getDataLoadAllHUB(this.listOfHub),document.getElementsByClassName("l7-control-layers-selector")[1].addEventListener("click",()=>{this.countPost=this.countPost+1,this.totalPost=0==this.countPost||this.countPost%2==0?this.listOfPostOffice.length:0}),document.getElementsByClassName("l7-control-layers-selector")[2].addEventListener("click",()=>{this.countCH=this.countCH+1,this.totalCH=0==this.countCH||this.countCH%2==0?this.listOfCH.length:0}),document.getElementsByClassName("l7-control-layers-selector")[3].addEventListener("click",()=>{this.countTTKT=this.countTTKT+1,this.totalTTKT=0==this.countTTKT||this.countTTKT%2==0?this.listOfTTKT.length:0}),document.getElementsByClassName("l7-control-layers-selector")[4].addEventListener("click",()=>{this.countTTB=this.countTTB+1,this.totalTTB=0==this.countTTB||this.countTTB%2==0?this.listOfTTB.length:0}),document.getElementsByClassName("l7-control-layers-selector")[5].addEventListener("click",()=>{this.countHub=this.countHub+1,this.totalHUB=0==this.countHub||this.countHub%2==0?this.listOfHub.length:0}))})})}getDataLoadAllCH(i){this.pointLayerCH=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("CH").size(14).active({color:"blue"}),this.pointLayerCH.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerCH.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerCH),this.layersControl.addVisualLayer(this.pointLayerCH,"C\u1eeda h\xe0ng")}getDataLoadAllTTKT(i){this.pointLayerTTKT=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("TTKT").size(14).active({color:"blue"}),this.pointLayerTTKT.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerTTKT.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerTTKT),this.layersControl.addVisualLayer(this.pointLayerTTKT,"Trung T\xe2m Khai Th\xe1c")}getDataLoadAllTTB(i){this.pointLayerTTB=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("TTB").size(14).active({color:"blue"}),this.pointLayerTTB.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerTTB.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerTTB),this.layersControl.addVisualLayer(this.pointLayerTTB,"Trung T\xe2m Bay")}getDataLoadAllHUB(i){this.pointLayerHUB=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("hub").size(14).active({color:"blue"}),this.pointLayerHUB.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerHUB.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerHUB),this.layersControl.addVisualLayer(this.pointLayerHUB,"HUB")}clickPoint(i){this.lockerItem=i.detail.feature;let u=document.getElementById("popoverpoint");u.style.left=i.detail.x+"px",u.style.top=i.detail.y+"px",setTimeout(()=>{this.visible=!0},100)}clickMe(){this.visible=!1}clickPointPost(i){this.itemPostOffice=i.detail.feature;let u=document.getElementById("pointpost");u.style.left=i.detail.x+"px",u.style.top=i.detail.y+"px",setTimeout(()=>{this.visiblePost=!0},100)}clickMePost(){this.visiblePost=!1}change(i){}changePost(i){}viewDetail(i){this.router.navigateByUrl("/lockers/detail/"+i)}getDetailTitleMap(){null==this.provinceId&&(this.titleBreadCrumb="T\u1ea4T C\u1ea2 C\xc1C B\u01afU C\u1ee4C")}searchAll(){this.getDataItemLocker(),this.getDataItemPost()}searchCode(i){this.listOfCabinets=[],null!=i&&""!=i&&this.mapService.getSearchLockerCabinets(i).subscribe(u=>{u.data.data.length>0&&u.data.data.forEach(h=>{let v=new R0.i(h);this.listOfCabinets.push(v)})}),null!=this.codeSearch?this.mapService.getLockerCabinets(this.codeSearch).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{u.length>0&&(this.titleBreadCrumb=u[0].title)}):this.titleBreadCrumb=null,this.getDataItemLocker()}getProvince(){this.mapService.getAllProvince().subscribe(i=>{0==i.error&&(this.listOfProvince=i.data.data)})}pageChange(i){this.page=i,this.getDataItemLocker(),this.getDataItemPost()}getDataItemLocker(){this.isLoadingMap=!0,this.mapService.getAllLockerCabinets(this.codeSearch,this.provinceName,this.distName,this.wardName,this.postId).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Bd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{i.length>0?(this.totalLocker=i.length,this.getDataCount(i),this.pointLayerLocker.setData(i),this.scene.setZoomAndCenter(null!=this.postId?15:9,[i[0].longitude,i[0].latitude])):this.totalLocker=0})}getDataItemPost(){this.isLoadingMap=!0,this.totalPost=0,this.totalCH=0,this.totalHUB=0,this.totalTTB=0,this.totalTTKT=0,this.listOfTTKT=[],this.listOfHub=[],this.listOfPostOffice=[],this.listOfTTB=[],this.listOfCH=[],this.mapService.getAllBuuCucUpgrade(this.provinceName,this.distName,this.wardName,this.postId).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Bd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{i.length>0&&(i.forEach(u=>{switch(Number(u.capBuuCuc)){case 10:u.name.toLocaleUpperCase().startsWith("HUB")?this.listOfHub.push(u):u.name.toLocaleUpperCase().startsWith("CH")?this.listOfCH.push(u):this.listOfPostOffice.push(u);break;case 30:this.listOfHub.push(u);break;case 40:this.listOfTTB.push(u);break;case 50:this.listOfTTKT.push(u)}}),this.totalPost=this.listOfPostOffice.length,this.totalTTKT=this.listOfTTKT.length,this.totalTTB=this.listOfTTB.length,this.totalHUB=this.listOfHub.length,this.totalCH=this.listOfCH.length,this.pointLayerPost.setData(this.listOfPostOffice),this.pointLayerTTKT.setData(this.listOfTTKT),this.pointLayerTTB.setData(this.listOfTTB),this.pointLayerHUB.setData(this.listOfHub),this.pointLayerCH.setData(this.listOfCH),this.scene.setZoomAndCenter(null!=this.postId?15:null!=this.wardId&&null==this.postId?12:null==this.wardId&&null==this.postId&&null!=this.distId?11:9,[i[0].longitude,i[0].latitude]))})}provinceChange(i){this.provinceName=i,null!=i?(this.pageBuuCuc=0,this.listOfPost=[],this.mapService.getProvinceByCode(i).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{u.length>0&&(this.titleBreadCrumbProvince=u[0].name)}),this.mapService.getDistByProvince(i).subscribe(u=>{0==u.error&&(this.listOfWard=[],this.distId=null,this.wardId=null,this.wardName=null,this.distName=null,this.postId=null,this.listOfDist=u.data.data)})):(this.titleBreadCrumbProvince=null,this.titleBreadCrumbPost=null,this.titleBreadCrumbWard=null,this.titleBreadCrumbDist=null,this.pageBuuCuc=0,this.listOfPost=[],this.listOfDist=[],this.listOfWard=[],this.wardName=null,this.distName=null,this.postId=null,this.distId=null,this.wardId=null,this.provinceName=null),this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}distChange(i){if(this.distId=i,null!=i){this.pageBuuCuc=0,this.listOfPost=[];for(let u=0;u<this.listOfDist.length;u++)if(i==this.listOfDist[u].id){this.distName=this.listOfDist[u].maQuanHuyen,this.mapService.getDistById(this.distName).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(h=>h.data.data)).subscribe(h=>{h.length>0&&(this.titleBreadCrumbDist=h[0].tenQuanHuyen)});break}this.mapService.getWardByDist(i).subscribe(u=>{0==u.error&&(this.wardName=null,this.wardId=null,this.postId=null,this.listOfWard=u.data.data)})}else this.titleBreadCrumbDist=null,this.titleBreadCrumbPost=null,this.titleBreadCrumbWard=null,this.pageBuuCuc=0,this.listOfPost=[],this.listOfWard=[],this.wardName=null,this.postId=null,this.distName=null,this.distId=null,this.wardId=null;this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}wardChange(i){if(this.wardId=i,null!=i){this.pageBuuCuc=0,this.listOfPost=[];for(let u=0;u<this.listOfDist.length;u++)if(i==this.listOfWard[u].id){this.postId=null,this.wardName=this.listOfWard[u].id,this.mapService.getWardsById(this.wardName).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(h=>h.data.data)).subscribe(h=>{h.length>0&&(this.titleBreadCrumbWard=h[0].name)});break}}else this.titleBreadCrumbWard=null,this.titleBreadCrumbPost=null,this.pageBuuCuc=0,this.listOfPost=[],this.wardName=null,this.wardId=null,this.postId=null;this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}searchPost(i){this.postId=i,null!=i?this.mapService.getPostOfficeById(i).pipe((0,Vf.K)(()=>(0,jf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{this.titleBreadCrumbPost=u[0].name}):this.titleBreadCrumbPost=null,this.getDataItemLocker(),this.getDataItemPost()}getBuuCucSearchLoad(){this.mapService.getBuuCuSearch(this.pageBuuCuc,this.sizeBuuCuc,this.provinceName,this.distName,this.wardName).subscribe(i=>{this.isLoadingScroll=!1,this.responseProcessBuuCuc(i)},i=>{console.log("Kh\xf4ng g\u01b0i \u0111\u01b0\u1ee3c th\xf4ng tin l\u1ea5y b\u01b0u c\u1ee5c",i)})}responseProcessBuuCuc(i){this.listOfPost=this.listOfPost==[]?i.data.data:this.listOfPost.concat(i.data.data),this.totalBuuCuc=i.data.total}loadMore(){this.totalBuuCuc>this.listOfPost.length&&(this.isLoadingScroll=!0,this.pageBuuCuc=this.pageBuuCuc+1,this.getBuuCucSearchLoad())}}return n.\u0275fac=function(i){return new(i||n)(g.Y36(Fd.eN),g.Y36(D0),g.Y36(c.F0),g.Y36(B0.bQ))},n.\u0275cmp=g.Xpm({type:n,selectors:[["cms-map"]],decls:101,vars:70,consts:[[1,"mt-0","mx-0"],["nz-row","",1,"row-search",3,"nzGutter"],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","4","nzXXl","5",1,"mt-1"],["nzShowSearch","","nzServerSearch","","nzAllowClear","","nzPlaceHolder","Nh\u1eadp m\xe3 locker",1,"width-full",3,"ngModel","nzShowArrow","nzFilterOption","ngModelChange","nzOnSearch"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","4","nzXXl","4",1,"mt-1"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn t\u1ec9nh","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn qu\u1eadn/huy\u1ec7n","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn ph\u01b0\u1eddng/x\xe3","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn b\u01b0u c\u1ee5c","nzAllowClear","",1,"width-full",3,"ngModel","nzDropdownRender","nzScrollToBottom","ngModelChange"],["renderTemplate",""],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","2","nzXXl","2",1,"mt-1"],["nz-button","","nzType","primary",3,"click"],["nz-row","",1,"mt-3"],["nz-col","","nzSpan","24"],["nz-typography","","nzType","secondary"],["nz-icon","","nzType","right","nzTheme","outline","class","next-segment",4,"ngIf"],["nz-typography","","class","mt-0 mb-2 d-inline-block",4,"ngIf"],[3,"nzSpinning"],["nz-row","","nzGutter","16"],["nz-col","","nzXs","24","nzSm","24","nzMd","5","nzLg","5","nzXl","4","nzXXl","3"],["nz-row",""],["nz-col","","nzXs","10","nzSm","11","nzMd","24","nzLg","24","nzXl","24","nzXXl","24",1,"top-statistic"],[3,"nzValue","nzTitle","nzPrefix"],["prefixTplOne",""],["prefixTplOne1",""],["prefixTplOne2",""],["prefixTplOne3",""],["prefixTplOne4",""],["prefixTplOne5",""],["prefixTplOne6",""],[1,"mt-4","status-tag"],["nzStatus","success","nzText","Kh\u1ea3 d\u1ee5ng",1,"d-inline-block","d-md-block","mb-2","ml-2"],["nzStatus","default","nzText","\u0110\u1ea7y",1,"d-inline-block","d-md-block","mb-2","ml-2"],["nzStatus","error","nzText","L\u1ed7i",1,"d-inline-block","d-md-block","ml-2"],["nz-col","","nzXs","24","nzSm","25","nzMd","19","nzLg","19","nzXl","20","nzXXl","21"],["id","map",1,"map-wrapper"],["id","popoverpoint"],["nz-popover","",3,"nzPopoverTitle","nzPopoverVisible","nzPopoverContent","nzPopoverVisibleChange"],["titleTemplate",""],["contentTemplate",""],["id","pointpost"],["titleTemplatePost",""],["contentTemplatePost",""],[3,"nzLabel","nzValue"],[3,"nzValue","nzLabel"],[4,"ngIf"],["nz-icon","","nzType","right","nzTheme","outline",1,"next-segment"],["nz-typography","",1,"mt-0","mb-2","d-inline-block"],["src","/assets/postofficeall.svg","height","18",1,"mr-2"],["src","/assets/locker (2).svg","height","18",1,"mr-2"],["src","/assets/active.svg","height","18",1,"mr-2"],["src","/assets/full.svg","height","18",1,"mr-2"],["src","/assets/error.svg","height","18",1,"mr-2"],["nz-icon","","nzType","lock","nzTheme","outline",1,"mr-2",2,"font-size","20px","color","red"],["nz-icon","","nzType","disconnect","nzTheme","outline",1,"mr-2",2,"font-size","20px","color","#808080"],[1,"pt-2",2,"display","flex","justify-content","space-between"],["nz-typography",""],[2,"cursor","pointer",3,"click"],["nz-icon","","nzType","close","nzTheme","outline"],[1,"ml-2"],["nz-col","","nzSpan","6"],["src","assets/homepost.svg",1,"mr-2"],["nz-col","",1,"text-bold"],["nz-col","","nzSpan","18"],["src","assets/address.svg",1,"mr-2"],["src","assets/active.svg","height","16","width","16",1,"mr-2"],[3,"nzColor",4,"ngIf"],["nz-row","",1,"mt-4"],["nz-col","","nzSpan","4"],[1,"text-bold"],["nz-col","","nzSpan","7"],["class","text-center",4,"ngIf"],[1,"mb-3"],["nz-col","","nzSpan","3"],["nz-row","","nzJustify","center",1,"mb-3","mt-4"],["nz-button","","nzType","primary",2,"cursor","pointer",3,"click"],[3,"nzColor"],[1,"text-center"],[1,"mx-2"],["nz-row","",1,"mt-3",2,"display","flex","justify-content","center"],["src","assets/banner-vtp.png",1,"mb-2",2,"width","100%","height","100%"],["nz-col","","nzSpan","17"],["nz-row","",1,"my-3"],["nz-col","",1,"text-bold","pl-5"]],template:function(i,u){if(1&i&&(g.TgZ(0,"nz-card"),g.TgZ(1,"div",0),g.TgZ(2,"div",1),g.TgZ(3,"div",2),g.TgZ(4,"nz-select",3),g.NdJ("ngModelChange",function(v){return u.codeSearch=v})("nzOnSearch",function(v){return u.searchCode(v)}),g.YNc(5,j0,1,2,"nz-option",4),g.qZA(),g.qZA(),g.TgZ(6,"div",5),g.TgZ(7,"nz-select",6),g.NdJ("ngModelChange",function(v){return u.provinceChange(v)}),g.YNc(8,V0,1,2,"nz-option",7),g.qZA(),g.qZA(),g.TgZ(9,"div",5),g.TgZ(10,"nz-select",8),g.NdJ("ngModelChange",function(v){return u.distChange(v)}),g.YNc(11,G0,1,2,"nz-option",7),g.qZA(),g.qZA(),g.TgZ(12,"div",5),g.TgZ(13,"nz-select",9),g.NdJ("ngModelChange",function(v){return u.wardChange(v)}),g.YNc(14,H0,1,2,"nz-option",7),g.qZA(),g.qZA(),g.TgZ(15,"div",5),g.TgZ(16,"nz-select",10),g.NdJ("nzScrollToBottom",function(){return u.loadMore()})("ngModelChange",function(v){return u.searchPost(v)}),g.YNc(17,W0,1,2,"nz-option",7),g.YNc(18,K0,1,1,"ng-template",null,11,g.W1O),g.qZA(),g.qZA(),g.TgZ(20,"div",12),g.TgZ(21,"button",13),g.NdJ("click",function(){return u.searchAll()}),g._uU(22," T\xecm ki\u1ebfm "),g.qZA(),g.qZA(),g.qZA(),g.TgZ(23,"div",14),g.TgZ(24,"div",15),g.TgZ(25,"span",16),g._uU(26,"Th\u1ed1ng k\xea"),g.qZA(),g.YNc(27,Y0,1,0,"i",17),g.YNc(28,q0,2,0,"h5",18),g.YNc(29,J0,1,0,"i",17),g.YNc(30,$0,2,1,"h5",18),g.YNc(31,Q0,1,0,"i",17),g.YNc(32,eg,2,1,"h5",18),g.YNc(33,tg,1,0,"i",17),g.YNc(34,rg,2,1,"h5",18),g.YNc(35,ng,1,0,"i",17),g.YNc(36,ig,2,1,"h5",18),g.YNc(37,ag,1,0,"i",17),g.YNc(38,og,2,1,"h5",18),g.qZA(),g.qZA(),g.TgZ(39,"nz-spin",19),g.TgZ(40,"div",20),g.TgZ(41,"div",21),g.TgZ(42,"div"),g.TgZ(43,"div",22),g.TgZ(44,"div",23),g._UZ(45,"nz-statistic",24),g.ALo(46,"number"),g.YNc(47,sg,1,0,"ng-template",null,25,g.W1O),g.qZA(),g.TgZ(49,"div",23),g._UZ(50,"nz-statistic",24),g.ALo(51,"number"),g.YNc(52,ug,1,0,"ng-template",null,26,g.W1O),g.qZA(),g.TgZ(54,"div",23),g._UZ(55,"nz-statistic",24),g.ALo(56,"number"),g.YNc(57,lg,1,0,"ng-template",null,27,g.W1O),g.qZA(),g.TgZ(59,"div",23),g._UZ(60,"nz-statistic",24),g.ALo(61,"number"),g.YNc(62,cg,1,0,"ng-template",null,28,g.W1O),g.qZA(),g.TgZ(64,"div",23),g._UZ(65,"nz-statistic",24),g.ALo(66,"number"),g.YNc(67,fg,1,0,"ng-template",null,29,g.W1O),g.qZA(),g.TgZ(69,"div",23),g._UZ(70,"nz-statistic",24),g.ALo(71,"number"),g.YNc(72,hg,1,0,"ng-template",null,30,g.W1O),g.qZA(),g.TgZ(74,"div",23),g._UZ(75,"nz-statistic",24),g.ALo(76,"number"),g.YNc(77,pg,1,0,"ng-template",null,31,g.W1O),g.qZA(),g.qZA(),g.TgZ(79,"div",32),g.TgZ(80,"p",16),g._uU(81,"Qui \u01b0\u1edbc m\xe0u"),g.qZA(),g._UZ(82,"nz-badge",33),g._UZ(83,"nz-badge",34),g._UZ(84,"nz-badge",35),g.qZA(),g.qZA(),g.qZA(),g.TgZ(85,"div",36),g._UZ(86,"div",37),g.TgZ(87,"div"),g.TgZ(88,"div",38),g.TgZ(89,"span",39),g.NdJ("nzPopoverVisibleChange",function(v){return u.change(v)}),g.qZA(),g.YNc(90,dg,5,1,"ng-template",null,40,g.W1O),g.YNc(92,Cg,112,14,"ng-template",null,41,g.W1O),g.qZA(),g.qZA(),g.TgZ(94,"div"),g.TgZ(95,"div",42),g.TgZ(96,"span",39),g.NdJ("nzPopoverVisibleChange",function(v){return u.changePost(v)}),g.qZA(),g.YNc(97,Ag,6,4,"ng-template",null,43,g.W1O),g.YNc(99,Pg,23,3,"ng-template",null,44,g.W1O),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&i){const h=g.MAs(19),v=g.MAs(48),w=g.MAs(53),I=g.MAs(58),k=g.MAs(63),X=g.MAs(68),le=g.MAs(73),se=g.MAs(78),Fe=g.MAs(91),rt=g.MAs(93),Bt=g.MAs(98),Wt=g.MAs(100);g.xp6(2),g.Q6J("nzGutter",g.DdM(69,Ig)),g.xp6(2),g.Q6J("ngModel",u.codeSearch)("nzShowArrow",!1)("nzFilterOption",u.nzFilterOption),g.xp6(1),g.Q6J("ngForOf",u.listOfCabinets),g.xp6(2),g.Q6J("ngModel",u.provinceId),g.xp6(1),g.Q6J("ngForOf",u.listOfProvince),g.xp6(2),g.Q6J("ngModel",u.distId),g.xp6(1),g.Q6J("ngForOf",u.listOfDist),g.xp6(2),g.Q6J("ngModel",u.wardId),g.xp6(1),g.Q6J("ngForOf",u.listOfWard),g.xp6(2),g.Q6J("ngModel",u.postId)("nzDropdownRender",h)("nzDropdownRender",h),g.xp6(1),g.Q6J("ngForOf",u.listOfPost),g.xp6(10),g.Q6J("ngIf",null==u.titleBreadCrumbProvince&&null==u.titleBreadCrumbPost&&null==u.titleBreadCrumb),g.xp6(1),g.Q6J("ngIf",null==u.titleBreadCrumbProvince&&null==u.titleBreadCrumbPost&&null==u.titleBreadCrumb),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumbProvince),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumbProvince),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumbDist),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumbDist),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumbWard),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumbWard),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumbPost),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumbPost),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumb),g.xp6(1),g.Q6J("ngIf",null!=u.titleBreadCrumb),g.xp6(1),g.Q6J("nzSpinning",u.isLoadingMap),g.xp6(6),g.Q6J("nzValue",u.totalPost>=0&&u.totalTTB>=0&&u.totalHUB>=0&&u.totalTTKT>=0&&u.totalCH>=0?g.lcZ(46,55,u.totalPost+u.totalTTB+u.totalHUB+u.totalTTKT+u.totalCH):0)("nzTitle","T\u1ed5ng s\u1ed1 b\u01b0u c\u1ee5c")("nzPrefix",v),g.xp6(5),g.Q6J("nzValue",u.totalLocker?g.lcZ(51,57,u.totalLocker):0)("nzTitle","T\u1ed5ng S\u1ed1 Locker")("nzPrefix",w),g.xp6(5),g.Q6J("nzValue",u.activeCount?g.lcZ(56,59,u.activeCount):0)("nzTitle","\u0110ang kh\u1ea3 d\u1ee5ng")("nzPrefix",I),g.xp6(5),g.Q6J("nzValue",u.fullCount?g.lcZ(61,61,u.fullCount):0)("nzTitle","\u0110\u1ea7y")("nzPrefix",k),g.xp6(5),g.Q6J("nzValue",u.errorCount?g.lcZ(66,63,u.errorCount):0)("nzTitle","L\u1ed7i")("nzPrefix",X),g.xp6(5),g.Q6J("nzValue",u.lockerCount?g.lcZ(71,65,u.lockerCount):0)("nzTitle","Kh\xf3a")("nzPrefix",le),g.xp6(5),g.Q6J("nzValue",u.offCount?g.lcZ(76,67,u.offCount):0)("nzTitle","T\u1eaft")("nzPrefix",se),g.xp6(14),g.Q6J("nzPopoverTitle",Fe)("nzPopoverVisible",u.visible)("nzPopoverContent",rt),g.xp6(7),g.Q6J("nzPopoverTitle",Bt)("nzPopoverVisible",u.visiblePost)("nzPopoverContent",Wt)}},directives:[Wv.bd,O.SK,O.t3,Nd.Vq,zd.JJ,zd.On,_.sg,Xv.ix,F0.dQ,N0.w,Kv.ZU,_.O5,Yv.W,qv.my,Jv.x7,$v.lU,Nd.Ip,Qv.Ls,em.j],pipes:[_.JJ,z0,Z0,U0],styles:[".text-align[_ngcontent-%COMP%]{text-align:center}.next-segment[_ngcontent-%COMP%]{font-size:12px;color:#d9d9d9;margin-right:4px}.map-wrapper[_ngcontent-%COMP%]{justify-content:center;position:relative;min-height:calc(100vh - 220px);margin:6px 0 0;border-radius:6px;overflow:hidden}.top-statistic[_ngcontent-%COMP%]{background-color:#f6f6f6;border-radius:6px;margin:6px 16px 0 0;padding:10px 20px 6px}[_nghost-%COMP%]     .status-tag .ant-badge-status-dot{width:12px;height:12px}#popoverpoint[_ngcontent-%COMP%]{position:absolute}#pointpost[_ngcontent-%COMP%]{position:absolute}.width-full[_ngcontent-%COMP%]{width:100%!important}"]}),n})(),Og=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=g.Xpm({type:n,selectors:[["cms-manager"]],decls:3,vars:0,consts:[["nz-row","",1,"my-4"],["nz-col","","nzXs","24","nzSm","24","nzMd","24","nzLg","24","nzXl","24"]],template:function(i,u){1&i&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g._UZ(2,"cms-map"),g.qZA(),g.qZA())},directives:[O.SK,O.t3,Mg],styles:[""]}),n})();const Lg=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=g.Xpm({type:n,selectors:[["cms-dashboard"]],decls:2,vars:0,consts:[[1,"dashboard-wrapper"]],template:function(i,u){1&i&&(g.TgZ(0,"div",0),g._UZ(1,"cms-manager"),g.qZA())},directives:[Og],styles:["[_nghost-%COMP%]     .date-select-charts{min-width:160px}"]}),n})()}];let kg=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[[c.Bz.forChild(Lg)],c.Bz]}),n})();var Rg=y(57674),Dg=y(83385),Bg=y(43654),Fg=y(52079),Ng=y(94401),zg=y(49703),Zg=y(87966),Ug=y(26214),jg=y(39242),Vg=y(13791);let Gg=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=g.oAB({type:n}),n.\u0275inj=g.cJS({imports:[[_.ez,kg,Xv.sL,Qv.PV,O.Jb,Rg.o7,Kv.ZJ,Wv.vh,Dg.S,Bg.HQ,Fg.Wr,Ng.b1,zg.Gb,Nd.LV,Zg.Hb,Fd.JF,zd.u5,Ug.Qp,jg.VchartsModule,qv.A2,Jv.mS,Vg.zf,$v.$6,em.X,Yv.j]]}),n})()},88774:(ie,L,y)=>{ie.exports=y(67941)},70576:(ie,L,y)=>{"use strict";y.d(L,{zL:()=>O,DL:()=>tt,Ht:()=>Ue});var M=6371008.8,_={centimeters:100*M,centimetres:100*M,degrees:M/111325,feet:3.28084*M,inches:39.37*M,kilometers:M/1e3,kilometres:M/1e3,meters:M,metres:M,miles:M/1609.344,millimeters:1e3*M,millimetres:1e3*M,nauticalmiles:M/1852,radians:1,yards:1.0936*M};function O(ge,de,oe){void 0===oe&&(oe={});var me={type:"Feature"};return(0===oe.id||oe.id)&&(me.id=oe.id),oe.bbox&&(me.bbox=oe.bbox),me.properties=de||{},me.geometry=ge,me}function tt(ge,de){void 0===de&&(de="kilometers");var oe=_[de];if(!oe)throw new Error(de+" units is invalid");return ge*oe}function Ue(ge){return ge%360*Math.PI/180}},56326:(ie,L,y)=>{"use strict";function M(_,c,g,O,R){var B={};return Object.keys(O).forEach(function(H){B[H]=O[H]}),B.enumerable=!!B.enumerable,B.configurable=!!B.configurable,("value"in B||B.initializer)&&(B.writable=!0),B=g.slice().reverse().reduce(function(H,G){return G(_,c,H)||H},B),R&&void 0!==B.initializer&&(B.value=B.initializer?B.initializer.call(R):void 0,B.initializer=void 0),void 0===B.initializer&&(Object.defineProperty(_,c,B),B=null),B}y.d(L,{Z:()=>M})},32988:(ie,L,y)=>{"use strict";function M(_,c){(null==c||c>_.length)&&(c=_.length);for(var g=0,O=new Array(c);g<c;g++)O[g]=_[g];return O}y.d(L,{Z:()=>M})},66518:(ie,L,y)=>{"use strict";function M(_){if(void 0===_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _}y.d(L,{Z:()=>M})},75134:(ie,L,y)=>{"use strict";function M(_,c){if(!(_ instanceof c))throw new TypeError("Cannot call a class as a function")}y.d(L,{Z:()=>M})},47289:(ie,L,y)=>{"use strict";function M(c,g){for(var O=0;O<g.length;O++){var R=g[O];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(c,R.key,R)}}function _(c,g,O){return g&&M(c.prototype,g),O&&M(c,O),c}y.d(L,{Z:()=>_})},93512:(ie,L,y)=>{"use strict";function M(_,c,g){return c in _?Object.defineProperty(_,c,{value:g,enumerable:!0,configurable:!0,writable:!0}):_[c]=g,_}y.d(L,{Z:()=>M})},99187:(ie,L,y)=>{"use strict";function M(_){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(g){return g.__proto__||Object.getPrototypeOf(g)})(_)}y.d(L,{Z:()=>M})},41885:(ie,L,y)=>{"use strict";y.d(L,{Z:()=>_});var M=y(92007);function _(c,g){if("function"!=typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(g&&g.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),g&&(0,M.Z)(c,g)}},32952:(ie,L,y)=>{"use strict";function M(_,c,g,O){!g||Object.defineProperty(_,c,{enumerable:g.enumerable,configurable:g.configurable,writable:g.writable,value:g.initializer?g.initializer.call(O):void 0})}y.d(L,{Z:()=>M})},71189:(ie,L,y)=>{"use strict";function _(c,g){if(null==c)return{};var R,B,O=function(c,g){if(null==c)return{};var B,H,O={},R=Object.keys(c);for(H=0;H<R.length;H++)!(g.indexOf(B=R[H])>=0)&&(O[B]=c[B]);return O}(c,g);if(Object.getOwnPropertySymbols){var H=Object.getOwnPropertySymbols(c);for(B=0;B<H.length;B++)!(g.indexOf(R=H[B])>=0)&&(!Object.prototype.propertyIsEnumerable.call(c,R)||(O[R]=c[R]))}return O}y.d(L,{Z:()=>_})},59553:(ie,L,y)=>{"use strict";y.d(L,{Z:()=>c});var M=y(85464),_=y(66518);function c(g,O){return!O||"object"!==(0,M.Z)(O)&&"function"!=typeof O?(0,_.Z)(g):O}},92007:(ie,L,y)=>{"use strict";function M(_,c){return(M=Object.setPrototypeOf||function(O,R){return O.__proto__=R,O})(_,c)}y.d(L,{Z:()=>M})},83838:(ie,L,y)=>{"use strict";y.d(L,{Z:()=>O});var c=y(2491);function O(R,B){return function(R){if(Array.isArray(R))return R}(R)||function(R,B){var H=null==R?null:"undefined"!=typeof Symbol&&R[Symbol.iterator]||R["@@iterator"];if(null!=H){var j,W,G=[],be=!0,Be=!1;try{for(H=H.call(R);!(be=(j=H.next()).done)&&(G.push(j.value),!B||G.length!==B);be=!0);}catch(Ke){Be=!0,W=Ke}finally{try{!be&&null!=H.return&&H.return()}finally{if(Be)throw W}}return G}}(R,B)||(0,c.Z)(R,B)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},96109:(ie,L,y)=>{"use strict";y.d(L,{Z:()=>R});var M=y(32988),g=y(2491);function R(B){return function(B){if(Array.isArray(B))return(0,M.Z)(B)}(B)||function(B){if("undefined"!=typeof Symbol&&null!=B[Symbol.iterator]||null!=B["@@iterator"])return Array.from(B)}(B)||(0,g.Z)(B)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},85464:(ie,L,y)=>{"use strict";function M(_){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(g){return typeof g}:function(g){return g&&"function"==typeof Symbol&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(_)}y.d(L,{Z:()=>M})},2491:(ie,L,y)=>{"use strict";y.d(L,{Z:()=>_});var M=y(32988);function _(c,g){if(c){if("string"==typeof c)return(0,M.Z)(c,g);var O=Object.prototype.toString.call(c).slice(8,-1);if("Object"===O&&c.constructor&&(O=c.constructor.name),"Map"===O||"Set"===O)return Array.from(c);if("Arguments"===O||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(O))return(0,M.Z)(c,g)}}}}]);