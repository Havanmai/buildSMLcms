(self.webpackChunksmartlocker_workspace=self.webpackChunksmartlocker_workspace||[]).push([[73],{97185:(dr,H,M)=>{"use strict";function p(Pr,wt){var Ie="function"==typeof Symbol&&Pr[Symbol.iterator];if(!Ie)return Pr;var nt,Wt,we=Ie.call(Pr),Le=[];try{for(;(void 0===wt||wt-- >0)&&!(nt=we.next()).done;)Le.push(nt.value)}catch(Ar){Wt={error:Ar}}finally{try{nt&&!nt.done&&(Ie=we.return)&&Ie.call(we)}finally{if(Wt)throw Wt.error}}return Le}function W(Pr){return Pr&&Pr.__esModule&&Object.prototype.hasOwnProperty.call(Pr,"default")?Pr.default:Pr}function X(Pr,wt){return Pr(wt={exports:{}},wt.exports),wt.exports}M.d(H,{zj:()=>ze,oI:()=>fn,ni:()=>ve,gg:()=>Ur});var q=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(we){return we&&"number"==typeof we.length&&we.length>=0&&we.length%1==0},Pr.exports=wt.default});W(q);var te=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(Ie){return function(){for(var we=[],nt=arguments.length;nt--;)we[nt]=arguments[nt];var Le=we.pop();return Ie.call(this,we,Le)}},Pr.exports=wt.default});W(te);var Y=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.fallback=nt,wt.wrap=Le;var Wt,Ie=wt.hasSetImmediate="function"==typeof setImmediate&&setImmediate,we=wt.hasNextTick="object"==typeof process&&"function"==typeof process.nextTick;function nt(Ar){setTimeout(Ar,0)}function Le(Ar){return function(Yt){for(var cr=[],Fr=arguments.length-1;Fr-- >0;)cr[Fr]=arguments[Fr+1];return Ar(function(){return Yt.apply(void 0,cr)})}}Wt=Ie?setImmediate:we?process.nextTick:nt,wt.default=Le(Wt)});W(Y);var tt=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(Yt){return(0,Mt.isAsync)(Yt)?function(){for(var cr=[],Fr=arguments.length;Fr--;)cr[Fr]=arguments[Fr];var Zn=cr.pop(),T=Yt.apply(this,cr);return Wt(T,Zn)}:(0,Ie.default)(function(cr,Fr){var Zn;try{Zn=Yt.apply(this,cr)}catch(T){return Fr(T)}if(Zn&&"function"==typeof Zn.then)return Wt(Zn,Fr);Fr(null,Zn)})};var Ie=nt(te),we=nt(Y);function nt(Yt){return Yt&&Yt.__esModule?Yt:{default:Yt}}function Wt(Yt,cr){return Yt.then(function(Fr){Ar(cr,null,Fr)},function(Fr){Ar(cr,Fr&&Fr.message?Fr:new Error(Fr))})}function Ar(Yt,cr,Fr){try{Yt(cr,Fr)}catch(Zn){(0,we.default)(function(T){throw T},Zn)}}Pr.exports=wt.default});W(tt);var Mt=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.isAsyncIterable=wt.isAsyncGenerator=wt.isAsync=void 0;var Yt,Ie=(Yt=tt)&&Yt.__esModule?Yt:{default:Yt};function nt(Yt){return"AsyncFunction"===Yt[Symbol.toStringTag]}wt.default=function(Yt){if("function"!=typeof Yt)throw new Error("expected a function");return nt(Yt)?(0,Ie.default)(Yt):Yt},wt.isAsync=nt,wt.isAsyncGenerator=function(Yt){return"AsyncGenerator"===Yt[Symbol.toStringTag]},wt.isAsyncIterable=function(Yt){return"function"==typeof Yt[Symbol.asyncIterator]}});W(Mt);var Et=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(we,nt){if(void 0===nt&&(nt=we.length),!nt)throw new Error("arity is undefined");function Le(){for(var Wt=this,Ar=[],Yt=arguments.length;Yt--;)Ar[Yt]=arguments[Yt];return"function"==typeof Ar[nt-1]?we.apply(this,Ar):new Promise(function(cr,Fr){Ar[nt-1]=function(Zn){for(var T=[],G=arguments.length-1;G-- >0;)T[G]=arguments[G+1];if(Zn)return Fr(Zn);cr(T.length>1?T:T[0])},we.apply(Wt,Ar)})}return Object.defineProperty(Le,"name",{configurable:!0,value:"awaitable("+we.name+")"}),Le},Pr.exports=wt.default});W(Et);var vr=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0});var Ie=Le(q),we=Le(Mt),nt=Le(Et);function Le(Wt){return Wt&&Wt.__esModule?Wt:{default:Wt}}wt.default=(0,nt.default)(function(Wt,Ar,Yt){var cr=(0,Ie.default)(Ar)?[]:{};Wt(Ar,function(Fr,Zn,T){(0,we.default)(Fr)(function(G){for(var rt=[],dt=arguments.length-1;dt-- >0;)rt[dt]=arguments[dt+1];rt.length<2&&(rt=rt[0]),cr[Zn]=rt,T(G)})},function(Fr){return Yt(Fr,cr)})},3),Pr.exports=wt.default});W(vr);var ne=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(we){function nt(){for(var Le=[],Wt=arguments.length;Wt--;)Le[Wt]=arguments[Wt];if(null!==we){var Ar=we;we=null,Ar.apply(this,Le)}}return Object.assign(nt,we),nt},Pr.exports=wt.default});W(ne);var nr=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(Ie){return Ie[Symbol.iterator]&&Ie[Symbol.iterator]()},Pr.exports=wt.default});W(nr);var Tt=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(cr){if((0,Ie.default)(cr))return function(cr){var Fr=-1,Zn=cr.length;return function(){return++Fr<Zn?{value:cr[Fr],key:Fr}:null}}(cr);var Fr=(0,we.default)(cr);return Fr?function(cr){var Fr=-1;return function(){var T=cr.next();return T.done?null:(Fr++,{value:T.value,key:Fr})}}(Fr):function(cr){var Fr=cr?Object.keys(cr):[],Zn=-1,T=Fr.length;return function(){var Ve=Fr[++Zn];return Zn<T?{value:cr[Ve],key:Ve}:null}}(cr)};var Ie=nt(q),we=nt(nr);function nt(cr){return cr&&cr.__esModule?cr:{default:cr}}Pr.exports=wt.default});W(Tt);var $e=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(we){return function(){for(var nt=[],Le=arguments.length;Le--;)nt[Le]=arguments[Le];if(null===we)throw new Error("Callback was already called.");var Wt=we;we=null,Wt.apply(this,nt)}},Pr.exports=wt.default});W($e);var Ct=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default={},Pr.exports=wt.default});W(Ct);var qe=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(Le,Wt,Ar,Yt){var cr=!1,Fr=!1,Zn=!1,T=0,G=0;function Ve(){T>=Wt||Zn||cr||(Zn=!0,Le.next().then(function(Ot){var B=Ot.value;if(!Fr&&!cr){if(Zn=!1,Ot.done)return cr=!0,void(T<=0&&Yt(null));T++,Ar(B,G,rt),G++,Ve()}}).catch(dt))}function rt(Ot,B){if(T-=1,!Fr){if(Ot)return dt(Ot);if(!1===Ot)return cr=!0,void(Fr=!0);if(B===Ie.default||cr&&T<=0)return cr=!0,Yt(null);Ve()}}function dt(Ot){Fr||(Zn=!1,cr=!0,Yt(Ot))}Ve()};var Le,Ie=(Le=Ct)&&Le.__esModule?Le:{default:Le};Pr.exports=wt.default});W(qe);var Dt=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0});var Ie=Ar(ne),we=Ar(Tt),nt=Ar($e),Le=Ar(qe),Wt=Ar(Ct);function Ar(Yt){return Yt&&Yt.__esModule?Yt:{default:Yt}}wt.default=function(Yt){return function(cr,Fr,Zn){if(Zn=(0,Ie.default)(Zn),Yt<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!cr)return Zn(null);if((0,Mt.isAsyncGenerator)(cr))return(0,Le.default)(cr,Yt,Fr,Zn);if((0,Mt.isAsyncIterable)(cr))return(0,Le.default)(cr[Symbol.asyncIterator](),Yt,Fr,Zn);var T=(0,we.default)(cr),G=!1,Ve=!1,rt=0,dt=!1;function Ot(Ue,_t){if(!Ve)if(rt-=1,Ue)G=!0,Zn(Ue);else if(!1===Ue)G=!0,Ve=!0;else{if(_t===Wt.default||G&&rt<=0)return G=!0,Zn(null);dt||B()}}function B(){for(dt=!0;rt<Yt&&!G;){var Ue=T();if(null===Ue)return G=!0,void(rt<=0&&Zn(null));rt+=1,Fr(Ue.value,Ue.key,(0,nt.default)(Ot))}dt=!1}B()}},Pr.exports=wt.default});W(Dt);var lr=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0});var Ie=Le(Dt),we=Le(Mt),nt=Le(Et);function Le(Ar){return Ar&&Ar.__esModule?Ar:{default:Ar}}wt.default=(0,nt.default)(function(Ar,Yt,cr,Fr){return(0,Ie.default)(Yt)(Ar,(0,we.default)(cr),Fr)},4),Pr.exports=wt.default});W(lr);var hr=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0});var Ie=nt(lr),we=nt(Et);function nt(Wt){return Wt&&Wt.__esModule?Wt:{default:Wt}}wt.default=(0,we.default)(function(Wt,Ar,Yt){return(0,Ie.default)(Wt,1,Ar,Yt)},3),Pr.exports=wt.default});W(hr);var _e=W(X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(Wt,Ar){return(0,Ie.default)(we.default,Wt,Ar)};var Ie=nt(vr),we=nt(hr);function nt(Wt){return Wt&&Wt.__esModule?Wt:{default:Wt}}Pr.exports=wt.default})),ve=function(){function Pr(){for(var wt=arguments,Ie=[],we=0;we<arguments.length;we++)Ie[we]=wt[we];this.args=[],this.tasks=[]}return Pr.prototype.call=function(){for(var wt=arguments,Ie=[],we=0;we<arguments.length;we++)Ie[we]=wt[we];return this.args=Ie,_e(this.tasks)},Pr.prototype.tap=function(wt,Ie){var we=this;this.tasks.push(function(nt){Ie.apply(void 0,function(){for(var Pr=[],wt=0;wt<arguments.length;wt++)Pr=Pr.concat(p(arguments[wt]));return Pr}(we.args)),nt(null,wt)})},Pr}(),ae=X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0});var Ie=cr(q),we=cr(Ct),nt=cr(lr),Le=cr(ne),Wt=cr($e),Ar=cr(Mt),Yt=cr(Et);function cr(G){return G&&G.__esModule?G:{default:G}}function Fr(G,Ve,rt){rt=(0,Le.default)(rt);var dt=0,Ot=0,B=G.length,Ue=!1;function _t(St,Xt){!1===St&&(Ue=!0),!0!==Ue&&(St?rt(St):(++Ot===B||Xt===we.default)&&rt(null))}for(0===B&&rt(null);dt<B;dt++)Ve(G[dt],dt,(0,Wt.default)(_t))}function Zn(G,Ve,rt){return(0,nt.default)(G,1/0,Ve,rt)}wt.default=(0,Yt.default)(function(G,Ve,rt){return((0,Ie.default)(G)?Fr:Zn)(G,(0,Ar.default)(Ve),rt)},3),Pr.exports=wt.default});W(ae);var Pe=W(X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0}),wt.default=function(Wt,Ar){return(0,we.default)(Ie.default,Wt,Ar)};var Ie=nt(ae),we=nt(vr);function nt(Wt){return Wt&&Wt.__esModule?Wt:{default:Wt}}Pr.exports=wt.default})),ze=function(){function Pr(){for(var wt=arguments,Ie=[],we=0;we<arguments.length;we++)Ie[we]=wt[we];this.tasks=[]}return Pr.prototype.promise=function(){for(var wt=arguments,Ie=[],we=0;we<arguments.length;we++)Ie[we]=wt[we];return Pe(this.tasks)},Pr.prototype.tapPromise=function(wt,Ie){var we=this;this.tasks.push(function(nt){return function(Pr,wt,Ie,we){return new(Ie||(Ie=Promise))(function(Le,Wt){function Ar(Fr){try{cr(we.next(Fr))}catch(Zn){Wt(Zn)}}function Yt(Fr){try{cr(we.throw(Fr))}catch(Zn){Wt(Zn)}}function cr(Fr){Fr.done?Le(Fr.value):function(Le){return Le instanceof Ie?Le:new Ie(function(Wt){Wt(Le)})}(Fr.value).then(Ar,Yt)}cr((we=we.apply(Pr,wt||[])).next())})}(we,void 0,void 0,function(){return function(Pr,wt){var we,nt,Le,Wt,Ie={label:0,sent:function(){if(1&Le[0])throw Le[1];return Le[1]},trys:[],ops:[]};return Wt={next:Ar(0),throw:Ar(1),return:Ar(2)},"function"==typeof Symbol&&(Wt[Symbol.iterator]=function(){return this}),Wt;function Ar(cr){return function(Fr){return function(cr){if(we)throw new TypeError("Generator is already executing.");for(;Ie;)try{if(we=1,nt&&(Le=2&cr[0]?nt.return:cr[0]?nt.throw||((Le=nt.return)&&Le.call(nt),0):nt.next)&&!(Le=Le.call(nt,cr[1])).done)return Le;switch(nt=0,Le&&(cr=[2&cr[0],Le.value]),cr[0]){case 0:case 1:Le=cr;break;case 4:return Ie.label++,{value:cr[1],done:!1};case 5:Ie.label++,nt=cr[1],cr=[0];continue;case 7:cr=Ie.ops.pop(),Ie.trys.pop();continue;default:if(!(Le=(Le=Ie.trys).length>0&&Le[Le.length-1])&&(6===cr[0]||2===cr[0])){Ie=0;continue}if(3===cr[0]&&(!Le||cr[1]>Le[0]&&cr[1]<Le[3])){Ie.label=cr[1];break}if(6===cr[0]&&Ie.label<Le[1]){Ie.label=Le[1],Le=cr;break}if(Le&&Ie.label<Le[2]){Ie.label=Le[2],Ie.ops.push(cr);break}Le[2]&&Ie.ops.pop(),Ie.trys.pop();continue}cr=wt.call(Pr,Ie)}catch(Fr){cr=[6,Fr],nt=0}finally{we=Le=0}if(5&cr[0])throw cr[1];return{value:cr[0]?cr[1]:void 0,done:!0}}([cr,Fr])}}}(this,function(Le){switch(Le.label){case 0:return[4,Ie()];case 1:return Le.sent(),nt(null,wt),[2]}})})})},Pr}(),br=W(X(function(Pr,wt){Object.defineProperty(wt,"__esModule",{value:!0});var Ie=Wt(ne),we=Wt($e),nt=Wt(Mt),Le=Wt(Et);function Wt(Yt){return Yt&&Yt.__esModule?Yt:{default:Yt}}wt.default=(0,Le.default)(function(Yt,cr){if(cr=(0,Ie.default)(cr),!Array.isArray(Yt))return cr(new Error("First argument to waterfall must be an array of functions"));if(!Yt.length)return cr();var Fr=0;function Zn(G){(0,nt.default)(Yt[Fr++]).apply(void 0,G.concat([(0,we.default)(T)]))}function T(G){for(var Ve=[],rt=arguments.length-1;rt-- >0;)Ve[rt]=arguments[rt+1];if(!1!==G){if(G||Fr===Yt.length)return cr.apply(void 0,[G].concat(Ve));Zn(Ve)}}Zn([])}),Pr.exports=wt.default})),Ur=function(){function Pr(){for(var wt=arguments,Ie=[],we=0;we<arguments.length;we++)Ie[we]=wt[we];this.tasks=[]}return Pr.prototype.call=function(){for(var wt=arguments,Ie=[],we=0;we<arguments.length;we++)Ie[we]=wt[we];return br(this.tasks)},Pr.prototype.tap=function(wt,Ie){this.tasks.push(0===this.tasks.length?function(we){var nt=Ie();we(!!nt&&null,nt)}:function(we,nt){nt(!!Ie()&&null,wt)})},Pr}(),fn=function(){function Pr(){for(var wt=arguments,Ie=[],we=0;we<arguments.length;we++)Ie[we]=wt[we];this.tasks=[]}return Pr.prototype.call=function(){for(var wt=arguments,Ie=[],we=0;we<arguments.length;we++)Ie[we]=wt[we];return _e(this.tasks)},Pr.prototype.tap=function(wt,Ie){this.tasks.push(function(we){we(Ie(),wt)})},Pr}()},42837:(dr,H,M)=>{"use strict";M.d(H,{nC:()=>ue.ZP,Hp:()=>ue.Hp,e7:()=>ue.e7,yT:()=>ue.yT,vK:()=>p.v,BlendType:()=>W.h,AttributeType:()=>X.GC,ScaleTypes:()=>X.vY,StyleScaleType:()=>X.ee,MapServiceEvent:()=>Y.I,CoordinateSystem:()=>Xe.l,CoordinateUniform:()=>Xe.k,CameraUniform:()=>Z.l,SceneEventList:()=>sr.P,PositionType:()=>Tt.d,gl:()=>Ar.gl});var ue=M(54184),p=(M(20051),M(92444)),W=(M(10120),M(35781)),X=M(39727),q=M(33511);M.o(q,"CameraUniform")&&M.d(H,{CameraUniform:function(){return q.CameraUniform}}),M.o(q,"CoordinateSystem")&&M.d(H,{CoordinateSystem:function(){return q.CoordinateSystem}}),M.o(q,"CoordinateUniform")&&M.d(H,{CoordinateUniform:function(){return q.CoordinateUniform}}),M.o(q,"Layers")&&M.d(H,{Layers:function(){return q.Layers}}),M.o(q,"MapServiceEvent")&&M.d(H,{MapServiceEvent:function(){return q.MapServiceEvent}}),M.o(q,"PointLayer")&&M.d(H,{PointLayer:function(){return q.PointLayer}}),M.o(q,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return q.PolygonLayer}}),M.o(q,"PositionType")&&M.d(H,{PositionType:function(){return q.PositionType}}),M.o(q,"Scene")&&M.d(H,{Scene:function(){return q.Scene}}),M.o(q,"SceneEventList")&&M.d(H,{SceneEventList:function(){return q.SceneEventList}}),M.o(q,"gl")&&M.d(H,{gl:function(){return q.gl}});var Y=M(53262),Xe=M(62306),et=M(75541);M.o(et,"CameraUniform")&&M.d(H,{CameraUniform:function(){return et.CameraUniform}}),M.o(et,"Layers")&&M.d(H,{Layers:function(){return et.Layers}}),M.o(et,"PointLayer")&&M.d(H,{PointLayer:function(){return et.PointLayer}}),M.o(et,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return et.PolygonLayer}}),M.o(et,"PositionType")&&M.d(H,{PositionType:function(){return et.PositionType}}),M.o(et,"Scene")&&M.d(H,{Scene:function(){return et.Scene}}),M.o(et,"SceneEventList")&&M.d(H,{SceneEventList:function(){return et.SceneEventList}}),M.o(et,"gl")&&M.d(H,{gl:function(){return et.gl}});var Z=M(40646),tt=M(24495);M.o(tt,"Layers")&&M.d(H,{Layers:function(){return tt.Layers}}),M.o(tt,"PointLayer")&&M.d(H,{PointLayer:function(){return tt.PointLayer}}),M.o(tt,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return tt.PolygonLayer}}),M.o(tt,"PositionType")&&M.d(H,{PositionType:function(){return tt.PositionType}}),M.o(tt,"Scene")&&M.d(H,{Scene:function(){return tt.Scene}}),M.o(tt,"SceneEventList")&&M.d(H,{SceneEventList:function(){return tt.SceneEventList}}),M.o(tt,"gl")&&M.d(H,{gl:function(){return tt.gl}});var sr=M(80533),Ut=M(63877);M.o(Ut,"Layers")&&M.d(H,{Layers:function(){return Ut.Layers}}),M.o(Ut,"PointLayer")&&M.d(H,{PointLayer:function(){return Ut.PointLayer}}),M.o(Ut,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return Ut.PolygonLayer}}),M.o(Ut,"PositionType")&&M.d(H,{PositionType:function(){return Ut.PositionType}}),M.o(Ut,"Scene")&&M.d(H,{Scene:function(){return Ut.Scene}}),M.o(Ut,"gl")&&M.d(H,{gl:function(){return Ut.gl}});var Et=M(21236);M.o(Et,"Layers")&&M.d(H,{Layers:function(){return Et.Layers}}),M.o(Et,"PointLayer")&&M.d(H,{PointLayer:function(){return Et.PointLayer}}),M.o(Et,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return Et.PolygonLayer}}),M.o(Et,"PositionType")&&M.d(H,{PositionType:function(){return Et.PositionType}}),M.o(Et,"Scene")&&M.d(H,{Scene:function(){return Et.Scene}}),M.o(Et,"gl")&&M.d(H,{gl:function(){return Et.gl}});var ne=M(22115);M.o(ne,"Layers")&&M.d(H,{Layers:function(){return ne.Layers}}),M.o(ne,"PointLayer")&&M.d(H,{PointLayer:function(){return ne.PointLayer}}),M.o(ne,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return ne.PolygonLayer}}),M.o(ne,"PositionType")&&M.d(H,{PositionType:function(){return ne.PositionType}}),M.o(ne,"Scene")&&M.d(H,{Scene:function(){return ne.Scene}}),M.o(ne,"gl")&&M.d(H,{gl:function(){return ne.gl}});var Tt=M(59304),$e=M(35323);M.o($e,"Layers")&&M.d(H,{Layers:function(){return $e.Layers}}),M.o($e,"PointLayer")&&M.d(H,{PointLayer:function(){return $e.PointLayer}}),M.o($e,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return $e.PolygonLayer}}),M.o($e,"Scene")&&M.d(H,{Scene:function(){return $e.Scene}}),M.o($e,"gl")&&M.d(H,{gl:function(){return $e.gl}});var qe=M(35393);M.o(qe,"Layers")&&M.d(H,{Layers:function(){return qe.Layers}}),M.o(qe,"PointLayer")&&M.d(H,{PointLayer:function(){return qe.PointLayer}}),M.o(qe,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return qe.PolygonLayer}}),M.o(qe,"Scene")&&M.d(H,{Scene:function(){return qe.Scene}}),M.o(qe,"gl")&&M.d(H,{gl:function(){return qe.gl}}),M(12260);var hr=M(25655);M.o(hr,"Layers")&&M.d(H,{Layers:function(){return hr.Layers}}),M.o(hr,"PointLayer")&&M.d(H,{PointLayer:function(){return hr.PointLayer}}),M.o(hr,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return hr.PolygonLayer}}),M.o(hr,"Scene")&&M.d(H,{Scene:function(){return hr.Scene}}),M.o(hr,"gl")&&M.d(H,{gl:function(){return hr.gl}});var _e=M(94671);M.o(_e,"Layers")&&M.d(H,{Layers:function(){return _e.Layers}}),M.o(_e,"PointLayer")&&M.d(H,{PointLayer:function(){return _e.PointLayer}}),M.o(_e,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return _e.PolygonLayer}}),M.o(_e,"Scene")&&M.d(H,{Scene:function(){return _e.Scene}}),M.o(_e,"gl")&&M.d(H,{gl:function(){return _e.gl}});var ae=M(75846);M.o(ae,"Layers")&&M.d(H,{Layers:function(){return ae.Layers}}),M.o(ae,"PointLayer")&&M.d(H,{PointLayer:function(){return ae.PointLayer}}),M.o(ae,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return ae.PolygonLayer}}),M.o(ae,"Scene")&&M.d(H,{Scene:function(){return ae.Scene}}),M.o(ae,"gl")&&M.d(H,{gl:function(){return ae.gl}});var Pe=M(81210);M.o(Pe,"Layers")&&M.d(H,{Layers:function(){return Pe.Layers}}),M.o(Pe,"PointLayer")&&M.d(H,{PointLayer:function(){return Pe.PointLayer}}),M.o(Pe,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return Pe.PolygonLayer}}),M.o(Pe,"Scene")&&M.d(H,{Scene:function(){return Pe.Scene}}),M.o(Pe,"gl")&&M.d(H,{gl:function(){return Pe.gl}});var pt=M(20626);M.o(pt,"Layers")&&M.d(H,{Layers:function(){return pt.Layers}}),M.o(pt,"PointLayer")&&M.d(H,{PointLayer:function(){return pt.PointLayer}}),M.o(pt,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return pt.PolygonLayer}}),M.o(pt,"Scene")&&M.d(H,{Scene:function(){return pt.Scene}}),M.o(pt,"gl")&&M.d(H,{gl:function(){return pt.gl}});var Ur=M(6974);M.o(Ur,"Layers")&&M.d(H,{Layers:function(){return Ur.Layers}}),M.o(Ur,"PointLayer")&&M.d(H,{PointLayer:function(){return Ur.PointLayer}}),M.o(Ur,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return Ur.PolygonLayer}}),M.o(Ur,"Scene")&&M.d(H,{Scene:function(){return Ur.Scene}}),M.o(Ur,"gl")&&M.d(H,{gl:function(){return Ur.gl}}),M(55576);var wt=M(23824);M.o(wt,"Layers")&&M.d(H,{Layers:function(){return wt.Layers}}),M.o(wt,"PointLayer")&&M.d(H,{PointLayer:function(){return wt.PointLayer}}),M.o(wt,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return wt.PolygonLayer}}),M.o(wt,"Scene")&&M.d(H,{Scene:function(){return wt.Scene}}),M.o(wt,"gl")&&M.d(H,{gl:function(){return wt.gl}});var we=M(34710);M.o(we,"Layers")&&M.d(H,{Layers:function(){return we.Layers}}),M.o(we,"PointLayer")&&M.d(H,{PointLayer:function(){return we.PointLayer}}),M.o(we,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return we.PolygonLayer}}),M.o(we,"Scene")&&M.d(H,{Scene:function(){return we.Scene}}),M.o(we,"gl")&&M.d(H,{gl:function(){return we.gl}});var Le=M(27159);M.o(Le,"Layers")&&M.d(H,{Layers:function(){return Le.Layers}}),M.o(Le,"PointLayer")&&M.d(H,{PointLayer:function(){return Le.PointLayer}}),M.o(Le,"PolygonLayer")&&M.d(H,{PolygonLayer:function(){return Le.PolygonLayer}}),M.o(Le,"Scene")&&M.d(H,{Scene:function(){return Le.Scene}}),M.o(Le,"gl")&&M.d(H,{gl:function(){return Le.gl}});var Ar=M(24558)},54184:(dr,H,M)=>{"use strict";M.d(H,{e7:()=>Ni,Hp:()=>yi,ZP:()=>Vi,yT:()=>kn}),M(78320);var $e,w=M(42624),p=M.n(w),_=M(15922),W=M(43857),X=M(92444),q=M(75134),te=M(47289),Y=M(93512),Xe=M(30832),et=M(51002),z=M.n(et);function Z($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function tt($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?Z(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):Z(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}function Mt($,ee){var L="undefined"!=typeof Symbol&&$[Symbol.iterator]||$["@@iterator"];if(!L){if(Array.isArray($)||(L=function($,ee){if($){if("string"==typeof $)return Ut($,undefined);var L=Object.prototype.toString.call($).slice(8,-1);if("Object"===L&&$.constructor&&(L=$.constructor.name),"Map"===L||"Set"===L)return Array.from($);if("Arguments"===L||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L))return Ut($,undefined)}}($))||ee&&$&&"number"==typeof $.length){L&&($=L);var D=0,fe=function(){};return{s:fe,n:function(){return D>=$.length?{done:!0}:{done:!1,value:$[D++]}},e:function(rr){throw rr},f:fe}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Pt,Se=!0,ct=!1;return{s:function(){L=L.call($)},n:function(){var rr=L.next();return Se=rr.done,rr},e:function(rr){ct=!0,Pt=rr},f:function(){try{!Se&&null!=L.return&&L.return()}finally{if(ct)throw Pt}}}}function Ut($,ee){(null==ee||ee>$.length)&&(ee=$.length);for(var L=0,D=new Array(ee);L<ee;L++)D[L]=$[L];return D}function ne($,ee,L){var fe,D=Mt(ee);try{for(D.s();!(fe=D.n()).done;){var Se=fe.value,ct=Se.icon,Pt=Se.xOffset;$[ct.id]=tt(tt({},ct),{},{x:Pt,y:L,image:ct.image,width:ct.width,height:ct.height})}}catch(bt){D.e(bt)}finally{D.f()}}function nr($){return Math.pow(2,Math.ceil(Math.log2($)))}function Ct($,ee){var L="undefined"!=typeof Symbol&&$[Symbol.iterator]||$["@@iterator"];if(!L){if(Array.isArray($)||(L=function($,ee){if($){if("string"==typeof $)return Dt($,undefined);var L=Object.prototype.toString.call($).slice(8,-1);if("Object"===L&&$.constructor&&(L=$.constructor.name),"Map"===L||"Set"===L)return Array.from($);if("Arguments"===L||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L))return Dt($,undefined)}}($))||ee&&$&&"number"==typeof $.length){L&&($=L);var D=0,fe=function(){};return{s:fe,n:function(){return D>=$.length?{done:!0}:{done:!1,value:$[D++]}},e:function(rr){throw rr},f:fe}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Pt,Se=!0,ct=!1;return{s:function(){L=L.call($)},n:function(){var rr=L.next();return Se=rr.done,rr},e:function(rr){ct=!0,Pt=rr},f:function(){try{!Se&&null!=L.return&&L.return()}finally{if(ct)throw Pt}}}}function Dt($,ee){(null==ee||ee>$.length)&&(ee=$.length);for(var L=0,D=new Array(ee);L<ee;L++)D[L]=$[L];return D}function lr($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function hr($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?lr(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):lr(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var Dr=function(){for(var $=[],ee=32;ee<128;ee++)$.push(String.fromCharCode(ee));return $}();function Ie($,ee,L,D){$.font="".concat(D," ").concat(L,"px ").concat(ee),$.fillStyle="black",$.textBaseline="middle"}function we($,ee){for(var L=0;L<$.length;L++)ee.data[4*L+3]=$[L]}var Fr,nt=(0,_.b2)()($e=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"fontAtlas",void 0),(0,Y.Z)(this,"iconFontMap",void 0),(0,Y.Z)(this,"iconFontGlyphs",{}),(0,Y.Z)(this,"fontOptions",void 0),(0,Y.Z)(this,"key",void 0),(0,Y.Z)(this,"cache",new Xe.z6(3))}return(0,te.Z)($,[{key:"scale",get:function(){return 1}},{key:"canvas",get:function(){var L=this.cache.get(this.key);return L&&L.data}},{key:"mapping",get:function(){var L=this.cache.get(this.key);return L&&L.mapping}},{key:"init",value:function(){this.cache.clear(),this.fontOptions={fontFamily:"sans-serif",fontWeight:"normal",characterSet:Dr,fontSize:24,buffer:3,sdf:!0,cutoff:.25,radius:8,iconfont:!1},this.key="",this.iconFontMap=new Map}},{key:"addIconGlyphs",value:function(L){var D=this;L.forEach(function(fe){D.iconFontGlyphs[fe.name]=fe.unicode})}},{key:"addIconFont",value:function(L,D){this.iconFontMap.set(L,D)}},{key:"getIconFontKey",value:function(L){return this.iconFontMap.get(L)||L}},{key:"getGlyph",value:function(L){return this.iconFontGlyphs[L]?String.fromCharCode(parseInt(this.iconFontGlyphs[L],16)):""}},{key:"setFontOptions",value:function(L){this.fontOptions=hr(hr({},this.fontOptions),L),this.key=this.getKey();var D=this.getNewChars(this.key,this.fontOptions.characterSet),fe=this.cache.get(this.key);if(!fe||0!==D.length){var Se=this.generateFontAtlas(this.key,D,fe);this.fontAtlas=Se,this.cache.set(this.key,Se)}}},{key:"destroy",value:function(){this.cache.clear(),this.iconFontMap.clear()}},{key:"generateFontAtlas",value:function(L,D,fe){var Se=this.fontOptions,ct=Se.fontFamily,Pt=Se.fontWeight,bt=Se.fontSize,rr=Se.buffer,jr=Se.sdf,Mn=Se.radius,Xn=Se.cutoff,ni=Se.iconfont,Ci=fe&&fe.data;Ci||((Ci=document.createElement("canvas")).width=1024);var wi=Ci.getContext("2d");Ie(wi,ct,bt,Pt);var ea=function($){var L=$.getFontWidth,D=$.fontHeight,fe=$.buffer,Se=$.maxCanvasWidth,ct=$.mapping,Pt=void 0===ct?{}:ct,bt=$.xOffset,jr=$.yOffset,Mn=void 0===jr?0:jr,Xn=0,ni=void 0===bt?0:bt;Array.from($.characterSet).forEach(function(wi,ea){if(!Pt[wi]){var xa=L(wi,ea);ni+30>Se&&(ni=0,Xn++),Pt[wi]={x:ni,y:Mn+30*Xn,width:30,height:30,advance:xa},ni+=30}});var Ci=D+2*fe;return{mapping:Pt,xOffset:ni,yOffset:Mn+Xn*Ci,canvasHeight:nr(Mn+(Xn+1)*Ci)}}(hr({getFontWidth:function(wu){return wi.measureText(wu).width},fontHeight:1*bt,buffer:rr,characterSet:D,maxCanvasWidth:1024},fe&&{mapping:fe.mapping,xOffset:fe.xOffset,yOffset:fe.yOffset})),xa=ea.mapping,ua=ea.canvasHeight,Ha=ea.xOffset,Wa=ea.yOffset,Ka=wi.getImageData(0,0,Ci.width,Ci.height);if(Ci.height=ua,wi.putImageData(Ka,0,0),Ie(wi,ct,bt,Pt),jr){var no,ia=new(z())(bt,rr,Mn,Xn,ct,Pt),ga=wi.getImageData(0,0,ia.size,ia.size),la=Ct(D);try{for(la.s();!(no=la.n()).done;){var Li=no.value;if(ni){var Ca=String.fromCharCode(parseInt(Li.replace("&#x","").replace(";",""),16));we(ia.draw(Ca),ga)}else we(ia.draw(Li),ga);wi.putImageData(ga,xa[Li].x,xa[Li].y)}}catch(Ko){la.e(Ko)}finally{la.f()}}else{var Yl,go=Ct(D);try{for(go.s();!(Yl=go.n()).done;){var uu=Yl.value;wi.fillText(uu,xa[uu].x,xa[uu].y+1*bt)}}catch(Ko){go.e(Ko)}finally{go.f()}}return{xOffset:Ha,yOffset:Wa,mapping:xa,data:Ci,width:Ci.width,height:Ci.height}}},{key:"getKey",value:function(){return"key"}},{key:"getNewChars",value:function(L,D){var fe=this.cache.get(L);if(!fe)return D;var Se=[],Pt=new Set(Object.keys(fe.mapping));return new Set(D).forEach(function(rr){Pt.has(rr)||Se.push(rr)}),Se}}]),$}())||$e,Le=M(66518),Wt=M(41885),Ar=M(59553),Yt=M(99187);var _t,Cr,dt=(0,_.b2)()(Fr=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){var D;(0,q.Z)(this,L);for(var fe=arguments.length,Se=new Array(fe),ct=0;ct<fe;ct++)Se[ct]=arguments[ct];return D=ee.call.apply(ee,[this].concat(Se)),(0,Y.Z)((0,Le.Z)(D),"canvasHeight",128),(0,Y.Z)((0,Le.Z)(D),"texture",void 0),(0,Y.Z)((0,Le.Z)(D),"canvas",void 0),(0,Y.Z)((0,Le.Z)(D),"iconData",void 0),(0,Y.Z)((0,Le.Z)(D),"iconMap",void 0),(0,Y.Z)((0,Le.Z)(D),"ctx",void 0),(0,Y.Z)((0,Le.Z)(D),"loadingImageCount",0),D}return(0,te.Z)(L,[{key:"isLoading",value:function(){return 0===this.loadingImageCount}},{key:"init",value:function(){this.iconData=[],this.iconMap={},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d")}},{key:"addImage",value:function(fe,Se){var ct=this,Pt=new Image;if(this.loadingImageCount++,this.hasImage(fe))throw new Error("Image Id already exists");this.iconData.push({id:fe,size:64}),this.updateIconMap(),this.loadImage(Se).then(function(bt){Pt=bt;var rr=ct.iconData.find(function(jr){return jr.id===fe});rr&&(rr.image=Pt,rr.width=Pt.width,rr.height=Pt.height),ct.update()})}},{key:"getTexture",value:function(){return this.texture}},{key:"getIconMap",value:function(){return this.iconMap}},{key:"getCanvas",value:function(){return this.canvas}},{key:"hasImage",value:function(fe){return this.iconMap.hasOwnProperty(fe)}},{key:"removeImage",value:function(fe){this.hasImage(fe)&&(this.iconData=this.iconData.filter(function(Se){return Se.id!==fe}),delete this.iconMap[fe],this.update())}},{key:"destroy",value:function(){this.iconData=[],this.iconMap={}}},{key:"update",value:function(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,0===this.loadingImageCount&&this.emit("imageUpdate")}},{key:"updateIconAtlas",value:function(){var fe=this;this.canvas.width=1024,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(function(Se){var ct=fe.iconMap[Se],Pt=ct.x,bt=ct.y,rr=ct.image,jr=ct.width,Mn=void 0===jr?64:jr,Xn=ct.height,ni=void 0===Xn?64:Xn,wi=Math.max(Mn,ni)/64,ea=ni/wi,xa=Mn/wi;rr&&fe.ctx.drawImage(rr,Pt+(64-xa)/2,bt+(64-ea)/2,xa,ea)})}},{key:"updateIconMap",value:function(){var fe=function($,ee,L){var rr,D=0,fe=0,Se=0,ct=[],Pt={},bt=Mt($);try{for(bt.s();!(rr=bt.n()).done;){var jr=rr.value;if(!Pt[jr.id]){var Mn=jr.size;D+Mn+3>1024&&(ne(Pt,ct,fe),D=0,fe=Se+fe+3,Se=0,ct=[]),ct.push({icon:jr,xOffset:D}),D=D+Mn+3,Se=Math.max(Se,Mn)}}}catch(ni){bt.e(ni)}finally{bt.f()}return ct.length>0&&ne(Pt,ct,fe),{mapping:Pt,canvasHeight:nr(Se+fe+3)}}(this.iconData),ct=fe.canvasHeight;this.iconMap=fe.mapping,this.canvasHeight=ct}},{key:"loadImage",value:function(fe){return new Promise(function(Se,ct){if(fe instanceof HTMLImageElement)Se(fe);else{var Pt=new Image;Pt.crossOrigin="anonymous",Pt.onload=function(){Se(Pt)},Pt.onerror=function(){ct(new Error("Could not load image at "+fe))},Pt.src=fe instanceof File?URL.createObjectURL(fe):fe}})}}]),L}(w.EventEmitter))||Fr,Ot=M(83838),B=M(30651),St=(0,_.b2)()(_t=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"viewport",void 0),(0,Y.Z)(this,"overridedViewProjectionMatrix",void 0),(0,Y.Z)(this,"jitteredViewProjectionMatrix",void 0),(0,Y.Z)(this,"jitteredProjectionMatrix",void 0),(0,Y.Z)(this,"viewMatrixInverse",void 0),(0,Y.Z)(this,"cameraPosition",void 0)}return(0,te.Z)($,[{key:"init",value:function(){}},{key:"update",value:function(L){this.viewport=L,this.viewMatrixInverse=B.create(),B.invert(this.viewMatrixInverse,L.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}},{key:"getProjectionMatrix",value:function(){return this.jitteredProjectionMatrix||this.viewport.getProjectionMatrix()}},{key:"getModelMatrix",value:function(){return this.viewport.getModelMatrix()}},{key:"getViewMatrix",value:function(){return this.viewport.getViewMatrix()}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.getViewMatrixUncentered()}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.getViewProjectionMatrixUncentered()}},{key:"getViewProjectionMatrix",value:function(){return this.overridedViewProjectionMatrix||this.jitteredViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}},{key:"getZoom",value:function(){return this.viewport.getZoom()}},{key:"getZoomScale",value:function(){return this.viewport.getZoomScale()}},{key:"getCenter",value:function(){var L=this.viewport.getCenter(),D=(0,Ot.Z)(L,2);return[D[0],D[1]]}},{key:"getFocalDistance",value:function(){return this.viewport.getFocalDistance()}},{key:"getCameraPosition",value:function(){return this.cameraPosition}},{key:"projectFlat",value:function(L,D){return this.viewport.projectFlat(L,D)}},{key:"setViewProjectionMatrix",value:function(L){this.overridedViewProjectionMatrix=L}},{key:"jitterProjectionMatrix",value:function(L,D){var fe=B.fromTranslation(B.create(),[L,D,0]);this.jitteredProjectionMatrix=B.multiply(B.create(),fe,this.viewport.getProjectionMatrix()),this.jitteredViewProjectionMatrix=B.multiply(B.create(),this.jitteredProjectionMatrix,this.viewport.getViewMatrix())}},{key:"clearJitterProjectionMatrix",value:function(){this.jitteredProjectionMatrix=void 0,this.jitteredViewProjectionMatrix=void 0}}]),$}())||_t;function mr($,ee){(null==ee||ee>$.length)&&(ee=$.length);for(var L=0,D=new Array(ee);L<ee;L++)D[L]=$[L];return D}var Ln,hi,er=(0,_.b2)()(Cr=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"container",void 0),(0,Y.Z)(this,"controlCorners",void 0),(0,Y.Z)(this,"controlContainer",void 0),(0,Y.Z)(this,"scene",void 0),(0,Y.Z)(this,"mapsService",void 0),(0,Y.Z)(this,"controls",[]),(0,Y.Z)(this,"unAddControls",[])}return(0,te.Z)($,[{key:"init",value:function(L,D){this.container=L.container,this.scene=D,this.mapsService=D.get(X.v.IMapService),this.initControlPos()}},{key:"addControl",value:function(L,D){D.get(X.v.IMapService).map?(L.addTo(this.scene),this.controls.push(L)):this.unAddControls.push(L)}},{key:"getControlByName",value:function(L){return this.controls.find(function(D){return D.controlOption.name===L})}},{key:"removeControl",value:function(L){var D=this.controls.indexOf(L);return D>-1&&this.controls.splice(D,1),L.remove(),this}},{key:"addControls",value:function(){var L=this;this.unAddControls.forEach(function(D){D.addTo(L.scene),L.controls.push(D)}),this.unAddControls=[]}},{key:"destroy",value:function(){var D,L=function($,ee){var L="undefined"!=typeof Symbol&&$[Symbol.iterator]||$["@@iterator"];if(!L){if(Array.isArray($)||(L=function($,ee){if($){if("string"==typeof $)return mr($,void 0);var L=Object.prototype.toString.call($).slice(8,-1);if("Object"===L&&$.constructor&&(L=$.constructor.name),"Map"===L||"Set"===L)return Array.from($);if("Arguments"===L||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L))return mr($,void 0)}}($))||ee&&$&&"number"==typeof $.length){L&&($=L);var D=0,fe=function(){};return{s:fe,n:function(){return D>=$.length?{done:!0}:{done:!1,value:$[D++]}},e:function(rr){throw rr},f:fe}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Pt,Se=!0,ct=!1;return{s:function(){L=L.call($)},n:function(){var rr=L.next();return Se=rr.done,rr},e:function(rr){ct=!0,Pt=rr},f:function(){try{!Se&&null!=L.return&&L.return()}finally{if(ct)throw Pt}}}}(this.controls);try{for(L.s();!(D=L.n()).done;)D.value.remove()}catch(Se){L.e(Se)}finally{L.f()}this.controls=[],this.clearControlPos()}},{key:"initControlPos",value:function(){var L=this.controlCorners={},D="l7-",fe=this.controlContainer=Xe.SO.create("div",D+"control-container",this.container);function Se(){var ct=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],Pt=ct.map(function(bt){return D+bt}).join(" ");L[ct.join("")]=Xe.SO.create("div",Pt,fe)}Se(["top","left"]),Se(["top","right"]),Se(["bottom","left"]),Se(["bottom","right"]),Se(["top","center"]),Se(["right","center"]),Se(["left","center"]),Se(["bottom","center"])}},{key:"clearControlPos",value:function(){for(var L in this.controlCorners)this.controlCorners[L]&&Xe.SO.remove(this.controlCorners[L]);this.controlContainer&&Xe.SO.remove(this.controlContainer),delete this.controlCorners,delete this.controlContainer}}]),$}())||Cr,Wn=(0,_.b2)()(Ln=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"container",void 0),(0,Y.Z)(this,"scene",void 0),(0,Y.Z)(this,"mapsService",void 0),(0,Y.Z)(this,"markers",[]),(0,Y.Z)(this,"markerLayers",[]),(0,Y.Z)(this,"unAddMarkers",[]),(0,Y.Z)(this,"unAddMarkerLayers",[])}return(0,te.Z)($,[{key:"addMarkerLayer",value:function(L){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(L),L.addTo(this.scene)):this.unAddMarkerLayers.push(L)}},{key:"removeMarkerLayer",value:function(L){L.destroy(),this.markerLayers.indexOf(L);var D=this.markerLayers.indexOf(L);D>-1&&this.markerLayers.splice(D,1)}},{key:"addMarker",value:function(L){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(L),L.addTo(this.scene)):this.unAddMarkers.push(L)}},{key:"addMarkers",value:function(){var L=this;this.unAddMarkers.forEach(function(D){D.addTo(L.scene),L.markers.push(D)}),this.unAddMarkers=[]}},{key:"addMarkerLayers",value:function(){var L=this;this.unAddMarkerLayers.forEach(function(D){L.markerLayers.push(D),D.addTo(L.scene)}),this.unAddMarkers=[]}},{key:"removeMarker",value:function(L){L.remove(),this.markers.indexOf(L);var D=this.markers.indexOf(L);D>-1&&this.markers.splice(D,1)}},{key:"removeAllMarkers",value:function(){this.destroy()}},{key:"init",value:function(L){this.scene=L,this.mapsService=L.get(X.v.IMapService)}},{key:"destroy",value:function(){this.markers.forEach(function(L){L.remove()}),this.markers=[],this.markerLayers.forEach(function(L){L.destroy()}),this.markerLayers=[]}},{key:"removeMakerLayerMarker",value:function(L){L.destroy()}}]),$}())||Ln,si=(0,_.b2)()(hi=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"scene",void 0),(0,Y.Z)(this,"popup",void 0),(0,Y.Z)(this,"mapsService",void 0),(0,Y.Z)(this,"unAddPopup",void 0)}return(0,te.Z)($,[{key:"removePopup",value:function(L){L.remove()}},{key:"destroy",value:function(){this.popup.remove()}},{key:"addPopup",value:function(L){this.popup&&this.popup.remove(),this.mapsService.map&&this.mapsService.getMarkerContainer()?(L.addTo(this.scene),this.popup=L):this.unAddPopup=L}},{key:"initPopup",value:function(){this.unAddPopup&&(this.addPopup(this.unAddPopup),this.unAddPopup=null)}},{key:"init",value:function(L){this.scene=L,this.mapsService=L.get(X.v.IMapService)}}]),$}())||hi,ai=M(3912),Yi=M.n(ai);const Ei={MapToken:"\u60a8\u6b63\u5728\u4f7f\u7528 Demo\u6d4b\u8bd5\u5730\u56fetoken\uff0c\u5982\u679c\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u53bb\u5bf9\u5e94\u5730\u56fe\u8bf7\u6ce8\u518cToken",SDK:"\u8bf7\u786e\u8ba4\u5f15\u5165\u4e86mapbox-gl api\u4e14\u5728L7\u4e4b\u524d\u5f15\u5165"};var he;function ge($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function F($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?ge(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):ge(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var re={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},ye={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",selectColor:"blue",enableTAA:!1,jitterScale:1,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0},Me=(0,_.b2)()(he=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"sceneConfigCache",{}),(0,Y.Z)(this,"layerConfigCache",{})}return(0,te.Z)($,[{key:"getSceneConfig",value:function(L){return this.sceneConfigCache[L]}},{key:"getSceneWarninfo",value:function(L){return Ei[L]}},{key:"setSceneConfig",value:function(L,D){this.sceneConfigCache[L]=F(F({},re),D)}},{key:"getLayerConfig",value:function(L){return this.layerConfigCache[L]}},{key:"setLayerConfig",value:function(L,D,fe){this.layerConfigCache[D]=F({},Yi()({},this.sceneConfigCache[L],ye,fe))}},{key:"clean",value:function(){this.sceneConfigCache={},this.layerConfigCache={}}}]),$}())||he,ce=M(32952),Te=M(56326),mt=M(58623),wr=Math.PI/180;function Br($){var ee=$.latitude,L=void 0===ee?0:ee,D=$.zoom,Se=$.scale,ct=$.highPrecision,Pt=void 0!==ct&&ct,bt=$.flipY,rr=void 0!==bt&&bt,jr={},Mn=512*(Se=void 0!==Se?Se:Math.pow(2,void 0===D?0:D)),Xn=Math.cos(L*wr),ni=Mn/360,Ci=ni/Xn,wi=Mn/4003e4/Xn;if(jr.pixelsPerMeter=[wi,-wi,wi],jr.metersPerPixel=[1/wi,-1/wi,1/wi],jr.pixelsPerDegree=[ni,-Ci,wi],jr.degreesPerPixel=[1/ni,-1/Ci,1/wi],Pt){var ea=wr*Math.tan(L*wr)/Xn,ua=Mn/4003e4*ea,Ha=ua/Ci*wi;jr.pixelsPerDegree2=[0,-ni*ea/2,ua],jr.pixelsPerMeter2=[Ha,0,Ha],rr&&(jr.pixelsPerDegree2[1]=-jr.pixelsPerDegree2[1],jr.pixelsPerMeter2[1]=-jr.pixelsPerMeter2[1])}return rr&&(jr.pixelsPerMeter[1]=-jr.pixelsPerMeter[1],jr.metersPerPixel[1]=-jr.metersPerPixel[1],jr.pixelsPerDegree[1]=-jr.pixelsPerDegree[1],jr.degreesPerPixel[1]=-jr.degreesPerPixel[1]),jr}var Cn,qt,xn,nn,ln,Ji,ji,Ti,_a,Ma,On=M(62306),Di=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],gn=(Cn=(0,_.b2)(),qt=(0,_.f3)(X.v.ICameraService),Cn((nn=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"needRefresh",!0),(0,ce.Z)(this,"cameraService",ln,this),(0,Y.Z)(this,"coordinateSystem",void 0),(0,Y.Z)(this,"viewportCenter",void 0),(0,Y.Z)(this,"viewportCenterProjection",void 0),(0,Y.Z)(this,"pixelsPerDegree",void 0),(0,Y.Z)(this,"pixelsPerDegree2",void 0),(0,Y.Z)(this,"pixelsPerMeter",void 0)}return(0,te.Z)($,[{key:"refresh",value:function(){var L=this.cameraService.getZoom(),D=this.cameraService.getZoomScale(),fe=this.cameraService.getCenter(),Se=Br({latitude:fe[1],zoom:L}),ct=Se.pixelsPerMeter,Pt=Se.pixelsPerDegree;this.viewportCenter=fe,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=ct,this.pixelsPerDegree=Pt,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===On.l.LNGLAT||this.coordinateSystem===On.l.P20?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===On.l.LNGLAT_OFFSET?this.calculateLnglatOffset(fe,L):this.coordinateSystem===On.l.P20_OFFSET&&this.calculateLnglatOffset(fe,L,D,!0),this.needRefresh=!1}},{key:"getCoordinateSystem",value:function(){return this.coordinateSystem}},{key:"setCoordinateSystem",value:function(L){this.coordinateSystem=L}},{key:"getViewportCenter",value:function(){return this.viewportCenter}},{key:"getViewportCenterProjection",value:function(){return this.viewportCenterProjection}},{key:"getPixelsPerDegree",value:function(){return this.pixelsPerDegree}},{key:"getPixelsPerDegree2",value:function(){return this.pixelsPerDegree2}},{key:"getPixelsPerMeter",value:function(){return this.pixelsPerMeter}},{key:"calculateLnglatOffset",value:function(L,D,fe,Se){var ct=Br({latitude:L[1],zoom:D,scale:fe,flipY:Se,highPrecision:!0}),Pt=ct.pixelsPerMeter,bt=ct.pixelsPerDegree,rr=ct.pixelsPerDegree2,jr=this.cameraService.getViewMatrix(),Mn=this.cameraService.getProjectionMatrix(),Xn=B.multiply([],Mn,jr),ni=this.cameraService.projectFlat([Math.fround(L[0]),Math.fround(L[1])],Math.pow(2,D));this.viewportCenterProjection=mt.fF([],[ni[0],ni[1],0,1],Xn),jr=this.cameraService.getViewMatrixUncentered()||jr,Xn=B.multiply([],Mn,jr),Xn=B.multiply([],Xn,Di),this.cameraService.setViewProjectionMatrix(Xn),this.pixelsPerMeter=Pt,this.pixelsPerDegree=bt,this.pixelsPerDegree2=rr}}]),$}(),ln=(0,Te.Z)(nn.prototype,"cameraService",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xn=nn))||xn),Oi=M(11524),ta=M.n(Oi),oi=M(12260);var Xi={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"},to=(Ji=(0,_.b2)(),ji=(0,_.f3)(X.v.IMapService),Ji((_a=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){var D;(0,q.Z)(this,L);for(var fe=arguments.length,Se=new Array(fe),ct=0;ct<fe;ct++)Se[ct]=arguments[ct];return D=ee.call.apply(ee,[this].concat(Se)),(0,ce.Z)((0,Le.Z)(D),"mapService",Ma,(0,Le.Z)(D)),(0,Y.Z)((0,Le.Z)(D),"hammertime",void 0),(0,Y.Z)((0,Le.Z)(D),"lastClickTime",0),(0,Y.Z)((0,Le.Z)(D),"lastClickXY",[-1,-1]),(0,Y.Z)((0,Le.Z)(D),"clickTimer",void 0),(0,Y.Z)((0,Le.Z)(D),"$containter",void 0),(0,Y.Z)((0,Le.Z)(D),"onDrag",function(Pt){var bt=D.interactionEvent(Pt);bt.type=Xi[bt.type],D.emit(oi.s.Drag,bt)}),(0,Y.Z)((0,Le.Z)(D),"onHammer",function(Pt){Pt.srcEvent.stopPropagation();var bt=D.interactionEvent(Pt);D.emit(oi.s.Hover,bt)}),(0,Y.Z)((0,Le.Z)(D),"onTouch",function(Pt){var bt=Pt.touches[0];D.onHover({x:bt.pageX,y:bt.pageY,type:"touch"})}),(0,Y.Z)((0,Le.Z)(D),"onHover",function(Pt){var jr=Pt.clientX,Mn=Pt.clientY,Xn=Pt.type,ni=D.mapService.getMapContainer();if(ni){var Ci=ni.getBoundingClientRect();jr=jr-Ci.left-ni.clientLeft,Mn=Mn-Ci.top-ni.clientTop}var xa=D.mapService.containerToLngLat([jr,Mn]);if("click"!==Xn)"touch"!==Xn?"click"!==Xn&&"dblclick"!==Xn&&D.emit(oi.s.Hover,{x:jr,y:Mn,lngLat:xa,type:Xn,target:Pt}):D.isDoubleTap(jr,Mn,xa);else{if("ontouchstart"in document.documentElement)return;D.isDoubleTap(jr,Mn,xa)}}),D}return(0,te.Z)(L,[{key:"init",value:function(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}},{key:"destroy",value:function(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(oi.s.Hover)}},{key:"triggerHover",value:function(fe){this.emit(oi.s.Hover,{x:fe.x,y:fe.y})}},{key:"triggerSelect",value:function(fe){this.emit(oi.s.Select,{featureId:fe})}},{key:"triggerActive",value:function(fe){this.emit(oi.s.Active,{featureId:fe})}},{key:"addEventListenerOnMap",value:function(){var fe=this.mapService.getMapContainer();if(fe){var Se=new(ta().Manager)(fe);Se.add(new(ta().Tap)({event:"dblclick",taps:2})),Se.add(new(ta().Tap)({event:"click"})),Se.add(new(ta().Pan)({threshold:0,pointers:0})),Se.add(new(ta().Press)({})),Se.on("dblclick click",this.onHammer),Se.on("panstart panmove panend pancancel",this.onDrag),fe.addEventListener("mousemove",this.onHover),fe.addEventListener("mousedown",this.onHover,!0),fe.addEventListener("mouseup",this.onHover),fe.addEventListener("contextmenu",this.onHover),this.hammertime=Se}}},{key:"removeEventListenerOnMap",value:function(){var fe=this.mapService.getMapContainer();fe&&(fe.removeEventListener("mousemove",this.onHover),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),fe.removeEventListener("mousedown",this.onHover),fe.removeEventListener("mouseup",this.onHover),fe.removeEventListener("contextmenu",this.onHover))}},{key:"interactionEvent",value:function(fe){var Pt,bt,Se=fe.type;"touch"===fe.pointerType?(bt=Math.floor(fe.pointers[0].clientY),Pt=Math.floor(fe.pointers[0].clientX)):(bt=Math.floor(fe.srcEvent.y),Pt=Math.floor(fe.srcEvent.x));var rr=this.mapService.getMapContainer();if(rr){var jr=rr.getBoundingClientRect();Pt-=jr.left,bt-=jr.top}return{x:Pt,y:bt,lngLat:this.mapService.containerToLngLat([Pt,bt]),type:Se,target:fe.srcEvent}}},{key:"isDoubleTap",value:function(fe,Se,ct){var Pt=this,bt=(new Date).getTime();bt-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-fe)<10&&Math.abs(this.lastClickXY[1]-Se)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),this.emit(oi.s.Hover,{x:fe,y:Se,lngLat:ct,type:"dblclick"})):(this.lastClickTime=bt,this.lastClickXY=[fe,Se],this.clickTimer=setTimeout(function(){Pt.emit(oi.s.Hover,{x:fe,y:Se,lngLat:ct,type:"click"})},400))}}]),L}(p()),Ma=(0,Te.Z)(_a.prototype,"mapService",[ji],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ti=_a))||Ti),Ho=M(8239),Za=M(88774),Wi=M.n(Za),Su=(window,0);function Da($){var ee=$;if("string"==typeof $&&(ee=document.getElementById($)),ee){var L=document.createElement("div");return L.style.cssText+="\n      position: absolute;\n      z-index:2;\n      height: 100%;\n      width: 100%;\n      pointer-events: none;\n    ",L.id="l7-scene-".concat(Su++),L.classList.add("l7-scene"),ee.appendChild(L),L}return null}var ra,bo,ma,vo,No,ks,aa,Jo,Ia,Ya,$o,Fi=M(24558);function Ba($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function be($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?Ba(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):Ba(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var Qt,Yr,$n,xi,lo,ro,co,ps,du,ts,Ls,Qs,gs,Oa,Lo,Fe=(ra=(0,_.b2)(),bo=(0,_.f3)(X.v.IRendererService),ma=(0,_.f3)(X.v.IGlobalConfigService),vo=(0,_.f3)(X.v.IInteractionService),No=(0,_.f3)(X.v.ILayerService),ra((aa=function(){function $(){var ee=this;(0,q.Z)(this,$),(0,ce.Z)(this,"rendererService",Jo,this),(0,ce.Z)(this,"configService",Ia,this),(0,ce.Z)(this,"interactionService",Ya,this),(0,ce.Z)(this,"layerService",$o,this),(0,Y.Z)(this,"pickingFBO",void 0),(0,Y.Z)(this,"width",0),(0,Y.Z)(this,"height",0),(0,Y.Z)(this,"alreadyInPicking",!1),(0,Y.Z)(this,"pickBufferScale",1),(0,Y.Z)(this,"pickFromPickingFBO",function(L,D){var fe,Se=D.x,ct=D.y,Pt=D.lngLat,bt=D.type,rr=D.target,jr=!1,Mn=ee.rendererService,ni=Mn.readPixels,wi=(0,Mn.getContainer)().getBoundingClientRect(),ea=wi.width,xa=wi.height;ea*=Xe.SO.DPR,xa*=Xe.SO.DPR;var ga,ua=L.getLayerConfig(),Ha=ua.enableHighlight,Wa=ua.enableSelect,Ka=Se*Xe.SO.DPR,ia=ct*Xe.SO.DPR;if(Ka>ea-1*Xe.SO.DPR||Ka<0||ia>xa-1*Xe.SO.DPR||ia<0)return!1;if(0!==(ga=ni({x:Math.floor(Ka/ee.pickBufferScale),y:Math.floor((xa-(ct+1)*Xe.SO.DPR)/ee.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:ee.pickingFBO}))[0]||0!==ga[1]||0!==ga[2]){var la=(0,Xe.W0)(ga),no=L.getSource().getFeatureById(la);la!==L.getCurrentPickId()&&"mousemove"===bt&&(bt="mouseenter");var Li={x:Se,y:ct,type:bt,lngLat:Pt,featureId:la,feature:no,target:rr};no&&(jr=!0,L.setCurrentPickId(la),ee.triggerHoverOnLayer(L,Li))}else{var Ca={x:Se,y:ct,lngLat:Pt,type:null!==L.getCurrentPickId()&&"mousemove"===bt?"mouseout":"un"+bt,featureId:null,target:rr,feature:null};ee.triggerHoverOnLayer(L,be(be({},Ca),{},{type:"unpick"})),ee.triggerHoverOnLayer(L,Ca),L.setCurrentPickId(null)}if(Ha&&ee.highlightPickedFeature(L,ga),Wa&&"click"===bt&&(null===(fe=ga)||void 0===fe?void 0:fe.toString())!==[0,0,0,0].toString()){var ba=(0,Xe.W0)(ga);null===L.getCurrentSelectedId()||ba!==L.getCurrentSelectedId()?(ee.selectFeature(L,ga),L.setCurrentSelectedId(ba)):(ee.selectFeature(L,new Uint8Array([0,0,0,0])),L.setCurrentSelectedId(null))}return jr})}return(0,te.Z)($,[{key:"init",value:function(L){var D=this.rendererService,fe=D.createTexture2D,Se=D.createFramebuffer,bt=(0,D.getContainer)().getBoundingClientRect(),rr=bt.width,jr=bt.height;rr*=Xe.SO.DPR,jr*=Xe.SO.DPR,this.pickBufferScale=this.configService.getSceneConfig(L).pickBufferScale||1,this.pickingFBO=Se({color:fe({width:Math.round(rr/this.pickBufferScale),height:Math.round(jr/this.pickBufferScale),wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.interactionService.on(oi.s.Hover,this.pickingAllLayer.bind(this))}},{key:"boxPickLayer",value:(ee=(0,Ho.Z)(Wi().mark(function D(fe,Se,ct){var bt,rr,jr,Pt=this;return Wi().wrap(function(ni){for(;;)switch(ni.prev=ni.next){case 0:rr=(bt=this.rendererService).useFramebuffer,jr=bt.clear,this.resizePickingFBO(),rr(this.pickingFBO,function(){jr({framebuffer:Pt.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),fe.hooks.beforePickingEncode.call(),fe.renderModels(),fe.hooks.afterPickingEncode.call();var Ci=Pt.pickBox(fe,Se);ct(Ci)});case 3:case"end":return ni.stop()}},D,this)})),function(D,fe,Se){return ee.apply(this,arguments)})},{key:"pickBox",value:function(L,D){var fe=this,Se=D.map(function(Ca){return Math.floor((Ca<0?0:Ca)*Xe.SO.DPR/fe.pickBufferScale)}),ct=(0,Ot.Z)(Se,4),Pt=ct[0],bt=ct[1],rr=ct[2],jr=ct[3],Mn=this.rendererService,ni=Mn.readPixels,wi=(0,Mn.getContainer)().getBoundingClientRect(),ea=wi.width,xa=wi.height;if(xa*=Xe.SO.DPR,Pt>((ea*=Xe.SO.DPR)-1)*Xe.SO.DPR/this.pickBufferScale||rr<0||bt>(xa-1)*Xe.SO.DPR/this.pickBufferScale||jr<0)return[];var ua,Ha=Math.min(ea/this.pickBufferScale,rr)-Pt,Wa=Math.min(xa/this.pickBufferScale,jr)-bt;ua=ni({x:Pt,y:Math.floor(xa/this.pickBufferScale-(jr+1)),width:Ha,height:Wa,data:new Uint8Array(Ha*Wa*4),framebuffer:this.pickingFBO});for(var Ka=[],ia={},ga=0;ga<ua.length/4;ga+=1){var la=ua.slice(4*ga,4*ga+4),no=(0,Xe.W0)(la);if(-1!==no&&!ia[no]){var Li=L.getSource().getFeatureById(no);Ka.push(Li),ia[no]=!0}}return Ka}},{key:"pickingAllLayer",value:function(){var ee=(0,Ho.Z)(Wi().mark(function D(fe){return Wi().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:if(!this.alreadyInPicking&&!this.layerService.alreadyInRendering){ct.next=2;break}return ct.abrupt("return");case 2:return this.alreadyInPicking=!0,ct.next=5,this.pickingLayers(fe);case 5:this.layerService.renderLayers("picking"),this.alreadyInPicking=!1;case 7:case"end":return ct.stop()}},D,this)}));return function(D){return ee.apply(this,arguments)}}()},{key:"resizePickingFBO",value:function(){var D=(0,this.rendererService.getContainer)().getBoundingClientRect(),fe=D.width,Se=D.height;Se*=Xe.SO.DPR,(this.width!==(fe*=Xe.SO.DPR)||this.height!==Se)&&(this.pickingFBO.resize({width:Math.round(fe/this.pickBufferScale),height:Math.round(Se/this.pickBufferScale)}),this.width=fe,this.height=Se)}},{key:"pickingLayers",value:function(){var ee=(0,Ho.Z)(Wi().mark(function D(fe){var ct,bt,rr,Se=this;return Wi().wrap(function(Xn){for(;;)switch(Xn.prev=Xn.next){case 0:bt=(ct=this.rendererService).useFramebuffer,rr=ct.clear,this.resizePickingFBO(),bt(this.pickingFBO,function(){Se.layerService.getLayers().filter(function(Ci){return Ci.needPick(fe.type)}).reverse().some(function(Ci){return rr({framebuffer:Se.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),Ci.hooks.beforePickingEncode.call(),Ci.renderModels(),Ci.hooks.afterPickingEncode.call(),Se.pickFromPickingFBO(Ci,fe)&&!Ci.getLayerConfig().enablePropagation})});case 3:case"end":return Xn.stop()}},D,this)}));return function(D){return ee.apply(this,arguments)}}()},{key:"triggerHoverOnLayer",value:function(L,D){(function($){var ee,L,D=!0;return null==$||null===(ee=$.target)||void 0===ee||null===(L=ee.path)||void 0===L||L.map(function(fe){var Se;null!=fe&&fe.classList&&(null==fe||null===(Se=fe.classList)||void 0===Se||Se.forEach(function(ct){("l7-marker"===ct||"l7-popup"===ct)&&(D=!1)}))}),D})(D)&&L.emit(D.type,D)}},{key:"highlightPickedFeature",value:function(L,D){var fe=(0,Ot.Z)(D,3);L.hooks.beforeHighlight.call([fe[0],fe[1],fe[2]])}},{key:"selectFeature",value:function(L,D){var fe=(0,Ot.Z)(D,3);L.hooks.beforeSelect.call([fe[0],fe[1],fe[2]])}}]),$;var ee}(),Jo=(0,Te.Z)(aa.prototype,"rendererService",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ia=(0,Te.Z)(aa.prototype,"configService",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ya=(0,Te.Z)(aa.prototype,"interactionService",[vo],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=(0,Te.Z)(aa.prototype,"layerService",[No],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ks=aa))||ks),vt=function(){function $(){var ee=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];(0,q.Z)(this,$),(0,Y.Z)(this,"autoStart",void 0),(0,Y.Z)(this,"startTime",0),(0,Y.Z)(this,"oldTime",0),(0,Y.Z)(this,"running",!1),(0,Y.Z)(this,"elapsedTime",0),this.autoStart=ee}return(0,te.Z)($,[{key:"start",value:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var L=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var D=("undefined"==typeof performance?Date:performance).now();L=(D-this.oldTime)/1e3,this.oldTime=D,this.elapsedTime+=L}return L}}]),$}(),Eu=(Qt=(0,_.b2)(),Yr=(0,_.f3)(X.v.IRendererService),$n=(0,_.f3)(X.v.IMapService),xi=(0,_.f3)(X.v.IGlobalConfigService),Qt((ro=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"clock",new vt),(0,Y.Z)(this,"alreadyInRendering",!1),(0,Y.Z)(this,"layers",[]),(0,Y.Z)(this,"layerRenderID",void 0),(0,Y.Z)(this,"sceneInited",!1),(0,Y.Z)(this,"animateInstanceCount",0),(0,Y.Z)(this,"lastRenderType",void 0),(0,Y.Z)(this,"lastPickRenderTime",void 0),(0,ce.Z)(this,"renderService",co,this),(0,ce.Z)(this,"mapService",ps,this),(0,ce.Z)(this,"configService",du,this)}return(0,te.Z)($,[{key:"add",value:function(L){this.sceneInited&&L.init(),this.layers.push(L)}},{key:"initLayers",value:function(){this.sceneInited=!0,this.layers.forEach(function(L){L.inited||L.init()})}},{key:"getLayers",value:function(){return this.layers}},{key:"getLayer",value:function(L){return this.layers.find(function(D){return D.id===L})}},{key:"getLayerByName",value:function(L){return this.layers.find(function(D){return D.name===L})}},{key:"remove",value:function(L){var D=this.layers.indexOf(L);D>-1&&this.layers.splice(D,1),L.emit("remove",null),L.destroy(),this.renderLayers()}},{key:"removeAllLayers",value:function(){this.destroy()}},{key:"renderLayers",value:function(L){!this.renderTest(L)||this.alreadyInRendering||(this.alreadyInRendering=!0,this.clear(),this.updateRenderOrder(),this.layers.filter(function(D){return D.inited}).filter(function(D){return D.isVisible()}).forEach(function(D){D.hooks.beforeRenderData.call(),D.hooks.beforeRender.call(),D.render(),D.hooks.afterRender.call()}),this.alreadyInRendering=!1)}},{key:"updateRenderOrder",value:function(){this.layers.sort(function(L,D){return L.zIndex-D.zIndex})}},{key:"destroy",value:function(){this.layers.forEach(function(L){return L.destroy()}),this.layers=[],this.renderLayers()}},{key:"startAnimate",value:function(){0==this.animateInstanceCount++&&(this.clock.start(),this.runRender())}},{key:"stopAnimate",value:function(){0==--this.animateInstanceCount&&(this.stopRender(),this.clock.stop())}},{key:"getOESTextureFloat",value:function(){return this.renderService.extensionObject.OES_texture_float}},{key:"renderTest",value:function(L){var fe=(new Date).getTime()-this.lastPickRenderTime;if("picking"===L&&(this.lastPickRenderTime=(new Date).getTime()),L)switch(L){case"picking":return"mapRender"===this.lastRenderType||"animate"===this.lastRenderType?(this.lastRenderType="picking",fe>48):(this.lastRenderType="picking",!0);case"animate":return"mapRender"===this.lastRenderType?(this.lastRenderType="animate",!1):(this.lastRenderType="animate",!0);case"mapRender":return this.lastRenderType="mapRender",!0;default:return!0}return!0}},{key:"clear",value:function(){var L=(0,Xe.CI)(this.mapService.bgColor);this.renderService.clear({color:L,depth:1,stencil:0,framebuffer:null})}},{key:"runRender",value:function(){this.renderLayers("animate"),this.layerRenderID=requestAnimationFrame(this.runRender.bind(this))}},{key:"stopRender",value:function(){cancelAnimationFrame(this.layerRenderID)}}]),$}(),co=(0,Te.Z)(ro.prototype,"renderService",[Yr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ps=(0,Te.Z)(ro.prototype,"mapService",[$n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=(0,Te.Z)(ro.prototype,"configService",[xi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lo=ro))||lo),fl=M(71189),Wo=M(96109),Qo=M(28303),ko=M.n(Qo),es=function(){function $(ee){var L=this;(0,q.Z)(this,$),(0,Y.Z)(this,"name",void 0),(0,Y.Z)(this,"type",void 0),(0,Y.Z)(this,"scale",void 0),(0,Y.Z)(this,"descriptor",void 0),(0,Y.Z)(this,"featureBufferLayout",[]),(0,Y.Z)(this,"needRescale",!1),(0,Y.Z)(this,"needRemapping",!1),(0,Y.Z)(this,"needRegenerateVertices",!1),(0,Y.Z)(this,"featureRange",{startIndex:0,endIndex:1/0}),(0,Y.Z)(this,"vertexAttribute",void 0),(0,Y.Z)(this,"defaultCallback",function(D){var fe;return 0===D.length?(null===(fe=L.scale)||void 0===fe?void 0:fe.defaultValues)||[]:D.map(function(Se,ct){var Pt;return(null===(Pt=L.scale)||void 0===Pt?void 0:Pt.scalers[ct].func)(Se)})}),this.setProps(ee)}return(0,te.Z)($,[{key:"setProps",value:function(L){Object.assign(this,L)}},{key:"mapping",value:function(L){var D;if(null!==(D=this.scale)&&void 0!==D&&D.callback){var fe,Se=null===(fe=this.scale)||void 0===fe?void 0:fe.callback.apply(fe,(0,Wo.Z)(L));if(!ko()(Se))return[Se]}return this.defaultCallback(L)}},{key:"resetDescriptor",value:function(){this.descriptor&&(this.descriptor.buffer.data=[])}}]),$}();function Ol($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function kl($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?Ol(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):Ol(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var m,E,U,O,pe,De,ft,Rt,kt,Ir,Nr,Jn,bi,pi,oa,Ea,Na,vi,Xo,vu,Tu,Ec,Du,Bl,mu,gu,tu,oo,Tc,Cc,rs,tc,ru,Sc=((0,Y.Z)(ts={},Fi.gl.FLOAT,4),(0,Y.Z)(ts,Fi.gl.UNSIGNED_BYTE,1),(0,Y.Z)(ts,Fi.gl.UNSIGNED_SHORT,2),ts),Rl=(Ls=(0,_.b2)(),Qs=(0,_.f3)(X.v.IRendererService),Ls((Oa=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"attributesAndIndices",void 0),(0,ce.Z)(this,"rendererService",Lo,this),(0,Y.Z)(this,"attributes",[]),(0,Y.Z)(this,"triangulation",void 0),(0,Y.Z)(this,"featureLayout",{sizePerElement:0,elements:[]})}return(0,te.Z)($,[{key:"registerStyleAttribute",value:function(L){var D=this.getLayerStyleAttribute(L.name||"");return D?D.setProps(L):(D=new es(L),this.attributes.push(D)),D}},{key:"updateStyleAttribute",value:function(L,D,fe){var Se=this.getLayerStyleAttribute(L);Se||(Se=this.registerStyleAttribute(kl(kl({},D),{},{name:L})));var ct=D.scale;ct&&Se&&(Se.scale=ct,Se.needRescale=!0,Se.needRemapping=!0,Se.needRegenerateVertices=!0,fe&&fe.featureRange&&(Se.featureRange=fe.featureRange))}},{key:"getLayerStyleAttributes",value:function(){return this.attributes}},{key:"getLayerStyleAttribute",value:function(L){return this.attributes.find(function(D){return D.name===L})}},{key:"getLayerAttributeScale",value:function(L){var D,fe=this.getLayerStyleAttribute(L),Se=null==fe||null===(D=fe.scale)||void 0===D?void 0:D.scalers;return Se&&Se[0]?Se[0].func:null}},{key:"updateAttributeByFeatureRange",value:function(L,D){var fe=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,Se=arguments.length>3?arguments[3]:void 0,ct=this.attributes.find(function(Wa){return Wa.name===L});if(ct&&ct.descriptor){var Pt=ct.descriptor,bt=Pt.update,rr=Pt.buffer,jr=Pt.size,Mn=void 0===jr?0:jr,Xn=Sc[rr.type||Fi.gl.FLOAT];if(bt){var ni=this.featureLayout,Ci=ni.elements,wi=ni.sizePerElement,ea=Ci.slice(fe,Se);if(!ea.length)return;var xa=ea[0].offset,ua=xa*Mn*Xn,Ha=ea.map(function(Wa,Ka){for(var ia=Wa.featureIdx,ga=Wa.vertices,la=Wa.normals,no=ga.length/wi,Li=[],Ca=0;Ca<no;Ca++){var ba=la?la.slice(3*Ca,3*Ca+3):[];Li.push.apply(Li,(0,Wo.Z)(bt(D[ia],ia,ga.slice(Ca*wi,Ca*wi+wi),Ka,ba)))}return Li}).reduce(function(Wa,Ka){return Wa.push.apply(Wa,(0,Wo.Z)(Ka)),Wa},[]);ct.vertexAttribute.updateBuffer({data:Ha,offset:ua})}}}},{key:"createAttributesAndIndices",value:function(L,D,fe){var Se=this;this.featureLayout={sizePerElement:0,elements:[]},D&&(this.triangulation=D);var ct=this.attributes.map(function(ua){return ua.resetDescriptor(),ua.descriptor}),Pt=0,rr=[];L.forEach(function(ua,Ha){var Wa=Se.triangulation(ua,fe),ia=Wa.vertices,ga=Wa.normals,la=Wa.size;Wa.indices.forEach(function(ba){rr.push(ba+Pt)});var no=ia.length/la;Se.featureLayout.sizePerElement=la,Se.featureLayout.elements.push({featureIdx:Ha,vertices:ia,normals:ga,offset:Pt}),Pt+=no;for(var Li=function(go){var Yl=(null==ga?void 0:ga.slice(3*go,3*go+3))||[],uu=ia.slice(go*la,go*la+la);ct.forEach(function(Ko,wu){var Hu;Ko&&Ko.update&&(Hu=Ko.buffer.data).push.apply(Hu,(0,Wo.Z)(Ko.update(ua,Ha,uu,go,Yl)))})},Ca=0;Ca<no;Ca++)Li(Ca)});var Xn=this.rendererService,ni=Xn.createAttribute,Ci=Xn.createBuffer,wi=Xn.createElements,ea={};ct.forEach(function(ua,Ha){if(ua){var Wa=ua.buffer,ga=(0,fl.Z)(ua,["buffer","update","name"]),la=ni(kl({buffer:Ci(Wa)},ga));ea[ua.name||""]=la,Se.attributes[Ha].vertexAttribute=la}});var xa=wi({data:rr,type:Fi.gl.UNSIGNED_INT,count:rr.length});return this.attributesAndIndices={attributes:ea,elements:xa},this.attributesAndIndices}},{key:"clearAllAttributes",value:function(){var L;this.attributes.forEach(function(D){D.vertexAttribute&&D.vertexAttribute.destroy()}),null===(L=this.attributesAndIndices)||void 0===L||L.elements.destroy(),this.attributes=[]}}]),$}(),Lo=(0,Te.Z)(Oa.prototype,"rendererService",[Qs],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gs=Oa))||gs),hl=M(97185),eu=M(18660),Dl=M.n(eu);var Ac,Bu=(m=(0,_.b2)(),E=(0,_.f3)(X.v.SceneID),U=(0,_.f3)(X.v.IIconService),O=(0,_.f3)(X.v.IFontService),pe=(0,_.f3)(X.v.IControlService),De=(0,_.f3)(X.v.IGlobalConfigService),ft=(0,_.f3)(X.v.IMapService),Rt=(0,_.f3)(X.v.ICoordinateSystemService),kt=(0,_.f3)(X.v.IRendererService),Ir=(0,_.f3)(X.v.ILayerService),Nr=(0,_.f3)(X.v.ICameraService),Jn=(0,_.f3)(X.v.IInteractionService),bi=(0,_.f3)(X.v.IPickingService),pi=(0,_.f3)(X.v.IShaderModuleService),oa=(0,_.f3)(X.v.IMarkerService),Ea=(0,_.f3)(X.v.IPopupService),m((vi=function($){(0,Wt.Z)(L,$);var D,ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){var D;return(0,q.Z)(this,L),D=ee.call(this),(0,Y.Z)((0,Le.Z)(D),"destroyed",!1),(0,Y.Z)((0,Le.Z)(D),"loaded",!1),(0,Y.Z)((0,Le.Z)(D),"loadFont",!1),(0,Y.Z)((0,Le.Z)(D),"fontFamily",""),(0,ce.Z)((0,Le.Z)(D),"id",Xo,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"iconService",vu,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"fontService",Tu,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"controlService",Ec,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"configService",Du,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"map",Bl,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"coordinateSystemService",mu,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"rendererService",gu,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"layerService",tu,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"cameraService",oo,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"interactionService",Tc,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"pickingService",Cc,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"shaderModuleService",rs,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"markerService",tc,(0,Le.Z)(D)),(0,ce.Z)((0,Le.Z)(D),"popupService",ru,(0,Le.Z)(D)),(0,Y.Z)((0,Le.Z)(D),"inited",!1),(0,Y.Z)((0,Le.Z)(D),"initPromise",void 0),(0,Y.Z)((0,Le.Z)(D),"rendering",!1),(0,Y.Z)((0,Le.Z)(D),"$container",void 0),(0,Y.Z)((0,Le.Z)(D),"canvas",void 0),(0,Y.Z)((0,Le.Z)(D),"markerContainer",void 0),(0,Y.Z)((0,Le.Z)(D),"hooks",void 0),(0,Y.Z)((0,Le.Z)(D),"handleWindowResized",function(){D.emit("resize"),D.$container&&(D.initContainer(),Xe.SO.triggerResize(),D.coordinateSystemService.needRefresh=!0,D.render())}),(0,Y.Z)((0,Le.Z)(D),"handleMapCameraChanged",function(fe){D.cameraService.update(fe),D.render("mapRender")}),D.hooks={init:new hl.zj},D}return(0,te.Z)(L,[{key:"init",value:function(fe){var Se=this;this.configService.setSceneConfig(this.id,fe),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.fontService.init(),this.hooks.init.tapPromise("initMap",(0,Ho.Z)(Wi().mark(function ct(){return Wi().wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:return bt.next=2,new Promise(function(rr){Se.map.onCameraChanged(function(jr){Se.cameraService.init(),Se.cameraService.update(jr),"GAODE2.x"!==Se.map.version&&rr()}),"GAODE2.x"!==Se.map.version?Se.map.init():rr()});case 2:if("GAODE2.x"!==Se.map.version||!Se.map.initViewPort){bt.next=6;break}return bt.next=5,Se.map.init();case 5:Se.map.initViewPort();case 6:Se.map.onCameraChanged(Se.handleMapCameraChanged),Se.map.addMarkerContainer(),Se.markerService.addMarkers(),Se.markerService.addMarkerLayers(),Se.popupService.initPopup(),Se.interactionService.init(),Se.interactionService.on(oi.s.Drag,Se.addSceneEvent.bind(Se));case 13:case"end":return bt.stop()}},ct)}))),this.hooks.init.tapPromise("initRenderer",(0,Ho.Z)(Wi().mark(function ct(){var Pt;return Wi().wrap(function(rr){for(;;)switch(rr.prev=rr.next){case 0:if(Pt=Da(Se.configService.getSceneConfig(Se.id).id||""),Se.$container=Pt,!Pt){rr.next=11;break}return Se.canvas=Xe.SO.create("canvas","",Pt),Se.setCanvas(),rr.next=7,Se.rendererService.init(Se.canvas,Se.configService.getSceneConfig(Se.id));case 7:Dl()(Se.$container,Se.handleWindowResized),window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)").addListener(Se.handleWindowResized),rr.next=12;break;case 11:console.error("\u5bb9\u5668 id \u4e0d\u5b58\u5728");case 12:Se.pickingService.init(Se.id);case 13:case"end":return rr.stop()}},ct)}))),this.initPromise=this.hooks.init.promise(),this.render()}},{key:"addLayer",value:function(fe){this.layerService.add(fe),this.render()}},{key:"render",value:(D=(0,Ho.Z)(Wi().mark(function Se(ct){return Wi().wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:if(!this.rendering&&!this.destroyed){bt.next=2;break}return bt.abrupt("return");case 2:if(this.rendering=!0,this.inited){bt.next=15;break}return bt.next=6,this.initPromise;case 6:if(this.destroyed&&this.destroy(),!this.loadFont||!document.fonts){bt.next=10;break}return bt.next=10,document.fonts.load("24px ".concat(this.fontFamily),"L7text");case 10:this.layerService.initLayers(),this.controlService.addControls(),this.loaded=!0,this.emit("loaded"),this.inited=!0;case 15:this.layerService.renderLayers(ct),this.rendering=!1;case 17:case"end":return bt.stop()}},Se,this)})),function(Se){return D.apply(this,arguments)})},{key:"addFontFace",value:function(fe,Se){this.fontFamily=fe;var ct=document.createElement("style");ct.type="text/css",ct.innerText="\n        @font-face{\n            font-family: '".concat(fe,"';\n            src: url('").concat(Se,"') format('woff2'),\n            url('").concat(Se,"') format('woff'),\n            url('").concat(Se,"') format('truetype');\n        }"),document.getElementsByTagName("head")[0].appendChild(ct),this.loadFont=!0}},{key:"getSceneContainer",value:function(){return this.$container}},{key:"exportPng",value:function(fe){var Se,ct=null===(Se=this.$container)||void 0===Se?void 0:Se.getElementsByTagName("canvas")[0];return this.render(),"jpg"===fe?null==ct?void 0:ct.toDataURL("image/jpeg"):null==ct?void 0:ct.toDataURL("image/png")}},{key:"getSceneConfig",value:function(){return this.configService.getSceneConfig(this.id)}},{key:"addMarkerContainer",value:function(){var fe=this.$container.parentElement;null!==fe&&(this.markerContainer=Xe.SO.create("div","l7-marker-container",fe))}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"destroy",value:function(){var fe,Se;this.inited?(this.emit("destroy"),this.layerService.destroy(),this.rendererService.destroy(),this.map.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),null===(fe=this.$container)||void 0===fe||null===(Se=fe.parentNode)||void 0===Se||Se.removeChild(this.$container),this.removeAllListeners(),this.inited=!1,(0,eu.unbind)(this.$container,this.handleWindowResized),window.matchMedia("screen and (min-resolution: 2dppx)").removeListener(this.handleWindowResized)):this.destroyed=!0}},{key:"initContainer",value:function(){var fe,Se,ct=Xe.SO.DPR,Pt=(null===(fe=this.$container)||void 0===fe?void 0:fe.clientWidth)||400,bt=(null===(Se=this.$container)||void 0===Se?void 0:Se.clientHeight)||300,rr=this.canvas;rr&&(rr.width=Pt*ct,rr.height=bt*ct,rr.style.width="".concat(Pt,"px"),rr.style.height="".concat(bt,"px")),this.rendererService.viewport({x:0,y:0,width:ct*Pt,height:ct*bt})}},{key:"setCanvas",value:function(){var fe,Se,ct=Xe.SO.DPR,Pt=(null===(fe=this.$container)||void 0===fe?void 0:fe.clientWidth)||400,bt=(null===(Se=this.$container)||void 0===Se?void 0:Se.clientHeight)||300,rr=this.canvas;rr.width=Pt*ct,rr.height=bt*ct,rr.style.width="".concat(Pt,"px"),rr.style.height="".concat(bt,"px")}},{key:"addSceneEvent",value:function(fe){this.emit(fe.type,fe)}}]),L}(w.EventEmitter),Xo=(0,Te.Z)(vi.prototype,"id",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vu=(0,Te.Z)(vi.prototype,"iconService",[U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=(0,Te.Z)(vi.prototype,"fontService",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ec=(0,Te.Z)(vi.prototype,"controlService",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Du=(0,Te.Z)(vi.prototype,"configService",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bl=(0,Te.Z)(vi.prototype,"map",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=(0,Te.Z)(vi.prototype,"coordinateSystemService",[Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=(0,Te.Z)(vi.prototype,"rendererService",[kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tu=(0,Te.Z)(vi.prototype,"layerService",[Ir],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oo=(0,Te.Z)(vi.prototype,"cameraService",[Nr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tc=(0,Te.Z)(vi.prototype,"interactionService",[Jn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cc=(0,Te.Z)(vi.prototype,"pickingService",[bi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rs=(0,Te.Z)(vi.prototype,"shaderModuleService",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tc=(0,Te.Z)(vi.prototype,"markerService",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ru=(0,Te.Z)(vi.prototype,"popupService",[Ea],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Na=vi))||Na),ka=M(72699),Ju=M.n(ka),Us=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function nc($){var ee={};return{content:$=$.replace(Us,function(L,D,fe){var Se=fe.split(":"),ct=Se[0].trim(),Pt="";switch(Se.length>1&&(Pt=Se[1].trim()),D){case"bool":Pt="true"===Pt;break;case"float":case"int":Pt=Number(Pt);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":Pt=Pt?Pt.replace("[","").replace("]","").split(",").reduce(function(bt,rr){return bt.push(Number(rr.trim())),bt},[]):new Array(function($){var ee=0;switch($){case"vec2":case"ivec2":ee=2;break;case"vec3":case"ivec3":ee=3;break;case"vec4":case"ivec4":case"mat2":ee=4;break;case"mat3":ee=9;break;case"mat4":ee=16}return ee}(D)).fill(0)}return ee[ct]=Pt,"uniform ".concat(D," ").concat(ct,";\n")}),uniforms:ee}}function Fl($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function yu($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?Fl(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):Fl(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var $u="#define PI 3.14159265359",ic=/precision\s+(high|low|medium)p\s+float/,uf=/#pragma include (["^+"]?["\ "[a-zA-Z_0-9](.*)"]*?)/g,Cu=(0,_.b2)()(Ac=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"moduleCache",{}),(0,Y.Z)(this,"rawContentCache",{})}return(0,te.Z)($,[{key:"registerBuiltinModules",value:function(){this.destroy(),this.registerModule("common",{vs:$u,fs:$u}),this.registerModule("decode",{vs:"#define SHIFT_RIGHT17 1.0 / 131072.0\n#define SHIFT_RIGHT18 1.0 / 262144.0\n#define SHIFT_RIGHT19 1.0 / 524288.0\n#define SHIFT_RIGHT20 1.0 / 1048576.0\n#define SHIFT_RIGHT21 1.0 / 2097152.0\n#define SHIFT_RIGHT22 1.0 / 4194304.0\n#define SHIFT_RIGHT23 1.0 / 8388608.0\n#define SHIFT_RIGHT24 1.0 / 16777216.0\n\n#define SHIFT_LEFT17 131072.0\n#define SHIFT_LEFT18 262144.0\n#define SHIFT_LEFT19 524288.0\n#define SHIFT_LEFT20 1048576.0\n#define SHIFT_LEFT21 2097152.0\n#define SHIFT_LEFT22 4194304.0\n#define SHIFT_LEFT23 8388608.0\n#define SHIFT_LEFT24 16777216.0\n\nvec2 unpack_float(float packedValue) {\n  int packedIntValue = int(packedValue);\n  int v0 = packedIntValue / 256;\n  return vec2(v0, packedIntValue - v0 * 256);\n}\n\nvec4 decode_color(vec2 encodedColor) {\n  return vec4(\n    unpack_float(encodedColor[0]) / 255.0,\n    unpack_float(encodedColor[1]) / 255.0\n  );\n}\n",fs:""}),this.registerModule("projection",{vs:"#define TILE_SIZE 512.0\n#define PI 3.1415926536\n#define WORLD_SCALE TILE_SIZE / (PI * 2.0)\n\n#define COORDINATE_SYSTEM_LNGLAT 1.0\n#define COORDINATE_SYSTEM_LNGLAT_OFFSET 2.0\n#define COORDINATE_SYSTEM_VECTOR_TILE 3.0\n#define COORDINATE_SYSTEM_IDENTITY 4.0\n#define COORDINATE_SYSTEM_P20 5.0\n#define COORDINATE_SYSTEM_P20_OFFSET 6.0\n#define COORDINATE_SYSTEM_METER_OFFSET 7.0\n\n#define COORDINATE_SYSTEM_P20_2 8.0\n\nuniform mat4 u_ViewMatrix;\nuniform mat4 u_ProjectionMatrix;\nuniform mat4 u_ViewProjectionMatrix;\nuniform float u_Zoom : 1;\nuniform float u_ZoomScale : 1;\n\nuniform float u_CoordinateSystem;\nuniform vec2 u_ViewportCenter;\nuniform vec4 u_ViewportCenterProjection;\nuniform vec3 u_PixelsPerDegree;\nuniform vec3 u_PixelsPerDegree2;\nuniform vec3 u_PixelsPerMeter;\n\nuniform vec2 u_ViewportSize;\nuniform float u_DevicePixelRatio;\nuniform float u_FocalDistance;\nuniform vec3 u_CameraPosition;\n\n// uniform mat4 u_Mvp;\n\n// web mercator coords -> world coords\nvec2 project_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  return vec2(\n    radians(x) + PI,\n    PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5))\n  );\n}\n\nfloat project_scale(float meters) {\n  return meters * u_PixelsPerMeter.z;\n}\n\n\n// offset coords -> world coords\nvec4 project_offset(vec4 offset) {\n  float dy = offset.y;\n  dy = clamp(dy, -1., 1.);\n  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;\n  return vec4(offset.xyz * pixels_per_unit, offset.w);\n}\n\nvec3 project_normal(vec3 normal) {\n  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);\n  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);\n}\n\nvec3 project_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01\n    || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // normals generated by the polygon tesselator are in lnglat offsets instead of meters\n    return normalize(vector * u_PixelsPerDegree);\n  }\n  return project_normal(vector);\n}\n// || u_CoordinateSystem < COORDINATE_SYSTEM_P20_OFFSET + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_P20_OFFSET - 0.01\n// reverse Y\nvec3 reverse_offset_normal(vec3 vector) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 ||u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET ) {\n    return vector * vec3(1.0, -1.0, 1.0);\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.0\n    return vector;\n  }\n  return vector;\n}\n\nvec4 project_position(vec4 position) {\n  float a = COORDINATE_SYSTEM_LNGLAT_OFFSET;\n  float b = COORDINATE_SYSTEM_P20_OFFSET;\n  float c = COORDINATE_SYSTEM_LNGLAT;\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET\n    || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    float X = position.x - u_ViewportCenter.x;\n    float Y = position.y - u_ViewportCenter.y;\n    return project_offset(vec4(X, Y, position.z, position.w));\n  }\n  if (u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 && u_CoordinateSystem >COORDINATE_SYSTEM_LNGLAT - 0.01) {\n    return vec4(\n      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20) {\n    return vec4(\n      (project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale - vec2(215440491., 106744817.)) * vec2(1., -1.),\n      project_scale(position.z),\n      position.w\n    );\n  }\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // return vec4(\n    //   (position.xy * WORLD_SCALE * u_ZoomScale) * vec2(1., -1.), \n    //   project_scale(position.z), \n    //   position.w);\n\n     return vec4(\n      position.xy, \n      project_scale(position.z), \n      position.w);\n  }\n  return position;\n\n  // TODO: \u74e6\u7247\u5750\u6807\u7cfb & \u5e38\u89c4\u4e16\u754c\u5750\u6807\u7cfb\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;\n  return offset * u_FocalDistance;\n}\n\nfloat project_pixel_allmap(float pixel) {\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n    return pixel * pow(2.0, u_Zoom);\n  }\n  return pixel;\n}\n\nfloat project_pixel(float pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));\n  }\n  return pixel;\n}\nvec2 project_pixel(vec2 pixel) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_P20 || u_CoordinateSystem == COORDINATE_SYSTEM_P20_OFFSET) {\n    // P20 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf1\n    return pixel * pow(2.0, (19.0 - u_Zoom));\n  }\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    // P20_2 \u5750\u6807\u7cfb\u4e0b\uff0c\u4e3a\u4e86\u548c Web \u58a8\u5361\u6258\u5750\u6807\u7cfb\u7edf\u4e00\uff0czoom \u9ed8\u8ba4\u51cf3\n    return pixel * pow(2.0, (19.0 - 3.0 - u_Zoom));\n  }\n  return pixel * -1.;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n    position.w *= u_PixelsPerMeter.z;\n  }\n\n  return viewProjectionMatrix * position + center;\n}\n\n// Projects from common space coordinates to clip space\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(\n    position,\n    u_ViewProjectionMatrix,\n    u_ViewportCenterProjection\n  );\n}\n\nvec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {\n  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);\n\n  if (u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||\n    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n    // Needs to be divided with project_uCommonUnitsPerMeter\n     pos.w = pos.w / u_PixelsPerMeter.z;\n  }\n  return pos;\n}\n\n\nbool isEqual( float a,  float b) {\n    return  a< b + 0.001 && a > b - 0.001;\n}",fs:""}),this.registerModule("project",{vs:"\n#define E 2.718281828459045\nvec2 ProjectFlat(vec2 lnglat){\n  float maxs=85.0511287798;\n  float lat=max(min(maxs,lnglat.y),-maxs);\n  float scale= 268435456.;\n  float d=PI/180.;\n  float x=lnglat.x*d;\n  float y=lat*d;\n  y=log(tan((PI/4.)+(y/2.)));\n\n  float a=.5/PI,\n  b=.5,\n  c=-.5/PI;\n  d=.5;\n  x=scale*(a*x+b);\n  y=scale*(c*y+d);\n  return vec2(x,y);\n}\n\nvec2 unProjectFlat(vec2 px){\n  float a=.5/PI;\n  float b=.5;\n  float c=-.5/PI;\n  float d=.5;\n  float scale = 268435456.;\n  float x=(px.x/scale-b)/a;\n  float y=(px.y/scale-d)/c;\n  y=(atan(pow(E,y))-(PI/4.))*2.;\n  d=PI/180.;\n  float lat=y/d;\n  float lng=x/d;\n  return vec2(lng,lat);\n}\n\nfloat pixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}\n\n// gaode2.0\nvec2 customProject(vec2 lnglat) { // \u7ecf\u7eac\u5ea6 => \u5e73\u9762\u5750\u6807\n  float t = lnglat.x;\n  float e = lnglat.y;\n  float Sm = 180.0 / PI;\n  float Tm = 6378137.0;\n  float Rm = PI / 180.0;\n  float r = 85.0511287798;\n  e = max(min(r, e), -r);\n  t *= Rm;\n  e *= Rm;\n  e = log(tan(PI / 4.0 + e / 2.0));\n  return vec2(t * Tm, e * Tm);\n}\n\nvec2 unProjCustomCoord(vec2 point) { // \u5e73\u9762\u5750\u6807 => \u7ecf\u7eac\u5ea6\n  float Sm = 57.29577951308232; //180 / Math.PI\n  float Tm = 6378137.0;\n  float t = point.x;\n  float e = point.y;\n  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);\n}\n\n\nfloat customPixelDistance(vec2 from, vec2 to) {\n vec2 a1 = ProjectFlat(from);\n vec2 b1 = ProjectFlat(to);\n return distance(a1, b1);\n}",fs:""}),this.registerModule("sdf_2d",{vs:"",fs:"/**\n * 2D signed distance field functions\n * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm\n */\n\nfloat ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }\n\nfloat sdCircle(vec2 p, float r) {\n  return length(p) - r;\n}\n\nfloat sdEquilateralTriangle(vec2 p) {\n  float k = sqrt(3.0);\n  p.x = abs(p.x) - 1.0;\n  p.y = p.y + 1.0/k;\n  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;\n  p.x -= clamp( p.x, -2.0, 0.0 );\n  return -length(p)*sign(p.y);\n}\n\nfloat sdBox(vec2 p, vec2 b) {\n  vec2 d = abs(p)-b;\n  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);\n}\n\nfloat sdPentagon(vec2 p, float r) {\n  vec3 k = vec3(0.809016994,0.587785252,0.726542528);\n  p.x = abs(p.x);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagon(vec2 p, float r) {\n  vec3 k = vec3(-0.866025404,0.5,0.577350269);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdOctogon(vec2 p, float r) {\n  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );\n  p = abs(p);\n  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);\n  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);\n  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdHexagram(vec2 p, float r) {\n  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);\n  p = abs(p);\n  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;\n  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;\n  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);\n  return length(p)*sign(p.y);\n}\n\nfloat sdRhombus(vec2 p, vec2 b) {\n  vec2 q = abs(p);\n  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);\n  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );\n  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );\n}\n\nfloat sdVesica(vec2 p, float r, float d) {\n  p = abs(p);\n  float b = sqrt(r*r-d*d); // can delay this sqrt\n  return ((p.y-b)*d>p.x*b)\n          ? length(p-vec2(0.0,b))\n          : length(p-vec2(-d,0.0))-r;\n}\n"}),this.registerModule("lighting",{vs:"// Blinn-Phong model\n// apply lighting in vertex shader instead of fragment shader\n// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting\nuniform float u_Ambient : 1.0;\nuniform float u_Diffuse : 1.0;\nuniform float u_Specular : 1.0;\nuniform int u_NumOfDirectionalLights : 1;\nuniform int u_NumOfSpotLights : 0;\n\n#define SHININESS 32.0\n#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3\n#define MAX_NUM_OF_SPOT_LIGHTS 3\n\nstruct DirectionalLight {\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n};\n\nstruct SpotLight {\n  vec3 position;\n  vec3 direction;\n  vec3 ambient;\n  vec3 diffuse;\n  vec3 specular;\n  float constant;\n  float linear;\n  float quadratic;\n  float angle;\n  float blur;\n  float exponent;\n};\n\nuniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];\nuniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];\n\nvec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {\n  vec3 lightDir = normalize(light.direction);\n  // diffuse shading\n  float diff = max(dot(normal, lightDir), 0.0);\n  // Blinn-Phong specular shading\n  vec3 halfwayDir = normalize(lightDir + viewDir);\n  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);\n\n  vec3 ambient = light.ambient * u_Ambient;\n  vec3 diffuse = light.diffuse * diff * u_Diffuse;\n  vec3 specular = light.specular * spec * u_Specular;\n\n  return ambient + diffuse + specular;\n}\n\n// vec3 calc_spot_light(SpotLight light, vec3 normal, vec3 fragPos, vec3 viewDir) {\n//   vec3 lightDir = normalize(light.position - fragPos);\n//   // diffuse shading\n//   float diff = max(dot(normal, lightDir), 0.0);\n//   // specular shading\n//   vec3 reflectDir = reflect(-lightDir, normal);\n//   float spec = pow(max(dot(viewDir, reflectDir), 0.0), SHININESS);\n//   // attenuation\n//   float distance = length(light.position - fragPos);\n//   float attenuation = 1.0 / (light.constant + light.linear * distance +\n//           light.quadratic * (distance * distance));\n\n//   vec3 ambient = light.ambient * u_Ambient;\n//   vec3 diffuse = light.diffuse * diff * u_Diffuse;\n//   vec3 specular = light.specular * spec * u_Specular;\n\n//   float spotEffect = dot(normalize(light.direction), -lightDir);\n//   float spotCosCutoff = cos(light.angle / 180.0 * PI);\n//   float spotCosOuterCutoff = cos((light.angle + light.blur) / 180.0 * PI);\n//   float spotCosInnerCutoff = cos((light.angle - light.blur) / 180.0 * PI);\n//   if (spotEffect > spotCosCutoff) {\n//     spotEffect = pow(smoothstep(spotCosOuterCutoff, spotCosInnerCutoff, spotEffect), light.exponent);\n//   } else {\n//     spotEffect = 0.0;\n//   }\n\n//   return ambient + attenuation * (spotEffect * diffuse + specular);\n// }\n\nvec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {\n  vec3 weight = vec3(0.0);\n  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {\n    if (i >= u_NumOfDirectionalLights) {\n      break;\n    }\n    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);\n  }\n  // for (int i = 0; i < MAX_NUM_OF_SPOT_LIGHTS; i++) {\n  //   if (i >= u_NumOfSpotLights) {\n  //     break;\n  //   }\n  //   weight += calc_spot_light(u_SpotLights[i], normal, position, viewDir);\n  // }\n  return weight;\n}\n",fs:""}),this.registerModule("light",{vs:"#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\n\nfloat calc_lighting(vec4 pos) {\n\n    vec3 worldPos = vec3(pos * u_ModelMatrix);\n\n    vec3 worldNormal = a_Normal;\n      // //cal light weight\n    vec3 viewDir = normalize(u_CameraPosition - worldPos);\n\n    vec3 lightDir = normalize(vec3(1, -10.5, 12));\n\n    vec3 halfDir = normalize(viewDir+lightDir);\n      // //lambert\n    float lambert = dot(worldNormal, lightDir);\n        //specular\n    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);\n        //sum to light weight\n    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;\n\n    return lightWeight;\n}\n",fs:""}),this.registerModule("picking",{vs:"attribute vec3 a_PickingColor;\nvarying vec4 v_PickingResult;\n\nuniform vec3 u_PickingColor : [0, 0, 0];\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\nuniform float u_PickingThreshold : 1.0;\nuniform float u_PickingBuffer: 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    abs(vertexColor.r - u_PickingColor.r) < u_PickingThreshold &&\n    abs(vertexColor.g - u_PickingColor.g) < u_PickingThreshold &&\n    abs(vertexColor.b - u_PickingColor.b) < u_PickingThreshold;\n}\n\nvoid setPickingColor(vec3 pickingColor) {\n  // compares only in highlight stage\n  v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && isVertexPicked(pickingColor));\n\n  // Stores the picking color so that the fragment shader can render it during picking\n  v_PickingResult.rgb = pickingColor * COLOR_SCALE;\n}\n\nfloat setPickingSize(float x) {\n   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;\n}\n\nfloat setPickingOrder(float z) {\n   bool selected = bool(v_PickingResult.a);\n   return selected ? z + 1. : 0.;\n}\n",fs:"varying vec4 v_PickingResult;\nuniform vec4 u_HighlightColor : [0, 0, 0, 0];\nuniform float u_PickingStage : 0.0;\n\n#define PICKING_NONE 0.0\n#define PICKING_ENCODE 1.0\n#define PICKING_HIGHLIGHT 2.0\n#define COLOR_SCALE 1. / 255.\n\n/*\n * Returns highlight color if this item is selected.\n */\nvec4 filterHighlightColor(vec4 color) {\n  bool selected = bool(v_PickingResult.a);\n\n  if (selected) {\n    vec4 highLightColor = u_HighlightColor * COLOR_SCALE;\n\n    float highLightAlpha = highLightColor.a;\n    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));\n\n    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);\n    return vec4(resultRGB, color.a);\n  } else {\n    return color;\n  }\n}\n\n/*\n * Returns picking color if picking enabled else unmodified argument.\n */\nvec4 filterPickingColor(vec4 color) {\n  vec3 pickingColor = v_PickingResult.rgb;\n  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {\n    discard;\n  }\n  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;\n}\n\n/*\n * Returns picking color if picking is enabled if not\n * highlight color if this item is selected, otherwise unmodified argument.\n */\nvec4 filterColor(vec4 color) {\n  return filterPickingColor(filterHighlightColor(color));\n}\n"}),this.registerModule("styleMapping",{vs:"attribute float a_vertexId;\n\nuniform mat4 u_cellTypeLayout;      // \u63cf\u8ff0\u6570\u636e\u7eb9\u7406 cell \u7ed3\u6784\u7684\u77e9\u9635\nuniform sampler2D u_dataTexture;    // \u6570\u636e\u7eb9\u7406\n\nbool hasOpacity() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 opacity \u7684\u6570\u636e\n  return u_cellTypeLayout[1][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeOpacity() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 strokeOpacity \u7684\u6570\u636e\n  return u_cellTypeLayout[1][1] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStrokeWidth() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 strokeWidth \u7684\u6570\u636e\n  return u_cellTypeLayout[1][2] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasStroke() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 stroke \u7684\u6570\u636e\n  return u_cellTypeLayout[1][3] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\nbool hasOffsets() { // \u5224\u65ad cell \u4e2d\u662f\u5426\u5b58\u5728 offsets \u7684\u6570\u636e\n  return u_cellTypeLayout[2][0] > 0.0 && u_cellTypeLayout[3][3] > 0.0;\n}\n\n// \u6839\u636e\u5750\u6807\u4f4d\u7f6e\u5148\u662f\u8ba1\u7b97 uv \uff0c\u7136\u540e\u6839\u636e uv \u4ece\u6570\u636e\u7eb9\u7406\u4e2d\u53d6\u503c\nfloat pos2value(vec2 pos, float columnWidth, float rowHeight) {\n  float u = (pos.r - 1.0) * columnWidth + columnWidth/2.0;\n  float v = 1.0 - ((pos.g - 1.0) * rowHeight + rowHeight/2.0);\n  return texture2D(u_dataTexture, vec2(u, v)).r;\n}\n\n/*\n  currentRow \u5f53\u524d\u884c\n  currentColumn \u5f53\u524d\u5217\n  columnCount \u6709\u591a\u5c11\u5217\n  nextStep \u9700\u8981\u8ba1\u7b97\u5f53\u524d cell \u540e\u7684\u7b2c\u51e0\u4e2a cell \uff08\u5f53\u524d cell \u5219 nextStep = 0\uff09\n*/\nvec2 nextPos(float currentRow, float currentColumn, float columnCount, float nextStep) {\n  float nextColumn = currentColumn;\n  float nextRow = currentRow;\n  if(currentColumn + nextStep <= columnCount){\n    nextColumn = currentColumn + nextStep;\n  } else {\n    nextColumn = mod(currentColumn + nextStep, columnCount); // \u4e0d\u4f1a\u51fa\u73b0\u8de8\u4e24\u884c\n    nextRow = currentRow + 1.0;\n  }\n  return vec2(nextColumn, nextRow);\n}\n\n// \u8ba1\u7b97\u5f53\u524d\u5355\u4e2a cell \u7684\u5927\u5c0f\nfloat calCellCount() { \n  //   u_cellTypeLayout\n  //   cal_height, WIDTH, 0.0, 0.0, // rowCount columnCount - \u51e0\u884c\u51e0\u5217\n  //   1.0, 1.0, 1.0, 0.0, // opacity strokeOpacity strokeWidth stroke - 1.0 \u8868\u793a\u6709\u6570\u636e\u6620\u5c04\u30010.0 \u8868\u793a\u6ca1\u6709\n  //   1.0, 0.0, 0.0, 0.0, // offsets\n  //   0.0, 0.0, 0.0, 0.0\n  \n  return  u_cellTypeLayout[1][0] +        // opacity\n          u_cellTypeLayout[1][1] +        // strokeOpacity\n          u_cellTypeLayout[1][2] +        // strokeWidth\n          u_cellTypeLayout[1][3] * 4.0 +  // stroke\n          u_cellTypeLayout[2][0] * 2.0;   // offsets\n}",fs:""}),this.registerModule("styleMappingCalOpacity",{vs:"\n// \u8ba1\u7b97 opacity \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasOpacity()) { // \u6570\u636e\u7eb9\u7406\u4e2d\u4e0d\u5b58\u5728 opacity \u7684\u65f6\u5019\u53d6\u9ed8\u8ba4\u503c\uff08\u7528\u6237\u5728 style \u4e2d\u4f20\u5165\u7684\u662f\u5e38\u91cf\uff09\n    return vec2(u_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeOpacity",{vs:"\n// \u8ba1\u7b97 strokeOpaicty \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calStrokeOpacityAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeOpacity()) {\n    return vec2(u_stroke_opacity, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeOpacity = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeOpacity, textureOffset + 1.0);\n  }\n}\n",fs:""}),this.registerModule("styleMappingCalStrokeWidth",{vs:"\n// \u8ba1\u7b97 strokeWidth \u548c\u6807\u793a\u5728 cell \u4e2d\u53d6\u503c\u4f4d\u7f6e\u7684\u504f\u79fb\u91cf textureOffset\nvec2 calStrokeWidthAndOffset(float cellCurrentRow, float cellCurrentColumn, float columnCount, float textureOffset, float columnWidth, float rowHeight) {\n  if(!hasStrokeWidth()) {\n    return vec2(u_stroke_width, textureOffset);\n  } else {\n    vec2 valuePos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    float textureStrokeWidth = pos2value(valuePos, columnWidth, rowHeight);\n    return vec2(textureStrokeWidth, textureOffset + 1.0);\n  }\n}\n",fs:""})}},{key:"registerModule",value:function(L,D){if(!this.rawContentCache[L]){var Se=D.fs,ct=D.uniforms,Pt=nc(D.vs),bt=Pt.content,rr=Pt.uniforms,jr=nc(Se),Xn=jr.uniforms;this.rawContentCache[L]={fs:jr.content,uniforms:yu(yu(yu({},rr),Xn),ct),vs:bt}}}},{key:"destroy",value:function(){this.moduleCache={},this.rawContentCache={}}},{key:"getModule",value:function(L){var D=this;if(this.moduleCache[L])return this.moduleCache[L];var Se=this.rawContentCache[L].fs,ct=this.processModule(this.rawContentCache[L].vs,[],"vs"),Pt=ct.content,bt=ct.includeList,rr=this.processModule(Se,[],"fs"),jr=rr.content,Mn=rr.includeList,Xn=jr,ni=Ju()(bt.concat(Mn).concat(L)).reduce(function(Ci,wi){return yu(yu({},Ci),D.rawContentCache[wi].uniforms)},{});return ic.test(jr)||(Xn="#ifdef GL_FRAGMENT_PRECISION_HIGH\n precision highp float;\n #else\n precision mediump float;\n#endif\n"+jr),this.moduleCache[L]={fs:Xn.trim(),uniforms:ni,vs:Pt.trim()},this.moduleCache[L]}},{key:"processModule",value:function(L,D,fe){var Se=this;return{content:L.replace(uf,function(Pt,bt){var jr=bt.split(" ")[0].replace(/"/g,"");if(D.indexOf(jr)>-1)return"";var Mn=Se.rawContentCache[jr][fe];return D.push(jr),Se.processModule(Mn,D,fe).content}),includeList:D}}}]),$}())||Ac;function nu($,ee,L){return(nu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(fe,Se,ct){var Pt=function($,ee){for(;!Object.prototype.hasOwnProperty.call($,ee)&&null!==($=(0,Yt.Z)($)););return $}(fe,Se);if(Pt){var bt=Object.getOwnPropertyDescriptor(Pt,Se);return bt.get?bt.get.call(ct):bt.value}})($,ee,L||$)}var js,zl,ac,oc,Zu,$a,Au=M(55576),ns=(js=(0,_.b2)(),zl=(0,_.f3)(X.v.IShaderModuleService),js((oc=function(){function $(){(0,q.Z)(this,$),(0,ce.Z)(this,"shaderModuleService",Zu,this),(0,Y.Z)(this,"rendererService",void 0),(0,Y.Z)(this,"cameraService",void 0),(0,Y.Z)(this,"mapService",void 0),(0,Y.Z)(this,"interactionService",void 0),(0,Y.Z)(this,"layerService",void 0),(0,Y.Z)(this,"config",void 0)}return(0,te.Z)($,[{key:"getName",value:function(){return""}},{key:"getType",value:function(){return Au.G.Normal}},{key:"init",value:function(L,D){this.config=D,this.rendererService=L.getContainer().get(X.v.IRendererService),this.cameraService=L.getContainer().get(X.v.ICameraService),this.mapService=L.getContainer().get(X.v.IMapService),this.interactionService=L.getContainer().get(X.v.IInteractionService),this.layerService=L.getContainer().get(X.v.ILayerService)}},{key:"render",value:function(L){}}]),$}(),Zu=(0,Te.Z)(oc.prototype,"shaderModuleService",[zl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ac=oc))||ac);var sa,ja,Ss,Ul,Uu,Pu=(0,_.b2)()($a=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"getName",value:function(){return"clear"}},{key:"init",value:function(fe,Se){nu((0,Yt.Z)(L.prototype),"init",this).call(this,fe,Se)}},{key:"render",value:function(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}]),L}(ns))||$a;function Ic($,ee){var L="undefined"!=typeof Symbol&&$[Symbol.iterator]||$["@@iterator"];if(!L){if(Array.isArray($)||(L=function($,ee){if($){if("string"==typeof $)return lf($,undefined);var L=Object.prototype.toString.call($).slice(8,-1);if("Object"===L&&$.constructor&&(L=$.constructor.name),"Map"===L||"Set"===L)return Array.from($);if("Arguments"===L||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(L))return lf($,undefined)}}($))||ee&&$&&"number"==typeof $.length){L&&($=L);var D=0,fe=function(){};return{s:fe,n:function(){return D>=$.length?{done:!0}:{done:!1,value:$[D++]}},e:function(rr){throw rr},f:fe}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var Pt,Se=!0,ct=!1;return{s:function(){L=L.call($)},n:function(){var rr=L.next();return Se=rr.done,rr},e:function(rr){ct=!0,Pt=rr},f:function(){try{!Se&&null!=L.return&&L.return()}finally{if(ct)throw Pt}}}}function lf($,ee){(null==ee||ee>$.length)&&(ee=$.length);for(var L=0,D=new Array(ee);L<ee;L++)D[L]=$[L];return D}var _u,Vl=(sa=(0,_.b2)(),ja=(0,_.f3)(X.v.IPostProcessor),sa((Ul=function(){function $(){(0,q.Z)(this,$),(0,Y.Z)(this,"passes",[]),(0,ce.Z)(this,"postProcessor",Uu,this),(0,Y.Z)(this,"layer",void 0),(0,Y.Z)(this,"renderFlag",void 0),(0,Y.Z)(this,"width",0),(0,Y.Z)(this,"height",0)}return(0,te.Z)($,[{key:"setLayer",value:function(L){this.layer=L}},{key:"setRenderFlag",value:function(L){this.renderFlag=L}},{key:"getRenderFlag",value:function(){return this.renderFlag}},{key:"getPostProcessor",value:function(){return this.postProcessor}},{key:"render",value:(ee=(0,Ho.Z)(Wi().mark(function D(){var fe,Se,ct;return Wi().wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:fe=Ic(this.passes),bt.prev=1,fe.s();case 3:if((Se=fe.n()).done){bt.next=9;break}return ct=Se.value,bt.next=7,ct.render(this.layer);case 7:bt.next=3;break;case 9:bt.next=14;break;case 11:bt.prev=11,bt.t0=bt.catch(1),fe.e(bt.t0);case 14:return bt.prev=14,fe.f(),bt.finish(14);case 17:this.layer.renderModels();case 18:case"end":return bt.stop()}},D,this,[[1,11,14,17]])})),function(){return ee.apply(this,arguments)})},{key:"resize",value:function(L,D){(this.width!==L||this.height!==D)&&(this.width=L,this.height=D)}},{key:"add",value:function(L,D){L.getType()===Au.G.PostProcessing?this.postProcessor.add(L,this.layer,D):(L.init(this.layer,D),this.passes.push(L))}},{key:"insert",value:function(L,D,fe){L.init(this.layer,D),this.passes.splice(fe,0,L)}},{key:"destroy",value:function(){this.passes.length=0}}]),$;var ee}(),Uu=(0,Te.Z)(Ul.prototype,"postProcessor",[ja],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ss=Ul))||Ss);function wo($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function gl($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?wo(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):wo(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var _l,Bn=(0,_.b2)()(_u=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){var D;(0,q.Z)(this,L);for(var fe=arguments.length,Se=new Array(fe),ct=0;ct<fe;ct++)Se[ct]=arguments[ct];return D=ee.call.apply(ee,[this].concat(Se)),(0,Y.Z)((0,Le.Z)(D),"pickingFBO",void 0),(0,Y.Z)((0,Le.Z)(D),"layer",void 0),(0,Y.Z)((0,Le.Z)(D),"width",0),(0,Y.Z)((0,Le.Z)(D),"height",0),(0,Y.Z)((0,Le.Z)(D),"alreadyInRendering",!1),(0,Y.Z)((0,Le.Z)(D),"pickFromPickingFBO",function(Pt){var bt=Pt.x,rr=Pt.y,jr=Pt.lngLat,Mn=Pt.type;if(D.layer.isVisible()&&D.layer.needPick(Mn)){var la,Xn=D.rendererService,Ci=Xn.readPixels,wi=Xn.useFramebuffer,ea=(0,Xn.getViewportSize)(),xa=ea.width,ua=ea.height,Ha=D.layer.getLayerConfig(),Wa=Ha.enableHighlight,Ka=Ha.enableSelect,ia=bt*Xe.SO.DPR,ga=rr*Xe.SO.DPR;ia>xa||ia<0||ga>ua||ga<0||wi(D.pickingFBO,function(){var no;if(0!==(la=Ci({x:Math.round(ia),y:Math.round(ua-(rr+1)*Xe.SO.DPR),width:1,height:1,data:new Uint8Array(4),framebuffer:D.pickingFBO}))[0]||0!==la[1]||0!==la[2]){var Li=(0,Xe.W0)(la),Ca=D.layer.getSource().getFeatureById(Li),ba={x:bt,y:rr,type:Mn,lngLat:jr,featureId:Li,feature:Ca};Ca&&(D.layer.setCurrentPickId(Li),D.triggerHoverOnLayer(ba))}else{var go={x:bt,y:rr,lngLat:jr,type:null===D.layer.getCurrentPickId()?"un"+Mn:"mouseout",featureId:null,feature:null};D.triggerHoverOnLayer(gl(gl({},go),{},{type:"unpick"})),D.triggerHoverOnLayer(go),D.layer.setCurrentPickId(null)}Wa&&D.highlightPickedFeature(la),Ka&&"click"===Mn&&(null===(no=la)||void 0===no?void 0:no.toString())!==[0,0,0,0].toString()&&D.selectFeature(la)})}}),D}return(0,te.Z)(L,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"pixelPicking"}},{key:"init",value:function(fe,Se){nu((0,Yt.Z)(L.prototype),"init",this).call(this,fe,Se),this.layer=fe;var ct=this.rendererService,Pt=ct.createTexture2D,bt=ct.createFramebuffer,jr=(0,ct.getViewportSize)();this.pickingFBO=bt({color:Pt({width:jr.width,height:jr.height,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.interactionService.on(oi.s.Hover,this.pickFromPickingFBO),this.interactionService.on(oi.s.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(oi.s.Active,this.highlightFeatureHandle.bind(this))}},{key:"render",value:function(fe){var Se=this;if(!this.alreadyInRendering){var ct=this.rendererService,bt=ct.useFramebuffer,rr=ct.clear,jr=(0,ct.getViewportSize)(),Mn=jr.width,Xn=jr.height;this.alreadyInRendering=!0,(this.width!==Mn||this.height!==Xn)&&(this.pickingFBO.resize({width:Mn,height:Xn}),this.width=Mn,this.height=Xn),bt(this.pickingFBO,function(){rr({framebuffer:Se.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});var ni=Se.layer.multiPassRenderer.getRenderFlag();Se.layer.multiPassRenderer.setRenderFlag(!1),fe.hooks.beforePickingEncode.call(),fe.render(),fe.hooks.afterPickingEncode.call(),Se.layer.multiPassRenderer.setRenderFlag(ni),Se.alreadyInRendering=!1})}}},{key:"triggerHoverOnLayer",value:function(fe){this.layer.emit(fe.type,fe)}},{key:"highlightPickedFeature",value:function(fe){var Se=(0,Ot.Z)(fe,3);this.layer.hooks.beforeHighlight.call([Se[0],Se[1],Se[2]]),this.layerService.renderLayers()}},{key:"selectFeature",value:function(fe){var Se=(0,Ot.Z)(fe,3);this.layer.hooks.beforeSelect.call([Se[0],Se[1],Se[2]]),this.layerService.renderLayers()}},{key:"selectFeatureHandle",value:function(fe){var ct=(0,Xe.Z6)(fe.featureId);this.selectFeature(new Uint8Array(ct))}},{key:"highlightFeatureHandle",value:function(fe){var ct=(0,Xe.Z6)(fe.featureId);this.highlightPickedFeature(new Uint8Array(ct))}}]),L}(ns))||_u,za=M(20051);function iu($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function Es($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?iu(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):iu(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var Ts,xl=(0,_.b2)()(_l=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var fe=this.shaderModuleService.getModule("blur-pass"),Se=fe.vs,ct=fe.fs,Pt=fe.uniforms,bt=this.rendererService.getViewportSize(),rr=bt.width,jr=bt.height;return{vs:Se,fs:ct,uniforms:Es(Es({},Pt),{},{u_ViewportSize:[rr,jr]})}}},{key:"convertOptionsToUniforms",value:function(fe){var Se={};return ko()(fe.blurRadius)||(Se.u_BlurDir=[fe.blurRadius,0]),Se}}]),L}(za.Z))||_l;function sc($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function au($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?sc(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):sc(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var Ws,cf=(0,_.b2)()(Ts=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("blur-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_BlurDir: [1.0, 0.0];\n\n// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n  vec4 color = vec4(0.0);\n  vec2 off1 = vec2(1.3846153846) * direction;\n  vec2 off2 = vec2(3.2307692308) * direction;\n  color += texture2D(image, uv) * 0.2270270270;\n  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);\n}"});var fe=this.shaderModuleService.getModule("blur-pass"),Se=fe.vs,ct=fe.fs,Pt=fe.uniforms,bt=this.rendererService.getViewportSize(),rr=bt.width,jr=bt.height;return{vs:Se,fs:ct,uniforms:au(au({},Pt),{},{u_ViewportSize:[rr,jr]})}}},{key:"convertOptionsToUniforms",value:function(fe){var Se={};return ko()(fe.blurRadius)||(Se.u_BlurDir=[0,fe.blurRadius]),Se}}]),L}(za.Z))||Ts;function Cs($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function $i($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?Cs(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):Cs(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var mo,bu=(0,_.b2)()(Ws=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:'varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Angle : 0;\nuniform float u_Size : 8;\n\n#pragma include "common"\n\nfloat scale = PI / u_Size;\n\nfloat pattern(float u_Angle, vec2 texSize, vec2 texCoord) {\n  float s = sin(u_Angle), c = cos(u_Angle);\n  vec2 tex = texCoord * texSize - u_Center * texSize;\n  vec2 point = vec2(\n    c * tex.x - s * tex.y,\n    s * tex.x + c * tex.y\n  ) * scale;\n  return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js\nvec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {\n  vec3 cmy = 1.0 - color.rgb;\n  float k = min(cmy.x, min(cmy.y, cmy.z));\n  cmy = (cmy - k) / (1.0 - k);\n  cmy = clamp(\n    cmy * 10.0 - 3.0 + vec3(\n      pattern(u_Angle + 0.26179, texSize, texCoord),\n      pattern(u_Angle + 1.30899, texSize, texCoord),\n      pattern(u_Angle, texSize, texCoord)\n    ),\n    0.0,\n    1.0\n  );\n  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);\n  return vec4(1.0 - cmy - k, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);\n}'});var fe=this.shaderModuleService.getModule("colorhalftone-pass"),Se=fe.vs,ct=fe.fs,Pt=fe.uniforms,bt=this.rendererService.getViewportSize(),rr=bt.width,jr=bt.height;return{vs:Se,fs:ct,uniforms:$i($i({},Pt),{},{u_ViewportSize:[rr,jr]})}}}]),L}(za.Z))||Ws;var Po,So=(0,_.b2)()(mo=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("copy-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}"}),this.shaderModuleService.getModule("copy-pass")}}]),L}(za.Z))||mo;function fo($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function jl($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?fo(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):fo(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var ys,As=(0,_.b2)()(Po=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform vec2 u_Center : [0.5, 0.5];\nuniform float u_Scale : 10;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js\nvec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;\n  tex.y /= 0.866025404;\n  tex.x -= tex.y * 0.5;\n  vec2 a;\n  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {\n    a = vec2(floor(tex.x), floor(tex.y));\n  }\n  else a = vec2(ceil(tex.x), ceil(tex.y));\n  vec2 b = vec2(ceil(tex.x), floor(tex.y));\n  vec2 c = vec2(floor(tex.x), ceil(tex.y));\n  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);\n  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);\n  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);\n  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);\n  float alen = length(TEX - A);\n  float blen = length(TEX - B);\n  float clen = length(TEX - C);\n  vec2 choice;\n  if (alen < blen) {\n    if (alen < clen) choice = a;\n    else choice = c;\n  } else {\n    if (blen < clen) choice = b;\n    else choice = c;\n  }\n  choice.x += choice.y * 0.5;\n  choice.y *= 0.866025404;\n  choice *= u_Scale / texSize;\n  return texture2D(texture, choice + u_Center);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var fe=this.shaderModuleService.getModule("hexagonalpixelate-pass"),Se=fe.vs,ct=fe.fs,Pt=fe.uniforms,bt=this.rendererService.getViewportSize(),rr=bt.width,jr=bt.height;return{vs:Se,fs:ct,uniforms:jl(jl({},Pt),{},{u_ViewportSize:[rr,jr]})}}}]),L}(za.Z))||Po;function is($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function al($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?is(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):is(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var ol,Kc=(0,_.b2)()(ys=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"setupShaders",value:function(){this.shaderModuleService.registerModule("ink-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform vec2 u_ViewportSize: [1.0, 1.0];\nuniform float u_Strength : 0.6;\n\nvec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {\n  vec2 dx = vec2(1.0 / texSize.x, 0.0);\n  vec2 dy = vec2(0.0, 1.0 / texSize.y);\n  vec4 color = texture2D(texture, texCoord);\n  float bigTotal = 0.0;\n  float smallTotal = 0.0;\n  vec3 bigAverage = vec3(0.0);\n  vec3 smallAverage = vec3(0.0);\n  for (float x = -2.0; x <= 2.0; x += 1.0) {\n    for (float y = -2.0; y <= 2.0; y += 1.0) {\n      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;\n      bigAverage += sample;\n      bigTotal += 1.0;\n      if (abs(x) + abs(y) < 2.0) {\n        smallAverage += sample;\n        smallTotal += 1.0;\n      }\n    }\n  }\n  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);\n  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;\n  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);\n}"});var fe=this.shaderModuleService.getModule("ink-pass"),Se=fe.vs,ct=fe.fs,Pt=fe.uniforms,bt=this.rendererService.getViewportSize(),rr=bt.width,jr=bt.height;return{vs:Se,fs:ct,uniforms:al(al({},Pt),{},{u_ViewportSize:[rr,jr]})}}}]),L}(za.Z))||ys;var Rc,Gu=(0,_.b2)()(ol=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("noise-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\nuniform float u_Amount : 0.5;\n\nfloat rand(vec2 co) {\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js\nvec4 noise_filterColor(vec4 color, vec2 texCoord) {\n  float diff = (rand(texCoord) - 0.5) * u_Amount;\n  color.r += diff;\n  color.g += diff;\n  color.b += diff;\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);\n}"}),this.shaderModuleService.getModule("noise-pass")}}]),L}(za.Z))||ol;var o,h,y,S,C,k,Ee,s=(0,_.b2)()(Rc=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"setupShaders",value:function(){return this.shaderModuleService.registerModule("sepia-pass",{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:"varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nuniform float u_Amount : 0.5;\n\n// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js\nvec4 sepia_filterColor(vec4 color) {\n  float r = color.r;\n  float g = color.g;\n  float b = color.b;\n  color.r =\n    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));\n  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));\n  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));\n  return color;\n}\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n  gl_FragColor = sepia_filterColor(gl_FragColor);\n}"}),this.shaderModuleService.getModule("sepia-pass")}}]),L}(za.Z))||Rc,K=(o=(0,_.b2)(),h=(0,_.f3)(X.v.IRendererService),y=(0,_.zY)(),o((C=function(){function $(){(0,q.Z)(this,$),(0,ce.Z)(this,"rendererService",k,this),(0,Y.Z)(this,"passes",[]),(0,Y.Z)(this,"readFBO",void 0),(0,Y.Z)(this,"writeFBO",void 0)}return(0,te.Z)($,[{key:"getReadFBO",value:function(){return this.readFBO}},{key:"getWriteFBO",value:function(){return this.writeFBO}},{key:"render",value:(ee=(0,Ho.Z)(Wi().mark(function D(fe){var Se,ct;return Wi().wrap(function(bt){for(;;)switch(bt.prev=bt.next){case 0:Se=0;case 1:if(!(Se<this.passes.length)){bt.next=10;break}return(ct=this.passes[Se]).setRenderToScreen(this.isLastEnabledPass(Se)),bt.next=6,ct.render(fe);case 6:Se!==this.passes.length-1&&this.swap();case 7:Se++,bt.next=1;break;case 10:case"end":return bt.stop()}},D,this)})),function(D){return ee.apply(this,arguments)})},{key:"resize",value:function(L,D){this.readFBO.resize({width:L,height:D}),this.writeFBO.resize({width:L,height:D})}},{key:"add",value:function(L,D,fe){L.init(D,fe),this.passes.push(L)}},{key:"insert",value:function(L,D,fe,Se){L.init(fe,Se),this.passes.splice(D,0,L)}},{key:"getPostProcessingPassByName",value:function(L){return this.passes.find(function(D){return D.getName()===L})}},{key:"init",value:function(){}},{key:"isLastEnabledPass",value:function(L){for(var D=L+1;D<this.passes.length;D++)if(this.passes[D].isEnabled())return!1;return!0}},{key:"swap",value:function(){var L=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=L}}]),$;var ee}(),k=(0,Te.Z)(C.prototype,"rendererService",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),(0,Te.Z)(C.prototype,"init",[y],Object.getOwnPropertyDescriptor(C.prototype,"init"),C.prototype),S=C))||S);var We,st,je,at,xt,Ke=(0,_.b2)()(Ee=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){return(0,q.Z)(this,L),ee.apply(this,arguments)}return(0,te.Z)(L,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"render"}},{key:"init",value:function(fe,Se){nu((0,Yt.Z)(L.prototype),"init",this).call(this,fe,Se)}},{key:"render",value:function(fe){var Se=this.rendererService,Pt=Se.clear;(0,Se.useFramebuffer)(null,function(){Pt({color:[0,0,0,0],depth:1,stencil:0}),fe.multiPassRenderer.setRenderFlag(!1),fe.render(),fe.multiPassRenderer.setRenderFlag(!0)})}}]),L}(ns))||Ee;function zt($,ee){var L=Object.keys($);if(Object.getOwnPropertySymbols){var D=Object.getOwnPropertySymbols($);ee&&(D=D.filter(function(fe){return Object.getOwnPropertyDescriptor($,fe).enumerable})),L.push.apply(L,D)}return L}function or($){for(var ee=1;ee<arguments.length;ee++){var L=null!=arguments[ee]?arguments[ee]:{};ee%2?zt(Object(L),!0).forEach(function(D){(0,Y.Z)($,D,L[D])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(L)):zt(Object(L)).forEach(function(D){Object.defineProperty($,D,Object.getOwnPropertyDescriptor(L,D))})}return $}var $r="varying vec2 v_UV;\n\nuniform sampler2D u_Texture;\n\nvoid main() {\n  gl_FragColor = vec4(texture2D(u_Texture, v_UV));\n}";function pn($,ee){for(var L=0,D=1/ee,fe=$;fe>0;)L+=D*(fe%ee),fe=Math.floor(fe/ee),D/=ee;return L}var qn=1,Un=(We=(0,_.b2)(),st=(0,_.f3)(X.v.IShaderModuleService),We((at=function($){(0,Wt.Z)(L,$);var ee=function($){var ee=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch($){return!1}}();return function(){var fe,D=(0,Yt.Z)($);if(ee){var Se=(0,Yt.Z)(this).constructor;fe=Reflect.construct(D,arguments,Se)}else fe=D.apply(this,arguments);return(0,Ar.Z)(this,fe)}}(L);function L(){var D;(0,q.Z)(this,L);for(var fe=arguments.length,Se=new Array(fe),ct=0;ct<fe;ct++)Se[ct]=arguments[ct];return D=ee.call.apply(ee,[this].concat(Se)),(0,ce.Z)((0,Le.Z)(D),"shaderModuleService",xt,(0,Le.Z)(D)),(0,Y.Z)((0,Le.Z)(D),"haltonSequence",[]),(0,Y.Z)((0,Le.Z)(D),"accumulatingId",0),(0,Y.Z)((0,Le.Z)(D),"frame",0),(0,Y.Z)((0,Le.Z)(D),"timer",void 0),(0,Y.Z)((0,Le.Z)(D),"sampleRenderTarget",void 0),(0,Y.Z)((0,Le.Z)(D),"prevRenderTarget",void 0),(0,Y.Z)((0,Le.Z)(D),"outputRenderTarget",void 0),(0,Y.Z)((0,Le.Z)(D),"copyRenderTarget",void 0),(0,Y.Z)((0,Le.Z)(D),"blendModel",void 0),(0,Y.Z)((0,Le.Z)(D),"outputModel",void 0),(0,Y.Z)((0,Le.Z)(D),"copyModel",void 0),D}return(0,te.Z)(L,[{key:"getType",value:function(){return Au.G.Normal}},{key:"getName",value:function(){return"taa"}},{key:"init",value:function(fe,Se){nu((0,Yt.Z)(L.prototype),"init",this).call(this,fe,Se);var ct=this.rendererService,Pt=ct.createFramebuffer,bt=ct.createTexture2D;this.sampleRenderTarget=Pt({color:bt({width:1,height:1,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.prevRenderTarget=Pt({color:bt({width:1,height:1,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.outputRenderTarget=Pt({color:bt({width:1,height:1,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})}),this.copyRenderTarget=Pt({color:bt({width:1,height:1,wrapS:Fi.gl.CLAMP_TO_EDGE,wrapT:Fi.gl.CLAMP_TO_EDGE})});for(var rr=0;rr<30;rr++)this.haltonSequence.push([pn(rr,2),pn(rr,3)]);this.blendModel=this.createTriangleModel("blend-pass","uniform float u_opacity : 1.0;\nuniform float u_MixRatio : 0.5;\n\nuniform sampler2D u_Diffuse1;\nuniform sampler2D u_Diffuse2;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  vec4 texel1 = texture2D(u_Diffuse1, v_UV);\n  vec4 texel2 = texture2D(u_Diffuse2, v_UV);\n  gl_FragColor = u_opacity * mix(texel1, texel2, u_MixRatio);\n}\n"),this.outputModel=this.createTriangleModel("copy-pass",$r,{blend:{enable:!0,func:{srcRGB:Fi.gl.ONE,dstRGB:Fi.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:Fi.gl.ONE,dstAlpha:Fi.gl.ONE_MINUS_SRC_ALPHA},equation:{rgb:Fi.gl.FUNC_ADD,alpha:Fi.gl.FUNC_ADD}}}),this.copyModel=this.createTriangleModel("copy-pass",$r)}},{key:"render",value:function(fe){var Se=this,ct=this.rendererService,Pt=ct.clear,rr=ct.useFramebuffer,jr=(0,ct.getViewportSize)(),Mn=jr.width,Xn=jr.height;this.sampleRenderTarget.resize({width:Mn,height:Xn}),this.prevRenderTarget.resize({width:Mn,height:Xn}),this.outputRenderTarget.resize({width:Mn,height:Xn}),this.copyRenderTarget.resize({width:Mn,height:Xn}),this.resetFrame(),this.stopAccumulating();var ni=fe.multiPassRenderer.getPostProcessor().getReadFBO();rr(ni,function(){Pt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:ni}),fe.multiPassRenderer.setRenderFlag(!1),fe.render(),fe.multiPassRenderer.setRenderFlag(!0)});var Ci=function wi(ea){!Se.accumulatingId||ea!==Se.accumulatingId||Se.isFinished()||(Se.doRender(fe),requestAnimationFrame(function(){wi(ea)}))};this.accumulatingId=qn++,this.timer=window.setTimeout(function(){Ci(Se.accumulatingId)},50)}},{key:"doRender",value:function(fe){var Se=this,ct=this.rendererService,Pt=ct.clear,rr=ct.useFramebuffer,jr=(0,ct.getViewportSize)(),Mn=jr.width,Xn=jr.height,Ci=fe.getLayerConfig().jitterScale,wi=void 0===Ci?1:Ci,ea=this.haltonSequence[this.frame%this.haltonSequence.length];this.cameraService.jitterProjectionMatrix((2*ea[0]-1)/Mn*wi,(2*ea[1]-1)/Xn*wi),fe.multiPassRenderer.setRenderFlag(!1),fe.hooks.beforeRender.call(),rr(this.sampleRenderTarget,function(){Pt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:Se.sampleRenderTarget}),fe.render()}),fe.hooks.afterRender.call(),fe.multiPassRenderer.setRenderFlag(!0);var xa=fe.getLayerConfig();rr(this.outputRenderTarget,function(){Se.blendModel.draw({uniforms:{u_opacity:xa.opacity||1,u_MixRatio:0===Se.frame?1:.9,u_Diffuse1:Se.sampleRenderTarget,u_Diffuse2:0===Se.frame?fe.multiPassRenderer.getPostProcessor().getReadFBO():Se.prevRenderTarget}})}),0===this.frame&&Pt({color:[0,0,0,0],depth:1,stencil:0,framebuffer:this.copyRenderTarget}),this.frame>=1&&(rr(this.copyRenderTarget,function(){Se.outputModel.draw({uniforms:{u_Texture:Se.outputRenderTarget}})}),rr(fe.multiPassRenderer.getPostProcessor().getReadFBO(),function(){Se.copyModel.draw({uniforms:{u_Texture:Se.copyRenderTarget}})}),fe.multiPassRenderer.getPostProcessor().render(fe));var ua=this.prevRenderTarget;this.prevRenderTarget=this.outputRenderTarget,this.outputRenderTarget=ua,this.frame++,this.cameraService.clearJitterProjectionMatrix()}},{key:"isFinished",value:function(){return this.frame>=this.haltonSequence.length}},{key:"resetFrame",value:function(){this.frame=0}},{key:"stopAccumulating",value:function(){this.accumulatingId=0,window.clearTimeout(this.timer)}},{key:"createTriangleModel",value:function(fe,Se,ct){this.shaderModuleService.registerModule(fe,{vs:"attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}",fs:Se});var Pt=this.shaderModuleService.getModule(fe),jr=Pt.uniforms,Mn=this.rendererService;return(0,Mn.createModel)(or({vs:Pt.vs,fs:Pt.fs,attributes:{a_Position:(0,Mn.createAttribute)({buffer:(0,Mn.createBuffer)({data:[-4,-4,4,-4,0,4],type:Fi.gl.FLOAT}),size:2})},uniforms:or({},jr),depth:{enable:!1},count:3},ct))}}]),L}(ns),xt=(0,Te.Z)(at.prototype,"shaderModuleService",[st],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),je=at))||je),Rn=new _.W2;Rn.bind(X.v.IGlobalConfigService).to(Me).inSingletonScope(),Rn.bind(X.v.IShaderModuleService).to(Cu).inSingletonScope(),(0,_.GW)((0,_.b2)(),w.EventEmitter),Rn.bind(X.v.IEventEmitter).to(w.EventEmitter);var ki=(0,W.Z)(Rn,!1),kn=function(ee){var L=ki.lazyInject(ee);return function(D,fe,Se){L.call(this,D,fe),Se&&(Se.initializer=function(){return D[fe]})}};const Vi=Rn;var li=0;function yi(){var $=new _.W2;return $.parent=Rn,$.bind(X.v.SceneID).toConstantValue("".concat(li++)),$.bind(X.v.ILayerService).to(Eu).inSingletonScope(),$.bind(X.v.ISceneService).to(Bu).inSingletonScope(),$.bind(X.v.ICameraService).to(St).inSingletonScope(),$.bind(X.v.ICoordinateSystemService).to(gn).inSingletonScope(),$.bind(X.v.IInteractionService).to(to).inSingletonScope(),$.bind(X.v.IPickingService).to(Fe).inSingletonScope(),$.bind(X.v.IControlService).to(er).inSingletonScope(),$.bind(X.v.IMarkerService).to(Wn).inSingletonScope(),$.bind(X.v.IIconService).to(dt).inSingletonScope(),$.bind(X.v.IFontService).to(nt).inSingletonScope(),$.bind(X.v.IPopupService).to(si).inSingletonScope(),$.bind(X.v.INormalPass).to(Pu).whenTargetNamed("clear"),$.bind(X.v.INormalPass).to(Bn).whenTargetNamed("pixelPicking"),$.bind(X.v.INormalPass).to(Ke).whenTargetNamed("render"),$.bind(X.v.INormalPass).to(Un).whenTargetNamed("taa"),$.bind(X.v.IFactoryNormalPass).toFactory(function(ee){return function(L){return ee.container.getNamed(X.v.INormalPass,L)}}),$.bind(X.v.IPostProcessingPass).to(So).whenTargetNamed("copy"),$.bind(X.v.IPostProcessingPass).to(xl).whenTargetNamed("blurH"),$.bind(X.v.IPostProcessingPass).to(cf).whenTargetNamed("blurV"),$.bind(X.v.IPostProcessingPass).to(Gu).whenTargetNamed("noise"),$.bind(X.v.IPostProcessingPass).to(s).whenTargetNamed("sepia"),$.bind(X.v.IPostProcessingPass).to(bu).whenTargetNamed("colorHalftone"),$.bind(X.v.IPostProcessingPass).to(As).whenTargetNamed("hexagonalPixelate"),$.bind(X.v.IPostProcessingPass).to(Kc).whenTargetNamed("ink"),$.bind(X.v.IFactoryPostProcessingPass).toFactory(function(ee){return function(L){var D=ee.container.getNamed(X.v.IPostProcessingPass,L);return D.setName(L),D}}),$}function Ni($){var ee=new _.W2;return ee.parent=$,ee.bind(X.v.IStyleAttributeService).to(Rl).inSingletonScope(),ee.bind(X.v.IMultiPassRenderer).to(Vl).inSingletonScope(),ee.bind(X.v.IPostProcessor).to(K).inSingletonScope(),ee}},22115:()=>{},21236:()=>{},40646:(dr,H,M)=>{"use strict";M.d(H,{l:()=>ue});var ue={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"}},59304:(dr,H,M)=>{"use strict";M.d(H,{d:()=>ue});var ue=(()=>{return(w=ue||(ue={})).TOPRIGHT="topright",w.TOPLEFT="topleft",w.BOTTOMRIGHT="bottomright",w.BOTTOMLEFT="bottomleft",w.TOPCENTER="topcenter",w.BOTTOMCENTER="bottomcenter",w.LEFTCENTER="leftcenter",w.RIGHTCENTER="rightcenter",ue;var w})()},35323:()=>{},35393:()=>{},24495:()=>{},62306:(dr,H,M)=>{"use strict";M.d(H,{l:()=>ue,k:()=>w});var ue=(()=>{return(p=ue||(ue={}))[p.LNGLAT=1]="LNGLAT",p[p.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",p[p.VECTOR_TILE=3]="VECTOR_TILE",p[p.IDENTITY=4]="IDENTITY",p[p.P20=5]="P20",p[p.P20_OFFSET=6]="P20_OFFSET",p[p.METER_OFFSET=7]="METER_OFFSET",p[p.P20_2=8]="P20_2",ue;var p})(),w={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter",Mvp:"u_Mvp"}},12260:(dr,H,M)=>{"use strict";M.d(H,{s:()=>ue});var ue=(()=>{return(w=ue||(ue={})).Hover="hover",w.Click="click",w.Select="select",w.Active="active",w.Drag="drag",ue;var w})()},25655:()=>{},35781:(dr,H,M)=>{"use strict";M.d(H,{h:()=>ue});var ue=(()=>{return(w=ue||(ue={})).normal="normal",w.additive="additive",w.subtractive="subtractive",w.min="min",w.max="max",w.none="none",ue;var w})()},39727:(dr,H,M)=>{"use strict";M.d(H,{vY:()=>ue,ee:()=>w,GC:()=>p});var ue=(()=>{return(_=ue||(ue={})).LINEAR="linear",_.POWER="power",_.LOG="log",_.IDENTITY="identity",_.TIME="time",_.QUANTILE="quantile",_.QUANTIZE="quantize",_.THRESHOLD="threshold",_.CAT="cat",ue;var _})(),w=(()=>{return(_=w||(w={})).CONSTANT="constant",_.VARIABLE="variable",w;var _})(),p=(()=>{return(_=p||(p={}))[_.Attribute=0]="Attribute",_[_.InstancedAttribute=1]="InstancedAttribute",_[_.Uniform=2]="Uniform",p;var _})()},53262:(dr,H,M)=>{"use strict";M.d(H,{I:()=>ue});var ue=["mapload"]},94671:()=>{},75846:()=>{},81210:()=>{},20626:()=>{},6974:()=>{},55576:(dr,H,M)=>{"use strict";M.d(H,{G:()=>ue});var ue=(()=>{return(w=ue||(ue={})).Normal="normal",w.PostProcessing="post-processing",ue;var w})()},23824:()=>{},75541:()=>{},34710:()=>{},27159:()=>{},24558:(dr,H,M)=>{"use strict";M.d(H,{gl:()=>ue});var ue=(()=>{return(w=ue||(ue={}))[w.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",w[w.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",w[w.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",w[w.POINTS=0]="POINTS",w[w.LINES=1]="LINES",w[w.LINE_LOOP=2]="LINE_LOOP",w[w.LINE_STRIP=3]="LINE_STRIP",w[w.TRIANGLES=4]="TRIANGLES",w[w.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",w[w.TRIANGLE_FAN=6]="TRIANGLE_FAN",w[w.ZERO=0]="ZERO",w[w.ONE=1]="ONE",w[w.SRC_COLOR=768]="SRC_COLOR",w[w.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",w[w.SRC_ALPHA=770]="SRC_ALPHA",w[w.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",w[w.DST_ALPHA=772]="DST_ALPHA",w[w.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",w[w.DST_COLOR=774]="DST_COLOR",w[w.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",w[w.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",w[w.FUNC_ADD=32774]="FUNC_ADD",w[w.BLEND_EQUATION=32777]="BLEND_EQUATION",w[w.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",w[w.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",w[w.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",w[w.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",w[w.MAX_EXT=32776]="MAX_EXT",w[w.MIN_EXT=32775]="MIN_EXT",w[w.BLEND_DST_RGB=32968]="BLEND_DST_RGB",w[w.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",w[w.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",w[w.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",w[w.CONSTANT_COLOR=32769]="CONSTANT_COLOR",w[w.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",w[w.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",w[w.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",w[w.BLEND_COLOR=32773]="BLEND_COLOR",w[w.ARRAY_BUFFER=34962]="ARRAY_BUFFER",w[w.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",w[w.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",w[w.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",w[w.STREAM_DRAW=35040]="STREAM_DRAW",w[w.STATIC_DRAW=35044]="STATIC_DRAW",w[w.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",w[w.BUFFER_SIZE=34660]="BUFFER_SIZE",w[w.BUFFER_USAGE=34661]="BUFFER_USAGE",w[w.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",w[w.FRONT=1028]="FRONT",w[w.BACK=1029]="BACK",w[w.FRONT_AND_BACK=1032]="FRONT_AND_BACK",w[w.CULL_FACE=2884]="CULL_FACE",w[w.BLEND=3042]="BLEND",w[w.DITHER=3024]="DITHER",w[w.STENCIL_TEST=2960]="STENCIL_TEST",w[w.DEPTH_TEST=2929]="DEPTH_TEST",w[w.SCISSOR_TEST=3089]="SCISSOR_TEST",w[w.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",w[w.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",w[w.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",w[w.NO_ERROR=0]="NO_ERROR",w[w.INVALID_ENUM=1280]="INVALID_ENUM",w[w.INVALID_VALUE=1281]="INVALID_VALUE",w[w.INVALID_OPERATION=1282]="INVALID_OPERATION",w[w.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",w[w.CW=2304]="CW",w[w.CCW=2305]="CCW",w[w.LINE_WIDTH=2849]="LINE_WIDTH",w[w.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",w[w.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",w[w.CULL_FACE_MODE=2885]="CULL_FACE_MODE",w[w.FRONT_FACE=2886]="FRONT_FACE",w[w.DEPTH_RANGE=2928]="DEPTH_RANGE",w[w.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",w[w.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",w[w.DEPTH_FUNC=2932]="DEPTH_FUNC",w[w.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",w[w.STENCIL_FUNC=2962]="STENCIL_FUNC",w[w.STENCIL_FAIL=2964]="STENCIL_FAIL",w[w.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",w[w.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",w[w.STENCIL_REF=2967]="STENCIL_REF",w[w.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",w[w.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",w[w.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",w[w.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",w[w.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",w[w.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",w[w.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",w[w.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",w[w.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",w[w.VIEWPORT=2978]="VIEWPORT",w[w.SCISSOR_BOX=3088]="SCISSOR_BOX",w[w.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",w[w.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",w[w.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",w[w.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",w[w.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",w[w.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",w[w.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",w[w.RED_BITS=3410]="RED_BITS",w[w.GREEN_BITS=3411]="GREEN_BITS",w[w.BLUE_BITS=3412]="BLUE_BITS",w[w.ALPHA_BITS=3413]="ALPHA_BITS",w[w.DEPTH_BITS=3414]="DEPTH_BITS",w[w.STENCIL_BITS=3415]="STENCIL_BITS",w[w.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",w[w.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",w[w.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",w[w.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",w[w.SAMPLES=32937]="SAMPLES",w[w.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",w[w.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",w[w.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",w[w.DONT_CARE=4352]="DONT_CARE",w[w.FASTEST=4353]="FASTEST",w[w.NICEST=4354]="NICEST",w[w.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",w[w.BYTE=5120]="BYTE",w[w.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",w[w.SHORT=5122]="SHORT",w[w.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",w[w.INT=5124]="INT",w[w.UNSIGNED_INT=5125]="UNSIGNED_INT",w[w.FLOAT=5126]="FLOAT",w[w.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",w[w.ALPHA=6406]="ALPHA",w[w.RGB=6407]="RGB",w[w.RGBA=6408]="RGBA",w[w.LUMINANCE=6409]="LUMINANCE",w[w.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",w[w.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",w[w.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",w[w.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",w[w.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",w[w.VERTEX_SHADER=35633]="VERTEX_SHADER",w[w.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",w[w.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",w[w.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",w[w.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",w[w.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",w[w.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",w[w.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",w[w.SHADER_TYPE=35663]="SHADER_TYPE",w[w.DELETE_STATUS=35712]="DELETE_STATUS",w[w.LINK_STATUS=35714]="LINK_STATUS",w[w.VALIDATE_STATUS=35715]="VALIDATE_STATUS",w[w.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",w[w.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",w[w.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",w[w.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",w[w.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",w[w.NEVER=512]="NEVER",w[w.LESS=513]="LESS",w[w.EQUAL=514]="EQUAL",w[w.LEQUAL=515]="LEQUAL",w[w.GREATER=516]="GREATER",w[w.NOTEQUAL=517]="NOTEQUAL",w[w.GEQUAL=518]="GEQUAL",w[w.ALWAYS=519]="ALWAYS",w[w.KEEP=7680]="KEEP",w[w.REPLACE=7681]="REPLACE",w[w.INCR=7682]="INCR",w[w.DECR=7683]="DECR",w[w.INVERT=5386]="INVERT",w[w.INCR_WRAP=34055]="INCR_WRAP",w[w.DECR_WRAP=34056]="DECR_WRAP",w[w.VENDOR=7936]="VENDOR",w[w.RENDERER=7937]="RENDERER",w[w.VERSION=7938]="VERSION",w[w.NEAREST=9728]="NEAREST",w[w.LINEAR=9729]="LINEAR",w[w.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",w[w.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",w[w.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",w[w.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",w[w.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",w[w.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",w[w.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",w[w.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",w[w.TEXTURE_2D=3553]="TEXTURE_2D",w[w.TEXTURE=5890]="TEXTURE",w[w.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",w[w.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",w[w.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",w[w.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",w[w.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",w[w.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",w[w.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",w[w.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",w[w.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",w[w.TEXTURE0=33984]="TEXTURE0",w[w.TEXTURE1=33985]="TEXTURE1",w[w.TEXTURE2=33986]="TEXTURE2",w[w.TEXTURE3=33987]="TEXTURE3",w[w.TEXTURE4=33988]="TEXTURE4",w[w.TEXTURE5=33989]="TEXTURE5",w[w.TEXTURE6=33990]="TEXTURE6",w[w.TEXTURE7=33991]="TEXTURE7",w[w.TEXTURE8=33992]="TEXTURE8",w[w.TEXTURE9=33993]="TEXTURE9",w[w.TEXTURE10=33994]="TEXTURE10",w[w.TEXTURE11=33995]="TEXTURE11",w[w.TEXTURE12=33996]="TEXTURE12",w[w.TEXTURE13=33997]="TEXTURE13",w[w.TEXTURE14=33998]="TEXTURE14",w[w.TEXTURE15=33999]="TEXTURE15",w[w.TEXTURE16=34e3]="TEXTURE16",w[w.TEXTURE17=34001]="TEXTURE17",w[w.TEXTURE18=34002]="TEXTURE18",w[w.TEXTURE19=34003]="TEXTURE19",w[w.TEXTURE20=34004]="TEXTURE20",w[w.TEXTURE21=34005]="TEXTURE21",w[w.TEXTURE22=34006]="TEXTURE22",w[w.TEXTURE23=34007]="TEXTURE23",w[w.TEXTURE24=34008]="TEXTURE24",w[w.TEXTURE25=34009]="TEXTURE25",w[w.TEXTURE26=34010]="TEXTURE26",w[w.TEXTURE27=34011]="TEXTURE27",w[w.TEXTURE28=34012]="TEXTURE28",w[w.TEXTURE29=34013]="TEXTURE29",w[w.TEXTURE30=34014]="TEXTURE30",w[w.TEXTURE31=34015]="TEXTURE31",w[w.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",w[w.REPEAT=10497]="REPEAT",w[w.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",w[w.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",w[w.FLOAT_VEC2=35664]="FLOAT_VEC2",w[w.FLOAT_VEC3=35665]="FLOAT_VEC3",w[w.FLOAT_VEC4=35666]="FLOAT_VEC4",w[w.INT_VEC2=35667]="INT_VEC2",w[w.INT_VEC3=35668]="INT_VEC3",w[w.INT_VEC4=35669]="INT_VEC4",w[w.BOOL=35670]="BOOL",w[w.BOOL_VEC2=35671]="BOOL_VEC2",w[w.BOOL_VEC3=35672]="BOOL_VEC3",w[w.BOOL_VEC4=35673]="BOOL_VEC4",w[w.FLOAT_MAT2=35674]="FLOAT_MAT2",w[w.FLOAT_MAT3=35675]="FLOAT_MAT3",w[w.FLOAT_MAT4=35676]="FLOAT_MAT4",w[w.SAMPLER_2D=35678]="SAMPLER_2D",w[w.SAMPLER_CUBE=35680]="SAMPLER_CUBE",w[w.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",w[w.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",w[w.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",w[w.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",w[w.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",w[w.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",w[w.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",w[w.COMPILE_STATUS=35713]="COMPILE_STATUS",w[w.LOW_FLOAT=36336]="LOW_FLOAT",w[w.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",w[w.HIGH_FLOAT=36338]="HIGH_FLOAT",w[w.LOW_INT=36339]="LOW_INT",w[w.MEDIUM_INT=36340]="MEDIUM_INT",w[w.HIGH_INT=36341]="HIGH_INT",w[w.FRAMEBUFFER=36160]="FRAMEBUFFER",w[w.RENDERBUFFER=36161]="RENDERBUFFER",w[w.RGBA4=32854]="RGBA4",w[w.RGB5_A1=32855]="RGB5_A1",w[w.RGB565=36194]="RGB565",w[w.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",w[w.STENCIL_INDEX=6401]="STENCIL_INDEX",w[w.STENCIL_INDEX8=36168]="STENCIL_INDEX8",w[w.DEPTH_STENCIL=34041]="DEPTH_STENCIL",w[w.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",w[w.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",w[w.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",w[w.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",w[w.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",w[w.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",w[w.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",w[w.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",w[w.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",w[w.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",w[w.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",w[w.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",w[w.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",w[w.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",w[w.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",w[w.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",w[w.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",w[w.NONE=0]="NONE",w[w.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",w[w.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",w[w.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",w[w.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",w[w.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",w[w.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",w[w.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",w[w.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",w[w.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",w[w.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",w[w.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",w[w.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",w[w.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",w[w.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",ue;var w})()},20051:(dr,H,M)=>{"use strict";M.d(H,{Z:()=>qe});var At,Et,vr,ne,nr,ue=M(32952),w=M(75134),p=M(47289),_=M(93512),W=M(56326),X=M(93890),q=M.n(X),te=M(28303),Y=M.n(te),Xe=M(35037),et=M.n(Xe),z=M(15922),Mt=(M(78320),M(24558)),sr=M(92444),Ut=M(55576);function Tt(Dt,lr){var hr=Object.keys(Dt);if(Object.getOwnPropertySymbols){var Dr=Object.getOwnPropertySymbols(Dt);lr&&(Dr=Dr.filter(function(_e){return Object.getOwnPropertyDescriptor(Dt,_e).enumerable})),hr.push.apply(hr,Dr)}return hr}function $e(Dt){for(var lr=1;lr<arguments.length;lr++){var hr=null!=arguments[lr]?arguments[lr]:{};lr%2?Tt(Object(hr),!0).forEach(function(Dr){(0,_.Z)(Dt,Dr,hr[Dr])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Dt,Object.getOwnPropertyDescriptors(hr)):Tt(Object(hr)).forEach(function(Dr){Object.defineProperty(Dt,Dr,Object.getOwnPropertyDescriptor(hr,Dr))})}return Dt}var qe=(At=(0,z.b2)(),Et=(0,z.f3)(sr.v.IShaderModuleService),At((ne=function(){function Dt(){(0,w.Z)(this,Dt),(0,ue.Z)(this,"shaderModuleService",nr,this),(0,_.Z)(this,"rendererService",void 0),(0,_.Z)(this,"config",void 0),(0,_.Z)(this,"quad","attribute vec2 a_Position;\n\nvarying vec2 v_UV;\n\nvoid main() {\n  v_UV = 0.5 * (a_Position + 1.0);\n  gl_Position = vec4(a_Position, 0., 1.);\n}"),(0,_.Z)(this,"enabled",!0),(0,_.Z)(this,"renderToScreen",!1),(0,_.Z)(this,"model",void 0),(0,_.Z)(this,"name",void 0),(0,_.Z)(this,"optionsToUpdate",{})}return(0,p.Z)(Dt,[{key:"getName",value:function(){return this.name}},{key:"setName",value:function(hr){this.name=hr}},{key:"getType",value:function(){return Ut.G.PostProcessing}},{key:"init",value:function(hr,Dr){this.config=Dr,this.rendererService=hr.getContainer().get(sr.v.IRendererService);var _e=this.rendererService,ve=_e.createAttribute,ae=_e.createBuffer,de=_e.createModel,Pe=this.setupShaders(),br=Pe.uniforms;this.model=de({vs:Pe.vs,fs:Pe.fs,attributes:{a_Position:ve({buffer:ae({data:[-4,-4,4,-4,0,4],type:Mt.gl.FLOAT}),size:2})},uniforms:$e($e({u_Texture:null},br),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:"copy"===this.getName()}})}},{key:"render",value:function(hr){var Dr=this,_e=hr.multiPassRenderer.getPostProcessor(),ve=this.rendererService,ae=ve.useFramebuffer,Pe=ve.clear,ze=(0,ve.getViewportSize)(),pt=ze.width,br=ze.height;ae(this.renderToScreen?null:_e.getWriteFBO(),function(){Pe({framebuffer:_e.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0}),Dr.model.draw({uniforms:$e({u_Texture:_e.getReadFBO(),u_ViewportSize:[pt,br]},Dr.convertOptionsToUniforms(Dr.optionsToUpdate))})})}},{key:"isEnabled",value:function(){return this.enabled}},{key:"setEnabled",value:function(hr){this.enabled=hr}},{key:"setRenderToScreen",value:function(hr){this.renderToScreen=hr}},{key:"updateOptions",value:function(hr){this.optionsToUpdate=$e($e({},this.optionsToUpdate),hr)}},{key:"setupShaders",value:function(){throw new Error("Method not implemented.")}},{key:"convertOptionsToUniforms",value:function(hr){var Dr={};return Object.keys(hr).forEach(function(_e){Y()(hr[_e])||(Dr["u_".concat(q()(et()(_e)))]=hr[_e])}),Dr}}]),Dt}(),nr=(0,W.Z)(ne.prototype,"shaderModuleService",[Et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vr=ne))||vr)},80533:(dr,H,M)=>{"use strict";M.d(H,{P:()=>ue});var ue=["loaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"]},63877:()=>{},33511:()=>{},92444:(dr,H,M)=>{"use strict";M.d(H,{v:()=>ue});var ue={IEventEmitter:Symbol.for("IEventEmitter"),ISceneService:Symbol.for("ISceneService"),IGlobalConfigService:Symbol.for("IGlobalConfigService"),ICameraService:Symbol.for("ICameraService"),ICoordinateSystemService:Symbol.for("ICoordinateSystemService"),ILayerService:Symbol.for("ILayerService"),ILayerMappingService:Symbol.for("ILayerMappingService"),ILayerStyleService:Symbol.for("ILayerStyleService"),IMapService:Symbol.for("IMapService"),IMarkerService:Symbol.for("IMarkerService"),IPopupService:Symbol.for("PopupService"),IFactoryMapService:Symbol.for("Factory<IMapService>"),IRendererService:Symbol.for("IRendererService"),IShaderModuleService:Symbol.for("IShaderModuleService"),IIconService:Symbol.for("IIconService"),IFontService:Symbol.for("IFontService"),IInteractionService:Symbol.for("IInteractionService"),IPickingService:Symbol.for("IPickingService"),IControlService:Symbol.for("IControlService"),IStyleAttributeService:Symbol.for("IStyleAttributeService"),ILayer:Symbol.for("ILayer"),ILayerPlugin:Symbol.for("ILayerPlugin"),INormalPass:Symbol.for("INormalPass"),IPostProcessor:Symbol.for("IPostProcessor"),IPostProcessingPass:Symbol.for("IPostProcessingPass"),IFactoryPostProcessingPass:Symbol.for("Factory<IPostProcessingPass>"),IFactoryNormalPass:Symbol.for("Factory<IFactoryNormalPass>"),IMultiPassRenderer:Symbol.for("IMultiPassRenderer"),SceneID:Symbol.for("SceneID"),MapConfig:Symbol.for("MapConfig")}},10120:(dr,H,M)=>{"use strict";M(43770)},88818:()=>{},30832:(dr,H,M)=>{"use strict";M.d(H,{SO:()=>ue,z6:()=>Cr,a5:()=>w,Z:()=>dt,rQ:()=>mi,bV:()=>Wn,zi:()=>hi,ds:()=>Xt,Ev:()=>_r,oO:()=>St,W0:()=>er,Z6:()=>pr,We:()=>Ar,gJ:()=>nt,vP:()=>Zn,yM:()=>B,yA:()=>_t,CI:()=>mr});var ue={};M.r(ue),M.d(ue,{DPR:()=>$e,addClass:()=>Z,create:()=>et,empty:()=>At,getClass:()=>Ut,getContainer:()=>q,getViewPortScale:()=>Tt,hasClass:()=>Mt,printCanvas:()=>nr,remove:()=>z,removeClass:()=>tt,setClass:()=>sr,setTransform:()=>vr,splitWords:()=>Y,triggerResize:()=>ne,trim:()=>te});var w={};M.r(w),M.d(w,{getColumn:()=>he,getSatByColumn:()=>ge,max:()=>si,mean:()=>Pi,min:()=>ai,mode:()=>Ei,statMap:()=>Q,sum:()=>Yi});var W=M(83838),X=window.document.documentElement.style;function q(F){var re=F;return"string"==typeof F&&(re=document.getElementById(F)),re}function te(F){return F.trim?F.trim():F.replace(/^\s+|\s+$/g,"")}function Y(F){return te(F).split(/\s+/)}function et(F,re,ye){var Me=document.createElement(F);return Me.className=re||"",ye&&ye.appendChild(Me),Me}function z(F){var re=F.parentNode;re&&re.removeChild(F)}function Z(F,re){if(void 0!==F.classList)for(var ye=Y(re),Me=0,ce=ye.length;Me<ce;Me++)F.classList.add(ye[Me]);else if(!Mt(F,re)){var Te=Ut(F);sr(F,(Te?Te+" ":"")+re)}}function tt(F,re){void 0!==F.classList?F.classList.remove(re):sr(F,te((" "+Ut(F)+" ").replace(" "+re+" "," ")))}function Mt(F,re){if(void 0!==F.classList)return F.classList.contains(re);var ye=Ut(F);return ye.length>0&&new RegExp("(^|\\s)"+re+"(\\s|$)").test(ye)}function sr(F,re){F instanceof HTMLElement?F.className=re:F.className.baseVal=re}function Ut(F){return F instanceof SVGElement&&(F=F.correspondingElement),void 0===F.className.baseVal?F.className:F.className.baseVal}function At(F){for(;F&&F.firstChild;)F.removeChild(F.firstChild)}var Et=function(F){if(!X)return F[0];for(var re in F)if(F[re]&&F[re]in X)return F[re];return F[0]}(["transform","WebkitTransform"]);function vr(F,re){F.style[Et]=re}function ne(){if("function"==typeof Event)window.dispatchEvent(new Event("resize"));else{var F=window.document.createEvent("UIEvents");F.initUIEvent("resize",!0,!1,window,0),window.dispatchEvent(F)}}function nr(F){var re=["padding: "+(F.height/2-8)+"px "+F.width/2+"px;","line-height: "+F.height+"px;","background-image: url("+F.toDataURL()+");"];console.log("%c\n",re.join(""))}function Tt(){var F,re=document.querySelector('meta[name="viewport"]');if(!re)return 1;var Me=(null===(F=re.content)||void 0===F?void 0:F.split(",")).find(function(ce){var Te=ce.split("=");return"initial-scale"===(0,W.Z)(Te,2)[0]});return Me?1*Me.split("=")[1]:1}var $e=Tt()<1?1:window.devicePixelRatio,Ct=M(75134),qe=M(47289),Dt=M(66518),lr=M(41885),hr=M(59553),Dr=M(99187),_e=M(92007);function ae(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(F){return!1}}function de(F,re,ye){return(de=ae()?Reflect.construct:function(ce,Te,mt){var wr=[null];wr.push.apply(wr,Te);var $t=new(Function.bind.apply(ce,wr));return mt&&(0,_e.Z)($t,mt.prototype),$t}).apply(null,arguments)}function Pe(F){var re="function"==typeof Map?new Map:void 0;return(Pe=function(Me){if(null===Me||!function(F){return-1!==Function.toString.call(F).indexOf("[native code]")}(Me))return Me;if("function"!=typeof Me)throw new TypeError("Super expression must either be null or a function");if(void 0!==re){if(re.has(Me))return re.get(Me);re.set(Me,ce)}function ce(){return de(Me,arguments,(0,Dr.Z)(this).constructor)}return ce.prototype=Object.create(Me.prototype,{constructor:{value:ce,enumerable:!1,writable:!0,configurable:!0}}),(0,_e.Z)(ce,Me)})(F)}var ze=M(93512);var Ur=function(F){(0,lr.Z)(ye,F);var re=function(F){var re=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(F){return!1}}();return function(){var ce,Me=(0,Dr.Z)(F);if(re){var Te=(0,Dr.Z)(this).constructor;ce=Reflect.construct(Me,arguments,Te)}else ce=Me.apply(this,arguments);return(0,hr.Z)(this,ce)}}(ye);function ye(Me,ce,Te){var mt;return(0,Ct.Z)(this,ye),mt=re.call(this,Me),(0,ze.Z)((0,Dt.Z)(mt),"status",void 0),(0,ze.Z)((0,Dt.Z)(mt),"url",void 0),mt.status=ce,mt.url=Te,mt.name=mt.constructor.name,mt.message=Me,mt}return(0,qe.Z)(ye,[{key:"toString",value:function(){return"".concat(this.name,": ").concat(this.message," (").concat(this.status,"): ").concat(this.url)}}]),ye}(Pe(Error));var nt=function(re,ye){return function(re,ye){var Me=function(F){var re=new XMLHttpRequest;for(var ye in re.open("GET",F.url,!0),F.headers)F.headers.hasOwnProperty(ye)&&re.setRequestHeader(ye,F.headers[ye]);return re.withCredentials="include"===F.credentials,re}(re);return Me.responseType="arraybuffer",Me.onerror=function(){ye(new Error(Me.statusText))},Me.onload=function(){var ce=Me.response;if(0===ce.byteLength&&200===Me.status)return ye(new Error("http status 200 returned without content."));Me.status>=200&&Me.status<300&&Me.response?ye(null,{data:ce,cacheControl:Me.getResponseHeader("Cache-Control"),expires:Me.getResponseHeader("Expires")}):ye(new Ur(Me.statusText,Me.status,re.url))},Me.send(),Me}(re,function(Me,ce){if(Me)ye(Me);else if(ce){var Te=new window.Image;Te.crossOrigin="anonymous";var mt=window.URL||window.webkitURL;Te.onload=function(){ye(null,Te),mt.revokeObjectURL(Te.src)};var wr=new window.Blob([new Uint8Array(ce.data)],{type:"image/png"});Te.src=ce.data.byteLength?mt.createObjectURL(wr):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}})},Le=M(70576),Wt=2*Math.PI*6378137/2;function Ar(F){var re=[1/0,1/0,-1/0,-1/0];return F.forEach(function(ye){Yt(re,ye.coordinates)}),re}function Yt(F,re){return Array.isArray(re[0])?re.forEach(function(ye){Yt(F,ye)}):(F[0]>re[0]&&(F[0]=re[0]),F[1]>re[1]&&(F[1]=re[1]),F[2]<re[0]&&(F[2]=re[0]),F[3]<re[1]&&(F[3]=re[1])),F}function Zn(F){var re=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],ye=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{enable:!0,decimal:1},Me=(F=rt(F,re))[0],ce=F[1],Te=Me*Wt/180,mt=Math.log(Math.tan((90+ce)*Math.PI/360))/(Math.PI/180);return mt=mt*Wt/180,ye.enable&&(Te=Number(Te.toFixed(ye.decimal)),mt=Number(mt.toFixed(ye.decimal))),3===F.length?[Te,mt,F[2]]:[Te,mt]}function rt(F,re){if(!1===re)return F;var ye=function(F){if(null==F)throw new Error("lng is required");return(F>180||F<-180)&&((F%=360)>180&&(F=-360+F),F<-180&&(F=360+F),0===F&&(F=0)),F}(F[0]),Me=function(F){if(null==F)throw new Error("lat is required");return(F>90||F<-90)&&((F%=180)>90&&(F=-180+F),F<-90&&(F=180+F),0===F&&(F=0)),F}(F[1]);return Me>85&&(Me=85),Me<-85&&(Me=-85),3===F.length?[ye,Me,F[2]]:[ye,Me]}function dt(F){var re=85.0511287798,ye=Math.max(Math.min(re,F[1]),-re),Me=256<<20,ce=Math.PI/180,Te=F[0]*ce,mt=ye*ce;return mt=Math.log(Math.tan(Math.PI/4+mt/2)),Te=Me*(.5/Math.PI*Te+.5),mt=Me*(-.5/Math.PI*mt+(ce=.5)),[Math.floor(Te),Math.floor(mt)]}function B(F,re,ye){var Me=(0,Le.Ht)(re[1]-F[1]),ce=(0,Le.Ht)(re[0]-F[0]),Te=(0,Le.Ht)(F[1]),mt=(0,Le.Ht)(re[1]),wr=Math.pow(Math.sin(Me/2),2)+Math.pow(Math.sin(ce/2),2)*Math.cos(Te)*Math.cos(mt);return(0,Le.DL)(2*Math.atan2(Math.sqrt(wr),Math.sqrt(1-wr)),"meters")}function _t(F,re){var ye=Math.abs(F[1][1]-F[0][1])*re,Me=Math.abs(F[1][0]-F[0][0])*re;return[[F[0][0]-Me,F[0][1]-ye],[F[1][0]+Me,F[1][1]+ye]]}function St(F,re){return F[0][0]<=re[0][0]&&F[0][1]<=re[0][1]&&F[1][0]>=re[1][0]&&F[1][1]>=re[1][1]}function Xt(F){return[[F[0],F[1]],[F[2],F[3]]]}var Cr=function(){function F(){var re=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,ye=arguments.length>1?arguments[1]:void 0;(0,Ct.Z)(this,F),(0,ze.Z)(this,"limit",void 0),(0,ze.Z)(this,"cache",void 0),(0,ze.Z)(this,"destroy",void 0),(0,ze.Z)(this,"order",void 0),this.limit=re,this.destroy=ye||this.defaultDestroy,this.order=[],this.clear()}return(0,qe.Z)(F,[{key:"clear",value:function(){var ye=this;this.order.forEach(function(Me){ye.delete(Me)}),this.cache={},this.order=[]}},{key:"get",value:function(ye){var Me=this.cache[ye];return Me&&(this.deleteOrder(ye),this.appendOrder(ye)),Me}},{key:"set",value:function(ye,Me){this.cache[ye]?(this.delete(ye),this.cache[ye]=Me,this.appendOrder(ye)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[ye]=Me,this.appendOrder(ye))}},{key:"delete",value:function(ye){var Me=this.cache[ye];Me&&(this.deleteCache(ye),this.deleteOrder(ye),this.destroy(Me,ye))}},{key:"deleteCache",value:function(ye){delete this.cache[ye]}},{key:"deleteOrder",value:function(ye){var Me=this.order.findIndex(function(ce){return ce===ye});Me>=0&&this.order.splice(Me,1)}},{key:"appendOrder",value:function(ye){this.order.push(ye)}},{key:"defaultDestroy",value:function(ye,Me){return null}}]),F}();function _r(F,re){F.forEach(function(ye){!re[ye]||(re[ye]=re[ye].bind(re))})}var jt=M(27859);function mr(F){var re=jt.ZP(F),ye=[0,0,0,0];return null!=re&&(ye[0]=re.r/255,ye[1]=re.g/255,ye[2]=re.b/255,ye[3]=re.opacity),ye}function er(F){return(F&&F[0])+256*(F&&F[1])+65536*(F&&F[2])-1}function pr(F){return[F+1&255,F+1>>8&255,F+1>>8>>8&255]}var Wn=(()=>{return(F=Wn||(Wn={})).CENTER="center",F.TOP="top",F["TOP-LEFT"]="top-left",F["TOP-RIGHT"]="top-right",F.BOTTOM="bottom",F["BOTTOM-LEFT"]="bottom-left",F.LEFT="left",F.RIGHT="right",Wn;var F})(),mi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function hi(F,re,ye){var Me=F.classList;for(var ce in mi)mi.hasOwnProperty(ce)&&Me.remove("l7-".concat(ye,"-anchor-").concat(ce));Me.add("l7-".concat(ye,"-anchor-").concat(re))}function si(F){if(0===F.length)throw new Error("max requires at least one data point");for(var re=F[0],ye=1;ye<F.length;ye++)F[ye]>re&&(re=F[ye]);return 1*re}function ai(F){if(0===F.length)throw new Error("min requires at least one data point");for(var re=F[0],ye=1;ye<F.length;ye++)F[ye]<re&&(re=F[ye]);return 1*re}function Yi(F){if(0===F.length)return 0;for(var re=1*F[0],ye=1;ye<F.length;ye++)re+=1*F[ye];return re}function Pi(F){if(0===F.length)throw new Error("mean requires at least one data point");return Yi(F)/F.length}function Ei(F){if(0===F.length)throw new Error("mean requires at least one data point");if(F.length<3)return F[0];F.sort();for(var re=F[0],ye=NaN,Me=0,ce=1,Te=1;Te<F.length+1;Te++)F[Te]!==re?(ce>Me&&(Me=ce,ye=re),ce=1,re=F[Te]):ce++;return 1*ye}var Q={min:ai,max:si,mean:Pi,sum:Yi,mode:Ei};function he(F,re){return F.map(function(ye){return ye[re]})}function ge(F,re){return Q[F](re)}},97935:(dr,H,M)=>{var ue=M(96847);function p(X){var q=0;if(X&&X.length>0){q+=Math.abs(_(X[0]));for(var te=1;te<X.length;te++)q-=Math.abs(_(X[te]))}return q}function _(X){var q,te,Xe,et,z,Z,tt=0,Mt=X.length;if(Mt>2){for(Z=0;Z<Mt;Z++)Z===Mt-2?(Xe=Mt-2,et=Mt-1,z=0):Z===Mt-1?(Xe=Mt-1,et=0,z=1):(Xe=Z,et=Z+1,z=Z+2),q=X[Xe],te=X[et],tt+=(W(X[z][0])-W(q[0]))*Math.sin(W(te[1]));tt=tt*ue.RADIUS*ue.RADIUS/2}return tt}function W(X){return X*Math.PI/180}dr.exports.geometry=function w(X){var te,q=0;switch(X.type){case"Polygon":return p(X.coordinates);case"MultiPolygon":for(te=0;te<X.coordinates.length;te++)q+=p(X.coordinates[te]);return q;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(te=0;te<X.geometries.length;te++)q+=w(X.geometries[te]);return q}},dr.exports.ring=_},57452:(dr,H,M)=>{var ue=M(97935);function p(te,Y){return function(Xe){return te(Xe,Y)}}function W(te,Y){te[0]=X(te[0],Y=!!Y);for(var Xe=1;Xe<te.length;Xe++)te[Xe]=X(te[Xe],!Y);return te}function X(te,Y){return function(te){return ue.ring(te)>=0}(te)===Y?te:te.reverse()}dr.exports=function w(te,Y){switch(te&&te.type||null){case"FeatureCollection":return te.features=te.features.map(p(w,Y)),te;case"GeometryCollection":return te.geometries=te.geometries.map(p(w,Y)),te;case"Feature":return te.geometry=w(te.geometry,Y),te;case"Polygon":case"MultiPolygon":return function(te,Y){return"Polygon"===te.type?te.coordinates=W(te.coordinates,Y):"MultiPolygon"===te.type&&(te.coordinates=te.coordinates.map(p(W,Y))),te}(te,Y);default:return te}}},51002:dr=>{"use strict";dr.exports=M,dr.exports.default=M;var H=1e20;function M(W,X,q,te,Y,Xe){this.fontSize=W||24,this.buffer=void 0===X?3:X,this.cutoff=te||.25,this.fontFamily=Y||"sans-serif",this.fontWeight=Xe||"normal",this.radius=q||8;var et=this.size=this.fontSize+2*this.buffer,z=et+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=et,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(z*z),this.gridInner=new Float64Array(z*z),this.f=new Float64Array(z),this.z=new Float64Array(z+1),this.v=new Uint16Array(z),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(et/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function p(W,X,q,te,Y,Xe){for(var et=0;et<X;et++)_(W,et,X,q,te,Y,Xe);for(var z=0;z<q;z++)_(W,z*X,1,X,te,Y,Xe)}function _(W,X,q,te,Y,Xe,et){var z,Z,tt,Mt;for(Xe[0]=0,et[0]=-H,et[1]=H,z=0;z<te;z++)Y[z]=W[X+z*q];for(z=1,Z=0,tt=0;z<te;z++){do{tt=(Y[z]-Y[Mt=Xe[Z]]+z*z-Mt*Mt)/(z-Mt)/2}while(tt<=et[Z]&&--Z>-1);Xe[++Z]=z,et[Z]=tt,et[Z+1]=H}for(z=0,Z=0;z<te;z++){for(;et[Z+1]<z;)Z++;W[X+z*q]=Y[Mt=Xe[Z]]+(z-Mt)*(z-Mt)}}M.prototype._draw=function(W,X){var Xe,et,z,Z,tt,Mt,sr,Ut,At,q=this.ctx.measureText(W),te=q.width,Y=2*this.buffer;X&&this.useMetrics?(tt=Math.floor(q.actualBoundingBoxAscent),Ut=this.buffer+Math.ceil(q.actualBoundingBoxAscent),Mt=this.buffer,sr=this.buffer,Xe=(et=Math.min(this.size,Math.ceil(q.actualBoundingBoxRight-q.actualBoundingBoxLeft)))+Y,z=(Z=Math.min(this.size-Mt,Math.ceil(q.actualBoundingBoxAscent+q.actualBoundingBoxDescent)))+Y,this.ctx.textBaseline="alphabetic"):(Xe=et=this.size,z=Z=this.size,tt=19*this.fontSize/24,Mt=sr=0,Ut=this.middle,this.ctx.textBaseline="middle"),et&&Z&&(this.ctx.clearRect(sr,Mt,et,Z),this.ctx.fillText(W,this.buffer,Ut),At=this.ctx.getImageData(sr,Mt,et,Z));var Et=new Uint8ClampedArray(Xe*z);return function(W,X,q,te,Y,Xe,et){Xe.fill(H,0,X*q),et.fill(0,0,X*q);for(var z=(X-te)/2,Z=0;Z<Y;Z++)for(var tt=0;tt<te;tt++){var Mt=(Z+z)*X+tt+z,sr=W.data[4*(Z*te+tt)+3]/255;if(1===sr)Xe[Mt]=0,et[Mt]=H;else if(0===sr)Xe[Mt]=H,et[Mt]=0;else{var Ut=Math.max(0,.5-sr),At=Math.max(0,sr-.5);Xe[Mt]=Ut*Ut,et[Mt]=At*At}}}(At,Xe,z,et,Z,this.gridOuter,this.gridInner),p(this.gridOuter,Xe,z,this.f,this.v,this.z),p(this.gridInner,Xe,z,this.f,this.v,this.z),function(W,X,q,te,Y,Xe,et){for(var z=0;z<X*q;z++){var Z=Math.sqrt(te[z])-Math.sqrt(Y[z]);W[z]=Math.round(255-255*(Z/Xe+et))}}(Et,Xe,z,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:Et,metrics:{width:et,height:Z,sdfWidth:Xe,sdfHeight:z,top:tt,left:0,advance:te}}},M.prototype.draw=function(W){return this._draw(W,!1).data},M.prototype.drawWithMetrics=function(W){return this._draw(W,!0)}},27859:(dr,H,M)=>{"use strict";function ue(de,Pe,ze){de.prototype=Pe.prototype=ze,ze.constructor=de}function w(de,Pe){var ze=Object.create(de.prototype);for(var pt in Pe)ze[pt]=Pe[pt];return ze}function p(){}M.d(H,{ZP:()=>vr,B8:()=>$e});var _=.7,W=1/_,X="\\s*([+-]?\\d+)\\s*",q="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",te="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Y=/^#([0-9a-f]{3,8})$/,Xe=new RegExp("^rgb\\("+[X,X,X]+"\\)$"),et=new RegExp("^rgb\\("+[te,te,te]+"\\)$"),z=new RegExp("^rgba\\("+[X,X,X,q]+"\\)$"),Z=new RegExp("^rgba\\("+[te,te,te,q]+"\\)$"),tt=new RegExp("^hsl\\("+[q,te,te]+"\\)$"),Mt=new RegExp("^hsla\\("+[q,te,te,q]+"\\)$"),sr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ut(){return this.rgb().formatHex()}function Et(){return this.rgb().formatRgb()}function vr(de){var Pe,ze;return de=(de+"").trim().toLowerCase(),(Pe=Y.exec(de))?(ze=Pe[1].length,Pe=parseInt(Pe[1],16),6===ze?ne(Pe):3===ze?new Ct(Pe>>8&15|Pe>>4&240,Pe>>4&15|240&Pe,(15&Pe)<<4|15&Pe,1):8===ze?nr(Pe>>24&255,Pe>>16&255,Pe>>8&255,(255&Pe)/255):4===ze?nr(Pe>>12&15|Pe>>8&240,Pe>>8&15|Pe>>4&240,Pe>>4&15|240&Pe,((15&Pe)<<4|15&Pe)/255):null):(Pe=Xe.exec(de))?new Ct(Pe[1],Pe[2],Pe[3],1):(Pe=et.exec(de))?new Ct(255*Pe[1]/100,255*Pe[2]/100,255*Pe[3]/100,1):(Pe=z.exec(de))?nr(Pe[1],Pe[2],Pe[3],Pe[4]):(Pe=Z.exec(de))?nr(255*Pe[1]/100,255*Pe[2]/100,255*Pe[3]/100,Pe[4]):(Pe=tt.exec(de))?hr(Pe[1],Pe[2]/100,Pe[3]/100,1):(Pe=Mt.exec(de))?hr(Pe[1],Pe[2]/100,Pe[3]/100,Pe[4]):sr.hasOwnProperty(de)?ne(sr[de]):"transparent"===de?new Ct(NaN,NaN,NaN,0):null}function ne(de){return new Ct(de>>16&255,de>>8&255,255&de,1)}function nr(de,Pe,ze,pt){return pt<=0&&(de=Pe=ze=NaN),new Ct(de,Pe,ze,pt)}function Tt(de){return de instanceof p||(de=vr(de)),de?new Ct((de=de.rgb()).r,de.g,de.b,de.opacity):new Ct}function $e(de,Pe,ze,pt){return 1===arguments.length?Tt(de):new Ct(de,Pe,ze,null==pt?1:pt)}function Ct(de,Pe,ze,pt){this.r=+de,this.g=+Pe,this.b=+ze,this.opacity=+pt}function qe(){return"#"+lr(this.r)+lr(this.g)+lr(this.b)}function Dt(){var de=this.opacity;return(1===(de=isNaN(de)?1:Math.max(0,Math.min(1,de)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===de?")":", "+de+")")}function lr(de){return((de=Math.max(0,Math.min(255,Math.round(de)||0)))<16?"0":"")+de.toString(16)}function hr(de,Pe,ze,pt){return pt<=0?de=Pe=ze=NaN:ze<=0||ze>=1?de=Pe=NaN:Pe<=0&&(de=NaN),new ve(de,Pe,ze,pt)}function Dr(de){if(de instanceof ve)return new ve(de.h,de.s,de.l,de.opacity);if(de instanceof p||(de=vr(de)),!de)return new ve;if(de instanceof ve)return de;var Pe=(de=de.rgb()).r/255,ze=de.g/255,pt=de.b/255,br=Math.min(Pe,ze,pt),Ur=Math.max(Pe,ze,pt),fn=NaN,Pr=Ur-br,wt=(Ur+br)/2;return Pr?(fn=Pe===Ur?(ze-pt)/Pr+6*(ze<pt):ze===Ur?(pt-Pe)/Pr+2:(Pe-ze)/Pr+4,Pr/=wt<.5?Ur+br:2-Ur-br,fn*=60):Pr=wt>0&&wt<1?0:fn,new ve(fn,Pr,wt,de.opacity)}function ve(de,Pe,ze,pt){this.h=+de,this.s=+Pe,this.l=+ze,this.opacity=+pt}function ae(de,Pe,ze){return 255*(de<60?Pe+(ze-Pe)*de/60:de<180?ze:de<240?Pe+(ze-Pe)*(240-de)/60:Pe)}ue(p,vr,{copy:function(de){return Object.assign(new this.constructor,this,de)},displayable:function(){return this.rgb().displayable()},hex:Ut,formatHex:Ut,formatHsl:function(){return Dr(this).formatHsl()},formatRgb:Et,toString:Et}),ue(Ct,$e,w(p,{brighter:function(de){return de=null==de?W:Math.pow(W,de),new Ct(this.r*de,this.g*de,this.b*de,this.opacity)},darker:function(de){return de=null==de?_:Math.pow(_,de),new Ct(this.r*de,this.g*de,this.b*de,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qe,formatHex:qe,formatRgb:Dt,toString:Dt})),ue(ve,function(de,Pe,ze,pt){return 1===arguments.length?Dr(de):new ve(de,Pe,ze,null==pt?1:pt)},w(p,{brighter:function(de){return de=null==de?W:Math.pow(W,de),new ve(this.h,this.s,this.l*de,this.opacity)},darker:function(de){return de=null==de?_:Math.pow(_,de),new ve(this.h,this.s,this.l*de,this.opacity)},rgb:function(){var de=this.h%360+360*(this.h<0),Pe=isNaN(de)||isNaN(this.s)?0:this.s,ze=this.l,pt=ze+(ze<.5?ze:1-ze)*Pe,br=2*ze-pt;return new Ct(ae(de>=240?de-240:de+120,br,pt),ae(de,br,pt),ae(de<120?de+240:de-120,br,pt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var de=this.opacity;return(1===(de=isNaN(de)?1:Math.max(0,Math.min(1,de)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===de?")":", "+de+")")}}))},41604:dr=>{"use strict";function H(_e,ve,ae){ae=ae||2;var br,Ur,fn,Pr,wt,Ie,we,de=ve&&ve.length,Pe=de?ve[0]*ae:_e.length,ze=M(_e,0,Pe,ae,!0),pt=[];if(!ze||ze.next===ze.prev)return pt;if(de&&(ze=function(_e,ve,ae,de){var ze,pt,fn,Pe=[];for(ze=0,pt=ve.length;ze<pt;ze++)(fn=M(_e,ve[ze]*de,ze<pt-1?ve[ze+1]*de:_e.length,de,!1))===fn.next&&(fn.steiner=!0),Pe.push(Mt(fn));for(Pe.sort(te),ze=0;ze<Pe.length;ze++)ae=ue(ae=Y(Pe[ze],ae),ae.next);return ae}(_e,ve,ze,ae)),_e.length>80*ae){br=fn=_e[0],Ur=Pr=_e[1];for(var nt=ae;nt<Pe;nt+=ae)(wt=_e[nt])<br&&(br=wt),(Ie=_e[nt+1])<Ur&&(Ur=Ie),wt>fn&&(fn=wt),Ie>Pr&&(Pr=Ie);we=0!==(we=Math.max(fn-br,Pr-Ur))?1/we:0}return w(ze,pt,ae,br,Ur,we),pt}function M(_e,ve,ae,de,Pe){var ze,pt;if(Pe===Dr(_e,ve,ae,de)>0)for(ze=ve;ze<ae;ze+=de)pt=Dt(ze,_e[ze],_e[ze+1],pt);else for(ze=ae-de;ze>=ve;ze-=de)pt=Dt(ze,_e[ze],_e[ze+1],pt);return pt&&Et(pt,pt.next)&&(lr(pt),pt=pt.next),pt}function ue(_e,ve){if(!_e)return _e;ve||(ve=_e);var de,ae=_e;do{if(de=!1,ae.steiner||!Et(ae,ae.next)&&0!==At(ae.prev,ae,ae.next))ae=ae.next;else{if(lr(ae),(ae=ve=ae.prev)===ae.next)break;de=!0}}while(de||ae!==ve);return ve}function w(_e,ve,ae,de,Pe,ze,pt){if(_e){!pt&&ze&&function(_e,ve,ae,de){var Pe=_e;do{null===Pe.z&&(Pe.z=tt(Pe.x,Pe.y,ve,ae,de)),Pe.prevZ=Pe.prev,Pe.nextZ=Pe.next,Pe=Pe.next}while(Pe!==_e);Pe.prevZ.nextZ=null,Pe.prevZ=null,function(_e){var ve,ae,de,Pe,ze,pt,br,Ur,fn=1;do{for(ae=_e,_e=null,ze=null,pt=0;ae;){for(pt++,de=ae,br=0,ve=0;ve<fn&&(br++,de=de.nextZ);ve++);for(Ur=fn;br>0||Ur>0&&de;)0!==br&&(0===Ur||!de||ae.z<=de.z)?(Pe=ae,ae=ae.nextZ,br--):(Pe=de,de=de.nextZ,Ur--),ze?ze.nextZ=Pe:_e=Pe,Pe.prevZ=ze,ze=Pe;ae=de}ze.nextZ=null,fn*=2}while(pt>1)}(Pe)}(_e,de,Pe,ze);for(var Ur,fn,br=_e;_e.prev!==_e.next;)if(Ur=_e.prev,fn=_e.next,ze?_(_e,de,Pe,ze):p(_e))ve.push(Ur.i/ae),ve.push(_e.i/ae),ve.push(fn.i/ae),lr(_e),_e=fn.next,br=fn.next;else if((_e=fn)===br){pt?1===pt?w(_e=W(ue(_e),ve,ae),ve,ae,de,Pe,ze,2):2===pt&&X(_e,ve,ae,de,Pe,ze):w(ue(_e),ve,ae,de,Pe,ze,1);break}}}function p(_e){var ve=_e.prev,ae=_e,de=_e.next;if(At(ve,ae,de)>=0)return!1;for(var Pe=_e.next.next;Pe!==_e.prev;){if(sr(ve.x,ve.y,ae.x,ae.y,de.x,de.y,Pe.x,Pe.y)&&At(Pe.prev,Pe,Pe.next)>=0)return!1;Pe=Pe.next}return!0}function _(_e,ve,ae,de){var Pe=_e.prev,ze=_e,pt=_e.next;if(At(Pe,ze,pt)>=0)return!1;for(var fn=Pe.x>ze.x?Pe.x>pt.x?Pe.x:pt.x:ze.x>pt.x?ze.x:pt.x,Pr=Pe.y>ze.y?Pe.y>pt.y?Pe.y:pt.y:ze.y>pt.y?ze.y:pt.y,wt=tt(Pe.x<ze.x?Pe.x<pt.x?Pe.x:pt.x:ze.x<pt.x?ze.x:pt.x,Pe.y<ze.y?Pe.y<pt.y?Pe.y:pt.y:ze.y<pt.y?ze.y:pt.y,ve,ae,de),Ie=tt(fn,Pr,ve,ae,de),we=_e.prevZ,nt=_e.nextZ;we&&we.z>=wt&&nt&&nt.z<=Ie;){if(we!==_e.prev&&we!==_e.next&&sr(Pe.x,Pe.y,ze.x,ze.y,pt.x,pt.y,we.x,we.y)&&At(we.prev,we,we.next)>=0||(we=we.prevZ,nt!==_e.prev&&nt!==_e.next&&sr(Pe.x,Pe.y,ze.x,ze.y,pt.x,pt.y,nt.x,nt.y)&&At(nt.prev,nt,nt.next)>=0))return!1;nt=nt.nextZ}for(;we&&we.z>=wt;){if(we!==_e.prev&&we!==_e.next&&sr(Pe.x,Pe.y,ze.x,ze.y,pt.x,pt.y,we.x,we.y)&&At(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;nt&&nt.z<=Ie;){if(nt!==_e.prev&&nt!==_e.next&&sr(Pe.x,Pe.y,ze.x,ze.y,pt.x,pt.y,nt.x,nt.y)&&At(nt.prev,nt,nt.next)>=0)return!1;nt=nt.nextZ}return!0}function W(_e,ve,ae){var de=_e;do{var Pe=de.prev,ze=de.next.next;!Et(Pe,ze)&&vr(Pe,de,de.next,ze)&&$e(Pe,ze)&&$e(ze,Pe)&&(ve.push(Pe.i/ae),ve.push(de.i/ae),ve.push(ze.i/ae),lr(de),lr(de.next),de=_e=ze),de=de.next}while(de!==_e);return ue(de)}function X(_e,ve,ae,de,Pe,ze){var pt=_e;do{for(var br=pt.next.next;br!==pt.prev;){if(pt.i!==br.i&&Ut(pt,br)){var Ur=qe(pt,br);return pt=ue(pt,pt.next),Ur=ue(Ur,Ur.next),w(pt,ve,ae,de,Pe,ze),void w(Ur,ve,ae,de,Pe,ze)}br=br.next}pt=pt.next}while(pt!==_e)}function te(_e,ve){return _e.x-ve.x}function Y(_e,ve){var ae=function(_e,ve){var pt,ae=ve,de=_e.x,Pe=_e.y,ze=-1/0;do{if(Pe<=ae.y&&Pe>=ae.next.y&&ae.next.y!==ae.y){var br=ae.x+(Pe-ae.y)*(ae.next.x-ae.x)/(ae.next.y-ae.y);if(br<=de&&br>ze){if(ze=br,br===de){if(Pe===ae.y)return ae;if(Pe===ae.next.y)return ae.next}pt=ae.x<ae.next.x?ae:ae.next}}ae=ae.next}while(ae!==ve);if(!pt)return null;if(de===ze)return pt;var Ie,Ur=pt,fn=pt.x,Pr=pt.y,wt=1/0;ae=pt;do{de>=ae.x&&ae.x>=fn&&de!==ae.x&&sr(Pe<Pr?de:ze,Pe,fn,Pr,Pe<Pr?ze:de,Pe,ae.x,ae.y)&&(Ie=Math.abs(Pe-ae.y)/(de-ae.x),$e(ae,_e)&&(Ie<wt||Ie===wt&&(ae.x>pt.x||ae.x===pt.x&&et(pt,ae)))&&(pt=ae,wt=Ie)),ae=ae.next}while(ae!==Ur);return pt}(_e,ve);if(!ae)return ve;var de=qe(ae,_e),Pe=ue(ae,ae.next);return ue(de,de.next),ve===ae?Pe:ve}function et(_e,ve){return At(_e.prev,_e,ve.prev)<0&&At(ve.next,_e,_e.next)<0}function tt(_e,ve,ae,de,Pe){return(_e=1431655765&((_e=858993459&((_e=252645135&((_e=16711935&((_e=32767*(_e-ae)*Pe)|_e<<8))|_e<<4))|_e<<2))|_e<<1))|(ve=1431655765&((ve=858993459&((ve=252645135&((ve=16711935&((ve=32767*(ve-de)*Pe)|ve<<8))|ve<<4))|ve<<2))|ve<<1))<<1}function Mt(_e){var ve=_e,ae=_e;do{(ve.x<ae.x||ve.x===ae.x&&ve.y<ae.y)&&(ae=ve),ve=ve.next}while(ve!==_e);return ae}function sr(_e,ve,ae,de,Pe,ze,pt,br){return(Pe-pt)*(ve-br)-(_e-pt)*(ze-br)>=0&&(_e-pt)*(de-br)-(ae-pt)*(ve-br)>=0&&(ae-pt)*(ze-br)-(Pe-pt)*(de-br)>=0}function Ut(_e,ve){return _e.next.i!==ve.i&&_e.prev.i!==ve.i&&!function(_e,ve){var ae=_e;do{if(ae.i!==_e.i&&ae.next.i!==_e.i&&ae.i!==ve.i&&ae.next.i!==ve.i&&vr(ae,ae.next,_e,ve))return!0;ae=ae.next}while(ae!==_e);return!1}(_e,ve)&&($e(_e,ve)&&$e(ve,_e)&&function(_e,ve){var ae=_e,de=!1,Pe=(_e.x+ve.x)/2,ze=(_e.y+ve.y)/2;do{ae.y>ze!=ae.next.y>ze&&ae.next.y!==ae.y&&Pe<(ae.next.x-ae.x)*(ze-ae.y)/(ae.next.y-ae.y)+ae.x&&(de=!de),ae=ae.next}while(ae!==_e);return de}(_e,ve)&&(At(_e.prev,_e,ve.prev)||At(_e,ve.prev,ve))||Et(_e,ve)&&At(_e.prev,_e,_e.next)>0&&At(ve.prev,ve,ve.next)>0)}function At(_e,ve,ae){return(ve.y-_e.y)*(ae.x-ve.x)-(ve.x-_e.x)*(ae.y-ve.y)}function Et(_e,ve){return _e.x===ve.x&&_e.y===ve.y}function vr(_e,ve,ae,de){var Pe=nr(At(_e,ve,ae)),ze=nr(At(_e,ve,de)),pt=nr(At(ae,de,_e)),br=nr(At(ae,de,ve));return!!(Pe!==ze&&pt!==br||0===Pe&&ne(_e,ae,ve)||0===ze&&ne(_e,de,ve)||0===pt&&ne(ae,_e,de)||0===br&&ne(ae,ve,de))}function ne(_e,ve,ae){return ve.x<=Math.max(_e.x,ae.x)&&ve.x>=Math.min(_e.x,ae.x)&&ve.y<=Math.max(_e.y,ae.y)&&ve.y>=Math.min(_e.y,ae.y)}function nr(_e){return _e>0?1:_e<0?-1:0}function $e(_e,ve){return At(_e.prev,_e,_e.next)<0?At(_e,ve,_e.next)>=0&&At(_e,_e.prev,ve)>=0:At(_e,ve,_e.prev)<0||At(_e,_e.next,ve)<0}function qe(_e,ve){var ae=new hr(_e.i,_e.x,_e.y),de=new hr(ve.i,ve.x,ve.y),Pe=_e.next,ze=ve.prev;return _e.next=ve,ve.prev=_e,ae.next=Pe,Pe.prev=ae,de.next=ae,ae.prev=de,ze.next=de,de.prev=ze,de}function Dt(_e,ve,ae,de){var Pe=new hr(_e,ve,ae);return de?(Pe.next=de.next,Pe.prev=de,de.next.prev=Pe,de.next=Pe):(Pe.prev=Pe,Pe.next=Pe),Pe}function lr(_e){_e.next.prev=_e.prev,_e.prev.next=_e.next,_e.prevZ&&(_e.prevZ.nextZ=_e.nextZ),_e.nextZ&&(_e.nextZ.prevZ=_e.prevZ)}function hr(_e,ve,ae){this.i=_e,this.x=ve,this.y=ae,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Dr(_e,ve,ae,de){for(var Pe=0,ze=ve,pt=ae-de;ze<ae;ze+=de)Pe+=(_e[pt]-_e[ze])*(_e[ze+1]+_e[pt+1]),pt=ze;return Pe}dr.exports=H,dr.exports.default=H,H.deviation=function(_e,ve,ae,de){var Pe=ve&&ve.length,pt=Math.abs(Dr(_e,0,Pe?ve[0]*ae:_e.length,ae));if(Pe)for(var br=0,Ur=ve.length;br<Ur;br++)pt-=Math.abs(Dr(_e,ve[br]*ae,br<Ur-1?ve[br+1]*ae:_e.length,ae));var wt=0;for(br=0;br<de.length;br+=3){var Ie=de[br]*ae,we=de[br+1]*ae,nt=de[br+2]*ae;wt+=Math.abs((_e[Ie]-_e[nt])*(_e[we+1]-_e[Ie+1])-(_e[Ie]-_e[we])*(_e[nt+1]-_e[Ie+1]))}return 0===pt&&0===wt?0:Math.abs((wt-pt)/pt)},H.flatten=function(_e){for(var ve=_e[0][0].length,ae={vertices:[],holes:[],dimensions:ve},de=0,Pe=0;Pe<_e.length;Pe++){for(var ze=0;ze<_e[Pe].length;ze++)for(var pt=0;pt<ve;pt++)ae.vertices.push(_e[Pe][ze][pt]);Pe>0&&ae.holes.push(de+=_e[Pe-1].length)}return ae}},18660:dr=>{function H(ue){var w=ue.target||ue.srcElement;w.__resizeRAF__&&cancelAnimationFrame(w.__resizeRAF__),w.__resizeRAF__=requestAnimationFrame(function(){var p=w.__resizeTrigger__,_=p&&p.__resizeListeners__;_&&_.forEach(function(W){W.call(p,ue)})})}var M=function(w,p){var X,W=this.document,q=W.attachEvent;if("undefined"!=typeof navigator&&(X=navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/Edge/)),!w.__resizeListeners__)if(w.__resizeListeners__=[],q)w.__resizeTrigger__=w,w.attachEvent("onresize",H);else{"static"===getComputedStyle(w).position&&(w.style.position="relative");var Y=w.__resizeTrigger__=W.createElement("object");Y.setAttribute("style","position: absolute; top: 0; left: 0; height: 100%; width: 100%; pointer-events: none; z-index: -1; opacity: 0;"),Y.setAttribute("class","resize-sensor"),Y.setAttribute("tabindex","-1"),Y.setAttribute("title",""),Y.__resizeElement__=w,Y.onload=function(){this.contentDocument.defaultView.__resizeTrigger__=this.__resizeElement__,this.contentDocument.defaultView.addEventListener("resize",H)},Y.type="text/html",X&&w.appendChild(Y),Y.data="about:blank",X||w.appendChild(Y)}w.__resizeListeners__.push(p)};dr.exports="undefined"==typeof window?M:M.bind(window),dr.exports.unbind=function(ue,w){var p=document.attachEvent,_=ue.__resizeListeners__||[];if(w){var W=_.indexOf(w);-1!==W&&_.splice(W,1)}else _=ue.__resizeListeners__=[];if(!_.length){if(p)ue.detachEvent("onresize",H);else if(ue.__resizeTrigger__){var X=ue.__resizeTrigger__.contentDocument,q=X&&X.defaultView;q&&(q.removeEventListener("resize",H),delete q.__resizeTrigger__),ue.__resizeTrigger__=!ue.removeChild(ue.__resizeTrigger__)}delete ue.__resizeListeners__}}},42624:dr=>{"use strict";var H=Object.prototype.hasOwnProperty,M="~";function ue(){}function w(X,q,te){this.fn=X,this.context=q,this.once=te||!1}function p(X,q,te,Y,Xe){if("function"!=typeof te)throw new TypeError("The listener must be a function");var et=new w(te,Y||X,Xe),z=M?M+q:q;return X._events[z]?X._events[z].fn?X._events[z]=[X._events[z],et]:X._events[z].push(et):(X._events[z]=et,X._eventsCount++),X}function _(X,q){0==--X._eventsCount?X._events=new ue:delete X._events[q]}function W(){this._events=new ue,this._eventsCount=0}Object.create&&(ue.prototype=Object.create(null),(new ue).__proto__||(M=!1)),W.prototype.eventNames=function(){var te,Y,q=[];if(0===this._eventsCount)return q;for(Y in te=this._events)H.call(te,Y)&&q.push(M?Y.slice(1):Y);return Object.getOwnPropertySymbols?q.concat(Object.getOwnPropertySymbols(te)):q},W.prototype.listeners=function(q){var Y=this._events[M?M+q:q];if(!Y)return[];if(Y.fn)return[Y.fn];for(var Xe=0,et=Y.length,z=new Array(et);Xe<et;Xe++)z[Xe]=Y[Xe].fn;return z},W.prototype.listenerCount=function(q){var Y=this._events[M?M+q:q];return Y?Y.fn?1:Y.length:0},W.prototype.emit=function(q,te,Y,Xe,et,z){var Z=M?M+q:q;if(!this._events[Z])return!1;var sr,Ut,tt=this._events[Z],Mt=arguments.length;if(tt.fn){switch(tt.once&&this.removeListener(q,tt.fn,void 0,!0),Mt){case 1:return tt.fn.call(tt.context),!0;case 2:return tt.fn.call(tt.context,te),!0;case 3:return tt.fn.call(tt.context,te,Y),!0;case 4:return tt.fn.call(tt.context,te,Y,Xe),!0;case 5:return tt.fn.call(tt.context,te,Y,Xe,et),!0;case 6:return tt.fn.call(tt.context,te,Y,Xe,et,z),!0}for(Ut=1,sr=new Array(Mt-1);Ut<Mt;Ut++)sr[Ut-1]=arguments[Ut];tt.fn.apply(tt.context,sr)}else{var Et,At=tt.length;for(Ut=0;Ut<At;Ut++)switch(tt[Ut].once&&this.removeListener(q,tt[Ut].fn,void 0,!0),Mt){case 1:tt[Ut].fn.call(tt[Ut].context);break;case 2:tt[Ut].fn.call(tt[Ut].context,te);break;case 3:tt[Ut].fn.call(tt[Ut].context,te,Y);break;case 4:tt[Ut].fn.call(tt[Ut].context,te,Y,Xe);break;default:if(!sr)for(Et=1,sr=new Array(Mt-1);Et<Mt;Et++)sr[Et-1]=arguments[Et];tt[Ut].fn.apply(tt[Ut].context,sr)}}return!0},W.prototype.on=function(q,te,Y){return p(this,q,te,Y,!1)},W.prototype.once=function(q,te,Y){return p(this,q,te,Y,!0)},W.prototype.removeListener=function(q,te,Y,Xe){var et=M?M+q:q;if(!this._events[et])return this;if(!te)return _(this,et),this;var z=this._events[et];if(z.fn)z.fn===te&&(!Xe||z.once)&&(!Y||z.context===Y)&&_(this,et);else{for(var Z=0,tt=[],Mt=z.length;Z<Mt;Z++)(z[Z].fn!==te||Xe&&!z[Z].once||Y&&z[Z].context!==Y)&&tt.push(z[Z]);tt.length?this._events[et]=1===tt.length?tt[0]:tt:_(this,et)}return this},W.prototype.removeAllListeners=function(q){var te;return q?this._events[te=M?M+q:q]&&_(this,te):(this._events=new ue,this._eventsCount=0),this},W.prototype.off=W.prototype.removeListener,W.prototype.addListener=W.prototype.on,W.prefixed=M,W.EventEmitter=W,dr.exports=W},14563:(dr,H,M)=>{"use strict";M.d(H,{Ib:()=>ue,WT:()=>w,FD:()=>p});var ue=1e-6,w="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;Math,Math.hypot||(Math.hypot=function(){for(var te=0,Y=arguments.length;Y--;)te+=arguments[Y]*arguments[Y];return Math.sqrt(te)})},30651:(dr,H,M)=>{"use strict";M.r(H),M.d(H,{create:()=>w,clone:()=>p,copy:()=>_,fromValues:()=>W,set:()=>X,identity:()=>q,transpose:()=>te,invert:()=>Y,adjoint:()=>Xe,determinant:()=>et,multiply:()=>z,translate:()=>Z,scale:()=>tt,rotate:()=>Mt,rotateX:()=>sr,rotateY:()=>Ut,rotateZ:()=>At,fromTranslation:()=>Et,fromScaling:()=>vr,fromRotation:()=>ne,fromXRotation:()=>nr,fromYRotation:()=>Tt,fromZRotation:()=>$e,fromRotationTranslation:()=>Ct,fromQuat2:()=>qe,getTranslation:()=>Dt,getScaling:()=>lr,getRotation:()=>hr,fromRotationTranslationScale:()=>Dr,fromRotationTranslationScaleOrigin:()=>_e,fromQuat:()=>ve,frustum:()=>ae,perspectiveNO:()=>de,perspective:()=>Pe,perspectiveZO:()=>ze,perspectiveFromFieldOfView:()=>pt,orthoNO:()=>br,ortho:()=>Ur,orthoZO:()=>fn,lookAt:()=>Pr,targetTo:()=>wt,str:()=>Ie,frob:()=>we,add:()=>nt,subtract:()=>Le,multiplyScalar:()=>Wt,multiplyScalarAndAdd:()=>Ar,exactEquals:()=>Yt,equals:()=>cr,mul:()=>Fr,sub:()=>Zn});var ue=M(14563);function w(){var T=new ue.WT(16);return ue.WT!=Float32Array&&(T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[11]=0,T[12]=0,T[13]=0,T[14]=0),T[0]=1,T[5]=1,T[10]=1,T[15]=1,T}function p(T){var G=new ue.WT(16);return G[0]=T[0],G[1]=T[1],G[2]=T[2],G[3]=T[3],G[4]=T[4],G[5]=T[5],G[6]=T[6],G[7]=T[7],G[8]=T[8],G[9]=T[9],G[10]=T[10],G[11]=T[11],G[12]=T[12],G[13]=T[13],G[14]=T[14],G[15]=T[15],G}function _(T,G){return T[0]=G[0],T[1]=G[1],T[2]=G[2],T[3]=G[3],T[4]=G[4],T[5]=G[5],T[6]=G[6],T[7]=G[7],T[8]=G[8],T[9]=G[9],T[10]=G[10],T[11]=G[11],T[12]=G[12],T[13]=G[13],T[14]=G[14],T[15]=G[15],T}function W(T,G,Ve,rt,dt,Ot,B,Ue,_t,St,Xt,Cr,_r,jt,mr,er){var pr=new ue.WT(16);return pr[0]=T,pr[1]=G,pr[2]=Ve,pr[3]=rt,pr[4]=dt,pr[5]=Ot,pr[6]=B,pr[7]=Ue,pr[8]=_t,pr[9]=St,pr[10]=Xt,pr[11]=Cr,pr[12]=_r,pr[13]=jt,pr[14]=mr,pr[15]=er,pr}function X(T,G,Ve,rt,dt,Ot,B,Ue,_t,St,Xt,Cr,_r,jt,mr,er,pr){return T[0]=G,T[1]=Ve,T[2]=rt,T[3]=dt,T[4]=Ot,T[5]=B,T[6]=Ue,T[7]=_t,T[8]=St,T[9]=Xt,T[10]=Cr,T[11]=_r,T[12]=jt,T[13]=mr,T[14]=er,T[15]=pr,T}function q(T){return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=1,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=1,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function te(T,G){if(T===G){var Ve=G[1],rt=G[2],dt=G[3],Ot=G[6],B=G[7],Ue=G[11];T[1]=G[4],T[2]=G[8],T[3]=G[12],T[4]=Ve,T[6]=G[9],T[7]=G[13],T[8]=rt,T[9]=Ot,T[11]=G[14],T[12]=dt,T[13]=B,T[14]=Ue}else T[0]=G[0],T[1]=G[4],T[2]=G[8],T[3]=G[12],T[4]=G[1],T[5]=G[5],T[6]=G[9],T[7]=G[13],T[8]=G[2],T[9]=G[6],T[10]=G[10],T[11]=G[14],T[12]=G[3],T[13]=G[7],T[14]=G[11],T[15]=G[15];return T}function Y(T,G){var Ve=G[0],rt=G[1],dt=G[2],Ot=G[3],B=G[4],Ue=G[5],_t=G[6],St=G[7],Xt=G[8],Cr=G[9],_r=G[10],jt=G[11],mr=G[12],er=G[13],pr=G[14],Ln=G[15],Wn=Ve*Ue-rt*B,mi=Ve*_t-dt*B,hi=Ve*St-Ot*B,si=rt*_t-dt*Ue,ai=rt*St-Ot*Ue,Yi=dt*St-Ot*_t,Pi=Xt*er-Cr*mr,Ei=Xt*pr-_r*mr,Q=Xt*Ln-jt*mr,he=Cr*pr-_r*er,ge=Cr*Ln-jt*er,F=_r*Ln-jt*pr,re=Wn*F-mi*ge+hi*he+si*Q-ai*Ei+Yi*Pi;return re?(T[0]=(Ue*F-_t*ge+St*he)*(re=1/re),T[1]=(dt*ge-rt*F-Ot*he)*re,T[2]=(er*Yi-pr*ai+Ln*si)*re,T[3]=(_r*ai-Cr*Yi-jt*si)*re,T[4]=(_t*Q-B*F-St*Ei)*re,T[5]=(Ve*F-dt*Q+Ot*Ei)*re,T[6]=(pr*hi-mr*Yi-Ln*mi)*re,T[7]=(Xt*Yi-_r*hi+jt*mi)*re,T[8]=(B*ge-Ue*Q+St*Pi)*re,T[9]=(rt*Q-Ve*ge-Ot*Pi)*re,T[10]=(mr*ai-er*hi+Ln*Wn)*re,T[11]=(Cr*hi-Xt*ai-jt*Wn)*re,T[12]=(Ue*Ei-B*he-_t*Pi)*re,T[13]=(Ve*he-rt*Ei+dt*Pi)*re,T[14]=(er*mi-mr*si-pr*Wn)*re,T[15]=(Xt*si-Cr*mi+_r*Wn)*re,T):null}function Xe(T,G){var Ve=G[0],rt=G[1],dt=G[2],Ot=G[3],B=G[4],Ue=G[5],_t=G[6],St=G[7],Xt=G[8],Cr=G[9],_r=G[10],jt=G[11],mr=G[12],er=G[13],pr=G[14],Ln=G[15];return T[0]=Ue*(_r*Ln-jt*pr)-Cr*(_t*Ln-St*pr)+er*(_t*jt-St*_r),T[1]=-(rt*(_r*Ln-jt*pr)-Cr*(dt*Ln-Ot*pr)+er*(dt*jt-Ot*_r)),T[2]=rt*(_t*Ln-St*pr)-Ue*(dt*Ln-Ot*pr)+er*(dt*St-Ot*_t),T[3]=-(rt*(_t*jt-St*_r)-Ue*(dt*jt-Ot*_r)+Cr*(dt*St-Ot*_t)),T[4]=-(B*(_r*Ln-jt*pr)-Xt*(_t*Ln-St*pr)+mr*(_t*jt-St*_r)),T[5]=Ve*(_r*Ln-jt*pr)-Xt*(dt*Ln-Ot*pr)+mr*(dt*jt-Ot*_r),T[6]=-(Ve*(_t*Ln-St*pr)-B*(dt*Ln-Ot*pr)+mr*(dt*St-Ot*_t)),T[7]=Ve*(_t*jt-St*_r)-B*(dt*jt-Ot*_r)+Xt*(dt*St-Ot*_t),T[8]=B*(Cr*Ln-jt*er)-Xt*(Ue*Ln-St*er)+mr*(Ue*jt-St*Cr),T[9]=-(Ve*(Cr*Ln-jt*er)-Xt*(rt*Ln-Ot*er)+mr*(rt*jt-Ot*Cr)),T[10]=Ve*(Ue*Ln-St*er)-B*(rt*Ln-Ot*er)+mr*(rt*St-Ot*Ue),T[11]=-(Ve*(Ue*jt-St*Cr)-B*(rt*jt-Ot*Cr)+Xt*(rt*St-Ot*Ue)),T[12]=-(B*(Cr*pr-_r*er)-Xt*(Ue*pr-_t*er)+mr*(Ue*_r-_t*Cr)),T[13]=Ve*(Cr*pr-_r*er)-Xt*(rt*pr-dt*er)+mr*(rt*_r-dt*Cr),T[14]=-(Ve*(Ue*pr-_t*er)-B*(rt*pr-dt*er)+mr*(rt*_t-dt*Ue)),T[15]=Ve*(Ue*_r-_t*Cr)-B*(rt*_r-dt*Cr)+Xt*(rt*_t-dt*Ue),T}function et(T){var G=T[0],Ve=T[1],rt=T[2],dt=T[3],Ot=T[4],B=T[5],Ue=T[6],_t=T[7],St=T[8],Xt=T[9],Cr=T[10],_r=T[11],jt=T[12],mr=T[13],er=T[14],pr=T[15];return(G*B-Ve*Ot)*(Cr*pr-_r*er)-(G*Ue-rt*Ot)*(Xt*pr-_r*mr)+(G*_t-dt*Ot)*(Xt*er-Cr*mr)+(Ve*Ue-rt*B)*(St*pr-_r*jt)-(Ve*_t-dt*B)*(St*er-Cr*jt)+(rt*_t-dt*Ue)*(St*mr-Xt*jt)}function z(T,G,Ve){var rt=G[0],dt=G[1],Ot=G[2],B=G[3],Ue=G[4],_t=G[5],St=G[6],Xt=G[7],Cr=G[8],_r=G[9],jt=G[10],mr=G[11],er=G[12],pr=G[13],Ln=G[14],Wn=G[15],mi=Ve[0],hi=Ve[1],si=Ve[2],ai=Ve[3];return T[0]=mi*rt+hi*Ue+si*Cr+ai*er,T[1]=mi*dt+hi*_t+si*_r+ai*pr,T[2]=mi*Ot+hi*St+si*jt+ai*Ln,T[3]=mi*B+hi*Xt+si*mr+ai*Wn,T[4]=(mi=Ve[4])*rt+(hi=Ve[5])*Ue+(si=Ve[6])*Cr+(ai=Ve[7])*er,T[5]=mi*dt+hi*_t+si*_r+ai*pr,T[6]=mi*Ot+hi*St+si*jt+ai*Ln,T[7]=mi*B+hi*Xt+si*mr+ai*Wn,T[8]=(mi=Ve[8])*rt+(hi=Ve[9])*Ue+(si=Ve[10])*Cr+(ai=Ve[11])*er,T[9]=mi*dt+hi*_t+si*_r+ai*pr,T[10]=mi*Ot+hi*St+si*jt+ai*Ln,T[11]=mi*B+hi*Xt+si*mr+ai*Wn,T[12]=(mi=Ve[12])*rt+(hi=Ve[13])*Ue+(si=Ve[14])*Cr+(ai=Ve[15])*er,T[13]=mi*dt+hi*_t+si*_r+ai*pr,T[14]=mi*Ot+hi*St+si*jt+ai*Ln,T[15]=mi*B+hi*Xt+si*mr+ai*Wn,T}function Z(T,G,Ve){var B,Ue,_t,St,Xt,Cr,_r,jt,mr,er,pr,Ln,rt=Ve[0],dt=Ve[1],Ot=Ve[2];return G===T?(T[12]=G[0]*rt+G[4]*dt+G[8]*Ot+G[12],T[13]=G[1]*rt+G[5]*dt+G[9]*Ot+G[13],T[14]=G[2]*rt+G[6]*dt+G[10]*Ot+G[14],T[15]=G[3]*rt+G[7]*dt+G[11]*Ot+G[15]):(Ue=G[1],_t=G[2],St=G[3],Xt=G[4],Cr=G[5],_r=G[6],jt=G[7],mr=G[8],er=G[9],pr=G[10],Ln=G[11],T[0]=B=G[0],T[1]=Ue,T[2]=_t,T[3]=St,T[4]=Xt,T[5]=Cr,T[6]=_r,T[7]=jt,T[8]=mr,T[9]=er,T[10]=pr,T[11]=Ln,T[12]=B*rt+Xt*dt+mr*Ot+G[12],T[13]=Ue*rt+Cr*dt+er*Ot+G[13],T[14]=_t*rt+_r*dt+pr*Ot+G[14],T[15]=St*rt+jt*dt+Ln*Ot+G[15]),T}function tt(T,G,Ve){var rt=Ve[0],dt=Ve[1],Ot=Ve[2];return T[0]=G[0]*rt,T[1]=G[1]*rt,T[2]=G[2]*rt,T[3]=G[3]*rt,T[4]=G[4]*dt,T[5]=G[5]*dt,T[6]=G[6]*dt,T[7]=G[7]*dt,T[8]=G[8]*Ot,T[9]=G[9]*Ot,T[10]=G[10]*Ot,T[11]=G[11]*Ot,T[12]=G[12],T[13]=G[13],T[14]=G[14],T[15]=G[15],T}function Mt(T,G,Ve,rt){var _t,St,Xt,Cr,_r,jt,mr,er,pr,Ln,Wn,mi,hi,si,ai,Yi,Pi,Ei,Q,he,ge,F,re,ye,dt=rt[0],Ot=rt[1],B=rt[2],Ue=Math.hypot(dt,Ot,B);return Ue<ue.Ib?null:(dt*=Ue=1/Ue,Ot*=Ue,B*=Ue,_t=Math.sin(Ve),St=Math.cos(Ve),_r=G[1],jt=G[2],mr=G[3],pr=G[5],Ln=G[6],Wn=G[7],hi=G[9],si=G[10],ai=G[11],Q=dt*Ot*(Xt=1-St)-B*_t,he=Ot*Ot*Xt+St,ge=B*Ot*Xt+dt*_t,F=dt*B*Xt+Ot*_t,re=Ot*B*Xt-dt*_t,ye=B*B*Xt+St,T[0]=(Cr=G[0])*(Yi=dt*dt*Xt+St)+(er=G[4])*(Pi=Ot*dt*Xt+B*_t)+(mi=G[8])*(Ei=B*dt*Xt-Ot*_t),T[1]=_r*Yi+pr*Pi+hi*Ei,T[2]=jt*Yi+Ln*Pi+si*Ei,T[3]=mr*Yi+Wn*Pi+ai*Ei,T[4]=Cr*Q+er*he+mi*ge,T[5]=_r*Q+pr*he+hi*ge,T[6]=jt*Q+Ln*he+si*ge,T[7]=mr*Q+Wn*he+ai*ge,T[8]=Cr*F+er*re+mi*ye,T[9]=_r*F+pr*re+hi*ye,T[10]=jt*F+Ln*re+si*ye,T[11]=mr*F+Wn*re+ai*ye,G!==T&&(T[12]=G[12],T[13]=G[13],T[14]=G[14],T[15]=G[15]),T)}function sr(T,G,Ve){var rt=Math.sin(Ve),dt=Math.cos(Ve),Ot=G[4],B=G[5],Ue=G[6],_t=G[7],St=G[8],Xt=G[9],Cr=G[10],_r=G[11];return G!==T&&(T[0]=G[0],T[1]=G[1],T[2]=G[2],T[3]=G[3],T[12]=G[12],T[13]=G[13],T[14]=G[14],T[15]=G[15]),T[4]=Ot*dt+St*rt,T[5]=B*dt+Xt*rt,T[6]=Ue*dt+Cr*rt,T[7]=_t*dt+_r*rt,T[8]=St*dt-Ot*rt,T[9]=Xt*dt-B*rt,T[10]=Cr*dt-Ue*rt,T[11]=_r*dt-_t*rt,T}function Ut(T,G,Ve){var rt=Math.sin(Ve),dt=Math.cos(Ve),Ot=G[0],B=G[1],Ue=G[2],_t=G[3],St=G[8],Xt=G[9],Cr=G[10],_r=G[11];return G!==T&&(T[4]=G[4],T[5]=G[5],T[6]=G[6],T[7]=G[7],T[12]=G[12],T[13]=G[13],T[14]=G[14],T[15]=G[15]),T[0]=Ot*dt-St*rt,T[1]=B*dt-Xt*rt,T[2]=Ue*dt-Cr*rt,T[3]=_t*dt-_r*rt,T[8]=Ot*rt+St*dt,T[9]=B*rt+Xt*dt,T[10]=Ue*rt+Cr*dt,T[11]=_t*rt+_r*dt,T}function At(T,G,Ve){var rt=Math.sin(Ve),dt=Math.cos(Ve),Ot=G[0],B=G[1],Ue=G[2],_t=G[3],St=G[4],Xt=G[5],Cr=G[6],_r=G[7];return G!==T&&(T[8]=G[8],T[9]=G[9],T[10]=G[10],T[11]=G[11],T[12]=G[12],T[13]=G[13],T[14]=G[14],T[15]=G[15]),T[0]=Ot*dt+St*rt,T[1]=B*dt+Xt*rt,T[2]=Ue*dt+Cr*rt,T[3]=_t*dt+_r*rt,T[4]=St*dt-Ot*rt,T[5]=Xt*dt-B*rt,T[6]=Cr*dt-Ue*rt,T[7]=_r*dt-_t*rt,T}function Et(T,G){return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=1,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=1,T[11]=0,T[12]=G[0],T[13]=G[1],T[14]=G[2],T[15]=1,T}function vr(T,G){return T[0]=G[0],T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=G[1],T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=G[2],T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function ne(T,G,Ve){var Ue,_t,St,rt=Ve[0],dt=Ve[1],Ot=Ve[2],B=Math.hypot(rt,dt,Ot);return B<ue.Ib?null:(rt*=B=1/B,dt*=B,Ot*=B,Ue=Math.sin(G),_t=Math.cos(G),T[0]=rt*rt*(St=1-_t)+_t,T[1]=dt*rt*St+Ot*Ue,T[2]=Ot*rt*St-dt*Ue,T[3]=0,T[4]=rt*dt*St-Ot*Ue,T[5]=dt*dt*St+_t,T[6]=Ot*dt*St+rt*Ue,T[7]=0,T[8]=rt*Ot*St+dt*Ue,T[9]=dt*Ot*St-rt*Ue,T[10]=Ot*Ot*St+_t,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T)}function nr(T,G){var Ve=Math.sin(G),rt=Math.cos(G);return T[0]=1,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=rt,T[6]=Ve,T[7]=0,T[8]=0,T[9]=-Ve,T[10]=rt,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function Tt(T,G){var Ve=Math.sin(G),rt=Math.cos(G);return T[0]=rt,T[1]=0,T[2]=-Ve,T[3]=0,T[4]=0,T[5]=1,T[6]=0,T[7]=0,T[8]=Ve,T[9]=0,T[10]=rt,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function $e(T,G){var Ve=Math.sin(G),rt=Math.cos(G);return T[0]=rt,T[1]=Ve,T[2]=0,T[3]=0,T[4]=-Ve,T[5]=rt,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=1,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function Ct(T,G,Ve){var rt=G[0],dt=G[1],Ot=G[2],B=G[3],Ue=rt+rt,_t=dt+dt,St=Ot+Ot,Xt=rt*Ue,Cr=rt*_t,_r=rt*St,jt=dt*_t,mr=dt*St,er=Ot*St,pr=B*Ue,Ln=B*_t,Wn=B*St;return T[0]=1-(jt+er),T[1]=Cr+Wn,T[2]=_r-Ln,T[3]=0,T[4]=Cr-Wn,T[5]=1-(Xt+er),T[6]=mr+pr,T[7]=0,T[8]=_r+Ln,T[9]=mr-pr,T[10]=1-(Xt+jt),T[11]=0,T[12]=Ve[0],T[13]=Ve[1],T[14]=Ve[2],T[15]=1,T}function qe(T,G){var Ve=new ue.WT(3),rt=-G[0],dt=-G[1],Ot=-G[2],B=G[3],Ue=G[4],_t=G[5],St=G[6],Xt=G[7],Cr=rt*rt+dt*dt+Ot*Ot+B*B;return Cr>0?(Ve[0]=2*(Ue*B+Xt*rt+_t*Ot-St*dt)/Cr,Ve[1]=2*(_t*B+Xt*dt+St*rt-Ue*Ot)/Cr,Ve[2]=2*(St*B+Xt*Ot+Ue*dt-_t*rt)/Cr):(Ve[0]=2*(Ue*B+Xt*rt+_t*Ot-St*dt),Ve[1]=2*(_t*B+Xt*dt+St*rt-Ue*Ot),Ve[2]=2*(St*B+Xt*Ot+Ue*dt-_t*rt)),Ct(T,G,Ve),T}function Dt(T,G){return T[0]=G[12],T[1]=G[13],T[2]=G[14],T}function lr(T,G){var Ot=G[4],B=G[5],Ue=G[6],_t=G[8],St=G[9],Xt=G[10];return T[0]=Math.hypot(G[0],G[1],G[2]),T[1]=Math.hypot(Ot,B,Ue),T[2]=Math.hypot(_t,St,Xt),T}function hr(T,G){var Ve=new ue.WT(3);lr(Ve,G);var rt=1/Ve[0],dt=1/Ve[1],Ot=1/Ve[2],B=G[0]*rt,Ue=G[1]*dt,_t=G[2]*Ot,St=G[4]*rt,Xt=G[5]*dt,Cr=G[6]*Ot,_r=G[8]*rt,jt=G[9]*dt,mr=G[10]*Ot,er=B+Xt+mr,pr=0;return er>0?(pr=2*Math.sqrt(er+1),T[3]=.25*pr,T[0]=(Cr-jt)/pr,T[1]=(_r-_t)/pr,T[2]=(Ue-St)/pr):B>Xt&&B>mr?(pr=2*Math.sqrt(1+B-Xt-mr),T[3]=(Cr-jt)/pr,T[0]=.25*pr,T[1]=(Ue+St)/pr,T[2]=(_r+_t)/pr):Xt>mr?(pr=2*Math.sqrt(1+Xt-B-mr),T[3]=(_r-_t)/pr,T[0]=(Ue+St)/pr,T[1]=.25*pr,T[2]=(Cr+jt)/pr):(pr=2*Math.sqrt(1+mr-B-Xt),T[3]=(Ue-St)/pr,T[0]=(_r+_t)/pr,T[1]=(Cr+jt)/pr,T[2]=.25*pr),T}function Dr(T,G,Ve,rt){var dt=G[0],Ot=G[1],B=G[2],Ue=G[3],_t=dt+dt,St=Ot+Ot,Xt=B+B,Cr=dt*_t,_r=dt*St,jt=dt*Xt,mr=Ot*St,er=Ot*Xt,pr=B*Xt,Ln=Ue*_t,Wn=Ue*St,mi=Ue*Xt,hi=rt[0],si=rt[1],ai=rt[2];return T[0]=(1-(mr+pr))*hi,T[1]=(_r+mi)*hi,T[2]=(jt-Wn)*hi,T[3]=0,T[4]=(_r-mi)*si,T[5]=(1-(Cr+pr))*si,T[6]=(er+Ln)*si,T[7]=0,T[8]=(jt+Wn)*ai,T[9]=(er-Ln)*ai,T[10]=(1-(Cr+mr))*ai,T[11]=0,T[12]=Ve[0],T[13]=Ve[1],T[14]=Ve[2],T[15]=1,T}function _e(T,G,Ve,rt,dt){var Ot=G[0],B=G[1],Ue=G[2],_t=G[3],St=Ot+Ot,Xt=B+B,Cr=Ue+Ue,_r=Ot*St,jt=Ot*Xt,mr=Ot*Cr,er=B*Xt,pr=B*Cr,Ln=Ue*Cr,Wn=_t*St,mi=_t*Xt,hi=_t*Cr,si=rt[0],ai=rt[1],Yi=rt[2],Pi=dt[0],Ei=dt[1],Q=dt[2],he=(1-(er+Ln))*si,ge=(jt+hi)*si,F=(mr-mi)*si,re=(jt-hi)*ai,ye=(1-(_r+Ln))*ai,Me=(pr+Wn)*ai,ce=(mr+mi)*Yi,Te=(pr-Wn)*Yi,mt=(1-(_r+er))*Yi;return T[0]=he,T[1]=ge,T[2]=F,T[3]=0,T[4]=re,T[5]=ye,T[6]=Me,T[7]=0,T[8]=ce,T[9]=Te,T[10]=mt,T[11]=0,T[12]=Ve[0]+Pi-(he*Pi+re*Ei+ce*Q),T[13]=Ve[1]+Ei-(ge*Pi+ye*Ei+Te*Q),T[14]=Ve[2]+Q-(F*Pi+Me*Ei+mt*Q),T[15]=1,T}function ve(T,G){var Ve=G[0],rt=G[1],dt=G[2],Ot=G[3],B=Ve+Ve,Ue=rt+rt,_t=dt+dt,St=Ve*B,Xt=rt*B,Cr=rt*Ue,_r=dt*B,jt=dt*Ue,mr=dt*_t,er=Ot*B,pr=Ot*Ue,Ln=Ot*_t;return T[0]=1-Cr-mr,T[1]=Xt+Ln,T[2]=_r-pr,T[3]=0,T[4]=Xt-Ln,T[5]=1-St-mr,T[6]=jt+er,T[7]=0,T[8]=_r+pr,T[9]=jt-er,T[10]=1-St-Cr,T[11]=0,T[12]=0,T[13]=0,T[14]=0,T[15]=1,T}function ae(T,G,Ve,rt,dt,Ot,B){var Ue=1/(Ve-G),_t=1/(dt-rt),St=1/(Ot-B);return T[0]=2*Ot*Ue,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=2*Ot*_t,T[6]=0,T[7]=0,T[8]=(Ve+G)*Ue,T[9]=(dt+rt)*_t,T[10]=(B+Ot)*St,T[11]=-1,T[12]=0,T[13]=0,T[14]=B*Ot*2*St,T[15]=0,T}function de(T,G,Ve,rt,dt){var B,Ot=1/Math.tan(G/2);return T[0]=Ot/Ve,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=Ot,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[11]=-1,T[12]=0,T[13]=0,T[15]=0,null!=dt&&dt!==1/0?(T[10]=(dt+rt)*(B=1/(rt-dt)),T[14]=2*dt*rt*B):(T[10]=-1,T[14]=-2*rt),T}var Pe=de;function ze(T,G,Ve,rt,dt){var B,Ot=1/Math.tan(G/2);return T[0]=Ot/Ve,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=Ot,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[11]=-1,T[12]=0,T[13]=0,T[15]=0,null!=dt&&dt!==1/0?(T[10]=dt*(B=1/(rt-dt)),T[14]=dt*rt*B):(T[10]=-1,T[14]=-rt),T}function pt(T,G,Ve,rt){var dt=Math.tan(G.upDegrees*Math.PI/180),Ot=Math.tan(G.downDegrees*Math.PI/180),B=Math.tan(G.leftDegrees*Math.PI/180),Ue=Math.tan(G.rightDegrees*Math.PI/180),_t=2/(B+Ue),St=2/(dt+Ot);return T[0]=_t,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=St,T[6]=0,T[7]=0,T[8]=-(B-Ue)*_t*.5,T[9]=(dt-Ot)*St*.5,T[10]=rt/(Ve-rt),T[11]=-1,T[12]=0,T[13]=0,T[14]=rt*Ve/(Ve-rt),T[15]=0,T}function br(T,G,Ve,rt,dt,Ot,B){var Ue=1/(G-Ve),_t=1/(rt-dt),St=1/(Ot-B);return T[0]=-2*Ue,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=-2*_t,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=2*St,T[11]=0,T[12]=(G+Ve)*Ue,T[13]=(dt+rt)*_t,T[14]=(B+Ot)*St,T[15]=1,T}var Ur=br;function fn(T,G,Ve,rt,dt,Ot,B){var Ue=1/(G-Ve),_t=1/(rt-dt),St=1/(Ot-B);return T[0]=-2*Ue,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=-2*_t,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=St,T[11]=0,T[12]=(G+Ve)*Ue,T[13]=(dt+rt)*_t,T[14]=Ot*St,T[15]=1,T}function Pr(T,G,Ve,rt){var dt,Ot,B,Ue,_t,St,Xt,Cr,_r,jt,mr=G[0],er=G[1],pr=G[2],Ln=rt[0],Wn=rt[1],mi=rt[2],hi=Ve[0],si=Ve[1],ai=Ve[2];return Math.abs(mr-hi)<ue.Ib&&Math.abs(er-si)<ue.Ib&&Math.abs(pr-ai)<ue.Ib?q(T):(Xt=mr-hi,Cr=er-si,_r=pr-ai,dt=Wn*(_r*=jt=1/Math.hypot(Xt,Cr,_r))-mi*(Cr*=jt),Ot=mi*(Xt*=jt)-Ln*_r,B=Ln*Cr-Wn*Xt,(jt=Math.hypot(dt,Ot,B))?(dt*=jt=1/jt,Ot*=jt,B*=jt):(dt=0,Ot=0,B=0),Ue=Cr*B-_r*Ot,_t=_r*dt-Xt*B,St=Xt*Ot-Cr*dt,(jt=Math.hypot(Ue,_t,St))?(Ue*=jt=1/jt,_t*=jt,St*=jt):(Ue=0,_t=0,St=0),T[0]=dt,T[1]=Ue,T[2]=Xt,T[3]=0,T[4]=Ot,T[5]=_t,T[6]=Cr,T[7]=0,T[8]=B,T[9]=St,T[10]=_r,T[11]=0,T[12]=-(dt*mr+Ot*er+B*pr),T[13]=-(Ue*mr+_t*er+St*pr),T[14]=-(Xt*mr+Cr*er+_r*pr),T[15]=1,T)}function wt(T,G,Ve,rt){var dt=G[0],Ot=G[1],B=G[2],Ue=rt[0],_t=rt[1],St=rt[2],Xt=dt-Ve[0],Cr=Ot-Ve[1],_r=B-Ve[2],jt=Xt*Xt+Cr*Cr+_r*_r;jt>0&&(Xt*=jt=1/Math.sqrt(jt),Cr*=jt,_r*=jt);var mr=_t*_r-St*Cr,er=St*Xt-Ue*_r,pr=Ue*Cr-_t*Xt;return(jt=mr*mr+er*er+pr*pr)>0&&(mr*=jt=1/Math.sqrt(jt),er*=jt,pr*=jt),T[0]=mr,T[1]=er,T[2]=pr,T[3]=0,T[4]=Cr*pr-_r*er,T[5]=_r*mr-Xt*pr,T[6]=Xt*er-Cr*mr,T[7]=0,T[8]=Xt,T[9]=Cr,T[10]=_r,T[11]=0,T[12]=dt,T[13]=Ot,T[14]=B,T[15]=1,T}function Ie(T){return"mat4("+T[0]+", "+T[1]+", "+T[2]+", "+T[3]+", "+T[4]+", "+T[5]+", "+T[6]+", "+T[7]+", "+T[8]+", "+T[9]+", "+T[10]+", "+T[11]+", "+T[12]+", "+T[13]+", "+T[14]+", "+T[15]+")"}function we(T){return Math.hypot(T[0],T[1],T[2],T[3],T[4],T[5],T[6],T[7],T[8],T[9],T[10],T[11],T[12],T[13],T[14],T[15])}function nt(T,G,Ve){return T[0]=G[0]+Ve[0],T[1]=G[1]+Ve[1],T[2]=G[2]+Ve[2],T[3]=G[3]+Ve[3],T[4]=G[4]+Ve[4],T[5]=G[5]+Ve[5],T[6]=G[6]+Ve[6],T[7]=G[7]+Ve[7],T[8]=G[8]+Ve[8],T[9]=G[9]+Ve[9],T[10]=G[10]+Ve[10],T[11]=G[11]+Ve[11],T[12]=G[12]+Ve[12],T[13]=G[13]+Ve[13],T[14]=G[14]+Ve[14],T[15]=G[15]+Ve[15],T}function Le(T,G,Ve){return T[0]=G[0]-Ve[0],T[1]=G[1]-Ve[1],T[2]=G[2]-Ve[2],T[3]=G[3]-Ve[3],T[4]=G[4]-Ve[4],T[5]=G[5]-Ve[5],T[6]=G[6]-Ve[6],T[7]=G[7]-Ve[7],T[8]=G[8]-Ve[8],T[9]=G[9]-Ve[9],T[10]=G[10]-Ve[10],T[11]=G[11]-Ve[11],T[12]=G[12]-Ve[12],T[13]=G[13]-Ve[13],T[14]=G[14]-Ve[14],T[15]=G[15]-Ve[15],T}function Wt(T,G,Ve){return T[0]=G[0]*Ve,T[1]=G[1]*Ve,T[2]=G[2]*Ve,T[3]=G[3]*Ve,T[4]=G[4]*Ve,T[5]=G[5]*Ve,T[6]=G[6]*Ve,T[7]=G[7]*Ve,T[8]=G[8]*Ve,T[9]=G[9]*Ve,T[10]=G[10]*Ve,T[11]=G[11]*Ve,T[12]=G[12]*Ve,T[13]=G[13]*Ve,T[14]=G[14]*Ve,T[15]=G[15]*Ve,T}function Ar(T,G,Ve,rt){return T[0]=G[0]+Ve[0]*rt,T[1]=G[1]+Ve[1]*rt,T[2]=G[2]+Ve[2]*rt,T[3]=G[3]+Ve[3]*rt,T[4]=G[4]+Ve[4]*rt,T[5]=G[5]+Ve[5]*rt,T[6]=G[6]+Ve[6]*rt,T[7]=G[7]+Ve[7]*rt,T[8]=G[8]+Ve[8]*rt,T[9]=G[9]+Ve[9]*rt,T[10]=G[10]+Ve[10]*rt,T[11]=G[11]+Ve[11]*rt,T[12]=G[12]+Ve[12]*rt,T[13]=G[13]+Ve[13]*rt,T[14]=G[14]+Ve[14]*rt,T[15]=G[15]+Ve[15]*rt,T}function Yt(T,G){return T[0]===G[0]&&T[1]===G[1]&&T[2]===G[2]&&T[3]===G[3]&&T[4]===G[4]&&T[5]===G[5]&&T[6]===G[6]&&T[7]===G[7]&&T[8]===G[8]&&T[9]===G[9]&&T[10]===G[10]&&T[11]===G[11]&&T[12]===G[12]&&T[13]===G[13]&&T[14]===G[14]&&T[15]===G[15]}function cr(T,G){var Ve=T[0],rt=T[1],dt=T[2],Ot=T[3],B=T[4],Ue=T[5],_t=T[6],St=T[7],Xt=T[8],Cr=T[9],_r=T[10],jt=T[11],mr=T[12],er=T[13],pr=T[14],Ln=T[15],Wn=G[0],mi=G[1],hi=G[2],si=G[3],ai=G[4],Yi=G[5],Pi=G[6],Ei=G[7],Q=G[8],he=G[9],ge=G[10],F=G[11],re=G[12],ye=G[13],Me=G[14],ce=G[15];return Math.abs(Ve-Wn)<=ue.Ib*Math.max(1,Math.abs(Ve),Math.abs(Wn))&&Math.abs(rt-mi)<=ue.Ib*Math.max(1,Math.abs(rt),Math.abs(mi))&&Math.abs(dt-hi)<=ue.Ib*Math.max(1,Math.abs(dt),Math.abs(hi))&&Math.abs(Ot-si)<=ue.Ib*Math.max(1,Math.abs(Ot),Math.abs(si))&&Math.abs(B-ai)<=ue.Ib*Math.max(1,Math.abs(B),Math.abs(ai))&&Math.abs(Ue-Yi)<=ue.Ib*Math.max(1,Math.abs(Ue),Math.abs(Yi))&&Math.abs(_t-Pi)<=ue.Ib*Math.max(1,Math.abs(_t),Math.abs(Pi))&&Math.abs(St-Ei)<=ue.Ib*Math.max(1,Math.abs(St),Math.abs(Ei))&&Math.abs(Xt-Q)<=ue.Ib*Math.max(1,Math.abs(Xt),Math.abs(Q))&&Math.abs(Cr-he)<=ue.Ib*Math.max(1,Math.abs(Cr),Math.abs(he))&&Math.abs(_r-ge)<=ue.Ib*Math.max(1,Math.abs(_r),Math.abs(ge))&&Math.abs(jt-F)<=ue.Ib*Math.max(1,Math.abs(jt),Math.abs(F))&&Math.abs(mr-re)<=ue.Ib*Math.max(1,Math.abs(mr),Math.abs(re))&&Math.abs(er-ye)<=ue.Ib*Math.max(1,Math.abs(er),Math.abs(ye))&&Math.abs(pr-Me)<=ue.Ib*Math.max(1,Math.abs(pr),Math.abs(Me))&&Math.abs(Ln-ce)<=ue.Ib*Math.max(1,Math.abs(Ln),Math.abs(ce))}var Fr=z,Zn=Le},58623:(dr,H,M)=>{"use strict";M.d(H,{Ue:()=>w,al:()=>_,bA:()=>sr,fF:()=>hr});var ue=M(14563);function w(){var Ie=new ue.WT(4);return ue.WT!=Float32Array&&(Ie[0]=0,Ie[1]=0,Ie[2]=0,Ie[3]=0),Ie}function _(Ie,we,nt,Le){var Wt=new ue.WT(4);return Wt[0]=Ie,Wt[1]=we,Wt[2]=nt,Wt[3]=Le,Wt}function sr(Ie,we,nt){return Ie[0]=we[0]*nt,Ie[1]=we[1]*nt,Ie[2]=we[2]*nt,Ie[3]=we[3]*nt,Ie}function hr(Ie,we,nt){var Le=we[0],Wt=we[1],Ar=we[2],Yt=we[3];return Ie[0]=nt[0]*Le+nt[4]*Wt+nt[8]*Ar+nt[12]*Yt,Ie[1]=nt[1]*Le+nt[5]*Wt+nt[9]*Ar+nt[13]*Yt,Ie[2]=nt[2]*Le+nt[6]*Wt+nt[10]*Ar+nt[14]*Yt,Ie[3]=nt[3]*Le+nt[7]*Wt+nt[11]*Ar+nt[15]*Yt,Ie}w()},11524:(dr,H,M)=>{var ue;!function(w,p,_,W){"use strict";var sr,X=["","webkit","Moz","MS","ms","o"],q=p.createElement("div"),Y=Math.round,Xe=Math.abs,et=Date.now;function z(be,Fe,vt){return setTimeout(vr(be,vt),Fe)}function Z(be,Fe,vt){return!!Array.isArray(be)&&(tt(be,vt[Fe],vt),!0)}function tt(be,Fe,vt){var Qt;if(be)if(be.forEach)be.forEach(Fe,vt);else if(be.length!==W)for(Qt=0;Qt<be.length;)Fe.call(vt,be[Qt],Qt,be),Qt++;else for(Qt in be)be.hasOwnProperty(Qt)&&Fe.call(vt,be[Qt],Qt,be)}function Mt(be,Fe,vt){var Qt="DEPRECATED METHOD: "+Fe+"\n"+vt+" AT \n";return function(){var Yr=new Error("get-stack-trace"),$n=Yr&&Yr.stack?Yr.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",xi=w.console&&(w.console.warn||w.console.log);return xi&&xi.call(w.console,Qt,$n),be.apply(this,arguments)}}sr="function"!=typeof Object.assign?function(Fe){if(Fe===W||null===Fe)throw new TypeError("Cannot convert undefined or null to object");for(var vt=Object(Fe),Qt=1;Qt<arguments.length;Qt++){var Yr=arguments[Qt];if(Yr!==W&&null!==Yr)for(var $n in Yr)Yr.hasOwnProperty($n)&&(vt[$n]=Yr[$n])}return vt}:Object.assign;var Ut=Mt(function(Fe,vt,Qt){for(var Yr=Object.keys(vt),$n=0;$n<Yr.length;)(!Qt||Qt&&Fe[Yr[$n]]===W)&&(Fe[Yr[$n]]=vt[Yr[$n]]),$n++;return Fe},"extend","Use `assign`."),At=Mt(function(Fe,vt){return Ut(Fe,vt,!0)},"merge","Use `assign`.");function Et(be,Fe,vt){var Yr,Qt=Fe.prototype;(Yr=be.prototype=Object.create(Qt)).constructor=be,Yr._super=Qt,vt&&sr(Yr,vt)}function vr(be,Fe){return function(){return be.apply(Fe,arguments)}}function ne(be,Fe){return"function"==typeof be?be.apply(Fe&&Fe[0]||W,Fe):be}function nr(be,Fe){return be===W?Fe:be}function Tt(be,Fe,vt){tt(Dt(Fe),function(Qt){be.addEventListener(Qt,vt,!1)})}function $e(be,Fe,vt){tt(Dt(Fe),function(Qt){be.removeEventListener(Qt,vt,!1)})}function Ct(be,Fe){for(;be;){if(be==Fe)return!0;be=be.parentNode}return!1}function qe(be,Fe){return be.indexOf(Fe)>-1}function Dt(be){return be.trim().split(/\s+/g)}function lr(be,Fe,vt){if(be.indexOf&&!vt)return be.indexOf(Fe);for(var Qt=0;Qt<be.length;){if(vt&&be[Qt][vt]==Fe||!vt&&be[Qt]===Fe)return Qt;Qt++}return-1}function hr(be){return Array.prototype.slice.call(be,0)}function Dr(be,Fe,vt){for(var Qt=[],Yr=[],$n=0;$n<be.length;){var xi=Fe?be[$n][Fe]:be[$n];lr(Yr,xi)<0&&Qt.push(be[$n]),Yr[$n]=xi,$n++}return vt&&(Qt=Fe?Qt.sort(function(ro,co){return ro[Fe]>co[Fe]}):Qt.sort()),Qt}function _e(be,Fe){for(var vt,Qt,Yr=Fe[0].toUpperCase()+Fe.slice(1),$n=0;$n<X.length;){if((Qt=(vt=X[$n])?vt+Yr:Fe)in be)return Qt;$n++}return W}var ve=1;function de(be){var Fe=be.ownerDocument||be;return Fe.defaultView||Fe.parentWindow||w}var ze="ontouchstart"in w,pt=_e(w,"PointerEvent")!==W,br=ze&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ur="touch",Pr="mouse",rt=["x","y"],dt=["clientX","clientY"];function Ot(be,Fe){var vt=this;this.manager=be,this.callback=Fe,this.element=be.element,this.target=be.options.inputTarget,this.domHandler=function(Qt){ne(be.options.enable,[be])&&vt.handler(Qt)},this.init()}function Ue(be,Fe,vt){var Qt=vt.pointers.length,Yr=vt.changedPointers.length,$n=1&Fe&&Qt-Yr==0,xi=12&Fe&&Qt-Yr==0;vt.isFirst=!!$n,vt.isFinal=!!xi,$n&&(be.session={}),vt.eventType=Fe,function(be,Fe){var vt=be.session,Qt=Fe.pointers,Yr=Qt.length;vt.firstInput||(vt.firstInput=Cr(Fe)),Yr>1&&!vt.firstMultiple?vt.firstMultiple=Cr(Fe):1===Yr&&(vt.firstMultiple=!1);var $n=vt.firstInput,xi=vt.firstMultiple,lo=xi?xi.center:$n.center,ro=Fe.center=_r(Qt);Fe.timeStamp=et(),Fe.deltaTime=Fe.timeStamp-$n.timeStamp,Fe.angle=pr(lo,ro),Fe.distance=er(lo,ro),function(be,Fe){var vt=Fe.center,Qt=be.offsetDelta||{},Yr=be.prevDelta||{},$n=be.prevInput||{};(1===Fe.eventType||4===$n.eventType)&&(Yr=be.prevDelta={x:$n.deltaX||0,y:$n.deltaY||0},Qt=be.offsetDelta={x:vt.x,y:vt.y}),Fe.deltaX=Yr.x+(vt.x-Qt.x),Fe.deltaY=Yr.y+(vt.y-Qt.y)}(vt,Fe),Fe.offsetDirection=mr(Fe.deltaX,Fe.deltaY);var co=jt(Fe.deltaTime,Fe.deltaX,Fe.deltaY);Fe.overallVelocityX=co.x,Fe.overallVelocityY=co.y,Fe.overallVelocity=Xe(co.x)>Xe(co.y)?co.x:co.y,Fe.scale=xi?function(be,Fe){return er(Fe[0],Fe[1],dt)/er(be[0],be[1],dt)}(xi.pointers,Qt):1,Fe.rotation=xi?function(be,Fe){return pr(Fe[1],Fe[0],dt)+pr(be[1],be[0],dt)}(xi.pointers,Qt):0,Fe.maxPointers=vt.prevInput?Fe.pointers.length>vt.prevInput.maxPointers?Fe.pointers.length:vt.prevInput.maxPointers:Fe.pointers.length,function(be,Fe){var Yr,$n,xi,lo,vt=be.lastInterval||Fe,Qt=Fe.timeStamp-vt.timeStamp;if(8!=Fe.eventType&&(Qt>25||vt.velocity===W)){var ro=Fe.deltaX-vt.deltaX,co=Fe.deltaY-vt.deltaY,ps=jt(Qt,ro,co);$n=ps.x,xi=ps.y,Yr=Xe(ps.x)>Xe(ps.y)?ps.x:ps.y,lo=mr(ro,co),be.lastInterval=Fe}else Yr=vt.velocity,$n=vt.velocityX,xi=vt.velocityY,lo=vt.direction;Fe.velocity=Yr,Fe.velocityX=$n,Fe.velocityY=xi,Fe.direction=lo}(vt,Fe);var ps=be.element;Ct(Fe.srcEvent.target,ps)&&(ps=Fe.srcEvent.target),Fe.target=ps}(be,vt),be.emit("hammer.input",vt),be.recognize(vt),be.session.prevInput=vt}function Cr(be){for(var Fe=[],vt=0;vt<be.pointers.length;)Fe[vt]={clientX:Y(be.pointers[vt].clientX),clientY:Y(be.pointers[vt].clientY)},vt++;return{timeStamp:et(),pointers:Fe,center:_r(Fe),deltaX:be.deltaX,deltaY:be.deltaY}}function _r(be){var Fe=be.length;if(1===Fe)return{x:Y(be[0].clientX),y:Y(be[0].clientY)};for(var vt=0,Qt=0,Yr=0;Yr<Fe;)vt+=be[Yr].clientX,Qt+=be[Yr].clientY,Yr++;return{x:Y(vt/Fe),y:Y(Qt/Fe)}}function jt(be,Fe,vt){return{x:Fe/be||0,y:vt/be||0}}function mr(be,Fe){return be===Fe?1:Xe(be)>=Xe(Fe)?be<0?2:4:Fe<0?8:16}function er(be,Fe,vt){vt||(vt=rt);var Qt=Fe[vt[0]]-be[vt[0]],Yr=Fe[vt[1]]-be[vt[1]];return Math.sqrt(Qt*Qt+Yr*Yr)}function pr(be,Fe,vt){return vt||(vt=rt),180*Math.atan2(Fe[vt[1]]-be[vt[1]],Fe[vt[0]]-be[vt[0]])/Math.PI}Ot.prototype={handler:function(){},init:function(){this.evEl&&Tt(this.element,this.evEl,this.domHandler),this.evTarget&&Tt(this.target,this.evTarget,this.domHandler),this.evWin&&Tt(de(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&$e(this.element,this.evEl,this.domHandler),this.evTarget&&$e(this.target,this.evTarget,this.domHandler),this.evWin&&$e(de(this.element),this.evWin,this.domHandler)}};var mi={mousedown:1,mousemove:2,mouseup:4},hi="mousedown",si="mousemove mouseup";function ai(){this.evEl=hi,this.evWin=si,this.pressed=!1,Ot.apply(this,arguments)}Et(ai,Ot,{handler:function(Fe){var vt=mi[Fe.type];1&vt&&0===Fe.button&&(this.pressed=!0),2&vt&&1!==Fe.which&&(vt=4),this.pressed&&(4&vt&&(this.pressed=!1),this.callback(this.manager,vt,{pointers:[Fe],changedPointers:[Fe],pointerType:Pr,srcEvent:Fe}))}});var Yi={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Pi={2:Ur,3:"pen",4:Pr,5:"kinect"},Ei="pointerdown",Q="pointermove pointerup pointercancel";function he(){this.evEl=Ei,this.evWin=Q,Ot.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}w.MSPointerEvent&&!w.PointerEvent&&(Ei="MSPointerDown",Q="MSPointerMove MSPointerUp MSPointerCancel"),Et(he,Ot,{handler:function(Fe){var vt=this.store,Qt=!1,Yr=Fe.type.toLowerCase().replace("ms",""),$n=Yi[Yr],xi=Pi[Fe.pointerType]||Fe.pointerType,lo=xi==Ur,ro=lr(vt,Fe.pointerId,"pointerId");1&$n&&(0===Fe.button||lo)?ro<0&&(vt.push(Fe),ro=vt.length-1):12&$n&&(Qt=!0),!(ro<0)&&(vt[ro]=Fe,this.callback(this.manager,$n,{pointers:vt,changedPointers:[Fe],pointerType:xi,srcEvent:Fe}),Qt&&vt.splice(ro,1))}});var ge={touchstart:1,touchmove:2,touchend:4,touchcancel:8},F="touchstart",re="touchstart touchmove touchend touchcancel";function ye(){this.evTarget=F,this.evWin=re,this.started=!1,Ot.apply(this,arguments)}function Me(be,Fe){var vt=hr(be.touches),Qt=hr(be.changedTouches);return 12&Fe&&(vt=Dr(vt.concat(Qt),"identifier",!0)),[vt,Qt]}Et(ye,Ot,{handler:function(Fe){var vt=ge[Fe.type];if(1===vt&&(this.started=!0),this.started){var Qt=Me.call(this,Fe,vt);12&vt&&Qt[0].length-Qt[1].length==0&&(this.started=!1),this.callback(this.manager,vt,{pointers:Qt[0],changedPointers:Qt[1],pointerType:Ur,srcEvent:Fe})}}});var ce={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Te="touchstart touchmove touchend touchcancel";function mt(){this.evTarget=Te,this.targetIds={},Ot.apply(this,arguments)}function wr(be,Fe){var vt=hr(be.touches),Qt=this.targetIds;if(3&Fe&&1===vt.length)return Qt[vt[0].identifier]=!0,[vt,vt];var Yr,$n,xi=hr(be.changedTouches),lo=[],ro=this.target;if($n=vt.filter(function(co){return Ct(co.target,ro)}),1===Fe)for(Yr=0;Yr<$n.length;)Qt[$n[Yr].identifier]=!0,Yr++;for(Yr=0;Yr<xi.length;)Qt[xi[Yr].identifier]&&lo.push(xi[Yr]),12&Fe&&delete Qt[xi[Yr].identifier],Yr++;return lo.length?[Dr($n.concat(lo),"identifier",!0),lo]:void 0}function Br(){Ot.apply(this,arguments);var be=vr(this.handler,this);this.touch=new mt(this.manager,be),this.mouse=new ai(this.manager,be),this.primaryTouch=null,this.lastTouches=[]}function On(be,Fe){1&be?(this.primaryTouch=Fe.changedPointers[0].identifier,Cn.call(this,Fe)):12&be&&Cn.call(this,Fe)}function Cn(be){var Fe=be.changedPointers[0];if(Fe.identifier===this.primaryTouch){var vt={x:Fe.clientX,y:Fe.clientY};this.lastTouches.push(vt);var Qt=this.lastTouches;setTimeout(function(){var $n=Qt.indexOf(vt);$n>-1&&Qt.splice($n,1)},2500)}}function qt(be){for(var Fe=be.srcEvent.clientX,vt=be.srcEvent.clientY,Qt=0;Qt<this.lastTouches.length;Qt++){var Yr=this.lastTouches[Qt],$n=Math.abs(Fe-Yr.x),xi=Math.abs(vt-Yr.y);if($n<=25&&xi<=25)return!0}return!1}Et(mt,Ot,{handler:function(Fe){var vt=ce[Fe.type],Qt=wr.call(this,Fe,vt);!Qt||this.callback(this.manager,vt,{pointers:Qt[0],changedPointers:Qt[1],pointerType:Ur,srcEvent:Fe})}}),Et(Br,Ot,{handler:function(Fe,vt,Qt){var $n=Qt.pointerType==Pr;if(!($n&&Qt.sourceCapabilities&&Qt.sourceCapabilities.firesTouchEvents)){if(Qt.pointerType==Ur)On.call(this,vt,Qt);else if($n&&qt.call(this,Qt))return;this.callback(Fe,vt,Qt)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var xn=_e(q.style,"touchAction"),nn=xn!==W,ln="compute",gn="manipulation",Oi="none",ta="pan-x",oi="pan-y",Ji=function(){if(!nn)return!1;var be={},Fe=w.CSS&&w.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(vt){be[vt]=!Fe||w.CSS.supports("touch-action",vt)}),be}();function ji(be,Fe){this.manager=be,this.set(Fe)}function Wi(be){this.options=sr({},this.defaults,be||{}),this.id=ve++,this.manager=null,this.options.enable=nr(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function va(be){return 16&be?"cancel":8&be?"end":4&be?"move":2&be?"start":""}function Su(be){return 16==be?"down":8==be?"up":2==be?"left":4==be?"right":""}function Da(be,Fe){var vt=Fe.manager;return vt?vt.get(be):be}function qo(){Wi.apply(this,arguments)}function Fi(){qo.apply(this,arguments),this.pX=null,this.pY=null}function ra(){qo.apply(this,arguments)}function bo(){Wi.apply(this,arguments),this._timer=null,this._input=null}function ma(){qo.apply(this,arguments)}function vo(){qo.apply(this,arguments)}function No(){Wi.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ks(be,Fe){return(Fe=Fe||{}).recognizers=nr(Fe.recognizers,ks.defaults.preset),new Ia(be,Fe)}function Ia(be,Fe){this.options=sr({},ks.defaults,Fe||{}),this.options.inputTarget=this.options.inputTarget||be,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=be,this.input=function(be){return new(be.options.inputClass||(pt?he:br?mt:ze?Br:ai))(be,Ue)}(this),this.touchAction=new ji(this,this.options.touchAction),Ya(this,!0),tt(this.options.recognizers,function(vt){var Qt=this.add(new vt[0](vt[1]));vt[2]&&Qt.recognizeWith(vt[2]),vt[3]&&Qt.requireFailure(vt[3])},this)}function Ya(be,Fe){var Qt,vt=be.element;vt.style&&(tt(be.options.cssProps,function(Yr,$n){Qt=_e(vt.style,$n),Fe?(be.oldCssProps[Qt]=vt.style[Qt],vt.style[Qt]=Yr):vt.style[Qt]=be.oldCssProps[Qt]||""}),Fe||(be.oldCssProps={}))}ji.prototype={set:function(be){be==ln&&(be=this.compute()),nn&&this.manager.element.style&&Ji[be]&&(this.manager.element.style[xn]=be),this.actions=be.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var be=[];return tt(this.manager.recognizers,function(Fe){ne(Fe.options.enable,[Fe])&&(be=be.concat(Fe.getTouchAction()))}),function(be){if(qe(be,Oi))return Oi;var Fe=qe(be,ta),vt=qe(be,oi);return Fe&&vt?Oi:Fe||vt?Fe?ta:oi:qe(be,gn)?gn:"auto"}(be.join(" "))},preventDefaults:function(be){var Fe=be.srcEvent,vt=be.offsetDirection;if(!this.manager.session.prevented){var Qt=this.actions,Yr=qe(Qt,Oi)&&!Ji[Oi],$n=qe(Qt,oi)&&!Ji[oi],xi=qe(Qt,ta)&&!Ji[ta];if(Yr&&1===be.pointers.length&&be.distance<2&&be.deltaTime<250)return;return xi&&$n||!(Yr||$n&&6&vt||xi&&24&vt)?void 0:this.preventSrc(Fe)}Fe.preventDefault()},preventSrc:function(be){this.manager.session.prevented=!0,be.preventDefault()}},Wi.prototype={defaults:{},set:function(be){return sr(this.options,be),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(be){if(Z(be,"recognizeWith",this))return this;var Fe=this.simultaneous;return Fe[(be=Da(be,this)).id]||(Fe[be.id]=be,be.recognizeWith(this)),this},dropRecognizeWith:function(be){return Z(be,"dropRecognizeWith",this)||(be=Da(be,this),delete this.simultaneous[be.id]),this},requireFailure:function(be){if(Z(be,"requireFailure",this))return this;var Fe=this.requireFail;return-1===lr(Fe,be=Da(be,this))&&(Fe.push(be),be.requireFailure(this)),this},dropRequireFailure:function(be){if(Z(be,"dropRequireFailure",this))return this;be=Da(be,this);var Fe=lr(this.requireFail,be);return Fe>-1&&this.requireFail.splice(Fe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(be){return!!this.simultaneous[be.id]},emit:function(be){var Fe=this,vt=this.state;function Qt(Yr){Fe.manager.emit(Yr,be)}vt<8&&Qt(Fe.options.event+va(vt)),Qt(Fe.options.event),be.additionalEvent&&Qt(be.additionalEvent),vt>=8&&Qt(Fe.options.event+va(vt))},tryEmit:function(be){if(this.canEmit())return this.emit(be);this.state=32},canEmit:function(){for(var be=0;be<this.requireFail.length;){if(!(33&this.requireFail[be].state))return!1;be++}return!0},recognize:function(be){var Fe=sr({},be);if(!ne(this.options.enable,[this,Fe]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Fe),30&this.state&&this.tryEmit(Fe)},process:function(be){},getTouchAction:function(){},reset:function(){}},Et(qo,Wi,{defaults:{pointers:1},attrTest:function(be){var Fe=this.options.pointers;return 0===Fe||be.pointers.length===Fe},process:function(be){var Fe=this.state,vt=be.eventType,Qt=6&Fe,Yr=this.attrTest(be);return Qt&&(8&vt||!Yr)?16|Fe:Qt||Yr?4&vt?8|Fe:2&Fe?4|Fe:2:32}}),Et(Fi,qo,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var be=this.options.direction,Fe=[];return 6&be&&Fe.push(oi),24&be&&Fe.push(ta),Fe},directionTest:function(be){var Fe=this.options,vt=!0,Qt=be.distance,Yr=be.direction,$n=be.deltaX,xi=be.deltaY;return Yr&Fe.direction||(6&Fe.direction?(Yr=0===$n?1:$n<0?2:4,vt=$n!=this.pX,Qt=Math.abs(be.deltaX)):(Yr=0===xi?1:xi<0?8:16,vt=xi!=this.pY,Qt=Math.abs(be.deltaY))),be.direction=Yr,vt&&Qt>Fe.threshold&&Yr&Fe.direction},attrTest:function(be){return qo.prototype.attrTest.call(this,be)&&(2&this.state||!(2&this.state)&&this.directionTest(be))},emit:function(be){this.pX=be.deltaX,this.pY=be.deltaY;var Fe=Su(be.direction);Fe&&(be.additionalEvent=this.options.event+Fe),this._super.emit.call(this,be)}}),Et(ra,qo,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Oi]},attrTest:function(be){return this._super.attrTest.call(this,be)&&(Math.abs(be.scale-1)>this.options.threshold||2&this.state)},emit:function(be){1!==be.scale&&(be.additionalEvent=this.options.event+(be.scale<1?"in":"out")),this._super.emit.call(this,be)}}),Et(bo,Wi,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(be){var Fe=this.options,vt=be.pointers.length===Fe.pointers,Qt=be.distance<Fe.threshold,Yr=be.deltaTime>Fe.time;if(this._input=be,!Qt||!vt||12&be.eventType&&!Yr)this.reset();else if(1&be.eventType)this.reset(),this._timer=z(function(){this.state=8,this.tryEmit()},Fe.time,this);else if(4&be.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(be){8===this.state&&(be&&4&be.eventType?this.manager.emit(this.options.event+"up",be):(this._input.timeStamp=et(),this.manager.emit(this.options.event,this._input)))}}),Et(ma,qo,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Oi]},attrTest:function(be){return this._super.attrTest.call(this,be)&&(Math.abs(be.rotation)>this.options.threshold||2&this.state)}}),Et(vo,qo,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Fi.prototype.getTouchAction.call(this)},attrTest:function(be){var vt,Fe=this.options.direction;return 30&Fe?vt=be.overallVelocity:6&Fe?vt=be.overallVelocityX:24&Fe&&(vt=be.overallVelocityY),this._super.attrTest.call(this,be)&&Fe&be.offsetDirection&&be.distance>this.options.threshold&&be.maxPointers==this.options.pointers&&Xe(vt)>this.options.velocity&&4&be.eventType},emit:function(be){var Fe=Su(be.offsetDirection);Fe&&this.manager.emit(this.options.event+Fe,be),this.manager.emit(this.options.event,be)}}),Et(No,Wi,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[gn]},process:function(be){var Fe=this.options,vt=be.pointers.length===Fe.pointers,Qt=be.distance<Fe.threshold,Yr=be.deltaTime<Fe.time;if(this.reset(),1&be.eventType&&0===this.count)return this.failTimeout();if(Qt&&Yr&&vt){if(4!=be.eventType)return this.failTimeout();var $n=!this.pTime||be.timeStamp-this.pTime<Fe.interval,xi=!this.pCenter||er(this.pCenter,be.center)<Fe.posThreshold;if(this.pTime=be.timeStamp,this.pCenter=be.center,xi&&$n?this.count+=1:this.count=1,this._input=be,0==this.count%Fe.taps)return this.hasRequireFailures()?(this._timer=z(function(){this.state=8,this.tryEmit()},Fe.interval,this),2):8}return 32},failTimeout:function(){return this._timer=z(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ks.VERSION="2.0.7",ks.defaults={domEvents:!1,touchAction:ln,enable:!0,inputTarget:null,inputClass:null,preset:[[ma,{enable:!1}],[ra,{enable:!1},["rotate"]],[vo,{direction:6}],[Fi,{direction:6},["swipe"]],[No],[No,{event:"doubletap",taps:2},["tap"]],[bo]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ia.prototype={set:function(be){return sr(this.options,be),be.touchAction&&this.touchAction.update(),be.inputTarget&&(this.input.destroy(),this.input.target=be.inputTarget,this.input.init()),this},stop:function(be){this.session.stopped=be?2:1},recognize:function(be){var Fe=this.session;if(!Fe.stopped){this.touchAction.preventDefaults(be);var vt,Qt=this.recognizers,Yr=Fe.curRecognizer;(!Yr||Yr&&8&Yr.state)&&(Yr=Fe.curRecognizer=null);for(var $n=0;$n<Qt.length;)vt=Qt[$n],2===Fe.stopped||Yr&&vt!=Yr&&!vt.canRecognizeWith(Yr)?vt.reset():vt.recognize(be),!Yr&&14&vt.state&&(Yr=Fe.curRecognizer=vt),$n++}},get:function(be){if(be instanceof Wi)return be;for(var Fe=this.recognizers,vt=0;vt<Fe.length;vt++)if(Fe[vt].options.event==be)return Fe[vt];return null},add:function(be){if(Z(be,"add",this))return this;var Fe=this.get(be.options.event);return Fe&&this.remove(Fe),this.recognizers.push(be),be.manager=this,this.touchAction.update(),be},remove:function(be){if(Z(be,"remove",this))return this;if(be=this.get(be)){var Fe=this.recognizers,vt=lr(Fe,be);-1!==vt&&(Fe.splice(vt,1),this.touchAction.update())}return this},on:function(be,Fe){if(be!==W&&Fe!==W){var vt=this.handlers;return tt(Dt(be),function(Qt){vt[Qt]=vt[Qt]||[],vt[Qt].push(Fe)}),this}},off:function(be,Fe){if(be!==W){var vt=this.handlers;return tt(Dt(be),function(Qt){Fe?vt[Qt]&&vt[Qt].splice(lr(vt[Qt],Fe),1):delete vt[Qt]}),this}},emit:function(be,Fe){this.options.domEvents&&function(be,Fe){var vt=p.createEvent("Event");vt.initEvent(be,!0,!0),vt.gesture=Fe,Fe.target.dispatchEvent(vt)}(be,Fe);var vt=this.handlers[be]&&this.handlers[be].slice();if(vt&&vt.length){Fe.type=be,Fe.preventDefault=function(){Fe.srcEvent.preventDefault()};for(var Qt=0;Qt<vt.length;)vt[Qt](Fe),Qt++}},destroy:function(){this.element&&Ya(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},sr(ks,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ia,Input:Ot,TouchAction:ji,TouchInput:mt,MouseInput:ai,PointerEventInput:he,TouchMouseInput:Br,SingleTouchInput:ye,Recognizer:Wi,AttrRecognizer:qo,Tap:No,Pan:Fi,Swipe:vo,Pinch:ra,Rotate:ma,Press:bo,on:Tt,off:$e,each:tt,merge:At,extend:Ut,assign:sr,inherit:Et,bindFn:vr,prefixed:_e}),(void 0!==w?w:"undefined"!=typeof self?self:{}).Hammer=ks,(ue=function(){return ks}.call(H,M,H,dr))!==W&&(dr.exports=ue)}(window,document)},82469:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0});var M=Symbol.for("INJECTION");function ue(X,q,te,Y){Object.defineProperty(X,q,{configurable:!0,enumerable:!0,get:function(){return Y&&!Reflect.hasMetadata(M,this,q)&&Reflect.defineMetadata(M,te(),this,q),Reflect.hasMetadata(M,this,q)?Reflect.getMetadata(M,this,q):te()},set:function(z){Reflect.defineMetadata(M,z,this,q)}})}H.makePropertyInjectDecorator=function(X,q){return function(te){return function(Y,Xe){ue(Y,Xe,function(){return X.get(te)},q)}}},H.makePropertyInjectNamedDecorator=function(X,q){return function(te,Y){return function(Xe,et){ue(Xe,et,function(){return X.getNamed(te,Y)},q)}}},H.makePropertyInjectTaggedDecorator=function(X,q){return function(te,Y,Xe){return function(et,z){ue(et,z,function(){return X.getTagged(te,Y,Xe)},q)}}},H.makePropertyMultiInjectDecorator=function(X,q){return function(te){return function(Y,Xe){ue(Y,Xe,function(){return X.getAll(te)},q)}}}},43857:(dr,H,M)=>{"use strict";var w=M(82469);H.Z=function(_,W){return void 0===W&&(W=!0),{lazyInject:w.makePropertyInjectDecorator(_,W),lazyInjectNamed:w.makePropertyInjectNamedDecorator(_,W),lazyInjectTagged:w.makePropertyInjectTaggedDecorator(_,W),lazyMultiInject:w.makePropertyMultiInjectDecorator(_,W)}}},84848:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.tagProperty=H.tagParameter=H.decorate=void 0;var ue=M(90640),w=M(7259);function W(Y,Xe,et,z,Z){var tt={},Mt="number"==typeof Z,sr=void 0!==Z&&Mt?Z.toString():et;if(Mt&&void 0!==et)throw new Error(ue.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(Y,Xe)&&(tt=Reflect.getMetadata(Y,Xe));var Ut=tt[sr];if(Array.isArray(Ut))for(var At=0,Et=Ut;At<Et.length;At++){var vr=Et[At];if(vr.key===z.key)throw new Error(ue.DUPLICATED_METADATA+" "+vr.key.toString())}else Ut=[];Ut.push(z),tt[sr]=Ut,Reflect.defineMetadata(Y,tt,Xe)}function X(Y,Xe){Reflect.decorate(Y,Xe)}function q(Y,Xe){return function(et,z){Xe(et,z,Y)}}H.tagParameter=function(Y,Xe,et,z){W(w.TAGGED,Y,Xe,z,et)},H.tagProperty=function(Y,Xe,et){W(w.TAGGED_PROP,Y.constructor,Xe,et)},H.decorate=function(Y,Xe,et){"number"==typeof et?X([q(et,Y)],Xe):"string"==typeof et?Reflect.decorate([Y],Xe,et):X([Y],Xe)}},53615:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.inject=H.LazyServiceIdentifer=void 0;var ue=M(90640),w=M(7259),p=M(95839),_=M(84848),W=function(){function q(te){this._cb=te}return q.prototype.unwrap=function(){return this._cb()},q}();H.LazyServiceIdentifer=W,H.inject=function(q){return function(te,Y,Xe){if(void 0===q)throw new Error(ue.UNDEFINED_INJECT_ANNOTATION(te.name));var et=new p.Metadata(w.INJECT_TAG,q);"number"==typeof Xe?_.tagParameter(te,Y,Xe,et):_.tagProperty(te,Y,et)}}},57549:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.injectable=void 0;var ue=M(90640),w=M(7259);H.injectable=function(){return function(_){if(Reflect.hasOwnMetadata(w.PARAM_TYPES,_))throw new Error(ue.DUPLICATED_INJECTABLE_DECORATOR);var W=Reflect.getMetadata(w.DESIGN_PARAM_TYPES,_)||[];return Reflect.defineMetadata(w.PARAM_TYPES,W,_),_}}},42048:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.multiInject=void 0;var ue=M(7259),w=M(95839),p=M(84848);H.multiInject=function(W){return function(X,q,te){var Y=new w.Metadata(ue.MULTI_INJECT_TAG,W);"number"==typeof te?p.tagParameter(X,q,te,Y):p.tagProperty(X,q,Y)}}},35546:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.named=void 0;var ue=M(7259),w=M(95839),p=M(84848);H.named=function(W){return function(X,q,te){var Y=new w.Metadata(ue.NAMED_TAG,W);"number"==typeof te?p.tagParameter(X,q,te,Y):p.tagProperty(X,q,Y)}}},78098:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.optional=void 0;var ue=M(7259),w=M(95839),p=M(84848);H.optional=function(){return function(W,X,q){var te=new w.Metadata(ue.OPTIONAL_TAG,!0);"number"==typeof q?p.tagParameter(W,X,q,te):p.tagProperty(W,X,te)}}},18955:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.postConstruct=void 0;var ue=M(90640),w=M(7259),p=M(95839);H.postConstruct=function(){return function(W,X,q){var te=new p.Metadata(w.POST_CONSTRUCT,X);if(Reflect.hasOwnMetadata(w.POST_CONSTRUCT,W.constructor))throw new Error(ue.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(w.POST_CONSTRUCT,te,W.constructor)}}},43881:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.tagged=void 0;var ue=M(95839),w=M(84848);H.tagged=function(_,W){return function(X,q,te){var Y=new ue.Metadata(_,W);"number"==typeof te?w.tagParameter(X,q,te,Y):w.tagProperty(X,q,Y)}}},91698:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.targetName=void 0;var ue=M(7259),w=M(95839),p=M(84848);H.targetName=function(W){return function(X,q,te){var Y=new w.Metadata(ue.NAME_TAG,W);p.tagParameter(X,q,te,Y)}}},14978:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.unmanaged=void 0;var ue=M(7259),w=M(95839),p=M(84848);H.unmanaged=function(){return function(W,X,q){var te=new w.Metadata(ue.UNMANAGED_TAG,!0);p.tagParameter(W,X,q,te)}}},31885:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.Binding=void 0;var ue=M(21785),w=M(16800),p=function(){function _(W,X){this.id=w.id(),this.activated=!1,this.serviceIdentifier=W,this.scope=X,this.type=ue.BindingTypeEnum.Invalid,this.constraint=function(q){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return _.prototype.clone=function(){var W=new _(this.serviceIdentifier,this.scope);return W.activated=W.scope===ue.BindingScopeEnum.Singleton&&this.activated,W.implementationType=this.implementationType,W.dynamicValue=this.dynamicValue,W.scope=this.scope,W.type=this.type,W.factory=this.factory,W.provider=this.provider,W.constraint=this.constraint,W.onActivation=this.onActivation,W.cache=this.cache,W},_}();H.Binding=p},54046:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.BindingCount=void 0,H.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},90640:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.STACK_OVERFLOW=H.CIRCULAR_DEPENDENCY_IN_FACTORY=H.POST_CONSTRUCT_ERROR=H.MULTIPLE_POST_CONSTRUCT_METHODS=H.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=H.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=H.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=H.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=H.ARGUMENTS_LENGTH_MISMATCH=H.INVALID_DECORATOR_OPERATION=H.INVALID_TO_SELF_VALUE=H.INVALID_FUNCTION_BINDING=H.INVALID_MIDDLEWARE_RETURN=H.NO_MORE_SNAPSHOTS_AVAILABLE=H.INVALID_BINDING_TYPE=H.NOT_IMPLEMENTED=H.CIRCULAR_DEPENDENCY=H.UNDEFINED_INJECT_ANNOTATION=H.MISSING_INJECT_ANNOTATION=H.MISSING_INJECTABLE_ANNOTATION=H.NOT_REGISTERED=H.CANNOT_UNBIND=H.AMBIGUOUS_MATCH=H.KEY_NOT_FOUND=H.NULL_ARGUMENT=H.DUPLICATED_METADATA=H.DUPLICATED_INJECTABLE_DECORATOR=void 0,H.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",H.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",H.NULL_ARGUMENT="NULL argument",H.KEY_NOT_FOUND="Key Not Found",H.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",H.CANNOT_UNBIND="Could not unbind serviceIdentifier:",H.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",H.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",H.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",H.UNDEFINED_INJECT_ANNOTATION=function(_){return"@inject called with undefined this could mean that the class "+_+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},H.CIRCULAR_DEPENDENCY="Circular dependency found:",H.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",H.INVALID_BINDING_TYPE="Invalid binding type:",H.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",H.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",H.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",H.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",H.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",H.ARGUMENTS_LENGTH_MISMATCH=function(){for(var _=[],W=0;W<arguments.length;W++)_[W]=arguments[W];return"The number of constructor arguments in the derived class "+_[0]+" must be >= than the number of constructor arguments of its base class."},H.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",H.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",H.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",H.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",H.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",H.POST_CONSTRUCT_ERROR=function(){for(var _=[],W=0;W<arguments.length;W++)_[W]=arguments[W];return"@postConstruct error in class "+_[0]+": "+_[1]},H.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var _=[],W=0;W<arguments.length;W++)_[W]=arguments[W];return"It looks like there is a circular dependency in one of the '"+_[0]+"' bindings. Please investigate bindings withservice identifier '"+_[1]+"'."},H.STACK_OVERFLOW="Maximum call stack size exceeded"},21785:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.TargetTypeEnum=H.BindingTypeEnum=H.BindingScopeEnum=void 0,H.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"},H.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},H.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},7259:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.NON_CUSTOM_TAG_KEYS=H.POST_CONSTRUCT=H.DESIGN_PARAM_TYPES=H.PARAM_TYPES=H.TAGGED_PROP=H.TAGGED=H.MULTI_INJECT_TAG=H.INJECT_TAG=H.OPTIONAL_TAG=H.UNMANAGED_TAG=H.NAME_TAG=H.NAMED_TAG=void 0,H.NAMED_TAG="named",H.NAME_TAG="name",H.UNMANAGED_TAG="unmanaged",H.OPTIONAL_TAG="optional",H.INJECT_TAG="inject",H.MULTI_INJECT_TAG="multi_inject",H.TAGGED="inversify:tagged",H.TAGGED_PROP="inversify:tagged_props",H.PARAM_TYPES="inversify:paramtypes",H.DESIGN_PARAM_TYPES="design:paramtypes",H.POST_CONSTRUCT="post_construct",H.NON_CUSTOM_TAG_KEYS=[H.INJECT_TAG,H.MULTI_INJECT_TAG,H.NAME_TAG,H.UNMANAGED_TAG,H.NAMED_TAG,H.OPTIONAL_TAG]},93414:function(dr,H,M){"use strict";var ue=this&&this.__awaiter||function(Ut,At,Et,vr){return new(Et||(Et=Promise))(function(nr,Tt){function $e(Dt){try{qe(vr.next(Dt))}catch(lr){Tt(lr)}}function Ct(Dt){try{qe(vr.throw(Dt))}catch(lr){Tt(lr)}}function qe(Dt){Dt.done?nr(Dt.value):function(nr){return nr instanceof Et?nr:new Et(function(Tt){Tt(nr)})}(Dt.value).then($e,Ct)}qe((vr=vr.apply(Ut,At||[])).next())})},w=this&&this.__generator||function(Ut,At){var vr,ne,nr,Tt,Et={label:0,sent:function(){if(1&nr[0])throw nr[1];return nr[1]},trys:[],ops:[]};return Tt={next:$e(0),throw:$e(1),return:$e(2)},"function"==typeof Symbol&&(Tt[Symbol.iterator]=function(){return this}),Tt;function $e(qe){return function(Dt){return function(qe){if(vr)throw new TypeError("Generator is already executing.");for(;Et;)try{if(vr=1,ne&&(nr=2&qe[0]?ne.return:qe[0]?ne.throw||((nr=ne.return)&&nr.call(ne),0):ne.next)&&!(nr=nr.call(ne,qe[1])).done)return nr;switch(ne=0,nr&&(qe=[2&qe[0],nr.value]),qe[0]){case 0:case 1:nr=qe;break;case 4:return Et.label++,{value:qe[1],done:!1};case 5:Et.label++,ne=qe[1],qe=[0];continue;case 7:qe=Et.ops.pop(),Et.trys.pop();continue;default:if(!(nr=(nr=Et.trys).length>0&&nr[nr.length-1])&&(6===qe[0]||2===qe[0])){Et=0;continue}if(3===qe[0]&&(!nr||qe[1]>nr[0]&&qe[1]<nr[3])){Et.label=qe[1];break}if(6===qe[0]&&Et.label<nr[1]){Et.label=nr[1],nr=qe;break}if(nr&&Et.label<nr[2]){Et.label=nr[2],Et.ops.push(qe);break}nr[2]&&Et.ops.pop(),Et.trys.pop();continue}qe=At.call(Ut,Et)}catch(Dt){qe=[6,Dt],ne=0}finally{vr=nr=0}if(5&qe[0])throw qe[1];return{value:qe[0]?qe[1]:void 0,done:!0}}([qe,Dt])}}},p=this&&this.__spreadArray||function(Ut,At){for(var Et=0,vr=At.length,ne=Ut.length;Et<vr;Et++,ne++)Ut[ne]=At[Et];return Ut};Object.defineProperty(H,"__esModule",{value:!0}),H.Container=void 0;var _=M(31885),W=M(90640),X=M(21785),q=M(7259),te=M(28236),Y=M(71256),Xe=M(2739),et=M(38809),z=M(16800),Z=M(48736),tt=M(8974),Mt=M(22377),sr=function(){function Ut(At){this._appliedMiddleware=[];var Et=At||{};if("object"!=typeof Et)throw new Error(""+W.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===Et.defaultScope)Et.defaultScope=X.BindingScopeEnum.Transient;else if(Et.defaultScope!==X.BindingScopeEnum.Singleton&&Et.defaultScope!==X.BindingScopeEnum.Transient&&Et.defaultScope!==X.BindingScopeEnum.Request)throw new Error(""+W.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===Et.autoBindInjectable)Et.autoBindInjectable=!1;else if("boolean"!=typeof Et.autoBindInjectable)throw new Error(""+W.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===Et.skipBaseClassChecks)Et.skipBaseClassChecks=!1;else if("boolean"!=typeof Et.skipBaseClassChecks)throw new Error(""+W.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:Et.autoBindInjectable,defaultScope:Et.defaultScope,skipBaseClassChecks:Et.skipBaseClassChecks},this.id=z.id(),this._bindingDictionary=new Mt.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new te.MetadataReader}return Ut.merge=function(At,Et){for(var vr=[],ne=2;ne<arguments.length;ne++)vr[ne-2]=arguments[ne];var nr=new Ut,Tt=p([At,Et],vr).map(function(qe){return Y.getBindingDictionary(qe)}),$e=Y.getBindingDictionary(nr);function Ct(qe,Dt){qe.traverse(function(lr,hr){hr.forEach(function(Dr){Dt.add(Dr.serviceIdentifier,Dr.clone())})})}return Tt.forEach(function(qe){Ct(qe,$e)}),nr},Ut.prototype.load=function(){for(var At=[],Et=0;Et<arguments.length;Et++)At[Et]=arguments[Et];for(var vr=this._getContainerModuleHelpersFactory(),ne=0,nr=At;ne<nr.length;ne++){var Tt=nr[ne],$e=vr(Tt.id);Tt.registry($e.bindFunction,$e.unbindFunction,$e.isboundFunction,$e.rebindFunction)}},Ut.prototype.loadAsync=function(){for(var At=[],Et=0;Et<arguments.length;Et++)At[Et]=arguments[Et];return ue(this,void 0,void 0,function(){var vr,ne,nr,Tt,$e;return w(this,function(Ct){switch(Ct.label){case 0:vr=this._getContainerModuleHelpersFactory(),ne=0,nr=At,Ct.label=1;case 1:return ne<nr.length?($e=vr((Tt=nr[ne]).id),[4,Tt.registry($e.bindFunction,$e.unbindFunction,$e.isboundFunction,$e.rebindFunction)]):[3,4];case 2:Ct.sent(),Ct.label=3;case 3:return ne++,[3,1];case 4:return[2]}})})},Ut.prototype.unload=function(){for(var At=this,Et=[],vr=0;vr<arguments.length;vr++)Et[vr]=arguments[vr];var ne=function(nr){return function(Tt){return Tt.moduleId===nr}};Et.forEach(function(nr){var Tt=ne(nr.id);At._bindingDictionary.removeByCondition(Tt)})},Ut.prototype.bind=function(At){var vr=new _.Binding(At,this.options.defaultScope||X.BindingScopeEnum.Transient);return this._bindingDictionary.add(At,vr),new et.BindingToSyntax(vr)},Ut.prototype.rebind=function(At){return this.unbind(At),this.bind(At)},Ut.prototype.unbind=function(At){try{this._bindingDictionary.remove(At)}catch(Et){throw new Error(W.CANNOT_UNBIND+" "+Z.getServiceIdentifierAsString(At))}},Ut.prototype.unbindAll=function(){this._bindingDictionary=new Mt.Lookup},Ut.prototype.isBound=function(At){var Et=this._bindingDictionary.hasKey(At);return!Et&&this.parent&&(Et=this.parent.isBound(At)),Et},Ut.prototype.isBoundNamed=function(At,Et){return this.isBoundTagged(At,q.NAMED_TAG,Et)},Ut.prototype.isBoundTagged=function(At,Et,vr){var ne=!1;if(this._bindingDictionary.hasKey(At)){var nr=this._bindingDictionary.get(At),Tt=Y.createMockRequest(this,At,Et,vr);ne=nr.some(function($e){return $e.constraint(Tt)})}return!ne&&this.parent&&(ne=this.parent.isBoundTagged(At,Et,vr)),ne},Ut.prototype.snapshot=function(){this._snapshots.push(tt.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},Ut.prototype.restore=function(){var At=this._snapshots.pop();if(void 0===At)throw new Error(W.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=At.bindings,this._middleware=At.middleware},Ut.prototype.createChild=function(At){var Et=new Ut(At||this.options);return Et.parent=this,Et},Ut.prototype.applyMiddleware=function(){for(var At=[],Et=0;Et<arguments.length;Et++)At[Et]=arguments[Et];this._appliedMiddleware=this._appliedMiddleware.concat(At);var vr=this._middleware?this._middleware:this._planAndResolve();this._middleware=At.reduce(function(ne,nr){return nr(ne)},vr)},Ut.prototype.applyCustomMetadataReader=function(At){this._metadataReader=At},Ut.prototype.get=function(At){return this._get(!1,!1,X.TargetTypeEnum.Variable,At)},Ut.prototype.getTagged=function(At,Et,vr){return this._get(!1,!1,X.TargetTypeEnum.Variable,At,Et,vr)},Ut.prototype.getNamed=function(At,Et){return this.getTagged(At,q.NAMED_TAG,Et)},Ut.prototype.getAll=function(At){return this._get(!0,!0,X.TargetTypeEnum.Variable,At)},Ut.prototype.getAllTagged=function(At,Et,vr){return this._get(!1,!0,X.TargetTypeEnum.Variable,At,Et,vr)},Ut.prototype.getAllNamed=function(At,Et){return this.getAllTagged(At,q.NAMED_TAG,Et)},Ut.prototype.resolve=function(At){var Et=this.createChild();return Et.bind(At).toSelf(),this._appliedMiddleware.forEach(function(vr){Et.applyMiddleware(vr)}),Et.get(At)},Ut.prototype._getContainerModuleHelpersFactory=function(){var At=this,Et=function($e,Ct){$e._binding.moduleId=Ct},vr=function($e){return function(Ct){var Dt=At.bind.bind(At)(Ct);return Et(Dt,$e),Dt}},Tt=function($e){return function(Ct){var Dt=At.rebind.bind(At)(Ct);return Et(Dt,$e),Dt}};return function($e){return{bindFunction:vr($e),isboundFunction:function(Ct){return At.isBound.bind(At)(Ct)},rebindFunction:Tt($e),unbindFunction:function(Ct){At.unbind.bind(At)(Ct)}}}},Ut.prototype._get=function(At,Et,vr,ne,nr,Tt){var $e=null,Ct={avoidConstraints:At,contextInterceptor:function(qe){return qe},isMultiInject:Et,key:nr,serviceIdentifier:ne,targetType:vr,value:Tt};if(this._middleware){if(null==($e=this._middleware(Ct)))throw new Error(W.INVALID_MIDDLEWARE_RETURN)}else $e=this._planAndResolve()(Ct);return $e},Ut.prototype._planAndResolve=function(){var At=this;return function(Et){var vr=Y.plan(At._metadataReader,At,Et.isMultiInject,Et.targetType,Et.serviceIdentifier,Et.key,Et.value,Et.avoidConstraints);return vr=Et.contextInterceptor(vr),Xe.resolve(vr)}},Ut}();H.Container=sr},6070:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.AsyncContainerModule=H.ContainerModule=void 0;var ue=M(16800);H.ContainerModule=function(W){this.id=ue.id(),this.registry=W},H.AsyncContainerModule=function(W){this.id=ue.id(),this.registry=W}},8974:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.ContainerSnapshot=void 0;var M=function(){function ue(){}return ue.of=function(w,p){var _=new ue;return _.bindings=w,_.middleware=p,_},ue}();H.ContainerSnapshot=M},22377:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.Lookup=void 0;var ue=M(90640),w=function(){function p(){this._map=new Map}return p.prototype.getMap=function(){return this._map},p.prototype.add=function(_,W){if(null==_)throw new Error(ue.NULL_ARGUMENT);if(null==W)throw new Error(ue.NULL_ARGUMENT);var X=this._map.get(_);void 0!==X?(X.push(W),this._map.set(_,X)):this._map.set(_,[W])},p.prototype.get=function(_){if(null==_)throw new Error(ue.NULL_ARGUMENT);var W=this._map.get(_);if(void 0!==W)return W;throw new Error(ue.KEY_NOT_FOUND)},p.prototype.remove=function(_){if(null==_)throw new Error(ue.NULL_ARGUMENT);if(!this._map.delete(_))throw new Error(ue.KEY_NOT_FOUND)},p.prototype.removeByCondition=function(_){var W=this;this._map.forEach(function(X,q){var te=X.filter(function(Y){return!_(Y)});te.length>0?W._map.set(q,te):W._map.delete(q)})},p.prototype.hasKey=function(_){if(null==_)throw new Error(ue.NULL_ARGUMENT);return this._map.has(_)},p.prototype.clone=function(){var _=new p;return this._map.forEach(function(W,X){W.forEach(function(q){return _.add(X,q.clone())})}),_},p.prototype.traverse=function(_){this._map.forEach(function(W,X){_(X,W)})},p}();H.Lookup=w},15922:(dr,H,M)=>{"use strict";H.GW=H.zY=H.f3=H.b2=H.W2=void 0,M(7259);var p=M(93414);Object.defineProperty(H,"W2",{enumerable:!0,get:function(){return p.Container}});M(21785),M(6070);var X=M(57549);Object.defineProperty(H,"b2",{enumerable:!0,get:function(){return X.injectable}});M(43881),M(35546);var Y=M(53615);Object.defineProperty(H,"f3",{enumerable:!0,get:function(){return Y.inject}});M(78098),M(14978),M(42048),M(91698);var tt=M(18955);Object.defineProperty(H,"zY",{enumerable:!0,get:function(){return tt.postConstruct}});M(28236),M(16800);var Ut=M(84848);Object.defineProperty(H,"GW",{enumerable:!0,get:function(){return Ut.decorate}});M(9446),M(48736),M(85527)},68902:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.Context=void 0;var ue=M(16800),w=function(){function p(_){this.id=ue.id(),this.container=_}return p.prototype.addPlan=function(_){this.plan=_},p.prototype.setCurrentRequest=function(_){this.currentRequest=_},p}();H.Context=w},95839:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.Metadata=void 0;var ue=M(7259),w=function(){function p(_,W){this.key=_,this.value=W}return p.prototype.toString=function(){return this.key===ue.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},p}();H.Metadata=w},28236:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.MetadataReader=void 0;var ue=M(7259),w=function(){function p(){}return p.prototype.getConstructorMetadata=function(_){return{compilerGeneratedMetadata:Reflect.getMetadata(ue.PARAM_TYPES,_),userGeneratedMetadata:Reflect.getMetadata(ue.TAGGED,_)||{}}},p.prototype.getPropertiesMetadata=function(_){return Reflect.getMetadata(ue.TAGGED_PROP,_)||[]},p}();H.MetadataReader=w},96742:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.Plan=void 0,H.Plan=function(w,p){this.parentContext=w,this.rootRequest=p}},71256:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.getBindingDictionary=H.createMockRequest=H.plan=void 0;var ue=M(54046),w=M(90640),p=M(21785),_=M(7259),W=M(61674),X=M(48736),q=M(68902),te=M(95839),Y=M(96742),Xe=M(64479),et=M(68779),z=M(56407);function Z(ne){return ne._bindingDictionary}function Mt(ne,nr,Tt,$e,Ct){var Dt,qe=At(Tt.container,Ct.serviceIdentifier);return qe.length===ue.BindingCount.NoBindingsAvailable&&Tt.container.options.autoBindInjectable&&"function"==typeof Ct.serviceIdentifier&&ne.getConstructorMetadata(Ct.serviceIdentifier).compilerGeneratedMetadata&&(Tt.container.bind(Ct.serviceIdentifier).toSelf(),qe=At(Tt.container,Ct.serviceIdentifier)),Dt=nr?qe:qe.filter(function(lr){var hr=new et.Request(lr.serviceIdentifier,Tt,$e,lr,Ct);return lr.constraint(hr)}),function(ne,nr,Tt,$e){switch(nr.length){case ue.BindingCount.NoBindingsAvailable:if(Tt.isOptional())return nr;var Ct=X.getServiceIdentifierAsString(ne),qe=w.NOT_REGISTERED;throw qe+=X.listMetadataForTarget(Ct,Tt),qe+=X.listRegisteredBindingsForServiceIdentifier($e,Ct,At),new Error(qe);case ue.BindingCount.OnlyOneBindingAvailable:if(!Tt.isArray())return nr;case ue.BindingCount.MultipleBindingsAvailable:default:if(Tt.isArray())return nr;throw Ct=X.getServiceIdentifierAsString(ne),qe=w.AMBIGUOUS_MATCH+" "+Ct,qe+=X.listRegisteredBindingsForServiceIdentifier($e,Ct,At),new Error(qe)}}(Ct.serviceIdentifier,Dt,Ct,Tt.container),Dt}function Ut(ne,nr,Tt,$e,Ct,qe){var Dt,lr;if(null===Ct){Dt=Mt(ne,nr,$e,null,qe),lr=new et.Request(Tt,$e,null,Dt,qe);var hr=new Y.Plan($e,lr);$e.addPlan(hr)}else Dt=Mt(ne,nr,$e,Ct,qe),lr=Ct.addChildRequest(qe.serviceIdentifier,Dt,qe);Dt.forEach(function(Dr){var _e=null;if(qe.isArray())_e=lr.addChildRequest(Dr.serviceIdentifier,Dr,qe);else{if(Dr.cache)return;_e=lr}if(Dr.type===p.BindingTypeEnum.Instance&&null!==Dr.implementationType){var ve=Xe.getDependencies(ne,Dr.implementationType);if(!$e.container.options.skipBaseClassChecks){var ae=Xe.getBaseClassDependencyCount(ne,Dr.implementationType);if(ve.length<ae){var de=w.ARGUMENTS_LENGTH_MISMATCH(Xe.getFunctionName(Dr.implementationType));throw new Error(de)}}ve.forEach(function(Pe){Ut(ne,!1,Pe.serviceIdentifier,$e,_e,Pe)})}})}function At(ne,nr){var Tt=[],$e=Z(ne);return $e.hasKey(nr)?Tt=$e.get(nr):null!==ne.parent&&(Tt=At(ne.parent,nr)),Tt}H.getBindingDictionary=Z,H.plan=function(ne,nr,Tt,$e,Ct,qe,Dt,lr){void 0===lr&&(lr=!1);var hr=new q.Context(nr),Dr=function(ne,nr,Tt,$e,Ct,qe){var lr=new te.Metadata(ne?_.MULTI_INJECT_TAG:_.INJECT_TAG,Tt),hr=new z.Target(nr,"",Tt,lr);if(void 0!==Ct){var Dr=new te.Metadata(Ct,qe);hr.metadata.push(Dr)}return hr}(Tt,$e,Ct,0,qe,Dt);try{return Ut(ne,lr,Ct,hr,null,Dr),hr}catch(_e){throw W.isStackOverflowExeption(_e)&&hr.plan&&X.circularDependencyToException(hr.plan.rootRequest),_e}},H.createMockRequest=function(ne,nr,Tt,$e){var Ct=new z.Target(p.TargetTypeEnum.Variable,"",nr,new te.Metadata(Tt,$e)),qe=new q.Context(ne);return new et.Request(nr,qe,null,[],Ct)}},46872:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.QueryableString=void 0;var M=function(){function ue(w){this.str=w}return ue.prototype.startsWith=function(w){return 0===this.str.indexOf(w)},ue.prototype.endsWith=function(w){var p,_=w.split("").reverse().join("");return p=this.str.split("").reverse().join(""),this.startsWith.call({str:p},_)},ue.prototype.contains=function(w){return-1!==this.str.indexOf(w)},ue.prototype.equals=function(w){return this.str===w},ue.prototype.value=function(){return this.str},ue}();H.QueryableString=M},64479:function(dr,H,M){"use strict";var ue=this&&this.__spreadArray||function(Mt,sr){for(var Ut=0,At=sr.length,Et=Mt.length;Ut<At;Ut++,Et++)Mt[Et]=sr[Ut];return Mt};Object.defineProperty(H,"__esModule",{value:!0}),H.getFunctionName=H.getBaseClassDependencyCount=H.getDependencies=void 0;var w=M(53615),p=M(90640),_=M(21785),W=M(7259),X=M(48736);Object.defineProperty(H,"getFunctionName",{enumerable:!0,get:function(){return X.getFunctionName}});var q=M(56407);function Y(Mt,sr,Ut,At){var Et=Mt.getConstructorMetadata(Ut),vr=Et.compilerGeneratedMetadata;if(void 0===vr)throw new Error(p.MISSING_INJECTABLE_ANNOTATION+" "+sr+".");var nr=Et.userGeneratedMetadata,Tt=Object.keys(nr),Dt=function(Mt,sr,Ut,At,Et){for(var vr=[],ne=0;ne<Et;ne++){var Tt=Xe(ne,Mt,sr,Ut,At);null!==Tt&&vr.push(Tt)}return vr}(At,sr,vr,nr,0===Ut.length&&Tt.length>0||Tt.length>Ut.length?Tt.length:Ut.length),lr=z(Mt,Ut);return ue(ue([],Dt),lr)}function Xe(Mt,sr,Ut,At,Et){var vr=Et[Mt.toString()]||[],ne=tt(vr),nr=!0!==ne.unmanaged,Tt=At[Mt];if((Tt=ne.inject||ne.multiInject||Tt)instanceof w.LazyServiceIdentifer&&(Tt=Tt.unwrap()),nr){if(!sr&&(Tt===Object||Tt===Function||void 0===Tt))throw new Error(p.MISSING_INJECT_ANNOTATION+" argument "+Mt+" in class "+Ut+".");var Dr=new q.Target(_.TargetTypeEnum.ConstructorArgument,ne.targetName,Tt);return Dr.metadata=vr,Dr}return null}function z(Mt,sr){for(var Ut=Mt.getPropertiesMetadata(sr),At=[],vr=0,ne=Object.keys(Ut);vr<ne.length;vr++){var nr=ne[vr],Tt=Ut[nr],$e=tt(Ut[nr]),Dt=new q.Target(_.TargetTypeEnum.ClassProperty,$e.targetName||nr,$e.inject||$e.multiInject);Dt.metadata=Tt,At.push(Dt)}var lr=Object.getPrototypeOf(sr.prototype).constructor;if(lr!==Object){var hr=z(Mt,lr);At=ue(ue([],At),hr)}return At}function tt(Mt){var sr={};return Mt.forEach(function(Ut){sr[Ut.key.toString()]=Ut.value}),{inject:sr[W.INJECT_TAG],multiInject:sr[W.MULTI_INJECT_TAG],targetName:sr[W.NAME_TAG],unmanaged:sr[W.UNMANAGED_TAG]}}H.getDependencies=function(Mt,sr){return Y(Mt,X.getFunctionName(sr),sr,!1)},H.getBaseClassDependencyCount=function Z(Mt,sr){var Ut=Object.getPrototypeOf(sr.prototype).constructor;if(Ut!==Object){var Et=Y(Mt,X.getFunctionName(Ut),Ut,!0),vr=Et.map(function(Tt){return Tt.metadata.filter(function($e){return $e.key===W.UNMANAGED_TAG})}),ne=[].concat.apply([],vr).length,nr=Et.length-ne;return nr>0?nr:Z(Mt,Ut)}return 0}},68779:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.Request=void 0;var ue=M(16800),w=function(){function p(_,W,X,q,te){this.id=ue.id(),this.serviceIdentifier=_,this.parentContext=W,this.parentRequest=X,this.target=te,this.childRequests=[],this.bindings=Array.isArray(q)?q:[q],this.requestScope=null===X?new Map:null}return p.prototype.addChildRequest=function(_,W,X){var q=new p(_,this.parentContext,this,W,X);return this.childRequests.push(q),q},p}();H.Request=w},56407:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.Target=void 0;var ue=M(7259),w=M(16800),p=M(95839),_=M(46872),W=function(){function X(q,te,Y,Xe){this.id=w.id(),this.type=q,this.serviceIdentifier=Y,this.name=new _.QueryableString(te||""),this.metadata=new Array;var et=null;"string"==typeof Xe?et=new p.Metadata(ue.NAMED_TAG,Xe):Xe instanceof p.Metadata&&(et=Xe),null!==et&&this.metadata.push(et)}return X.prototype.hasTag=function(q){for(var te=0,Y=this.metadata;te<Y.length;te++)if(Y[te].key===q)return!0;return!1},X.prototype.isArray=function(){return this.hasTag(ue.MULTI_INJECT_TAG)},X.prototype.matchesArray=function(q){return this.matchesTag(ue.MULTI_INJECT_TAG)(q)},X.prototype.isNamed=function(){return this.hasTag(ue.NAMED_TAG)},X.prototype.isTagged=function(){return this.metadata.some(function(q){return ue.NON_CUSTOM_TAG_KEYS.every(function(te){return q.key!==te})})},X.prototype.isOptional=function(){return this.matchesTag(ue.OPTIONAL_TAG)(!0)},X.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(q){return q.key===ue.NAMED_TAG})[0]:null},X.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(q){return ue.NON_CUSTOM_TAG_KEYS.every(function(te){return q.key!==te})}):null},X.prototype.matchesNamedTag=function(q){return this.matchesTag(ue.NAMED_TAG)(q)},X.prototype.matchesTag=function(q){var te=this;return function(Y){for(var Xe=0,et=te.metadata;Xe<et.length;Xe++){var z=et[Xe];if(z.key===q&&z.value===Y)return!0}return!1}},X}();H.Target=W},77661:function(dr,H,M){"use strict";var ue=this&&this.__spreadArray||function(Y,Xe){for(var et=0,z=Xe.length,Z=Y.length;et<z;et++,Z++)Y[Z]=Xe[et];return Y};Object.defineProperty(H,"__esModule",{value:!0}),H.resolveInstance=void 0;var w=M(90640),p=M(21785),_=M(7259);H.resolveInstance=function(Y,Xe,et){var z=null;return z=Xe.length>0?function(Y,Xe,et){var z=Xe.filter(function(tt){return null!==tt.target&&tt.target.type===p.TargetTypeEnum.ClassProperty}),Z=z.map(et);return z.forEach(function(tt,Mt){var sr;sr=tt.target.name.value(),Y[sr]=Z[Mt]}),Y}(z=function(Y,Xe){return new(Y.bind.apply(Y,ue([void 0],Xe)))}(Y,Xe.filter(function(Mt){return null!==Mt.target&&Mt.target.type===p.TargetTypeEnum.ConstructorArgument}).map(et)),Xe,et):new Y,function(Y,Xe){if(Reflect.hasMetadata(_.POST_CONSTRUCT,Y)){var et=Reflect.getMetadata(_.POST_CONSTRUCT,Y);try{Xe[et.value]()}catch(z){throw new Error(w.POST_CONSTRUCT_ERROR(Y.name,z.message))}}}(Y,z),z}},2739:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.resolve=void 0;var ue=M(90640),w=M(21785),p=M(61674),_=M(48736),W=M(77661),X=function(Y,Xe,et){try{return et()}catch(z){throw p.isStackOverflowExeption(z)?new Error(ue.CIRCULAR_DEPENDENCY_IN_FACTORY(Y,Xe.toString())):z}},q=function(Y){return function(Xe){Xe.parentContext.setCurrentRequest(Xe);var et=Xe.bindings,z=Xe.childRequests,Z=Xe.target&&Xe.target.isArray(),tt=!(Xe.parentRequest&&Xe.parentRequest.target&&Xe.target&&Xe.parentRequest.target.matchesArray(Xe.target.serviceIdentifier));if(Z&&tt)return z.map(function(vr){return q(Y)(vr)});var Mt=null;if(!Xe.target.isOptional()||0!==et.length){var sr=et[0],Ut=sr.scope===w.BindingScopeEnum.Singleton,At=sr.scope===w.BindingScopeEnum.Request;if(Ut&&sr.activated)return sr.cache;if(At&&null!==Y&&Y.has(sr.id))return Y.get(sr.id);if(sr.type===w.BindingTypeEnum.ConstantValue)Mt=sr.cache,sr.activated=!0;else if(sr.type===w.BindingTypeEnum.Function)Mt=sr.cache,sr.activated=!0;else if(sr.type===w.BindingTypeEnum.Constructor)Mt=sr.implementationType;else if(sr.type===w.BindingTypeEnum.DynamicValue&&null!==sr.dynamicValue)Mt=X("toDynamicValue",sr.serviceIdentifier,function(){return sr.dynamicValue(Xe.parentContext)});else if(sr.type===w.BindingTypeEnum.Factory&&null!==sr.factory)Mt=X("toFactory",sr.serviceIdentifier,function(){return sr.factory(Xe.parentContext)});else if(sr.type===w.BindingTypeEnum.Provider&&null!==sr.provider)Mt=X("toProvider",sr.serviceIdentifier,function(){return sr.provider(Xe.parentContext)});else{if(sr.type!==w.BindingTypeEnum.Instance||null===sr.implementationType){var Et=_.getServiceIdentifierAsString(Xe.serviceIdentifier);throw new Error(ue.INVALID_BINDING_TYPE+" "+Et)}Mt=W.resolveInstance(sr.implementationType,z,q(Y))}return"function"==typeof sr.onActivation&&(Mt=sr.onActivation(Xe.parentContext,Mt)),Ut&&(sr.cache=Mt,sr.activated=!0),At&&null!==Y&&!Y.has(sr.id)&&Y.set(sr.id,Mt),Mt}}};H.resolve=function(Y){return q(Y.plan.rootRequest.requestScope)(Y.plan.rootRequest)}},73504:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.BindingInSyntax=void 0;var ue=M(21785),w=M(18564),p=function(){function _(W){this._binding=W}return _.prototype.inRequestScope=function(){return this._binding.scope=ue.BindingScopeEnum.Request,new w.BindingWhenOnSyntax(this._binding)},_.prototype.inSingletonScope=function(){return this._binding.scope=ue.BindingScopeEnum.Singleton,new w.BindingWhenOnSyntax(this._binding)},_.prototype.inTransientScope=function(){return this._binding.scope=ue.BindingScopeEnum.Transient,new w.BindingWhenOnSyntax(this._binding)},_}();H.BindingInSyntax=p},80620:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.BindingInWhenOnSyntax=void 0;var ue=M(73504),w=M(17067),p=M(24803),_=function(){function W(X){this._binding=X,this._bindingWhenSyntax=new p.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new w.BindingOnSyntax(this._binding),this._bindingInSyntax=new ue.BindingInSyntax(X)}return W.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},W.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},W.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},W.prototype.when=function(X){return this._bindingWhenSyntax.when(X)},W.prototype.whenTargetNamed=function(X){return this._bindingWhenSyntax.whenTargetNamed(X)},W.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},W.prototype.whenTargetTagged=function(X,q){return this._bindingWhenSyntax.whenTargetTagged(X,q)},W.prototype.whenInjectedInto=function(X){return this._bindingWhenSyntax.whenInjectedInto(X)},W.prototype.whenParentNamed=function(X){return this._bindingWhenSyntax.whenParentNamed(X)},W.prototype.whenParentTagged=function(X,q){return this._bindingWhenSyntax.whenParentTagged(X,q)},W.prototype.whenAnyAncestorIs=function(X){return this._bindingWhenSyntax.whenAnyAncestorIs(X)},W.prototype.whenNoAncestorIs=function(X){return this._bindingWhenSyntax.whenNoAncestorIs(X)},W.prototype.whenAnyAncestorNamed=function(X){return this._bindingWhenSyntax.whenAnyAncestorNamed(X)},W.prototype.whenAnyAncestorTagged=function(X,q){return this._bindingWhenSyntax.whenAnyAncestorTagged(X,q)},W.prototype.whenNoAncestorNamed=function(X){return this._bindingWhenSyntax.whenNoAncestorNamed(X)},W.prototype.whenNoAncestorTagged=function(X,q){return this._bindingWhenSyntax.whenNoAncestorTagged(X,q)},W.prototype.whenAnyAncestorMatches=function(X){return this._bindingWhenSyntax.whenAnyAncestorMatches(X)},W.prototype.whenNoAncestorMatches=function(X){return this._bindingWhenSyntax.whenNoAncestorMatches(X)},W.prototype.onActivation=function(X){return this._bindingOnSyntax.onActivation(X)},W}();H.BindingInWhenOnSyntax=_},17067:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.BindingOnSyntax=void 0;var ue=M(24803),w=function(){function p(_){this._binding=_}return p.prototype.onActivation=function(_){return this._binding.onActivation=_,new ue.BindingWhenSyntax(this._binding)},p}();H.BindingOnSyntax=w},38809:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.BindingToSyntax=void 0;var ue=M(90640),w=M(21785),p=M(80620),_=M(18564),W=function(){function X(q){this._binding=q}return X.prototype.to=function(q){return this._binding.type=w.BindingTypeEnum.Instance,this._binding.implementationType=q,new p.BindingInWhenOnSyntax(this._binding)},X.prototype.toSelf=function(){if("function"!=typeof this._binding.serviceIdentifier)throw new Error(""+ue.INVALID_TO_SELF_VALUE);return this.to(this._binding.serviceIdentifier)},X.prototype.toConstantValue=function(q){return this._binding.type=w.BindingTypeEnum.ConstantValue,this._binding.cache=q,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=w.BindingScopeEnum.Singleton,new _.BindingWhenOnSyntax(this._binding)},X.prototype.toDynamicValue=function(q){return this._binding.type=w.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=q,this._binding.implementationType=null,new p.BindingInWhenOnSyntax(this._binding)},X.prototype.toConstructor=function(q){return this._binding.type=w.BindingTypeEnum.Constructor,this._binding.implementationType=q,this._binding.scope=w.BindingScopeEnum.Singleton,new _.BindingWhenOnSyntax(this._binding)},X.prototype.toFactory=function(q){return this._binding.type=w.BindingTypeEnum.Factory,this._binding.factory=q,this._binding.scope=w.BindingScopeEnum.Singleton,new _.BindingWhenOnSyntax(this._binding)},X.prototype.toFunction=function(q){if("function"!=typeof q)throw new Error(ue.INVALID_FUNCTION_BINDING);var te=this.toConstantValue(q);return this._binding.type=w.BindingTypeEnum.Function,this._binding.scope=w.BindingScopeEnum.Singleton,te},X.prototype.toAutoFactory=function(q){return this._binding.type=w.BindingTypeEnum.Factory,this._binding.factory=function(te){return function(){return te.container.get(q)}},this._binding.scope=w.BindingScopeEnum.Singleton,new _.BindingWhenOnSyntax(this._binding)},X.prototype.toProvider=function(q){return this._binding.type=w.BindingTypeEnum.Provider,this._binding.provider=q,this._binding.scope=w.BindingScopeEnum.Singleton,new _.BindingWhenOnSyntax(this._binding)},X.prototype.toService=function(q){this.toDynamicValue(function(te){return te.container.get(q)})},X}();H.BindingToSyntax=W},18564:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.BindingWhenOnSyntax=void 0;var ue=M(17067),w=M(24803),p=function(){function _(W){this._binding=W,this._bindingWhenSyntax=new w.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new ue.BindingOnSyntax(this._binding)}return _.prototype.when=function(W){return this._bindingWhenSyntax.when(W)},_.prototype.whenTargetNamed=function(W){return this._bindingWhenSyntax.whenTargetNamed(W)},_.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},_.prototype.whenTargetTagged=function(W,X){return this._bindingWhenSyntax.whenTargetTagged(W,X)},_.prototype.whenInjectedInto=function(W){return this._bindingWhenSyntax.whenInjectedInto(W)},_.prototype.whenParentNamed=function(W){return this._bindingWhenSyntax.whenParentNamed(W)},_.prototype.whenParentTagged=function(W,X){return this._bindingWhenSyntax.whenParentTagged(W,X)},_.prototype.whenAnyAncestorIs=function(W){return this._bindingWhenSyntax.whenAnyAncestorIs(W)},_.prototype.whenNoAncestorIs=function(W){return this._bindingWhenSyntax.whenNoAncestorIs(W)},_.prototype.whenAnyAncestorNamed=function(W){return this._bindingWhenSyntax.whenAnyAncestorNamed(W)},_.prototype.whenAnyAncestorTagged=function(W,X){return this._bindingWhenSyntax.whenAnyAncestorTagged(W,X)},_.prototype.whenNoAncestorNamed=function(W){return this._bindingWhenSyntax.whenNoAncestorNamed(W)},_.prototype.whenNoAncestorTagged=function(W,X){return this._bindingWhenSyntax.whenNoAncestorTagged(W,X)},_.prototype.whenAnyAncestorMatches=function(W){return this._bindingWhenSyntax.whenAnyAncestorMatches(W)},_.prototype.whenNoAncestorMatches=function(W){return this._bindingWhenSyntax.whenNoAncestorMatches(W)},_.prototype.onActivation=function(W){return this._bindingOnSyntax.onActivation(W)},_}();H.BindingWhenOnSyntax=p},24803:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.BindingWhenSyntax=void 0;var ue=M(17067),w=M(9446),p=function(){function _(W){this._binding=W}return _.prototype.when=function(W){return this._binding.constraint=W,new ue.BindingOnSyntax(this._binding)},_.prototype.whenTargetNamed=function(W){return this._binding.constraint=w.namedConstraint(W),new ue.BindingOnSyntax(this._binding)},_.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(W){return null!==W.target&&!W.target.isNamed()&&!W.target.isTagged()},new ue.BindingOnSyntax(this._binding)},_.prototype.whenTargetTagged=function(W,X){return this._binding.constraint=w.taggedConstraint(W)(X),new ue.BindingOnSyntax(this._binding)},_.prototype.whenInjectedInto=function(W){return this._binding.constraint=function(X){return w.typeConstraint(W)(X.parentRequest)},new ue.BindingOnSyntax(this._binding)},_.prototype.whenParentNamed=function(W){return this._binding.constraint=function(X){return w.namedConstraint(W)(X.parentRequest)},new ue.BindingOnSyntax(this._binding)},_.prototype.whenParentTagged=function(W,X){return this._binding.constraint=function(q){return w.taggedConstraint(W)(X)(q.parentRequest)},new ue.BindingOnSyntax(this._binding)},_.prototype.whenAnyAncestorIs=function(W){return this._binding.constraint=function(X){return w.traverseAncerstors(X,w.typeConstraint(W))},new ue.BindingOnSyntax(this._binding)},_.prototype.whenNoAncestorIs=function(W){return this._binding.constraint=function(X){return!w.traverseAncerstors(X,w.typeConstraint(W))},new ue.BindingOnSyntax(this._binding)},_.prototype.whenAnyAncestorNamed=function(W){return this._binding.constraint=function(X){return w.traverseAncerstors(X,w.namedConstraint(W))},new ue.BindingOnSyntax(this._binding)},_.prototype.whenNoAncestorNamed=function(W){return this._binding.constraint=function(X){return!w.traverseAncerstors(X,w.namedConstraint(W))},new ue.BindingOnSyntax(this._binding)},_.prototype.whenAnyAncestorTagged=function(W,X){return this._binding.constraint=function(q){return w.traverseAncerstors(q,w.taggedConstraint(W)(X))},new ue.BindingOnSyntax(this._binding)},_.prototype.whenNoAncestorTagged=function(W,X){return this._binding.constraint=function(q){return!w.traverseAncerstors(q,w.taggedConstraint(W)(X))},new ue.BindingOnSyntax(this._binding)},_.prototype.whenAnyAncestorMatches=function(W){return this._binding.constraint=function(X){return w.traverseAncerstors(X,W)},new ue.BindingOnSyntax(this._binding)},_.prototype.whenNoAncestorMatches=function(W){return this._binding.constraint=function(X){return!w.traverseAncerstors(X,W)},new ue.BindingOnSyntax(this._binding)},_}();H.BindingWhenSyntax=p},9446:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.typeConstraint=H.namedConstraint=H.taggedConstraint=H.traverseAncerstors=void 0;var ue=M(7259),w=M(95839),p=function(q,te){var Y=q.parentRequest;return null!==Y&&(!!te(Y)||p(Y,te))};H.traverseAncerstors=p;var _=function(q){return function(te){var Y=function(Xe){return null!==Xe&&null!==Xe.target&&Xe.target.matchesTag(q)(te)};return Y.metaData=new w.Metadata(q,te),Y}};H.taggedConstraint=_;var W=_(ue.NAMED_TAG);H.namedConstraint=W,H.typeConstraint=function(q){return function(te){return null!==te&&("string"==typeof q?te.bindings[0].serviceIdentifier===q:q===te.bindings[0].implementationType)}}},85527:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.multiBindToService=void 0,H.multiBindToService=function(ue){return function(w){return function(){for(var p=[],_=0;_<arguments.length;_++)p[_]=arguments[_];return p.forEach(function(W){return ue.bind(W).toService(w)})}}}},61674:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.isStackOverflowExeption=void 0;var ue=M(90640);H.isStackOverflowExeption=function(p){return p instanceof RangeError||p.message===ue.STACK_OVERFLOW}},16800:(dr,H)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.id=void 0;var M=0;H.id=function(){return M++}},48736:(dr,H,M)=>{"use strict";Object.defineProperty(H,"__esModule",{value:!0}),H.circularDependencyToException=H.listMetadataForTarget=H.listRegisteredBindingsForServiceIdentifier=H.getServiceIdentifierAsString=H.getFunctionName=void 0;var ue=M(90640);function w(Y){return"function"==typeof Y?Y.name:"symbol"==typeof Y?Y.toString():Y}function _(Y,Xe){return null!==Y.parentRequest&&(Y.parentRequest.serviceIdentifier===Xe||_(Y.parentRequest,Xe))}function te(Y){if(Y.name)return Y.name;var Xe=Y.toString(),et=Xe.match(/^function\s*([^\s(]+)/);return et?et[1]:"Anonymous function: "+Xe}H.getServiceIdentifierAsString=w,H.listRegisteredBindingsForServiceIdentifier=function(Y,Xe,et){var z="",Z=et(Y,Xe);return 0!==Z.length&&(z="\nRegistered bindings:",Z.forEach(function(tt){var Mt="Object";null!==tt.implementationType&&(Mt=te(tt.implementationType)),z=z+"\n "+Mt,tt.constraint.metaData&&(z=z+" - "+tt.constraint.metaData)})),z},H.circularDependencyToException=function X(Y){Y.childRequests.forEach(function(Xe){if(_(Xe,Xe.serviceIdentifier)){var et=function(Y){return function Xe(z,Z){void 0===Z&&(Z=[]);var tt=w(z.serviceIdentifier);return Z.push(tt),null!==z.parentRequest?Xe(z.parentRequest,Z):Z}(Y).reverse().join(" --\x3e ")}(Xe);throw new Error(ue.CIRCULAR_DEPENDENCY+" "+et)}X(Xe)})},H.listMetadataForTarget=function(Y,Xe){if(Xe.isTagged()||Xe.isNamed()){var et="",z=Xe.getNamedTag(),Z=Xe.getCustomTags();return null!==z&&(et+=z.toString()+"\n"),null!==Z&&Z.forEach(function(tt){et+=tt.toString()+"\n"})," "+Y+"\n "+Y+" - "+et}return" "+Y},H.getFunctionName=te},88660:(dr,H,M)=>{"use strict";M.r(H),M.d(H,{Function:()=>eu,Interpreter:()=>Lo,default:()=>Dl,evaluate:()=>hl,vm:()=>ue});var ue={};M.r(ue),M.d(ue,{Script:()=>Rl,compileFunction:()=>kl,createContext:()=>Ol,runInContext:()=>Ll,runInNewContext:()=>Sc});var w={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},p="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",_={5:p,"5module":p+" export import",6:p+" const class extends export import super"},W=/^in(stanceof)?$/,X="\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u052f\u0531-\u0556\u0559\u0560-\u0588\u05d0-\u05ea\u05ef-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u0860-\u086a\u08a0-\u08b4\u08b6-\u08c7\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u09fc\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0af9\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c58-\u0c5a\u0c60\u0c61\u0c80\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d04-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d54-\u0d56\u0d5f-\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e86-\u0e8a\u0e8c-\u0ea3\u0ea5\u0ea7-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f5\u13f8-\u13fd\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1878\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c9\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1c80-\u1c88\u1c90-\u1cba\u1cbd-\u1cbf\u1ce9-\u1cec\u1cee-\u1cf3\u1cf5\u1cf6\u1cfa\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2118-\u211d\u2124\u2126\u2128\u212a-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309b-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312f\u3131-\u318e\u31a0-\u31bf\u31f0-\u31ff\u3400-\u4dbf\u4e00-\u9ffc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua69d\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua7bf\ua7c2-\ua7ca\ua7f5-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua8fd\ua8fe\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\ua9e0-\ua9e4\ua9e6-\ua9ef\ua9fa-\ua9fe\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa7e-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5c-\uab69\uab70-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",q="\u200c\u200d\xb7\u0300-\u036f\u0387\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u07fd\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08d3-\u08e1\u08e3-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u09fe\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0afa-\u0aff\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b55-\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c00-\u0c04\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c81-\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d00-\u0d03\u0d3b\u0d3c\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d81-\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0de6-\u0def\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1369-\u1371\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19d0-\u19da\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1ab0-\u1abd\u1abf\u1ac0\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf4\u1cf7-\u1cf9\u1dc0-\u1df9\u1dfb-\u1dff\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69e\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua82c\ua880\ua881\ua8b4-\ua8c5\ua8d0-\ua8d9\ua8e0-\ua8f1\ua8ff-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\ua9e5\ua9f0-\ua9f9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b-\uaa7d\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f",te=new RegExp("["+X+"]"),Y=new RegExp("["+X+q+"]");X=q=null;var Xe=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,107,20,28,22,13,52,76,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,230,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,190,0,80,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8952,286,50,2,18,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,2357,44,11,6,17,0,370,43,1301,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42717,35,4148,12,221,3,5761,15,7472,3104,541,1507,4938],et=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,154,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,262,6,10,9,419,13,1495,6,110,6,6,9,4759,9,787719,239];function z(m,E){for(var U=65536,O=0;O<E.length;O+=2){if((U+=E[O])>m)return!1;if((U+=E[O+1])>=m)return!0}}function Z(m,E){return m<65?36===m:m<91||(m<97?95===m:m<123||(m<=65535?m>=170&&te.test(String.fromCharCode(m)):!1!==E&&z(m,Xe)))}function tt(m,E){return m<48?36===m:m<58||!(m<65)&&(m<91||(m<97?95===m:m<123||(m<=65535?m>=170&&Y.test(String.fromCharCode(m)):!1!==E&&(z(m,Xe)||z(m,et)))))}var Mt=function(E,U){void 0===U&&(U={}),this.label=E,this.keyword=U.keyword,this.beforeExpr=!!U.beforeExpr,this.startsExpr=!!U.startsExpr,this.isLoop=!!U.isLoop,this.isAssign=!!U.isAssign,this.prefix=!!U.prefix,this.postfix=!!U.postfix,this.binop=U.binop||null,this.updateContext=null};function sr(m,E){return new Mt(m,{beforeExpr:!0,binop:E})}var Ut={beforeExpr:!0},At={startsExpr:!0},Et={};function vr(m,E){return void 0===E&&(E={}),E.keyword=m,Et[m]=new Mt(m,E)}var ne={num:new Mt("num",At),regexp:new Mt("regexp",At),string:new Mt("string",At),name:new Mt("name",At),eof:new Mt("eof"),bracketL:new Mt("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Mt("]"),braceL:new Mt("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Mt("}"),parenL:new Mt("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Mt(")"),comma:new Mt(",",Ut),semi:new Mt(";",Ut),colon:new Mt(":",Ut),dot:new Mt("."),question:new Mt("?",Ut),questionDot:new Mt("?."),arrow:new Mt("=>",Ut),template:new Mt("template"),invalidTemplate:new Mt("invalidTemplate"),ellipsis:new Mt("...",Ut),backQuote:new Mt("`",At),dollarBraceL:new Mt("${",{beforeExpr:!0,startsExpr:!0}),eq:new Mt("=",{beforeExpr:!0,isAssign:!0}),assign:new Mt("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Mt("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Mt("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:sr("||",1),logicalAND:sr("&&",2),bitwiseOR:sr("|",3),bitwiseXOR:sr("^",4),bitwiseAND:sr("&",5),equality:sr("==/!=/===/!==",6),relational:sr("</>/<=/>=",7),bitShift:sr("<</>>/>>>",8),plusMin:new Mt("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:sr("%",10),star:sr("*",10),slash:sr("/",10),starstar:new Mt("**",{beforeExpr:!0}),coalesce:sr("??",1),_break:vr("break"),_case:vr("case",Ut),_catch:vr("catch"),_continue:vr("continue"),_debugger:vr("debugger"),_default:vr("default",Ut),_do:vr("do",{isLoop:!0,beforeExpr:!0}),_else:vr("else",Ut),_finally:vr("finally"),_for:vr("for",{isLoop:!0}),_function:vr("function",At),_if:vr("if"),_return:vr("return",Ut),_switch:vr("switch"),_throw:vr("throw",Ut),_try:vr("try"),_var:vr("var"),_const:vr("const"),_while:vr("while",{isLoop:!0}),_with:vr("with"),_new:vr("new",{beforeExpr:!0,startsExpr:!0}),_this:vr("this",At),_super:vr("super",At),_class:vr("class",At),_extends:vr("extends",Ut),_export:vr("export"),_import:vr("import",At),_null:vr("null",At),_true:vr("true",At),_false:vr("false",At),_in:vr("in",{beforeExpr:!0,binop:7}),_instanceof:vr("instanceof",{beforeExpr:!0,binop:7}),_typeof:vr("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:vr("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:vr("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},nr=/\r\n?|\n|\u2028|\u2029/,Tt=new RegExp(nr.source,"g");function $e(m,E){return 10===m||13===m||!E&&(8232===m||8233===m)}var Ct=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,qe=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Dt=Object.prototype,lr=Dt.hasOwnProperty,hr=Dt.toString;function Dr(m,E){return lr.call(m,E)}var _e=Array.isArray||function(m){return"[object Array]"===hr.call(m)};function ve(m){return new RegExp("^(?:"+m.replace(/ /g,"|")+")$")}var ae=function(E,U){this.line=E,this.column=U};ae.prototype.offset=function(E){return new ae(this.line,this.column+E)};var de=function(E,U,O){this.start=U,this.end=O,null!==E.sourceFile&&(this.source=E.sourceFile)};function Pe(m,E){for(var U=1,O=0;;){Tt.lastIndex=O;var pe=Tt.exec(m);if(!(pe&&pe.index<E))return new ae(U,E-O);++U,O=pe.index+pe[0].length}}var ze={ecmaVersion:10,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1};function Ar(m,E){return 2|(m?4:0)|(E?8:0)}var Ve=function(E,U,O){this.options=E=function(m){var E={};for(var U in ze)E[U]=m&&Dr(m,U)?m[U]:ze[U];if(E.ecmaVersion>=2015&&(E.ecmaVersion-=2009),null==E.allowReserved&&(E.allowReserved=E.ecmaVersion<5),_e(E.onToken)){var O=E.onToken;E.onToken=function(pe){return O.push(pe)}}return _e(E.onComment)&&(E.onComment=function(m,E){return function(U,O,pe,De,ft,Rt){var kt={type:U?"Block":"Line",value:O,start:pe,end:De};m.locations&&(kt.loc=new de(this,ft,Rt)),m.ranges&&(kt.range=[pe,De]),E.push(kt)}}(E,E.onComment)),E}(E),this.sourceFile=E.sourceFile,this.keywords=ve(_[E.ecmaVersion>=6?6:"module"===E.sourceType?"5module":5]);var pe="";if(!0!==E.allowReserved){for(var De=E.ecmaVersion;!(pe=w[De]);De--);"module"===E.sourceType&&(pe+=" await")}this.reservedWords=ve(pe);var ft=(pe?pe+" ":"")+w.strict;this.reservedWordsStrict=ve(ft),this.reservedWordsStrictBind=ve(ft+" "+w.strictBind),this.input=String(U),this.containsEsc=!1,O?(this.pos=O,this.lineStart=this.input.lastIndexOf("\n",O-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(nr).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=ne.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===E.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports={},0===this.pos&&E.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null},rt={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0}};Ve.prototype.parse=function(){var E=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(E)},rt.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},rt.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0},rt.inAsync.get=function(){return(4&this.currentVarScope().flags)>0},rt.allowSuper.get=function(){return(64&this.currentThisScope().flags)>0},rt.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},rt.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Ve.prototype.inNonArrowFunction=function(){return(2&this.currentThisScope().flags)>0},Ve.extend=function(){for(var E=[],U=arguments.length;U--;)E[U]=arguments[U];for(var O=this,pe=0;pe<E.length;pe++)O=E[pe](O);return O},Ve.parse=function(E,U){return new this(U,E).parse()},Ve.parseExpressionAt=function(E,U,O){var pe=new this(O,E,U);return pe.nextToken(),pe.parseExpression()},Ve.tokenizer=function(E,U){return new this(U,E)},Object.defineProperties(Ve.prototype,rt);var dt=Ve.prototype,Ot=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;function B(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}dt.strictDirective=function(m){for(;;){qe.lastIndex=m,m+=qe.exec(this.input)[0].length;var E=Ot.exec(this.input.slice(m));if(!E)return!1;if("use strict"===(E[1]||E[2])){qe.lastIndex=m+E[0].length;var U=qe.exec(this.input),O=U.index+U[0].length,pe=this.input.charAt(O);return";"===pe||"}"===pe||nr.test(U[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(pe)||"!"===pe&&"="===this.input.charAt(O+1))}qe.lastIndex=m+=E[0].length,m+=qe.exec(this.input)[0].length,";"===this.input[m]&&m++}},dt.eat=function(m){return this.type===m&&(this.next(),!0)},dt.isContextual=function(m){return this.type===ne.name&&this.value===m&&!this.containsEsc},dt.eatContextual=function(m){return!!this.isContextual(m)&&(this.next(),!0)},dt.expectContextual=function(m){this.eatContextual(m)||this.unexpected()},dt.canInsertSemicolon=function(){return this.type===ne.eof||this.type===ne.braceR||nr.test(this.input.slice(this.lastTokEnd,this.start))},dt.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},dt.semicolon=function(){!this.eat(ne.semi)&&!this.insertSemicolon()&&this.unexpected()},dt.afterTrailingComma=function(m,E){if(this.type===m)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),E||this.next(),!0},dt.expect=function(m){this.eat(m)||this.unexpected()},dt.unexpected=function(m){this.raise(null!=m?m:this.start,"Unexpected token")},dt.checkPatternErrors=function(m,E){if(m){m.trailingComma>-1&&this.raiseRecoverable(m.trailingComma,"Comma is not permitted after the rest element");var U=E?m.parenthesizedAssign:m.parenthesizedBind;U>-1&&this.raiseRecoverable(U,"Parenthesized pattern")}},dt.checkExpressionErrors=function(m,E){if(!m)return!1;var U=m.shorthandAssign,O=m.doubleProto;if(!E)return U>=0||O>=0;U>=0&&this.raise(U,"Shorthand property assignments are valid only in destructuring patterns"),O>=0&&this.raiseRecoverable(O,"Redefinition of __proto__ property")},dt.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},dt.isSimpleAssignTarget=function(m){return"ParenthesizedExpression"===m.type?this.isSimpleAssignTarget(m.expression):"Identifier"===m.type||"MemberExpression"===m.type};var Ue=Ve.prototype;Ue.parseTopLevel=function(m){var E={};for(m.body||(m.body=[]);this.type!==ne.eof;){var U=this.parseStatement(null,!0,E);m.body.push(U)}if(this.inModule)for(var O=0,pe=Object.keys(this.undefinedExports);O<pe.length;O+=1){var De=pe[O];this.raiseRecoverable(this.undefinedExports[De].start,"Export '"+De+"' is not defined")}return this.adaptDirectivePrologue(m.body),this.next(),m.sourceType=this.options.sourceType,this.finishNode(m,"Program")};var _t={kind:"loop"},St={kind:"switch"};Ue.isLet=function(m){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;qe.lastIndex=this.pos;var E=qe.exec(this.input),U=this.pos+E[0].length,O=this.input.charCodeAt(U);if(91===O)return!0;if(m)return!1;if(123===O)return!0;if(Z(O,!0)){for(var pe=U+1;tt(this.input.charCodeAt(pe),!0);)++pe;var De=this.input.slice(U,pe);if(!W.test(De))return!0}return!1},Ue.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;qe.lastIndex=this.pos;var m=qe.exec(this.input),E=this.pos+m[0].length;return!(nr.test(this.input.slice(this.pos,E))||"function"!==this.input.slice(E,E+8)||E+8!==this.input.length&&tt(this.input.charAt(E+8)))},Ue.parseStatement=function(m,E,U){var De,O=this.type,pe=this.startNode();switch(this.isLet(m)&&(O=ne._var,De="let"),O){case ne._break:case ne._continue:return this.parseBreakContinueStatement(pe,O.keyword);case ne._debugger:return this.parseDebuggerStatement(pe);case ne._do:return this.parseDoStatement(pe);case ne._for:return this.parseForStatement(pe);case ne._function:return m&&(this.strict||"if"!==m&&"label"!==m)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(pe,!1,!m);case ne._class:return m&&this.unexpected(),this.parseClass(pe,!0);case ne._if:return this.parseIfStatement(pe);case ne._return:return this.parseReturnStatement(pe);case ne._switch:return this.parseSwitchStatement(pe);case ne._throw:return this.parseThrowStatement(pe);case ne._try:return this.parseTryStatement(pe);case ne._const:case ne._var:return De=De||this.value,m&&"var"!==De&&this.unexpected(),this.parseVarStatement(pe,De);case ne._while:return this.parseWhileStatement(pe);case ne._with:return this.parseWithStatement(pe);case ne.braceL:return this.parseBlock(!0,pe);case ne.semi:return this.parseEmptyStatement(pe);case ne._export:case ne._import:if(this.options.ecmaVersion>10&&O===ne._import){qe.lastIndex=this.pos;var ft=qe.exec(this.input),kt=this.input.charCodeAt(this.pos+ft[0].length);if(40===kt||46===kt)return this.parseExpressionStatement(pe,this.parseExpression())}return this.options.allowImportExportEverywhere||(E||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),O===ne._import?this.parseImport(pe):this.parseExport(pe,U);default:if(this.isAsyncFunction())return m&&this.unexpected(),this.next(),this.parseFunctionStatement(pe,!0,!m);var Ir=this.value,Nr=this.parseExpression();return O===ne.name&&"Identifier"===Nr.type&&this.eat(ne.colon)?this.parseLabeledStatement(pe,Ir,Nr,m):this.parseExpressionStatement(pe,Nr)}},Ue.parseBreakContinueStatement=function(m,E){var U="break"===E;this.next(),this.eat(ne.semi)||this.insertSemicolon()?m.label=null:this.type!==ne.name?this.unexpected():(m.label=this.parseIdent(),this.semicolon());for(var O=0;O<this.labels.length;++O){var pe=this.labels[O];if((null==m.label||pe.name===m.label.name)&&(null!=pe.kind&&(U||"loop"===pe.kind)||m.label&&U))break}return O===this.labels.length&&this.raise(m.start,"Unsyntactic "+E),this.finishNode(m,U?"BreakStatement":"ContinueStatement")},Ue.parseDebuggerStatement=function(m){return this.next(),this.semicolon(),this.finishNode(m,"DebuggerStatement")},Ue.parseDoStatement=function(m){return this.next(),this.labels.push(_t),m.body=this.parseStatement("do"),this.labels.pop(),this.expect(ne._while),m.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(ne.semi):this.semicolon(),this.finishNode(m,"DoWhileStatement")},Ue.parseForStatement=function(m){this.next();var E=this.options.ecmaVersion>=9&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(_t),this.enterScope(0),this.expect(ne.parenL),this.type===ne.semi)return E>-1&&this.unexpected(E),this.parseFor(m,null);var U=this.isLet();if(this.type===ne._var||this.type===ne._const||U){var O=this.startNode(),pe=U?"let":this.value;return this.next(),this.parseVar(O,!0,pe),this.finishNode(O,"VariableDeclaration"),(this.type===ne._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===O.declarations.length?(this.options.ecmaVersion>=9&&(this.type===ne._in?E>-1&&this.unexpected(E):m.await=E>-1),this.parseForIn(m,O)):(E>-1&&this.unexpected(E),this.parseFor(m,O))}var De=new B,ft=this.parseExpression(!0,De);return this.type===ne._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.options.ecmaVersion>=9&&(this.type===ne._in?E>-1&&this.unexpected(E):m.await=E>-1),this.toAssignable(ft,!1,De),this.checkLVal(ft),this.parseForIn(m,ft)):(this.checkExpressionErrors(De,!0),E>-1&&this.unexpected(E),this.parseFor(m,ft))},Ue.parseFunctionStatement=function(m,E,U){return this.next(),this.parseFunction(m,Cr|(U?0:_r),!1,E)},Ue.parseIfStatement=function(m){return this.next(),m.test=this.parseParenExpression(),m.consequent=this.parseStatement("if"),m.alternate=this.eat(ne._else)?this.parseStatement("if"):null,this.finishNode(m,"IfStatement")},Ue.parseReturnStatement=function(m){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(ne.semi)||this.insertSemicolon()?m.argument=null:(m.argument=this.parseExpression(),this.semicolon()),this.finishNode(m,"ReturnStatement")},Ue.parseSwitchStatement=function(m){this.next(),m.discriminant=this.parseParenExpression(),m.cases=[],this.expect(ne.braceL),this.labels.push(St),this.enterScope(0);for(var E,U=!1;this.type!==ne.braceR;)if(this.type===ne._case||this.type===ne._default){var O=this.type===ne._case;E&&this.finishNode(E,"SwitchCase"),m.cases.push(E=this.startNode()),E.consequent=[],this.next(),O?E.test=this.parseExpression():(U&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),U=!0,E.test=null),this.expect(ne.colon)}else E||this.unexpected(),E.consequent.push(this.parseStatement(null));return this.exitScope(),E&&this.finishNode(E,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(m,"SwitchStatement")},Ue.parseThrowStatement=function(m){return this.next(),nr.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),m.argument=this.parseExpression(),this.semicolon(),this.finishNode(m,"ThrowStatement")};var Xt=[];Ue.parseTryStatement=function(m){if(this.next(),m.block=this.parseBlock(),m.handler=null,this.type===ne._catch){var E=this.startNode();if(this.next(),this.eat(ne.parenL)){E.param=this.parseBindingAtom();var U="Identifier"===E.param.type;this.enterScope(U?32:0),this.checkLVal(E.param,U?4:2),this.expect(ne.parenR)}else this.options.ecmaVersion<10&&this.unexpected(),E.param=null,this.enterScope(0);E.body=this.parseBlock(!1),this.exitScope(),m.handler=this.finishNode(E,"CatchClause")}return m.finalizer=this.eat(ne._finally)?this.parseBlock():null,!m.handler&&!m.finalizer&&this.raise(m.start,"Missing catch or finally clause"),this.finishNode(m,"TryStatement")},Ue.parseVarStatement=function(m,E){return this.next(),this.parseVar(m,!1,E),this.semicolon(),this.finishNode(m,"VariableDeclaration")},Ue.parseWhileStatement=function(m){return this.next(),m.test=this.parseParenExpression(),this.labels.push(_t),m.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(m,"WhileStatement")},Ue.parseWithStatement=function(m){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),m.object=this.parseParenExpression(),m.body=this.parseStatement("with"),this.finishNode(m,"WithStatement")},Ue.parseEmptyStatement=function(m){return this.next(),this.finishNode(m,"EmptyStatement")},Ue.parseLabeledStatement=function(m,E,U,O){for(var pe=0,De=this.labels;pe<De.length;pe+=1)De[pe].name===E&&this.raise(U.start,"Label '"+E+"' is already declared");for(var Rt=this.type.isLoop?"loop":this.type===ne._switch?"switch":null,kt=this.labels.length-1;kt>=0;kt--){var Ir=this.labels[kt];if(Ir.statementStart!==m.start)break;Ir.statementStart=this.start,Ir.kind=Rt}return this.labels.push({name:E,kind:Rt,statementStart:this.start}),m.body=this.parseStatement(O?-1===O.indexOf("label")?O+"label":O:"label"),this.labels.pop(),m.label=U,this.finishNode(m,"LabeledStatement")},Ue.parseExpressionStatement=function(m,E){return m.expression=E,this.semicolon(),this.finishNode(m,"ExpressionStatement")},Ue.parseBlock=function(m,E,U){for(void 0===m&&(m=!0),void 0===E&&(E=this.startNode()),E.body=[],this.expect(ne.braceL),m&&this.enterScope(0);this.type!==ne.braceR;){var O=this.parseStatement(null);E.body.push(O)}return U&&(this.strict=!1),this.next(),m&&this.exitScope(),this.finishNode(E,"BlockStatement")},Ue.parseFor=function(m,E){return m.init=E,this.expect(ne.semi),m.test=this.type===ne.semi?null:this.parseExpression(),this.expect(ne.semi),m.update=this.type===ne.parenR?null:this.parseExpression(),this.expect(ne.parenR),m.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(m,"ForStatement")},Ue.parseForIn=function(m,E){var U=this.type===ne._in;return this.next(),"VariableDeclaration"===E.type&&null!=E.declarations[0].init&&(!U||this.options.ecmaVersion<8||this.strict||"var"!==E.kind||"Identifier"!==E.declarations[0].id.type)?this.raise(E.start,(U?"for-in":"for-of")+" loop variable declaration may not have an initializer"):"AssignmentPattern"===E.type&&this.raise(E.start,"Invalid left-hand side in for-loop"),m.left=E,m.right=U?this.parseExpression():this.parseMaybeAssign(),this.expect(ne.parenR),m.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(m,U?"ForInStatement":"ForOfStatement")},Ue.parseVar=function(m,E,U){for(m.declarations=[],m.kind=U;;){var O=this.startNode();if(this.parseVarId(O,U),this.eat(ne.eq)?O.init=this.parseMaybeAssign(E):"const"!==U||this.type===ne._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"===O.id.type||E&&(this.type===ne._in||this.isContextual("of"))?O.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),m.declarations.push(this.finishNode(O,"VariableDeclarator")),!this.eat(ne.comma))break}return m},Ue.parseVarId=function(m,E){m.id=this.parseBindingAtom(),this.checkLVal(m.id,"var"===E?1:2,!1)};var Cr=1,_r=2;Ue.parseFunction=function(m,E,U,O){this.initFunction(m),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!O)&&(this.type===ne.star&&E&_r&&this.unexpected(),m.generator=this.eat(ne.star)),this.options.ecmaVersion>=8&&(m.async=!!O),E&Cr&&(m.id=4&E&&this.type!==ne.name?null:this.parseIdent(),m.id&&!(E&_r)&&this.checkLVal(m.id,this.strict||m.generator||m.async?this.treatFunctionsAsVar?1:2:3));var pe=this.yieldPos,De=this.awaitPos,ft=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(Ar(m.async,m.generator)),E&Cr||(m.id=this.type===ne.name?this.parseIdent():null),this.parseFunctionParams(m),this.parseFunctionBody(m,U,!1),this.yieldPos=pe,this.awaitPos=De,this.awaitIdentPos=ft,this.finishNode(m,E&Cr?"FunctionDeclaration":"FunctionExpression")},Ue.parseFunctionParams=function(m){this.expect(ne.parenL),m.params=this.parseBindingList(ne.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},Ue.parseClass=function(m,E){this.next();var U=this.strict;this.strict=!0,this.parseClassId(m,E),this.parseClassSuper(m);var O=this.startNode(),pe=!1;for(O.body=[],this.expect(ne.braceL);this.type!==ne.braceR;){var De=this.parseClassElement(null!==m.superClass);De&&(O.body.push(De),"MethodDefinition"===De.type&&"constructor"===De.kind&&(pe&&this.raise(De.start,"Duplicate constructor in the same class"),pe=!0))}return this.strict=U,this.next(),m.body=this.finishNode(O,"ClassBody"),this.finishNode(m,E?"ClassDeclaration":"ClassExpression")},Ue.parseClassElement=function(m){var E=this;if(this.eat(ne.semi))return null;var U=this.startNode(),O=function(kt,Ir){void 0===Ir&&(Ir=!1);var Nr=E.start,Jn=E.startLoc;return!(!E.eatContextual(kt)||(E.type===ne.parenL||Ir&&E.canInsertSemicolon())&&(U.key&&E.unexpected(),U.computed=!1,U.key=E.startNodeAt(Nr,Jn),U.key.name=kt,E.finishNode(U.key,"Identifier"),1))};U.kind="method",U.static=O("static");var pe=this.eat(ne.star),De=!1;pe||(this.options.ecmaVersion>=8&&O("async",!0)?(De=!0,pe=this.options.ecmaVersion>=9&&this.eat(ne.star)):O("get")?U.kind="get":O("set")&&(U.kind="set")),U.key||this.parsePropertyName(U);var ft=U.key,Rt=!1;return U.computed||U.static||!("Identifier"===ft.type&&"constructor"===ft.name||"Literal"===ft.type&&"constructor"===ft.value)?U.static&&"Identifier"===ft.type&&"prototype"===ft.name&&this.raise(ft.start,"Classes may not have a static property named prototype"):("method"!==U.kind&&this.raise(ft.start,"Constructor can't have get/set modifier"),pe&&this.raise(ft.start,"Constructor can't be a generator"),De&&this.raise(ft.start,"Constructor can't be an async method"),U.kind="constructor",Rt=m),this.parseClassMethod(U,pe,De,Rt),"get"===U.kind&&0!==U.value.params.length&&this.raiseRecoverable(U.value.start,"getter should have no params"),"set"===U.kind&&1!==U.value.params.length&&this.raiseRecoverable(U.value.start,"setter should have exactly one param"),"set"===U.kind&&"RestElement"===U.value.params[0].type&&this.raiseRecoverable(U.value.params[0].start,"Setter cannot use rest params"),U},Ue.parseClassMethod=function(m,E,U,O){return m.value=this.parseMethod(E,U,O),this.finishNode(m,"MethodDefinition")},Ue.parseClassId=function(m,E){this.type===ne.name?(m.id=this.parseIdent(),E&&this.checkLVal(m.id,2,!1)):(!0===E&&this.unexpected(),m.id=null)},Ue.parseClassSuper=function(m){m.superClass=this.eat(ne._extends)?this.parseExprSubscripts():null},Ue.parseExport=function(m,E){if(this.next(),this.eat(ne.star))return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(m.exported=this.parseIdent(!0),this.checkExport(E,m.exported.name,this.lastTokStart)):m.exported=null),this.expectContextual("from"),this.type!==ne.string&&this.unexpected(),m.source=this.parseExprAtom(),this.semicolon(),this.finishNode(m,"ExportAllDeclaration");if(this.eat(ne._default)){var U;if(this.checkExport(E,"default",this.lastTokStart),this.type===ne._function||(U=this.isAsyncFunction())){var O=this.startNode();this.next(),U&&this.next(),m.declaration=this.parseFunction(O,4|Cr,!1,U)}else if(this.type===ne._class){var pe=this.startNode();m.declaration=this.parseClass(pe,"nullableID")}else m.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(m,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())m.declaration=this.parseStatement(null),"VariableDeclaration"===m.declaration.type?this.checkVariableExport(E,m.declaration.declarations):this.checkExport(E,m.declaration.id.name,m.declaration.id.start),m.specifiers=[],m.source=null;else{if(m.declaration=null,m.specifiers=this.parseExportSpecifiers(E),this.eatContextual("from"))this.type!==ne.string&&this.unexpected(),m.source=this.parseExprAtom();else{for(var De=0,ft=m.specifiers;De<ft.length;De+=1){var Rt=ft[De];this.checkUnreserved(Rt.local),this.checkLocalExport(Rt.local)}m.source=null}this.semicolon()}return this.finishNode(m,"ExportNamedDeclaration")},Ue.checkExport=function(m,E,U){!m||(Dr(m,E)&&this.raiseRecoverable(U,"Duplicate export '"+E+"'"),m[E]=!0)},Ue.checkPatternExport=function(m,E){var U=E.type;if("Identifier"===U)this.checkExport(m,E.name,E.start);else if("ObjectPattern"===U)for(var O=0,pe=E.properties;O<pe.length;O+=1)this.checkPatternExport(m,pe[O]);else if("ArrayPattern"===U)for(var ft=0,Rt=E.elements;ft<Rt.length;ft+=1){var kt=Rt[ft];kt&&this.checkPatternExport(m,kt)}else"Property"===U?this.checkPatternExport(m,E.value):"AssignmentPattern"===U?this.checkPatternExport(m,E.left):"RestElement"===U?this.checkPatternExport(m,E.argument):"ParenthesizedExpression"===U&&this.checkPatternExport(m,E.expression)},Ue.checkVariableExport=function(m,E){if(m)for(var U=0,O=E;U<O.length;U+=1)this.checkPatternExport(m,O[U].id)},Ue.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},Ue.parseExportSpecifiers=function(m){var E=[],U=!0;for(this.expect(ne.braceL);!this.eat(ne.braceR);){if(U)U=!1;else if(this.expect(ne.comma),this.afterTrailingComma(ne.braceR))break;var O=this.startNode();O.local=this.parseIdent(!0),O.exported=this.eatContextual("as")?this.parseIdent(!0):O.local,this.checkExport(m,O.exported.name,O.exported.start),E.push(this.finishNode(O,"ExportSpecifier"))}return E},Ue.parseImport=function(m){return this.next(),this.type===ne.string?(m.specifiers=Xt,m.source=this.parseExprAtom()):(m.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),m.source=this.type===ne.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(m,"ImportDeclaration")},Ue.parseImportSpecifiers=function(){var m=[],E=!0;if(this.type===ne.name){var U=this.startNode();if(U.local=this.parseIdent(),this.checkLVal(U.local,2),m.push(this.finishNode(U,"ImportDefaultSpecifier")),!this.eat(ne.comma))return m}if(this.type===ne.star){var O=this.startNode();return this.next(),this.expectContextual("as"),O.local=this.parseIdent(),this.checkLVal(O.local,2),m.push(this.finishNode(O,"ImportNamespaceSpecifier")),m}for(this.expect(ne.braceL);!this.eat(ne.braceR);){if(E)E=!1;else if(this.expect(ne.comma),this.afterTrailingComma(ne.braceR))break;var pe=this.startNode();pe.imported=this.parseIdent(!0),this.eatContextual("as")?pe.local=this.parseIdent():(this.checkUnreserved(pe.imported),pe.local=pe.imported),this.checkLVal(pe.local,2),m.push(this.finishNode(pe,"ImportSpecifier"))}return m},Ue.adaptDirectivePrologue=function(m){for(var E=0;E<m.length&&this.isDirectiveCandidate(m[E]);++E)m[E].directive=m[E].expression.raw.slice(1,-1)},Ue.isDirectiveCandidate=function(m){return"ExpressionStatement"===m.type&&"Literal"===m.expression.type&&"string"==typeof m.expression.value&&('"'===this.input[m.start]||"'"===this.input[m.start])};var mr=Ve.prototype;mr.toAssignable=function(m,E,U){if(this.options.ecmaVersion>=6&&m)switch(m.type){case"Identifier":this.inAsync&&"await"===m.name&&this.raise(m.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":m.type="ObjectPattern",U&&this.checkPatternErrors(U,!0);for(var O=0,pe=m.properties;O<pe.length;O+=1){var De=pe[O];this.toAssignable(De,E),"RestElement"===De.type&&("ArrayPattern"===De.argument.type||"ObjectPattern"===De.argument.type)&&this.raise(De.argument.start,"Unexpected token")}break;case"Property":"init"!==m.kind&&this.raise(m.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(m.value,E);break;case"ArrayExpression":m.type="ArrayPattern",U&&this.checkPatternErrors(U,!0),this.toAssignableList(m.elements,E);break;case"SpreadElement":m.type="RestElement",this.toAssignable(m.argument,E),"AssignmentPattern"===m.argument.type&&this.raise(m.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==m.operator&&this.raise(m.left.end,"Only '=' operator can be used for specifying default value."),m.type="AssignmentPattern",delete m.operator,this.toAssignable(m.left,E);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(m.expression,E,U);break;case"ChainExpression":this.raiseRecoverable(m.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!E)break;default:this.raise(m.start,"Assigning to rvalue")}else U&&this.checkPatternErrors(U,!0);return m},mr.toAssignableList=function(m,E){for(var U=m.length,O=0;O<U;O++){var pe=m[O];pe&&this.toAssignable(pe,E)}if(U){var De=m[U-1];6===this.options.ecmaVersion&&E&&De&&"RestElement"===De.type&&"Identifier"!==De.argument.type&&this.unexpected(De.argument.start)}return m},mr.parseSpread=function(m){var E=this.startNode();return this.next(),E.argument=this.parseMaybeAssign(!1,m),this.finishNode(E,"SpreadElement")},mr.parseRestBinding=function(){var m=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==ne.name&&this.unexpected(),m.argument=this.parseBindingAtom(),this.finishNode(m,"RestElement")},mr.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case ne.bracketL:var m=this.startNode();return this.next(),m.elements=this.parseBindingList(ne.bracketR,!0,!0),this.finishNode(m,"ArrayPattern");case ne.braceL:return this.parseObj(!0)}return this.parseIdent()},mr.parseBindingList=function(m,E,U){for(var O=[],pe=!0;!this.eat(m);)if(pe?pe=!1:this.expect(ne.comma),E&&this.type===ne.comma)O.push(null);else{if(U&&this.afterTrailingComma(m))break;if(this.type===ne.ellipsis){var De=this.parseRestBinding();this.parseBindingListItem(De),O.push(De),this.type===ne.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(m);break}var ft=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(ft),O.push(ft)}return O},mr.parseBindingListItem=function(m){return m},mr.parseMaybeDefault=function(m,E,U){if(U=U||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(ne.eq))return U;var O=this.startNodeAt(m,E);return O.left=U,O.right=this.parseMaybeAssign(),this.finishNode(O,"AssignmentPattern")},mr.checkLVal=function(m,E,U){switch(void 0===E&&(E=0),m.type){case"Identifier":2===E&&"let"===m.name&&this.raiseRecoverable(m.start,"let is disallowed as a lexically bound name"),this.strict&&this.reservedWordsStrictBind.test(m.name)&&this.raiseRecoverable(m.start,(E?"Binding ":"Assigning to ")+m.name+" in strict mode"),U&&(Dr(U,m.name)&&this.raiseRecoverable(m.start,"Argument name clash"),U[m.name]=!0),0!==E&&5!==E&&this.declareName(m.name,E,m.start);break;case"ChainExpression":this.raiseRecoverable(m.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":E&&this.raiseRecoverable(m.start,"Binding member expression");break;case"ObjectPattern":for(var O=0,pe=m.properties;O<pe.length;O+=1)this.checkLVal(pe[O],E,U);break;case"Property":this.checkLVal(m.value,E,U);break;case"ArrayPattern":for(var ft=0,Rt=m.elements;ft<Rt.length;ft+=1){var kt=Rt[ft];kt&&this.checkLVal(kt,E,U)}break;case"AssignmentPattern":this.checkLVal(m.left,E,U);break;case"RestElement":this.checkLVal(m.argument,E,U);break;case"ParenthesizedExpression":this.checkLVal(m.expression,E,U);break;default:this.raise(m.start,(E?"Binding":"Assigning to")+" rvalue")}};var er=Ve.prototype;er.checkPropClash=function(m,E,U){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===m.type||this.options.ecmaVersion>=6&&(m.computed||m.method||m.shorthand))){var pe,O=m.key;switch(O.type){case"Identifier":pe=O.name;break;case"Literal":pe=String(O.value);break;default:return}var De=m.kind;if(this.options.ecmaVersion>=6)return void("__proto__"===pe&&"init"===De&&(E.proto&&(U?U.doubleProto<0&&(U.doubleProto=O.start):this.raiseRecoverable(O.start,"Redefinition of __proto__ property")),E.proto=!0));var ft=E[pe="$"+pe];ft?("init"===De?this.strict&&ft.init||ft.get||ft.set:ft.init||ft[De])&&this.raiseRecoverable(O.start,"Redefinition of property"):ft=E[pe]={init:!1,get:!1,set:!1},ft[De]=!0}},er.parseExpression=function(m,E){var U=this.start,O=this.startLoc,pe=this.parseMaybeAssign(m,E);if(this.type===ne.comma){var De=this.startNodeAt(U,O);for(De.expressions=[pe];this.eat(ne.comma);)De.expressions.push(this.parseMaybeAssign(m,E));return this.finishNode(De,"SequenceExpression")}return pe},er.parseMaybeAssign=function(m,E,U){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(m);this.exprAllowed=!1}var O=!1,pe=-1,De=-1;E?(pe=E.parenthesizedAssign,De=E.trailingComma,E.parenthesizedAssign=E.trailingComma=-1):(E=new B,O=!0);var ft=this.start,Rt=this.startLoc;(this.type===ne.parenL||this.type===ne.name)&&(this.potentialArrowAt=this.start);var kt=this.parseMaybeConditional(m,E);if(U&&(kt=U.call(this,kt,ft,Rt)),this.type.isAssign){var Ir=this.startNodeAt(ft,Rt);return Ir.operator=this.value,Ir.left=this.type===ne.eq?this.toAssignable(kt,!1,E):kt,O||(E.parenthesizedAssign=E.trailingComma=E.doubleProto=-1),E.shorthandAssign>=Ir.left.start&&(E.shorthandAssign=-1),this.checkLVal(kt),this.next(),Ir.right=this.parseMaybeAssign(m),this.finishNode(Ir,"AssignmentExpression")}return O&&this.checkExpressionErrors(E,!0),pe>-1&&(E.parenthesizedAssign=pe),De>-1&&(E.trailingComma=De),kt},er.parseMaybeConditional=function(m,E){var U=this.start,O=this.startLoc,pe=this.parseExprOps(m,E);if(this.checkExpressionErrors(E))return pe;if(this.eat(ne.question)){var De=this.startNodeAt(U,O);return De.test=pe,De.consequent=this.parseMaybeAssign(),this.expect(ne.colon),De.alternate=this.parseMaybeAssign(m),this.finishNode(De,"ConditionalExpression")}return pe},er.parseExprOps=function(m,E){var U=this.start,O=this.startLoc,pe=this.parseMaybeUnary(E,!1);return this.checkExpressionErrors(E)||pe.start===U&&"ArrowFunctionExpression"===pe.type?pe:this.parseExprOp(pe,U,O,-1,m)},er.parseExprOp=function(m,E,U,O,pe){var De=this.type.binop;if(null!=De&&(!pe||this.type!==ne._in)&&De>O){var ft=this.type===ne.logicalOR||this.type===ne.logicalAND,Rt=this.type===ne.coalesce;Rt&&(De=ne.logicalAND.binop);var kt=this.value;this.next();var Ir=this.start,Nr=this.startLoc,Jn=this.parseExprOp(this.parseMaybeUnary(null,!1),Ir,Nr,De,pe),bi=this.buildBinary(E,U,m,Jn,kt,ft||Rt);return(ft&&this.type===ne.coalesce||Rt&&(this.type===ne.logicalOR||this.type===ne.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(bi,E,U,O,pe)}return m},er.buildBinary=function(m,E,U,O,pe,De){var ft=this.startNodeAt(m,E);return ft.left=U,ft.operator=pe,ft.right=O,this.finishNode(ft,De?"LogicalExpression":"BinaryExpression")},er.parseMaybeUnary=function(m,E){var pe,U=this.start,O=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))pe=this.parseAwait(),E=!0;else if(this.type.prefix){var De=this.startNode(),ft=this.type===ne.incDec;De.operator=this.value,De.prefix=!0,this.next(),De.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(m,!0),ft?this.checkLVal(De.argument):this.strict&&"delete"===De.operator&&"Identifier"===De.argument.type?this.raiseRecoverable(De.start,"Deleting local variable in strict mode"):E=!0,pe=this.finishNode(De,ft?"UpdateExpression":"UnaryExpression")}else{if(pe=this.parseExprSubscripts(m),this.checkExpressionErrors(m))return pe;for(;this.type.postfix&&!this.canInsertSemicolon();){var Rt=this.startNodeAt(U,O);Rt.operator=this.value,Rt.prefix=!1,Rt.argument=pe,this.checkLVal(pe),this.next(),pe=this.finishNode(Rt,"UpdateExpression")}}return!E&&this.eat(ne.starstar)?this.buildBinary(U,O,pe,this.parseMaybeUnary(null,!1),"**",!1):pe},er.parseExprSubscripts=function(m){var E=this.start,U=this.startLoc,O=this.parseExprAtom(m);if("ArrowFunctionExpression"===O.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return O;var pe=this.parseSubscripts(O,E,U);return m&&"MemberExpression"===pe.type&&(m.parenthesizedAssign>=pe.start&&(m.parenthesizedAssign=-1),m.parenthesizedBind>=pe.start&&(m.parenthesizedBind=-1)),pe},er.parseSubscripts=function(m,E,U,O){for(var pe=this.options.ecmaVersion>=8&&"Identifier"===m.type&&"async"===m.name&&this.lastTokEnd===m.end&&!this.canInsertSemicolon()&&m.end-m.start==5&&this.potentialArrowAt===m.start,De=!1;;){var ft=this.parseSubscript(m,E,U,O,pe,De);if(ft.optional&&(De=!0),ft===m||"ArrowFunctionExpression"===ft.type){if(De){var Rt=this.startNodeAt(E,U);Rt.expression=ft,ft=this.finishNode(Rt,"ChainExpression")}return ft}m=ft}},er.parseSubscript=function(m,E,U,O,pe,De){var ft=this.options.ecmaVersion>=11,Rt=ft&&this.eat(ne.questionDot);O&&Rt&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var kt=this.eat(ne.bracketL);if(kt||Rt&&this.type!==ne.parenL&&this.type!==ne.backQuote||this.eat(ne.dot)){var Ir=this.startNodeAt(E,U);Ir.object=m,Ir.property=kt?this.parseExpression():this.parseIdent("never"!==this.options.allowReserved),Ir.computed=!!kt,kt&&this.expect(ne.bracketR),ft&&(Ir.optional=Rt),m=this.finishNode(Ir,"MemberExpression")}else if(!O&&this.eat(ne.parenL)){var Nr=new B,Jn=this.yieldPos,bi=this.awaitPos,pi=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var oa=this.parseExprList(ne.parenR,this.options.ecmaVersion>=8,!1,Nr);if(pe&&!Rt&&!this.canInsertSemicolon()&&this.eat(ne.arrow))return this.checkPatternErrors(Nr,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=Jn,this.awaitPos=bi,this.awaitIdentPos=pi,this.parseArrowExpression(this.startNodeAt(E,U),oa,!0);this.checkExpressionErrors(Nr,!0),this.yieldPos=Jn||this.yieldPos,this.awaitPos=bi||this.awaitPos,this.awaitIdentPos=pi||this.awaitIdentPos;var Ea=this.startNodeAt(E,U);Ea.callee=m,Ea.arguments=oa,ft&&(Ea.optional=Rt),m=this.finishNode(Ea,"CallExpression")}else if(this.type===ne.backQuote){(Rt||De)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var Na=this.startNodeAt(E,U);Na.tag=m,Na.quasi=this.parseTemplate({isTagged:!0}),m=this.finishNode(Na,"TaggedTemplateExpression")}return m},er.parseExprAtom=function(m){this.type===ne.slash&&this.readRegexp();var E,U=this.potentialArrowAt===this.start;switch(this.type){case ne._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),E=this.startNode(),this.next(),this.type===ne.parenL&&!this.allowDirectSuper&&this.raise(E.start,"super() call outside constructor of a subclass"),this.type!==ne.dot&&this.type!==ne.bracketL&&this.type!==ne.parenL&&this.unexpected(),this.finishNode(E,"Super");case ne._this:return E=this.startNode(),this.next(),this.finishNode(E,"ThisExpression");case ne.name:var O=this.start,pe=this.startLoc,De=this.containsEsc,ft=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!De&&"async"===ft.name&&!this.canInsertSemicolon()&&this.eat(ne._function))return this.parseFunction(this.startNodeAt(O,pe),0,!1,!0);if(U&&!this.canInsertSemicolon()){if(this.eat(ne.arrow))return this.parseArrowExpression(this.startNodeAt(O,pe),[ft],!1);if(this.options.ecmaVersion>=8&&"async"===ft.name&&this.type===ne.name&&!De)return ft=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(ne.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(O,pe),[ft],!0)}return ft;case ne.regexp:var Rt=this.value;return(E=this.parseLiteral(Rt.value)).regex={pattern:Rt.pattern,flags:Rt.flags},E;case ne.num:case ne.string:return this.parseLiteral(this.value);case ne._null:case ne._true:case ne._false:return(E=this.startNode()).value=this.type===ne._null?null:this.type===ne._true,E.raw=this.type.keyword,this.next(),this.finishNode(E,"Literal");case ne.parenL:var kt=this.start,Ir=this.parseParenAndDistinguishExpression(U);return m&&(m.parenthesizedAssign<0&&!this.isSimpleAssignTarget(Ir)&&(m.parenthesizedAssign=kt),m.parenthesizedBind<0&&(m.parenthesizedBind=kt)),Ir;case ne.bracketL:return E=this.startNode(),this.next(),E.elements=this.parseExprList(ne.bracketR,!0,!0,m),this.finishNode(E,"ArrayExpression");case ne.braceL:return this.parseObj(!1,m);case ne._function:return E=this.startNode(),this.next(),this.parseFunction(E,0);case ne._class:return this.parseClass(this.startNode(),!1);case ne._new:return this.parseNew();case ne.backQuote:return this.parseTemplate();case ne._import:return this.options.ecmaVersion>=11?this.parseExprImport():this.unexpected();default:this.unexpected()}},er.parseExprImport=function(){var m=this.startNode();this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import");var E=this.parseIdent(!0);switch(this.type){case ne.parenL:return this.parseDynamicImport(m);case ne.dot:return m.meta=E,this.parseImportMeta(m);default:this.unexpected()}},er.parseDynamicImport=function(m){if(this.next(),m.source=this.parseMaybeAssign(),!this.eat(ne.parenR)){var E=this.start;this.eat(ne.comma)&&this.eat(ne.parenR)?this.raiseRecoverable(E,"Trailing comma is not allowed in import()"):this.unexpected(E)}return this.finishNode(m,"ImportExpression")},er.parseImportMeta=function(m){this.next();var E=this.containsEsc;return m.property=this.parseIdent(!0),"meta"!==m.property.name&&this.raiseRecoverable(m.property.start,"The only valid meta property for import is 'import.meta'"),E&&this.raiseRecoverable(m.start,"'import.meta' must not contain escaped characters"),"module"!==this.options.sourceType&&this.raiseRecoverable(m.start,"Cannot use 'import.meta' outside a module"),this.finishNode(m,"MetaProperty")},er.parseLiteral=function(m){var E=this.startNode();return E.value=m,E.raw=this.input.slice(this.start,this.end),110===E.raw.charCodeAt(E.raw.length-1)&&(E.bigint=E.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(E,"Literal")},er.parseParenExpression=function(){this.expect(ne.parenL);var m=this.parseExpression();return this.expect(ne.parenR),m},er.parseParenAndDistinguishExpression=function(m){var O,E=this.start,U=this.startLoc,pe=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var pi,De=this.start,ft=this.startLoc,Rt=[],kt=!0,Ir=!1,Nr=new B,Jn=this.yieldPos,bi=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==ne.parenR;){if(kt?kt=!1:this.expect(ne.comma),pe&&this.afterTrailingComma(ne.parenR,!0)){Ir=!0;break}if(this.type===ne.ellipsis){pi=this.start,Rt.push(this.parseParenItem(this.parseRestBinding())),this.type===ne.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}Rt.push(this.parseMaybeAssign(!1,Nr,this.parseParenItem))}var oa=this.start,Ea=this.startLoc;if(this.expect(ne.parenR),m&&!this.canInsertSemicolon()&&this.eat(ne.arrow))return this.checkPatternErrors(Nr,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=Jn,this.awaitPos=bi,this.parseParenArrowList(E,U,Rt);(!Rt.length||Ir)&&this.unexpected(this.lastTokStart),pi&&this.unexpected(pi),this.checkExpressionErrors(Nr,!0),this.yieldPos=Jn||this.yieldPos,this.awaitPos=bi||this.awaitPos,Rt.length>1?((O=this.startNodeAt(De,ft)).expressions=Rt,this.finishNodeAt(O,"SequenceExpression",oa,Ea)):O=Rt[0]}else O=this.parseParenExpression();if(this.options.preserveParens){var Na=this.startNodeAt(E,U);return Na.expression=O,this.finishNode(Na,"ParenthesizedExpression")}return O},er.parseParenItem=function(m){return m},er.parseParenArrowList=function(m,E,U){return this.parseArrowExpression(this.startNodeAt(m,E),U)};var pr=[];er.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var m=this.startNode(),E=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(ne.dot)){m.meta=E;var U=this.containsEsc;return m.property=this.parseIdent(!0),"target"!==m.property.name&&this.raiseRecoverable(m.property.start,"The only valid meta property for new is 'new.target'"),U&&this.raiseRecoverable(m.start,"'new.target' must not contain escaped characters"),this.inNonArrowFunction()||this.raiseRecoverable(m.start,"'new.target' can only be used in functions"),this.finishNode(m,"MetaProperty")}var O=this.start,pe=this.startLoc,De=this.type===ne._import;return m.callee=this.parseSubscripts(this.parseExprAtom(),O,pe,!0),De&&"ImportExpression"===m.callee.type&&this.raise(O,"Cannot use new with import()"),m.arguments=this.eat(ne.parenL)?this.parseExprList(ne.parenR,this.options.ecmaVersion>=8,!1):pr,this.finishNode(m,"NewExpression")},er.parseTemplateElement=function(m){var E=m.isTagged,U=this.startNode();return this.type===ne.invalidTemplate?(E||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),U.value={raw:this.value,cooked:null}):U.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),U.tail=this.type===ne.backQuote,this.finishNode(U,"TemplateElement")},er.parseTemplate=function(m){void 0===m&&(m={});var E=m.isTagged;void 0===E&&(E=!1);var U=this.startNode();this.next(),U.expressions=[];var O=this.parseTemplateElement({isTagged:E});for(U.quasis=[O];!O.tail;)this.type===ne.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(ne.dollarBraceL),U.expressions.push(this.parseExpression()),this.expect(ne.braceR),U.quasis.push(O=this.parseTemplateElement({isTagged:E}));return this.next(),this.finishNode(U,"TemplateLiteral")},er.isAsyncProp=function(m){return!m.computed&&"Identifier"===m.key.type&&"async"===m.key.name&&(this.type===ne.name||this.type===ne.num||this.type===ne.string||this.type===ne.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===ne.star)&&!nr.test(this.input.slice(this.lastTokEnd,this.start))},er.parseObj=function(m,E){var U=this.startNode(),O=!0,pe={};for(U.properties=[],this.next();!this.eat(ne.braceR);){if(O)O=!1;else if(this.expect(ne.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(ne.braceR))break;var De=this.parseProperty(m,E);m||this.checkPropClash(De,pe,E),U.properties.push(De)}return this.finishNode(U,m?"ObjectPattern":"ObjectExpression")},er.parseProperty=function(m,E){var O,pe,De,ft,U=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(ne.ellipsis))return m?(U.argument=this.parseIdent(!1),this.type===ne.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(U,"RestElement")):(this.type===ne.parenL&&E&&(E.parenthesizedAssign<0&&(E.parenthesizedAssign=this.start),E.parenthesizedBind<0&&(E.parenthesizedBind=this.start)),U.argument=this.parseMaybeAssign(!1,E),this.type===ne.comma&&E&&E.trailingComma<0&&(E.trailingComma=this.start),this.finishNode(U,"SpreadElement"));this.options.ecmaVersion>=6&&(U.method=!1,U.shorthand=!1,(m||E)&&(De=this.start,ft=this.startLoc),m||(O=this.eat(ne.star)));var Rt=this.containsEsc;return this.parsePropertyName(U),!m&&!Rt&&this.options.ecmaVersion>=8&&!O&&this.isAsyncProp(U)?(pe=!0,O=this.options.ecmaVersion>=9&&this.eat(ne.star),this.parsePropertyName(U,E)):pe=!1,this.parsePropertyValue(U,m,O,pe,De,ft,E,Rt),this.finishNode(U,"Property")},er.parsePropertyValue=function(m,E,U,O,pe,De,ft,Rt){if((U||O)&&this.type===ne.colon&&this.unexpected(),this.eat(ne.colon))m.value=E?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,ft),m.kind="init";else if(this.options.ecmaVersion>=6&&this.type===ne.parenL)E&&this.unexpected(),m.kind="init",m.method=!0,m.value=this.parseMethod(U,O);else if(E||Rt||!(this.options.ecmaVersion>=5)||m.computed||"Identifier"!==m.key.type||"get"!==m.key.name&&"set"!==m.key.name||this.type===ne.comma||this.type===ne.braceR||this.type===ne.eq)this.options.ecmaVersion>=6&&!m.computed&&"Identifier"===m.key.type?((U||O)&&this.unexpected(),this.checkUnreserved(m.key),"await"===m.key.name&&!this.awaitIdentPos&&(this.awaitIdentPos=pe),m.kind="init",E?m.value=this.parseMaybeDefault(pe,De,m.key):this.type===ne.eq&&ft?(ft.shorthandAssign<0&&(ft.shorthandAssign=this.start),m.value=this.parseMaybeDefault(pe,De,m.key)):m.value=m.key,m.shorthand=!0):this.unexpected();else{if((U||O)&&this.unexpected(),m.kind=m.key.name,this.parsePropertyName(m),m.value=this.parseMethod(!1),m.value.params.length!==("get"===m.kind?0:1))this.raiseRecoverable(m.value.start,"get"===m.kind?"getter should have no params":"setter should have exactly one param");else"set"===m.kind&&"RestElement"===m.value.params[0].type&&this.raiseRecoverable(m.value.params[0].start,"Setter cannot use rest params")}},er.parsePropertyName=function(m){if(this.options.ecmaVersion>=6){if(this.eat(ne.bracketL))return m.computed=!0,m.key=this.parseMaybeAssign(),this.expect(ne.bracketR),m.key;m.computed=!1}return m.key=this.type===ne.num||this.type===ne.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},er.initFunction=function(m){m.id=null,this.options.ecmaVersion>=6&&(m.generator=m.expression=!1),this.options.ecmaVersion>=8&&(m.async=!1)},er.parseMethod=function(m,E,U){var O=this.startNode(),pe=this.yieldPos,De=this.awaitPos,ft=this.awaitIdentPos;return this.initFunction(O),this.options.ecmaVersion>=6&&(O.generator=m),this.options.ecmaVersion>=8&&(O.async=!!E),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|Ar(E,O.generator)|(U?128:0)),this.expect(ne.parenL),O.params=this.parseBindingList(ne.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(O,!1,!0),this.yieldPos=pe,this.awaitPos=De,this.awaitIdentPos=ft,this.finishNode(O,"FunctionExpression")},er.parseArrowExpression=function(m,E,U){var O=this.yieldPos,pe=this.awaitPos,De=this.awaitIdentPos;return this.enterScope(16|Ar(U,!1)),this.initFunction(m),this.options.ecmaVersion>=8&&(m.async=!!U),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,m.params=this.toAssignableList(E,!0),this.parseFunctionBody(m,!0,!1),this.yieldPos=O,this.awaitPos=pe,this.awaitIdentPos=De,this.finishNode(m,"ArrowFunctionExpression")},er.parseFunctionBody=function(m,E,U){var pe=this.strict,De=!1;if(E&&this.type!==ne.braceL)m.body=this.parseMaybeAssign(),m.expression=!0,this.checkParams(m,!1);else{var ft=this.options.ecmaVersion>=7&&!this.isSimpleParamList(m.params);(!pe||ft)&&(De=this.strictDirective(this.end))&&ft&&this.raiseRecoverable(m.start,"Illegal 'use strict' directive in function with non-simple parameter list");var Rt=this.labels;this.labels=[],De&&(this.strict=!0),this.checkParams(m,!pe&&!De&&!E&&!U&&this.isSimpleParamList(m.params)),this.strict&&m.id&&this.checkLVal(m.id,5),m.body=this.parseBlock(!1,void 0,De&&!pe),m.expression=!1,this.adaptDirectivePrologue(m.body.body),this.labels=Rt}this.exitScope()},er.isSimpleParamList=function(m){for(var E=0,U=m;E<U.length;E+=1)if("Identifier"!==U[E].type)return!1;return!0},er.checkParams=function(m,E){for(var U={},O=0,pe=m.params;O<pe.length;O+=1)this.checkLVal(pe[O],1,E?null:U)},er.parseExprList=function(m,E,U,O){for(var pe=[],De=!0;!this.eat(m);){if(De)De=!1;else if(this.expect(ne.comma),E&&this.afterTrailingComma(m))break;var ft=void 0;U&&this.type===ne.comma?ft=null:this.type===ne.ellipsis?(ft=this.parseSpread(O),O&&this.type===ne.comma&&O.trailingComma<0&&(O.trailingComma=this.start)):ft=this.parseMaybeAssign(!1,O),pe.push(ft)}return pe},er.checkUnreserved=function(m){var E=m.start,U=m.end,O=m.name;this.inGenerator&&"yield"===O&&this.raiseRecoverable(E,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===O&&this.raiseRecoverable(E,"Cannot use 'await' as identifier inside an async function"),this.keywords.test(O)&&this.raise(E,"Unexpected keyword '"+O+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(E,U).indexOf("\\")||(this.strict?this.reservedWordsStrict:this.reservedWords).test(O)&&(!this.inAsync&&"await"===O&&this.raiseRecoverable(E,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(E,"The keyword '"+O+"' is reserved"))},er.parseIdent=function(m,E){var U=this.startNode();return this.type===ne.name?U.name=this.value:this.type.keyword?(U.name=this.type.keyword,("class"===U.name||"function"===U.name)&&(this.lastTokEnd!==this.lastTokStart+1||46!==this.input.charCodeAt(this.lastTokStart))&&this.context.pop()):this.unexpected(),this.next(!!m),this.finishNode(U,"Identifier"),m||(this.checkUnreserved(U),"await"===U.name&&!this.awaitIdentPos&&(this.awaitIdentPos=U.start)),U},er.parseYield=function(m){this.yieldPos||(this.yieldPos=this.start);var E=this.startNode();return this.next(),this.type===ne.semi||this.canInsertSemicolon()||this.type!==ne.star&&!this.type.startsExpr?(E.delegate=!1,E.argument=null):(E.delegate=this.eat(ne.star),E.argument=this.parseMaybeAssign(m)),this.finishNode(E,"YieldExpression")},er.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var m=this.startNode();return this.next(),m.argument=this.parseMaybeUnary(null,!1),this.finishNode(m,"AwaitExpression")};var Ln=Ve.prototype;Ln.raise=function(m,E){var U=Pe(this.input,m),O=new SyntaxError(E+=" ("+U.line+":"+U.column+")");throw O.pos=m,O.loc=U,O.raisedAt=this.pos,O},Ln.raiseRecoverable=Ln.raise,Ln.curPosition=function(){if(this.options.locations)return new ae(this.curLine,this.pos-this.lineStart)};var Wn=Ve.prototype,mi=function(E){this.flags=E,this.var=[],this.lexical=[],this.functions=[]};Wn.enterScope=function(m){this.scopeStack.push(new mi(m))},Wn.exitScope=function(){this.scopeStack.pop()},Wn.treatFunctionsAsVarInScope=function(m){return 2&m.flags||!this.inModule&&1&m.flags},Wn.declareName=function(m,E,U){var O=!1;if(2===E){var pe=this.currentScope();O=pe.lexical.indexOf(m)>-1||pe.functions.indexOf(m)>-1||pe.var.indexOf(m)>-1,pe.lexical.push(m),this.inModule&&1&pe.flags&&delete this.undefinedExports[m]}else if(4===E)this.currentScope().lexical.push(m);else if(3===E){var ft=this.currentScope();O=this.treatFunctionsAsVar?ft.lexical.indexOf(m)>-1:ft.lexical.indexOf(m)>-1||ft.var.indexOf(m)>-1,ft.functions.push(m)}else for(var Rt=this.scopeStack.length-1;Rt>=0;--Rt){var kt=this.scopeStack[Rt];if(kt.lexical.indexOf(m)>-1&&!(32&kt.flags&&kt.lexical[0]===m)||!this.treatFunctionsAsVarInScope(kt)&&kt.functions.indexOf(m)>-1){O=!0;break}if(kt.var.push(m),this.inModule&&1&kt.flags&&delete this.undefinedExports[m],3&kt.flags)break}O&&this.raiseRecoverable(U,"Identifier '"+m+"' has already been declared")},Wn.checkLocalExport=function(m){-1===this.scopeStack[0].lexical.indexOf(m.name)&&-1===this.scopeStack[0].var.indexOf(m.name)&&(this.undefinedExports[m.name]=m)},Wn.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},Wn.currentVarScope=function(){for(var m=this.scopeStack.length-1;;m--){var E=this.scopeStack[m];if(3&E.flags)return E}},Wn.currentThisScope=function(){for(var m=this.scopeStack.length-1;;m--){var E=this.scopeStack[m];if(3&E.flags&&!(16&E.flags))return E}};var hi=function(E,U,O){this.type="",this.start=U,this.end=0,E.options.locations&&(this.loc=new de(E,O)),E.options.directSourceFile&&(this.sourceFile=E.options.directSourceFile),E.options.ranges&&(this.range=[U,0])},si=Ve.prototype;function ai(m,E,U,O){return m.type=E,m.end=U,this.options.locations&&(m.loc.end=O),this.options.ranges&&(m.range[1]=U),m}si.startNode=function(){return new hi(this,this.start,this.startLoc)},si.startNodeAt=function(m,E){return new hi(this,m,E)},si.finishNode=function(m,E){return ai.call(this,m,E,this.lastTokEnd,this.lastTokEndLoc)},si.finishNodeAt=function(m,E,U,O){return ai.call(this,m,E,U,O)};var Yi=function(E,U,O,pe,De){this.token=E,this.isExpr=!!U,this.preserveSpace=!!O,this.override=pe,this.generator=!!De},Pi={b_stat:new Yi("{",!1),b_expr:new Yi("{",!0),b_tmpl:new Yi("${",!1),p_stat:new Yi("(",!1),p_expr:new Yi("(",!0),q_tmpl:new Yi("`",!0,!0,function(m){return m.tryReadTemplateToken()}),f_stat:new Yi("function",!1),f_expr:new Yi("function",!0),f_expr_gen:new Yi("function",!0,!1,null,!0),f_gen:new Yi("function",!1,!1,null,!0)},Ei=Ve.prototype;Ei.initialContext=function(){return[Pi.b_stat]},Ei.braceIsBlock=function(m){var E=this.curContext();return E===Pi.f_expr||E===Pi.f_stat||(m!==ne.colon||E!==Pi.b_stat&&E!==Pi.b_expr?m===ne._return||m===ne.name&&this.exprAllowed?nr.test(this.input.slice(this.lastTokEnd,this.start)):m===ne._else||m===ne.semi||m===ne.eof||m===ne.parenR||m===ne.arrow||(m===ne.braceL?E===Pi.b_stat:m!==ne._var&&m!==ne._const&&m!==ne.name&&!this.exprAllowed):!E.isExpr)},Ei.inGeneratorContext=function(){for(var m=this.context.length-1;m>=1;m--){var E=this.context[m];if("function"===E.token)return E.generator}return!1},Ei.updateContext=function(m){var E,U=this.type;U.keyword&&m===ne.dot?this.exprAllowed=!1:(E=U.updateContext)?E.call(this,m):this.exprAllowed=U.beforeExpr},ne.parenR.updateContext=ne.braceR.updateContext=function(){if(1!==this.context.length){var m=this.context.pop();m===Pi.b_stat&&"function"===this.curContext().token&&(m=this.context.pop()),this.exprAllowed=!m.isExpr}else this.exprAllowed=!0},ne.braceL.updateContext=function(m){this.context.push(this.braceIsBlock(m)?Pi.b_stat:Pi.b_expr),this.exprAllowed=!0},ne.dollarBraceL.updateContext=function(){this.context.push(Pi.b_tmpl),this.exprAllowed=!0},ne.parenL.updateContext=function(m){this.context.push(m===ne._if||m===ne._for||m===ne._with||m===ne._while?Pi.p_stat:Pi.p_expr),this.exprAllowed=!0},ne.incDec.updateContext=function(){},ne._function.updateContext=ne._class.updateContext=function(m){!m.beforeExpr||m===ne.semi||m===ne._else||m===ne._return&&nr.test(this.input.slice(this.lastTokEnd,this.start))||(m===ne.colon||m===ne.braceL)&&this.curContext()===Pi.b_stat?this.context.push(Pi.f_stat):this.context.push(Pi.f_expr),this.exprAllowed=!1},ne.backQuote.updateContext=function(){this.curContext()===Pi.q_tmpl?this.context.pop():this.context.push(Pi.q_tmpl),this.exprAllowed=!1},ne.star.updateContext=function(m){if(m===ne._function){var E=this.context.length-1;this.context[E]=this.context[E]===Pi.f_expr?Pi.f_expr_gen:Pi.f_gen}this.exprAllowed=!0},ne.name.updateContext=function(m){var E=!1;this.options.ecmaVersion>=6&&m!==ne.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(E=!0),this.exprAllowed=E};var Q="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",F={9:Q,10:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic",11:"ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS Extended_Pictographic"},re="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",ye="Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Te={9:ye,10:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",11:"Adlam Adlm Ahom Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho"},mt={};function wr(m){var E=mt[m]={binary:ve(F[m]+" "+re),nonBinary:{General_Category:ve(re),Script:ve(Te[m])}};E.nonBinary.Script_Extensions=E.nonBinary.Script,E.nonBinary.gc=E.nonBinary.General_Category,E.nonBinary.sc=E.nonBinary.Script,E.nonBinary.scx=E.nonBinary.Script_Extensions}wr(9),wr(10),wr(11);var Vt=Ve.prototype,$t=function(E){this.parser=E,this.validFlags="gim"+(E.options.ecmaVersion>=6?"uy":"")+(E.options.ecmaVersion>=9?"s":""),this.unicodeProperties=mt[E.options.ecmaVersion>=11?11:E.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function Br(m){return m<=65535?String.fromCharCode(m):(m-=65536,String.fromCharCode(55296+(m>>10),56320+(1023&m)))}function On(m){return 36===m||m>=40&&m<=43||46===m||63===m||m>=91&&m<=94||m>=123&&m<=125}function xn(m){return m>=65&&m<=90||m>=97&&m<=122}function Di(m){return xn(m)||95===m}function gn(m){return Di(m)||Oi(m)}function Oi(m){return m>=48&&m<=57}function ta(m){return m>=48&&m<=57||m>=65&&m<=70||m>=97&&m<=102}function oi(m){return m>=65&&m<=70?m-65+10:m>=97&&m<=102?m-97+10:m-48}function Ji(m){return m>=48&&m<=55}$t.prototype.reset=function(E,U,O){var pe=-1!==O.indexOf("u");this.start=0|E,this.source=U+"",this.flags=O,this.switchU=pe&&this.parser.options.ecmaVersion>=6,this.switchN=pe&&this.parser.options.ecmaVersion>=9},$t.prototype.raise=function(E){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+E)},$t.prototype.at=function(E,U){void 0===U&&(U=!1);var O=this.source,pe=O.length;if(E>=pe)return-1;var De=O.charCodeAt(E);if(!U&&!this.switchU||De<=55295||De>=57344||E+1>=pe)return De;var ft=O.charCodeAt(E+1);return ft>=56320&&ft<=57343?(De<<10)+ft-56613888:De},$t.prototype.nextIndex=function(E,U){void 0===U&&(U=!1);var O=this.source,pe=O.length;if(E>=pe)return pe;var ft,De=O.charCodeAt(E);return!U&&!this.switchU||De<=55295||De>=57344||E+1>=pe||(ft=O.charCodeAt(E+1))<56320||ft>57343?E+1:E+2},$t.prototype.current=function(E){return void 0===E&&(E=!1),this.at(this.pos,E)},$t.prototype.lookahead=function(E){return void 0===E&&(E=!1),this.at(this.nextIndex(this.pos,E),E)},$t.prototype.advance=function(E){void 0===E&&(E=!1),this.pos=this.nextIndex(this.pos,E)},$t.prototype.eat=function(E,U){return void 0===U&&(U=!1),this.current(U)===E&&(this.advance(U),!0)},Vt.validateRegExpFlags=function(m){for(var E=m.validFlags,U=m.flags,O=0;O<U.length;O++){var pe=U.charAt(O);-1===E.indexOf(pe)&&this.raise(m.start,"Invalid regular expression flag"),U.indexOf(pe,O+1)>-1&&this.raise(m.start,"Duplicate regular expression flag")}},Vt.validateRegExpPattern=function(m){this.regexp_pattern(m),!m.switchN&&this.options.ecmaVersion>=9&&m.groupNames.length>0&&(m.switchN=!0,this.regexp_pattern(m))},Vt.regexp_pattern=function(m){m.pos=0,m.lastIntValue=0,m.lastStringValue="",m.lastAssertionIsQuantifiable=!1,m.numCapturingParens=0,m.maxBackReference=0,m.groupNames.length=0,m.backReferenceNames.length=0,this.regexp_disjunction(m),m.pos!==m.source.length&&(m.eat(41)&&m.raise("Unmatched ')'"),(m.eat(93)||m.eat(125))&&m.raise("Lone quantifier brackets")),m.maxBackReference>m.numCapturingParens&&m.raise("Invalid escape");for(var E=0,U=m.backReferenceNames;E<U.length;E+=1)-1===m.groupNames.indexOf(U[E])&&m.raise("Invalid named capture referenced")},Vt.regexp_disjunction=function(m){for(this.regexp_alternative(m);m.eat(124);)this.regexp_alternative(m);this.regexp_eatQuantifier(m,!0)&&m.raise("Nothing to repeat"),m.eat(123)&&m.raise("Lone quantifier brackets")},Vt.regexp_alternative=function(m){for(;m.pos<m.source.length&&this.regexp_eatTerm(m););},Vt.regexp_eatTerm=function(m){return this.regexp_eatAssertion(m)?(m.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(m)&&m.switchU&&m.raise("Invalid quantifier"),!0):!!(m.switchU?this.regexp_eatAtom(m):this.regexp_eatExtendedAtom(m))&&(this.regexp_eatQuantifier(m),!0)},Vt.regexp_eatAssertion=function(m){var E=m.pos;if(m.lastAssertionIsQuantifiable=!1,m.eat(94)||m.eat(36))return!0;if(m.eat(92)){if(m.eat(66)||m.eat(98))return!0;m.pos=E}if(m.eat(40)&&m.eat(63)){var U=!1;if(this.options.ecmaVersion>=9&&(U=m.eat(60)),m.eat(61)||m.eat(33))return this.regexp_disjunction(m),m.eat(41)||m.raise("Unterminated group"),m.lastAssertionIsQuantifiable=!U,!0}return m.pos=E,!1},Vt.regexp_eatQuantifier=function(m,E){return void 0===E&&(E=!1),!!this.regexp_eatQuantifierPrefix(m,E)&&(m.eat(63),!0)},Vt.regexp_eatQuantifierPrefix=function(m,E){return m.eat(42)||m.eat(43)||m.eat(63)||this.regexp_eatBracedQuantifier(m,E)},Vt.regexp_eatBracedQuantifier=function(m,E){var U=m.pos;if(m.eat(123)){var O=0,pe=-1;if(this.regexp_eatDecimalDigits(m)&&(O=m.lastIntValue,m.eat(44)&&this.regexp_eatDecimalDigits(m)&&(pe=m.lastIntValue),m.eat(125)))return-1!==pe&&pe<O&&!E&&m.raise("numbers out of order in {} quantifier"),!0;m.switchU&&!E&&m.raise("Incomplete quantifier"),m.pos=U}return!1},Vt.regexp_eatAtom=function(m){return this.regexp_eatPatternCharacters(m)||m.eat(46)||this.regexp_eatReverseSolidusAtomEscape(m)||this.regexp_eatCharacterClass(m)||this.regexp_eatUncapturingGroup(m)||this.regexp_eatCapturingGroup(m)},Vt.regexp_eatReverseSolidusAtomEscape=function(m){var E=m.pos;if(m.eat(92)){if(this.regexp_eatAtomEscape(m))return!0;m.pos=E}return!1},Vt.regexp_eatUncapturingGroup=function(m){var E=m.pos;if(m.eat(40)){if(m.eat(63)&&m.eat(58)){if(this.regexp_disjunction(m),m.eat(41))return!0;m.raise("Unterminated group")}m.pos=E}return!1},Vt.regexp_eatCapturingGroup=function(m){if(m.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(m):63===m.current()&&m.raise("Invalid group"),this.regexp_disjunction(m),m.eat(41))return m.numCapturingParens+=1,!0;m.raise("Unterminated group")}return!1},Vt.regexp_eatExtendedAtom=function(m){return m.eat(46)||this.regexp_eatReverseSolidusAtomEscape(m)||this.regexp_eatCharacterClass(m)||this.regexp_eatUncapturingGroup(m)||this.regexp_eatCapturingGroup(m)||this.regexp_eatInvalidBracedQuantifier(m)||this.regexp_eatExtendedPatternCharacter(m)},Vt.regexp_eatInvalidBracedQuantifier=function(m){return this.regexp_eatBracedQuantifier(m,!0)&&m.raise("Nothing to repeat"),!1},Vt.regexp_eatSyntaxCharacter=function(m){var E=m.current();return!!On(E)&&(m.lastIntValue=E,m.advance(),!0)},Vt.regexp_eatPatternCharacters=function(m){for(var E=m.pos,U=0;-1!==(U=m.current())&&!On(U);)m.advance();return m.pos!==E},Vt.regexp_eatExtendedPatternCharacter=function(m){var E=m.current();return!(-1===E||36===E||E>=40&&E<=43||46===E||63===E||91===E||94===E||124===E||(m.advance(),0))},Vt.regexp_groupSpecifier=function(m){if(m.eat(63)){if(this.regexp_eatGroupName(m))return-1!==m.groupNames.indexOf(m.lastStringValue)&&m.raise("Duplicate capture group name"),void m.groupNames.push(m.lastStringValue);m.raise("Invalid group")}},Vt.regexp_eatGroupName=function(m){if(m.lastStringValue="",m.eat(60)){if(this.regexp_eatRegExpIdentifierName(m)&&m.eat(62))return!0;m.raise("Invalid capture group name")}return!1},Vt.regexp_eatRegExpIdentifierName=function(m){if(m.lastStringValue="",this.regexp_eatRegExpIdentifierStart(m)){for(m.lastStringValue+=Br(m.lastIntValue);this.regexp_eatRegExpIdentifierPart(m);)m.lastStringValue+=Br(m.lastIntValue);return!0}return!1},Vt.regexp_eatRegExpIdentifierStart=function(m){var E=m.pos,U=this.options.ecmaVersion>=11,O=m.current(U);return m.advance(U),92===O&&this.regexp_eatRegExpUnicodeEscapeSequence(m,U)&&(O=m.lastIntValue),function(m){return Z(m,!0)||36===m||95===m}(O)?(m.lastIntValue=O,!0):(m.pos=E,!1)},Vt.regexp_eatRegExpIdentifierPart=function(m){var E=m.pos,U=this.options.ecmaVersion>=11,O=m.current(U);return m.advance(U),92===O&&this.regexp_eatRegExpUnicodeEscapeSequence(m,U)&&(O=m.lastIntValue),function(m){return tt(m,!0)||36===m||95===m||8204===m||8205===m}(O)?(m.lastIntValue=O,!0):(m.pos=E,!1)},Vt.regexp_eatAtomEscape=function(m){return!!(this.regexp_eatBackReference(m)||this.regexp_eatCharacterClassEscape(m)||this.regexp_eatCharacterEscape(m)||m.switchN&&this.regexp_eatKGroupName(m))||(m.switchU&&(99===m.current()&&m.raise("Invalid unicode escape"),m.raise("Invalid escape")),!1)},Vt.regexp_eatBackReference=function(m){var E=m.pos;if(this.regexp_eatDecimalEscape(m)){var U=m.lastIntValue;if(m.switchU)return U>m.maxBackReference&&(m.maxBackReference=U),!0;if(U<=m.numCapturingParens)return!0;m.pos=E}return!1},Vt.regexp_eatKGroupName=function(m){if(m.eat(107)){if(this.regexp_eatGroupName(m))return m.backReferenceNames.push(m.lastStringValue),!0;m.raise("Invalid named reference")}return!1},Vt.regexp_eatCharacterEscape=function(m){return this.regexp_eatControlEscape(m)||this.regexp_eatCControlLetter(m)||this.regexp_eatZero(m)||this.regexp_eatHexEscapeSequence(m)||this.regexp_eatRegExpUnicodeEscapeSequence(m,!1)||!m.switchU&&this.regexp_eatLegacyOctalEscapeSequence(m)||this.regexp_eatIdentityEscape(m)},Vt.regexp_eatCControlLetter=function(m){var E=m.pos;if(m.eat(99)){if(this.regexp_eatControlLetter(m))return!0;m.pos=E}return!1},Vt.regexp_eatZero=function(m){return 48===m.current()&&!Oi(m.lookahead())&&(m.lastIntValue=0,m.advance(),!0)},Vt.regexp_eatControlEscape=function(m){var E=m.current();return 116===E?(m.lastIntValue=9,m.advance(),!0):110===E?(m.lastIntValue=10,m.advance(),!0):118===E?(m.lastIntValue=11,m.advance(),!0):102===E?(m.lastIntValue=12,m.advance(),!0):114===E&&(m.lastIntValue=13,m.advance(),!0)},Vt.regexp_eatControlLetter=function(m){var E=m.current();return!!xn(E)&&(m.lastIntValue=E%32,m.advance(),!0)},Vt.regexp_eatRegExpUnicodeEscapeSequence=function(m,E){void 0===E&&(E=!1);var U=m.pos,O=E||m.switchU;if(m.eat(117)){if(this.regexp_eatFixedHexDigits(m,4)){var pe=m.lastIntValue;if(O&&pe>=55296&&pe<=56319){var De=m.pos;if(m.eat(92)&&m.eat(117)&&this.regexp_eatFixedHexDigits(m,4)){var ft=m.lastIntValue;if(ft>=56320&&ft<=57343)return m.lastIntValue=1024*(pe-55296)+(ft-56320)+65536,!0}m.pos=De,m.lastIntValue=pe}return!0}if(O&&m.eat(123)&&this.regexp_eatHexDigits(m)&&m.eat(125)&&function(m){return m>=0&&m<=1114111}(m.lastIntValue))return!0;O&&m.raise("Invalid unicode escape"),m.pos=U}return!1},Vt.regexp_eatIdentityEscape=function(m){if(m.switchU)return!!this.regexp_eatSyntaxCharacter(m)||!!m.eat(47)&&(m.lastIntValue=47,!0);var E=m.current();return!(99===E||m.switchN&&107===E||(m.lastIntValue=E,m.advance(),0))},Vt.regexp_eatDecimalEscape=function(m){m.lastIntValue=0;var E=m.current();if(E>=49&&E<=57){do{m.lastIntValue=10*m.lastIntValue+(E-48),m.advance()}while((E=m.current())>=48&&E<=57);return!0}return!1},Vt.regexp_eatCharacterClassEscape=function(m){var E=m.current();if(function(m){return 100===m||68===m||115===m||83===m||119===m||87===m}(E))return m.lastIntValue=-1,m.advance(),!0;if(m.switchU&&this.options.ecmaVersion>=9&&(80===E||112===E)){if(m.lastIntValue=-1,m.advance(),m.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(m)&&m.eat(125))return!0;m.raise("Invalid property name")}return!1},Vt.regexp_eatUnicodePropertyValueExpression=function(m){var E=m.pos;if(this.regexp_eatUnicodePropertyName(m)&&m.eat(61)){var U=m.lastStringValue;if(this.regexp_eatUnicodePropertyValue(m))return this.regexp_validateUnicodePropertyNameAndValue(m,U,m.lastStringValue),!0}return m.pos=E,!!this.regexp_eatLoneUnicodePropertyNameOrValue(m)&&(this.regexp_validateUnicodePropertyNameOrValue(m,m.lastStringValue),!0)},Vt.regexp_validateUnicodePropertyNameAndValue=function(m,E,U){Dr(m.unicodeProperties.nonBinary,E)||m.raise("Invalid property name"),m.unicodeProperties.nonBinary[E].test(U)||m.raise("Invalid property value")},Vt.regexp_validateUnicodePropertyNameOrValue=function(m,E){m.unicodeProperties.binary.test(E)||m.raise("Invalid property name")},Vt.regexp_eatUnicodePropertyName=function(m){var E=0;for(m.lastStringValue="";Di(E=m.current());)m.lastStringValue+=Br(E),m.advance();return""!==m.lastStringValue},Vt.regexp_eatUnicodePropertyValue=function(m){var E=0;for(m.lastStringValue="";gn(E=m.current());)m.lastStringValue+=Br(E),m.advance();return""!==m.lastStringValue},Vt.regexp_eatLoneUnicodePropertyNameOrValue=function(m){return this.regexp_eatUnicodePropertyValue(m)},Vt.regexp_eatCharacterClass=function(m){if(m.eat(91)){if(m.eat(94),this.regexp_classRanges(m),m.eat(93))return!0;m.raise("Unterminated character class")}return!1},Vt.regexp_classRanges=function(m){for(;this.regexp_eatClassAtom(m);){var E=m.lastIntValue;if(m.eat(45)&&this.regexp_eatClassAtom(m)){var U=m.lastIntValue;m.switchU&&(-1===E||-1===U)&&m.raise("Invalid character class"),-1!==E&&-1!==U&&E>U&&m.raise("Range out of order in character class")}}},Vt.regexp_eatClassAtom=function(m){var E=m.pos;if(m.eat(92)){if(this.regexp_eatClassEscape(m))return!0;if(m.switchU){var U=m.current();(99===U||Ji(U))&&m.raise("Invalid class escape"),m.raise("Invalid escape")}m.pos=E}var O=m.current();return 93!==O&&(m.lastIntValue=O,m.advance(),!0)},Vt.regexp_eatClassEscape=function(m){var E=m.pos;if(m.eat(98))return m.lastIntValue=8,!0;if(m.switchU&&m.eat(45))return m.lastIntValue=45,!0;if(!m.switchU&&m.eat(99)){if(this.regexp_eatClassControlLetter(m))return!0;m.pos=E}return this.regexp_eatCharacterClassEscape(m)||this.regexp_eatCharacterEscape(m)},Vt.regexp_eatClassControlLetter=function(m){var E=m.current();return!(!Oi(E)&&95!==E||(m.lastIntValue=E%32,m.advance(),0))},Vt.regexp_eatHexEscapeSequence=function(m){var E=m.pos;if(m.eat(120)){if(this.regexp_eatFixedHexDigits(m,2))return!0;m.switchU&&m.raise("Invalid escape"),m.pos=E}return!1},Vt.regexp_eatDecimalDigits=function(m){var E=m.pos,U=0;for(m.lastIntValue=0;Oi(U=m.current());)m.lastIntValue=10*m.lastIntValue+(U-48),m.advance();return m.pos!==E},Vt.regexp_eatHexDigits=function(m){var E=m.pos,U=0;for(m.lastIntValue=0;ta(U=m.current());)m.lastIntValue=16*m.lastIntValue+oi(U),m.advance();return m.pos!==E},Vt.regexp_eatLegacyOctalEscapeSequence=function(m){if(this.regexp_eatOctalDigit(m)){var E=m.lastIntValue;if(this.regexp_eatOctalDigit(m)){var U=m.lastIntValue;m.lastIntValue=E<=3&&this.regexp_eatOctalDigit(m)?64*E+8*U+m.lastIntValue:8*E+U}else m.lastIntValue=E;return!0}return!1},Vt.regexp_eatOctalDigit=function(m){var E=m.current();return Ji(E)?(m.lastIntValue=E-48,m.advance(),!0):(m.lastIntValue=0,!1)},Vt.regexp_eatFixedHexDigits=function(m,E){var U=m.pos;m.lastIntValue=0;for(var O=0;O<E;++O){var pe=m.current();if(!ta(pe))return m.pos=U,!1;m.lastIntValue=16*m.lastIntValue+oi(pe),m.advance()}return!0};var ji=function(E){this.type=E.type,this.value=E.value,this.start=E.start,this.end=E.end,E.options.locations&&(this.loc=new de(E,E.startLoc,E.endLoc)),E.options.ranges&&(this.range=[E.start,E.end])},Ti=Ve.prototype;function Ma(m){return"function"!=typeof BigInt?null:BigInt(m.replace(/_/g,""))}function Gi(m){return m<=65535?String.fromCharCode(m):(m-=65536,String.fromCharCode(55296+(m>>10),56320+(1023&m)))}Ti.next=function(m){!m&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new ji(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Ti.getToken=function(){return this.next(),new ji(this)},"undefined"!=typeof Symbol&&(Ti[Symbol.iterator]=function(){var m=this;return{next:function(){var E=m.getToken();return{done:E.type===ne.eof,value:E}}}}),Ti.curContext=function(){return this.context[this.context.length-1]},Ti.nextToken=function(){var m=this.curContext();return(!m||!m.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(ne.eof):m.override?m.override(this):void this.readToken(this.fullCharCodeAtPos())},Ti.readToken=function(m){return Z(m,this.options.ecmaVersion>=6)||92===m?this.readWord():this.getTokenFromCode(m)},Ti.fullCharCodeAtPos=function(){var m=this.input.charCodeAt(this.pos);return m<=55295||m>=57344?m:(m<<10)+this.input.charCodeAt(this.pos+1)-56613888},Ti.skipBlockComment=function(){var m=this.options.onComment&&this.curPosition(),E=this.pos,U=this.input.indexOf("*/",this.pos+=2);if(-1===U&&this.raise(this.pos-2,"Unterminated comment"),this.pos=U+2,this.options.locations){Tt.lastIndex=E;for(var O;(O=Tt.exec(this.input))&&O.index<this.pos;)++this.curLine,this.lineStart=O.index+O[0].length}this.options.onComment&&this.options.onComment(!0,this.input.slice(E+2,U),E,this.pos,m,this.curPosition())},Ti.skipLineComment=function(m){for(var E=this.pos,U=this.options.onComment&&this.curPosition(),O=this.input.charCodeAt(this.pos+=m);this.pos<this.input.length&&!$e(O);)O=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(E+m,this.pos),E,this.pos,U,this.curPosition())},Ti.skipSpace=function(){e:for(;this.pos<this.input.length;){var m=this.input.charCodeAt(this.pos);switch(m){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break e}break;default:if(!(m>8&&m<14||m>=5760&&Ct.test(String.fromCharCode(m))))break e;++this.pos}}},Ti.finishToken=function(m,E){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var U=this.type;this.type=m,this.value=E,this.updateContext(U)},Ti.readToken_dot=function(){var m=this.input.charCodeAt(this.pos+1);if(m>=48&&m<=57)return this.readNumber(!0);var E=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===m&&46===E?(this.pos+=3,this.finishToken(ne.ellipsis)):(++this.pos,this.finishToken(ne.dot))},Ti.readToken_slash=function(){var m=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===m?this.finishOp(ne.assign,2):this.finishOp(ne.slash,1)},Ti.readToken_mult_modulo_exp=function(m){var E=this.input.charCodeAt(this.pos+1),U=1,O=42===m?ne.star:ne.modulo;return this.options.ecmaVersion>=7&&42===m&&42===E&&(++U,O=ne.starstar,E=this.input.charCodeAt(this.pos+2)),61===E?this.finishOp(ne.assign,U+1):this.finishOp(O,U)},Ti.readToken_pipe_amp=function(m){var E=this.input.charCodeAt(this.pos+1);return E===m?this.options.ecmaVersion>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(ne.assign,3):this.finishOp(124===m?ne.logicalOR:ne.logicalAND,2):61===E?this.finishOp(ne.assign,2):this.finishOp(124===m?ne.bitwiseOR:ne.bitwiseAND,1)},Ti.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(ne.assign,2):this.finishOp(ne.bitwiseXOR,1)},Ti.readToken_plus_min=function(m){var E=this.input.charCodeAt(this.pos+1);return E===m?45!==E||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!nr.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(ne.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===E?this.finishOp(ne.assign,2):this.finishOp(ne.plusMin,1)},Ti.readToken_lt_gt=function(m){var E=this.input.charCodeAt(this.pos+1),U=1;return E===m?(U=62===m&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+U)?this.finishOp(ne.assign,U+1):this.finishOp(ne.bitShift,U)):33!==E||60!==m||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===E&&(U=2),this.finishOp(ne.relational,U)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},Ti.readToken_eq_excl=function(m){var E=this.input.charCodeAt(this.pos+1);return 61===E?this.finishOp(ne.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===m&&62===E&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(ne.arrow)):this.finishOp(61===m?ne.eq:ne.prefix,1)},Ti.readToken_question=function(){var m=this.options.ecmaVersion;if(m>=11){var E=this.input.charCodeAt(this.pos+1);if(46===E){var U=this.input.charCodeAt(this.pos+2);if(U<48||U>57)return this.finishOp(ne.questionDot,2)}if(63===E)return m>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(ne.assign,3):this.finishOp(ne.coalesce,2)}return this.finishOp(ne.question,1)},Ti.getTokenFromCode=function(m){switch(m){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(ne.parenL);case 41:return++this.pos,this.finishToken(ne.parenR);case 59:return++this.pos,this.finishToken(ne.semi);case 44:return++this.pos,this.finishToken(ne.comma);case 91:return++this.pos,this.finishToken(ne.bracketL);case 93:return++this.pos,this.finishToken(ne.bracketR);case 123:return++this.pos,this.finishToken(ne.braceL);case 125:return++this.pos,this.finishToken(ne.braceR);case 58:return++this.pos,this.finishToken(ne.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(ne.backQuote);case 48:var E=this.input.charCodeAt(this.pos+1);if(120===E||88===E)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===E||79===E)return this.readRadixNumber(8);if(98===E||66===E)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(m);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(m);case 124:case 38:return this.readToken_pipe_amp(m);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(m);case 60:case 62:return this.readToken_lt_gt(m);case 61:case 33:return this.readToken_eq_excl(m);case 63:return this.readToken_question();case 126:return this.finishOp(ne.prefix,1)}this.raise(this.pos,"Unexpected character '"+Gi(m)+"'")},Ti.finishOp=function(m,E){var U=this.input.slice(this.pos,this.pos+E);return this.pos+=E,this.finishToken(m,U)},Ti.readRegexp=function(){for(var m,E,U=this.pos;;){this.pos>=this.input.length&&this.raise(U,"Unterminated regular expression");var O=this.input.charAt(this.pos);if(nr.test(O)&&this.raise(U,"Unterminated regular expression"),m)m=!1;else{if("["===O)E=!0;else if("]"===O&&E)E=!1;else if("/"===O&&!E)break;m="\\"===O}++this.pos}var pe=this.input.slice(U,this.pos);++this.pos;var De=this.pos,ft=this.readWord1();this.containsEsc&&this.unexpected(De);var Rt=this.regexpState||(this.regexpState=new $t(this));Rt.reset(U,pe,ft),this.validateRegExpFlags(Rt),this.validateRegExpPattern(Rt);var kt=null;try{kt=new RegExp(pe,ft)}catch(Ir){}return this.finishToken(ne.regexp,{pattern:pe,flags:ft,value:kt})},Ti.readInt=function(m,E,U){for(var O=this.options.ecmaVersion>=12&&void 0===E,pe=U&&48===this.input.charCodeAt(this.pos),De=this.pos,ft=0,Rt=0,kt=0,Ir=null==E?1/0:E;kt<Ir;++kt,++this.pos){var Nr=this.input.charCodeAt(this.pos),Jn=void 0;if(O&&95===Nr)pe&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===Rt&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===kt&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),Rt=Nr;else{if((Jn=Nr>=97?Nr-97+10:Nr>=65?Nr-65+10:Nr>=48&&Nr<=57?Nr-48:1/0)>=m)break;Rt=Nr,ft=ft*m+Jn}}return O&&95===Rt&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===De||null!=E&&this.pos-De!==E?null:ft},Ti.readRadixNumber=function(m){var E=this.pos;this.pos+=2;var U=this.readInt(m);return null==U&&this.raise(this.start+2,"Expected number in radix "+m),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(U=Ma(this.input.slice(E,this.pos)),++this.pos):Z(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ne.num,U)},Ti.readNumber=function(m){var E=this.pos;!m&&null===this.readInt(10,void 0,!0)&&this.raise(E,"Invalid number");var U=this.pos-E>=2&&48===this.input.charCodeAt(E);U&&this.strict&&this.raise(E,"Invalid number");var O=this.input.charCodeAt(this.pos);if(!U&&!m&&this.options.ecmaVersion>=11&&110===O){var pe=Ma(this.input.slice(E,this.pos));return++this.pos,Z(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(ne.num,pe)}U&&/[89]/.test(this.input.slice(E,this.pos))&&(U=!1),46===O&&!U&&(++this.pos,this.readInt(10),O=this.input.charCodeAt(this.pos)),(69===O||101===O)&&!U&&((43===(O=this.input.charCodeAt(++this.pos))||45===O)&&++this.pos,null===this.readInt(10)&&this.raise(E,"Invalid number")),Z(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var De=function(m,E){return E?parseInt(m,8):parseFloat(m.replace(/_/g,""))}(this.input.slice(E,this.pos),U);return this.finishToken(ne.num,De)},Ti.readCodePoint=function(){var E;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var U=++this.pos;E=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,E>1114111&&this.invalidStringToken(U,"Code point out of bounds")}else E=this.readHexChar(4);return E},Ti.readString=function(m){for(var E="",U=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var O=this.input.charCodeAt(this.pos);if(O===m)break;92===O?(E+=this.input.slice(U,this.pos),E+=this.readEscapedChar(!1),U=this.pos):($e(O,this.options.ecmaVersion>=10)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return E+=this.input.slice(U,this.pos++),this.finishToken(ne.string,E)};var Bi={};function Wi(m,E){m.prototype=Object.create(E.prototype),m.prototype.constructor=m,m.__proto__=E}function va(m){var E="function"==typeof Map?new Map:void 0;return(va=function(O){if(null===O||!function(m){return-1!==Function.toString.call(m).indexOf("[native code]")}(O))return O;if("function"!=typeof O)throw new TypeError("Super expression must either be null or a function");if(void 0!==E){if(E.has(O))return E.get(O);E.set(O,pe)}function pe(){return Da(O,arguments,ra(this).constructor)}return pe.prototype=Object.create(O.prototype,{constructor:{value:pe,enumerable:!1,writable:!0,configurable:!0}}),Fi(pe,O)})(m)}function Su(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}function Da(m,E,U){return(Da=Su()?Reflect.construct:function(pe,De,ft){var Rt=[null];Rt.push.apply(Rt,De);var Ir=new(Function.bind.apply(pe,Rt));return ft&&Fi(Ir,ft.prototype),Ir}).apply(null,arguments)}function Fi(m,E){return(Fi=Object.setPrototypeOf||function(O,pe){return O.__proto__=pe,O})(m,E)}function ra(m){return(ra=Object.setPrototypeOf?Object.getPrototypeOf:function(U){return U.__proto__||Object.getPrototypeOf(U)})(m)}Ti.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(m){if(m!==Bi)throw m;this.readInvalidTemplateToken()}this.inTemplateElement=!1},Ti.invalidStringToken=function(m,E){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw Bi;this.raise(m,E)},Ti.readTmplToken=function(){for(var m="",E=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var U=this.input.charCodeAt(this.pos);if(96===U||36===U&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==ne.template&&this.type!==ne.invalidTemplate?(m+=this.input.slice(E,this.pos),this.finishToken(ne.template,m)):36===U?(this.pos+=2,this.finishToken(ne.dollarBraceL)):(++this.pos,this.finishToken(ne.backQuote));if(92===U)m+=this.input.slice(E,this.pos),m+=this.readEscapedChar(!0),E=this.pos;else if($e(U)){switch(m+=this.input.slice(E,this.pos),++this.pos,U){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:m+="\n";break;default:m+=String.fromCharCode(U)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),E=this.pos}else++this.pos}},Ti.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(ne.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},Ti.readEscapedChar=function(m){var E=this.input.charCodeAt(++this.pos);switch(++this.pos,E){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return Gi(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(m)return this.invalidStringToken(this.pos-1,"Invalid escape sequence in template string"),null;default:if(E>=48&&E<=55){var O=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],pe=parseInt(O,8);return pe>255&&(O=O.slice(0,-1),pe=parseInt(O,8)),this.pos+=O.length-1,E=this.input.charCodeAt(this.pos),("0"!==O||56===E||57===E)&&(this.strict||m)&&this.invalidStringToken(this.pos-1-O.length,m?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(pe)}return $e(E)?"":String.fromCharCode(E)}},Ti.readHexChar=function(m){var E=this.pos,U=this.readInt(16,m);return null===U&&this.invalidStringToken(E,"Bad character escape sequence"),U},Ti.readWord1=function(){this.containsEsc=!1;for(var m="",E=!0,U=this.pos,O=this.options.ecmaVersion>=6;this.pos<this.input.length;){var pe=this.fullCharCodeAtPos();if(tt(pe,O))this.pos+=pe<=65535?1:2;else{if(92!==pe)break;this.containsEsc=!0,m+=this.input.slice(U,this.pos);var De=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var ft=this.readCodePoint();(E?Z:tt)(ft,O)||this.invalidStringToken(De,"Invalid Unicode escape"),m+=Gi(ft),U=this.pos}E=!1}return m+this.input.slice(U,this.pos)},Ti.readWord=function(){var m=this.readWord1(),E=ne.name;return this.keywords.test(m)&&(E=Et[m]),this.finishToken(E,m)},Ve.acorn={Parser:Ve,version:"7.4.1",defaultOptions:ze,Position:ae,SourceLocation:de,getLineInfo:Pe,Node:hi,TokenType:Mt,tokTypes:ne,keywordTypes:Et,TokContext:Yi,tokContexts:Pi,isIdentifierChar:tt,isIdentifierStart:Z,Token:ji,isNewLine:$e,lineBreak:nr,lineBreakG:Tt,nonASCIIwhitespace:Ct};var bo=function(m){function E(){return m.apply(this,arguments)||this}return Wi(E,m),E}(va(Error)),ma=function(m){function E(){return m.apply(this,arguments)||this}return Wi(E,m),E}(va(SyntaxError)),vo=function(m){function E(){return m.apply(this,arguments)||this}return Wi(E,m),E}(va(ReferenceError)),No=function(m){function E(){return m.apply(this,arguments)||this}return Wi(E,m),E}(va(TypeError)),ks=function(m){function E(){return m.apply(this,arguments)||this}return Wi(E,m),E}(bo),aa=function(m){function E(){return m.apply(this,arguments)||this}return Wi(E,m),E}(ma),Jo=function(m){function E(){return m.apply(this,arguments)||this}return Wi(E,m),E}(vo),Ia={UnknownError:[3001,"%0",ks],ExecutionTimeOutError:[3002,"Script execution timed out after %0ms",ks],NodeTypeSyntaxError:[1001,"Unknown node type: %0",Jo],BinaryOperatorSyntaxError:[1002,"Unknown binary operator: %0",Jo],LogicalOperatorSyntaxError:[1003,"Unknown logical operator: %0",Jo],UnaryOperatorSyntaxError:[1004,"Unknown unary operator: %0",Jo],UpdateOperatorSyntaxError:[1005,"Unknown update operator: %0",Jo],ObjectStructureSyntaxError:[1006,"Unknown object structure: %0",Jo],AssignmentExpressionSyntaxError:[1007,"Unknown assignment expression: %0",Jo],VariableTypeSyntaxError:[1008,"Unknown variable type: %0",Jo],ParamTypeSyntaxError:[1009,"Unknown param type: %0",Jo],AssignmentTypeSyntaxError:[1010,"Unknown assignment type: %0",Jo],FunctionUndefinedReferenceError:[2001,"%0 is not a function",vo],VariableUndefinedReferenceError:[2002,"%0 is not defined",vo],IsNotConstructor:[2003,"%0 is not a constructor",No]};function Ya(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(m){return!1}}function $o(m,E,U){return($o=Ya()?Reflect.construct:function(pe,De,ft){var Rt=[null];Rt.push.apply(Rt,De);var Ir=new(Function.bind.apply(pe,Rt));return ft&&Ba(Ir,ft.prototype),Ir}).apply(null,arguments)}function Ba(m,E){return(Ba=Object.setPrototypeOf||function(O,pe){return O.__proto__=pe,O})(m,E)}function Fe(m,E){Object.defineProperty(m,"name",{value:E,writable:!1,enumerable:!1,configurable:!0})}var vt=Object.prototype.hasOwnProperty,Qt=Symbol("Break"),Yr=Symbol("Continue"),$n=Symbol("DefaultCase"),xi=Symbol("EmptyStatementReturn"),lo=Symbol("WithScopeName"),ro=Symbol("SuperScopeName"),co=Symbol("RootScopeName"),ps=Symbol("GlobalScopeName");function du(m){return"function"==typeof m}var Eu=function(){function m(U){this.interpreter=U}return m.prototype.generator=function(){var O=this.interpreter;return{getOptions:O.getOptions.bind(O),getCurrentScope:function(){return this.getCurrentScope()}.bind(O),getGlobalScope:function(){return this.getGlobalScope()}.bind(O),getCurrentContext:function(){return this.getCurrentContext()}.bind(O),getExecStartTime:O.getExecStartTime.bind(O)}},m}();function fl(m,E,U){if(void 0===U&&(U=!0),!(m instanceof Eu))throw new Error("Illegal call");if("string"!=typeof E)return E;if(E){var O=m.generator(),De={timeout:O.getOptions().timeout,_initEnv:function(){U||this.setCurrentContext(O.getCurrentContext()),this.execStartTime=O.getExecStartTime(),this.execEndTime=this.execStartTime}},ft=U?O.getGlobalScope():O.getCurrentScope();return new Lo(ft,De).evaluate(E)}}function Wo(m){if(!(m instanceof Eu))throw new Error("Illegal call");for(var E=m.generator(),U=arguments.length,O=new Array(U>1?U-1:0),pe=1;pe<U;pe++)O[pe-1]=arguments[pe];var De=O.pop(),ft=new Lo(E.getGlobalScope(),E.getOptions()),Rt="\n\t\t    (function anonymous("+O.join(",")+"){\n\t\t        "+De+"\n\t\t    });\n\t\t    ";return ft.evaluate(Rt)}Object.defineProperty(fl,"__IS_EVAL_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(Wo,"__IS_FUNCTION_FUNC",{value:!0,writable:!1,enumerable:!1,configurable:!1});var Qo=function(E){this.value=E},ko=function(E){this.value=E},es=function(E){this.value=E},ts=function(E,U,O){void 0===U&&(U=null),this.name=O,this.parent=U,this.data=E,this.labelStack=[]};function Ls(){}function Qs(m,E){return void 0===m&&(m=null),new ts(Object.create(null),m,E)}var Oa={NaN:NaN,Infinity:1/0,undefined:void 0,Object,Array,String,Boolean,Number,Date,RegExp,Error,URIError,TypeError,RangeError,SyntaxError,ReferenceError,Float32Array,Uint32Array,Math,parseInt,parseFloat,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,escape,unescape,eval:fl,Function:Wo};"undefined"!=typeof JSON&&(Oa.JSON=JSON),"undefined"!=typeof Promise&&(Oa.Promise=Promise),"undefined"!=typeof Set&&(Oa.Set=Set),"undefined"!=typeof Map&&(Oa.Map=Map),"undefined"!=typeof Symbol&&(Oa.Symbol=Symbol),"undefined"!=typeof Proxy&&(Oa.Proxy=Proxy),"undefined"!=typeof WeakMap&&(Oa.WeakMap=WeakMap),"undefined"!=typeof WeakSet&&(Oa.WeakSet=WeakSet),"undefined"!=typeof Reflect&&(Oa.Reflect=Reflect);var Lo=function(){function m(U,O){void 0===U&&(U=m.global),void 0===O&&(O={}),this.sourceList=[],this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.isVarDeclMode=!1,this.lastExecNode=null,this.isRunning=!1,this.options={ecmaVersion:O.ecmaVersion||m.ecmaVersion,timeout:O.timeout||0,rootContext:O.rootContext,globalContextInFunction:void 0===O.globalContextInFunction?m.globalContextInFunction:O.globalContextInFunction,_initEnv:O._initEnv},this.context=U||Object.create(null),this.callStack=[],this.initEnvironment(this.context)}var E=m.prototype;return E.initEnvironment=function(O){var pe;if(O instanceof ts)pe=O;else{var De=null,ft=this.createSuperScope(O);this.options.rootContext&&(De=new ts(function(m){return Object.create(m)}(this.options.rootContext),ft,co)),pe=new ts(O,De||ft,ps)}this.globalScope=pe,this.currentScope=this.globalScope,this.globalContext=pe.data,this.currentContext=pe.data,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null),this.execStartTime=Date.now(),this.execEndTime=this.execStartTime;var Rt=this.options._initEnv;Rt&&Rt.call(this)},E.getExecStartTime=function(){return this.execStartTime},E.getExecutionTime=function(){return this.execEndTime-this.execStartTime},E.setExecTimeout=function(O){void 0===O&&(O=0),this.options.timeout=O},E.getOptions=function(){return this.options},E.getGlobalScope=function(){return this.globalScope},E.getCurrentScope=function(){return this.currentScope},E.getCurrentContext=function(){return this.currentContext},E.isInterruptThrow=function(O){return O instanceof ks||O instanceof Jo||O instanceof aa},E.createSuperScope=function(O){var pe=Object.assign({},Oa);return Object.keys(pe).forEach(function(ft){ft in O&&delete pe[ft]}),new ts(pe,null,ro)},E.setCurrentContext=function(O){this.currentContext=O},E.setCurrentScope=function(O){this.currentScope=O},E.evaluate=function(O){var pe;if(void 0===O&&(O=""),O)return pe=function(m,E){return Ve.parse(m,E)}(O,{ranges:!0,locations:!0,ecmaVersion:this.options.ecmaVersion||m.ecmaVersion}),this.evaluateNode(pe,O)},E.appendCode=function(O){return this.evaluate(O)},E.evaluateNode=function(O,pe){void 0===pe&&(pe=""),this.value=void 0,this.source=pe,this.sourceList.push(pe),this.isRunning=!0,this.execStartTime=Date.now(),this.execEndTime=this.execStartTime,this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var ft=this.getCurrentScope(),Rt=this.getCurrentContext(),kt=ft.labelStack.concat([]),Ir=this.callStack.concat([]);try{var Jn=this.createClosure(O);this.addDeclarationsToScope(this.collectDeclVars,this.collectDeclFuncs,this.getCurrentScope()),Jn()}catch(bi){throw bi}finally{this.setCurrentScope(ft),this.setCurrentContext(Rt),ft.labelStack=kt,this.callStack=Ir,this.execEndTime=Date.now()}return this.isRunning=!1,this.getValue()},E.createErrorMessage=function(O,pe,De){var ft=O[1].replace("%0",String(pe));return null!==De&&(ft+=this.getNodePosition(De||this.lastExecNode)),ft},E.createError=function(O,pe){return new pe(O)},E.createThrowError=function(O,pe){return this.createError(O,pe)},E.createInternalThrowError=function(O,pe,De){return this.createError(this.createErrorMessage(O,pe,De),O[2])},E.checkTimeout=function(){if(!this.isRunning)return!1;var O=this.options.timeout||0;return Date.now()-this.execStartTime>O},E.getNodePosition=function(O){return O&&O.loc?" ["+O.loc.start.line+":"+O.loc.start.column+"]":""},E.createClosure=function(O){var De,pe=this;switch(O.type){case"BinaryExpression":De=this.binaryExpressionHandler(O);break;case"LogicalExpression":De=this.logicalExpressionHandler(O);break;case"UnaryExpression":De=this.unaryExpressionHandler(O);break;case"UpdateExpression":De=this.updateExpressionHandler(O);break;case"ObjectExpression":De=this.objectExpressionHandler(O);break;case"ArrayExpression":De=this.arrayExpressionHandler(O);break;case"CallExpression":De=this.callExpressionHandler(O);break;case"NewExpression":De=this.newExpressionHandler(O);break;case"MemberExpression":De=this.memberExpressionHandler(O);break;case"ThisExpression":De=this.thisExpressionHandler(O);break;case"SequenceExpression":De=this.sequenceExpressionHandler(O);break;case"Literal":De=this.literalHandler(O);break;case"Identifier":De=this.identifierHandler(O);break;case"AssignmentExpression":De=this.assignmentExpressionHandler(O);break;case"FunctionDeclaration":De=this.functionDeclarationHandler(O);break;case"VariableDeclaration":De=this.variableDeclarationHandler(O);break;case"BlockStatement":case"Program":De=this.programHandler(O);break;case"ExpressionStatement":De=this.expressionStatementHandler(O);break;case"EmptyStatement":De=this.emptyStatementHandler(O);break;case"ReturnStatement":De=this.returnStatementHandler(O);break;case"FunctionExpression":De=this.functionExpressionHandler(O);break;case"IfStatement":De=this.ifStatementHandler(O);break;case"ConditionalExpression":De=this.conditionalExpressionHandler(O);break;case"ForStatement":De=this.forStatementHandler(O);break;case"WhileStatement":De=this.whileStatementHandler(O);break;case"DoWhileStatement":De=this.doWhileStatementHandler(O);break;case"ForInStatement":De=this.forInStatementHandler(O);break;case"WithStatement":De=this.withStatementHandler(O);break;case"ThrowStatement":De=this.throwStatementHandler(O);break;case"TryStatement":De=this.tryStatementHandler(O);break;case"ContinueStatement":De=this.continueStatementHandler(O);break;case"BreakStatement":De=this.breakStatementHandler(O);break;case"SwitchStatement":De=this.switchStatementHandler(O);break;case"LabeledStatement":De=this.labeledStatementHandler(O);break;case"DebuggerStatement":De=this.debuggerStatementHandler(O);break;default:throw this.createInternalThrowError(Ia.NodeTypeSyntaxError,O.type,O)}return function(){var ft=pe.options.timeout;if(ft&&ft>0&&pe.checkTimeout())throw pe.createInternalThrowError(Ia.ExecutionTimeOutError,ft,null);return pe.lastExecNode=O,De.apply(void 0,arguments)}},E.binaryExpressionHandler=function(O){var pe=this,De=this.createClosure(O.left),ft=this.createClosure(O.right);return function(){var Rt=De(),kt=ft();switch(O.operator){case"==":return Rt==kt;case"!=":return Rt!=kt;case"===":return Rt===kt;case"!==":return Rt!==kt;case"<":return Rt<kt;case"<=":return Rt<=kt;case">":return Rt>kt;case">=":return Rt>=kt;case"<<":return Rt<<kt;case">>":return Rt>>kt;case">>>":return Rt>>>kt;case"+":return Rt+kt;case"-":return Rt-kt;case"*":return Rt*kt;case"**":return Math.pow(Rt,kt);case"/":return Rt/kt;case"%":return Rt%kt;case"|":return Rt|kt;case"^":return Rt^kt;case"&":return Rt&kt;case"in":return Rt in kt;case"instanceof":return Rt instanceof kt;default:throw pe.createInternalThrowError(Ia.BinaryOperatorSyntaxError,O.operator,O)}}},E.logicalExpressionHandler=function(O){var pe=this,De=this.createClosure(O.left),ft=this.createClosure(O.right);return function(){switch(O.operator){case"||":return De()||ft();case"&&":return De()&&ft();default:throw pe.createInternalThrowError(Ia.LogicalOperatorSyntaxError,O.operator,O)}}},E.unaryExpressionHandler=function(O){var pe=this;switch(O.operator){case"delete":var De=this.createObjectGetter(O.argument),ft=this.createNameGetter(O.argument);return function(){return delete De()[ft()]};default:var Rt;if("typeof"===O.operator&&"Identifier"===O.argument.type){var kt=this.createObjectGetter(O.argument),Ir=this.createNameGetter(O.argument);Rt=function(){return kt()[Ir()]}}else Rt=this.createClosure(O.argument);return function(){var Nr=Rt();switch(O.operator){case"-":return-Nr;case"+":return+Nr;case"!":return!Nr;case"~":return~Nr;case"void":return;case"typeof":return typeof Nr;default:throw pe.createInternalThrowError(Ia.UnaryOperatorSyntaxError,O.operator,O)}}}},E.updateExpressionHandler=function(O){var pe=this,De=this.createObjectGetter(O.argument),ft=this.createNameGetter(O.argument);return function(){var Rt=De(),kt=ft();switch(pe.assertVariable(Rt,kt,O),O.operator){case"++":return O.prefix?++Rt[kt]:Rt[kt]++;case"--":return O.prefix?--Rt[kt]:Rt[kt]--;default:throw pe.createInternalThrowError(Ia.UpdateOperatorSyntaxError,O.operator,O)}}},E.objectExpressionHandler=function(O){var pe=this,De=[],Rt=Object.create(null);return O.properties.forEach(function(kt){var Ir=kt.kind,Nr=function(kt){return"Identifier"===kt.type?kt.name:"Literal"===kt.type?kt.value:this.throwError(Ia.ObjectStructureSyntaxError,kt.type,kt)}(kt.key);(!Rt[Nr]||"init"===Ir)&&(Rt[Nr]={}),Rt[Nr][Ir]=pe.createClosure(kt.value),De.push({key:Nr,property:kt})}),function(){for(var kt={},Ir=De.length,Nr=0;Nr<Ir;Nr++){var Jn=De[Nr],bi=Jn.key,pi=Rt[bi],oa=pi.init?pi.init():void 0,Ea=pi.get?pi.get():function(){},Na=pi.set?pi.set():function(Tu){};if("set"in pi||"get"in pi)Object.defineProperty(kt,bi,{configurable:!0,enumerable:!0,get:Ea,set:Na});else{var Xo=Jn.property;"Identifier"===Xo.key.type&&"FunctionExpression"===Xo.value.type&&"init"===Xo.kind&&!Xo.value.id&&Fe(oa,Xo.key.name),kt[bi]=oa}}return kt}},E.arrayExpressionHandler=function(O){var pe=this,De=O.elements.map(function(ft){return ft&&pe.createClosure(ft)});return function(){for(var ft=De.length,Rt=Array(ft),kt=0;kt<ft;kt++){var Ir=De[kt];Ir&&(Rt[kt]=Ir())}return Rt}},E.safeObjectGet=function(O,pe,De){return O[pe]},E.createCallFunctionGetter=function(O){var pe=this;switch(O.type){case"MemberExpression":var De=this.createClosure(O.object),ft=this.createMemberKeyGetter(O),Rt=this.source;return function(){var Ir=De(),Nr=ft(),Jn=pe.safeObjectGet(Ir,Nr,O);if(!Jn||!du(Jn)){var bi=Rt.slice(O.start,O.end);throw pe.createInternalThrowError(Ia.FunctionUndefinedReferenceError,bi,O)}return Jn.__IS_EVAL_FUNC?function(pi){return Jn(new Eu(pe),pi,!0)}:Jn.__IS_FUNCTION_FUNC?function(){for(var pi=arguments.length,oa=new Array(pi),Ea=0;Ea<pi;Ea++)oa[Ea]=arguments[Ea];return Jn.apply(void 0,[new Eu(pe)].concat(oa))}:Jn.bind(Ir)};default:var kt=this.createClosure(O);return function(){var Ir="";"Identifier"===O.type&&(Ir=O.name);var Nr=kt();if(!Nr||!du(Nr))throw pe.createInternalThrowError(Ia.FunctionUndefinedReferenceError,Ir,O);if("Identifier"===O.type&&Nr.__IS_EVAL_FUNC&&"eval"===Ir)return function(pi){var oa=pe.getScopeFromName(Ir,pe.getCurrentScope()),Ea=oa.name===ro||oa.name===ps||oa.name===co;return Nr(new Eu(pe),pi,!Ea)};if(Nr.__IS_EVAL_FUNC)return function(pi){return Nr(new Eu(pe),pi,!0)};if(Nr.__IS_FUNCTION_FUNC)return function(){for(var pi=arguments.length,oa=new Array(pi),Ea=0;Ea<pi;Ea++)oa[Ea]=arguments[Ea];return Nr.apply(void 0,[new Eu(pe)].concat(oa))};var Jn=pe.options.globalContextInFunction;if("Identifier"===O.type){var bi=pe.getIdentifierScope(O);bi.name===lo&&(Jn=bi.data)}return Nr.bind(Jn)}}},E.callExpressionHandler=function(O){var pe=this,De=this.createCallFunctionGetter(O.callee),ft=O.arguments.map(function(Rt){return pe.createClosure(Rt)});return function(){return De().apply(void 0,ft.map(function(Rt){return Rt()}))}},E.functionExpressionHandler=function(O){var pe=this,De=this,ft=this.source,Rt=this.collectDeclVars,kt=this.collectDeclFuncs;this.collectDeclVars=Object.create(null),this.collectDeclFuncs=Object.create(null);var Ir=O.id?O.id.name:"",Nr=O.params.length,Jn=O.params.map(function(Ea){return pe.createParamNameGetter(Ea)}),bi=this.createClosure(O.body),pi=this.collectDeclVars,oa=this.collectDeclFuncs;return this.collectDeclVars=Rt,this.collectDeclFuncs=kt,function(){var Ea=De.getCurrentScope(),Na=function vi(){for(var Xo=arguments.length,vu=new Array(Xo),Tu=0;Tu<Xo;Tu++)vu[Tu]=arguments[Tu];De.callStack.push(""+Ir);var Ec=De.getCurrentScope(),Du=Qs(Ea,"FunctionScope("+Ir+")");De.setCurrentScope(Du),De.addDeclarationsToScope(pi,oa,Du),Ir&&(Du.data[Ir]=vi),Du.data.arguments=arguments,Jn.forEach(function(gu,tu){Du.data[gu()]=vu[tu]});var Bl=De.getCurrentContext();De.setCurrentContext(this);var mu=bi();if(De.setCurrentContext(Bl),De.setCurrentScope(Ec),De.callStack.pop(),mu instanceof Qo)return mu.value};return Fe(Na,Ir),Object.defineProperty(Na,"length",{value:Nr,writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(Na,"toString",{value:function(){return ft.slice(O.start,O.end)},writable:!0,configurable:!0,enumerable:!1}),Object.defineProperty(Na,"valueOf",{value:function(){return ft.slice(O.start,O.end)},writable:!0,configurable:!0,enumerable:!1}),Na}},E.newExpressionHandler=function(O){var pe=this,De=this.source,ft=this.createClosure(O.callee),Rt=O.arguments.map(function(kt){return pe.createClosure(kt)});return function(){var kt=ft();if(!du(kt)||kt.__IS_EVAL_FUNC){var Ir=O.callee,Nr=De.slice(Ir.start,Ir.end);throw pe.createInternalThrowError(Ia.IsNotConstructor,Nr,O)}return kt.__IS_FUNCTION_FUNC?kt.apply(void 0,[new Eu(pe)].concat(Rt.map(function(Jn){return Jn()}))):$o(kt,Rt.map(function(Jn){return Jn()}))}},E.memberExpressionHandler=function(O){var pe=this.createClosure(O.object),De=this.createMemberKeyGetter(O);return function(){return pe()[De()]}},E.thisExpressionHandler=function(O){var pe=this;return function(){return pe.getCurrentContext()}},E.sequenceExpressionHandler=function(O){var pe=this,De=O.expressions.map(function(ft){return pe.createClosure(ft)});return function(){for(var ft,Rt=De.length,kt=0;kt<Rt;kt++)ft=(0,De[kt])();return ft}},E.literalHandler=function(O){return function(){return O.regex?new RegExp(O.regex.pattern,O.regex.flags):O.value}},E.identifierHandler=function(O){var pe=this;return function(){var De=pe.getCurrentScope(),ft=pe.getScopeDataFromName(O.name,De);return pe.assertVariable(ft,O.name,O),ft[O.name]}},E.getIdentifierScope=function(O){var pe=this.getCurrentScope();return this.getScopeFromName(O.name,pe)},E.assignmentExpressionHandler=function(O){var pe=this;"Identifier"===O.left.type&&"FunctionExpression"===O.right.type&&!O.right.id&&(O.right.id={type:"Identifier",name:O.left.name});var De=this.createObjectGetter(O.left),ft=this.createNameGetter(O.left),Rt=this.createClosure(O.right);return function(){var kt=De(),Ir=ft(),Nr=Rt();switch("="!==O.operator&&pe.assertVariable(kt,Ir,O),O.operator){case"=":return kt[Ir]=Nr;case"+=":return kt[Ir]+=Nr;case"-=":return kt[Ir]-=Nr;case"*=":return kt[Ir]*=Nr;case"**=":return kt[Ir]=Math.pow(kt[Ir],Nr);case"/=":return kt[Ir]/=Nr;case"%=":return kt[Ir]%=Nr;case"<<=":return kt[Ir]<<=Nr;case">>=":return kt[Ir]>>=Nr;case">>>=":return kt[Ir]>>>=Nr;case"&=":return kt[Ir]&=Nr;case"^=":return kt[Ir]^=Nr;case"|=":return kt[Ir]|=Nr;default:throw pe.createInternalThrowError(Ia.AssignmentExpressionSyntaxError,O.type,O)}}},E.functionDeclarationHandler=function(O){if(O.id){var pe=this.functionExpressionHandler(O);Object.defineProperty(pe,"isFunctionDeclareClosure",{value:!0,writable:!1,configurable:!1,enumerable:!1}),this.funcDeclaration(O.id.name,pe)}return function(){return xi}},E.getVariableName=function(O){if("Identifier"===O.type)return O.name;throw this.createInternalThrowError(Ia.VariableTypeSyntaxError,O.type,O)},E.variableDeclarationHandler=function(O){for(var De,pe=this,ft=[],Rt=0;Rt<O.declarations.length;Rt++){var kt=O.declarations[Rt];this.varDeclaration(this.getVariableName(kt.id)),kt.init&&ft.push({type:"AssignmentExpression",operator:"=",left:kt.id,right:kt.init})}return ft.length&&(De=this.createClosure({type:"BlockStatement",body:ft})),function(){if(De){var Ir=pe.isVarDeclMode;pe.isVarDeclMode=!0,De(),pe.isVarDeclMode=Ir}return xi}},E.assertVariable=function(O,pe,De){if(O===this.globalScope.data&&!(pe in O))throw this.createInternalThrowError(Ia.VariableUndefinedReferenceError,pe,De)},E.programHandler=function(O){var pe=this,De=O.body.map(function(ft){return pe.createClosure(ft)});return function(){for(var ft=xi,Rt=0;Rt<De.length;Rt++){var Ir=pe.setValue((0,De[Rt])());if(Ir!==xi&&((ft=Ir)instanceof Qo||ft instanceof ko||ft instanceof es||ft===Qt||ft===Yr))break}return ft}},E.expressionStatementHandler=function(O){return this.createClosure(O.expression)},E.emptyStatementHandler=function(O){return function(){return xi}},E.returnStatementHandler=function(O){var pe=O.argument?this.createClosure(O.argument):Ls;return function(){return new Qo(pe())}},E.ifStatementHandler=function(O){var pe=this.createClosure(O.test),De=this.createClosure(O.consequent),ft=O.alternate?this.createClosure(O.alternate):function(){return xi};return function(){return pe()?De():ft()}},E.conditionalExpressionHandler=function(O){return this.ifStatementHandler(O)},E.forStatementHandler=function(O){var pe=this,De=Ls,ft=O.test?this.createClosure(O.test):function(){return!0},Rt=Ls,kt=this.createClosure(O.body);return"ForStatement"===O.type&&(De=O.init?this.createClosure(O.init):De,Rt=O.update?this.createClosure(O.update):Ls),function(Ir){var Nr,Jn=xi,bi="DoWhileStatement"===O.type;for(Ir&&"LabeledStatement"===Ir.type&&(Nr=Ir.label.name),De();bi||ft();Rt()){bi=!1;var pi=pe.setValue(kt());if(pi!==xi&&pi!==Yr){if(pi===Qt)break;if((Jn=pi)instanceof es&&Jn.value===Nr){Jn=xi;continue}if(Jn instanceof Qo||Jn instanceof ko||Jn instanceof es)break}}return Jn}},E.whileStatementHandler=function(O){return this.forStatementHandler(O)},E.doWhileStatementHandler=function(O){return this.forStatementHandler(O)},E.forInStatementHandler=function(O){var pe=this,De=O.left,ft=this.createClosure(O.right),Rt=this.createClosure(O.body);return"VariableDeclaration"===O.left.type&&(this.createClosure(O.left)(),De=O.left.declarations[0].id),function(kt){var Ir,Jn,Nr=xi;kt&&"LabeledStatement"===kt.type&&(Ir=kt.label.name);var bi=ft();for(Jn in bi){pe.assignmentExpressionHandler({type:"AssignmentExpression",operator:"=",left:De,right:{type:"Literal",value:Jn}})();var pi=pe.setValue(Rt());if(pi!==xi&&pi!==Yr){if(pi===Qt)break;if((Nr=pi)instanceof es&&Nr.value===Ir){Nr=xi;continue}if(Nr instanceof Qo||Nr instanceof ko||Nr instanceof es)break}}return Nr}},E.withStatementHandler=function(O){var pe=this,De=this.createClosure(O.object),ft=this.createClosure(O.body);return function(){var Rt=De(),kt=pe.getCurrentScope(),Ir=new ts(Rt,kt,lo);pe.setCurrentScope(Ir);var Nr=pe.setValue(ft());return pe.setCurrentScope(kt),Nr}},E.throwStatementHandler=function(O){var pe=this,De=this.createClosure(O.argument);return function(){throw pe.setValue(void 0),De()}},E.tryStatementHandler=function(O){var pe=this,De=this.createClosure(O.block),ft=O.handler?this.catchClauseHandler(O.handler):null,Rt=O.finalizer?this.createClosure(O.finalizer):null;return function(){var pi,oa,kt=pe.getCurrentScope(),Ir=pe.getCurrentContext(),Nr=kt.labelStack.concat([]),Jn=pe.callStack.concat([]),bi=xi,Ea=function(){pe.setCurrentScope(kt),pe.setCurrentContext(Ir),kt.labelStack=Nr,pe.callStack=Jn};try{(bi=pe.setValue(De()))instanceof Qo&&(pi=bi)}catch(Na){if(Ea(),pe.isInterruptThrow(Na))throw Na;if(ft)try{(bi=pe.setValue(ft(Na)))instanceof Qo&&(pi=bi)}catch(vi){if(Ea(),pe.isInterruptThrow(vi))throw vi;oa=vi}}if(Rt)try{(bi=Rt())instanceof Qo&&(pi=bi)}catch(Na){if(Ea(),pe.isInterruptThrow(Na))throw Na;oa=Na}if(oa)throw oa;return pi||bi}},E.catchClauseHandler=function(O){var pe=this,De=this.createParamNameGetter(O.param),ft=this.createClosure(O.body);return function(Rt){var kt,Nr=pe.getCurrentScope().data,Jn=De(),bi=vt.call(Nr,Jn),pi=Nr[Jn];return Nr[Jn]=Rt,kt=ft(),bi?Nr[Jn]=pi:delete Nr[Jn],kt}},E.continueStatementHandler=function(O){return function(){return O.label?new es(O.label.name):Yr}},E.breakStatementHandler=function(O){return function(){return O.label?new ko(O.label.name):Qt}},E.switchStatementHandler=function(O){var pe=this,De=this.createClosure(O.discriminant),ft=O.cases.map(function(Rt){return pe.switchCaseHandler(Rt)});return function(){for(var Ir,Nr,Jn,Rt=De(),kt=!1,bi=0;bi<ft.length;bi++){var pi=ft[bi](),oa=pi.testClosure();if(oa!==$n){if(kt||oa===Rt){if(kt=!0,(Nr=pe.setValue(pi.bodyClosure()))===xi)continue;if(Nr===Qt||(Ir=Nr)instanceof Qo||Ir instanceof ko||Ir instanceof es||Ir===Yr)break}}else Jn=pi}return!kt&&Jn&&((Nr=pe.setValue(Jn.bodyClosure()))===xi||Nr===Qt||Nr===Yr||(Ir=Nr)),Ir}},E.switchCaseHandler=function(O){var pe=O.test?this.createClosure(O.test):function(){return $n},De=this.createClosure({type:"BlockStatement",body:O.consequent});return function(){return{testClosure:pe,bodyClosure:De}}},E.labeledStatementHandler=function(O){var pe=this,De=O.label.name,ft=this.createClosure(O.body);return function(){var Rt,kt=pe.getCurrentScope();return kt.labelStack.push(De),(Rt=ft(O))instanceof ko&&Rt.value===De&&(Rt=xi),kt.labelStack.pop(),Rt}},E.debuggerStatementHandler=function(O){return function(){return xi}},E.createParamNameGetter=function(O){if("Identifier"===O.type)return function(){return O.name};throw this.createInternalThrowError(Ia.ParamTypeSyntaxError,O.type,O)},E.createObjectKeyGetter=function(O){var pe;return pe="Identifier"===O.type?function(){return O.name}:this.createClosure(O),function(){return pe()}},E.createMemberKeyGetter=function(O){return O.computed?this.createClosure(O.property):this.createObjectKeyGetter(O.property)},E.createObjectGetter=function(O){var pe=this;switch(O.type){case"Identifier":return function(){return pe.getScopeDataFromName(O.name,pe.getCurrentScope())};case"MemberExpression":return this.createClosure(O.object);default:throw this.createInternalThrowError(Ia.AssignmentTypeSyntaxError,O.type,O)}},E.createNameGetter=function(O){switch(O.type){case"Identifier":return function(){return O.name};case"MemberExpression":return this.createMemberKeyGetter(O);default:throw this.createInternalThrowError(Ia.AssignmentTypeSyntaxError,O.type,O)}},E.varDeclaration=function(O){this.collectDeclVars[O]=void 0},E.funcDeclaration=function(O,pe){this.collectDeclFuncs[O]=pe},E.addDeclarationsToScope=function(O,pe,De){var ft=De.data;for(var Rt in pe){var kt=pe[Rt];ft[Rt]=kt&&kt()}for(var Ir in O)Ir in ft||(ft[Ir]=void 0)},E.getScopeValue=function(O,pe){return this.getScopeFromName(O,pe).data[O]},E.getScopeDataFromName=function(O,pe){return this.getScopeFromName(O,pe).data},E.getScopeFromName=function(O,pe){var De=pe;do{if(O in De.data)return De}while(De=De.parent);return this.globalScope},E.setValue=function(O){return this.isVarDeclMode||this.callStack.length||O===xi||O===Qt||O===Yr||O instanceof ko||O instanceof es||(this.value=O instanceof Qo?O.value:O),O},E.getValue=function(){return this.value},m}();function Ol(m){return void 0===m&&(m=Object.create(null)),m}function kl(m,E,U){void 0===E&&(E=[]),void 0===U&&(U={});var O=U.parsingContext,pe=void 0===U.timeout?0:U.timeout,De="\n    (function anonymous("+E.join(",")+"){\n         "+m+"\n    });\n    ";return new Lo(O,{ecmaVersion:U.ecmaVersion,timeout:pe,rootContext:U.rootContext,globalContextInFunction:U.globalContextInFunction}).evaluate(De)}function Ll(m,E,U){return new Lo(E,U).evaluate(m)}Lo.version="0.0.2",Lo.eval=fl,Lo.Function=Wo,Lo.ecmaVersion=5,Lo.globalContextInFunction=void 0,Lo.global=Object.create(null);var Sc=Ll,Rl=function(){function m(U){this._code=U}var E=m.prototype;return E.runInContext=function(O){return Ll(this._code,O)},E.runInNewContext=function(O){return Ll(this._code,O)},m}();const hl=function(m,E,U){return Ll(m,E,U)};function eu(){for(var m=arguments.length,E=new Array(m),U=0;U<m;U++)E[U]=arguments[U];var O=E.pop();return kl(O||"",E)}const Dl=hl},35296:function(dr,H,M){dr.exports=function(ue){"use strict";var w=function(V){return V instanceof Uint8Array||V instanceof Uint16Array||V instanceof Uint32Array||V instanceof Int8Array||V instanceof Int16Array||V instanceof Int32Array||V instanceof Float32Array||V instanceof Float64Array||V instanceof Uint8ClampedArray},p=function(V,ke){for(var Qe=Object.keys(ke),ir=0;ir<Qe.length;++ir)V[Qe[ir]]=ke[Qe[ir]];return V},_="\n";function W(V){return"undefined"!=typeof atob?atob(V):"base64:"+V}function X(V){var ke=new Error("(regl) "+V);throw console.error(ke),ke}function q(V,ke){V||X(ke)}function te(V){return V?": "+V:""}function et(V,ke){switch(ke){case"number":return"number"==typeof V;case"object":return"object"==typeof V;case"string":return"string"==typeof V;case"boolean":return"boolean"==typeof V;case"function":return"function"==typeof V;case"undefined":return void 0===V;case"symbol":return"symbol"==typeof V}}function tt(V,ke,Qe){ke.indexOf(V)<0&&X("invalid value"+te(Qe)+". must be one of: "+ke)}var Mt=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function Ut(V,ke){for(V+="";V.length<ke;)V=" "+V;return V}function At(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function Et(V,ke){this.number=V,this.line=ke,this.errors=[]}function vr(V,ke,Qe){this.file=V,this.line=ke,this.message=Qe}function ne(){var V=new Error,ke=(V.stack||V).toString(),Qe=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(ke);if(Qe)return Qe[1];var ir=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(ke);return ir?ir[1]:"unknown"}function nr(){var V=new Error,ke=(V.stack||V).toString(),Qe=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(ke);if(Qe)return Qe[1];var ir=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(ke);return ir?ir[1]:"unknown"}function Tt(V,ke){var Qe=V.split("\n"),ir=1,kr=0,tr={unknown:new At,0:new At};tr.unknown.name=tr[0].name=ke||ne(),tr.unknown.lines.push(new Et(0,""));for(var Er=0;Er<Qe.length;++Er){var Zr=Qe[Er],Gr=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(Zr);if(Gr)switch(Gr[1]){case"line":var Kr=/(\d+)(\s+\d+)?/.exec(Gr[2]);Kr&&(ir=0|Kr[1],Kr[2]&&((kr=0|Kr[2])in tr||(tr[kr]=new At)));break;case"define":var qr=/SHADER_NAME(_B64)?\s+(.*)$/.exec(Gr[2]);qr&&(tr[kr].name=qr[1]?W(qr[2]):qr[2])}tr[kr].lines.push(new Et(ir++,Zr))}return Object.keys(tr).forEach(function(Qr){var hn=tr[Qr];hn.lines.forEach(function(Hr){hn.index[Hr.number]=Hr})}),tr}function lr(V){V._commandRef=ne()}function Dr(V,ke){var Qe=nr();X(V+" in command "+(ke||ne())+("unknown"===Qe?"":" called from "+Qe))}function ae(V,ke,Qe,ir){et(V,ke)||Dr("invalid parameter type"+te(Qe)+". expected "+ke+", got "+typeof V,ir||ne())}var ze=33071,G={};function Ve(V,ke){return 32820===V||32819===V||33635===V?2:34042===V?4:G[V]*ke}function rt(V){return!(V&V-1||!V)}G[5120]=G[5121]=1,G[5122]=G[5123]=G[36193]=G[33635]=G[32819]=G[32820]=2,G[5124]=G[5125]=G[5126]=G[34042]=4;var B=p(q,{optional:function(V){V()},raise:X,commandRaise:Dr,command:function(V,ke,Qe){V||Dr(ke,Qe||ne())},parameter:function(V,ke,Qe){V in ke||X("unknown parameter ("+V+")"+te(Qe)+". possible values: "+Object.keys(ke).join())},commandParameter:function(V,ke,Qe,ir){V in ke||Dr("unknown parameter ("+V+")"+te(Qe)+". possible values: "+Object.keys(ke).join(),ir||ne())},constructor:function(V){Object.keys(V).forEach(function(ke){Mt.indexOf(ke)<0&&X('invalid regl constructor argument "'+ke+'". must be one of '+Mt)})},type:function(V,ke,Qe){et(V,ke)||X("invalid parameter type"+te(Qe)+". expected "+ke+", got "+typeof V)},commandType:ae,isTypedArray:function(V,ke){w(V)||X("invalid parameter type"+te(ke)+". must be a typed array")},nni:function(V,ke){V>=0&&(0|V)===V||X("invalid parameter type, ("+V+")"+te(ke)+". must be a nonnegative integer")},oneOf:tt,shaderError:function(V,ke,Qe,ir,kr){if(!V.getShaderParameter(ke,V.COMPILE_STATUS)){var tr=V.getShaderInfoLog(ke),Er=ir===V.FRAGMENT_SHADER?"fragment":"vertex";ae(Qe,"string",Er+" shader source must be a string",kr);var Zr=Tt(Qe,kr),Gr=function(V){var ke=[];return V.split("\n").forEach(function(Qe){if(!(Qe.length<5)){var ir=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(Qe);ir?ke.push(new vr(0|ir[1],0|ir[2],ir[3].trim())):Qe.length>0&&ke.push(new vr("unknown",0,Qe))}}),ke}(tr);(function(V,ke){ke.forEach(function(Qe){var ir=V[Qe.file];if(ir){var kr=ir.index[Qe.line];if(kr)return kr.errors.push(Qe),void(ir.hasErrors=!0)}V.unknown.hasErrors=!0,V.unknown.lines[0].errors.push(Qe)})})(Zr,Gr),Object.keys(Zr).forEach(function(Kr){var qr=Zr[Kr];if(qr.hasErrors){var Qr=[""],hn=[""];Hr("file number "+Kr+": "+qr.name+"\n","color:red;text-decoration:underline;font-weight:bold"),qr.lines.forEach(function(en){if(en.errors.length>0){Hr(Ut(en.number,4)+"|  ","background-color:yellow; font-weight:bold"),Hr(en.line+_,"color:red; background-color:yellow; font-weight:bold");var Bt=0;en.errors.forEach(function(gr){var Wr=gr.message,Tn=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Wr);if(Tn){var Mr=Tn[1];switch(Wr=Tn[2],Mr){case"assign":Mr="="}Bt=Math.max(en.line.indexOf(Mr,Bt),0)}else Bt=0;Hr(Ut("| ",6)),Hr(Ut("^^^",Bt+3)+_,"font-weight:bold"),Hr(Ut("| ",6)),Hr(Wr+_,"font-weight:bold")}),Hr(Ut("| ",6)+_)}else Hr(Ut(en.number,4)+"|  "),Hr(en.line+_,"color:red")}),"undefined"==typeof document||window.chrome?console.log(Qr.join("")):(hn[0]=Qr.join("%c"),console.log.apply(console,hn))}function Hr(en,Bt){Qr.push(en),hn.push(Bt||"")}}),q.raise("Error compiling "+Er+" shader, "+Zr[0].name)}},linkError:function(V,ke,Qe,ir,kr){if(!V.getProgramParameter(ke,V.LINK_STATUS)){var tr=V.getProgramInfoLog(ke),Er=Tt(Qe,kr),Gr='Error linking program with vertex shader, "'+Tt(ir,kr)[0].name+'", and fragment shader "'+Er[0].name+'"';"undefined"!=typeof document?console.log("%c"+Gr+"\n%c"+tr,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(Gr+_+tr),q.raise(Gr)}},callSite:nr,saveCommandRef:lr,saveDrawInfo:function(V,ke,Qe,ir){function kr(Gr){return Gr?ir.id(Gr):0}function tr(Gr,Kr){Object.keys(Kr).forEach(function(qr){Gr[ir.id(qr)]=!0})}lr(V),V._fragId=kr(V.static.frag),V._vertId=kr(V.static.vert);var Er=V._uniformSet={};tr(Er,ke.static),tr(Er,ke.dynamic);var Zr=V._attributeSet={};tr(Zr,Qe.static),tr(Zr,Qe.dynamic),V._hasCount="count"in V.static||"count"in V.dynamic||"elements"in V.static||"elements"in V.dynamic},framebufferFormat:function(V,ke,Qe){V.texture?tt(V.texture._texture.internalformat,ke,"unsupported texture format for attachment"):tt(V.renderbuffer._renderbuffer.format,Qe,"unsupported renderbuffer format for attachment")},guessCommand:ne,texture2D:function(V,ke,Qe){var ir,kr=ke.width,tr=ke.height,Er=ke.channels;q(kr>0&&kr<=Qe.maxTextureSize&&tr>0&&tr<=Qe.maxTextureSize,"invalid texture shape"),(V.wrapS!==ze||V.wrapT!==ze)&&q(rt(kr)&&rt(tr),"incompatible wrap mode for texture, both width and height must be power of 2"),1===ke.mipmask?1!==kr&&1!==tr&&q(9984!==V.minFilter&&9986!==V.minFilter&&9985!==V.minFilter&&9987!==V.minFilter,"min filter requires mipmap"):(q(rt(kr)&&rt(tr),"texture must be a square power of 2 to support mipmapping"),q(ke.mipmask===(kr<<1)-1,"missing or incomplete mipmap data")),5126===ke.type&&(Qe.extensions.indexOf("oes_texture_float_linear")<0&&q(9728===V.minFilter&&9728===V.magFilter,"filter not supported, must enable oes_texture_float_linear"),q(!V.genMipmaps,"mipmap generation not supported with float textures"));var Zr=ke.images;for(ir=0;ir<16;++ir)if(Zr[ir]){var Gr=kr>>ir,Kr=tr>>ir;q(ke.mipmask&1<<ir,"missing mipmap data");var qr=Zr[ir];if(q(qr.width===Gr&&qr.height===Kr,"invalid shape for mip images"),q(qr.format===ke.format&&qr.internalformat===ke.internalformat&&qr.type===ke.type,"incompatible type for mip image"),!qr.compressed&&qr.data){var Qr=Math.ceil(Ve(qr.type,Er)*Gr/qr.unpackAlignment)*qr.unpackAlignment;q(qr.data.byteLength===Qr*Kr,"invalid data for image, buffer size is inconsistent with image format")}}else V.genMipmaps||q(0==(ke.mipmask&1<<ir),"extra mipmap data");ke.compressed&&q(!V.genMipmaps,"mipmap generation for compressed images not supported")},textureCube:function(V,ke,Qe,ir){var kr=V.width,tr=V.height,Er=V.channels;q(kr>0&&kr<=ir.maxTextureSize&&tr>0&&tr<=ir.maxTextureSize,"invalid texture shape"),q(kr===tr,"cube map must be square"),q(ke.wrapS===ze&&ke.wrapT===ze,"wrap mode not supported by cube map");for(var Zr=0;Zr<Qe.length;++Zr){var Gr=Qe[Zr];q(Gr.width===kr&&Gr.height===tr,"inconsistent cube map face shape"),ke.genMipmaps&&(q(!Gr.compressed,"can not generate mipmap for compressed textures"),q(1===Gr.mipmask,"can not specify mipmaps and generate mipmaps"));for(var Kr=Gr.images,qr=0;qr<16;++qr){var Qr=Kr[qr];if(Qr){var hn=kr>>qr,Hr=tr>>qr;q(Gr.mipmask&1<<qr,"missing mipmap data"),q(Qr.width===hn&&Qr.height===Hr,"invalid shape for mip images"),q(Qr.format===V.format&&Qr.internalformat===V.internalformat&&Qr.type===V.type,"incompatible type for mip image"),Qr.compressed||Qr.data&&q(Qr.data.byteLength===hn*Hr*Math.max(Ve(Qr.type,Er),Qr.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format")}}}}}),Ue=0;function Cr(V,ke){this.id=Ue++,this.type=V,this.data=ke}function _r(V){return V.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function jt(V){if(0===V.length)return[];var ke=V.charAt(0),Qe=V.charAt(V.length-1);if(V.length>1&&ke===Qe&&('"'===ke||"'"===ke))return['"'+_r(V.substr(1,V.length-2))+'"'];var ir=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(V);if(ir)return jt(V.substr(0,ir.index)).concat(jt(ir[1])).concat(jt(V.substr(ir.index+ir[0].length)));var kr=V.split(".");if(1===kr.length)return['"'+_r(V)+'"'];for(var tr=[],Er=0;Er<kr.length;++Er)tr=tr.concat(jt(kr[Er]));return tr}function mr(V){return"["+jt(V).join("][")+"]"}var Wn={DynamicVariable:Cr,define:function(V,ke){return new Cr(V,mr(ke+""))},isDynamic:function(V){return"function"==typeof V&&!V._reglType||V instanceof Cr},unbox:function Ln(V,ke){return"function"==typeof V?new Cr(0,V):"number"==typeof V||"boolean"==typeof V?new Cr(5,V):Array.isArray(V)?new Cr(6,V.map(function(Qe,ir){return Ln(Qe,ke+"["+ir+"]")})):V instanceof Cr?V:void B(!1,"invalid option type in uniform "+ke)},accessor:mr},mi={next:"function"==typeof requestAnimationFrame?function(V){return requestAnimationFrame(V)}:function(V){return setTimeout(V,16)},cancel:"function"==typeof cancelAnimationFrame?function(V){return cancelAnimationFrame(V)}:clearTimeout},si="undefined"!=typeof my&&my&&"function"==typeof my.showToast?function(){return+new Date}:"undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date};function he(V){return"string"==typeof V?V.split():(B(Array.isArray(V),"invalid extension array"),V)}function ge(V){return"string"==typeof V?(B("undefined"!=typeof document,"not supported outside of DOM"),document.querySelector(V)):V}function F(V){var Qe,ir,kr,tr,ke=V||{},Er={},Zr=[],Gr=[],Kr="undefined"==typeof window?1:window.devicePixelRatio,qr=!1,Qr=function(en){en&&B.raise(en)},hn=function(){};if("string"==typeof ke?(B("undefined"!=typeof document,"selector queries only supported in DOM environments"),Qe=document.querySelector(ke),B(Qe,"invalid query string for element")):"object"==typeof ke?function(V){return"string"==typeof V.nodeName&&"function"==typeof V.appendChild&&"function"==typeof V.getBoundingClientRect}(ke)?Qe=ke:function(V){return"function"==typeof V.drawArrays||"function"==typeof V.drawElements}(ke)?kr=(tr=ke).canvas:(B.constructor(ke),"gl"in ke?tr=ke.gl:"canvas"in ke?kr=ge(ke.canvas):"container"in ke&&(ir=ge(ke.container)),"attributes"in ke&&B.type(Er=ke.attributes,"object","invalid context attributes"),"extensions"in ke&&(Zr=he(ke.extensions)),"optionalExtensions"in ke&&(Gr=he(ke.optionalExtensions)),"onDone"in ke&&(B.type(ke.onDone,"function","invalid or missing onDone callback"),Qr=ke.onDone),"profile"in ke&&(qr=!!ke.profile),"pixelRatio"in ke&&B((Kr=+ke.pixelRatio)>0,"invalid pixel ratio")):B.raise("invalid arguments to regl"),Qe&&("canvas"===Qe.nodeName.toLowerCase()?kr=Qe:ir=Qe),!tr){if(!kr){B("undefined"!=typeof document,"must manually specify webgl context outside of DOM environments");var Hr=function(V,ke,Qe){var tr,ir=document.createElement("canvas");function kr(){var Zr=window.innerWidth,Gr=window.innerHeight;if(V!==document.body){var Kr=ir.getBoundingClientRect();Zr=Kr.right-Kr.left,Gr=Kr.bottom-Kr.top}ir.width=Qe*Zr,ir.height=Qe*Gr}return p(ir.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),V.appendChild(ir),V===document.body&&(ir.style.position="absolute",p(V.style,{margin:0,padding:0})),V!==document.body&&"function"==typeof ResizeObserver?(tr=new ResizeObserver(function(){setTimeout(kr)})).observe(V):window.addEventListener("resize",kr,!1),kr(),{canvas:ir,onDestroy:function(){tr?tr.disconnect():window.removeEventListener("resize",kr),V.removeChild(ir)}}}(ir||document.body,0,Kr);if(!Hr)return null;kr=Hr.canvas,hn=Hr.onDestroy}void 0===Er.premultipliedAlpha&&(Er.premultipliedAlpha=!0),tr=function(V,ke){function Qe(ir){try{return V.getContext(ir,ke)}catch(kr){return null}}return Qe("webgl")||Qe("experimental-webgl")||Qe("webgl-experimental")}(kr,Er)}return tr?{gl:tr,canvas:kr,container:ir,extensions:Zr,optionalExtensions:Gr,pixelRatio:Kr,profile:qr,onDone:Qr,onDestroy:hn}:(hn(),Qr("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function re(V,ke){var Qe={};function ir(Zr){B.type(Zr,"string","extension name must be string");var Kr,Gr=Zr.toLowerCase();try{Kr=Qe[Gr]=function(Zr){return V.getExtension(Zr)?V.getExtension(Zr):V.getExtension(Zr.toLowerCase())?V.getExtension(Zr.toLowerCase()):null}(Zr)}catch(qr){}return!!Kr}for(var tr=0;tr<ke.extensions.length;++tr){var Er=ke.extensions[tr];if(!ir(Er))return ke.onDestroy(),ke.onDone('"'+Er+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ke.optionalExtensions.forEach(ir),{extensions:Qe,restore:function(){Object.keys(Qe).forEach(function(Zr){if(Qe[Zr]&&!ir(Zr))throw new Error("(regl): error restoring extension "+Zr)})}}}function ye(V,ke){for(var Qe=Array(V),ir=0;ir<V;++ir)Qe[ir]=ke(ir);return Qe}function On(V){var ke,Qe;return ke=(V>65535)<<4,ke|=Qe=((V>>>=ke)>255)<<3,ke|=Qe=((V>>>=Qe)>15)<<2,(ke|=Qe=((V>>>=Qe)>3)<<1)|(V>>>=Qe)>>1}function Cn(){var V=ye(8,function(){return[]});function ke(tr){var Er=function(V){for(var ke=16;ke<=1<<28;ke*=16)if(V<=ke)return ke;return 0}(tr),Zr=V[On(Er)>>2];return Zr.length>0?Zr.pop():new ArrayBuffer(Er)}function Qe(tr){V[On(tr.byteLength)>>2].push(tr)}return{alloc:ke,free:Qe,allocType:function(tr,Er){var Zr=null;switch(tr){case 5120:Zr=new Int8Array(ke(Er),0,Er);break;case 5121:Zr=new Uint8Array(ke(Er),0,Er);break;case 5122:Zr=new Int16Array(ke(2*Er),0,Er);break;case 5123:Zr=new Uint16Array(ke(2*Er),0,Er);break;case 5124:Zr=new Int32Array(ke(4*Er),0,Er);break;case 5125:Zr=new Uint32Array(ke(4*Er),0,Er);break;case 5126:Zr=new Float32Array(ke(4*Er),0,Er);break;default:return null}return Zr.length!==Er?Zr.subarray(0,Er):Zr},freeType:function(tr){Qe(tr.buffer)}}}var qt=Cn();qt.zero=Cn();var aa=6408;function vt(V){return!!V&&"object"==typeof V&&Array.isArray(V.shape)&&Array.isArray(V.stride)&&"number"==typeof V.offset&&V.shape.length===V.stride.length&&(Array.isArray(V.data)||w(V.data))}var Qt=function(V){return Object.keys(V).map(function(ke){return V[ke]})},Yr={shape:function(V){for(var ke=[],Qe=V;Qe.length;Qe=Qe[0])ke.push(Qe.length);return ke},flatten:function(V,ke,Qe,ir){var kr=1;if(ke.length)for(var tr=0;tr<ke.length;++tr)kr*=ke[tr];else kr=0;var Er=ir||qt.allocType(Qe,kr);switch(ke.length){case 0:break;case 1:!function(V,ke,Qe){for(var ir=0;ir<ke;++ir)Qe[ir]=V[ir]}(V,ke[0],Er);break;case 2:!function(V,ke,Qe,ir){for(var kr=0,tr=0;tr<ke;++tr)for(var Er=V[tr],Zr=0;Zr<Qe;++Zr)ir[kr++]=Er[Zr]}(V,ke[0],ke[1],Er);break;case 3:lo(V,ke[0],ke[1],ke[2],Er,0);break;default:ro(V,ke,0,Er,0)}return Er}};function lo(V,ke,Qe,ir,kr,tr){for(var Er=tr,Zr=0;Zr<ke;++Zr)for(var Gr=V[Zr],Kr=0;Kr<Qe;++Kr)for(var qr=Gr[Kr],Qr=0;Qr<ir;++Qr)kr[Er++]=qr[Qr]}function ro(V,ke,Qe,ir,kr){for(var tr=1,Er=Qe+1;Er<ke.length;++Er)tr*=ke[Er];var Zr=ke[Qe];if(ke.length-Qe==4){var Gr=ke[Qe+1],Kr=ke[Qe+2],qr=ke[Qe+3];for(Er=0;Er<Zr;++Er)lo(V[Er],Gr,Kr,qr,ir,kr),kr+=tr}else for(Er=0;Er<Zr;++Er)ro(V[Er],ke,Qe+1,ir,kr),kr+=tr}var du={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Qs={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Lo={dynamic:35048,stream:35040,static:35044},Ol=Yr.flatten,kl=Yr.shape,eu=[];function Dl(V){return 0|du[Object.prototype.toString.call(V)]}function m(V,ke){for(var Qe=0;Qe<ke.length;++Qe)V[Qe]=ke[Qe]}function E(V,ke,Qe,ir,kr,tr,Er){for(var Zr=0,Gr=0;Gr<Qe;++Gr)for(var Kr=0;Kr<ir;++Kr)V[Zr++]=ke[kr*Gr+tr*Kr+Er]}eu[5120]=1,eu[5122]=2,eu[5124]=4,eu[5121]=1,eu[5123]=2,eu[5125]=4,eu[5126]=4;var Ir={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},oa=5121,Na=5123,Xo=5125;var Bl=new Float32Array(1),mu=new Uint32Array(Bl.buffer);function tu(V){for(var ke=qt.allocType(5123,V.length),Qe=0;Qe<V.length;++Qe)if(isNaN(V[Qe]))ke[Qe]=65535;else if(V[Qe]===1/0)ke[Qe]=31744;else if(V[Qe]===-1/0)ke[Qe]=64512;else{Bl[0]=V[Qe];var ir=mu[0],kr=ir>>>31<<15,tr=(ir<<1>>>24)-127,Er=ir>>13&1023;ke[Qe]=tr<-24?kr:tr<-14?kr+(Er+1024>>-14-tr):tr>15?kr+31744:kr+(tr+15<<10)+Er}return ke}function oo(V){return Array.isArray(V)||w(V)}var Tc=function(V){return!(V&V-1||!V)},rs=3553,ru=34069,Rs=6408,ka=6409,pl=34041,dl=36193,zu=5121,js=5126,yl=33984,Ro=[9984,9986,9985,9987],Bn=[0,ka,6410,6407,Rs],za={};function Vu(V){return"[object "+V+"]"}za[ka]=za[6406]=za[6402]=1,za[pl]=za[6410]=2,za[6407]=za[35904]=3,za[Rs]=za[35906]=4;var _l=Vu("HTMLCanvasElement"),iu=Vu("OffscreenCanvas"),Es=Vu("CanvasRenderingContext2D"),Xc=Vu("ImageBitmap"),cn=Vu("HTMLImageElement"),Yc=Vu("HTMLVideoElement"),Oc=Object.keys(du).concat([_l,iu,Es,Xc,cn,Yc]),xl=[];xl[zu]=1,xl[js]=4,xl[dl]=2,xl[5123]=2,xl[5125]=4;var Ga=[];function Ts(V){return Array.isArray(V)&&(0===V.length||"number"==typeof V[0])}function sc(V){return!!Array.isArray(V)&&!(0===V.length||!oo(V[0]))}function au(V){return Object.prototype.toString.call(V)}function Ds(V){return au(V)===_l}function Hs(V){return au(V)===iu}function Ws(V){return!!("undefined"!=typeof my&&my&&"function"==typeof my.showToast&&V&&V.getContext)}function Cs(V){if(!V)return!1;if(Ws(V))return!0;var ke=au(V);return Oc.indexOf(ke)>=0||Ts(V)||sc(V)||vt(V)}function $i(V){return 0|du[Object.prototype.toString.call(V)]}function Bs(V,ke){return qt.allocType(V.type===dl?js:V.type,ke)}function Yo(V,ke){V.type===dl?(V.data=tu(ke),qt.freeType(ke)):V.data=ke}function bu(V,ke,Qe,ir,kr,tr){var Er;if(Er=void 0!==Ga[V]?Ga[V]:za[V]*xl[ke],tr&&(Er*=6),kr){for(var Zr=0,Gr=Qe;Gr>=1;)Zr+=Er*Gr*Gr,Gr/=2;return Zr}return Er*Qe*ir}function ou(V,ke,Qe,ir,kr,tr,Er){var Zr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},Gr={repeat:10497,clamp:33071,mirror:33648},Kr={nearest:9728,linear:9729},qr=p({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Kr),Qr={none:0,browser:37444},hn={uint8:zu,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Hr={alpha:6406,luminance:ka,"luminance alpha":6410,rgb:6407,rgba:Rs,rgba4:32854,"rgb5 a1":32855,rgb565:36194},en={};ke.ext_srgb&&(Hr.srgb=35904,Hr.srgba=35906),ke.oes_texture_float&&(hn.float32=hn.float=js),ke.oes_texture_half_float&&(hn.float16=hn["half float"]=dl),ke.webgl_depth_texture&&(p(Hr,{depth:6402,"depth stencil":pl}),p(hn,{uint16:5123,uint32:5125,"depth stencil":34042})),ke.webgl_compressed_texture_s3tc&&p(en,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),ke.webgl_compressed_texture_atc&&p(en,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),ke.webgl_compressed_texture_pvrtc&&p(en,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),ke.webgl_compressed_texture_etc1&&(en["rgb etc1"]=36196);var Bt=Array.prototype.slice.call(V.getParameter(34467)||new Uint32Array(0));Object.keys(en).forEach(function(Ye){var ur=en[Ye];Bt.indexOf(ur)>=0&&(Hr[Ye]=ur)});var gr=Object.keys(Hr);Qe.textureFormats=gr;var Wr=[];Object.keys(Hr).forEach(function(Ye){Wr[Hr[Ye]]=Ye});var Tn=[];Object.keys(hn).forEach(function(Ye){Tn[hn[Ye]]=Ye});var Mr=[];Object.keys(Kr).forEach(function(Ye){Mr[Kr[Ye]]=Ye});var bn=[];Object.keys(qr).forEach(function(Ye){bn[qr[Ye]]=Ye});var tn=[];Object.keys(Gr).forEach(function(Ye){tn[Gr[Ye]]=Ye});var ui=gr.reduce(function(Ye,ur){var Kt=Hr[ur];return Ye[Kt]=Kt===ka||6406===Kt||Kt===ka||6410===Kt||6402===Kt||Kt===pl||ke.ext_srgb&&(35904===Kt||35906===Kt)?Kt:32855===Kt||ur.indexOf("rgba")>=0?Rs:6407,Ye},{});function Or(){this.internalformat=Rs,this.format=Rs,this.type=zu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=37444,this.width=0,this.height=0,this.channels=0}function Sr(Ye,ur){Ye.internalformat=ur.internalformat,Ye.format=ur.format,Ye.type=ur.type,Ye.compressed=ur.compressed,Ye.premultiplyAlpha=ur.premultiplyAlpha,Ye.flipY=ur.flipY,Ye.unpackAlignment=ur.unpackAlignment,Ye.colorSpace=ur.colorSpace,Ye.width=ur.width,Ye.height=ur.height,Ye.channels=ur.channels}function jn(Ye,ur){if("object"==typeof ur&&ur){if("premultiplyAlpha"in ur&&(B.type(ur.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),Ye.premultiplyAlpha=ur.premultiplyAlpha),"flipY"in ur&&(B.type(ur.flipY,"boolean","invalid texture flip"),Ye.flipY=ur.flipY),"alignment"in ur&&(B.oneOf(ur.alignment,[1,2,4,8],"invalid texture unpack alignment"),Ye.unpackAlignment=ur.alignment),"colorSpace"in ur&&(B.parameter(ur.colorSpace,Qr,"invalid colorSpace"),Ye.colorSpace=Qr[ur.colorSpace]),"type"in ur){var Kt=ur.type;B(ke.oes_texture_float||!("float"===Kt||"float32"===Kt),"you must enable the OES_texture_float extension in order to use floating point textures."),B(ke.oes_texture_half_float||!("half float"===Kt||"float16"===Kt),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),B(ke.webgl_depth_texture||!("uint16"===Kt||"uint32"===Kt||"depth stencil"===Kt),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),B.parameter(Kt,hn,"invalid texture type"),Ye.type=hn[Kt]}var Fn=Ye.width,ya=Ye.height,Ne=Ye.channels,Ce=!1;"shape"in ur?(B(Array.isArray(ur.shape)&&ur.shape.length>=2,"shape must be an array"),Fn=ur.shape[0],ya=ur.shape[1],3===ur.shape.length&&(B((Ne=ur.shape[2])>0&&Ne<=4,"invalid number of channels"),Ce=!0),B(Fn>=0&&Fn<=Qe.maxTextureSize,"invalid width"),B(ya>=0&&ya<=Qe.maxTextureSize,"invalid height")):("radius"in ur&&(Fn=ya=ur.radius,B(Fn>=0&&Fn<=Qe.maxTextureSize,"invalid radius")),"width"in ur&&B((Fn=ur.width)>=0&&Fn<=Qe.maxTextureSize,"invalid width"),"height"in ur&&B((ya=ur.height)>=0&&ya<=Qe.maxTextureSize,"invalid height"),"channels"in ur&&(B((Ne=ur.channels)>0&&Ne<=4,"invalid number of channels"),Ce=!0)),Ye.width=0|Fn,Ye.height=0|ya,Ye.channels=0|Ne;var lt=!1;if("format"in ur){var Ft=ur.format;B(ke.webgl_depth_texture||!("depth"===Ft||"depth stencil"===Ft),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),B.parameter(Ft,Hr,"invalid texture format");var ar=Ye.internalformat=Hr[Ft];Ye.format=ui[ar],Ft in hn&&("type"in ur||(Ye.type=hn[Ft])),Ft in en&&(Ye.compressed=!0),lt=!0}!Ce&&lt?Ye.channels=za[Ye.format]:Ce&&!lt?Ye.channels!==Bn[Ye.format]&&(Ye.format=Ye.internalformat=Bn[Ye.channels]):lt&&Ce&&B(Ye.channels===za[Ye.format],"number of channels inconsistent with specified format")}}function dn(Ye){V.pixelStorei(37440,Ye.flipY),V.pixelStorei(37441,Ye.premultiplyAlpha),V.pixelStorei(37443,Ye.colorSpace),V.pixelStorei(3317,Ye.unpackAlignment)}function Jr(){Or.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function yn(Ye,ur){var Kt=null;if(Cs(ur)?Kt=ur:ur&&(B.type(ur,"object","invalid pixel data type"),jn(Ye,ur),"x"in ur&&(Ye.xOffset=0|ur.x),"y"in ur&&(Ye.yOffset=0|ur.y),Cs(ur.data)&&(Kt=ur.data)),B(!Ye.compressed||Kt instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),ur.copy){B(!Kt,"can not specify copy and data field for the same texture");var Fn=kr.viewportWidth,ya=kr.viewportHeight;Ye.width=Ye.width||Fn-Ye.xOffset,Ye.height=Ye.height||ya-Ye.yOffset,Ye.needsCopy=!0,B(Ye.xOffset>=0&&Ye.xOffset<Fn&&Ye.yOffset>=0&&Ye.yOffset<ya&&Ye.width>0&&Ye.width<=Fn&&Ye.height>0&&Ye.height<=ya,"copy texture read out of bounds")}else if(Kt){if(w(Kt))Ye.channels=Ye.channels||4,Ye.data=Kt,!("type"in ur)&&Ye.type===zu&&(Ye.type=$i(Kt));else if(Ts(Kt))Ye.channels=Ye.channels||4,function(V,ke){var Qe=ke.length;switch(V.type){case zu:case 5123:case 5125:case js:var ir=qt.allocType(V.type,Qe);ir.set(ke),V.data=ir;break;case dl:V.data=tu(ke);break;default:B.raise("unsupported texture type, must specify a typed array")}}(Ye,Kt),Ye.alignment=1,Ye.needsFree=!0;else if(vt(Kt)){var Ne=Kt.data;!Array.isArray(Ne)&&Ye.type===zu&&(Ye.type=$i(Ne));var Ft,ar,yt,ht,ut,Be,Ce=Kt.shape,lt=Kt.stride;3===Ce.length?(yt=Ce[2],Be=lt[2]):(B(2===Ce.length,"invalid ndarray pixel data, must be 2 or 3D"),yt=1,Be=1),Ft=Ce[0],ar=Ce[1],ht=lt[0],ut=lt[1],Ye.alignment=1,Ye.width=Ft,Ye.height=ar,Ye.channels=yt,Ye.format=Ye.internalformat=Bn[yt],Ye.needsFree=!0,function(V,ke,Qe,ir,kr,tr){for(var Er=V.width,Zr=V.height,Gr=V.channels,qr=Bs(V,Er*Zr*Gr),Qr=0,hn=0;hn<Zr;++hn)for(var Hr=0;Hr<Er;++Hr)for(var en=0;en<Gr;++en)qr[Qr++]=ke[Qe*Hr+ir*hn+kr*en+tr];Yo(V,qr)}(Ye,Ne,ht,ut,Be,Kt.offset)}else if(Ws(Kt)||Ds(Kt)||Hs(Kt)||function(V){return au(V)===Es}(Kt))Ye.element=Ws(Kt)||Ds(Kt)||Hs(Kt)?Kt:Kt.canvas,Ye.width=Ye.element.width,Ye.height=Ye.element.height,Ye.channels=4;else if(function(V){return au(V)===Xc}(Kt))Ye.element=Kt,Ye.width=Kt.width,Ye.height=Kt.height,Ye.channels=4;else if(function(V){return au(V)===cn}(Kt))Ye.element=Kt,Ye.width=Kt.naturalWidth,Ye.height=Kt.naturalHeight,Ye.channels=4;else if(function(V){return au(V)===Yc}(Kt))Ye.element=Kt,Ye.width=Kt.videoWidth,Ye.height=Kt.videoHeight,Ye.channels=4;else if(sc(Kt)){var ot=Ye.width||Kt[0].length,Ze=Ye.height||Kt.length,Nt=Ye.channels;Nt=oo(Kt[0][0])?Nt||Kt[0][0].length:Nt||1;for(var Gt=Yr.shape(Kt),zr=1,sn=0;sn<Gt.length;++sn)zr*=Gt[sn];var un=Bs(Ye,zr);Yr.flatten(Kt,Gt,"",un),Yo(Ye,un),Ye.alignment=1,Ye.width=ot,Ye.height=Ze,Ye.channels=Nt,Ye.format=Ye.internalformat=Bn[Nt],Ye.needsFree=!0}}else Ye.width=Ye.width||1,Ye.height=Ye.height||1,Ye.channels=Ye.channels||4;Ye.type===js?B(Qe.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):Ye.type===dl&&B(Qe.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function wn(Ye,ur,Kt){var Fn=Ye.element,ya=Ye.data,Ne=Ye.internalformat,Ce=Ye.format,lt=Ye.type,Ft=Ye.width,ar=Ye.height;dn(Ye),Fn?V.texImage2D(ur,Kt,Ce,Ce,lt,Fn):Ye.compressed?V.compressedTexImage2D(ur,Kt,Ne,Ft,ar,0,ya):Ye.needsCopy?(ir(),V.copyTexImage2D(ur,Kt,Ce,Ye.xOffset,Ye.yOffset,Ft,ar,0)):V.texImage2D(ur,Kt,Ce,Ft,ar,0,Ce,lt,ya||null)}function zi(Ye,ur,Kt,Fn,ya){var Ne=Ye.element,Ce=Ye.data,lt=Ye.internalformat,Ft=Ye.format,ar=Ye.type,yt=Ye.width,ht=Ye.height;dn(Ye),Ne?V.texSubImage2D(ur,ya,Kt,Fn,Ft,ar,Ne):Ye.compressed?V.compressedTexSubImage2D(ur,ya,Kt,Fn,lt,yt,ht,Ce):Ye.needsCopy?(ir(),V.copyTexSubImage2D(ur,ya,Kt,Fn,Ye.xOffset,Ye.yOffset,yt,ht)):V.texSubImage2D(ur,ya,Kt,Fn,yt,ht,Ft,ar,Ce)}var Mi=[];function En(){return Mi.pop()||new Jr}function Sn(Ye){Ye.needsFree&&qt.freeType(Ye.data),Jr.call(Ye),Mi.push(Ye)}function _i(){Or.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Zi(Ye,ur,Kt){var Fn=Ye.images[0]=En();Ye.mipmask=1,Fn.width=Ye.width=ur,Fn.height=Ye.height=Kt,Fn.channels=Ye.channels=4}function fa(Ye,ur){var Kt=null;if(Cs(ur))Sr(Kt=Ye.images[0]=En(),Ye),yn(Kt,ur),Ye.mipmask=1;else if(jn(Ye,ur),Array.isArray(ur.mipmap))for(var Fn=ur.mipmap,ya=0;ya<Fn.length;++ya)Sr(Kt=Ye.images[ya]=En(),Ye),Kt.width>>=ya,Kt.height>>=ya,yn(Kt,Fn[ya]),Ye.mipmask|=1<<ya;else Sr(Kt=Ye.images[0]=En(),Ye),yn(Kt,ur),Ye.mipmask=1;Sr(Ye,Ye.images[0]),Ye.compressed&&(33776===Ye.internalformat||33777===Ye.internalformat||33778===Ye.internalformat||33779===Ye.internalformat)&&B(Ye.width%4==0&&Ye.height%4==0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Mo(Ye,ur){for(var Kt=Ye.images,Fn=0;Fn<Kt.length;++Fn){if(!Kt[Fn])return;wn(Kt[Fn],ur,Fn)}}var Io=[];function ha(){var Ye=Io.pop()||new _i;Or.call(Ye),Ye.mipmask=0;for(var ur=0;ur<16;++ur)Ye.images[ur]=null;return Ye}function ds(Ye){for(var ur=Ye.images,Kt=0;Kt<ur.length;++Kt)ur[Kt]&&Sn(ur[Kt]),ur[Kt]=null;Io.push(Ye)}function so(){this.minFilter=9728,this.magFilter=9728,this.wrapS=33071,this.wrapT=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function vs(Ye,ur){if("min"in ur){var Kt=ur.min;B.parameter(Kt,qr),Ye.minFilter=qr[Kt],Ro.indexOf(Ye.minFilter)>=0&&!("faces"in ur)&&(Ye.genMipmaps=!0)}if("mag"in ur){var Fn=ur.mag;B.parameter(Fn,Kr),Ye.magFilter=Kr[Fn]}var ya=Ye.wrapS,Ne=Ye.wrapT;if("wrap"in ur){var Ce=ur.wrap;"string"==typeof Ce?(B.parameter(Ce,Gr),ya=Ne=Gr[Ce]):Array.isArray(Ce)&&(B.parameter(Ce[0],Gr),B.parameter(Ce[1],Gr),ya=Gr[Ce[0]],Ne=Gr[Ce[1]])}else{if("wrapS"in ur){var lt=ur.wrapS;B.parameter(lt,Gr),ya=Gr[lt]}if("wrapT"in ur){var Ft=ur.wrapT;B.parameter(Ft,Gr),Ne=Gr[Ft]}}if(Ye.wrapS=ya,Ye.wrapT=Ne,"anisotropic"in ur){var ar=ur.anisotropic;B("number"==typeof ar&&ar>=1&&ar<=Qe.maxAnisotropic,"aniso samples must be between 1 and "),Ye.anisotropic=ur.anisotropic}if("mipmap"in ur){var yt=!1;switch(typeof ur.mipmap){case"string":B.parameter(ur.mipmap,Zr,"invalid mipmap hint"),Ye.mipmapHint=Zr[ur.mipmap],Ye.genMipmaps=!0,yt=!0;break;case"boolean":yt=Ye.genMipmaps=ur.mipmap;break;case"object":B(Array.isArray(ur.mipmap),"invalid mipmap type"),Ye.genMipmaps=!1,yt=!0;break;default:B.raise("invalid mipmap type")}yt&&!("min"in ur)&&(Ye.minFilter=9984)}}function Uo(Ye,ur){V.texParameteri(ur,10241,Ye.minFilter),V.texParameteri(ur,10240,Ye.magFilter),V.texParameteri(ur,10242,Ye.wrapS),V.texParameteri(ur,10243,Ye.wrapT),ke.ext_texture_filter_anisotropic&&V.texParameteri(ur,34046,Ye.anisotropic),Ye.genMipmaps&&(V.hint(33170,Ye.mipmapHint),V.generateMipmap(ur))}var ss=0,ms={},us=Qe.maxTextureUnits,Vo=Array(us).map(function(){return null});function Hi(Ye){Or.call(this),this.mipmask=0,this.internalformat=Rs,this.id=ss++,this.refCount=1,this.target=Ye,this.texture=V.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new so,Er.profile&&(this.stats={size:0})}function ls(Ye){V.activeTexture(yl),V.bindTexture(Ye.target,Ye.texture)}function La(){var Ye=Vo[0];Ye?V.bindTexture(Ye.target,Ye.texture):V.bindTexture(rs,null)}function uo(Ye){var ur=Ye.texture;B(ur,"must not double destroy texture");var Kt=Ye.unit,Fn=Ye.target;Kt>=0&&(V.activeTexture(yl+Kt),V.bindTexture(Fn,null),Vo[Kt]=null),V.deleteTexture(ur),Ye.texture=null,Ye.params=null,Ye.pixels=null,Ye.refCount=0,delete ms[Ye.id],tr.textureCount--}return p(Hi.prototype,{bind:function(){var Ye=this;Ye.bindCount+=1;var ur=Ye.unit;if(ur<0){for(var Kt=0;Kt<us;++Kt){var Fn=Vo[Kt];if(Fn){if(Fn.bindCount>0)continue;Fn.unit=-1}Vo[Kt]=Ye,ur=Kt;break}ur>=us&&B.raise("insufficient number of texture units"),Er.profile&&tr.maxTextureUnits<ur+1&&(tr.maxTextureUnits=ur+1),Ye.unit=ur,V.activeTexture(yl+ur),V.bindTexture(Ye.target,Ye.texture)}return ur},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&uo(this)}}),Er.profile&&(tr.getTotalTextureSize=function(){var Ye=0;return Object.keys(ms).forEach(function(ur){Ye+=ms[ur].stats.size}),Ye}),{create2D:function(Ye,ur){var Kt=new Hi(rs);function Fn(Ce,lt){var Ft=Kt.texInfo;so.call(Ft);var ar=ha();return"number"==typeof Ce?Zi(ar,0|Ce,"number"==typeof lt?0|lt:0|Ce):Ce?(B.type(Ce,"object","invalid arguments to regl.texture"),vs(Ft,Ce),fa(ar,Ce)):Zi(ar,1,1),Ft.genMipmaps&&(ar.mipmask=(ar.width<<1)-1),Kt.mipmask=ar.mipmask,Sr(Kt,ar),B.texture2D(Ft,ar,Qe),Kt.internalformat=ar.internalformat,Fn.width=ar.width,Fn.height=ar.height,ls(Kt),Mo(ar,rs),Uo(Ft,rs),La(),ds(ar),Er.profile&&(Kt.stats.size=bu(Kt.internalformat,Kt.type,ar.width,ar.height,Ft.genMipmaps,!1)),Fn.format=Wr[Kt.internalformat],Fn.type=Tn[Kt.type],Fn.mag=Mr[Ft.magFilter],Fn.min=bn[Ft.minFilter],Fn.wrapS=tn[Ft.wrapS],Fn.wrapT=tn[Ft.wrapT],Fn}return ms[Kt.id]=Kt,tr.textureCount++,Fn(Ye,ur),Fn.subimage=function(Ce,lt,Ft,ar){B(!!Ce,"must specify image data");var yt=0|lt,ht=0|Ft,ut=0|ar,Be=En();return Sr(Be,Kt),Be.width=0,Be.height=0,yn(Be,Ce),Be.width=Be.width||(Kt.width>>ut)-yt,Be.height=Be.height||(Kt.height>>ut)-ht,B(Kt.type===Be.type&&Kt.format===Be.format&&Kt.internalformat===Be.internalformat,"incompatible format for texture.subimage"),B(yt>=0&&ht>=0&&yt+Be.width<=Kt.width&&ht+Be.height<=Kt.height,"texture.subimage write out of bounds"),B(Kt.mipmask&1<<ut,"missing mipmap data"),B(Be.data||Be.element||Be.needsCopy,"missing image data"),ls(Kt),zi(Be,rs,yt,ht,ut),La(),Sn(Be),Fn},Fn.resize=function(Ce,lt){var Ft=0|Ce,ar=0|lt||Ft;if(Ft===Kt.width&&ar===Kt.height)return Fn;Fn.width=Kt.width=Ft,Fn.height=Kt.height=ar,ls(Kt);for(var yt=0;Kt.mipmask>>yt;++yt){var ht=Ft>>yt,ut=ar>>yt;if(!ht||!ut)break;V.texImage2D(rs,yt,Kt.format,ht,ut,0,Kt.format,Kt.type,null)}return La(),Er.profile&&(Kt.stats.size=bu(Kt.internalformat,Kt.type,Ft,ar,!1,!1)),Fn},Fn._reglType="texture2d",Fn._texture=Kt,Er.profile&&(Fn.stats=Kt.stats),Fn.destroy=function(){Kt.decRef()},Fn},createCube:function(Ye,ur,Kt,Fn,ya,Ne){var Ce=new Hi(34067);ms[Ce.id]=Ce,tr.cubeCount++;var lt=new Array(6);function Ft(ht,ut,Be,ot,Ze,Nt){var Gt,zr=Ce.texInfo;for(so.call(zr),Gt=0;Gt<6;++Gt)lt[Gt]=ha();if("number"!=typeof ht&&ht)if("object"==typeof ht)if(ut)fa(lt[0],ht),fa(lt[1],ut),fa(lt[2],Be),fa(lt[3],ot),fa(lt[4],Ze),fa(lt[5],Nt);else if(vs(zr,ht),jn(Ce,ht),"faces"in ht){var un=ht.faces;for(B(Array.isArray(un)&&6===un.length,"cube faces must be a length 6 array"),Gt=0;Gt<6;++Gt)B("object"==typeof un[Gt]&&!!un[Gt],"invalid input for cube map face"),Sr(lt[Gt],Ce),fa(lt[Gt],un[Gt])}else for(Gt=0;Gt<6;++Gt)fa(lt[Gt],ht);else B.raise("invalid arguments to cube map");else{var sn=0|ht||1;for(Gt=0;Gt<6;++Gt)Zi(lt[Gt],sn,sn)}for(Sr(Ce,lt[0]),B.optional(function(){Qe.npotTextureCube||B(Tc(Ce.width)&&Tc(Ce.height),"your browser does not support non power or two texture dimensions")}),Ce.mipmask=zr.genMipmaps?(lt[0].width<<1)-1:lt[0].mipmask,B.textureCube(Ce,zr,lt,Qe),Ce.internalformat=lt[0].internalformat,Ft.width=lt[0].width,Ft.height=lt[0].height,ls(Ce),Gt=0;Gt<6;++Gt)Mo(lt[Gt],ru+Gt);for(Uo(zr,34067),La(),Er.profile&&(Ce.stats.size=bu(Ce.internalformat,Ce.type,Ft.width,Ft.height,zr.genMipmaps,!0)),Ft.format=Wr[Ce.internalformat],Ft.type=Tn[Ce.type],Ft.mag=Mr[zr.magFilter],Ft.min=bn[zr.minFilter],Ft.wrapS=tn[zr.wrapS],Ft.wrapT=tn[zr.wrapT],Gt=0;Gt<6;++Gt)ds(lt[Gt]);return Ft}return Ft(Ye,ur,Kt,Fn,ya,Ne),Ft.subimage=function(ht,ut,Be,ot,Ze){B(!!ut,"must specify image data"),B("number"==typeof ht&&ht===(0|ht)&&ht>=0&&ht<6,"invalid face");var Nt=0|Be,Gt=0|ot,zr=0|Ze,sn=En();return Sr(sn,Ce),sn.width=0,sn.height=0,yn(sn,ut),sn.width=sn.width||(Ce.width>>zr)-Nt,sn.height=sn.height||(Ce.height>>zr)-Gt,B(Ce.type===sn.type&&Ce.format===sn.format&&Ce.internalformat===sn.internalformat,"incompatible format for texture.subimage"),B(Nt>=0&&Gt>=0&&Nt+sn.width<=Ce.width&&Gt+sn.height<=Ce.height,"texture.subimage write out of bounds"),B(Ce.mipmask&1<<zr,"missing mipmap data"),B(sn.data||sn.element||sn.needsCopy,"missing image data"),ls(Ce),zi(sn,ru+ht,Nt,Gt,zr),La(),Sn(sn),Ft},Ft.resize=function(ht){var ut=0|ht;if(ut!==Ce.width){Ft.width=Ce.width=ut,Ft.height=Ce.height=ut,ls(Ce);for(var Be=0;Be<6;++Be)for(var ot=0;Ce.mipmask>>ot;++ot)V.texImage2D(ru+Be,ot,Ce.format,ut>>ot,ut>>ot,0,Ce.format,Ce.type,null);return La(),Er.profile&&(Ce.stats.size=bu(Ce.internalformat,Ce.type,Ft.width,Ft.height,!1,!0)),Ft}},Ft._reglType="textureCube",Ft._texture=Ce,Er.profile&&(Ft.stats=Ce.stats),Ft.destroy=function(){Ce.decRef()},Ft},clear:function(){for(var Ye=0;Ye<us;++Ye)V.activeTexture(yl+Ye),V.bindTexture(rs,null),Vo[Ye]=null;Qt(ms).forEach(uo),tr.cubeCount=0,tr.textureCount=0},getTexture:function(Ye){return null},restore:function(){for(var Ye=0;Ye<us;++Ye){var ur=Vo[Ye];ur&&(ur.bindCount=0,ur.unit=-1,Vo[Ye]=null)}Qt(ms).forEach(function(Kt){Kt.texture=V.createTexture(),V.bindTexture(Kt.target,Kt.texture);for(var Fn=0;Fn<32;++Fn)if(0!=(Kt.mipmask&1<<Fn))if(Kt.target===rs)V.texImage2D(rs,Fn,Kt.internalformat,Kt.width>>Fn,Kt.height>>Fn,0,Kt.internalformat,Kt.type,null);else for(var ya=0;ya<6;++ya)V.texImage2D(ru+ya,Fn,Kt.internalformat,Kt.width>>Fn,Kt.height>>Fn,0,Kt.internalformat,Kt.type,null);Uo(Kt.texInfo,Kt.target)})},refresh:function(){for(var Ye=0;Ye<us;++Ye){var ur=Vo[Ye];ur&&(ur.bindCount=0,ur.unit=-1,Vo[Ye]=null),V.activeTexture(yl+Ye),V.bindTexture(rs,null),V.bindTexture(34067,null)}}}}Ga[32854]=2,Ga[32855]=2,Ga[36194]=2,Ga[pl]=4,Ga[33776]=.5,Ga[33777]=.5,Ga[33778]=1,Ga[33779]=1,Ga[35986]=.5,Ga[35987]=1,Ga[34798]=1,Ga[35840]=.5,Ga[35841]=.25,Ga[35842]=.5,Ga[35843]=.25,Ga[36196]=.5;var mo=36161,il=32854,Qi=[];function zo(V,ke,Qe){return Qi[V]*ke*Qe}Qi[il]=2,Qi[32855]=2,Qi[36194]=2,Qi[33189]=2,Qi[36168]=1,Qi[34041]=4,Qi[35907]=4,Qi[34836]=16,Qi[34842]=8,Qi[34843]=6;var As=36160,ys=3553,is=34069,cc=[6407,6408],fc=[];fc[6408]=4,fc[6407]=3;var El=[];El[5121]=1,El[5126]=4,El[36193]=2;var Ee=[32854,32855,36194,35907,34842,34843,34836],Ae={};Ae[36053]="complete",Ae[36054]="incomplete attachment",Ae[36057]="incomplete dimensions",Ae[36055]="incomplete, missing attachment",Ae[36061]="unsupported";var je=["attributes","elements","offset","count","primitive","instances"];function at(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.offset=0,this.stride=0,this.divisor=0}var Xr=5121;function Un(V,ke,Qe,ir,kr,tr,Er){function Zr(qr){var Qr;null===ke.next?(B(kr.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Qr=Xr):(B(null!==ke.next.colorAttachments[0].texture,"You cannot read from a renderbuffer"),Qr=ke.next.colorAttachments[0].texture._texture.type,B.optional(function(){tr.oes_texture_float?(B(Qr===Xr||5126===Qr,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),5126===Qr&&B(Er.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):B(Qr===Xr,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var hn=0,Hr=0,en=ir.framebufferWidth,Bt=ir.framebufferHeight,gr=null;w(qr)?gr=qr:qr&&(B.type(qr,"object","invalid arguments to regl.read()"),Hr=0|qr.y,B((hn=0|qr.x)>=0&&hn<ir.framebufferWidth,"invalid x offset for regl.read"),B(Hr>=0&&Hr<ir.framebufferHeight,"invalid y offset for regl.read"),en=0|(qr.width||ir.framebufferWidth-hn),Bt=0|(qr.height||ir.framebufferHeight-Hr),gr=qr.data||null),gr&&(Qr===Xr?B(gr instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):5126===Qr&&B(gr instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),B(en>0&&en+hn<=ir.framebufferWidth,"invalid width for read pixels"),B(Bt>0&&Bt+Hr<=ir.framebufferHeight,"invalid height for read pixels"),Qe();var Wr=en*Bt*4;return gr||(Qr===Xr?gr=new Uint8Array(Wr):5126===Qr&&(gr=gr||new Float32Array(Wr))),B.isTypedArray(gr,"data buffer for regl.read() must be a typedarray"),B(gr.byteLength>=Wr,"data buffer for regl.read() too small"),V.pixelStorei(3333,4),V.readPixels(hn,Hr,en,Bt,6408,Qr,gr),gr}return function(qr){return qr&&"framebuffer"in qr?function(qr){var Qr;return ke.setFBO({framebuffer:qr.framebuffer},function(){Qr=Zr(qr)}),Qr}(qr):Zr(qr)}}function Rn(V){return Array.prototype.slice.call(V)}function ki(V){return Rn(V).join("")}var gi="xyzw".split(""),Pt="blend.enable",bt="blend.color",rr="blend.equation",jr="blend.func",Mn="depth.enable",Xn="depth.func",ni="depth.range",Ci="depth.mask",wi="colorMask",ea="cull.enable",xa="cull.face",ua="frontFace",Ha="lineWidth",Wa="polygonOffset.enable",Ka="polygonOffset.offset",ia="sample.alpha",ga="sample.enable",la="sample.coverage",no="stencil.enable",Li="stencil.mask",Ca="stencil.func",ba="stencil.opFront",go="stencil.opBack",Yl="scissor.enable",uu="scissor.box",Ko="viewport",wu="profile",Hu="framebuffer",ul="vert",Ys="frag",Kl="elements",Wu="primitive",ca="count",Hf="offset",Tl="instances",Wf="vao",Ks="Width",xh="Height",Dc=Hu+Ks,hc=Hu+xh,Xf="drawingBuffer",ll=Xf+Ks,qc=Xf+xh,$h=[jr,rr,Ca,ba,go,la,Ko,uu,Ka],hf=34962,pf=35664,Pf=35665,Fc=35666,Mu=35667,Yf=35668,Cl=35669,Mf=35671,If=35672,Qc=35673,vf=35674,Ns=35675,Kf=35676,_s=35678,ql=35680,ef=1028,Js=1029,rf=7680,Iu={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Ch=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],Al={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Jl={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ah={frag:35632,vert:35633},$f={cw:2304,ccw:2305};function yf(V){return Array.isArray(V)||w(V)||vt(V)}function kf(V){return V.sort(function(ke,Qe){return ke===Ko?-1:Qe===Ko?1:ke<Qe?-1:1})}function as(V,ke,Qe,ir){this.thisDep=V,this.contextDep=ke,this.propDep=Qe,this.append=ir}function Zo(V){return V&&!(V.thisDep||V.contextDep||V.propDep)}function os(V){return new as(!1,!1,!1,V)}function cu(V,ke){var Qe=V.type;if(0===Qe){var ir=V.data.length;return new as(!0,ir>=1,ir>=2,ke)}if(4===Qe){var kr=V.data;return new as(kr.thisDep,kr.contextDep,kr.propDep,ke)}if(5===Qe)return new as(!1,!1,!1,ke);if(6===Qe){for(var tr=!1,Er=!1,Zr=!1,Gr=0;Gr<V.data.length;++Gr){var Kr=V.data[Gr];if(1===Kr.type)Zr=!0;else if(2===Kr.type)Er=!0;else if(3===Kr.type)tr=!0;else if(0===Kr.type){tr=!0;var qr=Kr.data;qr>=1&&(Er=!0),qr>=2&&(Zr=!0)}else 4===Kr.type&&(tr=tr||Kr.data.thisDep,Er=Er||Kr.data.contextDep,Zr=Zr||Kr.data.propDep)}return new as(tr,Er,Zr,ke)}return new as(3===Qe,2===Qe,1===Qe,ke)}var Ph=new as(!1,!1,!1,function(){});function Ap(V,ke,Qe,ir,kr,tr,Er,Zr,Gr,Kr,qr,Qr,hn,Hr,en){var Bt=Kr.Record,gr={add:32774,subtract:32778,"reverse subtract":32779};Qe.ext_blend_minmax&&(gr.min=32775,gr.max=32776);var Wr=Qe.angle_instanced_arrays,Tn=Qe.webgl_draw_buffers,Mr=Qe.oes_vertex_array_object,bn={dirty:!0,profile:en.profile},tn={},ui=[],Or={},Sr={};function jn(Ne){return Ne.replace(".","_")}function dn(Ne,Ce,lt){var Ft=jn(Ne);ui.push(Ne),tn[Ft]=bn[Ft]=!!lt,Or[Ft]=Ce}function Jr(Ne,Ce,lt){var Ft=jn(Ne);ui.push(Ne),Array.isArray(lt)?(bn[Ft]=lt.slice(),tn[Ft]=lt.slice()):bn[Ft]=tn[Ft]=lt,Sr[Ft]=Ce}dn("dither",3024),dn(Pt,3042),Jr(bt,"blendColor",[0,0,0,0]),Jr(rr,"blendEquationSeparate",[32774,32774]),Jr(jr,"blendFuncSeparate",[1,0,1,0]),dn(Mn,2929,!0),Jr(Xn,"depthFunc",513),Jr(ni,"depthRange",[0,1]),Jr(Ci,"depthMask",!0),Jr(wi,wi,[!0,!0,!0,!0]),dn(ea,2884),Jr(xa,"cullFace",Js),Jr(ua,ua,2305),Jr(Ha,Ha,1),dn(Wa,32823),Jr(Ka,"polygonOffset",[0,0]),dn(ia,32926),dn(ga,32928),Jr(la,"sampleCoverage",[1,!1]),dn(no,2960),Jr(Li,"stencilMask",-1),Jr(Ca,"stencilFunc",[519,0,-1]),Jr(ba,"stencilOpSeparate",[ef,rf,rf,rf]),Jr(go,"stencilOpSeparate",[Js,rf,rf,rf]),dn(Yl,3089),Jr(uu,"scissor",[0,0,V.drawingBufferWidth,V.drawingBufferHeight]),Jr(Ko,Ko,[0,0,V.drawingBufferWidth,V.drawingBufferHeight]);var yn={gl:V,context:hn,strings:ke,next:tn,current:bn,draw:Qr,elements:tr,buffer:kr,shader:qr,attributes:Kr.state,vao:Kr,uniforms:Gr,framebuffer:Zr,extensions:Qe,timer:Hr,isBufferArgs:yf},wn={primTypes:Ir,compareFuncs:Al,blendFuncs:Iu,blendEquations:gr,stencilOps:Jl,glTypes:Qs,orientationType:$f};B.optional(function(){yn.isArrayLike=oo}),Tn&&(wn.backBuffer=[Js],wn.drawBuffer=ye(ir.maxDrawbuffers,function(Ne){return 0===Ne?[0]:ye(Ne,function(Ce){return 36064+Ce})}));var zi=0;function Mi(){var Ne=function(){var V=0,ke=[],Qe=[];function kr(){var Qr=[],Hr=[];return p(function(){Qr.push.apply(Qr,Rn(arguments))},{def:function(){var Bt="v"+V++;return Hr.push(Bt),arguments.length>0&&(Qr.push(Bt,"="),Qr.push.apply(Qr,Rn(arguments)),Qr.push(";")),Bt},toString:function(){return ki([Hr.length>0?"var "+Hr.join(",")+";":"",ki(Qr)])}})}function tr(){var Qr=kr(),hn=kr(),Hr=Qr.toString,en=hn.toString;function Bt(gr,Wr){hn(gr,Wr,"=",Qr.def(gr,Wr),";")}return p(function(){Qr.apply(Qr,Rn(arguments))},{def:Qr.def,entry:Qr,exit:hn,save:Bt,set:function(gr,Wr,Tn){Bt(gr,Wr),Qr(gr,Wr,"=",Tn,";")},toString:function(){return Hr()+en()}})}var Zr=kr(),Gr={};return{global:Zr,link:function(Qr){for(var hn=0;hn<Qe.length;++hn)if(Qe[hn]===Qr)return ke[hn];var Hr="g"+V++;return ke.push(Hr),Qe.push(Qr),Hr},block:kr,proc:function(Qr,hn){var Hr=[];function en(){var Mr="a"+Hr.length;return Hr.push(Mr),Mr}hn=hn||0;for(var Bt=0;Bt<hn;++Bt)en();var gr=tr(),Wr=gr.toString;return Gr[Qr]=p(gr,{arg:en,toString:function(){return ki(["function(",Hr.join(),"){",Wr(),"}"])}})},scope:tr,cond:function(){var Qr=ki(arguments),hn=tr(),Hr=tr(),en=hn.toString,Bt=Hr.toString;return p(hn,{then:function(){return hn.apply(hn,Rn(arguments)),this},else:function(){return Hr.apply(Hr,Rn(arguments)),this},toString:function(){var gr=Bt();return gr&&(gr="else{"+gr+"}"),ki(["if(",Qr,"){",en(),"}",gr])}})},compile:function(){var Qr=['"use strict";',Zr,"return {"];Object.keys(Gr).forEach(function(Bt){Qr.push('"',Bt,'":',Gr[Bt].toString(),",")}),Qr.push("}");var hn=ki(Qr).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return("undefined"!=typeof my&&my&&"function"==typeof my.showToast?ue.Function.apply(null,ke.concat(hn)):Function.apply(null,ke.concat(hn))).apply(null,Qe)}}}(),Ce=Ne.link,lt=Ne.global;Ne.id=zi++,Ne.batchId="0";var Ft=Ce(yn),ar=Ne.shared={props:"a0"};Object.keys(yn).forEach(function(ot){ar[ot]=lt.def(Ft,".",ot)}),B.optional(function(){Ne.CHECK=Ce(B),Ne.commandStr=B.guessCommand(),Ne.command=Ce(Ne.commandStr),Ne.assert=function(ot,Ze,Nt){ot("if(!(",Ze,"))",this.CHECK,".commandRaise(",Ce(Nt),",",this.command,");")},wn.invalidBlendCombinations=Ch});var yt=Ne.next={},ht=Ne.current={};Object.keys(Sr).forEach(function(ot){Array.isArray(bn[ot])&&(yt[ot]=lt.def(ar.next,".",ot),ht[ot]=lt.def(ar.current,".",ot))});var ut=Ne.constants={};Object.keys(wn).forEach(function(ot){ut[ot]=lt.def(JSON.stringify(wn[ot]))}),Ne.invoke=function(ot,Ze){switch(Ze.type){case 0:var Nt=["this",ar.context,ar.props,Ne.batchId];return ot.def(Ce(Ze.data),".call(",Nt.slice(0,Math.max(Ze.data.length+1,4)),")");case 1:return ot.def(ar.props,Ze.data);case 2:return ot.def(ar.context,Ze.data);case 3:return ot.def("this",Ze.data);case 4:return Ze.data.append(Ne,ot),Ze.data.ref;case 5:return Ze.data.toString();case 6:return Ze.data.map(function(Gt){return Ne.invoke(ot,Gt)})}},Ne.attribCache={};var Be={};return Ne.scopeAttrib=function(ot){var Ze=ke.id(ot);if(Ze in Be)return Be[Ze];var Nt=Kr.scope[Ze];return Nt||(Nt=Kr.scope[Ze]=new Bt),Be[Ze]=Ce(Nt)},Ne}function vs(Ne,Ce,lt,Ft,ar){var yt=Ne.static,ht=Ne.dynamic;B.optional(function(){var In=[Hu,ul,Ys,Kl,Wu,Hf,ca,Tl,wu,Wf].concat(ui);function Vn(Kn){Object.keys(Kn).forEach(function(Gn){B.command(In.indexOf(Gn)>=0,'unknown parameter "'+Gn+'"',ar.commandStr)})}Vn(yt),Vn(ht)});var ut=function(Ne,Ce){var lt=Ne.static;if("string"==typeof lt[Ys]&&"string"==typeof lt[ul]){if(Object.keys(Ce.dynamic).length>0)return null;var ar=Ce.static,yt=Object.keys(ar);if(yt.length>0&&"number"==typeof ar[yt[0]]){for(var ht=[],ut=0;ut<yt.length;++ut)B("number"==typeof ar[yt[ut]],"must specify all vertex attribute locations when using vaos"),ht.push([0|ar[yt[ut]],yt[ut]]);return ht}}return null}(Ne,Ce),Be=function(Ne,Ce){var lt=Ne.static,Ft=Ne.dynamic;if(Hu in lt){var ar=lt[Hu];return ar?(ar=Zr.getFramebuffer(ar),B.command(ar,"invalid framebuffer object"),os(function(ht,ut){var Be=ht.link(ar),ot=ht.shared;ut.set(ot.framebuffer,".next",Be);var Ze=ot.context;return ut.set(Ze,"."+Dc,Be+".width"),ut.set(Ze,"."+hc,Be+".height"),Be})):os(function(ht,ut){var Be=ht.shared;ut.set(Be.framebuffer,".next","null");var ot=Be.context;return ut.set(ot,"."+Dc,ot+"."+ll),ut.set(ot,"."+hc,ot+"."+qc),"null"})}if(Hu in Ft){var yt=Ft[Hu];return cu(yt,function(ht,ut){var Be=ht.invoke(ut,yt),ot=ht.shared,Ze=ot.framebuffer,Nt=ut.def(Ze,".getFramebuffer(",Be,")");B.optional(function(){ht.assert(ut,"!"+Be+"||"+Nt,"invalid framebuffer object")}),ut.set(Ze,".next",Nt);var Gt=ot.context;return ut.set(Gt,"."+Dc,Nt+"?"+Nt+".width:"+Gt+"."+ll),ut.set(Gt,"."+hc,Nt+"?"+Nt+".height:"+Gt+"."+qc),Nt})}return null}(Ne),ot=function(Ne,Ce,lt){var Ft=Ne.static,ar=Ne.dynamic;function yt(Be){if(Be in Ft){var ot=Ft[Be];B.commandType(ot,"object","invalid "+Be,lt.commandStr);var zr,sn,Ze=!0,Nt=0|ot.x,Gt=0|ot.y;return"width"in ot?B.command((zr=0|ot.width)>=0,"invalid "+Be,lt.commandStr):Ze=!1,"height"in ot?B.command((sn=0|ot.height)>=0,"invalid "+Be,lt.commandStr):Ze=!1,new as(!Ze&&Ce&&Ce.thisDep,!Ze&&Ce&&Ce.contextDep,!Ze&&Ce&&Ce.propDep,function(an,Yn){var In=an.shared.context,Vn=zr;"width"in ot||(Vn=Yn.def(In,".",Dc,"-",Nt));var Kn=sn;return"height"in ot||(Kn=Yn.def(In,".",hc,"-",Gt)),[Nt,Gt,Vn,Kn]})}if(Be in ar){var un=ar[Be],_n=cu(un,function(an,Yn){var In=an.invoke(Yn,un);B.optional(function(){an.assert(Yn,In+"&&typeof "+In+'==="object"',"invalid "+Be)});var Vn=an.shared.context,Kn=Yn.def(In,".x|0"),Gn=Yn.def(In,".y|0"),ci=Yn.def('"width" in ',In,"?",In,".width|0:","(",Vn,".",Dc,"-",Kn,")"),qa=Yn.def('"height" in ',In,"?",In,".height|0:","(",Vn,".",hc,"-",Gn,")");return B.optional(function(){an.assert(Yn,ci+">=0&&"+qa+">=0","invalid "+Be)}),[Kn,Gn,ci,qa]});return Ce&&(_n.thisDep=_n.thisDep||Ce.thisDep,_n.contextDep=_n.contextDep||Ce.contextDep,_n.propDep=_n.propDep||Ce.propDep),_n}return Ce?new as(Ce.thisDep,Ce.contextDep,Ce.propDep,function(an,Yn){var In=an.shared.context;return[0,0,Yn.def(In,".",Dc),Yn.def(In,".",hc)]}):null}var ht=yt(Ko);if(ht){var ut=ht;ht=new as(ht.thisDep,ht.contextDep,ht.propDep,function(Be,ot){var Ze=ut.append(Be,ot),Nt=Be.shared.context;return ot.set(Nt,".viewportWidth",Ze[2]),ot.set(Nt,".viewportHeight",Ze[3]),Ze})}return{viewport:ht,scissor_box:yt(uu)}}(Ne,Be,ar),Ze=function(Ne,Ce){var lt=Ne.static,Ft=Ne.dynamic,ar={},yt=!1,ut=function(){if(Wf in lt){var Yn=lt[Wf];return null!==Yn&&null===Kr.getVAO(Yn)&&(Yn=Kr.createVAO(Yn)),yt=!0,ar.vao=Yn,os(function(Vn){var Kn=Kr.getVAO(Yn);return Kn?Vn.link(Kn):"null"})}if(Wf in Ft){yt=!0;var In=Ft[Wf];return cu(In,function(Vn,Kn){var Gn=Vn.invoke(Kn,In);return Kn.def(Vn.shared.vao+".getVAO("+Gn+")")})}return null}(),Be=!1,Ze=function(){if(Kl in lt){var Yn=lt[Kl];if(ar.elements=Yn,yf(Yn)){var In=ar.elements=tr.create(Yn,!0);Yn=tr.getElements(In),Be=!0}else Yn&&(Yn=tr.getElements(Yn),Be=!0,B.command(Yn,"invalid elements",Ce.commandStr));var Vn=os(function(Gn,ci){if(Yn){var qa=Gn.link(Yn);return Gn.ELEMENTS=qa,qa}return Gn.ELEMENTS=null,null});return Vn.value=Yn,Vn}if(Kl in Ft){Be=!0;var Kn=Ft[Kl];return cu(Kn,function(Gn,ci){var qa=Gn.shared,jo=qa.isBufferArgs,$l=qa.elements,ao=Gn.invoke(ci,Kn),Fa=ci.def("null"),zs=ci.def(jo,"(",ao,")"),Xu=Gn.cond(zs).then(Fa,"=",$l,".createStream(",ao,");").else(Fa,"=",$l,".getElements(",ao,");");return B.optional(function(){Gn.assert(Xu.else,"!"+ao+"||"+Fa,"invalid elements")}),ci.entry(Xu),ci.exit(Gn.cond(zs).then($l,".destroyStream(",Fa,");")),Gn.ELEMENTS=Fa,Fa})}return yt?new as(ut.thisDep,ut.contextDep,ut.propDep,function(Gn,ci){return ci.def(Gn.shared.vao+".currentVAO?"+Gn.shared.elements+".getElements("+Gn.shared.vao+".currentVAO.elements):null")}):null}();function Gt(Yn,In){if(Yn in lt){var Vn=0|lt[Yn];return In?ar.offset=Vn:ar.instances=Vn,B.command(!In||Vn>=0,"invalid "+Yn,Ce.commandStr),os(function(Gn,ci){return In&&(Gn.OFFSET=Vn),Vn})}if(Yn in Ft){var Kn=Ft[Yn];return cu(Kn,function(Gn,ci){var qa=Gn.invoke(ci,Kn);return In&&(Gn.OFFSET=qa,B.optional(function(){Gn.assert(ci,qa+">=0","invalid "+Yn)})),qa})}if(In){if(Be)return os(function(Gn,ci){return Gn.OFFSET=0,0});if(yt)return new as(ut.thisDep,ut.contextDep,ut.propDep,function(Gn,ci){return ci.def(Gn.shared.vao+".currentVAO?"+Gn.shared.vao+".currentVAO.offset:0")})}else if(yt)return new as(ut.thisDep,ut.contextDep,ut.propDep,function(Gn,ci){return ci.def(Gn.shared.vao+".currentVAO?"+Gn.shared.vao+".currentVAO.instances:-1")});return null}var zr=Gt(Hf,!0),un=function(){if(Wu in lt){var Yn=lt[Wu];return ar.primitive=Yn,B.commandParameter(Yn,Ir,"invalid primitve",Ce.commandStr),os(function(Vn,Kn){return Ir[Yn]})}if(Wu in Ft){var In=Ft[Wu];return cu(In,function(Vn,Kn){var Gn=Vn.constants.primTypes,ci=Vn.invoke(Kn,In);return B.optional(function(){Vn.assert(Kn,ci+" in "+Gn,"invalid primitive, must be one of "+Object.keys(Ir))}),Kn.def(Gn,"[",ci,"]")})}return Be?Zo(Ze)?os(Ze.value?function(Vn,Kn){return Kn.def(Vn.ELEMENTS,".primType")}:function(){return 4}):new as(Ze.thisDep,Ze.contextDep,Ze.propDep,function(Vn,Kn){var Gn=Vn.ELEMENTS;return Kn.def(Gn,"?",Gn,".primType:",4)}):yt?new as(ut.thisDep,ut.contextDep,ut.propDep,function(Vn,Kn){return Kn.def(Vn.shared.vao+".currentVAO?"+Vn.shared.vao+".currentVAO.primitive:4")}):null}(),_n=function(){if(ca in lt){var Yn=0|lt[ca];return ar.count=Yn,B.command("number"==typeof Yn&&Yn>=0,"invalid vertex count",Ce.commandStr),os(function(){return Yn})}if(ca in Ft){var In=Ft[ca];return cu(In,function(ci,qa){var jo=ci.invoke(qa,In);return B.optional(function(){ci.assert(qa,"typeof "+jo+'==="number"&&'+jo+">=0&&"+jo+"===("+jo+"|0)","invalid vertex count")}),jo})}if(Be){if(Zo(Ze)){if(Ze)return zr?new as(zr.thisDep,zr.contextDep,zr.propDep,function(ci,qa){var jo=qa.def(ci.ELEMENTS,".vertCount-",ci.OFFSET);return B.optional(function(){ci.assert(qa,jo+">=0","invalid vertex offset/element buffer too small")}),jo}):os(function(ci,qa){return qa.def(ci.ELEMENTS,".vertCount")});var Vn=os(function(){return-1});return B.optional(function(){Vn.MISSING=!0}),Vn}var Kn=new as(Ze.thisDep||zr.thisDep,Ze.contextDep||zr.contextDep,Ze.propDep||zr.propDep,function(ci,qa){var jo=ci.ELEMENTS;return ci.OFFSET?qa.def(jo,"?",jo,".vertCount-",ci.OFFSET,":-1"):qa.def(jo,"?",jo,".vertCount:-1")});return B.optional(function(){Kn.DYNAMIC=!0}),Kn}return yt?new as(ut.thisDep,ut.contextDep,ut.propDep,function(ci,qa){return qa.def(ci.shared.vao,".currentVAO?",ci.shared.vao,".currentVAO.count:-1")}):null}(),an=Gt(Tl,!1);return{elements:Ze,primitive:un,count:_n,instances:an,offset:zr,vao:ut,vaoActive:yt,elementsActive:Be,static:ar}}(Ne,ar),Nt=function(Ne,Ce){var lt=Ne.static,Ft=Ne.dynamic,ar={};return ui.forEach(function(yt){var ht=jn(yt);function ut(Be,ot){if(yt in lt){var Ze=Be(lt[yt]);ar[ht]=os(function(){return Ze})}else if(yt in Ft){var Nt=Ft[yt];ar[ht]=cu(Nt,function(Gt,zr){return ot(Gt,zr,Gt.invoke(zr,Nt))})}}switch(yt){case ea:case Pt:case"dither":case no:case Mn:case Yl:case Wa:case ia:case ga:case Ci:return ut(function(Be){return B.commandType(Be,"boolean",yt,Ce.commandStr),Be},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,"typeof "+Ze+'==="boolean"',"invalid flag "+yt,Be.commandStr)}),Ze});case Xn:return ut(function(Be){return B.commandParameter(Be,Al,"invalid "+yt,Ce.commandStr),Al[Be]},function(Be,ot,Ze){var Nt=Be.constants.compareFuncs;return B.optional(function(){Be.assert(ot,Ze+" in "+Nt,"invalid "+yt+", must be one of "+Object.keys(Al))}),ot.def(Nt,"[",Ze,"]")});case ni:return ut(function(Be){return B.command(oo(Be)&&2===Be.length&&"number"==typeof Be[0]&&"number"==typeof Be[1]&&Be[0]<=Be[1],"depth range is 2d array",Ce.commandStr),Be},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,Be.shared.isArrayLike+"("+Ze+")&&"+Ze+".length===2&&typeof "+Ze+'[0]==="number"&&typeof '+Ze+'[1]==="number"&&'+Ze+"[0]<="+Ze+"[1]","depth range must be a 2d array")}),[ot.def("+",Ze,"[0]"),ot.def("+",Ze,"[1]")]});case jr:return ut(function(Be){B.commandType(Be,"object","blend.func",Ce.commandStr);var ot="srcRGB"in Be?Be.srcRGB:Be.src,Ze="srcAlpha"in Be?Be.srcAlpha:Be.src,Nt="dstRGB"in Be?Be.dstRGB:Be.dst,Gt="dstAlpha"in Be?Be.dstAlpha:Be.dst;return B.commandParameter(ot,Iu,ht+".srcRGB",Ce.commandStr),B.commandParameter(Ze,Iu,ht+".srcAlpha",Ce.commandStr),B.commandParameter(Nt,Iu,ht+".dstRGB",Ce.commandStr),B.commandParameter(Gt,Iu,ht+".dstAlpha",Ce.commandStr),B.command(-1===Ch.indexOf(ot+", "+Nt),"unallowed blending combination (srcRGB, dstRGB) = ("+ot+", "+Nt+")",Ce.commandStr),[Iu[ot],Iu[Nt],Iu[Ze],Iu[Gt]]},function(Be,ot,Ze){var Nt=Be.constants.blendFuncs;function Gt(In,Vn){var Kn=ot.def('"',In,Vn,'" in ',Ze,"?",Ze,".",In,Vn,":",Ze,".",In);return B.optional(function(){Be.assert(ot,Kn+" in "+Nt,"invalid "+yt+"."+In+Vn+", must be one of "+Object.keys(Iu))}),Kn}B.optional(function(){Be.assert(ot,Ze+"&&typeof "+Ze+'==="object"',"invalid blend func, must be an object")});var zr=Gt("src","RGB"),sn=Gt("dst","RGB");B.optional(function(){Be.assert(ot,Be.constants.invalidBlendCombinations+".indexOf("+zr+'+", "+'+sn+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var un=ot.def(Nt,"[",zr,"]"),_n=ot.def(Nt,"[",Gt("src","Alpha"),"]");return[un,ot.def(Nt,"[",sn,"]"),_n,ot.def(Nt,"[",Gt("dst","Alpha"),"]")]});case rr:return ut(function(Be){return"string"==typeof Be?(B.commandParameter(Be,gr,"invalid "+yt,Ce.commandStr),[gr[Be],gr[Be]]):"object"==typeof Be?(B.commandParameter(Be.rgb,gr,yt+".rgb",Ce.commandStr),B.commandParameter(Be.alpha,gr,yt+".alpha",Ce.commandStr),[gr[Be.rgb],gr[Be.alpha]]):void B.commandRaise("invalid blend.equation",Ce.commandStr)},function(Be,ot,Ze){var Nt=Be.constants.blendEquations,Gt=ot.def(),zr=ot.def(),sn=Be.cond("typeof ",Ze,'==="string"');return B.optional(function(){function un(_n,an,Yn){Be.assert(_n,Yn+" in "+Nt,"invalid "+an+", must be one of "+Object.keys(gr))}un(sn.then,yt,Ze),Be.assert(sn.else,Ze+"&&typeof "+Ze+'==="object"',"invalid "+yt),un(sn.else,yt+".rgb",Ze+".rgb"),un(sn.else,yt+".alpha",Ze+".alpha")}),sn.then(Gt,"=",zr,"=",Nt,"[",Ze,"];"),sn.else(Gt,"=",Nt,"[",Ze,".rgb];",zr,"=",Nt,"[",Ze,".alpha];"),ot(sn),[Gt,zr]});case bt:return ut(function(Be){return B.command(oo(Be)&&4===Be.length,"blend.color must be a 4d array",Ce.commandStr),ye(4,function(ot){return+Be[ot]})},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,Be.shared.isArrayLike+"("+Ze+")&&"+Ze+".length===4","blend.color must be a 4d array")}),ye(4,function(Nt){return ot.def("+",Ze,"[",Nt,"]")})});case Li:return ut(function(Be){return B.commandType(Be,"number",ht,Ce.commandStr),0|Be},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,"typeof "+Ze+'==="number"',"invalid stencil.mask")}),ot.def(Ze,"|0")});case Ca:return ut(function(Be){B.commandType(Be,"object",ht,Ce.commandStr);var ot=Be.cmp||"keep",Ze=Be.ref||0,Nt="mask"in Be?Be.mask:-1;return B.commandParameter(ot,Al,yt+".cmp",Ce.commandStr),B.commandType(Ze,"number",yt+".ref",Ce.commandStr),B.commandType(Nt,"number",yt+".mask",Ce.commandStr),[Al[ot],Ze,Nt]},function(Be,ot,Ze){var Nt=Be.constants.compareFuncs;return B.optional(function(){function un(){Be.assert(ot,Array.prototype.join.call(arguments,""),"invalid stencil.func")}un(Ze+"&&typeof ",Ze,'==="object"'),un('!("cmp" in ',Ze,")||(",Ze,".cmp in ",Nt,")")}),[ot.def('"cmp" in ',Ze,"?",Nt,"[",Ze,".cmp]",":",rf),ot.def(Ze,".ref|0"),ot.def('"mask" in ',Ze,"?",Ze,".mask|0:-1")]});case ba:case go:return ut(function(Be){B.commandType(Be,"object",ht,Ce.commandStr);var ot=Be.fail||"keep",Ze=Be.zfail||"keep",Nt=Be.zpass||"keep";return B.commandParameter(ot,Jl,yt+".fail",Ce.commandStr),B.commandParameter(Ze,Jl,yt+".zfail",Ce.commandStr),B.commandParameter(Nt,Jl,yt+".zpass",Ce.commandStr),[yt===go?Js:ef,Jl[ot],Jl[Ze],Jl[Nt]]},function(Be,ot,Ze){var Nt=Be.constants.stencilOps;function Gt(zr){return B.optional(function(){Be.assert(ot,'!("'+zr+'" in '+Ze+")||("+Ze+"."+zr+" in "+Nt+")","invalid "+yt+"."+zr+", must be one of "+Object.keys(Jl))}),ot.def('"',zr,'" in ',Ze,"?",Nt,"[",Ze,".",zr,"]:",rf)}return B.optional(function(){Be.assert(ot,Ze+"&&typeof "+Ze+'==="object"',"invalid "+yt)}),[yt===go?Js:ef,Gt("fail"),Gt("zfail"),Gt("zpass")]});case Ka:return ut(function(Be){B.commandType(Be,"object",ht,Ce.commandStr);var ot=0|Be.factor,Ze=0|Be.units;return B.commandType(ot,"number",ht+".factor",Ce.commandStr),B.commandType(Ze,"number",ht+".units",Ce.commandStr),[ot,Ze]},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,Ze+"&&typeof "+Ze+'==="object"',"invalid "+yt)}),[ot.def(Ze,".factor|0"),ot.def(Ze,".units|0")]});case xa:return ut(function(Be){var ot=0;return"front"===Be?ot=ef:"back"===Be&&(ot=Js),B.command(!!ot,ht,Ce.commandStr),ot},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,Ze+'==="front"||'+Ze+'==="back"',"invalid cull.face")}),ot.def(Ze,'==="front"?',ef,":",Js)});case Ha:return ut(function(Be){return B.command("number"==typeof Be&&Be>=ir.lineWidthDims[0]&&Be<=ir.lineWidthDims[1],"invalid line width, must be a positive number between "+ir.lineWidthDims[0]+" and "+ir.lineWidthDims[1],Ce.commandStr),Be},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,"typeof "+Ze+'==="number"&&'+Ze+">="+ir.lineWidthDims[0]+"&&"+Ze+"<="+ir.lineWidthDims[1],"invalid line width")}),Ze});case ua:return ut(function(Be){return B.commandParameter(Be,$f,ht,Ce.commandStr),$f[Be]},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,Ze+'==="cw"||'+Ze+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),ot.def(Ze+'==="cw"?2304:2305')});case wi:return ut(function(Be){return B.command(oo(Be)&&4===Be.length,"color.mask must be length 4 array",Ce.commandStr),Be.map(function(ot){return!!ot})},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,Be.shared.isArrayLike+"("+Ze+")&&"+Ze+".length===4","invalid color.mask")}),ye(4,function(Nt){return"!!"+Ze+"["+Nt+"]"})});case la:return ut(function(Be){B.command("object"==typeof Be&&Be,ht,Ce.commandStr);var ot="value"in Be?Be.value:1,Ze=!!Be.invert;return B.command("number"==typeof ot&&ot>=0&&ot<=1,"sample.coverage.value must be a number between 0 and 1",Ce.commandStr),[ot,Ze]},function(Be,ot,Ze){return B.optional(function(){Be.assert(ot,Ze+"&&typeof "+Ze+'==="object"',"invalid sample.coverage")}),[ot.def('"value" in ',Ze,"?+",Ze,".value:1"),ot.def("!!",Ze,".invert")]})}}),ar}(Ne,ar),Gt=function(Ne,Ce,lt){var Ft=Ne.static,ar=Ne.dynamic;function yt(Ze){if(Ze in Ft){var Nt=ke.id(Ft[Ze]);B.optional(function(){qr.shader(Ah[Ze],Nt,B.guessCommand())});var Gt=os(function(){return Nt});return Gt.id=Nt,Gt}if(Ze in ar){var zr=ar[Ze];return cu(zr,function(sn,un){var _n=sn.invoke(un,zr),an=un.def(sn.shared.strings,".id(",_n,")");return B.optional(function(){un(sn.shared.shader,".shader(",Ah[Ze],",",an,",",sn.command,");")}),an})}return null}var ot,ht=yt(Ys),ut=yt(ul),Be=null;return Zo(ht)&&Zo(ut)?(Be=qr.program(ut.id,ht.id,null,lt),ot=os(function(Ze,Nt){return Ze.link(Be)})):ot=new as(ht&&ht.thisDep||ut&&ut.thisDep,ht&&ht.contextDep||ut&&ut.contextDep,ht&&ht.propDep||ut&&ut.propDep,function(Ze,Nt){var zr,Gt=Ze.shared.shader;zr=ht?ht.append(Ze,Nt):Nt.def(Gt,".",Ys);var un=Gt+".program("+(ut?ut.append(Ze,Nt):Nt.def(Gt,".",ul))+","+zr;return B.optional(function(){un+=","+Ze.command}),Nt.def(un+")")}),{frag:ht,vert:ut,progVar:ot,program:Be}}(Ne,0,ut);function zr(In){var Vn=ot[In];Vn&&(Nt[In]=Vn)}zr(Ko),zr(jn(uu));var sn=Object.keys(Nt).length>0,un={framebuffer:Be,draw:Ze,shader:Gt,state:Nt,dirty:sn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(un.profile=function(Ne){var Ft,Ce=Ne.static,lt=Ne.dynamic;if(wu in Ce){var ar=!!Ce[wu];(Ft=os(function(ht,ut){return ar})).enable=ar}else if(wu in lt){var yt=lt[wu];Ft=cu(yt,function(ht,ut){return ht.invoke(ut,yt)})}return Ft}(Ne),un.uniforms=function(Ne,Ce){var lt=Ne.static,Ft=Ne.dynamic,ar={};return Object.keys(lt).forEach(function(yt){var ut,ht=lt[yt];if("number"==typeof ht||"boolean"==typeof ht)ut=os(function(){return ht});else if("function"==typeof ht){var Be=ht._reglType;"texture2d"===Be||"textureCube"===Be?ut=os(function(ot){return ot.link(ht)}):"framebuffer"===Be||"framebufferCube"===Be?(B.command(ht.color.length>0,'missing color attachment for framebuffer sent to uniform "'+yt+'"',Ce.commandStr),ut=os(function(ot){return ot.link(ht.color[0])})):B.commandRaise('invalid data for uniform "'+yt+'"',Ce.commandStr)}else oo(ht)?ut=os(function(ot){return ot.global.def("[",ye(ht.length,function(Nt){return B.command("number"==typeof ht[Nt]||"boolean"==typeof ht[Nt],"invalid uniform "+yt,ot.commandStr),ht[Nt]}),"]")}):B.commandRaise('invalid or missing data for uniform "'+yt+'"',Ce.commandStr);ut.value=ht,ar[yt]=ut}),Object.keys(Ft).forEach(function(yt){var ht=Ft[yt];ar[yt]=cu(ht,function(ut,Be){return ut.invoke(Be,ht)})}),ar}(lt,ar),un.drawVAO=un.scopeVAO=Ze.vao,!un.drawVAO&&Gt.program&&!ut&&Qe.angle_instanced_arrays&&Ze.static.elements){var _n=!0,an=Gt.program.attributes.map(function(In){var Vn=Ce.static[In];return _n=_n&&!!Vn,Vn});if(_n&&an.length>0){var Yn=Kr.getVAO(Kr.createVAO({attributes:an,elements:Ze.static.elements}));un.drawVAO=new as(null,null,null,function(In,Vn){return In.link(Yn)}),un.useVAO=!0}}return ut?un.useVAO=!0:un.attributes=function(Ne,Ce){var lt=Ne.static,Ft=Ne.dynamic,ar={};return Object.keys(lt).forEach(function(yt){var ht=lt[yt],ut=ke.id(yt),Be=new Bt;if(yf(ht))Be.state=1,Be.buffer=kr.getBuffer(kr.create(ht,hf,!1,!0)),Be.type=0;else{var ot=kr.getBuffer(ht);if(ot)Be.state=1,Be.buffer=ot,Be.type=0;else if(B.command("object"==typeof ht&&ht,"invalid data for attribute "+yt,Ce.commandStr),"constant"in ht){var Ze=ht.constant;Be.buffer="null",Be.state=2,"number"==typeof Ze?Be.x=Ze:(B.command(oo(Ze)&&Ze.length>0&&Ze.length<=4,"invalid constant for attribute "+yt,Ce.commandStr),gi.forEach(function(an,Yn){Yn<Ze.length&&(Be[an]=Ze[Yn])}))}else{ot=yf(ht.buffer)?kr.getBuffer(kr.create(ht.buffer,hf,!1,!0)):kr.getBuffer(ht.buffer),B.command(!!ot,'missing buffer for attribute "'+yt+'"',Ce.commandStr);var Nt=0|ht.offset;B.command(Nt>=0,'invalid offset for attribute "'+yt+'"',Ce.commandStr);var Gt=0|ht.stride;B.command(Gt>=0&&Gt<256,'invalid stride for attribute "'+yt+'", must be integer betweeen [0, 255]',Ce.commandStr);var zr=0|ht.size;B.command(!("size"in ht)||zr>0&&zr<=4,'invalid size for attribute "'+yt+'", must be 1,2,3,4',Ce.commandStr);var sn=!!ht.normalized,un=0;"type"in ht&&(B.commandParameter(ht.type,Qs,"invalid type for attribute "+yt,Ce.commandStr),un=Qs[ht.type]);var _n=0|ht.divisor;B.optional(function(){"divisor"in ht&&(B.command(0===_n||Wr,'cannot specify divisor for attribute "'+yt+'", instancing not supported',Ce.commandStr),B.command(_n>=0,'invalid divisor for attribute "'+yt+'"',Ce.commandStr));var an=Ce.commandStr,Yn=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(ht).forEach(function(In){B.command(Yn.indexOf(In)>=0,'unknown parameter "'+In+'" for attribute pointer "'+yt+'" (valid parameters are '+Yn+")",an)})}),Be.buffer=ot,Be.state=1,Be.size=zr,Be.normalized=sn,Be.type=un||ot.dtype,Be.offset=Nt,Be.stride=Gt,Be.divisor=_n}}ar[yt]=os(function(an,Yn){var In=an.attribCache;if(ut in In)return In[ut];var Vn={isStream:!1};return Object.keys(Be).forEach(function(Kn){Vn[Kn]=Be[Kn]}),Be.buffer&&(Vn.buffer=an.link(Be.buffer),Vn.type=Vn.type||Vn.buffer+".dtype"),In[ut]=Vn,Vn})}),Object.keys(Ft).forEach(function(yt){var ht=Ft[yt];ar[yt]=cu(ht,function(Be,ot){var Ze=Be.invoke(ot,ht),Nt=Be.shared,Gt=Be.constants,zr=Nt.isBufferArgs,sn=Nt.buffer;B.optional(function(){Be.assert(ot,Ze+"&&(typeof "+Ze+'==="object"||typeof '+Ze+'==="function")&&('+zr+"("+Ze+")||"+sn+".getBuffer("+Ze+")||"+sn+".getBuffer("+Ze+".buffer)||"+zr+"("+Ze+'.buffer)||("constant" in '+Ze+"&&(typeof "+Ze+'.constant==="number"||'+Nt.isArrayLike+"("+Ze+".constant))))",'invalid dynamic attribute "'+yt+'"')});var un={isStream:ot.def(!1)},_n=new Bt;_n.state=1,Object.keys(_n).forEach(function(Vn){un[Vn]=ot.def(""+_n[Vn])});var an=un.buffer,Yn=un.type;function In(Vn){ot(un[Vn],"=",Ze,".",Vn,"|0;")}return ot("if(",zr,"(",Ze,")){",un.isStream,"=true;",an,"=",sn,".createStream(",hf,",",Ze,");",Yn,"=",an,".dtype;","}else{",an,"=",sn,".getBuffer(",Ze,");","if(",an,"){",Yn,"=",an,".dtype;",'}else if("constant" in ',Ze,"){",un.state,"=",2,";","if(typeof "+Ze+'.constant === "number"){',un[gi[0]],"=",Ze,".constant;",gi.slice(1).map(function(Vn){return un[Vn]}).join("="),"=0;","}else{",gi.map(function(Vn,Kn){return un[Vn]+"="+Ze+".constant.length>"+Kn+"?"+Ze+".constant["+Kn+"]:0;"}).join(""),"}}else{","if(",zr,"(",Ze,".buffer)){",an,"=",sn,".createStream(",hf,",",Ze,".buffer);","}else{",an,"=",sn,".getBuffer(",Ze,".buffer);","}",Yn,'="type" in ',Ze,"?",Gt.glTypes,"[",Ze,".type]:",an,".dtype;",un.normalized,"=!!",Ze,".normalized;"),In("size"),In("offset"),In("stride"),In("divisor"),ot("}}"),ot.exit("if(",un.isStream,"){",sn,".destroyStream(",an,");","}"),un})}),ar}(Ce,ar),un.context=function(Ne){var Ce=Ne.static,lt=Ne.dynamic,Ft={};return Object.keys(Ce).forEach(function(ar){var yt=Ce[ar];Ft[ar]=os(function(ht,ut){return"number"==typeof yt||"boolean"==typeof yt?""+yt:ht.link(yt)})}),Object.keys(lt).forEach(function(ar){var yt=lt[ar];Ft[ar]=cu(yt,function(ht,ut){return ht.invoke(ut,yt)})}),Ft}(Ft),un}function Uo(Ne,Ce,lt){var ar=Ne.shared.context,yt=Ne.scope();Object.keys(lt).forEach(function(ht){Ce.save(ar,"."+ht);var Be=lt[ht].append(Ne,Ce);Array.isArray(Be)?yt(ar,".",ht,"=[",Be.join(),"];"):yt(ar,".",ht,"=",Be,";")}),Ce(yt)}function ss(Ne,Ce,lt,Ft){var ut,ar=Ne.shared,yt=ar.gl,ht=ar.framebuffer;Tn&&(ut=Ce.def(ar.extensions,".webgl_draw_buffers"));var Nt,Be=Ne.constants,ot=Be.drawBuffer,Ze=Be.backBuffer;Nt=lt?lt.append(Ne,Ce):Ce.def(ht,".next"),Ft||Ce("if(",Nt,"!==",ht,".cur){"),Ce("if(",Nt,"){",yt,".bindFramebuffer(",36160,",",Nt,".framebuffer);"),Tn&&Ce(ut,".drawBuffersWEBGL(",ot,"[",Nt,".colorAttachments.length]);"),Ce("}else{",yt,".bindFramebuffer(",36160,",null);"),Tn&&Ce(ut,".drawBuffersWEBGL(",Ze,");"),Ce("}",ht,".cur=",Nt,";"),Ft||Ce("}")}function ms(Ne,Ce,lt){var Ft=Ne.shared,ar=Ft.gl,yt=Ne.current,ht=Ne.next,ut=Ft.current,Be=Ft.next,ot=Ne.cond(ut,".dirty");ui.forEach(function(Ze){var Gt,zr,Nt=jn(Ze);if(!(Nt in lt.state))if(Nt in ht){Gt=ht[Nt],zr=yt[Nt];var sn=ye(bn[Nt].length,function(_n){return ot.def(Gt,"[",_n,"]")});ot(Ne.cond(sn.map(function(_n,an){return _n+"!=="+zr+"["+an+"]"}).join("||")).then(ar,".",Sr[Nt],"(",sn,");",sn.map(function(_n,an){return zr+"["+an+"]="+_n}).join(";"),";"))}else{Gt=ot.def(Be,".",Nt);var un=Ne.cond(Gt,"!==",ut,".",Nt);ot(un),Nt in Or?un(Ne.cond(Gt).then(ar,".enable(",Or[Nt],");").else(ar,".disable(",Or[Nt],");"),ut,".",Nt,"=",Gt,";"):un(ar,".",Sr[Nt],"(",Gt,");",ut,".",Nt,"=",Gt,";")}}),0===Object.keys(lt.state).length&&ot(ut,".dirty=false;"),Ce(ot)}function us(Ne,Ce,lt,Ft){var ar=Ne.shared,yt=Ne.current,ht=ar.current,ut=ar.gl;kf(Object.keys(lt)).forEach(function(Be){var ot=lt[Be];if(!Ft||Ft(ot)){var Ze=ot.append(Ne,Ce);if(Or[Be]){var Nt=Or[Be];Zo(ot)?Ce(ut,Ze?".enable(":".disable(",Nt,");"):Ce(Ne.cond(Ze).then(ut,".enable(",Nt,");").else(ut,".disable(",Nt,");")),Ce(ht,".",Be,"=",Ze,";")}else if(oo(Ze)){var Gt=yt[Be];Ce(ut,".",Sr[Be],"(",Ze,");",Ze.map(function(zr,sn){return Gt+"["+sn+"]="+zr}).join(";"),";")}else Ce(ut,".",Sr[Be],"(",Ze,");",ht,".",Be,"=",Ze,";")}})}function Vo(Ne,Ce){Wr&&(Ne.instancing=Ce.def(Ne.shared.extensions,".angle_instanced_arrays"))}function Hi(Ne,Ce,lt,Ft,ar){var Nt,Gt,_n,yt=Ne.shared,ht=Ne.stats,ut=yt.current,Be=yt.timer,ot=lt.profile;function Ze(){return"undefined"!=typeof my&&my&&"function"==typeof my.showToast||"undefined"==typeof performance?"Date.now()":"performance.now()"}function zr(In){In(Nt=Ce.def(),"=",Ze(),";"),"string"==typeof ar?In(ht,".count+=",ar,";"):In(ht,".count++;"),Hr&&(Ft?In(Gt=Ce.def(),"=",Be,".getNumPendingQueries();"):In(Be,".beginQuery(",ht,");"))}function sn(In){In(ht,".cpuTime+=",Ze(),"-",Nt,";"),Hr&&(Ft?In(Be,".pushScopeStats(",Gt,",",Be,".getNumPendingQueries(),",ht,");"):In(Be,".endQuery();"))}function un(In){var Vn=Ce.def(ut,".profile");Ce(ut,".profile=",In,";"),Ce.exit(ut,".profile=",Vn,";")}if(ot){if(Zo(ot))return void(ot.enable?(zr(Ce),sn(Ce.exit),un("true")):un("false"));un(_n=ot.append(Ne,Ce))}else _n=Ce.def(ut,".profile");var an=Ne.block();zr(an),Ce("if(",_n,"){",an,"}");var Yn=Ne.block();sn(Yn),Ce.exit("if(",_n,"){",Yn,"}")}function ls(Ne,Ce,lt,Ft,ar){var yt=Ne.shared;Ft.forEach(function(Be){var Nt,ot=Be.name,Ze=lt.attributes[ot];if(Ze){if(!ar(Ze))return;Nt=Ze.append(Ne,Ce)}else{if(!ar(Ph))return;var Gt=Ne.scopeAttrib(ot);B.optional(function(){Ne.assert(Ce,Gt+".state","missing attribute "+ot)}),Nt={},Object.keys(new Bt).forEach(function(zr){Nt[zr]=Ce.def(Gt,".",zr)})}!function(Be,ot,Ze){var Nt=yt.gl,Gt=Ce.def(Be,".location"),zr=Ce.def(yt.attributes,"[",Gt,"]"),sn=Ze.state,un=Ze.buffer,_n=[Ze.x,Ze.y,Ze.z,Ze.w],an=["buffer","normalized","offset","stride"];function Yn(){Ce("if(!",zr,".buffer){",Nt,".enableVertexAttribArray(",Gt,");}");var Kn,Vn=Ze.type;if(Kn=Ze.size?Ce.def(Ze.size,"||",ot):ot,Ce("if(",zr,".type!==",Vn,"||",zr,".size!==",Kn,"||",an.map(function(ci){return zr+"."+ci+"!=="+Ze[ci]}).join("||"),"){",Nt,".bindBuffer(",hf,",",un,".buffer);",Nt,".vertexAttribPointer(",[Gt,Kn,Vn,Ze.normalized,Ze.stride,Ze.offset],");",zr,".type=",Vn,";",zr,".size=",Kn,";",an.map(function(ci){return zr+"."+ci+"="+Ze[ci]+";"}).join(""),"}"),Wr){var Gn=Ze.divisor;Ce("if(",zr,".divisor!==",Gn,"){",Ne.instancing,".vertexAttribDivisorANGLE(",[Gt,Gn],");",zr,".divisor=",Gn,";}")}}function In(){Ce("if(",zr,".buffer){",Nt,".disableVertexAttribArray(",Gt,");",zr,".buffer=null;","}if(",gi.map(function(Vn,Kn){return zr+"."+Vn+"!=="+_n[Kn]}).join("||"),"){",Nt,".vertexAttrib4f(",Gt,",",_n,");",gi.map(function(Vn,Kn){return zr+"."+Vn+"="+_n[Kn]+";"}).join(""),"}")}1===sn?Yn():2===sn?In():(Ce("if(",sn,"===",1,"){"),Yn(),Ce("}else{"),In(),Ce("}"))}(Ne.link(Be),function(Be){switch(Be){case pf:case Mu:case Mf:return 2;case Pf:case Yf:case If:return 3;case Fc:case Cl:case Qc:return 4;default:return 1}}(Be.info.type),Nt)})}function La(Ne,Ce,lt,Ft,ar,yt){for(var Be,ht=Ne.shared,ut=ht.gl,ot=0;ot<Ft.length;++ot){var _n,Ze=Ft[ot],Nt=Ze.name,Gt=Ze.info.type,zr=lt.uniforms[Nt],un=Ne.link(Ze)+".location";if(zr){if(!ar(zr))continue;if(Zo(zr)){var an=zr.value;if(B.command(null!=an,'missing uniform "'+Nt+'"',Ne.commandStr),Gt===_s||Gt===ql){B.command("function"==typeof an&&(Gt===_s&&("texture2d"===an._reglType||"framebuffer"===an._reglType)||Gt===ql&&("textureCube"===an._reglType||"framebufferCube"===an._reglType)),"invalid texture for uniform "+Nt,Ne.commandStr);var Yn=Ne.link(an._texture||an.color[0]._texture);Ce(ut,".uniform1i(",un,",",Yn+".bind());"),Ce.exit(Yn,".unbind();")}else if(Gt===vf||Gt===Ns||Gt===Kf){B.optional(function(){B.command(oo(an),"invalid matrix for uniform "+Nt,Ne.commandStr),B.command(Gt===vf&&4===an.length||Gt===Ns&&9===an.length||Gt===Kf&&16===an.length,"invalid length for matrix uniform "+Nt,Ne.commandStr)});var In=Ne.global.def("new Float32Array(["+Array.prototype.slice.call(an)+"])"),Vn=2;Gt===Ns?Vn=3:Gt===Kf&&(Vn=4),Ce(ut,".uniformMatrix",Vn,"fv(",un,",false,",In,");")}else{switch(Gt){case 5126:B.commandType(an,"number","uniform "+Nt,Ne.commandStr),Be="1f";break;case pf:B.command(oo(an)&&2===an.length,"uniform "+Nt,Ne.commandStr),Be="2f";break;case Pf:B.command(oo(an)&&3===an.length,"uniform "+Nt,Ne.commandStr),Be="3f";break;case Fc:B.command(oo(an)&&4===an.length,"uniform "+Nt,Ne.commandStr),Be="4f";break;case 35670:B.commandType(an,"boolean","uniform "+Nt,Ne.commandStr),Be="1i";break;case 5124:B.commandType(an,"number","uniform "+Nt,Ne.commandStr),Be="1i";break;case Mf:case Mu:B.command(oo(an)&&2===an.length,"uniform "+Nt,Ne.commandStr),Be="2i";break;case If:case Yf:B.command(oo(an)&&3===an.length,"uniform "+Nt,Ne.commandStr),Be="3i";break;case Qc:case Cl:B.command(oo(an)&&4===an.length,"uniform "+Nt,Ne.commandStr),Be="4i"}Ce(ut,".uniform",Be,"(",un,",",oo(an)?Array.prototype.slice.call(an):an,");")}continue}_n=zr.append(Ne,Ce)}else{if(!ar(Ph))continue;_n=Ce.def(ht.uniforms,"[",ke.id(Nt),"]")}Gt===_s?(B(!Array.isArray(_n),"must specify a scalar prop for textures"),Ce("if(",_n,"&&",_n,'._reglType==="framebuffer"){',_n,"=",_n,".color[0];","}")):Gt===ql&&(B(!Array.isArray(_n),"must specify a scalar prop for cube maps"),Ce("if(",_n,"&&",_n,'._reglType==="framebufferCube"){',_n,"=",_n,".color[0];","}")),B.optional(function(){function zs(Yu,Qf){Ne.assert(Ce,Yu,'bad data or missing for uniform "'+Nt+'".  '+Qf)}function Xu(Yu){B(!Array.isArray(_n),"must not specify an array type for uniform"),zs("typeof "+_n+'==="'+Yu+'"',"invalid type, expected "+Yu)}function Ou(Yu,Qf){Array.isArray(_n)?B(_n.length===Yu,"must have length "+Yu):zs(ht.isArrayLike+"("+_n+")&&"+_n+".length==="+Yu,"invalid vector, should have length "+Yu)}function Ih(Yu){B(!Array.isArray(_n),"must not specify a value type"),zs("typeof "+_n+'==="function"&&'+_n+'._reglType==="texture'+(3553===Yu?"2d":"Cube")+'"',"invalid texture type")}switch(Gt){case 5124:Xu("number");break;case Mu:Ou(2);break;case Yf:Ou(3);break;case Cl:Ou(4);break;case 5126:Xu("number");break;case pf:Ou(2);break;case Pf:Ou(3);break;case Fc:Ou(4);break;case 35670:Xu("boolean");break;case Mf:Ou(2);break;case If:Ou(3);break;case Qc:case vf:Ou(4);break;case Ns:Ou(9);break;case Kf:Ou(16);break;case _s:Ih(3553);break;case ql:Ih(34067)}});var Kn=1;switch(Gt){case _s:case ql:var Gn=Ce.def(_n,"._texture");Ce(ut,".uniform1i(",un,",",Gn,".bind());"),Ce.exit(Gn,".unbind();");continue;case 5124:case 35670:Be="1i";break;case Mu:case Mf:Be="2i",Kn=2;break;case Yf:case If:Be="3i",Kn=3;break;case Cl:case Qc:Be="4i",Kn=4;break;case 5126:Be="1f";break;case pf:Be="2f",Kn=2;break;case Pf:Be="3f",Kn=3;break;case Fc:Be="4f",Kn=4;break;case vf:Be="Matrix2fv";break;case Ns:Be="Matrix3fv";break;case Kf:Be="Matrix4fv"}if("M"===Be.charAt(0)){Ce(ut,".uniform",Be,"(",un,",");var ci=Math.pow(Gt-vf+2,2),qa=Ne.global.def("new Float32Array(",ci,")");Array.isArray(_n)?Ce("false,(",ye(ci,function(zs){return qa+"["+zs+"]="+_n[zs]}),",",qa,")"):Ce("false,(Array.isArray(",_n,")||",_n," instanceof Float32Array)?",_n,":(",ye(ci,function(zs){return qa+"["+zs+"]="+_n+"["+zs+"]"}),",",qa,")"),Ce(");")}else if(Kn>1){for(var jo=[],$l=[],ao=0;ao<Kn;++ao)Array.isArray(_n)?$l.push(_n[ao]):$l.push(Ce.def(_n+"["+ao+"]")),yt&&jo.push(Ce.def());yt&&Ce("if(!",Ne.batchId,"||",jo.map(function(zs,Xu){return zs+"!=="+$l[Xu]}).join("||"),"){",jo.map(function(zs,Xu){return zs+"="+$l[Xu]+";"}).join("")),Ce(ut,".uniform",Be,"(",un,",",$l.join(","),");"),yt&&Ce("}")}else{if(B(!Array.isArray(_n),"uniform value must not be an array"),yt){var Fa=Ce.def();Ce("if(!",Ne.batchId,"||",Fa,"!==",_n,"){",Fa,"=",_n,";")}Ce(ut,".uniform",Be,"(",un,",",_n,");"),yt&&Ce("}")}}}function uo(Ne,Ce,lt,Ft){var ar=Ne.shared,yt=ar.gl,ht=ar.draw,ut=Ft.draw;var Gn,Kn,ci,Ze=(ci=Ce,(Kn=ut.elements)?((Kn.contextDep&&Ft.contextDynamic||Kn.propDep)&&(ci=lt),Gn=Kn.append(Ne,ci),ut.elementsActive&&ci("if("+Gn+")"+yt+".bindBuffer(34963,"+Gn+".buffer.buffer);")):(Gn=ci.def(),ci(Gn,"=",ht,".",Kl,";","if(",Gn,"){",yt,".bindBuffer(",34963,",",Gn,".buffer.buffer);}","else if(",ar.vao,".currentVAO){",Gn,"=",Ne.shared.elements+".getElements("+ar.vao,".currentVAO.elements);",Mr?"":"if("+Gn+")"+yt+".bindBuffer(34963,"+Gn+".buffer.buffer);","}")),Gn);function Nt(Kn){var Gn=ut[Kn];return Gn?Gn.append(Ne,Gn.contextDep&&Ft.contextDynamic||Gn.propDep?lt:Ce):Ce.def(ht,".",Kn)}var un,_n,Gt=Nt(Wu),zr=Nt(Hf),sn=function(){var Gn,Kn=ut.count,ci=Ce;return Kn?((Kn.contextDep&&Ft.contextDynamic||Kn.propDep)&&(ci=lt),Gn=Kn.append(Ne,ci),B.optional(function(){Kn.MISSING&&Ne.assert(Ce,"false","missing vertex count"),Kn.DYNAMIC&&Ne.assert(ci,Gn+">=0","missing vertex count")})):(Gn=ci.def(ht,".",ca),B.optional(function(){Ne.assert(ci,Gn+">=0","missing vertex count")})),Gn}();if("number"==typeof sn){if(0===sn)return}else lt("if(",sn,"){"),lt.exit("}");Wr&&(un=Nt(Tl),_n=Ne.instancing);var an=Ze+".type",Yn=ut.elements&&Zo(ut.elements)&&!ut.vaoActive;function In(){function Kn(){lt(_n,".drawElementsInstancedANGLE(",[Gt,sn,an,zr+"<<(("+an+"-5121)>>1)",un],");")}function Gn(){lt(_n,".drawArraysInstancedANGLE(",[Gt,zr,sn,un],");")}Ze&&"null"!==Ze?Yn?Kn():(lt("if(",Ze,"){"),Kn(),lt("}else{"),Gn(),lt("}")):Gn()}function Vn(){function Kn(){lt(yt+".drawElements("+[Gt,sn,an,zr+"<<(("+an+"-5121)>>1)"]+");")}function Gn(){lt(yt+".drawArrays("+[Gt,zr,sn]+");")}Ze&&"null"!==Ze?Yn?Kn():(lt("if(",Ze,"){"),Kn(),lt("}else{"),Gn(),lt("}")):Gn()}Wr&&("number"!=typeof un||un>=0)?"string"==typeof un?(lt("if(",un,">0){"),In(),lt("}else if(",un,"<0){"),Vn(),lt("}")):In():Vn()}function Ai(Ne,Ce,lt,Ft,ar){var yt=Mi(),ht=yt.proc("body",ar);return B.optional(function(){yt.commandStr=Ce.commandStr,yt.command=yt.link(Ce.commandStr)}),Wr&&(yt.instancing=ht.def(yt.shared.extensions,".angle_instanced_arrays")),Ne(yt,ht,lt,Ft),yt.compile().body}function pa(Ne,Ce,lt,Ft){Vo(Ne,Ce),lt.useVAO?lt.drawVAO?Ce(Ne.shared.vao,".setVAO(",lt.drawVAO.append(Ne,Ce),");"):Ce(Ne.shared.vao,".setVAO(",Ne.shared.vao,".targetVAO);"):(Ce(Ne.shared.vao,".setVAO(null);"),ls(Ne,Ce,lt,Ft.attributes,function(){return!0})),La(Ne,Ce,lt,Ft.uniforms,function(){return!0},!1),uo(Ne,Ce,Ce,lt)}function To(Ne,Ce,lt,Ft){function ar(){return!0}Ne.batchId="a1",Vo(Ne,Ce),ls(Ne,Ce,lt,Ft.attributes,ar),La(Ne,Ce,lt,Ft.uniforms,ar,!1),uo(Ne,Ce,Ce,lt)}function Pl(Ne,Ce,lt,Ft){Vo(Ne,Ce);var ar=lt.contextDep,yt=Ce.def(),Be=Ce.def();Ne.shared.props=Be,Ne.batchId=yt;var ot=Ne.scope(),Ze=Ne.scope();function Nt(an){return an.contextDep&&ar||an.propDep}function Gt(an){return!Nt(an)}if(Ce(ot.entry,"for(",yt,"=0;",yt,"<","a1",";++",yt,"){",Be,"=","a0","[",yt,"];",Ze,"}",ot.exit),lt.needsContext&&Uo(Ne,Ze,lt.context),lt.needsFramebuffer&&ss(Ne,Ze,lt.framebuffer),us(Ne,Ze,lt.state,Nt),lt.profile&&Nt(lt.profile)&&Hi(Ne,Ze,lt,!1,!0),Ft)lt.useVAO?lt.drawVAO?Nt(lt.drawVAO)?Ze(Ne.shared.vao,".setVAO(",lt.drawVAO.append(Ne,Ze),");"):ot(Ne.shared.vao,".setVAO(",lt.drawVAO.append(Ne,ot),");"):ot(Ne.shared.vao,".setVAO(",Ne.shared.vao,".targetVAO);"):(ot(Ne.shared.vao,".setVAO(null);"),ls(Ne,ot,lt,Ft.attributes,Gt),ls(Ne,Ze,lt,Ft.attributes,Nt)),La(Ne,ot,lt,Ft.uniforms,Gt,!1),La(Ne,Ze,lt,Ft.uniforms,Nt,!0),uo(Ne,ot,Ze,lt);else{var zr=Ne.global.def("{}"),sn=lt.shader.progVar.append(Ne,Ze),un=Ze.def(sn,".id"),_n=Ze.def(zr,"[",un,"]");Ze(Ne.shared.gl,".useProgram(",sn,".program);","if(!",_n,"){",_n,"=",zr,"[",un,"]=",Ne.link(function(an){return Ai(To,Ne,lt,an,2)}),"(",sn,");}",_n,".call(this,a0[",yt,"],",yt,");")}}function Fn(Ne,Ce,lt){var Ft=Ce.static[lt];if(Ft&&function(Ne){if("object"==typeof Ne&&!oo(Ne)){for(var Ce=Object.keys(Ne),lt=0;lt<Ce.length;++lt)if(Wn.isDynamic(Ne[Ce[lt]]))return!0;return!1}}(Ft)){var ar=Ne.global,yt=Object.keys(Ft),ht=!1,ut=!1,Be=!1,ot=Ne.global.def("{}");yt.forEach(function(Nt){var Gt=Ft[Nt];if(Wn.isDynamic(Gt)){"function"==typeof Gt&&(Gt=Ft[Nt]=Wn.unbox(Gt));var zr=cu(Gt,null);ht=ht||zr.thisDep,Be=Be||zr.propDep,ut=ut||zr.contextDep}else{switch(ar(ot,".",Nt,"="),typeof Gt){case"number":ar(Gt);break;case"string":ar('"',Gt,'"');break;case"object":Array.isArray(Gt)&&ar("[",Gt.join(),"]");break;default:ar(Ne.link(Gt))}ar(";")}}),Ce.dynamic[lt]=new Wn.DynamicVariable(4,{thisDep:ht,contextDep:ut,propDep:Be,ref:ot,append:function(Nt,Gt){yt.forEach(function(zr){var sn=Ft[zr];if(Wn.isDynamic(sn)){var un=Nt.invoke(Gt,sn);Gt(ot,".",zr,"=",un,";")}})}}),delete Ce.static[lt]}}return{next:tn,current:bn,procs:function(){var Ne=Mi(),Ce=Ne.proc("poll"),lt=Ne.proc("refresh"),Ft=Ne.block();Ce(Ft),lt(Ft);var Be,ar=Ne.shared,yt=ar.gl,ht=ar.next,ut=ar.current;Ft(ut,".dirty=false;"),ss(Ne,Ce),ss(Ne,lt,null,!0),Wr&&(Be=Ne.link(Wr)),Qe.oes_vertex_array_object&&lt(Ne.link(Qe.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var ot=0;ot<ir.maxAttributes;++ot){var Ze=lt.def(ar.attributes,"[",ot,"]"),Nt=Ne.cond(Ze,".buffer");Nt.then(yt,".enableVertexAttribArray(",ot,");",yt,".bindBuffer(",hf,",",Ze,".buffer.buffer);",yt,".vertexAttribPointer(",ot,",",Ze,".size,",Ze,".type,",Ze,".normalized,",Ze,".stride,",Ze,".offset);").else(yt,".disableVertexAttribArray(",ot,");",yt,".vertexAttrib4f(",ot,",",Ze,".x,",Ze,".y,",Ze,".z,",Ze,".w);",Ze,".buffer=null;"),lt(Nt),Wr&&lt(Be,".vertexAttribDivisorANGLE(",ot,",",Ze,".divisor);")}return lt(Ne.shared.vao,".currentVAO=null;",Ne.shared.vao,".setVAO(",Ne.shared.vao,".targetVAO);"),Object.keys(Or).forEach(function(Gt){var zr=Or[Gt],sn=Ft.def(ht,".",Gt),un=Ne.block();un("if(",sn,"){",yt,".enable(",zr,")}else{",yt,".disable(",zr,")}",ut,".",Gt,"=",sn,";"),lt(un),Ce("if(",sn,"!==",ut,".",Gt,"){",un,"}")}),Object.keys(Sr).forEach(function(Gt){var un,_n,zr=Sr[Gt],sn=bn[Gt],an=Ne.block();if(an(yt,".",zr,"("),oo(sn)){var Yn=sn.length;un=Ne.global.def(ht,".",Gt),_n=Ne.global.def(ut,".",Gt),an(ye(Yn,function(In){return un+"["+In+"]"}),");",ye(Yn,function(In){return _n+"["+In+"]="+un+"["+In+"];"}).join("")),Ce("if(",ye(Yn,function(In){return un+"["+In+"]!=="+_n+"["+In+"]"}).join("||"),"){",an,"}")}else un=Ft.def(ht,".",Gt),_n=Ft.def(ut,".",Gt),an(un,");",ut,".",Gt,"=",un,";"),Ce("if(",un,"!==",_n,"){",an,"}");lt(an)}),Ne.compile()}(),compile:function(Ne,Ce,lt,Ft,ar){var yt=Mi();yt.stats=yt.link(ar),Object.keys(Ce.static).forEach(function(ut){Fn(yt,Ce,ut)}),$h.forEach(function(ut){Fn(yt,Ne,ut)});var ht=vs(Ne,Ce,lt,Ft,yt);return function(Ne,Ce){var lt=Ne.proc("draw",1);Vo(Ne,lt),Uo(Ne,lt,Ce.context),ss(Ne,lt,Ce.framebuffer),ms(Ne,lt,Ce),us(Ne,lt,Ce.state),Hi(Ne,lt,Ce,!1,!0);var Ft=Ce.shader.progVar.append(Ne,lt);if(lt(Ne.shared.gl,".useProgram(",Ft,".program);"),Ce.shader.program)pa(Ne,lt,Ce,Ce.shader.program);else{lt(Ne.shared.vao,".setVAO(null);");var ar=Ne.global.def("{}"),yt=lt.def(Ft,".id"),ht=lt.def(ar,"[",yt,"]");lt(Ne.cond(ht).then(ht,".call(this,a0);").else(ht,"=",ar,"[",yt,"]=",Ne.link(function(ut){return Ai(pa,Ne,Ce,ut,1)}),"(",Ft,");",ht,".call(this,a0);"))}Object.keys(Ce.state).length>0&&lt(Ne.shared.current,".dirty=true;"),Ne.shared.vao&&lt(Ne.shared.vao,".setVAO(null);")}(yt,ht),function(Ne,Ce){var lt=Ne.proc("scope",3);Ne.batchId="a2";var Ft=Ne.shared,ar=Ft.current;function yt(ht){var ut=Ce.shader[ht];ut&&lt.set(Ft.shader,"."+ht,ut.append(Ne,lt))}Uo(Ne,lt,Ce.context),Ce.framebuffer&&Ce.framebuffer.append(Ne,lt),kf(Object.keys(Ce.state)).forEach(function(ht){var Be=Ce.state[ht].append(Ne,lt);oo(Be)?Be.forEach(function(ot,Ze){lt.set(Ne.next[ht],"["+Ze+"]",ot)}):lt.set(Ft.next,"."+ht,Be)}),Hi(Ne,lt,Ce,!0,!0),[Kl,Hf,ca,Tl,Wu].forEach(function(ht){var ut=Ce.draw[ht];!ut||lt.set(Ft.draw,"."+ht,""+ut.append(Ne,lt))}),Object.keys(Ce.uniforms).forEach(function(ht){var ut=Ce.uniforms[ht].append(Ne,lt);Array.isArray(ut)&&(ut="["+ut.join()+"]"),lt.set(Ft.uniforms,"["+ke.id(ht)+"]",ut)}),Object.keys(Ce.attributes).forEach(function(ht){var ut=Ce.attributes[ht].append(Ne,lt),Be=Ne.scopeAttrib(ht);Object.keys(new Bt).forEach(function(ot){lt.set(Be,"."+ot,ut[ot])})}),Ce.scopeVAO&&lt.set(Ft.vao,".targetVAO",Ce.scopeVAO.append(Ne,lt)),yt(ul),yt(Ys),Object.keys(Ce.state).length>0&&(lt(ar,".dirty=true;"),lt.exit(ar,".dirty=true;")),lt("a1(",Ne.shared.context,",a0,",Ne.batchId,");")}(yt,ht),function(Ne,Ce){var lt=Ne.proc("batch",2);Ne.batchId="0",Vo(Ne,lt);var Ft=!1,ar=!0;Object.keys(Ce.context).forEach(function(zr){Ft=Ft||Ce.context[zr].propDep}),Ft||(Uo(Ne,lt,Ce.context),ar=!1);var yt=Ce.framebuffer,ht=!1;function ut(zr){return zr.contextDep&&Ft||zr.propDep}yt?(yt.propDep?Ft=ht=!0:yt.contextDep&&Ft&&(ht=!0),ht||ss(Ne,lt,yt)):ss(Ne,lt,null),Ce.state.viewport&&Ce.state.viewport.propDep&&(Ft=!0),ms(Ne,lt,Ce),us(Ne,lt,Ce.state,function(zr){return!ut(zr)}),(!Ce.profile||!ut(Ce.profile))&&Hi(Ne,lt,Ce,!1,"a1"),Ce.contextDep=Ft,Ce.needsContext=ar,Ce.needsFramebuffer=ht;var Be=Ce.shader.progVar;if(Be.contextDep&&Ft||Be.propDep)Pl(Ne,lt,Ce,null);else{var ot=Be.append(Ne,lt);if(lt(Ne.shared.gl,".useProgram(",ot,".program);"),Ce.shader.program)Pl(Ne,lt,Ce,Ce.shader.program);else{lt(Ne.shared.vao,".setVAO(null);");var Ze=Ne.global.def("{}"),Nt=lt.def(ot,".id"),Gt=lt.def(Ze,"[",Nt,"]");lt(Ne.cond(Gt).then(Gt,".call(this,a0,a1);").else(Gt,"=",Ze,"[",Nt,"]=",Ne.link(function(zr){return Ai(Pl,Ne,Ce,zr,2)}),"(",ot,");",Gt,".call(this,a0,a1);"))}}Object.keys(Ce.state).length>0&&lt(Ne.shared.current,".dirty=true;"),Ne.shared.vao&&lt(Ne.shared.vao,".setVAO(null);")}(yt,ht),p(yt.compile(),{destroy:function(){ht.shader.program.destroy()}})}}}var Mp=function(V,ke){if(!ke.ext_disjoint_timer_query)return null;var Qe=[];function kr(Wr){Qe.push(Wr)}var tr=[];function Gr(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Kr=[];function Qr(Wr){Kr.push(Wr)}var hn=[];function Hr(Wr,Tn,Mr){var bn=Kr.pop()||new Gr;bn.startQueryIndex=Wr,bn.endQueryIndex=Tn,bn.sum=0,bn.stats=Mr,hn.push(bn)}var en=[],Bt=[];return{beginQuery:function(Wr){var Tn=Qe.pop()||ke.ext_disjoint_timer_query.createQueryEXT();ke.ext_disjoint_timer_query.beginQueryEXT(35007,Tn),tr.push(Tn),Hr(tr.length-1,tr.length,Wr)},endQuery:function(){ke.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Hr,update:function(){var Wr,Tn,Mr=tr.length;if(0!==Mr){Bt.length=Math.max(Bt.length,Mr+1),en.length=Math.max(en.length,Mr+1),en[0]=0,Bt[0]=0;var bn=0;for(Wr=0,Tn=0;Tn<tr.length;++Tn){var tn=tr[Tn];ke.ext_disjoint_timer_query.getQueryObjectEXT(tn,34919)?(bn+=ke.ext_disjoint_timer_query.getQueryObjectEXT(tn,34918),kr(tn)):tr[Wr++]=tn,en[Tn+1]=bn,Bt[Tn+1]=Wr}for(tr.length=Wr,Wr=0,Tn=0;Tn<hn.length;++Tn){var ui=hn[Tn],Or=ui.startQueryIndex,Sr=ui.endQueryIndex;ui.sum+=en[Sr]-en[Or];var jn=Bt[Or],dn=Bt[Sr];dn===jn?(ui.stats.gpuTime+=ui.sum/1e6,Qr(ui)):(ui.startQueryIndex=jn,ui.endQueryIndex=dn,hn[Wr++]=ui)}hn.length=Wr}},getNumPendingQueries:function(){return tr.length},clear:function(){Qe.push.apply(Qe,tr);for(var Wr=0;Wr<Qe.length;Wr++)ke.ext_disjoint_timer_query.deleteQueryEXT(Qe[Wr]);tr.length=0,Qe.length=0},restore:function(){tr.length=0,Qe.length=0}}},Mh="webglcontextlost",zc="webglcontextrestored";function nf(V,ke){for(var Qe=0;Qe<V.length;++Qe)if(V[Qe]===ke)return Qe;return-1}return function(V){var ke=F(V);if(!ke)return null;var Qe=ke.gl,ir=Qe.getContextAttributes(),kr=Qe.isContextLost(),tr=re(Qe,ke);if(!tr)return null;var Er=function(){var V={"":0},ke=[""];return{id:function(Qe){var ir=V[Qe];return ir||(ir=V[Qe]=ke.length,ke.push(Qe),ir)},str:function(Qe){return ke[Qe]}}}(),Zr={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Gr=tr.extensions,Kr=Mp(0,Gr),qr=si(),Qr=Qe.drawingBufferWidth,hn=Qe.drawingBufferHeight,Hr={tick:0,time:0,viewportWidth:Qr,viewportHeight:hn,framebufferWidth:Qr,framebufferHeight:hn,drawingBufferWidth:Qr,drawingBufferHeight:hn,pixelRatio:ke.pixelRatio},Bt={elements:null,primitive:4,count:-1,offset:0,instances:-1},gr=function(V,ke){var Qe=1;ke.ext_texture_filter_anisotropic&&(Qe=V.getParameter(34047));var ir=1,kr=1;ke.webgl_draw_buffers&&(ir=V.getParameter(34852),kr=V.getParameter(36063));var tr=!!ke.oes_texture_float;if(tr){var Er=V.createTexture();V.bindTexture(3553,Er),V.texImage2D(3553,0,aa,1,1,0,aa,5126,null);var Zr=V.createFramebuffer();if(V.bindFramebuffer(36160,Zr),V.framebufferTexture2D(36160,36064,3553,Er,0),V.bindTexture(3553,null),36053!==V.checkFramebufferStatus(36160))tr=!1;else{V.viewport(0,0,1,1),V.clearColor(1,0,0,1),V.clear(16384);var Gr=qt.allocType(5126,4);V.readPixels(0,0,1,1,aa,5126,Gr),V.getError()?tr=!1:(V.deleteFramebuffer(Zr),V.deleteTexture(Er),tr=1===Gr[0]),qt.freeType(Gr)}}var qr=!0;if("undefined"==typeof navigator||!(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))){var Qr=V.createTexture(),hn=qt.allocType(5121,36);V.activeTexture(33984),V.bindTexture(34067,Qr),V.texImage2D(34069,0,aa,3,3,0,aa,5121,hn),qt.freeType(hn),V.bindTexture(34067,null),V.deleteTexture(Qr),qr=!V.getError()}return{colorBits:[V.getParameter(3410),V.getParameter(3411),V.getParameter(3412),V.getParameter(3413)],depthBits:V.getParameter(3414),stencilBits:V.getParameter(3415),subpixelBits:V.getParameter(3408),extensions:Object.keys(ke).filter(function(Hr){return!!ke[Hr]}),maxAnisotropic:Qe,maxDrawbuffers:ir,maxColorAttachments:kr,pointSizeDims:V.getParameter(33901),lineWidthDims:V.getParameter(33902),maxViewportDims:V.getParameter(3386),maxCombinedTextureUnits:V.getParameter(35661),maxCubeMapSize:V.getParameter(34076),maxRenderbufferSize:V.getParameter(34024),maxTextureUnits:V.getParameter(34930),maxTextureSize:V.getParameter(3379),maxAttributes:V.getParameter(34921),maxVertexUniforms:V.getParameter(36347),maxVertexTextureUnits:V.getParameter(35660),maxVaryingVectors:V.getParameter(36348),maxFragmentUniforms:V.getParameter(36349),glsl:V.getParameter(35724),renderer:V.getParameter(7937),vendor:V.getParameter(7936),version:V.getParameter(7938),readFloat:tr,npotTextureCube:qr}}(Qe,Gr),Wr=function(V,ke,Qe,ir){var kr=0,tr={};function Er(Bt){this.id=kr++,this.buffer=V.createBuffer(),this.type=Bt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Qe.profile&&(this.stats={size:0})}Er.prototype.bind=function(){V.bindBuffer(this.type,this.buffer)},Er.prototype.destroy=function(){hn(this)};var Zr=[];function qr(Bt,gr,Wr){Bt.byteLength=gr.byteLength,V.bufferData(Bt.type,gr,Wr)}function Qr(Bt,gr,Wr,Tn,Mr,bn){var tn,ui;if(Bt.usage=Wr,Array.isArray(gr)){if(Bt.dtype=Tn||5126,gr.length>0)if(Array.isArray(gr[0])){tn=kl(gr);for(var Or=1,Sr=1;Sr<tn.length;++Sr)Or*=tn[Sr];Bt.dimension=Or,qr(Bt,ui=Ol(gr,tn,Bt.dtype),Wr),bn?Bt.persistentData=ui:qt.freeType(ui)}else if("number"==typeof gr[0]){Bt.dimension=Mr;var jn=qt.allocType(Bt.dtype,gr.length);m(jn,gr),qr(Bt,jn,Wr),bn?Bt.persistentData=jn:qt.freeType(jn)}else w(gr[0])?(Bt.dimension=gr[0].length,Bt.dtype=Tn||Dl(gr[0])||5126,qr(Bt,ui=Ol(gr,[gr.length,gr[0].length],Bt.dtype),Wr),bn?Bt.persistentData=ui:qt.freeType(ui)):B.raise("invalid buffer data")}else if(w(gr))Bt.dtype=Tn||Dl(gr),Bt.dimension=Mr,qr(Bt,gr,Wr),bn&&(Bt.persistentData=new Uint8Array(new Uint8Array(gr.buffer)));else if(vt(gr)){var dn=gr.stride,Jr=gr.offset,yn=0,wn=0,zi=0,Mi=0;1===(tn=gr.shape).length?(yn=tn[0],wn=1,zi=dn[0],Mi=0):2===tn.length?(yn=tn[0],wn=tn[1],zi=dn[0],Mi=dn[1]):B.raise("invalid shape"),Bt.dtype=Tn||Dl(gr.data)||5126,Bt.dimension=wn;var En=qt.allocType(Bt.dtype,yn*wn);E(En,gr.data,yn,wn,zi,Mi,Jr),qr(Bt,En,Wr),bn?Bt.persistentData=En:qt.freeType(En)}else gr instanceof ArrayBuffer?(Bt.dtype=5121,Bt.dimension=Mr,qr(Bt,gr,Wr),bn&&(Bt.persistentData=new Uint8Array(new Uint8Array(gr)))):B.raise("invalid buffer data")}function hn(Bt){ke.bufferCount--,ir(Bt);var gr=Bt.buffer;B(gr,"buffer must not be deleted already"),V.deleteBuffer(gr),Bt.buffer=null,delete tr[Bt.id]}return Qe.profile&&(ke.getTotalBufferSize=function(){var Bt=0;return Object.keys(tr).forEach(function(gr){Bt+=tr[gr].stats.size}),Bt}),{create:function(Bt,gr,Wr,Tn){ke.bufferCount++;var Mr=new Er(gr);function bn(Or){var Sr=35044,jn=null,dn=0,Jr=0,yn=1;return Array.isArray(Or)||w(Or)||vt(Or)||Or instanceof ArrayBuffer?jn=Or:"number"==typeof Or?dn=0|Or:Or&&(B.type(Or,"object","buffer arguments must be an object, a number or an array"),"data"in Or&&(B(null===jn||Array.isArray(jn)||w(jn)||vt(jn),"invalid data for buffer"),jn=Or.data),"usage"in Or&&(B.parameter(Or.usage,Lo,"invalid buffer usage"),Sr=Lo[Or.usage]),"type"in Or&&(B.parameter(Or.type,Qs,"invalid buffer type"),Jr=Qs[Or.type]),"dimension"in Or&&(B.type(Or.dimension,"number","invalid dimension"),yn=0|Or.dimension),"length"in Or&&(B.nni(dn,"buffer length must be a nonnegative integer"),dn=0|Or.length)),Mr.bind(),jn?Qr(Mr,jn,Sr,Jr,yn,Tn):(dn&&V.bufferData(Mr.type,dn,Sr),Mr.dtype=Jr||5121,Mr.usage=Sr,Mr.dimension=yn,Mr.byteLength=dn),Qe.profile&&(Mr.stats.size=Mr.byteLength*eu[Mr.dtype]),bn}function tn(Or,Sr){B(Sr+Or.byteLength<=Mr.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Or.byteLength+" starting from offset "+Sr+" to a buffer of size "+Mr.byteLength),V.bufferSubData(Mr.type,Sr,Or)}return tr[Mr.id]=Mr,Wr||bn(Bt),bn._reglType="buffer",bn._buffer=Mr,bn.subdata=function(Or,Sr){var dn,jn=0|(Sr||0);if(Mr.bind(),w(Or)||Or instanceof ArrayBuffer)tn(Or,jn);else if(Array.isArray(Or)){if(Or.length>0)if("number"==typeof Or[0]){var Jr=qt.allocType(Mr.dtype,Or.length);m(Jr,Or),tn(Jr,jn),qt.freeType(Jr)}else if(Array.isArray(Or[0])||w(Or[0])){dn=kl(Or);var yn=Ol(Or,dn,Mr.dtype);tn(yn,jn),qt.freeType(yn)}else B.raise("invalid buffer data")}else if(vt(Or)){var wn=Or.stride,zi=0,Mi=0,En=0,Sn=0;1===(dn=Or.shape).length?(zi=dn[0],Mi=1,En=wn[0],Sn=0):2===dn.length?(zi=dn[0],Mi=dn[1],En=wn[0],Sn=wn[1]):B.raise("invalid shape");var _i=Array.isArray(Or.data)?Mr.dtype:Dl(Or.data),Zi=qt.allocType(_i,zi*Mi);E(Zi,Or.data,zi,Mi,En,Sn,Or.offset),tn(Zi,jn),qt.freeType(Zi)}else B.raise("invalid data for buffer subdata");return bn},Qe.profile&&(bn.stats=Mr.stats),bn.destroy=function(){hn(Mr)},bn},createStream:function(Bt,gr){var Wr=Zr.pop();return Wr||(Wr=new Er(Bt)),Wr.bind(),Qr(Wr,gr,35040,0,1,!1),Wr},destroyStream:function(Bt){Zr.push(Bt)},clear:function(){Qt(tr).forEach(hn),Zr.forEach(hn)},getBuffer:function(Bt){return Bt&&Bt._buffer instanceof Er?Bt._buffer:null},restore:function(){Qt(tr).forEach(function(Bt){Bt.buffer=V.createBuffer(),V.bindBuffer(Bt.type,Bt.buffer),V.bufferData(Bt.type,Bt.persistentData||Bt.byteLength,Bt.usage)})},_initBuffer:Qr}}(Qe,Zr,ke,function(Ai){return Mr.destroyBuffer(Ai)}),Tn=function(V,ke,Qe,ir){var kr={},tr=0,Er={uint8:oa,uint16:Na};function Zr(en){this.id=tr++,kr[this.id]=this,this.buffer=en,this.primType=4,this.vertCount=0,this.type=0}ke.oes_element_index_uint&&(Er.uint32=Xo),Zr.prototype.bind=function(){this.buffer.bind()};var Gr=[];function Qr(en,Bt,gr,Wr,Tn,Mr,bn){var tn;if(en.buffer.bind(),Bt){var ui=bn;!bn&&(!w(Bt)||vt(Bt)&&!w(Bt.data))&&(ui=ke.oes_element_index_uint?Xo:Na),Qe._initBuffer(en.buffer,Bt,gr,ui,3)}else V.bufferData(34963,Mr,gr),en.buffer.dtype=tn||oa,en.buffer.usage=gr,en.buffer.dimension=3,en.buffer.byteLength=Mr;if(tn=bn,!bn){switch(en.buffer.dtype){case oa:case 5120:tn=oa;break;case Na:case 5122:tn=Na;break;case Xo:case 5124:tn=Xo;break;default:B.raise("unsupported type for element array")}en.buffer.dtype=tn}en.type=tn,B(tn!==Xo||!!ke.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Or=Tn;Or<0&&(Or=en.buffer.byteLength,tn===Na?Or>>=1:tn===Xo&&(Or>>=2)),en.vertCount=Or;var Sr=Wr;if(Wr<0){Sr=4;var jn=en.buffer.dimension;1===jn&&(Sr=0),2===jn&&(Sr=1),3===jn&&(Sr=4)}en.primType=Sr}function hn(en){ir.elementsCount--,B(null!==en.buffer,"must not double destroy elements"),delete kr[en.id],en.buffer.destroy(),en.buffer=null}return{create:function(en,Bt){var gr=Qe.create(null,34963,!0),Wr=new Zr(gr._buffer);function Tn(Mr){if(Mr)if("number"==typeof Mr)gr(Mr),Wr.primType=4,Wr.vertCount=0|Mr,Wr.type=oa;else{var bn=null,tn=35044,ui=-1,Or=-1,Sr=0,jn=0;Array.isArray(Mr)||w(Mr)||vt(Mr)?bn=Mr:(B.type(Mr,"object","invalid arguments for elements"),"data"in Mr&&(bn=Mr.data,B(Array.isArray(bn)||w(bn)||vt(bn),"invalid data for element buffer")),"usage"in Mr&&(B.parameter(Mr.usage,Lo,"invalid element buffer usage"),tn=Lo[Mr.usage]),"primitive"in Mr&&(B.parameter(Mr.primitive,Ir,"invalid element buffer primitive"),ui=Ir[Mr.primitive]),"count"in Mr&&(B("number"==typeof Mr.count&&Mr.count>=0,"invalid vertex count for elements"),Or=0|Mr.count),"type"in Mr&&(B.parameter(Mr.type,Er,"invalid buffer type"),jn=Er[Mr.type]),"length"in Mr?Sr=0|Mr.length:(Sr=Or,jn===Na||5122===jn?Sr*=2:(jn===Xo||5124===jn)&&(Sr*=4))),Qr(Wr,bn,tn,ui,Or,Sr,jn)}else gr(),Wr.primType=4,Wr.vertCount=0,Wr.type=oa;return Tn}return ir.elementsCount++,Tn(en),Tn._reglType="elements",Tn._elements=Wr,Tn.subdata=function(Mr,bn){return gr.subdata(Mr,bn),Tn},Tn.destroy=function(){hn(Wr)},Tn},createStream:function(en){var Bt=Gr.pop();return Bt||(Bt=new Zr(Qe.create(null,34963,!0,!1)._buffer)),Qr(Bt,en,35040,-1,-1,0,0),Bt},destroyStream:function(en){Gr.push(en)},getElements:function(en){return"function"==typeof en&&en._elements instanceof Zr?en._elements:null},clear:function(){Qt(kr).forEach(hn)}}}(Qe,Gr,Wr,Zr),Mr=function(V,ke,Qe,ir,kr,tr,Er){for(var Zr=Qe.maxAttributes,Gr=new Array(Zr),Kr=0;Kr<Zr;++Kr)Gr[Kr]=new at;var qr=0,Qr={},hn={Record:at,scope:{},state:Gr,currentVAO:null,targetVAO:null,restore:en()?function(){en()&&Qt(Qr).forEach(function(Sr){Sr.refresh()})}:function(){},createVAO:function(Or){var Sr=new bn;function jn(dn){var Jr;if(Array.isArray(dn))Jr=dn,Sr.elements&&Sr.ownsElements&&Sr.elements.destroy(),Sr.elements=null,Sr.ownsElements=!1,Sr.offset=0,Sr.count=0,Sr.instances=-1,Sr.primitive=4;else{if(B("object"==typeof dn,"invalid arguments for create vao"),B("attributes"in dn,"must specify attributes for vao"),dn.elements){var yn=dn.elements;Sr.ownsElements?"function"==typeof yn&&"elements"===yn._reglType?(Sr.elements.destroy(),Sr.ownsElements=!1):(Sr.elements(yn),Sr.ownsElements=!1):tr.getElements(dn.elements)?(Sr.elements=dn.elements,Sr.ownsElements=!1):(Sr.elements=tr.create(dn.elements),Sr.ownsElements=!0)}else Sr.elements=null,Sr.ownsElements=!1;Jr=dn.attributes,Sr.offset=0,Sr.count=-1,Sr.instances=-1,Sr.primitive=4,Sr.elements&&(Sr.count=Sr.elements._elements.vertCount,Sr.primitive=Sr.elements._elements.primType),"offset"in dn&&(Sr.offset=0|dn.offset),"count"in dn&&(Sr.count=0|dn.count),"instances"in dn&&(Sr.instances=0|dn.instances),"primitive"in dn&&(B(dn.primitive in Ir,"bad primitive type: "+dn.primitive),Sr.primitive=Ir[dn.primitive]),B.optional(()=>{for(var Mo=Object.keys(dn),Io=0;Io<Mo.length;++Io)B(je.indexOf(Mo[Io])>=0,'invalid option for vao: "'+Mo[Io]+'" valid options are '+je)}),B(Array.isArray(Jr),"attributes must be an array")}B(Jr.length<Zr,"too many attributes"),B(Jr.length>0,"must specify at least one attribute");var wn={},zi=Sr.attributes;zi.length=Jr.length;for(var Mi=0;Mi<Jr.length;++Mi){var Zi,En=Jr[Mi],Sn=zi[Mi]=new at,_i=En.data||En;Array.isArray(_i)||w(_i)||vt(_i)?(Sr.buffers[Mi]&&(Zi=Sr.buffers[Mi],w(_i)&&Zi._buffer.byteLength>=_i.byteLength?Zi.subdata(_i):(Zi.destroy(),Sr.buffers[Mi]=null)),Sr.buffers[Mi]||(Zi=Sr.buffers[Mi]=kr.create(En,34962,!1,!0)),Sn.buffer=kr.getBuffer(Zi),Sn.size=0|Sn.buffer.dimension,Sn.normalized=!1,Sn.type=Sn.buffer.dtype,Sn.offset=0,Sn.stride=0,Sn.divisor=0,Sn.state=1,wn[Mi]=1):kr.getBuffer(En)?(Sn.buffer=kr.getBuffer(En),Sn.size=0|Sn.buffer.dimension,Sn.normalized=!1,Sn.type=Sn.buffer.dtype,Sn.offset=0,Sn.stride=0,Sn.divisor=0,Sn.state=1):kr.getBuffer(En.buffer)?(Sn.buffer=kr.getBuffer(En.buffer),Sn.size=0|(+En.size||Sn.buffer.dimension),Sn.normalized=!!En.normalized||!1,"type"in En?(B.parameter(En.type,Qs,"invalid buffer type"),Sn.type=Qs[En.type]):Sn.type=Sn.buffer.dtype,Sn.offset=0|(En.offset||0),Sn.stride=0|(En.stride||0),Sn.divisor=0|(En.divisor||0),Sn.state=1,B(Sn.size>=1&&Sn.size<=4,"size must be between 1 and 4"),B(Sn.offset>=0,"invalid offset"),B(Sn.stride>=0&&Sn.stride<=255,"stride must be between 0 and 255"),B(Sn.divisor>=0,"divisor must be positive"),B(!Sn.divisor||!!ke.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in En?(B(Mi>0,"first attribute must not be a constant"),Sn.x=+En.x||0,Sn.y=+En.y||0,Sn.z=+En.z||0,Sn.w=+En.w||0,Sn.state=2):B(!1,"invalid attribute spec for location "+Mi)}for(var fa=0;fa<Sr.buffers.length;++fa)!wn[fa]&&Sr.buffers[fa]&&(Sr.buffers[fa].destroy(),Sr.buffers[fa]=null);return Sr.refresh(),jn}return ir.vaoCount+=1,jn.destroy=function(){for(var dn=0;dn<Sr.buffers.length;++dn)Sr.buffers[dn]&&Sr.buffers[dn].destroy();Sr.buffers.length=0,Sr.ownsElements&&(Sr.elements.destroy(),Sr.elements=null,Sr.ownsElements=!1),Sr.destroy()},jn._vao=Sr,jn._reglType="vao",jn(Or)},getVAO:function(Or){return"function"==typeof Or&&Or._vao?Or._vao:null},destroyBuffer:function(Or){for(var Sr=0;Sr<Gr.length;++Sr){var jn=Gr[Sr];jn.buffer===Or&&(V.disableVertexAttribArray(Sr),jn.buffer=null)}},setVAO:en()?function(Or){Or!==hn.currentVAO&&(en().bindVertexArrayOES(Or?Or.vao:null),hn.currentVAO=Or)}:function(Or){if(Or!==hn.currentVAO){if(Or)Or.bindAttrs();else{for(var Sr=Bt(),jn=0;jn<Gr.length;++jn){var dn=Gr[jn];dn.buffer?(V.enableVertexAttribArray(jn),dn.buffer.bind(),V.vertexAttribPointer(jn,dn.size,dn.type,dn.normalized,dn.stride,dn.offfset),Sr&&dn.divisor&&Sr.vertexAttribDivisorANGLE(jn,dn.divisor)):(V.disableVertexAttribArray(jn),V.vertexAttrib4f(jn,dn.x,dn.y,dn.z,dn.w))}V.bindBuffer(34963,Er.elements?Er.elements.buffer.buffer:null)}hn.currentVAO=Or}},clear:en()?function(){Qt(Qr).forEach(function(Or){Or.destroy()})}:function(){}};function en(){return ke.oes_vertex_array_object}function Bt(){return ke.angle_instanced_arrays}function bn(){this.id=++qr,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var Or=en();this.vao=Or?Or.createVertexArrayOES():null,Qr[this.id]=this,this.buffers=[]}return bn.prototype.bindAttrs=function(){for(var Or=Bt(),Sr=this.attributes,jn=0;jn<Sr.length;++jn){var dn=Sr[jn];dn.buffer?(V.enableVertexAttribArray(jn),V.bindBuffer(34962,dn.buffer.buffer),V.vertexAttribPointer(jn,dn.size,dn.type,dn.normalized,dn.stride,dn.offset),Or&&dn.divisor&&Or.vertexAttribDivisorANGLE(jn,dn.divisor)):(V.disableVertexAttribArray(jn),V.vertexAttrib4f(jn,dn.x,dn.y,dn.z,dn.w))}for(var Jr=Sr.length;Jr<Zr;++Jr)V.disableVertexAttribArray(Jr);var yn=tr.getElements(this.elements);V.bindBuffer(34963,yn?yn.buffer.buffer:null)},bn.prototype.refresh=function(){var Or=en();Or&&(Or.bindVertexArrayOES(this.vao),this.bindAttrs(),hn.currentVAO=null,Or.bindVertexArrayOES(null))},bn.prototype.destroy=function(){if(this.vao){var Or=en();this===hn.currentVAO&&(hn.currentVAO=null,Or.bindVertexArrayOES(null)),Or.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Qr[this.id]&&(delete Qr[this.id],ir.vaoCount-=1)},hn}(Qe,Gr,gr,Zr,Wr,Tn,Bt),tn=function(V,ke,Qe,ir){var kr={},tr={};function Er(Bt,gr,Wr,Tn){this.name=Bt,this.id=gr,this.location=Wr,this.info=Tn}function Zr(Bt,gr){for(var Wr=0;Wr<Bt.length;++Wr)if(Bt[Wr].id===gr.id)return void(Bt[Wr].location=gr.location);Bt.push(gr)}function Gr(Bt,gr,Wr){var Tn=35632===Bt?kr:tr,Mr=Tn[gr];if(!Mr){var bn=ke.str(gr);Mr=V.createShader(Bt),V.shaderSource(Mr,bn),V.compileShader(Mr),B.shaderError(V,Mr,bn,Bt,Wr),Tn[gr]=Mr}return Mr}var Kr={},qr=[],Qr=0;function hn(Bt,gr){this.id=Qr++,this.fragId=Bt,this.vertId=gr,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,ir.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Hr(Bt,gr,Wr){var Tn,Mr,bn=Gr(35632,Bt.fragId),tn=Gr(35633,Bt.vertId),ui=Bt.program=V.createProgram();if(V.attachShader(ui,bn),V.attachShader(ui,tn),Wr)for(Tn=0;Tn<Wr.length;++Tn){var Or=Wr[Tn];V.bindAttribLocation(ui,Or[0],Or[1])}V.linkProgram(ui),B.linkError(V,ui,ke.str(Bt.fragId),ke.str(Bt.vertId),gr);var Sr=V.getProgramParameter(ui,35718);ir.profile&&(Bt.stats.uniformsCount=Sr);var jn=Bt.uniforms;for(Tn=0;Tn<Sr;++Tn)if(Mr=V.getActiveUniform(ui,Tn))if(Mr.size>1)for(var dn=0;dn<Mr.size;++dn){var Jr=Mr.name.replace("[0]","["+dn+"]");Zr(jn,new Er(Jr,ke.id(Jr),V.getUniformLocation(ui,Jr),Mr))}else Zr(jn,new Er(Mr.name,ke.id(Mr.name),V.getUniformLocation(ui,Mr.name),Mr));var yn=V.getProgramParameter(ui,35721);ir.profile&&(Bt.stats.attributesCount=yn);var wn=Bt.attributes;for(Tn=0;Tn<yn;++Tn)(Mr=V.getActiveAttrib(ui,Tn))&&Zr(wn,new Er(Mr.name,ke.id(Mr.name),V.getAttribLocation(ui,Mr.name),Mr))}return ir.profile&&(Qe.getMaxUniformsCount=function(){var Bt=0;return qr.forEach(function(gr){gr.stats.uniformsCount>Bt&&(Bt=gr.stats.uniformsCount)}),Bt},Qe.getMaxAttributesCount=function(){var Bt=0;return qr.forEach(function(gr){gr.stats.attributesCount>Bt&&(Bt=gr.stats.attributesCount)}),Bt}),{clear:function(){var Bt=V.deleteShader.bind(V);Qt(kr).forEach(Bt),kr={},Qt(tr).forEach(Bt),tr={},qr.forEach(function(gr){V.deleteProgram(gr.program)}),qr.length=0,Kr={},Qe.shaderCount=0},program:function(Bt,gr,Wr,Tn){B.command(Bt>=0,"missing vertex shader",Wr),B.command(gr>=0,"missing fragment shader",Wr);var Mr=Kr[gr];Mr||(Mr=Kr[gr]={});var bn=Mr[Bt];if(bn&&(bn.refCount++,!Tn))return bn;var tn=new hn(gr,Bt);return Qe.shaderCount++,Hr(tn,Wr,Tn),bn||(Mr[Bt]=tn),qr.push(tn),p(tn,{destroy:function(){if(tn.refCount--,tn.refCount<=0){V.deleteProgram(tn.program);var ui=qr.indexOf(tn);qr.splice(ui,1),Qe.shaderCount--}Mr[tn.vertId].refCount<=0&&(V.deleteShader(tr[tn.vertId]),delete tr[tn.vertId],delete Kr[tn.fragId][tn.vertId]),Object.keys(Kr[tn.fragId]).length||(V.deleteShader(kr[tn.fragId]),delete kr[tn.fragId],delete Kr[tn.fragId])}})},restore:function(){kr={},tr={};for(var Bt=0;Bt<qr.length;++Bt)Hr(qr[Bt],null,qr[Bt].attributes.map(function(gr){return[gr.location,gr.name]}))},shader:Gr,frag:-1,vert:-1}}(Qe,Er,Zr,ke),ui=ou(Qe,Gr,gr,function(){jn.procs.poll()},Hr,Zr,ke),Or=function(V,ke,Qe,ir,kr){var tr={rgba4:il,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};ke.ext_srgb&&(tr.srgba=35907),ke.ext_color_buffer_half_float&&(tr.rgba16f=34842,tr.rgb16f=34843),ke.webgl_color_buffer_float&&(tr.rgba32f=34836);var Er=[];Object.keys(tr).forEach(function(Hr){Er[tr[Hr]]=Hr});var Zr=0,Gr={};function Kr(Hr){this.id=Zr++,this.refCount=1,this.renderbuffer=Hr,this.format=il,this.width=0,this.height=0,kr.profile&&(this.stats={size:0})}function qr(Hr){var en=Hr.renderbuffer;B(en,"must not double destroy renderbuffer"),V.bindRenderbuffer(mo,null),V.deleteRenderbuffer(en),Hr.renderbuffer=null,Hr.refCount=0,delete Gr[Hr.id],ir.renderbufferCount--}return Kr.prototype.decRef=function(){--this.refCount<=0&&qr(this)},kr.profile&&(ir.getTotalRenderbufferSize=function(){var Hr=0;return Object.keys(Gr).forEach(function(en){Hr+=Gr[en].stats.size}),Hr}),{create:function(Hr,en){var Bt=new Kr(V.createRenderbuffer());function gr(Tn,Mr){var bn=0,tn=0,ui=il;if("object"==typeof Tn&&Tn){var Or=Tn;if("shape"in Or){var Sr=Or.shape;B(Array.isArray(Sr)&&Sr.length>=2,"invalid renderbuffer shape"),bn=0|Sr[0],tn=0|Sr[1]}else"radius"in Or&&(bn=tn=0|Or.radius),"width"in Or&&(bn=0|Or.width),"height"in Or&&(tn=0|Or.height);"format"in Or&&(B.parameter(Or.format,tr,"invalid renderbuffer format"),ui=tr[Or.format])}else"number"==typeof Tn?(bn=0|Tn,tn="number"==typeof Mr?0|Mr:bn):Tn?B.raise("invalid arguments to renderbuffer constructor"):bn=tn=1;if(B(bn>0&&tn>0&&bn<=Qe.maxRenderbufferSize&&tn<=Qe.maxRenderbufferSize,"invalid renderbuffer size"),bn!==Bt.width||tn!==Bt.height||ui!==Bt.format)return gr.width=Bt.width=bn,gr.height=Bt.height=tn,Bt.format=ui,V.bindRenderbuffer(mo,Bt.renderbuffer),V.renderbufferStorage(mo,ui,bn,tn),B(0===V.getError(),"invalid render buffer format"),kr.profile&&(Bt.stats.size=zo(Bt.format,Bt.width,Bt.height)),gr.format=Er[Bt.format],gr}return Gr[Bt.id]=Bt,ir.renderbufferCount++,gr(Hr,en),gr.resize=function(Tn,Mr){var bn=0|Tn,tn=0|Mr||bn;return bn===Bt.width&&tn===Bt.height||(B(bn>0&&tn>0&&bn<=Qe.maxRenderbufferSize&&tn<=Qe.maxRenderbufferSize,"invalid renderbuffer size"),gr.width=Bt.width=bn,gr.height=Bt.height=tn,V.bindRenderbuffer(mo,Bt.renderbuffer),V.renderbufferStorage(mo,Bt.format,bn,tn),B(0===V.getError(),"invalid render buffer format"),kr.profile&&(Bt.stats.size=zo(Bt.format,Bt.width,Bt.height))),gr},gr._reglType="renderbuffer",gr._renderbuffer=Bt,kr.profile&&(gr.stats=Bt.stats),gr.destroy=function(){Bt.decRef()},gr},clear:function(){Qt(Gr).forEach(qr)},restore:function(){Qt(Gr).forEach(function(Hr){Hr.renderbuffer=V.createRenderbuffer(),V.bindRenderbuffer(mo,Hr.renderbuffer),V.renderbufferStorage(mo,Hr.format,Hr.width,Hr.height)}),V.bindRenderbuffer(mo,null)}}}(Qe,Gr,gr,Zr,ke),Sr=function(V,ke,Qe,ir,kr,tr){var Er={cur:null,next:null,dirty:!1,setFBO:null},Zr=["rgba"],Gr=["rgba4","rgb565","rgb5 a1"];ke.ext_srgb&&Gr.push("srgba"),ke.ext_color_buffer_half_float&&Gr.push("rgba16f","rgb16f"),ke.webgl_color_buffer_float&&Gr.push("rgba32f");var Kr=["uint8"];function qr(Jr,yn,wn){this.target=Jr,this.texture=yn,this.renderbuffer=wn;var zi=0,Mi=0;yn?(zi=yn.width,Mi=yn.height):wn&&(zi=wn.width,Mi=wn.height),this.width=zi,this.height=Mi}function Qr(Jr){Jr&&(Jr.texture&&Jr.texture._texture.decRef(),Jr.renderbuffer&&Jr.renderbuffer._renderbuffer.decRef())}function hn(Jr,yn,wn){if(Jr)if(Jr.texture){var zi=Jr.texture._texture,Mi=Math.max(1,zi.width),En=Math.max(1,zi.height);B(Mi===yn&&En===wn,"inconsistent width/height for supplied texture"),zi.refCount+=1}else{var Sn=Jr.renderbuffer._renderbuffer;B(Sn.width===yn&&Sn.height===wn,"inconsistent width/height for renderbuffer"),Sn.refCount+=1}}function Hr(Jr,yn){yn&&(yn.texture?V.framebufferTexture2D(As,Jr,yn.target,yn.texture._texture.texture,0):V.framebufferRenderbuffer(As,Jr,36161,yn.renderbuffer._renderbuffer.renderbuffer))}function en(Jr){var yn=ys,wn=null,zi=null,Mi=Jr;"object"==typeof Jr&&(Mi=Jr.data,"target"in Jr&&(yn=0|Jr.target)),B.type(Mi,"function","invalid attachment data");var En=Mi._reglType;return"texture2d"===En?(wn=Mi,B(yn===ys)):"textureCube"===En?(wn=Mi,B(yn>=is&&yn<is+6,"invalid cube map target")):"renderbuffer"===En?(zi=Mi,yn=36161):B.raise("invalid regl object for attachment"),new qr(yn,wn,zi)}function Bt(Jr,yn,wn,zi,Mi){if(wn){var En=ir.create2D({width:Jr,height:yn,format:zi,type:Mi});return En._texture.refCount=0,new qr(ys,En,null)}var Sn=kr.create({width:Jr,height:yn,format:zi});return Sn._renderbuffer.refCount=0,new qr(36161,null,Sn)}function gr(Jr){return Jr&&(Jr.texture||Jr.renderbuffer)}function Wr(Jr,yn,wn){Jr&&(Jr.texture?Jr.texture.resize(yn,wn):Jr.renderbuffer&&Jr.renderbuffer.resize(yn,wn),Jr.width=yn,Jr.height=wn)}ke.oes_texture_half_float&&Kr.push("half float","float16"),ke.oes_texture_float&&Kr.push("float","float32");var Tn=0,Mr={};function bn(){this.id=Tn++,Mr[this.id]=this,this.framebuffer=V.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function tn(Jr){Jr.colorAttachments.forEach(Qr),Qr(Jr.depthAttachment),Qr(Jr.stencilAttachment),Qr(Jr.depthStencilAttachment)}function ui(Jr){var yn=Jr.framebuffer;B(yn,"must not double destroy framebuffer"),V.deleteFramebuffer(yn),Jr.framebuffer=null,tr.framebufferCount--,delete Mr[Jr.id]}function Or(Jr){var yn;V.bindFramebuffer(As,Jr.framebuffer);var wn=Jr.colorAttachments;for(yn=0;yn<wn.length;++yn)Hr(36064+yn,wn[yn]);for(yn=wn.length;yn<Qe.maxColorAttachments;++yn)V.framebufferTexture2D(As,36064+yn,ys,null,0);V.framebufferTexture2D(As,33306,ys,null,0),V.framebufferTexture2D(As,36096,ys,null,0),V.framebufferTexture2D(As,36128,ys,null,0),Hr(36096,Jr.depthAttachment),Hr(36128,Jr.stencilAttachment),Hr(33306,Jr.depthStencilAttachment);var zi=V.checkFramebufferStatus(As);!V.isContextLost()&&36053!==zi&&B.raise("framebuffer configuration not supported, status = "+Ae[zi]),V.bindFramebuffer(As,Er.next?Er.next.framebuffer:null),Er.cur=Er.next,V.getError()}function Sr(Jr,yn){var wn=new bn;function zi(En,Sn){var _i;B(Er.next!==wn,"can not update framebuffer which is currently in use");var Zi=0,fa=0,Mo=!0,Io=!0,ha=null,ds=!0,so="rgba",vs="uint8",Uo=1,ss=null,ms=null,us=null,Vo=!1;if("number"==typeof En)Zi=0|En,fa=0|Sn||Zi;else if(En){B.type(En,"object","invalid arguments for framebuffer");var Hi=En;if("shape"in Hi){var ls=Hi.shape;B(Array.isArray(ls)&&ls.length>=2,"invalid shape for framebuffer"),Zi=ls[0],fa=ls[1]}else"radius"in Hi&&(Zi=fa=Hi.radius),"width"in Hi&&(Zi=Hi.width),"height"in Hi&&(fa=Hi.height);("color"in Hi||"colors"in Hi)&&(ha=Hi.color||Hi.colors,Array.isArray(ha)&&B(1===ha.length||ke.webgl_draw_buffers,"multiple render targets not supported")),ha||("colorCount"in Hi&&B((Uo=0|Hi.colorCount)>0,"invalid color buffer count"),"colorTexture"in Hi&&(ds=!!Hi.colorTexture,so="rgba4"),"colorType"in Hi&&(vs=Hi.colorType,ds?(B(ke.oes_texture_float||!("float"===vs||"float32"===vs),"you must enable OES_texture_float in order to use floating point framebuffer objects"),B(ke.oes_texture_half_float||!("half float"===vs||"float16"===vs),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):"half float"===vs||"float16"===vs?(B(ke.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),so="rgba16f"):("float"===vs||"float32"===vs)&&(B(ke.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),so="rgba32f"),B.oneOf(vs,Kr,"invalid color type")),"colorFormat"in Hi&&(Zr.indexOf(so=Hi.colorFormat)>=0?ds=!0:Gr.indexOf(so)>=0?ds=!1:B.optional(function(){ds?B.oneOf(Hi.colorFormat,Zr,"invalid color format for texture"):B.oneOf(Hi.colorFormat,Gr,"invalid color format for renderbuffer")}))),("depthTexture"in Hi||"depthStencilTexture"in Hi)&&B(!(Vo=!(!Hi.depthTexture&&!Hi.depthStencilTexture))||ke.webgl_depth_texture,"webgl_depth_texture extension not supported"),"depth"in Hi&&("boolean"==typeof Hi.depth?Mo=Hi.depth:(ss=Hi.depth,Io=!1)),"stencil"in Hi&&("boolean"==typeof Hi.stencil?Io=Hi.stencil:(ms=Hi.stencil,Mo=!1)),"depthStencil"in Hi&&("boolean"==typeof Hi.depthStencil?Mo=Io=Hi.depthStencil:(us=Hi.depthStencil,Mo=!1,Io=!1))}else Zi=fa=1;var La=null,uo=null,Ai=null,pa=null;if(Array.isArray(ha))La=ha.map(en);else if(ha)La=[en(ha)];else for(La=new Array(Uo),_i=0;_i<Uo;++_i)La[_i]=Bt(Zi,fa,ds,so,vs);B(ke.webgl_draw_buffers||La.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),B(La.length<=Qe.maxColorAttachments,"too many color attachments, not supported"),Zi=Zi||La[0].width,fa=fa||La[0].height,ss?uo=en(ss):Mo&&!Io&&(uo=Bt(Zi,fa,Vo,"depth","uint32")),ms?Ai=en(ms):Io&&!Mo&&(Ai=Bt(Zi,fa,!1,"stencil","uint8")),us?pa=en(us):!ss&&!ms&&Io&&Mo&&(pa=Bt(Zi,fa,Vo,"depth stencil","depth stencil")),B(!!ss+!!ms+!!us<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Qa=null;for(_i=0;_i<La.length;++_i)if(hn(La[_i],Zi,fa),B(!La[_i]||La[_i].texture&&cc.indexOf(La[_i].texture._texture.format)>=0||La[_i].renderbuffer&&Ee.indexOf(La[_i].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+_i+" is invalid"),La[_i]&&La[_i].texture){var To=fc[La[_i].texture._texture.format]*El[La[_i].texture._texture.type];null===Qa?Qa=To:B(Qa===To,"all color attachments much have the same number of bits per pixel.")}return hn(uo,Zi,fa),B(!uo||uo.texture&&6402===uo.texture._texture.format||uo.renderbuffer&&33189===uo.renderbuffer._renderbuffer.format,"invalid depth attachment for framebuffer object"),hn(Ai,Zi,fa),B(!Ai||Ai.renderbuffer&&36168===Ai.renderbuffer._renderbuffer.format,"invalid stencil attachment for framebuffer object"),hn(pa,Zi,fa),B(!pa||pa.texture&&34041===pa.texture._texture.format||pa.renderbuffer&&34041===pa.renderbuffer._renderbuffer.format,"invalid depth-stencil attachment for framebuffer object"),tn(wn),wn.width=Zi,wn.height=fa,wn.colorAttachments=La,wn.depthAttachment=uo,wn.stencilAttachment=Ai,wn.depthStencilAttachment=pa,zi.color=La.map(gr),zi.depth=gr(uo),zi.stencil=gr(Ai),zi.depthStencil=gr(pa),zi.width=wn.width,zi.height=wn.height,Or(wn),zi}return tr.framebufferCount++,zi(Jr,yn),p(zi,{resize:function(En,Sn){B(Er.next!==wn,"can not resize a framebuffer which is currently in use");var _i=Math.max(0|En,1),Zi=Math.max(0|Sn||_i,1);if(_i===wn.width&&Zi===wn.height)return zi;for(var fa=wn.colorAttachments,Mo=0;Mo<fa.length;++Mo)Wr(fa[Mo],_i,Zi);return Wr(wn.depthAttachment,_i,Zi),Wr(wn.stencilAttachment,_i,Zi),Wr(wn.depthStencilAttachment,_i,Zi),wn.width=zi.width=_i,wn.height=zi.height=Zi,Or(wn),zi},_reglType:"framebuffer",_framebuffer:wn,destroy:function(){ui(wn),tn(wn)},use:function(En){Er.setFBO({framebuffer:zi},En)}})}return p(Er,{getFramebuffer:function(Jr){if("function"==typeof Jr&&"framebuffer"===Jr._reglType){var yn=Jr._framebuffer;if(yn instanceof bn)return yn}return null},create:Sr,createCube:function(Jr){var yn=Array(6);function wn(Mi){var En;B(yn.indexOf(Er.next)<0,"can not update framebuffer which is currently in use");var so,Sn={color:null},_i=0,Zi=null,fa="rgba",Mo="uint8",Io=1;if("number"==typeof Mi)_i=0|Mi;else if(Mi){B.type(Mi,"object","invalid arguments for framebuffer");var ha=Mi;if("shape"in ha){var ds=ha.shape;B(Array.isArray(ds)&&ds.length>=2,"invalid shape for framebuffer"),B(ds[0]===ds[1],"cube framebuffer must be square"),_i=ds[0]}else"radius"in ha&&(_i=0|ha.radius),"width"in ha?(_i=0|ha.width,"height"in ha&&B(ha.height===_i,"must be square")):"height"in ha&&(_i=0|ha.height);("color"in ha||"colors"in ha)&&(Zi=ha.color||ha.colors,Array.isArray(Zi)&&B(1===Zi.length||ke.webgl_draw_buffers,"multiple render targets not supported")),Zi||("colorCount"in ha&&B((Io=0|ha.colorCount)>0,"invalid color buffer count"),"colorType"in ha&&(B.oneOf(ha.colorType,Kr,"invalid color type"),Mo=ha.colorType),"colorFormat"in ha&&(fa=ha.colorFormat,B.oneOf(ha.colorFormat,Zr,"invalid color format for texture"))),"depth"in ha&&(Sn.depth=ha.depth),"stencil"in ha&&(Sn.stencil=ha.stencil),"depthStencil"in ha&&(Sn.depthStencil=ha.depthStencil)}else _i=1;if(Zi)if(Array.isArray(Zi))for(so=[],En=0;En<Zi.length;++En)so[En]=Zi[En];else so=[Zi];else{so=Array(Io);var vs={radius:_i,format:fa,type:Mo};for(En=0;En<Io;++En)so[En]=ir.createCube(vs)}for(Sn.color=Array(so.length),En=0;En<so.length;++En){var Uo=so[En];B("function"==typeof Uo&&"textureCube"===Uo._reglType,"invalid cube map"),B(Uo.width===(_i=_i||Uo.width)&&Uo.height===_i,"invalid cube map shape"),Sn.color[En]={target:is,data:so[En]}}for(En=0;En<6;++En){for(var ss=0;ss<so.length;++ss)Sn.color[ss].target=is+En;En>0&&(Sn.depth=yn[0].depth,Sn.stencil=yn[0].stencil,Sn.depthStencil=yn[0].depthStencil),yn[En]?yn[En](Sn):yn[En]=Sr(Sn)}return p(wn,{width:_i,height:_i,color:so})}return wn(Jr),p(wn,{faces:yn,resize:function(Mi){var En,Sn=0|Mi;if(B(Sn>0&&Sn<=Qe.maxCubeMapSize,"invalid radius for cube fbo"),Sn===wn.width)return wn;var _i=wn.color;for(En=0;En<_i.length;++En)_i[En].resize(Sn);for(En=0;En<6;++En)yn[En].resize(Sn);return wn.width=wn.height=Sn,wn},_reglType:"framebufferCube",destroy:function(){yn.forEach(function(Mi){Mi.destroy()})}})},clear:function(){Qt(Mr).forEach(ui)},restore:function(){Er.cur=null,Er.next=null,Er.dirty=!0,Qt(Mr).forEach(function(Jr){Jr.framebuffer=V.createFramebuffer(),Or(Jr)})}})}(Qe,Gr,gr,ui,Or,Zr),jn=Ap(Qe,Er,Gr,gr,Wr,Tn,0,Sr,{},Mr,tn,Bt,Hr,Kr,ke),dn=Un(Qe,Sr,jn.procs.poll,Hr,ir,Gr,gr),Jr=jn.next,yn=Qe.canvas,wn=[],zi=[],Mi=[],En=[ke.onDestroy],Sn=null;function _i(){if(0===wn.length)return Kr&&Kr.update(),void(Sn=null);Sn=mi.next(_i),Vo();for(var Ai=wn.length-1;Ai>=0;--Ai){var pa=wn[Ai];pa&&pa(Hr,null,0)}Qe.flush(),Kr&&Kr.update()}function Zi(){!Sn&&wn.length>0&&(Sn=mi.next(_i))}function fa(){Sn&&(mi.cancel(_i),Sn=null)}function Mo(Ai){Ai.preventDefault(),kr=!0,fa(),zi.forEach(function(pa){pa()})}function Io(Ai){Qe.getError(),kr=!1,tr.restore(),tn.restore(),Wr.restore(),ui.restore(),Or.restore(),Sr.restore(),Mr.restore(),Kr&&Kr.restore(),jn.procs.refresh(),Zi(),Mi.forEach(function(pa){pa()})}var ha="undefined"!=typeof my&&!!my&&"function"==typeof my.showToast;function so(Ai){function Qa(yt,ht){var ut={},Be={};return Object.keys(yt).forEach(function(ot){var Ze=yt[ot];if(Wn.isDynamic(Ze))Be[ot]=Wn.unbox(Ze,ot);else{if(ht&&Array.isArray(Ze))for(var Nt=0;Nt<Ze.length;++Nt)if(Wn.isDynamic(Ze[Nt]))return void(Be[ot]=Wn.unbox(Ze,ot));ut[ot]=Ze}}),{dynamic:Be,static:ut}}B(!!Ai,"invalid args to regl({...})"),B.type(Ai,"object","invalid args to regl({...})");var To=Qa(Ai.context||{},!0),Pl=Qa(Ai.uniforms||{},!0),Ye=Qa(Ai.attributes||{},!1),ur=Qa(function(yt){var ht=p({},yt);function ut(Be){if(Be in ht){var ot=ht[Be];delete ht[Be],Object.keys(ot).forEach(function(Ze){ht[Be+"."+Ze]=ot[Ze]})}}return delete ht.uniforms,delete ht.attributes,delete ht.context,delete ht.vao,"stencil"in ht&&ht.stencil.op&&(ht.stencil.opBack=ht.stencil.opFront=ht.stencil.op,delete ht.stencil.op),ut("blend"),ut("depth"),ut("cull"),ut("stencil"),ut("polygonOffset"),ut("scissor"),ut("sample"),"vao"in yt&&(ht.vao=yt.vao),ht}(Ai),!1),Kt={gpuTime:0,cpuTime:0,count:0},Fn=jn.compile(ur,Ye,Pl,To,Kt),ya=Fn.draw,Ne=Fn.batch,Ce=Fn.scope,lt=[];return p(function(yt,ht){var ut;if(kr&&B.raise("context lost"),"function"==typeof yt)return Ce.call(this,null,yt,0);if("function"==typeof ht)if("number"==typeof yt)for(ut=0;ut<yt;++ut)Ce.call(this,null,ht,ut);else{if(!Array.isArray(yt))return Ce.call(this,yt,ht,0);for(ut=0;ut<yt.length;++ut)Ce.call(this,yt[ut],ht,ut)}else if("number"==typeof yt){if(yt>0)return Ne.call(this,function(yt){for(;lt.length<yt;)lt.push(null);return lt}(0|yt),0|yt)}else{if(!Array.isArray(yt))return ya.call(this,yt);if(yt.length)return Ne.call(this,yt,yt.length)}},{stats:Kt,destroy:function(){Fn.destroy()}})}!ha&&yn&&(yn.addEventListener(Mh,Mo,!1),yn.addEventListener(zc,Io,!1));var vs=Sr.setFBO=so({framebuffer:Wn.define.call(null,1,"framebuffer")});function Uo(Ai,pa){var Qa=0;jn.procs.poll();var To=pa.color;To&&(Qe.clearColor(+To[0]||0,+To[1]||0,+To[2]||0,+To[3]||0),Qa|=16384),"depth"in pa&&(Qe.clearDepth(+pa.depth),Qa|=256),"stencil"in pa&&(Qe.clearStencil(0|pa.stencil),Qa|=1024),B(!!Qa,"called regl.clear with no buffer specified"),Qe.clear(Qa)}function ms(Ai){return B.type(Ai,"function","regl.frame() callback must be a function"),wn.push(Ai),Zi(),{cancel:function(){var Qa=nf(wn,Ai);B(Qa>=0,"cannot cancel a frame twice"),wn[Qa]=function To(){var Pl=nf(wn,To);wn[Pl]=wn[wn.length-1],wn.length-=1,wn.length<=0&&fa()}}}}function us(){var Ai=Jr.viewport,pa=Jr.scissor_box;Ai[0]=Ai[1]=pa[0]=pa[1]=0,Hr.viewportWidth=Hr.framebufferWidth=Hr.drawingBufferWidth=Ai[2]=pa[2]=Qe.drawingBufferWidth,Hr.viewportHeight=Hr.framebufferHeight=Hr.drawingBufferHeight=Ai[3]=pa[3]=Qe.drawingBufferHeight}function Vo(){Hr.tick+=1,Hr.time=ls(),us(),jn.procs.poll()}function Hi(){ui.refresh(),us(),jn.procs.refresh(),Kr&&Kr.update()}function ls(){return(si()-qr)/1e3}Hi();var uo=p(so,{clear:function(Ai){if(B("object"==typeof Ai&&Ai,"regl.clear() takes an object as input"),"framebuffer"in Ai)if(Ai.framebuffer&&"framebufferCube"===Ai.framebuffer_reglType)for(var pa=0;pa<6;++pa)vs(p({framebuffer:Ai.framebuffer.faces[pa]},Ai),Uo);else vs(Ai,Uo);else Uo(0,Ai)},prop:Wn.define.bind(null,1),context:Wn.define.bind(null,2),this:Wn.define.bind(null,3),draw:so({}),buffer:function(Ai){return Wr.create(Ai,34962,!1,!1)},elements:function(Ai){return Tn.create(Ai,!1)},texture:ui.create2D,cube:ui.createCube,renderbuffer:Or.create,framebuffer:Sr.create,framebufferCube:Sr.createCube,vao:Mr.createVAO,attributes:ir,frame:ms,on:function(Ai,pa){var Qa;switch(B.type(pa,"function","listener callback must be a function"),Ai){case"frame":return ms(pa);case"lost":Qa=zi;break;case"restore":Qa=Mi;break;case"destroy":Qa=En;break;default:B.raise("invalid event, must be one of frame,lost,restore,destroy")}return Qa.push(pa),{cancel:function(){for(var To=0;To<Qa.length;++To)if(Qa[To]===pa)return Qa[To]=Qa[Qa.length-1],void Qa.pop()}}},limits:gr,hasExtension:function(Ai){return gr.extensions.indexOf(Ai.toLowerCase())>=0},read:dn,destroy:function(){wn.length=0,fa(),!ha&&yn&&(yn.removeEventListener(Mh,Mo),yn.removeEventListener(zc,Io)),tn.clear(),Sr.clear(),Or.clear(),Mr.clear(),ui.clear(),Tn.clear(),Wr.clear(),Kr&&Kr.clear(),En.forEach(function(Ai){Ai()})},_gl:Qe,_refresh:Hi,poll:function(){Vo(),Kr&&Kr.update()},now:ls,stats:Zr});return ke.onDone(null,uo),uo}}(M(88660))},87280:dr=>{dr.exports=function(M){return M.split("")}},54561:dr=>{var H=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;dr.exports=function(ue){return ue.match(H)||[]}},15820:dr=>{dr.exports=function(M,ue,w){return M==M&&(void 0!==w&&(M=M<=w?M:w),void 0!==ue&&(M=M>=ue?M:ue)),M}},17421:dr=>{dr.exports=function(M){return function(ue){return null==M?void 0:M[ue]}}},63586:dr=>{dr.exports=function(M,ue,w){var p=-1,_=M.length;ue<0&&(ue=-ue>_?0:_+ue),(w=w>_?_:w)<0&&(w+=_),_=ue>w?0:w-ue>>>0,ue>>>=0;for(var W=Array(_);++p<_;)W[p]=M[p+ue];return W}},26477:(dr,H,M)=>{var ue=M(63586);dr.exports=function(p,_,W){var X=p.length;return W=void 0===W?X:W,!_&&W>=X?p:ue(p,_,W)}},66803:(dr,H,M)=>{var ue=M(26477),w=M(407),p=M(2150),_=M(41233);dr.exports=function(X){return function(q){q=_(q);var te=w(q)?p(q):void 0,Y=te?te[0]:q.charAt(0),Xe=te?ue(te,1).join(""):q.slice(1);return Y[X]()+Xe}}},17407:(dr,H,M)=>{var ue=M(89731),w=M(75289),p=M(96590),W=RegExp("['\u2019]","g");dr.exports=function(q){return function(te){return ue(p(w(te).replace(W,"")),q,"")}}},4068:(dr,H,M)=>{var p=M(17421)({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"});dr.exports=p},59316:dr=>{var H=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;dr.exports=function(ue){return H.test(ue)}},2150:(dr,H,M)=>{var ue=M(87280),w=M(407),p=M(1879);dr.exports=function(W){return w(W)?p(W):ue(W)}},1879:dr=>{var H="\\ud800-\\udfff",W="["+H+"]",X="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",q="\\ud83c[\\udffb-\\udfff]",Y="[^"+H+"]",Xe="(?:\\ud83c[\\udde6-\\uddff]){2}",et="[\\ud800-\\udbff][\\udc00-\\udfff]",Z="(?:"+X+"|"+q+")?",tt="[\\ufe0e\\ufe0f]?",sr=tt+Z+"(?:\\u200d(?:"+[Y,Xe,et].join("|")+")"+tt+Z+")*",Ut="(?:"+[Y+X+"?",X,Xe,et,W].join("|")+")",At=RegExp(q+"(?="+q+")|"+Ut+sr,"g");dr.exports=function(vr){return vr.match(At)||[]}},58863:dr=>{var H="\\ud800-\\udfff",_="\\u2700-\\u27bf",W="a-z\\xdf-\\xf6\\xf8-\\xff",Xe="A-Z\\xc0-\\xd6\\xd8-\\xde",z="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",tt="["+z+"]",sr="\\d+",Ut="["+_+"]",At="["+W+"]",Et="[^"+H+z+sr+_+W+Xe+"]",Tt="(?:\\ud83c[\\udde6-\\uddff]){2}",$e="[\\ud800-\\udbff][\\udc00-\\udfff]",Ct="["+Xe+"]",Dt="(?:"+At+"|"+Et+")",lr="(?:"+Ct+"|"+Et+")",hr="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Dr="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",_e="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",ve="[\\ufe0e\\ufe0f]?",ze=ve+_e+"(?:\\u200d(?:"+["[^"+H+"]",Tt,$e].join("|")+")"+ve+_e+")*",pt="(?:"+[Ut,Tt,$e].join("|")+")"+ze,br=RegExp([Ct+"?"+At+"+"+hr+"(?="+[tt,Ct,"$"].join("|")+")",lr+"+"+Dr+"(?="+[tt,Ct+Dt,"$"].join("|")+")",Ct+"?"+Dt+"+"+hr,Ct+"+"+Dr,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",sr,pt].join("|"),"g");dr.exports=function(fn){return fn.match(br)||[]}},35037:(dr,H,M)=>{var ue=M(76974),p=M(17407)(function(_,W,X){return W=W.toLowerCase(),_+(X?ue(W):W)});dr.exports=p},76974:(dr,H,M)=>{var ue=M(41233),w=M(93890);dr.exports=function(_){return w(ue(_).toLowerCase())}},43770:(dr,H,M)=>{var ue=M(15820),w=M(45038);dr.exports=function(_,W,X){return void 0===X&&(X=W,W=void 0),void 0!==X&&(X=(X=w(X))==X?X:0),void 0!==W&&(W=(W=w(W))==W?W:0),ue(w(_),W,X)}},75289:(dr,H,M)=>{var ue=M(4068),w=M(41233),p=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Y=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");dr.exports=function(et){return(et=w(et))&&et.replace(p,ue).replace(Y,"")}},49977:(dr,H,M)=>{var ue=M(30696);dr.exports=function(p,_){return ue(p,_)}},28303:dr=>{dr.exports=function(M){return null==M}},80167:(dr,H,M)=>{var ue=M(72802),w=M(27503);dr.exports=function(W){return"number"==typeof W||w(W)&&"[object Number]"==ue(W)}},33939:(dr,H,M)=>{var ue=M(9085),p=M(30906)(function(_,W,X,q){ue(_,W,X,q)});dr.exports=p},72699:(dr,H,M)=>{var ue=M(83987);dr.exports=function(p){return p&&p.length?ue(p):[]}},93890:(dr,H,M)=>{var w=M(66803)("toUpperCase");dr.exports=w},96590:(dr,H,M)=>{var ue=M(54561),w=M(59316),p=M(41233),_=M(58863);dr.exports=function(X,q,te){return X=p(X),void 0===(q=te?void 0:q)?w(X)?_(X):ue(X):X.match(q)||[]}},82958:function(dr){dr.exports=function(){"use strict";var H,M,ue;function w(p,_){if(H)if(M){var W="var sharedChunk = {}; ("+H+")(sharedChunk); ("+M+")(sharedChunk);",X={};H(X),ue=_(X),"undefined"!=typeof window&&(ue.workerUrl=window.URL.createObjectURL(new Blob([W],{type:"text/javascript"})))}else M=_;else H=_}return w(0,function(p){function _(e,t){return e(t={exports:{}},t.exports),t.exports}var W=X;function X(e,t,r,c){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=c,this.p2x=r,this.p2y=c}X.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},X.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},X.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},X.prototype.solveCurveX=function(e,t){var r,c,d,g,x;for(void 0===t&&(t=1e-6),d=e,x=0;x<8;x++){if(g=this.sampleCurveX(d)-e,Math.abs(g)<t)return d;var A=this.sampleCurveDerivativeX(d);if(Math.abs(A)<1e-6)break;d-=g/A}if((d=e)<(r=0))return r;if(d>(c=1))return c;for(;r<c;){if(g=this.sampleCurveX(d),Math.abs(g-e)<t)return d;e>g?r=d:c=d,d=.5*(c-r)+r}return d},X.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var q=te;function te(e,t){this.x=e,this.y=t}te.prototype={clone:function(){return new te(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),c=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=c,this},_rotateAround:function(e,t){var r=Math.cos(e),c=Math.sin(e),d=t.y+c*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-c*(this.y-t.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},te.convert=function(e){return e instanceof te?e:Array.isArray(e)?new te(e[0],e[1]):e};var Y="undefined"!=typeof self?self:{},Xe=Math.pow(2,53)-1;function et(e,t,r,c){var d=new W(e,t,r,c);return function(g){return d.solve(g)}}var z=et(.25,.1,.25,1);function Z(e,t,r){return Math.min(r,Math.max(t,e))}function tt(e,t,r){var c=r-t,d=((e-t)%c+c)%c+t;return d===t?r:d}function Mt(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var c=0,d=t;c<d.length;c+=1){var g=d[c];for(var x in g)e[x]=g[x]}return e}var sr=1;function Ut(){return sr++}function At(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function Et(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function vr(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function ne(e,t){return-1!==e.indexOf(t,e.length-t.length)}function nr(e,t,r){var c={};for(var d in e)c[d]=t.call(r||this,e[d],d,e);return c}function Tt(e,t,r){var c={};for(var d in e)t.call(r||this,e[d],d,e)&&(c[d]=e[d]);return c}function $e(e){return Array.isArray(e)?e.map($e):"object"==typeof e&&e?nr(e,$e):e}var Ct={};function qe(e){Ct[e]||("undefined"!=typeof console&&console.warn(e),Ct[e]=!0)}function Dt(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function lr(e){for(var t=0,r=0,c=e.length,d=c-1,g=void 0,x=void 0;r<c;d=r++)t+=((x=e[d]).x-(g=e[r]).x)*(g.y+x.y);return t}function hr(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Dr(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(c,d,g,x){var A=g||x;return t[d]=!A||A.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var _e=null;function ve(e){if(null==_e){var t=e.navigator?e.navigator.userAgent:null;_e=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return _e}function ae(e){try{var t=Y[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var de,Pe,ze,pt,br=Y.performance&&Y.performance.now?Y.performance.now.bind(Y.performance):Date.now.bind(Date),Ur=Y.requestAnimationFrame||Y.mozRequestAnimationFrame||Y.webkitRequestAnimationFrame||Y.msRequestAnimationFrame,fn=Y.cancelAnimationFrame||Y.mozCancelAnimationFrame||Y.webkitCancelAnimationFrame||Y.msCancelAnimationFrame,Pr={now:br,frame:function(e){var t=Ur(e);return{cancel:function(){return fn(t)}}},getImageData:function(e,t){void 0===t&&(t=0);var r=Y.document.createElement("canvas"),c=r.getContext("2d");if(!c)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,c.drawImage(e,0,0,e.width,e.height),c.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return de||(de=Y.document.createElement("a")),de.href=e,de.href},hardwareConcurrency:Y.navigator&&Y.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Y.devicePixelRatio},get prefersReducedMotion(){return!!Y.matchMedia&&(null==Pe&&(Pe=Y.matchMedia("(prefers-reduced-motion: reduce)")),Pe.matches)}},wt={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ie={supported:!1,testSupport:function(e){!we&&pt&&(nt?Le(e):ze=e)}},we=!1,nt=!1;function Le(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,pt),e.isContextLost())return;Ie.supported=!0}catch(r){}e.deleteTexture(t),we=!0}Y.document&&((pt=Y.document.createElement("img")).onload=function(){ze&&Le(ze),ze=null,nt=!0},pt.onerror=function(){we=!0,ze=null},pt.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Wt="01",Ar=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Yt(e){return 0===e.indexOf("mapbox:")}Ar.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Wt,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Ar.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ar.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Ar.prototype.normalizeStyleURL=function(e,t){if(!Yt(e))return e;var r=T(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Ar.prototype.normalizeGlyphsURL=function(e,t){if(!Yt(e))return e;var r=T(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Ar.prototype.normalizeSourceURL=function(e,t){if(!Yt(e))return e;var r=T(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},Ar.prototype.normalizeSpriteURL=function(e,t,r,c){var d=T(e);return Yt(e)?(d.path="/styles/v1"+d.path+"/sprite"+t+r,this._makeAPIURL(d,this._customAccessToken||c)):(d.path+=""+t+r,G(d))},Ar.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Yt(e))return e;var r=T(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Pr.devicePixelRatio>=2||512===t?"@2x":"")+(Ie.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var c=this._customAccessToken||function(d){for(var g=0,x=d;g<x.length;g+=1){var A=x[g].match(/^access_token=(.*)$/);if(A)return A[1]}return null}(r.params)||wt.ACCESS_TOKEN;return wt.REQUIRE_ACCESS_TOKEN&&c&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,c)},Ar.prototype.canonicalizeTileURL=function(e,t){var r=T(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var c="mapbox://tiles/";c+=r.path.replace("/v4/","");var d=r.params;return t&&(d=d.filter(function(g){return!g.match(/^access_token=/)})),d.length&&(c+="?"+d.join("&")),c},Ar.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&Yt(t),c=[],d=0,g=e.tiles||[];d<g.length;d+=1){var x=g[d];Fr(x)?c.push(this.canonicalizeTileURL(x,r)):c.push(x)}return c},Ar.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",c=T(wt.API_URL);if(e.protocol=c.protocol,e.authority=c.authority,"http"===e.protocol){var d=e.params.indexOf("secure");d>=0&&e.params.splice(d,1)}if("/"!==c.path&&(e.path=""+c.path+e.path),!wt.REQUIRE_ACCESS_TOKEN)return G(e);if(!(t=t||wt.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if("s"===t[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(g){return-1===g.indexOf("access_token")}),e.params.push("access_token="+t),G(e)};var cr=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Fr(e){return cr.test(e)}var Zn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function T(e){var t=e.match(Zn);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function G(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function Ve(e){if(!e)return null;var t=e.split(".");if(!t||3!==t.length)return null;try{return JSON.parse(decodeURIComponent(Y.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var rt=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};rt.prototype.getStorageKey=function(e){var t,r=Ve(wt.ACCESS_TOKEN);return t=r&&r.u?Y.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(c,d){return String.fromCharCode(Number("0x"+d))})):wt.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},rt.prototype.fetchEventData=function(){var e=ae("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var c=Y.localStorage.getItem(t);c&&(this.eventData=JSON.parse(c));var d=Y.localStorage.getItem(r);d&&(this.anonId=d)}catch(g){qe("Unable to read from LocalStorage")}},rt.prototype.saveEventData=function(){var e=ae("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{Y.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&Y.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(c){qe("Unable to write to LocalStorage")}},rt.prototype.processRequests=function(e){},rt.prototype.postEvent=function(e,t,r,c){var d=this;if(wt.EVENTS_URL){var g=T(wt.EVENTS_URL);g.params.push("access_token="+(c||wt.ACCESS_TOKEN||""));var x={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.2",skuId:Wt,userId:this.anonId},A=t?Mt(x,t):x,R={url:G(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([A])};this.pendingRequest=Ei(R,function(j){d.pendingRequest=null,r(j),d.saveEventData(),d.processRequests(c)})}},rt.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var dt,Ot,B=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,c,d,g){this.skuToken=d,(wt.EVENTS_URL&&g||wt.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(x){return Yt(x)||Fr(x)}))&&this.queueRequest({id:c,timestamp:Date.now()},g)},t.prototype.processRequests=function(r){var c=this;if(!this.pendingRequest&&0!==this.queue.length){var d=this.queue.shift(),g=d.id,x=d.timestamp;g&&this.success[g]||(this.anonId||this.fetchEventData(),Et(this.anonId)||(this.anonId=At()),this.postEvent(x,{skuToken:this.skuToken},function(A){A||g&&(c.success[g]=!0)},r))}},t}(rt),Ue=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,c){wt.EVENTS_URL&&wt.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(d){return Yt(d)||Fr(d)})&&this.queueRequest(Date.now(),c)},t.prototype.processRequests=function(r){var c=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var d=Ve(wt.ACCESS_TOKEN),g=d?d.u:wt.ACCESS_TOKEN,x=g!==this.eventData.tokenU;Et(this.anonId)||(this.anonId=At(),x=!0);var A=this.queue.shift();if(this.eventData.lastSuccess){var R=new Date(this.eventData.lastSuccess),j=new Date(A),J=(A-this.eventData.lastSuccess)/864e5;x=x||J>=1||J<-1||R.getDate()!==j.getDate()}else x=!0;if(!x)return this.processRequests();this.postEvent(A,{"enabled.telemetry":!1},function(oe){oe||(c.eventData.lastSuccess=A,c.eventData.tokenU=g)},r)}},t}(rt)),_t=Ue.postTurnstileEvent.bind(Ue),St=new B,Xt=St.postMapLoadEvent.bind(St),Cr=500,_r=50;function jt(){Y.caches&&!dt&&(dt=Y.caches.open("mapbox-tiles"))}function mr(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var er,pr=1/0;function Ln(){return null==er&&(er=Y.OffscreenCanvas&&new Y.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof Y.createImageBitmap),er}var Wn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Wn);var si,ai,mi=function(e){function t(r,c,d){401===c&&Fr(d)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=c,this.url=d,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),hi=hr()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===Y.location.protocol?Y.parent:Y).location.href},Yi=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(hi())&&!/^\w+:/.test(r))){if(Y.fetch&&Y.Request&&Y.AbortController&&Y.Request.prototype.hasOwnProperty("signal"))return function(c,d){var g,x=new Y.AbortController,A=new Y.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:hi(),signal:x.signal}),R=!1,j=!1,J=(g=A.url).indexOf("sku=")>0&&Fr(g);"json"===c.type&&A.headers.set("Accept","application/json");var oe=function(xe,Ge,He){if(!j){if(xe&&"SecurityError"!==xe.message&&qe(xe),Ge&&He)return me(Ge);var gt=Date.now();Y.fetch(A).then(function(it){if(it.ok){var Lt=J?it.clone():null;return me(it,Lt,gt)}return d(new mi(it.statusText,it.status,c.url))}).catch(function(it){20!==it.code&&d(new Error(it.message))})}},me=function(xe,Ge,He){("arrayBuffer"===c.type?xe.arrayBuffer():"json"===c.type?xe.json():xe.text()).then(function(gt){j||(Ge&&He&&function(it,Lt,Ht){if(jt(),dt){var fr={status:Lt.status,statusText:Lt.statusText,headers:new Y.Headers};Lt.headers.forEach(function(Lr,rn){return fr.headers.set(rn,Lr)});var xr=Dr(Lt.headers.get("Cache-Control")||"");xr["no-store"]||(xr["max-age"]&&fr.headers.set("Expires",new Date(Ht+1e3*xr["max-age"]).toUTCString()),new Date(fr.headers.get("Expires")).getTime()-Ht<42e4||function(Lr,rn){if(void 0===Ot)try{new Response(new ReadableStream),Ot=!0}catch(vn){Ot=!1}Ot?rn(Lr.body):Lr.blob().then(rn)}(Lt,function(Lr){var rn=new Y.Response(Lr,fr);jt(),dt&&dt.then(function(vn){return vn.put(mr(it.url),rn)}).catch(function(vn){return qe(vn.message)})}))}}(A,Ge,He),R=!0,d(null,gt,xe.headers.get("Cache-Control"),xe.headers.get("Expires")))}).catch(function(gt){j||d(new Error(gt.message))})};return J?function(xe,Ge){if(jt(),!dt)return Ge(null);var He=mr(xe.url);dt.then(function(gt){gt.match(He).then(function(it){var Lt=function(Ht){if(!Ht)return!1;var fr=new Date(Ht.headers.get("Expires")||0),xr=Dr(Ht.headers.get("Cache-Control")||"");return fr>Date.now()&&!xr["no-cache"]}(it);gt.delete(He),Lt&&gt.put(He,it.clone()),Ge(null,it,Lt)}).catch(Ge)}).catch(Ge)}(A,oe):oe(null,null),{cancel:function(){j=!0,R||x.abort()}}}(e,t);if(hr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(c,d){var g=new Y.XMLHttpRequest;for(var x in g.open(c.method||"GET",c.url,!0),"arrayBuffer"===c.type&&(g.responseType="arraybuffer"),c.headers)g.setRequestHeader(x,c.headers[x]);return"json"===c.type&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials="include"===c.credentials,g.onerror=function(){d(new Error(g.statusText))},g.onload=function(){if((g.status>=200&&g.status<300||0===g.status)&&null!==g.response){var A=g.response;if("json"===c.type)try{A=JSON.parse(g.response)}catch(R){return d(R)}d(null,A,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else d(new mi(g.statusText,g.status,c.url))},g.send(c.body),{cancel:function(){return g.abort()}}}(e,t)},Pi=function(e,t){return Yi(Mt(e,{type:"arrayBuffer"}),t)},Ei=function(e,t){return Yi(Mt(e,{method:"POST"}),t)},Q="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";si=[],ai=0;var he=function(e,t){if(Ie.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),ai>=wt.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return si.push(r),r}ai++;var c=!1,d=function(){if(!c)for(c=!0,ai--;si.length&&ai<wt.MAX_PARALLEL_IMAGE_REQUESTS;){var x=si.shift();x.cancelled||(x.cancel=he(x.requestParameters,x.callback).cancel)}},g=Pi(e,function(x,A,R,j){var oe,me;d(),x?t(x):A&&(Ln()?(oe=t,me=new Y.Blob([new Uint8Array(A)],{type:"image/png"}),Y.createImageBitmap(me).then(function(xe){oe(null,xe)}).catch(function(xe){oe(new Error("Could not load image because of "+xe.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})):function(J,oe,me,xe){var Ge=new Y.Image,He=Y.URL;Ge.onload=function(){oe(null,Ge),He.revokeObjectURL(Ge.src),Ge.onload=null,Y.requestAnimationFrame(function(){Ge.src=Q})},Ge.onerror=function(){return oe(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var gt=new Y.Blob([new Uint8Array(J)],{type:"image/png"});Ge.cacheControl=me,Ge.expires=xe,Ge.src=J.byteLength?He.createObjectURL(gt):Q}(A,t,R,j))});return{cancel:function(){g.cancel(),d()}}};function ge(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function F(e,t,r){if(r&&r[e]){var c=r[e].indexOf(t);-1!==c&&r[e].splice(c,1)}}var re=function(e,t){void 0===t&&(t={}),Mt(this,t),this.type=e},ye=function(e){function t(r,c){void 0===c&&(c={}),e.call(this,"error",Mt({error:r},c))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(re),Me=function(){};Me.prototype.on=function(e,t){return this._listeners=this._listeners||{},ge(e,t,this._listeners),this},Me.prototype.off=function(e,t){return F(e,t,this._listeners),F(e,t,this._oneTimeListeners),this},Me.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},ge(e,t,this._oneTimeListeners),this},Me.prototype.fire=function(e,t){"string"==typeof e&&(e=new re(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var c=0,d=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];c<d.length;c+=1)d[c].call(this,e);for(var g=0,x=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];g<x.length;g+=1){var A=x[g];F(r,A,this._oneTimeListeners),A.call(this,e)}var R=this._eventedParent;R&&(Mt(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),R.fire(e))}else e instanceof ye&&console.error(e.error);return this},Me.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},Me.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var ce={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Te=function(e,t,r,c){this.message=(e?e+": ":"")+r,c&&(this.identifier=c),null!=t&&t.__line__&&(this.line=t.__line__)};function mt(e){var t=e.value;return t?[new Te(e.key,t,"constants have been deprecated as of v8")]:[]}function wr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var c=0,d=t;c<d.length;c+=1){var g=d[c];for(var x in g)e[x]=g[x]}return e}function Vt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function $t(e){if(Array.isArray(e))return e.map($t);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=$t(e[r]);return t}return Vt(e)}var Br=function(e){function t(r,c){e.call(this,c),this.message=c,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),On=function(e,t){void 0===t&&(t=[]),this.parent=e,this.bindings={};for(var r=0,c=t;r<c.length;r+=1){var d=c[r];this.bindings[d[0]]=d[1]}};On.prototype.concat=function(e){return new On(this,e)},On.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},On.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var Cn={kind:"null"},qt={kind:"number"},xn={kind:"string"},nn={kind:"boolean"},ln={kind:"color"},Di={kind:"object"},gn={kind:"value"},Oi={kind:"collator"},ta={kind:"formatted"},oi={kind:"resolvedImage"};function Ji(e,t){return{kind:"array",itemType:e,N:t}}function ji(e){if("array"===e.kind){var t=ji(e.itemType);return"number"==typeof e.N?"array<"+t+", "+e.N+">":"value"===e.itemType.kind?"array":"array<"+t+">"}return e.kind}var Ti=[Cn,qt,xn,nn,ln,ta,Di,Ji(gn),oi];function _a(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!_a(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(var r=0,c=Ti;r<c.length;r+=1)if(!_a(c[r],t))return null}return"Expected "+ji(e)+" but found "+ji(t)+" instead."}function Ma(e,t){return t.some(function(r){return r.kind===e.kind})}function Gi(e,t){return t.some(function(r){return"null"===r?null===e:"array"===r?Array.isArray(e):"object"===r?e&&!Array.isArray(e)&&"object"==typeof e:r===typeof e})}var Bi=_(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function c(A){return(A=Math.round(A))<0?0:A>255?255:A}function d(A){return c("%"===A[A.length-1]?parseFloat(A)/100*255:parseInt(A))}function g(A){return(R="%"===A[A.length-1]?parseFloat(A)/100:parseFloat(A))<0?0:R>1?1:R;var R}function x(A,R,j){return j<0?j+=1:j>1&&(j-=1),6*j<1?A+(R-A)*j*6:2*j<1?R:3*j<2?A+(R-A)*(2/3-j)*6:A}try{t.parseCSSColor=function(A){var R,j=A.replace(/ /g,"").toLowerCase();if(j in r)return r[j].slice();if("#"===j[0])return 4===j.length?(R=parseInt(j.substr(1),16))>=0&&R<=4095?[(3840&R)>>4|(3840&R)>>8,240&R|(240&R)>>4,15&R|(15&R)<<4,1]:null:7===j.length&&(R=parseInt(j.substr(1),16))>=0&&R<=16777215?[(16711680&R)>>16,(65280&R)>>8,255&R,1]:null;var J=j.indexOf("("),oe=j.indexOf(")");if(-1!==J&&oe+1===j.length){var me=j.substr(0,J),xe=j.substr(J+1,oe-(J+1)).split(","),Ge=1;switch(me){case"rgba":if(4!==xe.length)return null;Ge=g(xe.pop());case"rgb":return 3!==xe.length?null:[d(xe[0]),d(xe[1]),d(xe[2]),Ge];case"hsla":if(4!==xe.length)return null;Ge=g(xe.pop());case"hsl":if(3!==xe.length)return null;var He=(parseFloat(xe[0])%360+360)%360/360,gt=g(xe[1]),it=g(xe[2]),Lt=it<=.5?it*(gt+1):it+gt-it*gt,Ht=2*it-Lt;return[c(255*x(Ht,Lt,He+1/3)),c(255*x(Ht,Lt,He)),c(255*x(Ht,Lt,He-1/3)),Ge];default:return null}}return null}}catch(A){}}).parseCSSColor,Xi=function(e,t,r,c){void 0===c&&(c=1),this.r=e,this.g=t,this.b=r,this.a=c};Xi.parse=function(e){if(e){if(e instanceof Xi)return e;if("string"==typeof e){var t=Bi(e);if(t)return new Xi(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Xi.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],c=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+c+")"},Xi.prototype.toArray=function(){var e=this.a;return 0===e?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Xi.black=new Xi(0,0,0,1),Xi.white=new Xi(1,1,1,1),Xi.transparent=new Xi(0,0,0,0),Xi.red=new Xi(1,0,0,1);var to=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};to.prototype.compare=function(e,t){return this.collator.compare(e,t)},to.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Ho=function(e,t,r,c,d){this.text=e,this.image=t,this.scale=r,this.fontStack=c,this.textColor=d},Za=function(e){this.sections=e};Za.fromString=function(e){return new Za([new Ho(e,null,null,null,null)])},Za.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(e){return 0!==e.text.length||e.image&&0!==e.image.name.length})},Za.factory=function(e){return e instanceof Za?e:Za.fromString(e)},Za.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(e){return e.text}).join("")},Za.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var c=r[t];if(c.image)e.push(["image",c.image.name]);else{e.push(c.text);var d={};c.fontStack&&(d["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(d["font-scale"]=c.scale),c.textColor&&(d["text-color"]=["rgba"].concat(c.textColor.toArray())),e.push(d)}}return e};var Wi=function(e){this.name=e.name,this.available=e.available};function va(e,t,r,c){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===c||"number"==typeof c&&c>=0&&c<=1?null:"Invalid rgba value ["+[e,t,r,c].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof c?[e,t,r,c]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Su(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Xi||e instanceof to||e instanceof Za||e instanceof Wi)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Su(r[t]))return!1;return!0}if("object"==typeof e){for(var c in e)if(!Su(e[c]))return!1;return!0}return!1}function Da(e){if(null===e)return Cn;if("string"==typeof e)return xn;if("boolean"==typeof e)return nn;if("number"==typeof e)return qt;if(e instanceof Xi)return ln;if(e instanceof to)return Oi;if(e instanceof Za)return ta;if(e instanceof Wi)return oi;if(Array.isArray(e)){for(var t,r=e.length,c=0,d=e;c<d.length;c+=1){var g=Da(d[c]);if(t){if(t===g)continue;t=gn;break}t=g}return Ji(t||gn,r)}return Di}function qo(e){var t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Xi||e instanceof Za||e instanceof Wi?e.toString():JSON.stringify(e)}Wi.prototype.toString=function(){return this.name},Wi.fromString=function(e){return e?new Wi({name:e,available:!1}):null},Wi.prototype.serialize=function(){return["image",this.name]};var Fi=function(e,t){this.type=e,this.value=t};Fi.parse=function(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Su(e[1]))return t.error("invalid value");var r=e[1],c=Da(r),d=t.expectedType;return"array"!==c.kind||0!==c.N||!d||"array"!==d.kind||"number"==typeof d.N&&0!==d.N||(c=d),new Fi(c,r)},Fi.prototype.evaluate=function(){return this.value},Fi.prototype.eachChild=function(){},Fi.prototype.outputDefined=function(){return!0},Fi.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Xi?["rgba"].concat(this.value.toArray()):this.value instanceof Za?this.value.serialize():this.value};var ra=function(e){this.name="ExpressionEvaluationError",this.message=e};ra.prototype.toJSON=function(){return this.message};var bo={string:xn,number:qt,boolean:nn,object:Di},ma=function(e,t){this.type=e,this.args=t};ma.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,c=1,d=e[0];if("array"===d){var g,x;if(e.length>2){var A=e[1];if("string"!=typeof A||!(A in bo)||"object"===A)return t.error('The item type argument of "array" must be one of string, number, boolean',1);g=bo[A],c++}else g=gn;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);x=e[2],c++}r=Ji(g,x)}else r=bo[d];for(var R=[];c<e.length;c++){var j=t.parse(e[c],c,gn);if(!j)return null;R.push(j)}return new ma(r,R)},ma.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!_a(this.type,Da(r)))return r;if(t===this.args.length-1)throw new ra("Expected value to be of type "+ji(this.type)+", but found "+ji(Da(r))+" instead.")}return null},ma.prototype.eachChild=function(e){this.args.forEach(e)},ma.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},ma.prototype.serialize=function(){var e=this.type,t=[e.kind];if("array"===e.kind){var r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);var c=e.N;("number"==typeof c||this.args.length>1)&&t.push(c)}}return t.concat(this.args.map(function(d){return d.serialize()}))};var vo=function(e){this.type=ta,this.sections=e};vo.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");for(var c=[],d=!1,g=1;g<=e.length-1;++g){var x=e[g];if(d&&"object"==typeof x&&!Array.isArray(x)){d=!1;var A=null;if(x["font-scale"]&&!(A=t.parse(x["font-scale"],1,qt)))return null;var R=null;if(x["text-font"]&&!(R=t.parse(x["text-font"],1,Ji(xn))))return null;var j=null;if(x["text-color"]&&!(j=t.parse(x["text-color"],1,ln)))return null;var J=c[c.length-1];J.scale=A,J.font=R,J.textColor=j}else{var oe=t.parse(e[g],1,gn);if(!oe)return null;var me=oe.type.kind;if("string"!==me&&"value"!==me&&"null"!==me&&"resolvedImage"!==me)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");d=!0,c.push({content:oe,scale:null,font:null,textColor:null})}}return new vo(c)},vo.prototype.evaluate=function(e){return new Za(this.sections.map(function(t){var r=t.content.evaluate(e);return Da(r)===oi?new Ho("",r,null,null,null):new Ho(qo(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},vo.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var c=r[t];e(c.content),c.scale&&e(c.scale),c.font&&e(c.font),c.textColor&&e(c.textColor)}},vo.prototype.outputDefined=function(){return!1},vo.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var c=r[t];e.push(c.content.serialize());var d={};c.scale&&(d["font-scale"]=c.scale.serialize()),c.font&&(d["text-font"]=c.font.serialize()),c.textColor&&(d["text-color"]=c.textColor.serialize()),e.push(d)}return e};var No=function(e){this.type=oi,this.input=e};No.parse=function(e,t){if(2!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,xn);return r?new No(r):t.error("No image name provided.")},No.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Wi.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},No.prototype.eachChild=function(e){e(this.input)},No.prototype.outputDefined=function(){return!1},No.prototype.serialize=function(){return["image",this.input.serialize()]};var ks={"to-boolean":nn,"to-color":ln,"to-number":qt,"to-string":xn},aa=function(e,t){this.type=e,this.args=t};aa.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");for(var c=ks[r],d=[],g=1;g<e.length;g++){var x=t.parse(e[g],g,gn);if(!x)return null;d.push(x)}return new aa(c,d)},aa.prototype.evaluate=function(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){for(var t,r,c=0,d=this.args;c<d.length;c+=1){if(r=null,(t=d[c].evaluate(e))instanceof Xi)return t;if("string"==typeof t){var g=e.parseColor(t);if(g)return g}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":va(t[0],t[1],t[2],t[3])))return new Xi(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new ra(r||"Could not parse color from value '"+("string"==typeof t?t:String(JSON.stringify(t)))+"'")}if("number"===this.type.kind){for(var x=null,A=0,R=this.args;A<R.length;A+=1){if(null===(x=R[A].evaluate(e)))return 0;var j=Number(x);if(!isNaN(j))return j}throw new ra("Could not convert "+JSON.stringify(x)+" to number.")}return"formatted"===this.type.kind?Za.fromString(qo(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Wi.fromString(qo(this.args[0].evaluate(e))):qo(this.args[0].evaluate(e))},aa.prototype.eachChild=function(e){this.args.forEach(e)},aa.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},aa.prototype.serialize=function(){if("formatted"===this.type.kind)return new vo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new No(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Jo=["Unknown","Point","LineString","Polygon"],Ia=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ia.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ia.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Jo[this.feature.type]:this.feature.type:null},Ia.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ia.prototype.canonicalID=function(){return this.canonical},Ia.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ia.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Xi.parse(e)),t};var Ya=function(e,t,r,c){this.name=e,this.type=t,this._evaluate=r,this.args=c};Ya.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Ya.prototype.eachChild=function(e){this.args.forEach(e)},Ya.prototype.outputDefined=function(){return!1},Ya.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Ya.parse=function(e,t){var r,c=e[0],d=Ya.definitions[c];if(!d)return t.error('Unknown expression "'+c+'". If you wanted a literal array, use ["literal", [...]].',0);for(var g=Array.isArray(d)?d[0]:d.type,x=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,A=x.filter(function(fi){var Nn=fi[0];return!Array.isArray(Nn)||Nn.length===e.length-1}),R=null,j=0,J=A;j<J.length;j+=1){var oe=J[j],me=oe[0],xe=oe[1];R=new Ls(t.registry,t.path,null,t.scope);for(var Ge=[],He=!1,gt=1;gt<e.length;gt++){var it=e[gt],Lt=Array.isArray(me)?me[gt-1]:me.type,Ht=R.parse(it,1+Ge.length,Lt);if(!Ht){He=!0;break}Ge.push(Ht)}if(!He)if(Array.isArray(me)&&me.length!==Ge.length)R.error("Expected "+me.length+" arguments, but found "+Ge.length+" instead.");else{for(var fr=0;fr<Ge.length;fr++){var xr=Array.isArray(me)?me[fr]:me.type,Lr=Ge[fr];R.concat(fr+1).checkSubtype(xr,Lr.type)}if(0===R.errors.length)return new Ya(c,g,xe,Ge)}}if(1===A.length)(r=t.errors).push.apply(r,R.errors);else{for(var rn=(A.length?A:x).map(function(fi){var Nn;return Nn=fi[0],Array.isArray(Nn)?"("+Nn.map(ji).join(", ")+")":"("+ji(Nn.type)+"...)"}).join(" | "),vn=[],ii=1;ii<e.length;ii++){var Dn=t.parse(e[ii],1+vn.length);if(!Dn)return null;vn.push(ji(Dn.type))}t.error("Expected arguments of type "+rn+", but found ("+vn.join(", ")+") instead.")}return null},Ya.register=function(e,t){for(var r in Ya.definitions=t,t)e[r]=Ya};var $o=function(e,t,r){this.type=Oi,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function Ba(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function be(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function Fe(e,t){var r=(180+e[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(r*d*8192),Math.round(c*d*8192)]}function vt(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Qt(e,t){for(var r,c,d,g,x,A,R,j=!1,J=0,oe=t.length;J<oe;J++)for(var me=t[J],xe=0,Ge=me.length;xe<Ge-1;xe++){if((g=(r=e)[0]-(c=me[xe])[0])*(R=r[1]-(d=me[xe+1])[1])-(A=r[0]-d[0])*(x=r[1]-c[1])==0&&g*A<=0&&x*R<=0)return!1;vt(e,me[xe],me[xe+1])&&(j=!j)}return j}function Yr(e,t){for(var r=0;r<t.length;r++)if(Qt(e,t[r]))return!0;return!1}function $n(e,t,r,c){var d=c[0]-r[0],g=c[1]-r[1],x=(e[0]-r[0])*g-d*(e[1]-r[1]),A=(t[0]-r[0])*g-d*(t[1]-r[1]);return x>0&&A<0||x<0&&A>0}function xi(e,t,r){for(var c=0,d=r;c<d.length;c+=1)for(var g=d[c],x=0;x<g.length-1;++x)if((oe=[(J=g[x+1])[0]-(j=g[x])[0],J[1]-j[1]])[0]*(me=[(R=t)[0]-(A=e)[0],R[1]-A[1]])[1]-oe[1]*me[0]!=0&&$n(A,R,j,J)&&$n(j,J,A,R))return!0;var A,R,j,J,oe,me;return!1}function lo(e,t){for(var r=0;r<e.length;++r)if(!Qt(e[r],t))return!1;for(var c=0;c<e.length-1;++c)if(xi(e[c],e[c+1],t))return!1;return!0}function ro(e,t){for(var r=0;r<t.length;r++)if(lo(e,t[r]))return!0;return!1}function co(e,t,r){for(var c=[],d=0;d<e.length;d++){for(var g=[],x=0;x<e[d].length;x++){var A=Fe(e[d][x],r);Ba(t,A),g.push(A)}c.push(g)}return c}function ps(e,t,r){for(var c=[],d=0;d<e.length;d++){var g=co(e[d],t,r);c.push(g)}return c}function du(e,t,r,c){if(e[0]<r[0]||e[0]>r[2]){var d=.5*c,g=e[0]-r[0]>d?-c:r[0]-e[0]>d?c:0;0===g&&(g=e[0]-r[2]>d?-c:r[2]-e[0]>d?c:0),e[0]+=g}Ba(t,e)}function Eu(e,t,r,c){for(var d=8192*Math.pow(2,c.z),g=[8192*c.x,8192*c.y],x=[],A=0,R=e;A<R.length;A+=1)for(var j=0,J=R[A];j<J.length;j+=1){var oe=J[j],me=[oe.x+g[0],oe.y+g[1]];du(me,t,r,d),x.push(me)}return x}function fl(e,t,r,c){for(var d,g=8192*Math.pow(2,c.z),x=[8192*c.x,8192*c.y],A=[],R=0,j=e;R<j.length;R+=1){for(var J=[],oe=0,me=j[R];oe<me.length;oe+=1){var xe=me[oe],Ge=[xe.x+x[0],xe.y+x[1]];Ba(t,Ge),J.push(Ge)}A.push(J)}if(t[2]-t[0]<=g/2){(d=t)[0]=d[1]=1/0,d[2]=d[3]=-1/0;for(var He=0,gt=A;He<gt.length;He+=1)for(var it=0,Lt=gt[He];it<Lt.length;it+=1)du(Lt[it],t,r,g)}return A}$o.parse=function(e,t){if(2!==e.length)return t.error("Expected one argument.");var r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");var c=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,nn);if(!c)return null;var d=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,nn);if(!d)return null;var g=null;return r.locale&&!(g=t.parse(r.locale,1,xn))?null:new $o(c,d,g)},$o.prototype.evaluate=function(e){return new to(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},$o.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},$o.prototype.outputDefined=function(){return!1},$o.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Wo=function(e,t){this.type=nn,this.geojson=e,this.geometries=t};function Qo(e){if(e instanceof Ya&&("get"===e.name&&1===e.args.length||"feature-state"===e.name||"has"===e.name&&1===e.args.length||"properties"===e.name||"geometry-type"===e.name||"id"===e.name||/^filter-/.test(e.name))||e instanceof Wo)return!1;var t=!0;return e.eachChild(function(r){t&&!Qo(r)&&(t=!1)}),t}function ko(e){if(e instanceof Ya&&"feature-state"===e.name)return!1;var t=!0;return e.eachChild(function(r){t&&!ko(r)&&(t=!1)}),t}function es(e,t){if(e instanceof Ya&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(c){r&&!es(c,t)&&(r=!1)}),r}Wo.parse=function(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Su(e[1])){var r=e[1];if("FeatureCollection"===r.type)for(var c=0;c<r.features.length;++c){var d=r.features[c].geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new Wo(r,r.features[c].geometry)}else if("Feature"===r.type){var g=r.geometry.type;if("Polygon"===g||"MultiPolygon"===g)return new Wo(r,r.geometry)}else if("Polygon"===r.type||"MultiPolygon"===r.type)return new Wo(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Wo.prototype.evaluate=function(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(t,r){var c=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if("Polygon"===r.type){var x=co(r.coordinates,d,g),A=Eu(t.geometry(),c,d,g);if(!be(c,d))return!1;for(var R=0,j=A;R<j.length;R+=1)if(!Qt(j[R],x))return!1}if("MultiPolygon"===r.type){var J=ps(r.coordinates,d,g),oe=Eu(t.geometry(),c,d,g);if(!be(c,d))return!1;for(var me=0,xe=oe;me<xe.length;me+=1)if(!Yr(xe[me],J))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(t,r){var c=[1/0,1/0,-1/0,-1/0],d=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if("Polygon"===r.type){var x=co(r.coordinates,d,g),A=fl(t.geometry(),c,d,g);if(!be(c,d))return!1;for(var R=0,j=A;R<j.length;R+=1)if(!lo(j[R],x))return!1}if("MultiPolygon"===r.type){var J=ps(r.coordinates,d,g),oe=fl(t.geometry(),c,d,g);if(!be(c,d))return!1;for(var me=0,xe=oe;me<xe.length;me+=1)if(!ro(xe[me],J))return!1}return!0}(e,this.geometries)}return!1},Wo.prototype.eachChild=function(){},Wo.prototype.outputDefined=function(){return!0},Wo.prototype.serialize=function(){return["within",this.geojson]};var ts=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};ts.parse=function(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new ts(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},ts.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},ts.prototype.eachChild=function(){},ts.prototype.outputDefined=function(){return!1},ts.prototype.serialize=function(){return["var",this.name]};var Ls=function(e,t,r,c,d){void 0===t&&(t=[]),void 0===c&&(c=new On),void 0===d&&(d=[]),this.registry=e,this.path=t,this.key=t.map(function(g){return"["+g+"]"}).join(""),this.scope=c,this.errors=d,this.expectedType=r};function Qs(e,t){for(var r,c=e.length-1,d=0,g=c,x=0;d<=g;)if((r=e[x=Math.floor((d+g)/2)])<=t){if(x===c||t<e[x+1])return x;d=x+1}else{if(!(r>t))throw new ra("Input is not a number.");g=x-1}return 0}Ls.prototype.parse=function(e,t,r,c,d){return void 0===d&&(d={}),t?this.concat(t,r,c)._parse(e,d):this._parse(e,d)},Ls.prototype._parse=function(e,t){function r(j,J,oe){return"assert"===oe?new ma(J,[j]):"coerce"===oe?new aa(J,[j]):j}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var c=e[0];if("string"!=typeof c)return this.error("Expression name must be a string, but found "+typeof c+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var d=this.registry[c];if(d){var g=d.parse(e,this);if(!g)return null;if(this.expectedType){var x=this.expectedType,A=g.type;if("string"!==x.kind&&"number"!==x.kind&&"boolean"!==x.kind&&"object"!==x.kind&&"array"!==x.kind||"value"!==A.kind)if("color"!==x.kind&&"formatted"!==x.kind&&"resolvedImage"!==x.kind||"value"!==A.kind&&"string"!==A.kind){if(this.checkSubtype(x,A))return null}else g=r(g,x,t.typeAnnotation||"coerce");else g=r(g,x,t.typeAnnotation||"assert")}if(!(g instanceof Fi)&&"resolvedImage"!==g.type.kind&&function j(J){if(J instanceof ts)return j(J.boundExpression);if(J instanceof Ya&&"error"===J.name||J instanceof $o||J instanceof Wo)return!1;var oe=J instanceof aa||J instanceof ma,me=!0;return J.eachChild(function(xe){me=oe?me&&j(xe):me&&xe instanceof Fi}),!!me&&Qo(J)&&es(J,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(g)){var R=new Ia;try{g=new Fi(g.type,g.evaluate(R))}catch(j){return this.error(j.message),null}}return g}return this.error('Unknown expression "'+c+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Ls.prototype.concat=function(e,t,r){var c="number"==typeof e?this.path.concat(e):this.path,d=r?this.scope.concat(r):this.scope;return new Ls(this.registry,c,t||null,d,this.errors)},Ls.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var c=""+this.key+t.map(function(d){return"["+d+"]"}).join("");this.errors.push(new Br(c,e))},Ls.prototype.checkSubtype=function(e,t){var r=_a(e,t);return r&&this.error(r),r};var gs=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var c=0,d=r;c<d.length;c+=1){var g=d[c],x=g[1];this.labels.push(g[0]),this.outputs.push(x)}};function Oa(e,t,r){return e*(1-r)+t*r}gs.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,qt);if(!r)return null;var c=[],d=null;t.expectedType&&"value"!==t.expectedType.kind&&(d=t.expectedType);for(var g=1;g<e.length;g+=2){var x=1===g?-1/0:e[g],A=e[g+1],R=g,j=g+1;if("number"!=typeof x)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(c.length&&c[c.length-1][0]>=x)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);var J=t.parse(A,j,d);if(!J)return null;d=d||J.type,c.push([x,J])}return new gs(d,r,c)},gs.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var c=this.input.evaluate(e);if(c<=t[0])return r[0].evaluate(e);var d=t.length;return c>=t[d-1]?r[d-1].evaluate(e):r[Qs(t,c)].evaluate(e)},gs.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},gs.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},gs.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Lo=Object.freeze({__proto__:null,number:Oa,color:function(e,t,r){return new Xi(Oa(e.r,t.r,r),Oa(e.g,t.g,r),Oa(e.b,t.b,r),Oa(e.a,t.a,r))},array:function(e,t,r){return e.map(function(c,d){return Oa(c,t[d],r)})}}),Ol=6/29*3*(6/29),kl=Math.PI/180,Ll=180/Math.PI;function Sc(e){return e>.008856451679035631?Math.pow(e,1/3):e/Ol+4/29}function Rl(e){return e>6/29?e*e*e:Ol*(e-4/29)}function hl(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function eu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Dl(e){var t=eu(e.r),r=eu(e.g),c=eu(e.b),d=Sc((.4124564*t+.3575761*r+.1804375*c)/.95047),g=Sc((.2126729*t+.7151522*r+.072175*c)/1);return{l:116*g-16,a:500*(d-g),b:200*(g-Sc((.0193339*t+.119192*r+.9503041*c)/1.08883)),alpha:e.a}}function m(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,c=isNaN(e.b)?t:t-e.b/200;return t=1*Rl(t),r=.95047*Rl(r),c=1.08883*Rl(c),new Xi(hl(3.2404542*r-1.5371385*t-.4985314*c),hl(-.969266*r+1.8760108*t+.041556*c),hl(.0556434*r-.2040259*t+1.0572252*c),e.alpha)}function E(e,t,r){var c=t-e;return e+r*(c>180||c<-180?c-360*Math.round(c/360):c)}var U={forward:Dl,reverse:m,interpolate:function(e,t,r){return{l:Oa(e.l,t.l,r),a:Oa(e.a,t.a,r),b:Oa(e.b,t.b,r),alpha:Oa(e.alpha,t.alpha,r)}}},O={forward:function(e){var t=Dl(e),r=t.l,c=t.a,d=t.b,g=Math.atan2(d,c)*Ll;return{h:g<0?g+360:g,c:Math.sqrt(c*c+d*d),l:r,alpha:e.a}},reverse:function(e){var t=e.h*kl,r=e.c;return m({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:E(e.h,t.h,r),c:Oa(e.c,t.c,r),l:Oa(e.l,t.l,r),alpha:Oa(e.alpha,t.alpha,r)}}},pe=Object.freeze({__proto__:null,lab:U,hcl:O}),De=function(e,t,r,c,d){this.type=e,this.operator=t,this.interpolation=r,this.input=c,this.labels=[],this.outputs=[];for(var g=0,x=d;g<x.length;g+=1){var A=x[g],R=A[1];this.labels.push(A[0]),this.outputs.push(R)}};function ft(e,t,r,c){var d=c-r,g=e-r;return 0===d?0:1===t?g/d:(Math.pow(t,g)-1)/(Math.pow(t,d)-1)}De.interpolationFactor=function(e,t,r,c){var d=0;if("exponential"===e.name)d=ft(t,e.base,r,c);else if("linear"===e.name)d=ft(t,1,r,c);else if("cubic-bezier"===e.name){var g=e.controlPoints;d=new W(g[0],g[1],g[2],g[3]).solve(ft(t,1,r,c))}return d},De.parse=function(e,t){var r=e[0],c=e[1],d=e[2],g=e.slice(3);if(!Array.isArray(c)||0===c.length)return t.error("Expected an interpolation type expression.",1);if("linear"===c[0])c={name:"linear"};else if("exponential"===c[0]){var x=c[1];if("number"!=typeof x)return t.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:x}}else{if("cubic-bezier"!==c[0])return t.error("Unknown interpolation type "+String(c[0]),1,0);var A=c.slice(1);if(4!==A.length||A.some(function(gt){return"number"!=typeof gt||gt<0||gt>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:A}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(d=t.parse(d,2,qt)))return null;var R=[],j=null;"interpolate-hcl"===r||"interpolate-lab"===r?j=ln:t.expectedType&&"value"!==t.expectedType.kind&&(j=t.expectedType);for(var J=0;J<g.length;J+=2){var oe=g[J],me=g[J+1],xe=J+3,Ge=J+4;if("number"!=typeof oe)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',xe);if(R.length&&R[R.length-1][0]>=oe)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',xe);var He=t.parse(me,Ge,j);if(!He)return null;j=j||He.type,R.push([oe,He])}return"number"===j.kind||"color"===j.kind||"array"===j.kind&&"number"===j.itemType.kind&&"number"==typeof j.N?new De(j,r,c,d,R):t.error("Type "+ji(j)+" is not interpolatable.")},De.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);var c=this.input.evaluate(e);if(c<=t[0])return r[0].evaluate(e);var d=t.length;if(c>=t[d-1])return r[d-1].evaluate(e);var g=Qs(t,c),x=De.interpolationFactor(this.interpolation,c,t[g],t[g+1]),A=r[g].evaluate(e),R=r[g+1].evaluate(e);return"interpolate"===this.operator?Lo[this.type.kind.toLowerCase()](A,R,x):"interpolate-hcl"===this.operator?O.reverse(O.interpolate(O.forward(A),O.forward(R),x)):U.reverse(U.interpolate(U.forward(A),U.forward(R),x))},De.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},De.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},De.prototype.serialize=function(){var e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var Rt=function(e,t){this.type=e,this.args=t};Rt.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,c=t.expectedType;c&&"value"!==c.kind&&(r=c);for(var d=[],g=0,x=e.slice(1);g<x.length;g+=1){var A=t.parse(x[g],1+d.length,r,void 0,{typeAnnotation:"omit"});if(!A)return null;r=r||A.type,d.push(A)}var R=c&&d.some(function(j){return _a(c,j.type)});return new Rt(R?gn:r,d)},Rt.prototype.evaluate=function(e){for(var t,r=null,c=0,d=0,g=this.args;d<g.length&&(c++,(r=g[d].evaluate(e))&&r instanceof Wi&&!r.available&&(t||(t=r.name),r=null,c===this.args.length&&(r=t)),null===r);d+=1);return r},Rt.prototype.eachChild=function(e){this.args.forEach(e)},Rt.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Rt.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var kt=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};kt.prototype.evaluate=function(e){return this.result.evaluate(e)},kt.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},kt.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],c=1;c<e.length-1;c+=2){var d=e[c];if("string"!=typeof d)return t.error("Expected string, but found "+typeof d+" instead.",c);if(/[^a-zA-Z0-9_]/.test(d))return t.error("Variable names must contain only alphanumeric characters or '_'.",c);var g=t.parse(e[c+1],c+1);if(!g)return null;r.push([d,g])}var x=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return x?new kt(r,x):null},kt.prototype.outputDefined=function(){return this.result.outputDefined()},kt.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var c=r[t];e.push(c[0],c[1].serialize())}return e.push(this.result.serialize()),e};var Ir=function(e,t,r){this.type=e,this.index=t,this.input=r};Ir.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,qt),c=t.parse(e[2],2,Ji(t.expectedType||gn));return r&&c?new Ir(c.type.itemType,r,c):null},Ir.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new ra("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new ra("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new ra("Array index must be an integer, but found "+t+" instead.");return r[t]},Ir.prototype.eachChild=function(e){e(this.index),e(this.input)},Ir.prototype.outputDefined=function(){return!1},Ir.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Nr=function(e,t){this.type=nn,this.needle=e,this.haystack=t};Nr.parse=function(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),c=t.parse(e[2],2,gn);return r&&c?Ma(r.type,[nn,xn,qt,Cn,gn])?new Nr(r,c):t.error("Expected first argument to be of type boolean, string, number or null, but found "+ji(r.type)+" instead"):null},Nr.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Gi(t,["boolean","string","number","null"]))throw new ra("Expected first argument to be of type boolean, string, number or null, but found "+ji(Da(t))+" instead.");if(!Gi(r,["string","array"]))throw new ra("Expected second argument to be of type array or string, but found "+ji(Da(r))+" instead.");return r.indexOf(t)>=0},Nr.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Nr.prototype.outputDefined=function(){return!0},Nr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Jn=function(e,t,r){this.type=qt,this.needle=e,this.haystack=t,this.fromIndex=r};Jn.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),c=t.parse(e[2],2,gn);if(!r||!c)return null;if(!Ma(r.type,[nn,xn,qt,Cn,gn]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+ji(r.type)+" instead");if(4===e.length){var d=t.parse(e[3],3,qt);return d?new Jn(r,c,d):null}return new Jn(r,c)},Jn.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Gi(t,["boolean","string","number","null"]))throw new ra("Expected first argument to be of type boolean, string, number or null, but found "+ji(Da(t))+" instead.");if(!Gi(r,["string","array"]))throw new ra("Expected second argument to be of type array or string, but found "+ji(Da(r))+" instead.");if(this.fromIndex){var c=this.fromIndex.evaluate(e);return r.indexOf(t,c)}return r.indexOf(t)},Jn.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},Jn.prototype.outputDefined=function(){return!1},Jn.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var bi=function(e,t,r,c,d,g){this.inputType=e,this.type=t,this.input=r,this.cases=c,this.outputs=d,this.otherwise=g};bi.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,c;t.expectedType&&"value"!==t.expectedType.kind&&(c=t.expectedType);for(var d={},g=[],x=2;x<e.length-1;x+=2){var A=e[x],R=e[x+1];Array.isArray(A)||(A=[A]);var j=t.concat(x);if(0===A.length)return j.error("Expected at least one branch label.");for(var J=0,oe=A;J<oe.length;J+=1){var me=oe[J];if("number"!=typeof me&&"string"!=typeof me)return j.error("Branch labels must be numbers or strings.");if("number"==typeof me&&Math.abs(me)>Number.MAX_SAFE_INTEGER)return j.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof me&&Math.floor(me)!==me)return j.error("Numeric branch labels must be integer values.");if(r){if(j.checkSubtype(r,Da(me)))return null}else r=Da(me);if(void 0!==d[String(me)])return j.error("Branch labels must be unique.");d[String(me)]=g.length}var xe=t.parse(R,x,c);if(!xe)return null;c=c||xe.type,g.push(xe)}var Ge=t.parse(e[1],1,gn);if(!Ge)return null;var He=t.parse(e[e.length-1],e.length-1,c);return He?"value"!==Ge.type.kind&&t.concat(1).checkSubtype(r,Ge.type)?null:new bi(r,c,Ge,d,g,He):null},bi.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(Da(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},bi.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},bi.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},bi.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],c={},d=0,g=Object.keys(this.cases).sort();d<g.length;d+=1){var x=g[d];void 0===(oe=c[this.cases[x]])?(c[this.cases[x]]=r.length,r.push([this.cases[x],[x]])):r[oe][1].push(x)}for(var A=function(xe){return"number"===e.inputType.kind?Number(xe):xe},R=0,j=r;R<j.length;R+=1){var J=j[R],oe=J[0],me=J[1];t.push(1===me.length?A(me[0]):me.map(A)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var pi=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};pi.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);for(var c=[],d=1;d<e.length-1;d+=2){var g=t.parse(e[d],d,nn);if(!g)return null;var x=t.parse(e[d+1],d+1,r);if(!x)return null;c.push([g,x]),r=r||x.type}var A=t.parse(e[e.length-1],e.length-1,r);return A?new pi(r,c,A):null},pi.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var c=r[t],d=c[1];if(c[0].evaluate(e))return d.evaluate(e)}return this.otherwise.evaluate(e)},pi.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var c=r[t],d=c[1];e(c[0]),e(d)}e(this.otherwise)},pi.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},pi.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var oa=function(e,t,r,c){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=c};function Ea(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function Na(e,t,r,c){return 0===c.compare(t,r)}function vi(e,t,r){var c="=="!==e&&"!="!==e;return function(){function d(g,x,A){this.type=nn,this.lhs=g,this.rhs=x,this.collator=A,this.hasUntypedArgument="value"===g.type.kind||"value"===x.type.kind}return d.parse=function(g,x){if(3!==g.length&&4!==g.length)return x.error("Expected two or three arguments.");var A=g[0],R=x.parse(g[1],1,gn);if(!R)return null;if(!Ea(A,R.type))return x.concat(1).error('"'+A+"\" comparisons are not supported for type '"+ji(R.type)+"'.");var j=x.parse(g[2],2,gn);if(!j)return null;if(!Ea(A,j.type))return x.concat(2).error('"'+A+"\" comparisons are not supported for type '"+ji(j.type)+"'.");if(R.type.kind!==j.type.kind&&"value"!==R.type.kind&&"value"!==j.type.kind)return x.error("Cannot compare types '"+ji(R.type)+"' and '"+ji(j.type)+"'.");c&&("value"===R.type.kind&&"value"!==j.type.kind?R=new ma(j.type,[R]):"value"!==R.type.kind&&"value"===j.type.kind&&(j=new ma(R.type,[j])));var J=null;if(4===g.length){if("string"!==R.type.kind&&"string"!==j.type.kind&&"value"!==R.type.kind&&"value"!==j.type.kind)return x.error("Cannot use collator to compare non-string types.");if(!(J=x.parse(g[3],3,Oi)))return null}return new d(R,j,J)},d.prototype.evaluate=function(g){var x=this.lhs.evaluate(g),A=this.rhs.evaluate(g);if(c&&this.hasUntypedArgument){var R=Da(x),j=Da(A);if(R.kind!==j.kind||"string"!==R.kind&&"number"!==R.kind)throw new ra('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+R.kind+", "+j.kind+") instead.")}if(this.collator&&!c&&this.hasUntypedArgument){var J=Da(x),oe=Da(A);if("string"!==J.kind||"string"!==oe.kind)return t(g,x,A)}return this.collator?r(g,x,A,this.collator.evaluate(g)):t(g,x,A)},d.prototype.eachChild=function(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)},d.prototype.outputDefined=function(){return!0},d.prototype.serialize=function(){var g=[e];return this.eachChild(function(x){g.push(x.serialize())}),g},d}()}oa.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,gn),c=t.parse(e[2],2,qt);if(!r||!c)return null;if(!Ma(r.type,[Ji(gn),xn,gn]))return t.error("Expected first argument to be of type array or string, but found "+ji(r.type)+" instead");if(4===e.length){var d=t.parse(e[3],3,qt);return d?new oa(r.type,r,c,d):null}return new oa(r.type,r,c)},oa.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Gi(t,["string","array"]))throw new ra("Expected first argument to be of type array or string, but found "+ji(Da(t))+" instead.");if(this.endIndex){var c=this.endIndex.evaluate(e);return t.slice(r,c)}return t.slice(r)},oa.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},oa.prototype.outputDefined=function(){return!1},oa.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Xo=vi("==",function(e,t,r){return t===r},Na),vu=vi("!=",function(e,t,r){return t!==r},function(e,t,r,c){return!Na(0,t,r,c)}),Tu=vi("<",function(e,t,r){return t<r},function(e,t,r,c){return c.compare(t,r)<0}),Ec=vi(">",function(e,t,r){return t>r},function(e,t,r,c){return c.compare(t,r)>0}),Du=vi("<=",function(e,t,r){return t<=r},function(e,t,r,c){return c.compare(t,r)<=0}),Bl=vi(">=",function(e,t,r){return t>=r},function(e,t,r,c){return c.compare(t,r)>=0}),mu=function(e,t,r,c,d){this.type=xn,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=c,this.maxFractionDigits=d};mu.parse=function(e,t){if(3!==e.length)return t.error("Expected two arguments.");var r=t.parse(e[1],1,qt);if(!r)return null;var c=e[2];if("object"!=typeof c||Array.isArray(c))return t.error("NumberFormat options argument must be an object.");var d=null;if(c.locale&&!(d=t.parse(c.locale,1,xn)))return null;var g=null;if(c.currency&&!(g=t.parse(c.currency,1,xn)))return null;var x=null;if(c["min-fraction-digits"]&&!(x=t.parse(c["min-fraction-digits"],1,qt)))return null;var A=null;return c["max-fraction-digits"]&&!(A=t.parse(c["max-fraction-digits"],1,qt))?null:new mu(r,d,g,x,A)},mu.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},mu.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},mu.prototype.outputDefined=function(){return!1},mu.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var gu=function(e){this.type=qt,this.input=e};gu.parse=function(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error("Expected argument of type string or array, but found "+ji(r.type)+" instead."):new gu(r):null},gu.prototype.evaluate=function(e){var t=this.input.evaluate(e);if("string"==typeof t||Array.isArray(t))return t.length;throw new ra("Expected value to be of type string or array, but found "+ji(Da(t))+" instead.")},gu.prototype.eachChild=function(e){e(this.input)},gu.prototype.outputDefined=function(){return!1},gu.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var tu={"==":Xo,"!=":vu,">":Ec,"<":Tu,">=":Bl,"<=":Du,array:ma,at:Ir,boolean:ma,case:pi,coalesce:Rt,collator:$o,format:vo,image:No,in:Nr,"index-of":Jn,interpolate:De,"interpolate-hcl":De,"interpolate-lab":De,length:gu,let:kt,literal:Fi,match:bi,number:ma,"number-format":mu,object:ma,slice:oa,step:gs,string:ma,"to-boolean":aa,"to-color":aa,"to-number":aa,"to-string":aa,var:ts,within:Wo};function oo(e,t){var r=t[0],c=t[1],d=t[2],g=t[3];r=r.evaluate(e),c=c.evaluate(e),d=d.evaluate(e);var x=g?g.evaluate(e):1,A=va(r,c,d,x);if(A)throw new ra(A);return new Xi(r/255*x,c/255*x,d/255*x,x)}function Tc(e,t){return e in t}function Cc(e,t){var r=t[e];return void 0===r?null:r}function rs(e){return{type:e}}function tc(e){return{result:"success",value:e}}function ru(e){return{result:"error",value:e}}function Rs(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function rc(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Bu(e){return!!e.expression&&e.expression.interpolated}function ka(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Ju(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function Gc(e){return e}function Us(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function nc(e,t,r,c,d){return Us(typeof r===d?c[r]:void 0,e.default,t.default)}function Hc(e,t,r){if("number"!==ka(r))return Us(e.default,t.default);var c=e.stops.length;if(1===c||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[c-1][0])return e.stops[c-1][1];var d=Qs(e.stops.map(function(g){return g[0]}),r);return e.stops[d][1]}function Ac(e,t,r){var c=void 0!==e.base?e.base:1;if("number"!==ka(r))return Us(e.default,t.default);var d=e.stops.length;if(1===d||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[d-1][0])return e.stops[d-1][1];var me,xe,He,gt,g=Qs(e.stops.map(function(oe){return oe[0]}),r),x=(me=c,gt=r-(xe=e.stops[g][0]),0==(He=e.stops[g+1][0]-xe)?0:1===me?gt/He:(Math.pow(me,gt)-1)/(Math.pow(me,He)-1)),A=e.stops[g][1],R=e.stops[g+1][1],j=Lo[t.type]||Gc;if(e.colorSpace&&"rgb"!==e.colorSpace){var J=pe[e.colorSpace];j=function(oe,me){return J.reverse(J.interpolate(J.forward(oe),J.forward(me),x))}}return"function"==typeof A.evaluate?{evaluate:function(){for(var oe=[],me=arguments.length;me--;)oe[me]=arguments[me];var xe=A.evaluate.apply(void 0,oe),Ge=R.evaluate.apply(void 0,oe);if(void 0!==xe&&void 0!==Ge)return j(xe,Ge,x)}}:j(A,R,x)}function Fl(e,t,r){return"color"===t.type?r=Xi.parse(r):"formatted"===t.type?r=Za.fromString(r.toString()):"resolvedImage"===t.type?r=Wi.fromString(r.toString()):ka(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),Us(r,e.default,t.default)}Ya.register(tu,{error:[{kind:"error"},[xn],function(e,t){throw new ra(t[0].evaluate(e))}],typeof:[xn,[gn],function(e,t){return ji(Da(t[0].evaluate(e)))}],"to-rgba":[Ji(qt,4),[ln],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[ln,[qt,qt,qt],oo],rgba:[ln,[qt,qt,qt,qt],oo],has:{type:nn,overloads:[[[xn],function(e,t){return Tc(t[0].evaluate(e),e.properties())}],[[xn,Di],function(e,t){var r=t[1];return Tc(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:gn,overloads:[[[xn],function(e,t){return Cc(t[0].evaluate(e),e.properties())}],[[xn,Di],function(e,t){var r=t[1];return Cc(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[gn,[xn],function(e,t){return Cc(t[0].evaluate(e),e.featureState||{})}],properties:[Di,[],function(e){return e.properties()}],"geometry-type":[xn,[],function(e){return e.geometryType()}],id:[gn,[],function(e){return e.id()}],zoom:[qt,[],function(e){return e.globals.zoom}],"heatmap-density":[qt,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[qt,[],function(e){return e.globals.lineProgress||0}],accumulated:[gn,[],function(e){return void 0===e.globals.accumulated?null:e.globals.accumulated}],"+":[qt,rs(qt),function(e,t){for(var r=0,c=0,d=t;c<d.length;c+=1)r+=d[c].evaluate(e);return r}],"*":[qt,rs(qt),function(e,t){for(var r=1,c=0,d=t;c<d.length;c+=1)r*=d[c].evaluate(e);return r}],"-":{type:qt,overloads:[[[qt,qt],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[qt],function(e,t){return-t[0].evaluate(e)}]]},"/":[qt,[qt,qt],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[qt,[qt,qt],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[qt,[],function(){return Math.LN2}],pi:[qt,[],function(){return Math.PI}],e:[qt,[],function(){return Math.E}],"^":[qt,[qt,qt],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[qt,[qt],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[qt,[qt],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[qt,[qt],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[qt,[qt],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[qt,[qt],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[qt,[qt],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[qt,[qt],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[qt,[qt],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[qt,[qt],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[qt,[qt],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[qt,rs(qt),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[qt,rs(qt),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[qt,[qt],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[qt,[qt],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[qt,[qt],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[qt,[qt],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[nn,[xn,gn],function(e,t){var r=t[0],c=t[1];return e.properties()[r.value]===c.value}],"filter-id-==":[nn,[gn],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[nn,[xn],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[nn,[xn,gn],function(e,t){var r=t[0],c=t[1],d=e.properties()[r.value],g=c.value;return typeof d==typeof g&&d<g}],"filter-id-<":[nn,[gn],function(e,t){var r=t[0],c=e.id(),d=r.value;return typeof c==typeof d&&c<d}],"filter->":[nn,[xn,gn],function(e,t){var r=t[0],c=t[1],d=e.properties()[r.value],g=c.value;return typeof d==typeof g&&d>g}],"filter-id->":[nn,[gn],function(e,t){var r=t[0],c=e.id(),d=r.value;return typeof c==typeof d&&c>d}],"filter-<=":[nn,[xn,gn],function(e,t){var r=t[0],c=t[1],d=e.properties()[r.value],g=c.value;return typeof d==typeof g&&d<=g}],"filter-id-<=":[nn,[gn],function(e,t){var r=t[0],c=e.id(),d=r.value;return typeof c==typeof d&&c<=d}],"filter->=":[nn,[xn,gn],function(e,t){var r=t[0],c=t[1],d=e.properties()[r.value],g=c.value;return typeof d==typeof g&&d>=g}],"filter-id->=":[nn,[gn],function(e,t){var r=t[0],c=e.id(),d=r.value;return typeof c==typeof d&&c>=d}],"filter-has":[nn,[gn],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[nn,[],function(e){return null!==e.id()&&void 0!==e.id()}],"filter-type-in":[nn,[Ji(xn)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[nn,[Ji(gn)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[nn,[xn,Ji(gn)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[nn,[xn,Ji(gn)],function(e,t){var r=t[0],c=t[1];return function(d,g,x,A){for(;x<=A;){var R=x+A>>1;if(g[R]===d)return!0;g[R]>d?A=R-1:x=R+1}return!1}(e.properties()[r.value],c.value,0,c.value.length-1)}],all:{type:nn,overloads:[[[nn,nn],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[rs(nn),function(e,t){for(var r=0,c=t;r<c.length;r+=1)if(!c[r].evaluate(e))return!1;return!0}]]},any:{type:nn,overloads:[[[nn,nn],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[rs(nn),function(e,t){for(var r=0,c=t;r<c.length;r+=1)if(c[r].evaluate(e))return!0;return!1}]]},"!":[nn,[nn],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[nn,[xn],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[xn,[xn],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[xn,[xn],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[xn,rs(gn),function(e,t){return t.map(function(r){return qo(r.evaluate(e))}).join("")}],"resolved-locale":[xn,[Oi],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var yu=function(e,t){var r;this.expression=e,this._warningHistory={},this._evaluator=new Ia,this._defaultValue=t?"color"===(r=t).type&&Ju(r.default)?new Xi(0,0,0,0):"color"===r.type?Xi.parse(r.default)||null:void 0===r.default?null:r.default:null,this._enumValues=t&&"enum"===t.type?t.values:null};function $u(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in tu}function pl(e,t){var d,g,r=new Ls(tu,[],t?(g={color:ln,string:xn,number:qt,enum:xn,boolean:nn,formatted:ta,resolvedImage:oi},"array"===(d=t).type?Ji(g[d.value]||gn,d.length):g[d.type]):void 0),c=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return c?tc(new yu(c,t)):ru(r.errors)}yu.prototype.evaluateWithoutErrorHandling=function(e,t,r,c,d,g){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=c,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)},yu.prototype.evaluate=function(e,t,r,c,d,g){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=c,this._evaluator.availableImages=d||null,this._evaluator.formattedSection=g||null;try{var x=this.expression.evaluate(this._evaluator);if(null==x||"number"==typeof x&&x!=x)return this._defaultValue;if(this._enumValues&&!(x in this._enumValues))throw new ra("Expected value to be one of "+Object.keys(this._enumValues).map(function(A){return JSON.stringify(A)}).join(", ")+", but found "+JSON.stringify(x)+" instead.");return x}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,"undefined"!=typeof console&&console.warn(A.message)),this._defaultValue}};var Qu=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!ko(t.expression)};Qu.prototype.evaluateWithoutErrorHandling=function(e,t,r,c,d,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,c,d,g)},Qu.prototype.evaluate=function(e,t,r,c,d,g){return this._styleExpression.evaluate(e,t,r,c,d,g)};var el=function(e,t,r,c){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!ko(t.expression),this.interpolationType=c};function dl(e,t){if("error"===(e=pl(e,t)).result)return e;var r=e.value.expression,c=Qo(r);if(!c&&!Rs(t))return ru([new Br("","data expressions not supported")]);var d=es(r,["zoom"]);if(!d&&!rc(t))return ru([new Br("","zoom expressions not supported")]);var g=function x(A){var R=null;if(A instanceof kt)R=x(A.result);else if(A instanceof Rt)for(var j=0,J=A.args;j<J.length&&!(R=x(J[j]));j+=1);else(A instanceof gs||A instanceof De)&&A.input instanceof Ya&&"zoom"===A.input.name&&(R=A);return R instanceof Br||A.eachChild(function(oe){var me=x(oe);me instanceof Br?R=me:!R&&me?R=new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):R&&me&&R!==me&&(R=new Br("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),R}(r);return g||d?g instanceof Br?ru([g]):g instanceof De&&!Bu(t)?ru([new Br("",'"interpolate" expressions cannot be used with this property')]):tc(g?new el(c?"camera":"composite",e.value,g.labels,g instanceof De?g.interpolation:void 0):new Qu(c?"constant":"source",e.value)):ru([new Br("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}el.prototype.evaluateWithoutErrorHandling=function(e,t,r,c,d,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,c,d,g)},el.prototype.evaluate=function(e,t,r,c,d,g){return this._styleExpression.evaluate(e,t,r,c,d,g)},el.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?De.interpolationFactor(this.interpolationType,e,t,r):0};var Fu=function(e,t){this._parameters=e,this._specification=t,wr(this,function r(c,d){var g,x,A,R="color"===d.type,j=c.stops&&"object"==typeof c.stops[0][0],J=j||!(j||void 0!==c.property),oe=c.type||(Bu(d)?"exponential":"interval");if(R&&((c=wr({},c)).stops&&(c.stops=c.stops.map(function(Dn){return[Dn[0],Xi.parse(Dn[1])]})),c.default=Xi.parse(c.default?c.default:d.default)),c.colorSpace&&"rgb"!==c.colorSpace&&!pe[c.colorSpace])throw new Error("Unknown color space: "+c.colorSpace);if("exponential"===oe)g=Ac;else if("interval"===oe)g=Hc;else if("categorical"===oe){g=nc,x=Object.create(null);for(var me=0,xe=c.stops;me<xe.length;me+=1){var Ge=xe[me];x[Ge[0]]=Ge[1]}A=typeof c.stops[0][0]}else{if("identity"!==oe)throw new Error('Unknown function type "'+oe+'"');g=Fl}if(j){for(var He={},gt=[],it=0;it<c.stops.length;it++){var Lt=c.stops[it],Ht=Lt[0].zoom;void 0===He[Ht]&&(He[Ht]={zoom:Ht,type:c.type,property:c.property,default:c.default,stops:[]},gt.push(Ht)),He[Ht].stops.push([Lt[0].value,Lt[1]])}for(var fr=[],xr=0,Lr=gt;xr<Lr.length;xr+=1){var rn=Lr[xr];fr.push([He[rn].zoom,r(He[rn],d)])}var vn={name:"linear"};return{kind:"composite",interpolationType:vn,interpolationFactor:De.interpolationFactor.bind(void 0,vn),zoomStops:fr.map(function(Dn){return Dn[0]}),evaluate:function(Dn,fi){var Nn=Dn.zoom;return Ac({stops:fr,base:c.base},d,Nn).evaluate(Nn,fi)}}}if(J){var ii="exponential"===oe?{name:"exponential",base:void 0!==c.base?c.base:1}:null;return{kind:"camera",interpolationType:ii,interpolationFactor:De.interpolationFactor.bind(void 0,ii),zoomStops:c.stops.map(function(Dn){return Dn[0]}),evaluate:function(Dn){return g(c,d,Dn.zoom,x,A)}}}return{kind:"source",evaluate:function(Dn,fi){var Nn=fi&&fi.properties?fi.properties[c.property]:void 0;return void 0===Nn?Us(c.default,d.default):g(c,d,Nn,x,A)}}}(this._parameters,this._specification))};function Vs(e){var t=e.key,r=e.value,c=e.valueSpec||{},d=e.objectElementValidators||{},g=e.style,x=e.styleSpec,A=[],R=ka(r);if("object"!==R)return[new Te(t,r,"object expected, "+R+" found")];for(var j in r){var J=j.split(".")[0],oe=c[J]||c["*"],me=void 0;if(d[J])me=d[J];else if(c[J])me=sa;else if(d["*"])me=d["*"];else{if(!c["*"]){A.push(new Te(t,r[j],'unknown property "'+j+'"'));continue}me=sa}A=A.concat(me({key:(t&&t+".")+j,value:r[j],valueSpec:oe,style:g,styleSpec:x,object:r,objectKey:j},r))}for(var xe in c)d[xe]||c[xe].required&&void 0===c[xe].default&&void 0===r[xe]&&A.push(new Te(t,r,'missing required property "'+xe+'"'));return A}function Pc(e){var t=e.value,r=e.valueSpec,c=e.style,d=e.styleSpec,g=e.key,x=e.arrayElementValidator||sa;if("array"!==ka(t))return[new Te(g,t,"array expected, "+ka(t)+" found")];if(r.length&&t.length!==r.length)return[new Te(g,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Te(g,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var A={type:r.value,values:r.values};d.$version<7&&(A.function=r.function),"object"===ka(r.value)&&(A=r.value);for(var R=[],j=0;j<t.length;j++)R=R.concat(x({array:t,arrayIndex:j,value:t[j],valueSpec:A,style:c,styleSpec:d,key:g+"["+j+"]"}));return R}function Mc(e){var t=e.key,r=e.value,c=e.valueSpec,d=ka(r);return"number"===d&&r!=r&&(d="NaN"),"number"!==d?[new Te(t,r,"number expected, "+d+" found")]:"minimum"in c&&r<c.minimum?[new Te(t,r,r+" is less than the minimum value "+c.minimum)]:"maximum"in c&&r>c.maximum?[new Te(t,r,r+" is greater than the maximum value "+c.maximum)]:[]}function Wc(e){var t,r,c,d=e.valueSpec,g=Vt(e.value.type),x={},A="categorical"!==g&&void 0===e.value.property,R=!A,j="array"===ka(e.value.stops)&&"array"===ka(e.value.stops[0])&&"object"===ka(e.value.stops[0][0]),J=Vs({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(xe){if("identity"===g)return[new Te(xe.key,xe.value,'identity function may not have a "stops" property')];var Ge=[],He=xe.value;return Ge=Ge.concat(Pc({key:xe.key,value:He,valueSpec:xe.valueSpec,style:xe.style,styleSpec:xe.styleSpec,arrayElementValidator:oe})),"array"===ka(He)&&0===He.length&&Ge.push(new Te(xe.key,He,"array must have at least one stop")),Ge},default:function(xe){return sa({key:xe.key,value:xe.value,valueSpec:d,style:xe.style,styleSpec:xe.styleSpec})}}});return"identity"===g&&A&&J.push(new Te(e.key,e.value,'missing required property "property"')),"identity"===g||e.value.stops||J.push(new Te(e.key,e.value,'missing required property "stops"')),"exponential"===g&&e.valueSpec.expression&&!Bu(e.valueSpec)&&J.push(new Te(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(R&&!Rs(e.valueSpec)?J.push(new Te(e.key,e.value,"property functions not supported")):A&&!rc(e.valueSpec)&&J.push(new Te(e.key,e.value,"zoom functions not supported"))),"categorical"!==g&&!j||void 0!==e.value.property||J.push(new Te(e.key,e.value,'"property" property is required')),J;function oe(xe){var Ge=[],He=xe.value,gt=xe.key;if("array"!==ka(He))return[new Te(gt,He,"array expected, "+ka(He)+" found")];if(2!==He.length)return[new Te(gt,He,"array length 2 expected, length "+He.length+" found")];if(j){if("object"!==ka(He[0]))return[new Te(gt,He,"object expected, "+ka(He[0])+" found")];if(void 0===He[0].zoom)return[new Te(gt,He,"object stop key must have zoom")];if(void 0===He[0].value)return[new Te(gt,He,"object stop key must have value")];if(c&&c>Vt(He[0].zoom))return[new Te(gt,He[0].zoom,"stop zoom values must appear in ascending order")];Vt(He[0].zoom)!==c&&(c=Vt(He[0].zoom),r=void 0,x={}),Ge=Ge.concat(Vs({key:gt+"[0]",value:He[0],valueSpec:{zoom:{}},style:xe.style,styleSpec:xe.styleSpec,objectElementValidators:{zoom:Mc,value:me}}))}else Ge=Ge.concat(me({key:gt+"[0]",value:He[0],valueSpec:{},style:xe.style,styleSpec:xe.styleSpec},He));return $u($t(He[1]))?Ge.concat([new Te(gt+"[1]",He[1],"expressions are not allowed in function stops.")]):Ge.concat(sa({key:gt+"[1]",value:He[1],valueSpec:d,style:xe.style,styleSpec:xe.styleSpec}))}function me(xe,Ge){var He=ka(xe.value),gt=Vt(xe.value),it=null!==xe.value?xe.value:Ge;if(t){if(He!==t)return[new Te(xe.key,it,He+" stop domain type must match previous stop domain type "+t)]}else t=He;if("number"!==He&&"string"!==He&&"boolean"!==He)return[new Te(xe.key,it,"stop domain value must be a number, string, or boolean")];if("number"!==He&&"categorical"!==g){var Lt="number expected, "+He+" found";return Rs(d)&&void 0===g&&(Lt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Te(xe.key,it,Lt)]}return"categorical"!==g||"number"!==He||isFinite(gt)&&Math.floor(gt)===gt?"categorical"!==g&&"number"===He&&void 0!==r&&gt<r?[new Te(xe.key,it,"stop domain values must appear in ascending order")]:(r=gt,"categorical"===g&&gt in x?[new Te(xe.key,it,"stop domain values must be unique")]:(x[gt]=!0,[])):[new Te(xe.key,it,"integer expected, found "+gt)]}}function tl(e){var t=("property"===e.expressionContext?dl:pl)($t(e.value),e.valueSpec);if("error"===t.result)return t.value.map(function(c){return new Te(""+e.key+c.key,e.value,c.message)});var r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Te(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===e.expressionContext&&"layout"===e.propertyType&&!ko(r))return[new Te(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!ko(r))return[new Te(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!es(r,["zoom","feature-state"]))return[new Te(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!Qo(r))return[new Te(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function vl(e){var t=e.key,r=e.value,c=e.valueSpec,d=[];return Array.isArray(c.values)?-1===c.values.indexOf(Vt(r))&&d.push(new Te(t,r,"expected one of ["+c.values.join(", ")+"], "+JSON.stringify(r)+" found")):-1===Object.keys(c.values).indexOf(Vt(r))&&d.push(new Te(t,r,"expected one of ["+Object.keys(c.values).join(", ")+"], "+JSON.stringify(r)+" found")),d}function Nl(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var c=r[t];if(!Nl(c)&&"boolean"!=typeof c)return!1}return!0;default:return!0}}Fu.deserialize=function(e){return new Fu(e._parameters,e._specification)},Fu.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var ic={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Nu(e){if(null==e)return{filter:function(){return!0},needGeometry:!1};Nl(e)||(e=Cu(e));var t=pl(e,ic);if("error"===t.result)throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,c,d){return t.value.evaluate(r,c,{},d)},needGeometry:function r(c){if(!Array.isArray(c))return!1;if("within"===c[0])return!0;for(var d=1;d<c.length;d++)if(r(c[d]))return!0;return!1}(e)}}function uf(e,t){return e<t?-1:e>t?1:0}function Cu(e){if(!e)return!0;var t,r=e[0];return e.length<=1?"any"!==r:"=="===r?zu(e[1],e[2],"=="):"!="===r?js(zu(e[1],e[2],"==")):"<"===r||">"===r||"<="===r||">="===r?zu(e[1],e[2],r):"any"===r?(t=e.slice(1),["any"].concat(t.map(Cu))):"all"===r?["all"].concat(e.slice(1).map(Cu)):"none"===r?["all"].concat(e.slice(1).map(Cu).map(js)):"in"===r?nu(e[1],e.slice(2)):"!in"===r?js(nu(e[1],e.slice(2))):"has"===r?Au(e[1]):"!has"===r?js(Au(e[1])):"within"!==r||e}function zu(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function nu(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(uf)]]:["filter-in-small",e,["literal",t]]}}function Au(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function js(e){return["!",e]}function zl(e){return Nl($t(e.value))?tl(wr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var c=r.value,d=r.key;if("array"!==ka(c))return[new Te(d,c,"array expected, "+ka(c)+" found")];var g,x=r.styleSpec,A=[];if(c.length<1)return[new Te(d,c,"filter array must have at least 1 element")];switch(A=A.concat(vl({key:d+"[0]",value:c[0],valueSpec:x.filter_operator,style:r.style,styleSpec:r.styleSpec})),Vt(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&"$type"===Vt(c[1])&&A.push(new Te(d,c,'"$type" cannot be use with operator "'+c[0]+'"'));case"==":case"!=":3!==c.length&&A.push(new Te(d,c,'filter array for operator "'+c[0]+'" must have 3 elements'));case"in":case"!in":c.length>=2&&"string"!==(g=ka(c[1]))&&A.push(new Te(d+"[1]",c[1],"string expected, "+g+" found"));for(var R=2;R<c.length;R++)g=ka(c[R]),"$type"===Vt(c[1])?A=A.concat(vl({key:d+"["+R+"]",value:c[R],valueSpec:x.geometry_type,style:r.style,styleSpec:r.styleSpec})):"string"!==g&&"number"!==g&&"boolean"!==g&&A.push(new Te(d+"["+R+"]",c[R],"string, number, or boolean expected, "+g+" found"));break;case"any":case"all":case"none":for(var j=1;j<c.length;j++)A=A.concat(t({key:d+"["+j+"]",value:c[j],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":g=ka(c[1]),2!==c.length?A.push(new Te(d,c,'filter array for "'+c[0]+'" operator must have 2 elements')):"string"!==g&&A.push(new Te(d+"[1]",c[1],"string expected, "+g+" found"));break;case"within":g=ka(c[1]),2!==c.length?A.push(new Te(d,c,'filter array for "'+c[0]+'" operator must have 2 elements')):"object"!==g&&A.push(new Te(d+"[1]",c[1],"object expected, "+g+" found"))}return A}(e)}function ac(e,t){var r=e.key,c=e.style,d=e.styleSpec,g=e.value,x=e.objectKey,A=d[t+"_"+e.layerType];if(!A)return[];var R=x.match(/^(.*)-transition$/);if("paint"===t&&R&&A[R[1]]&&A[R[1]].transition)return sa({key:r,value:g,valueSpec:d.transition,style:c,styleSpec:d});var j,J=e.valueSpec||A[x];if(!J)return[new Te(r,g,'unknown property "'+x+'"')];if("string"===ka(g)&&Rs(J)&&!J.tokens&&(j=/^{([^}]+)}$/.exec(g)))return[new Te(r,g,'"'+x+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(j[1])+" }`.")];var oe=[];return"symbol"===e.layerType&&("text-field"===x&&c&&!c.glyphs&&oe.push(new Te(r,g,'use of "text-field" requires a style "glyphs" property')),"text-font"===x&&Ju($t(g))&&"identity"===Vt(g.type)&&oe.push(new Te(r,g,'"text-font" does not support identity functions'))),oe.concat(sa({key:e.key,value:g,valueSpec:J,style:c,styleSpec:d,expressionContext:"property",propertyType:t,propertyKey:x}))}function oc(e){return ac(e,"paint")}function Zu(e){return ac(e,"layout")}function ns(e){var t=[],r=e.value,c=e.key,d=e.style,g=e.styleSpec;r.type||r.ref||t.push(new Te(c,r,'either "type" or "ref" is required'));var x,A=Vt(r.type),R=Vt(r.ref);if(r.id)for(var j=Vt(r.id),J=0;J<e.arrayIndex;J++){var oe=d.layers[J];Vt(oe.id)===j&&t.push(new Te(c,r.id,'duplicate layer id "'+r.id+'", previously used at line '+oe.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Ge){Ge in r&&t.push(new Te(c,r[Ge],'"'+Ge+'" is prohibited for ref layers'))}),d.layers.forEach(function(Ge){Vt(Ge.id)===R&&(x=Ge)}),x?x.ref?t.push(new Te(c,r.ref,"ref cannot reference another ref layer")):A=Vt(x.type):t.push(new Te(c,r.ref,'ref layer "'+R+'" not found'));else if("background"!==A)if(r.source){var me=d.sources&&d.sources[r.source],xe=me&&Vt(me.type);me?"vector"===xe&&"raster"===A?t.push(new Te(c,r.source,'layer "'+r.id+'" requires a raster source')):"raster"===xe&&"raster"!==A?t.push(new Te(c,r.source,'layer "'+r.id+'" requires a vector source')):"vector"!==xe||r["source-layer"]?"raster-dem"===xe&&"hillshade"!==A?t.push(new Te(c,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==A||!r.paint||!r.paint["line-gradient"]||"geojson"===xe&&me.lineMetrics||t.push(new Te(c,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Te(c,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Te(c,r.source,'source "'+r.source+'" not found'))}else t.push(new Te(c,r,'missing required property "source"'));return t=t.concat(Vs({key:c,value:r,valueSpec:g.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return sa({key:c+".type",value:r.type,valueSpec:g.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:zl,layout:function(Ge){return Vs({layer:r,key:Ge.key,value:Ge.value,style:Ge.style,styleSpec:Ge.styleSpec,objectElementValidators:{"*":function(He){return Zu(wr({layerType:A},He))}}})},paint:function(Ge){return Vs({layer:r,key:Ge.key,value:Ge.value,style:Ge.style,styleSpec:Ge.styleSpec,objectElementValidators:{"*":function(He){return oc(wr({layerType:A},He))}}})}}}))}function rl(e){var t=e.value,r=e.key,c=ka(t);return"string"!==c?[new Te(r,t,"string expected, "+c+" found")]:[]}var $a={promoteId:function(e){var t=e.key,r=e.value;if("string"===ka(r))return rl({key:t,value:r});var c=[];for(var d in r)c.push.apply(c,rl({key:t+"."+d,value:r[d]}));return c}};function Zl(e){var t=e.value,r=e.key,c=e.styleSpec,d=e.style;if(!t.type)return[new Te(r,t,'"type" is required')];var g,x=Vt(t.type);switch(x){case"vector":case"raster":case"raster-dem":return Vs({key:r,value:t,valueSpec:c["source_"+x.replace("-","_")],style:e.style,styleSpec:c,objectElementValidators:$a});case"geojson":if(g=Vs({key:r,value:t,valueSpec:c.source_geojson,style:d,styleSpec:c,objectElementValidators:$a}),t.cluster)for(var A in t.clusterProperties){var R=t.clusterProperties[A],j=R[0],J="string"==typeof j?[j,["accumulated"],["get",A]]:j;g.push.apply(g,tl({key:r+"."+A+".map",value:R[1],expressionContext:"cluster-map"})),g.push.apply(g,tl({key:r+"."+A+".reduce",value:J,expressionContext:"cluster-reduce"}))}return g;case"video":return Vs({key:r,value:t,valueSpec:c.source_video,style:d,styleSpec:c});case"image":return Vs({key:r,value:t,valueSpec:c.source_image,style:d,styleSpec:c});case"canvas":return[new Te(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vl({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,styleSpec:c})}}function Gs(e){var t=e.value,r=e.styleSpec,c=r.light,d=e.style,g=[],x=ka(t);if(void 0===t)return g;if("object"!==x)return g.concat([new Te("light",t,"object expected, "+x+" found")]);for(var A in t){var R=A.match(/^(.*)-transition$/);g=g.concat(R&&c[R[1]]&&c[R[1]].transition?sa({key:A,value:t[A],valueSpec:r.transition,style:d,styleSpec:r}):c[A]?sa({key:A,value:t[A],valueSpec:c[A],style:d,styleSpec:r}):[new Te(A,t[A],'unknown property "'+A+'"')])}return g}var Pu={"*":function(){return[]},array:Pc,boolean:function(e){var t=e.value,r=e.key,c=ka(t);return"boolean"!==c?[new Te(r,t,"boolean expected, "+c+" found")]:[]},number:Mc,color:function(e){var t=e.key,r=e.value,c=ka(r);return"string"!==c?[new Te(t,r,"color expected, "+c+" found")]:null===Bi(r)?[new Te(t,r,'color expected, "'+r+'" found')]:[]},constants:mt,enum:vl,filter:zl,function:Wc,layer:ns,object:Vs,source:Zl,light:Gs,string:rl,formatted:function(e){return 0===rl(e).length?[]:tl(e)},resolvedImage:function(e){return 0===rl(e).length?[]:tl(e)}};function sa(e){var t=e.value,r=e.valueSpec,c=e.styleSpec;return r.expression&&Ju(Vt(t))?Wc(e):r.expression&&$u($t(t))?tl(e):r.type&&Pu[r.type]?Pu[r.type](e):Vs(wr({},e,{valueSpec:r.type?c[r.type]:r}))}function ja(e){var t=e.value,r=e.key,c=rl(e);return c.length||(-1===t.indexOf("{fontstack}")&&c.push(new Te(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&c.push(new Te(r,t,'"glyphs" url must include a "{range}" token'))),c}function Ss(e,t){void 0===t&&(t=ce);var r=[];return r=r.concat(sa({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:ja,"*":function(){return[]}}})),e.constants&&(r=r.concat(mt({key:"constants",value:e.constants,style:e,styleSpec:t}))),Ul(r)}function Ul(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Uu(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Ul(e.apply(this,t))}}Ss.source=Uu(Zl),Ss.light=Uu(Gs),Ss.layer=Uu(ns),Ss.filter=Uu(zl),Ss.paintProperty=Uu(oc),Ss.layoutProperty=Uu(Zu);var Ic=Ss,Ta=Ic.light,lf=Ic.paintProperty,Vl=Ic.layoutProperty;function ml(e,t){var r=!1;if(t&&t.length)for(var c=0,d=t;c<d.length;c+=1)e.fire(new ye(new Error(d[c].message))),r=!0;return r}var _u=wo;function wo(e,t,r){var c=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var d=new Int32Array(this.arrayBuffer);e=d[0],this.d=(t=d[1])+2*(r=d[2]);for(var g=0;g<this.d*this.d;g++){var x=d[3+g],A=d[3+g+1];c.push(x===A?null:d.subarray(x,A))}var R=d[3+c.length+1];this.keys=d.subarray(d[3+c.length],R),this.bboxes=d.subarray(R),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var j=0;j<this.d*this.d;j++)c.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var J=r/t*e;this.min=-J,this.max=e+J}wo.prototype.insert=function(e,t,r,c,d){this._forEachCell(t,r,c,d,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(c),this.bboxes.push(d)},wo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},wo.prototype._insertCell=function(e,t,r,c,d,g){this.cells[d].push(g)},wo.prototype.query=function(e,t,r,c,d){var g=this.min,x=this.max;if(e<=g&&t<=g&&x<=r&&x<=c&&!d)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(e,t,r,c,this._queryCell,A,{},d),A},wo.prototype._queryCell=function(e,t,r,c,d,g,x,A){var R=this.cells[d];if(null!==R)for(var j=this.keys,J=this.bboxes,oe=0;oe<R.length;oe++){var me=R[oe];if(void 0===x[me]){var xe=4*me;(A?A(J[xe+0],J[xe+1],J[xe+2],J[xe+3]):e<=J[xe+2]&&t<=J[xe+3]&&r>=J[xe+0]&&c>=J[xe+1])?(x[me]=!0,g.push(j[me])):x[me]=!1}}},wo.prototype._forEachCell=function(e,t,r,c,d,g,x,A){for(var R=this._convertToCellCoord(e),j=this._convertToCellCoord(t),J=this._convertToCellCoord(r),oe=this._convertToCellCoord(c),me=R;me<=J;me++)for(var xe=j;xe<=oe;xe++){var Ge=this.d*xe+me;if((!A||A(this._convertFromCellCoord(me),this._convertFromCellCoord(xe),this._convertFromCellCoord(me+1),this._convertFromCellCoord(xe+1)))&&d.call(this,e,t,r,c,Ge,g,x,A))return}},wo.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},wo.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},wo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,c=0;c<this.cells.length;c++)r+=this.cells[c].length;var d=new Int32Array(t+r+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var g=t,x=0;x<e.length;x++){var A=e[x];d[3+x]=g,d.set(A,g),g+=A.length}return d[3+e.length]=g,d.set(this.keys,g),d[3+e.length+1]=g+=this.keys.length,d.set(this.bboxes,g),g+=this.bboxes.length,d.buffer};var gl=Y.ImageData,yl=Y.ImageBitmap,Ro={};function Bn(e,t,r){void 0===r&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),Ro[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var za in Bn("Object",Object),_u.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},_u.deserialize=function(e){return new _u(e.buffer)},Bn("Grid",_u),Bn("Color",Xi),Bn("Error",Error),Bn("ResolvedImage",Wi),Bn("StylePropertyFunction",Fu),Bn("StyleExpression",yu,{omit:["_evaluator"]}),Bn("ZoomDependentExpression",el),Bn("ZoomConstantExpression",Qu),Bn("CompoundExpression",Ya,{omit:["_evaluate"]}),tu)tu[za]._classRegistryKey||Bn("Expression_"+za,tu[za]);function Vu(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function _l(e){return yl&&e instanceof yl}function iu(e,t){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Vu(e)||_l(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof gl)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var c=[],d=0,g=e;d<g.length;d+=1)c.push(iu(g[d],t));return c}if("object"==typeof e){var x=e.constructor,A=x._classRegistryKey;if(!A)throw new Error("can't serialize object of unregistered class");var R=x.serialize?x.serialize(e,t):{};if(!x.serialize){for(var j in e)if(e.hasOwnProperty(j)&&!(Ro[A].omit.indexOf(j)>=0)){var J=e[j];R[j]=Ro[A].shallow.indexOf(j)>=0?J:iu(J,t)}e instanceof Error&&(R.message=e.message)}if(R.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==A&&(R.$name=A),R}throw new Error("can't serialize object of type "+typeof e)}function Es(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Vu(e)||_l(e)||ArrayBuffer.isView(e)||e instanceof gl)return e;if(Array.isArray(e))return e.map(Es);if("object"==typeof e){var t=e.$name||"Object",r=Ro[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var c=Object.create(r.prototype),d=0,g=Object.keys(e);d<g.length;d+=1){var x=g[d];if("$name"!==x){var A=e[x];c[x]=Ro[t].shallow.indexOf(x)>=0?A:Es(A)}}return c}throw new Error("can't deserialize object of type "+typeof e)}var Xc=function(){this.first=!0};Xc.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var cn={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function Yc(e){for(var t=0,r=e;t<r.length;t+=1)if(Oc(r[t].charCodeAt(0)))return!0;return!1}function Oc(e){return!(746!==e&&747!==e&&(e<4352||!(cn["Bopomofo Extended"](e)||cn.Bopomofo(e)||cn["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||cn["CJK Compatibility Ideographs"](e)||cn["CJK Compatibility"](e)||cn["CJK Radicals Supplement"](e)||cn["CJK Strokes"](e)||!(!cn["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||cn["CJK Unified Ideographs Extension A"](e)||cn["CJK Unified Ideographs"](e)||cn["Enclosed CJK Letters and Months"](e)||cn["Hangul Compatibility Jamo"](e)||cn["Hangul Jamo Extended-A"](e)||cn["Hangul Jamo Extended-B"](e)||cn["Hangul Jamo"](e)||cn["Hangul Syllables"](e)||cn.Hiragana(e)||cn["Ideographic Description Characters"](e)||cn.Kanbun(e)||cn["Kangxi Radicals"](e)||cn["Katakana Phonetic Extensions"](e)||cn.Katakana(e)&&12540!==e||!(!cn["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!cn["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||cn["Unified Canadian Aboriginal Syllabics"](e)||cn["Unified Canadian Aboriginal Syllabics Extended"](e)||cn["Vertical Forms"](e)||cn["Yijing Hexagram Symbols"](e)||cn["Yi Syllables"](e)||cn["Yi Radicals"](e))))}function xl(e){return!(Oc(e)||(t=e,cn["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||cn["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||cn["Letterlike Symbols"](t)||cn["Number Forms"](t)||cn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||cn["Control Pictures"](t)&&9251!==t||cn["Optical Character Recognition"](t)||cn["Enclosed Alphanumerics"](t)||cn["Geometric Shapes"](t)||cn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||cn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||cn["CJK Symbols and Punctuation"](t)||cn.Katakana(t)||cn["Private Use Area"](t)||cn["CJK Compatibility Forms"](t)||cn["Small Form Variants"](t)||cn["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t));var t}function Ga(e){return e>=1424&&e<=2303||cn["Arabic Presentation Forms-A"](e)||cn["Arabic Presentation Forms-B"](e)}function Ts(e,t){return!(!t&&Ga(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||cn.Khmer(e))}function sc(e){for(var t=0,r=e;t<r.length;t+=1)if(Ga(r[t].charCodeAt(0)))return!0;return!1}var au=null,Ds="unavailable",Hs=null,Tf=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Ds="error"),au&&au(e)};function uc(){cf.fire(new re("pluginStateChange",{pluginStatus:Ds,pluginURL:Hs}))}var cf=new Me,kc=function(){return Ds},Ws=function(){if("deferred"!==Ds||!Hs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ds="loading",uc(),Hs&&Pi({url:Hs},function(e){e?Tf(e):(Ds="loaded",uc())})},Cs={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===Ds||null!=Cs.applyArabicShaping},isLoading:function(){return"loading"===Ds},setState:function(e){Ds=e.pluginStatus,Hs=e.pluginURL},isParsed:function(){return null!=Cs.applyArabicShaping&&null!=Cs.processBidirectionalText&&null!=Cs.processStyledBidirectionalText},getPluginURL:function(){return Hs}},$i=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Xc,this.transition={})};$i.prototype.isSupportedScript=function(e){return function(t,r){for(var c=0,d=t;c<d.length;c+=1)if(!Ts(d[c].charCodeAt(0),r))return!1;return!0}(e,Cs.isLoaded())},$i.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},$i.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var xu=function(e,t){this.property=e,this.value=t,this.expression=function(r,c){if(Ju(r))return new Fu(r,c);if($u(r)){var d=dl(r,c);if("error"===d.result)throw new Error(d.value.map(function(x){return x.key+": "+x.message}).join(", "));return d.value}var g=r;return"string"==typeof r&&"color"===c.type&&(g=Xi.parse(r)),{kind:"constant",evaluate:function(){return g}}}(void 0===t?e.specification.default:t,e.specification)};xu.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},xu.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var Bs=function(e){this.property=e,this.value=new xu(e,void 0)};Bs.prototype.transitioned=function(e,t){return new nl(this.property,this.value,t,Mt({},e.transition,this.transition),e.now)},Bs.prototype.untransitioned=function(){return new nl(this.property,this.value,null,{},0)};var Yo=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};Yo.prototype.getValue=function(e){return $e(this._values[e].value.value)},Yo.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Bs(this._values[e].property)),this._values[e].value=new xu(this._values[e].property,null===t?void 0:$e(t))},Yo.prototype.getTransition=function(e){return $e(this._values[e].transition)},Yo.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Bs(this._values[e].property)),this._values[e].transition=$e(t)||void 0},Yo.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var c=r[t],d=this.getValue(c);void 0!==d&&(e[c]=d);var g=this.getTransition(c);void 0!==g&&(e[c+"-transition"]=g)}return e},Yo.prototype.transitioned=function(e,t){for(var r=new bu(this._properties),c=0,d=Object.keys(this._values);c<d.length;c+=1){var g=d[c];r._values[g]=this._values[g].transitioned(e,t._values[g])}return r},Yo.prototype.untransitioned=function(){for(var e=new bu(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var c=r[t];e._values[c]=this._values[c].untransitioned()}return e};var nl=function(e,t,r,c,d){this.property=e,this.value=t,this.begin=d+c.delay||0,this.end=this.begin+c.duration||0,e.specification.transition&&(c.delay||c.duration)&&(this.prior=r)};nl.prototype.possiblyEvaluate=function(e,t,r){var c=e.now||0,d=this.value.possiblyEvaluate(e,t,r),g=this.prior;if(g){if(c>this.end)return this.prior=null,d;if(this.value.isDataDriven())return this.prior=null,d;if(c<this.begin)return g.possiblyEvaluate(e,t,r);var x=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,t,r),d,function(A){if(A<=0)return 0;if(A>=1)return 1;var R=A*A,j=R*A;return 4*(A<.5?j:3*(A-R)+j-.75)}(x))}return d};var bu=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};bu.prototype.possiblyEvaluate=function(e,t,r){for(var c=new il(this._properties),d=0,g=Object.keys(this._values);d<g.length;d+=1){var x=g[d];c._values[x]=this._values[x].possiblyEvaluate(e,t,r)}return c},bu.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var ou=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};ou.prototype.getValue=function(e){return $e(this._values[e].value)},ou.prototype.setValue=function(e,t){this._values[e]=new xu(this._values[e].property,null===t?void 0:$e(t))},ou.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var c=r[t],d=this.getValue(c);void 0!==d&&(e[c]=d)}return e},ou.prototype.possiblyEvaluate=function(e,t,r){for(var c=new il(this._properties),d=0,g=Object.keys(this._values);d<g.length;d+=1){var x=g[d];c._values[x]=this._values[x].possiblyEvaluate(e,t,r)}return c};var mo=function(e,t,r){this.property=e,this.value=t,this.parameters=r};mo.prototype.isConstant=function(){return"constant"===this.value.kind},mo.prototype.constantOr=function(e){return"constant"===this.value.kind?this.value.value:e},mo.prototype.evaluate=function(e,t,r,c){return this.property.evaluate(this.value,this.parameters,e,t,r,c)};var il=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};il.prototype.get=function(e){return this._values[e]};var ri=function(e){this.specification=e};ri.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},ri.prototype.interpolate=function(e,t,r){var c=Lo[this.specification.type];return c?c(e,t,r):e};var An=function(e,t){this.specification=e,this.overrides=t};An.prototype.possiblyEvaluate=function(e,t,r,c){return new mo(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,c)}:e.expression,t)},An.prototype.interpolate=function(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new mo(this,{kind:"constant",value:void 0},e.parameters);var c=Lo[this.specification.type];return c?new mo(this,{kind:"constant",value:c(e.value.value,t.value.value,r)},e.parameters):e},An.prototype.evaluate=function(e,t,r,c,d,g){return"constant"===e.kind?e.value:e.evaluate(t,r,c,d,g)};var lc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,c,d,g){if(void 0===r.value)return new mo(this,{kind:"constant",value:void 0},c);if("constant"===r.expression.kind){var x=r.expression.evaluate(c,null,{},d,g),A="resolvedImage"===r.property.specification.type&&"string"!=typeof x?x.name:x,R=this._calculate(A,A,A,c);return new mo(this,{kind:"constant",value:R},c)}if("camera"===r.expression.kind){var j=this._calculate(r.expression.evaluate({zoom:c.zoom-1}),r.expression.evaluate({zoom:c.zoom}),r.expression.evaluate({zoom:c.zoom+1}),c);return new mo(this,{kind:"constant",value:j},c)}return new mo(this,r.expression,c)},t.prototype.evaluate=function(r,c,d,g,x,A){if("source"===r.kind){var R=r.evaluate(c,d,g,x,A);return this._calculate(R,R,R,c)}return"composite"===r.kind?this._calculate(r.evaluate({zoom:Math.floor(c.zoom)-1},d,g),r.evaluate({zoom:Math.floor(c.zoom)},d,g),r.evaluate({zoom:Math.floor(c.zoom)+1},d,g),c):r.value},t.prototype._calculate=function(r,c,d,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:c}:{from:d,to:c}},t.prototype.interpolate=function(r){return r},t}(An),So=function(e){this.specification=e};So.prototype.possiblyEvaluate=function(e,t,r,c){if(void 0!==e.value){if("constant"===e.expression.kind){var d=e.expression.evaluate(t,null,{},r,c);return this._calculate(d,d,d,t)}return this._calculate(e.expression.evaluate(new $i(Math.floor(t.zoom-1),t)),e.expression.evaluate(new $i(Math.floor(t.zoom),t)),e.expression.evaluate(new $i(Math.floor(t.zoom+1),t)),t)}},So.prototype._calculate=function(e,t,r,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},So.prototype.interpolate=function(e){return e};var Xs=function(e){this.specification=e};Xs.prototype.possiblyEvaluate=function(e,t,r,c){return!!e.expression.evaluate(t,null,{},r,c)},Xs.prototype.interpolate=function(){return!1};var Po=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var c=this.defaultPropertyValues[t]=new xu(r,void 0),d=this.defaultTransitionablePropertyValues[t]=new Bs(r);this.defaultTransitioningPropertyValues[t]=d.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=c.possiblyEvaluate({})}};Bn("DataDrivenProperty",An),Bn("DataConstantProperty",ri),Bn("CrossFadedDataDrivenProperty",lc),Bn("CrossFadedProperty",So),Bn("ColorRampProperty",Xs);var fo=function(e){function t(r,c){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==r.type&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),c.layout&&(this._unevaluatedLayout=new ou(c.layout)),c.paint)){for(var d in this._transitionablePaint=new Yo(c.paint),r.paint)this.setPaintProperty(d,r.paint[d],{validate:!1});for(var g in r.layout)this.setLayoutProperty(g,r.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new il(c.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,c,d){void 0===d&&(d={}),null!=c&&this._validate(Vl,"layers."+this.id+".layout."+r,r,c,d)||("visibility"!==r?this._unevaluatedLayout.setValue(r,c):this.visibility=c)},t.prototype.getPaintProperty=function(r){return ne(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,c,d){if(void 0===d&&(d={}),null!=c&&this._validate(lf,"layers."+this.id+".paint."+r,r,c,d))return!1;if(ne(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),c||void 0),!1;var g=this._transitionablePaint._values[r],x="cross-faded-data-driven"===g.property.specification["property-type"],A=g.value.isDataDriven(),R=g.value;this._transitionablePaint.setValue(r,c),this._handleSpecialPaintPropertyUpdate(r);var j=this._transitionablePaint._values[r].value;return j.isDataDriven()||A||x||this._handleOverridablePaintPropertyUpdate(r,R,j)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,c,d){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,c){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,c)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Tt(r,function(c,d){return!(void 0===c||"layout"===d&&!Object.keys(c).length||"paint"===d&&!Object.keys(c).length)})},t.prototype._validate=function(r,c,d,g,x){return void 0===x&&(x={}),(!x||!1!==x.validate)&&ml(this,r.call(Ic,{key:c,layerType:this.type,objectKey:d,value:g,styleSpec:ce,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var c=this.paint.get(r);if(c instanceof mo&&Rs(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1},t}(Me),jl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Gl=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Qi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function zo(e,t){void 0===t&&(t=1);var r=0,c=0;return{members:e.map(function(d){var g=jl[d.type].BYTES_PER_ELEMENT,x=r=ff(r,Math.max(t,g)),A=d.components||1;return c=Math.max(c,g),r+=g*A,{name:d.name,type:d.type,components:A,offset:x}}),size:ff(r,Math.max(c,t)),alignment:t}}function ff(e,t){return Math.ceil(e/t)*t}Qi.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Qi.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Qi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Qi.prototype.clear=function(){this.length=0},Qi.prototype.resize=function(e){this.reserve(e),this.length=e},Qi.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Qi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var As=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c){var d=this.length;return this.resize(d+1),this.emplace(d,r,c)},t.prototype.emplace=function(r,c,d){var g=2*r;return this.int16[g+0]=c,this.int16[g+1]=d,r},t}(Qi);As.prototype.bytesPerElement=4,Bn("StructArrayLayout2i4",As);var bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g){var x=this.length;return this.resize(x+1),this.emplace(x,r,c,d,g)},t.prototype.emplace=function(r,c,d,g,x){var A=4*r;return this.int16[A+0]=c,this.int16[A+1]=d,this.int16[A+2]=g,this.int16[A+3]=x,r},t}(Qi);bl.prototype.bytesPerElement=8,Bn("StructArrayLayout4i8",bl);var ys=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x,A){var R=this.length;return this.resize(R+1),this.emplace(R,r,c,d,g,x,A)},t.prototype.emplace=function(r,c,d,g,x,A,R){var j=6*r;return this.int16[j+0]=c,this.int16[j+1]=d,this.int16[j+2]=g,this.int16[j+3]=x,this.int16[j+4]=A,this.int16[j+5]=R,r},t}(Qi);ys.prototype.bytesPerElement=12,Bn("StructArrayLayout2i4i12",ys);var is=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x,A){var R=this.length;return this.resize(R+1),this.emplace(R,r,c,d,g,x,A)},t.prototype.emplace=function(r,c,d,g,x,A,R){var j=4*r,J=8*r;return this.int16[j+0]=c,this.int16[j+1]=d,this.uint8[J+4]=g,this.uint8[J+5]=x,this.uint8[J+6]=A,this.uint8[J+7]=R,r},t}(Qi);is.prototype.bytesPerElement=8,Bn("StructArrayLayout2i4ub8",is);var al=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c){var d=this.length;return this.resize(d+1),this.emplace(d,r,c)},t.prototype.emplace=function(r,c,d){var g=2*r;return this.float32[g+0]=c,this.float32[g+1]=d,r},t}(Qi);al.prototype.bytesPerElement=8,Bn("StructArrayLayout2f8",al);var su=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x,A,R,j,J,oe){var me=this.length;return this.resize(me+1),this.emplace(me,r,c,d,g,x,A,R,j,J,oe)},t.prototype.emplace=function(r,c,d,g,x,A,R,j,J,oe,me){var xe=10*r;return this.uint16[xe+0]=c,this.uint16[xe+1]=d,this.uint16[xe+2]=g,this.uint16[xe+3]=x,this.uint16[xe+4]=A,this.uint16[xe+5]=R,this.uint16[xe+6]=j,this.uint16[xe+7]=J,this.uint16[xe+8]=oe,this.uint16[xe+9]=me,r},t}(Qi);su.prototype.bytesPerElement=20,Bn("StructArrayLayout10ui20",su);var Hl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x,A,R,j,J,oe,me,xe){var Ge=this.length;return this.resize(Ge+1),this.emplace(Ge,r,c,d,g,x,A,R,j,J,oe,me,xe)},t.prototype.emplace=function(r,c,d,g,x,A,R,j,J,oe,me,xe,Ge){var He=12*r;return this.int16[He+0]=c,this.int16[He+1]=d,this.int16[He+2]=g,this.int16[He+3]=x,this.uint16[He+4]=A,this.uint16[He+5]=R,this.uint16[He+6]=j,this.uint16[He+7]=J,this.int16[He+8]=oe,this.int16[He+9]=me,this.int16[He+10]=xe,this.int16[He+11]=Ge,r},t}(Qi);Hl.prototype.bytesPerElement=24,Bn("StructArrayLayout4i4ui4i24",Hl);var wl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d){var g=this.length;return this.resize(g+1),this.emplace(g,r,c,d)},t.prototype.emplace=function(r,c,d,g){var x=3*r;return this.float32[x+0]=c,this.float32[x+1]=d,this.float32[x+2]=g,r},t}(Qi);wl.prototype.bytesPerElement=12,Bn("StructArrayLayout3f12",wl);var Wl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var c=this.length;return this.resize(c+1),this.emplace(c,r)},t.prototype.emplace=function(r,c){return this.uint32[1*r+0]=c,r},t}(Qi);Wl.prototype.bytesPerElement=4,Bn("StructArrayLayout1ul4",Wl);var Kc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x,A,R,j,J){var oe=this.length;return this.resize(oe+1),this.emplace(oe,r,c,d,g,x,A,R,j,J)},t.prototype.emplace=function(r,c,d,g,x,A,R,j,J,oe){var me=10*r,xe=5*r;return this.int16[me+0]=c,this.int16[me+1]=d,this.int16[me+2]=g,this.int16[me+3]=x,this.int16[me+4]=A,this.int16[me+5]=R,this.uint32[xe+3]=j,this.uint16[me+8]=J,this.uint16[me+9]=oe,r},t}(Qi);Kc.prototype.bytesPerElement=20,Bn("StructArrayLayout6i1ul2ui20",Kc);var Sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x,A){var R=this.length;return this.resize(R+1),this.emplace(R,r,c,d,g,x,A)},t.prototype.emplace=function(r,c,d,g,x,A,R){var j=6*r;return this.int16[j+0]=c,this.int16[j+1]=d,this.int16[j+2]=g,this.int16[j+3]=x,this.int16[j+4]=A,this.int16[j+5]=R,r},t}(Qi);Sl.prototype.bytesPerElement=12,Bn("StructArrayLayout2i2i2i12",Sl);var ol=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x){var A=this.length;return this.resize(A+1),this.emplace(A,r,c,d,g,x)},t.prototype.emplace=function(r,c,d,g,x,A){var R=4*r,j=8*r;return this.float32[R+0]=c,this.float32[R+1]=d,this.float32[R+2]=g,this.int16[j+6]=x,this.int16[j+7]=A,r},t}(Qi);ol.prototype.bytesPerElement=16,Bn("StructArrayLayout2f1f2i16",ol);var Lc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g){var x=this.length;return this.resize(x+1),this.emplace(x,r,c,d,g)},t.prototype.emplace=function(r,c,d,g,x){var A=12*r,R=3*r;return this.uint8[A+0]=c,this.uint8[A+1]=d,this.float32[R+1]=g,this.float32[R+2]=x,r},t}(Qi);Lc.prototype.bytesPerElement=12,Bn("StructArrayLayout2ub2f12",Lc);var sl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d){var g=this.length;return this.resize(g+1),this.emplace(g,r,c,d)},t.prototype.emplace=function(r,c,d,g){var x=3*r;return this.uint16[x+0]=c,this.uint16[x+1]=d,this.uint16[x+2]=g,r},t}(Qi);sl.prototype.bytesPerElement=6,Bn("StructArrayLayout3ui6",sl);var ju=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x,A,R,j,J,oe,me,xe,Ge,He,gt,it,Lt){var Ht=this.length;return this.resize(Ht+1),this.emplace(Ht,r,c,d,g,x,A,R,j,J,oe,me,xe,Ge,He,gt,it,Lt)},t.prototype.emplace=function(r,c,d,g,x,A,R,j,J,oe,me,xe,Ge,He,gt,it,Lt,Ht){var fr=24*r,xr=12*r,Lr=48*r;return this.int16[fr+0]=c,this.int16[fr+1]=d,this.uint16[fr+2]=g,this.uint16[fr+3]=x,this.uint32[xr+2]=A,this.uint32[xr+3]=R,this.uint32[xr+4]=j,this.uint16[fr+10]=J,this.uint16[fr+11]=oe,this.uint16[fr+12]=me,this.float32[xr+7]=xe,this.float32[xr+8]=Ge,this.uint8[Lr+36]=He,this.uint8[Lr+37]=gt,this.uint8[Lr+38]=it,this.uint32[xr+10]=Lt,this.int16[fr+22]=Ht,r},t}(Qi);ju.prototype.bytesPerElement=48,Bn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ju);var Xl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g,x,A,R,j,J,oe,me,xe,Ge,He,gt,it,Lt,Ht,fr,xr,Lr,rn,vn,ii,Dn,fi,Nn,na){var Si=this.length;return this.resize(Si+1),this.emplace(Si,r,c,d,g,x,A,R,j,J,oe,me,xe,Ge,He,gt,it,Lt,Ht,fr,xr,Lr,rn,vn,ii,Dn,fi,Nn,na)},t.prototype.emplace=function(r,c,d,g,x,A,R,j,J,oe,me,xe,Ge,He,gt,it,Lt,Ht,fr,xr,Lr,rn,vn,ii,Dn,fi,Nn,na,Si){var Qn=34*r,da=17*r;return this.int16[Qn+0]=c,this.int16[Qn+1]=d,this.int16[Qn+2]=g,this.int16[Qn+3]=x,this.int16[Qn+4]=A,this.int16[Qn+5]=R,this.int16[Qn+6]=j,this.int16[Qn+7]=J,this.uint16[Qn+8]=oe,this.uint16[Qn+9]=me,this.uint16[Qn+10]=xe,this.uint16[Qn+11]=Ge,this.uint16[Qn+12]=He,this.uint16[Qn+13]=gt,this.uint16[Qn+14]=it,this.uint16[Qn+15]=Lt,this.uint16[Qn+16]=Ht,this.uint16[Qn+17]=fr,this.uint16[Qn+18]=xr,this.uint16[Qn+19]=Lr,this.uint16[Qn+20]=rn,this.uint16[Qn+21]=vn,this.uint16[Qn+22]=ii,this.uint32[da+12]=Dn,this.float32[da+13]=fi,this.float32[da+14]=Nn,this.float32[da+15]=na,this.float32[da+16]=Si,r},t}(Qi);Xl.prototype.bytesPerElement=68,Bn("StructArrayLayout8i15ui1ul4f68",Xl);var Gu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var c=this.length;return this.resize(c+1),this.emplace(c,r)},t.prototype.emplace=function(r,c){return this.float32[1*r+0]=c,r},t}(Qi);Gu.prototype.bytesPerElement=4,Bn("StructArrayLayout1f4",Gu);var Fs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d){var g=this.length;return this.resize(g+1),this.emplace(g,r,c,d)},t.prototype.emplace=function(r,c,d,g){var x=3*r;return this.int16[x+0]=c,this.int16[x+1]=d,this.int16[x+2]=g,r},t}(Qi);Fs.prototype.bytesPerElement=6,Bn("StructArrayLayout3i6",Fs);var Rc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d){var g=this.length;return this.resize(g+1),this.emplace(g,r,c,d)},t.prototype.emplace=function(r,c,d,g){var x=4*r;return this.uint32[2*r+0]=c,this.uint16[x+2]=d,this.uint16[x+3]=g,r},t}(Qi);Rc.prototype.bytesPerElement=8,Bn("StructArrayLayout1ul2ui8",Rc);var cc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c){var d=this.length;return this.resize(d+1),this.emplace(d,r,c)},t.prototype.emplace=function(r,c,d){var g=2*r;return this.uint16[g+0]=c,this.uint16[g+1]=d,r},t}(Qi);cc.prototype.bytesPerElement=4,Bn("StructArrayLayout2ui4",cc);var fc=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var c=this.length;return this.resize(c+1),this.emplace(c,r)},t.prototype.emplace=function(r,c){return this.uint16[1*r+0]=c,r},t}(Qi);fc.prototype.bytesPerElement=2,Bn("StructArrayLayout1ui2",fc);var El=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,d,g){var x=this.length;return this.resize(x+1),this.emplace(x,r,c,d,g)},t.prototype.emplace=function(r,c,d,g,x){var A=4*r;return this.float32[A+0]=c,this.float32[A+1]=d,this.float32[A+2]=g,this.float32[A+3]=x,r},t}(Qi);El.prototype.bytesPerElement=16,Bn("StructArrayLayout4f16",El);var a=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new q(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Gl);a.prototype.size=20;var s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new a(this,r)},t}(Kc);Bn("CollisionBoxArray",s);var o=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(c){this._structArray.uint8[this._pos1+37]=c},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(c){this._structArray.uint8[this._pos1+38]=c},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(c){this._structArray.uint32[this._pos4+10]=c},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Gl);o.prototype.size=48;var h=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new o(this,r)},t}(ju);Bn("PlacedSymbolArray",h);var y=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(c){this._structArray.uint32[this._pos4+12]=c},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Gl);y.prototype.size=68;var S=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new y(this,r)},t}(Xl);Bn("SymbolInstanceArray",S);var C=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}(Gu);Bn("GlyphOffsetArray",C);var k=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Fs);Bn("SymbolLineVertexArray",k);var K=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Gl);K.prototype.size=8;var le=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new K(this,r)},t}(Rc);Bn("FeatureIndexArray",le);var Ee=zo([{name:"a_pos",components:2,type:"Int16"}],4).members,Ae=function(e){void 0===e&&(e=[]),this.segments=e};function Oe(e,t){return 256*(e=Z(Math.floor(e),0,255))+Z(Math.floor(t),0,255)}Ae.prototype.prepareSegment=function(e,t,r,c){var d=this.segments[this.segments.length-1];return e>Ae.MAX_VERTEX_ARRAY_LENGTH&&qe("Max vertices per segment is "+Ae.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!d||d.vertexLength+e>Ae.MAX_VERTEX_ARRAY_LENGTH||d.sortKey!==c)&&(d={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==c&&(d.sortKey=c),this.segments.push(d)),d},Ae.prototype.get=function(){return this.segments},Ae.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var c in r.vaos)r.vaos[c].destroy()}},Ae.simpleSegment=function(e,t,r,c){return new Ae([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:c,vaos:{},sortKey:0}])},Ae.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Bn("SegmentVector",Ae);var Ke=zo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),We=_(function(e){e.exports=function(t,r){var c,d,g,x,A,R,j,J;for(d=t.length-(c=3&t.length),g=r,A=3432918353,R=461845907,J=0;J<d;)j=255&t.charCodeAt(J)|(255&t.charCodeAt(++J))<<8|(255&t.charCodeAt(++J))<<16|(255&t.charCodeAt(++J))<<24,++J,g=27492+(65535&(x=5*(65535&(g=(g^=j=(65535&(j=(j=(65535&j)*A+(((j>>>16)*A&65535)<<16)&4294967295)<<15|j>>>17))*R+(((j>>>16)*R&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(x>>>16)&65535)<<16);switch(j=0,c){case 3:j^=(255&t.charCodeAt(J+2))<<16;case 2:j^=(255&t.charCodeAt(J+1))<<8;case 1:g^=j=(65535&(j=(j=(65535&(j^=255&t.charCodeAt(J)))*A+(((j>>>16)*A&65535)<<16)&4294967295)<<15|j>>>17))*R+(((j>>>16)*R&65535)<<16)&4294967295}return g^=t.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}),st=_(function(e){e.exports=function(t,r){for(var c,d=t.length,g=r^d,x=0;d>=4;)c=1540483477*(65535&(c=255&t.charCodeAt(x)|(255&t.charCodeAt(++x))<<8|(255&t.charCodeAt(++x))<<16|(255&t.charCodeAt(++x))<<24))+((1540483477*(c>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),d-=4,++x;switch(d){case 3:g^=(255&t.charCodeAt(x+2))<<16;case 2:g^=(255&t.charCodeAt(x+1))<<8;case 1:g=1540483477*(65535&(g^=255&t.charCodeAt(x)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}}),je=We,at=st;je.murmur3=We,je.murmur2=at;var xt=function(){this.ids=[],this.positions=[],this.indexed=!1};xt.prototype.add=function(e,t,r,c){this.ids.push(or(e)),this.positions.push(t,r,c)},xt.prototype.getPositions=function(e){for(var t=or(e),r=0,c=this.ids.length-1;r<c;){var d=r+c>>1;this.ids[d]>=t?c=d:r=d+1}for(var g=[];this.ids[r]===t;)g.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return g},xt.serialize=function(e,t){var r=new Float64Array(e.ids),c=new Uint32Array(e.positions);return function d(g,x,A,R){for(;A<R;){for(var j=g[A+R>>1],J=A-1,oe=R+1;;){do{J++}while(g[J]<j);do{oe--}while(g[oe]>j);if(J>=oe)break;Jt(g,J,oe),Jt(x,3*J,3*oe),Jt(x,3*J+1,3*oe+1),Jt(x,3*J+2,3*oe+2)}oe-A<R-oe?(d(g,x,A,oe),A=oe+1):(d(g,x,oe+1,R),R=oe)}}(r,c,0,r.length-1),t&&t.push(r.buffer,c.buffer),{ids:r,positions:c}},xt.deserialize=function(e){var t=new xt;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var zt=Math.pow(2,53)-1;function or(e){var t=+e;return!isNaN(t)&&t<=zt?t:je(String(e))}function Jt(e,t,r){var c=e[t];e[t]=e[r],e[r]=c}Bn("FeaturePositionMap",xt);var yr=function(e,t){this.gl=e.gl,this.location=t},Rr=function(e){function t(r,c){e.call(this,r,c),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(yr),$r=function(e){function t(r,c){e.call(this,r,c),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(yr),Xr=function(e){function t(r,c){e.call(this,r,c),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(yr),pn=function(e){function t(r,c){e.call(this,r,c),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(yr),qn=function(e){function t(r,c){e.call(this,r,c),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(yr),Un=function(e){function t(r,c){e.call(this,r,c),this.current=Xi.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(yr),Rn=new Float32Array(16),ki=function(e){function t(r,c){e.call(this,r,c),this.current=Rn}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var c=1;c<16;c++)if(r[c]!==this.current[c]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(yr);function kn(e){return[Oe(255*e.r,255*e.g),Oe(255*e.b,255*e.a)]}var gi=function(e,t,r){this.value=e,this.uniformNames=t.map(function(c){return"u_"+c}),this.type=r};gi.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},gi.prototype.getBinding=function(e,t,r){return"color"===this.type?new Un(e,t):new $r(e,t)};var Vi=function(e,t){this.uniformNames=t.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Vi.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Vi.prototype.setUniform=function(e,t,r,c){var d="u_pattern_to"===c?this.patternTo:"u_pattern_from"===c?this.patternFrom:"u_pixel_ratio_to"===c?this.pixelRatioTo:"u_pixel_ratio_from"===c?this.pixelRatioFrom:null;d&&e.set(d)},Vi.prototype.getBinding=function(e,t,r){return"u_pattern"===r.substr(0,9)?new qn(e,t):new $r(e,t)};var li=function(e,t,r,c){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(function(d){return{name:"a_"+d,type:"Float32",components:"color"===r?2:1,offset:0}}),this.paintVertexArray=new c};li.prototype.populatePaintArray=function(e,t,r,c,d){var g=this.paintVertexArray.length,x=this.expression.evaluate(new $i(0),t,{},c,[],d);this.paintVertexArray.resize(e),this._setPaintValue(g,e,x)},li.prototype.updatePaintArray=function(e,t,r,c){var d=this.expression.evaluate({zoom:0},r,c);this._setPaintValue(e,t,d)},li.prototype._setPaintValue=function(e,t,r){if("color"===this.type)for(var c=kn(r),d=e;d<t;d++)this.paintVertexArray.emplace(d,c[0],c[1]);else{for(var g=e;g<t;g++)this.paintVertexArray.emplace(g,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},li.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},li.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var yi=function(e,t,r,c,d,g){this.expression=e,this.uniformNames=t.map(function(x){return"u_"+x+"_t"}),this.type=r,this.useIntegerZoom=c,this.zoom=d,this.maxValue=0,this.paintVertexAttributes=t.map(function(x){return{name:"a_"+x,type:"Float32",components:"color"===r?4:2,offset:0}}),this.paintVertexArray=new g};yi.prototype.populatePaintArray=function(e,t,r,c,d){var g=this.expression.evaluate(new $i(this.zoom),t,{},c,[],d),x=this.expression.evaluate(new $i(this.zoom+1),t,{},c,[],d),A=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(A,e,g,x)},yi.prototype.updatePaintArray=function(e,t,r,c){var d=this.expression.evaluate({zoom:this.zoom},r,c),g=this.expression.evaluate({zoom:this.zoom+1},r,c);this._setPaintValue(e,t,d,g)},yi.prototype._setPaintValue=function(e,t,r,c){if("color"===this.type)for(var d=kn(r),g=kn(c),x=e;x<t;x++)this.paintVertexArray.emplace(x,d[0],d[1],g[0],g[1]);else{for(var A=e;A<t;A++)this.paintVertexArray.emplace(A,r,c);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(c))}},yi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},yi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},yi.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,c=Z(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(c)},yi.prototype.getBinding=function(e,t,r){return new $r(e,t)};var Ni=function(e,t,r,c,d,g){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=c,this.layerId=g,this.zoomInPaintVertexArray=new d,this.zoomOutPaintVertexArray=new d};Ni.prototype.populatePaintArray=function(e,t,r){var c=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(c,e,t.patterns&&t.patterns[this.layerId],r)},Ni.prototype.updatePaintArray=function(e,t,r,c,d){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],d)},Ni.prototype._setPaintValues=function(e,t,r,c){if(c&&r){var d=c[r.min],g=c[r.mid],x=c[r.max];if(d&&g&&x)for(var A=e;A<t;A++)this.zoomInPaintVertexArray.emplace(A,g.tl[0],g.tl[1],g.br[0],g.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],g.pixelRatio,d.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,g.tl[0],g.tl[1],g.br[0],g.br[1],x.tl[0],x.tl[1],x.br[0],x.br[1],g.pixelRatio,x.pixelRatio)}},Ni.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ke.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ke.members,this.expression.isStateDependent))},Ni.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var $=function(e,t,r){this.binders={},this._buffers=[];var c=[];for(var d in e.paint._values)if(r(d)){var g=e.paint.get(d);if(g instanceof mo&&Rs(g.property.specification)){var x=L(d,e.type),A=g.value,R=g.property.specification.type,j=g.property.useIntegerZoom,J=g.property.specification["property-type"],oe="cross-faded"===J||"cross-faded-data-driven"===J;if("constant"===A.kind)this.binders[d]=oe?new Vi(A.value,x):new gi(A.value,x,R),c.push("/u_"+d);else if("source"===A.kind||oe){var me=D(d,R,"source");this.binders[d]=oe?new Ni(A,R,j,t,me,e.id):new li(A,x,R,me),c.push("/a_"+d)}else{var xe=D(d,R,"composite");this.binders[d]=new yi(A,x,R,j,t,xe),c.push("/z_"+d)}}}this.cacheKey=c.sort().join("")};$.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof li||t instanceof yi?t.maxValue:0},$.prototype.populatePaintArrays=function(e,t,r,c,d){for(var g in this.binders){var x=this.binders[g];(x instanceof li||x instanceof yi||x instanceof Ni)&&x.populatePaintArray(e,t,r,c,d)}},$.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var c=this.binders[r];c instanceof Vi&&c.setConstantPatternPositions(e,t)}},$.prototype.updatePaintArrays=function(e,t,r,c,d){var g=!1;for(var x in e)for(var A=0,R=t.getPositions(x);A<R.length;A+=1){var j=R[A],J=r.feature(j.index);for(var oe in this.binders){var me=this.binders[oe];if((me instanceof li||me instanceof yi||me instanceof Ni)&&!0===me.expression.isStateDependent){var xe=c.paint.get(oe);me.expression=xe.value,me.updatePaintArray(j.start,j.end,J,e[x],d),g=!0}}}return g},$.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof gi||r instanceof Vi)&&e.push.apply(e,r.uniformNames.map(function(c){return"#define HAS_UNIFORM_"+c}))}return e},$.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof li||r instanceof yi)for(var c=0;c<r.paintVertexAttributes.length;c++)e.push(r.paintVertexAttributes[c].name);else if(r instanceof Ni)for(var d=0;d<Ke.members.length;d++)e.push(Ke.members[d].name)}return e},$.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof gi||r instanceof Vi||r instanceof yi)for(var c=0,d=r.uniformNames;c<d.length;c+=1)e.push(d[c])}return e},$.prototype.getPaintVertexBuffers=function(){return this._buffers},$.prototype.getUniforms=function(e,t){var r=[];for(var c in this.binders){var d=this.binders[c];if(d instanceof gi||d instanceof Vi||d instanceof yi)for(var g=0,x=d.uniformNames;g<x.length;g+=1){var A=x[g];if(t[A]){var R=d.getBinding(e,t[A],A);r.push({name:A,property:c,binding:R})}}}return r},$.prototype.setUniforms=function(e,t,r,c){for(var d=0,g=t;d<g.length;d+=1){var x=g[d],A=x.name,R=x.property;this.binders[R].setUniform(x.binding,c,r.get(R),A)}},$.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Ni){var c=2===e.fromScale?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;c&&this._buffers.push(c)}else(r instanceof li||r instanceof yi)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},$.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof li||r instanceof yi||r instanceof Ni)&&r.upload(e)}this.updatePaintBuffers()},$.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof li||t instanceof yi||t instanceof Ni)&&t.destroy()}};var ee=function(e,t,r){void 0===r&&(r=function(){return!0}),this.programConfigurations={};for(var c=0,d=e;c<d.length;c+=1){var g=d[c];this.programConfigurations[g.id]=new $(g,t,r)}this.needsUpload=!1,this._featureMap=new xt,this._bufferOffset=0};function L(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function D(e,t,r){var d={"line-pattern":{source:su,composite:su},"fill-pattern":{source:su,composite:su},"fill-extrusion-pattern":{source:su,composite:su}}[e];return d&&d[r]||{color:{source:al,composite:El},number:{source:Gu,composite:al}}[t][r]}ee.prototype.populatePaintArrays=function(e,t,r,c,d,g){for(var x in this.programConfigurations)this.programConfigurations[x].populatePaintArrays(e,t,c,d,g);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},ee.prototype.updatePaintArrays=function(e,t,r,c){for(var d=0,g=r;d<g.length;d+=1){var x=g[d];this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,t,x,c)||this.needsUpload}},ee.prototype.get=function(e){return this.programConfigurations[e]},ee.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},ee.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},Bn("ConstantBinder",gi),Bn("CrossFadedConstantBinder",Vi),Bn("SourceExpressionBinder",li),Bn("CrossFadedCompositeBinder",Ni),Bn("CompositeExpressionBinder",yi),Bn("ProgramConfiguration",$,{omit:["_buffers"]}),Bn("ProgramConfigurationSet",ee);var fe=Math.pow(2,14)-1,Se=-fe-1;function ct(e){for(var t=8192/e.extent,r=e.loadGeometry(),c=0;c<r.length;c++)for(var d=r[c],g=0;g<d.length;g++){var x=d[g],A=Math.round(x.x*t),R=Math.round(x.y*t);x.x=Z(A,Se,fe),x.y=Z(R,Se,fe),(A<x.x||A>x.x+1||R<x.y||R>x.y+1)&&qe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Pt(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ct(e):[]}}function bt(e,t,r,c,d){e.emplaceBack(2*t+(c+1)/2,2*r+(d+1)/2)}var rr=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new As,this.indexArray=new sl,this.segments=new Ae,this.programConfigurations=new ee(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function jr(e,t){for(var r=0;r<e.length;r++)if(Ha(t,e[r]))return!0;for(var c=0;c<t.length;c++)if(Ha(e,t[c]))return!0;return!!Ci(e,t)}function Mn(e,t,r){return!!Ha(e,t)||!!ea(t,e,r)}function Xn(e,t){if(1===e.length)return ua(t,e[0]);for(var r=0;r<t.length;r++)for(var c=t[r],d=0;d<c.length;d++)if(Ha(e,c[d]))return!0;for(var g=0;g<e.length;g++)if(ua(t,e[g]))return!0;for(var x=0;x<t.length;x++)if(Ci(e,t[x]))return!0;return!1}function ni(e,t,r){if(e.length>1){if(Ci(e,t))return!0;for(var c=0;c<t.length;c++)if(ea(t[c],e,r))return!0}for(var d=0;d<e.length;d++)if(ea(e[d],t,r))return!0;return!1}function Ci(e,t){if(0===e.length||0===t.length)return!1;for(var r=0;r<e.length-1;r++)for(var c=e[r],d=e[r+1],g=0;g<t.length-1;g++)if(wi(c,d,t[g],t[g+1]))return!0;return!1}function wi(e,t,r,c){return Dt(e,r,c)!==Dt(t,r,c)&&Dt(e,t,r)!==Dt(e,t,c)}function ea(e,t,r){var c=r*r;if(1===t.length)return e.distSqr(t[0])<c;for(var d=1;d<t.length;d++)if(xa(e,t[d-1],t[d])<c)return!0;return!1}function xa(e,t,r){var c=t.distSqr(r);if(0===c)return e.distSqr(t);var d=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/c;return e.distSqr(d<0?t:d>1?r:r.sub(t)._mult(d)._add(t))}function ua(e,t){for(var r,c,d,g=!1,x=0;x<e.length;x++)for(var A=0,R=(r=e[x]).length-1;A<r.length;R=A++)(c=r[A]).y>t.y!=(d=r[R]).y>t.y&&t.x<(d.x-c.x)*(t.y-c.y)/(d.y-c.y)+c.x&&(g=!g);return g}function Ha(e,t){for(var r=!1,c=0,d=e.length-1;c<e.length;d=c++){var g=e[c],x=e[d];g.y>t.y!=x.y>t.y&&t.x<(x.x-g.x)*(t.y-g.y)/(x.y-g.y)+g.x&&(r=!r)}return r}function Wa(e,t,r){var c=r[0],d=r[2];if(e.x<c.x&&t.x<c.x||e.x>d.x&&t.x>d.x||e.y<c.y&&t.y<c.y||e.y>d.y&&t.y>d.y)return!1;var g=Dt(e,t,r[0]);return g!==Dt(e,t,r[1])||g!==Dt(e,t,r[2])||g!==Dt(e,t,r[3])}function Ka(e,t,r){var c=t.paint.get(e).value;return"constant"===c.kind?c.value:r.programConfigurations.get(t.id).getMaxValue(e)}function ia(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function ga(e,t,r,c,d){if(!t[0]&&!t[1])return e;var g=q.convert(t)._mult(d);"viewport"===r&&g._rotate(-c);for(var x=[],A=0;A<e.length;A++)x.push(e[A].sub(g));return x}rr.prototype.populate=function(e,t,r){var c=this.layers[0],d=[],g=null;"circle"===c.type&&(g=c.layout.get("circle-sort-key"));for(var x=0,A=e;x<A.length;x+=1){var R=A[x],j=R.feature,J=R.id,oe=R.index,me=R.sourceLayerIndex,xe=this.layers[0]._featureFilter.needGeometry,Ge=Pt(j,xe);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),Ge,r)){var He=g?g.evaluate(Ge,{},r):void 0,gt={id:J,properties:j.properties,type:j.type,sourceLayerIndex:me,index:oe,geometry:xe?Ge.geometry:ct(j),patterns:{},sortKey:He};d.push(gt)}}g&&d.sort(function(vn,ii){return vn.sortKey-ii.sortKey});for(var it=0,Lt=d;it<Lt.length;it+=1){var Ht=Lt[it],fr=Ht.geometry,xr=Ht.index,Lr=Ht.sourceLayerIndex,rn=e[xr].feature;this.addFeature(Ht,fr,xr,r),t.featureIndex.insert(rn,fr,xr,Lr,this.index)}},rr.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},rr.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},rr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rr.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ee),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},rr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},rr.prototype.addFeature=function(e,t,r,c){for(var d=0,g=t;d<g.length;d+=1)for(var x=0,A=g[d];x<A.length;x+=1){var R=A[x],j=R.x,J=R.y;if(!(j<0||j>=8192||J<0||J>=8192)){var oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),me=oe.vertexLength;bt(this.layoutVertexArray,j,J,-1,-1),bt(this.layoutVertexArray,j,J,1,-1),bt(this.layoutVertexArray,j,J,1,1),bt(this.layoutVertexArray,j,J,-1,1),this.indexArray.emplaceBack(me,me+1,me+2),this.indexArray.emplaceBack(me,me+3,me+2),oe.vertexLength+=4,oe.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},c)},Bn("CircleBucket",rr,{omit:["layers"]});var la=new Po({"circle-sort-key":new An(ce.layout_circle["circle-sort-key"])}),no={paint:new Po({"circle-radius":new An(ce.paint_circle["circle-radius"]),"circle-color":new An(ce.paint_circle["circle-color"]),"circle-blur":new An(ce.paint_circle["circle-blur"]),"circle-opacity":new An(ce.paint_circle["circle-opacity"]),"circle-translate":new ri(ce.paint_circle["circle-translate"]),"circle-translate-anchor":new ri(ce.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ri(ce.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ri(ce.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new An(ce.paint_circle["circle-stroke-width"]),"circle-stroke-color":new An(ce.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new An(ce.paint_circle["circle-stroke-opacity"])}),layout:la},Li="undefined"!=typeof Float32Array?Float32Array:Array;function Ca(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ba(e,t,r){var c=t[0],d=t[1],g=t[2],x=t[3],A=t[4],R=t[5],j=t[6],J=t[7],oe=t[8],me=t[9],xe=t[10],Ge=t[11],He=t[12],gt=t[13],it=t[14],Lt=t[15],Ht=r[0],fr=r[1],xr=r[2],Lr=r[3];return e[0]=Ht*c+fr*A+xr*oe+Lr*He,e[1]=Ht*d+fr*R+xr*me+Lr*gt,e[2]=Ht*g+fr*j+xr*xe+Lr*it,e[3]=Ht*x+fr*J+xr*Ge+Lr*Lt,e[4]=(Ht=r[4])*c+(fr=r[5])*A+(xr=r[6])*oe+(Lr=r[7])*He,e[5]=Ht*d+fr*R+xr*me+Lr*gt,e[6]=Ht*g+fr*j+xr*xe+Lr*it,e[7]=Ht*x+fr*J+xr*Ge+Lr*Lt,e[8]=(Ht=r[8])*c+(fr=r[9])*A+(xr=r[10])*oe+(Lr=r[11])*He,e[9]=Ht*d+fr*R+xr*me+Lr*gt,e[10]=Ht*g+fr*j+xr*xe+Lr*it,e[11]=Ht*x+fr*J+xr*Ge+Lr*Lt,e[12]=(Ht=r[12])*c+(fr=r[13])*A+(xr=r[14])*oe+(Lr=r[15])*He,e[13]=Ht*d+fr*R+xr*me+Lr*gt,e[14]=Ht*g+fr*j+xr*xe+Lr*it,e[15]=Ht*x+fr*J+xr*Ge+Lr*Lt,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var go,e,Yl=ba;function uu(e,t,r){var c=t[0],d=t[1],g=t[2],x=t[3];return e[0]=r[0]*c+r[4]*d+r[8]*g+r[12]*x,e[1]=r[1]*c+r[5]*d+r[9]*g+r[13]*x,e[2]=r[2]*c+r[6]*d+r[10]*g+r[14]*x,e[3]=r[3]*c+r[7]*d+r[11]*g+r[15]*x,e}go=new Li(3),Li!=Float32Array&&(go[0]=0,go[1]=0,go[2]=0),e=new Li(4),Li!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0);var Ko=(function(){var e=new Li(2);Li!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,no)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new rr(r)},t.prototype.queryRadius=function(r){var c=r;return Ka("circle-radius",this,c)+Ka("circle-stroke-width",this,c)+ia(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,c,d,g,x,A,R,j){for(var J=ga(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),A.angle,R),oe=this.paint.get("circle-radius").evaluate(c,d)+this.paint.get("circle-stroke-width").evaluate(c,d),me="map"===this.paint.get("circle-pitch-alignment"),xe=me?J:function(rn,vn){return rn.map(function(ii){return wu(ii,vn)})}(J,j),Ge=me?oe*R:oe,He=0,gt=g;He<gt.length;He+=1)for(var it=0,Lt=gt[He];it<Lt.length;it+=1){var Ht=Lt[it],fr=me?Ht:wu(Ht,j),xr=Ge,Lr=uu([],[Ht.x,Ht.y,0,1],j);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?xr*=Lr[3]/A.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(xr*=A.cameraToCenterDistance/Lr[3]),Mn(xe,fr,xr))return!0}return!1},t}(fo));function wu(e,t){var r=uu([],[e.x,e.y,0,1],t);return new q(r[0]/r[3],r[1]/r[3])}var Hu=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(rr);function ul(e,t,r,c){var d=t.width,g=t.height;if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==d*g*r)throw new RangeError("mismatched image size")}else c=new Uint8Array(d*g*r);return e.width=d,e.height=g,e.data=c,e}function Ys(e,t,r){var c=t.width,d=t.height;if(c!==e.width||d!==e.height){var g=ul({},{width:c,height:d},r);Kl(e,g,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,c),height:Math.min(e.height,d)},r),e.width=c,e.height=d,e.data=g.data}}function Kl(e,t,r,c,d,g){if(0===d.width||0===d.height)return t;if(d.width>e.width||d.height>e.height||r.x>e.width-d.width||r.y>e.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||c.x>t.width-d.width||c.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");for(var x=e.data,A=t.data,R=0;R<d.height;R++)for(var j=((r.y+R)*e.width+r.x)*g,J=((c.y+R)*t.width+c.x)*g,oe=0;oe<d.width*g;oe++)A[J+oe]=x[j+oe];return t}Bn("HeatmapBucket",Hu,{omit:["layers"]});var Wu=function(e,t){ul(this,e,1,t)};Wu.prototype.resize=function(e){Ys(this,e,1)},Wu.prototype.clone=function(){return new Wu({width:this.width,height:this.height},new Uint8Array(this.data))},Wu.copy=function(e,t,r,c,d){Kl(e,t,r,c,d,1)};var ca=function(e,t){ul(this,e,4,t)};ca.prototype.resize=function(e){Ys(this,e,4)},ca.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},ca.prototype.clone=function(){return new ca({width:this.width,height:this.height},new Uint8Array(this.data))},ca.copy=function(e,t,r,c,d){Kl(e,t,r,c,d,4)},Bn("AlphaImage",Wu),Bn("RGBAImage",ca);var Hf={paint:new Po({"heatmap-radius":new An(ce.paint_heatmap["heatmap-radius"]),"heatmap-weight":new An(ce.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ri(ce.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Xs(ce.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ri(ce.paint_heatmap["heatmap-opacity"])})};function Tl(e){var t={},r=e.resolution||256,c=e.clips?e.clips.length:1,d=e.image||new ca({width:r,height:c}),g=function(Ge,He,gt){t[e.evaluationKey]=gt;var it=e.expression.evaluate(t);d.data[Ge+He+0]=Math.floor(255*it.r/it.a),d.data[Ge+He+1]=Math.floor(255*it.g/it.a),d.data[Ge+He+2]=Math.floor(255*it.b/it.a),d.data[Ge+He+3]=Math.floor(255*it.a)};if(e.clips)for(var x=0,A=0;x<c;++x,A+=4*r)for(var R=0,j=0;R<r;R++,j+=4){var J=R/(r-1),oe=e.clips[x];g(A,j,oe.start*(1-J)+oe.end*J)}else for(var me=0,xe=0;me<r;me++,xe+=4)g(0,xe,me/(r-1));return d}var Wf=function(e){function t(r){e.call(this,r,Hf),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Hu(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){"heatmap-color"===r&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=Tl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},t}(fo),Ks={paint:new Po({"hillshade-illumination-direction":new ri(ce.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ri(ce.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ri(ce.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ri(ce.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ri(ce.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ri(ce.paint_hillshade["hillshade-accent-color"])})},xh=function(e){function t(r){e.call(this,r,Ks)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},t}(fo),Dc=zo([{name:"a_pos",components:2,type:"Int16"}],4).members,hc=Cf,Sp=Cf;function Cf(e,t,r){r=r||2;var c,d,g,x,A,R,j,J=t&&t.length,oe=J?t[0]*r:e.length,me=Xf(e,0,oe,r,!0),xe=[];if(!me||me.next===me.prev)return xe;if(J&&(me=function(He,gt,it,Lt){var Ht,fr,xr,Lr=[];for(Ht=0,fr=gt.length;Ht<fr;Ht++)(xr=Xf(He,gt[Ht]*Lt,Ht<fr-1?gt[Ht+1]*Lt:He.length,Lt,!1))===xr.next&&(xr.steiner=!0),Lr.push(tp(xr));for(Lr.sort(ep),Ht=0;Ht<Lr.length;Ht++)qs(Lr[Ht],it),it=ll(it,it.next);return it}(e,t,me,r)),e.length>80*r){c=g=e[0],d=x=e[1];for(var Ge=r;Ge<oe;Ge+=r)(A=e[Ge])<c&&(c=A),(R=e[Ge+1])<d&&(d=R),A>g&&(g=A),R>x&&(x=R);j=0!==(j=Math.max(g-c,x-d))?1/j:0}return qc(me,xe,r,c,d,j),xe}function Xf(e,t,r,c,d){var g,x;if(d===Mu(e,t,r,c)>0)for(g=t;g<r;g+=c)x=Pf(g,e[g],e[g+1],x);else for(g=r-c;g>=t;g-=c)x=Pf(g,e[g],e[g+1],x);return x&&pc(x,x.next)&&(Fc(x),x=x.next),x}function ll(e,t){if(!e)return e;t||(t=e);var r,c=e;do{if(r=!1,c.steiner||!pc(c,c.next)&&0!==Eo(c.prev,c,c.next))c=c.next;else{if(Fc(c),(c=t=c.prev)===c.next)break;r=!0}}while(r||c!==t);return t}function qc(e,t,r,c,d,g,x){if(e){!x&&g&&function(J,oe,me,xe){var Ge=J;do{null===Ge.z&&(Ge.z=wh(Ge.x,Ge.y,oe,me,xe)),Ge.prevZ=Ge.prev,Ge.nextZ=Ge.next,Ge=Ge.next}while(Ge!==J);Ge.prevZ.nextZ=null,Ge.prevZ=null,function(He){var gt,it,Lt,Ht,fr,xr,Lr,rn,vn=1;do{for(it=He,He=null,fr=null,xr=0;it;){for(xr++,Lt=it,Lr=0,gt=0;gt<vn&&(Lr++,Lt=Lt.nextZ);gt++);for(rn=vn;Lr>0||rn>0&&Lt;)0!==Lr&&(0===rn||!Lt||it.z<=Lt.z)?(Ht=it,it=it.nextZ,Lr--):(Ht=Lt,Lt=Lt.nextZ,rn--),fr?fr.nextZ=Ht:He=Ht,Ht.prevZ=fr,fr=Ht;it=Lt}fr.nextZ=null,vn*=2}while(xr>1)}(Ge)}(e,c,d,g);for(var A,R,j=e;e.prev!==e.next;)if(A=e.prev,R=e.next,g?hf(e,c,d,g):$h(e))t.push(A.i/r),t.push(e.i/r),t.push(R.i/r),Fc(e),e=R.next,j=R.next;else if((e=R)===j){x?1===x?qc(e=bh(ll(e),t,r),t,r,c,d,g,2):2===x&&Qh(e,t,r,c,d,g):qc(ll(e),t,r,c,d,g,1);break}}}function $h(e){var t=e.prev,r=e,c=e.next;if(Eo(t,r,c)>=0)return!1;for(var d=e.next.next;d!==e.prev;){if(Jc(t.x,t.y,r.x,r.y,c.x,c.y,d.x,d.y)&&Eo(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function hf(e,t,r,c){var d=e.prev,g=e,x=e.next;if(Eo(d,g,x)>=0)return!1;for(var A=d.x>g.x?d.x>x.x?d.x:x.x:g.x>x.x?g.x:x.x,R=d.y>g.y?d.y>x.y?d.y:x.y:g.y>x.y?g.y:x.y,j=wh(d.x<g.x?d.x<x.x?d.x:x.x:g.x<x.x?g.x:x.x,d.y<g.y?d.y<x.y?d.y:x.y:g.y<x.y?g.y:x.y,t,r,c),J=wh(A,R,t,r,c),oe=e.prevZ,me=e.nextZ;oe&&oe.z>=j&&me&&me.z<=J;){if(oe!==e.prev&&oe!==e.next&&Jc(d.x,d.y,g.x,g.y,x.x,x.y,oe.x,oe.y)&&Eo(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,me!==e.prev&&me!==e.next&&Jc(d.x,d.y,g.x,g.y,x.x,x.y,me.x,me.y)&&Eo(me.prev,me,me.next)>=0))return!1;me=me.nextZ}for(;oe&&oe.z>=j;){if(oe!==e.prev&&oe!==e.next&&Jc(d.x,d.y,g.x,g.y,x.x,x.y,oe.x,oe.y)&&Eo(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;me&&me.z<=J;){if(me!==e.prev&&me!==e.next&&Jc(d.x,d.y,g.x,g.y,x.x,x.y,me.x,me.y)&&Eo(me.prev,me,me.next)>=0)return!1;me=me.nextZ}return!0}function bh(e,t,r){var c=e;do{var d=c.prev,g=c.next.next;!pc(d,g)&&Sh(d,c,c.next,g)&&Bc(d,g)&&Bc(g,d)&&(t.push(d.i/r),t.push(c.i/r),t.push(g.i/r),Fc(c),Fc(c.next),c=e=g),c=c.next}while(c!==e);return ll(c)}function Qh(e,t,r,c,d,g){var x=e;do{for(var A=x.next.next;A!==x.prev;){if(x.i!==A.i&&Tp(x,A)){var R=pf(x,A);return x=ll(x,x.next),R=ll(R,R.next),qc(x,t,r,c,d,g),void qc(R,t,r,c,d,g)}A=A.next}x=x.next}while(x!==e)}function ep(e,t){return e.x-t.x}function qs(e,t){if(t=function(c,d){var g,x=d,A=c.x,R=c.y,j=-1/0;do{if(R<=x.y&&R>=x.next.y&&x.next.y!==x.y){var J=x.x+(R-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(J<=A&&J>j){if(j=J,J===A){if(R===x.y)return x;if(R===x.next.y)return x.next}g=x.x<x.next.x?x:x.next}}x=x.next}while(x!==d);if(!g)return null;if(A===j)return g;var oe,me=g,xe=g.x,Ge=g.y,He=1/0;x=g;do{A>=x.x&&x.x>=xe&&A!==x.x&&Jc(R<Ge?A:j,R,xe,Ge,R<Ge?j:A,R,x.x,x.y)&&(oe=Math.abs(R-x.y)/(A-x.x),Bc(x,c)&&(oe<He||oe===He&&(x.x>g.x||x.x===g.x&&Ep(g,x)))&&(g=x,He=oe)),x=x.next}while(x!==me);return g}(e,t)){var r=pf(t,e);ll(t,t.next),ll(r,r.next)}}function Ep(e,t){return Eo(e.prev,e,t.prev)<0&&Eo(t.next,e,e.next)<0}function wh(e,t,r,c,d){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*d)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-c)*d)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function tp(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function Jc(e,t,r,c,d,g,x,A){return(d-x)*(t-A)-(e-x)*(g-A)>=0&&(e-x)*(c-A)-(r-x)*(t-A)>=0&&(r-x)*(g-A)-(d-x)*(c-A)>=0}function Tp(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,c){var d=r;do{if(d.i!==r.i&&d.next.i!==r.i&&d.i!==c.i&&d.next.i!==c.i&&Sh(d,d.next,r,c))return!0;d=d.next}while(d!==r);return!1}(e,t)&&(Bc(e,t)&&Bc(t,e)&&function(r,c){var d=r,g=!1,x=(r.x+c.x)/2,A=(r.y+c.y)/2;do{d.y>A!=d.next.y>A&&d.next.y!==d.y&&x<(d.next.x-d.x)*(A-d.y)/(d.next.y-d.y)+d.x&&(g=!g),d=d.next}while(d!==r);return g}(e,t)&&(Eo(e.prev,e,t.prev)||Eo(e,t.prev,t))||pc(e,t)&&Eo(e.prev,e,e.next)>0&&Eo(t.prev,t,t.next)>0)}function Eo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function pc(e,t){return e.x===t.x&&e.y===t.y}function Sh(e,t,r,c){var d=$c(Eo(e,t,r)),g=$c(Eo(e,t,c)),x=$c(Eo(r,c,e)),A=$c(Eo(r,c,t));return d!==g&&x!==A||!(0!==d||!Af(e,r,t))||!(0!==g||!Af(e,c,t))||!(0!==x||!Af(r,e,c))||!(0!==A||!Af(r,t,c))}function Af(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function $c(e){return e>0?1:e<0?-1:0}function Bc(e,t){return Eo(e.prev,e,e.next)<0?Eo(e,t,e.next)>=0&&Eo(e,e.prev,t)>=0:Eo(e,t,e.prev)<0||Eo(e,e.next,t)<0}function pf(e,t){var r=new df(e.i,e.x,e.y),c=new df(t.i,t.x,t.y),d=e.next,g=t.prev;return e.next=t,t.prev=e,r.next=d,d.prev=r,c.next=r,r.prev=c,g.next=c,c.prev=g,c}function Pf(e,t,r,c){var d=new df(e,t,r);return c?(d.next=c.next,d.prev=c,c.next.prev=d,c.next=d):(d.prev=d,d.next=d),d}function Fc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function df(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Mu(e,t,r,c){for(var d=0,g=t,x=r-c;g<r;g+=c)d+=(e[x]-e[g])*(e[g+1]+e[x+1]),x=g;return d}function Yf(e,t,r,c,d){!function g(x,A,R,j,J){for(;j>R;){if(j-R>600){var oe=j-R+1,me=A-R+1,xe=Math.log(oe),Ge=.5*Math.exp(2*xe/3),He=.5*Math.sqrt(xe*Ge*(oe-Ge)/oe)*(me-oe/2<0?-1:1);g(x,A,Math.max(R,Math.floor(A-me*Ge/oe+He)),Math.min(j,Math.floor(A+(oe-me)*Ge/oe+He)),J)}var gt=x[A],it=R,Lt=j;for(Cl(x,R,A),J(x[j],gt)>0&&Cl(x,R,j);it<Lt;){for(Cl(x,it,Lt),it++,Lt--;J(x[it],gt)<0;)it++;for(;J(x[Lt],gt)>0;)Lt--}0===J(x[R],gt)?Cl(x,R,Lt):Cl(x,++Lt,j),Lt<=A&&(R=Lt+1),A<=Lt&&(j=Lt-1)}}(e,t,r||0,c||e.length-1,d||Eh)}function Cl(e,t,r){var c=e[t];e[t]=e[r],e[r]=c}function Eh(e,t){return e<t?-1:e>t?1:0}function Mf(e,t){var r=e.length;if(r<=1)return[e];for(var c,d,g=[],x=0;x<r;x++){var A=lr(e[x]);0!==A&&(e[x].area=Math.abs(A),void 0===d&&(d=A<0),d===A<0?(c&&g.push(c),c=[e[x]]):c.push(e[x]))}if(c&&g.push(c),t>1)for(var R=0;R<g.length;R++)g[R].length<=t||(Yf(g[R],t,1,g[R].length-1,If),g[R]=g[R].slice(0,t));return g}function If(e,t){return t.area-e.area}function Qc(e,t,r){for(var c=r.patternDependencies,d=!1,g=0,x=t;g<x.length;g+=1){var A=x[g].paint.get(e+"-pattern");A.isConstant()||(d=!0);var R=A.constantOr(null);R&&(d=!0,c[R.to]=!0,c[R.from]=!0)}return d}function vf(e,t,r,c,d){for(var g=d.patternDependencies,x=0,A=t;x<A.length;x+=1){var R=A[x],j=R.paint.get(e+"-pattern").value;if("constant"!==j.kind){var J=j.evaluate({zoom:c-1},r,{},d.availableImages),oe=j.evaluate({zoom:c},r,{},d.availableImages),me=j.evaluate({zoom:c+1},r,{},d.availableImages);oe=oe&&oe.name?oe.name:oe,me=me&&me.name?me.name:me,g[J=J&&J.name?J.name:J]=!0,g[oe]=!0,g[me]=!0,r.patterns[R.id]={min:J,mid:oe,max:me}}}return r}Cf.deviation=function(e,t,r,c){var d=t&&t.length,g=Math.abs(Mu(e,0,d?t[0]*r:e.length,r));if(d)for(var x=0,A=t.length;x<A;x++)g-=Math.abs(Mu(e,t[x]*r,x<A-1?t[x+1]*r:e.length,r));var R=0;for(x=0;x<c.length;x+=3){var j=c[x]*r,J=c[x+1]*r,oe=c[x+2]*r;R+=Math.abs((e[j]-e[oe])*(e[J+1]-e[j+1])-(e[j]-e[J])*(e[oe+1]-e[j+1]))}return 0===g&&0===R?0:Math.abs((R-g)/g)},Cf.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},c=0,d=0;d<e.length;d++){for(var g=0;g<e[d].length;g++)for(var x=0;x<t;x++)r.vertices.push(e[d][g][x]);d>0&&r.holes.push(c+=e[d-1].length)}return r},hc.default=Sp;var Ns=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new As,this.indexArray=new sl,this.indexArray2=new cc,this.programConfigurations=new ee(e.layers,e.zoom),this.segments=new Ae,this.segments2=new Ae,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};Ns.prototype.populate=function(e,t,r){this.hasPattern=Qc("fill",this.layers,t);for(var c=this.layers[0].layout.get("fill-sort-key"),d=[],g=0,x=e;g<x.length;g+=1){var A=x[g],R=A.feature,j=A.id,J=A.index,oe=A.sourceLayerIndex,me=this.layers[0]._featureFilter.needGeometry,xe=Pt(R,me);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),xe,r)){var Ge=c?c.evaluate(xe,{},r,t.availableImages):void 0,He={id:j,properties:R.properties,type:R.type,sourceLayerIndex:oe,index:J,geometry:me?xe.geometry:ct(R),patterns:{},sortKey:Ge};d.push(He)}}c&&d.sort(function(rn,vn){return rn.sortKey-vn.sortKey});for(var gt=0,it=d;gt<it.length;gt+=1){var Lt=it[gt],Ht=Lt.geometry,fr=Lt.index,xr=Lt.sourceLayerIndex;if(this.hasPattern){var Lr=vf("fill",this.layers,Lt,this.zoom,t);this.patternFeatures.push(Lr)}else this.addFeature(Lt,Ht,fr,r,{});t.featureIndex.insert(e[fr].feature,Ht,fr,xr,this.index)}},Ns.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ns.prototype.addFeatures=function(e,t,r){for(var c=0,d=this.patternFeatures;c<d.length;c+=1){var g=d[c];this.addFeature(g,g.geometry,g.index,t,r)}},Ns.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ns.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ns.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Dc),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},Ns.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Ns.prototype.addFeature=function(e,t,r,c,d){for(var g=0,x=Mf(t,500);g<x.length;g+=1){for(var A=x[g],R=0,j=0,J=A;j<J.length;j+=1)R+=J[j].length;for(var oe=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray),me=oe.vertexLength,xe=[],Ge=[],He=0,gt=A;He<gt.length;He+=1){var it=gt[He];if(0!==it.length){it!==A[0]&&Ge.push(xe.length/2);var Lt=this.segments2.prepareSegment(it.length,this.layoutVertexArray,this.indexArray2),Ht=Lt.vertexLength;this.layoutVertexArray.emplaceBack(it[0].x,it[0].y),this.indexArray2.emplaceBack(Ht+it.length-1,Ht),xe.push(it[0].x),xe.push(it[0].y);for(var fr=1;fr<it.length;fr++)this.layoutVertexArray.emplaceBack(it[fr].x,it[fr].y),this.indexArray2.emplaceBack(Ht+fr-1,Ht+fr),xe.push(it[fr].x),xe.push(it[fr].y);Lt.vertexLength+=it.length,Lt.primitiveLength+=it.length}}for(var xr=hc(xe,Ge),Lr=0;Lr<xr.length;Lr+=3)this.indexArray.emplaceBack(me+xr[Lr],me+xr[Lr+1],me+xr[Lr+2]);oe.vertexLength+=R,oe.primitiveLength+=xr.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,c)},Bn("FillBucket",Ns,{omit:["layers","patternFeatures"]});var Kf=new Po({"fill-sort-key":new An(ce.layout_fill["fill-sort-key"])}),_s={paint:new Po({"fill-antialias":new ri(ce.paint_fill["fill-antialias"]),"fill-opacity":new An(ce.paint_fill["fill-opacity"]),"fill-color":new An(ce.paint_fill["fill-color"]),"fill-outline-color":new An(ce.paint_fill["fill-outline-color"]),"fill-translate":new ri(ce.paint_fill["fill-translate"]),"fill-translate-anchor":new ri(ce.paint_fill["fill-translate-anchor"]),"fill-pattern":new lc(ce.paint_fill["fill-pattern"])}),layout:Kf},ql=function(e){function t(r){e.call(this,r,_s)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,c){e.prototype.recalculate.call(this,r,c);var d=this.paint._values["fill-outline-color"];"constant"===d.value.kind&&void 0===d.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new Ns(r)},t.prototype.queryRadius=function(){return ia(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,c,d,g,x,A,R){return Xn(ga(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),A.angle,R),g)},t.prototype.isTileClipped=function(){return!0},t}(fo),mf=zo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,ef=Js;function Js(e,t,r,c,d){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=c,this._values=d,e.readFields(Of,this,t)}function Of(e,t,r){1==e?t.id=r.readVarint():2==e?function(c,d){for(var g=c.readVarint()+c.pos;c.pos<g;){var x=d._keys[c.readVarint()],A=d._values[c.readVarint()];d.properties[x]=A}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function qf(e){for(var t,r,c=0,d=0,g=e.length,x=g-1;d<g;x=d++)c+=((r=e[x]).x-(t=e[d]).x)*(t.y+r.y);return c}Js.types=["Unknown","Point","LineString","Polygon"],Js.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,c=1,d=0,g=0,x=0,A=[];e.pos<r;){if(d<=0){var R=e.readVarint();c=7&R,d=R>>3}if(d--,1===c||2===c)g+=e.readSVarint(),x+=e.readSVarint(),1===c&&(t&&A.push(t),t=[]),t.push(new q(g,x));else{if(7!==c)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&A.push(t),A},Js.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,c=0,d=0,g=0,x=1/0,A=-1/0,R=1/0,j=-1/0;e.pos<t;){if(c<=0){var J=e.readVarint();r=7&J,c=J>>3}if(c--,1===r||2===r)(d+=e.readSVarint())<x&&(x=d),d>A&&(A=d),(g+=e.readSVarint())<R&&(R=g),g>j&&(j=g);else if(7!==r)throw new Error("unknown command "+r)}return[x,R,A,j]},Js.prototype.toGeoJSON=function(e,t,r){var c,d,g=this.extent*Math.pow(2,r),x=this.extent*e,A=this.extent*t,R=this.loadGeometry(),j=Js.types[this.type];function J(xe){for(var Ge=0;Ge<xe.length;Ge++){var He=xe[Ge];xe[Ge]=[360*(He.x+x)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(He.y+A)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var oe=[];for(c=0;c<R.length;c++)oe[c]=R[c][0];J(R=oe);break;case 2:for(c=0;c<R.length;c++)J(R[c]);break;case 3:for(R=function(xe){var Ge=xe.length;if(Ge<=1)return[xe];for(var He,gt,it=[],Lt=0;Lt<Ge;Lt++){var Ht=qf(xe[Lt]);0!==Ht&&(void 0===gt&&(gt=Ht<0),gt===Ht<0?(He&&it.push(He),He=[xe[Lt]]):He.push(xe[Lt]))}return He&&it.push(He),it}(R),c=0;c<R.length;c++)for(d=0;d<R[c].length;d++)J(R[c][d])}1===R.length?R=R[0]:j="Multi"+j;var me={type:"Feature",geometry:{type:j,coordinates:R},properties:this.properties};return"id"in this&&(me.id=this.id),me};var Cp=rp;function rp(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(tf,this,t),this.length=this._features.length}function tf(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(c){for(var d=null,g=c.readVarint()+c.pos;c.pos<g;){var x=c.readVarint()>>3;d=1===x?c.readString():2===x?c.readFloat():3===x?c.readDouble():4===x?c.readVarint64():5===x?c.readVarint():6===x?c.readSVarint():7===x?c.readBoolean():null}return d}(r))}function rf(e,t,r){if(3===e){var c=new Cp(r,r.readVarint()+r.pos);c.length&&(t[c.name]=c)}}rp.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new ef(this._pbf,t,this.extent,this._keys,this._values)};var gf={VectorTile:function(e,t){this.layers=e.readFields(rf,{},t)},VectorTileFeature:ef,VectorTileLayer:Cp},Th=gf.VectorTileFeature.types,Jf=Math.pow(2,13);function lu(e,t,r,c,d,g,x,A){e.emplaceBack(t,r,2*Math.floor(c*Jf)+x,d*Jf*2,g*Jf*2,Math.round(A))}var Ps=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ys,this.indexArray=new sl,this.programConfigurations=new ee(e.layers,e.zoom),this.segments=new Ae,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function Nc(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ps.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=Qc("fill-extrusion",this.layers,t);for(var c=0,d=e;c<d.length;c+=1){var g=d[c],x=g.feature,A=g.id,R=g.index,j=g.sourceLayerIndex,J=this.layers[0]._featureFilter.needGeometry,oe=Pt(x,J);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),oe,r)){var me={id:A,sourceLayerIndex:j,index:R,geometry:J?oe.geometry:ct(x),properties:x.properties,type:x.type,patterns:{}};this.hasPattern?this.features.push(vf("fill-extrusion",this.layers,me,this.zoom,t)):this.addFeature(me,me.geometry,R,r,{}),t.featureIndex.insert(x,me.geometry,R,j,this.index,!0)}}},Ps.prototype.addFeatures=function(e,t,r){for(var c=0,d=this.features;c<d.length;c+=1){var g=d[c];this.addFeature(g,g.geometry,g.index,t,r)}},Ps.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ps.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ps.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ps.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mf),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ps.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ps.prototype.addFeature=function(e,t,r,c,d){for(var g=0,x=Mf(t,500);g<x.length;g+=1){for(var A=x[g],R=0,j=0,J=A;j<J.length;j+=1)R+=J[j].length;for(var oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),me=0,xe=A;me<xe.length;me+=1){var Ge=xe[me];if(0!==Ge.length&&!((da=Ge).every(function(Ki){return Ki.x<0})||da.every(function(Ki){return Ki.x>8192})||da.every(function(Ki){return Ki.y<0})||da.every(function(Ki){return Ki.y>8192})))for(var He=0,gt=0;gt<Ge.length;gt++){var it=Ge[gt];if(gt>=1){var Lt=Ge[gt-1];if(!Nc(it,Lt)){oe.vertexLength+4>Ae.MAX_VERTEX_ARRAY_LENGTH&&(oe=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Ht=it.sub(Lt)._perp()._unit(),fr=Lt.dist(it);He+fr>32768&&(He=0),lu(this.layoutVertexArray,it.x,it.y,Ht.x,Ht.y,0,0,He),lu(this.layoutVertexArray,it.x,it.y,Ht.x,Ht.y,0,1,He),lu(this.layoutVertexArray,Lt.x,Lt.y,Ht.x,Ht.y,0,0,He+=fr),lu(this.layoutVertexArray,Lt.x,Lt.y,Ht.x,Ht.y,0,1,He);var xr=oe.vertexLength;this.indexArray.emplaceBack(xr,xr+2,xr+1),this.indexArray.emplaceBack(xr+1,xr+2,xr+3),oe.vertexLength+=4,oe.primitiveLength+=2}}}}if(oe.vertexLength+R>Ae.MAX_VERTEX_ARRAY_LENGTH&&(oe=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray)),"Polygon"===Th[e.type]){for(var Lr=[],rn=[],vn=oe.vertexLength,ii=0,Dn=A;ii<Dn.length;ii+=1){var fi=Dn[ii];if(0!==fi.length){fi!==A[0]&&rn.push(Lr.length/2);for(var Nn=0;Nn<fi.length;Nn++){var na=fi[Nn];lu(this.layoutVertexArray,na.x,na.y,0,0,1,1,0),Lr.push(na.x),Lr.push(na.y)}}}for(var Si=hc(Lr,rn),Qn=0;Qn<Si.length;Qn+=3)this.indexArray.emplaceBack(vn+Si[Qn],vn+Si[Qn+2],vn+Si[Qn+1]);oe.primitiveLength+=Si.length/3,oe.vertexLength+=R}}var da;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,c)},Bn("FillExtrusionBucket",Ps,{omit:["layers","features"]});var Iu={paint:new Po({"fill-extrusion-opacity":new ri(ce["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new An(ce["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ri(ce["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ri(ce["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lc(ce["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new An(ce["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new An(ce["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ri(ce["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Ch=function(e){function t(r){e.call(this,r,Iu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Ps(r)},t.prototype.queryRadius=function(){return ia(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,c,d,g,x,A,R,j){var J=ga(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),A.angle,R),oe=this.paint.get("fill-extrusion-height").evaluate(c,d),me=this.paint.get("fill-extrusion-base").evaluate(c,d),xe=function(He,gt,it,Lt){for(var Ht=[],fr=0,xr=He;fr<xr.length;fr+=1){var Lr=xr[fr],rn=[Lr.x,Lr.y,0,1];uu(rn,rn,gt),Ht.push(new q(rn[0]/rn[3],rn[1]/rn[3]))}return Ht}(J,j),Ge=function(He,gt,it,Lt){for(var Ht=[],fr=[],xr=Lt[8]*gt,Lr=Lt[9]*gt,rn=Lt[10]*gt,vn=Lt[11]*gt,ii=Lt[8]*it,Dn=Lt[9]*it,fi=Lt[10]*it,Nn=Lt[11]*it,na=0,Si=He;na<Si.length;na+=1){for(var Qn=[],da=[],Ki=0,Aa=Si[na];Ki<Aa.length;Ki+=1){var di=Aa[Ki],Ra=di.x,Co=di.y,Ao=Lt[0]*Ra+Lt[4]*Co+Lt[12],Do=Lt[1]*Ra+Lt[5]*Co+Lt[13],ho=Lt[2]*Ra+Lt[6]*Co+Lt[14],Oo=Lt[3]*Ra+Lt[7]*Co+Lt[15],xs=ho+rn,bs=Oo+vn,fu=Ao+ii,Is=Do+Dn,hu=ho+fi,Bo=Oo+Nn,Os=new q((Ao+xr)/bs,(Do+Lr)/bs);Os.z=xs/bs,Qn.push(Os);var wa=new q(fu/Bo,Is/Bo);wa.z=hu/Bo,da.push(wa)}Ht.push(Qn),fr.push(da)}return[Ht,fr]}(g,me,oe,j);return function(He,gt,it){var Lt=1/0;Xn(it,gt)&&(Lt=Jl(it,gt[0]));for(var Ht=0;Ht<gt.length;Ht++)for(var fr=gt[Ht],xr=He[Ht],Lr=0;Lr<fr.length-1;Lr++){var rn=fr[Lr],vn=[rn,fr[Lr+1],xr[Lr+1],xr[Lr],rn];jr(it,vn)&&(Lt=Math.min(Lt,Jl(it,vn)))}return Lt!==1/0&&Lt}(Ge[0],Ge[1],xe)},t}(fo);function Al(e,t){return e.x*t.x+e.y*t.y}function Jl(e,t){if(1===e.length){for(var r,c=0,d=t[c++];!r||d.equals(r);)if(!(r=t[c++]))return 1/0;for(;c<t.length;c++){var g=t[c],x=e[0],A=r.sub(d),R=g.sub(d),j=x.sub(d),J=Al(A,A),oe=Al(A,R),me=Al(R,R),xe=Al(j,A),Ge=Al(j,R),He=J*me-oe*oe,gt=(me*xe-oe*Ge)/He,it=(J*Ge-oe*xe)/He,Lt=d.z*(1-gt-it)+r.z*gt+g.z*it;if(isFinite(Lt))return Lt}return 1/0}for(var Ht=1/0,fr=0,xr=t;fr<xr.length;fr+=1)Ht=Math.min(Ht,xr[fr].z);return Ht}var Ah=zo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,$f=zo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,yf=gf.VectorTileFeature.types,kf=Math.cos(Math.PI/180*37.5),as=Math.pow(2,14)/.5,Zo=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){t.gradients[r.id]={}}),this.layoutVertexArray=new is,this.layoutVertexArray2=new al,this.indexArray=new sl,this.programConfigurations=new ee(e.layers,e.zoom),this.segments=new Ae,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};Zo.prototype.populate=function(e,t,r){this.hasPattern=Qc("line",this.layers,t);for(var c=this.layers[0].layout.get("line-sort-key"),d=[],g=0,x=e;g<x.length;g+=1){var A=x[g],R=A.feature,j=A.id,J=A.index,oe=A.sourceLayerIndex,me=this.layers[0]._featureFilter.needGeometry,xe=Pt(R,me);if(this.layers[0]._featureFilter.filter(new $i(this.zoom),xe,r)){var Ge=c?c.evaluate(xe,{},r):void 0,He={id:j,properties:R.properties,type:R.type,sourceLayerIndex:oe,index:J,geometry:me?xe.geometry:ct(R),patterns:{},sortKey:Ge};d.push(He)}}c&&d.sort(function(rn,vn){return rn.sortKey-vn.sortKey});for(var gt=0,it=d;gt<it.length;gt+=1){var Lt=it[gt],Ht=Lt.geometry,fr=Lt.index,xr=Lt.sourceLayerIndex;if(this.hasPattern){var Lr=vf("line",this.layers,Lt,this.zoom,t);this.patternFeatures.push(Lr)}else this.addFeature(Lt,Ht,fr,r,{});t.featureIndex.insert(e[fr].feature,Ht,fr,xr,this.index)}},Zo.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Zo.prototype.addFeatures=function(e,t,r){for(var c=0,d=this.patternFeatures;c<d.length;c+=1){var g=d[c];this.addFeature(g,g.geometry,g.index,t,r)}},Zo.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Zo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zo.prototype.upload=function(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,$f)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ah),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Zo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zo.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},Zo.prototype.addFeature=function(e,t,r,c,d){var g=this.layers[0].layout,x=g.get("line-join").evaluate(e,{}),A=g.get("line-cap"),R=g.get("line-miter-limit"),j=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var J=0,oe=t;J<oe.length;J+=1)this.addLine(oe[J],e,x,A,R,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,d,c)},Zo.prototype.addLine=function(e,t,r,c,d,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var A="Polygon"===yf[t.type],R=e.length;R>=2&&e[R-1].equals(e[R-2]);)R--;for(var j=0;j<R-1&&e[j].equals(e[j+1]);)j++;if(!(R<(A?3:2))){"bevel"===r&&(d=1.05);var J,oe=this.overscaling<=16?122880/(512*this.overscaling):0,me=this.segments.prepareSegment(10*R,this.layoutVertexArray,this.indexArray),xe=void 0,Ge=void 0,He=void 0,gt=void 0;this.e1=this.e2=-1,A&&(gt=e[j].sub(J=e[R-2])._unit()._perp());for(var it=j;it<R;it++)if(!(Ge=it===R-1?A?e[j+1]:void 0:e[it+1])||!e[it].equals(Ge)){gt&&(He=gt),J&&(xe=J),J=e[it],gt=Ge?Ge.sub(J)._unit()._perp():He;var Lt=(He=He||gt).add(gt);0===Lt.x&&0===Lt.y||Lt._unit();var Ht=He.x*gt.x+He.y*gt.y,fr=Lt.x*gt.x+Lt.y*gt.y,xr=0!==fr?1/fr:1/0,Lr=2*Math.sqrt(2-2*fr),rn=fr<kf&&xe&&Ge,vn=He.x*gt.y-He.y*gt.x>0;if(rn&&it>j){var ii=J.dist(xe);if(ii>2*oe){var Dn=J.sub(J.sub(xe)._mult(oe/ii)._round());this.updateDistance(xe,Dn),this.addCurrentVertex(Dn,He,0,0,me),xe=Dn}}var fi=xe&&Ge,Nn=fi?r:A?"butt":c;if(fi&&"round"===Nn&&(xr<g?Nn="miter":xr<=2&&(Nn="fakeround")),"miter"===Nn&&xr>d&&(Nn="bevel"),"bevel"===Nn&&(xr>2&&(Nn="flipbevel"),xr<d&&(Nn="miter")),xe&&this.updateDistance(xe,J),"miter"===Nn)Lt._mult(xr),this.addCurrentVertex(J,Lt,0,0,me);else if("flipbevel"===Nn){if(xr>100)Lt=gt.mult(-1);else{var na=xr*He.add(gt).mag()/He.sub(gt).mag();Lt._perp()._mult(na*(vn?-1:1))}this.addCurrentVertex(J,Lt,0,0,me),this.addCurrentVertex(J,Lt.mult(-1),0,0,me)}else if("bevel"===Nn||"fakeround"===Nn){var Si=-Math.sqrt(xr*xr-1),Qn=vn?Si:0,da=vn?0:Si;if(xe&&this.addCurrentVertex(J,He,Qn,da,me),"fakeround"===Nn)for(var Ki=Math.round(180*Lr/Math.PI/20),Aa=1;Aa<Ki;Aa++){var di=Aa/Ki;if(.5!==di){var Ra=di-.5;di+=di*Ra*(di-1)*((1.0904+Ht*(Ht*(3.55645-1.43519*Ht)-3.2452))*Ra*Ra+(.848013+Ht*(.215638*Ht-1.06021)))}var Co=gt.sub(He)._mult(di)._add(He)._unit()._mult(vn?-1:1);this.addHalfVertex(J,Co.x,Co.y,!1,vn,0,me)}Ge&&this.addCurrentVertex(J,gt,-Qn,-da,me)}else if("butt"===Nn)this.addCurrentVertex(J,Lt,0,0,me);else if("square"===Nn){var Ao=xe?1:-1;this.addCurrentVertex(J,Lt,Ao,Ao,me)}else"round"===Nn&&(xe&&(this.addCurrentVertex(J,He,0,0,me),this.addCurrentVertex(J,He,1,1,me,!0)),Ge&&(this.addCurrentVertex(J,gt,-1,-1,me,!0),this.addCurrentVertex(J,gt,0,0,me)));if(rn&&it<R-1){var Do=J.dist(Ge);if(Do>2*oe){var ho=J.add(Ge.sub(J)._mult(oe/Do)._round());this.updateDistance(J,ho),this.addCurrentVertex(ho,gt,0,0,me),J=ho}}}}},Zo.prototype.addCurrentVertex=function(e,t,r,c,d,g){void 0===g&&(g=!1);var x=t.y*c-t.x,A=-t.y-t.x*c;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,g,!1,r,d),this.addHalfVertex(e,x,A,g,!0,-c,d),this.distance>as/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(e,t,r,c,d,g))},Zo.prototype.addHalfVertex=function(e,t,r,c,d,g,x){var A=.5*(this.lineClips?this.scaledDistance*(as-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(c?1:0),(e.y<<1)+(d?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(0===g?0:g<0?-1:1)|(63&A)<<2,A>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var R=x.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),x.primitiveLength++),d?this.e2=R:this.e1=R},Zo.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},Zo.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},Bn("LineBucket",Zo,{omit:["layers","patternFeatures"]});var os=new Po({"line-cap":new ri(ce.layout_line["line-cap"]),"line-join":new An(ce.layout_line["line-join"]),"line-miter-limit":new ri(ce.layout_line["line-miter-limit"]),"line-round-limit":new ri(ce.layout_line["line-round-limit"]),"line-sort-key":new An(ce.layout_line["line-sort-key"])}),cu={paint:new Po({"line-opacity":new An(ce.paint_line["line-opacity"]),"line-color":new An(ce.paint_line["line-color"]),"line-translate":new ri(ce.paint_line["line-translate"]),"line-translate-anchor":new ri(ce.paint_line["line-translate-anchor"]),"line-width":new An(ce.paint_line["line-width"]),"line-gap-width":new An(ce.paint_line["line-gap-width"]),"line-offset":new An(ce.paint_line["line-offset"]),"line-blur":new An(ce.paint_line["line-blur"]),"line-dasharray":new So(ce.paint_line["line-dasharray"]),"line-pattern":new lc(ce.paint_line["line-pattern"]),"line-gradient":new Xs(ce.paint_line["line-gradient"])}),layout:os},Ph=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,c){return c=new $i(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),e.prototype.possiblyEvaluate.call(this,r,c)},t.prototype.evaluate=function(r,c,d,g){return c=Mt({},c,{zoom:Math.floor(c.zoom)}),e.prototype.evaluate.call(this,r,c,d,g)},t}(An))(cu.paint.properties["line-width"].specification);Ph.useIntegerZoom=!0;var Ap=function(e){function t(r){e.call(this,r,cu),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){"line-gradient"===r&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof gs,this.gradientVersion=(this.gradientVersion+1)%Xe)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,c){e.prototype.recalculate.call(this,r,c),this.paint._values["line-floorwidth"]=Ph.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new Zo(r)},t.prototype.queryRadius=function(r){var c=r,d=np(Ka("line-width",this,c),Ka("line-gap-width",this,c)),g=Ka("line-offset",this,c);return d/2+Math.abs(g)+ia(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,c,d,g,x,A,R){var j=ga(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),A.angle,R),J=R/2*np(this.paint.get("line-width").evaluate(c,d),this.paint.get("line-gap-width").evaluate(c,d)),oe=this.paint.get("line-offset").evaluate(c,d);return oe&&(g=function(me,xe){for(var Ge=[],He=new q(0,0),gt=0;gt<me.length;gt++){for(var it=me[gt],Lt=[],Ht=0;Ht<it.length;Ht++){var fr=it[Ht],xr=it[Ht+1],Lr=0===Ht?He:fr.sub(it[Ht-1])._unit()._perp(),rn=Ht===it.length-1?He:xr.sub(fr)._unit()._perp(),vn=Lr._add(rn)._unit();vn._mult(1/(vn.x*rn.x+vn.y*rn.y)),Lt.push(vn._mult(xe)._add(fr))}Ge.push(Lt)}return Ge}(g,oe*R)),function(me,xe,Ge){for(var He=0;He<xe.length;He++){var gt=xe[He];if(me.length>=3)for(var it=0;it<gt.length;it++)if(Ha(me,gt[it]))return!0;if(ni(me,gt,Ge))return!0}return!1}(j,g,J)},t.prototype.isTileClipped=function(){return!0},t}(fo);function np(e,t){return t>0?t+2*e:e}var $p=zo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Qp=zo([{name:"a_projected_pos",components:3,type:"Float32"}],4),Pp=(zo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),zo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Mp=(zo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),zo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Ip=zo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ed(e,t,r){return e.sections.forEach(function(c){var d,x,A;c.text=(d=c.text,x=r,"uppercase"===(A=t.layout.get("text-transform").evaluate(x,{}))?d=d.toLocaleUpperCase():"lowercase"===A&&(d=d.toLocaleLowerCase()),Cs.applyArabicShaping&&(d=Cs.applyArabicShaping(d)),d)}),e}zo([{name:"triangle",components:3,type:"Uint16"}]),zo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),zo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),zo([{type:"Float32",name:"offsetX"}]),zo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Lf={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"},Op=function(e,t,r,c,d){var g,x,A=8*d-c-1,R=(1<<A)-1,j=R>>1,J=-7,oe=r?d-1:0,me=r?-1:1,xe=e[t+oe];for(oe+=me,g=xe&(1<<-J)-1,xe>>=-J,J+=A;J>0;g=256*g+e[t+oe],oe+=me,J-=8);for(x=g&(1<<-J)-1,g>>=-J,J+=c;J>0;x=256*x+e[t+oe],oe+=me,J-=8);if(0===g)g=1-j;else{if(g===R)return x?NaN:1/0*(xe?-1:1);x+=Math.pow(2,c),g-=j}return(xe?-1:1)*x*Math.pow(2,g-c)},Mh=function(e,t,r,c,d,g){var x,A,R,j=8*g-d-1,J=(1<<j)-1,oe=J>>1,me=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,xe=c?0:g-1,Ge=c?1:-1,He=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(A=isNaN(t)?1:0,x=J):(x=Math.floor(Math.log(t)/Math.LN2),t*(R=Math.pow(2,-x))<1&&(x--,R*=2),(t+=x+oe>=1?me/R:me*Math.pow(2,1-oe))*R>=2&&(x++,R/=2),x+oe>=J?(A=0,x=J):x+oe>=1?(A=(t*R-1)*Math.pow(2,d),x+=oe):(A=t*Math.pow(2,oe-1)*Math.pow(2,d),x=0));d>=8;e[r+xe]=255&A,xe+=Ge,A/=256,d-=8);for(x=x<<d|A,j+=d;j>0;e[r+xe]=255&x,xe+=Ge,x/=256,j-=8);e[r+xe-Ge]|=128*He},zc=io;function io(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}io.Varint=0,io.Fixed64=1,io.Bytes=2,io.Fixed32=5;var ip="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function dc(e){return e.type===io.Bytes?e.readVarint()+e.pos:e.pos+1}function ap(e,t,r){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(c);for(var d=r.pos-1;d>=e;d--)r.buf[d+c]=r.buf[d]}function V(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function ke(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Qe(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function ir(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function kr(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function tr(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Er(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Zr(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Gr(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Kr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function qr(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Qr(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function hn(e,t,r){1===e&&r.readMessage(Hr,t)}function Hr(e,t,r){if(3===e){var c=r.readMessage(en,{}),d=c.width,g=c.height,x=c.left,A=c.top,R=c.advance;t.push({id:c.id,bitmap:new Wu({width:d+6,height:g+6},c.bitmap),metrics:{width:d,height:g,left:x,top:A,advance:R}})}}function en(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function Bt(e){for(var t=0,r=0,c=0,d=e;c<d.length;c+=1){var g=d[c];t+=g.w*g.h,r=Math.max(r,g.w)}e.sort(function(He,gt){return gt.h-He.h});for(var x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],A=0,R=0,j=0,J=e;j<J.length;j+=1)for(var oe=J[j],me=x.length-1;me>=0;me--){var xe=x[me];if(!(oe.w>xe.w||oe.h>xe.h)){if(oe.x=xe.x,oe.y=xe.y,R=Math.max(R,oe.y+oe.h),A=Math.max(A,oe.x+oe.w),oe.w===xe.w&&oe.h===xe.h){var Ge=x.pop();me<x.length&&(x[me]=Ge)}else oe.h===xe.h?(xe.x+=oe.w,xe.w-=oe.w):oe.w===xe.w?(xe.y+=oe.h,xe.h-=oe.h):(x.push({x:xe.x+oe.w,y:xe.y,w:xe.w-oe.w,h:oe.h}),xe.y+=oe.h,xe.h-=oe.h);break}}return{w:A,h:R,fill:t/(A*R)||0}}io.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var c=this.readVarint(),d=c>>3,g=this.pos;this.type=7&c,e(d,t,this),this.pos===g&&this.skip(c)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Kr(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Qr(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Kr(this.buf,this.pos)+4294967296*Kr(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=Kr(this.buf,this.pos)+4294967296*Qr(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=Op(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Op(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,c=this.buf;return t=127&(r=c[this.pos++]),r<128?t:(t|=(127&(r=c[this.pos++]))<<7,r<128?t:(t|=(127&(r=c[this.pos++]))<<14,r<128?t:(t|=(127&(r=c[this.pos++]))<<21,r<128?t:function(d,g,x){var A,R,j=x.buf;if(A=(112&(R=j[x.pos++]))>>4,R<128||(A|=(127&(R=j[x.pos++]))<<3,R<128)||(A|=(127&(R=j[x.pos++]))<<10,R<128)||(A|=(127&(R=j[x.pos++]))<<17,R<128)||(A|=(127&(R=j[x.pos++]))<<24,R<128)||(A|=(1&(R=j[x.pos++]))<<31,R<128))return function(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}(d,A,g);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=c[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&ip?ip.decode(this.buf.subarray(t,e)):function(r,c,d){for(var g="",x=c;x<d;){var A,R,j,J=r[x],oe=null,me=J>239?4:J>223?3:J>191?2:1;if(x+me>d)break;1===me?J<128&&(oe=J):2===me?128==(192&(A=r[x+1]))&&(oe=(31&J)<<6|63&A)<=127&&(oe=null):3===me?(R=r[x+2],128==(192&(A=r[x+1]))&&128==(192&R)&&((oe=(15&J)<<12|(63&A)<<6|63&R)<=2047||oe>=55296&&oe<=57343)&&(oe=null)):4===me&&(R=r[x+2],j=r[x+3],128==(192&(A=r[x+1]))&&128==(192&R)&&128==(192&j)&&((oe=(15&J)<<18|(63&A)<<12|(63&R)<<6|63&j)<=65535||oe>=1114112)&&(oe=null)),null===oe?(oe=65533,me=1):oe>65535&&(oe-=65536,g+=String.fromCharCode(oe>>>10&1023|55296),oe=56320|1023&oe),g+=String.fromCharCode(oe),x+=me}return g}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==io.Bytes)return e.push(this.readVarint(t));var r=dc(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==io.Bytes)return e.push(this.readSVarint());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==io.Bytes)return e.push(this.readBoolean());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==io.Bytes)return e.push(this.readFloat());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==io.Bytes)return e.push(this.readDouble());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==io.Bytes)return e.push(this.readFixed32());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==io.Bytes)return e.push(this.readSFixed32());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==io.Bytes)return e.push(this.readFixed64());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==io.Bytes)return e.push(this.readSFixed64());var t=dc(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===io.Varint)for(;this.buf[this.pos++]>127;);else if(t===io.Bytes)this.pos=this.readVarint()+this.pos;else if(t===io.Fixed32)this.pos+=4;else{if(t!==io.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),qr(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),qr(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),qr(this.buf,-1&e,this.pos),qr(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),qr(this.buf,-1&e,this.pos),qr(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var c,d,g,A;if(t>=0?(c=t%4294967296|0,d=t/4294967296|0):(d=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,d=d+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),g=c,(A=r).buf[A.pos++]=127&g|128,g>>>=7,A.buf[A.pos++]=127&g|128,g>>>=7,A.buf[A.pos++]=127&g|128,g>>>=7,A.buf[A.pos++]=127&g|128,A.buf[A.pos]=127&(g>>>=7),function(g,x){var A=(7&g)<<4;x.buf[x.pos++]|=A|((g>>>=3)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g|((g>>>=7)?128:0),g&&(x.buf[x.pos++]=127&g)))))}(d,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(c,d,g){for(var x,A,R=0;R<d.length;R++){if((x=d.charCodeAt(R))>55295&&x<57344){if(!A){x>56319||R+1===d.length?(c[g++]=239,c[g++]=191,c[g++]=189):A=x;continue}if(x<56320){c[g++]=239,c[g++]=191,c[g++]=189,A=x;continue}x=A-55296<<10|x-56320|65536,A=null}else A&&(c[g++]=239,c[g++]=191,c[g++]=189,A=null);x<128?c[g++]=x:(x<2048?c[g++]=x>>6|192:(x<65536?c[g++]=x>>12|224:(c[g++]=x>>18|240,c[g++]=x>>12&63|128),c[g++]=x>>6&63|128),c[g++]=63&x|128)}return g}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&ap(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Mh(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Mh(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var c=this.pos-r;c>=128&&ap(r,c,this),this.pos=r-1,this.writeVarint(c),this.pos+=c},writeMessage:function(e,t,r){this.writeTag(e,io.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,V,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,ke,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,kr,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Qe,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,ir,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,tr,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Er,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Zr,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Gr,t)},writeBytesField:function(e,t){this.writeTag(e,io.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,io.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,io.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,io.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,io.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,io.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,io.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,io.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,io.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,io.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var gr=function(e,t){var r=t.pixelRatio,c=t.version,d=t.stretchX,g=t.stretchY,x=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=d,this.stretchY=g,this.content=x,this.version=c},Wr={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Wr.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Wr.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Wr.tlbr.get=function(){return this.tl.concat(this.br)},Wr.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(gr.prototype,Wr);var Tn=function(e,t){var r={},c={};this.haveRenderCallbacks=[];var d=[];this.addImages(e,r,d),this.addImages(t,c,d);var g=Bt(d),x=new ca({width:g.w||1,height:g.h||1});for(var A in e){var R=e[A],j=r[A].paddedRect;ca.copy(R.data,x,{x:0,y:0},{x:j.x+1,y:j.y+1},R.data)}for(var J in t){var oe=t[J],me=c[J].paddedRect,xe=me.x+1,Ge=me.y+1,He=oe.data.width,gt=oe.data.height;ca.copy(oe.data,x,{x:0,y:0},{x:xe,y:Ge},oe.data),ca.copy(oe.data,x,{x:0,y:gt-1},{x:xe,y:Ge-1},{width:He,height:1}),ca.copy(oe.data,x,{x:0,y:0},{x:xe,y:Ge+gt},{width:He,height:1}),ca.copy(oe.data,x,{x:He-1,y:0},{x:xe-1,y:Ge},{width:1,height:gt}),ca.copy(oe.data,x,{x:0,y:0},{x:xe+He,y:Ge},{width:1,height:gt})}this.image=x,this.iconPositions=r,this.patternPositions=c};Tn.prototype.addImages=function(e,t,r){for(var c in e){var d=e[c],g={x:0,y:0,w:d.data.width+2,h:d.data.height+2};r.push(g),t[c]=new gr(g,d),d.hasRenderCallback&&this.haveRenderCallbacks.push(c)}},Tn.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Tn.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var c=e.tl;r.update(t.data,void 0,{x:c[0],y:c[1]})}},Bn("ImagePosition",gr),Bn("ImageAtlas",Tn);var Mr={horizontal:1,vertical:2,horizontalOnly:3},bn=function(){this.scale=1,this.fontStack="",this.imageName=null};bn.forText=function(e,t){var r=new bn;return r.scale=e||1,r.fontStack=t,r},bn.forImage=function(e){var t=new bn;return t.imageName=e,t};var tn=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function ui(e,t,r,c,d,g,x,A,R,j,J,oe,me,xe,Ge,He){var gt,it=tn.fromFeature(e,d);oe===Mr.vertical&&it.verticalizePunctuation();var Lt=Cs.processBidirectionalText,Ht=Cs.processStyledBidirectionalText;if(Lt&&1===it.sections.length){gt=[];for(var fr=0,xr=Lt(it.toString(),wn(it,j,g,t,c,xe,Ge));fr<xr.length;fr+=1){var Lr=xr[fr],rn=new tn;rn.text=Lr,rn.sections=it.sections;for(var vn=0;vn<Lr.length;vn++)rn.sectionIndex.push(0);gt.push(rn)}}else if(Ht){gt=[];for(var ii=0,Dn=Ht(it.text,it.sectionIndex,wn(it,j,g,t,c,xe,Ge));ii<Dn.length;ii+=1){var fi=Dn[ii],Nn=new tn;Nn.text=fi[0],Nn.sectionIndex=fi[1],Nn.sections=it.sections,gt.push(Nn)}}else gt=function(Qn,da){for(var Ki=[],Aa=Qn.text,di=0,Ra=0,Co=da;Ra<Co.length;Ra+=1){var Ao=Co[Ra];Ki.push(Qn.substring(di,Ao)),di=Ao}return di<Aa.length&&Ki.push(Qn.substring(di,Aa.length)),Ki}(it,wn(it,j,g,t,c,xe,Ge));var na=[],Si={positionedLines:na,text:it.toString(),top:J[1],bottom:J[1],left:J[0],right:J[0],writingMode:oe,iconsInText:!1,verticalizable:!1};return function(Qn,da,Ki,Aa,di,Ra,Co,Ao,Do,ho,Oo,xs){for(var bs=0,fu=-17,Is=0,hu=0,Bo="right"===Ao?1:"left"===Ao?0:.5,Os=0,wa=0,Ja=di;wa<Ja.length;wa+=1){var Xa=Ja[wa];Xa.trim();var qi=Xa.getMaxScale(),$s=24*(qi-1),Zs={positionedGlyphs:[],lineOffset:0};Qn.positionedLines[Os]=Zs;var yo=Zs.positionedGlyphs,fs=0;if(Xa.length()){for(var ws=0;ws<Xa.length();ws++){var Pa=Xa.getSection(ws),vc=Xa.getSectionIndex(ws),cl=Xa.getCharCode(ws),Il=0,Fo=null,Uc=null,Ku=null,mc=24,Df=!(Do===Mr.horizontal||!Oo&&!Oc(cl)||Oo&&(Or[cl]||(Vc=cl,cn.Arabic(Vc)||cn["Arabic Supplement"](Vc)||cn["Arabic Extended-A"](Vc)||cn["Arabic Presentation Forms-A"](Vc)||cn["Arabic Presentation Forms-B"](Vc))));if(Pa.imageName){var nh=Aa[Pa.imageName];if(!nh)continue;Ku=Pa.imageName,Qn.iconsInText=Qn.iconsInText||!0,Uc=nh.paddedRect;var af=nh.displaySize;Pa.scale=24*Pa.scale/xs,Il=$s+(24-af[1]*Pa.scale),mc=(Fo={width:af[0],height:af[1],left:1,top:-3,advance:Df?af[1]:af[0]}).advance;var ih=Df?af[0]*Pa.scale-24*qi:af[1]*Pa.scale-24*qi;ih>0&&ih>fs&&(fs=ih)}else{var kh=Ki[Pa.fontStack],ah=kh&&kh[cl];if(ah&&ah.rect)Uc=ah.rect,Fo=ah.metrics;else{var oh=da[Pa.fontStack],Lh=oh&&oh[cl];if(!Lh)continue;Fo=Lh.metrics}Il=24*(qi-Pa.scale)}Df?(Qn.verticalizable=!0,yo.push({glyph:cl,imageName:Ku,x:bs,y:fu+Il,vertical:Df,scale:Pa.scale,fontStack:Pa.fontStack,sectionIndex:vc,metrics:Fo,rect:Uc}),bs+=mc*Pa.scale+ho):(yo.push({glyph:cl,imageName:Ku,x:bs,y:fu+Il,vertical:Df,scale:Pa.scale,fontStack:Pa.fontStack,sectionIndex:vc,metrics:Fo,rect:Uc}),bs+=Fo.advance*Pa.scale+ho)}0!==yo.length&&(Is=Math.max(bs-ho,Is),Mi(yo,0,yo.length-1,Bo,fs)),bs=0;var Rh=Ra*qi+fs;Zs.lineOffset=Math.max(fs,$s),fu+=Rh,hu=Math.max(Rh,hu),++Os}else fu+=Ra,++Os}var Vc,sh=fu- -17,uh=zi(Co),gc=uh.horizontalAlign,bf=uh.verticalAlign;(function(Dh,up,Bh,Fh,lp,wf,lh,ch,Nh){var Bf,zh=(up-Bh)*lp;Bf=wf!==lh?-ch*Fh- -17:(-Fh*Nh+.5)*lh;for(var fh=0,Zh=Dh;fh<Zh.length;fh+=1)for(var Ff=0,Uh=Zh[fh].positionedGlyphs;Ff<Uh.length;Ff+=1){var hh=Uh[Ff];hh.x+=zh,hh.y+=Bf}})(Qn.positionedLines,Bo,gc,bf,Is,hu,Ra,sh,di.length),Qn.top+=-bf*sh,Qn.bottom=Qn.top+sh,Qn.left+=-gc*Is,Qn.right=Qn.left+Is}(Si,t,r,c,gt,x,A,R,oe,j,me,He),!function(Qn){for(var da=0,Ki=Qn;da<Ki.length;da+=1)if(0!==Ki[da].positionedGlyphs.length)return!1;return!0}(na)&&Si}tn.fromFeature=function(e,t){for(var r=new tn,c=0;c<e.sections.length;c++){var d=e.sections[c];d.image?r.addImageSection(d):r.addTextSection(d,t)}return r},tn.prototype.length=function(){return this.text.length},tn.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},tn.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},tn.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},tn.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var c=e.charCodeAt(r+1)||null,d=e.charCodeAt(r-1)||null;t+=c&&xl(c)&&!Lf[e[r+1]]||d&&xl(d)&&!Lf[e[r-1]]||!Lf[e[r]]?e[r]:Lf[e[r]]}return t}(this.text)},tn.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Or[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,c=this.text.length-1;c>=0&&c>=e&&Or[this.text.charCodeAt(c)];c--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},tn.prototype.substring=function(e,t){var r=new tn;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},tn.prototype.toString=function(){return this.text},tn.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},tn.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(bn.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,c=0;c<e.text.length;++c)this.sectionIndex.push(r)},tn.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(0!==t.length){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(bn.forImage(t)),this.sectionIndex.push(this.sections.length-1)):qe("Reached maximum number of images 6401")}else qe("Can't add FormattedSection with an empty image.")},tn.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Or={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Sr={};function jn(e,t,r,c,d,g){if(t.imageName){var x=c[t.imageName];return x?x.displaySize[0]*t.scale*24/g+d:0}var A=r[t.fontStack],R=A&&A[e];return R?R.metrics.advance*t.scale+d:0}function dn(e,t,r,c){var d=Math.pow(e-t,2);return c?e<t?d/2:2*d:d+Math.abs(r)*r}function Jr(e,t,r){var c=0;return 10===e&&(c-=1e4),r&&(c+=150),40!==e&&65288!==e||(c+=50),41!==t&&65289!==t||(c+=50),c}function yn(e,t,r,c,d,g){for(var x=null,A=dn(t,r,d,g),R=0,j=c;R<j.length;R+=1){var J=j[R],oe=dn(t-J.x,r,d,g)+J.badness;oe<=A&&(x=J,A=oe)}return{index:e,x:t,priorBreak:x,badness:A}}function wn(e,t,r,c,d,g,x){if("point"!==g)return[];if(!e)return[];for(var A,R=[],j=function(gt,it,Lt,Ht,fr,xr){for(var Lr=0,rn=0;rn<gt.length();rn++){var vn=gt.getSection(rn);Lr+=jn(gt.getCharCode(rn),vn,Ht,fr,it,xr)}return Lr/Math.max(1,Math.ceil(Lr/Lt))}(e,t,r,c,d,x),J=e.text.indexOf("\u200b")>=0,oe=0,me=0;me<e.length();me++){var xe=e.getSection(me),Ge=e.getCharCode(me);if(Or[Ge]||(oe+=jn(Ge,xe,c,d,t,x)),me<e.length()-1){var He=!((A=Ge)<11904||!(cn["Bopomofo Extended"](A)||cn.Bopomofo(A)||cn["CJK Compatibility Forms"](A)||cn["CJK Compatibility Ideographs"](A)||cn["CJK Compatibility"](A)||cn["CJK Radicals Supplement"](A)||cn["CJK Strokes"](A)||cn["CJK Symbols and Punctuation"](A)||cn["CJK Unified Ideographs Extension A"](A)||cn["CJK Unified Ideographs"](A)||cn["Enclosed CJK Letters and Months"](A)||cn["Halfwidth and Fullwidth Forms"](A)||cn.Hiragana(A)||cn["Ideographic Description Characters"](A)||cn["Kangxi Radicals"](A)||cn["Katakana Phonetic Extensions"](A)||cn.Katakana(A)||cn["Vertical Forms"](A)||cn["Yi Radicals"](A)||cn["Yi Syllables"](A)));(Sr[Ge]||He||xe.imageName)&&R.push(yn(me+1,oe,j,R,Jr(Ge,e.getCharCode(me+1),He&&J),!1))}}return function gt(it){return it?gt(it.priorBreak).concat(it.index):[]}(yn(e.length(),oe,j,R,0,!0))}function zi(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Mi(e,t,r,c,d){if(c||d)for(var g=e[r],x=(e[r].x+g.metrics.advance*g.scale)*c,A=t;A<=r;A++)e[A].x-=x,e[A].y+=d}function En(e,t,r,c,d,g){var x,A=e.image;if(A.content){var R=A.content,j=A.pixelRatio||1;x=[R[0]/j,R[1]/j,A.displaySize[0]-R[2]/j,A.displaySize[1]-R[3]/j]}var J,oe,me,xe,Ge=t.left*g,He=t.right*g;"width"===r||"both"===r?(xe=d[0]+Ge-c[3],oe=d[0]+He+c[1]):oe=(xe=d[0]+(Ge+He-A.displaySize[0])/2)+A.displaySize[0];var gt=t.top*g,it=t.bottom*g;return"height"===r||"both"===r?(J=d[1]+gt-c[0],me=d[1]+it+c[2]):me=(J=d[1]+(gt+it-A.displaySize[1])/2)+A.displaySize[1],{image:A,top:J,right:oe,bottom:me,left:xe,collisionPadding:x}}Sr[10]=!0,Sr[32]=!0,Sr[38]=!0,Sr[40]=!0,Sr[41]=!0,Sr[43]=!0,Sr[45]=!0,Sr[47]=!0,Sr[173]=!0,Sr[183]=!0,Sr[8203]=!0,Sr[8208]=!0,Sr[8211]=!0,Sr[8231]=!0;var Sn=function(e){function t(r,c,d,g){e.call(this,r,c),this.angle=d,void 0!==g&&(this.segment=g)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(q);function _i(e,t){var r=t.expression;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new $i(e+1))};if("source"===r.kind)return{kind:"source"};for(var c=r.zoomStops,d=r.interpolationType,g=0;g<c.length&&c[g]<=e;)g++;for(var x=g=Math.max(0,g-1);x<c.length&&c[x]<e+1;)x++;x=Math.min(c.length-1,x);var A=c[g],R=c[x];return"composite"===r.kind?{kind:"composite",minZoom:A,maxZoom:R,interpolationType:d}:{kind:"camera",minZoom:A,maxZoom:R,minSize:r.evaluate(new $i(A)),maxSize:r.evaluate(new $i(R)),interpolationType:d}}function Zi(e,t,r){var c=t.uSize,d=r.lowerSize;return"source"===e.kind?d/128:"composite"===e.kind?Oa(d/128,r.upperSize/128,t.uSizeT):c}function fa(e,t){var r=0,c=0;if("constant"===e.kind)c=e.layoutSize;else if("source"!==e.kind){var d=e.interpolationType,g=d?Z(De.interpolationFactor(d,t,e.minZoom,e.maxZoom),0,1):0;"camera"===e.kind?c=Oa(e.minSize,e.maxSize,g):r=g}return{uSizeT:r,uSize:c}}Bn("Anchor",Sn);var Mo=Object.freeze({__proto__:null,getSizeData:_i,evaluateSizeForFeature:Zi,evaluateSizeForZoom:fa,SIZE_PACK_FACTOR:128});function Io(e,t,r,c,d){if(void 0===t.segment)return!0;for(var g=t,x=t.segment+1,A=0;A>-r/2;){if(--x<0)return!1;A-=e[x].dist(g),g=e[x]}A+=e[x].dist(e[x+1]),x++;for(var R=[],j=0;A<r/2;){var J=e[x],oe=e[x+1];if(!oe)return!1;var me=e[x-1].angleTo(J)-J.angleTo(oe);for(me=Math.abs((me+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:A,angleDelta:me}),j+=me;A-R[0].distance>c;)j-=R.shift().angleDelta;if(j>d)return!1;x++,A+=J.dist(oe)}return!0}function ha(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function ds(e,t,r){return e?.6*t*r:0}function so(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function vs(e,t,r,c,d,g){for(var x=ds(r,d,g),A=so(r,c)*g,R=0,j=ha(e)/2,J=0;J<e.length-1;J++){var oe=e[J],me=e[J+1],xe=oe.dist(me);if(R+xe>j){var Ge=(j-R)/xe,He=Oa(oe.x,me.x,Ge),gt=Oa(oe.y,me.y,Ge),it=new Sn(He,gt,me.angleTo(oe),J);return it._round(),!x||Io(e,it,A,x,t)?it:void 0}R+=xe}}function Uo(e,t,r,c,d,g,x,A,R){var j=ds(c,g,x),J=so(c,d),oe=J*x,me=0===e[0].x||e[0].x===R||0===e[0].y||e[0].y===R;return t-oe<t/4&&(t=oe+t/4),function xe(Ge,He,gt,it,Lt,Ht,fr,xr,Lr){for(var rn=Ht/2,vn=ha(Ge),ii=0,Dn=He-gt,fi=[],Nn=0;Nn<Ge.length-1;Nn++){for(var na=Ge[Nn],Si=Ge[Nn+1],Qn=na.dist(Si),da=Si.angleTo(na);Dn+gt<ii+Qn;){var Ki=((Dn+=gt)-ii)/Qn,Aa=Oa(na.x,Si.x,Ki),di=Oa(na.y,Si.y,Ki);if(Aa>=0&&Aa<Lr&&di>=0&&di<Lr&&Dn-rn>=0&&Dn+rn<=vn){var Ra=new Sn(Aa,di,da,Nn);Ra._round(),it&&!Io(Ge,Ra,Ht,it,Lt)||fi.push(Ra)}}ii+=Qn}return xr||fi.length||fr||(fi=xe(Ge,ii/2,gt,it,Lt,Ht,fr,!0,Lr)),fi}(e,me?t/2*A%t:(J/2+2*g)*x*A%t,t,j,r,oe,me,!1,R)}function ss(e,t,r,c,d){for(var g=[],x=0;x<e.length;x++)for(var A=e[x],R=void 0,j=0;j<A.length-1;j++){var J=A[j],oe=A[j+1];J.x<t&&oe.x<t||(J.x<t?J=new q(t,J.y+(t-J.x)/(oe.x-J.x)*(oe.y-J.y))._round():oe.x<t&&(oe=new q(t,J.y+(t-J.x)/(oe.x-J.x)*(oe.y-J.y))._round()),J.y<r&&oe.y<r||(J.y<r?J=new q(J.x+(r-J.y)/(oe.y-J.y)*(oe.x-J.x),r)._round():oe.y<r&&(oe=new q(J.x+(r-J.y)/(oe.y-J.y)*(oe.x-J.x),r)._round()),J.x>=c&&oe.x>=c||(J.x>=c?J=new q(c,J.y+(c-J.x)/(oe.x-J.x)*(oe.y-J.y))._round():oe.x>=c&&(oe=new q(c,J.y+(c-J.x)/(oe.x-J.x)*(oe.y-J.y))._round()),J.y>=d&&oe.y>=d||(J.y>=d?J=new q(J.x+(d-J.y)/(oe.y-J.y)*(oe.x-J.x),d)._round():oe.y>=d&&(oe=new q(J.x+(d-J.y)/(oe.y-J.y)*(oe.x-J.x),d)._round()),R&&J.equals(R[R.length-1])||g.push(R=[J]),R.push(oe)))))}return g}function ms(e,t,r,c){var d=[],g=e.image,x=g.pixelRatio,A=g.paddedRect.w-2,R=g.paddedRect.h-2,j=e.right-e.left,J=e.bottom-e.top,oe=g.stretchX||[[0,A]],me=g.stretchY||[[0,R]],xe=function(Aa,di){return Aa+di[1]-di[0]},Ge=oe.reduce(xe,0),He=me.reduce(xe,0),gt=A-Ge,it=R-He,Lt=0,Ht=Ge,fr=0,xr=He,Lr=0,rn=gt,vn=0,ii=it;if(g.content&&c){var Dn=g.content;Lt=us(oe,0,Dn[0]),fr=us(me,0,Dn[1]),Ht=us(oe,Dn[0],Dn[2]),xr=us(me,Dn[1],Dn[3]),Lr=Dn[0]-Lt,vn=Dn[1]-fr,rn=Dn[2]-Dn[0]-Ht,ii=Dn[3]-Dn[1]-xr}var fi=function(Aa,di,Ra,Co){var Ao=Hi(Aa.stretch-Lt,Ht,j,e.left),Do=ls(Aa.fixed-Lr,rn,Aa.stretch,Ge),ho=Hi(di.stretch-fr,xr,J,e.top),Oo=ls(di.fixed-vn,ii,di.stretch,He),xs=Hi(Ra.stretch-Lt,Ht,j,e.left),bs=ls(Ra.fixed-Lr,rn,Ra.stretch,Ge),fu=Hi(Co.stretch-fr,xr,J,e.top),Is=ls(Co.fixed-vn,ii,Co.stretch,He),hu=new q(Ao,ho),Bo=new q(xs,ho),Os=new q(xs,fu),wa=new q(Ao,fu),Ja=new q(Do/x,Oo/x),Xa=new q(bs/x,Is/x),qi=t*Math.PI/180;if(qi){var $s=Math.sin(qi),Zs=Math.cos(qi),yo=[Zs,-$s,$s,Zs];hu._matMult(yo),Bo._matMult(yo),wa._matMult(yo),Os._matMult(yo)}var fs=Aa.stretch+Aa.fixed,ws=di.stretch+di.fixed;return{tl:hu,tr:Bo,bl:wa,br:Os,tex:{x:g.paddedRect.x+1+fs,y:g.paddedRect.y+1+ws,w:Ra.stretch+Ra.fixed-fs,h:Co.stretch+Co.fixed-ws},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ja,pixelOffsetBR:Xa,minFontScaleX:rn/x/j,minFontScaleY:ii/x/J,isSDF:r}};if(c&&(g.stretchX||g.stretchY))for(var Nn=Vo(oe,gt,Ge),na=Vo(me,it,He),Si=0;Si<Nn.length-1;Si++)for(var Qn=Nn[Si],da=Nn[Si+1],Ki=0;Ki<na.length-1;Ki++)d.push(fi(Qn,na[Ki],da,na[Ki+1]));else d.push(fi({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:A+1},{fixed:0,stretch:R+1}));return d}function us(e,t,r){for(var c=0,d=0,g=e;d<g.length;d+=1){var x=g[d];c+=Math.max(t,Math.min(r,x[1]))-Math.max(t,Math.min(r,x[0]))}return c}function Vo(e,t,r){for(var c=[{fixed:-1,stretch:0}],d=0,g=e;d<g.length;d+=1){var x=g[d],A=x[0],R=x[1],j=c[c.length-1];c.push({fixed:A-j.stretch,stretch:j.stretch}),c.push({fixed:A-j.stretch,stretch:j.stretch+(R-A)})}return c.push({fixed:t+1,stretch:r}),c}function Hi(e,t,r,c){return e/t*r+c}function ls(e,t,r,c){return e-t*r/c}var La=function(e,t,r,c,d,g,x,A,R,j){if(this.boxStartIndex=e.length,R){var J=g.top,oe=g.bottom,me=g.collisionPadding;me&&(J-=me[1],oe+=me[3]);var xe=oe-J;xe>0&&(xe=Math.max(10,xe),this.circleDiameter=xe)}else{var Ge=g.top*x-A,He=g.bottom*x+A,gt=g.left*x-A,it=g.right*x+A,Lt=g.collisionPadding;if(Lt&&(gt-=Lt[0]*x,Ge-=Lt[1]*x,it+=Lt[2]*x,He+=Lt[3]*x),j){var Ht=new q(gt,Ge),fr=new q(it,Ge),xr=new q(gt,He),Lr=new q(it,He),rn=j*Math.PI/180;Ht._rotate(rn),fr._rotate(rn),xr._rotate(rn),Lr._rotate(rn),gt=Math.min(Ht.x,fr.x,xr.x,Lr.x),it=Math.max(Ht.x,fr.x,xr.x,Lr.x),Ge=Math.min(Ht.y,fr.y,xr.y,Lr.y),He=Math.max(Ht.y,fr.y,xr.y,Lr.y)}e.emplaceBack(t.x,t.y,gt,Ge,it,He,r,c,d)}this.boxEndIndex=e.length},uo=function(e,t){if(void 0===e&&(e=[]),void 0===t&&(t=Ai),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Ai(e,t){return e<t?-1:e>t?1:0}function pa(e,t,r){void 0===t&&(t=1),void 0===r&&(r=!1);for(var c=1/0,d=1/0,g=-1/0,x=-1/0,A=e[0],R=0;R<A.length;R++){var j=A[R];(!R||j.x<c)&&(c=j.x),(!R||j.y<d)&&(d=j.y),(!R||j.x>g)&&(g=j.x),(!R||j.y>x)&&(x=j.y)}var J=Math.min(g-c,x-d),oe=J/2,me=new uo([],Qa);if(0===J)return new q(c,d);for(var xe=c;xe<g;xe+=J)for(var Ge=d;Ge<x;Ge+=J)me.push(new To(xe+oe,Ge+oe,oe,e));for(var He=function(Lt){for(var Ht=0,fr=0,xr=0,Lr=Lt[0],rn=0,vn=Lr.length,ii=vn-1;rn<vn;ii=rn++){var Dn=Lr[rn],fi=Lr[ii],Nn=Dn.x*fi.y-fi.x*Dn.y;fr+=(Dn.x+fi.x)*Nn,xr+=(Dn.y+fi.y)*Nn,Ht+=3*Nn}return new To(fr/Ht,xr/Ht,0,Lt)}(e),gt=me.length;me.length;){var it=me.pop();(it.d>He.d||!He.d)&&(He=it,r&&console.log("found best %d after %d probes",Math.round(1e4*it.d)/1e4,gt)),it.max-He.d<=t||(me.push(new To(it.p.x-(oe=it.h/2),it.p.y-oe,oe,e)),me.push(new To(it.p.x+oe,it.p.y-oe,oe,e)),me.push(new To(it.p.x-oe,it.p.y+oe,oe,e)),me.push(new To(it.p.x+oe,it.p.y+oe,oe,e)),gt+=4)}return r&&(console.log("num probes: "+gt),console.log("best distance: "+He.d)),He.p}function Qa(e,t){return t.max-e.max}function To(e,t,r,c){this.p=new q(e,t),this.h=r,this.d=function(d,g){for(var x=!1,A=1/0,R=0;R<g.length;R++)for(var j=g[R],J=0,oe=j.length,me=oe-1;J<oe;me=J++){var xe=j[J],Ge=j[me];xe.y>d.y!=Ge.y>d.y&&d.x<(Ge.x-xe.x)*(d.y-xe.y)/(Ge.y-xe.y)+xe.x&&(x=!x),A=Math.min(A,xa(d,xe,Ge))}return(x?1:-1)*Math.sqrt(A)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}uo.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},uo.prototype.pop=function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},uo.prototype.peek=function(){return this.data[0]},uo.prototype._up=function(e){for(var t=this.data,r=this.compare,c=t[e];e>0;){var d=e-1>>1,g=t[d];if(r(c,g)>=0)break;t[e]=g,e=d}t[e]=c},uo.prototype._down=function(e){for(var t=this.data,r=this.compare,c=this.length>>1,d=t[e];e<c;){var g=1+(e<<1),x=t[g],A=g+1;if(A<this.length&&r(t[A],x)<0&&(g=A,x=t[A]),r(x,d)>=0)break;t[e]=x,e=g}t[e]=d};var Pl=Number.POSITIVE_INFINITY;function Ye(e,t){return t[1]!==Pl?function(r,c,d){var g=0,x=0;switch(c=Math.abs(c),d=Math.abs(d),r){case"top-right":case"top-left":case"top":x=d-7;break;case"bottom-right":case"bottom-left":case"bottom":x=7-d}switch(r){case"top-right":case"bottom-right":case"right":g=-c;break;case"top-left":case"bottom-left":case"left":g=c}return[g,x]}(e,t[0],t[1]):function(r,c){var d=0,g=0;c<0&&(c=0);var x=c/Math.sqrt(2);switch(r){case"top-right":case"top-left":g=x-7;break;case"bottom-right":case"bottom-left":g=7-x;break;case"bottom":g=7-c;break;case"top":g=c-7}switch(r){case"top-right":case"bottom-right":d=-x;break;case"top-left":case"bottom-left":d=x;break;case"left":d=c;break;case"right":d=-c}return[d,g]}(e,t[0])}function ur(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Kt(e,t,r,c,d,g,x,A,R,j,J,oe,me,xe,Ge){var He=function(fr,xr,Lr,rn,vn,ii,Dn,fi){for(var Nn=rn.layout.get("text-rotate").evaluate(ii,{})*Math.PI/180,na=[],Si=0,Qn=xr.positionedLines;Si<Qn.length;Si+=1)for(var da=Qn[Si],Ki=0,Aa=da.positionedGlyphs;Ki<Aa.length;Ki+=1){var di=Aa[Ki];if(di.rect){var Ra=di.rect||{},Co=4,Ao=!0,Do=1,ho=0,Oo=(vn||fi)&&di.vertical,xs=di.metrics.advance*di.scale/2;if(fi&&xr.verticalizable&&(ho=da.lineOffset/2-(di.imageName?-(24-di.metrics.width*di.scale)/2:24*(di.scale-1))),di.imageName){var bs=Dn[di.imageName];Ao=bs.sdf,Co=1/(Do=bs.pixelRatio)}var fu=vn?[di.x+xs,di.y]:[0,0],Is=vn?[0,0]:[di.x+xs+Lr[0],di.y+Lr[1]-ho],hu=[0,0];Oo&&(hu=Is,Is=[0,0]);var Bo=(di.metrics.left-Co)*di.scale-xs+Is[0],Os=(-di.metrics.top-Co)*di.scale+Is[1],wa=Bo+Ra.w*di.scale/Do,Ja=Os+Ra.h*di.scale/Do,Xa=new q(Bo,Os),qi=new q(wa,Os),$s=new q(Bo,Ja),Zs=new q(wa,Ja);if(Oo){var yo=new q(-xs,xs- -17),fs=-Math.PI/2,ws=12-xs,Pa=new q(22-ws,-(di.imageName?ws:0)),vc=new(Function.prototype.bind.apply(q,[null].concat(hu)));Xa._rotateAround(fs,yo)._add(Pa)._add(vc),qi._rotateAround(fs,yo)._add(Pa)._add(vc),$s._rotateAround(fs,yo)._add(Pa)._add(vc),Zs._rotateAround(fs,yo)._add(Pa)._add(vc)}if(Nn){var cl=Math.sin(Nn),Il=Math.cos(Nn),Fo=[Il,-cl,cl,Il];Xa._matMult(Fo),qi._matMult(Fo),$s._matMult(Fo),Zs._matMult(Fo)}var Uc=new q(0,0),Ku=new q(0,0);na.push({tl:Xa,tr:qi,bl:$s,br:Zs,tex:Ra,writingMode:xr.writingMode,glyphOffset:fu,sectionIndex:di.sectionIndex,isSDF:Ao,pixelOffsetTL:Uc,pixelOffsetBR:Ku,minFontScaleX:0,minFontScaleY:0})}}return na}(0,r,A,d,g,x,c,e.allowVerticalPlacement),gt=e.textSizeData,it=null;"source"===gt.kind?(it=[128*d.layout.get("text-size").evaluate(x,{})])[0]>32640&&qe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===gt.kind&&((it=[128*xe.compositeTextSizes[0].evaluate(x,{},Ge),128*xe.compositeTextSizes[1].evaluate(x,{},Ge)])[0]>32640||it[1]>32640)&&qe(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,He,it,A,g,x,j,t,R.lineStartIndex,R.lineLength,me,Ge);for(var Lt=0,Ht=J;Lt<Ht.length;Lt+=1)oe[Ht[Lt]]=e.text.placedSymbolArray.length-1;return 4*He.length}function Fn(e){for(var t in e)return e[t];return null}function ya(e,t,r,c){var d=e.compareText;if(t in d){for(var g=d[t],x=g.length-1;x>=0;x--)if(c.dist(g[x])<r)return!0}else d[t]=[];return d[t].push(c),!1}var Ne=gf.VectorTileFeature.types,Ce=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function lt(e,t,r,c,d,g,x,A,R,j,J,oe,me){var xe=A?Math.min(32640,Math.round(A[0])):0,Ge=A?Math.min(32640,Math.round(A[1])):0;e.emplaceBack(t,r,Math.round(32*c),Math.round(32*d),g,x,(xe<<1)+(R?1:0),Ge,16*j,16*J,256*oe,256*me)}function Ft(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function ar(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(sc(r[t].text))return!0;return!1}var yt=function(e){this.layoutVertexArray=new Hl,this.indexArray=new sl,this.programConfigurations=e,this.segments=new Ae,this.dynamicLayoutVertexArray=new wl,this.opacityVertexArray=new Wl,this.placedSymbolArray=new h};yt.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},yt.prototype.upload=function(e,t,r,c){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,$p.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Qp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Ce,!0),this.opacityVertexBuffer.itemSize=1),(r||c)&&this.programConfigurations.upload(e))},yt.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Bn("SymbolBuffers",yt);var ht=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new Ae,this.collisionVertexArray=new Lc};ht.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Pp.members,!0)},ht.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Bn("CollisionBuffers",ht);var ut=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(g){return g.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ca([]),this.placementViewportMatrix=Ca([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=_i(this.zoom,t["text-size"]),this.iconSizeData=_i(this.zoom,t["icon-size"]);var r=this.layers[0].layout,c=r.get("symbol-sort-key"),d=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==d&&void 0!==c.constantOr(1),this.sortFeaturesByY=("viewport-y"===d||"auto"===d&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map(function(g){return Mr[g]})),this.stateDependentLayerIds=this.layers.filter(function(g){return g.isStateDependent()}).map(function(g){return g.id}),this.sourceID=e.sourceID};ut.prototype.createArrays=function(){this.text=new yt(new ee(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new yt(new ee(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new C,this.lineVertexArray=new k,this.symbolInstances=new S},ut.prototype.calculateGlyphDependencies=function(e,t,r,c,d){for(var g=0;g<e.length;g++)if(t[e.charCodeAt(g)]=!0,(r||c)&&d){var x=Lf[e.charAt(g)];x&&(t[x.charCodeAt(0)]=!0)}},ut.prototype.populate=function(e,t,r){var c=this.layers[0],d=c.layout,g=d.get("text-font"),x=d.get("text-field"),A=d.get("icon-image"),R=("constant"!==x.value.kind||x.value.value instanceof Za&&!x.value.value.isEmpty()||x.value.value.toString().length>0)&&("constant"!==g.value.kind||g.value.value.length>0),j="constant"!==A.value.kind||!!A.value.value||Object.keys(A.parameters).length>0,J=d.get("symbol-sort-key");if(this.features=[],R||j){for(var oe=t.iconDependencies,me=t.glyphDependencies,xe=t.availableImages,Ge=new $i(this.zoom),He=0,gt=e;He<gt.length;He+=1){var it=gt[He],Lt=it.feature,Ht=it.id,fr=it.index,xr=it.sourceLayerIndex,Lr=c._featureFilter.needGeometry,rn=Pt(Lt,Lr);if(c._featureFilter.filter(Ge,rn,r)){Lr||(rn.geometry=ct(Lt));var vn=void 0;if(R){var ii=c.getValueAndResolveTokens("text-field",rn,r,xe),Dn=Za.factory(ii);ar(Dn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===kc()||this.hasRTLText&&Cs.isParsed())&&(vn=ed(Dn,c,rn))}var fi=void 0;if(j){var Nn=c.getValueAndResolveTokens("icon-image",rn,r,xe);fi=Nn instanceof Wi?Nn:Wi.fromString(Nn)}if(vn||fi){var na=this.sortFeaturesByKey?J.evaluate(rn,{},r):void 0;if(this.features.push({id:Ht,text:vn,icon:fi,index:fr,sourceLayerIndex:xr,geometry:rn.geometry,properties:Lt.properties,type:Ne[Lt.type],sortKey:na}),fi&&(oe[fi.name]=!0),vn){var Si=g.evaluate(rn,{},r).join(","),Qn="map"===d.get("text-rotation-alignment")&&"point"!==d.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Mr.vertical)>=0;for(var da=0,Ki=vn.sections;da<Ki.length;da+=1){var Aa=Ki[da];if(Aa.image)oe[Aa.image.name]=!0;else{var di=Yc(vn.toString()),Ra=Aa.fontStack||Si,Co=me[Ra]=me[Ra]||{};this.calculateGlyphDependencies(Aa.text,Co,Qn,this.allowVerticalPlacement,di)}}}}}}"line"===d.get("symbol-placement")&&(this.features=function(Ao){var Do={},ho={},Oo=[],xs=0;function bs(yo){Oo.push(Ao[yo]),xs++}function fu(yo,fs,ws){var Pa=ho[yo];return delete ho[yo],ho[fs]=Pa,Oo[Pa].geometry[0].pop(),Oo[Pa].geometry[0]=Oo[Pa].geometry[0].concat(ws[0]),Pa}function Is(yo,fs,ws){var Pa=Do[fs];return delete Do[fs],Do[yo]=Pa,Oo[Pa].geometry[0].shift(),Oo[Pa].geometry[0]=ws[0].concat(Oo[Pa].geometry[0]),Pa}function hu(yo,fs,ws){var Pa=ws?fs[0][fs[0].length-1]:fs[0][0];return yo+":"+Pa.x+":"+Pa.y}for(var Bo=0;Bo<Ao.length;Bo++){var Os=Ao[Bo],wa=Os.geometry,Ja=Os.text?Os.text.toString():null;if(Ja){var Xa=hu(Ja,wa),qi=hu(Ja,wa,!0);if(Xa in ho&&qi in Do&&ho[Xa]!==Do[qi]){var $s=Is(Xa,qi,wa),Zs=fu(Xa,qi,Oo[$s].geometry);delete Do[Xa],delete ho[qi],ho[hu(Ja,Oo[Zs].geometry,!0)]=Zs,Oo[$s].geometry=null}else Xa in ho?fu(Xa,qi,wa):qi in Do?Is(Xa,qi,wa):(bs(Bo),Do[Xa]=xs-1,ho[qi]=xs-1)}else bs(Bo)}return Oo.filter(function(yo){return yo.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ao,Do){return Ao.sortKey-Do.sortKey})}},ut.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},ut.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},ut.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ut.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ut.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ut.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ut.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(void 0!==e.segment){for(var c=e.dist(t[e.segment+1]),d=e.dist(t[e.segment]),g={},x=e.segment+1;x<t.length;x++)g[x]={x:t[x].x,y:t[x].y,tileUnitDistanceFromAnchor:c},x<t.length-1&&(c+=t[x+1].dist(t[x]));for(var A=e.segment||0;A>=0;A--)g[A]={x:t[A].x,y:t[A].y,tileUnitDistanceFromAnchor:d},A>0&&(d+=t[A-1].dist(t[A]));for(var R=0;R<t.length;R++){var j=g[R];this.lineVertexArray.emplaceBack(j.x,j.y,j.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},ut.prototype.addSymbols=function(e,t,r,c,d,g,x,A,R,j,J,oe){for(var me=e.indexArray,xe=e.layoutVertexArray,Ge=e.segments.prepareSegment(4*t.length,xe,me,this.canOverlap?g.sortKey:void 0),He=this.glyphOffsetArray.length,gt=Ge.vertexLength,it=this.allowVerticalPlacement&&x===Mr.vertical?Math.PI/2:0,Lt=g.text&&g.text.sections,Ht=0;Ht<t.length;Ht++){var fr=t[Ht],xr=fr.tl,Lr=fr.tr,rn=fr.bl,vn=fr.br,ii=fr.tex,Dn=fr.pixelOffsetTL,fi=fr.pixelOffsetBR,Nn=fr.minFontScaleX,na=fr.minFontScaleY,Si=fr.glyphOffset,Qn=fr.isSDF,da=fr.sectionIndex,Ki=Ge.vertexLength,Aa=Si[1];lt(xe,A.x,A.y,xr.x,Aa+xr.y,ii.x,ii.y,r,Qn,Dn.x,Dn.y,Nn,na),lt(xe,A.x,A.y,Lr.x,Aa+Lr.y,ii.x+ii.w,ii.y,r,Qn,fi.x,Dn.y,Nn,na),lt(xe,A.x,A.y,rn.x,Aa+rn.y,ii.x,ii.y+ii.h,r,Qn,Dn.x,fi.y,Nn,na),lt(xe,A.x,A.y,vn.x,Aa+vn.y,ii.x+ii.w,ii.y+ii.h,r,Qn,fi.x,fi.y,Nn,na),Ft(e.dynamicLayoutVertexArray,A,it),me.emplaceBack(Ki,Ki+1,Ki+2),me.emplaceBack(Ki+1,Ki+2,Ki+3),Ge.vertexLength+=4,Ge.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Si[0]),Ht!==t.length-1&&da===t[Ht+1].sectionIndex||e.programConfigurations.populatePaintArrays(xe.length,g,g.index,{},oe,Lt&&Lt[da])}e.placedSymbolArray.emplaceBack(A.x,A.y,He,this.glyphOffsetArray.length-He,gt,R,j,A.segment,r?r[0]:0,r?r[1]:0,c[0],c[1],x,0,!1,0,J)},ut.prototype._addCollisionDebugVertex=function(e,t,r,c,d,g){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,c,d,Math.round(g.x),Math.round(g.y))},ut.prototype.addCollisionDebugVertices=function(e,t,r,c,d,g,x){var A=d.segments.prepareSegment(4,d.layoutVertexArray,d.indexArray),R=A.vertexLength,j=d.layoutVertexArray,J=d.collisionVertexArray,oe=x.anchorX,me=x.anchorY;this._addCollisionDebugVertex(j,J,g,oe,me,new q(e,t)),this._addCollisionDebugVertex(j,J,g,oe,me,new q(r,t)),this._addCollisionDebugVertex(j,J,g,oe,me,new q(r,c)),this._addCollisionDebugVertex(j,J,g,oe,me,new q(e,c)),A.vertexLength+=4;var xe=d.indexArray;xe.emplaceBack(R,R+1),xe.emplaceBack(R+1,R+2),xe.emplaceBack(R+2,R+3),xe.emplaceBack(R+3,R),A.primitiveLength+=4},ut.prototype.addDebugCollisionBoxes=function(e,t,r,c){for(var d=e;d<t;d++){var g=this.collisionBoxArray.get(d);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,c?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,r)}},ut.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ht(Sl,Mp.members,cc),this.iconCollisionBox=new ht(Sl,Mp.members,cc);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},ut.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,c,d,g,x,A,R){for(var j={},J=t;J<r;J++){var oe=e.get(J);j.textBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,anchorPointX:oe.anchorPointX,anchorPointY:oe.anchorPointY},j.textFeatureIndex=oe.featureIndex;break}for(var me=c;me<d;me++){var xe=e.get(me);j.verticalTextBox={x1:xe.x1,y1:xe.y1,x2:xe.x2,y2:xe.y2,anchorPointX:xe.anchorPointX,anchorPointY:xe.anchorPointY},j.verticalTextFeatureIndex=xe.featureIndex;break}for(var Ge=g;Ge<x;Ge++){var He=e.get(Ge);j.iconBox={x1:He.x1,y1:He.y1,x2:He.x2,y2:He.y2,anchorPointX:He.anchorPointX,anchorPointY:He.anchorPointY},j.iconFeatureIndex=He.featureIndex;break}for(var gt=A;gt<R;gt++){var it=e.get(gt);j.verticalIconBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},j.verticalIconFeatureIndex=it.featureIndex;break}return j},ut.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},ut.prototype.hasTextData=function(){return this.text.segments.get().length>0},ut.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ut.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ut.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ut.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ut.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),c=r.vertexStartIndex+4*r.numGlyphs,d=r.vertexStartIndex;d<c;d+=4)e.indexArray.emplaceBack(d,d+1,d+2),e.indexArray.emplaceBack(d+1,d+2,d+3)},ut.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),c=[],d=[],g=[],x=0;x<this.symbolInstances.length;++x){g.push(x);var A=this.symbolInstances.get(x);c.push(0|Math.round(t*A.anchorX+r*A.anchorY)),d.push(A.featureIndex)}return g.sort(function(R,j){return c[R]-c[j]||d[j]-d[R]}),g},ut.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},ut.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,c=this.symbolInstanceIndexes;r<c.length;r+=1){var d=this.symbolInstances.get(c[r]);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach(function(g,x,A){g>=0&&A.indexOf(g)===x&&t.addIndicesForPlacedSymbol(t.text,g)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Bn("SymbolBucket",ut,{omit:["layers","collisionBoxArray","features","compareText"]}),ut.MAX_GLYPHS=65535,ut.addDynamicAttributes=Ft;var Be=new Po({"symbol-placement":new ri(ce.layout_symbol["symbol-placement"]),"symbol-spacing":new ri(ce.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ri(ce.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new An(ce.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ri(ce.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ri(ce.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ri(ce.layout_symbol["icon-ignore-placement"]),"icon-optional":new ri(ce.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ri(ce.layout_symbol["icon-rotation-alignment"]),"icon-size":new An(ce.layout_symbol["icon-size"]),"icon-text-fit":new ri(ce.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ri(ce.layout_symbol["icon-text-fit-padding"]),"icon-image":new An(ce.layout_symbol["icon-image"]),"icon-rotate":new An(ce.layout_symbol["icon-rotate"]),"icon-padding":new ri(ce.layout_symbol["icon-padding"]),"icon-keep-upright":new ri(ce.layout_symbol["icon-keep-upright"]),"icon-offset":new An(ce.layout_symbol["icon-offset"]),"icon-anchor":new An(ce.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ri(ce.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ri(ce.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ri(ce.layout_symbol["text-rotation-alignment"]),"text-field":new An(ce.layout_symbol["text-field"]),"text-font":new An(ce.layout_symbol["text-font"]),"text-size":new An(ce.layout_symbol["text-size"]),"text-max-width":new An(ce.layout_symbol["text-max-width"]),"text-line-height":new ri(ce.layout_symbol["text-line-height"]),"text-letter-spacing":new An(ce.layout_symbol["text-letter-spacing"]),"text-justify":new An(ce.layout_symbol["text-justify"]),"text-radial-offset":new An(ce.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ri(ce.layout_symbol["text-variable-anchor"]),"text-anchor":new An(ce.layout_symbol["text-anchor"]),"text-max-angle":new ri(ce.layout_symbol["text-max-angle"]),"text-writing-mode":new ri(ce.layout_symbol["text-writing-mode"]),"text-rotate":new An(ce.layout_symbol["text-rotate"]),"text-padding":new ri(ce.layout_symbol["text-padding"]),"text-keep-upright":new ri(ce.layout_symbol["text-keep-upright"]),"text-transform":new An(ce.layout_symbol["text-transform"]),"text-offset":new An(ce.layout_symbol["text-offset"]),"text-allow-overlap":new ri(ce.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ri(ce.layout_symbol["text-ignore-placement"]),"text-optional":new ri(ce.layout_symbol["text-optional"])}),ot={paint:new Po({"icon-opacity":new An(ce.paint_symbol["icon-opacity"]),"icon-color":new An(ce.paint_symbol["icon-color"]),"icon-halo-color":new An(ce.paint_symbol["icon-halo-color"]),"icon-halo-width":new An(ce.paint_symbol["icon-halo-width"]),"icon-halo-blur":new An(ce.paint_symbol["icon-halo-blur"]),"icon-translate":new ri(ce.paint_symbol["icon-translate"]),"icon-translate-anchor":new ri(ce.paint_symbol["icon-translate-anchor"]),"text-opacity":new An(ce.paint_symbol["text-opacity"]),"text-color":new An(ce.paint_symbol["text-color"],{runtimeType:ln,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new An(ce.paint_symbol["text-halo-color"]),"text-halo-width":new An(ce.paint_symbol["text-halo-width"]),"text-halo-blur":new An(ce.paint_symbol["text-halo-blur"]),"text-translate":new ri(ce.paint_symbol["text-translate"]),"text-translate-anchor":new ri(ce.paint_symbol["text-translate-anchor"])}),layout:Be},Ze=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Cn,this.defaultValue=e};Ze.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},Ze.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},Ze.prototype.outputDefined=function(){return!1},Ze.prototype.serialize=function(){return null},Bn("FormatSectionOverride",Ze,{omit:["defaultValue"]});var Nt=function(e){function t(r){e.call(this,r,ot)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,c){if(e.prototype.recalculate.call(this,r,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var d=this.layout.get("text-writing-mode");if(d){for(var g=[],x=0,A=d;x<A.length;x+=1){var R=A[x];g.indexOf(R)<0&&g.push(R)}this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,c,d,g){var R,x=this.layout.get(r).evaluate(c,{},d,g),A=this._unevaluatedLayout._values[r];return A.isDataDriven()||$u(A.value)||!x?x:(R=c.properties,x.replace(/{([^{}]+)}/g,function(J,oe){return oe in R?String(R[oe]):""}))},t.prototype.createBucket=function(r){return new ut(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,c=ot.paint.overridableProperties;r<c.length;r+=1){var d=c[r];if(t.hasPaintOverride(this.layout,d)){var g,x=this.paint.get(d),A=new Ze(x),R=new yu(A,x.property.specification);g="constant"===x.value.kind||"source"===x.value.kind?new Qu("source",R):new el("composite",R,x.value.zoomStops,x.value._interpolationType),this.paint._values[d]=new mo(x.property,g,x.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,c){var d=r.get("text-field"),g=ot.paint.properties[c],x=!1,A=function(J){for(var oe=0,me=J;oe<me.length;oe+=1)if(g.overrides&&g.overrides.hasOverride(me[oe]))return void(x=!0)};if("constant"===d.value.kind&&d.value.value instanceof Za)A(d.value.value.sections);else if("source"===d.value.kind){var R=function(J){x||(J instanceof Fi&&Da(J.value)===ta?A(J.value.sections):J instanceof vo?A(J.sections):J.eachChild(R))},j=d.value;j._styleExpression&&R(j._styleExpression.expression)}return x},t}(fo),Gt={paint:new Po({"background-color":new ri(ce.paint_background["background-color"]),"background-pattern":new So(ce.paint_background["background-pattern"]),"background-opacity":new ri(ce.paint_background["background-opacity"])})},zr=function(e){function t(r){e.call(this,r,Gt)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(fo),sn={paint:new Po({"raster-opacity":new ri(ce.paint_raster["raster-opacity"]),"raster-hue-rotate":new ri(ce.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ri(ce.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ri(ce.paint_raster["raster-brightness-max"]),"raster-saturation":new ri(ce.paint_raster["raster-saturation"]),"raster-contrast":new ri(ce.paint_raster["raster-contrast"]),"raster-resampling":new ri(ce.paint_raster["raster-resampling"]),"raster-fade-duration":new ri(ce.paint_raster["raster-fade-duration"])})},un=function(e){function t(r){e.call(this,r,sn)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(fo),_n=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},t.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(fo),an={circle:Ko,heatmap:Wf,hillshade:xh,fill:ql,"fill-extrusion":Ch,line:Ap,symbol:Nt,background:zr,raster:un},Yn=Y.HTMLImageElement,In=Y.HTMLCanvasElement,Vn=Y.HTMLVideoElement,Kn=Y.ImageData,Gn=Y.ImageBitmap,ci=function(e,t,r,c){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,c)};ci.prototype.update=function(e,t,r){var c=e.width,d=e.height,g=!(this.size&&this.size[0]===c&&this.size[1]===d||r),x=this.context,A=x.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),A.bindTexture(A.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===A.RGBA&&(!t||!1!==t.premultiply)),g)this.size=[c,d],e instanceof Yn||e instanceof In||e instanceof Vn||e instanceof Kn||Gn&&e instanceof Gn?A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,A.UNSIGNED_BYTE,e):A.texImage2D(A.TEXTURE_2D,0,this.format,c,d,0,this.format,A.UNSIGNED_BYTE,e.data);else{var R=r||{x:0,y:0},j=R.x,J=R.y;e instanceof Yn||e instanceof In||e instanceof Vn||e instanceof Kn||Gn&&e instanceof Gn?A.texSubImage2D(A.TEXTURE_2D,0,j,J,A.RGBA,A.UNSIGNED_BYTE,e):A.texSubImage2D(A.TEXTURE_2D,0,j,J,c,d,A.RGBA,A.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&A.generateMipmap(A.TEXTURE_2D)},ci.prototype.bind=function(e,t,r){var c=this.context.gl;c.bindTexture(c.TEXTURE_2D,this.texture),r!==c.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=c.LINEAR),e!==this.filter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,e),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,t),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,t),this.wrap=t)},ci.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ci.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var qa=function(e){var t=this;this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};qa.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},qa.prototype.remove=function(){delete this._channel,this._callback=function(){}};var jo=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},vr(["receive","process"],this),this.invoker=new qa(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=hr()?e:Y};function $l(e,t,r){var c=2*Math.PI*6378137/256/Math.pow(2,r);return[e*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}jo.prototype.send=function(e,t,r,c,d){var g=this;void 0===d&&(d=!1);var x=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[x]=r);var A=ve(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:e,hasCallback:!!r,targetMapId:c,mustQueue:d,sourceMapId:this.mapId,data:iu(t,A)},A),{cancel:function(){r&&delete g.callbacks[x],g.target.postMessage({id:x,type:"<cancel>",targetMapId:c,sourceMapId:g.mapId})}}},jo.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[r];var c=this.cancelCallbacks[r];delete this.cancelCallbacks[r],c&&c()}else hr()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},jo.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},jo.prototype.processTask=function(e,t){var r=this;if("<response>"===t.type){var c=this.callbacks[e];delete this.callbacks[e],c&&(t.error?c(Es(t.error)):c(null,Es(t.data)))}else{var d=!1,g=ve(this.globalScope)?void 0:[],x=t.hasCallback?function(J,oe){d=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:J?iu(J):null,data:iu(oe,g)},g)}:function(J){d=!0},A=null,R=Es(t.data);if(this.parent[t.type])A=this.parent[t.type](t.sourceMapId,R,x);else if(this.parent.getWorkerSource){var j=t.type.split(".");A=this.parent.getWorkerSource(t.sourceMapId,j[0],R.source)[j[1]](R,x)}else x(new Error("Could not find function "+t.type));!d&&A&&A.cancel&&(this.cancelCallbacks[e]=A.cancel)}},jo.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ao=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};ao.prototype.setNorthEast=function(e){return this._ne=e instanceof Fa?new Fa(e.lng,e.lat):Fa.convert(e),this},ao.prototype.setSouthWest=function(e){return this._sw=e instanceof Fa?new Fa(e.lng,e.lat):Fa.convert(e),this},ao.prototype.extend=function(e){var t,r,c=this._sw,d=this._ne;if(e instanceof Fa)t=e,r=e;else{if(!(e instanceof ao))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(ao.convert(e)):this.extend(Fa.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return c||d?(c.lng=Math.min(t.lng,c.lng),c.lat=Math.min(t.lat,c.lat),d.lng=Math.max(r.lng,d.lng),d.lat=Math.max(r.lat,d.lat)):(this._sw=new Fa(t.lng,t.lat),this._ne=new Fa(r.lng,r.lat)),this},ao.prototype.getCenter=function(){return new Fa((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ao.prototype.getSouthWest=function(){return this._sw},ao.prototype.getNorthEast=function(){return this._ne},ao.prototype.getNorthWest=function(){return new Fa(this.getWest(),this.getNorth())},ao.prototype.getSouthEast=function(){return new Fa(this.getEast(),this.getSouth())},ao.prototype.getWest=function(){return this._sw.lng},ao.prototype.getSouth=function(){return this._sw.lat},ao.prototype.getEast=function(){return this._ne.lng},ao.prototype.getNorth=function(){return this._ne.lat},ao.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ao.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ao.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ao.prototype.contains=function(e){var t=Fa.convert(e),r=t.lng,c=t.lat,d=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d},ao.convert=function(e){return!e||e instanceof ao?e:new ao(e)};var Fa=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Fa.prototype.wrap=function(){return new Fa(tt(this.lng,-180,180),this.lat)},Fa.prototype.toArray=function(){return[this.lng,this.lat]},Fa.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Fa.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,c=e.lat*t,d=Math.sin(r)*Math.sin(c)+Math.cos(r)*Math.cos(c)*Math.cos((e.lng-this.lng)*t);return 6371008.8*Math.acos(Math.min(d,1))},Fa.prototype.toBounds=function(e){void 0===e&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new ao(new Fa(this.lng-r,this.lat-t),new Fa(this.lng+r,this.lat+t))},Fa.convert=function(e){if(e instanceof Fa)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Fa(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Fa(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var zs=2*Math.PI*6371008.8;function Xu(e){return zs*Math.cos(e*Math.PI/180)}function Ou(e){return(180+e)/360}function Ih(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Yu(e,t){return e/Xu(t)}function Qf(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var eh=function(e,t,r){void 0===r&&(r=0),this.x=+e,this.y=+t,this.z=+r};eh.fromLngLat=function(e,t){void 0===t&&(t=0);var r=Fa.convert(e);return new eh(Ou(r.lng),Ih(r.lat),Yu(t,r.lat))},eh.prototype.toLngLat=function(){return new Fa(360*this.x-180,Qf(this.y))},eh.prototype.toAltitude=function(){return this.z*Xu(Qf(this.y))},eh.prototype.meterInMercatorCoordinateUnits=function(){return 1/zs*(e=Qf(this.y),1/Math.cos(e*Math.PI/180));var e};var Zc=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=op(0,e,e,t,r)};Zc.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Zc.prototype.url=function(e,t){var r,c,d,g,x,A=(c=this.y,d=this.z,g=$l(256*(r=this.x),256*(c=Math.pow(2,d)-c-1),d),x=$l(256*(r+1),256*(c+1),d),g[0]+","+g[1]+","+x[0]+","+x[1]),R=function(j,J,oe){for(var me,xe="",Ge=j;Ge>0;Ge--)xe+=(J&(me=1<<Ge-1)?1:0)+(oe&me?2:0);return xe}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",R).replace("{bbox-epsg-3857}",A)},Zc.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new q(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Zc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var td=function(e,t){this.wrap=e,this.canonical=t,this.key=op(e,t.z,t.z,t.x,t.y)},cs=function(e,t,r,c,d){this.overscaledZ=e,this.wrap=t,this.canonical=new Zc(r,+c,+d),this.key=op(t,e,r,c,d)};function op(e,t,r,c,d){(e*=2)<0&&(e=-1*e-1);var g=1<<r;return(g*g*e+g*d+c).toString(36)+r.toString(36)+t.toString(36)}cs.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},cs.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new cs(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new cs(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},cs.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?op(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):op(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},cs.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},cs.prototype.children=function(e){if(this.overscaledZ>=e)return[new cs(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,c=2*this.canonical.y;return[new cs(t,this.wrap,t,r,c),new cs(t,this.wrap,t,r+1,c),new cs(t,this.wrap,t,r,c+1),new cs(t,this.wrap,t,r+1,c+1)]},cs.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},cs.prototype.wrapped=function(){return new cs(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},cs.prototype.unwrapTo=function(e){return new cs(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},cs.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},cs.prototype.toUnwrapped=function(){return new td(this.wrap,this.canonical)},cs.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},cs.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new eh(e.x-this.wrap,e.y))},Bn("CanonicalTileID",Zc),Bn("OverscaledTileID",cs,{omit:["posMatrix"]});var _f=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return qe('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var c=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var d=0;d<c;d++)this.data[this._idx(-1,d)]=this.data[this._idx(0,d)],this.data[this._idx(c,d)]=this.data[this._idx(c-1,d)],this.data[this._idx(d,-1)]=this.data[this._idx(d,0)],this.data[this._idx(d,c)]=this.data[this._idx(d,c-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(c,-1)]=this.data[this._idx(c-1,0)],this.data[this._idx(-1,c)]=this.data[this._idx(0,c-1)],this.data[this._idx(c,c)]=this.data[this._idx(c-1,c-1)]};_f.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),c=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(r[c],r[c+1],r[c+2])},_f.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},_f.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},_f.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},_f.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},_f.prototype.getPixels=function(){return new ca({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},_f.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var c=t*this.dim,d=t*this.dim+this.dim,g=r*this.dim,x=r*this.dim+this.dim;switch(t){case-1:c=d-1;break;case 1:d=c+1}switch(r){case-1:g=x-1;break;case 1:x=g+1}for(var A=-t*this.dim,R=-r*this.dim,j=g;j<x;j++)for(var J=c;J<d;J++)this.data[this._idx(J,j)]=e.data[this._idx(J+A,j+R)]},Bn("DEMData",_f);var th=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};th.prototype.encode=function(e){return this._stringToNumber[e]},th.prototype.decode=function(e){return this._numberToString[e]};var rh=function(e,t,r,c,d){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=c,this.properties=e.properties,this.id=d},Oh={geometry:{configurable:!0}};Oh.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Oh.geometry.set=function(e){this._geometry=e},rh.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e},Object.defineProperties(rh.prototype,Oh);var Rf=function(){this.state={},this.stateChanges={},this.deletedStates={}};Rf.prototype.updateState=function(e,t,r){var c=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][c]=this.stateChanges[e][c]||{},Mt(this.stateChanges[e][c],r),null===this.deletedStates[e])for(var d in this.deletedStates[e]={},this.state[e])d!==c&&(this.deletedStates[e][d]=null);else if(this.deletedStates[e]&&null===this.deletedStates[e][c])for(var g in this.deletedStates[e][c]={},this.state[e][c])r[g]||(this.deletedStates[e][c][g]=null);else for(var x in r)this.deletedStates[e]&&this.deletedStates[e][c]&&null===this.deletedStates[e][c][x]&&delete this.deletedStates[e][c][x]},Rf.prototype.removeFeatureState=function(e,t,r){if(null!==this.deletedStates[e]){var c=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][c]&&(this.deletedStates[e][c]=this.deletedStates[e][c]||{},this.deletedStates[e][c][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][c])for(r in this.deletedStates[e][c]={},this.stateChanges[e][c])this.deletedStates[e][c][r]=null;else this.deletedStates[e][c]=null;else this.deletedStates[e]=null}},Rf.prototype.getState=function(e,t){var r=String(t),c=Mt({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){var d=this.deletedStates[e][t];if(null===d)return{};for(var g in d)delete c[g]}return c},Rf.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},Rf.prototype.coalesceChanges=function(e,t){var r={};for(var c in this.stateChanges){this.state[c]=this.state[c]||{};var d={};for(var g in this.stateChanges[c])this.state[c][g]||(this.state[c][g]={}),Mt(this.state[c][g],this.stateChanges[c][g]),d[g]=this.state[c][g];r[c]=d}for(var x in this.deletedStates){this.state[x]=this.state[x]||{};var A={};if(null===this.deletedStates[x])for(var R in this.state[x])A[R]={},this.state[x][R]={};else for(var j in this.deletedStates[x]){if(null===this.deletedStates[x][j])this.state[x][j]={};else for(var J=0,oe=Object.keys(this.deletedStates[x][j]);J<oe.length;J+=1)delete this.state[x][j][oe[J]];A[j]=this.state[x][j]}r[x]=r[x]||{},Mt(r[x],A)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(var me in e)e[me].setFeatureState(r,t)};var Ql=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new _u(8192,16,0),this.grid3D=new _u(8192,16,0),this.featureIndexArray=new le,this.promoteId=t};function sp(e,t,r,c,d){return nr(e,function(g,x){var A=t instanceof il?t.get(x):null;return A&&A.evaluate?A.evaluate(r,c,d):A})}function vd(e){for(var t=1/0,r=1/0,c=-1/0,d=-1/0,g=0,x=e;g<x.length;g+=1){var A=x[g];t=Math.min(t,A.x),r=Math.min(r,A.y),c=Math.max(c,A.x),d=Math.max(d,A.y)}return{minX:t,minY:r,maxX:c,maxY:d}}function Zd(e,t){return t-e}Ql.prototype.insert=function(e,t,r,c,d,g){var x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,c,d);for(var A=g?this.grid3D:this.grid,R=0;R<t.length;R++){for(var j=t[R],J=[1/0,1/0,-1/0,-1/0],oe=0;oe<j.length;oe++){var me=j[oe];J[0]=Math.min(J[0],me.x),J[1]=Math.min(J[1],me.y),J[2]=Math.max(J[2],me.x),J[3]=Math.max(J[3],me.y)}J[0]<8192&&J[1]<8192&&J[2]>=0&&J[3]>=0&&A.insert(x,J[0],J[1],J[2],J[3])}},Ql.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new gf.VectorTile(new zc(this.rawTileData)).layers,this.sourceLayerCoder=new th(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ql.prototype.query=function(e,t,r,c){var d=this;this.loadVTLayers();for(var g=e.params||{},x=8192/e.tileSize/e.scale,A=Nu(g.filter),R=e.queryGeometry,j=e.queryPadding*x,J=vd(R),oe=this.grid.query(J.minX-j,J.minY-j,J.maxX+j,J.maxY+j),me=vd(e.cameraQueryGeometry),Ge=0,He=this.grid3D.query(me.minX-j,me.minY-j,me.maxX+j,me.maxY+j,function(fr,xr,Lr,rn){return function(vn,ii,Dn,fi,Nn){for(var na=0,Si=vn;na<Si.length;na+=1){var Qn=Si[na];if(ii<=Qn.x&&Dn<=Qn.y&&fi>=Qn.x&&Nn>=Qn.y)return!0}var da=[new q(ii,Dn),new q(ii,Nn),new q(fi,Nn),new q(fi,Dn)];if(vn.length>2)for(var Ki=0,Aa=da;Ki<Aa.length;Ki+=1)if(Ha(vn,Aa[Ki]))return!0;for(var di=0;di<vn.length-1;di++)if(Wa(vn[di],vn[di+1],da))return!0;return!1}(e.cameraQueryGeometry,fr-j,xr-j,Lr+j,rn+j)});Ge<He.length;Ge+=1)oe.push(He[Ge]);oe.sort(Zd);for(var gt,it={},Lt=function(fr){var xr=oe[fr];if(xr!==gt){gt=xr;var Lr=d.featureIndexArray.get(xr),rn=null;d.loadMatchingFeature(it,Lr.bucketIndex,Lr.sourceLayerIndex,Lr.featureIndex,A,g.layers,g.availableImages,t,r,c,function(vn,ii,Dn){return rn||(rn=ct(vn)),ii.queryIntersectsFeature(R,vn,Dn,rn,d.z,e.transform,x,e.pixelPosMatrix)})}},Ht=0;Ht<oe.length;Ht++)Lt(Ht);return it},Ql.prototype.loadMatchingFeature=function(e,t,r,c,d,g,x,A,R,j,J){var oe=this.bucketLayerIDs[t];if(!g||function(vn,ii){for(var Dn=0;Dn<vn.length;Dn++)if(ii.indexOf(vn[Dn])>=0)return!0;return!1}(g,oe)){var me=this.sourceLayerCoder.decode(r),xe=this.vtLayers[me].feature(c);if(d.needGeometry){var Ge=Pt(xe,!0);if(!d.filter(new $i(this.tileID.overscaledZ),Ge,this.tileID.canonical))return}else if(!d.filter(new $i(this.tileID.overscaledZ),xe))return;for(var He=this.getId(xe,me),gt=0;gt<oe.length;gt++){var it=oe[gt];if(!(g&&g.indexOf(it)<0)){var Lt=A[it];if(Lt){var Ht={};void 0!==He&&j&&(Ht=j.getState(Lt.sourceLayer||"_geojsonTileLayer",He));var fr=Mt({},R[it]);fr.paint=sp(fr.paint,Lt.paint,xe,Ht,x),fr.layout=sp(fr.layout,Lt.layout,xe,Ht,x);var xr=!J||J(xe,Lt,Ht);if(xr){var Lr=new rh(xe,this.z,this.x,this.y,He);Lr.layer=fr;var rn=e[it];void 0===rn&&(rn=e[it]=[]),rn.push({featureIndex:c,feature:Lr,intersectionZ:xr})}}}}}},Ql.prototype.lookupSymbolFeatures=function(e,t,r,c,d,g,x,A){var R={};this.loadVTLayers();for(var j=Nu(d),J=0,oe=e;J<oe.length;J+=1)this.loadMatchingFeature(R,r,c,oe[J],j,g,x,A,t);return R},Ql.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var c=0,d=r[t];c<d.length;c+=1)if(e===d[c])return!0;return!1},Ql.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&"boolean"==typeof(r=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]])&&(r=Number(r)),r},Bn("FeatureIndex",Ql,{omit:["rawTileData","sourceLayerCoder"]});var Ms=function(e,t){this.tileID=e,this.uid=Ut(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ms.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<Pr.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},Ms.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Ms.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var c in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(j,J){var oe={};if(!J)return oe;for(var me=function(){var He=Ge[xe],gt=He.layerIds.map(function(Ht){return J.getLayer(Ht)}).filter(Boolean);if(0!==gt.length){He.layers=gt,He.stateDependentLayerIds&&(He.stateDependentLayers=He.stateDependentLayerIds.map(function(Ht){return gt.filter(function(fr){return fr.id===Ht})[0]}));for(var it=0,Lt=gt;it<Lt.length;it+=1)oe[Lt[it].id]=He}},xe=0,Ge=j;xe<Ge.length;xe+=1)me();return oe}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var d=this.buckets[c];if(d instanceof ut){if(this.hasSymbolBuckets=!0,!r)break;d.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var g in this.buckets){var x=this.buckets[g];if(x instanceof ut&&x.hasRTLText){this.hasRTLText=!0,Cs.isLoading()||Cs.isLoaded()||"deferred"!==kc()||Ws();break}}for(var A in this.queryPadding=0,this.buckets){var R=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(A).queryRadius(R))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s},Ms.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ms.prototype.getBucket=function(e){return this.buckets[e.id]},Ms.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var c=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ci(e,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ci(e,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)},Ms.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},Ms.prototype.queryRenderedFeatures=function(e,t,r,c,d,g,x,A,R,j){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:d,scale:g,tileSize:this.tileSize,pixelPosMatrix:j,transform:A,params:x,queryPadding:this.queryPadding*R},e,t,r):{}},Ms.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var c=r.loadVTLayers(),d=t?t.sourceLayer:"",g=c._geojsonTileLayer||c[d];if(g)for(var x=Nu(t&&t.filter),A=this.tileID.canonical,R=A.z,j=A.x,J=A.y,oe={z:R,x:j,y:J},me=0;me<g.length;me++){var xe=g.feature(me);if(x.needGeometry){var Ge=Pt(xe,!0);if(!x.filter(new $i(this.tileID.overscaledZ),Ge,this.tileID.canonical))continue}else if(!x.filter(new $i(this.tileID.overscaledZ),xe))continue;var He=r.getId(xe,d),gt=new rh(xe,R,j,J,He);gt.tile=oe,e.push(gt)}}},Ms.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Ms.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ms.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=Dr(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var c=Date.now(),d=!1;if(this.expirationTime>c)d=!1;else if(t)if(this.expirationTime<t)d=!0;else{var g=this.expirationTime-t;g?this.expirationTime=c+Math.max(g,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ms.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Ms.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(e).length){var r=this.latestFeatureIndex.loadVTLayers();for(var c in this.buckets)if(t.style.hasLayer(c)){var d=this.buckets[c],g=d.layers[0].sourceLayer||"_geojsonTileLayer",x=r[g],A=e[g];if(x&&A&&0!==Object.keys(A).length){d.update(A,x,this.imageAtlas&&this.imageAtlas.patternPositions||{});var R=t&&t.style&&t.style.getLayer(c);R&&(this.queryPadding=Math.max(this.queryPadding,R.queryRadius(d)))}}}},Ms.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Ms.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Pr.now()},Ms.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ms.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=Pr.now()+e},Ms.prototype.setDependencies=function(e,t){for(var r={},c=0,d=t;c<d.length;c+=1)r[d[c]]=!0;this.dependencies[e]=r},Ms.prototype.hasDependency=function(e,t){for(var r=0,c=e;r<c.length;r+=1){var d=this.dependencies[c[r]];if(d)for(var g=0,x=t;g<x.length;g+=1)if(d[x[g]])return!0}return!1};var xf=Y.performance,Ml=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},xf.mark(this._marks.start)};Ml.prototype.finish=function(){xf.mark(this._marks.end);var e=xf.getEntriesByName(this._marks.measure);return 0===e.length&&(xf.measure(this._marks.measure,this._marks.start,this._marks.end),e=xf.getEntriesByName(this._marks.measure),xf.clearMarks(this._marks.start),xf.clearMarks(this._marks.end),xf.clearMeasures(this._marks.measure)),e},p.Actor=jo,p.AlphaImage=Wu,p.CanonicalTileID=Zc,p.CollisionBoxArray=s,p.Color=Xi,p.DEMData=_f,p.DataConstantProperty=ri,p.DictionaryCoder=th,p.EXTENT=8192,p.ErrorEvent=ye,p.EvaluationParameters=$i,p.Event=re,p.Evented=Me,p.FeatureIndex=Ql,p.FillBucket=Ns,p.FillExtrusionBucket=Ps,p.ImageAtlas=Tn,p.ImagePosition=gr,p.LineBucket=Zo,p.LngLat=Fa,p.LngLatBounds=ao,p.MercatorCoordinate=eh,p.ONE_EM=24,p.OverscaledTileID=cs,p.Point=q,p.Point$1=q,p.Properties=Po,p.Protobuf=zc,p.RGBAImage=ca,p.RequestManager=Ar,p.RequestPerformance=Ml,p.ResourceType=Wn,p.SegmentVector=Ae,p.SourceFeatureState=Rf,p.StructArrayLayout1ui2=fc,p.StructArrayLayout2f1f2i16=ol,p.StructArrayLayout2i4=As,p.StructArrayLayout3ui6=sl,p.StructArrayLayout4i8=bl,p.SymbolBucket=ut,p.Texture=ci,p.Tile=Ms,p.Transitionable=Yo,p.Uniform1f=$r,p.Uniform1i=Rr,p.Uniform2f=Xr,p.Uniform3f=pn,p.Uniform4f=qn,p.UniformColor=Un,p.UniformMatrix4f=ki,p.UnwrappedTileID=td,p.ValidationError=Te,p.WritingMode=Mr,p.ZoomHistory=Xc,p.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},p.addDynamicAttributes=Ft,p.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var c=e.length,d=new Array(e.length),g=null;e.forEach(function(x,A){t(x,function(R,j){R&&(g=R),d[A]=j,0==--c&&r(g,d)})})},p.bezier=et,p.bindAll=vr,p.browser=Pr,p.cacheEntryPossiblyAdded=function(e){++pr>_r&&(e.getActor().send("enforceCacheSizeLimit",Cr),pr=0)},p.clamp=Z,p.clearTileCache=function(e){var t=Y.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},p.clipLine=ss,p.clone=function(e){var t=new Li(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},p.clone$1=$e,p.clone$2=function(e){var t=new Li(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},p.collisionCircleLayout=Ip,p.config=wt,p.create=function(){var e=new Li(16);return Li!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},p.create$1=function(){var e=new Li(9);return Li!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},p.create$2=function(){var e=new Li(4);return Li!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},p.createCommonjsModule=_,p.createExpression=pl,p.createLayout=zo,p.createStyleLayer=function(e){return"custom"===e.type?new _n(e):new an[e.type](e)},p.cross=function(e,t,r){var c=t[0],d=t[1],g=t[2],x=r[0],A=r[1],R=r[2];return e[0]=d*R-g*A,e[1]=g*x-c*R,e[2]=c*A-d*x,e},p.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var c=0;c<t.length;c++)if(!e(t[c],r[c]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==r){if("object"!=typeof r||Object.keys(t).length!==Object.keys(r).length)return!1;for(var d in t)if(!e(t[d],r[d]))return!1;return!0}return t===r},p.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},p.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},p.ease=z,p.emitValidationErrors=ml,p.endsWith=ne,p.enforceCacheSizeLimit=function(e){jt(),dt&&dt.then(function(t){t.keys().then(function(r){for(var c=0;c<r.length-e;c++)t.delete(r[c])})})},p.evaluateSizeForFeature=Zi,p.evaluateSizeForZoom=fa,p.evaluateVariableOffset=Ye,p.evented=cf,p.extend=Mt,p.featureFilter=Nu,p.filterObject=Tt,p.fromRotation=function(e,t){var r=Math.sin(t),c=Math.cos(t);return e[0]=c,e[1]=r,e[2]=0,e[3]=-r,e[4]=c,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.getAnchorAlignment=zi,p.getAnchorJustification=ur,p.getArrayBuffer=Pi,p.getImage=he,p.getJSON=function(e,t){return Yi(Mt(e,{type:"json"}),t)},p.getRTLTextPluginStatus=kc,p.getReferrer=hi,p.getVideo=function(e,t){var r,c,d=Y.document.createElement("video");d.muted=!0,d.onloadstart=function(){t(null,d)};for(var g=0;g<e.length;g++){var x=Y.document.createElement("source");r=e[g],c=void 0,(c=Y.document.createElement("a")).href=r,(c.protocol!==Y.document.location.protocol||c.host!==Y.document.location.host)&&(d.crossOrigin="Anonymous"),x.src=e[g],d.appendChild(x)}return{cancel:function(){}}},p.identity=Ca,p.invert=function(e,t){var r=t[0],c=t[1],d=t[2],g=t[3],x=t[4],A=t[5],R=t[6],j=t[7],J=t[8],oe=t[9],me=t[10],xe=t[11],Ge=t[12],He=t[13],gt=t[14],it=t[15],Lt=r*A-c*x,Ht=r*R-d*x,fr=r*j-g*x,xr=c*R-d*A,Lr=c*j-g*A,rn=d*j-g*R,vn=J*He-oe*Ge,ii=J*gt-me*Ge,Dn=J*it-xe*Ge,fi=oe*gt-me*He,Nn=oe*it-xe*He,na=me*it-xe*gt,Si=Lt*na-Ht*Nn+fr*fi+xr*Dn-Lr*ii+rn*vn;return Si?(e[0]=(A*na-R*Nn+j*fi)*(Si=1/Si),e[1]=(d*Nn-c*na-g*fi)*Si,e[2]=(He*rn-gt*Lr+it*xr)*Si,e[3]=(me*Lr-oe*rn-xe*xr)*Si,e[4]=(R*Dn-x*na-j*ii)*Si,e[5]=(r*na-d*Dn+g*ii)*Si,e[6]=(gt*fr-Ge*rn-it*Ht)*Si,e[7]=(J*rn-me*fr+xe*Ht)*Si,e[8]=(x*Nn-A*Dn+j*vn)*Si,e[9]=(c*Dn-r*Nn-g*vn)*Si,e[10]=(Ge*Lr-He*fr+it*Lt)*Si,e[11]=(oe*fr-J*Lr-xe*Lt)*Si,e[12]=(A*ii-x*fi-R*vn)*Si,e[13]=(r*fi-c*ii+d*vn)*Si,e[14]=(He*Ht-Ge*xr-gt*Lt)*Si,e[15]=(J*xr-oe*Ht+me*Lt)*Si,e):null},p.isChar=cn,p.isMapboxURL=Yt,p.keysDifference=function(e,t){var r=[];for(var c in e)c in t||r.push(c);return r},p.makeRequest=Yi,p.mapObject=nr,p.mercatorXfromLng=Ou,p.mercatorYfromLat=Ih,p.mercatorZfromAltitude=Yu,p.mul=Yl,p.multiply=ba,p.mvt=gf,p.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},p.normalize=function(e,t){var r=t[0],c=t[1],d=t[2],g=r*r+c*c+d*d;return g>0&&(g=1/Math.sqrt(g)),e[0]=t[0]*g,e[1]=t[1]*g,e[2]=t[2]*g,e},p.number=Oa,p.offscreenCanvasSupported=Ln,p.ortho=function(e,t,r,c,d,g,x){var A=1/(t-r),R=1/(c-d),j=1/(g-x);return e[0]=-2*A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*R,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*j,e[11]=0,e[12]=(t+r)*A,e[13]=(d+c)*R,e[14]=(x+g)*j,e[15]=1,e},p.parseGlyphPBF=function(e){return new zc(e).readFields(hn,[])},p.pbf=zc,p.performSymbolLayout=function(e,t,r,c,d,g,x){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var A=e.layers[0].layout,R=e.layers[0]._unevaluatedLayout._values,j={};if("composite"===e.textSizeData.kind){var J=e.textSizeData,oe=J.maxZoom;j.compositeTextSizes=[R["text-size"].possiblyEvaluate(new $i(J.minZoom),x),R["text-size"].possiblyEvaluate(new $i(oe),x)]}if("composite"===e.iconSizeData.kind){var me=e.iconSizeData,xe=me.maxZoom;j.compositeIconSizes=[R["icon-size"].possiblyEvaluate(new $i(me.minZoom),x),R["icon-size"].possiblyEvaluate(new $i(xe),x)]}j.layoutTextSize=R["text-size"].possiblyEvaluate(new $i(e.zoom+1),x),j.layoutIconSize=R["icon-size"].possiblyEvaluate(new $i(e.zoom+1),x),j.textMaxSize=R["text-size"].possiblyEvaluate(new $i(18));for(var Ge=24*A.get("text-line-height"),He="map"===A.get("text-rotation-alignment")&&"point"!==A.get("symbol-placement"),gt=A.get("text-keep-upright"),it=A.get("text-size"),Lt=function(){var xr=fr[Ht],Lr=A.get("text-font").evaluate(xr,{},x).join(","),rn=it.evaluate(xr,{},x),vn=j.layoutTextSize.evaluate(xr,{},x),ii=j.layoutIconSize.evaluate(xr,{},x),Dn={horizontal:{},vertical:void 0},fi=xr.text,Nn=[0,0];if(fi){var na=fi.toString(),Si=24*A.get("text-letter-spacing").evaluate(xr,{},x),Qn=function(wa){for(var Ja=0,Xa=wa;Ja<Xa.length;Ja+=1)if(qi=Xa[Ja].charCodeAt(0),cn.Arabic(qi)||cn["Arabic Supplement"](qi)||cn["Arabic Extended-A"](qi)||cn["Arabic Presentation Forms-A"](qi)||cn["Arabic Presentation Forms-B"](qi))return!1;var qi;return!0}(na)?Si:0,da=A.get("text-anchor").evaluate(xr,{},x),Ki=A.get("text-variable-anchor");if(!Ki){var Aa=A.get("text-radial-offset").evaluate(xr,{},x);Nn=Aa?Ye(da,[24*Aa,Pl]):A.get("text-offset").evaluate(xr,{},x).map(function(wa){return 24*wa})}var di=He?"center":A.get("text-justify").evaluate(xr,{},x),Ra=A.get("symbol-placement"),Co="point"===Ra?24*A.get("text-max-width").evaluate(xr,{},x):0,Ao=function(){e.allowVerticalPlacement&&Yc(na)&&(Dn.vertical=ui(fi,t,r,d,Lr,Co,Ge,da,"left",Qn,Nn,Mr.vertical,!0,Ra,vn,rn))};if(!He&&Ki){for(var Do="auto"===di?Ki.map(function(wa){return ur(wa)}):[di],ho=!1,Oo=0;Oo<Do.length;Oo++){var xs=Do[Oo];if(!Dn.horizontal[xs])if(ho)Dn.horizontal[xs]=Dn.horizontal[0];else{var bs=ui(fi,t,r,d,Lr,Co,Ge,"center",xs,Qn,Nn,Mr.horizontal,!1,Ra,vn,rn);bs&&(Dn.horizontal[xs]=bs,ho=1===bs.positionedLines.length)}}Ao()}else{"auto"===di&&(di=ur(da));var fu=ui(fi,t,r,d,Lr,Co,Ge,da,di,Qn,Nn,Mr.horizontal,!1,Ra,vn,rn);fu&&(Dn.horizontal[di]=fu),Ao(),Yc(na)&&He&&gt&&(Dn.vertical=ui(fi,t,r,d,Lr,Co,Ge,da,di,Qn,Nn,Mr.vertical,!1,Ra,vn,rn))}}var wa,Ja,qi,$s,Zs,Is=void 0,hu=!1;if(xr.icon&&xr.icon.name){var Bo=c[xr.icon.name];Bo&&(wa=d[xr.icon.name],Ja=A.get("icon-offset").evaluate(xr,{},x),qi=zi(A.get("icon-anchor").evaluate(xr,{},x)),Is={image:wa,top:Zs=Ja[1]-wa.displaySize[1]*qi.verticalAlign,bottom:Zs+wa.displaySize[1],left:$s=Ja[0]-wa.displaySize[0]*qi.horizontalAlign,right:$s+wa.displaySize[0]},hu=Bo.sdf,void 0===e.sdfIcons?e.sdfIcons=Bo.sdf:e.sdfIcons!==Bo.sdf&&qe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Bo.pixelRatio!==e.pixelRatio||0!==A.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}var Os=Fn(Dn.horizontal)||Dn.vertical;e.iconsInText=!!Os&&Os.iconsInText,(Os||Is)&&function(wa,Ja,Xa,qi,$s,Zs,yo,fs,ws,Pa,vc){var cl=Zs.textMaxSize.evaluate(Ja,{});void 0===cl&&(cl=yo);var Il,Fo=wa.layers[0].layout,Uc=Fo.get("icon-offset").evaluate(Ja,{},vc),Ku=Fn(Xa.horizontal),mc=yo/24,Df=wa.tilePixelRatio*mc,nh=wa.tilePixelRatio*cl/24,af=wa.tilePixelRatio*fs,ih=wa.tilePixelRatio*Fo.get("symbol-spacing"),kh=Fo.get("text-padding")*wa.tilePixelRatio,ah=Fo.get("icon-padding")*wa.tilePixelRatio,oh=Fo.get("text-max-angle")/180*Math.PI,Lh="map"===Fo.get("text-rotation-alignment")&&"point"!==Fo.get("symbol-placement"),Rh="map"===Fo.get("icon-rotation-alignment")&&"point"!==Fo.get("symbol-placement"),Vc=Fo.get("symbol-placement"),sh=ih/2,uh=Fo.get("icon-text-fit");qi&&"none"!==uh&&(wa.allowVerticalPlacement&&Xa.vertical&&(Il=En(qi,Xa.vertical,uh,Fo.get("icon-text-fit-padding"),Uc,mc)),Ku&&(qi=En(qi,Ku,uh,Fo.get("icon-text-fit-padding"),Uc,mc)));var gc=function(md,Vh){Vh.x<0||Vh.x>=8192||Vh.y<0||Vh.y>=8192||function(Go,yc,gd,Sf,jh,yd,Gh,_c,Hh,Nf,ph,pu,Wh,zf,pp,Lp,nd,_d,Xh,dh,qu,Yh,Rp,ku,Dp){var Kh,Zf,vh,xc,mh,gh=Go.addToLineVertexArray(yc,gd),xd=0,bd=0,wd=0,Sd=0,id=-1,ad=-1,Ef={},Bp=je(""),qh=0,od=0;if(void 0===_c._unevaluatedLayout.getValue("text-radial-offset")?(qh=(Kh=_c.layout.get("text-offset").evaluate(qu,{},ku).map(function(mp){return 24*mp}))[0],od=Kh[1]):(qh=24*_c.layout.get("text-radial-offset").evaluate(qu,{},ku),od=Pl),Go.allowVerticalPlacement&&Sf.vertical){var Fp=_c.layout.get("text-rotate").evaluate(qu,{},ku)+90;xc=new La(Hh,yc,Nf,ph,pu,Sf.vertical,Wh,zf,pp,Fp),Gh&&(mh=new La(Hh,yc,Nf,ph,pu,Gh,nd,_d,pp,Fp))}if(jh){var Np=_c.layout.get("icon-rotate").evaluate(qu,{}),Ed="none"!==_c.layout.get("icon-text-fit"),zp=ms(jh,Np,Rp,Ed),Zp=Gh?ms(Gh,Np,Rp,Ed):void 0;vh=new La(Hh,yc,Nf,ph,pu,jh,nd,_d,!1,Np),xd=4*zp.length;var Td=Go.iconSizeData,yh=null;"source"===Td.kind?(yh=[128*_c.layout.get("icon-size").evaluate(qu,{})])[0]>32640&&qe(Go.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===Td.kind&&((yh=[128*Yh.compositeIconSizes[0].evaluate(qu,{},ku),128*Yh.compositeIconSizes[1].evaluate(qu,{},ku)])[0]>32640||yh[1]>32640)&&qe(Go.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Go.addSymbols(Go.icon,zp,yh,dh,Xh,qu,!1,yc,gh.lineStartIndex,gh.lineLength,-1,ku),id=Go.icon.placedSymbolArray.length-1,Zp&&(bd=4*Zp.length,Go.addSymbols(Go.icon,Zp,yh,dh,Xh,qu,Mr.vertical,yc,gh.lineStartIndex,gh.lineLength,-1,ku),ad=Go.icon.placedSymbolArray.length-1)}for(var sd in Sf.horizontal){var Up=Sf.horizontal[sd];if(!Zf){Bp=je(Up.text);var dp=_c.layout.get("text-rotate").evaluate(qu,{},ku);Zf=new La(Hh,yc,Nf,ph,pu,Up,Wh,zf,pp,dp)}var ud=1===Up.positionedLines.length;if(wd+=Kt(Go,yc,Up,yd,_c,pp,qu,Lp,gh,Sf.vertical?Mr.horizontal:Mr.horizontalOnly,ud?Object.keys(Sf.horizontal):[sd],Ef,id,Yh,ku),ud)break}Sf.vertical&&(Sd+=Kt(Go,yc,Sf.vertical,yd,_c,pp,qu,Lp,gh,Mr.vertical,["vertical"],Ef,ad,Yh,ku));var Ud=Zf?Zf.boxStartIndex:Go.collisionBoxArray.length,Uf=Zf?Zf.boxEndIndex:Go.collisionBoxArray.length,ld=xc?xc.boxStartIndex:Go.collisionBoxArray.length,vp=xc?xc.boxEndIndex:Go.collisionBoxArray.length,Cd=vh?vh.boxStartIndex:Go.collisionBoxArray.length,Ad=vh?vh.boxEndIndex:Go.collisionBoxArray.length,_h=mh?mh.boxStartIndex:Go.collisionBoxArray.length,Pd=mh?mh.boxEndIndex:Go.collisionBoxArray.length,jc=-1,Vp=function(mp,Id){return mp&&mp.circleDiameter?Math.max(mp.circleDiameter,Id):Id};jc=Vp(Zf,jc),jc=Vp(xc,jc),jc=Vp(vh,jc);var Md=(jc=Vp(mh,jc))>-1?1:0;Md&&(jc*=Dp/24),Go.glyphOffsetArray.length>=ut.MAX_GLYPHS&&qe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==qu.sortKey&&Go.addToSortKeyRanges(Go.symbolInstances.length,qu.sortKey),Go.symbolInstances.emplaceBack(yc.x,yc.y,Ef.right>=0?Ef.right:-1,Ef.center>=0?Ef.center:-1,Ef.left>=0?Ef.left:-1,Ef.vertical||-1,id,ad,Bp,Ud,Uf,ld,vp,Cd,Ad,_h,Pd,Nf,wd,Sd,xd,bd,Md,0,Wh,qh,od,jc)}(wa,Vh,md,Xa,qi,$s,Il,wa.layers[0],wa.collisionBoxArray,Ja.index,Ja.sourceLayerIndex,wa.index,Df,kh,Lh,ws,af,ah,Rh,Uc,Ja,Zs,Pa,vc,yo)};if("line"===Vc)for(var bf=0,Dh=ss(Ja.geometry,0,0,8192,8192);bf<Dh.length;bf+=1)for(var up=Dh[bf],Bh=0,Fh=Uo(up,ih,oh,Xa.vertical||Ku,qi,24,nh,wa.overscaling,8192);Bh<Fh.length;Bh+=1){var lp=Fh[Bh];Ku&&ya(wa,Ku.text,sh,lp)||gc(up,lp)}else if("line-center"===Vc)for(var wf=0,lh=Ja.geometry;wf<lh.length;wf+=1){var ch=lh[wf];if(ch.length>1){var Nh=vs(ch,oh,Xa.vertical||Ku,qi,24,nh);Nh&&gc(ch,Nh)}}else if("Polygon"===Ja.type)for(var Bf=0,zh=Mf(Ja.geometry,0);Bf<zh.length;Bf+=1){var fh=zh[Bf],Zh=pa(fh,16);gc(fh[0],new Sn(Zh.x,Zh.y,0))}else if("LineString"===Ja.type)for(var Ff=0,Uh=Ja.geometry;Ff<Uh.length;Ff+=1){var hh=Uh[Ff];gc(hh,new Sn(hh[0].x,hh[0].y,0))}else if("Point"===Ja.type)for(var cp=0,rd=Ja.geometry;cp<rd.length;cp+=1)for(var fp=0,kp=rd[cp];fp<kp.length;fp+=1){var hp=kp[fp];gc([hp],new Sn(hp.x,hp.y,0))}}(e,xr,Dn,Is,c,j,vn,ii,Nn,hu,x)},Ht=0,fr=e.features;Ht<fr.length;Ht+=1)Lt();g&&e.generateCollisionDebugBuffers()},p.perspective=function(e,t,r,c,d){var g,x=1/Math.tan(t/2);return e[0]=x/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=x,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=d&&d!==1/0?(e[10]=(d+c)*(g=1/(c-d)),e[14]=2*d*c*g):(e[10]=-1,e[14]=-2*c),e},p.pick=function(e,t){for(var r={},c=0;c<t.length;c++){var d=t[c];d in e&&(r[d]=e[d])}return r},p.plugin=Cs,p.polygonIntersectsPolygon=jr,p.postMapLoadEvent=Xt,p.postTurnstileEvent=_t,p.potpack=Bt,p.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],p.register=Bn,p.registerForPluginStateChange=function(e){return e({pluginStatus:Ds,pluginURL:Hs}),cf.on("pluginStateChange",e),e},p.renderColorRamp=Tl,p.rotate=function(e,t,r){var c=t[0],d=t[1],g=t[2],x=t[3],A=Math.sin(r),R=Math.cos(r);return e[0]=c*R+g*A,e[1]=d*R+x*A,e[2]=c*-A+g*R,e[3]=d*-A+x*R,e},p.rotateX=function(e,t,r){var c=Math.sin(r),d=Math.cos(r),g=t[4],x=t[5],A=t[6],R=t[7],j=t[8],J=t[9],oe=t[10],me=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=g*d+j*c,e[5]=x*d+J*c,e[6]=A*d+oe*c,e[7]=R*d+me*c,e[8]=j*d-g*c,e[9]=J*d-x*c,e[10]=oe*d-A*c,e[11]=me*d-R*c,e},p.rotateZ=function(e,t,r){var c=Math.sin(r),d=Math.cos(r),g=t[0],x=t[1],A=t[2],R=t[3],j=t[4],J=t[5],oe=t[6],me=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*d+j*c,e[1]=x*d+J*c,e[2]=A*d+oe*c,e[3]=R*d+me*c,e[4]=j*d-g*c,e[5]=J*d-x*c,e[6]=oe*d-A*c,e[7]=me*d-R*c,e},p.scale=function(e,t,r){var c=r[0],d=r[1],g=r[2];return e[0]=t[0]*c,e[1]=t[1]*c,e[2]=t[2]*c,e[3]=t[3]*c,e[4]=t[4]*d,e[5]=t[5]*d,e[6]=t[6]*d,e[7]=t[7]*d,e[8]=t[8]*g,e[9]=t[9]*g,e[10]=t[10]*g,e[11]=t[11]*g,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},p.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},p.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},p.setCacheLimits=function(e,t){Cr=e,_r=t},p.setRTLTextPlugin=function(e,t,r){if(void 0===r&&(r=!1),"deferred"===Ds||"loading"===Ds||"loaded"===Ds)throw new Error("setRTLTextPlugin cannot be called multiple times.");Hs=Pr.resolveURL(e),Ds="deferred",au=t,uc(),r||Ws()},p.sphericalToCartesian=function(e){var t=e[0],r=e[1],c=e[2];return r+=90,r*=Math.PI/180,c*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(c),y:t*Math.sin(r)*Math.sin(c),z:t*Math.cos(c)}},p.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},p.styleSpec=ce,p.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},p.symbolSize=Mo,p.transformMat3=function(e,t,r){var c=t[0],d=t[1],g=t[2];return e[0]=c*r[0]+d*r[3]+g*r[6],e[1]=c*r[1]+d*r[4]+g*r[7],e[2]=c*r[2]+d*r[5]+g*r[8],e},p.transformMat4=uu,p.translate=function(e,t,r){var c,d,g,x,A,R,j,J,oe,me,xe,Ge,He=r[0],gt=r[1],it=r[2];return t===e?(e[12]=t[0]*He+t[4]*gt+t[8]*it+t[12],e[13]=t[1]*He+t[5]*gt+t[9]*it+t[13],e[14]=t[2]*He+t[6]*gt+t[10]*it+t[14],e[15]=t[3]*He+t[7]*gt+t[11]*it+t[15]):(d=t[1],g=t[2],x=t[3],A=t[4],R=t[5],j=t[6],J=t[7],oe=t[8],me=t[9],xe=t[10],Ge=t[11],e[0]=c=t[0],e[1]=d,e[2]=g,e[3]=x,e[4]=A,e[5]=R,e[6]=j,e[7]=J,e[8]=oe,e[9]=me,e[10]=xe,e[11]=Ge,e[12]=c*He+A*gt+oe*it+t[12],e[13]=d*He+R*gt+me*it+t[13],e[14]=g*He+j*gt+xe*it+t[14],e[15]=x*He+J*gt+Ge*it+t[15]),e},p.triggerPluginCompletionEvent=Tf,p.uniqueId=Ut,p.validateCustomStyleLayer=function(e){var t=[],r=e.id;return void 0===r&&t.push({message:"layers."+r+': missing required property "id"'}),void 0===e.render&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},p.validateLight=Ta,p.validateStyle=Ic,p.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},p.vectorTile=gf,p.version="1.13.2",p.warnOnce=qe,p.webpSupported=Ie,p.window=Y,p.wrap=tt}),w(0,function(p){function _(Q){var he=typeof Q;if("number"===he||"boolean"===he||"string"===he||null==Q)return JSON.stringify(Q);if(Array.isArray(Q)){for(var ge="[",F=0,re=Q;F<re.length;F+=1)ge+=_(re[F])+",";return ge+"]"}for(var ye=Object.keys(Q).sort(),Me="{",ce=0;ce<ye.length;ce++)Me+=JSON.stringify(ye[ce])+":"+_(Q[ye[ce]])+",";return Me+"}"}function W(Q){for(var he="",ge=0,F=p.refProperties;ge<F.length;ge+=1)he+="/"+_(Q[F[ge]]);return he}var X=function(Q){this.keyCache={},Q&&this.replace(Q)};X.prototype.replace=function(Q){this._layerConfigs={},this._layers={},this.update(Q,[])},X.prototype.update=function(Q,he){for(var ge=this,F=0,re=Q;F<re.length;F+=1){var ye=re[F];this._layerConfigs[ye.id]=ye;var Me=this._layers[ye.id]=p.createStyleLayer(ye);Me._featureFilter=p.featureFilter(Me.filter),this.keyCache[ye.id]&&delete this.keyCache[ye.id]}for(var ce=0,Te=he;ce<Te.length;ce+=1){var mt=Te[ce];delete this.keyCache[mt],delete this._layerConfigs[mt],delete this._layers[mt]}this.familiesBySource={};for(var wr=0,Vt=function(nn,ln){for(var Di={},gn=0;gn<nn.length;gn++){var Oi=ln&&ln[nn[gn].id]||W(nn[gn]);ln&&(ln[nn[gn].id]=Oi);var ta=Di[Oi];ta||(ta=Di[Oi]=[]),ta.push(nn[gn])}var oi=[];for(var Ji in Di)oi.push(Di[Ji]);return oi}(p.values(this._layerConfigs),this.keyCache);wr<Vt.length;wr+=1){var $t=Vt[wr].map(function(nn){return ge._layers[nn.id]}),Br=$t[0];if("none"!==Br.visibility){var On=Br.source||"",Cn=this.familiesBySource[On];Cn||(Cn=this.familiesBySource[On]={});var qt=Br.sourceLayer||"_geojsonTileLayer",xn=Cn[qt];xn||(xn=Cn[qt]=[]),xn.push($t)}}};var q=function(Q){var he={},ge=[];for(var F in Q){var re=Q[F],ye=he[F]={};for(var Me in re){var ce=re[+Me];if(ce&&0!==ce.bitmap.width&&0!==ce.bitmap.height){var Te={x:0,y:0,w:ce.bitmap.width+2,h:ce.bitmap.height+2};ge.push(Te),ye[Me]={rect:Te,metrics:ce.metrics}}}}var mt=p.potpack(ge),wr=new p.AlphaImage({width:mt.w||1,height:mt.h||1});for(var Vt in Q){var $t=Q[Vt];for(var Br in $t){var On=$t[+Br];if(On&&0!==On.bitmap.width&&0!==On.bitmap.height){var Cn=he[Vt][Br].rect;p.AlphaImage.copy(On.bitmap,wr,{x:0,y:0},{x:Cn.x+1,y:Cn.y+1},On.bitmap)}}}this.image=wr,this.positions=he};p.register("GlyphAtlas",q);var te=function(Q){this.tileID=new p.OverscaledTileID(Q.tileID.overscaledZ,Q.tileID.wrap,Q.tileID.canonical.z,Q.tileID.canonical.x,Q.tileID.canonical.y),this.uid=Q.uid,this.zoom=Q.zoom,this.pixelRatio=Q.pixelRatio,this.tileSize=Q.tileSize,this.source=Q.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Q.showCollisionBoxes,this.collectResourceTiming=!!Q.collectResourceTiming,this.returnDependencies=!!Q.returnDependencies,this.promoteId=Q.promoteId};function Y(Q,he,ge){for(var F=new p.EvaluationParameters(he),re=0,ye=Q;re<ye.length;re+=1)ye[re].recalculate(F,ge)}function Xe(Q,he){var ge=p.getArrayBuffer(Q.request,function(F,re,ye,Me){F?he(F):re&&he(null,{vectorTile:new p.vectorTile.VectorTile(new p.pbf(re)),rawData:re,cacheControl:ye,expires:Me})});return function(){ge.cancel(),he()}}te.prototype.parse=function(Q,he,ge,F,re){var ye=this;this.status="parsing",this.data=Q,this.collisionBoxArray=new p.CollisionBoxArray;var Me=new p.DictionaryCoder(Object.keys(Q.layers).sort()),ce=new p.FeatureIndex(this.tileID,this.promoteId);ce.bucketLayerIDs=[];var Te,mt,wr,Vt,$t={},Br={featureIndex:ce,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ge},On=he.familiesBySource[this.source];for(var Cn in On){var qt=Q.layers[Cn];if(qt){1===qt.version&&p.warnOnce('Vector tile source "'+this.source+'" layer "'+Cn+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var xn=Me.encode(Cn),nn=[],ln=0;ln<qt.length;ln++){var Di=qt.feature(ln),gn=ce.getId(Di,Cn);nn.push({feature:Di,id:gn,index:ln,sourceLayerIndex:xn})}for(var Oi=0,ta=On[Cn];Oi<ta.length;Oi+=1){var oi=ta[Oi],Ji=oi[0];Ji.minzoom&&this.zoom<Math.floor(Ji.minzoom)||Ji.maxzoom&&this.zoom>=Ji.maxzoom||"none"!==Ji.visibility&&(Y(oi,this.zoom,ge),($t[Ji.id]=Ji.createBucket({index:ce.bucketLayerIDs.length,layers:oi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xn,sourceID:this.source})).populate(nn,Br,this.tileID.canonical),ce.bucketLayerIDs.push(oi.map(function(Gi){return Gi.id})))}}}var ji=p.mapObject(Br.glyphDependencies,function(Gi){return Object.keys(Gi).map(Number)});Object.keys(ji).length?F.send("getGlyphs",{uid:this.uid,stacks:ji},function(Gi,Bi){Te||(Te=Gi,mt=Bi,Ma.call(ye))}):mt={};var Ti=Object.keys(Br.iconDependencies);Ti.length?F.send("getImages",{icons:Ti,source:this.source,tileID:this.tileID,type:"icons"},function(Gi,Bi){Te||(Te=Gi,wr=Bi,Ma.call(ye))}):wr={};var _a=Object.keys(Br.patternDependencies);function Ma(){if(Te)return re(Te);if(mt&&wr&&Vt){var Gi=new q(mt),Bi=new p.ImageAtlas(wr,Vt);for(var Xi in $t){var to=$t[Xi];to instanceof p.SymbolBucket?(Y(to.layers,this.zoom,ge),p.performSymbolLayout(to,mt,Gi.positions,wr,Bi.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):to.hasPattern&&(to instanceof p.LineBucket||to instanceof p.FillBucket||to instanceof p.FillExtrusionBucket)&&(Y(to.layers,this.zoom,ge),to.addFeatures(Br,this.tileID.canonical,Bi.patternPositions))}this.status="done",re(null,{buckets:p.values($t).filter(function(Ho){return!Ho.isEmpty()}),featureIndex:ce,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Gi.image,imageAtlas:Bi,glyphMap:this.returnDependencies?mt:null,iconMap:this.returnDependencies?wr:null,glyphPositions:this.returnDependencies?Gi.positions:null})}}_a.length?F.send("getImages",{icons:_a,source:this.source,tileID:this.tileID,type:"patterns"},function(Gi,Bi){Te||(Te=Gi,Vt=Bi,Ma.call(ye))}):Vt={},Ma.call(this)};var et=function(Q,he,ge,F){this.actor=Q,this.layerIndex=he,this.availableImages=ge,this.loadVectorData=F||Xe,this.loading={},this.loaded={}};et.prototype.loadTile=function(Q,he){var ge=this,F=Q.uid;this.loading||(this.loading={});var re=!!(Q&&Q.request&&Q.request.collectResourceTiming)&&new p.RequestPerformance(Q.request),ye=this.loading[F]=new te(Q);ye.abort=this.loadVectorData(Q,function(Me,ce){if(delete ge.loading[F],Me||!ce)return ye.status="done",ge.loaded[F]=ye,he(Me);var Te=ce.rawData,mt={};ce.expires&&(mt.expires=ce.expires),ce.cacheControl&&(mt.cacheControl=ce.cacheControl);var wr={};if(re){var Vt=re.finish();Vt&&(wr.resourceTiming=JSON.parse(JSON.stringify(Vt)))}ye.vectorTile=ce.vectorTile,ye.parse(ce.vectorTile,ge.layerIndex,ge.availableImages,ge.actor,function($t,Br){if($t||!Br)return he($t);he(null,p.extend({rawTileData:Te.slice(0)},Br,mt,wr))}),ge.loaded=ge.loaded||{},ge.loaded[F]=ye})},et.prototype.reloadTile=function(Q,he){var ge=this,F=this.loaded,re=Q.uid,ye=this;if(F&&F[re]){var Me=F[re];Me.showCollisionBoxes=Q.showCollisionBoxes;var ce=function(Te,mt){var wr=Me.reloadCallback;wr&&(delete Me.reloadCallback,Me.parse(Me.vectorTile,ye.layerIndex,ge.availableImages,ye.actor,wr)),he(Te,mt)};"parsing"===Me.status?Me.reloadCallback=ce:"done"===Me.status&&(Me.vectorTile?Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,ce):ce())}},et.prototype.abortTile=function(Q,he){var ge=this.loading,F=Q.uid;ge&&ge[F]&&ge[F].abort&&(ge[F].abort(),delete ge[F]),he()},et.prototype.removeTile=function(Q,he){var ge=this.loaded,F=Q.uid;ge&&ge[F]&&delete ge[F],he()};var z=p.window.ImageBitmap,Z=function(){this.loaded={}};function tt(Q,he){if(0!==Q.length){Mt(Q[0],he);for(var ge=1;ge<Q.length;ge++)Mt(Q[ge],!he)}}function Mt(Q,he){for(var ge=0,F=0,re=Q.length,ye=re-1;F<re;ye=F++)ge+=(Q[F][0]-Q[ye][0])*(Q[ye][1]+Q[F][1]);ge>=0!=!!he&&Q.reverse()}Z.prototype.loadTile=function(Q,he){var ge=Q.uid,F=Q.encoding,re=Q.rawImageData,ye=z&&re instanceof z?this.getImageData(re):re,Me=new p.DEMData(ge,ye,F);this.loaded=this.loaded||{},this.loaded[ge]=Me,he(null,Me)},Z.prototype.getImageData=function(Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Q.width,Q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Q.width,this.offscreenCanvas.height=Q.height,this.offscreenCanvasContext.drawImage(Q,0,0,Q.width,Q.height);var he=this.offscreenCanvasContext.getImageData(-1,-1,Q.width+2,Q.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new p.RGBAImage({width:he.width,height:he.height},he.data)},Z.prototype.removeTile=function(Q){var he=this.loaded,ge=Q.uid;he&&he[ge]&&delete he[ge]};var sr=p.vectorTile.VectorTileFeature.prototype.toGeoJSON,Ut=function(Q){this._feature=Q,this.extent=p.EXTENT,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))};Ut.prototype.loadGeometry=function(){if(1===this._feature.type){for(var Q=[],he=0,ge=this._feature.geometry;he<ge.length;he+=1){var F=ge[he];Q.push([new p.Point$1(F[0],F[1])])}return Q}for(var re=[],ye=0,Me=this._feature.geometry;ye<Me.length;ye+=1){for(var ce=[],Te=0,mt=Me[ye];Te<mt.length;Te+=1){var wr=mt[Te];ce.push(new p.Point$1(wr[0],wr[1]))}re.push(ce)}return re},Ut.prototype.toGeoJSON=function(Q,he,ge){return sr.call(this,Q,he,ge)};var At=function(Q){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.EXTENT,this.length=Q.length,this._features=Q};At.prototype.feature=function(Q){return new Ut(this._features[Q])};var Et=p.vectorTile.VectorTileFeature,vr=ne;function ne(Q,he){this.options=he||{},this.features=Q,this.length=Q.length}function nr(Q,he){this.id="number"==typeof Q.id?Q.id:void 0,this.type=Q.type,this.rawGeometry=1===Q.type?[Q.geometry]:Q.geometry,this.properties=Q.tags,this.extent=he||4096}ne.prototype.feature=function(Q){return new nr(this.features[Q],this.options.extent)},nr.prototype.loadGeometry=function(){var Q=this.rawGeometry;this.geometry=[];for(var he=0;he<Q.length;he++){for(var ge=Q[he],F=[],re=0;re<ge.length;re++)F.push(new p.Point$1(ge[re][0],ge[re][1]));this.geometry.push(F)}return this.geometry},nr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Q=this.geometry,he=1/0,ge=-1/0,F=1/0,re=-1/0,ye=0;ye<Q.length;ye++)for(var Me=Q[ye],ce=0;ce<Me.length;ce++){var Te=Me[ce];he=Math.min(he,Te.x),ge=Math.max(ge,Te.x),F=Math.min(F,Te.y),re=Math.max(re,Te.y)}return[he,F,ge,re]},nr.prototype.toGeoJSON=Et.prototype.toGeoJSON;var Tt=Ct,$e=vr;function Ct(Q){var he=new p.pbf;return function(ge,F){for(var re in ge.layers)F.writeMessage(3,qe,ge.layers[re])}(Q,he),he.finish()}function qe(Q,he){var ge;he.writeVarintField(15,Q.version||1),he.writeStringField(1,Q.name||""),he.writeVarintField(5,Q.extent||4096);var F={keys:[],values:[],keycache:{},valuecache:{}};for(ge=0;ge<Q.length;ge++)F.feature=Q.feature(ge),he.writeMessage(2,Dt,F);var re=F.keys;for(ge=0;ge<re.length;ge++)he.writeStringField(3,re[ge]);var ye=F.values;for(ge=0;ge<ye.length;ge++)he.writeMessage(4,ve,ye[ge])}function Dt(Q,he){var ge=Q.feature;void 0!==ge.id&&he.writeVarintField(1,ge.id),he.writeMessage(2,lr,Q),he.writeVarintField(3,ge.type),he.writeMessage(4,_e,ge)}function lr(Q,he){var ge=Q.feature,F=Q.keys,re=Q.values,ye=Q.keycache,Me=Q.valuecache;for(var ce in ge.properties){var Te=ye[ce];void 0===Te&&(F.push(ce),ye[ce]=Te=F.length-1),he.writeVarint(Te);var mt=ge.properties[ce],wr=typeof mt;"string"!==wr&&"boolean"!==wr&&"number"!==wr&&(mt=JSON.stringify(mt));var Vt=wr+":"+mt,$t=Me[Vt];void 0===$t&&(re.push(mt),Me[Vt]=$t=re.length-1),he.writeVarint($t)}}function hr(Q,he){return(he<<3)+(7&Q)}function Dr(Q){return Q<<1^Q>>31}function _e(Q,he){for(var ge=Q.loadGeometry(),F=Q.type,re=0,ye=0,Me=ge.length,ce=0;ce<Me;ce++){var Te=ge[ce],mt=1;1===F&&(mt=Te.length),he.writeVarint(hr(1,mt));for(var wr=3===F?Te.length-1:Te.length,Vt=0;Vt<wr;Vt++){1===Vt&&1!==F&&he.writeVarint(hr(2,wr-1));var $t=Te[Vt].x-re,Br=Te[Vt].y-ye;he.writeVarint(Dr($t)),he.writeVarint(Dr(Br)),re+=$t,ye+=Br}3===F&&he.writeVarint(hr(7,1))}}function ve(Q,he){var ge=typeof Q;"string"===ge?he.writeStringField(1,Q):"boolean"===ge?he.writeBooleanField(7,Q):"number"===ge&&(Q%1!=0?he.writeDoubleField(3,Q):Q<0?he.writeSVarintField(6,Q):he.writeVarintField(5,Q))}function ae(Q,he,ge,F){de(Q,ge,F),de(he,2*ge,2*F),de(he,2*ge+1,2*F+1)}function de(Q,he,ge){var F=Q[he];Q[he]=Q[ge],Q[ge]=F}function Pe(Q,he,ge,F){var re=Q-ge,ye=he-F;return re*re+ye*ye}Tt.fromVectorTileJs=Ct,Tt.fromGeojsonVt=function(Q,he){he=he||{};var ge={};for(var F in Q)ge[F]=new vr(Q[F].features,he),ge[F].name=F,ge[F].version=he.version,ge[F].extent=he.extent;return Ct({layers:ge})},Tt.GeoJSONWrapper=$e;var ze=function(Q){return Q[0]},pt=function(Q){return Q[1]},br=function(Q,he,ge,F,re){void 0===he&&(he=ze),void 0===ge&&(ge=pt),void 0===F&&(F=64),void 0===re&&(re=Float64Array),this.nodeSize=F,this.points=Q;for(var ye=Q.length<65536?Uint16Array:Uint32Array,Me=this.ids=new ye(Q.length),ce=this.coords=new re(2*Q.length),Te=0;Te<Q.length;Te++)Me[Te]=Te,ce[2*Te]=he(Q[Te]),ce[2*Te+1]=ge(Q[Te]);!function mt(wr,Vt,$t,Br,On,Cn){if(!(On-Br<=$t)){var qt=Br+On>>1;(function xn(nn,ln,Di,gn,Oi,ta){for(;Oi>gn;){if(Oi-gn>600){var oi=Oi-gn+1,Ji=Di-gn+1,ji=Math.log(oi),Ti=.5*Math.exp(2*ji/3),_a=.5*Math.sqrt(ji*Ti*(oi-Ti)/oi)*(Ji-oi/2<0?-1:1);xn(nn,ln,Di,Math.max(gn,Math.floor(Di-Ji*Ti/oi+_a)),Math.min(Oi,Math.floor(Di+(oi-Ji)*Ti/oi+_a)),ta)}var Ma=ln[2*Di+ta],Gi=gn,Bi=Oi;for(ae(nn,ln,gn,Di),ln[2*Oi+ta]>Ma&&ae(nn,ln,gn,Oi);Gi<Bi;){for(ae(nn,ln,Gi,Bi),Gi++,Bi--;ln[2*Gi+ta]<Ma;)Gi++;for(;ln[2*Bi+ta]>Ma;)Bi--}ln[2*gn+ta]===Ma?ae(nn,ln,gn,Bi):ae(nn,ln,++Bi,Oi),Bi<=Di&&(gn=Bi+1),Di<=Bi&&(Oi=Bi-1)}})(wr,Vt,qt,Br,On,Cn%2),mt(wr,Vt,$t,Br,qt-1,Cn+1),mt(wr,Vt,$t,qt+1,On,Cn+1)}}(Me,ce,F,0,Me.length-1,0)};br.prototype.range=function(Q,he,ge,F){return function(re,ye,Me,ce,Te,mt,wr){for(var Vt,$t,Br=[0,re.length-1,0],On=[];Br.length;){var Cn=Br.pop(),qt=Br.pop(),xn=Br.pop();if(qt-xn<=wr)for(var nn=xn;nn<=qt;nn++)$t=ye[2*nn+1],(Vt=ye[2*nn])>=Me&&Vt<=Te&&$t>=ce&&$t<=mt&&On.push(re[nn]);else{var ln=Math.floor((xn+qt)/2);$t=ye[2*ln+1],(Vt=ye[2*ln])>=Me&&Vt<=Te&&$t>=ce&&$t<=mt&&On.push(re[ln]);var Di=(Cn+1)%2;(0===Cn?Me<=Vt:ce<=$t)&&(Br.push(xn),Br.push(ln-1),Br.push(Di)),(0===Cn?Te>=Vt:mt>=$t)&&(Br.push(ln+1),Br.push(qt),Br.push(Di))}}return On}(this.ids,this.coords,Q,he,ge,F,this.nodeSize)},br.prototype.within=function(Q,he,ge){return function(F,re,ye,Me,ce,Te){for(var mt=[0,F.length-1,0],wr=[],Vt=ce*ce;mt.length;){var $t=mt.pop(),Br=mt.pop(),On=mt.pop();if(Br-On<=Te)for(var Cn=On;Cn<=Br;Cn++)Pe(re[2*Cn],re[2*Cn+1],ye,Me)<=Vt&&wr.push(F[Cn]);else{var qt=Math.floor((On+Br)/2),xn=re[2*qt],nn=re[2*qt+1];Pe(xn,nn,ye,Me)<=Vt&&wr.push(F[qt]);var ln=($t+1)%2;(0===$t?ye-ce<=xn:Me-ce<=nn)&&(mt.push(On),mt.push(qt-1),mt.push(ln)),(0===$t?ye+ce>=xn:Me+ce>=nn)&&(mt.push(qt+1),mt.push(Br),mt.push(ln))}}return wr}(this.ids,this.coords,Q,he,ge,this.nodeSize)};var Ur={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Q){return Q}},fn=function(Q){this.options=Wt(Object.create(Ur),Q),this.trees=new Array(this.options.maxZoom+1)};function Pr(Q,he,ge,F,re){return{x:Q,y:he,zoom:1/0,id:ge,parentId:-1,numPoints:F,properties:re}}function wt(Q,he){var ge=Q.geometry.coordinates,F=ge[1];return{x:nt(ge[0]),y:Le(F),zoom:1/0,index:he,parentId:-1}}function Ie(Q){return{type:"Feature",id:Q.id,properties:we(Q),geometry:{type:"Point",coordinates:[(F=Q.x,360*(F-.5)),(he=Q.y,ge=(180-360*he)*Math.PI/180,360*Math.atan(Math.exp(ge))/Math.PI-90)]}};var he,ge,F}function we(Q){var he=Q.numPoints,ge=he>=1e4?Math.round(he/1e3)+"k":he>=1e3?Math.round(he/100)/10+"k":he;return Wt(Wt({},Q.properties),{cluster:!0,cluster_id:Q.id,point_count:he,point_count_abbreviated:ge})}function nt(Q){return Q/360+.5}function Le(Q){var he=Math.sin(Q*Math.PI/180),ge=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return ge<0?0:ge>1?1:ge}function Wt(Q,he){for(var ge in he)Q[ge]=he[ge];return Q}function Ar(Q){return Q.x}function Yt(Q){return Q.y}function cr(Q,he,ge,F,re,ye){var Me=re-ge,ce=ye-F;if(0!==Me||0!==ce){var Te=((Q-ge)*Me+(he-F)*ce)/(Me*Me+ce*ce);Te>1?(ge=re,F=ye):Te>0&&(ge+=Me*Te,F+=ce*Te)}return(Me=Q-ge)*Me+(ce=he-F)*ce}function Fr(Q,he,ge,F){var re={id:void 0===Q?null:Q,type:he,geometry:ge,tags:F,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(ye){var Me=ye.geometry,ce=ye.type;if("Point"===ce||"MultiPoint"===ce||"LineString"===ce)Zn(ye,Me);else if("Polygon"===ce||"MultiLineString"===ce)for(var Te=0;Te<Me.length;Te++)Zn(ye,Me[Te]);else if("MultiPolygon"===ce)for(Te=0;Te<Me.length;Te++)for(var mt=0;mt<Me[Te].length;mt++)Zn(ye,Me[Te][mt])}(re),re}function Zn(Q,he){for(var ge=0;ge<he.length;ge+=3)Q.minX=Math.min(Q.minX,he[ge]),Q.minY=Math.min(Q.minY,he[ge+1]),Q.maxX=Math.max(Q.maxX,he[ge]),Q.maxY=Math.max(Q.maxY,he[ge+1])}function T(Q,he,ge,F){if(he.geometry){var re=he.geometry.coordinates,ye=he.geometry.type,Me=Math.pow(ge.tolerance/((1<<ge.maxZoom)*ge.extent),2),ce=[],Te=he.id;if(ge.promoteId?Te=he.properties[ge.promoteId]:ge.generateId&&(Te=F||0),"Point"===ye)G(re,ce);else if("MultiPoint"===ye)for(var mt=0;mt<re.length;mt++)G(re[mt],ce);else if("LineString"===ye)Ve(re,ce,Me,!1);else if("MultiLineString"===ye){if(ge.lineMetrics){for(mt=0;mt<re.length;mt++)Ve(re[mt],ce=[],Me,!1),Q.push(Fr(Te,"LineString",ce,he.properties));return}rt(re,ce,Me,!1)}else if("Polygon"===ye)rt(re,ce,Me,!0);else{if("MultiPolygon"!==ye){if("GeometryCollection"===ye){for(mt=0;mt<he.geometry.geometries.length;mt++)T(Q,{id:Te,geometry:he.geometry.geometries[mt],properties:he.properties},ge,F);return}throw new Error("Input data is not a valid GeoJSON object.")}for(mt=0;mt<re.length;mt++){var wr=[];rt(re[mt],wr,Me,!0),ce.push(wr)}}Q.push(Fr(Te,ye,ce,he.properties))}}function G(Q,he){he.push(dt(Q[0])),he.push(Ot(Q[1])),he.push(0)}function Ve(Q,he,ge,F){for(var re,ye,Me=0,ce=0;ce<Q.length;ce++){var Te=dt(Q[ce][0]),mt=Ot(Q[ce][1]);he.push(Te),he.push(mt),he.push(0),ce>0&&(Me+=F?(re*mt-Te*ye)/2:Math.sqrt(Math.pow(Te-re,2)+Math.pow(mt-ye,2))),re=Te,ye=mt}var wr=he.length-3;he[2]=1,function Vt($t,Br,On,Cn){for(var qt,xn=Cn,nn=On-Br>>1,ln=On-Br,Di=$t[Br],gn=$t[Br+1],Oi=$t[On],ta=$t[On+1],oi=Br+3;oi<On;oi+=3){var Ji=cr($t[oi],$t[oi+1],Di,gn,Oi,ta);if(Ji>xn)qt=oi,xn=Ji;else if(Ji===xn){var ji=Math.abs(oi-nn);ji<ln&&(qt=oi,ln=ji)}}xn>Cn&&(qt-Br>3&&Vt($t,Br,qt,Cn),$t[qt+2]=xn,On-qt>3&&Vt($t,qt,On,Cn))}(he,0,wr,ge),he[wr+2]=1,he.size=Math.abs(Me),he.start=0,he.end=he.size}function rt(Q,he,ge,F){for(var re=0;re<Q.length;re++){var ye=[];Ve(Q[re],ye,ge,F),he.push(ye)}}function dt(Q){return Q/360+.5}function Ot(Q){var he=Math.sin(Q*Math.PI/180),ge=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return ge<0?0:ge>1?1:ge}function B(Q,he,ge,F,re,ye,Me,ce){if(F/=he,ye>=(ge/=he)&&Me<F)return Q;if(Me<ge||ye>=F)return null;for(var Te=[],mt=0;mt<Q.length;mt++){var wr=Q[mt],Vt=wr.geometry,$t=wr.type,Br=0===re?wr.minX:wr.minY,On=0===re?wr.maxX:wr.maxY;if(Br>=ge&&On<F)Te.push(wr);else if(!(On<ge||Br>=F)){var Cn=[];if("Point"===$t||"MultiPoint"===$t)Ue(Vt,Cn,ge,F,re);else if("LineString"===$t)_t(Vt,Cn,ge,F,re,!1,ce.lineMetrics);else if("MultiLineString"===$t)Xt(Vt,Cn,ge,F,re,!1);else if("Polygon"===$t)Xt(Vt,Cn,ge,F,re,!0);else if("MultiPolygon"===$t)for(var qt=0;qt<Vt.length;qt++){var xn=[];Xt(Vt[qt],xn,ge,F,re,!0),xn.length&&Cn.push(xn)}if(Cn.length){if(ce.lineMetrics&&"LineString"===$t){for(qt=0;qt<Cn.length;qt++)Te.push(Fr(wr.id,$t,Cn[qt],wr.tags));continue}"LineString"!==$t&&"MultiLineString"!==$t||(1===Cn.length?($t="LineString",Cn=Cn[0]):$t="MultiLineString"),"Point"!==$t&&"MultiPoint"!==$t||($t=3===Cn.length?"Point":"MultiPoint"),Te.push(Fr(wr.id,$t,Cn,wr.tags))}}}return Te.length?Te:null}function Ue(Q,he,ge,F,re){for(var ye=0;ye<Q.length;ye+=3){var Me=Q[ye+re];Me>=ge&&Me<=F&&(he.push(Q[ye]),he.push(Q[ye+1]),he.push(Q[ye+2]))}}function _t(Q,he,ge,F,re,ye,Me){for(var ce,Te,mt=St(Q),wr=0===re?_r:jt,Vt=Q.start,$t=0;$t<Q.length-3;$t+=3){var Br=Q[$t],On=Q[$t+1],Cn=Q[$t+2],qt=Q[$t+3],xn=Q[$t+4],nn=0===re?Br:On,ln=0===re?qt:xn,Di=!1;Me&&(ce=Math.sqrt(Math.pow(Br-qt,2)+Math.pow(On-xn,2))),nn<ge?ln>ge&&(Te=wr(mt,Br,On,qt,xn,ge),Me&&(mt.start=Vt+ce*Te)):nn>F?ln<F&&(Te=wr(mt,Br,On,qt,xn,F),Me&&(mt.start=Vt+ce*Te)):Cr(mt,Br,On,Cn),ln<ge&&nn>=ge&&(Te=wr(mt,Br,On,qt,xn,ge),Di=!0),ln>F&&nn<=F&&(Te=wr(mt,Br,On,qt,xn,F),Di=!0),!ye&&Di&&(Me&&(mt.end=Vt+ce*Te),he.push(mt),mt=St(Q)),Me&&(Vt+=ce)}var gn=Q.length-3;Br=Q[gn],On=Q[gn+1],Cn=Q[gn+2],(nn=0===re?Br:On)>=ge&&nn<=F&&Cr(mt,Br,On,Cn),gn=mt.length-3,ye&&gn>=3&&(mt[gn]!==mt[0]||mt[gn+1]!==mt[1])&&Cr(mt,mt[0],mt[1],mt[2]),mt.length&&he.push(mt)}function St(Q){var he=[];return he.size=Q.size,he.start=Q.start,he.end=Q.end,he}function Xt(Q,he,ge,F,re,ye){for(var Me=0;Me<Q.length;Me++)_t(Q[Me],he,ge,F,re,ye,!1)}function Cr(Q,he,ge,F){Q.push(he),Q.push(ge),Q.push(F)}function _r(Q,he,ge,F,re,ye){var Me=(ye-he)/(F-he);return Q.push(ye),Q.push(ge+(re-ge)*Me),Q.push(1),Me}function jt(Q,he,ge,F,re,ye){var Me=(ye-ge)/(re-ge);return Q.push(he+(F-he)*Me),Q.push(ye),Q.push(1),Me}function mr(Q,he){for(var ge=[],F=0;F<Q.length;F++){var re,ye=Q[F],Me=ye.type;if("Point"===Me||"MultiPoint"===Me||"LineString"===Me)re=er(ye.geometry,he);else if("MultiLineString"===Me||"Polygon"===Me){re=[];for(var ce=0;ce<ye.geometry.length;ce++)re.push(er(ye.geometry[ce],he))}else if("MultiPolygon"===Me)for(re=[],ce=0;ce<ye.geometry.length;ce++){for(var Te=[],mt=0;mt<ye.geometry[ce].length;mt++)Te.push(er(ye.geometry[ce][mt],he));re.push(Te)}ge.push(Fr(ye.id,Me,re,ye.tags))}return ge}function er(Q,he){var ge=[];ge.size=Q.size,void 0!==Q.start&&(ge.start=Q.start,ge.end=Q.end);for(var F=0;F<Q.length;F+=3)ge.push(Q[F]+he,Q[F+1],Q[F+2]);return ge}function pr(Q,he){if(Q.transformed)return Q;var ge,F,re,ye=1<<Q.z,Me=Q.x,ce=Q.y;for(ge=0;ge<Q.features.length;ge++){var Te=Q.features[ge],mt=Te.geometry,wr=Te.type;if(Te.geometry=[],1===wr)for(F=0;F<mt.length;F+=2)Te.geometry.push(Ln(mt[F],mt[F+1],he,ye,Me,ce));else for(F=0;F<mt.length;F++){var Vt=[];for(re=0;re<mt[F].length;re+=2)Vt.push(Ln(mt[F][re],mt[F][re+1],he,ye,Me,ce));Te.geometry.push(Vt)}}return Q.transformed=!0,Q}function Ln(Q,he,ge,F,re,ye){return[Math.round(ge*(Q*F-re)),Math.round(ge*(he*F-ye))]}function Wn(Q,he,ge,F,re){for(var ye=he===re.maxZoom?0:re.tolerance/((1<<he)*re.extent),Me={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ge,y:F,z:he,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ce=0;ce<Q.length;ce++){Me.numFeatures++,mi(Me,Q[ce],ye,re);var Te=Q[ce].minX,mt=Q[ce].minY,wr=Q[ce].maxX,Vt=Q[ce].maxY;Te<Me.minX&&(Me.minX=Te),mt<Me.minY&&(Me.minY=mt),wr>Me.maxX&&(Me.maxX=wr),Vt>Me.maxY&&(Me.maxY=Vt)}return Me}function mi(Q,he,ge,F){var re=he.geometry,ye=he.type,Me=[];if("Point"===ye||"MultiPoint"===ye)for(var ce=0;ce<re.length;ce+=3)Me.push(re[ce]),Me.push(re[ce+1]),Q.numPoints++,Q.numSimplified++;else if("LineString"===ye)hi(Me,re,Q,ge,!1,!1);else if("MultiLineString"===ye||"Polygon"===ye)for(ce=0;ce<re.length;ce++)hi(Me,re[ce],Q,ge,"Polygon"===ye,0===ce);else if("MultiPolygon"===ye)for(var Te=0;Te<re.length;Te++){var mt=re[Te];for(ce=0;ce<mt.length;ce++)hi(Me,mt[ce],Q,ge,!0,0===ce)}if(Me.length){var wr=he.tags||null;if("LineString"===ye&&F.lineMetrics){for(var Vt in wr={},he.tags)wr[Vt]=he.tags[Vt];wr.mapbox_clip_start=re.start/re.size,wr.mapbox_clip_end=re.end/re.size}var $t={geometry:Me,type:"Polygon"===ye||"MultiPolygon"===ye?3:"LineString"===ye||"MultiLineString"===ye?2:1,tags:wr};null!==he.id&&($t.id=he.id),Q.features.push($t)}}function hi(Q,he,ge,F,re,ye){var Me=F*F;if(F>0&&he.size<(re?Me:F))ge.numPoints+=he.length/3;else{for(var ce=[],Te=0;Te<he.length;Te+=3)(0===F||he[Te+2]>Me)&&(ge.numSimplified++,ce.push(he[Te]),ce.push(he[Te+1])),ge.numPoints++;re&&function(mt,wr){for(var Vt=0,$t=0,Br=mt.length,On=Br-2;$t<Br;On=$t,$t+=2)Vt+=(mt[$t]-mt[On])*(mt[$t+1]+mt[On+1]);if(Vt>0===wr)for($t=0,Br=mt.length;$t<Br/2;$t+=2){var Cn=mt[$t],qt=mt[$t+1];mt[$t]=mt[Br-2-$t],mt[$t+1]=mt[Br-1-$t],mt[Br-2-$t]=Cn,mt[Br-1-$t]=qt}}(ce,ye),Q.push(ce)}}function si(Q,he){var ge=(he=this.options=function(re,ye){for(var Me in ye)re[Me]=ye[Me];return re}(Object.create(this.options),he)).debug;if(ge&&console.time("preprocess data"),he.maxZoom<0||he.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(he.promoteId&&he.generateId)throw new Error("promoteId and generateId cannot be used together.");var re,ye,Me,ce,Te,mt,F=function(re,ye){var Me=[];if("FeatureCollection"===re.type)for(var ce=0;ce<re.features.length;ce++)T(Me,re.features[ce],ye,ce);else T(Me,"Feature"===re.type?re:{geometry:re},ye);return Me}(Q,he);this.tiles={},this.tileCoords=[],ge&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",he.indexMaxZoom,he.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(re=F,ye=he,Me=ye.buffer/ye.extent,ce=re,Te=B(re,1,-1-Me,Me,0,-1,2,ye),mt=B(re,1,1-Me,2+Me,0,-1,2,ye),(Te||mt)&&(ce=B(re,1,-Me,1+Me,0,-1,2,ye)||[],Te&&(ce=mr(Te,1).concat(ce)),mt&&(ce=ce.concat(mr(mt,-1)))),F=ce).length&&this.splitTile(F,0,0,0),ge&&(F.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ai(Q,he,ge){return 32*((1<<Q)*ge+he)+Q}function Yi(Q,he){var ge=Q.tileID.canonical;if(!this._geoJSONIndex)return he(null,null);var F=this._geoJSONIndex.getTile(ge.z,ge.x,ge.y);if(!F)return he(null,null);var re=new At(F.features),ye=Tt(re);0===ye.byteOffset&&ye.byteLength===ye.buffer.byteLength||(ye=new Uint8Array(ye)),he(null,{vectorTile:re,rawData:ye.buffer})}fn.prototype.load=function(Q){var he=this.options,ge=he.log,F=he.minZoom,re=he.maxZoom,ye=he.nodeSize;ge&&console.time("total time");var Me="prepare "+Q.length+" points";ge&&console.time(Me),this.points=Q;for(var ce=[],Te=0;Te<Q.length;Te++)Q[Te].geometry&&ce.push(wt(Q[Te],Te));this.trees[re+1]=new br(ce,Ar,Yt,ye,Float32Array),ge&&console.timeEnd(Me);for(var mt=re;mt>=F;mt--){var wr=+Date.now();ce=this._cluster(ce,mt),this.trees[mt]=new br(ce,Ar,Yt,ye,Float32Array),ge&&console.log("z%d: %d clusters in %dms",mt,ce.length,+Date.now()-wr)}return ge&&console.timeEnd("total time"),this},fn.prototype.getClusters=function(Q,he){var ge=((Q[0]+180)%360+360)%360-180,F=Math.max(-90,Math.min(90,Q[1])),re=180===Q[2]?180:((Q[2]+180)%360+360)%360-180,ye=Math.max(-90,Math.min(90,Q[3]));if(Q[2]-Q[0]>=360)ge=-180,re=180;else if(ge>re){var Me=this.getClusters([ge,F,180,ye],he),ce=this.getClusters([-180,F,re,ye],he);return Me.concat(ce)}for(var Te=this.trees[this._limitZoom(he)],mt=[],wr=0,Vt=Te.range(nt(ge),Le(ye),nt(re),Le(F));wr<Vt.length;wr+=1){var $t=Te.points[Vt[wr]];mt.push($t.numPoints?Ie($t):this.points[$t.index])}return mt},fn.prototype.getChildren=function(Q){var he=this._getOriginId(Q),ge=this._getOriginZoom(Q),F="No cluster with the specified id.",re=this.trees[ge];if(!re)throw new Error(F);var ye=re.points[he];if(!ye)throw new Error(F);for(var Me=this.options.radius/(this.options.extent*Math.pow(2,ge-1)),ce=[],Te=0,mt=re.within(ye.x,ye.y,Me);Te<mt.length;Te+=1){var wr=re.points[mt[Te]];wr.parentId===Q&&ce.push(wr.numPoints?Ie(wr):this.points[wr.index])}if(0===ce.length)throw new Error(F);return ce},fn.prototype.getLeaves=function(Q,he,ge){var F=[];return this._appendLeaves(F,Q,he=he||10,ge=ge||0,0),F},fn.prototype.getTile=function(Q,he,ge){var F=this.trees[this._limitZoom(Q)],re=Math.pow(2,Q),ye=this.options,Me=ye.radius/ye.extent,ce=(ge-Me)/re,Te=(ge+1+Me)/re,mt={features:[]};return this._addTileFeatures(F.range((he-Me)/re,ce,(he+1+Me)/re,Te),F.points,he,ge,re,mt),0===he&&this._addTileFeatures(F.range(1-Me/re,ce,1,Te),F.points,re,ge,re,mt),he===re-1&&this._addTileFeatures(F.range(0,ce,Me/re,Te),F.points,-1,ge,re,mt),mt.features.length?mt:null},fn.prototype.getClusterExpansionZoom=function(Q){for(var he=this._getOriginZoom(Q)-1;he<=this.options.maxZoom;){var ge=this.getChildren(Q);if(he++,1!==ge.length)break;Q=ge[0].properties.cluster_id}return he},fn.prototype._appendLeaves=function(Q,he,ge,F,re){for(var ye=0,Me=this.getChildren(he);ye<Me.length;ye+=1){var ce=Me[ye],Te=ce.properties;if(Te&&Te.cluster?re+Te.point_count<=F?re+=Te.point_count:re=this._appendLeaves(Q,Te.cluster_id,ge,F,re):re<F?re++:Q.push(ce),Q.length===ge)break}return re},fn.prototype._addTileFeatures=function(Q,he,ge,F,re,ye){for(var Me=0,ce=Q;Me<ce.length;Me+=1){var Te=he[ce[Me]],mt=Te.numPoints,wr={type:1,geometry:[[Math.round(this.options.extent*(Te.x*re-ge)),Math.round(this.options.extent*(Te.y*re-F))]],tags:mt?we(Te):this.points[Te.index].properties},Vt=void 0;mt?Vt=Te.id:this.options.generateId?Vt=Te.index:this.points[Te.index].id&&(Vt=this.points[Te.index].id),void 0!==Vt&&(wr.id=Vt),ye.features.push(wr)}},fn.prototype._limitZoom=function(Q){return Math.max(this.options.minZoom,Math.min(+Q,this.options.maxZoom+1))},fn.prototype._cluster=function(Q,he){for(var ge=[],F=this.options,re=F.reduce,ye=F.minPoints,Me=F.radius/(F.extent*Math.pow(2,he)),ce=0;ce<Q.length;ce++){var Te=Q[ce];if(!(Te.zoom<=he)){Te.zoom=he;for(var mt=this.trees[he+1],wr=mt.within(Te.x,Te.y,Me),Vt=Te.numPoints||1,$t=Vt,Br=0,On=wr;Br<On.length;Br+=1){var Cn=mt.points[On[Br]];Cn.zoom>he&&($t+=Cn.numPoints||1)}if($t>=ye){for(var qt=Te.x*Vt,xn=Te.y*Vt,nn=re&&Vt>1?this._map(Te,!0):null,ln=(ce<<5)+(he+1)+this.points.length,Di=0,gn=wr;Di<gn.length;Di+=1){var Oi=mt.points[gn[Di]];if(!(Oi.zoom<=he)){Oi.zoom=he;var ta=Oi.numPoints||1;qt+=Oi.x*ta,xn+=Oi.y*ta,Oi.parentId=ln,re&&(nn||(nn=this._map(Te,!0)),re(nn,this._map(Oi)))}}Te.parentId=ln,ge.push(Pr(qt/$t,xn/$t,ln,$t,nn))}else if(ge.push(Te),$t>1)for(var oi=0,Ji=wr;oi<Ji.length;oi+=1){var ji=mt.points[Ji[oi]];ji.zoom<=he||(ji.zoom=he,ge.push(ji))}}}return ge},fn.prototype._getOriginId=function(Q){return Q-this.points.length>>5},fn.prototype._getOriginZoom=function(Q){return(Q-this.points.length)%32},fn.prototype._map=function(Q,he){if(Q.numPoints)return he?Wt({},Q.properties):Q.properties;var ge=this.points[Q.index].properties,F=this.options.map(ge);return he&&F===ge?Wt({},F):F},si.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},si.prototype.splitTile=function(Q,he,ge,F,re,ye,Me){for(var ce=[Q,he,ge,F],Te=this.options,mt=Te.debug;ce.length;){F=ce.pop(),ge=ce.pop(),he=ce.pop(),Q=ce.pop();var wr=1<<he,Vt=ai(he,ge,F),$t=this.tiles[Vt];if(!$t&&(mt>1&&console.time("creation"),$t=this.tiles[Vt]=Wn(Q,he,ge,F,Te),this.tileCoords.push({z:he,x:ge,y:F}),mt)){mt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",he,ge,F,$t.numFeatures,$t.numPoints,$t.numSimplified),console.timeEnd("creation"));var Br="z"+he;this.stats[Br]=(this.stats[Br]||0)+1,this.total++}if($t.source=Q,re){if(he===Te.maxZoom||he===re)continue;var On=1<<re-he;if(ge!==Math.floor(ye/On)||F!==Math.floor(Me/On))continue}else if(he===Te.indexMaxZoom||$t.numPoints<=Te.indexMaxPoints)continue;if($t.source=null,0!==Q.length){mt>1&&console.time("clipping");var Cn,qt,xn,nn,ln,Di,gn=.5*Te.buffer/Te.extent,Oi=.5-gn,ta=.5+gn,oi=1+gn;Cn=qt=xn=nn=null,ln=B(Q,wr,ge-gn,ge+ta,0,$t.minX,$t.maxX,Te),Di=B(Q,wr,ge+Oi,ge+oi,0,$t.minX,$t.maxX,Te),Q=null,ln&&(Cn=B(ln,wr,F-gn,F+ta,1,$t.minY,$t.maxY,Te),qt=B(ln,wr,F+Oi,F+oi,1,$t.minY,$t.maxY,Te),ln=null),Di&&(xn=B(Di,wr,F-gn,F+ta,1,$t.minY,$t.maxY,Te),nn=B(Di,wr,F+Oi,F+oi,1,$t.minY,$t.maxY,Te),Di=null),mt>1&&console.timeEnd("clipping"),ce.push(Cn||[],he+1,2*ge,2*F),ce.push(qt||[],he+1,2*ge,2*F+1),ce.push(xn||[],he+1,2*ge+1,2*F),ce.push(nn||[],he+1,2*ge+1,2*F+1)}}},si.prototype.getTile=function(Q,he,ge){var F=this.options,re=F.extent,ye=F.debug;if(Q<0||Q>24)return null;var Me=1<<Q,ce=ai(Q,he=(he%Me+Me)%Me,ge);if(this.tiles[ce])return pr(this.tiles[ce],re);ye>1&&console.log("drilling down to z%d-%d-%d",Q,he,ge);for(var Te,mt=Q,wr=he,Vt=ge;!Te&&mt>0;)mt--,wr=Math.floor(wr/2),Vt=Math.floor(Vt/2),Te=this.tiles[ai(mt,wr,Vt)];return Te&&Te.source?(ye>1&&console.log("found parent tile z%d-%d-%d",mt,wr,Vt),ye>1&&console.time("drilling down"),this.splitTile(Te.source,mt,wr,Vt,Q,he,ge),ye>1&&console.timeEnd("drilling down"),this.tiles[ce]?pr(this.tiles[ce],re):null):null};var Pi=function(Q){function he(ge,F,re,ye){Q.call(this,ge,F,re,Yi),ye&&(this.loadGeoJSON=ye)}return Q&&(he.__proto__=Q),(he.prototype=Object.create(Q&&Q.prototype)).constructor=he,he.prototype.loadData=function(ge,F){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=F,this._pendingLoadDataParams=ge,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},he.prototype._loadData=function(){var ge=this;if(this._pendingCallback&&this._pendingLoadDataParams){var F=this._pendingCallback,re=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var ye=!!(re&&re.request&&re.request.collectResourceTiming)&&new p.RequestPerformance(re.request);this.loadGeoJSON(re,function(Me,ce){if(Me||!ce)return F(Me);if("object"!=typeof ce)return F(new Error("Input data given to '"+re.source+"' is not a valid GeoJSON object."));!function $t(Br,On){var Cn,qt=Br&&Br.type;if("FeatureCollection"===qt)for(Cn=0;Cn<Br.features.length;Cn++)$t(Br.features[Cn],On);else if("GeometryCollection"===qt)for(Cn=0;Cn<Br.geometries.length;Cn++)$t(Br.geometries[Cn],On);else if("Feature"===qt)$t(Br.geometry,On);else if("Polygon"===qt)tt(Br.coordinates,On);else if("MultiPolygon"===qt)for(Cn=0;Cn<Br.coordinates.length;Cn++)tt(Br.coordinates[Cn],On);return Br}(ce,!0);try{if(re.filter){var Te=p.createExpression(re.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Te.result)throw new Error(Te.value.map(function($t){return $t.key+": "+$t.message}).join(", "));var mt=ce.features.filter(function($t){return Te.value.evaluate({zoom:0},$t)});ce={type:"FeatureCollection",features:mt}}ge._geoJSONIndex=re.cluster?new fn(function($t){var Br=$t.superclusterOptions,On=$t.clusterProperties;if(!On||!Br)return Br;for(var Cn={},qt={},xn={accumulated:null,zoom:0},nn={properties:null},ln=Object.keys(On),Di=0,gn=ln;Di<gn.length;Di+=1){var Oi=gn[Di],ta=On[Oi],oi=ta[0],Ji=p.createExpression(ta[1]),ji=p.createExpression("string"==typeof oi?[oi,["accumulated"],["get",Oi]]:oi);Cn[Oi]=Ji.value,qt[Oi]=ji.value}return Br.map=function(Ti){nn.properties=Ti;for(var _a={},Ma=0,Gi=ln;Ma<Gi.length;Ma+=1){var Bi=Gi[Ma];_a[Bi]=Cn[Bi].evaluate(xn,nn)}return _a},Br.reduce=function(Ti,_a){nn.properties=_a;for(var Ma=0,Gi=ln;Ma<Gi.length;Ma+=1){var Bi=Gi[Ma];xn.accumulated=Ti[Bi],Ti[Bi]=qt[Bi].evaluate(xn,nn)}},Br}(re)).load(ce.features):new si($t=ce,re.geojsonVtOptions)}catch($t){return F($t)}var $t;ge.loaded={};var wr={};if(ye){var Vt=ye.finish();Vt&&(wr.resourceTiming={},wr.resourceTiming[re.source]=JSON.parse(JSON.stringify(Vt)))}F(null,wr)})}},he.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},he.prototype.reloadTile=function(ge,F){var re=this.loaded;return re&&re[ge.uid]?Q.prototype.reloadTile.call(this,ge,F):this.loadTile(ge,F)},he.prototype.loadGeoJSON=function(ge,F){if(ge.request)p.getJSON(ge.request,F);else{if("string"!=typeof ge.data)return F(new Error("Input data given to '"+ge.source+"' is not a valid GeoJSON object."));try{return F(null,JSON.parse(ge.data))}catch(re){return F(new Error("Input data given to '"+ge.source+"' is not a valid GeoJSON object."))}}},he.prototype.removeSource=function(ge,F){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),F()},he.prototype.getClusterExpansionZoom=function(ge,F){try{F(null,this._geoJSONIndex.getClusterExpansionZoom(ge.clusterId))}catch(re){F(re)}},he.prototype.getClusterChildren=function(ge,F){try{F(null,this._geoJSONIndex.getChildren(ge.clusterId))}catch(re){F(re)}},he.prototype.getClusterLeaves=function(ge,F){try{F(null,this._geoJSONIndex.getLeaves(ge.clusterId,ge.limit,ge.offset))}catch(re){F(re)}},he}(et),Ei=function(Q){var he=this;this.self=Q,this.actor=new p.Actor(Q,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:et,geojson:Pi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ge,F){if(he.workerSourceTypes[ge])throw new Error('Worker source with name "'+ge+'" already registered.');he.workerSourceTypes[ge]=F},this.self.registerRTLTextPlugin=function(ge){if(p.plugin.isParsed())throw new Error("RTL text plugin already registered.");p.plugin.applyArabicShaping=ge.applyArabicShaping,p.plugin.processBidirectionalText=ge.processBidirectionalText,p.plugin.processStyledBidirectionalText=ge.processStyledBidirectionalText}};return Ei.prototype.setReferrer=function(Q,he){this.referrer=he},Ei.prototype.setImages=function(Q,he,ge){for(var F in this.availableImages[Q]=he,this.workerSources[Q]){var re=this.workerSources[Q][F];for(var ye in re)re[ye].availableImages=he}ge()},Ei.prototype.setLayers=function(Q,he,ge){this.getLayerIndex(Q).replace(he),ge()},Ei.prototype.updateLayers=function(Q,he,ge){this.getLayerIndex(Q).update(he.layers,he.removedIds),ge()},Ei.prototype.loadTile=function(Q,he,ge){this.getWorkerSource(Q,he.type,he.source).loadTile(he,ge)},Ei.prototype.loadDEMTile=function(Q,he,ge){this.getDEMWorkerSource(Q,he.source).loadTile(he,ge)},Ei.prototype.reloadTile=function(Q,he,ge){this.getWorkerSource(Q,he.type,he.source).reloadTile(he,ge)},Ei.prototype.abortTile=function(Q,he,ge){this.getWorkerSource(Q,he.type,he.source).abortTile(he,ge)},Ei.prototype.removeTile=function(Q,he,ge){this.getWorkerSource(Q,he.type,he.source).removeTile(he,ge)},Ei.prototype.removeDEMTile=function(Q,he){this.getDEMWorkerSource(Q,he.source).removeTile(he)},Ei.prototype.removeSource=function(Q,he,ge){if(this.workerSources[Q]&&this.workerSources[Q][he.type]&&this.workerSources[Q][he.type][he.source]){var F=this.workerSources[Q][he.type][he.source];delete this.workerSources[Q][he.type][he.source],void 0!==F.removeSource?F.removeSource(he,ge):ge()}},Ei.prototype.loadWorkerSource=function(Q,he,ge){try{this.self.importScripts(he.url),ge()}catch(F){ge(F.toString())}},Ei.prototype.syncRTLPluginState=function(Q,he,ge){try{p.plugin.setState(he);var F=p.plugin.getPluginURL();if(p.plugin.isLoaded()&&!p.plugin.isParsed()&&null!=F){this.self.importScripts(F);var re=p.plugin.isParsed();ge(re?void 0:new Error("RTL Text Plugin failed to import scripts from "+F),re)}}catch(ye){ge(ye.toString())}},Ei.prototype.getAvailableImages=function(Q){var he=this.availableImages[Q];return he||(he=[]),he},Ei.prototype.getLayerIndex=function(Q){var he=this.layerIndexes[Q];return he||(he=this.layerIndexes[Q]=new X),he},Ei.prototype.getWorkerSource=function(Q,he,ge){var F=this;return this.workerSources[Q]||(this.workerSources[Q]={}),this.workerSources[Q][he]||(this.workerSources[Q][he]={}),this.workerSources[Q][he][ge]||(this.workerSources[Q][he][ge]=new this.workerSourceTypes[he]({send:function(re,ye,Me){F.actor.send(re,ye,Me,Q)}},this.getLayerIndex(Q),this.getAvailableImages(Q))),this.workerSources[Q][he][ge]},Ei.prototype.getDEMWorkerSource=function(Q,he){return this.demWorkerSources[Q]||(this.demWorkerSources[Q]={}),this.demWorkerSources[Q][he]||(this.demWorkerSources[Q][he]=new Z),this.demWorkerSources[Q][he]},Ei.prototype.enforceCacheSizeLimit=function(Q,he){p.enforceCacheSizeLimit(he)},"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ei(self)),Ei}),w(0,function(p){var _=p.createCommonjsModule(function(a){function s(y){return!o(y)}function o(y){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var C,k,K=new Blob([""],{type:"text/javascript"}),le=URL.createObjectURL(K);try{k=new Worker(le),C=!0}catch(Ee){C=!1}return k&&k.terminate(),URL.revokeObjectURL(le),C}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var C=document.createElement("canvas");C.width=C.height=1;var k=C.getContext("2d");if(!k)return!1;var K=k.getImageData(0,0,1,1);return K&&K.width===C.width}()?(void 0===h[S=y&&y.failIfMajorPerformanceCaveat]&&(h[S]=function(C){var le,Ee,Ae,k=(le=C,Ee=document.createElement("canvas"),(Ae=Object.create(s.webGLContextAttributes)).failIfMajorPerformanceCaveat=le,Ee.probablySupportsContext?Ee.probablySupportsContext("webgl",Ae)||Ee.probablySupportsContext("experimental-webgl",Ae):Ee.supportsContext?Ee.supportsContext("webgl",Ae)||Ee.supportsContext("experimental-webgl",Ae):Ee.getContext("webgl",Ae)||Ee.getContext("experimental-webgl",Ae));if(!k)return!1;var K=k.createShader(k.VERTEX_SHADER);return!(!K||k.isContextLost())&&(k.shaderSource(K,"void main() {}"),k.compileShader(K),!0===k.getShaderParameter(K,k.COMPILE_STATUS))}(S)),h[S]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var S}a.exports?a.exports=s:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=s,window.mapboxgl.notSupportedReason=o);var h={};s.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),W={create:function(a,s,o){var h=p.window.document.createElement(a);return void 0!==s&&(h.className=s),o&&o.appendChild(h),h},createNS:function(a,s){return p.window.document.createElementNS(a,s)}},X=p.window.document&&p.window.document.documentElement.style;function q(a){if(!X)return a[0];for(var s=0;s<a.length;s++)if(a[s]in X)return a[s];return a[0]}var te,Y=q(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);W.disableDrag=function(){X&&Y&&(te=X[Y],X[Y]="none")},W.enableDrag=function(){X&&Y&&(X[Y]=te)};var Xe=q(["transform","WebkitTransform"]);W.setTransform=function(a,s){a.style[Xe]=s};var et=!1;try{var z=Object.defineProperty({},"passive",{get:function(){et=!0}});p.window.addEventListener("test",z,z),p.window.removeEventListener("test",z,z)}catch(a){et=!1}W.addEventListener=function(a,s,o,h){void 0===h&&(h={}),a.addEventListener(s,o,"passive"in h&&et?h:h.capture)},W.removeEventListener=function(a,s,o,h){void 0===h&&(h={}),a.removeEventListener(s,o,"passive"in h&&et?h:h.capture)};var Z=function(a){a.preventDefault(),a.stopPropagation(),p.window.removeEventListener("click",Z,!0)};function tt(a){var s=a.userImage;return!!(s&&s.render&&s.render())&&(a.data.replace(new Uint8Array(s.data.buffer)),!0)}W.suppressClick=function(){p.window.addEventListener("click",Z,!0),p.window.setTimeout(function(){p.window.removeEventListener("click",Z,!0)},0)},W.mousePos=function(a,s){var o=a.getBoundingClientRect();return new p.Point(s.clientX-o.left-a.clientLeft,s.clientY-o.top-a.clientTop)},W.touchPos=function(a,s){for(var o=a.getBoundingClientRect(),h=[],y=0;y<s.length;y++)h.push(new p.Point(s[y].clientX-o.left-a.clientLeft,s[y].clientY-o.top-a.clientTop));return h},W.mouseButton=function(a){return void 0!==p.window.InstallTrigger&&2===a.button&&a.ctrlKey&&p.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:a.button},W.remove=function(a){a.parentNode&&a.parentNode.removeChild(a)};var Mt=function(a){function s(){a.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new p.RGBAImage({width:1,height:1}),this.dirty=!0}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.isLoaded=function(){return this.loaded},s.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var h=0,y=this.requestors;h<y.length;h+=1){var S=y[h];this._notify(S.ids,S.callback)}this.requestors=[]}},s.prototype.getImage=function(o){return this.images[o]},s.prototype.addImage=function(o,h){this._validate(o,h)&&(this.images[o]=h)},s.prototype._validate=function(o,h){var y=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new p.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),y=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new p.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),y=!1),this._validateContent(h.content,h)||(this.fire(new p.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),y=!1),y},s.prototype._validateStretch=function(o,h){if(!o)return!0;for(var y=0,S=0,C=o;S<C.length;S+=1){var k=C[S];if(k[0]<y||k[1]<k[0]||h<k[1])return!1;y=k[1]}return!0},s.prototype._validateContent=function(o,h){return!(o&&(4!==o.length||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},s.prototype.updateImage=function(o,h){h.version=this.images[o].version+1,this.images[o]=h,this.updatedImages[o]=!0},s.prototype.removeImage=function(o){var h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()},s.prototype.listImages=function(){return Object.keys(this.images)},s.prototype.getImages=function(o,h){var y=!0;if(!this.isLoaded())for(var S=0,C=o;S<C.length;S+=1)this.images[C[S]]||(y=!1);this.isLoaded()||y?this._notify(o,h):this.requestors.push({ids:o,callback:h})},s.prototype._notify=function(o,h){for(var y={},S=0,C=o;S<C.length;S+=1){var k=C[S];this.images[k]||this.fire(new p.Event("styleimagemissing",{id:k}));var K=this.images[k];K?y[k]={data:K.data.clone(),pixelRatio:K.pixelRatio,sdf:K.sdf,version:K.version,stretchX:K.stretchX,stretchY:K.stretchY,content:K.content,hasRenderCallback:Boolean(K.userImage&&K.userImage.render)}:p.warnOnce('Image "'+k+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}h(null,y)},s.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},s.prototype.getPattern=function(o){var h=this.patterns[o],y=this.getImage(o);if(!y)return null;if(h&&h.position.version===y.version)return h.position;if(h)h.position.version=y.version;else{var S={w:y.data.width+2,h:y.data.height+2,x:0,y:0},C=new p.ImagePosition(S,y);this.patterns[o]={bin:S,position:C}}return this._updatePatternAtlas(),this.patterns[o].position},s.prototype.bind=function(o){var h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new p.Texture(o,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)},s.prototype._updatePatternAtlas=function(){var o=[];for(var h in this.patterns)o.push(this.patterns[h].bin);var y=p.potpack(o),S=y.w,C=y.h,k=this.atlasImage;for(var K in k.resize({width:S||1,height:C||1}),this.patterns){var le=this.patterns[K].bin,Ee=le.x+1,Ae=le.y+1,Oe=this.images[K].data,Ke=Oe.width,We=Oe.height;p.RGBAImage.copy(Oe,k,{x:0,y:0},{x:Ee,y:Ae},{width:Ke,height:We}),p.RGBAImage.copy(Oe,k,{x:0,y:We-1},{x:Ee,y:Ae-1},{width:Ke,height:1}),p.RGBAImage.copy(Oe,k,{x:0,y:0},{x:Ee,y:Ae+We},{width:Ke,height:1}),p.RGBAImage.copy(Oe,k,{x:Ke-1,y:0},{x:Ee-1,y:Ae},{width:1,height:We}),p.RGBAImage.copy(Oe,k,{x:0,y:0},{x:Ee+Ke,y:Ae},{width:1,height:We})}this.dirty=!0},s.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},s.prototype.dispatchRenderCallbacks=function(o){for(var h=0,y=o;h<y.length;h+=1){var S=y[h];if(!this.callbackDispatchedThisFrame[S]){this.callbackDispatchedThisFrame[S]=!0;var C=this.images[S];tt(C)&&this.updateImage(S,C)}}},s}(p.Evented),sr=Et,Ut=Et,At=1e20;function Et(a,s,o,h,y,S){this.fontSize=a||24,this.buffer=void 0===s?3:s,this.cutoff=h||.25,this.fontFamily=y||"sans-serif",this.fontWeight=S||"normal",this.radius=o||8;var C=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=C,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(C*C),this.gridInner=new Float64Array(C*C),this.f=new Float64Array(C),this.d=new Float64Array(C),this.z=new Float64Array(C+1),this.v=new Int16Array(C),this.middle=Math.round(C/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function vr(a,s,o,h,y,S,C){for(var k=0;k<s;k++){for(var K=0;K<o;K++)h[K]=a[K*s+k];for(ne(h,y,S,C,o),K=0;K<o;K++)a[K*s+k]=y[K]}for(K=0;K<o;K++){for(k=0;k<s;k++)h[k]=a[K*s+k];for(ne(h,y,S,C,s),k=0;k<s;k++)a[K*s+k]=Math.sqrt(y[k])}}function ne(a,s,o,h,y){o[0]=0,h[0]=-At,h[1]=+At;for(var S=1,C=0;S<y;S++){for(var k=(a[S]+S*S-(a[o[C]]+o[C]*o[C]))/(2*S-2*o[C]);k<=h[C];)C--,k=(a[S]+S*S-(a[o[C]]+o[C]*o[C]))/(2*S-2*o[C]);o[++C]=S,h[C]=k,h[C+1]=+At}for(S=0,C=0;S<y;S++){for(;h[C+1]<S;)C++;s[S]=(S-o[C])*(S-o[C])+a[o[C]]}}Et.prototype.draw=function(a){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(a,this.buffer,this.middle);for(var s=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),h=0;h<this.size*this.size;h++){var y=s.data[4*h+3]/255;this.gridOuter[h]=1===y?0:0===y?At:Math.pow(Math.max(0,.5-y),2),this.gridInner[h]=1===y?At:0===y?0:Math.pow(Math.max(0,y-.5),2)}for(vr(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),vr(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),h=0;h<this.size*this.size;h++)o[h]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[h]-this.gridInner[h])/this.radius+this.cutoff))));return o},sr.default=Ut;var nr=function(a,s){this.requestManager=a,this.localIdeographFontFamily=s,this.entries={}};nr.prototype.setURL=function(a){this.url=a},nr.prototype.getGlyphs=function(a,s){var o=this,h=[];for(var y in a)for(var S=0,C=a[y];S<C.length;S+=1)h.push({stack:y,id:C[S]});p.asyncAll(h,function(k,K){var le=k.stack,Ee=k.id,Ae=o.entries[le];Ae||(Ae=o.entries[le]={glyphs:{},requests:{},ranges:{}});var Oe=Ae.glyphs[Ee];if(void 0===Oe){if(Oe=o._tinySDF(Ae,le,Ee))return Ae.glyphs[Ee]=Oe,void K(null,{stack:le,id:Ee,glyph:Oe});var Ke=Math.floor(Ee/256);if(256*Ke>65535)K(new Error("glyphs > 65535 not supported"));else if(Ae.ranges[Ke])K(null,{stack:le,id:Ee,glyph:Oe});else{var We=Ae.requests[Ke];We||(We=Ae.requests[Ke]=[],nr.loadGlyphRange(le,Ke,o.url,o.requestManager,function(st,je){if(je){for(var at in je)o._doesCharSupportLocalGlyph(+at)||(Ae.glyphs[+at]=je[+at]);Ae.ranges[Ke]=!0}for(var xt=0,zt=We;xt<zt.length;xt+=1)(0,zt[xt])(st,je);delete Ae.requests[Ke]})),We.push(function(st,je){st?K(st):je&&K(null,{stack:le,id:Ee,glyph:je[Ee]||null})})}}else K(null,{stack:le,id:Ee,glyph:Oe})},function(k,K){if(k)s(k);else if(K){for(var le={},Ee=0,Ae=K;Ee<Ae.length;Ee+=1){var Oe=Ae[Ee],Ke=Oe.stack,We=Oe.id,st=Oe.glyph;(le[Ke]||(le[Ke]={}))[We]=st&&{id:st.id,bitmap:st.bitmap.clone(),metrics:st.metrics}}s(null,le)}})},nr.prototype._doesCharSupportLocalGlyph=function(a){return!!this.localIdeographFontFamily&&(p.isChar["CJK Unified Ideographs"](a)||p.isChar["Hangul Syllables"](a)||p.isChar.Hiragana(a)||p.isChar.Katakana(a))},nr.prototype._tinySDF=function(a,s,o){var h=this.localIdeographFontFamily;if(h&&this._doesCharSupportLocalGlyph(o)){var y=a.tinySDF;if(!y){var S="400";/bold/i.test(s)?S="900":/medium/i.test(s)?S="500":/light/i.test(s)&&(S="200"),y=a.tinySDF=new nr.TinySDF(24,3,8,.25,h,S)}return{id:o,bitmap:new p.AlphaImage({width:30,height:30},y.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},nr.loadGlyphRange=function(a,s,o,h,y){var S=256*s,C=S+255,k=h.transformRequest(h.normalizeGlyphsURL(o).replace("{fontstack}",a).replace("{range}",S+"-"+C),p.ResourceType.Glyphs);p.getArrayBuffer(k,function(K,le){if(K)y(K);else if(le){for(var Ee={},Ae=0,Oe=p.parseGlyphPBF(le);Ae<Oe.length;Ae+=1){var Ke=Oe[Ae];Ee[Ke.id]=Ke}y(null,Ee)}})},nr.TinySDF=sr;var Tt=function(){this.specification=p.styleSpec.light.position};Tt.prototype.possiblyEvaluate=function(a,s){return p.sphericalToCartesian(a.expression.evaluate(s))},Tt.prototype.interpolate=function(a,s,o){return{x:p.number(a.x,s.x,o),y:p.number(a.y,s.y,o),z:p.number(a.z,s.z,o)}};var $e=new p.Properties({anchor:new p.DataConstantProperty(p.styleSpec.light.anchor),position:new Tt,color:new p.DataConstantProperty(p.styleSpec.light.color),intensity:new p.DataConstantProperty(p.styleSpec.light.intensity)}),Ct=function(a){function s(o){a.call(this),this._transitionable=new p.Transitionable($e),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getLight=function(){return this._transitionable.serialize()},s.prototype.setLight=function(o,h){if(void 0===h&&(h={}),!this._validate(p.validateLight,o,h))for(var y in o){var S=o[y];p.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-"-transition".length),S):this._transitionable.setValue(y,S)}},s.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},s.prototype.hasTransition=function(){return this._transitioning.hasTransition()},s.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},s.prototype._validate=function(o,h,y){return(!y||!1!==y.validate)&&p.emitValidationErrors(this,o.call(p.validateStyle,p.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:p.styleSpec})))},s}(p.Evented),qe=function(a,s){this.width=a,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};qe.prototype.getDash=function(a,s){var o=a.join(",")+String(s);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(a,s)),this.dashEntry[o]},qe.prototype.getDashRanges=function(a,s,o){var h=[],y=a.length%2==1?-a[a.length-1]*o:0,S=a[0]*o,C=!0;h.push({left:y,right:S,isDash:C,zeroLength:0===a[0]});for(var k=a[0],K=1;K<a.length;K++){var le=a[K];h.push({left:y=k*o,right:S=(k+=le)*o,isDash:C=!C,zeroLength:0===le})}return h},qe.prototype.addRoundDash=function(a,s,o){for(var h=s/2,y=-o;y<=o;y++)for(var S=this.width*(this.nextRow+o+y),C=0,k=a[C],K=0;K<this.width;K++){K/k.right>1&&(k=a[++C]);var le=Math.abs(K-k.left),Ee=Math.abs(K-k.right),Ae=Math.min(le,Ee),Oe=void 0,Ke=y/o*(h+1);if(k.isDash){var We=h-Math.abs(Ke);Oe=Math.sqrt(Ae*Ae+We*We)}else Oe=h-Math.sqrt(Ae*Ae+Ke*Ke);this.data[S+K]=Math.max(0,Math.min(255,Oe+128))}},qe.prototype.addRegularDash=function(a){for(var s=a.length-1;s>=0;--s){var o=a[s],h=a[s+1];o.zeroLength?a.splice(s,1):h&&h.isDash===o.isDash&&(h.left=o.left,a.splice(s,1))}var y=a[0],S=a[a.length-1];y.isDash===S.isDash&&(y.left=S.left-this.width,S.right=y.right+this.width);for(var C=this.width*this.nextRow,k=0,K=a[k],le=0;le<this.width;le++){le/K.right>1&&(K=a[++k]);var Ee=Math.abs(le-K.left),Ae=Math.abs(le-K.right),Oe=Math.min(Ee,Ae);this.data[C+le]=Math.max(0,Math.min(255,(K.isDash?Oe:-Oe)+128))}},qe.prototype.addDash=function(a,s){var o=s?7:0,h=2*o+1;if(this.nextRow+h>this.height)return p.warnOnce("LineAtlas out of space"),null;for(var y=0,S=0;S<a.length;S++)y+=a[S];if(0!==y){var C=this.width/y,k=this.getDashRanges(a,this.width,C);s?this.addRoundDash(k,C,o):this.addRegularDash(k)}var K={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:y};return this.nextRow+=h,this.dirty=!0,K},qe.prototype.bind=function(a){var s=a.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))};var Dt=function a(s,o){this.workerPool=s,this.actors=[],this.currentActor=0,this.id=p.uniqueId();for(var h=this.workerPool.acquire(this.id),y=0;y<h.length;y++){var S=new a.Actor(h[y],o,this.id);S.name="Worker "+y,this.actors.push(S)}};function lr(a,s,o){var h=function(y,S){if(y)return o(y);if(S){var C=p.pick(p.extend(S,a),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);S.vector_layers&&(C.vectorLayers=S.vector_layers,C.vectorLayerIds=C.vectorLayers.map(function(k){return k.id})),C.tiles=s.canonicalizeTileset(C,a.url),o(null,C)}};return a.url?p.getJSON(s.transformRequest(s.normalizeSourceURL(a.url),p.ResourceType.Source),h):p.browser.frame(function(){return h(null,a)})}Dt.prototype.broadcast=function(a,s,o){p.asyncAll(this.actors,function(h,y){h.send(a,s,y)},o=o||function(){})},Dt.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Dt.prototype.remove=function(){this.actors.forEach(function(a){a.remove()}),this.actors=[],this.workerPool.release(this.id)},Dt.Actor=p.Actor;var hr=function(a,s,o){this.bounds=p.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=s||0,this.maxzoom=o||24};hr.prototype.validateBounds=function(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]},hr.prototype.contains=function(a){var s=Math.pow(2,a.z),o=Math.floor(p.mercatorXfromLng(this.bounds.getWest())*s),h=Math.floor(p.mercatorYfromLat(this.bounds.getNorth())*s),y=Math.ceil(p.mercatorXfromLng(this.bounds.getEast())*s),S=Math.ceil(p.mercatorYfromLat(this.bounds.getSouth())*s);return a.x>=o&&a.x<y&&a.y>=h&&a.y<S};var Dr=function(a){function s(o,h,y,S){if(a.call(this),this.id=o,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,p.extend(this,p.pick(h,["url","scheme","tileSize","promoteId"])),this._options=p.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=lr(this._options,this.map._requestManager,function(h,y){o._tileJSONRequest=null,o._loaded=!0,h?o.fire(new p.ErrorEvent(h)):y&&(p.extend(o,y),y.bounds&&(o.tileBounds=new hr(y.bounds,o.minzoom,o.maxzoom)),p.postTurnstileEvent(y.tiles,o.map._requestManager._customAccessToken),p.postMapLoadEvent(y.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},s.prototype.setTiles=function(o){var h=this;return this.setSourceProperty(function(){h._options.tiles=o}),this},s.prototype.setUrl=function(o){var h=this;return this.setSourceProperty(function(){h.url=o,h._options.url=o}),this},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return p.extend({},this._options)},s.prototype.loadTile=function(o,h){var y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),S={request:this.map._requestManager.transformRequest(y,p.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:p.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function C(k,K){return delete o.request,o.aborted?h(null):k&&404!==k.status?h(k):(K&&K.resourceTiming&&(o.resourceTiming=K.resourceTiming),this.map._refreshExpiredTiles&&K&&o.setExpiryData(K),o.loadVectorData(K,this.map.painter),p.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}S.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state?"loading"===o.state?o.reloadCallback=h:o.request=o.actor.send("reloadTile",S,C.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",S,C.bind(this)))},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},s.prototype.hasTransition=function(){return!1},s}(p.Evented),_e=function(a){function s(o,h,y,S){a.call(this),this.id=o,this.dispatcher=y,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=p.extend({type:"raster"},h),p.extend(this,p.pick(h,["url","scheme","tileSize"]))}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=lr(this._options,this.map._requestManager,function(h,y){o._tileJSONRequest=null,o._loaded=!0,h?o.fire(new p.ErrorEvent(h)):y&&(p.extend(o,y),y.bounds&&(o.tileBounds=new hr(y.bounds,o.minzoom,o.maxzoom)),p.postTurnstileEvent(y.tiles),p.postMapLoadEvent(y.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})))})},s.prototype.loaded=function(){return this._loaded},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},s.prototype.serialize=function(){return p.extend({},this._options)},s.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},s.prototype.loadTile=function(o,h){var y=this,S=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=p.getImage(this.map._requestManager.transformRequest(S,p.ResourceType.Tile),function(C,k){if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(C)o.state="errored",h(C);else if(k){y.map._refreshExpiredTiles&&o.setExpiryData(k),delete k.cacheControl,delete k.expires;var K=y.map.painter.context,le=K.gl;o.texture=y.map.painter.getTileTexture(k.width),o.texture?o.texture.update(k,{useMipmap:!0}):(o.texture=new p.Texture(K,k,le.RGBA,{useMipmap:!0}),o.texture.bind(le.LINEAR,le.CLAMP_TO_EDGE,le.LINEAR_MIPMAP_NEAREST),K.extTextureFilterAnisotropic&&le.texParameterf(le.TEXTURE_2D,K.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,K.extTextureFilterAnisotropicMax)),o.state="loaded",p.cacheEntryPossiblyAdded(y.dispatcher),h(null)}})},s.prototype.abortTile=function(o,h){o.request&&(o.request.cancel(),delete o.request),h()},s.prototype.unloadTile=function(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()},s.prototype.hasTransition=function(){return!1},s}(p.Evented),ve=function(a){function s(o,h,y,S){a.call(this,o,h,y,S),this.type="raster-dem",this.maxzoom=22,this._options=p.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},s.prototype.loadTile=function(o,h){var y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function S(C,k){C&&(o.state="errored",h(C)),k&&(o.dem=k,o.needsHillshadePrepare=!0,o.state="loaded",h(null))}o.request=p.getImage(this.map._requestManager.transformRequest(y,p.ResourceType.Tile),function(C,k){if(delete o.request,o.aborted)o.state="unloaded",h(null);else if(C)o.state="errored",h(C);else if(k){this.map._refreshExpiredTiles&&o.setExpiryData(k),delete k.cacheControl,delete k.expires;var K=p.window.ImageBitmap&&k instanceof p.window.ImageBitmap&&p.offscreenCanvasSupported()?k:p.browser.getImageData(k,1),le={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:K,encoding:this.encoding};o.actor&&"expired"!==o.state||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",le,S.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},s.prototype._getNeighboringTiles=function(o){var h=o.canonical,y=Math.pow(2,h.z),S=(h.x-1+y)%y,C=0===h.x?o.wrap-1:o.wrap,k=(h.x+1+y)%y,K=h.x+1===y?o.wrap+1:o.wrap,le={};return le[new p.OverscaledTileID(o.overscaledZ,C,h.z,S,h.y).key]={backfilled:!1},le[new p.OverscaledTileID(o.overscaledZ,K,h.z,k,h.y).key]={backfilled:!1},h.y>0&&(le[new p.OverscaledTileID(o.overscaledZ,C,h.z,S,h.y-1).key]={backfilled:!1},le[new p.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},le[new p.OverscaledTileID(o.overscaledZ,K,h.z,k,h.y-1).key]={backfilled:!1}),h.y+1<y&&(le[new p.OverscaledTileID(o.overscaledZ,C,h.z,S,h.y+1).key]={backfilled:!1},le[new p.OverscaledTileID(o.overscaledZ,o.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},le[new p.OverscaledTileID(o.overscaledZ,K,h.z,k,h.y+1).key]={backfilled:!1}),le},s.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},s}(_e),ae=function(a){function s(o,h,y,S){a.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=y.getActor(),this.setEventedParent(S),this._data=h.data,this._options=p.extend({},h),this._collectResourceTiming=h.collectResourceTiming,this._resourceTiming=[],void 0!==h.maxzoom&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;var C=p.EXTENT/this.tileSize;this.workerOptions=p.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(void 0!==h.buffer?h.buffer:128)*C,tolerance:(void 0!==h.tolerance?h.tolerance:.375)*C,extent:p.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:void 0!==h.clusterMaxZoom?Math.min(h.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:p.EXTENT,radius:(h.clusterRadius||50)*C,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this.fire(new p.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(h){if(h)o.fire(new p.ErrorEvent(h));else{var y={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(y.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new p.Event("data",y))}})},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setData=function(o){var h=this;return this._data=o,this.fire(new p.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(y){if(y)h.fire(new p.ErrorEvent(y));else{var S={dataType:"source",sourceDataType:"content"};h._collectResourceTiming&&h._resourceTiming&&h._resourceTiming.length>0&&(S.resourceTiming=h._resourceTiming,h._resourceTiming=[]),h.fire(new p.Event("data",S))}}),this},s.prototype.getClusterExpansionZoom=function(o,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},h),this},s.prototype.getClusterChildren=function(o,h){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},h),this},s.prototype.getClusterLeaves=function(o,h,y,S){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:h,offset:y},S),this},s.prototype._updateWorkerData=function(o){var h=this;this._loaded=!1;var y=p.extend({},this.workerOptions),S=this._data;"string"==typeof S?(y.request=this.map._requestManager.transformRequest(p.browser.resolveURL(S),p.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(S),this.actor.send(this.type+".loadData",y,function(C,k){h._removed||k&&k.abandoned||(h._loaded=!0,k&&k.resourceTiming&&k.resourceTiming[h.id]&&(h._resourceTiming=k.resourceTiming[h.id].slice(0)),h.actor.send(h.type+".coalesce",{source:y.source},null),o(C))})},s.prototype.loaded=function(){return this._loaded},s.prototype.loadTile=function(o,h){var y=this,S=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(S,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:p.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(C,k){return delete o.request,o.unloadVectorData(),o.aborted?h(null):C?h(C):(o.loadVectorData(k,y.map.painter,"reloadTile"===S),h(null))})},s.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},s.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},s.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},s.prototype.serialize=function(){return p.extend({},this._options,{type:this.type,data:this._data})},s.prototype.hasTransition=function(){return!1},s}(p.Evented),de=p.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Pe=function(a){function s(o,h,y,S){a.call(this),this.id=o,this.dispatcher=y,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=h}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(o,h){var y=this;this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this.url=this.options.url,p.getImage(this.map._requestManager.transformRequest(this.url,p.ResourceType.Image),function(S,C){y._loaded=!0,S?y.fire(new p.ErrorEvent(S)):C&&(y.image=C,o&&(y.coordinates=o),h&&h(),y._finishLoading())})},s.prototype.loaded=function(){return this._loaded},s.prototype.updateImage=function(o){var h=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){h.texture=null}),this):this},s.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})))},s.prototype.onAdd=function(o){this.map=o,this.load()},s.prototype.setCoordinates=function(o){var h=this;this.coordinates=o;var y=o.map(p.MercatorCoordinate.fromLngLat);this.tileID=function(C){for(var k=1/0,K=1/0,le=-1/0,Ee=-1/0,Ae=0,Oe=C;Ae<Oe.length;Ae+=1){var Ke=Oe[Ae];k=Math.min(k,Ke.x),K=Math.min(K,Ke.y),le=Math.max(le,Ke.x),Ee=Math.max(Ee,Ke.y)}var We=Math.max(le-k,Ee-K),st=Math.max(0,Math.floor(-Math.log(We)/Math.LN2)),je=Math.pow(2,st);return new p.CanonicalTileID(st,Math.floor((k+le)/2*je),Math.floor((K+Ee)/2*je))}(y),this.minzoom=this.maxzoom=this.tileID.z;var S=y.map(function(C){return h.tileID.getTilePoint(C)._round()});return this._boundsArray=new p.StructArrayLayout4i8,this._boundsArray.emplaceBack(S[0].x,S[0].y,0,0),this._boundsArray.emplaceBack(S[1].x,S[1].y,p.EXTENT,0),this._boundsArray.emplaceBack(S[3].x,S[3].y,0,p.EXTENT),this._boundsArray.emplaceBack(S[2].x,S[2].y,p.EXTENT,p.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})),this},s.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var o=this.map.painter.context,h=o.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,de.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new p.Texture(o,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this.tiles){var S=this.tiles[y];"loaded"!==S.state&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.loadTile=function(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))},s.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return!1},s}(p.Evented),ze=function(a){function s(o,h,y,S){a.call(this,o,h,y,S),this.roundZoom=!0,this.type="video",this.options=h}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){var o=this;this._loaded=!1;var h=this.options;this.urls=[];for(var y=0,S=h.urls;y<S.length;y+=1)this.urls.push(this.map._requestManager.transformRequest(S[y],p.ResourceType.Source).url);p.getVideo(this.urls,function(C,k){o._loaded=!0,C?o.fire(new p.ErrorEvent(C)):k&&(o.video=k,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},s.prototype.pause=function(){this.video&&this.video.pause()},s.prototype.play=function(){this.video&&this.video.play()},s.prototype.seek=function(o){if(this.video){var h=this.video.seekable;o<h.start(0)||o>h.end(0)?this.fire(new p.ErrorEvent(new p.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+h.start(0)+" and "+h.end(0)+"-second mark."))):this.video.currentTime=o}},s.prototype.getVideo=function(){return this.video},s.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},s.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var o=this.map.painter.context,h=o.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,de.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new p.Texture(o,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this.tiles){var S=this.tiles[y];"loaded"!==S.state&&(S.state="loaded",S.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this.video&&!this.video.paused},s}(Pe),pt=function(a){function s(o,h,y,S){a.call(this,o,h,y,S),h.coordinates?Array.isArray(h.coordinates)&&4===h.coordinates.length&&!h.coordinates.some(function(C){return!Array.isArray(C)||2!==C.length||C.some(function(k){return"number"!=typeof k})})||this.fire(new p.ErrorEvent(new p.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new p.ErrorEvent(new p.ValidationError("sources."+o,null,'missing required property "coordinates"'))),h.animate&&"boolean"!=typeof h.animate&&this.fire(new p.ErrorEvent(new p.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),h.canvas?"string"==typeof h.canvas||h.canvas instanceof p.window.HTMLCanvasElement||this.fire(new p.ErrorEvent(new p.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new p.ErrorEvent(new p.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=h,this.animate=void 0===h.animate||h.animate}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof p.window.HTMLCanvasElement?this.options.canvas:p.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new p.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},s.prototype.getCanvas=function(){return this.canvas},s.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},s.prototype.onRemove=function(){this.pause()},s.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var h=this.map.painter.context,y=h.gl;for(var S in this.boundsBuffer||(this.boundsBuffer=h.createVertexBuffer(this._boundsArray,de.members)),this.boundsSegments||(this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new p.Texture(h,this.canvas,y.RGBA,{premultiply:!0}),this.tiles){var C=this.tiles[S];"loaded"!==C.state&&(C.state="loaded",C.texture=this.texture)}}},s.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},s.prototype.hasTransition=function(){return this._playing},s.prototype._hasInvalidDimensions=function(){for(var o=0,h=[this.canvas.width,this.canvas.height];o<h.length;o+=1){var y=h[o];if(isNaN(y)||y<=0)return!0}return!1},s}(Pe),br={vector:Dr,raster:_e,"raster-dem":ve,geojson:ae,video:ze,image:Pe,canvas:pt};function Ur(a,s){var o=p.identity([]);return p.translate(o,o,[1,1,0]),p.scale(o,o,[.5*a.width,.5*a.height,1]),p.multiply(o,o,a.calculatePosMatrix(s.toUnwrapped()))}function fn(a,s,o,h,y,S){var C=function(st,je,at){if(st)for(var xt=0,zt=st;xt<zt.length;xt+=1){var or=je[zt[xt]];if(or&&or.source===at&&"fill-extrusion"===or.type)return!0}else for(var Jt in je){var yr=je[Jt];if(yr.source===at&&"fill-extrusion"===yr.type)return!0}return!1}(y&&y.layers,s,a.id),k=S.maxPitchScaleFactor(),K=a.tilesIn(h,k,C);K.sort(Pr);for(var le=[],Ee=0,Ae=K;Ee<Ae.length;Ee+=1){var Oe=Ae[Ee];le.push({wrappedTileID:Oe.tileID.wrapped().key,queryResults:Oe.tile.queryRenderedFeatures(s,o,a._state,Oe.queryGeometry,Oe.cameraQueryGeometry,Oe.scale,y,S,k,Ur(a.transform,Oe.tileID))})}var Ke=function(st){for(var je={},at={},xt=0,zt=st;xt<zt.length;xt+=1){var or=zt[xt],Jt=or.queryResults,yr=or.wrappedTileID,Rr=at[yr]=at[yr]||{};for(var $r in Jt)for(var Xr=Jt[$r],pn=Rr[$r]=Rr[$r]||{},qn=je[$r]=je[$r]||[],Un=0,Rn=Xr;Un<Rn.length;Un+=1){var ki=Rn[Un];pn[ki.featureIndex]||(pn[ki.featureIndex]=!0,qn.push(ki))}}return je}(le);for(var We in Ke)Ke[We].forEach(function(st){var je=st.feature,at=a.getFeatureState(je.layer["source-layer"],je.id);je.source=je.layer.source,je.layer["source-layer"]&&(je.sourceLayer=je.layer["source-layer"]),je.state=at});return Ke}function Pr(a,s){var o=a.tileID,h=s.tileID;return o.overscaledZ-h.overscaledZ||o.canonical.y-h.canonical.y||o.wrap-h.wrap||o.canonical.x-h.canonical.x}var wt=function(a,s){this.max=a,this.onRemove=s,this.reset()};wt.prototype.reset=function(){for(var a in this.data)for(var s=0,o=this.data[a];s<o.length;s+=1){var h=o[s];h.timeout&&clearTimeout(h.timeout),this.onRemove(h.value)}return this.data={},this.order=[],this},wt.prototype.add=function(a,s,o){var h=this,y=a.wrapped().key;void 0===this.data[y]&&(this.data[y]=[]);var S={value:s,timeout:void 0};if(void 0!==o&&(S.timeout=setTimeout(function(){h.remove(a,S)},o)),this.data[y].push(S),this.order.push(y),this.order.length>this.max){var C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this},wt.prototype.has=function(a){return a.wrapped().key in this.data},wt.prototype.getAndRemove=function(a){return this.has(a)?this._getAndRemoveByKey(a.wrapped().key):null},wt.prototype._getAndRemoveByKey=function(a){var s=this.data[a].shift();return s.timeout&&clearTimeout(s.timeout),0===this.data[a].length&&delete this.data[a],this.order.splice(this.order.indexOf(a),1),s.value},wt.prototype.getByKey=function(a){var s=this.data[a];return s?s[0].value:null},wt.prototype.get=function(a){return this.has(a)?this.data[a.wrapped().key][0].value:null},wt.prototype.remove=function(a,s){if(!this.has(a))return this;var o=a.wrapped().key,h=void 0===s?0:this.data[o].indexOf(s),y=this.data[o][h];return this.data[o].splice(h,1),y.timeout&&clearTimeout(y.timeout),0===this.data[o].length&&delete this.data[o],this.onRemove(y.value),this.order.splice(this.order.indexOf(o),1),this},wt.prototype.setMaxSize=function(a){for(this.max=a;this.order.length>this.max;){var s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this},wt.prototype.filter=function(a){var s=[];for(var o in this.data)for(var h=0,y=this.data[o];h<y.length;h+=1){var S=y[h];a(S.value)||s.push(S)}for(var C=0,k=s;C<k.length;C+=1){var K=k[C];this.remove(K.value.tileID,K)}};var Ie=function(a,s,o){this.context=a;var h=a.gl;this.buffer=h.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};Ie.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},Ie.prototype.updateData=function(a){var s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)},Ie.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var we={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},nt=function(a,s,o,h){this.length=s.length,this.attributes=o,this.itemSize=s.bytesPerElement,this.dynamicDraw=h,this.context=a;var y=a.gl;this.buffer=y.createBuffer(),a.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer};nt.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},nt.prototype.updateData=function(a){var s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,a.arrayBuffer)},nt.prototype.enableAttributes=function(a,s){for(var o=0;o<this.attributes.length;o++){var h=s.attributes[this.attributes[o].name];void 0!==h&&a.enableVertexAttribArray(h)}},nt.prototype.setVertexAttribPointers=function(a,s,o){for(var h=0;h<this.attributes.length;h++){var y=this.attributes[h],S=s.attributes[y.name];void 0!==S&&a.vertexAttribPointer(S,y.components,a[we[y.type]],!1,this.itemSize,y.offset+this.itemSize*(o||0))}},nt.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Le=function(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Le.prototype.get=function(){return this.current},Le.prototype.set=function(a){},Le.prototype.getDefault=function(){return this.default},Le.prototype.setDefault=function(){this.set(this.default)};var Wt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return p.Color.transparent},s.prototype.set=function(o){var h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Le),Ar=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 1},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},s}(Le),Yt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},s}(Le),cr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return[!0,!0,!0,!0]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Le),Fr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},s}(Le),Zn=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 255},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},s}(Le),T=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},s.prototype.set=function(o){var h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},s}(Le),G=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},s}(Le),Ve=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}},s}(Le),rt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return[0,1]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Le),dt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}},s}(Le),Ot=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.LESS},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},s}(Le),B=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}},s}(Le),Ue=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},s}(Le),_t=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return p.Color.transparent},s.prototype.set=function(o){var h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},s}(Le),St=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.FUNC_ADD},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},s}(Le),Xt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}},s}(Le),Cr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.BACK},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},s}(Le),_r=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.CCW},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},s}(Le),jt=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},s}(Le),mr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return this.gl.TEXTURE0},s.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},s}(Le),er=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},s.prototype.set=function(o){var h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},s}(Le),pr=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},s}(Le),Ln=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Le),Wn=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}},s}(Le),mi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},s}(Le),hi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){var h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},s}(Le),si=function(a){function s(o){a.call(this,o),this.vao=o.extVertexArrayObject}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},s}(Le),ai=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return 4},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},s}(Le),Yi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},s}(Le),Pi=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return!1},s.prototype.set=function(o){if(o!==this.current||this.dirty){var h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},s}(Le),Ei=function(a){function s(o,h){a.call(this,o),this.context=o,this.parent=h}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getDefault=function(){return null},s}(Le),Q=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.setDirty=function(){this.dirty=!0},s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},s}(Ei),he=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,h.DEPTH_ATTACHMENT,h.RENDERBUFFER,o),this.current=o,this.dirty=!1}},s}(Ei),ge=function(a,s,o,h){this.context=a,this.width=s,this.height=o;var y=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new Q(a,y),h&&(this.depthAttachment=new he(a,y))};ge.prototype.destroy=function(){var a=this.context.gl,s=this.colorAttachment.get();if(s&&a.deleteTexture(s),this.depthAttachment){var o=this.depthAttachment.get();o&&a.deleteRenderbuffer(o)}a.deleteFramebuffer(this.framebuffer)};var F=function(a,s,o){this.func=a,this.mask=s,this.range=o};F.ReadOnly=!1,F.ReadWrite=!0,F.disabled=new F(519,F.ReadOnly,[0,1]);var re=function(a,s,o,h,y,S){this.test=a,this.ref=s,this.mask=o,this.fail=h,this.depthFail=y,this.pass=S};re.disabled=new re({func:519,mask:0},0,0,7680,7680,7680);var ye=function(a,s,o){this.blendFunction=a,this.blendColor=s,this.mask=o};ye.disabled=new ye(ye.Replace=[1,0],p.Color.transparent,[!1,!1,!1,!1]),ye.unblended=new ye(ye.Replace,p.Color.transparent,[!0,!0,!0,!0]),ye.alphaBlended=new ye([1,771],p.Color.transparent,[!0,!0,!0,!0]);var Me=function(a,s,o){this.enable=a,this.mode=s,this.frontFace=o};Me.disabled=new Me(!1,1029,2305),Me.backCCW=new Me(!0,1029,2305);var ce=function(a){this.gl=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Wt(this),this.clearDepth=new Ar(this),this.clearStencil=new Yt(this),this.colorMask=new cr(this),this.depthMask=new Fr(this),this.stencilMask=new Zn(this),this.stencilFunc=new T(this),this.stencilOp=new G(this),this.stencilTest=new Ve(this),this.depthRange=new rt(this),this.depthTest=new dt(this),this.depthFunc=new Ot(this),this.blend=new B(this),this.blendFunc=new Ue(this),this.blendColor=new _t(this),this.blendEquation=new St(this),this.cullFace=new Xt(this),this.cullFaceSide=new Cr(this),this.frontFace=new _r(this),this.program=new jt(this),this.activeTexture=new mr(this),this.viewport=new er(this),this.bindFramebuffer=new pr(this),this.bindRenderbuffer=new Ln(this),this.bindTexture=new Wn(this),this.bindVertexBuffer=new mi(this),this.bindElementBuffer=new hi(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new si(this),this.pixelStoreUnpack=new ai(this),this.pixelStoreUnpackPremultiplyAlpha=new Yi(this),this.pixelStoreUnpackFlipY=new Pi(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=a.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(a.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)};ce.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},ce.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},ce.prototype.createIndexBuffer=function(a,s){return new Ie(this,a,s)},ce.prototype.createVertexBuffer=function(a,s,o){return new nt(this,a,s,o)},ce.prototype.createRenderbuffer=function(a,s,o){var h=this.gl,y=h.createRenderbuffer();return this.bindRenderbuffer.set(y),h.renderbufferStorage(h.RENDERBUFFER,a,s,o),this.bindRenderbuffer.set(null),y},ce.prototype.createFramebuffer=function(a,s,o){return new ge(this,a,s,o)},ce.prototype.clear=function(a){var s=a.color,o=a.depth,h=this.gl,y=0;s&&(y|=h.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set([!0,!0,!0,!0])),void 0!==o&&(y|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),h.clear(y)},ce.prototype.setCullFace=function(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))},ce.prototype.setDepthMode=function(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)},ce.prototype.setStencilMode=function(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)},ce.prototype.setColorMode=function(a){p.deepEqual(a.blendFunction,ye.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)},ce.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Te=function(a){function s(o,h,y){var S=this;a.call(this),this.id=o,this.dispatcher=y,this.on("data",function(C){"source"===C.dataType&&"metadata"===C.sourceDataType&&(S._sourceLoaded=!0),S._sourceLoaded&&!S._paused&&"source"===C.dataType&&"content"===C.sourceDataType&&(S.reload(),S.transform&&S.update(S.transform))}),this.on("error",function(){S._sourceErrored=!0}),this._source=function(C,k,K,le){var Ee=new br[k.type](C,k,K,le);if(Ee.id!==C)throw new Error("Expected Source id to be "+C+" instead of "+Ee.id);return p.bindAll(["load","abort","unload","serialize","prepare"],Ee),Ee}(o,h,y,this),this._tiles={},this._cache=new wt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new p.SourceFeatureState}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},s.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},s.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var h=this._tiles[o];if("loaded"!==h.state&&"errored"!==h.state)return!1}return!0},s.prototype.getSource=function(){return this._source},s.prototype.pause=function(){this._paused=!0},s.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},s.prototype._loadTile=function(o,h){return this._source.loadTile(o,h)},s.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},s.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},s.prototype.serialize=function(){return this._source.serialize()},s.prototype.prepare=function(o){for(var h in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var y=this._tiles[h];y.upload(o),y.prepare(this.map.style.imageManager)}},s.prototype.getIds=function(){return p.values(this._tiles).map(function(o){return o.tileID}).sort(mt).map(function(o){return o.key})},s.prototype.getRenderableIds=function(o){var h=this,y=[];for(var S in this._tiles)this._isIdRenderable(S,o)&&y.push(this._tiles[S]);return o?y.sort(function(C,k){var K=C.tileID,le=k.tileID,Ee=new p.Point(K.canonical.x,K.canonical.y)._rotate(h.transform.angle),Ae=new p.Point(le.canonical.x,le.canonical.y)._rotate(h.transform.angle);return K.overscaledZ-le.overscaledZ||Ae.y-Ee.y||Ae.x-Ee.x}).map(function(C){return C.tileID.key}):y.map(function(C){return C.tileID}).sort(mt).map(function(C){return C.key})},s.prototype.hasRenderableParent=function(o){var h=this.findLoadedParent(o,0);return!!h&&this._isIdRenderable(h.tileID.key)},s.prototype._isIdRenderable=function(o,h){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(h||!this._tiles[o].holdingForFade())},s.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)"errored"!==this._tiles[o].state&&this._reloadTile(o,"reloading")},s.prototype._reloadTile=function(o,h){var y=this._tiles[o];y&&("loading"!==y.state&&(y.state=h),this._loadTile(y,this._tileLoaded.bind(this,y,o,h)))},s.prototype._tileLoaded=function(o,h,y,S){if(S)return o.state="errored",void(404!==S.status?this._source.fire(new p.ErrorEvent(S,{tile:o})):this.update(this.transform));o.timeAdded=p.browser.now(),"expired"===y&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(h,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new p.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},s.prototype._backfillDEM=function(o){for(var h=this.getRenderableIds(),y=0;y<h.length;y++){var S=h[y];if(o.neighboringTiles&&o.neighboringTiles[S]){var C=this.getTileByID(S);k(o,C),k(C,o)}}function k(K,le){K.needsHillshadePrepare=!0;var Ee=le.tileID.canonical.x-K.tileID.canonical.x,Ae=le.tileID.canonical.y-K.tileID.canonical.y,Oe=Math.pow(2,K.tileID.canonical.z),Ke=le.tileID.key;0===Ee&&0===Ae||Math.abs(Ae)>1||(Math.abs(Ee)>1&&(1===Math.abs(Ee+Oe)?Ee+=Oe:1===Math.abs(Ee-Oe)&&(Ee-=Oe)),le.dem&&K.dem&&(K.dem.backfillBorder(le.dem,Ee,Ae),K.neighboringTiles&&K.neighboringTiles[Ke]&&(K.neighboringTiles[Ke].backfilled=!0)))}},s.prototype.getTile=function(o){return this.getTileByID(o.key)},s.prototype.getTileByID=function(o){return this._tiles[o]},s.prototype._retainLoadedChildren=function(o,h,y,S){for(var C in this._tiles){var k=this._tiles[C];if(!(S[C]||!k.hasData()||k.tileID.overscaledZ<=h||k.tileID.overscaledZ>y)){for(var K=k.tileID;k&&k.tileID.overscaledZ>h+1;){var le=k.tileID.scaledTo(k.tileID.overscaledZ-1);(k=this._tiles[le.key])&&k.hasData()&&(K=le)}for(var Ee=K;Ee.overscaledZ>h;)if(o[(Ee=Ee.scaledTo(Ee.overscaledZ-1)).key]){S[K.key]=K;break}}}},s.prototype.findLoadedParent=function(o,h){if(o.key in this._loadedParentTiles){var y=this._loadedParentTiles[o.key];return y&&y.tileID.overscaledZ>=h?y:null}for(var S=o.overscaledZ-1;S>=h;S--){var C=o.scaledTo(S),k=this._getLoadedTile(C);if(k)return k}},s.prototype._getLoadedTile=function(o){var h=this._tiles[o.key];return h&&h.hasData()?h:this._cache.getByKey(o.wrapped().key)},s.prototype.updateCacheSize=function(o){var h=Math.ceil(o.width/this._source.tileSize)+1,y=Math.ceil(o.height/this._source.tileSize)+1,S=Math.floor(h*y*5),C="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(C)},s.prototype.handleWrapJump=function(o){var h=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,h){var y={};for(var S in this._tiles){var C=this._tiles[S];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+h),y[C.tileID.key]=C}for(var k in this._tiles=y,this._timers)clearTimeout(this._timers[k]),delete this._timers[k];for(var K in this._tiles)this._setTileReloadTimer(K,this._tiles[K])}},s.prototype.update=function(o){var h=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var y;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Rr){return new p.OverscaledTileID(Rr.canonical.z,Rr.wrap,Rr.canonical.z,Rr.canonical.x,Rr.canonical.y)}):(y=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(function(Rr){return h._source.hasTile(Rr)}))):y=[];var S=o.coveringZoomLevel(this._source),C=Math.max(S-s.maxOverzooming,this._source.minzoom),k=Math.max(S+s.maxUnderzooming,this._source.minzoom),K=this._updateRetainedTiles(y,S);if(wr(this._source.type)){for(var le={},Ee={},Ae=0,Oe=Object.keys(K);Ae<Oe.length;Ae+=1){var Ke=Oe[Ae],We=K[Ke],st=this._tiles[Ke];if(st&&!(st.fadeEndTime&&st.fadeEndTime<=p.browser.now())){var je=this.findLoadedParent(We,C);je&&(this._addTile(je.tileID),le[je.tileID.key]=je.tileID),Ee[Ke]=We}}for(var at in this._retainLoadedChildren(Ee,S,k,K),le)K[at]||(this._coveredTiles[at]=!0,K[at]=le[at])}for(var xt in K)this._tiles[xt].clearFadeHold();for(var zt=0,or=p.keysDifference(this._tiles,K);zt<or.length;zt+=1){var Jt=or[zt],yr=this._tiles[Jt];yr.hasSymbolBuckets&&!yr.holdingForFade()?yr.setHoldDuration(this.map._fadeDuration):yr.hasSymbolBuckets&&!yr.symbolFadeFinished()||this._removeTile(Jt)}this._updateLoadedParentTileCache()}},s.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},s.prototype._updateRetainedTiles=function(o,h){for(var y={},S={},C=Math.max(h-s.maxOverzooming,this._source.minzoom),k=Math.max(h+s.maxUnderzooming,this._source.minzoom),K={},le=0,Ee=o;le<Ee.length;le+=1){var Ae=Ee[le],Oe=this._addTile(Ae);y[Ae.key]=Ae,Oe.hasData()||h<this._source.maxzoom&&(K[Ae.key]=Ae)}this._retainLoadedChildren(K,h,k,y);for(var Ke=0,We=o;Ke<We.length;Ke+=1){var st=We[Ke],je=this._tiles[st.key];if(!je.hasData()){if(h+1>this._source.maxzoom){var at=st.children(this._source.maxzoom)[0],xt=this.getTile(at);if(xt&&xt.hasData()){y[at.key]=at;continue}}else{var zt=st.children(this._source.maxzoom);if(y[zt[0].key]&&y[zt[1].key]&&y[zt[2].key]&&y[zt[3].key])continue}for(var or=je.wasRequested(),Jt=st.overscaledZ-1;Jt>=C;--Jt){var yr=st.scaledTo(Jt);if(S[yr.key]||(S[yr.key]=!0,!(je=this.getTile(yr))&&or&&(je=this._addTile(yr)),je&&(y[yr.key]=yr,or=je.wasRequested(),je.hasData())))break}}}return y},s.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var h=[],y=void 0,S=this._tiles[o].tileID;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){y=this._loadedParentTiles[S.key];break}h.push(S.key);var C=S.scaledTo(S.overscaledZ-1);if(y=this._getLoadedTile(C))break;S=C}for(var k=0,K=h;k<K.length;k+=1)this._loadedParentTiles[K[k]]=y}},s.prototype._addTile=function(o){var h=this._tiles[o.key];if(h)return h;(h=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,h),h.tileID=o,this._state.initializeTileState(h,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,h)));var y=Boolean(h);return y||(h=new p.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(h,this._tileLoaded.bind(this,h,o.key,h.state))),h?(h.uses++,this._tiles[o.key]=h,y||this._source.fire(new p.Event("dataloading",{tile:h,coord:h.tileID,dataType:"source"})),h):null},s.prototype._setTileReloadTimer=function(o,h){var y=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var S=h.getExpiryTimeout();S&&(this._timers[o]=setTimeout(function(){y._reloadTile(o,"expired"),delete y._timers[o]},S))},s.prototype._removeTile=function(o){var h=this._tiles[o];h&&(h.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),h.uses>0||(h.hasData()&&"reloading"!==h.state?this._cache.add(h.tileID,h,h.getExpiryTimeout()):(h.aborted=!0,this._abortTile(h),this._unloadTile(h))))},s.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},s.prototype.tilesIn=function(o,h,y){var S=this,C=[],k=this.transform;if(!k)return C;for(var K=y?k.getCameraQueryGeometry(o):o,le=o.map(function(Jt){return k.pointCoordinate(Jt)}),Ee=K.map(function(Jt){return k.pointCoordinate(Jt)}),Ae=this.getIds(),Oe=1/0,Ke=1/0,We=-1/0,st=-1/0,je=0,at=Ee;je<at.length;je+=1){var xt=at[je];Oe=Math.min(Oe,xt.x),Ke=Math.min(Ke,xt.y),We=Math.max(We,xt.x),st=Math.max(st,xt.y)}for(var zt=function(Jt){var yr=S._tiles[Ae[Jt]];if(!yr.holdingForFade()){var Rr=yr.tileID,$r=Math.pow(2,k.zoom-yr.tileID.overscaledZ),Xr=h*yr.queryPadding*p.EXTENT/yr.tileSize/$r,pn=[Rr.getTilePoint(new p.MercatorCoordinate(Oe,Ke)),Rr.getTilePoint(new p.MercatorCoordinate(We,st))];if(pn[0].x-Xr<p.EXTENT&&pn[0].y-Xr<p.EXTENT&&pn[1].x+Xr>=0&&pn[1].y+Xr>=0){var qn=le.map(function(Rn){return Rr.getTilePoint(Rn)}),Un=Ee.map(function(Rn){return Rr.getTilePoint(Rn)});C.push({tile:yr,tileID:Rr,queryGeometry:qn,cameraQueryGeometry:Un,scale:$r})}}},or=0;or<Ae.length;or++)zt(or);return C},s.prototype.getVisibleCoordinates=function(o){for(var h=this,y=this.getRenderableIds(o).map(function(K){return h._tiles[K].tileID}),S=0,C=y;S<C.length;S+=1){var k=C[S];k.posMatrix=this.transform.calculatePosMatrix(k.toUnwrapped())}return y},s.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(wr(this._source.type))for(var o in this._tiles){var h=this._tiles[o];if(void 0!==h.fadeEndTime&&h.fadeEndTime>=p.browser.now())return!0}return!1},s.prototype.setFeatureState=function(o,h,y){this._state.updateState(o=o||"_geojsonTileLayer",h,y)},s.prototype.removeFeatureState=function(o,h,y){this._state.removeFeatureState(o=o||"_geojsonTileLayer",h,y)},s.prototype.getFeatureState=function(o,h){return this._state.getState(o=o||"_geojsonTileLayer",h)},s.prototype.setDependencies=function(o,h,y){var S=this._tiles[o];S&&S.setDependencies(h,y)},s.prototype.reloadTilesForDependencies=function(o,h){for(var y in this._tiles)this._tiles[y].hasDependency(o,h)&&this._reloadTile(y,"reloading");this._cache.filter(function(S){return!S.hasDependency(o,h)})},s}(p.Evented);function mt(a,s){var o=Math.abs(2*a.wrap)-+(a.wrap<0),h=Math.abs(2*s.wrap)-+(s.wrap<0);return a.overscaledZ-s.overscaledZ||h-o||s.canonical.y-a.canonical.y||s.canonical.x-a.canonical.x}function wr(a){return"raster"===a||"image"===a||"video"===a}function Vt(){return new p.window.Worker(El.workerUrl)}Te.maxOverzooming=10,Te.maxUnderzooming=3;var $t="mapboxgl_preloaded_worker_pool",Br=function(){this.active={}};Br.prototype.acquire=function(a){if(!this.workers)for(this.workers=[];this.workers.length<Br.workerCount;)this.workers.push(new Vt);return this.active[a]=!0,this.workers.slice()},Br.prototype.release=function(a){delete this.active[a],0===this.numActive()&&(this.workers.forEach(function(s){s.terminate()}),this.workers=null)},Br.prototype.isPreloaded=function(){return!!this.active[$t]},Br.prototype.numActive=function(){return Object.keys(this.active).length};var On,Cn=Math.floor(p.browser.hardwareConcurrency/2);function qt(){return On||(On=new Br),On}function xn(a,s){var o={};for(var h in a)"ref"!==h&&(o[h]=a[h]);return p.refProperties.forEach(function(y){y in s&&(o[y]=s[y])}),o}function nn(a){a=a.slice();for(var s=Object.create(null),o=0;o<a.length;o++)s[a[o].id]=a[o];for(var h=0;h<a.length;h++)"ref"in a[h]&&(a[h]=xn(a[h],s[a[h].ref]));return a}Br.workerCount=Math.max(Math.min(Cn,6),1);var ln={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Di(a,s,o){o.push({command:ln.addSource,args:[a,s[a]]})}function gn(a,s,o){s.push({command:ln.removeSource,args:[a]}),o[a]=!0}function Oi(a,s,o,h){gn(a,o,h),Di(a,s,o)}function ta(a,s,o){var h;for(h in a[o])if(a[o].hasOwnProperty(h)&&"data"!==h&&!p.deepEqual(a[o][h],s[o][h]))return!1;for(h in s[o])if(s[o].hasOwnProperty(h)&&"data"!==h&&!p.deepEqual(a[o][h],s[o][h]))return!1;return!0}function oi(a,s,o,h,y,S){var C;for(C in s=s||{},a=a||{})a.hasOwnProperty(C)&&(p.deepEqual(a[C],s[C])||o.push({command:S,args:[h,C,s[C],y]}));for(C in s)s.hasOwnProperty(C)&&!a.hasOwnProperty(C)&&(p.deepEqual(a[C],s[C])||o.push({command:S,args:[h,C,s[C],y]}))}function Ji(a){return a.id}function ji(a,s){return a[s.id]=s,a}var Ti=function(a,s){this.reset(a,s)};Ti.prototype.reset=function(a,s){this.points=a||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ti.prototype.lerp=function(a){if(1===this.points.length)return this.points[0];a=p.clamp(a,0,1);for(var s=1,o=this._distances[s],h=a*this.paddedLength+this.padding;o<h&&s<this._distances.length;)o=this._distances[++s];var y=s-1,S=this._distances[y],C=o-S,k=C>0?(h-S)/C:0;return this.points[y].mult(1-k).add(this.points[s].mult(k))};var _a=function(a,s,o){var h=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(a/o),this.yCellCount=Math.ceil(s/o);for(var S=0;S<this.xCellCount*this.yCellCount;S++)h.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=s,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0};function Ma(a,s,o,h,y){var S=p.create();return s?(p.scale(S,S,[1/y,1/y,1]),o||p.rotateZ(S,S,h.angle)):p.multiply(S,h.labelPlaneMatrix,a),S}function Gi(a,s,o,h,y){if(s){var S=p.clone(a);return p.scale(S,S,[y,y,1]),o||p.rotateZ(S,S,-h.angle),S}return h.glCoordMatrix}function Bi(a,s){var o=[a.x,a.y,0,1];ra(o,o,s);var h=o[3];return{point:new p.Point(o[0]/h,o[1]/h),signedDistanceFromCamera:h}}function Xi(a,s){return.5+a/s*.5}function to(a,s){var o=a[0]/a[3],h=a[1]/a[3];return o>=-s[0]&&o<=s[0]&&h>=-s[1]&&h<=s[1]}function Ho(a,s,o,h,y,S,C,k){var K=h?a.textSizeData:a.iconSizeData,le=p.evaluateSizeForZoom(K,o.transform.zoom),Ee=[256/o.width*2+1,256/o.height*2+1],Ae=h?a.text.dynamicLayoutVertexArray:a.icon.dynamicLayoutVertexArray;Ae.clear();for(var Oe=a.lineVertexArray,Ke=h?a.text.placedSymbolArray:a.icon.placedSymbolArray,We=o.transform.width/o.transform.height,st=!1,je=0;je<Ke.length;je++){var at=Ke.get(je);if(at.hidden||at.writingMode===p.WritingMode.vertical&&!st)Fi(at.numGlyphs,Ae);else{st=!1;var xt=[at.anchorX,at.anchorY,0,1];if(p.transformMat4(xt,xt,s),to(xt,Ee)){var zt=Xi(o.transform.cameraToCenterDistance,xt[3]),or=p.evaluateSizeForFeature(K,le,at),Jt=C?or/zt:or*zt,yr=new p.Point(at.anchorX,at.anchorY),Rr=Bi(yr,y).point,$r={},Xr=va(at,Jt,!1,k,s,y,S,a.glyphOffsetArray,Oe,Ae,Rr,yr,$r,We);st=Xr.useVertical,(Xr.notEnoughRoom||st||Xr.needsFlipping&&va(at,Jt,!0,k,s,y,S,a.glyphOffsetArray,Oe,Ae,Rr,yr,$r,We).notEnoughRoom)&&Fi(at.numGlyphs,Ae)}else Fi(at.numGlyphs,Ae)}}h?a.text.dynamicLayoutVertexBuffer.updateData(Ae):a.icon.dynamicLayoutVertexBuffer.updateData(Ae)}function Za(a,s,o,h,y,S,C,k,K,le,Ee){var Ae=k.glyphStartIndex+k.numGlyphs,Oe=k.lineStartIndex,Ke=k.lineStartIndex+k.lineLength,We=s.getoffsetX(k.glyphStartIndex),st=s.getoffsetX(Ae-1),je=Da(a*We,o,h,y,S,C,k.segment,Oe,Ke,K,le,Ee);if(!je)return null;var at=Da(a*st,o,h,y,S,C,k.segment,Oe,Ke,K,le,Ee);return at?{first:je,last:at}:null}function Wi(a,s,o,h){return a===p.WritingMode.horizontal&&Math.abs(o.y-s.y)>Math.abs(o.x-s.x)*h?{useVertical:!0}:(a===p.WritingMode.vertical?s.y<o.y:s.x>o.x)?{needsFlipping:!0}:null}function va(a,s,o,h,y,S,C,k,K,le,Ee,Ae,Oe,Ke){var We,st=s/24,je=a.lineOffsetX*st,at=a.lineOffsetY*st;if(a.numGlyphs>1){var xt=a.glyphStartIndex+a.numGlyphs,zt=a.lineStartIndex,or=a.lineStartIndex+a.lineLength,Jt=Za(st,k,je,at,o,Ee,Ae,a,K,S,Oe);if(!Jt)return{notEnoughRoom:!0};var yr=Bi(Jt.first.point,C).point,Rr=Bi(Jt.last.point,C).point;if(h&&!o){var $r=Wi(a.writingMode,yr,Rr,Ke);if($r)return $r}We=[Jt.first];for(var Xr=a.glyphStartIndex+1;Xr<xt-1;Xr++)We.push(Da(st*k.getoffsetX(Xr),je,at,o,Ee,Ae,a.segment,zt,or,K,S,Oe));We.push(Jt.last)}else{if(h&&!o){var pn=Bi(Ae,y).point,qn=a.lineStartIndex+a.segment+1,Un=new p.Point(K.getx(qn),K.gety(qn)),Rn=Bi(Un,y),ki=Rn.signedDistanceFromCamera>0?Rn.point:Su(Ae,Un,pn,1,y),kn=Wi(a.writingMode,pn,ki,Ke);if(kn)return kn}var gi=Da(st*k.getoffsetX(a.glyphStartIndex),je,at,o,Ee,Ae,a.segment,a.lineStartIndex,a.lineStartIndex+a.lineLength,K,S,Oe);if(!gi)return{notEnoughRoom:!0};We=[gi]}for(var Vi=0,li=We;Vi<li.length;Vi+=1){var yi=li[Vi];p.addDynamicAttributes(le,yi.point,yi.angle)}return{}}function Su(a,s,o,h,y){var S=Bi(a.add(a.sub(s)._unit()),y).point,C=o.sub(S);return o.add(C._mult(h/C.mag()))}function Da(a,s,o,h,y,S,C,k,K,le,Ee,Ae){var Oe=h?a-s:a+s,Ke=Oe>0?1:-1,We=0;h&&(Ke*=-1,We=Math.PI),Ke<0&&(We+=Math.PI);for(var st=Ke>0?k+C:k+C+1,je=y,at=y,xt=0,zt=0,or=Math.abs(Oe),Jt=[];xt+zt<=or;){if((st+=Ke)<k||st>=K)return null;if(at=je,Jt.push(je),void 0===(je=Ae[st])){var yr=new p.Point(le.getx(st),le.gety(st)),Rr=Bi(yr,Ee);if(Rr.signedDistanceFromCamera>0)je=Ae[st]=Rr.point;else{var $r=st-Ke;je=Su(0===xt?S:new p.Point(le.getx($r),le.gety($r)),yr,at,or-xt+1,Ee)}}xt+=zt,zt=at.dist(je)}var Xr=(or-xt)/zt,pn=je.sub(at),qn=pn.mult(Xr)._add(at);qn._add(pn._unit()._perp()._mult(o*Ke));var Un=We+Math.atan2(je.y-at.y,je.x-at.x);return Jt.push(qn),{point:qn,angle:Un,path:Jt}}_a.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},_a.prototype.insert=function(a,s,o,h,y){this._forEachCell(s,o,h,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(s),this.bboxes.push(o),this.bboxes.push(h),this.bboxes.push(y)},_a.prototype.insertCircle=function(a,s,o,h){this._forEachCell(s-h,o-h,s+h,o+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(s),this.circles.push(o),this.circles.push(h)},_a.prototype._insertBoxCell=function(a,s,o,h,y,S){this.boxCells[y].push(S)},_a.prototype._insertCircleCell=function(a,s,o,h,y,S){this.circleCells[y].push(S)},_a.prototype._query=function(a,s,o,h,y,S){if(o<0||a>this.width||h<0||s>this.height)return!y&&[];var C=[];if(a<=0&&s<=0&&this.width<=o&&this.height<=h){if(y)return!0;for(var k=0;k<this.boxKeys.length;k++)C.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(var K=0;K<this.circleKeys.length;K++){var le=this.circles[3*K],Ee=this.circles[3*K+1],Ae=this.circles[3*K+2];C.push({key:this.circleKeys[K],x1:le-Ae,y1:Ee-Ae,x2:le+Ae,y2:Ee+Ae})}return S?C.filter(S):C}return this._forEachCell(a,s,o,h,this._queryCell,C,{hitTest:y,seenUids:{box:{},circle:{}}},S),y?C.length>0:C},_a.prototype._queryCircle=function(a,s,o,h,y){var S=a-o,C=a+o,k=s-o,K=s+o;if(C<0||S>this.width||K<0||k>this.height)return!h&&[];var le=[];return this._forEachCell(S,k,C,K,this._queryCellCircle,le,{hitTest:h,circle:{x:a,y:s,radius:o},seenUids:{box:{},circle:{}}},y),h?le.length>0:le},_a.prototype.query=function(a,s,o,h,y){return this._query(a,s,o,h,!1,y)},_a.prototype.hitTest=function(a,s,o,h,y){return this._query(a,s,o,h,!0,y)},_a.prototype.hitTestCircle=function(a,s,o,h){return this._queryCircle(a,s,o,!0,h)},_a.prototype._queryCell=function(a,s,o,h,y,S,C,k){var K=C.seenUids,le=this.boxCells[y];if(null!==le)for(var Ee=this.bboxes,Ae=0,Oe=le;Ae<Oe.length;Ae+=1){var Ke=Oe[Ae];if(!K.box[Ke]){K.box[Ke]=!0;var We=4*Ke;if(a<=Ee[We+2]&&s<=Ee[We+3]&&o>=Ee[We+0]&&h>=Ee[We+1]&&(!k||k(this.boxKeys[Ke]))){if(C.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[Ke],x1:Ee[We],y1:Ee[We+1],x2:Ee[We+2],y2:Ee[We+3]})}}}var st=this.circleCells[y];if(null!==st)for(var je=this.circles,at=0,xt=st;at<xt.length;at+=1){var zt=xt[at];if(!K.circle[zt]){K.circle[zt]=!0;var or=3*zt;if(this._circleAndRectCollide(je[or],je[or+1],je[or+2],a,s,o,h)&&(!k||k(this.circleKeys[zt]))){if(C.hitTest)return S.push(!0),!0;var Jt=je[or],yr=je[or+1],Rr=je[or+2];S.push({key:this.circleKeys[zt],x1:Jt-Rr,y1:yr-Rr,x2:Jt+Rr,y2:yr+Rr})}}}},_a.prototype._queryCellCircle=function(a,s,o,h,y,S,C,k){var K=C.circle,le=C.seenUids,Ee=this.boxCells[y];if(null!==Ee)for(var Ae=this.bboxes,Oe=0,Ke=Ee;Oe<Ke.length;Oe+=1){var We=Ke[Oe];if(!le.box[We]){le.box[We]=!0;var st=4*We;if(this._circleAndRectCollide(K.x,K.y,K.radius,Ae[st+0],Ae[st+1],Ae[st+2],Ae[st+3])&&(!k||k(this.boxKeys[We])))return S.push(!0),!0}}var je=this.circleCells[y];if(null!==je)for(var at=this.circles,xt=0,zt=je;xt<zt.length;xt+=1){var or=zt[xt];if(!le.circle[or]){le.circle[or]=!0;var Jt=3*or;if(this._circlesCollide(at[Jt],at[Jt+1],at[Jt+2],K.x,K.y,K.radius)&&(!k||k(this.circleKeys[or])))return S.push(!0),!0}}},_a.prototype._forEachCell=function(a,s,o,h,y,S,C,k){for(var K=this._convertToXCellCoord(a),le=this._convertToYCellCoord(s),Ee=this._convertToXCellCoord(o),Ae=this._convertToYCellCoord(h),Oe=K;Oe<=Ee;Oe++)for(var Ke=le;Ke<=Ae;Ke++)if(y.call(this,a,s,o,h,this.xCellCount*Ke+Oe,S,C,k))return},_a.prototype._convertToXCellCoord=function(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))},_a.prototype._convertToYCellCoord=function(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))},_a.prototype._circlesCollide=function(a,s,o,h,y,S){var C=h-a,k=y-s,K=o+S;return K*K>C*C+k*k},_a.prototype._circleAndRectCollide=function(a,s,o,h,y,S,C){var k=(S-h)/2,K=Math.abs(a-(h+k));if(K>k+o)return!1;var le=(C-y)/2,Ee=Math.abs(s-(y+le));if(Ee>le+o)return!1;if(K<=k||Ee<=le)return!0;var Ae=K-k,Oe=Ee-le;return Ae*Ae+Oe*Oe<=o*o};var qo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Fi(a,s){for(var o=0;o<a;o++){var h=s.length;s.resize(h+4),s.float32.set(qo,3*h)}}function ra(a,s,o){var h=s[0],y=s[1];return a[0]=o[0]*h+o[4]*y+o[12],a[1]=o[1]*h+o[5]*y+o[13],a[3]=o[3]*h+o[7]*y+o[15],a}var bo=function(a,s,o){void 0===s&&(s=new _a(a.width+200,a.height+200,25)),void 0===o&&(o=new _a(a.width+200,a.height+200,25)),this.transform=a,this.grid=s,this.ignoredGrid=o,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+100,this.screenBottomBoundary=a.height+100,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200};function ma(a,s,o){return s*(p.EXTENT/(a.tileSize*Math.pow(2,o-a.tileID.overscaledZ)))}bo.prototype.placeCollisionBox=function(a,s,o,h,y){var S=this.projectAndGetPerspectiveRatio(h,a.anchorPointX,a.anchorPointY),C=o*S.perspectiveRatio,k=a.x1*C+S.point.x,K=a.y1*C+S.point.y,le=a.x2*C+S.point.x,Ee=a.y2*C+S.point.y;return!this.isInsideGrid(k,K,le,Ee)||!s&&this.grid.hitTest(k,K,le,Ee,y)?{box:[],offscreen:!1}:{box:[k,K,le,Ee],offscreen:this.isOffscreen(k,K,le,Ee)}},bo.prototype.placeCollisionCircles=function(a,s,o,h,y,S,C,k,K,le,Ee,Ae,Oe){var Ke=[],We=new p.Point(s.anchorX,s.anchorY),st=Bi(We,S),je=Xi(this.transform.cameraToCenterDistance,st.signedDistanceFromCamera),at=(le?y/je:y*je)/p.ONE_EM,xt=Bi(We,C).point,zt=Za(at,h,s.lineOffsetX*at,s.lineOffsetY*at,!1,xt,We,s,o,C,{}),or=!1,Jt=!1,yr=!0;if(zt){for(var Rr=.5*Ae*je+Oe,$r=new p.Point(-100,-100),Xr=new p.Point(this.screenRightBoundary,this.screenBottomBoundary),pn=new Ti,qn=zt.first,Un=zt.last,Rn=[],ki=qn.path.length-1;ki>=1;ki--)Rn.push(qn.path[ki]);for(var kn=1;kn<Un.path.length;kn++)Rn.push(Un.path[kn]);var gi=2.5*Rr;if(k){var Vi=Rn.map(function(ni){return Bi(ni,k)});Rn=Vi.some(function(ni){return ni.signedDistanceFromCamera<=0})?[]:Vi.map(function(ni){return ni.point})}var li=[];if(Rn.length>0){for(var yi=Rn[0].clone(),Ni=Rn[0].clone(),$=1;$<Rn.length;$++)yi.x=Math.min(yi.x,Rn[$].x),yi.y=Math.min(yi.y,Rn[$].y),Ni.x=Math.max(Ni.x,Rn[$].x),Ni.y=Math.max(Ni.y,Rn[$].y);li=yi.x>=$r.x&&Ni.x<=Xr.x&&yi.y>=$r.y&&Ni.y<=Xr.y?[Rn]:Ni.x<$r.x||yi.x>Xr.x||Ni.y<$r.y||yi.y>Xr.y?[]:p.clipLine([Rn],$r.x,$r.y,Xr.x,Xr.y)}for(var ee=0,L=li;ee<L.length;ee+=1){var D;pn.reset(L[ee],.25*Rr),D=pn.length<=.5*Rr?1:Math.ceil(pn.paddedLength/gi)+1;for(var fe=0;fe<D;fe++){var Se=fe/Math.max(D-1,1),ct=pn.lerp(Se),Pt=ct.x+100,bt=ct.y+100;Ke.push(Pt,bt,Rr,0);var rr=Pt-Rr,jr=bt-Rr,Mn=Pt+Rr,Xn=bt+Rr;if(yr=yr&&this.isOffscreen(rr,jr,Mn,Xn),Jt=Jt||this.isInsideGrid(rr,jr,Mn,Xn),!a&&this.grid.hitTestCircle(Pt,bt,Rr,Ee)&&(or=!0,!K))return{circles:[],offscreen:!1,collisionDetected:or}}}}return{circles:!K&&or||!Jt?[]:Ke,offscreen:yr,collisionDetected:or}},bo.prototype.queryRenderedSymbols=function(a){if(0===a.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var s=[],o=1/0,h=1/0,y=-1/0,S=-1/0,C=0,k=a;C<k.length;C+=1){var K=k[C],le=new p.Point(K.x+100,K.y+100);o=Math.min(o,le.x),h=Math.min(h,le.y),y=Math.max(y,le.x),S=Math.max(S,le.y),s.push(le)}for(var Ee={},Ae={},Oe=0,Ke=this.grid.query(o,h,y,S).concat(this.ignoredGrid.query(o,h,y,S));Oe<Ke.length;Oe+=1){var We=Ke[Oe],st=We.key;if(void 0===Ee[st.bucketInstanceId]&&(Ee[st.bucketInstanceId]={}),!Ee[st.bucketInstanceId][st.featureIndex]){var je=[new p.Point(We.x1,We.y1),new p.Point(We.x2,We.y1),new p.Point(We.x2,We.y2),new p.Point(We.x1,We.y2)];p.polygonIntersectsPolygon(s,je)&&(Ee[st.bucketInstanceId][st.featureIndex]=!0,void 0===Ae[st.bucketInstanceId]&&(Ae[st.bucketInstanceId]=[]),Ae[st.bucketInstanceId].push(st.featureIndex))}}return Ae},bo.prototype.insertCollisionBox=function(a,s,o,h,y){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:h,collisionGroupID:y},a[0],a[1],a[2],a[3])},bo.prototype.insertCollisionCircles=function(a,s,o,h,y){for(var S=s?this.ignoredGrid:this.grid,C={bucketInstanceId:o,featureIndex:h,collisionGroupID:y},k=0;k<a.length;k+=4)S.insertCircle(C,a[k],a[k+1],a[k+2])},bo.prototype.projectAndGetPerspectiveRatio=function(a,s,o){var h=[s,o,0,1];return ra(h,h,a),{point:new p.Point((h[0]/h[3]+1)/2*this.transform.width+100,(-h[1]/h[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/h[3]*.5}},bo.prototype.isOffscreen=function(a,s,o,h){return o<100||a>=this.screenRightBoundary||h<100||s>this.screenBottomBoundary},bo.prototype.isInsideGrid=function(a,s,o,h){return o>=0&&a<this.gridRightBoundary&&h>=0&&s<this.gridBottomBoundary},bo.prototype.getViewportMatrix=function(){var a=p.identity([]);return p.translate(a,a,[-100,-100,0]),a};var vo=function(a,s,o,h){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?s:-s))):h&&o?1:0,this.placed=o};vo.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var No=function(a,s,o,h,y){this.text=new vo(a?a.text:null,s,o,y),this.icon=new vo(a?a.icon:null,s,h,y)};No.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ks=function(a,s,o){this.text=a,this.icon=s,this.skipFade=o},aa=function(){this.invProjMatrix=p.create(),this.viewportMatrix=p.create(),this.circles=[]},Jo=function(a,s,o,h,y){this.bucketInstanceId=a,this.featureIndex=s,this.sourceLayerIndex=o,this.bucketIndex=h,this.tileID=y},Ia=function(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}};function Ya(a,s,o,h,y){var S=p.getAnchorAlignment(a),C=-(S.horizontalAlign-.5)*s,k=-(S.verticalAlign-.5)*o,K=p.evaluateVariableOffset(a,h);return new p.Point(C+K[0]*y,k+K[1]*y)}function $o(a,s,o,h,y,S){var C=a.x1,k=a.x2,K=a.y1,le=a.y2,Ee=a.anchorPointX,Ae=a.anchorPointY,Oe=new p.Point(s,o);return h&&Oe._rotate(y?S:-S),{x1:C+Oe.x,y1:K+Oe.y,x2:k+Oe.x,y2:le+Oe.y,anchorPointX:Ee,anchorPointY:Ae}}Ia.prototype.get=function(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){var s=++this.maxGroupID;this.collisionGroups[a]={ID:s,predicate:function(o){return o.collisionGroupID===s}}}return this.collisionGroups[a]};var Ba=function(a,s,o,h){this.transform=a.clone(),this.collisionIndex=new bo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Ia(o),this.collisionCircleArrays={},this.prevPlacement=h,h&&(h.prevPlacement=void 0),this.placedOrientations={}};function be(a,s,o,h,y){a.emplaceBack(s?1:0,o?1:0,h||0,y||0),a.emplaceBack(s?1:0,o?1:0,h||0,y||0),a.emplaceBack(s?1:0,o?1:0,h||0,y||0),a.emplaceBack(s?1:0,o?1:0,h||0,y||0)}Ba.prototype.getBucketParts=function(a,s,o,h){var y=o.getBucket(s),S=o.latestFeatureIndex;if(y&&S&&s.id===y.layerIds[0]){var C=o.collisionBoxArray,k=y.layers[0].layout,K=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),le=o.tileSize/p.EXTENT,Ee=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),Ae="map"===k.get("text-pitch-alignment"),Oe="map"===k.get("text-rotation-alignment"),Ke=ma(o,1,this.transform.zoom),We=Ma(Ee,Ae,Oe,this.transform,Ke),st=null;if(Ae){var je=Gi(Ee,Ae,Oe,this.transform,Ke);st=p.multiply([],this.transform.labelPlaneMatrix,je)}this.retainedQueryData[y.bucketInstanceId]=new Jo(y.bucketInstanceId,S,y.sourceLayerIndex,y.index,o.tileID);var at={bucket:y,layout:k,posMatrix:Ee,textLabelPlaneMatrix:We,labelToScreenMatrix:st,scale:K,textPixelRatio:le,holdingForFade:o.holdingForFade(),collisionBoxArray:C,partiallyEvaluatedTextSize:p.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(h)for(var xt=0,zt=y.sortKeyRanges;xt<zt.length;xt+=1){var or=zt[xt];a.push({sortKey:or.sortKey,symbolInstanceStart:or.symbolInstanceStart,symbolInstanceEnd:or.symbolInstanceEnd,parameters:at})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:at})}},Ba.prototype.attemptAnchorPlacement=function(a,s,o,h,y,S,C,k,K,le,Ee,Ae,Oe,Ke,We){var st,je=[Ae.textOffset0,Ae.textOffset1],at=Ya(a,o,h,je,y),xt=this.collisionIndex.placeCollisionBox($o(s,at.x,at.y,S,C,this.transform.angle),Ee,k,K,le.predicate);if(!We||0!==this.collisionIndex.placeCollisionBox($o(We,at.x,at.y,S,C,this.transform.angle),Ee,k,K,le.predicate).box.length)return xt.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Ae.crossTileID]&&this.prevPlacement.placements[Ae.crossTileID]&&this.prevPlacement.placements[Ae.crossTileID].text&&(st=this.prevPlacement.variableOffsets[Ae.crossTileID].anchor),this.variableOffsets[Ae.crossTileID]={textOffset:je,width:o,height:h,anchor:a,textBoxScale:y,prevAnchor:st},this.markUsedJustification(Oe,a,Ae,Ke),Oe.allowVerticalPlacement&&(this.markUsedOrientation(Oe,Ke,Ae),this.placedOrientations[Ae.crossTileID]=Ke),{shift:at,placedGlyphBoxes:xt}):void 0},Ba.prototype.placeLayerBucketPart=function(a,s,o){var h=this,y=a.parameters,S=y.bucket,C=y.layout,k=y.posMatrix,K=y.textLabelPlaneMatrix,le=y.labelToScreenMatrix,Ee=y.textPixelRatio,Ae=y.holdingForFade,Oe=y.collisionBoxArray,Ke=y.partiallyEvaluatedTextSize,We=y.collisionGroup,st=C.get("text-optional"),je=C.get("icon-optional"),at=C.get("text-allow-overlap"),xt=C.get("icon-allow-overlap"),zt="map"===C.get("text-rotation-alignment"),or="map"===C.get("text-pitch-alignment"),Jt="none"!==C.get("icon-text-fit"),yr="viewport-y"===C.get("symbol-z-order"),Rr=at&&(xt||!S.hasIconData()||je),$r=xt&&(at||!S.hasTextData()||st);!S.collisionArrays&&Oe&&S.deserializeCollisionBoxes(Oe);var Xr=function(kn,gi){if(!s[kn.crossTileID])if(Ae)h.placements[kn.crossTileID]=new ks(!1,!1,!1);else{var Vi,li=!1,yi=!1,Ni=!0,$=null,ee={box:null,offscreen:null},L={box:null,offscreen:null},D=null,fe=null,Se=0,ct=0,Pt=0;gi.textFeatureIndex?Se=gi.textFeatureIndex:kn.useRuntimeCollisionCircles&&(Se=kn.featureIndex),gi.verticalTextFeatureIndex&&(ct=gi.verticalTextFeatureIndex);var bt=gi.textBox;if(bt){var rr=function(Li){var Ca=p.WritingMode.horizontal;if(S.allowVerticalPlacement&&!Li&&h.prevPlacement){var ba=h.prevPlacement.placedOrientations[kn.crossTileID];ba&&(h.placedOrientations[kn.crossTileID]=ba,h.markUsedOrientation(S,Ca=ba,kn))}return Ca},jr=function(Li,Ca){if(S.allowVerticalPlacement&&kn.numVerticalGlyphVertices>0&&gi.verticalTextBox)for(var ba=0,go=S.writingModes;ba<go.length&&(go[ba]===p.WritingMode.vertical?(ee=Ca(),L=ee):ee=Li(),!(ee&&ee.box&&ee.box.length));ba+=1);else ee=Li()};if(C.get("text-variable-anchor")){var Mn=C.get("text-variable-anchor");if(h.prevPlacement&&h.prevPlacement.variableOffsets[kn.crossTileID]){var Xn=h.prevPlacement.variableOffsets[kn.crossTileID];Mn.indexOf(Xn.anchor)>0&&(Mn=Mn.filter(function(Li){return Li!==Xn.anchor})).unshift(Xn.anchor)}var ni=function(Li,Ca,ba){for(var go=Li.x2-Li.x1,Yl=Li.y2-Li.y1,uu=kn.textBoxScale,Ko=Jt&&!xt?Ca:null,wu={box:[],offscreen:!1},Hu=at?2*Mn.length:Mn.length,ul=0;ul<Hu;++ul){var Ys=h.attemptAnchorPlacement(Mn[ul%Mn.length],Li,go,Yl,uu,zt,or,Ee,k,We,ul>=Mn.length,kn,S,ba,Ko);if(Ys&&(wu=Ys.placedGlyphBoxes)&&wu.box&&wu.box.length){li=!0,$=Ys.shift;break}}return wu};jr(function(){return ni(bt,gi.iconBox,p.WritingMode.horizontal)},function(){var Li=gi.verticalTextBox;return S.allowVerticalPlacement&&!(ee&&ee.box&&ee.box.length)&&kn.numVerticalGlyphVertices>0&&Li?ni(Li,gi.verticalIconBox,p.WritingMode.vertical):{box:null,offscreen:null}}),ee&&(li=ee.box,Ni=ee.offscreen);var Ci=rr(ee&&ee.box);if(!li&&h.prevPlacement){var wi=h.prevPlacement.variableOffsets[kn.crossTileID];wi&&(h.variableOffsets[kn.crossTileID]=wi,h.markUsedJustification(S,wi.anchor,kn,Ci))}}else{var ea=function(Li,Ca){var ba=h.collisionIndex.placeCollisionBox(Li,at,Ee,k,We.predicate);return ba&&ba.box&&ba.box.length&&(h.markUsedOrientation(S,Ca,kn),h.placedOrientations[kn.crossTileID]=Ca),ba};jr(function(){return ea(bt,p.WritingMode.horizontal)},function(){var Li=gi.verticalTextBox;return S.allowVerticalPlacement&&kn.numVerticalGlyphVertices>0&&Li?ea(Li,p.WritingMode.vertical):{box:null,offscreen:null}}),rr(ee&&ee.box&&ee.box.length)}}if(li=(Vi=ee)&&Vi.box&&Vi.box.length>0,Ni=Vi&&Vi.offscreen,kn.useRuntimeCollisionCircles){var xa=S.text.placedSymbolArray.get(kn.centerJustifiedTextSymbolIndex),ua=p.evaluateSizeForFeature(S.textSizeData,Ke,xa),Ha=C.get("text-padding");D=h.collisionIndex.placeCollisionCircles(at,xa,S.lineVertexArray,S.glyphOffsetArray,ua,k,K,le,o,or,We.predicate,kn.collisionCircleDiameter,Ha),li=at||D.circles.length>0&&!D.collisionDetected,Ni=Ni&&D.offscreen}if(gi.iconFeatureIndex&&(Pt=gi.iconFeatureIndex),gi.iconBox){var Wa=function(Li){var Ca=Jt&&$?$o(Li,$.x,$.y,zt,or,h.transform.angle):Li;return h.collisionIndex.placeCollisionBox(Ca,xt,Ee,k,We.predicate)};yi=L&&L.box&&L.box.length&&gi.verticalIconBox?(fe=Wa(gi.verticalIconBox)).box.length>0:(fe=Wa(gi.iconBox)).box.length>0,Ni=Ni&&fe.offscreen}var Ka=st||0===kn.numHorizontalGlyphVertices&&0===kn.numVerticalGlyphVertices,ia=je||0===kn.numIconVertices;if(Ka||ia?ia?Ka||(yi=yi&&li):li=yi&&li:yi=li=yi&&li,li&&Vi&&Vi.box&&h.collisionIndex.insertCollisionBox(Vi.box,C.get("text-ignore-placement"),S.bucketInstanceId,L&&L.box&&ct?ct:Se,We.ID),yi&&fe&&h.collisionIndex.insertCollisionBox(fe.box,C.get("icon-ignore-placement"),S.bucketInstanceId,Pt,We.ID),D&&(li&&h.collisionIndex.insertCollisionCircles(D.circles,C.get("text-ignore-placement"),S.bucketInstanceId,Se,We.ID),o)){var ga=S.bucketInstanceId,la=h.collisionCircleArrays[ga];void 0===la&&(la=h.collisionCircleArrays[ga]=new aa);for(var no=0;no<D.circles.length;no+=4)la.circles.push(D.circles[no+0]),la.circles.push(D.circles[no+1]),la.circles.push(D.circles[no+2]),la.circles.push(D.collisionDetected?1:0)}h.placements[kn.crossTileID]=new ks(li||Rr,yi||$r,Ni||S.justReloaded),s[kn.crossTileID]=!0}};if(yr)for(var pn=S.getSortedSymbolIndexes(this.transform.angle),qn=pn.length-1;qn>=0;--qn){var Un=pn[qn];Xr(S.symbolInstances.get(Un),S.collisionArrays[Un])}else for(var Rn=a.symbolInstanceStart;Rn<a.symbolInstanceEnd;Rn++)Xr(S.symbolInstances.get(Rn),S.collisionArrays[Rn]);if(o&&S.bucketInstanceId in this.collisionCircleArrays){var ki=this.collisionCircleArrays[S.bucketInstanceId];p.invert(ki.invProjMatrix,k),ki.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1},Ba.prototype.markUsedJustification=function(a,s,o,h){var y;y=h===p.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[p.getAnchorJustification(s)];for(var S=0,C=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];S<C.length;S+=1){var k=C[S];k>=0&&(a.text.placedSymbolArray.get(k).crossTileID=y>=0&&k!==y?0:o.crossTileID)}},Ba.prototype.markUsedOrientation=function(a,s,o){for(var h=s===p.WritingMode.horizontal||s===p.WritingMode.horizontalOnly?s:0,y=s===p.WritingMode.vertical?s:0,S=0,C=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];S<C.length;S+=1)a.text.placedSymbolArray.get(C[S]).placedOrientation=h;o.verticalPlacedTextSymbolIndex&&(a.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=y)},Ba.prototype.commit=function(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;var s=this.prevPlacement,o=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;var h=s?s.symbolFadeChange(a):1,y=s?s.opacities:{},S=s?s.variableOffsets:{},C=s?s.placedOrientations:{};for(var k in this.placements){var K=this.placements[k],le=y[k];le?(this.opacities[k]=new No(le,h,K.text,K.icon),o=o||K.text!==le.text.placed||K.icon!==le.icon.placed):(this.opacities[k]=new No(null,h,K.text,K.icon,K.skipFade),o=o||K.text||K.icon)}for(var Ee in y){var Ae=y[Ee];if(!this.opacities[Ee]){var Oe=new No(Ae,h,!1,!1);Oe.isHidden()||(this.opacities[Ee]=Oe,o=o||Ae.text.placed||Ae.icon.placed)}}for(var Ke in S)this.variableOffsets[Ke]||!this.opacities[Ke]||this.opacities[Ke].isHidden()||(this.variableOffsets[Ke]=S[Ke]);for(var We in C)this.placedOrientations[We]||!this.opacities[We]||this.opacities[We].isHidden()||(this.placedOrientations[We]=C[We]);o?this.lastPlacementChangeTime=a:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:a)},Ba.prototype.updateLayerOpacities=function(a,s){for(var o={},h=0,y=s;h<y.length;h+=1){var S=y[h],C=S.getBucket(a);C&&S.latestFeatureIndex&&a.id===C.layerIds[0]&&this.updateBucketOpacities(C,o,S.collisionBoxArray)}},Ba.prototype.updateBucketOpacities=function(a,s,o){var h=this;a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();var y=a.layers[0].layout,S=new No(null,0,!1,!1,!0),C=y.get("text-allow-overlap"),k=y.get("icon-allow-overlap"),K=y.get("text-variable-anchor"),le="map"===y.get("text-rotation-alignment"),Ee="map"===y.get("text-pitch-alignment"),Ae="none"!==y.get("icon-text-fit"),Oe=new No(null,0,C&&(k||!a.hasIconData()||y.get("icon-optional")),k&&(C||!a.hasTextData()||y.get("text-optional")),!0);!a.collisionArrays&&o&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(o);for(var Ke=function(at,xt,zt){for(var or=0;or<xt/4;or++)at.opacityVertexArray.emplaceBack(zt)},We=function(at){var xt=a.symbolInstances.get(at),zt=xt.numHorizontalGlyphVertices,or=xt.numVerticalGlyphVertices,Jt=xt.crossTileID,yr=h.opacities[Jt];s[Jt]?yr=S:yr||(h.opacities[Jt]=yr=Oe),s[Jt]=!0;var Rr=xt.numIconVertices>0,$r=h.placedOrientations[xt.crossTileID],Xr=$r===p.WritingMode.vertical,pn=$r===p.WritingMode.horizontal||$r===p.WritingMode.horizontalOnly;if(zt>0||or>0){var qn=ro(yr.text);Ke(a.text,zt,Xr?co:qn),Ke(a.text,or,pn?co:qn);var Un=yr.text.isHidden();[xt.rightJustifiedTextSymbolIndex,xt.centerJustifiedTextSymbolIndex,xt.leftJustifiedTextSymbolIndex].forEach(function(ee){ee>=0&&(a.text.placedSymbolArray.get(ee).hidden=Un||Xr?1:0)}),xt.verticalPlacedTextSymbolIndex>=0&&(a.text.placedSymbolArray.get(xt.verticalPlacedTextSymbolIndex).hidden=Un||pn?1:0);var Rn=h.variableOffsets[xt.crossTileID];Rn&&h.markUsedJustification(a,Rn.anchor,xt,$r);var ki=h.placedOrientations[xt.crossTileID];ki&&(h.markUsedJustification(a,"left",xt,ki),h.markUsedOrientation(a,ki,xt))}if(Rr){var kn=ro(yr.icon),gi=!(Ae&&xt.verticalPlacedIconSymbolIndex&&Xr);xt.placedIconSymbolIndex>=0&&(Ke(a.icon,xt.numIconVertices,gi?kn:co),a.icon.placedSymbolArray.get(xt.placedIconSymbolIndex).hidden=yr.icon.isHidden()),xt.verticalPlacedIconSymbolIndex>=0&&(Ke(a.icon,xt.numVerticalIconVertices,gi?co:kn),a.icon.placedSymbolArray.get(xt.verticalPlacedIconSymbolIndex).hidden=yr.icon.isHidden())}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){var Vi=a.collisionArrays[at];if(Vi){var li=new p.Point(0,0);if(Vi.textBox||Vi.verticalTextBox){var yi=!0;if(K){var Ni=h.variableOffsets[Jt];Ni?(li=Ya(Ni.anchor,Ni.width,Ni.height,Ni.textOffset,Ni.textBoxScale),le&&li._rotate(Ee?h.transform.angle:-h.transform.angle)):yi=!1}Vi.textBox&&be(a.textCollisionBox.collisionVertexArray,yr.text.placed,!yi||Xr,li.x,li.y),Vi.verticalTextBox&&be(a.textCollisionBox.collisionVertexArray,yr.text.placed,!yi||pn,li.x,li.y)}var $=Boolean(!pn&&Vi.verticalIconBox);Vi.iconBox&&be(a.iconCollisionBox.collisionVertexArray,yr.icon.placed,$,Ae?li.x:0,Ae?li.y:0),Vi.verticalIconBox&&be(a.iconCollisionBox.collisionVertexArray,yr.icon.placed,!$,Ae?li.x:0,Ae?li.y:0)}}},st=0;st<a.symbolInstances.length;st++)We(st);if(a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){var je=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=je.invProjMatrix,a.placementViewportMatrix=je.viewportMatrix,a.collisionCircleArray=je.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}},Ba.prototype.symbolFadeChange=function(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Ba.prototype.zoomAdjustment=function(a){return Math.max(0,(this.transform.zoom-a)/1.5)},Ba.prototype.hasTransitions=function(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration},Ba.prototype.stillRecent=function(a,s){var o=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*o>a},Ba.prototype.setStale=function(){this.stale=!0};var Fe=Math.pow(2,25),vt=Math.pow(2,24),Qt=Math.pow(2,17),Yr=Math.pow(2,16),$n=Math.pow(2,9),xi=Math.pow(2,8),lo=Math.pow(2,1);function ro(a){if(0===a.opacity&&!a.placed)return 0;if(1===a.opacity&&a.placed)return 4294967295;var s=a.placed?1:0,o=Math.floor(127*a.opacity);return o*Fe+s*vt+o*Qt+s*Yr+o*$n+s*xi+o*lo+s}var co=0,ps=function(a){this._sortAcrossTiles="viewport-y"!==a.layout.get("symbol-z-order")&&void 0!==a.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};ps.prototype.continuePlacement=function(a,s,o,h,y){for(var S=this._bucketParts;this._currentTileIndex<a.length;)if(s.getBucketParts(S,h,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort(function(C,k){return C.sortKey-k.sortKey}));this._currentPartIndex<S.length;)if(s.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,y())return!0;return!1};var du=function(a,s,o,h,y,S,C){this.placement=new Ba(a,y,S,C),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=h,this._done=!1};du.prototype.isDone=function(){return this._done},du.prototype.continuePlacement=function(a,s,o){for(var h=this,y=p.browser.now(),S=function(){var K=p.browser.now()-y;return!h._forceFullPlacement&&K>2};this._currentPlacementIndex>=0;){var C=s[a[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if("symbol"===C.type&&(!C.minzoom||C.minzoom<=k)&&(!C.maxzoom||C.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new ps(C)),this._inProgressLayer.continuePlacement(o[C.source],this.placement,this._showCollisionBoxes,C,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},du.prototype.commit=function(a){return this.placement.commit(a),this.placement};var Eu=512/p.EXTENT/2,fl=function(a,s,o){this.tileID=a,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var h=0;h<s.length;h++){var y=s.get(h),S=y.key;this.indexedSymbolInstances[S]||(this.indexedSymbolInstances[S]=[]),this.indexedSymbolInstances[S].push({crossTileID:y.crossTileID,coord:this.getScaledCoordinates(y,a)})}};fl.prototype.getScaledCoordinates=function(a,s){var o=Eu/Math.pow(2,s.canonical.z-this.tileID.canonical.z);return{x:Math.floor((s.canonical.x*p.EXTENT+a.anchorX)*o),y:Math.floor((s.canonical.y*p.EXTENT+a.anchorY)*o)}},fl.prototype.findMatches=function(a,s,o){for(var h=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),y=0;y<a.length;y++){var S=a.get(y);if(!S.crossTileID){var C=this.indexedSymbolInstances[S.key];if(C)for(var k=this.getScaledCoordinates(S,s),K=0,le=C;K<le.length;K+=1){var Ee=le[K];if(Math.abs(Ee.coord.x-k.x)<=h&&Math.abs(Ee.coord.y-k.y)<=h&&!o[Ee.crossTileID]){o[Ee.crossTileID]=!0,S.crossTileID=Ee.crossTileID;break}}}}};var Wo=function(){this.maxCrossTileID=0};Wo.prototype.generate=function(){return++this.maxCrossTileID};var Qo=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Qo.prototype.handleWrapJump=function(a){var s=Math.round((a-this.lng)/360);if(0!==s)for(var o in this.indexes){var h=this.indexes[o],y={};for(var S in h){var C=h[S];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+s),y[C.tileID.key]=C}this.indexes[o]=y}this.lng=a},Qo.prototype.addBucket=function(a,s,o){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(var h=0;h<s.symbolInstances.length;h++)s.symbolInstances.get(h).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]={});var y=this.usedCrossTileIDs[a.overscaledZ];for(var S in this.indexes){var C=this.indexes[S];if(Number(S)>a.overscaledZ)for(var k in C){var K=C[k];K.tileID.isChildOf(a)&&K.findMatches(s.symbolInstances,a,y)}else{var le=C[a.scaledTo(Number(S)).key];le&&le.findMatches(s.symbolInstances,a,y)}}for(var Ee=0;Ee<s.symbolInstances.length;Ee++){var Ae=s.symbolInstances.get(Ee);Ae.crossTileID||(Ae.crossTileID=o.generate(),y[Ae.crossTileID]=!0)}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new fl(a,s.symbolInstances,s.bucketInstanceId),!0},Qo.prototype.removeBucketCrossTileIDs=function(a,s){for(var o in s.indexedSymbolInstances)for(var h=0,y=s.indexedSymbolInstances[o];h<y.length;h+=1)delete this.usedCrossTileIDs[a][y[h].crossTileID]},Qo.prototype.removeStaleBuckets=function(a){var s=!1;for(var o in this.indexes){var h=this.indexes[o];for(var y in h)a[h[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,h[y]),delete h[y],s=!0)}return s};var ko=function(){this.layerIndexes={},this.crossTileIDs=new Wo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ko.prototype.addLayer=function(a,s,o){var h=this.layerIndexes[a.id];void 0===h&&(h=this.layerIndexes[a.id]=new Qo);var y=!1,S={};h.handleWrapJump(o);for(var C=0,k=s;C<k.length;C+=1){var K=k[C],le=K.getBucket(a);le&&a.id===le.layerIds[0]&&(le.bucketInstanceId||(le.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(K.tileID,le,this.crossTileIDs)&&(y=!0),S[le.bucketInstanceId]=!0)}return h.removeStaleBuckets(S)&&(y=!0),y},ko.prototype.pruneUnusedLayers=function(a){var s={};for(var o in a.forEach(function(h){s[h]=!0}),this.layerIndexes)s[o]||delete this.layerIndexes[o]};var es=function(a,s){return p.emitValidationErrors(a,s&&s.filter(function(o){return"source.canvas"!==o.identifier}))},ts=p.pick(ln,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Ls=p.pick(ln,["setCenter","setZoom","setBearing","setPitch"]),Qs=function(){var a={},s=p.styleSpec.$version;for(var o in p.styleSpec.$root){var h,y=p.styleSpec.$root[o];y.required&&null!=(h="version"===o?s:"array"===y.type?[]:{})&&(a[o]=h)}return a}(),gs=function(a){function s(o,h){var y=this;void 0===h&&(h={}),a.call(this),this.map=o,this.dispatcher=new Dt(qt(),this),this.imageManager=new Mt,this.imageManager.setEventedParent(this),this.glyphManager=new nr(o._requestManager,h.localIdeographFontFamily),this.lineAtlas=new qe(256,512),this.crossTileSymbolIndex=new ko,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new p.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",p.getReferrer());var S=this;this._rtlTextPluginCallback=s.registerForPluginStateChange(function(C){S.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},function(k,K){if(p.triggerPluginCompletionEvent(k),K&&K.every(function(Ee){return Ee}))for(var le in S.sourceCaches)S.sourceCaches[le].reload()})}),this.on("data",function(C){if("source"===C.dataType&&"metadata"===C.sourceDataType){var k=y.sourceCaches[C.sourceId];if(k){var K=k.getSource();if(K&&K.vectorLayerIds)for(var le in y._layers){var Ee=y._layers[le];Ee.source===K.id&&y._validateLayer(Ee)}}}})}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.loadURL=function(o,h){var y=this;void 0===h&&(h={}),this.fire(new p.Event("dataloading",{dataType:"style"}));var S="boolean"==typeof h.validate?h.validate:!p.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,h.accessToken);var C=this.map._requestManager.transformRequest(o,p.ResourceType.Style);this._request=p.getJSON(C,function(k,K){y._request=null,k?y.fire(new p.ErrorEvent(k)):K&&y._load(K,S)})},s.prototype.loadJSON=function(o,h){var y=this;void 0===h&&(h={}),this.fire(new p.Event("dataloading",{dataType:"style"})),this._request=p.browser.frame(function(){y._request=null,y._load(o,!1!==h.validate)})},s.prototype.loadEmpty=function(){this.fire(new p.Event("dataloading",{dataType:"style"})),this._load(Qs,!1)},s.prototype._load=function(o,h){if(!h||!es(this,p.validateStyle(o))){for(var y in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(y,o.sources[y],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var S=nn(this.stylesheet.layers);this._order=S.map(function(le){return le.id}),this._layers={},this._serializedLayers={};for(var C=0,k=S;C<k.length;C+=1){var K=k[C];(K=p.createStyleLayer(K)).setEventedParent(this,{layer:{id:K.id}}),this._layers[K.id]=K,this._serializedLayers[K.id]=K.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ct(this.stylesheet.light),this.fire(new p.Event("data",{dataType:"style"})),this.fire(new p.Event("style.load"))}},s.prototype._loadSprite=function(o){var h=this;this._spriteRequest=function(y,S,C){var k,K,le,Ee=p.browser.devicePixelRatio>1?"@2x":"",Ae=p.getJSON(S.transformRequest(S.normalizeSpriteURL(y,Ee,".json"),p.ResourceType.SpriteJSON),function(We,st){Ae=null,le||(le=We,k=st,Ke())}),Oe=p.getImage(S.transformRequest(S.normalizeSpriteURL(y,Ee,".png"),p.ResourceType.SpriteImage),function(We,st){Oe=null,le||(le=We,K=st,Ke())});function Ke(){if(le)C(le);else if(k&&K){var We=p.browser.getImageData(K),st={};for(var je in k){var at=k[je],xt=at.width,zt=at.height,or=at.x,Jt=at.y,yr=at.sdf,Rr=at.pixelRatio,$r=at.stretchX,Xr=at.stretchY,pn=at.content,qn=new p.RGBAImage({width:xt,height:zt});p.RGBAImage.copy(We,qn,{x:or,y:Jt},{x:0,y:0},{width:xt,height:zt}),st[je]={data:qn,pixelRatio:Rr,sdf:yr,stretchX:$r,stretchY:Xr,content:pn}}C(null,st)}}return{cancel:function(){Ae&&(Ae.cancel(),Ae=null),Oe&&(Oe.cancel(),Oe=null)}}}(o,this.map._requestManager,function(y,S){if(h._spriteRequest=null,y)h.fire(new p.ErrorEvent(y));else if(S)for(var C in S)h.imageManager.addImage(C,S[C]);h.imageManager.setLoaded(!0),h._availableImages=h.imageManager.listImages(),h.dispatcher.broadcast("setImages",h._availableImages),h.fire(new p.Event("data",{dataType:"style"}))})},s.prototype._validateLayer=function(o){var h=this.sourceCaches[o.source];if(h){var y=o.sourceLayer;if(y){var S=h.getSource();("geojson"===S.type||S.vectorLayerIds&&-1===S.vectorLayerIds.indexOf(y))&&this.fire(new p.ErrorEvent(new Error('Source layer "'+y+'" does not exist on source "'+S.id+'" as specified by style layer "'+o.id+'"')))}}},s.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},s.prototype._serializeLayers=function(o){for(var h=[],y=0,S=o;y<S.length;y+=1){var C=this._layers[S[y]];"custom"!==C.type&&h.push(C.serialize())}return h},s.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var h in this._layers)if(this._layers[h].hasTransition())return!0;return!1},s.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},s.prototype.update=function(o){if(this._loaded){var h=this._changed;if(this._changed){var y=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);for(var C in(y.length||S.length)&&this._updateWorkerLayers(y,S),this._updatedSources){var k=this._updatedSources[C];"reload"===k?this._reloadSource(C):"clear"===k&&this._clearSource(C)}for(var K in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[K].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var le={};for(var Ee in this.sourceCaches){var Ae=this.sourceCaches[Ee];le[Ee]=Ae.used,Ae.used=!1}for(var Oe=0,Ke=this._order;Oe<Ke.length;Oe+=1){var We=this._layers[Ke[Oe]];We.recalculate(o,this._availableImages),!We.isHidden(o.zoom)&&We.source&&(this.sourceCaches[We.source].used=!0)}for(var st in le){var je=this.sourceCaches[st];le[st]!==je.used&&je.fire(new p.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:st}))}this.light.recalculate(o),this.z=o.zoom,h&&this.fire(new p.Event("data",{dataType:"style"}))}},s.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var h in this.sourceCaches)this.sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},s.prototype._updateWorkerLayers=function(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:h})},s.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},s.prototype.setState=function(o){var h=this;if(this._checkLoaded(),es(this,p.validateStyle(o)))return!1;(o=p.clone$1(o)).layers=nn(o.layers);var y=function(C,k){if(!C)return[{command:ln.setStyle,args:[k]}];var K=[];try{if(!p.deepEqual(C.version,k.version))return[{command:ln.setStyle,args:[k]}];p.deepEqual(C.center,k.center)||K.push({command:ln.setCenter,args:[k.center]}),p.deepEqual(C.zoom,k.zoom)||K.push({command:ln.setZoom,args:[k.zoom]}),p.deepEqual(C.bearing,k.bearing)||K.push({command:ln.setBearing,args:[k.bearing]}),p.deepEqual(C.pitch,k.pitch)||K.push({command:ln.setPitch,args:[k.pitch]}),p.deepEqual(C.sprite,k.sprite)||K.push({command:ln.setSprite,args:[k.sprite]}),p.deepEqual(C.glyphs,k.glyphs)||K.push({command:ln.setGlyphs,args:[k.glyphs]}),p.deepEqual(C.transition,k.transition)||K.push({command:ln.setTransition,args:[k.transition]}),p.deepEqual(C.light,k.light)||K.push({command:ln.setLight,args:[k.light]});var le={},Ee=[];!function(Oe,Ke,We,st){var je;for(je in Ke=Ke||{},Oe=Oe||{})Oe.hasOwnProperty(je)&&(Ke.hasOwnProperty(je)||gn(je,We,st));for(je in Ke)Ke.hasOwnProperty(je)&&(Oe.hasOwnProperty(je)?p.deepEqual(Oe[je],Ke[je])||("geojson"===Oe[je].type&&"geojson"===Ke[je].type&&ta(Oe,Ke,je)?We.push({command:ln.setGeoJSONSourceData,args:[je,Ke[je].data]}):Oi(je,Ke,We,st)):Di(je,Ke,We))}(C.sources,k.sources,Ee,le);var Ae=[];C.layers&&C.layers.forEach(function(Oe){le[Oe.source]?K.push({command:ln.removeLayer,args:[Oe.id]}):Ae.push(Oe)}),K=K.concat(Ee),function(Oe,Ke,We){Ke=Ke||[];var st,je,at,xt,zt,or,Jt,yr=(Oe=Oe||[]).map(Ji),Rr=Ke.map(Ji),$r=Oe.reduce(ji,{}),Xr=Ke.reduce(ji,{}),pn=yr.slice(),qn=Object.create(null);for(st=0,je=0;st<yr.length;st++)Xr.hasOwnProperty(at=yr[st])?je++:(We.push({command:ln.removeLayer,args:[at]}),pn.splice(pn.indexOf(at,je),1));for(st=0,je=0;st<Rr.length;st++)pn[pn.length-1-st]!==(at=Rr[Rr.length-1-st])&&($r.hasOwnProperty(at)?(We.push({command:ln.removeLayer,args:[at]}),pn.splice(pn.lastIndexOf(at,pn.length-je),1)):je++,We.push({command:ln.addLayer,args:[Xr[at],or=pn[pn.length-st]]}),pn.splice(pn.length-st,0,at),qn[at]=!0);for(st=0;st<Rr.length;st++)if(xt=$r[at=Rr[st]],zt=Xr[at],!qn[at]&&!p.deepEqual(xt,zt))if(p.deepEqual(xt.source,zt.source)&&p.deepEqual(xt["source-layer"],zt["source-layer"])&&p.deepEqual(xt.type,zt.type)){for(Jt in oi(xt.layout,zt.layout,We,at,null,ln.setLayoutProperty),oi(xt.paint,zt.paint,We,at,null,ln.setPaintProperty),p.deepEqual(xt.filter,zt.filter)||We.push({command:ln.setFilter,args:[at,zt.filter]}),p.deepEqual(xt.minzoom,zt.minzoom)&&p.deepEqual(xt.maxzoom,zt.maxzoom)||We.push({command:ln.setLayerZoomRange,args:[at,zt.minzoom,zt.maxzoom]}),xt)xt.hasOwnProperty(Jt)&&"layout"!==Jt&&"paint"!==Jt&&"filter"!==Jt&&"metadata"!==Jt&&"minzoom"!==Jt&&"maxzoom"!==Jt&&(0===Jt.indexOf("paint.")?oi(xt[Jt],zt[Jt],We,at,Jt.slice(6),ln.setPaintProperty):p.deepEqual(xt[Jt],zt[Jt])||We.push({command:ln.setLayerProperty,args:[at,Jt,zt[Jt]]}));for(Jt in zt)zt.hasOwnProperty(Jt)&&!xt.hasOwnProperty(Jt)&&"layout"!==Jt&&"paint"!==Jt&&"filter"!==Jt&&"metadata"!==Jt&&"minzoom"!==Jt&&"maxzoom"!==Jt&&(0===Jt.indexOf("paint.")?oi(xt[Jt],zt[Jt],We,at,Jt.slice(6),ln.setPaintProperty):p.deepEqual(xt[Jt],zt[Jt])||We.push({command:ln.setLayerProperty,args:[at,Jt,zt[Jt]]}))}else We.push({command:ln.removeLayer,args:[at]}),or=pn[pn.lastIndexOf(at)+1],We.push({command:ln.addLayer,args:[zt,or]})}(Ae,k.layers,K)}catch(Oe){console.warn("Unable to compute style diff:",Oe),K=[{command:ln.setStyle,args:[k]}]}return K}(this.serialize(),o).filter(function(C){return!(C.command in Ls)});if(0===y.length)return!1;var S=y.filter(function(C){return!(C.command in ts)});if(S.length>0)throw new Error("Unimplemented: "+S.map(function(C){return C.command}).join(", ")+".");return y.forEach(function(C){"setTransition"!==C.command&&h[C.command].apply(h,C.args)}),this.stylesheet=o,!0},s.prototype.addImage=function(o,h){if(this.getImage(o))return this.fire(new p.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,h),this._afterImageUpdated(o)},s.prototype.updateImage=function(o,h){this.imageManager.updateImage(o,h)},s.prototype.getImage=function(o){return this.imageManager.getImage(o)},s.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new p.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},s.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new p.Event("data",{dataType:"style"}))},s.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},s.prototype.addSource=function(o,h,y){var S=this;if(void 0===y&&(y={}),this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error("There is already a source with this ID");if(!h.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(h).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(p.validateStyle.source,"sources."+o,h,null,y))){this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);var C=this.sourceCaches[o]=new Te(o,h,this.dispatcher);C.style=this,C.setEventedParent(this,function(){return{isSourceLoaded:S.loaded(),source:C.serialize(),sourceId:o}}),C.onAdd(this.map),this._changed=!0}},s.prototype.removeSource=function(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(var h in this._layers)if(this._layers[h].source===o)return this.fire(new p.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+h+'" is using it.')));var y=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],y.fire(new p.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),y.setEventedParent(null),y.clearTiles(),y.onRemove&&y.onRemove(this.map),this._changed=!0},s.prototype.setGeoJSONSourceData=function(o,h){this._checkLoaded(),this.sourceCaches[o].getSource().setData(h),this._changed=!0},s.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},s.prototype.addLayer=function(o,h,y){void 0===y&&(y={}),this._checkLoaded();var S=o.id;if(this.getLayer(S))this.fire(new p.ErrorEvent(new Error('Layer with id "'+S+'" already exists on this map')));else{var C;if("custom"===o.type){if(es(this,p.validateCustomStyleLayer(o)))return;C=p.createStyleLayer(o)}else{if("object"==typeof o.source&&(this.addSource(S,o.source),o=p.clone$1(o),o=p.extend(o,{source:S})),this._validate(p.validateStyle.layer,"layers."+S,o,{arrayIndex:-1},y))return;C=p.createStyleLayer(o),this._validateLayer(C),C.setEventedParent(this,{layer:{id:S}}),this._serializedLayers[C.id]=C.serialize()}var k=h?this._order.indexOf(h):this._order.length;if(h&&-1===k)this.fire(new p.ErrorEvent(new Error('Layer with id "'+h+'" does not exist on this map.')));else{if(this._order.splice(k,0,S),this._layerOrderChanged=!0,this._layers[S]=C,this._removedLayers[S]&&C.source&&"custom"!==C.type){var K=this._removedLayers[S];delete this._removedLayers[S],K.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",this.sourceCaches[C.source].pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map)}}},s.prototype.moveLayer=function(o,h){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==h){var y=this._order.indexOf(o);this._order.splice(y,1);var S=h?this._order.indexOf(h):this._order.length;h&&-1===S?this.fire(new p.ErrorEvent(new Error('Layer with id "'+h+'" does not exist on this map.'))):(this._order.splice(S,0,o),this._layerOrderChanged=!0)}}else this.fire(new p.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},s.prototype.removeLayer=function(o){this._checkLoaded();var h=this._layers[o];if(h){h.setEventedParent(null);var y=this._order.indexOf(o);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map)}else this.fire(new p.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},s.prototype.getLayer=function(o){return this._layers[o]},s.prototype.hasLayer=function(o){return o in this._layers},s.prototype.setLayerZoomRange=function(o,h,y){this._checkLoaded();var S=this.getLayer(o);S?S.minzoom===h&&S.maxzoom===y||(null!=h&&(S.minzoom=h),null!=y&&(S.maxzoom=y),this._updateLayer(S)):this.fire(new p.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},s.prototype.setFilter=function(o,h,y){void 0===y&&(y={}),this._checkLoaded();var S=this.getLayer(o);if(S){if(!p.deepEqual(S.filter,h))return null==h?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(p.validateStyle.filter,"layers."+S.id+".filter",h,null,y)||(S.filter=p.clone$1(h),this._updateLayer(S)))}else this.fire(new p.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},s.prototype.getFilter=function(o){return p.clone$1(this.getLayer(o).filter)},s.prototype.setLayoutProperty=function(o,h,y,S){void 0===S&&(S={}),this._checkLoaded();var C=this.getLayer(o);C?p.deepEqual(C.getLayoutProperty(h),y)||(C.setLayoutProperty(h,y,S),this._updateLayer(C)):this.fire(new p.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getLayoutProperty=function(o,h){var y=this.getLayer(o);if(y)return y.getLayoutProperty(h);this.fire(new p.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},s.prototype.setPaintProperty=function(o,h,y,S){void 0===S&&(S={}),this._checkLoaded();var C=this.getLayer(o);C?p.deepEqual(C.getPaintProperty(h),y)||(C.setPaintProperty(h,y,S)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new p.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},s.prototype.getPaintProperty=function(o,h){return this.getLayer(o).getPaintProperty(h)},s.prototype.setFeatureState=function(o,h){this._checkLoaded();var y=o.source,S=o.sourceLayer,C=this.sourceCaches[y];if(void 0!==C){var k=C.getSource().type;"geojson"===k&&S?this.fire(new p.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==k||S?(void 0===o.id&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),C.setFeatureState(S,o.id,h)):this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},s.prototype.removeFeatureState=function(o,h){this._checkLoaded();var y=o.source,S=this.sourceCaches[y];if(void 0!==S){var C=S.getSource().type,k="vector"===C?o.sourceLayer:void 0;"vector"!==C||k?h&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new p.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):S.removeFeatureState(k,o.id,h):this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},s.prototype.getFeatureState=function(o){this._checkLoaded();var h=o.source,y=o.sourceLayer,S=this.sourceCaches[h];if(void 0!==S){if("vector"!==S.getSource().type||y)return void 0===o.id&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),S.getFeatureState(y,o.id);this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error("The source '"+h+"' does not exist in the map's style.")))},s.prototype.getTransition=function(){return p.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},s.prototype.serialize=function(){return p.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:p.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return void 0!==o})},s.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},s.prototype._flattenAndSortRenderedFeatures=function(o){for(var h=this,y=function($r){return"fill-extrusion"===h._layers[$r].type},S={},C=[],k=this._order.length-1;k>=0;k--){var K=this._order[k];if(y(K)){S[K]=k;for(var le=0,Ee=o;le<Ee.length;le+=1){var Ae=Ee[le][K];if(Ae)for(var Oe=0,Ke=Ae;Oe<Ke.length;Oe+=1)C.push(Ke[Oe])}}}C.sort(function($r,Xr){return Xr.intersectionZ-$r.intersectionZ});for(var We=[],st=this._order.length-1;st>=0;st--){var je=this._order[st];if(y(je))for(var at=C.length-1;at>=0;at--){var xt=C[at].feature;if(S[xt.layer.id]<st)break;We.push(xt),C.pop()}else for(var zt=0,or=o;zt<or.length;zt+=1){var Jt=or[zt][je];if(Jt)for(var yr=0,Rr=Jt;yr<Rr.length;yr+=1)We.push(Rr[yr].feature)}}return We},s.prototype.queryRenderedFeatures=function(o,h,y){h&&h.filter&&this._validate(p.validateStyle.filter,"queryRenderedFeatures.filter",h.filter,null,h);var S={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new p.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var C=0,k=h.layers;C<k.length;C+=1){var K=k[C],le=this._layers[K];if(!le)return this.fire(new p.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot be queried for features."))),[];S[le.source]=!0}}var Ee=[];for(var Ae in h.availableImages=this._availableImages,this.sourceCaches)h.layers&&!S[Ae]||Ee.push(fn(this.sourceCaches[Ae],this._layers,this._serializedLayers,o,h,y));return this.placement&&Ee.push(function(Oe,Ke,We,st,je,at,xt){for(var zt={},or=at.queryRenderedSymbols(st),Jt=[],yr=0,Rr=Object.keys(or).map(Number);yr<Rr.length;yr+=1)Jt.push(xt[Rr[yr]]);Jt.sort(Pr);for(var $r=function(){var Rn=pn[Xr],ki=Rn.featureIndex.lookupSymbolFeatures(or[Rn.bucketInstanceId],Ke,Rn.bucketIndex,Rn.sourceLayerIndex,je.filter,je.layers,je.availableImages,Oe);for(var kn in ki){var gi=zt[kn]=zt[kn]||[],Vi=ki[kn];Vi.sort(function(Ni,$){var ee=Rn.featureSortOrder;if(ee){var L=ee.indexOf(Ni.featureIndex);return ee.indexOf($.featureIndex)-L}return $.featureIndex-Ni.featureIndex});for(var li=0,yi=Vi;li<yi.length;li+=1)gi.push(yi[li])}},Xr=0,pn=Jt;Xr<pn.length;Xr+=1)$r();var qn=function(Rn){zt[Rn].forEach(function(ki){var kn=ki.feature,gi=We[Oe[Rn].source].getFeatureState(kn.layer["source-layer"],kn.id);kn.source=kn.layer.source,kn.layer["source-layer"]&&(kn.sourceLayer=kn.layer["source-layer"]),kn.state=gi})};for(var Un in zt)qn(Un);return zt}(this._layers,this._serializedLayers,this.sourceCaches,o,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(Ee)},s.prototype.querySourceFeatures=function(o,h){h&&h.filter&&this._validate(p.validateStyle.filter,"querySourceFeatures.filter",h.filter,null,h);var y=this.sourceCaches[o];return y?function(S,C){for(var k=S.getRenderableIds().map(function(Ke){return S.getTileByID(Ke)}),K=[],le={},Ee=0;Ee<k.length;Ee++){var Ae=k[Ee],Oe=Ae.tileID.canonical.key;le[Oe]||(le[Oe]=!0,Ae.querySourceFeatures(K,C))}return K}(y,h):[]},s.prototype.addSourceType=function(o,h,y){return s.getSourceType(o)?y(new Error('A source type called "'+o+'" already exists.')):(s.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},y):y(null,null))},s.prototype.getLight=function(){return this.light.getLight()},s.prototype.setLight=function(o,h){void 0===h&&(h={}),this._checkLoaded();var y=this.light.getLight(),S=!1;for(var C in o)if(!p.deepEqual(o[C],y[C])){S=!0;break}if(S){var k={now:p.browser.now(),transition:p.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,h),this.light.updateTransitions(k)}},s.prototype._validate=function(o,h,y,S,C){return void 0===C&&(C={}),(!C||!1!==C.validate)&&es(this,o.call(p.validateStyle,p.extend({key:h,style:this.serialize(),value:y,styleSpec:p.styleSpec},S)))},s.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),p.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var h in this.sourceCaches)this.sourceCaches[h].clearTiles(),this.sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},s.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},s.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},s.prototype._updateSources=function(o){for(var h in this.sourceCaches)this.sourceCaches[h].update(o)},s.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},s.prototype._updatePlacement=function(o,h,y,S,C){void 0===C&&(C=!1);for(var k=!1,K=!1,le={},Ee=0,Ae=this._order;Ee<Ae.length;Ee+=1){var Oe=this._layers[Ae[Ee]];if("symbol"===Oe.type){if(!le[Oe.source]){var Ke=this.sourceCaches[Oe.source];le[Oe.source]=Ke.getRenderableIds(!0).map(function(xt){return Ke.getTileByID(xt)}).sort(function(xt,zt){return zt.tileID.overscaledZ-xt.tileID.overscaledZ||(xt.tileID.isLessThan(zt.tileID)?-1:1)})}var We=this.crossTileSymbolIndex.addLayer(Oe,le[Oe.source],o.center.lng);k=k||We}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((C=C||this._layerOrderChanged||0===y)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(p.browser.now(),o.zoom))&&(this.pauseablePlacement=new du(o,this._order,C,h,y,S,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,le),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(p.browser.now()),K=!0),k&&this.pauseablePlacement.placement.setStale()),K||k)for(var st=0,je=this._order;st<je.length;st+=1){var at=this._layers[je[st]];"symbol"===at.type&&this.placement.updateLayerOpacities(at,le[at.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(p.browser.now())},s.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},s.prototype.getImages=function(o,h,y){this.imageManager.getImages(h.icons,y),this._updateTilesForChangedImages();var S=this.sourceCaches[h.source];S&&S.setDependencies(h.tileID.key,h.type,h.icons)},s.prototype.getGlyphs=function(o,h,y){this.glyphManager.getGlyphs(h.stacks,y)},s.prototype.getResource=function(o,h,y){return p.makeRequest(h,y)},s}(p.Evented);gs.getSourceType=function(a){return br[a]},gs.setSourceType=function(a,s){br[a]=s},gs.registerForPluginStateChange=p.registerForPluginStateChange;var Oa=p.createLayout([{name:"a_pos",type:"Int16",components:2}]),Lo=vi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),Ol=vi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),kl=vi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ll=vi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),Sc=vi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Rl=vi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),hl=vi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),eu=vi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Dl=vi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),m=vi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),E=vi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),U=vi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),O=vi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),pe=vi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),De=vi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),ft=vi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Rt=vi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),kt=vi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Ir=vi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Nr=vi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),Jn=vi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),bi=vi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),pi=vi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),oa=vi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),Ea=vi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),Na=vi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function vi(a,s){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,h=s.match(/attribute ([\w]+) ([\w]+)/g),y=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=s.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),C=S?S.concat(y):y,k={};return{fragmentSource:a=a.replace(o,function(K,le,Ee,Ae,Oe){return k[Oe]=!0,"define"===le?"\n#ifndef HAS_UNIFORM_u_"+Oe+"\nvarying "+Ee+" "+Ae+" "+Oe+";\n#else\nuniform "+Ee+" "+Ae+" u_"+Oe+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+Oe+"\n    "+Ee+" "+Ae+" "+Oe+" = u_"+Oe+";\n#endif\n"}),vertexSource:s=s.replace(o,function(K,le,Ee,Ae,Oe){var Ke="float"===Ae?"vec2":"vec4",We=Oe.match(/color/)?"color":Ke;return k[Oe]?"define"===le?"\n#ifndef HAS_UNIFORM_u_"+Oe+"\nuniform lowp float u_"+Oe+"_t;\nattribute "+Ee+" "+Ke+" a_"+Oe+";\nvarying "+Ee+" "+Ae+" "+Oe+";\n#else\nuniform "+Ee+" "+Ae+" u_"+Oe+";\n#endif\n":"vec4"===We?"\n#ifndef HAS_UNIFORM_u_"+Oe+"\n    "+Oe+" = a_"+Oe+";\n#else\n    "+Ee+" "+Ae+" "+Oe+" = u_"+Oe+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+Oe+"\n    "+Oe+" = unpack_mix_"+We+"(a_"+Oe+", u_"+Oe+"_t);\n#else\n    "+Ee+" "+Ae+" "+Oe+" = u_"+Oe+";\n#endif\n":"define"===le?"\n#ifndef HAS_UNIFORM_u_"+Oe+"\nuniform lowp float u_"+Oe+"_t;\nattribute "+Ee+" "+Ke+" a_"+Oe+";\n#else\nuniform "+Ee+" "+Ae+" u_"+Oe+";\n#endif\n":"vec4"===We?"\n#ifndef HAS_UNIFORM_u_"+Oe+"\n    "+Ee+" "+Ae+" "+Oe+" = a_"+Oe+";\n#else\n    "+Ee+" "+Ae+" "+Oe+" = u_"+Oe+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+Oe+"\n    "+Ee+" "+Ae+" "+Oe+" = unpack_mix_"+We+"(a_"+Oe+", u_"+Oe+"_t);\n#else\n    "+Ee+" "+Ae+" "+Oe+" = u_"+Oe+";\n#endif\n"}),staticAttributes:h,staticUniforms:C}}var Xo=Object.freeze({__proto__:null,prelude:Lo,background:Ol,backgroundPattern:kl,circle:Ll,clippingMask:Sc,heatmap:Rl,heatmapTexture:hl,collisionBox:eu,collisionCircle:Dl,debug:m,fill:E,fillOutline:U,fillOutlinePattern:O,fillPattern:pe,fillExtrusion:De,fillExtrusionPattern:ft,hillshadePrepare:Rt,hillshade:kt,line:Ir,lineGradient:Nr,linePattern:Jn,lineSDF:bi,raster:pi,symbolIcon:oa,symbolSDF:Ea,symbolTextAndIcon:Na}),vu=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Tu(a){for(var s=[],o=0;o<a.length;o++)if(null!==a[o]){var h=a[o].split(" ");s.push(h.pop())}return s}vu.prototype.bind=function(a,s,o,h,y,S,C,k){this.context=a;for(var K=this.boundPaintVertexBuffers.length!==h.length,le=0;!K&&le<h.length;le++)this.boundPaintVertexBuffers[le]!==h[le]&&(K=!0);a.extVertexArrayObject&&this.vao&&this.boundProgram===s&&this.boundLayoutVertexBuffer===o&&!K&&this.boundIndexBuffer===y&&this.boundVertexOffset===S&&this.boundDynamicVertexBuffer===C&&this.boundDynamicVertexBuffer2===k?(a.bindVertexArrayOES.set(this.vao),C&&C.bind(),y&&y.dynamicDraw&&y.bind(),k&&k.bind()):this.freshBind(s,o,h,y,S,C,k)},vu.prototype.freshBind=function(a,s,o,h,y,S,C){var k,K=a.numAttributes,le=this.context,Ee=le.gl;if(le.extVertexArrayObject)this.vao&&this.destroy(),this.vao=le.extVertexArrayObject.createVertexArrayOES(),le.bindVertexArrayOES.set(this.vao),k=0,this.boundProgram=a,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=h,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=C;else{k=le.currentNumAttributes||0;for(var Ae=K;Ae<k;Ae++)Ee.disableVertexAttribArray(Ae)}s.enableAttributes(Ee,a);for(var Oe=0,Ke=o;Oe<Ke.length;Oe+=1)Ke[Oe].enableAttributes(Ee,a);S&&S.enableAttributes(Ee,a),C&&C.enableAttributes(Ee,a),s.bind(),s.setVertexAttribPointers(Ee,a,y);for(var We=0,st=o;We<st.length;We+=1){var je=st[We];je.bind(),je.setVertexAttribPointers(Ee,a,y)}S&&(S.bind(),S.setVertexAttribPointers(Ee,a,y)),h&&h.bind(),C&&(C.bind(),C.setVertexAttribPointers(Ee,a,y)),le.currentNumAttributes=K},vu.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ec=function(a,s,o,h,y,S){var C=a.gl;this.program=C.createProgram();for(var k=Tu(o.staticAttributes),K=h?h.getBinderAttributes():[],le=k.concat(K),Ee=o.staticUniforms?Tu(o.staticUniforms):[],Ae=h?h.getBinderUniforms():[],Oe=[],Ke=0,We=Ee.concat(Ae);Ke<We.length;Ke+=1){var st=We[Ke];Oe.indexOf(st)<0&&Oe.push(st)}var je=h?h.defines():[];S&&je.push("#define OVERDRAW_INSPECTOR;");var at=je.concat(Lo.fragmentSource,o.fragmentSource).join("\n"),xt=je.concat(Lo.vertexSource,o.vertexSource).join("\n"),zt=C.createShader(C.FRAGMENT_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(zt,at),C.compileShader(zt),C.attachShader(this.program,zt);var or=C.createShader(C.VERTEX_SHADER);if(C.isContextLost())this.failedToCreate=!0;else{C.shaderSource(or,xt),C.compileShader(or),C.attachShader(this.program,or),this.attributes={};var Jt={};this.numAttributes=le.length;for(var yr=0;yr<this.numAttributes;yr++)le[yr]&&(C.bindAttribLocation(this.program,yr,le[yr]),this.attributes[le[yr]]=yr);C.linkProgram(this.program),C.deleteShader(or),C.deleteShader(zt);for(var Rr=0;Rr<Oe.length;Rr++){var $r=Oe[Rr];if($r&&!Jt[$r]){var Xr=C.getUniformLocation(this.program,$r);Xr&&(Jt[$r]=Xr)}}this.fixedUniforms=y(a,Jt),this.binderUniforms=h?h.getUniforms(a,Jt):[]}}};function Du(a,s,o){var h=1/ma(o,1,s.transform.tileZoom),y=Math.pow(2,o.tileID.overscaledZ),S=o.tileSize*Math.pow(2,s.transform.tileZoom)/y,C=S*(o.tileID.canonical.x+o.tileID.wrap*y),k=S*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[h,a.fromScale,a.toScale],u_fade:a.t,u_pixel_coord_upper:[C>>16,k>>16],u_pixel_coord_lower:[65535&C,65535&k]}}Ec.prototype.draw=function(a,s,o,h,y,S,C,k,K,le,Ee,Ae,Oe,Ke,We,st){var je,at=a.gl;if(!this.failedToCreate){for(var xt in a.program.set(this.program),a.setDepthMode(o),a.setStencilMode(h),a.setColorMode(y),a.setCullFace(S),this.fixedUniforms)this.fixedUniforms[xt].set(C[xt]);Ke&&Ke.setUniforms(a,this.binderUniforms,Ae,{zoom:Oe});for(var zt=(je={},je[at.LINES]=2,je[at.TRIANGLES]=3,je[at.LINE_STRIP]=1,je)[s],or=0,Jt=Ee.get();or<Jt.length;or+=1){var yr=Jt[or],Rr=yr.vaos||(yr.vaos={});(Rr[k]||(Rr[k]=new vu)).bind(a,this,K,Ke?Ke.getPaintVertexBuffers():[],le,yr.vertexOffset,We,st),at.drawElements(s,yr.primitiveLength*zt,at.UNSIGNED_SHORT,yr.primitiveOffset*zt*2)}}};var Bl=function(a,s,o,h){var y=s.style.light,S=y.properties.get("position"),C=[S.x,S.y,S.z],k=p.create$1();"viewport"===y.properties.get("anchor")&&p.fromRotation(k,-s.transform.angle),p.transformMat3(C,C,k);var K=y.properties.get("color");return{u_matrix:a,u_lightpos:C,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[K.r,K.g,K.b],u_vertical_gradient:+o,u_opacity:h}},mu=function(a,s,o,h,y,S,C){return p.extend(Bl(a,s,o,h),Du(S,s,C),{u_height_factor:-Math.pow(2,y.overscaledZ)/C.tileSize/8})},gu=function(a){return{u_matrix:a}},tu=function(a,s,o,h){return p.extend(gu(a),Du(o,s,h))},oo=function(a,s){return{u_matrix:a,u_world:s}},Tc=function(a,s,o,h,y){return p.extend(tu(a,s,o,h),{u_world:y})},Cc=function(a,s,o,h){var y,S,C=a.transform;if("map"===h.paint.get("circle-pitch-alignment")){var k=ma(o,1,C.zoom);y=!0,S=[k,k]}else y=!1,S=C.pixelsToGLUnits;return{u_camera_to_center_distance:C.cameraToCenterDistance,u_scale_with_map:+("map"===h.paint.get("circle-pitch-scale")),u_matrix:a.translatePosMatrix(s.posMatrix,o,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:p.browser.devicePixelRatio,u_extrude_scale:S}},rs=function(a,s,o){var h=ma(o,1,s.zoom),y=Math.pow(2,s.zoom-o.tileID.overscaledZ),S=o.tileID.overscaleFactor();return{u_matrix:a,u_camera_to_center_distance:s.cameraToCenterDistance,u_pixels_to_tile_units:h,u_extrude_scale:[s.pixelsToGLUnits[0]/(h*y),s.pixelsToGLUnits[1]/(h*y)],u_overscale_factor:S}},tc=function(a,s,o){return{u_matrix:a,u_inv_matrix:s,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},ru=function(a,s,o){return void 0===o&&(o=1),{u_matrix:a,u_color:s,u_overlay:0,u_overlay_scale:o}},Rs=function(a){return{u_matrix:a}},rc=function(a,s,o,h){return{u_matrix:a,u_extrude_scale:ma(s,1,o),u_intensity:h}},Bu=function(a,s,o){var h=a.transform;return{u_matrix:nc(a,s,o),u_ratio:1/ma(s,1,h.zoom),u_device_pixel_ratio:p.browser.devicePixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},ka=function(a,s,o,h){return p.extend(Bu(a,s,o),{u_image:0,u_image_height:h})},Ju=function(a,s,o,h){var y=a.transform,S=Us(s,y);return{u_matrix:nc(a,s,o),u_texsize:s.imageAtlasTexture.size,u_ratio:1/ma(s,1,y.zoom),u_device_pixel_ratio:p.browser.devicePixelRatio,u_image:0,u_scale:[S,h.fromScale,h.toScale],u_fade:h.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Gc=function(a,s,o,h,y){var S=a.lineAtlas,C=Us(s,a.transform),k="round"===o.layout.get("line-cap"),K=S.getDash(h.from,k),le=S.getDash(h.to,k),Ee=K.width*y.fromScale,Ae=le.width*y.toScale;return p.extend(Bu(a,s,o),{u_patternscale_a:[C/Ee,-K.height/2],u_patternscale_b:[C/Ae,-le.height/2],u_sdfgamma:S.width/(256*Math.min(Ee,Ae)*p.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:K.y,u_tex_y_b:le.y,u_mix:y.t})};function Us(a,s){return 1/ma(a,1,s.tileZoom)}function nc(a,s,o){return a.translatePosMatrix(s.tileID.posMatrix,s,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Hc=function(a,s,o,h,y){return{u_matrix:a,u_tl_parent:s,u_scale_parent:o,u_buffer_scale:1,u_fade_t:h.mix,u_opacity:h.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(C=y.paint.get("raster-saturation"),C>0?1-1/(1.001-C):-C),u_contrast_factor:(S=y.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Ac(y.paint.get("raster-hue-rotate"))};var S,C};function Ac(a){a*=Math.PI/180;var s=Math.sin(a),o=Math.cos(a);return[(2*o+1)/3,(-Math.sqrt(3)*s-o+1)/3,(Math.sqrt(3)*s-o+1)/3]}var Fl,yu=function(a,s,o,h,y,S,C,k,K,le){var Ee=y.transform;return{u_is_size_zoom_constant:+("constant"===a||"source"===a),u_is_size_feature_constant:+("constant"===a||"camera"===a),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:Ee.cameraToCenterDistance,u_pitch:Ee.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:Ee.width/Ee.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:C,u_coord_matrix:k,u_is_text:+K,u_pitch_with_map:+h,u_texsize:le,u_texture:0}},$u=function(a,s,o,h,y,S,C,k,K,le,Ee){var Ae=y.transform;return p.extend(yu(a,s,o,h,y,S,C,k,K,le),{u_gamma_scale:h?Math.cos(Ae._pitch)*Ae.cameraToCenterDistance:1,u_device_pixel_ratio:p.browser.devicePixelRatio,u_is_halo:+Ee})},pl=function(a,s,o,h,y,S,C,k,K,le){return p.extend($u(a,s,o,h,y,S,C,k,!0,K,!0),{u_texsize_icon:le,u_texture_icon:1})},Qu=function(a,s,o){return{u_matrix:a,u_opacity:s,u_color:o}},el=function(a,s,o,h,y,S){return p.extend((k=S,le=y,Ee=(K=o).imageManager.getPattern((C=h).from.toString()),Ae=K.imageManager.getPattern(C.to.toString()),Ke=(Oe=K.imageManager.getPixelSize()).width,We=Oe.height,st=Math.pow(2,le.tileID.overscaledZ),at=(je=le.tileSize*Math.pow(2,K.transform.tileZoom)/st)*(le.tileID.canonical.x+le.tileID.wrap*st),xt=je*le.tileID.canonical.y,{u_image:0,u_pattern_tl_a:Ee.tl,u_pattern_br_a:Ee.br,u_pattern_tl_b:Ae.tl,u_pattern_br_b:Ae.br,u_texsize:[Ke,We],u_mix:k.t,u_pattern_size_a:Ee.displaySize,u_pattern_size_b:Ae.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/ma(le,1,K.transform.tileZoom),u_pixel_coord_upper:[at>>16,xt>>16],u_pixel_coord_lower:[65535&at,65535&xt]}),{u_matrix:a,u_opacity:s});var C,k,K,le,Ee,Ae,Oe,Ke,We,st,je,at,xt},dl={fillExtrusion:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_lightpos:new p.Uniform3f(a,s.u_lightpos),u_lightintensity:new p.Uniform1f(a,s.u_lightintensity),u_lightcolor:new p.Uniform3f(a,s.u_lightcolor),u_vertical_gradient:new p.Uniform1f(a,s.u_vertical_gradient),u_opacity:new p.Uniform1f(a,s.u_opacity)}},fillExtrusionPattern:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_lightpos:new p.Uniform3f(a,s.u_lightpos),u_lightintensity:new p.Uniform1f(a,s.u_lightintensity),u_lightcolor:new p.Uniform3f(a,s.u_lightcolor),u_vertical_gradient:new p.Uniform1f(a,s.u_vertical_gradient),u_height_factor:new p.Uniform1f(a,s.u_height_factor),u_image:new p.Uniform1i(a,s.u_image),u_texsize:new p.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new p.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new p.Uniform3f(a,s.u_scale),u_fade:new p.Uniform1f(a,s.u_fade),u_opacity:new p.Uniform1f(a,s.u_opacity)}},fill:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix)}},fillPattern:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_image:new p.Uniform1i(a,s.u_image),u_texsize:new p.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new p.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new p.Uniform3f(a,s.u_scale),u_fade:new p.Uniform1f(a,s.u_fade)}},fillOutline:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_world:new p.Uniform2f(a,s.u_world)}},fillOutlinePattern:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_world:new p.Uniform2f(a,s.u_world),u_image:new p.Uniform1i(a,s.u_image),u_texsize:new p.Uniform2f(a,s.u_texsize),u_pixel_coord_upper:new p.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(a,s.u_pixel_coord_lower),u_scale:new p.Uniform3f(a,s.u_scale),u_fade:new p.Uniform1f(a,s.u_fade)}},circle:function(a,s){return{u_camera_to_center_distance:new p.Uniform1f(a,s.u_camera_to_center_distance),u_scale_with_map:new p.Uniform1i(a,s.u_scale_with_map),u_pitch_with_map:new p.Uniform1i(a,s.u_pitch_with_map),u_extrude_scale:new p.Uniform2f(a,s.u_extrude_scale),u_device_pixel_ratio:new p.Uniform1f(a,s.u_device_pixel_ratio),u_matrix:new p.UniformMatrix4f(a,s.u_matrix)}},collisionBox:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_camera_to_center_distance:new p.Uniform1f(a,s.u_camera_to_center_distance),u_pixels_to_tile_units:new p.Uniform1f(a,s.u_pixels_to_tile_units),u_extrude_scale:new p.Uniform2f(a,s.u_extrude_scale),u_overscale_factor:new p.Uniform1f(a,s.u_overscale_factor)}},collisionCircle:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_inv_matrix:new p.UniformMatrix4f(a,s.u_inv_matrix),u_camera_to_center_distance:new p.Uniform1f(a,s.u_camera_to_center_distance),u_viewport_size:new p.Uniform2f(a,s.u_viewport_size)}},debug:function(a,s){return{u_color:new p.UniformColor(a,s.u_color),u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_overlay:new p.Uniform1i(a,s.u_overlay),u_overlay_scale:new p.Uniform1f(a,s.u_overlay_scale)}},clippingMask:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix)}},heatmap:function(a,s){return{u_extrude_scale:new p.Uniform1f(a,s.u_extrude_scale),u_intensity:new p.Uniform1f(a,s.u_intensity),u_matrix:new p.UniformMatrix4f(a,s.u_matrix)}},heatmapTexture:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_world:new p.Uniform2f(a,s.u_world),u_image:new p.Uniform1i(a,s.u_image),u_color_ramp:new p.Uniform1i(a,s.u_color_ramp),u_opacity:new p.Uniform1f(a,s.u_opacity)}},hillshade:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_image:new p.Uniform1i(a,s.u_image),u_latrange:new p.Uniform2f(a,s.u_latrange),u_light:new p.Uniform2f(a,s.u_light),u_shadow:new p.UniformColor(a,s.u_shadow),u_highlight:new p.UniformColor(a,s.u_highlight),u_accent:new p.UniformColor(a,s.u_accent)}},hillshadePrepare:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_image:new p.Uniform1i(a,s.u_image),u_dimension:new p.Uniform2f(a,s.u_dimension),u_zoom:new p.Uniform1f(a,s.u_zoom),u_unpack:new p.Uniform4f(a,s.u_unpack)}},line:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_ratio:new p.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new p.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(a,s.u_units_to_pixels)}},lineGradient:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_ratio:new p.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new p.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(a,s.u_units_to_pixels),u_image:new p.Uniform1i(a,s.u_image),u_image_height:new p.Uniform1f(a,s.u_image_height)}},linePattern:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_texsize:new p.Uniform2f(a,s.u_texsize),u_ratio:new p.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new p.Uniform1f(a,s.u_device_pixel_ratio),u_image:new p.Uniform1i(a,s.u_image),u_units_to_pixels:new p.Uniform2f(a,s.u_units_to_pixels),u_scale:new p.Uniform3f(a,s.u_scale),u_fade:new p.Uniform1f(a,s.u_fade)}},lineSDF:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_ratio:new p.Uniform1f(a,s.u_ratio),u_device_pixel_ratio:new p.Uniform1f(a,s.u_device_pixel_ratio),u_units_to_pixels:new p.Uniform2f(a,s.u_units_to_pixels),u_patternscale_a:new p.Uniform2f(a,s.u_patternscale_a),u_patternscale_b:new p.Uniform2f(a,s.u_patternscale_b),u_sdfgamma:new p.Uniform1f(a,s.u_sdfgamma),u_image:new p.Uniform1i(a,s.u_image),u_tex_y_a:new p.Uniform1f(a,s.u_tex_y_a),u_tex_y_b:new p.Uniform1f(a,s.u_tex_y_b),u_mix:new p.Uniform1f(a,s.u_mix)}},raster:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_tl_parent:new p.Uniform2f(a,s.u_tl_parent),u_scale_parent:new p.Uniform1f(a,s.u_scale_parent),u_buffer_scale:new p.Uniform1f(a,s.u_buffer_scale),u_fade_t:new p.Uniform1f(a,s.u_fade_t),u_opacity:new p.Uniform1f(a,s.u_opacity),u_image0:new p.Uniform1i(a,s.u_image0),u_image1:new p.Uniform1i(a,s.u_image1),u_brightness_low:new p.Uniform1f(a,s.u_brightness_low),u_brightness_high:new p.Uniform1f(a,s.u_brightness_high),u_saturation_factor:new p.Uniform1f(a,s.u_saturation_factor),u_contrast_factor:new p.Uniform1f(a,s.u_contrast_factor),u_spin_weights:new p.Uniform3f(a,s.u_spin_weights)}},symbolIcon:function(a,s){return{u_is_size_zoom_constant:new p.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new p.Uniform1f(a,s.u_size_t),u_size:new p.Uniform1f(a,s.u_size),u_camera_to_center_distance:new p.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new p.Uniform1f(a,s.u_pitch),u_rotate_symbol:new p.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new p.Uniform1f(a,s.u_fade_change),u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new p.Uniform1i(a,s.u_is_text),u_pitch_with_map:new p.Uniform1i(a,s.u_pitch_with_map),u_texsize:new p.Uniform2f(a,s.u_texsize),u_texture:new p.Uniform1i(a,s.u_texture)}},symbolSDF:function(a,s){return{u_is_size_zoom_constant:new p.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new p.Uniform1f(a,s.u_size_t),u_size:new p.Uniform1f(a,s.u_size),u_camera_to_center_distance:new p.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new p.Uniform1f(a,s.u_pitch),u_rotate_symbol:new p.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new p.Uniform1f(a,s.u_fade_change),u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new p.Uniform1i(a,s.u_is_text),u_pitch_with_map:new p.Uniform1i(a,s.u_pitch_with_map),u_texsize:new p.Uniform2f(a,s.u_texsize),u_texture:new p.Uniform1i(a,s.u_texture),u_gamma_scale:new p.Uniform1f(a,s.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(a,s.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(a,s.u_is_halo)}},symbolTextAndIcon:function(a,s){return{u_is_size_zoom_constant:new p.Uniform1i(a,s.u_is_size_zoom_constant),u_is_size_feature_constant:new p.Uniform1i(a,s.u_is_size_feature_constant),u_size_t:new p.Uniform1f(a,s.u_size_t),u_size:new p.Uniform1f(a,s.u_size),u_camera_to_center_distance:new p.Uniform1f(a,s.u_camera_to_center_distance),u_pitch:new p.Uniform1f(a,s.u_pitch),u_rotate_symbol:new p.Uniform1i(a,s.u_rotate_symbol),u_aspect_ratio:new p.Uniform1f(a,s.u_aspect_ratio),u_fade_change:new p.Uniform1f(a,s.u_fade_change),u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_label_plane_matrix:new p.UniformMatrix4f(a,s.u_label_plane_matrix),u_coord_matrix:new p.UniformMatrix4f(a,s.u_coord_matrix),u_is_text:new p.Uniform1i(a,s.u_is_text),u_pitch_with_map:new p.Uniform1i(a,s.u_pitch_with_map),u_texsize:new p.Uniform2f(a,s.u_texsize),u_texsize_icon:new p.Uniform2f(a,s.u_texsize_icon),u_texture:new p.Uniform1i(a,s.u_texture),u_texture_icon:new p.Uniform1i(a,s.u_texture_icon),u_gamma_scale:new p.Uniform1f(a,s.u_gamma_scale),u_device_pixel_ratio:new p.Uniform1f(a,s.u_device_pixel_ratio),u_is_halo:new p.Uniform1i(a,s.u_is_halo)}},background:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_opacity:new p.Uniform1f(a,s.u_opacity),u_color:new p.UniformColor(a,s.u_color)}},backgroundPattern:function(a,s){return{u_matrix:new p.UniformMatrix4f(a,s.u_matrix),u_opacity:new p.Uniform1f(a,s.u_opacity),u_image:new p.Uniform1i(a,s.u_image),u_pattern_tl_a:new p.Uniform2f(a,s.u_pattern_tl_a),u_pattern_br_a:new p.Uniform2f(a,s.u_pattern_br_a),u_pattern_tl_b:new p.Uniform2f(a,s.u_pattern_tl_b),u_pattern_br_b:new p.Uniform2f(a,s.u_pattern_br_b),u_texsize:new p.Uniform2f(a,s.u_texsize),u_mix:new p.Uniform1f(a,s.u_mix),u_pattern_size_a:new p.Uniform2f(a,s.u_pattern_size_a),u_pattern_size_b:new p.Uniform2f(a,s.u_pattern_size_b),u_scale_a:new p.Uniform1f(a,s.u_scale_a),u_scale_b:new p.Uniform1f(a,s.u_scale_b),u_pixel_coord_upper:new p.Uniform2f(a,s.u_pixel_coord_upper),u_pixel_coord_lower:new p.Uniform2f(a,s.u_pixel_coord_lower),u_tile_units_to_pixels:new p.Uniform1f(a,s.u_tile_units_to_pixels)}}};function Fu(a,s,o,h,y,S,C){for(var k=a.context,K=k.gl,le=a.useProgram("collisionBox"),Ee=[],Ae=0,Oe=0,Ke=0;Ke<h.length;Ke++){var We=h[Ke],st=s.getTile(We),je=st.getBucket(o);if(je){var at=We.posMatrix;0===y[0]&&0===y[1]||(at=a.translatePosMatrix(We.posMatrix,st,y,S));var xt=C?je.textCollisionBox:je.iconCollisionBox,zt=je.collisionCircleArray;if(zt.length>0){var or=p.create(),Jt=at;p.mul(or,je.placementInvProjMatrix,a.transform.glCoordMatrix),p.mul(or,or,je.placementViewportMatrix),Ee.push({circleArray:zt,circleOffset:Oe,transform:Jt,invTransform:or}),Oe=Ae+=zt.length/4}xt&&le.draw(k,K.LINES,F.disabled,re.disabled,a.colorModeForRenderPass(),Me.disabled,rs(at,a.transform,st),o.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,null,a.transform.zoom,null,null,xt.collisionVertexBuffer)}}if(C&&Ee.length){var yr=a.useProgram("collisionCircle"),Rr=new p.StructArrayLayout2f1f2i16;Rr.resize(4*Ae),Rr._trim();for(var $r=0,Xr=0,pn=Ee;Xr<pn.length;Xr+=1)for(var qn=pn[Xr],Un=0;Un<qn.circleArray.length/4;Un++){var Rn=4*Un,ki=qn.circleArray[Rn+0],kn=qn.circleArray[Rn+1],gi=qn.circleArray[Rn+2],Vi=qn.circleArray[Rn+3];Rr.emplace($r++,ki,kn,gi,Vi,0),Rr.emplace($r++,ki,kn,gi,Vi,1),Rr.emplace($r++,ki,kn,gi,Vi,2),Rr.emplace($r++,ki,kn,gi,Vi,3)}(!Fl||Fl.length<2*Ae)&&(Fl=function(D){var fe=2*D,Se=new p.StructArrayLayout3ui6;Se.resize(fe),Se._trim();for(var ct=0;ct<fe;ct++){var Pt=6*ct;Se.uint16[Pt+0]=4*ct+0,Se.uint16[Pt+1]=4*ct+1,Se.uint16[Pt+2]=4*ct+2,Se.uint16[Pt+3]=4*ct+2,Se.uint16[Pt+4]=4*ct+3,Se.uint16[Pt+5]=4*ct+0}return Se}(Ae));for(var li=k.createIndexBuffer(Fl,!0),yi=k.createVertexBuffer(Rr,p.collisionCircleLayout.members,!0),Ni=0,$=Ee;Ni<$.length;Ni+=1){var ee=$[Ni],L=tc(ee.transform,ee.invTransform,a.transform);yr.draw(k,K.TRIANGLES,F.disabled,re.disabled,a.colorModeForRenderPass(),Me.disabled,L,o.id,yi,li,p.SegmentVector.simpleSegment(0,2*ee.circleOffset,ee.circleArray.length,ee.circleArray.length/2),null,a.transform.zoom,null,null,null)}yi.destroy(),li.destroy()}}var Vs=p.identity(new Float32Array(16));function Pc(a,s,o,h,y,S){var C=p.getAnchorAlignment(a),k=-(C.horizontalAlign-.5)*s,K=-(C.verticalAlign-.5)*o,le=p.evaluateVariableOffset(a,h);return new p.Point((k/y+le[0])*S,(K/y+le[1])*S)}function Mc(a,s,o,h,y,S,C,k,K,le,Ee){var Ae=a.text.placedSymbolArray,Oe=a.text.dynamicLayoutVertexArray,Ke=a.icon.dynamicLayoutVertexArray,We={};Oe.clear();for(var st=0;st<Ae.length;st++){var je=Ae.get(st),at=je.hidden||!je.crossTileID||a.allowVerticalPlacement&&!je.placedOrientation?null:h[je.crossTileID];if(at){var xt=new p.Point(je.anchorX,je.anchorY),zt=Bi(xt,o?k:C),or=Xi(S.cameraToCenterDistance,zt.signedDistanceFromCamera),Jt=y.evaluateSizeForFeature(a.textSizeData,le,je)*or/p.ONE_EM;o&&(Jt*=a.tilePixelRatio/K);for(var yr=Pc(at.anchor,at.width,at.height,at.textOffset,at.textBoxScale,Jt),Rr=o?Bi(xt.add(yr),C).point:zt.point.add(s?yr.rotate(-S.angle):yr),$r=a.allowVerticalPlacement&&je.placedOrientation===p.WritingMode.vertical?Math.PI/2:0,Xr=0;Xr<je.numGlyphs;Xr++)p.addDynamicAttributes(Oe,Rr,$r);Ee&&je.associatedIconIndex>=0&&(We[je.associatedIconIndex]={shiftedAnchor:Rr,angle:$r})}else Fi(je.numGlyphs,Oe)}if(Ee){Ke.clear();for(var pn=a.icon.placedSymbolArray,qn=0;qn<pn.length;qn++){var Un=pn.get(qn);if(Un.hidden)Fi(Un.numGlyphs,Ke);else{var Rn=We[qn];if(Rn)for(var ki=0;ki<Un.numGlyphs;ki++)p.addDynamicAttributes(Ke,Rn.shiftedAnchor,Rn.angle);else Fi(Un.numGlyphs,Ke)}}a.icon.dynamicLayoutVertexBuffer.updateData(Ke)}a.text.dynamicLayoutVertexBuffer.updateData(Oe)}function Wc(a,s,o){return o.iconsInText&&s?"symbolTextAndIcon":a?"symbolSDF":"symbolIcon"}function tl(a,s,o,h,y,S,C,k,K,le,Ee,Ae){for(var Oe=a.context,Ke=Oe.gl,We=a.transform,st="map"===k,je="map"===K,at=st&&"point"!==o.layout.get("symbol-placement"),xt=st&&!je&&!at,zt=void 0!==o.layout.get("symbol-sort-key").constantOr(1),or=!1,Jt=a.depthModeForSublayer(0,F.ReadOnly),yr=o.layout.get("text-variable-anchor"),Rr=[],$r=0,Xr=h;$r<Xr.length;$r+=1){var pn=Xr[$r],qn=s.getTile(pn),Un=qn.getBucket(o);if(Un){var Rn=y?Un.text:Un.icon;if(Rn&&Rn.segments.get().length){var ki=Rn.programConfigurations.get(o.id),kn=y||Un.sdfIcons,gi=y?Un.textSizeData:Un.iconSizeData,Vi=je||0!==We.pitch,li=a.useProgram(Wc(kn,y,Un),ki),yi=p.evaluateSizeForZoom(gi,We.zoom),Ni=void 0,$=[0,0],ee=void 0,L=void 0,D=null,fe=void 0;if(y)ee=qn.glyphAtlasTexture,L=Ke.LINEAR,Ni=qn.glyphAtlasTexture.size,Un.iconsInText&&($=qn.imageAtlasTexture.size,D=qn.imageAtlasTexture,fe=Vi||a.options.rotating||a.options.zooming||"composite"===gi.kind||"camera"===gi.kind?Ke.LINEAR:Ke.NEAREST);else{var Se=1!==o.layout.get("icon-size").constantOr(0)||Un.iconsNeedLinear;ee=qn.imageAtlasTexture,L=kn||a.options.rotating||a.options.zooming||Se||Vi?Ke.LINEAR:Ke.NEAREST,Ni=qn.imageAtlasTexture.size}var ct=ma(qn,1,a.transform.zoom),Pt=Ma(pn.posMatrix,je,st,a.transform,ct),bt=Gi(pn.posMatrix,je,st,a.transform,ct),rr=yr&&Un.hasTextData(),jr="none"!==o.layout.get("icon-text-fit")&&rr&&Un.hasIconData();at&&Ho(Un,pn.posMatrix,a,y,Pt,bt,je,le);var Mn=a.translatePosMatrix(pn.posMatrix,qn,S,C),Xn=at||y&&yr||jr?Vs:Pt,ni=a.translatePosMatrix(bt,qn,S,C,!0),Ci=kn&&0!==o.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1),wi={program:li,buffers:Rn,uniformValues:kn?Un.iconsInText?pl(gi.kind,yi,xt,je,a,Mn,Xn,ni,Ni,$):$u(gi.kind,yi,xt,je,a,Mn,Xn,ni,y,Ni,!0):yu(gi.kind,yi,xt,je,a,Mn,Xn,ni,y,Ni),atlasTexture:ee,atlasTextureIcon:D,atlasInterpolation:L,atlasInterpolationIcon:fe,isSDF:kn,hasHalo:Ci};if(zt&&Un.canOverlap){or=!0;for(var ea=0,xa=Rn.segments.get();ea<xa.length;ea+=1){var ua=xa[ea];Rr.push({segments:new p.SegmentVector([ua]),sortKey:ua.sortKey,state:wi})}}else Rr.push({segments:Rn.segments,sortKey:0,state:wi})}}}or&&Rr.sort(function(la,no){return la.sortKey-no.sortKey});for(var Ha=0,Wa=Rr;Ha<Wa.length;Ha+=1){var Ka=Wa[Ha],ia=Ka.state;if(Oe.activeTexture.set(Ke.TEXTURE0),ia.atlasTexture.bind(ia.atlasInterpolation,Ke.CLAMP_TO_EDGE),ia.atlasTextureIcon&&(Oe.activeTexture.set(Ke.TEXTURE1),ia.atlasTextureIcon&&ia.atlasTextureIcon.bind(ia.atlasInterpolationIcon,Ke.CLAMP_TO_EDGE)),ia.isSDF){var ga=ia.uniformValues;ia.hasHalo&&(ga.u_is_halo=1,vl(ia.buffers,Ka.segments,o,a,ia.program,Jt,Ee,Ae,ga)),ga.u_is_halo=0}vl(ia.buffers,Ka.segments,o,a,ia.program,Jt,Ee,Ae,ia.uniformValues)}}function vl(a,s,o,h,y,S,C,k,K){var le=h.context;y.draw(le,le.gl.TRIANGLES,S,C,k,Me.disabled,K,o.id,a.layoutVertexBuffer,a.indexBuffer,s,o.paint,h.transform.zoom,a.programConfigurations.get(o.id),a.dynamicLayoutVertexBuffer,a.opacityVertexBuffer)}function Nl(a,s,o,h,y,S,C){var k,K,le,Ee,Ae,Oe=a.context.gl,Ke=o.paint.get("fill-pattern"),We=Ke&&Ke.constantOr(1),st=o.getCrossfadeParameters();C?(K=We&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",k=Oe.LINES):(K=We?"fillPattern":"fill",k=Oe.TRIANGLES);for(var je=0,at=h;je<at.length;je+=1){var xt=at[je],zt=s.getTile(xt);if(!We||zt.patternsLoaded()){var or=zt.getBucket(o);if(or){var Jt=or.programConfigurations.get(o.id),yr=a.useProgram(K,Jt);We&&(a.context.activeTexture.set(Oe.TEXTURE0),zt.imageAtlasTexture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE),Jt.updatePaintBuffers(st));var Rr=Ke.constantOr(null);if(Rr&&zt.imageAtlas){var $r=zt.imageAtlas,Xr=$r.patternPositions[Rr.to.toString()],pn=$r.patternPositions[Rr.from.toString()];Xr&&pn&&Jt.setConstantPatternPositions(Xr,pn)}var qn=a.translatePosMatrix(xt.posMatrix,zt,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(C){Ee=or.indexBuffer2,Ae=or.segments2;var Un=[Oe.drawingBufferWidth,Oe.drawingBufferHeight];le="fillOutlinePattern"===K&&We?Tc(qn,a,st,zt,Un):oo(qn,Un)}else Ee=or.indexBuffer,Ae=or.segments,le=We?tu(qn,a,st,zt):gu(qn);yr.draw(a.context,k,y,a.stencilModeForClipping(xt),S,Me.disabled,le,o.id,or.layoutVertexBuffer,Ee,Ae,o.paint,a.transform.zoom,Jt)}}}}function ic(a,s,o,h,y,S,C){for(var k=a.context,K=k.gl,le=o.paint.get("fill-extrusion-pattern"),Ee=le.constantOr(1),Ae=o.getCrossfadeParameters(),Oe=o.paint.get("fill-extrusion-opacity"),Ke=0,We=h;Ke<We.length;Ke+=1){var st=We[Ke],je=s.getTile(st),at=je.getBucket(o);if(at){var xt=at.programConfigurations.get(o.id),zt=a.useProgram(Ee?"fillExtrusionPattern":"fillExtrusion",xt);Ee&&(a.context.activeTexture.set(K.TEXTURE0),je.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),xt.updatePaintBuffers(Ae));var or=le.constantOr(null);if(or&&je.imageAtlas){var Jt=je.imageAtlas,yr=Jt.patternPositions[or.to.toString()],Rr=Jt.patternPositions[or.from.toString()];yr&&Rr&&xt.setConstantPatternPositions(yr,Rr)}var $r=a.translatePosMatrix(st.posMatrix,je,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Xr=o.paint.get("fill-extrusion-vertical-gradient"),pn=Ee?mu($r,a,Xr,Oe,st,Ae,je):Bl($r,a,Xr,Oe);zt.draw(k,k.gl.TRIANGLES,y,S,C,Me.backCCW,pn,o.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,o.paint,a.transform.zoom,xt)}}}function Nu(a,s,o,h,y,S){var C=a.context,k=C.gl,K=s.fbo;if(K){var le=a.useProgram("hillshade");C.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,K.colorAttachment.get());var Ee=function(Ae,Oe,Ke){var We=Ke.paint.get("hillshade-shadow-color"),st=Ke.paint.get("hillshade-highlight-color"),je=Ke.paint.get("hillshade-accent-color"),at=Ke.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Ke.paint.get("hillshade-illumination-anchor")&&(at-=Ae.transform.angle);var xt,zt,or,Jt=!Ae.options.moving;return{u_matrix:Ae.transform.calculatePosMatrix(Oe.tileID.toUnwrapped(),Jt),u_image:0,u_latrange:(xt=Oe.tileID,zt=Math.pow(2,xt.canonical.z),or=xt.canonical.y,[new p.MercatorCoordinate(0,or/zt).toLngLat().lat,new p.MercatorCoordinate(0,(or+1)/zt).toLngLat().lat]),u_light:[Ke.paint.get("hillshade-exaggeration"),at],u_shadow:We,u_highlight:st,u_accent:je}}(a,s,o);le.draw(C,k.TRIANGLES,h,y,S,Me.disabled,Ee,o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}}function uf(a,s,o,h,y,S){var st,je,at,xt,C=a.context,k=C.gl,K=s.dem;if(K&&K.data){var le=K.dim,Ee=K.stride,Ae=K.getPixels();if(C.activeTexture.set(k.TEXTURE1),C.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||a.getTileTexture(Ee),s.demTexture){var Oe=s.demTexture;Oe.update(Ae,{premultiply:!1}),Oe.bind(k.NEAREST,k.CLAMP_TO_EDGE)}else s.demTexture=new p.Texture(C,Ae,k.RGBA,{premultiply:!1}),s.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);C.activeTexture.set(k.TEXTURE0);var Ke=s.fbo;if(!Ke){var We=new p.Texture(C,{width:le,height:le,data:null},k.RGBA);We.bind(k.LINEAR,k.CLAMP_TO_EDGE),(Ke=s.fbo=C.createFramebuffer(le,le,!0)).colorAttachment.set(We.texture)}C.bindFramebuffer.set(Ke.framebuffer),C.viewport.set([0,0,le,le]),a.useProgram("hillshadePrepare").draw(C,k.TRIANGLES,h,y,S,Me.disabled,(st=s.tileID,at=(je=K).stride,xt=p.create(),p.ortho(xt,0,p.EXTENT,-p.EXTENT,0,0,1),p.translate(xt,xt,[0,-p.EXTENT,0]),{u_matrix:xt,u_image:1,u_dimension:[at,at],u_zoom:st.overscaledZ,u_unpack:je.getUnpackVector()}),o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments),s.needsHillshadePrepare=!1}}function Cu(a,s,o,h,y){var S=h.paint.get("raster-fade-duration");if(S>0){var C=p.browser.now(),k=(C-a.timeAdded)/S,K=s?(C-s.timeAdded)/S:-1,le=o.getSource(),Ee=y.coveringZoomLevel({tileSize:le.tileSize,roundZoom:le.roundZoom}),Ae=!s||Math.abs(s.tileID.overscaledZ-Ee)>Math.abs(a.tileID.overscaledZ-Ee),Oe=Ae&&a.refreshedUponExpiration?1:p.clamp(Ae?k:1-K,0,1);return a.refreshedUponExpiration&&k>=1&&(a.refreshedUponExpiration=!1),s?{opacity:1,mix:1-Oe}:{opacity:Oe,mix:0}}return{opacity:1,mix:0}}var zu=new p.Color(1,0,0,1),nu=new p.Color(0,1,0,1),Au=new p.Color(0,0,1,1),js=new p.Color(1,0,1,1),zl=new p.Color(0,1,1,1);function ac(a,s,o,h){Zu(a,0,s+o/2,a.transform.width,o,h)}function oc(a,s,o,h){Zu(a,s-o/2,0,o,a.transform.height,h)}function Zu(a,s,o,h,y,S){var C=a.context,k=C.gl;k.enable(k.SCISSOR_TEST),k.scissor(s*p.browser.devicePixelRatio,o*p.browser.devicePixelRatio,h*p.browser.devicePixelRatio,y*p.browser.devicePixelRatio),C.clear({color:S}),k.disable(k.SCISSOR_TEST)}function ns(a,s,o){var h=a.context,y=h.gl,S=o.posMatrix,C=a.useProgram("debug"),k=F.disabled,K=re.disabled,le=a.colorModeForRenderPass();h.activeTexture.set(y.TEXTURE0),a.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),C.draw(h,y.LINE_STRIP,k,K,le,Me.disabled,ru(S,p.Color.red),"$debug",a.debugBuffer,a.tileBorderIndexBuffer,a.debugSegments);var Ee=s.getTileByID(o.key).latestRawTileData,Ae=Math.floor((Ee&&Ee.byteLength||0)/1024),Oe=s.getTile(o).tileSize,Ke=512/Math.min(Oe,512)*(o.overscaledZ/a.transform.zoom)*.5,We=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(We+=" => "+o.overscaledZ),function(st,je){st.initDebugOverlayCanvas();var at=st.debugOverlayCanvas,xt=st.context.gl,zt=st.debugOverlayCanvas.getContext("2d");zt.clearRect(0,0,at.width,at.height),zt.shadowColor="white",zt.shadowBlur=2,zt.lineWidth=1.5,zt.strokeStyle="white",zt.textBaseline="top",zt.font="bold 36px Open Sans, sans-serif",zt.fillText(je,5,5),zt.strokeText(je,5,5),st.debugOverlayTexture.update(at),st.debugOverlayTexture.bind(xt.LINEAR,xt.CLAMP_TO_EDGE)}(a,We+" "+Ae+"kb"),C.draw(h,y.TRIANGLES,k,K,ye.alphaBlended,Me.disabled,ru(S,p.Color.transparent,Ke),"$debug",a.debugBuffer,a.quadTriangleIndexBuffer,a.debugSegments)}var rl={symbol:function(a,s,o,h,y){if("translucent"===a.renderPass){var S=re.disabled,C=a.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(k,K,le,Ee,Ae,Oe,Ke){for(var We=K.transform,st="map"===Ae,je="map"===Oe,at=0,xt=k;at<xt.length;at+=1){var zt=xt[at],or=Ee.getTile(zt),Jt=or.getBucket(le);if(Jt&&Jt.text&&Jt.text.segments.get().length){var yr=p.evaluateSizeForZoom(Jt.textSizeData,We.zoom),Rr=ma(or,1,K.transform.zoom),$r=Ma(zt.posMatrix,je,st,K.transform,Rr),Xr="none"!==le.layout.get("icon-text-fit")&&Jt.hasIconData();if(yr){var pn=Math.pow(2,We.zoom-or.tileID.overscaledZ);Mc(Jt,st,je,Ke,p.symbolSize,We,$r,zt.posMatrix,pn,yr,Xr)}}}}(h,a,o,s,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),y),0!==o.paint.get("icon-opacity").constantOr(1)&&tl(a,s,o,h,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),S,C),0!==o.paint.get("text-opacity").constantOr(1)&&tl(a,s,o,h,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),S,C),s.map.showCollisionBoxes&&(Fu(a,s,o,h,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),Fu(a,s,o,h,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(a,s,o,h){if("translucent"===a.renderPass){var y=o.paint.get("circle-opacity"),S=o.paint.get("circle-stroke-width"),C=o.paint.get("circle-stroke-opacity"),k=void 0!==o.layout.get("circle-sort-key").constantOr(1);if(0!==y.constantOr(1)||0!==S.constantOr(1)&&0!==C.constantOr(1)){for(var K=a.context,le=K.gl,Ee=a.depthModeForSublayer(0,F.ReadOnly),Ae=re.disabled,Oe=a.colorModeForRenderPass(),Ke=[],We=0;We<h.length;We++){var st=h[We],je=s.getTile(st),at=je.getBucket(o);if(at){var xt=at.programConfigurations.get(o.id),zt={programConfiguration:xt,program:a.useProgram("circle",xt),layoutVertexBuffer:at.layoutVertexBuffer,indexBuffer:at.indexBuffer,uniformValues:Cc(a,st,je,o)};if(k)for(var or=0,Jt=at.segments.get();or<Jt.length;or+=1){var yr=Jt[or];Ke.push({segments:new p.SegmentVector([yr]),sortKey:yr.sortKey,state:zt})}else Ke.push({segments:at.segments,sortKey:0,state:zt})}}k&&Ke.sort(function(qn,Un){return qn.sortKey-Un.sortKey});for(var Rr=0,$r=Ke;Rr<$r.length;Rr+=1){var Xr=$r[Rr],pn=Xr.state;pn.program.draw(K,le.TRIANGLES,Ee,Ae,Oe,Me.disabled,pn.uniformValues,o.id,pn.layoutVertexBuffer,pn.indexBuffer,Xr.segments,o.paint,a.transform.zoom,pn.programConfiguration)}}}},heatmap:function(a,s,o,h){if(0!==o.paint.get("heatmap-opacity"))if("offscreen"===a.renderPass){var y=a.context,S=y.gl,C=re.disabled,k=new ye([S.ONE,S.ONE],p.Color.transparent,[!0,!0,!0,!0]);(function(Ke,We,st){var je=Ke.gl;Ke.activeTexture.set(je.TEXTURE1),Ke.viewport.set([0,0,We.width/4,We.height/4]);var zt,or,Jt,yr,Rr,at=st.heatmapFbo;if(at)je.bindTexture(je.TEXTURE_2D,at.colorAttachment.get()),Ke.bindFramebuffer.set(at.framebuffer);else{var xt=je.createTexture();je.bindTexture(je.TEXTURE_2D,xt),je.texParameteri(je.TEXTURE_2D,je.TEXTURE_WRAP_S,je.CLAMP_TO_EDGE),je.texParameteri(je.TEXTURE_2D,je.TEXTURE_WRAP_T,je.CLAMP_TO_EDGE),je.texParameteri(je.TEXTURE_2D,je.TEXTURE_MIN_FILTER,je.LINEAR),je.texParameteri(je.TEXTURE_2D,je.TEXTURE_MAG_FILTER,je.LINEAR),Jt=xt,yr=at=st.heatmapFbo=Ke.createFramebuffer(We.width/4,We.height/4,!1),(Rr=(zt=Ke).gl).texImage2D(Rr.TEXTURE_2D,0,Rr.RGBA,(or=We).width/4,or.height/4,0,Rr.RGBA,zt.extRenderToTextureHalfFloat?zt.extTextureHalfFloat.HALF_FLOAT_OES:Rr.UNSIGNED_BYTE,null),yr.colorAttachment.set(Jt)}})(y,a,o),y.clear({color:p.Color.transparent});for(var K=0;K<h.length;K++){var le=h[K];if(!s.hasRenderableParent(le)){var Ee=s.getTile(le),Ae=Ee.getBucket(o);if(Ae){var Oe=Ae.programConfigurations.get(o.id);a.useProgram("heatmap",Oe).draw(y,S.TRIANGLES,F.disabled,C,k,Me.disabled,rc(le.posMatrix,Ee,a.transform.zoom,o.paint.get("heatmap-intensity")),o.id,Ae.layoutVertexBuffer,Ae.indexBuffer,Ae.segments,o.paint,a.transform.zoom,Oe)}}}y.viewport.set([0,0,a.width,a.height])}else"translucent"===a.renderPass&&(a.context.setColorMode(a.colorModeForRenderPass()),function(Ke,We){var st=Ke.context,je=st.gl,at=We.heatmapFbo;if(at){st.activeTexture.set(je.TEXTURE0),je.bindTexture(je.TEXTURE_2D,at.colorAttachment.get()),st.activeTexture.set(je.TEXTURE1);var xt=We.colorRampTexture;xt||(xt=We.colorRampTexture=new p.Texture(st,We.colorRamp,je.RGBA)),xt.bind(je.LINEAR,je.CLAMP_TO_EDGE),Ke.useProgram("heatmapTexture").draw(st,je.TRIANGLES,F.disabled,re.disabled,Ke.colorModeForRenderPass(),Me.disabled,function(zt,or,Jt,yr){var Rr=p.create();p.ortho(Rr,0,zt.width,zt.height,0,0,1);var $r=zt.context.gl;return{u_matrix:Rr,u_world:[$r.drawingBufferWidth,$r.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:or.paint.get("heatmap-opacity")}}(Ke,We),We.id,Ke.viewportBuffer,Ke.quadTriangleIndexBuffer,Ke.viewportSegments,We.paint,Ke.transform.zoom)}}(a,o))},line:function(a,s,o,h){if("translucent"===a.renderPass){var y=o.paint.get("line-opacity"),S=o.paint.get("line-width");if(0!==y.constantOr(1)&&0!==S.constantOr(1))for(var C=a.depthModeForSublayer(0,F.ReadOnly),k=a.colorModeForRenderPass(),K=o.paint.get("line-dasharray"),le=o.paint.get("line-pattern"),Ee=le.constantOr(1),Ae=o.paint.get("line-gradient"),Oe=o.getCrossfadeParameters(),Ke=Ee?"linePattern":K?"lineSDF":Ae?"lineGradient":"line",We=a.context,st=We.gl,je=!0,at=0,xt=h;at<xt.length;at+=1){var zt=xt[at],or=s.getTile(zt);if(!Ee||or.patternsLoaded()){var Jt=or.getBucket(o);if(Jt){var yr=Jt.programConfigurations.get(o.id),Rr=a.context.program.get(),$r=a.useProgram(Ke,yr),Xr=je||$r.program!==Rr,pn=le.constantOr(null);if(pn&&or.imageAtlas){var qn=or.imageAtlas,Un=qn.patternPositions[pn.to.toString()],Rn=qn.patternPositions[pn.from.toString()];Un&&Rn&&yr.setConstantPatternPositions(Un,Rn)}var ki=Ee?Ju(a,or,o,Oe):K?Gc(a,or,o,K,Oe):Ae?ka(a,or,o,Jt.lineClipsArray.length):Bu(a,or,o);if(Ee)We.activeTexture.set(st.TEXTURE0),or.imageAtlasTexture.bind(st.LINEAR,st.CLAMP_TO_EDGE),yr.updatePaintBuffers(Oe);else if(K&&(Xr||a.lineAtlas.dirty))We.activeTexture.set(st.TEXTURE0),a.lineAtlas.bind(We);else if(Ae){var kn=Jt.gradients[o.id],gi=kn.texture;if(o.gradientVersion!==kn.version){var Vi=256;if(o.stepInterpolant){var li=s.getSource().maxzoom,yi=zt.canonical.z===li?Math.ceil(1<<a.transform.maxZoom-zt.canonical.z):1;Vi=p.clamp(p.nextPowerOfTwo(Jt.maxLineLength/p.EXTENT*1024*yi),256,We.maxTextureSize)}kn.gradient=p.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:Vi,image:kn.gradient||void 0,clips:Jt.lineClipsArray}),kn.texture?kn.texture.update(kn.gradient):kn.texture=new p.Texture(We,kn.gradient,st.RGBA),kn.version=o.gradientVersion,gi=kn.texture}We.activeTexture.set(st.TEXTURE0),gi.bind(o.stepInterpolant?st.NEAREST:st.LINEAR,st.CLAMP_TO_EDGE)}$r.draw(We,st.TRIANGLES,C,a.stencilModeForClipping(zt),k,Me.disabled,ki,o.id,Jt.layoutVertexBuffer,Jt.indexBuffer,Jt.segments,o.paint,a.transform.zoom,yr,Jt.layoutVertexBuffer2),je=!1}}}}},fill:function(a,s,o,h){var y=o.paint.get("fill-color"),S=o.paint.get("fill-opacity");if(0!==S.constantOr(1)){var C=a.colorModeForRenderPass(),k=o.paint.get("fill-pattern"),K=a.opaquePassEnabledForLayer()&&!k.constantOr(1)&&1===y.constantOr(p.Color.transparent).a&&1===S.constantOr(0)?"opaque":"translucent";if(a.renderPass===K){var le=a.depthModeForSublayer(1,"opaque"===a.renderPass?F.ReadWrite:F.ReadOnly);Nl(a,s,o,h,le,C,!1)}if("translucent"===a.renderPass&&o.paint.get("fill-antialias")){var Ee=a.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,F.ReadOnly);Nl(a,s,o,h,Ee,C,!0)}}},"fill-extrusion":function(a,s,o,h){var y=o.paint.get("fill-extrusion-opacity");if(0!==y&&"translucent"===a.renderPass){var S=new F(a.context.gl.LEQUAL,F.ReadWrite,a.depthRangeFor3D);if(1!==y||o.paint.get("fill-extrusion-pattern").constantOr(1))ic(a,s,o,h,S,re.disabled,ye.disabled),ic(a,s,o,h,S,a.stencilModeFor3D(),a.colorModeForRenderPass());else{var C=a.colorModeForRenderPass();ic(a,s,o,h,S,re.disabled,C)}}},hillshade:function(a,s,o,h){if("offscreen"===a.renderPass||"translucent"===a.renderPass){for(var y=a.context,S=a.depthModeForSublayer(0,F.ReadOnly),C=a.colorModeForRenderPass(),k="translucent"===a.renderPass?a.stencilConfigForOverlap(h):[{},h],K=k[0],le=0,Ee=k[1];le<Ee.length;le+=1){var Ae=Ee[le],Oe=s.getTile(Ae);Oe.needsHillshadePrepare&&"offscreen"===a.renderPass?uf(a,Oe,o,S,re.disabled,C):"translucent"===a.renderPass&&Nu(a,Oe,o,S,K[Ae.overscaledZ],C)}y.viewport.set([0,0,a.width,a.height])}},raster:function(a,s,o,h){if("translucent"===a.renderPass&&0!==o.paint.get("raster-opacity")&&h.length)for(var y=a.context,S=y.gl,C=s.getSource(),k=a.useProgram("raster"),K=a.colorModeForRenderPass(),le=C instanceof Pe?[{},h]:a.stencilConfigForOverlap(h),Ee=le[0],Ae=le[1],Oe=Ae[Ae.length-1].overscaledZ,Ke=!a.options.moving,We=0,st=Ae;We<st.length;We+=1){var je=st[We],at=a.depthModeForSublayer(je.overscaledZ-Oe,1===o.paint.get("raster-opacity")?F.ReadWrite:F.ReadOnly,S.LESS),xt=s.getTile(je),zt=a.transform.calculatePosMatrix(je.toUnwrapped(),Ke);xt.registerFadeDuration(o.paint.get("raster-fade-duration"));var or=s.findLoadedParent(je,0),Jt=Cu(xt,or,s,o,a.transform),yr=void 0,Rr=void 0,$r="nearest"===o.paint.get("raster-resampling")?S.NEAREST:S.LINEAR;y.activeTexture.set(S.TEXTURE0),xt.texture.bind($r,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),y.activeTexture.set(S.TEXTURE1),or?(or.texture.bind($r,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),yr=Math.pow(2,or.tileID.overscaledZ-xt.tileID.overscaledZ),Rr=[xt.tileID.canonical.x*yr%1,xt.tileID.canonical.y*yr%1]):xt.texture.bind($r,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST);var Xr=Hc(zt,Rr||[0,0],yr||1,Jt,o);C instanceof Pe?k.draw(y,S.TRIANGLES,at,re.disabled,K,Me.disabled,Xr,o.id,C.boundsBuffer,a.quadTriangleIndexBuffer,C.boundsSegments):k.draw(y,S.TRIANGLES,at,Ee[je.overscaledZ],K,Me.disabled,Xr,o.id,a.rasterBoundsBuffer,a.quadTriangleIndexBuffer,a.rasterBoundsSegments)}},background:function(a,s,o){var h=o.paint.get("background-color"),y=o.paint.get("background-opacity");if(0!==y){var S=a.context,C=S.gl,k=a.transform,K=k.tileSize,le=o.paint.get("background-pattern");if(!a.isPatternMissing(le)){var Ee=!le&&1===h.a&&1===y&&a.opaquePassEnabledForLayer()?"opaque":"translucent";if(a.renderPass===Ee){var Ae=re.disabled,Oe=a.depthModeForSublayer(0,"opaque"===Ee?F.ReadWrite:F.ReadOnly),Ke=a.colorModeForRenderPass(),We=a.useProgram(le?"backgroundPattern":"background"),st=k.coveringTiles({tileSize:K});le&&(S.activeTexture.set(C.TEXTURE0),a.imageManager.bind(a.context));for(var je=o.getCrossfadeParameters(),at=0,xt=st;at<xt.length;at+=1){var zt=xt[at],or=a.transform.calculatePosMatrix(zt.toUnwrapped()),Jt=le?el(or,y,a,le,{tileID:zt,tileSize:K},je):Qu(or,y,h);We.draw(S,C.TRIANGLES,Oe,Ae,Ke,Me.disabled,Jt,o.id,a.tileExtentBuffer,a.quadTriangleIndexBuffer,a.tileExtentSegments)}}}}},debug:function(a,s,o){for(var h=0;h<o.length;h++)ns(a,s,o[h])},custom:function(a,s,o){var h=a.context,y=o.implementation;if("offscreen"===a.renderPass){var S=y.prerender;S&&(a.setCustomLayerDefaults(),h.setColorMode(a.colorModeForRenderPass()),S.call(y,h.gl,a.transform.customLayerMatrix()),h.setDirty(),a.setBaseState())}else if("translucent"===a.renderPass){a.setCustomLayerDefaults(),h.setColorMode(a.colorModeForRenderPass()),h.setStencilMode(re.disabled);var C="3d"===y.renderingMode?new F(a.context.gl.LEQUAL,F.ReadWrite,a.depthRangeFor3D):a.depthModeForSublayer(0,F.ReadOnly);h.setDepthMode(C),y.render(h.gl,a.transform.customLayerMatrix()),h.setDirty(),a.setBaseState(),h.bindFramebuffer.set(null)}}},$a=function(a,s){this.context=new ce(a),this.transform=s,this._tileTextures={},this.setup(),this.numSublayers=Te.maxUnderzooming+Te.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ko,this.gpuTimers={}};$a.prototype.resize=function(a,s){if(this.width=a*p.browser.devicePixelRatio,this.height=s*p.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,h=this.style._order;o<h.length;o+=1)this.style._layers[h[o]].resize()},$a.prototype.setup=function(){var a=this.context,s=new p.StructArrayLayout2i4;s.emplaceBack(0,0),s.emplaceBack(p.EXTENT,0),s.emplaceBack(0,p.EXTENT),s.emplaceBack(p.EXTENT,p.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(s,Oa.members),this.tileExtentSegments=p.SegmentVector.simpleSegment(0,0,4,2);var o=new p.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(p.EXTENT,0),o.emplaceBack(0,p.EXTENT),o.emplaceBack(p.EXTENT,p.EXTENT),this.debugBuffer=a.createVertexBuffer(o,Oa.members),this.debugSegments=p.SegmentVector.simpleSegment(0,0,4,5);var h=new p.StructArrayLayout4i8;h.emplaceBack(0,0,0,0),h.emplaceBack(p.EXTENT,0,p.EXTENT,0),h.emplaceBack(0,p.EXTENT,0,p.EXTENT),h.emplaceBack(p.EXTENT,p.EXTENT,p.EXTENT,p.EXTENT),this.rasterBoundsBuffer=a.createVertexBuffer(h,de.members),this.rasterBoundsSegments=p.SegmentVector.simpleSegment(0,0,4,2);var y=new p.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(y,Oa.members),this.viewportSegments=p.SegmentVector.simpleSegment(0,0,4,2);var S=new p.StructArrayLayout1ui2;S.emplaceBack(0),S.emplaceBack(1),S.emplaceBack(3),S.emplaceBack(2),S.emplaceBack(0),this.tileBorderIndexBuffer=a.createIndexBuffer(S);var C=new p.StructArrayLayout3ui6;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(C),this.emptyTexture=new p.Texture(a,{width:1,height:1,data:new Uint8Array([0,0,0,0])},a.gl.RGBA);var k=this.context.gl;this.stencilClearMode=new re({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)},$a.prototype.clearStencil=function(){var a=this.context,s=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=p.create();p.ortho(o,0,this.width,this.height,0,0,1),p.scale(o,o,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(a,s.TRIANGLES,F.disabled,this.stencilClearMode,ye.disabled,Me.disabled,Rs(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},$a.prototype._renderTileClippingMasks=function(a,s){if(this.currentStencilSource!==a.source&&a.isTileClipped()&&s&&s.length){this.currentStencilSource=a.source;var o=this.context,h=o.gl;this.nextStencilID+s.length>256&&this.clearStencil(),o.setColorMode(ye.disabled),o.setDepthMode(F.disabled);var y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var S=0,C=s;S<C.length;S+=1){var k=C[S],K=this._tileClippingMaskIDs[k.key]=this.nextStencilID++;y.draw(o,h.TRIANGLES,F.disabled,new re({func:h.ALWAYS,mask:0},K,255,h.KEEP,h.KEEP,h.REPLACE),ye.disabled,Me.disabled,Rs(k.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},$a.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var a=this.nextStencilID++,s=this.context.gl;return new re({func:s.NOTEQUAL,mask:255},a,255,s.KEEP,s.KEEP,s.REPLACE)},$a.prototype.stencilModeForClipping=function(a){var s=this.context.gl;return new re({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,s.KEEP,s.KEEP,s.REPLACE)},$a.prototype.stencilConfigForOverlap=function(a){var s,o=this.context.gl,h=a.sort(function(K,le){return le.overscaledZ-K.overscaledZ}),y=h[h.length-1].overscaledZ,S=h[0].overscaledZ-y+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();for(var C={},k=0;k<S;k++)C[k+y]=new re({func:o.GEQUAL,mask:255},k+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=S,[C,h]}return[(s={},s[y]=re.disabled,s),h]},$a.prototype.colorModeForRenderPass=function(){var a=this.context.gl;return this._showOverdrawInspector?new ye([a.CONSTANT_COLOR,a.ONE],new p.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?ye.unblended:ye.alphaBlended},$a.prototype.depthModeForSublayer=function(a,s,o){if(!this.opaquePassEnabledForLayer())return F.disabled;var h=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new F(o||this.context.gl.LEQUAL,s,[h,h])},$a.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},$a.prototype.render=function(a,s){var o=this;this.style=a,this.options=s,this.lineAtlas=a.lineAtlas,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(p.browser.now()),this.imageManager.beginFrame();var h=this.style._order,y=this.style.sourceCaches;for(var S in y){var C=y[S];C.used&&C.prepare(this.context)}var k,K,le={},Ee={},Ae={};for(var Oe in y){var Ke=y[Oe];le[Oe]=Ke.getVisibleCoordinates(),Ee[Oe]=le[Oe].slice().reverse(),Ae[Oe]=Ke.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var We=0;We<h.length;We++)if(this.style._layers[h[We]].is3D()){this.opaquePassCutoff=We;break}this.renderPass="offscreen";for(var st=0,je=h;st<je.length;st+=1){var at=this.style._layers[je[st]];if(at.hasOffscreenPass()&&!at.isHidden(this.transform.zoom)){var xt=Ee[at.source];("custom"===at.type||xt.length)&&this.renderLayer(this,y[at.source],at,xt)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?p.Color.black:p.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(a._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=h.length-1;this.currentLayer>=0;this.currentLayer--){var zt=this.style._layers[h[this.currentLayer]],or=y[zt.source],Jt=le[zt.source];this._renderTileClippingMasks(zt,Jt),this.renderLayer(this,or,zt,Jt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<h.length;this.currentLayer++){var yr=this.style._layers[h[this.currentLayer]],Rr=y[yr.source],$r=("symbol"===yr.type?Ae:Ee)[yr.source];this._renderTileClippingMasks(yr,le[yr.source]),this.renderLayer(this,Rr,yr,$r)}this.options.showTileBoundaries&&(p.values(this.style._layers).forEach(function(Xr){Xr.source&&!Xr.isHidden(o.transform.zoom)&&(Xr.source!==(K&&K.id)&&(K=o.style.sourceCaches[Xr.source]),(!k||k.getSource().maxzoom<K.getSource().maxzoom)&&(k=K))}),k&&rl.debug(this,k,k.getVisibleCoordinates())),this.options.showPadding&&function(Xr){var pn=Xr.transform.padding;ac(Xr,Xr.transform.height-(pn.top||0),3,zu),ac(Xr,pn.bottom||0,3,nu),oc(Xr,pn.left||0,3,Au),oc(Xr,Xr.transform.width-(pn.right||0),3,js);var Un,Rn,ki,kn,qn=Xr.transform.centerPoint;Zu(Un=Xr,(Rn=qn.x)-1,(ki=Xr.transform.height-qn.y)-10,2,20,kn=zl),Zu(Un,Rn-10,ki-1,20,2,kn)}(this),this.context.setDefault()},$a.prototype.renderLayer=function(a,s,o,h){o.isHidden(this.transform.zoom)||("background"===o.type||"custom"===o.type||h.length)&&(this.id=o.id,this.gpuTimingStart(o),rl[o.type](a,s,o,h,this.style.placement.variableOffsets),this.gpuTimingEnd())},$a.prototype.gpuTimingStart=function(a){if(this.options.gpuTiming){var s=this.context.extTimerQuery,o=this.gpuTimers[a.id];o||(o=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:s.createQueryEXT()}),o.calls++,s.beginQueryEXT(s.TIME_ELAPSED_EXT,o.query)}},$a.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}},$a.prototype.collectGpuTimers=function(){var a=this.gpuTimers;return this.gpuTimers={},a},$a.prototype.queryGpuTimers=function(a){var s={};for(var o in a){var h=a[o],y=this.context.extTimerQuery,S=y.getQueryObjectEXT(h.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(h.query),s[o]=S}return s},$a.prototype.translatePosMatrix=function(a,s,o,h,y){if(!o[0]&&!o[1])return a;var S=y?"map"===h?this.transform.angle:0:"viewport"===h?-this.transform.angle:0;if(S){var C=Math.sin(S),k=Math.cos(S);o=[o[0]*k-o[1]*C,o[0]*C+o[1]*k]}var K=[y?o[0]:ma(s,o[0],this.transform.zoom),y?o[1]:ma(s,o[1],this.transform.zoom),0],le=new Float32Array(16);return p.translate(le,a,K),le},$a.prototype.saveTileTexture=function(a){var s=this._tileTextures[a.size[0]];s?s.push(a):this._tileTextures[a.size[0]]=[a]},$a.prototype.getTileTexture=function(a){var s=this._tileTextures[a];return s&&s.length>0?s.pop():null},$a.prototype.isPatternMissing=function(a){if(!a)return!1;if(!a.from||!a.to)return!0;var s=this.imageManager.getPattern(a.from.toString()),o=this.imageManager.getPattern(a.to.toString());return!s||!o},$a.prototype.useProgram=function(a,s){this.cache=this.cache||{};var o=""+a+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new Ec(this.context,a,Xo[a],s,dl[a],this._showOverdrawInspector)),this.cache[o]},$a.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},$a.prototype.setBaseState=function(){var a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)},$a.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=p.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new p.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},$a.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Zl=function(a,s){this.points=a,this.planes=s};Zl.fromInvProjectionMatrix=function(a,s,o){var h=Math.pow(2,o),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(C){return p.transformMat4([],C,a)}).map(function(C){return p.scale$1([],C,1/C[3]/s*h)}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(C){var k=p.sub([],y[C[0]],y[C[1]]),K=p.sub([],y[C[2]],y[C[1]]),le=p.normalize([],p.cross([],k,K)),Ee=-p.dot(le,y[C[1]]);return le.concat(Ee)});return new Zl(y,S)};var Gs=function(a,s){this.min=a,this.max=s,this.center=p.scale$2([],p.add([],this.min,this.max),.5)};Gs.prototype.quadrant=function(a){for(var s=[a%2==0,a<2],o=p.clone$2(this.min),h=p.clone$2(this.max),y=0;y<s.length;y++)o[y]=s[y]?this.min[y]:this.center[y],h[y]=s[y]?this.center[y]:this.max[y];return h[2]=this.max[2],new Gs(o,h)},Gs.prototype.distanceX=function(a){return Math.max(Math.min(this.max[0],a[0]),this.min[0])-a[0]},Gs.prototype.distanceY=function(a){return Math.max(Math.min(this.max[1],a[1]),this.min[1])-a[1]},Gs.prototype.intersects=function(a){for(var s=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,h=0;h<a.planes.length;h++){for(var y=a.planes[h],S=0,C=0;C<s.length;C++)S+=p.dot$1(y,s[C])>=0;if(0===S)return 0;S!==s.length&&(o=!1)}if(o)return 2;for(var k=0;k<3;k++){for(var K=Number.MAX_VALUE,le=-Number.MAX_VALUE,Ee=0;Ee<a.points.length;Ee++){var Ae=a.points[Ee][k]-this.min[k];K=Math.min(K,Ae),le=Math.max(le,Ae)}if(le<0||K>this.max[k]-this.min[k])return 0}return 1};var Pu=function(a,s,o,h){if(void 0===a&&(a=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===h&&(h=0),isNaN(a)||a<0||isNaN(s)||s<0||isNaN(o)||o<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=s,this.left=o,this.right=h};Pu.prototype.interpolate=function(a,s,o){return null!=s.top&&null!=a.top&&(this.top=p.number(a.top,s.top,o)),null!=s.bottom&&null!=a.bottom&&(this.bottom=p.number(a.bottom,s.bottom,o)),null!=s.left&&null!=a.left&&(this.left=p.number(a.left,s.left,o)),null!=s.right&&null!=a.right&&(this.right=p.number(a.right,s.right,o)),this},Pu.prototype.getCenter=function(a,s){var o=p.clamp((this.left+a-this.right)/2,0,a),h=p.clamp((this.top+s-this.bottom)/2,0,s);return new p.Point(o,h)},Pu.prototype.equals=function(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right},Pu.prototype.clone=function(){return new Pu(this.top,this.bottom,this.left,this.right)},Pu.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var sa=function(a,s,o,h,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===y||y,this._minZoom=a||0,this._maxZoom=s||22,this._minPitch=null==o?0:o,this._maxPitch=null==h?60:h,this.setMaxBounds(),this.width=0,this.height=0,this._center=new p.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Pu,this._posMatrixCache={},this._alignedPosMatrixCache={}},ja={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};sa.prototype.clone=function(){var a=new sa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return a.tileSize=this.tileSize,a.latRange=this.latRange,a.width=this.width,a.height=this.height,a._center=this._center,a.zoom=this.zoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._calcMatrices(),a},ja.minZoom.get=function(){return this._minZoom},ja.minZoom.set=function(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))},ja.maxZoom.get=function(){return this._maxZoom},ja.maxZoom.set=function(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))},ja.minPitch.get=function(){return this._minPitch},ja.minPitch.set=function(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))},ja.maxPitch.get=function(){return this._maxPitch},ja.maxPitch.set=function(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))},ja.renderWorldCopies.get=function(){return this._renderWorldCopies},ja.renderWorldCopies.set=function(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a},ja.worldSize.get=function(){return this.tileSize*this.scale},ja.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ja.size.get=function(){return new p.Point(this.width,this.height)},ja.bearing.get=function(){return-this.angle/Math.PI*180},ja.bearing.set=function(a){var s=-p.wrap(a,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=p.create$2(),p.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ja.pitch.get=function(){return this._pitch/Math.PI*180},ja.pitch.set=function(a){var s=p.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())},ja.fov.get=function(){return this._fov/Math.PI*180},ja.fov.set=function(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=a/180*Math.PI,this._calcMatrices())},ja.zoom.get=function(){return this._zoom},ja.zoom.set=function(a){var s=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom,this._constrain(),this._calcMatrices())},ja.center.get=function(){return this._center},ja.center.set=function(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._constrain(),this._calcMatrices())},ja.padding.get=function(){return this._edgeInsets.toJSON()},ja.padding.set=function(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())},ja.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},sa.prototype.isPaddingEqual=function(a){return this._edgeInsets.equals(a)},sa.prototype.interpolatePadding=function(a,s,o){this._unmodified=!1,this._edgeInsets.interpolate(a,s,o),this._constrain(),this._calcMatrices()},sa.prototype.coveringZoomLevel=function(a){var s=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,s)},sa.prototype.getVisibleUnwrappedCoordinates=function(a){var s=[new p.UnwrappedTileID(0,a)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new p.Point(0,0)),h=this.pointCoordinate(new p.Point(this.width,0)),y=this.pointCoordinate(new p.Point(this.width,this.height)),S=this.pointCoordinate(new p.Point(0,this.height)),C=Math.floor(Math.min(o.x,h.x,y.x,S.x)),k=Math.floor(Math.max(o.x,h.x,y.x,S.x)),K=C-1;K<=k+1;K++)0!==K&&s.push(new p.UnwrappedTileID(K,a));return s},sa.prototype.coveringTiles=function(a){var s=this.coveringZoomLevel(a),o=s;if(void 0!==a.minzoom&&s<a.minzoom)return[];void 0!==a.maxzoom&&s>a.maxzoom&&(s=a.maxzoom);var h=p.MercatorCoordinate.fromLngLat(this.center),y=Math.pow(2,s),S=[y*h.x,y*h.y,0],C=Zl.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s),k=a.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(k=s);var K=function(Xr){return{aabb:new Gs([Xr*y,0,0],[(Xr+1)*y,y,0]),zoom:0,x:0,y:0,wrap:Xr,fullyVisible:!1}},le=[],Ee=[],Ae=s,Oe=a.reparseOverscaled?o:s;if(this._renderWorldCopies)for(var Ke=1;Ke<=3;Ke++)le.push(K(-Ke)),le.push(K(Ke));for(le.push(K(0));le.length>0;){var We=le.pop(),st=We.x,je=We.y,at=We.fullyVisible;if(!at){var xt=We.aabb.intersects(C);if(0===xt)continue;at=2===xt}var zt=We.aabb.distanceX(S),or=We.aabb.distanceY(S),Jt=Math.max(Math.abs(zt),Math.abs(or));if(We.zoom===Ae||Jt>3+(1<<Ae-We.zoom)-2&&We.zoom>=k)Ee.push({tileID:new p.OverscaledTileID(We.zoom===Ae?Oe:We.zoom,We.wrap,We.zoom,st,je),distanceSq:p.sqrLen([S[0]-.5-st,S[1]-.5-je])});else for(var yr=0;yr<4;yr++){var Rr=(st<<1)+yr%2,$r=(je<<1)+(yr>>1);le.push({aabb:We.aabb.quadrant(yr),zoom:We.zoom+1,x:Rr,y:$r,wrap:We.wrap,fullyVisible:at})}}return Ee.sort(function(Xr,pn){return Xr.distanceSq-pn.distanceSq}).map(function(Xr){return Xr.tileID})},sa.prototype.resize=function(a,s){this.width=a,this.height=s,this.pixelsToGLUnits=[2/a,-2/s],this._constrain(),this._calcMatrices()},ja.unmodified.get=function(){return this._unmodified},sa.prototype.zoomScale=function(a){return Math.pow(2,a)},sa.prototype.scaleZoom=function(a){return Math.log(a)/Math.LN2},sa.prototype.project=function(a){var s=p.clamp(a.lat,-this.maxValidLatitude,this.maxValidLatitude);return new p.Point(p.mercatorXfromLng(a.lng)*this.worldSize,p.mercatorYfromLat(s)*this.worldSize)},sa.prototype.unproject=function(a){return new p.MercatorCoordinate(a.x/this.worldSize,a.y/this.worldSize).toLngLat()},ja.point.get=function(){return this.project(this.center)},sa.prototype.setLocationAtPoint=function(a,s){var o=this.pointCoordinate(s),h=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(a),S=new p.MercatorCoordinate(y.x-(o.x-h.x),y.y-(o.y-h.y));this.center=this.coordinateLocation(S),this._renderWorldCopies&&(this.center=this.center.wrap())},sa.prototype.locationPoint=function(a){return this.coordinatePoint(this.locationCoordinate(a))},sa.prototype.pointLocation=function(a){return this.coordinateLocation(this.pointCoordinate(a))},sa.prototype.locationCoordinate=function(a){return p.MercatorCoordinate.fromLngLat(a)},sa.prototype.coordinateLocation=function(a){return a.toLngLat()},sa.prototype.pointCoordinate=function(a){var s=[a.x,a.y,0,1],o=[a.x,a.y,1,1];p.transformMat4(s,s,this.pixelMatrixInverse),p.transformMat4(o,o,this.pixelMatrixInverse);var h=s[3],y=o[3],S=s[1]/h,C=o[1]/y,k=s[2]/h,K=o[2]/y,le=k===K?0:(0-k)/(K-k);return new p.MercatorCoordinate(p.number(s[0]/h,o[0]/y,le)/this.worldSize,p.number(S,C,le)/this.worldSize)},sa.prototype.coordinatePoint=function(a){var s=[a.x*this.worldSize,a.y*this.worldSize,0,1];return p.transformMat4(s,s,this.pixelMatrix),new p.Point(s[0]/s[3],s[1]/s[3])},sa.prototype.getBounds=function(){return(new p.LngLatBounds).extend(this.pointLocation(new p.Point(0,0))).extend(this.pointLocation(new p.Point(this.width,0))).extend(this.pointLocation(new p.Point(this.width,this.height))).extend(this.pointLocation(new p.Point(0,this.height)))},sa.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new p.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},sa.prototype.setMaxBounds=function(a){a?(this.lngRange=[a.getWest(),a.getEast()],this.latRange=[a.getSouth(),a.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},sa.prototype.calculatePosMatrix=function(a,s){void 0===s&&(s=!1);var o=a.key,h=s?this._alignedPosMatrixCache:this._posMatrixCache;if(h[o])return h[o];var y=a.canonical,S=this.worldSize/this.zoomScale(y.z),C=y.x+Math.pow(2,y.z)*a.wrap,k=p.identity(new Float64Array(16));return p.translate(k,k,[C*S,y.y*S,0]),p.scale(k,k,[S/p.EXTENT,S/p.EXTENT,1]),p.multiply(k,s?this.alignedProjMatrix:this.projMatrix,k),h[o]=new Float32Array(k),h[o]},sa.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},sa.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var a,s,o,h,y=-90,S=90,C=-180,k=180,K=this.size,le=this._unmodified;if(this.latRange){var Ee=this.latRange;y=p.mercatorYfromLat(Ee[1])*this.worldSize,a=(S=p.mercatorYfromLat(Ee[0])*this.worldSize)-y<K.y?K.y/(S-y):0}if(this.lngRange){var Ae=this.lngRange;C=p.mercatorXfromLng(Ae[0])*this.worldSize,s=(k=p.mercatorXfromLng(Ae[1])*this.worldSize)-C<K.x?K.x/(k-C):0}var Oe=this.point,Ke=Math.max(s||0,a||0);if(Ke)return this.center=this.unproject(new p.Point(s?(k+C)/2:Oe.x,a?(S+y)/2:Oe.y)),this.zoom+=this.scaleZoom(Ke),this._unmodified=le,void(this._constraining=!1);if(this.latRange){var We=Oe.y,st=K.y/2;We-st<y&&(h=y+st),We+st>S&&(h=S-st)}if(this.lngRange){var je=Oe.x,at=K.x/2;je-at<C&&(o=C+at),je+at>k&&(o=k-at)}void 0===o&&void 0===h||(this.center=this.unproject(new p.Point(void 0!==o?o:Oe.x,void 0!==h?h:Oe.y))),this._unmodified=le,this._constraining=!1}},sa.prototype._calcMatrices=function(){if(this.height){var a=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var s=Math.PI/2+this._pitch,o=this._fov*(.5+a.y/this.height),h=Math.sin(o)*this.cameraToCenterDistance/Math.sin(p.clamp(Math.PI-s-o,.01,Math.PI-.01)),y=this.point,S=y.x,C=y.y,k=1.01*(Math.cos(Math.PI/2-this._pitch)*h+this.cameraToCenterDistance),K=this.height/50,le=new Float64Array(16);p.perspective(le,this._fov,this.width/this.height,K,k),le[8]=2*-a.x/this.width,le[9]=2*a.y/this.height,p.scale(le,le,[1,-1,1]),p.translate(le,le,[0,0,-this.cameraToCenterDistance]),p.rotateX(le,le,this._pitch),p.rotateZ(le,le,this.angle),p.translate(le,le,[-S,-C,0]),this.mercatorMatrix=p.scale([],le,[this.worldSize,this.worldSize,this.worldSize]),p.scale(le,le,[1,1,p.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=le,this.invProjMatrix=p.invert([],this.projMatrix);var Ee=this.width%2/2,Ae=this.height%2/2,Oe=Math.cos(this.angle),Ke=Math.sin(this.angle),We=S-Math.round(S)+Oe*Ee+Ke*Ae,st=C-Math.round(C)+Oe*Ae+Ke*Ee,je=new Float64Array(le);if(p.translate(je,je,[We>.5?We-1:We,st>.5?st-1:st,0]),this.alignedProjMatrix=je,le=p.create(),p.scale(le,le,[this.width/2,-this.height/2,1]),p.translate(le,le,[1,-1,0]),this.labelPlaneMatrix=le,le=p.create(),p.scale(le,le,[1,-1,1]),p.translate(le,le,[-1,-1,0]),p.scale(le,le,[2/this.width,2/this.height,1]),this.glCoordMatrix=le,this.pixelMatrix=p.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(le=p.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=le,this._posMatrixCache={},this._alignedPosMatrixCache={}}},sa.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var a=this.pointCoordinate(new p.Point(0,0)),s=[a.x*this.worldSize,a.y*this.worldSize,0,1];return p.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance},sa.prototype.getCameraPoint=function(){var a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new p.Point(0,a))},sa.prototype.getCameraQueryGeometry=function(a){var s=this.getCameraPoint();if(1===a.length)return[a[0],s];for(var o=s.x,h=s.y,y=s.x,S=s.y,C=0,k=a;C<k.length;C+=1){var K=k[C];o=Math.min(o,K.x),h=Math.min(h,K.y),y=Math.max(y,K.x),S=Math.max(S,K.y)}return[new p.Point(o,h),new p.Point(y,h),new p.Point(y,S),new p.Point(o,S),new p.Point(o,h)]},Object.defineProperties(sa.prototype,ja);var Ss=function(a){var s,o,h,y;this._hashName=a&&encodeURIComponent(a),p.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(s=this._updateHashUnthrottled.bind(this),o=!1,h=null,y=function(){h=null,o&&(s(),h=setTimeout(y,300),o=!1)},function(){return o=!0,h||y(),h})};Ss.prototype.addTo=function(a){return this._map=a,p.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Ss.prototype.remove=function(){return p.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Ss.prototype.getHashString=function(a){var s=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,h=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,h),S=Math.round(s.lng*y)/y,C=Math.round(s.lat*y)/y,k=this._map.getBearing(),K=this._map.getPitch(),le="";if(le+=a?"/"+S+"/"+C+"/"+o:o+"/"+C+"/"+S,(k||K)&&(le+="/"+Math.round(10*k)/10),K&&(le+="/"+Math.round(K)),this._hashName){var Ee=this._hashName,Ae=!1,Oe=p.window.location.hash.slice(1).split("&").map(function(Ke){var We=Ke.split("=")[0];return We===Ee?(Ae=!0,We+"="+le):Ke}).filter(function(Ke){return Ke});return Ae||Oe.push(Ee+"="+le),"#"+Oe.join("&")}return"#"+le},Ss.prototype._getCurrentHash=function(){var a,s=this,o=p.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(h){return h.split("=")}).forEach(function(h){h[0]===s._hashName&&(a=h)}),(a&&a[1]||"").split("/")):o.split("/")},Ss.prototype._onHashChange=function(){var a=this._getCurrentHash();if(a.length>=3&&!a.some(function(o){return isNaN(o)})){var s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:s,pitch:+(a[4]||0)}),!0}return!1},Ss.prototype._updateHashUnthrottled=function(){var a=p.window.location.href.replace(/(#.+)?$/,this.getHashString());try{p.window.history.replaceState(p.window.history.state,null,a)}catch(s){}};var Ul={linearity:.3,easing:p.bezier(0,0,.3,1)},Uu=p.extend({deceleration:2500,maxSpeed:1400},Ul),Ic=p.extend({deceleration:20,maxSpeed:1400},Ul),Ta=p.extend({deceleration:1e3,maxSpeed:360},Ul),lf=p.extend({deceleration:1e3,maxSpeed:90},Ul),Vl=function(a){this._map=a,this.clear()};function ml(a,s){(!a.duration||a.duration<s.duration)&&(a.duration=s.duration,a.easing=s.easing)}function _u(a,s,o){var h=o.maxSpeed,y=o.linearity,S=o.deceleration,C=p.clamp(a*y/(s/1e3),-h,h),k=Math.abs(C)/(S*y);return{easing:o.easing,duration:1e3*k,amount:C*(k/2)}}Vl.prototype.clear=function(){this._inertiaBuffer=[]},Vl.prototype.record=function(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:p.browser.now(),settings:a})},Vl.prototype._drainInertiaBuffer=function(){for(var a=this._inertiaBuffer,s=p.browser.now();a.length>0&&s-a[0].time>160;)a.shift()},Vl.prototype._onMoveEnd=function(a){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var s={zoom:0,bearing:0,pitch:0,pan:new p.Point(0,0),pinchAround:void 0,around:void 0},o=0,h=this._inertiaBuffer;o<h.length;o+=1){var y=h[o].settings;s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround)}var S=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(s.pan.mag()){var k=_u(s.pan.mag(),S,p.extend({},Uu,a||{}));C.offset=s.pan.mult(k.amount/s.pan.mag()),C.center=this._map.transform.center,ml(C,k)}if(s.zoom){var K=_u(s.zoom,S,Ic);C.zoom=this._map.transform.zoom+K.amount,ml(C,K)}if(s.bearing){var le=_u(s.bearing,S,Ta);C.bearing=this._map.transform.bearing+p.clamp(le.amount,-179,179),ml(C,le)}if(s.pitch){var Ee=_u(s.pitch,S,lf);C.pitch=this._map.transform.pitch+Ee.amount,ml(C,Ee)}if(C.zoom||C.bearing){var Ae=void 0===s.pinchAround?s.around:s.pinchAround;C.around=Ae?this._map.unproject(Ae):this._map.getCenter()}return this.clear(),p.extend(C,{noMoveStart:!0})}};var wo=function(a){function s(h,y,S,C){void 0===C&&(C={});var k=W.mousePos(y.getCanvasContainer(),S),K=y.unproject(k);a.call(this,h,p.extend({point:k,lngLat:K,originalEvent:S},C)),this._defaultPrevented=!1,this.target=y}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(p.Event),gl=function(a){function s(h,y,S){var C="touchend"===h?S.changedTouches:S.touches,k=W.touchPos(y.getCanvasContainer(),C),K=k.map(function(Ae){return y.unproject(Ae)}),le=k.reduce(function(Ae,Oe,Ke,We){return Ae.add(Oe.div(We.length))},new p.Point(0,0)),Ee=y.unproject(le);a.call(this,h,{points:k,point:le,lngLats:K,lngLat:Ee,originalEvent:S}),this._defaultPrevented=!1}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(p.Event),yl=function(a){function s(h,y,S){a.call(this,h,{originalEvent:S}),this._defaultPrevented=!1}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={defaultPrevented:{configurable:!0}};return s.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(s.prototype,o),s}(p.Event),Ro=function(a,s){this._map=a,this._clickTolerance=s.clickTolerance};Ro.prototype.reset=function(){delete this._mousedownPos},Ro.prototype.wheel=function(a){return this._firePreventable(new yl(a.type,this._map,a))},Ro.prototype.mousedown=function(a,s){return this._mousedownPos=s,this._firePreventable(new wo(a.type,this._map,a))},Ro.prototype.mouseup=function(a){this._map.fire(new wo(a.type,this._map,a))},Ro.prototype.click=function(a,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new wo(a.type,this._map,a))},Ro.prototype.dblclick=function(a){return this._firePreventable(new wo(a.type,this._map,a))},Ro.prototype.mouseover=function(a){this._map.fire(new wo(a.type,this._map,a))},Ro.prototype.mouseout=function(a){this._map.fire(new wo(a.type,this._map,a))},Ro.prototype.touchstart=function(a){return this._firePreventable(new gl(a.type,this._map,a))},Ro.prototype.touchmove=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype.touchend=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype.touchcancel=function(a){this._map.fire(new gl(a.type,this._map,a))},Ro.prototype._firePreventable=function(a){if(this._map.fire(a),a.defaultPrevented)return{}},Ro.prototype.isEnabled=function(){return!0},Ro.prototype.isActive=function(){return!1},Ro.prototype.enable=function(){},Ro.prototype.disable=function(){};var Bn=function(a){this._map=a};Bn.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Bn.prototype.mousemove=function(a){this._map.fire(new wo(a.type,this._map,a))},Bn.prototype.mousedown=function(){this._delayContextMenu=!0},Bn.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Bn.prototype.contextmenu=function(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new wo(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()},Bn.prototype.isEnabled=function(){return!0},Bn.prototype.isActive=function(){return!1},Bn.prototype.enable=function(){},Bn.prototype.disable=function(){};var za=function(a,s){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=s.clickTolerance||1};function Vu(a,s){for(var o={},h=0;h<a.length;h++)o[a[h].identifier]=s[h];return o}za.prototype.isEnabled=function(){return!!this._enabled},za.prototype.isActive=function(){return!!this._active},za.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},za.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},za.prototype.mousedown=function(a,s){this.isEnabled()&&a.shiftKey&&0===a.button&&(W.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)},za.prototype.mousemoveWindow=function(a,s){if(this._active){var o=s;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var h=this._startPos;this._lastPos=o,this._box||(this._box=W.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));var y=Math.min(h.x,o.x),S=Math.max(h.x,o.x),C=Math.min(h.y,o.y),k=Math.max(h.y,o.y);W.setTransform(this._box,"translate("+y+"px,"+C+"px)"),this._box.style.width=S-y+"px",this._box.style.height=k-C+"px"}}},za.prototype.mouseupWindow=function(a,s){var o=this;if(this._active&&0===a.button){var h=this._startPos,y=s;if(this.reset(),W.suppressClick(),h.x!==y.x||h.y!==y.y)return this._map.fire(new p.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:function(S){return S.fitScreenCoordinates(h,y,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",a)}},za.prototype.keydown=function(a){this._active&&27===a.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",a))},za.prototype.blur=function(){this.reset()},za.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(W.remove(this._box),this._box=null),W.enableDrag(),delete this._startPos,delete this._lastPos},za.prototype._fireEvent=function(a,s){return this._map.fire(new p.Event(a,{originalEvent:s}))};var _l=function(a){this.reset(),this.numTouches=a.numTouches};_l.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},_l.prototype.touchstart=function(a,s,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=a.timeStamp),o.length===this.numTouches&&(this.centroid=function(h){for(var y=new p.Point(0,0),S=0,C=h;S<C.length;S+=1)y._add(C[S]);return y.div(h.length)}(s),this.touches=Vu(o,s)))},_l.prototype.touchmove=function(a,s,o){if(!this.aborted&&this.centroid){var h=Vu(o,s);for(var y in this.touches){var S=h[y];(!S||S.dist(this.touches[y])>30)&&(this.aborted=!0)}}},_l.prototype.touchend=function(a,s,o){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),0===o.length){var h=!this.aborted&&this.centroid;if(this.reset(),h)return h}};var iu=function(a){this.singleTap=new _l(a),this.numTaps=a.numTaps,this.reset()};iu.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},iu.prototype.touchstart=function(a,s,o){this.singleTap.touchstart(a,s,o)},iu.prototype.touchmove=function(a,s,o){this.singleTap.touchmove(a,s,o)},iu.prototype.touchend=function(a,s,o){var h=this.singleTap.touchend(a,s,o);if(h){var y=a.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(h)<30;if(y&&S||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}};var Es=function(){this._zoomIn=new iu({numTouches:1,numTaps:2}),this._zoomOut=new iu({numTouches:2,numTaps:1}),this.reset()};Es.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Es.prototype.touchstart=function(a,s,o){this._zoomIn.touchstart(a,s,o),this._zoomOut.touchstart(a,s,o)},Es.prototype.touchmove=function(a,s,o){this._zoomIn.touchmove(a,s,o),this._zoomOut.touchmove(a,s,o)},Es.prototype.touchend=function(a,s,o){var h=this,y=this._zoomIn.touchend(a,s,o),S=this._zoomOut.touchend(a,s,o);return y?(this._active=!0,a.preventDefault(),setTimeout(function(){return h.reset()},0),{cameraAnimation:function(C){return C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(y)},{originalEvent:a})}}):S?(this._active=!0,a.preventDefault(),setTimeout(function(){return h.reset()},0),{cameraAnimation:function(C){return C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(S)},{originalEvent:a})}}):void 0},Es.prototype.touchcancel=function(){this.reset()},Es.prototype.enable=function(){this._enabled=!0},Es.prototype.disable=function(){this._enabled=!1,this.reset()},Es.prototype.isEnabled=function(){return this._enabled},Es.prototype.isActive=function(){return this._active};var Xc={0:1,2:2},cn=function(a){this.reset(),this._clickTolerance=a.clickTolerance||1};cn.prototype.blur=function(){this.reset()},cn.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},cn.prototype._correctButton=function(a,s){return!1},cn.prototype._move=function(a,s){return{}},cn.prototype.mousedown=function(a,s){if(!this._lastPoint){var o=W.mouseButton(a);this._correctButton(a,o)&&(this._lastPoint=s,this._eventButton=o)}},cn.prototype.mousemoveWindow=function(a,s){var h,S,o=this._lastPoint;if(o)if(a.preventDefault(),S=Xc[this._eventButton],void 0===(h=a).buttons||(h.buttons&S)!==S)this.reset();else if(this._moved||!(s.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(o,s)},cn.prototype.mouseupWindow=function(a){this._lastPoint&&W.mouseButton(a)===this._eventButton&&(this._moved&&W.suppressClick(),this.reset())},cn.prototype.enable=function(){this._enabled=!0},cn.prototype.disable=function(){this._enabled=!1,this.reset()},cn.prototype.isEnabled=function(){return this._enabled},cn.prototype.isActive=function(){return this._active};var Yc=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.mousedown=function(o,h){a.prototype.mousedown.call(this,o,h),this._lastPoint&&(this._active=!0)},s.prototype._correctButton=function(o,h){return 0===h&&!o.ctrlKey},s.prototype._move=function(o,h){return{around:h,panDelta:h.sub(o)}},s}(cn),Oc=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype._correctButton=function(o,h){return 0===h&&o.ctrlKey||2===h},s.prototype._move=function(o,h){var y=.8*(h.x-o.x);if(y)return this._active=!0,{bearingDelta:y}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(cn),xl=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype._correctButton=function(o,h){return 0===h&&o.ctrlKey||2===h},s.prototype._move=function(o,h){var y=-.5*(h.y-o.y);if(y)return this._active=!0,{pitchDelta:y}},s.prototype.contextmenu=function(o){o.preventDefault()},s}(cn),Ga=function(a){this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset()};Ga.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new p.Point(0,0)},Ga.prototype.touchstart=function(a,s,o){return this._calculateTransform(a,s,o)},Ga.prototype.touchmove=function(a,s,o){if(this._active&&!(o.length<this._minTouches))return a.preventDefault(),this._calculateTransform(a,s,o)},Ga.prototype.touchend=function(a,s,o){this._calculateTransform(a,s,o),this._active&&o.length<this._minTouches&&this.reset()},Ga.prototype.touchcancel=function(){this.reset()},Ga.prototype._calculateTransform=function(a,s,o){o.length>0&&(this._active=!0);var h=Vu(o,s),y=new p.Point(0,0),S=new p.Point(0,0),C=0;for(var k in h){var K=h[k],le=this._touches[k];le&&(y._add(K),S._add(K.sub(le)),C++,h[k]=K)}if(this._touches=h,!(C<this._minTouches)&&S.mag()){var Ee=S.div(C);if(this._sum._add(Ee),!(this._sum.mag()<this._clickTolerance))return{around:y.div(C),panDelta:Ee}}},Ga.prototype.enable=function(){this._enabled=!0},Ga.prototype.disable=function(){this._enabled=!1,this.reset()},Ga.prototype.isEnabled=function(){return this._enabled},Ga.prototype.isActive=function(){return this._active};var Ts=function(){this.reset()};function sc(a,s,o){for(var h=0;h<a.length;h++)if(a[h].identifier===o)return s[h]}function au(a,s){return Math.log(a/s)/Math.LN2}Ts.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ts.prototype._start=function(a){},Ts.prototype._move=function(a,s,o){return{}},Ts.prototype.touchstart=function(a,s,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([s[0],s[1]]))},Ts.prototype.touchmove=function(a,s,o){if(this._firstTwoTouches){a.preventDefault();var h=this._firstTwoTouches,y=h[1],S=sc(o,s,h[0]),C=sc(o,s,y);if(S&&C){var k=this._aroundCenter?null:S.add(C).div(2);return this._move([S,C],k,a)}}},Ts.prototype.touchend=function(a,s,o){if(this._firstTwoTouches){var h=this._firstTwoTouches,y=h[1],S=sc(o,s,h[0]),C=sc(o,s,y);S&&C||(this._active&&W.suppressClick(),this.reset())}},Ts.prototype.touchcancel=function(){this.reset()},Ts.prototype.enable=function(a){this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around},Ts.prototype.disable=function(){this._enabled=!1,this.reset()},Ts.prototype.isEnabled=function(){return this._enabled},Ts.prototype.isActive=function(){return this._active};var Ds=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),delete this._distance,delete this._startDistance},s.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},s.prototype._move=function(o,h){var y=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(au(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:au(this._distance,y),pinchAround:h}},s}(Ts);function Hs(a,s){return 180*a.angleWith(s)/Math.PI}var Tf=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},s.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},s.prototype._move=function(o,h){var y=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Hs(this._vector,y),pinchAround:h}},s.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var h=25/(Math.PI*this._minDiameter)*360,y=Hs(o,this._startVector);return Math.abs(y)<h},s}(Ts);function uc(a){return Math.abs(a.y)>Math.abs(a.x)}var cf=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.reset=function(){a.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},s.prototype._start=function(o){this._lastPoints=o,uc(o[0].sub(o[1]))&&(this._valid=!1)},s.prototype._move=function(o,h,y){var S=o[0].sub(this._lastPoints[0]),C=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(S,C,y.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(S.y+C.y)/2*-.5}},s.prototype.gestureBeginsVertically=function(o,h,y){if(void 0!==this._valid)return this._valid;var S=o.mag()>=2,C=h.mag()>=2;if(S||C){if(!S||!C)return void 0===this._firstMove&&(this._firstMove=y),y-this._firstMove<100&&void 0;var k=o.y>0==h.y>0;return uc(o)&&uc(h)&&k}},s}(Ts),kc={panStep:100,bearingStep:15,pitchStep:10},Ws=function(){var a=kc;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1};function Cs(a){return a*(2-a)}Ws.prototype.blur=function(){this.reset()},Ws.prototype.reset=function(){this._active=!1},Ws.prototype.keydown=function(a){var s=this;if(!(a.altKey||a.ctrlKey||a.metaKey)){var o=0,h=0,y=0,S=0,C=0;switch(a.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:a.shiftKey?h=-1:(a.preventDefault(),S=-1);break;case 39:a.shiftKey?h=1:(a.preventDefault(),S=1);break;case 38:a.shiftKey?y=1:(a.preventDefault(),C=-1);break;case 40:a.shiftKey?y=-1:(a.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(h=0,y=0),{cameraAnimation:function(k){var K=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:Cs,zoom:o?Math.round(K)+o*(a.shiftKey?2:1):K,bearing:k.getBearing()+h*s._bearingStep,pitch:k.getPitch()+y*s._pitchStep,offset:[-S*s._panStep,-C*s._panStep],center:k.getCenter()},{originalEvent:a})}}}},Ws.prototype.enable=function(){this._enabled=!0},Ws.prototype.disable=function(){this._enabled=!1,this.reset()},Ws.prototype.isEnabled=function(){return this._enabled},Ws.prototype.isActive=function(){return this._active},Ws.prototype.disableRotation=function(){this._rotationDisabled=!0},Ws.prototype.enableRotation=function(){this._rotationDisabled=!1};var $i=function(a,s){this._map=a,this._el=a.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,p.bindAll(["_onTimeout"],this)};$i.prototype.setZoomRate=function(a){this._defaultZoomRate=a},$i.prototype.setWheelZoomRate=function(a){this._wheelZoomRate=a},$i.prototype.isEnabled=function(){return!!this._enabled},$i.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},$i.prototype.isZooming=function(){return!!this._zooming},$i.prototype.enable=function(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=a&&"center"===a.around)},$i.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},$i.prototype.wheel=function(a){if(this.isEnabled()){var s=a.deltaMode===p.window.WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY,o=p.browser.now(),h=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,0!==s&&s%4.000244140625==0?this._type="wheel":0!==s&&Math.abs(s)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(h*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),a.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=a,this._delta-=s,this._active||this._start(a)),a.preventDefault()}},$i.prototype._onTimeout=function(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)},$i.prototype._start=function(a){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var s=W.mousePos(this._el,a);this._around=p.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(s)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},$i.prototype.renderFrame=function(){var a=this;if(this._frameId&&(this._frameId=null,this.isActive())){var s=this._map.transform;if(0!==this._delta){var o="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,h=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&0!==h&&(h=1/h);var y="number"==typeof this._targetZoom?s.zoomScale(this._targetZoom):s.scale;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(y*h))),"wheel"===this._type&&(this._startZoom=s.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var S,C="number"==typeof this._targetZoom?this._targetZoom:s.zoom,k=this._startZoom,K=this._easing,le=!1;if("wheel"===this._type&&k&&K){var Ee=Math.min((p.browser.now()-this._lastWheelEventTime)/200,1),Ae=K(Ee);S=p.number(k,C,Ae),Ee<1?this._frameId||(this._frameId=!0):le=!0}else S=C,le=!0;return this._active=!0,le&&(this._active=!1,this._finishTimeout=setTimeout(function(){a._zooming=!1,a._handler._triggerRenderFrame(),delete a._targetZoom,delete a._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!le,zoomDelta:S-s.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},$i.prototype._smoothOutEasing=function(a){var s=p.ease;if(this._prevEase){var o=this._prevEase,h=(p.browser.now()-o.start)/o.duration,y=o.easing(h+.01)-o.easing(h),S=.27/Math.sqrt(y*y+1e-4)*.01,C=Math.sqrt(.0729-S*S);s=p.bezier(S,C,.25,1)}return this._prevEase={start:p.browser.now(),duration:a,easing:s},s},$i.prototype.blur=function(){this.reset()},$i.prototype.reset=function(){this._active=!1};var xu=function(a,s){this._clickZoom=a,this._tapZoom=s};xu.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},xu.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},xu.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},xu.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Bs=function(){this.reset()};Bs.prototype.reset=function(){this._active=!1},Bs.prototype.blur=function(){this.reset()},Bs.prototype.dblclick=function(a,s){return a.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(a.shiftKey?-1:1),around:o.unproject(s)},{originalEvent:a})}}},Bs.prototype.enable=function(){this._enabled=!0},Bs.prototype.disable=function(){this._enabled=!1,this.reset()},Bs.prototype.isEnabled=function(){return this._enabled},Bs.prototype.isActive=function(){return this._active};var Yo=function(){this._tap=new iu({numTouches:1,numTaps:1}),this.reset()};Yo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},Yo.prototype.touchstart=function(a,s,o){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=s[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(a,s,o))},Yo.prototype.touchmove=function(a,s,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var h=s[0],y=h.y-this._swipePoint.y;return this._swipePoint=h,a.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(a,s,o)},Yo.prototype.touchend=function(a,s,o){this._tapTime?this._swipePoint&&0===o.length&&this.reset():this._tap.touchend(a,s,o)&&(this._tapTime=a.timeStamp)},Yo.prototype.touchcancel=function(){this.reset()},Yo.prototype.enable=function(){this._enabled=!0},Yo.prototype.disable=function(){this._enabled=!1,this.reset()},Yo.prototype.isEnabled=function(){return this._enabled},Yo.prototype.isActive=function(){return this._active};var nl=function(a,s,o){this._el=a,this._mousePan=s,this._touchPan=o};nl.prototype.enable=function(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},nl.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},nl.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},nl.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var bu=function(a,s,o){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=s,this._mousePitch=o};bu.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},bu.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},bu.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},bu.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ou=function(a,s,o,h){this._el=a,this._touchZoom=s,this._touchRotate=o,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0};ou.prototype.enable=function(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ou.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ou.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ou.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ou.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ou.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var mo=function(a){return a.zoom||a.drag||a.pitch||a.rotate},il=function(a){function s(){a.apply(this,arguments)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s}(p.Event);function ri(a){return a.panDelta&&a.panDelta.mag()||a.zoomDelta||a.bearingDelta||a.pitchDelta}var An=function(a,s){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Vl(a),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),p.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[p.window.document,"mousemove",{capture:!0}],[p.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[p.window,"blur",void 0]];for(var h=0,y=this._listeners;h<y.length;h+=1){var S=y[h],C=S[0];W.addEventListener(C,S[1],C===p.window.document?this.handleWindowEvent:this.handleEvent,S[2])}};An.prototype.destroy=function(){for(var a=0,s=this._listeners;a<s.length;a+=1){var o=s[a],h=o[0];W.removeEventListener(h,o[1],h===p.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},An.prototype._addDefaultHandlers=function(a){var s=this._map,o=s.getCanvasContainer();this._add("mapEvent",new Ro(s,a));var h=s.boxZoom=new za(s,a);this._add("boxZoom",h);var y=new Es,S=new Bs;s.doubleClickZoom=new xu(S,y),this._add("tapZoom",y),this._add("clickZoom",S);var C=new Yo;this._add("tapDragZoom",C);var k=s.touchPitch=new cf;this._add("touchPitch",k);var K=new Oc(a),le=new xl(a);s.dragRotate=new bu(a,K,le),this._add("mouseRotate",K,["mousePitch"]),this._add("mousePitch",le,["mouseRotate"]);var Ee=new Yc(a),Ae=new Ga(a);s.dragPan=new nl(o,Ee,Ae),this._add("mousePan",Ee),this._add("touchPan",Ae,["touchZoom","touchRotate"]);var Oe=new Tf,Ke=new Ds;s.touchZoomRotate=new ou(o,Ke,Oe,C),this._add("touchRotate",Oe,["touchPan","touchZoom"]),this._add("touchZoom",Ke,["touchPan","touchRotate"]);var We=s.scrollZoom=new $i(s,this);this._add("scrollZoom",We,["mousePan"]);var st=s.keyboard=new Ws;this._add("keyboard",st),this._add("blockableMapEvent",new Bn(s));for(var je=0,at=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];je<at.length;je+=1){var xt=at[je];a.interactive&&a[xt]&&s[xt].enable(a[xt])}},An.prototype._add=function(a,s,o){this._handlers.push({handlerName:a,handler:s,allowed:o}),this._handlersById[a]=s},An.prototype.stop=function(a){if(!this._updatingCamera){for(var s=0,o=this._handlers;s<o.length;s+=1)o[s].handler.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}},An.prototype.isActive=function(){for(var a=0,s=this._handlers;a<s.length;a+=1)if(s[a].handler.isActive())return!0;return!1},An.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},An.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},An.prototype.isMoving=function(){return Boolean(mo(this._eventsInProgress))||this.isZooming()},An.prototype._blockedByActive=function(a,s,o){for(var h in a)if(h!==o&&(!s||s.indexOf(h)<0))return!0;return!1},An.prototype.handleWindowEvent=function(a){this.handleEvent(a,a.type+"Window")},An.prototype._getMapTouches=function(a){for(var s=[],o=0,h=a;o<h.length;o+=1){var y=h[o];this._el.contains(y.target)&&s.push(y)}return s},An.prototype.handleEvent=function(a,s){this._updatingCamera=!0;for(var o="renderFrame"===a.type?void 0:a,h={needsRenderFrame:!1},y={},S={},C=a.touches?this._getMapTouches(a.touches):void 0,k=C?W.touchPos(this._el,C):W.mousePos(this._el,a),K=0,le=this._handlers;K<le.length;K+=1){var Ee=le[K],Ae=Ee.handlerName,Oe=Ee.handler,Ke=Ee.allowed;if(Oe.isEnabled()){var We=void 0;this._blockedByActive(S,Ke,Ae)?Oe.reset():Oe[s||a.type]&&(We=Oe[s||a.type](a,k,C),this.mergeHandlerResult(h,y,We,Ae,o),We&&We.needsRenderFrame&&this._triggerRenderFrame()),(We||Oe.isActive())&&(S[Ae]=Oe)}}var st={};for(var je in this._previousActiveHandlers)S[je]||(st[je]=o);this._previousActiveHandlers=S,(Object.keys(st).length||ri(h))&&(this._changes.push([h,y,st]),this._triggerRenderFrame()),(Object.keys(S).length||ri(h))&&this._map._stop(!0),this._updatingCamera=!1;var at=h.cameraAnimation;at&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],at(this._map))},An.prototype.mergeHandlerResult=function(a,s,o,h,y){if(o){p.extend(a,o);var S={handlerName:h,originalEvent:o.originalEvent||y};void 0!==o.zoomDelta&&(s.zoom=S),void 0!==o.panDelta&&(s.drag=S),void 0!==o.pitchDelta&&(s.pitch=S),void 0!==o.bearingDelta&&(s.rotate=S)}},An.prototype._applyChanges=function(){for(var a={},s={},o={},h=0,y=this._changes;h<y.length;h+=1){var S=y[h],C=S[0],k=S[1],K=S[2];C.panDelta&&(a.panDelta=(a.panDelta||new p.Point(0,0))._add(C.panDelta)),C.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+C.pitchDelta),void 0!==C.around&&(a.around=C.around),void 0!==C.pinchAround&&(a.pinchAround=C.pinchAround),C.noInertia&&(a.noInertia=C.noInertia),p.extend(s,k),p.extend(o,K)}this._updateMapTransform(a,s,o),this._changes=[]},An.prototype._updateMapTransform=function(a,s,o){var h=this._map,y=h.transform;if(!ri(a))return this._fireEvents(s,o,!0);var S=a.panDelta,C=a.zoomDelta,k=a.bearingDelta,K=a.pitchDelta,le=a.around,Ee=a.pinchAround;void 0!==Ee&&(le=Ee),h._stop(!0),le=le||h.transform.centerPoint;var Ae=y.pointLocation(S?le.sub(S):le);k&&(y.bearing+=k),K&&(y.pitch+=K),C&&(y.zoom+=C),y.setLocationAtPoint(Ae,le),this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(s,o,!0)},An.prototype._fireEvents=function(a,s,o){var h=this,y=mo(this._eventsInProgress),S=mo(a),C={};for(var k in a)this._eventsInProgress[k]||(C[k+"start"]=a[k].originalEvent),this._eventsInProgress[k]=a[k];for(var K in!y&&S&&this._fireEvent("movestart",S.originalEvent),C)this._fireEvent(K,C[K]);for(var le in S&&this._fireEvent("move",S.originalEvent),a)this._fireEvent(le,a[le].originalEvent);var Ee,Ae={};for(var Oe in this._eventsInProgress){var Ke=this._eventsInProgress[Oe],We=Ke.handlerName,st=Ke.originalEvent;this._handlersById[We].isActive()||(delete this._eventsInProgress[Oe],Ae[Oe+"end"]=Ee=s[We]||st)}for(var je in Ae)this._fireEvent(je,Ae[je]);var at=mo(this._eventsInProgress);if(o&&(y||S)&&!at){this._updatingCamera=!0;var xt=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),zt=function(or){return 0!==or&&-h._bearingSnap<or&&or<h._bearingSnap};xt?(zt(xt.bearing||this._map.getBearing())&&(xt.bearing=0),this._map.easeTo(xt,{originalEvent:Ee})):(this._map.fire(new p.Event("moveend",{originalEvent:Ee})),zt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},An.prototype._fireEvent=function(a,s){this._map.fire(new p.Event(a,s?{originalEvent:s}:{}))},An.prototype._requestFrame=function(){var a=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(s){delete a._frameId,a.handleEvent(new il("renderFrame",{timeStamp:s})),a._applyChanges()})},An.prototype._triggerRenderFrame=function(){void 0===this._frameId&&(this._frameId=this._requestFrame())};var lc=function(a){function s(o,h){a.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,p.bindAll(["_renderFrameCallback"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.getCenter=function(){return new p.LngLat(this.transform.center.lng,this.transform.center.lat)},s.prototype.setCenter=function(o,h){return this.jumpTo({center:o},h)},s.prototype.panBy=function(o,h,y){return o=p.Point.convert(o).mult(-1),this.panTo(this.transform.center,p.extend({offset:o},h),y)},s.prototype.panTo=function(o,h,y){return this.easeTo(p.extend({center:o},h),y)},s.prototype.getZoom=function(){return this.transform.zoom},s.prototype.setZoom=function(o,h){return this.jumpTo({zoom:o},h),this},s.prototype.zoomTo=function(o,h,y){return this.easeTo(p.extend({zoom:o},h),y)},s.prototype.zoomIn=function(o,h){return this.zoomTo(this.getZoom()+1,o,h),this},s.prototype.zoomOut=function(o,h){return this.zoomTo(this.getZoom()-1,o,h),this},s.prototype.getBearing=function(){return this.transform.bearing},s.prototype.setBearing=function(o,h){return this.jumpTo({bearing:o},h),this},s.prototype.getPadding=function(){return this.transform.padding},s.prototype.setPadding=function(o,h){return this.jumpTo({padding:o},h),this},s.prototype.rotateTo=function(o,h,y){return this.easeTo(p.extend({bearing:o},h),y)},s.prototype.resetNorth=function(o,h){return this.rotateTo(0,p.extend({duration:1e3},o),h),this},s.prototype.resetNorthPitch=function(o,h){return this.easeTo(p.extend({bearing:0,pitch:0,duration:1e3},o),h),this},s.prototype.snapToNorth=function(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this},s.prototype.getPitch=function(){return this.transform.pitch},s.prototype.setPitch=function(o,h){return this.jumpTo({pitch:o},h),this},s.prototype.cameraForBounds=function(o,h){o=p.LngLatBounds.convert(o);var y=h&&h.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),y,h)},s.prototype._cameraForBoxAndBearing=function(o,h,y,S){var C={top:0,bottom:0,right:0,left:0};if("number"==typeof(S=p.extend({padding:C,offset:[0,0],maxZoom:this.transform.maxZoom},S)).padding){var k=S.padding;S.padding={top:k,bottom:k,right:k,left:k}}S.padding=p.extend(C,S.padding);var K=this.transform,le=K.padding,Ee=K.project(p.LngLat.convert(o)),Ae=K.project(p.LngLat.convert(h)),Oe=Ee.rotate(-y*Math.PI/180),Ke=Ae.rotate(-y*Math.PI/180),We=new p.Point(Math.max(Oe.x,Ke.x),Math.max(Oe.y,Ke.y)),st=new p.Point(Math.min(Oe.x,Ke.x),Math.min(Oe.y,Ke.y)),je=We.sub(st),at=(K.width-(le.left+le.right+S.padding.left+S.padding.right))/je.x,xt=(K.height-(le.top+le.bottom+S.padding.top+S.padding.bottom))/je.y;if(!(xt<0||at<0)){var zt=Math.min(K.scaleZoom(K.scale*Math.min(at,xt)),S.maxZoom),or="number"==typeof S.offset.x?new p.Point(S.offset.x,S.offset.y):p.Point.convert(S.offset),Jt=new p.Point((S.padding.left-S.padding.right)/2,(S.padding.top-S.padding.bottom)/2).rotate(y*Math.PI/180),yr=or.add(Jt).mult(K.scale/K.zoomScale(zt));return{center:K.unproject(Ee.add(Ae).div(2).sub(yr)),zoom:zt,bearing:y}}p.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},s.prototype.fitBounds=function(o,h,y){return this._fitInternal(this.cameraForBounds(o,h),h,y)},s.prototype.fitScreenCoordinates=function(o,h,y,S,C){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(p.Point.convert(o)),this.transform.pointLocation(p.Point.convert(h)),y,S),S,C)},s.prototype._fitInternal=function(o,h,y){return o?(delete(h=p.extend(o,h)).padding,h.linear?this.easeTo(h,y):this.flyTo(h,y)):this},s.prototype.jumpTo=function(o,h){this.stop();var y=this.transform,S=!1,C=!1,k=!1;return"zoom"in o&&y.zoom!==+o.zoom&&(S=!0,y.zoom=+o.zoom),void 0!==o.center&&(y.center=p.LngLat.convert(o.center)),"bearing"in o&&y.bearing!==+o.bearing&&(C=!0,y.bearing=+o.bearing),"pitch"in o&&y.pitch!==+o.pitch&&(k=!0,y.pitch=+o.pitch),null==o.padding||y.isPaddingEqual(o.padding)||(y.padding=o.padding),this.fire(new p.Event("movestart",h)).fire(new p.Event("move",h)),S&&this.fire(new p.Event("zoomstart",h)).fire(new p.Event("zoom",h)).fire(new p.Event("zoomend",h)),C&&this.fire(new p.Event("rotatestart",h)).fire(new p.Event("rotate",h)).fire(new p.Event("rotateend",h)),k&&this.fire(new p.Event("pitchstart",h)).fire(new p.Event("pitch",h)).fire(new p.Event("pitchend",h)),this.fire(new p.Event("moveend",h))},s.prototype.easeTo=function(o,h){var y=this;this._stop(!1,o.easeId),(!1===(o=p.extend({offset:[0,0],duration:500,easing:p.ease},o)).animate||!o.essential&&p.browser.prefersReducedMotion)&&(o.duration=0);var S=this.transform,C=this.getZoom(),k=this.getBearing(),K=this.getPitch(),le=this.getPadding(),Ee="zoom"in o?+o.zoom:C,Ae="bearing"in o?this._normalizeBearing(o.bearing,k):k,Oe="pitch"in o?+o.pitch:K,Ke="padding"in o?o.padding:S.padding,We=p.Point.convert(o.offset),st=S.centerPoint.add(We),je=S.pointLocation(st),at=p.LngLat.convert(o.center||je);this._normalizeCenter(at);var xt,zt,or=S.project(je),Jt=S.project(at).sub(or),yr=S.zoomScale(Ee-C);o.around&&(xt=p.LngLat.convert(o.around),zt=S.locationPoint(xt));var Rr={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Ee!==C,this._rotating=this._rotating||k!==Ae,this._pitching=this._pitching||Oe!==K,this._padding=!S.isPaddingEqual(Ke),this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,Rr),this._ease(function($r){if(y._zooming&&(S.zoom=p.number(C,Ee,$r)),y._rotating&&(S.bearing=p.number(k,Ae,$r)),y._pitching&&(S.pitch=p.number(K,Oe,$r)),y._padding&&(S.interpolatePadding(le,Ke,$r),st=S.centerPoint.add(We)),xt)S.setLocationAtPoint(xt,zt);else{var Xr=S.zoomScale(S.zoom-C),pn=Ee>C?Math.min(2,yr):Math.max(.5,yr),qn=Math.pow(pn,1-$r),Un=S.unproject(or.add(Jt.mult($r*qn)).mult(Xr));S.setLocationAtPoint(S.renderWorldCopies?Un.wrap():Un,st)}y._fireMoveEvents(h)},function($r){y._afterEase(h,$r)},o),this},s.prototype._prepareEase=function(o,h,y){void 0===y&&(y={}),this._moving=!0,h||y.moving||this.fire(new p.Event("movestart",o)),this._zooming&&!y.zooming&&this.fire(new p.Event("zoomstart",o)),this._rotating&&!y.rotating&&this.fire(new p.Event("rotatestart",o)),this._pitching&&!y.pitching&&this.fire(new p.Event("pitchstart",o))},s.prototype._fireMoveEvents=function(o){this.fire(new p.Event("move",o)),this._zooming&&this.fire(new p.Event("zoom",o)),this._rotating&&this.fire(new p.Event("rotate",o)),this._pitching&&this.fire(new p.Event("pitch",o))},s.prototype._afterEase=function(o,h){if(!this._easeId||!h||this._easeId!==h){delete this._easeId;var y=this._zooming,S=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new p.Event("zoomend",o)),S&&this.fire(new p.Event("rotateend",o)),C&&this.fire(new p.Event("pitchend",o)),this.fire(new p.Event("moveend",o))}},s.prototype.flyTo=function(o,h){var y=this;if(!o.essential&&p.browser.prefersReducedMotion){var S=p.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(S,h)}this.stop(),o=p.extend({offset:[0,0],speed:1.2,curve:1.42,easing:p.ease},o);var C=this.transform,k=this.getZoom(),K=this.getBearing(),le=this.getPitch(),Ee=this.getPadding(),Ae="zoom"in o?p.clamp(+o.zoom,C.minZoom,C.maxZoom):k,Oe="bearing"in o?this._normalizeBearing(o.bearing,K):K,Ke="pitch"in o?+o.pitch:le,We="padding"in o?o.padding:C.padding,st=C.zoomScale(Ae-k),je=p.Point.convert(o.offset),at=C.centerPoint.add(je),xt=C.pointLocation(at),zt=p.LngLat.convert(o.center||xt);this._normalizeCenter(zt);var or=C.project(xt),Jt=C.project(zt).sub(or),yr=o.curve,Rr=Math.max(C.width,C.height),$r=Rr/st,Xr=Jt.mag();if("minZoom"in o){var pn=p.clamp(Math.min(o.minZoom,k,Ae),C.minZoom,C.maxZoom),qn=Rr/C.zoomScale(pn-k);yr=Math.sqrt(qn/Xr*2)}var Un=yr*yr;function Rn($){var ee=($r*$r-Rr*Rr+($?-1:1)*Un*Un*Xr*Xr)/(2*($?$r:Rr)*Un*Xr);return Math.log(Math.sqrt(ee*ee+1)-ee)}function ki($){return(Math.exp($)-Math.exp(-$))/2}function kn($){return(Math.exp($)+Math.exp(-$))/2}var gi=Rn(0),Vi=function($){return kn(gi)/kn(gi+yr*$)},li=function($){return Rr*((kn(gi)*(ki(ee=gi+yr*$)/kn(ee))-ki(gi))/Un)/Xr;var ee},yi=(Rn(1)-gi)/yr;if(Math.abs(Xr)<1e-6||!isFinite(yi)){if(Math.abs(Rr-$r)<1e-6)return this.easeTo(o,h);var Ni=$r<Rr?-1:1;yi=Math.abs(Math.log($r/Rr))/yr,li=function(){return 0},Vi=function($){return Math.exp(Ni*yr*$)}}return o.duration="duration"in o?+o.duration:1e3*yi/("screenSpeed"in o?+o.screenSpeed/yr:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=K!==Oe,this._pitching=Ke!==le,this._padding=!C.isPaddingEqual(We),this._prepareEase(h,!1),this._ease(function($){var ee=$*yi,L=1/Vi(ee);C.zoom=1===$?Ae:k+C.scaleZoom(L),y._rotating&&(C.bearing=p.number(K,Oe,$)),y._pitching&&(C.pitch=p.number(le,Ke,$)),y._padding&&(C.interpolatePadding(Ee,We,$),at=C.centerPoint.add(je));var D=1===$?zt:C.unproject(or.add(Jt.mult(li(ee))).mult(L));C.setLocationAtPoint(C.renderWorldCopies?D.wrap():D,at),y._fireMoveEvents(h)},function(){return y._afterEase(h)},o),this},s.prototype.isEasing=function(){return!!this._easeFrameId},s.prototype.stop=function(){return this._stop()},s.prototype._stop=function(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,h)}if(!o){var S=this.handlers;S&&S.stop(!1)}return this},s.prototype._ease=function(o,h,y){!1===y.animate||0===y.duration?(o(1),h()):(this._easeStart=p.browser.now(),this._easeOptions=y,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},s.prototype._renderFrameCallback=function(){var o=Math.min((p.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},s.prototype._normalizeBearing=function(o,h){o=p.wrap(o,-180,180);var y=Math.abs(o-h);return Math.abs(o-360-h)<y&&(o-=360),Math.abs(o+360-h)<y&&(o+=360),o},s.prototype._normalizeCenter=function(o){var h=this.transform;if(h.renderWorldCopies&&!h.lngRange){var y=o.lng-h.center.lng;o.lng+=y>180?-360:y<-180?360:0}},s}(p.Evented),So=function(a){void 0===a&&(a={}),this.options=a,p.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};So.prototype.getDefaultPosition=function(){return"bottom-right"},So.prototype.onAdd=function(a){var s=this.options&&this.options.compact;return this._map=a,this._container=W.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=W.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=W.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===s&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},So.prototype.onRemove=function(){W.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},So.prototype._setElementTitle=function(a,s){var o=this._map._getUIString("AttributionControl."+s);a.title=o,a.setAttribute("aria-label",o)},So.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},So.prototype._updateEditLink=function(){var a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));var s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||p.config.ACCESS_TOKEN}];if(a){var o=s.reduce(function(h,y,S){return y.value&&(h+=y.key+"="+y.value+(S<s.length-1?"&":"")),h},"?");a.href=p.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),a.rel="noopener nofollow",this._setElementTitle(a,"MapFeedback")}},So.prototype._updateData=function(a){!a||"metadata"!==a.sourceDataType&&"visibility"!==a.sourceDataType&&"style"!==a.dataType||(this._updateAttributions(),this._updateEditLink())},So.prototype._updateAttributions=function(){if(this._map.style){var a=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=a.concat(this.options.customAttribution.map(function(k){return"string"!=typeof k?"":k})):"string"==typeof this.options.customAttribution&&a.push(this.options.customAttribution)),this._map.style.stylesheet){var s=this._map.style.stylesheet;this.styleOwner=s.owner,this.styleId=s.id}var o=this._map.style.sourceCaches;for(var h in o){var y=o[h];if(y.used){var S=y.getSource();S.attribution&&a.indexOf(S.attribution)<0&&a.push(S.attribution)}}a.sort(function(k,K){return k.length-K.length});var C=(a=a.filter(function(k,K){for(var le=K+1;le<a.length;le++)if(a[le].indexOf(k)>=0)return!1;return!0})).join(" | ");C!==this._attribHTML&&(this._attribHTML=C,a.length?(this._innerContainer.innerHTML=C,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},So.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var Xs=function(){p.bindAll(["_updateLogo"],this),p.bindAll(["_updateCompact"],this)};Xs.prototype.onAdd=function(a){this._map=a,this._container=W.create("div","mapboxgl-ctrl");var s=W.create("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Xs.prototype.onRemove=function(){W.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Xs.prototype.getDefaultPosition=function(){return"bottom-left"},Xs.prototype._updateLogo=function(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},Xs.prototype._logoRequired=function(){if(this._map.style){var a=this._map.style.sourceCaches;for(var s in a)if(a[s].getSource().mapbox_logo)return!0;return!1}},Xs.prototype._updateCompact=function(){var a=this._container.children;if(a.length){var s=a[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}};var Po=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Po.prototype.add=function(a){var s=++this._id;return this._queue.push({callback:a,id:s,cancelled:!1}),s},Po.prototype.remove=function(a){for(var s=this._currentlyRunning,o=0,h=s?this._queue.concat(s):this._queue;o<h.length;o+=1){var y=h[o];if(y.id===a)return void(y.cancelled=!0)}},Po.prototype.run=function(a){void 0===a&&(a=0);var s=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,h=s;o<h.length;o+=1){var y=h[o];if(!y.cancelled&&(y.callback(a),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Po.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var fo={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},jl=p.window.HTMLImageElement,Gl=p.window.HTMLElement,Qi=p.window.ImageBitmap,zo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ff=function(a){function s(h){var y=this;if(null!=(h=p.extend({},zo,h)).minZoom&&null!=h.maxZoom&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=h.minPitch&&null!=h.maxPitch&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=h.minPitch&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=h.maxPitch&&h.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var S=new sa(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies);if(a.call(this,S,h),this._interactive=h.interactive,this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new Po,this._controls=[],this._mapId=p.uniqueId(),this._locale=p.extend({},fo,h.locale),this._clickTolerance=h.clickTolerance,this._requestManager=new p.RequestManager(h.transformRequest,h.accessToken),"string"==typeof h.container){if(this._container=p.window.document.getElementById(h.container),!this._container)throw new Error("Container '"+h.container+"' not found.")}else{if(!(h.container instanceof Gl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),p.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return y._update(!1)}),this.on("moveend",function(){return y._update(!1)}),this.on("zoom",function(){return y._update(!0)}),void 0!==p.window&&(p.window.addEventListener("online",this._onWindowOnline,!1),p.window.addEventListener("resize",this._onWindowResize,!1),p.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new An(this,h),this._hash=h.hash&&new Ss("string"==typeof h.hash&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,p.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new So({customAttribution:h.customAttribution})),this.addControl(new Xs,h.logoPosition),this.on("style.load",function(){y.transform.unmodified&&y.jumpTo(y.style.stylesheet)}),this.on("data",function(C){y._update("style"===C.dataType),y.fire(new p.Event(C.dataType+"data",C))}),this.on("dataloading",function(C){y.fire(new p.Event(C.dataType+"dataloading",C))})}a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return s.prototype._getMapId=function(){return this._mapId},s.prototype.addControl=function(h,y){if(void 0===y&&(y=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var S=h.onAdd(this);this._controls.push(h);var C=this._controlPositions[y];return-1!==y.indexOf("bottom")?C.insertBefore(S,C.firstChild):C.appendChild(S),this},s.prototype.removeControl=function(h){if(!h||!h.onRemove)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var y=this._controls.indexOf(h);return y>-1&&this._controls.splice(y,1),h.onRemove(this),this},s.prototype.hasControl=function(h){return this._controls.indexOf(h)>-1},s.prototype.resize=function(h){var y=this._containerDimensions(),S=y[0],C=y[1];if(S===this.transform.width&&C===this.transform.height)return this;this._resizeCanvas(S,C),this.transform.resize(S,C),this.painter.resize(S,C);var k=!this._moving;return k&&this.fire(new p.Event("movestart",h)).fire(new p.Event("move",h)),this.fire(new p.Event("resize",h)),k&&this.fire(new p.Event("moveend",h)),this},s.prototype.getBounds=function(){return this.transform.getBounds()},s.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},s.prototype.setMaxBounds=function(h){return this.transform.setMaxBounds(p.LngLatBounds.convert(h)),this._update()},s.prototype.setMinZoom=function(h){if((h=null==h?-2:h)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},s.prototype.getMinZoom=function(){return this.transform.minZoom},s.prototype.setMaxZoom=function(h){if((h=null==h?22:h)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")},s.prototype.getMaxZoom=function(){return this.transform.maxZoom},s.prototype.setMinPitch=function(h){if((h=null==h?0:h)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},s.prototype.getMinPitch=function(){return this.transform.minPitch},s.prototype.setMaxPitch=function(h){if((h=null==h?60:h)>60)throw new Error("maxPitch must be less than or equal to 60");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")},s.prototype.getMaxPitch=function(){return this.transform.maxPitch},s.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},s.prototype.setRenderWorldCopies=function(h){return this.transform.renderWorldCopies=h,this._update()},s.prototype.project=function(h){return this.transform.locationPoint(p.LngLat.convert(h))},s.prototype.unproject=function(h){return this.transform.pointLocation(p.Point.convert(h))},s.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},s.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},s.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},s.prototype._createDelegatedListener=function(h,y,S){var C,k=this;if("mouseenter"===h||"mouseover"===h){var K=!1;return{layer:y,listener:S,delegates:{mousemove:function(Ee){var Ae=k.getLayer(y)?k.queryRenderedFeatures(Ee.point,{layers:[y]}):[];Ae.length?K||(K=!0,S.call(k,new wo(h,k,Ee.originalEvent,{features:Ae}))):K=!1},mouseout:function(){K=!1}}}}if("mouseleave"===h||"mouseout"===h){var le=!1;return{layer:y,listener:S,delegates:{mousemove:function(Ee){(k.getLayer(y)?k.queryRenderedFeatures(Ee.point,{layers:[y]}):[]).length?le=!0:le&&(le=!1,S.call(k,new wo(h,k,Ee.originalEvent)))},mouseout:function(Ee){le&&(le=!1,S.call(k,new wo(h,k,Ee.originalEvent)))}}}}return{layer:y,listener:S,delegates:(C={},C[h]=function(Ee){var Ae=k.getLayer(y)?k.queryRenderedFeatures(Ee.point,{layers:[y]}):[];Ae.length&&(Ee.features=Ae,S.call(k,Ee),delete Ee.features)},C)}},s.prototype.on=function(h,y,S){if(void 0===S)return a.prototype.on.call(this,h,y);var C=this._createDelegatedListener(h,y,S);for(var k in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(C),C.delegates)this.on(k,C.delegates[k]);return this},s.prototype.once=function(h,y,S){if(void 0===S)return a.prototype.once.call(this,h,y);var C=this._createDelegatedListener(h,y,S);for(var k in C.delegates)this.once(k,C.delegates[k]);return this},s.prototype.off=function(h,y,S){var C=this;return void 0===S?a.prototype.off.call(this,h,y):(this._delegatedListeners&&this._delegatedListeners[h]&&function(k){for(var K=k[h],le=0;le<K.length;le++){var Ee=K[le];if(Ee.layer===y&&Ee.listener===S){for(var Ae in Ee.delegates)C.off(Ae,Ee.delegates[Ae]);return K.splice(le,1),C}}}(this._delegatedListeners),this)},s.prototype.queryRenderedFeatures=function(h,y){if(!this.style)return[];var S;if(void 0!==y||void 0===h||h instanceof p.Point||Array.isArray(h)||(y=h,h=void 0),y=y||{},(h=h||[[0,0],[this.transform.width,this.transform.height]])instanceof p.Point||"number"==typeof h[0])S=[p.Point.convert(h)];else{var C=p.Point.convert(h[0]),k=p.Point.convert(h[1]);S=[C,new p.Point(k.x,C.y),k,new p.Point(C.x,k.y),C]}return this.style.queryRenderedFeatures(S,y,this.transform)},s.prototype.querySourceFeatures=function(h,y){return this.style.querySourceFeatures(h,y)},s.prototype.setStyle=function(h,y){return!1!==(y=p.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},y)).diff&&y.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,y),this):(this._localIdeographFontFamily=y.localIdeographFontFamily,this._updateStyle(h,y))},s.prototype._getUIString=function(h){var y=this._locale[h];if(null==y)throw new Error("Missing UI string '"+h+"'");return y},s.prototype._updateStyle=function(h,y){return this.style&&(this.style.setEventedParent(null),this.style._remove()),h?(this.style=new gs(this,y||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof h?this.style.loadURL(h):this.style.loadJSON(h),this):(delete this.style,this)},s.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new gs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},s.prototype._diffStyle=function(h,y){var S=this;if("string"==typeof h){var C=this._requestManager.normalizeStyleURL(h),k=this._requestManager.transformRequest(C,p.ResourceType.Style);p.getJSON(k,function(K,le){K?S.fire(new p.ErrorEvent(K)):le&&S._updateDiff(le,y)})}else"object"==typeof h&&this._updateDiff(h,y)},s.prototype._updateDiff=function(h,y){try{this.style.setState(h)&&this._update(!0)}catch(S){p.warnOnce("Unable to perform style diff: "+(S.message||S.error||S)+".  Rebuilding the style from scratch."),this._updateStyle(h,y)}},s.prototype.getStyle=function(){if(this.style)return this.style.serialize()},s.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():p.warnOnce("There is no style added to the map.")},s.prototype.addSource=function(h,y){return this._lazyInitEmptyStyle(),this.style.addSource(h,y),this._update(!0)},s.prototype.isSourceLoaded=function(h){var y=this.style&&this.style.sourceCaches[h];if(void 0!==y)return y.loaded();this.fire(new p.ErrorEvent(new Error("There is no source with ID '"+h+"'")))},s.prototype.areTilesLoaded=function(){var h=this.style&&this.style.sourceCaches;for(var y in h){var S=h[y]._tiles;for(var C in S){var k=S[C];if("loaded"!==k.state&&"errored"!==k.state)return!1}}return!0},s.prototype.addSourceType=function(h,y,S){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,y,S)},s.prototype.removeSource=function(h){return this.style.removeSource(h),this._update(!0)},s.prototype.getSource=function(h){return this.style.getSource(h)},s.prototype.addImage=function(h,y,S){void 0===S&&(S={});var C=S.pixelRatio;void 0===C&&(C=1);var k=S.sdf;void 0===k&&(k=!1);var K=S.stretchX,le=S.stretchY,Ee=S.content;if(this._lazyInitEmptyStyle(),y instanceof jl||Qi&&y instanceof Qi){var Ae=p.browser.getImageData(y);this.style.addImage(h,{data:new p.RGBAImage({width:Ae.width,height:Ae.height},Ae.data),pixelRatio:C,stretchX:K,stretchY:le,content:Ee,sdf:k,version:0})}else{if(void 0===y.width||void 0===y.height)return this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Oe=y;this.style.addImage(h,{data:new p.RGBAImage({width:y.width,height:y.height},new Uint8Array(y.data)),pixelRatio:C,stretchX:K,stretchY:le,content:Ee,sdf:k,version:0,userImage:Oe}),Oe.onAdd&&Oe.onAdd(this,h)}},s.prototype.updateImage=function(h,y){var S=this.style.getImage(h);if(!S)return this.fire(new p.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var C=y instanceof jl||Qi&&y instanceof Qi?p.browser.getImageData(y):y,k=C.width,K=C.height,le=C.data;return void 0===k||void 0===K?this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):k!==S.data.width||K!==S.data.height?this.fire(new p.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(S.data.replace(le,!(y instanceof jl||Qi&&y instanceof Qi)),void this.style.updateImage(h,S))},s.prototype.hasImage=function(h){return h?!!this.style.getImage(h):(this.fire(new p.ErrorEvent(new Error("Missing required image id"))),!1)},s.prototype.removeImage=function(h){this.style.removeImage(h)},s.prototype.loadImage=function(h,y){p.getImage(this._requestManager.transformRequest(h,p.ResourceType.Image),y)},s.prototype.listImages=function(){return this.style.listImages()},s.prototype.addLayer=function(h,y){return this._lazyInitEmptyStyle(),this.style.addLayer(h,y),this._update(!0)},s.prototype.moveLayer=function(h,y){return this.style.moveLayer(h,y),this._update(!0)},s.prototype.removeLayer=function(h){return this.style.removeLayer(h),this._update(!0)},s.prototype.getLayer=function(h){return this.style.getLayer(h)},s.prototype.setLayerZoomRange=function(h,y,S){return this.style.setLayerZoomRange(h,y,S),this._update(!0)},s.prototype.setFilter=function(h,y,S){return void 0===S&&(S={}),this.style.setFilter(h,y,S),this._update(!0)},s.prototype.getFilter=function(h){return this.style.getFilter(h)},s.prototype.setPaintProperty=function(h,y,S,C){return void 0===C&&(C={}),this.style.setPaintProperty(h,y,S,C),this._update(!0)},s.prototype.getPaintProperty=function(h,y){return this.style.getPaintProperty(h,y)},s.prototype.setLayoutProperty=function(h,y,S,C){return void 0===C&&(C={}),this.style.setLayoutProperty(h,y,S,C),this._update(!0)},s.prototype.getLayoutProperty=function(h,y){return this.style.getLayoutProperty(h,y)},s.prototype.setLight=function(h,y){return void 0===y&&(y={}),this._lazyInitEmptyStyle(),this.style.setLight(h,y),this._update(!0)},s.prototype.getLight=function(){return this.style.getLight()},s.prototype.setFeatureState=function(h,y){return this.style.setFeatureState(h,y),this._update()},s.prototype.removeFeatureState=function(h,y){return this.style.removeFeatureState(h,y),this._update()},s.prototype.getFeatureState=function(h){return this.style.getFeatureState(h)},s.prototype.getContainer=function(){return this._container},s.prototype.getCanvasContainer=function(){return this._canvasContainer},s.prototype.getCanvas=function(){return this._canvas},s.prototype._containerDimensions=function(){var h=0,y=0;return this._container&&(h=this._container.clientWidth||400,y=this._container.clientHeight||300),[h,y]},s.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==p.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&p.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},s.prototype._setupContainer=function(){var h=this._container;h.classList.add("mapboxgl-map"),(this._missingCSSCanary=W.create("div","mapboxgl-canary",h)).style.visibility="hidden",this._detectMissingCSS();var y=this._canvasContainer=W.create("div","mapboxgl-canvas-container",h);this._interactive&&y.classList.add("mapboxgl-interactive"),this._canvas=W.create("canvas","mapboxgl-canvas",y),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var S=this._containerDimensions();this._resizeCanvas(S[0],S[1]);var C=this._controlContainer=W.create("div","mapboxgl-control-container",h),k=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(K){k[K]=W.create("div","mapboxgl-ctrl-"+K,C)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},s.prototype._resizeCanvas=function(h,y){var S=p.browser.devicePixelRatio||1;this._canvas.width=S*h,this._canvas.height=S*y,this._canvas.style.width=h+"px",this._canvas.style.height=y+"px"},s.prototype._setupPainter=function(){var h=p.extend({},_.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),y=this._canvas.getContext("webgl",h)||this._canvas.getContext("experimental-webgl",h);y?(this.painter=new $a(y,this.transform),p.webpSupported.testSupport(y)):this.fire(new p.ErrorEvent(new Error("Failed to initialize WebGL")))},s.prototype._contextLost=function(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new p.Event("webglcontextlost",{originalEvent:h}))},s.prototype._contextRestored=function(h){this._setupPainter(),this.resize(),this._update(),this.fire(new p.Event("webglcontextrestored",{originalEvent:h}))},s.prototype._onMapScroll=function(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},s.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},s.prototype._update=function(h){return this.style?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this},s.prototype._requestRenderFrame=function(h){return this._update(),this._renderTaskQueue.add(h)},s.prototype._cancelRenderFrame=function(h){this._renderTaskQueue.remove(h)},s.prototype._render=function(h){var y,S=this,C=0,k=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(y=k.createQueryEXT(),k.beginQueryEXT(k.TIME_ELAPSED_EXT,y),C=p.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),!this._removed){var K=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var le=this.transform.zoom,Ee=p.browser.now();this.style.zoomHistory.update(le,Ee);var Ae=new p.EvaluationParameters(le,{now:Ee,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Oe=Ae.crossFadingFactor();1===Oe&&Oe===this._crossFadingFactor||(K=!0,this._crossFadingFactor=Oe),this.style.update(Ae)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new p.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new p.Event("load"))),this.style&&(this.style.hasTransitions()||K)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ke=p.browser.now()-C;k.endQueryEXT(k.TIME_ELAPSED_EXT,y),setTimeout(function(){var je=k.getQueryObjectEXT(y,k.QUERY_RESULT_EXT)/1e6;k.deleteQueryEXT(y),S.fire(new p.Event("gpu-timing-frame",{cpuTime:Ke,gpuTime:je}))},50)}if(this.listens("gpu-timing-layer")){var We=this.painter.collectGpuTimers();setTimeout(function(){var je=S.painter.queryGpuTimers(We);S.fire(new p.Event("gpu-timing-layer",{layerTimes:je}))},50)}var st=this._sourcesDirty||this._styleDirty||this._placementDirty;return st||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new p.Event("idle")),!this._loaded||this._fullyLoaded||st||(this._fullyLoaded=!0),this}},s.prototype.remove=function(){this._hash&&this._hash.remove();for(var h=0,y=this._controls;h<y.length;h+=1)y[h].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==p.window&&(p.window.removeEventListener("resize",this._onWindowResize,!1),p.window.removeEventListener("orientationchange",this._onWindowResize,!1),p.window.removeEventListener("online",this._onWindowOnline,!1));var S=this.painter.context.gl.getExtension("WEBGL_lose_context");S&&S.loseContext(),As(this._canvasContainer),As(this._controlContainer),As(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new p.Event("remove"))},s.prototype.triggerRepaint=function(){var h=this;this.style&&!this._frame&&(this._frame=p.browser.frame(function(y){h._frame=null,h._render(y)}))},s.prototype._onWindowOnline=function(){this._update()},s.prototype._onWindowResize=function(h){this._trackResize&&this.resize({originalEvent:h})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(h){this._showPadding!==h&&(this._showPadding=h,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(h){this._vertices=h,this._update()},s.prototype._setCacheLimits=function(h,y){p.setCacheLimits(h,y)},o.version.get=function(){return p.version},Object.defineProperties(s.prototype,o),s}(lc);function As(a){a.parentNode&&a.parentNode.removeChild(a)}var bl={showCompass:!0,showZoom:!0,visualizePitch:!1},ys=function(a){var s=this;this.options=p.extend({},bl,a),this._container=W.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(p.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return s._map.zoomIn({},{originalEvent:o})}),W.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return s._map.zoomOut({},{originalEvent:o})}),W.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(p.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){s.options.visualizePitch?s._map.resetNorthPitch({},{originalEvent:o}):s._map.resetNorth({},{originalEvent:o})}),this._compassIcon=W.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ys.prototype._updateZoomButtons=function(){var a=this._map.getZoom(),s=a===this._map.getMaxZoom(),o=a===this._map.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},ys.prototype._rotateCompassArrow=function(){var a=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=a},ys.prototype.onAdd=function(a){return this._map=a,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new is(this._map,this._compass,this.options.visualizePitch)),this._container},ys.prototype.onRemove=function(){W.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ys.prototype._createButton=function(a,s){var o=W.create("button",a,this._container);return o.type="button",o.addEventListener("click",s),o},ys.prototype._setButtonTitle=function(a,s){var o=this._map._getUIString("NavigationControl."+s);a.title=o,a.setAttribute("aria-label",o)};var is=function(a,s,o){void 0===o&&(o=!1),this._clickTolerance=10,this.element=s,this.mouseRotate=new Oc({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,o&&(this.mousePitch=new xl({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),p.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),W.addEventListener(s,"mousedown",this.mousedown),W.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),W.addEventListener(s,"touchmove",this.touchmove),W.addEventListener(s,"touchend",this.touchend),W.addEventListener(s,"touchcancel",this.reset)};function al(a,s,o){if(a=new p.LngLat(a.lng,a.lat),s){var h=new p.LngLat(a.lng-360,a.lat),y=new p.LngLat(a.lng+360,a.lat),S=o.locationPoint(a).distSqr(s);o.locationPoint(h).distSqr(s)<S?a=h:o.locationPoint(y).distSqr(s)<S&&(a=y)}for(;Math.abs(a.lng-o.center.lng)>180;){var C=o.locationPoint(a);if(C.x>=0&&C.y>=0&&C.x<=o.width&&C.y<=o.height)break;a.lng>o.center.lng?a.lng-=360:a.lng+=360}return a}is.prototype.down=function(a,s){this.mouseRotate.mousedown(a,s),this.mousePitch&&this.mousePitch.mousedown(a,s),W.disableDrag()},is.prototype.move=function(a,s){var o=this.map,h=this.mouseRotate.mousemoveWindow(a,s);if(h&&h.bearingDelta&&o.setBearing(o.getBearing()+h.bearingDelta),this.mousePitch){var y=this.mousePitch.mousemoveWindow(a,s);y&&y.pitchDelta&&o.setPitch(o.getPitch()+y.pitchDelta)}},is.prototype.off=function(){var a=this.element;W.removeEventListener(a,"mousedown",this.mousedown),W.removeEventListener(a,"touchstart",this.touchstart,{passive:!1}),W.removeEventListener(a,"touchmove",this.touchmove),W.removeEventListener(a,"touchend",this.touchend),W.removeEventListener(a,"touchcancel",this.reset),this.offTemp()},is.prototype.offTemp=function(){W.enableDrag(),W.removeEventListener(p.window,"mousemove",this.mousemove),W.removeEventListener(p.window,"mouseup",this.mouseup)},is.prototype.mousedown=function(a){this.down(p.extend({},a,{ctrlKey:!0,preventDefault:function(){return a.preventDefault()}}),W.mousePos(this.element,a)),W.addEventListener(p.window,"mousemove",this.mousemove),W.addEventListener(p.window,"mouseup",this.mouseup)},is.prototype.mousemove=function(a){this.move(a,W.mousePos(this.element,a))},is.prototype.mouseup=function(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()},is.prototype.touchstart=function(a){1!==a.targetTouches.length?this.reset():(this._startPos=this._lastPos=W.touchPos(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return a.preventDefault()}},this._startPos))},is.prototype.touchmove=function(a){1!==a.targetTouches.length?this.reset():(this._lastPos=W.touchPos(this.element,a.targetTouches)[0],this.move({preventDefault:function(){return a.preventDefault()}},this._lastPos))},is.prototype.touchend=function(a){0===a.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},is.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var su={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Hl(a,s,o){var h=a.classList;for(var y in su)h.remove("mapboxgl-"+o+"-anchor-"+y);h.add("mapboxgl-"+o+"-anchor-"+s)}var wl,Wl=function(a){function s(o,h){if(a.call(this),(o instanceof p.window.HTMLElement||h)&&(o=p.extend({element:o},h)),p.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=p.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=W.create("div"),this._element.setAttribute("aria-label","Map marker");var y=W.createNS("http://www.w3.org/2000/svg","svg");y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height","41px"),y.setAttributeNS(null,"width","27px"),y.setAttributeNS(null,"viewBox","0 0 27 41");var S=W.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");var C=W.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill-rule","nonzero");var k=W.createNS("http://www.w3.org/2000/svg","g");k.setAttributeNS(null,"transform","translate(3.0, 29.0)"),k.setAttributeNS(null,"fill","#000000");for(var K=0,le=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];K<le.length;K+=1){var Ee=le[K],Ae=W.createNS("http://www.w3.org/2000/svg","ellipse");Ae.setAttributeNS(null,"opacity","0.04"),Ae.setAttributeNS(null,"cx","10.5"),Ae.setAttributeNS(null,"cy","5.80029008"),Ae.setAttributeNS(null,"rx",Ee.rx),Ae.setAttributeNS(null,"ry",Ee.ry),k.appendChild(Ae)}var Oe=W.createNS("http://www.w3.org/2000/svg","g");Oe.setAttributeNS(null,"fill",this._color);var Ke=W.createNS("http://www.w3.org/2000/svg","path");Ke.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Oe.appendChild(Ke);var We=W.createNS("http://www.w3.org/2000/svg","g");We.setAttributeNS(null,"opacity","0.25"),We.setAttributeNS(null,"fill","#000000");var st=W.createNS("http://www.w3.org/2000/svg","path");st.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),We.appendChild(st);var je=W.createNS("http://www.w3.org/2000/svg","g");je.setAttributeNS(null,"transform","translate(6.0, 7.0)"),je.setAttributeNS(null,"fill","#FFFFFF");var at=W.createNS("http://www.w3.org/2000/svg","g");at.setAttributeNS(null,"transform","translate(8.0, 8.0)");var xt=W.createNS("http://www.w3.org/2000/svg","circle");xt.setAttributeNS(null,"fill","#000000"),xt.setAttributeNS(null,"opacity","0.25"),xt.setAttributeNS(null,"cx","5.5"),xt.setAttributeNS(null,"cy","5.5"),xt.setAttributeNS(null,"r","5.4999962");var zt=W.createNS("http://www.w3.org/2000/svg","circle");zt.setAttributeNS(null,"fill","#FFFFFF"),zt.setAttributeNS(null,"cx","5.5"),zt.setAttributeNS(null,"cy","5.5"),zt.setAttributeNS(null,"r","5.4999962"),at.appendChild(xt),at.appendChild(zt),C.appendChild(k),C.appendChild(Oe),C.appendChild(We),C.appendChild(je),C.appendChild(at),y.appendChild(C),y.setAttributeNS(null,"height",41*this._scale+"px"),y.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(y),this._offset=p.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(or){or.preventDefault()}),this._element.addEventListener("mousedown",function(or){or.preventDefault()}),Hl(this._element,this._anchor,"marker"),this._popup=null}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},s.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),W.remove(this._element),this._popup&&this._popup.remove(),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=p.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},s.prototype.getElement=function(){return this._element},s.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var h=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(24.6+h)],"bottom-right":[-h,-1*(24.6+h)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},s.prototype._onKeyPress=function(o){var h=o.code,y=o.charCode||o.keyCode;"Space"!==h&&"Enter"!==h&&32!==y&&13!==y||this.togglePopup()},s.prototype._onMapClick=function(o){var h=o.originalEvent.target,y=this._element;this._popup&&(h===y||y.contains(h))&&this.togglePopup()},s.prototype.getPopup=function(){return this._popup},s.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},s.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=al(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var h="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?h="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(h="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var y="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?y="rotateX(0deg)":"map"===this._pitchAlignment&&(y="rotateX("+this._map.getPitch()+"deg)"),o&&"moveend"!==o.type||(this._pos=this._pos.round()),W.setTransform(this._element,su[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+y+" "+h)}},s.prototype.getOffset=function(){return this._offset},s.prototype.setOffset=function(o){return this._offset=p.Point.convert(o),this._update(),this},s.prototype._onMove=function(o){if(!this._isDragging){var h=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=h}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new p.Event("dragstart"))),this.fire(new p.Event("drag")))},s.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new p.Event("dragend")),this._state="inactive"},s.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},s.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},s.prototype.isDraggable=function(){return this._draggable},s.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},s.prototype.getRotation=function(){return this._rotation},s.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},s.prototype.getRotationAlignment=function(){return this._rotationAlignment},s.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this},s.prototype.getPitchAlignment=function(){return this._pitchAlignment},s}(p.Evented),Kc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Sl=0,ol=!1,Lc=function(a){function s(o){a.call(this),this.options=p.extend({},Kc,o),p.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.onAdd=function(o){var h;return this._map=o,this._container=W.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),h=this._setupUI,void 0!==wl?h(wl):void 0!==p.window.navigator.permissions?p.window.navigator.permissions.query({name:"geolocation"}).then(function(y){h(wl="denied"!==y.state)}):h(wl=!!p.window.navigator.geolocation),this._container},s.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(p.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),W.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Sl=0,ol=!1},s.prototype._isOutOfMapMaxBounds=function(o){var h=this._map.getMaxBounds(),y=o.coords;return h&&(y.longitude<h.getWest()||y.longitude>h.getEast()||y.latitude<h.getSouth()||y.latitude>h.getNorth())},s.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},s.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new p.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("geolocate",o)),this._finish()}},s.prototype._updateCamera=function(o){var h=new p.LngLat(o.coords.longitude,o.coords.latitude),y=o.coords.accuracy,S=this._map.getBearing(),C=p.extend({bearing:S},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(y),C,{geolocateSource:!0})},s.prototype._updateMarker=function(o){if(o){var h=new p.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},s.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,h=this._map.unproject([0,o]),y=this._map.unproject([1,o]),S=h.distanceTo(y),C=Math.ceil(2*this._accuracy/S);this._circleElement.style.width=C+"px",this._circleElement.style.height=C+"px"},s.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},s.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=h,this._geolocateButton.setAttribute("aria-label",h),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&ol)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("error",o)),this._finish()}},s.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},s.prototype._setupUI=function(o){var h=this;if(this._container.addEventListener("contextmenu",function(C){return C.preventDefault()}),this._geolocateButton=W.create("button","mapboxgl-ctrl-geolocate",this._container),W.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===o){p.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var y=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y)}else{var S=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=S,this._geolocateButton.setAttribute("aria-label",S)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=W.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Wl(this._dotElement),this._circleElement=W.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(C){C.geolocateSource||"ACTIVE_LOCK"!==h._watchState||C.originalEvent&&"resize"===C.originalEvent.type||(h._watchState="BACKGROUND",h._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),h._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),h.fire(new p.Event("trackuserlocationend")))})},s.prototype.trigger=function(){if(!this._setup)return p.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new p.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Sl--,ol=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new p.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new p.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Sl>1?(o={maximumAge:6e5,timeout:0},ol=!0):(o=this.options.positionOptions,ol=!1),this._geolocationWatchID=p.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else p.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},s.prototype._clearWatch=function(){p.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},s}(p.Evented),sl={maxWidth:100,unit:"metric"},ju=function(a){this.options=p.extend({},sl,a),p.bindAll(["_onMove","setUnit"],this)};function Xl(a,s,o){var h=o&&o.maxWidth||100,y=a._container.clientHeight/2,S=a.unproject([0,y]),C=a.unproject([h,y]),k=S.distanceTo(C);if(o&&"imperial"===o.unit){var K=3.2808*k;K>5280?Gu(s,h,K/5280,a._getUIString("ScaleControl.Miles")):Gu(s,h,K,a._getUIString("ScaleControl.Feet"))}else o&&"nautical"===o.unit?Gu(s,h,k/1852,a._getUIString("ScaleControl.NauticalMiles")):k>=1e3?Gu(s,h,k/1e3,a._getUIString("ScaleControl.Kilometers")):Gu(s,h,k,a._getUIString("ScaleControl.Meters"))}function Gu(a,s,o,h){var y,S,C,K,le,k=(y=o,(S=Math.pow(10,(""+Math.floor(y)).length-1))*(C=(C=y/S)>=10?10:C>=5?5:C>=3?3:C>=2?2:C>=1?1:(K=C,le=Math.pow(10,Math.ceil(-Math.log(K)/Math.LN10)),Math.round(K*le)/le)));a.style.width=s*(k/o)+"px",a.innerHTML=k+"&nbsp;"+h}ju.prototype.getDefaultPosition=function(){return"bottom-left"},ju.prototype._onMove=function(){Xl(this._map,this._container,this.options)},ju.prototype.onAdd=function(a){return this._map=a,this._container=W.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",a.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ju.prototype.onRemove=function(){W.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ju.prototype.setUnit=function(a){this.options.unit=a,Xl(this._map,this._container,this.options)};var Fs=function(a){this._fullscreen=!1,a&&a.container&&(a.container instanceof p.window.HTMLElement?this._container=a.container:p.warnOnce("Full screen control 'container' must be a DOM element.")),p.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in p.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in p.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in p.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in p.window.document&&(this._fullscreenchange="MSFullscreenChange")};Fs.prototype.onAdd=function(a){return this._map=a,this._container||(this._container=this._map.getContainer()),this._controlContainer=W.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",p.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Fs.prototype.onRemove=function(){W.remove(this._controlContainer),this._map=null,p.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Fs.prototype._checkFullscreenSupport=function(){return!!(p.window.document.fullscreenEnabled||p.window.document.mozFullScreenEnabled||p.window.document.msFullscreenEnabled||p.window.document.webkitFullscreenEnabled)},Fs.prototype._setupUI=function(){var a=this._fullscreenButton=W.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);W.create("span","mapboxgl-ctrl-icon",a).setAttribute("aria-hidden",!0),a.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),p.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Fs.prototype._updateTitle=function(){var a=this._getTitle();this._fullscreenButton.setAttribute("aria-label",a),this._fullscreenButton.title=a},Fs.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Fs.prototype._isFullscreen=function(){return this._fullscreen},Fs.prototype._changeIcon=function(){(p.window.document.fullscreenElement||p.window.document.mozFullScreenElement||p.window.document.webkitFullscreenElement||p.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Fs.prototype._onClickFullscreen=function(){this._isFullscreen()?p.window.document.exitFullscreen?p.window.document.exitFullscreen():p.window.document.mozCancelFullScreen?p.window.document.mozCancelFullScreen():p.window.document.msExitFullscreen?p.window.document.msExitFullscreen():p.window.document.webkitCancelFullScreen&&p.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Rc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},cc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),fc=function(a){function s(o){a.call(this),this.options=p.extend(Object.create(Rc),o),p.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return a&&(s.__proto__=a),(s.prototype=Object.create(a&&a.prototype)).constructor=s,s.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new p.Event("open")),this},s.prototype.isOpen=function(){return!!this._map},s.prototype.remove=function(){return this._content&&W.remove(this._content),this._container&&(W.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new p.Event("close")),this},s.prototype.getLngLat=function(){return this._lngLat},s.prototype.setLngLat=function(o){return this._lngLat=p.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},s.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},s.prototype.getElement=function(){return this._container},s.prototype.setText=function(o){return this.setDOMContent(p.window.document.createTextNode(o))},s.prototype.setHTML=function(o){var h,y=p.window.document.createDocumentFragment(),S=p.window.document.createElement("body");for(S.innerHTML=o;h=S.firstChild;)y.appendChild(h);return this.setDOMContent(y)},s.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},s.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},s.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=W.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},s.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},s.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},s.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},s.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},s.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=W.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},s.prototype._onMouseUp=function(o){this._update(o.point)},s.prototype._onMouseMove=function(o){this._update(o.point)},s.prototype._onDrag=function(o){this._update(o.point)},s.prototype._update=function(o){var h=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=W.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=W.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Ae){return h._container.classList.add(Ae)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=al(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var y=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),S=this.options.anchor,C=function Ae(Oe){if(Oe){if("number"==typeof Oe){var Ke=Math.round(Math.sqrt(.5*Math.pow(Oe,2)));return{center:new p.Point(0,0),top:new p.Point(0,Oe),"top-left":new p.Point(Ke,Ke),"top-right":new p.Point(-Ke,Ke),bottom:new p.Point(0,-Oe),"bottom-left":new p.Point(Ke,-Ke),"bottom-right":new p.Point(-Ke,-Ke),left:new p.Point(Oe,0),right:new p.Point(-Oe,0)}}if(Oe instanceof p.Point||Array.isArray(Oe)){var We=p.Point.convert(Oe);return{center:We,top:We,"top-left":We,"top-right":We,bottom:We,"bottom-left":We,"bottom-right":We,left:We,right:We}}return{center:p.Point.convert(Oe.center||[0,0]),top:p.Point.convert(Oe.top||[0,0]),"top-left":p.Point.convert(Oe["top-left"]||[0,0]),"top-right":p.Point.convert(Oe["top-right"]||[0,0]),bottom:p.Point.convert(Oe.bottom||[0,0]),"bottom-left":p.Point.convert(Oe["bottom-left"]||[0,0]),"bottom-right":p.Point.convert(Oe["bottom-right"]||[0,0]),left:p.Point.convert(Oe.left||[0,0]),right:p.Point.convert(Oe.right||[0,0])}}return Ae(new p.Point(0,0))}(this.options.offset);if(!S){var k,K=this._container.offsetWidth,le=this._container.offsetHeight;k=y.y+C.bottom.y<le?["top"]:y.y>this._map.transform.height-le?["bottom"]:[],y.x<K/2?k.push("left"):y.x>this._map.transform.width-K/2&&k.push("right"),S=0===k.length?"bottom":k.join("-")}var Ee=y.add(C[S]).round();W.setTransform(this._container,su[S]+" translate("+Ee.x+"px,"+Ee.y+"px)"),Hl(this._container,S,"popup")}},s.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(cc);o&&o.focus()}},s.prototype._onClose=function(){this.remove()},s}(p.Evented),El={version:p.version,supported:_,setRTLTextPlugin:p.setRTLTextPlugin,getRTLTextPluginStatus:p.getRTLTextPluginStatus,Map:ff,NavigationControl:ys,GeolocateControl:Lc,AttributionControl:So,ScaleControl:ju,FullscreenControl:Fs,Popup:fc,Marker:Wl,Style:gs,LngLat:p.LngLat,LngLatBounds:p.LngLatBounds,Point:p.Point,MercatorCoordinate:p.MercatorCoordinate,Evented:p.Evented,config:p.config,prewarm:function(){qt().acquire($t)},clearPrewarmedResources:function(){var a=On;a&&(a.isPreloaded()&&1===a.numActive()?(a.release($t),On=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return p.config.ACCESS_TOKEN},set accessToken(a){p.config.ACCESS_TOKEN=a},get baseApiUrl(){return p.config.API_URL},set baseApiUrl(a){p.config.API_URL=a},get workerCount(){return Br.workerCount},set workerCount(a){Br.workerCount=a},get maxParallelImageRequests(){return p.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(a){p.config.MAX_PARALLEL_IMAGE_REQUESTS=a},clearStorage:function(a){p.clearTileCache(a)},workerUrl:""};return El}),ue}()},78320:()=>{var dr,H;H=dr||(dr={}),function(M){var ue="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),w=p(H);function p(_,W){return function(X,q){"function"!=typeof _[X]&&Object.defineProperty(_,X,{configurable:!0,writable:!0,value:q}),W&&W(X,q)}}void 0===ue.Reflect?ue.Reflect=H:w=p(ue.Reflect,w),function(M){var ue=Object.prototype.hasOwnProperty,w="function"==typeof Symbol,p=w&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",_=w&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",W="function"==typeof Object.create,X={__proto__:[]}instanceof Array,q=!W&&!X,te={create:W?function(){return Ot(Object.create(null))}:X?function(){return Ot({__proto__:null})}:function(){return Ot({})},has:q?function(B,Ue){return ue.call(B,Ue)}:function(B,Ue){return Ue in B},get:q?function(B,Ue){return ue.call(B,Ue)?B[Ue]:void 0}:function(B,Ue){return B[Ue]}},Y=Object.getPrototypeOf(Function),Xe="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,et=Xe||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var B={},Ue=[],_t=function(){function _r(jt,mr,er){this._index=0,this._keys=jt,this._values=mr,this._selector=er}return _r.prototype["@@iterator"]=function(){return this},_r.prototype[_]=function(){return this},_r.prototype.next=function(){var jt=this._index;if(jt>=0&&jt<this._keys.length){var mr=this._selector(this._keys[jt],this._values[jt]);return jt+1>=this._keys.length?(this._index=-1,this._keys=Ue,this._values=Ue):this._index++,{value:mr,done:!1}}return{value:void 0,done:!0}},_r.prototype.throw=function(jt){throw this._index>=0&&(this._index=-1,this._keys=Ue,this._values=Ue),jt},_r.prototype.return=function(jt){return this._index>=0&&(this._index=-1,this._keys=Ue,this._values=Ue),{value:jt,done:!0}},_r}();return function(){function _r(){this._keys=[],this._values=[],this._cacheKey=B,this._cacheIndex=-2}return Object.defineProperty(_r.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),_r.prototype.has=function(jt){return this._find(jt,!1)>=0},_r.prototype.get=function(jt){var mr=this._find(jt,!1);return mr>=0?this._values[mr]:void 0},_r.prototype.set=function(jt,mr){var er=this._find(jt,!0);return this._values[er]=mr,this},_r.prototype.delete=function(jt){var mr=this._find(jt,!1);if(mr>=0){for(var er=this._keys.length,pr=mr+1;pr<er;pr++)this._keys[pr-1]=this._keys[pr],this._values[pr-1]=this._values[pr];return this._keys.length--,this._values.length--,jt===this._cacheKey&&(this._cacheKey=B,this._cacheIndex=-2),!0}return!1},_r.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=B,this._cacheIndex=-2},_r.prototype.keys=function(){return new _t(this._keys,this._values,St)},_r.prototype.values=function(){return new _t(this._keys,this._values,Xt)},_r.prototype.entries=function(){return new _t(this._keys,this._values,Cr)},_r.prototype["@@iterator"]=function(){return this.entries()},_r.prototype[_]=function(){return this.entries()},_r.prototype._find=function(jt,mr){return this._cacheKey!==jt&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=jt)),this._cacheIndex<0&&mr&&(this._cacheIndex=this._keys.length,this._keys.push(jt),this._values.push(void 0)),this._cacheIndex},_r}();function St(_r,jt){return _r}function Xt(_r,jt){return jt}function Cr(_r,jt){return[_r,jt]}}():Map,z=Xe||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function B(){this._map=new et}return Object.defineProperty(B.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),B.prototype.has=function(Ue){return this._map.has(Ue)},B.prototype.add=function(Ue){return this._map.set(Ue,Ue),this},B.prototype.delete=function(Ue){return this._map.delete(Ue)},B.prototype.clear=function(){this._map.clear()},B.prototype.keys=function(){return this._map.keys()},B.prototype.values=function(){return this._map.values()},B.prototype.entries=function(){return this._map.entries()},B.prototype["@@iterator"]=function(){return this.keys()},B.prototype[_]=function(){return this.keys()},B}():Set,tt=new(Xe||"function"!=typeof WeakMap?function(){var Ue=te.create(),_t=St();return function(){function mr(){this._key=St()}return mr.prototype.has=function(er){var pr=Xt(er,!1);return void 0!==pr&&te.has(pr,this._key)},mr.prototype.get=function(er){var pr=Xt(er,!1);return void 0!==pr?te.get(pr,this._key):void 0},mr.prototype.set=function(er,pr){return Xt(er,!0)[this._key]=pr,this},mr.prototype.delete=function(er){var pr=Xt(er,!1);return void 0!==pr&&delete pr[this._key]},mr.prototype.clear=function(){this._key=St()},mr}();function St(){var mr;do{mr="@@WeakMap@@"+jt()}while(te.has(Ue,mr));return Ue[mr]=!0,mr}function Xt(mr,er){if(!ue.call(mr,_t)){if(!er)return;Object.defineProperty(mr,_t,{value:te.create()})}return mr[_t]}function Cr(mr,er){for(var pr=0;pr<er;++pr)mr[pr]=255*Math.random()|0;return mr}function jt(){var mr=function(mr){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(mr)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(mr)):Cr(new Uint8Array(mr),mr):Cr(new Array(mr),mr)}(16);mr[6]=79&mr[6]|64,mr[8]=191&mr[8]|128;for(var er="",pr=0;pr<16;++pr){var Ln=mr[pr];(4===pr||6===pr||8===pr)&&(er+="-"),Ln<16&&(er+="0"),er+=Ln.toString(16).toLowerCase()}return er}}():WeakMap);function Dt(B,Ue,_t){var St=tt.get(B);if(ze(St)){if(!_t)return;St=new et,tt.set(B,St)}var Xt=St.get(Ue);if(ze(Xt)){if(!_t)return;Xt=new et,St.set(Ue,Xt)}return Xt}function lr(B,Ue,_t){if(hr(B,Ue,_t))return!0;var Xt=G(Ue);return!pt(Xt)&&lr(B,Xt,_t)}function hr(B,Ue,_t){var St=Dt(Ue,_t,!1);return!ze(St)&&function(B){return!!B}(St.has(B))}function Dr(B,Ue,_t){if(hr(B,Ue,_t))return _e(B,Ue,_t);var Xt=G(Ue);return pt(Xt)?void 0:Dr(B,Xt,_t)}function _e(B,Ue,_t){var St=Dt(Ue,_t,!1);if(!ze(St))return St.get(B)}function ve(B,Ue,_t,St){Dt(_t,St,!0).set(B,Ue)}function ae(B,Ue){var _t=de(B,Ue),St=G(B);if(null===St)return _t;var Xt=ae(St,Ue);if(Xt.length<=0)return _t;if(_t.length<=0)return Xt;for(var Cr=new z,_r=[],jt=0,mr=_t;jt<mr.length;jt++)Cr.has(er=mr[jt])||(Cr.add(er),_r.push(er));for(var Ln=0,Wn=Xt;Ln<Wn.length;Ln++){var er;Cr.has(er=Wn[Ln])||(Cr.add(er),_r.push(er))}return _r}function de(B,Ue){var _t=[],St=Dt(B,Ue,!1);if(ze(St))return _t;for(var Cr=function(B){var Ue=Yt(B,_);if(!Le(Ue))throw new TypeError;var _t=Ue.call(B);if(!Ur(_t))throw new TypeError;return _t}(St.keys()),_r=0;;){var jt=Zn(Cr);if(!jt)return _t.length=_r,_t;var mr=Fr(jt);try{_t[_r]=mr}catch(er){try{T(Cr)}finally{throw er}}_r++}}function Pe(B){if(null===B)return 1;switch(typeof B){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===B?1:6;default:return 6}}function ze(B){return void 0===B}function pt(B){return null===B}function Ur(B){return"object"==typeof B?null!==B:"function"==typeof B}function fn(B,Ue){switch(Pe(B)){case 0:case 1:case 2:case 3:case 4:case 5:return B}var _t=3===Ue?"string":5===Ue?"number":"default",St=Yt(B,p);if(void 0!==St){var Xt=St.call(B,_t);if(Ur(Xt))throw new TypeError;return Xt}return function(B,Ue){if("string"===Ue){var _t=B.toString;if(Le(_t)&&!Ur(St=_t.call(B)))return St;if(Le(Xt=B.valueOf)&&!Ur(St=Xt.call(B)))return St}else{var Xt;if(Le(Xt=B.valueOf)&&!Ur(St=Xt.call(B)))return St;var St,Cr=B.toString;if(Le(Cr)&&!Ur(St=Cr.call(B)))return St}throw new TypeError}(B,"default"===_t?"number":_t)}function we(B){var Ue=fn(B,3);return function(B){return"symbol"==typeof B}(Ue)?Ue:function(B){return""+B}(Ue)}function nt(B){return Array.isArray?Array.isArray(B):B instanceof Object?B instanceof Array:"[object Array]"===Object.prototype.toString.call(B)}function Le(B){return"function"==typeof B}function Wt(B){return"function"==typeof B}function Yt(B,Ue){var _t=B[Ue];if(null!=_t){if(!Le(_t))throw new TypeError;return _t}}function Fr(B){return B.value}function Zn(B){var Ue=B.next();return!Ue.done&&Ue}function T(B){var Ue=B.return;Ue&&Ue.call(B)}function G(B){var Ue=Object.getPrototypeOf(B);if("function"!=typeof B||B===Y||Ue!==Y)return Ue;var _t=B.prototype,St=_t&&Object.getPrototypeOf(_t);if(null==St||St===Object.prototype)return Ue;var Xt=St.constructor;return"function"!=typeof Xt||Xt===B?Ue:Xt}function Ot(B){return B.__=void 0,delete B.__,B}M("decorate",function(B,Ue,_t,St){if(ze(_t)){if(!nt(B))throw new TypeError;if(!Wt(Ue))throw new TypeError;return function(B,Ue){for(var _t=B.length-1;_t>=0;--_t){var Xt=(0,B[_t])(Ue);if(!ze(Xt)&&!pt(Xt)){if(!Wt(Xt))throw new TypeError;Ue=Xt}}return Ue}(B,Ue)}if(!nt(B))throw new TypeError;if(!Ur(Ue))throw new TypeError;if(!Ur(St)&&!ze(St)&&!pt(St))throw new TypeError;return pt(St)&&(St=void 0),function(B,Ue,_t,St){for(var Xt=B.length-1;Xt>=0;--Xt){var _r=(0,B[Xt])(Ue,_t,St);if(!ze(_r)&&!pt(_r)){if(!Ur(_r))throw new TypeError;St=_r}}return St}(B,Ue,_t=we(_t),St)}),M("metadata",function(B,Ue){return function(St,Xt){if(!Ur(St))throw new TypeError;if(!ze(Xt)&&!function(B){switch(Pe(B)){case 3:case 4:return!0;default:return!1}}(Xt))throw new TypeError;ve(B,Ue,St,Xt)}}),M("defineMetadata",function(B,Ue,_t,St){if(!Ur(_t))throw new TypeError;return ze(St)||(St=we(St)),ve(B,Ue,_t,St)}),M("hasMetadata",function(B,Ue,_t){if(!Ur(Ue))throw new TypeError;return ze(_t)||(_t=we(_t)),lr(B,Ue,_t)}),M("hasOwnMetadata",function(B,Ue,_t){if(!Ur(Ue))throw new TypeError;return ze(_t)||(_t=we(_t)),hr(B,Ue,_t)}),M("getMetadata",function(B,Ue,_t){if(!Ur(Ue))throw new TypeError;return ze(_t)||(_t=we(_t)),Dr(B,Ue,_t)}),M("getOwnMetadata",function(B,Ue,_t){if(!Ur(Ue))throw new TypeError;return ze(_t)||(_t=we(_t)),_e(B,Ue,_t)}),M("getMetadataKeys",function(B,Ue){if(!Ur(B))throw new TypeError;return ze(Ue)||(Ue=we(Ue)),ae(B,Ue)}),M("getOwnMetadataKeys",function(B,Ue){if(!Ur(B))throw new TypeError;return ze(Ue)||(Ue=we(Ue)),de(B,Ue)}),M("deleteMetadata",function(B,Ue,_t){if(!Ur(Ue))throw new TypeError;ze(_t)||(_t=we(_t));var St=Dt(Ue,_t,!1);if(ze(St)||!St.delete(B))return!1;if(St.size>0)return!0;var Xt=tt.get(Ue);return Xt.delete(_t),Xt.size>0||tt.delete(Ue),!0})}(w)}()},67941:dr=>{var H=function(M){"use strict";var p,ue=Object.prototype,w=ue.hasOwnProperty,_="function"==typeof Symbol?Symbol:{},W=_.iterator||"@@iterator",X=_.asyncIterator||"@@asyncIterator",q=_.toStringTag||"@@toStringTag";function te(ve,ae,de){return Object.defineProperty(ve,ae,{value:de,enumerable:!0,configurable:!0,writable:!0}),ve[ae]}try{te({},"")}catch(ve){te=function(ae,de,Pe){return ae[de]=Pe}}function Y(ve,ae,de,Pe){var pt=Object.create((ae&&ae.prototype instanceof sr?ae:sr).prototype),br=new hr(Pe||[]);return pt._invoke=function(ve,ae,de){var Pe=et;return function(pt,br){if(Pe===Z)throw new Error("Generator is already running");if(Pe===tt){if("throw"===pt)throw br;return _e()}for(de.method=pt,de.arg=br;;){var Ur=de.delegate;if(Ur){var fn=qe(Ur,de);if(fn){if(fn===Mt)continue;return fn}}if("next"===de.method)de.sent=de._sent=de.arg;else if("throw"===de.method){if(Pe===et)throw Pe=tt,de.arg;de.dispatchException(de.arg)}else"return"===de.method&&de.abrupt("return",de.arg);Pe=Z;var Pr=Xe(ve,ae,de);if("normal"===Pr.type){if(Pe=de.done?tt:z,Pr.arg===Mt)continue;return{value:Pr.arg,done:de.done}}"throw"===Pr.type&&(Pe=tt,de.method="throw",de.arg=Pr.arg)}}}(ve,de,br),pt}function Xe(ve,ae,de){try{return{type:"normal",arg:ve.call(ae,de)}}catch(Pe){return{type:"throw",arg:Pe}}}M.wrap=Y;var et="suspendedStart",z="suspendedYield",Z="executing",tt="completed",Mt={};function sr(){}function Ut(){}function At(){}var Et={};te(Et,W,function(){return this});var vr=Object.getPrototypeOf,ne=vr&&vr(vr(Dr([])));ne&&ne!==ue&&w.call(ne,W)&&(Et=ne);var nr=At.prototype=sr.prototype=Object.create(Et);function Tt(ve){["next","throw","return"].forEach(function(ae){te(ve,ae,function(de){return this._invoke(ae,de)})})}function $e(ve,ae){function de(pt,br,Ur,fn){var Pr=Xe(ve[pt],ve,br);if("throw"!==Pr.type){var wt=Pr.arg,Ie=wt.value;return Ie&&"object"==typeof Ie&&w.call(Ie,"__await")?ae.resolve(Ie.__await).then(function(we){de("next",we,Ur,fn)},function(we){de("throw",we,Ur,fn)}):ae.resolve(Ie).then(function(we){wt.value=we,Ur(wt)},function(we){return de("throw",we,Ur,fn)})}fn(Pr.arg)}var Pe;this._invoke=function(pt,br){function Ur(){return new ae(function(fn,Pr){de(pt,br,fn,Pr)})}return Pe=Pe?Pe.then(Ur,Ur):Ur()}}function qe(ve,ae){var de=ve.iterator[ae.method];if(de===p){if(ae.delegate=null,"throw"===ae.method){if(ve.iterator.return&&(ae.method="return",ae.arg=p,qe(ve,ae),"throw"===ae.method))return Mt;ae.method="throw",ae.arg=new TypeError("The iterator does not provide a 'throw' method")}return Mt}var Pe=Xe(de,ve.iterator,ae.arg);if("throw"===Pe.type)return ae.method="throw",ae.arg=Pe.arg,ae.delegate=null,Mt;var ze=Pe.arg;return ze?ze.done?(ae[ve.resultName]=ze.value,ae.next=ve.nextLoc,"return"!==ae.method&&(ae.method="next",ae.arg=p),ae.delegate=null,Mt):ze:(ae.method="throw",ae.arg=new TypeError("iterator result is not an object"),ae.delegate=null,Mt)}function Dt(ve){var ae={tryLoc:ve[0]};1 in ve&&(ae.catchLoc=ve[1]),2 in ve&&(ae.finallyLoc=ve[2],ae.afterLoc=ve[3]),this.tryEntries.push(ae)}function lr(ve){var ae=ve.completion||{};ae.type="normal",delete ae.arg,ve.completion=ae}function hr(ve){this.tryEntries=[{tryLoc:"root"}],ve.forEach(Dt,this),this.reset(!0)}function Dr(ve){if(ve){var ae=ve[W];if(ae)return ae.call(ve);if("function"==typeof ve.next)return ve;if(!isNaN(ve.length)){var de=-1,Pe=function ze(){for(;++de<ve.length;)if(w.call(ve,de))return ze.value=ve[de],ze.done=!1,ze;return ze.value=p,ze.done=!0,ze};return Pe.next=Pe}}return{next:_e}}function _e(){return{value:p,done:!0}}return Ut.prototype=At,te(nr,"constructor",At),te(At,"constructor",Ut),Ut.displayName=te(At,q,"GeneratorFunction"),M.isGeneratorFunction=function(ve){var ae="function"==typeof ve&&ve.constructor;return!!ae&&(ae===Ut||"GeneratorFunction"===(ae.displayName||ae.name))},M.mark=function(ve){return Object.setPrototypeOf?Object.setPrototypeOf(ve,At):(ve.__proto__=At,te(ve,q,"GeneratorFunction")),ve.prototype=Object.create(nr),ve},M.awrap=function(ve){return{__await:ve}},Tt($e.prototype),te($e.prototype,X,function(){return this}),M.AsyncIterator=$e,M.async=function(ve,ae,de,Pe,ze){void 0===ze&&(ze=Promise);var pt=new $e(Y(ve,ae,de,Pe),ze);return M.isGeneratorFunction(ae)?pt:pt.next().then(function(br){return br.done?br.value:pt.next()})},Tt(nr),te(nr,q,"Generator"),te(nr,W,function(){return this}),te(nr,"toString",function(){return"[object Generator]"}),M.keys=function(ve){var ae=[];for(var de in ve)ae.push(de);return ae.reverse(),function Pe(){for(;ae.length;){var ze=ae.pop();if(ze in ve)return Pe.value=ze,Pe.done=!1,Pe}return Pe.done=!0,Pe}},M.values=Dr,hr.prototype={constructor:hr,reset:function(ve){if(this.prev=0,this.next=0,this.sent=this._sent=p,this.done=!1,this.delegate=null,this.method="next",this.arg=p,this.tryEntries.forEach(lr),!ve)for(var ae in this)"t"===ae.charAt(0)&&w.call(this,ae)&&!isNaN(+ae.slice(1))&&(this[ae]=p)},stop:function(){this.done=!0;var ae=this.tryEntries[0].completion;if("throw"===ae.type)throw ae.arg;return this.rval},dispatchException:function(ve){if(this.done)throw ve;var ae=this;function de(fn,Pr){return pt.type="throw",pt.arg=ve,ae.next=fn,Pr&&(ae.method="next",ae.arg=p),!!Pr}for(var Pe=this.tryEntries.length-1;Pe>=0;--Pe){var ze=this.tryEntries[Pe],pt=ze.completion;if("root"===ze.tryLoc)return de("end");if(ze.tryLoc<=this.prev){var br=w.call(ze,"catchLoc"),Ur=w.call(ze,"finallyLoc");if(br&&Ur){if(this.prev<ze.catchLoc)return de(ze.catchLoc,!0);if(this.prev<ze.finallyLoc)return de(ze.finallyLoc)}else if(br){if(this.prev<ze.catchLoc)return de(ze.catchLoc,!0)}else{if(!Ur)throw new Error("try statement without catch or finally");if(this.prev<ze.finallyLoc)return de(ze.finallyLoc)}}}},abrupt:function(ve,ae){for(var de=this.tryEntries.length-1;de>=0;--de){var Pe=this.tryEntries[de];if(Pe.tryLoc<=this.prev&&w.call(Pe,"finallyLoc")&&this.prev<Pe.finallyLoc){var ze=Pe;break}}ze&&("break"===ve||"continue"===ve)&&ze.tryLoc<=ae&&ae<=ze.finallyLoc&&(ze=null);var pt=ze?ze.completion:{};return pt.type=ve,pt.arg=ae,ze?(this.method="next",this.next=ze.finallyLoc,Mt):this.complete(pt)},complete:function(ve,ae){if("throw"===ve.type)throw ve.arg;return"break"===ve.type||"continue"===ve.type?this.next=ve.arg:"return"===ve.type?(this.rval=this.arg=ve.arg,this.method="return",this.next="end"):"normal"===ve.type&&ae&&(this.next=ae),Mt},finish:function(ve){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var de=this.tryEntries[ae];if(de.finallyLoc===ve)return this.complete(de.completion,de.afterLoc),lr(de),Mt}},catch:function(ve){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var de=this.tryEntries[ae];if(de.tryLoc===ve){var Pe=de.completion;if("throw"===Pe.type){var ze=Pe.arg;lr(de)}return ze}}throw new Error("illegal catch attempt")},delegateYield:function(ve,ae,de){return this.delegate={iterator:Dr(ve),resultName:ae,nextLoc:de},"next"===this.method&&(this.arg=p),Mt}},M}(dr.exports);try{regeneratorRuntime=H}catch(M){"object"==typeof globalThis?globalThis.regeneratorRuntime=H:Function("r","regeneratorRuntime = r")(H)}},20878:function(dr){dr.exports=function(){"use strict";function H(Tt,$e,Ct,qe,Dt,lr){if(!(Dt-qe<=Ct)){var hr=qe+Dt>>1;M(Tt,$e,hr,qe,Dt,lr%2),H(Tt,$e,Ct,qe,hr-1,lr+1),H(Tt,$e,Ct,hr+1,Dt,lr+1)}}function M(Tt,$e,Ct,qe,Dt,lr){for(;Dt>qe;){if(Dt-qe>600){var hr=Dt-qe+1,Dr=Ct-qe+1,_e=Math.log(hr),ve=.5*Math.exp(2*_e/3),ae=.5*Math.sqrt(_e*ve*(hr-ve)/hr)*(Dr-hr/2<0?-1:1);M(Tt,$e,Ct,Math.max(qe,Math.floor(Ct-Dr*ve/hr+ae)),Math.min(Dt,Math.floor(Ct+(hr-Dr)*ve/hr+ae)),lr)}var ze=$e[2*Ct+lr],pt=qe,br=Dt;for(ue(Tt,$e,qe,Ct),$e[2*Dt+lr]>ze&&ue(Tt,$e,qe,Dt);pt<br;){for(ue(Tt,$e,pt,br),pt++,br--;$e[2*pt+lr]<ze;)pt++;for(;$e[2*br+lr]>ze;)br--}$e[2*qe+lr]===ze?ue(Tt,$e,qe,br):ue(Tt,$e,++br,Dt),br<=Ct&&(qe=br+1),Ct<=br&&(Dt=br-1)}}function ue(Tt,$e,Ct,qe){w(Tt,Ct,qe),w($e,2*Ct,2*qe),w($e,2*Ct+1,2*qe+1)}function w(Tt,$e,Ct){var qe=Tt[$e];Tt[$e]=Tt[Ct],Tt[Ct]=qe}function W(Tt,$e,Ct,qe){var Dt=Tt-Ct,lr=$e-qe;return Dt*Dt+lr*lr}var X=function(Tt){return Tt[0]},q=function(Tt){return Tt[1]},te=function($e,Ct,qe,Dt,lr){void 0===Ct&&(Ct=X),void 0===qe&&(qe=q),void 0===Dt&&(Dt=64),void 0===lr&&(lr=Float64Array),this.nodeSize=Dt,this.points=$e;for(var hr=$e.length<65536?Uint16Array:Uint32Array,Dr=this.ids=new hr($e.length),_e=this.coords=new lr(2*$e.length),ve=0;ve<$e.length;ve++)Dr[ve]=ve,_e[2*ve]=Ct($e[ve]),_e[2*ve+1]=qe($e[ve]);H(Dr,_e,Dt,0,Dr.length-1,0)};te.prototype.range=function($e,Ct,qe,Dt){return function(Tt,$e,Ct,qe,Dt,lr,hr){for(var ve,ae,Dr=[0,Tt.length-1,0],_e=[];Dr.length;){var de=Dr.pop(),Pe=Dr.pop(),ze=Dr.pop();if(Pe-ze<=hr)for(var pt=ze;pt<=Pe;pt++)ae=$e[2*pt+1],(ve=$e[2*pt])>=Ct&&ve<=Dt&&ae>=qe&&ae<=lr&&_e.push(Tt[pt]);else{var br=Math.floor((ze+Pe)/2);ae=$e[2*br+1],(ve=$e[2*br])>=Ct&&ve<=Dt&&ae>=qe&&ae<=lr&&_e.push(Tt[br]);var Ur=(de+1)%2;(0===de?Ct<=ve:qe<=ae)&&(Dr.push(ze),Dr.push(br-1),Dr.push(Ur)),(0===de?Dt>=ve:lr>=ae)&&(Dr.push(br+1),Dr.push(Pe),Dr.push(Ur))}}return _e}(this.ids,this.coords,$e,Ct,qe,Dt,this.nodeSize)},te.prototype.within=function($e,Ct,qe){return function(Tt,$e,Ct,qe,Dt,lr){for(var hr=[0,Tt.length-1,0],Dr=[],_e=Dt*Dt;hr.length;){var ve=hr.pop(),ae=hr.pop(),de=hr.pop();if(ae-de<=lr)for(var Pe=de;Pe<=ae;Pe++)W($e[2*Pe],$e[2*Pe+1],Ct,qe)<=_e&&Dr.push(Tt[Pe]);else{var ze=Math.floor((de+ae)/2),pt=$e[2*ze],br=$e[2*ze+1];W(pt,br,Ct,qe)<=_e&&Dr.push(Tt[ze]);var Ur=(ve+1)%2;(0===ve?Ct-Dt<=pt:qe-Dt<=br)&&(hr.push(de),hr.push(ze-1),hr.push(Ur)),(0===ve?Ct+Dt>=pt:qe+Dt>=br)&&(hr.push(ze+1),hr.push(ae),hr.push(Ur))}}return Dr}(this.ids,this.coords,$e,Ct,qe,this.nodeSize)};var Tt,Y={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Tt){return Tt}},Xe=Math.fround||(Tt=new Float32Array(1),function($e){return Tt[0]=+$e,Tt[0]}),et=function($e){this.options=vr(Object.create(Y),$e),this.trees=new Array(this.options.maxZoom+1)};function z(Tt,$e,Ct,qe,Dt){return{x:Xe(Tt),y:Xe($e),zoom:1/0,id:Ct,parentId:-1,numPoints:qe,properties:Dt}}function Z(Tt,$e){var Ct=Tt.geometry.coordinates,Dt=Ct[1];return{x:Xe(sr(Ct[0])),y:Xe(Ut(Dt)),zoom:1/0,index:$e,parentId:-1}}function tt(Tt){return{type:"Feature",id:Tt.id,properties:Mt(Tt),geometry:{type:"Point",coordinates:[At(Tt.x),Et(Tt.y)]}}}function Mt(Tt){var $e=Tt.numPoints,Ct=$e>=1e4?Math.round($e/1e3)+"k":$e>=1e3?Math.round($e/100)/10+"k":$e;return vr(vr({},Tt.properties),{cluster:!0,cluster_id:Tt.id,point_count:$e,point_count_abbreviated:Ct})}function sr(Tt){return Tt/360+.5}function Ut(Tt){var $e=Math.sin(Tt*Math.PI/180),Ct=.5-.25*Math.log((1+$e)/(1-$e))/Math.PI;return Ct<0?0:Ct>1?1:Ct}function At(Tt){return 360*(Tt-.5)}function Et(Tt){var $e=(180-360*Tt)*Math.PI/180;return 360*Math.atan(Math.exp($e))/Math.PI-90}function vr(Tt,$e){for(var Ct in $e)Tt[Ct]=$e[Ct];return Tt}function ne(Tt){return Tt.x}function nr(Tt){return Tt.y}return et.prototype.load=function($e){var Ct=this.options,qe=Ct.log,Dt=Ct.minZoom,lr=Ct.maxZoom,hr=Ct.nodeSize;qe&&console.time("total time");var Dr="prepare "+$e.length+" points";qe&&console.time(Dr),this.points=$e;for(var _e=[],ve=0;ve<$e.length;ve++)!$e[ve].geometry||_e.push(Z($e[ve],ve));this.trees[lr+1]=new te(_e,ne,nr,hr,Float32Array),qe&&console.timeEnd(Dr);for(var ae=lr;ae>=Dt;ae--){var de=+Date.now();_e=this._cluster(_e,ae),this.trees[ae]=new te(_e,ne,nr,hr,Float32Array),qe&&console.log("z%d: %d clusters in %dms",ae,_e.length,+Date.now()-de)}return qe&&console.timeEnd("total time"),this},et.prototype.getClusters=function($e,Ct){var qe=(($e[0]+180)%360+360)%360-180,Dt=Math.max(-90,Math.min(90,$e[1])),lr=180===$e[2]?180:(($e[2]+180)%360+360)%360-180,hr=Math.max(-90,Math.min(90,$e[3]));if($e[2]-$e[0]>=360)qe=-180,lr=180;else if(qe>lr){var Dr=this.getClusters([qe,Dt,180,hr],Ct),_e=this.getClusters([-180,Dt,lr,hr],Ct);return Dr.concat(_e)}for(var ve=this.trees[this._limitZoom(Ct)],de=[],Pe=0,ze=ve.range(sr(qe),Ut(hr),sr(lr),Ut(Dt));Pe<ze.length;Pe+=1){var br=ve.points[ze[Pe]];de.push(br.numPoints?tt(br):this.points[br.index])}return de},et.prototype.getChildren=function($e){var Ct=this._getOriginId($e),qe=this._getOriginZoom($e),Dt="No cluster with the specified id.",lr=this.trees[qe];if(!lr)throw new Error(Dt);var hr=lr.points[Ct];if(!hr)throw new Error(Dt);for(var Dr=this.options.radius/(this.options.extent*Math.pow(2,qe-1)),ve=[],ae=0,de=lr.within(hr.x,hr.y,Dr);ae<de.length;ae+=1){var ze=lr.points[de[ae]];ze.parentId===$e&&ve.push(ze.numPoints?tt(ze):this.points[ze.index])}if(0===ve.length)throw new Error(Dt);return ve},et.prototype.getLeaves=function($e,Ct,qe){var Dt=[];return this._appendLeaves(Dt,$e,Ct=Ct||10,qe=qe||0,0),Dt},et.prototype.getTile=function($e,Ct,qe){var Dt=this.trees[this._limitZoom($e)],lr=Math.pow(2,$e),hr=this.options,ve=hr.radius/hr.extent,ae=(qe-ve)/lr,de=(qe+1+ve)/lr,Pe={features:[]};return this._addTileFeatures(Dt.range((Ct-ve)/lr,ae,(Ct+1+ve)/lr,de),Dt.points,Ct,qe,lr,Pe),0===Ct&&this._addTileFeatures(Dt.range(1-ve/lr,ae,1,de),Dt.points,lr,qe,lr,Pe),Ct===lr-1&&this._addTileFeatures(Dt.range(0,ae,ve/lr,de),Dt.points,-1,qe,lr,Pe),Pe.features.length?Pe:null},et.prototype.getClusterExpansionZoom=function($e){for(var Ct=this._getOriginZoom($e)-1;Ct<=this.options.maxZoom;){var qe=this.getChildren($e);if(Ct++,1!==qe.length)break;$e=qe[0].properties.cluster_id}return Ct},et.prototype._appendLeaves=function($e,Ct,qe,Dt,lr){for(var Dr=0,_e=this.getChildren(Ct);Dr<_e.length;Dr+=1){var ve=_e[Dr],ae=ve.properties;if(ae&&ae.cluster?lr+ae.point_count<=Dt?lr+=ae.point_count:lr=this._appendLeaves($e,ae.cluster_id,qe,Dt,lr):lr<Dt?lr++:$e.push(ve),$e.length===qe)break}return lr},et.prototype._addTileFeatures=function($e,Ct,qe,Dt,lr,hr){for(var Dr=0,_e=$e;Dr<_e.length;Dr+=1){var ae=Ct[_e[Dr]],de=ae.numPoints,Pe=void 0,ze=void 0,pt=void 0;if(de)Pe=Mt(ae),ze=ae.x,pt=ae.y;else{var br=this.points[ae.index];Pe=br.properties,ze=sr(br.geometry.coordinates[0]),pt=Ut(br.geometry.coordinates[1])}var Ur={type:1,geometry:[[Math.round(this.options.extent*(ze*lr-qe)),Math.round(this.options.extent*(pt*lr-Dt))]],tags:Pe},fn=void 0;de?fn=ae.id:this.options.generateId?fn=ae.index:this.points[ae.index].id&&(fn=this.points[ae.index].id),void 0!==fn&&(Ur.id=fn),hr.features.push(Ur)}},et.prototype._limitZoom=function($e){return Math.max(this.options.minZoom,Math.min(+$e,this.options.maxZoom+1))},et.prototype._cluster=function($e,Ct){for(var qe=[],Dt=this.options,Dr=Dt.reduce,_e=Dt.minPoints,ve=Dt.radius/(Dt.extent*Math.pow(2,Ct)),ae=0;ae<$e.length;ae++){var de=$e[ae];if(!(de.zoom<=Ct)){de.zoom=Ct;for(var Pe=this.trees[Ct+1],ze=Pe.within(de.x,de.y,ve),pt=de.numPoints||1,br=pt,Ur=0,fn=ze;Ur<fn.length;Ur+=1){var wt=Pe.points[fn[Ur]];wt.zoom>Ct&&(br+=wt.numPoints||1)}if(br>pt&&br>=_e){for(var Ie=de.x*pt,we=de.y*pt,nt=Dr&&pt>1?this._map(de,!0):null,Le=(ae<<5)+(Ct+1)+this.points.length,Wt=0,Ar=ze;Wt<Ar.length;Wt+=1){var cr=Pe.points[Ar[Wt]];if(!(cr.zoom<=Ct)){cr.zoom=Ct;var Fr=cr.numPoints||1;Ie+=cr.x*Fr,we+=cr.y*Fr,cr.parentId=Le,Dr&&(nt||(nt=this._map(de,!0)),Dr(nt,this._map(cr)))}}de.parentId=Le,qe.push(z(Ie/br,we/br,Le,br,nt))}else if(qe.push(de),br>1)for(var Zn=0,T=ze;Zn<T.length;Zn+=1){var Ve=Pe.points[T[Zn]];Ve.zoom<=Ct||(Ve.zoom=Ct,qe.push(Ve))}}}return qe},et.prototype._getOriginId=function($e){return $e-this.points.length>>5},et.prototype._getOriginZoom=function($e){return($e-this.points.length)%32},et.prototype._map=function($e,Ct){if($e.numPoints)return Ct?vr({},$e.properties):$e.properties;var qe=this.points[$e.index].properties,Dt=this.options.map(qe);return Ct&&Dt===qe?vr({},Dt):Dt},et}()},96847:dr=>{dr.exports.RADIUS=6378137,dr.exports.FLATTENING=1/298.257223563,dr.exports.POLAR_RADIUS=6356752.3142},31073:(dr,H,M)=>{"use strict";M.r(H),M.d(H,{DashboardModule:()=>Gg});var ue={};M.r(ue),M.d(ue,{add:()=>si,angle:()=>oi,bezier:()=>qt,ceil:()=>Ei,clone:()=>pr,copy:()=>mi,create:()=>er,cross:()=>Br,dist:()=>Xi,distance:()=>Me,div:()=>Bi,divide:()=>Pi,dot:()=>$t,equals:()=>_a,exactEquals:()=>Ti,floor:()=>Q,forEach:()=>Wi,fromValues:()=>Wn,hermite:()=>Cn,inverse:()=>wr,len:()=>Ho,length:()=>Ln,lerp:()=>On,max:()=>ge,min:()=>he,mul:()=>Gi,multiply:()=>Yi,negate:()=>mt,normalize:()=>Vt,random:()=>xn,rotateX:()=>gn,rotateY:()=>Oi,rotateZ:()=>ta,round:()=>F,scale:()=>re,scaleAndAdd:()=>ye,set:()=>hi,sqrDist:()=>to,sqrLen:()=>Za,squaredDistance:()=>ce,squaredLength:()=>Te,str:()=>ji,sub:()=>Ma,subtract:()=>ai,transformMat3:()=>ln,transformMat4:()=>nn,transformQuat:()=>Di,zero:()=>Ji});var w=M(38583),p=M(39895),_=M(37716),W=M(16704),X=M(75134),q=M(47289),te=M(66518),Y=M(41885),Xe=M(59553),et=M(99187),z=M(93512),Z=M(42837),tt=M(30832),Mt=M(42624);function sr(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Ut(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?sr(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):sr(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var vr=0,ne=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(u){var f;return(0,X.Z)(this,i),f=l.call(this),(0,z.Z)((0,te.Z)(f),"controlOption",void 0),(0,z.Z)((0,te.Z)(f),"container",void 0),(0,z.Z)((0,te.Z)(f),"sceneContainer",void 0),(0,z.Z)((0,te.Z)(f),"mapsService",void 0),(0,z.Z)((0,te.Z)(f),"renderService",void 0),(0,z.Z)((0,te.Z)(f),"layerService",void 0),(0,z.Z)((0,te.Z)(f),"controlService",void 0),(0,z.Z)((0,te.Z)(f),"isShow",void 0),f.controlOption=Ut(Ut({},f.getDefault()),u||{}),f}return(0,q.Z)(i,[{key:"getDefault",value:function(){return{position:Z.PositionType.TOPRIGHT,name:"".concat(vr++)}}},{key:"setPosition",value:function(){var f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z.PositionType.BOTTOMRIGHT,v=this.controlService;return v&&v.removeControl(this),this.controlOption.position=f,v&&v.addControl(this,this.sceneContainer),this}},{key:"addTo",value:function(f){this.mapsService=f.get(Z.vK.IMapService),this.renderService=f.get(Z.vK.IRendererService),this.layerService=f.get(Z.vK.ILayerService),this.controlService=f.get(Z.vK.IControlService),this.sceneContainer=f,this.isShow=!0,this.container=this.onAdd();var v=this.container,b=this.controlOption.position,P=this.controlService.controlCorners[b];return tt.SO.addClass(v,"l7-control"),-1!==b.indexOf("bottom")?P.insertBefore(v,P.firstChild):P.appendChild(v),this}},{key:"onAdd",value:function(){throw new Error("Method not implemented.")}},{key:"onRemove",value:function(){throw new Error("Method not implemented.")}},{key:"hide",value:function(){tt.SO.addClass(this.container,"l7-control-hide"),this.isShow=!1}},{key:"show",value:function(){tt.SO.removeClass(this.container,"l7-control-hide"),this.isShow=!0}},{key:"remove",value:function(){if(!this.mapsService)return this;tt.SO.remove(this.container),this.onRemove()}},{key:"_refocusOnMap",value:function(f){if(this.mapsService&&f&&f.screenX>0&&f.screenY>0){var v=this.mapsService.getContainer();null!==v&&v.focus()}}}]),i}(Mt.EventEmitter);var $e=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(u){var f;return(0,X.Z)(this,i),f=l.call(this,u),(0,z.Z)((0,te.Z)(f),"layerControlInputs",void 0),(0,z.Z)((0,te.Z)(f),"layers",void 0),(0,z.Z)((0,te.Z)(f),"lastZIndex",void 0),(0,z.Z)((0,te.Z)(f),"handlingClick",void 0),(0,z.Z)((0,te.Z)(f),"layersLink",void 0),(0,z.Z)((0,te.Z)(f),"baseLayersList",void 0),(0,z.Z)((0,te.Z)(f),"separator",void 0),(0,z.Z)((0,te.Z)(f),"overlaysList",void 0),(0,z.Z)((0,te.Z)(f),"form",void 0),f.layerControlInputs=[],f.layers=[],f.lastZIndex=0,f.handlingClick=!1,f.initLayers(),(0,tt.Ev)(["checkDisabledLayers","onLayerChange","collapse","extend","expand","onInputClick"],(0,te.Z)(f)),f}return(0,q.Z)(i,[{key:"getDefault",value:function(){return{collapsed:!0,position:Z.PositionType.TOPRIGHT,autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,name:"layers"}}},{key:"onAdd",value:function(){var f=this;return this.initLayout(),this.update(),this.mapsService.on("zoomend",this.checkDisabledLayers),this.layers.forEach(function(v){v.layer.on("remove",f.onLayerChange),v.layer.on("add",f.onLayerChange)}),this.container}},{key:"addVisualLayer",value:function(f,v){return this.addLayer(f,v,!0),this.mapsService?this.update():this}},{key:"expand",value:function(){var v=this.renderService.getViewportSize().height;tt.SO.addClass(this.container,"l7-control-layers-expanded"),this.form.style.height="null";var b=v-(this.container.offsetTop+50);return b<this.form.clientHeight?(tt.SO.addClass(this.form,"l7-control-layers-scrollbar"),this.form.style.height=b+"px"):tt.SO.removeClass(this.form,"l7-control-layers-scrollbar"),this.checkDisabledLayers(),this}},{key:"collapse",value:function(){return tt.SO.removeClass(this.container,"l7-control-layers-expanded"),this}},{key:"onRemove",value:function(){var f=this;!this.mapsService||(this.mapsService.off("click",this.collapse),this.layers.forEach(function(v){v.layer.off("remove",f.onLayerChange),v.layer.off("add",f.onLayerChange)}))}},{key:"initLayout",value:function(){var f="l7-control-layers",v=this.container=tt.SO.create("div",f),b=this.controlOption.collapsed;v.setAttribute("aria-haspopup","true");var P=this.form=tt.SO.create("form",f+"-list");b&&(this.mapsService.on("click",this.collapse),v.addEventListener("mouseenter",this.expand),v.addEventListener("mouseleave",this.collapse)),this.layersLink=tt.SO.create("a",f+"-toggle",v),this.layersLink.title="Layers",b||this.expand(),this.baseLayersList=tt.SO.create("div",f+"-base",P),this.separator=tt.SO.create("div",f+"-separator",P),this.overlaysList=tt.SO.create("div",f+"-overlays",P),v.appendChild(P)}},{key:"initLayers",value:function(){var f=this,v=this.controlOption,b=v.baseLayers,P=void 0===b?{}:b,I=v.overlayers,N=void 0===I?{}:I;Object.keys(P).forEach(function(se,ie){f.addLayer(P[se],se,!1)}),Object.keys(N).forEach(function(se,ie){f.addLayer(N[se],se,!0)})}},{key:"update",value:function(){if(!this.container)return this;tt.SO.empty(this.baseLayersList),tt.SO.empty(this.overlaysList),this.layerControlInputs=[];var f,v,b,P,I=0;for(b=0;b<this.layers.length;b++)this.addItem(P=this.layers[b]),v=v||P.overlay,f=f||!P.overlay,I+=P.overlay?0:1;return this.controlOption.hideSingleBase&&(this.baseLayersList.style.display=(f=f&&I>1)?"":"none"),this.separator.style.display=v&&f?"":"none",this}},{key:"checkDisabledLayers",value:function(){for(var v,b,f=this.layerControlInputs,P=this.mapsService.getZoom(),I=f.length-1;I>=0;I--)if((b=this.layerService.getLayer((v=f[I]).layerId))&&b.inited){var N=b.getMinZoom(),se=b.getMaxZoom();v.disabled=P<N||P>se}}},{key:"addLayer",value:function(f,v,b){this.mapsService&&(f.on("add",this.onLayerChange),f.on("remove",this.onLayerChange)),this.layers.push({layer:f,name:v,overlay:b});var P=this.controlOption,N=P.sortFunction,se=P.autoZIndex;P.sortLayers&&this.layers.sort(function(ie,Re){return N(ie.layer,Re.layer,ie.name,Re.name)}),se&&f.setZIndex&&(this.lastZIndex++,f.setZIndex(this.lastZIndex)),this.expandIfNotCollapsed()}},{key:"expandIfNotCollapsed",value:function(){return this.mapsService&&!this.controlOption.collapsed&&this.expand(),this}},{key:"onLayerChange",value:function(f){this.handlingClick||this.update();var v=this.layerService.getLayer(f.target.layerId),b=null!=v&&v.overlay?"add"===f.type?"overlayadd":"overlayremove":"add"===f.type?"baselayerchange":null;b&&this.emit(b,v)}},{key:"createRadioElement",value:function(f,v){var b='<input type="radio" class="l7-control-layers-selector" name="'+f+'"'+(v?' checked="checked"':"")+"/>",P=document.createElement("div");return P.innerHTML=b,P.firstChild}},{key:"addItem",value:function(f){var I,v=document.createElement("label"),b=this.layerService.getLayer(f.layer.id),P=b&&b.inited&&f.layer.isVisible();f.overlay?((I=document.createElement("input")).type="checkbox",I.className="l7-control-layers-selector",I.defaultChecked=P):I=this.createRadioElement("l7-base-layers",P),this.layerControlInputs.push(I),I.layerId=f.layer.id,I.addEventListener("click",this.onInputClick);var N=document.createElement("span");N.innerHTML=" "+f.name;var se=document.createElement("div");return v.appendChild(se),se.appendChild(I),se.appendChild(N),(f.overlay?this.overlaysList:this.baseLayersList).appendChild(v),this.checkDisabledLayers(),v}},{key:"onInputClick",value:function(){var v,b,f=this.layerControlInputs,P=[],I=[];this.handlingClick=!0;for(var N=f.length-1;N>=0;N--)b=this.layerService.getLayer((v=f[N]).layerId),v.checked?P.push(b):v.checked||I.push(b);I.forEach(function(se){se.hide()}),P.forEach(function(se){se.show()}),this.handlingClick=!1}}]),i}(ne);var Dt=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){return(0,X.Z)(this,i),l.apply(this,arguments)}return(0,q.Z)(i,[{key:"getDefault",value:function(){return{position:Z.PositionType.BOTTOMLEFT,name:"logo"}}},{key:"onAdd",value:function(){var v=tt.SO.create("div","l7-control-logo"),b=tt.SO.create("a","l7-ctrl-logo");return b.target="_blank",b.rel="noopener nofollow",b.href="https://antv.alipay.com/l7",b.setAttribute("aria-label","AntV logo"),b.setAttribute("rel","noopener nofollow"),v.appendChild(b),v}},{key:"onRemove",value:function(){return null}}]),i}(ne);var Dr=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(u){var f;return(0,X.Z)(this,i),f=l.call(this,u),(0,z.Z)((0,te.Z)(f),"mScale",void 0),(0,z.Z)((0,te.Z)(f),"iScale",void 0),(0,tt.Ev)(["update"],(0,te.Z)(f)),f}return(0,q.Z)(i,[{key:"getDefault",value:function(){return{position:Z.PositionType.BOTTOMLEFT,maxWidth:100,metric:!0,updateWhenIdle:!1,imperial:!1,name:"scale"}}},{key:"onAdd",value:function(){var f="l7-control-scale",v=tt.SO.create("div",f);this.addScales(f+"-line",v);var b=this.controlOption.updateWhenIdle;return this.mapsService.on(b?"moveend":"mapmove",this.update),this.mapsService.on(b?"zoomend":"zoomchange",this.update),this.update(),v}},{key:"onRemove",value:function(){var f=this.controlOption.updateWhenIdle;this.mapsService.off(f?"zoomend":"zoomchange",this.update),this.mapsService.off(f?"moveend":"mapmove",this.update)}},{key:"update",value:function(){var f=this.mapsService,v=this.controlOption.maxWidth,b=f.getSize()[1]/2,P=f.containerToLngLat([0,b]),I=f.containerToLngLat([v,b]),N=(0,tt.yM)([P.lng,P.lat],[I.lng,I.lat]);this.updateScales(N)}},{key:"updateScales",value:function(f){var v=this.controlOption,P=v.imperial;v.metric&&f&&this.updateMetric(f),P&&f&&this.updateImperial(f)}},{key:"updateMetric",value:function(f){var v=this.getRoundNum(f);this.updateScale(this.mScale,v<1e3?v+" m":v/1e3+" km",v/f)}},{key:"updateImperial",value:function(f){var b,P,I,v=3.2808399*f;v>5280?(P=this.getRoundNum(b=v/5280),this.updateScale(this.iScale,P+" mi",P/b)):(I=this.getRoundNum(v),this.updateScale(this.iScale,I+" ft",I/v))}},{key:"updateScale",value:function(f,v,b){f.style.width=Math.round(this.controlOption.maxWidth*b)+"px",f.innerHTML=v}},{key:"getRoundNum",value:function(f){var v=Math.pow(10,(Math.floor(f)+"").length-1),b=f/v;return v*(b>=10?10:b>=5?5:b>=3?3:b>=2?2:1)}},{key:"addScales",value:function(f,v){var b=this.controlOption,I=b.imperial;b.metric&&(this.mScale=tt.SO.create("div",f,v)),I&&(this.iScale=tt.SO.create("div",f,v))}}]),i}(ne);var ae=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(u){var f;return(0,X.Z)(this,i),f=l.call(this,u),(0,z.Z)((0,te.Z)(f),"disabled",void 0),(0,z.Z)((0,te.Z)(f),"zoomInButton",void 0),(0,z.Z)((0,te.Z)(f),"zoomOutButton",void 0),(0,tt.Ev)(["updateDisabled","zoomIn","zoomOut"],(0,te.Z)(f)),f}return(0,q.Z)(i,[{key:"getDefault",value:function(){return{position:Z.PositionType.TOPLEFT,zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out",name:"zoom"}}},{key:"onAdd",value:function(){var f="l7-control-zoom",v=tt.SO.create("div",f+" l7-bar");return this.zoomInButton=this.createButton(this.controlOption.zoomInText,this.controlOption.zoomInTitle,f+"-in",v,this.zoomIn),this.zoomOutButton=this.createButton(this.controlOption.zoomOutText,this.controlOption.zoomOutTitle,f+"-out",v,this.zoomOut),this.mapsService.on("zoomend",this.updateDisabled),this.mapsService.on("zoomchange",this.updateDisabled),this.updateDisabled(),v}},{key:"onRemove",value:function(){this.mapsService.off("zoomend",this.updateDisabled),this.mapsService.off("zoomchange",this.updateDisabled)}},{key:"disable",value:function(){return this.disabled=!0,this.updateDisabled(),this}},{key:"enable",value:function(){return this.disabled=!1,this.updateDisabled(),this}},{key:"zoomIn",value:function(){!this.disabled&&this.mapsService.getZoom()<this.mapsService.getMaxZoom()&&this.mapsService.zoomIn()}},{key:"zoomOut",value:function(){!this.disabled&&this.mapsService.getZoom()>this.mapsService.getMinZoom()&&this.mapsService.zoomOut()}},{key:"createButton",value:function(f,v,b,P,I){var N=tt.SO.create("a",b,P);return N.innerHTML=f,N.title=v,N.href="javascript:void(0)",N.addEventListener("click",I),N}},{key:"updateDisabled",value:function(){var f=this.mapsService,v="l7-disabled";tt.SO.removeClass(this.zoomInButton,v),tt.SO.removeClass(this.zoomOutButton,v),(this.disabled||f.getZoom()<=f.getMinZoom())&&tt.SO.addClass(this.zoomOutButton,v),(this.disabled||f.getZoom()>=f.getMaxZoom())&&tt.SO.addClass(this.zoomInButton,v)}}]),i}(ne);function de(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Pe(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?de(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):de(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var br=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(u){var f;return(0,X.Z)(this,i),f=l.call(this),(0,z.Z)((0,te.Z)(f),"markerOption",void 0),(0,z.Z)((0,te.Z)(f),"defaultMarker",void 0),(0,z.Z)((0,te.Z)(f),"popup",void 0),(0,z.Z)((0,te.Z)(f),"mapsService",void 0),(0,z.Z)((0,te.Z)(f),"sceneSerive",void 0),(0,z.Z)((0,te.Z)(f),"lngLat",void 0),(0,z.Z)((0,te.Z)(f),"scene",void 0),(0,z.Z)((0,te.Z)(f),"added",!1),(0,z.Z)((0,te.Z)(f),"eventHandle",function(v){f.emit(v.type,{target:v,data:f.markerOption.extData,lngLat:f.lngLat})}),f.markerOption=Pe(Pe({},f.getDefault()),u),(0,tt.Ev)(["update","onMove","onUp","addDragHandler","onMapClick"],(0,te.Z)(f)),f.init(),f}return(0,q.Z)(i,[{key:"getDefault",value:function(){return{element:void 0,anchor:tt.bV.BOTTOM,offsets:[0,0],color:"#5B8FF9",draggable:!1}}},{key:"addTo",value:function(f){this.scene=f,this.mapsService=f.get(Z.vK.IMapService),this.sceneSerive=f.get(Z.vK.ISceneService);var b=this.markerOption.element;return this.mapsService.getMarkerContainer().appendChild(b),this.registerMarkerEvent(b),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.update(),this.added=!0,this.emit("added"),this}},{key:"remove",value:function(){this.mapsService&&(this.mapsService.off("click",this.onMapClick),this.mapsService.off("move",this.update),this.mapsService.off("moveend",this.update),this.mapsService.off("mousedown",this.addDragHandler),this.mapsService.off("touchstart",this.addDragHandler),this.mapsService.off("mouseup",this.onUp),this.mapsService.off("touchend",this.onUp)),this.unRegisterMarkerEvent(),this.removeAllListeners();var f=this.markerOption.element;return f&&tt.SO.remove(f),this.popup&&this.popup.remove(),this}},{key:"setLnglat",value:function(f){return this.lngLat=f,Array.isArray(f)&&(this.lngLat={lng:f[0],lat:f[1]}),this.popup&&this.popup.setLnglat(this.lngLat),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"getElement",value:function(){return this.markerOption.element}},{key:"setElement",value:function(f){var v=this;if(!this.added)return this.once("added",function(){v.setElement(f)}),this;var b=this.markerOption.element;return b&&tt.SO.remove(b),this.markerOption.element=f,this.init(),this.mapsService.getMarkerContainer().appendChild(f),this.registerMarkerEvent(f),this.update(),this}},{key:"openPopup",value:function(){var f=this;if(!this.added)return this.once("added",function(){f.openPopup()}),this;var v=this.popup;return v?(v.isOpen()||v.addTo(this.scene),this):this}},{key:"closePopup",value:function(){var f=this;this.added||this.once("added",function(){f.closePopup()});var v=this.popup;return v&&v.remove(),this}},{key:"setPopup",value:function(f){return this.popup=f,this.lngLat&&this.popup.setLnglat(this.lngLat),this}},{key:"togglePopup",value:function(){var f=this.popup;return f?(f.isOpen()?f.remove():f.addTo(this.scene),this):this}},{key:"getPopup",value:function(){return this.popup}},{key:"getOffset",value:function(){return this.markerOption.offsets}},{key:"setDraggable",value:function(f){throw new Error("Method not implemented.")}},{key:"isDraggable",value:function(){return this.markerOption.draggable}},{key:"getExtData",value:function(){return this.markerOption.extData}},{key:"setExtData",value:function(f){this.markerOption.extData=f}},{key:"update",value:function(){if(this.mapsService){var f=this.markerOption,v=f.element,b=f.anchor;this.updatePosition(),tt.SO.setTransform(v,"".concat(tt.rQ[b]))}}},{key:"onMapClick",value:function(f){this.popup&&this.markerOption.element&&this.togglePopup()}},{key:"updatePosition",value:function(){if(this.mapsService){var f=this.markerOption,v=f.element,b=f.offsets,P=this.lngLat,I=P.lng,N=P.lat,se=this.mapsService.getBounds(),ie=this.mapsService.lngLatToContainer([I,N]);if(v){v.style.display="block";var Re=this.mapsService.getContainer(),Je=0,It=0;if(Re&&(Je=Re.scrollWidth,It=Re.scrollHeight),Math.abs(se[0][0])>180||Math.abs(se[1][0])>180){if(ie.x>Je){var Zt=this.mapsService.lngLatToContainer([I-360,N]);ie.x=Zt.x}if(ie.x<0){var Tr=this.mapsService.lngLatToContainer([I+360,N]);ie.x=Tr.x}}(ie.x>Je||ie.x<0||ie.y>It||ie.y<0)&&(v.style.display="none"),v.style.left=ie.x+b[0]+"px",v.style.top=ie.y-b[1]+"px"}}}},{key:"init",value:function(){var f=this,v=this.markerOption.element,b=this.markerOption,P=b.color,I=b.anchor;if(!v){this.defaultMarker=!0,v=tt.SO.create("div"),this.markerOption.element=v;var N=document.createElementNS("http://www.w3.org/2000/svg","svg");N.setAttributeNS(null,"display","block"),N.setAttributeNS(null,"height","48px"),N.setAttributeNS(null,"width","48px"),N.setAttributeNS(null,"viewBox","0 0 1024 1024");var se=document.createElementNS("http://www.w3.org/2000/svg","path");se.setAttributeNS(null,"d","M512 490.666667C453.12 490.666667 405.333333 442.88 405.333333 384 405.333333 325.12 453.12 277.333333 512 277.333333 570.88 277.333333 618.666667 325.12 618.666667 384 618.666667 442.88 570.88 490.666667 512 490.666667M512 85.333333C346.88 85.333333 213.333333 218.88 213.333333 384 213.333333 608 512 938.666667 512 938.666667 512 938.666667 810.666667 608 810.666667 384 810.666667 218.88 677.12 85.333333 512 85.333333Z"),se.setAttributeNS(null,"fill",P),N.appendChild(se),v.appendChild(N)}tt.SO.addClass(v,"l7-marker"),Object.keys(this.markerOption.style||{}).forEach(function(ie){var Re,Je,It=(null===(Re=f.markerOption)||void 0===Re?void 0:Re.style)&&(null===(Je=f.markerOption)||void 0===Je?void 0:Je.style[ie]);v&&(v.style[ie]=It)}),v.addEventListener("click",function(ie){f.onMapClick(ie)}),v.addEventListener("click",this.eventHandle),(0,tt.zi)(v,I,"marker")}},{key:"registerMarkerEvent",value:function(f){f.addEventListener("mousemove",this.eventHandle),f.addEventListener("click",this.eventHandle),f.addEventListener("mousedown",this.eventHandle),f.addEventListener("mouseup",this.eventHandle),f.addEventListener("dblclick",this.eventHandle),f.addEventListener("contextmenu",this.eventHandle),f.addEventListener("mouseover",this.eventHandle),f.addEventListener("mouseout",this.eventHandle)}},{key:"unRegisterMarkerEvent",value:function(){var f=this.getElement();f.removeEventListener("mousemove",this.eventHandle),f.removeEventListener("click",this.eventHandle),f.removeEventListener("mousedown",this.eventHandle),f.removeEventListener("mouseup",this.eventHandle),f.removeEventListener("dblclick",this.eventHandle),f.removeEventListener("contextmenu",this.eventHandle),f.removeEventListener("mouseover",this.eventHandle),f.removeEventListener("mouseout",this.eventHandle)}},{key:"addDragHandler",value:function(f){throw new Error("Method not implemented.")}},{key:"onUp",value:function(f){throw new Error("Method not implemented.")}}]),i}(Mt.EventEmitter),Ur=M(3912),fn=M.n(Ur),Pr=M(20878),wt=M.n(Pr);function Ie(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function we(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Ie(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Ie(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Ar(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Yt(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Ar(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Ar(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}!function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(u){var f,v;return(0,X.Z)(this,i),v=l.call(this),(0,z.Z)((0,te.Z)(v),"markers",[]),(0,z.Z)((0,te.Z)(v),"markerLayerOption",void 0),(0,z.Z)((0,te.Z)(v),"clusterIndex",void 0),(0,z.Z)((0,te.Z)(v),"points",[]),(0,z.Z)((0,te.Z)(v),"clusterMarkers",[]),(0,z.Z)((0,te.Z)(v),"mapsService",void 0),(0,z.Z)((0,te.Z)(v),"scene",void 0),(0,z.Z)((0,te.Z)(v),"zoom",void 0),(0,z.Z)((0,te.Z)(v),"bbox",void 0),v.markerLayerOption=fn()(v.getDefault(),u),(0,tt.Ev)(["update"],(0,te.Z)(v)),v.zoom=(null===(f=v.markerLayerOption.clusterOption)||void 0===f?void 0:f.zoom)||-99,v}(0,q.Z)(i,[{key:"getDefault",value:function(){return{cluster:!1,clusterOption:{radius:80,maxZoom:20,minZoom:0,zoom:-99,style:{},className:""}}}},{key:"addTo",value:function(f){return this.scene=f,this.mapsService=f.get(Z.vK.IMapService),this.markerLayerOption.cluster&&(this.initCluster(),this.update(),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.addMarkers(),this}},{key:"addMarker",value:function(f){this.markerLayerOption.cluster&&this.addPoint(f,this.markers.length),this.markers.push(f)}},{key:"removeMarker",value:function(f){this.markers.indexOf(f);var v=this.markers.indexOf(f);v>-1&&this.markers.splice(v,1)}},{key:"hide",value:function(){this.markers.map(function(f){f.getElement().style.opacity="0"})}},{key:"show",value:function(){this.markers.map(function(f){f.getElement().style.opacity="1"})}},{key:"getMarkers",value:function(){return this.markerLayerOption.cluster?this.clusterMarkers:this.markers}},{key:"addMarkers",value:function(){var f=this;this.getMarkers().forEach(function(v){v.addTo(f.scene)})}},{key:"clear",value:function(){this.markers.forEach(function(f){f.remove()}),this.clusterMarkers.forEach(function(f){f.remove()}),this.mapsService.off("camerachange",this.update),this.markers=[],this.clusterMarkers=[]}},{key:"destroy",value:function(){this.clear(),this.removeAllListeners()}},{key:"addPoint",value:function(f,v){var b=f.getLnglat(),N={geometry:{type:"Point",coordinates:[b.lng,b.lat]},properties:we(we({},f.getExtData()),{},{marker_id:v})};this.points.push(N)}},{key:"initCluster",value:function(){if(this.markerLayerOption.cluster){var f=this.markerLayerOption.clusterOption,v=f.radius,b=f.minZoom,P=void 0===b?0:b,I=f.maxZoom;this.clusterIndex=new(wt())({radius:v,minZoom:P,maxZoom:I}),this.clusterIndex.load(this.points)}}},{key:"getClusterMarker",value:function(f,v){var b=this,P=f[0].concat(f[1]),I=this.clusterIndex.getClusters(P,v);this.clusterMarkers.forEach(function(N){N.remove()}),this.clusterMarkers=[],I.forEach(function(N){var se,ie=b.markerLayerOption.clusterOption,Re=ie.field,Je=ie.method;if(N.properties&&null!==(se=N.properties)&&void 0!==se&&se.cluster_id){var It,Zt=b.getLeaves(null===(It=N.properties)||void 0===It?void 0:It.cluster_id);if(N.properties.clusterData=Zt,Re&&Je){var Tr=null==Zt?void 0:Zt.map(function(Hn){return(0,z.Z)({},Re,Hn.properties[Re])}),Vr=tt.a5.getColumn(Tr,Re),on=tt.a5.getSatByColumn(Je,Vr);N.properties["point_"+Je]=on.toFixed(2)}}var Pn=b.clusterMarker(N);b.clusterMarkers.push(Pn),Pn.addTo(b.scene)})}},{key:"getLeaves",value:function(f){var v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,b=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return f?this.clusterIndex.getLeaves(f,v,b):null}},{key:"clusterMarker",value:function(f){var P=this.markerLayerOption.clusterOption.element,I=void 0===P?this.generateElement.bind(this):P;return new br({element:I(f)}).setLnglat({lng:f.geometry.coordinates[0],lat:f.geometry.coordinates[1]})}},{key:"normalMarker",value:function(f){return this.markers[f.properties.marker_id]}},{key:"update",value:function(){var f=this.mapsService.getZoom(),v=this.mapsService.getBounds();(!this.bbox||Math.abs(f-this.zoom)>=1||!(0,tt.oO)(this.bbox,v))&&(this.bbox=(0,tt.yA)(v,.5),this.zoom=Math.floor(f),this.getClusterMarker(this.bbox,this.zoom))}},{key:"generateElement",value:function(f){var v=tt.SO.create("div","l7-marker-cluster"),b=tt.SO.create("div","",v),P=tt.SO.create("span","",b),I=this.markerLayerOption.clusterOption,N=I.field,se=I.method;return f.properties.point_count=f.properties.point_count||1,P.textContent=N&&se?f.properties["point_"+se]||f.properties[N]:f.properties.point_count,v}}])}(Mt.EventEmitter),function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(u){var f;return(0,X.Z)(this,i),f=l.call(this),(0,z.Z)((0,te.Z)(f),"popupOption",void 0),(0,z.Z)((0,te.Z)(f),"mapsService",void 0),(0,z.Z)((0,te.Z)(f),"sceneSerive",void 0),(0,z.Z)((0,te.Z)(f),"lngLat",void 0),(0,z.Z)((0,te.Z)(f),"content",void 0),(0,z.Z)((0,te.Z)(f),"closeButton",void 0),(0,z.Z)((0,te.Z)(f),"timeoutInstance",void 0),(0,z.Z)((0,te.Z)(f),"container",void 0),(0,z.Z)((0,te.Z)(f),"tip",void 0),(0,z.Z)((0,te.Z)(f),"scene",void 0),f.popupOption=Yt(Yt({},f.getdefault()),u),(0,tt.Ev)(["update","onClickClose","remove"],(0,te.Z)(f)),f}(0,q.Z)(i,[{key:"addTo",value:function(f){var v=this;return this.mapsService=f.get(Z.vK.IMapService),this.sceneSerive=f.get(Z.vK.ISceneService),this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update),this.scene=f,this.update(),this.popupOption.closeOnClick&&(this.timeoutInstance=setTimeout(function(){v.mapsService.on("click",v.onClickClose)},30)),this.emit("open"),this}},{key:"close",value:function(){this.remove()}},{key:"open",value:function(){this.addTo(this.scene)}},{key:"setHTML",value:function(f){var P,v=window.document.createDocumentFragment(),b=window.document.createElement("body");for(b.innerHTML=f;P=b.firstChild;)v.appendChild(P);return this.setDOMContent(v)}},{key:"setLnglat",value:function(f){return this.lngLat=f,Array.isArray(f)&&(this.lngLat={lng:f[0],lat:f[1]}),this.mapsService&&(this.mapsService.on("camerachange",this.update),this.mapsService.on("viewchange",this.update)),this.update(),this}},{key:"getLnglat",value:function(){return this.lngLat}},{key:"setText",value:function(f){return this.setDOMContent(window.document.createTextNode(f))}},{key:"setMaxWidth",value:function(f){return this.popupOption.maxWidth=f,this.update(),this}},{key:"setDOMContent",value:function(f){return this.createContent(),this.content.appendChild(f),this.update(),this}},{key:"remove",value:function(){return this.content&&this.removeDom(this.content),this.container&&(this.removeDom(this.container),delete this.container),this.mapsService&&(this.mapsService.off("camerachange",this.update),this.mapsService.off("viewchange",this.update),this.mapsService.off("click",this.onClickClose),delete this.mapsService),clearTimeout(this.timeoutInstance),this.emit("close"),this}},{key:"isOpen",value:function(){return!!this.mapsService}},{key:"createContent",value:function(){this.content&&tt.SO.remove(this.content),this.content=tt.SO.create("div","l7-popup-content",this.container),this.popupOption.closeButton&&(this.closeButton=tt.SO.create("button","l7-popup-close-button",this.content),this.popupOption.closeButtonOffsets&&(this.closeButton.style.right=this.popupOption.closeButtonOffsets[0]+"px",this.closeButton.style.top=this.popupOption.closeButtonOffsets[1]+"px"),this.closeButton.setAttribute("aria-label","Close popup"),this.closeButton.innerHTML="&#215;",this.closeButton.addEventListener("click",this.onClickClose))}},{key:"creatDom",value:function(f,v,b){var P=window.document.createElement(f);return void 0!==v&&(P.className=v),b&&b.appendChild(P),P}},{key:"removeDom",value:function(f){f.parentNode&&f.parentNode.removeChild(f)}},{key:"getdefault",value:function(){return{closeButton:!0,closeOnClick:!0,maxWidth:"240px",offsets:[0,0],anchor:tt.bV.BOTTOM,className:"",stopPropagation:!0}}},{key:"onClickClose",value:function(f){f.stopPropagation&&f.stopPropagation(),this.remove()}},{key:"update",value:function(){var f=this,b=this.popupOption,P=b.className,I=b.maxWidth,N=b.anchor;if(this.mapsService&&this.lngLat&&this.content){var se=this.mapsService.getMarkerContainer();!this.container&&se&&(this.container=this.creatDom("div","l7-popup",se),this.tip=this.creatDom("div","l7-popup-tip",this.container),this.container.appendChild(this.content),P&&P.split(" ").forEach(function(Re){return f.container.classList.add(Re)}),this.popupOption.stopPropagation&&["mousemove","mousedown","mouseup","click","dblclick"].forEach(function(Re){f.container.addEventListener(Re,function(Je){Je.stopPropagation()})})),I&&this.container.style.maxWidth!==I&&(this.container.style.maxWidth=I),this.updatePosition(),tt.SO.setTransform(this.container,"".concat(tt.rQ[N])),(0,tt.zi)(this.container,N,"popup")}}},{key:"updatePosition",value:function(){if(this.mapsService){var f=this.lngLat,P=this.popupOption.offsets,I=this.mapsService.lngLatToContainer([f.lng,f.lat]);this.container.style.left=I.x+P[0]+"px",this.container.style.top=I.y-P[1]+"px"}}}])}(Mt.EventEmitter),function(n,l){if(l||(l=document),l){var i=l.head||l.getElementsByTagName("head")[0];if(!i){i=l.createElement("head");var u=l.body||l.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):l.documentElement.appendChild(i)}var f=l.createElement("style");f.type="text/css",f.styleSheet?f.styleSheet.cssText=n:f.appendChild(l.createTextNode(n)),i.appendChild(f)}}(".l7-marker-container {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  position: absolute;\n}\n\n.l7-marker {\n  position: absolute !important;\n  top: 0;\n  left: 0;\n  z-index: 5;\n  cursor: pointer;\n}\n\n.l7-marker-cluster {\n  background-clip: padding-box;\n  border-radius: 20px;\n  background-color: rgba(181, 226, 140, 0.6);\n  width: 40px;\n  height: 40px;\n}\n.l7-marker-cluster div {\n  width: 30px;\n  height: 30px;\n  margin-left: 5px;\n  margin-top: 5px;\n  text-align: center;\n  border-radius: 15px;\n  font: 12px 'Helvetica Neue', Arial, Helvetica, sans-serif;\n  background-color: rgba(110, 204, 57, 0.6);\n}\n.l7-marker-cluster span {\n  line-height: 30px;\n}\n\n.l7-popup-anchor-bottom,\n.l7-popup-anchor-bottom-left,\n.l7-popup-anchor-bottom-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: column-reverse;\n          flex-direction: column-reverse;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* layers control */\n\n.l7-control-layers {\n  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);\n  background: #fff;\n  border-radius: 5px;\n}\n.l7-popup-anchor-top,\n.l7-popup-anchor-top-left,\n.l7-popup-anchor-top-right {\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.l7-popup-anchor-left {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n}\n\n.l7-popup-anchor-right {\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: reverse;\n      -ms-flex-direction: row-reverse;\n          flex-direction: row-reverse;\n}\n.l7-popup {\n  position: absolute;\n  top: 0;\n  left: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  will-change: transform;\n  pointer-events: none;\n  z-index: 5;\n}\n.l7-popup-tip {\n  width: 0;\n  height: 0;\n  border: 10px solid transparent;\n  z-index: 1;\n}\n.l7-popup-anchor-top .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-top: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-top: none;\n  border-left: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-top-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-top: none;\n  border-right: none;\n  border-bottom-color: #fff;\n}\n\n.l7-popup-anchor-bottom .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-bottom: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-tip {\n  -webkit-align-self: flex-start;\n  -ms-flex-item-align: start;\n      align-self: flex-start;\n  border-bottom: none;\n  border-left: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-tip {\n  -webkit-align-self: flex-end;\n  -ms-flex-item-align: end;\n      align-self: flex-end;\n  border-bottom: none;\n  border-right: none;\n  border-top-color: #fff;\n}\n\n.l7-popup-anchor-left .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-left: none;\n  border-right-color: #fff;\n}\n\n.l7-popup-anchor-right .l7-popup-tip {\n  -webkit-align-self: center;\n  -ms-flex-item-align: center;\n      align-self: center;\n  border-right: none;\n  border-left-color: #fff;\n}\n\n.l7-popup-close-button {\n  position: absolute;\n  right: 0;\n  top: 0;\n  border: 0;\n  padding: 0;\n  font-size: 25px;\n  line-height: 20px;\n  border-radius: 0 3px 0 0;\n  cursor: pointer;\n  background-color: transparent;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n.l7-popup-anchor-top-left .l7-popup-content {\n  border-top-left-radius: 0;\n}\n\n.l7-popup-anchor-top-right .l7-popup-content {\n  border-top-right-radius: 0;\n}\n\n.l7-popup-anchor-bottom-left .l7-popup-content {\n  border-bottom-left-radius: 0;\n}\n\n.l7-popup-anchor-bottom-right .l7-popup-content {\n  border-bottom-right-radius: 0;\n}\n\n.l7-popup-track-pointer {\n  display: none;\n}\n\n.l7-popup-track-pointer * {\n  pointer-events: none;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n\n.l7-map:hover .l7-popup-track-pointer {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n}\n\n.l7-map:active .l7-popup-track-pointer {\n  display: none;\n}\n\n.l7-popup-close-button:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n}\n\n.l7-popup-content {\n  position: relative;\n  background: #fff;\n  border-radius: 3px;\n  -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n  padding: 10px 10px 15px;\n  pointer-events: auto;\n}\n\n/* general toolbar styles */\n\n.l7-bar {\n  -webkit-box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n          box-shadow: 0 1px 5px rgba(0, 0, 0, 0.65);\n  border-radius: 4px;\n}\n.l7-bar a,\n.l7-bar a:hover {\n  background-color: #fff;\n  width: 30px;\n  height: 30px;\n  font-size: 20px;\n  display: block;\n  text-align: center;\n  text-decoration: none;\n  color: #8e9dab;\n}\n.l7-bar a,\n.l7-control-layers-toggle {\n  background-position: 50% 50%;\n  background-repeat: no-repeat;\n  display: block;\n}\n.l7-bar a:hover {\n  background-color: #f4f4f4;\n}\n.l7-bar a:first-child {\n  border-top-left-radius: 2px;\n  border-top-right-radius: 2px;\n}\n.l7-bar a:last-child {\n  border-bottom-left-radius: 2px;\n  border-bottom-right-radius: 2px;\n  border-bottom: none;\n}\n.l7-bar a.l7-disabled {\n  cursor: default;\n  background-color: #f4f4f4;\n  color: #bbb;\n}\n\n/* control positioning */\n\n.l7-control-container {\n  font: 12px/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;\n}\n.l7-control-hide {\n  display: none;\n}\n.l7-control {\n  position: relative;\n  z-index: 800;\n  pointer-events: visiblePainted; /* IE 9-10 doesn't have auto */\n  pointer-events: auto;\n}\n.l7-control {\n  float: left;\n  clear: both;\n}\n.l7-top,\n.l7-bottom {\n  position: absolute;\n  z-index: 1000;\n  pointer-events: none;\n}\n.l7-top {\n  top: 0;\n}\n.l7-right {\n  right: 0;\n}\n.l7-bottom {\n  bottom: 0;\n}\n.l7-left {\n  left: 0;\n}\n.l7-center {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  position: absolute;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.l7-bottom.l7-center,\n.l7-top.l7-center {\n  width: 100%;\n}\n.l7-right.l7-center,\n.l7-left.l7-center {\n  height: 100%;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.l7-top.l7-center,\n.l7-left.l7-center {\n  -webkit-box-align: start;\n      -ms-flex-align: start;\n          align-items: flex-start;\n}\n\n.l7-bottom.l7-center,\n.l7-right.l7-center {\n  -webkit-box-align: end;\n      -ms-flex-align: end;\n          align-items: flex-end;\n}\n\n.l7-center .l7-control {\n  margin-right: 10px;\n  margin-bottom: 10px;\n}\n\n.l7-control {\n  float: left;\n  clear: both;\n}\n.l7-right .l7-control {\n  float: right;\n}\n.l7-top .l7-control {\n  margin-top: 10px;\n}\n.l7-bottom .l7-control {\n  margin-bottom: 10px;\n}\n.l7-left .l7-control {\n  margin-left: 10px;\n}\n.l7-right .l7-control {\n  margin-right: 10px;\n}\n\n/* attribution and scale controls */\n\n.l7-control-container .l7-control-attribution {\n  background: #fff;\n  background: rgba(255, 255, 255, 0.7);\n  margin: 0;\n}\n.l7-control-attribution,\n.l7-control-scale-line {\n  padding: 0 5px;\n  color: #333;\n}\n.l7-control-attribution a {\n  text-decoration: none;\n}\n.l7-control-attribution a:hover {\n  text-decoration: underline;\n}\n.l7-container .l7-control-attribution,\n.l7-container .l7-control-scale {\n  font-size: 11px;\n  padding: 5px 5px 2px 5px;\n  background: rgba(255, 255, 255, 0.7);\n}\n.l7-left .l7-control-scale {\n  margin-left: 5px;\n}\n.l7-bottom .l7-control-scale {\n  margin-bottom: 5px;\n}\n.l7-control-scale-line {\n  border: 2px solid #000;\n  border-top: none;\n  color: #000;\n  line-height: 1.1;\n  padding: 2px 5px 1px;\n  font-size: 11px;\n  white-space: nowrap;\n  overflow: hidden;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n\n  background: #fff;\n}\n.l7-control-scale-line:not(:first-child) {\n  border-top: 2px solid #777;\n  border-bottom: none;\n  margin-top: -2px;\n}\n.l7-control-scale-line:not(:first-child):not(:last-child) {\n  border-bottom: 2px solid #777;\n}\n\n.l7-touch .l7-control-attribution,\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  -webkit-box-shadow: none;\n          box-shadow: none;\n}\n.l7-touch .l7-control-layers,\n.l7-touch .l7-bar {\n  border: 2px solid rgba(0, 0, 0, 0.2);\n  background-clip: padding-box;\n}\n/*logo */\n\n.l7-ctrl-logo {\n  background-size: 100% 100%;\n  width: 89px;\n  height: 16px;\n  margin: 0 0 -3px -3px;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  background-repeat: no-repeat;\n  cursor: pointer;\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAAAgCAYAAAHBIxK2AAAABGdBTUEAALGPC/xhBQAAIJZJREFUeAHtfAl8Tkf3/9z7PNmDRFbZSawhQcRSaqva1xCqpataqrT2UkuUUiqlaKtafe1VS1pUiypB0dIgIkpKRPZIELI/2/zO98akN48nltL3838//84nNzNzzpkzc+eee+bMOXMfxijNaMJ7LOrGO/HdYfZ8fb12gD2JJINJdR8WNHVQnRtSn7hilpz0u2DMKaEcFhZmhdzLNbiPyNVlwPxcm4Qh93Fr0gO4Ol5hfqiz6Q14G+QzGpYzQ9nXrUl7X/fgbrXdG3skX7m26+bNW2fQqJ5XmCs6RQKd6EQwB0zgtKgsvCidGF+N8wV/SBLqSKnXzx2WKIHw1xNxq2xtrKsBXqgrbePt1rivJFmloa5OoD129NcVQwa9Phxwaflw3ifvHCus1YIVjW7fwEF66dIhdYO/XV7Qk+9HY/5F7RA+w0G5TdRxq7gw10FBPWwA+3r9jpkYGcoJ5/7YiFxMiYCjLspsekOeCiJ1AhJJNER+8rfTX/j4BNcUMNCLMmhF+wC3cE9RZmMd/0IQjeTtGdwJjURD5EajsRQN1EwEHjAkUVce2LLhnKf8xGId3ZhkX4uxmj7MMKqJz0ZmMr3MJNZBmphV8WDBOCCgo+2QiE7DF3005wvU75e8vMLs4+P3HwwN7do5MzOu2NcjpPHRX/csCqjt2wvtxEAy8xJ3o+7j3jjkcurpn2xtrT0EPiS0oQPKSOfi/ygqL9H/qNbls8EXuer4+65xUa149QnBvGYFgapAN21EZ+pnuH3rrrnKdNA/zCRmjoqGzu36RoL21q38BLAAjRgo6iir63g1QAOcOoU27DAgwKtpPzVMKU+qBWIuve3Jx0zw4j/eQ0CASeNnjUi5mrYH72ZxUfFV0emJ479/BvrM9KxDAgZZEjziTp1d8+pL415sEdJloIAhF7QCZmnQoCkuLkkXNPfkozU8b4wVb30P4i4ADNQ41P08mtSBogHc27Vx70CPEHeUgRNwgUOuTqBR8wwODraGSIkrKipKxqVuI300mntri1jz9OOs0IHeHUdvms2t0iG+vn5nxmnan5QeUff6GGWttpidSjvGbCSZJdAAGTMwtjWSH2G5XrOp3oEv9wuWxqdeUPchZkW8OGqcedmcdujgUcMOH/zltmgL2YW2Fu22fbMz6q2xM+IEvmvHiCGyRq7AK3QLe959+T6v46co0uVBisLk0/9SqIIhcnQiVBPqULJ4dPVd2ypLg6Dx8wxuhAGDHrCOHTtqUfZ2b6KsYYIOuUiXL1/dKW4SMJRxkbbpG9nv5ecVutlt+PSoNvw7VPg8V4X5wqf4YQVp9g+NDQZDITr2cm/8lNIGlbvp+edGD/946eqJqOKmoBJRhjyjrclk0qlZAqeumw8YOEwE6ILdgh0raN9pcHeWx9n3mViPh9IKnlmBVBWI4bfoePDAEcOGPz9WWUDBzMe1cUdft5CnUfb2DvFR8rsz2avrkOdmT18wJisz5zDaqthVWjwAtzRgtBF9VbSdVofXIPWmB2CCouYqUBUFH59QbwwEqg0XykAi96/VuCEetRrm59msEfA+nqEtAUeqNEt324JGJEsDxpMi26gnaCpUxqJk6bahkGFp3akrZO8IBurcVGponpGW+VOdQP++uIAznzE1/cBBvRRZTc+OP0miUBJ78OiyxNxE6uX+KSP3vDIZuEE/z9BgWZZtHHj1oxZbkS6uJFNqIn+SWSy1AubjFtLd171xoHrQooyFQJRB7+0eHBrk2cxNtBW5mgYwoYNFXg5r7CvoFXWxajQ3mjiTc84wVkB2kTWt5NYk3lZ02SCvzphDDVrNZOY2p3mdA0wrhQoGSm5ig6SRyTsqwSxUaMKk+t4tXJIy4/IsoP82yNu7pYusKwk2WdslZmScvGHOyNs1tJ5GNrjVaeT2W2xsLCnuv5J6woQq/QtbXoLCMJqYtbWj208pKbGK4aamgWJR19XlCvpFEdxn6SDOl0byAjXB/cp8rlM/PteZ83k1T92PTuAw0Ly8GychmosWLB/v7xFSW+AeJQ/0auyLiYFEBgQ0dYKdDRsJfFOvpe0V76fgCVrgkNQTao63hAONr2vjFtAFltoTTFLzB415Al7RFdNipHRviWlLbzCHhZ05HxfEy9e7T/zX8FV+XLk+96e8Tl0xOJZfOpjdKp4kzboZXgGrouDj1rTunHnTQl1caoZ/unLNlKnTx32sNxobR0ZGakQTDCY8tEtEkG+LfihDg+NC2ccjpBXoyMTqVaLjTaFLduxe219XqH+67HYGKU5D0pbN30X5+vl0a9m6mZOPTxvFUIayPRAbM1RpS1uztp0a/SD6e9hcYlKVqgi7QEg/DAyRsAUsKSlNLyvT56Bs8e2Ias4LZzfnfEowJyOOVocZDs9jt8YnMDvUZzblZ+jis1rwtqg/KMHgwEThCUOCUS64U/An6iiL9oIGcFjwqMOQQB0JdTyEXd/tfR/1rMzsWCrPBxwPCxJMfJMELVYq0KO+fNkXk6CHRV/qXPSLXA0XZejpqiRZ0IgcY7hzu+AS2TB3quInaNnU2vzSlNqcT/fhHSqAVJgawAunEXxCPU4W9MMlcRN0ryZMAl2XcOHm6YlnYgMAToIOuxks+YBBErGrAa0YtKDDDkeYAaBFErjSUl2uKOfm5v1GE9y1nOLe/4IO+b3YchfKw0wy3lZ6m2arxyr4KV4RURH54qtS/fGufEMZZ7Hja/Ko0ptsgYML0+kKGM+4wbTbmGQUtPfLMfBrWWc3gIZenX4aJmUp9OQdqunk4nv2QmzMus0rO730wtj0qu2DqnuQjCYbrOjYrINq5JuRe/CKQp3QtRMweivm0yur+FBQf9xk6WFQX99Tvw2GDO0390jssWXW1vKf6n4q7Dc1EOXledJwQxF7RV/EomQbptMXssJlNyT5YSe4dq1m/s907eik1WprNKjdur9sW/1AWt7535Ur6/zvN2/lpcds/37eM892mEgTXGHuHD1y4qLRYK0YvrJsMly5knKu0tg0csmObbvfC2/ZbETK9bOnW4TU7xtGEw0a2geZbKysz/Xu9txQvV6fX6VOrMTw/hVsdF8b/tbGgX1feqF1m7Bq5hda+/o+pVgXm9Ztmzk0ctTBlMyEi/fnaoZ9g3HH1xmv5GgwI/m3+oAZUOzkj4fx7rQBt7qdxnhJDiuj/YlBe9dG1pLNbF9D8c2dem2xVMA3NQhjBk6WMyVaelmZVaL0+vmcB/Tz/zVa+8lIPlWW2SLMQh559ZSNCE2sbCq/FBuLyrrbLJVHsYZMr/sdfpiKJOv1pOxtyISp0tQRtHXqhNWQZffSy5d/LBOwJ5H71mrcAnzSSA2Z84ObJPlCbiujSZubkRefZI5X61hL5pavbzMvY4kuTCuzm6nXE4+Ztwf/lBRmcW1zcSkwxsXF6bWmEnbQSPJsoqWMZumwUqYC7QCVi3Y6tMmnCZdYDItiJezj0v3MaLJmRmXX58w0zKJ3w3ww2IwE+fk7JSUll9b2Crl4NfPcJXOav1OH7fyfdSs6cS7zl18Y65GRd36Pmk/S+dwex0/tHTN54pxNJ0/I2tTsM5WccqDFQgn9rW4nyphg4J95ut9gZis7p6Ym3BI4L9eQ+sS/ntrbLXDIE8/fLKaHVP7goyN5whKyKKMHcsWboSasqsznORfSRYEaz3v29uZt4JiDxMC8QVJLjzntg+ow+dBe7BhRJ1MwQ/AVkRbwQbBj7OtTXgVu49qt79LDrW/OX4yrqjEJ/OIPVrwlfM2CB/rW6XQ3wd9SgjsM41SsC9pLt+H0AptK2fdRjFdYHHwdhY0QOsL1VZDimkIHfLLD8xThcmCF+p3SjOxc0WlV+Zervm2x68dN/QQ+MLC2DVSHqOOVw6ZFXDRgCXjUBQ1y7Py+3bO+HyQLO0bArGV2auRrkxRv1orPPgjXF6XVARxJz0vCPvz4vbkoT50899yTenvAD0ljLx0L8Gr2Et4C9XXnTkEiecNKv/xiU/q1nHNXlQmN2iYVlpWwL0qLmSR3ZNFgQCpCogXuLDMa45WrTH8AcCVpTL8Q7ChbVDhAgO6XmwwGj7AWoa9lZ+UcBt3ufZvn6Ar0bUSbP/+42cJQ7NhbNjj3ybpW2p0G3LtP966DUIYk0TbZDr4Kk9Ho7lXLw1+0g6qo6Wtz8+f9sfmARQzqPZNWiCCBJ/NLtrOz9SkoKPxDlmT1SiJIHiuH6oAeF5e1o9XRGjWqa6pXrxbcqlm3YY7Wtifu6WDeU1xHF59an1cDki9wm8nnU7h3AV0fergDNrsln0+BtKUoP0yizYJr/57DhuJ1wnY5/mziepTVr6e3R0hrsbPLyck7BrxIZO/eAi2uuwE4I3Aok5rIAtzPPbjtxQuXtgCOOtQTwkqrPvlqMmBd2vcfDGeSpfGCXrS7H96SujCnBy+oj6LComSoEoGvUA0A6EvZ8DLaO9nYsUOoSzNy57Oi4mJyBu2SpuRcj2rGvZievUsRgleBf5gk6cpabd62egFoaYtr6NFl8DaUoz96LzTAq0kDlNWppLhE2UTg9Tuf8MdG2sw4DRjQU9H7e3b/FE2vomLoU3nJjm92rYSEwoXZuX3EJvDZsWtdz/+sjGlqMJqCXx/90jzALlz4syQl5awi7aj/EwnxPfC1srJy7ti232Sb6jZHRT+VJvm909I3pjKWayxjYdODeLkO1hnC2OLC/mhQWsJO6UvInCtjHQWDB+XKK2tvF3Dq5JkvVR4t/tzwiHk6namuefunwruvEq9ft86RW4Ef9sqQcK2WXRkzYtKBgtsFGYCNHjHpt3enzd+cnpvwo8pHbKQd2Wg9M3qDhjz9tqd+O7tao2XZqP+TKf8Ga3vyzP630EdGRpY+OTnutuiv0iQDqDOxVgaaSDLpjqMuResukoXHpwTw7jT5XnQlfHBBOgPcgxIiEqu+jG4NuoYN63a4mHzio0vJvy7Blhcwa2srWW0NAFZVgh0uaTSKj0LQYFERZVmy+WP1Z2uno25vZyd/tX5FO5T79x72faoF+xm4J5m4geLOPl7PHPvl1CeyLF1T875nkpdckq7qdOwIqY4aEz35i+XEXCYJ30MXs7dnSghSzaSqMunN2n36dZsBfG7uzYt3r0vpaVm/AHbkxJ4xJYWpD80PbapK6bmnL8+dvURRJXsPbXu5W49OU6n/ItA/zEapKr4PA8fC7OVVS1EXgwe8sq9Nh4aJ6nYWdyrFmayLvQsrIwleF8n4Jk9ntlCvo00gZ6ujE6UHBujQAZw2ZY52Cv8fvj/wwahXJu6VGFdu2sh4rdTs+M6+fl7dSAI+kTS0yfkbCWEndbhJIzPdjRu3TgcGBijqbcHc6Km21iz+b7C22KTEaGxFi1slHDyLsrGgKHr5kvYCsW3btkpeynskGYSrmaQnvTufLubhyL6WDGwK0zH9ypvSKMHoQXmuoaztz0diJoHu9VfePp6el3BYeOGstVYJ0Ys/VSR81OjhPmQqKAvbg3hqZNOd9PTsZNAt/3Rhi+5dW/cmy6SzaGfv7HS817NDlUUWsFWfrU9LzkxMFfjHyadMe3MZ7HPzCwJjMnK/8JbNI6rib1GSQfxpoTT7TRs+mYzLSJJoWkTYsKqYWIIbTNzWuaZTA0iWOT4l+2zKxx99fpXCUKxXv+5hn6/akP7n5eRztbw9O5rToi7cnx5+0rWIvi/uSU4/M2BgZJ/ZAwb2KiO9HynaXLp0rIAkTZeff/tc7MFju2Qm0T7r8RPcnJa43MjL1+PtocUif8SrE2ZkpWWX0Tmbex4q5q/KNFLLO8mcHSTXRc7nRsmzSkILCOzWsJkAypLjBXE4U+mdtmSCGclC+AEbC8US0Wh+u5Jz7jraIWREYfRGuJG064n7AAvxCHHIMxorpLcac4q9lHesYjLRb06qrgtZMoVpuecqzCi0tZRg2wq4pXEiKCDwlnIRMMD9WFvrjGqrwhK9RRj5kp+bwLgS37NI8C/wgTOgSPLyV7ibxoa9Rp7kV8nrVo1E3qSjJSr/CuNlBUxHTswSZmLFkhWTtLSGUqSEjO7yXEN1DZW1FBuQrQllxzK5FVuTc5HtnnOIwlRf1X6Waa1GM24KoNGQT69SkpiGFtIyYwwrMK1jb1+9/U9bApV6/7fyxGYAwewzZ1IdiosNBvF2PzHmD8FIWfcoKPIV7ZZ7Q8rImmJGPWPpR0jqdMxEAs5IgEkWCUm6mf6YRITIOXIFUC6heCvIyguhPIR5s1PE9TYrMixlWkM9ZqRwC2jLkywKSm4tPc005KKeOxe+qb+oKhE9fAUOvLLi0ubYH6AVNpoaLU++lnWezs8/OLbw8D09GUp8HkB7wHCEEwVHjBkOxqvX7x906kgOzMvn89qZWLm7SbSXmXwnqLHLMdVmWKAq5eolSY2wtDyp8aIcFNSqekl+Uftjhy5IbduGV0tKulrCdMEGrcRupeYm/iLoLOXkMpJqe4fUN+hZHRM3keQ9Wip3IGiSEIupmLjooXwByeoUA2daCrSw4nx2Kucye86qhJUq7MUKSznt+SqSHcq0KAqY1okZxqySrlcQUIEvJ7e+RDocW2JdmR3T8K0UT2lOwk1viKQnh2oUuaIqrFt120ct4ySGwaALHDPuVb8ZM9+OxjlFOh95oGXzrsvpxk2e/jb7ERB6VL6PQw9hS79427lUqzOOGBGZj5i64IcPYUp1paHDXxzs+UH07NUCvnrVumlzZ334h0ajuZqWc+68gKtz+Bq//CSmq4kbrRL/PDbPyalGKPDJySm7n27V+wtJywozshMPqduYl4Ugw/oHDm455A8ryDjEhp3CkV+/HxEYGKC0/XDRyreXLVmVbKeyE8HTPOE0DNmONhS3Gu0f4NPTHP+gOj7JGRwx4icYzRU7kUlfSzMW9+PJJMTLS03MztqahXs1YuuK8tmAqFgp70FM74eXxpeHTvhkR3eKY2wic6K5YmRoWBE51UdI825tuV/7h8Uh1qQzFAf26vusy8zZE1eKdt6+Xl1ooovbt+795fVUXRuC03rzzyecisZBYwoCsvETRgbcupFfunrl1mwSHtIW7EpqduKF5My4VBIG9w3rt7L+g3qtggsRI3t91IvzNq7d/sKVK1drk8bOtaSZ16zc3pw0sdV332/sLYSYzofd7tdj+H/Aw1O2/S0DhX8wlWvFv7eI0jpJqs1gs33brv09ej6TT7wqFKulIbt7utalw5RKxJwO4+yCEGMDFdjILbFCkNFw6k7py0XP8qu0Fm8nl4UTcW1nY81ORHXjPaL2SZcFcxq2xNbUXsSstB0oiCbA5TkWCCMvYQbda9KotCuVkCbTQGYyNCFb3ESh72wmayOlRbePV6L5m5UAOh+sK8wNh4tzxaeLF99lY6KjunGuri7h0BZf/GfZBfhQfDyaNEnPSUgw70o5bm8yuZrDUcdSTXftYL4EaiT5tobZJqXknsq+p52e+wB28vT+cfQyPYtyxOA+nw/oPXwPyiKl5ibE+Xs06UJb9x/OJB4OdXd3aUMmkPX2XWsnNAvu8EGZJDWhZfi62izyouPDRh2v9cabr/iGt2o6UvCa9c7CqfQFo0Gy0ZyJyyg/uiZw/0SuNocelX9qbvwv8F5+suxzv6VLPo211J6EvRZWnCXL5jUb+sKAoaDBh5SYKzyT1JxzRzAvlQQZRNN+kn6Oepq3JXn8gar+JKZBRPQbffnSJ+qEpAgdCTjnt/UbGCt7jkq+lbZwVmQqGPlcaVJWhRBHPcXd6ciG29xDbOecNtIGCm3VkKJLnqiy0JfcbIvxxx7fOc7Gxkpx6G3ZEDNn1rsLEy5cOb6GIkIuPXt3eef5FwaO3LxpByNteTM9Pb7yGO7az7+fPTBR+Km2bIyZPWPa/Pi1m1b0b0FONnt7Oz/0g0Su6oLLSVd+GP/G9G9154uLtZL2lsnGPo6XFjyDB0wx33JCC/8NBoavKQKBogB8noskH89jxs5dOw78MC7h5/VkUjiSQD+1fvPKDi8+/+ZhX0/lawzl5bv70jZ1dHTQTJ0xfr5gv+/HQ4vXr/smC/GC9Ixz6QL+T+aPo5ExrvT0E/BwX7I0RoR9TSajFebgmWc7TgINjk6OG/POKVnLctKzE06SECtNK2+67nKLOipdIEEOp7jI73QKg+lKWE3aDB56N5wPuUvCpInpCazEEM7yS86wQloh7tBVXFLEbpa8REL8fjkdl2Y158NItDOp/XnZimXM/ZW3lJY+WSH2dwttRt5o+6+3r+6C4A/6Tkq6EjNp4uz44pIS05wZi94V4164ZNYSN1cXKyz54hyowFnK+0X0GJGccXpneKuwQRcvJB3YvXPfAgSX6CPVeBK2avUb1huy79COLecuHp1Dx5fgU+wCId70zapnhNdZaGPwb9mq2SgBRx45uK87p1Xgjh3NjrV0FmHm92YtnirGggfYp09XV5PRFIBNIeDGohstke/9edtrCNmifC0l/YdXXxz3Cxy76dfPVz4DC4L/sYQvkhFh+HT1h62EEP+45+dFEGJ8xp6enXhSfUsWBRkEM45KubIDe5qE+DsE9XSlNM2lbMv0YP4OxaJIzsm+ePd6DivMb8vu6GKYviyJFRq7Se/d+hq4KMa104PZLBLgDXRiRkPhbU5h7s03PNgx4J9UCvBsGqDnBh/YoO07PDUefEtLyzK7tI9Yh80dQtTr1m7JPHL4+HLg6GxB9f2Hy0M1CNtg5wx4VUnWaO1bNn12YJBfizf69hr+5Zujpqx5PnLUp43rtZvVtFHHCBFAdHFxDlu28v1w8JEljf6FIaN/FseJ8DGe4I9wvYAj37Z113XZVnsaZxUyM8+nkYJJw5Gjn386/JFos3Tl+3NQ1nMpDB/aGbmpxkfL329Wu46fcqiD7je7U9u+n0M72jr5nhDt/ldzH7fgIJOJ+0+aNjaw34AeihI6ezph7YiX3zpGk3sjI/fsWfN7q1KQQUibvNIF51kECfMysmuNlFPUjy2sHchWvhzAyXNM9aWshDTsQOmD0vrShwWKkI704vZFddkXRDuXhJgsELKYS9n7CxKkF1b8KNFr8WQS3Gw6g74JztRNeefNDwXXyeNnzSIBI88gl40GpkRyhg4aeeD69RvKQ8aSHbNrfS+Exvy8yn9OQ7Q1z2kCd+D8BDZnGdcTTqTmJCTjRKgky3nQntezc0+JNl7etRT7WqM1XcOuX9ZoKnlvBB1yrdb6CmhwqU2cjNzEs/A2vPj82Nj0tMz9oLWzt/Pfd3DbYNjntJmr06x5Ywf6ZEIRbuBHvz5lWplOp7jrnvRxZPD/byZ8IE0u3IZ16wbaTpw8Zgn6pjBiQq9uQ2Po6/SyjJwEiy/qfQW5/AYkvviyNIEEcgIFqstweou07GgXA4sZ6cxrlNP89X9MDe7sILM9JK4v60CrYyUlejZy0Z/SrL+oHr8EB7w4q7hr78ZZcLMJritXL16jXr5FGZsoQdOqTfNRM2ZNrGvU81pVfXUGWnoZlN2seqOl8PgH/dFWtm4noF07te33KX0GmIv+GjdpOIzs4SCUN2xZ9Q5lyrPbuuW7uT/tPXjLykq6bMmzAfr/pVQs3WmG8W785rMRlCkr//w50eWrKWPx9zyHuzenvZs/MItOl1a85cGvajjbpJNYdYpd97C3YkfH2fGeK0qkdDCg3x4JoI3fXknH6hMNRnFLx9igZTnSwQd28IgExw9fpO9PTVbQVOR6CkFzslvP0pI/+36scLwRp+9A88a4Vxbt2bV3WHz8hUb0uzm3yn9i4H6tVbgHmCQqykcuptBX2/6uYXFk37d4+413pn62Jvo/YPLm+Nfmt+/QZouzs5PiL066dHnrhHEz4xB8QLDnkTv6hxuQtyWAPESKXV9VV5JReyM193QWBNTXlT4Y4boaeGF9fL26og3cbF9vjsmRtdqcq9nxVX6R9NCCDKYf50jfv+3EO5gYHYbjzItATZg1OzVG5t3IFrWmjeGPpL9cCQ8HXYpGw3rQB38XUX2SCd8ilOmMrouXzAmBpgJvsnUNg/u/shBlnMC2dD7Wzy24HTaAzVuFxtSrFxhBk6fd+u1X8+rXaT2Jlcmt6ZzVHQMYPKEk0SecYEVnd/WCpZNzjZoKjII28FrgvK9tDftjly//dkfQIL+WF5dF9nDyrl37WLeYZ+b3j+g5kzaX9s2aN3kV+OLC4iud2vXfiMMqdYJdfk2NBfT/jfTc0P49unXrVKXQiVEWFhUXvT12xgHaK+jpxf3doNH7IUjWf0DPZwXNvh8OHkFZMsiKshRw8/yRBBmNl+VLZ0fb8ZayzH4krdyEnpQnudbiKRxMAbry9Y5gJwnfOzpfUpZF804fp46dOwlxvY5dnnZ64aVIRbOC39ovN8/GAW9ZsrpoSYhBU82dnczPkbpiI5iUcrK1ra2Nl2M1x7oHf/lueOd2/TeYmEnxAID2iSSDdQbZVp6ff7J214IPZ3YnnnLdunUiyNSJuMvfSC/fi8eOnepAp6EOnss5Rydc/kp0EDORfuXOZeyoqSeDmzSIQVtg8Q3K4IGvzkSZW9vd87sdgP+3Ejw05n3hFxroMgffU6f7KBs4uM8fy5euTjFKRkf6ks4FRJ61PJojL7hTePH99z5Kwsuael3R2gBbTPcMwiKVBeBkxh0KtGw7mQ/dhbeUynihvrU2sKEr2JPb1Km7h238a+ylp4zc6IRNXsdObV3JTswqKCw0kUeCNmLxiWp68zLOBpTeLm5LGydt377dXJycnazhewUd/K/YLZPmk8aOf80/LSW96Ntvf8jFRGodXA5iyRf88Es5xQZda0GbkZZVtGP77ntocaKXlRW3wQOv5ugot+vUyqluUGB18CGT5hZ+jwuOfRx0FbzVOcLQaz7Z0Q6eCsDRHzayiodCI58URwXVbR6l/Lghavw6hYGZsDr/rYSNLSKQcfS7AwiOSGWF4eJewRAmRVAD59MPOjPytwUZncAN5yyzhVacDSFlbDJIbO1qkzQXuP9Gql+/bTXj7WLbUq1t4V3H+kN3q5zWOnq5Jn05Jdm6GvMTExPJnC9PCDgYC2/X1Mp6o38j1xv3m0Q1LT5wu985DghlzGcxdqUaKzvSRpLJXtaFhdUpND8mLsZhKQcPuhSTxRL+UWFCkM3bPexZC/N2/9b/nYF/Z+AxZuD/AA8zEhkTLyOGAAAAAElFTkSuQmCC');\n}\n\n/* layers control */\n\n.l7-control-layers {\n  -webkit-box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);\n          box-shadow: 0 1px 8px rgba(0, 0, 0, 0.4);\n  background: #fff;\n  border-radius: 2px;\n}\n.l7-control-layers-toggle {\n  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAkCAYAAAGf7Ah0AAAABGdBTUEAALGPC/xhBQAABzdJREFUWAnVV3lslEUUn/l2F0tpwdAih1HEqCReDcphNCo1EkgFkXa5PNpuC0Fo2e7Wgko8KiaKWrvbK5672xYFpNtiRRuNiY0aURA14BGviBcVlaKltVa6+42/N9v5Mrtt05rwj/PHzjt+8743b+a9N8vYwKgMNlUQyemnMtAkaJajvb3dToQSGp8e6boopkr4VYgEMYwO0vhCTfMVzBcMf8bx086YyODcuM80zTqp9IWat+7evW8sMdIxIqqCLa6oiAaJpuEtcBqcc2HEWMZ0JclgZR/Nchf++ubrzKjJSguXS4tVjXvPjfb3/UAAacGTn/MOMb7QnjNpNqP/bKZ50Ai0tqYmCi0n4zbM+W+lBc7JBOa+QPhDwcTsxJXE2+32edKCL9h8hRDmRzpIOWydAylhrcMfDN+ugBRKSdP3KwPhsFJIPth02FISIYQwYsDYcVfWhy/Bon4JgumffMGmiGTwQ0B/sHml4q2ZFAD3WQIQVhx0IdFw8B189lolN+w8w5PnjPmlhJgtA8/vfn3iye7u3yGzDljDxZEG4097Cp3rSSjBtMHunp6vFR+HHoIxmbgTe1xHKssDHecLNFUjMzbqMs5ZlHF7ute17M84+TMHDzr+OvR9JwKdCms9yRkzJq6bPTsWXh05QOPUN+PUHyPWMPhm6UHd7vaUohWZPSRE8OqxpTyibQa/qcTlbEP0vwF7AWUAT3JM9dy69FfSNza+MU4awNE8iQtXSkJuGLleV852ov2h5jkwVof0mUs8aO4LhTuYYFOAjExId0wcFIPahpaLTkWiX9ECfHG/sLNi1i8+HODfgLFFRI96+INNi0cNTgTS1obKQh03aAuk9DeELzcj4pACYivvwvXrFK/PcQZiQWo+hmidpYMUjQC7EOB6xdNsGfAHwk/RDdOVw9Dm+NTUSWtWLDohDVQ37JkbiUT2DwMeVswZP+gtdM4x3HnLDhjcGM2XLWOISaenIGee9MCSgqgMht/H/q/SZYk0qviV3oKcj5XcioESyOoqIseFYDYloxnAGm/hcrcuk3JV2XBMl+pKqn6mENux11+w12m6jpqMMFn7rPPTHdwfCm8yTfG4tMaNu+GepPUFiqbM7T105ARSPQU+dY/LOC/N2gI65WEkyWUEtjmSppfkLvlRLaQ5VnZFDtGGzbheNRROKZmbu/AvUvh3tE4Wff2/0IUC+y2q+4VVoXBW1BSvkR7Rb8BW84lWJQBdlGozcs7GLy3Nd35OSqTxBqtfgkc1+sPjcqbDgEl6xK0dH5lv545LOCVL1/F+3CoY4eyY1+WcBiC2KYEHQBd5XDkyndE17xCm2Ug6BLcSwb3LigE1AlOYu6TS4HUwVEw0Df1osfBnLDwnpiFDCQPuvQ73Fkqxg8/hEVYLXt66MXbbzOK8bKre1hhkgDT0RDja3fEHytwZxCMLH0YWPkD0fxqjqUZDejDSV3z1LbexqPkEPJxKWLqtKOGbvPnZL460NlE/KgfkIZiRrfjShsQcG2QQDUwwXjcuZcID61Ys6ErUJ/LDOiCfLUzUjVQdEg0O4jn/ABEq0iuIjrEcwE0x/KGWNbjPj4BO00Gni0ZOoIPzLR5X9vMqqaQDqDzzENra4V5zp8sBZQcROYjsLvYUOPdbEVBKeiZ193QjCmwtZCM+ldS6EWYTH3wuNSV1i+pFCj/IAaWgGUfBq0N78qPM3DZcp9TxcTQeyzZm3ON2LatXpSlOP8BIB6qDLddHmHnFrBlpNZmZmdZbNXEB9XsRlZXFennqGHzoXW5DaId4iSoc/Q365EjnRjszPnYXZL9NDWUtGsqzCjAw7xprTypbn7fkaILcYqkInzzeX06C8emO8sKlS7stZQLxVMPes/+O9FVAvEpXob+utY6gZmfrtMjf/RUI+2odhF7wJbq+Gzf3zTj5CAwyaoEwozVoCzN1KKK00z7WUbZx9dIOklsO6CAZpu87i5gpHoJ8gtLh9vZixSO2KckV7qysf5Sc5uq2tjOix3rL0FW3IJuSNV0XM/iDs85LqxvqeKUD8n3LxUobt5WVuLJlS9IM4O9i09VRwWtxLWfpcix+hXjs8mZdjn19YuOiuKRgufzXqOuqQi2r8O+yAk/tl2Q/RMW7ETe8UdX1GJhHDM5qjDHJ5e7bs07qBp7ZsTe9t6/vUXykkLKEdLFbLgLJSUn3rrt1yXEdX/1C23jzVG+5Keg/B5r2wJD9g/NcaUAJq4MvXxxl/TWoATcoGc0Av4eUKnIXZlsvXpLHO0CS2KgOtGQgdeuwqWuUjGbUgrdszLHRXXDLF0oe54AS0kyPnc5Iz/2CmV7EeIzSwcjvsHQPXkUhld/kCP6Xu+DRNjg/SWHh+SnODF+aPeVh9XCydAPEsA4kAqsCzcuiTPiw7+maTj6SwGsVk/9gY9xbUpizR8MNS47aAd0C7s35CG8VdrxYyjl/FcdUgo73nY77X9D/Au9RDMh+aBoVAAAAAElFTkSuQmCC');\n  width: 30px;\n  height: 30px;\n  background-size: 20px 20px;\n}\n\n.l7-touch .l7-control-layers-toggle {\n  width: 44px;\n  height: 44px;\n}\n.l7-control-layers .l7-control-layers-list,\n.l7-control-layers-expanded .l7-control-layers-toggle {\n  display: none;\n}\n.l7-control-layers-expanded .l7-control-layers-list {\n  display: block;\n  position: relative;\n}\n.l7-control-layers-expanded {\n  padding: 6px 10px 6px 6px;\n  color: #59626b;\n  background: #fff;\n}\n.l7-control-layers-scrollbar {\n  overflow-y: scroll;\n  overflow-x: hidden;\n  padding-right: 5px;\n}\n.l7-control-layers-selector {\n  margin-top: 2px;\n  position: relative;\n  top: 1px;\n}\n.l7-control-layers label {\n  display: block;\n  padding: 8px;\n}\n.l7-control-layers label input[type='radio'],\n.l7-control-layers label input[type='checkbox'] {\n  width: 14px;\n  height: 14px;\n  margin: 0;\n}\n.l7-control-layers-separator {\n  height: 0;\n  border-top: 1px solid #d8d8d8;\n  margin: 5px -10px 5px -6px;\n}\n.mapboxgl-ctrl-logo {\n  display: none !important;\n}\n.amap-logo {\n  display: none !important;\n}\n");var rt,dt,Ot,G=M(32952),Ve=M(56326);function B(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Ue(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?B(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):B(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var _t=(rt=(0,Z.yT)(Z.vK.IGlobalConfigService),dt=function(){function n(l){(0,X.Z)(this,n),(0,G.Z)(this,"configService",Ot,this),(0,z.Z)(this,"config",void 0),this.config=l}return(0,q.Z)(n,[{key:"setContainer",value:function(i,u){i.bind(Z.vK.MapConfig).toConstantValue(Ue(Ue({},this.config),{},{id:u})),i.bind(Z.vK.IMapService).to(this.getServiceConstructor()).inSingletonScope()}},{key:"getServiceConstructor",value:function(){throw new Error("Method not implemented.")}}]),n}(),Ot=(0,Ve.Z)(dt.prototype,"configService",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt),St=M(71189),Xt=M(8239),Cr=M(88774),_r=M.n(Cr),jt=M(30651),mr=M(14563);function er(){var n=new mr.WT(3);return mr.WT!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function pr(n){var l=new mr.WT(3);return l[0]=n[0],l[1]=n[1],l[2]=n[2],l}function Ln(n){return Math.hypot(n[0],n[1],n[2])}function Wn(n,l,i){var u=new mr.WT(3);return u[0]=n,u[1]=l,u[2]=i,u}function mi(n,l){return n[0]=l[0],n[1]=l[1],n[2]=l[2],n}function hi(n,l,i,u){return n[0]=l,n[1]=i,n[2]=u,n}function si(n,l,i){return n[0]=l[0]+i[0],n[1]=l[1]+i[1],n[2]=l[2]+i[2],n}function ai(n,l,i){return n[0]=l[0]-i[0],n[1]=l[1]-i[1],n[2]=l[2]-i[2],n}function Yi(n,l,i){return n[0]=l[0]*i[0],n[1]=l[1]*i[1],n[2]=l[2]*i[2],n}function Pi(n,l,i){return n[0]=l[0]/i[0],n[1]=l[1]/i[1],n[2]=l[2]/i[2],n}function Ei(n,l){return n[0]=Math.ceil(l[0]),n[1]=Math.ceil(l[1]),n[2]=Math.ceil(l[2]),n}function Q(n,l){return n[0]=Math.floor(l[0]),n[1]=Math.floor(l[1]),n[2]=Math.floor(l[2]),n}function he(n,l,i){return n[0]=Math.min(l[0],i[0]),n[1]=Math.min(l[1],i[1]),n[2]=Math.min(l[2],i[2]),n}function ge(n,l,i){return n[0]=Math.max(l[0],i[0]),n[1]=Math.max(l[1],i[1]),n[2]=Math.max(l[2],i[2]),n}function F(n,l){return n[0]=Math.round(l[0]),n[1]=Math.round(l[1]),n[2]=Math.round(l[2]),n}function re(n,l,i){return n[0]=l[0]*i,n[1]=l[1]*i,n[2]=l[2]*i,n}function ye(n,l,i,u){return n[0]=l[0]+i[0]*u,n[1]=l[1]+i[1]*u,n[2]=l[2]+i[2]*u,n}function Me(n,l){return Math.hypot(l[0]-n[0],l[1]-n[1],l[2]-n[2])}function ce(n,l){var i=l[0]-n[0],u=l[1]-n[1],f=l[2]-n[2];return i*i+u*u+f*f}function Te(n){var l=n[0],i=n[1],u=n[2];return l*l+i*i+u*u}function mt(n,l){return n[0]=-l[0],n[1]=-l[1],n[2]=-l[2],n}function wr(n,l){return n[0]=1/l[0],n[1]=1/l[1],n[2]=1/l[2],n}function Vt(n,l){var i=l[0],u=l[1],f=l[2],v=i*i+u*u+f*f;return v>0&&(v=1/Math.sqrt(v)),n[0]=l[0]*v,n[1]=l[1]*v,n[2]=l[2]*v,n}function $t(n,l){return n[0]*l[0]+n[1]*l[1]+n[2]*l[2]}function Br(n,l,i){var u=l[0],f=l[1],v=l[2],b=i[0],P=i[1],I=i[2];return n[0]=f*I-v*P,n[1]=v*b-u*I,n[2]=u*P-f*b,n}function On(n,l,i,u){var f=l[0],v=l[1],b=l[2];return n[0]=f+u*(i[0]-f),n[1]=v+u*(i[1]-v),n[2]=b+u*(i[2]-b),n}function Cn(n,l,i,u,f,v){var b=v*v,P=b*(2*v-3)+1,I=b*(v-2)+v,N=b*(v-1),se=b*(3-2*v);return n[0]=l[0]*P+i[0]*I+u[0]*N+f[0]*se,n[1]=l[1]*P+i[1]*I+u[1]*N+f[1]*se,n[2]=l[2]*P+i[2]*I+u[2]*N+f[2]*se,n}function qt(n,l,i,u,f,v){var b=1-v,P=b*b,I=v*v,N=P*b,se=3*v*P,ie=3*I*b,Re=I*v;return n[0]=l[0]*N+i[0]*se+u[0]*ie+f[0]*Re,n[1]=l[1]*N+i[1]*se+u[1]*ie+f[1]*Re,n[2]=l[2]*N+i[2]*se+u[2]*ie+f[2]*Re,n}function xn(n,l){l=l||1;var i=2*mr.FD()*Math.PI,u=2*mr.FD()-1,f=Math.sqrt(1-u*u)*l;return n[0]=Math.cos(i)*f,n[1]=Math.sin(i)*f,n[2]=u*l,n}function nn(n,l,i){var u=l[0],f=l[1],v=l[2],b=i[3]*u+i[7]*f+i[11]*v+i[15];return n[0]=(i[0]*u+i[4]*f+i[8]*v+i[12])/(b=b||1),n[1]=(i[1]*u+i[5]*f+i[9]*v+i[13])/b,n[2]=(i[2]*u+i[6]*f+i[10]*v+i[14])/b,n}function ln(n,l,i){var u=l[0],f=l[1],v=l[2];return n[0]=u*i[0]+f*i[3]+v*i[6],n[1]=u*i[1]+f*i[4]+v*i[7],n[2]=u*i[2]+f*i[5]+v*i[8],n}function Di(n,l,i){var u=i[0],f=i[1],v=i[2],P=l[0],I=l[1],N=l[2],se=f*N-v*I,ie=v*P-u*N,Re=u*I-f*P,Je=f*Re-v*ie,It=v*se-u*Re,Zt=u*ie-f*se,Tr=2*i[3];return ie*=Tr,Re*=Tr,It*=2,Zt*=2,n[0]=P+(se*=Tr)+(Je*=2),n[1]=I+ie+It,n[2]=N+Re+Zt,n}function gn(n,l,i,u){var f=[],v=[];return f[0]=l[0]-i[0],f[1]=l[1]-i[1],f[2]=l[2]-i[2],v[0]=f[0],v[1]=f[1]*Math.cos(u)-f[2]*Math.sin(u),v[2]=f[1]*Math.sin(u)+f[2]*Math.cos(u),n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function Oi(n,l,i,u){var f=[],v=[];return f[0]=l[0]-i[0],f[1]=l[1]-i[1],f[2]=l[2]-i[2],v[0]=f[2]*Math.sin(u)+f[0]*Math.cos(u),v[1]=f[1],v[2]=f[2]*Math.cos(u)-f[0]*Math.sin(u),n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function ta(n,l,i,u){var f=[],v=[];return f[0]=l[0]-i[0],f[1]=l[1]-i[1],f[2]=l[2]-i[2],v[0]=f[0]*Math.cos(u)-f[1]*Math.sin(u),v[1]=f[0]*Math.sin(u)+f[1]*Math.cos(u),v[2]=f[2],n[0]=v[0]+i[0],n[1]=v[1]+i[1],n[2]=v[2]+i[2],n}function oi(n,l){var i=n[0],u=n[1],f=n[2],v=l[0],b=l[1],P=l[2],se=Math.sqrt(i*i+u*u+f*f)*Math.sqrt(v*v+b*b+P*P),ie=se&&$t(n,l)/se;return Math.acos(Math.min(Math.max(ie,-1),1))}function Ji(n){return n[0]=0,n[1]=0,n[2]=0,n}function ji(n){return"vec3("+n[0]+", "+n[1]+", "+n[2]+")"}function Ti(n,l){return n[0]===l[0]&&n[1]===l[1]&&n[2]===l[2]}function _a(n,l){var i=n[0],u=n[1],f=n[2],v=l[0],b=l[1],P=l[2];return Math.abs(i-v)<=mr.Ib*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(u-b)<=mr.Ib*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(f-P)<=mr.Ib*Math.max(1,Math.abs(f),Math.abs(P))}var n,Ma=ai,Gi=Yi,Bi=Pi,Xi=Me,to=ce,Ho=Ln,Za=Te,Wi=(n=er(),function(l,i,u,f,v,b){var P,I;for(i||(i=3),u||(u=0),I=f?Math.min(f*i+u,l.length):l.length,P=u;P<I;P+=i)n[0]=l[P],n[1]=l[P+1],n[2]=l[P+2],v(n,n,b),l[P]=n[0],l[P+1]=n[1],l[P+2]=n[2];return l}),va=M(15922),Su=M(82958),Da=M.n(Su),Fi=(M(78320),(()=>(function(n){n["GAODE1.x"]="GAODE1.x",n["GAODE2.x"]="GAODE2.x",n.MAPBOX="MAPBOX",n.L7MAP="L7MAP",n.GLOBEL="GLOBEL"}(Fi||(Fi={})),Fi))()),ra=M(83838),bo=M(58623);function vo(n,l){var i=bo.fF([],l,n);return bo.bA(i,i,1/i[3]),i}function aa(){var n=new mr.WT(2);return mr.WT!=Float32Array&&(n[0]=0,n[1]=0),n}function Ia(n,l){var i=new mr.WT(2);return i[0]=n,i[1]=l,i}function Ya(n,l){return n[0]=l[0],n[1]=l[1],n}function Ba(n,l,i){return n[0]=l[0]+i[0],n[1]=l[1]+i[1],n}function be(n,l,i){return n[0]=l[0]-i[0],n[1]=l[1]-i[1],n}function ko(n,l){var i=l[0],u=l[1],f=i*i+u*u;return f>0&&(f=1/Math.sqrt(f)),n[0]=l[0]*f,n[1]=l[1]*f,n}function es(n,l){return n[0]*l[0]+n[1]*l[1]}function Ls(n,l,i,u){var f=l[0],v=l[1];return n[0]=f+u*(i[0]-f),n[1]=v+u*(i[1]-v),n}var m=be;function Rt(n,l){if(!n)throw new Error(l||"viewport-mercator-project: assertion failed.")}aa();var kt=Math.PI,Ir=kt/4,Nr=kt/180,Jn=180/kt;function Ea(n){return Math.pow(2,n)}function vi(n,l){var i=(0,ra.Z)(n,2),u=i[0],f=i[1];return Rt(Number.isFinite(u)&&Number.isFinite(l)),Rt(Number.isFinite(f)&&f>=-90&&f<=90,"invalid latitude"),[(l*=512)*(u*Nr+kt)/(2*kt),l*(kt-Math.log(Math.tan(Ir+f*Nr*.5)))/(2*kt)]}function Xo(n,l){var i=(0,ra.Z)(n,2),v=i[0]/(l*=512)*(2*kt)-kt,b=2*(Math.atan(Math.exp(kt-i[1]/l*(2*kt)))-Ir);return[v*Jn,b*Jn]}function Tu(n){var l=n.latitude,i=n.longitude,f=n.scale,v=n.highPrecision,b=void 0!==v&&v;f=void 0!==f?f:Ea(n.zoom),Rt(Number.isFinite(l)&&Number.isFinite(i)&&Number.isFinite(f));var P={},I=512*f,N=Math.cos(l*Nr),se=I/360,ie=se/N,Re=I/4003e4/N;if(P.pixelsPerMeter=[Re,-Re,Re],P.metersPerPixel=[1/Re,-1/Re,1/Re],P.pixelsPerDegree=[se,-ie,Re],P.degreesPerPixel=[1/se,-1/ie,1/Re],b){var Je=Nr*Math.tan(l*Nr)/N,Zt=I/4003e4*Je,Tr=Zt/ie*Re;P.pixelsPerDegree2=[0,-se*Je/2,Zt],P.pixelsPerMeter2=[Tr,0,Tr]}return P}function Du(n){var l=n.height,i=n.pitch,u=n.bearing,v=n.center,b=void 0===v?null:v,P=n.flipY,I=void 0!==P&&P,N=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return jt.translate(N,N,[0,0,-n.altitude]),jt.scale(N,N,[1,1,1/l]),jt.rotateX(N,N,-i*Nr),jt.rotateZ(N,N,u*Nr),I&&jt.scale(N,N,[1,-1,1]),b&&jt.translate(N,N,mt([],b)),N}function mu(n){var P=function(n){var l=n.width,i=n.height,u=n.altitude,f=void 0===u?1.5:u,v=n.pitch,P=n.nearZMultiplier,I=void 0===P?1:P,N=n.farZMultiplier,se=void 0===N?1:N,ie=(void 0===v?0:v)*Nr,Re=Math.atan(.5/f),Je=Math.sin(Re)*f/Math.sin(Math.PI/2-ie-Re),It=Math.cos(Math.PI/2-ie)*Je+f;return{fov:2*Math.atan(i/2/f),aspect:l/i,focalDistance:f,near:I,far:It*se}}({width:n.width,height:n.height,altitude:n.altitude,pitch:n.pitch,nearZMultiplier:n.nearZMultiplier,farZMultiplier:n.farZMultiplier});return jt.perspective([],P.fov,P.aspect,P.near,P.far)}function gu(n,l){var i=(0,ra.Z)(n,3),u=i[0],f=i[1],v=i[2],b=void 0===v?0:v;return Rt(Number.isFinite(u)&&Number.isFinite(f)&&Number.isFinite(b)),vo(l,[u,f,b,1])}function tu(n,l){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=(0,ra.Z)(n,3),f=u[0],v=u[1],b=u[2];if(Rt(Number.isFinite(f)&&Number.isFinite(v),"invalid pixel coordinate"),Number.isFinite(b)){var P=vo(l,[f,v,b,1]);return P}var I=vo(l,[f,v,0,1]),N=vo(l,[f,v,1,1]),se=I[2],ie=N[2],Re=se===ie?0:((i||0)-se)/(ie-se);return Ls([],I,N,Re)}var oo=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function Cc(n){var l=n.width,i=n.height,f=n.minExtent,v=void 0===f?0:f,b=n.maxZoom,P=void 0===b?24:b,I=n.padding,N=void 0===I?0:I,se=n.offset,ie=void 0===se?[0,0]:se,Re=(0,ra.Z)(n.bounds,2),Je=(0,ra.Z)(Re[0],2),It=Je[0],Zt=Je[1],Tr=(0,ra.Z)(Re[1],2),Vr=Tr[0],on=Tr[1];Number.isFinite(N)?N={top:N,bottom:N,left:N,right:N}:Rt(Number.isFinite(N.top)&&Number.isFinite(N.bottom)&&Number.isFinite(N.left)&&Number.isFinite(N.right));var Pn=new rs({width:l,height:i,longitude:0,latitude:0,zoom:0}),Hn=Pn.project([It,on]),ei=Pn.project([Vr,Zt]),ti=[Math.max(Math.abs(ei[0]-Hn[0]),v),Math.max(Math.abs(ei[1]-Hn[1]),v)],Ui=[l-N.left-N.right-2*Math.abs(ie[0]),i-N.top-N.bottom-2*Math.abs(ie[1])];Rt(Ui[0]>0&&Ui[1]>0);var Sa=Ui[0]/ti[0],Ua=Ui[1]/ti[1],Ru=Pn.unproject([(ei[0]+Hn[0])/2+(N.right-N.left)/2/Sa,(ei[1]+Hn[1])/2+(N.bottom-N.top)/2/Ua]),_p=Pn.zoom+Math.log2(Math.abs(Math.min(Sa,Ua)));return{longitude:Ru[0],latitude:Ru[1],zoom:Math.min(_p,P)}}var Rs,rc,Bu,ka,Ju,Gc,Us,nc,Hc,Ac,Fl,rs=function(n){function l(){var i,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=u.width,v=u.height,b=u.latitude,P=void 0===b?0:b,I=u.longitude,N=void 0===I?0:I,se=u.zoom,ie=void 0===se?0:se,Re=u.pitch,Je=void 0===Re?0:Re,It=u.bearing,Zt=void 0===It?0:It,Tr=u.altitude,Vr=void 0===Tr?1.5:Tr,on=u.nearZMultiplier,mn=u.farZMultiplier;(0,X.Z)(this,l),f=f||1,v=v||1;var Pn=Ea(ie);Vr=Math.max(.75,Vr);var Hn=vi([N,P],Pn);Hn[2]=0;var ei=mu({width:f,height:v,pitch:Je,bearing:Zt,altitude:Vr,nearZMultiplier:on||1/v,farZMultiplier:mn||1.01}),ti=Du({height:v,center:Hn,pitch:Je,bearing:Zt,altitude:Vr,flipY:!0});return(i=(0,Xe.Z)(this,(0,et.Z)(l).call(this,{width:f,height:v,viewMatrix:ti,projectionMatrix:ei}))).latitude=P,i.longitude=N,i.zoom=ie,i.pitch=Je,i.bearing=Zt,i.altitude=Vr,i.scale=Pn,i.center=Hn,i.pixelsPerMeter=Tu((0,te.Z)((0,te.Z)(i))).pixelsPerMeter[2],Object.freeze((0,te.Z)((0,te.Z)(i))),i}return(0,Y.Z)(l,n),(0,q.Z)(l,[{key:"projectFlat",value:function(u){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return vi(u,f)}},{key:"unprojectFlat",value:function(u){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.scale;return Xo(u,f)}},{key:"getMapCenterByLngLatPosition",value:function(u){var f=u.lngLat,b=tu(u.pos,this.pixelUnprojectionMatrix),I=Ba([],vi(f,this.scale),function(n,l){return n[0]=-l[0],n[1]=-l[1],n}([],b));return Xo(Ba([],this.center,I),this.scale)}},{key:"getLocationAtPoint",value:function(u){return this.getMapCenterByLngLatPosition({lngLat:u.lngLat,pos:u.pos})}},{key:"fitBounds",value:function(u){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},v=this.width,b=this.height,P=Cc(Object.assign({width:v,height:b,bounds:u},f)),I=P.longitude,N=P.latitude,se=P.zoom;return new l({width:v,height:b,longitude:I,latitude:N,zoom:se})}}]),l}(function(){function n(){var l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=l.width,u=l.height,f=l.viewMatrix,v=void 0===f?oo:f,b=l.projectionMatrix,P=void 0===b?oo:b;(0,X.Z)(this,n),this.width=i||1,this.height=u||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=v,this.projectionMatrix=P;var I=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];jt.multiply(I,I,this.projectionMatrix),jt.multiply(I,I,this.viewMatrix),this.viewProjectionMatrix=I;var N=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];jt.scale(N,N,[this.width/2,-this.height/2,1]),jt.translate(N,N,[1,-1,0]),jt.multiply(N,N,this.viewProjectionMatrix);var se=jt.invert([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],N);if(!se)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=N,this.pixelUnprojectionMatrix=se,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return(0,q.Z)(n,[{key:"equals",value:function(i){return i instanceof n&&i.width===this.width&&i.height===this.height&&jt.equals(i.projectionMatrix,this.projectionMatrix)&&jt.equals(i.viewMatrix,this.viewMatrix)}},{key:"project",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=u.topLeft,v=void 0===f||f,b=this.projectPosition(i),P=gu(b,this.pixelProjectionMatrix),I=(0,ra.Z)(P,2),N=I[0],se=I[1],ie=v?se:this.height-se;return 2===i.length?[N,ie]:[N,ie,P[2]]}},{key:"unproject",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},f=u.topLeft,v=void 0===f||f,b=u.targetZ,P=(0,ra.Z)(i,3),I=P[0],N=P[1],se=P[2],ie=v?N:this.height-N,Re=b&&b*this.pixelsPerMeter,Je=tu([I,ie,se],this.pixelUnprojectionMatrix,Re),It=this.unprojectPosition(Je),Zt=(0,ra.Z)(It,3),Tr=Zt[0],Vr=Zt[1],on=Zt[2];return Number.isFinite(se)?[Tr,Vr,on]:Number.isFinite(b)?[Tr,Vr,b]:[Tr,Vr]}},{key:"projectPosition",value:function(i){var u=this.projectFlat(i),f=(0,ra.Z)(u,2);return[f[0],f[1],(i[2]||0)*this.pixelsPerMeter]}},{key:"unprojectPosition",value:function(i){var u=this.unprojectFlat(i),f=(0,ra.Z)(u,2);return[f[0],f[1],(i[2]||0)/this.pixelsPerMeter]}},{key:"projectFlat",value:function(i){return i}},{key:"unprojectFlat",value:function(i){return i}}]),n}()),tc=function(){function n(){(0,X.Z)(this,n),(0,z.Z)(this,"viewport",void 0)}return(0,q.Z)(n,[{key:"syncWithMapCamera",value:function(i){var u=i.center;this.viewport=new rs({width:i.viewportWidth,height:i.viewportHeight,longitude:u&&u[0],latitude:u&&u[1],zoom:i.zoom,pitch:i.pitch,bearing:i.bearing})}},{key:"getZoom",value:function(){return this.viewport.zoom}},{key:"getZoomScale",value:function(){return Math.pow(2,this.getZoom())}},{key:"getCenter",value:function(){return[this.viewport.longitude,this.viewport.latitude]}},{key:"getProjectionMatrix",value:function(){return this.viewport.projectionMatrix}},{key:"getModelMatrix",value:function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}},{key:"getViewMatrix",value:function(){return this.viewport.viewMatrix}},{key:"getViewMatrixUncentered",value:function(){return this.viewport.viewMatrixUncentered}},{key:"getViewProjectionMatrix",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getViewProjectionMatrixUncentered",value:function(){return this.viewport.viewProjectionMatrix}},{key:"getFocalDistance",value:function(){return 1}},{key:"projectFlat",value:function(i,u){return this.viewport.projectFlat(i,u)}}]),n}(),ru={light:"mapbox://styles/zcxduo/ck2ypyb1r3q9o1co1766dex29",dark:"mapbox://styles/zcxduo/ck241p6413s0b1cpayzldv7x7",normal:"mapbox://styles/mapbox/streets-v11",blank:{version:8,sources:{},layers:[{id:"background",type:"background",layout:{visibility:"none"}}]}};function yu(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function $u(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?yu(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):yu(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}(function(n,l){if(l||(l=document),l){var i=l.head||l.getElementsByTagName("head")[0];if(!i){i=l.createElement("head");var u=l.body||l.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):l.documentElement.appendChild(i)}var f=l.createElement("style");f.type="text/css",f.styleSheet?f.styleSheet.cssText=n:f.appendChild(l.createTextNode(n)),i.appendChild(f)}})(".mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif;overflow:hidden;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mapboxgl-canvas{position:absolute;left:0;top:0}.mapboxgl-map:-webkit-full-screen{width:100%;height:100%}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:-webkit-grab;cursor:grab;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{-ms-touch-action:pan-x pan-y;touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:pinch-zoom;touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{-ms-touch-action:none;touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;-webkit-transform:translate(0);transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){-webkit-box-shadow:0 0 0 2px ButtonText;box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-attrib-button:focus,.mapboxgl-ctrl-group button:focus{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{-webkit-box-shadow:0 0 2px 2px #0096ff;box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){-webkit-box-shadow:none;box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E\")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E\")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E\")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:2px 24px 2px 0;margin:10px;position:relative;background-color:#fff;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 28px 2px 8px;visibility:visible}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact-show{padding:2px 8px 2px 28px;border-radius:12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib-button{display:none;cursor:pointer;position:absolute;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;-webkit-box-sizing:border-box;box-sizing:border-box;border-radius:12px;outline:none;top:0;right:0;border:0}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl-attrib-button,.mapboxgl-ctrl-top-left .mapboxgl-ctrl-attrib-button{left:0}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-inner,.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-button{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact-show .mapboxgl-ctrl-attrib-button{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E\")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;-webkit-box-sizing:border-box;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-box;display:-ms-flexbox;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-box-orient:vertical;-webkit-box-direction:reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;-ms-flex-item-align:start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;-ms-flex-item-align:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;-webkit-box-shadow:0 1px 2px rgba(0,0,0,.1);box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:-webkit-box;display:-ms-flexbox;display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot,.mapboxgl-user-location-dot:before{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{content:\"\";position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:\"\";height:19px;left:-2px;position:absolute;top:-2px;width:19px;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:0 0 3px rgba(0,0,0,.35);box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);transform:scale(3);opacity:0}to{-webkit-transform:scale(1);transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}"),window.mapboxgl=Da();var Qu={mapmove:"move",camerachange:"move",zoomchange:"zoom",dragging:"drag"},el=0,Fu="pk.eyJ1IjoibHp4dWUiLCJhIjoiY2tvaWZuM2s4MWZuYjJ1dHI5ZGduYTlrdiJ9.DQCfMRbZzx0VSwecQ69McA",Vs=(Rs=(0,va.b2)(),rc=(0,va.f3)(Z.vK.MapConfig),Bu=(0,va.f3)(Z.vK.IGlobalConfigService),ka=(0,va.f3)(Z.vK.ICoordinateSystemService),Ju=(0,va.f3)(Z.vK.IEventEmitter),Rs((Us=function(){function n(){var l=this;(0,X.Z)(this,n),(0,z.Z)(this,"version",Fi.MAPBOX),(0,z.Z)(this,"map",void 0),(0,z.Z)(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),(0,G.Z)(this,"config",nc,this),(0,G.Z)(this,"configService",Hc,this),(0,G.Z)(this,"coordinateSystemService",Ac,this),(0,G.Z)(this,"eventEmitter",Fl,this),(0,z.Z)(this,"viewport",void 0),(0,z.Z)(this,"markerContainer",void 0),(0,z.Z)(this,"cameraChangedCallback",void 0),(0,z.Z)(this,"$mapContainer",void 0),(0,z.Z)(this,"handleCameraChanged",function(){var i=l.map.getCenter().wrap(),u=i.lat,f=i.lng;l.viewport.syncWithMapCamera({bearing:l.map.getBearing(),center:[f,u],viewportHeight:l.map.transform.height,pitch:l.map.getPitch(),viewportWidth:l.map.transform.width,zoom:l.map.getZoom(),cameraHeight:0});var v=l.config.offsetZoom,b=void 0===v?12:v;l.viewport.getZoom()>b?l.coordinateSystemService.setCoordinateSystem(Z.CoordinateSystem.LNGLAT_OFFSET):l.coordinateSystemService.setCoordinateSystem(Z.CoordinateSystem.LNGLAT),l.cameraChangedCallback(l.viewport)})}return(0,q.Z)(n,[{key:"setBgColor",value:function(i){this.bgColor=i}},{key:"addMarkerContainer",value:function(){var i=this.map.getCanvasContainer();this.markerContainer=tt.SO.create("div","l7-marker-container",i),this.markerContainer.setAttribute("tabindex","-1")}},{key:"getMarkerContainer",value:function(){return this.markerContainer}},{key:"on",value:function(i,u){-1!==Z.MapServiceEvent.indexOf(i)?this.eventEmitter.on(i,u):this.map.on(Qu[i]||i,u)}},{key:"off",value:function(i,u){this.map.off(Qu[i]||i,u)}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getMapCanvasContainer",value:function(){return this.map.getCanvasContainer()}},{key:"getSize",value:function(){var i=this.map.transform;return[i.width,i.height]}},{key:"getType",value:function(){return"mapbox"}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"setZoom",value:function(i){return this.map.setZoom(i)}},{key:"getCenter",value:function(){return this.map.getCenter()}},{key:"setCenter",value:function(i){this.map.setCenter(i)}},{key:"getPitch",value:function(){return this.map.getPitch()}},{key:"getRotation",value:function(){return this.map.getBearing()}},{key:"getBounds",value:function(){return this.map.getBounds().toArray()}},{key:"getMinZoom",value:function(){return this.map.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.map.getMaxZoom()}},{key:"setRotation",value:function(i){this.map.setBearing(i)}},{key:"zoomIn",value:function(i,u){this.map.zoomIn(i,u)}},{key:"zoomOut",value:function(i,u){this.map.zoomOut(i,u)}},{key:"setPitch",value:function(i){return this.map.setPitch(i)}},{key:"panTo",value:function(i){this.map.panTo(i)}},{key:"panBy",value:function(i,u){this.panTo([i,u])}},{key:"fitBounds",value:function(i,u){this.map.fitBounds(i,u)}},{key:"setMaxZoom",value:function(i){this.map.setMaxZoom(i)}},{key:"setMinZoom",value:function(i){this.map.setMinZoom(i)}},{key:"setMapStatus",value:function(i){!0===i.doubleClickZoom&&this.map.doubleClickZoom.enable(),!1===i.doubleClickZoom&&this.map.doubleClickZoom.disable(),!1===i.dragEnable&&this.map.dragPan.disable(),!0===i.dragEnable&&this.map.dragPan.enable(),!1===i.rotateEnable&&this.map.dragRotate.disable(),!0===i.rotateEnable&&this.map.dragRotate.enable(),!1===i.keyboardEnable&&this.map.keyboard.disable(),!0===i.keyboardEnable&&this.map.keyboard.enable(),!1===i.zoomEnable&&this.map.scrollZoom.disable(),!0===i.zoomEnable&&this.map.scrollZoom.enable()}},{key:"setZoomAndCenter",value:function(i,u){this.map.flyTo({zoom:i,center:u})}},{key:"setMapStyle",value:function(i){this.map.setStyle(this.getMapStyle(i))}},{key:"pixelToLngLat",value:function(i){return this.map.unproject(i)}},{key:"lngLatToPixel",value:function(i){return this.map.project(i)}},{key:"containerToLngLat",value:function(i){return this.map.unproject(i)}},{key:"lngLatToContainer",value:function(i){return this.map.project(i)}},{key:"lngLatToCoord",value:function(i){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0},f=this.lngLatToMercator(i,0),v=f.x,b=f.y;return[v-u.x,b-u.y]}},{key:"lngLatToMercator",value:function(i,u){var f=window.mapboxgl.MercatorCoordinate.fromLngLat(i,u),v=f.x,P=f.y,N=f.z;return{x:void 0===v?0:v,y:void 0===P?0:P,z:void 0===N?0:N}}},{key:"getModelMatrix",value:function(i,u,f){var v=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],b=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{x:0,y:0,z:0},P=window.mapboxgl.MercatorCoordinate.fromLngLat(i,u),I=P.meterInMercatorCoordinateUnits(),N=jt.create();return jt.translate(N,N,Wn(P.x-b.x,P.y-b.y,P.z||0-b.z)),jt.scale(N,N,Wn(I*v[0],-I*v[1],I*v[2])),jt.rotateX(N,N,f[0]),jt.rotateY(N,N,f[1]),jt.rotateZ(N,N,f[2]),N}},{key:"init",value:(l=(0,Xt.Z)(_r().mark(function u(){var f,v,b,P,I,N,se,ie,Re,Je,It,Zt,Tr;return _r().wrap(function(on){for(;;)switch(on.prev=on.next){case 0:b=void 0===(v=(f=this.config).id)?"map":v,I=void 0!==(P=f.attributionControl)&&P,se=void 0===(N=f.style)?"light":N,Re=void 0===(ie=f.token)?Fu:ie,It=void 0===(Je=f.rotation)?0:Je,Zt=f.mapInstance,Tr=(0,St.Z)(f,["id","attributionControl","style","token","rotation","mapInstance"]),this.viewport=new tc,!Zt&&!window.mapboxgl&&console.error(this.configService.getSceneWarninfo("SDK")),Re===Fu&&"blank"!==se&&!window.mapboxgl.accessToken&&!Zt&&console.warn(this.configService.getSceneWarninfo("MapToken")),!Zt&&!window.mapboxgl.accessToken&&(window.mapboxgl.accessToken=Re),Zt?(this.map=Zt,this.$mapContainer=this.map.getContainer()):(this.$mapContainer=this.creatAmapContainer(b),this.map=new window.mapboxgl.Map($u({container:this.$mapContainer,style:this.getMapStyle(se),attributionControl:I,bearing:It},Tr))),this.map.on("load",this.handleCameraChanged),this.map.on("move",this.handleCameraChanged),this.handleCameraChanged();case 9:case"end":return on.stop()}},u,this)})),function(){return l.apply(this,arguments)})},{key:"destroy",value:function(){var i,u;null===(i=this.$mapContainer)||void 0===i||null===(u=i.parentNode)||void 0===u||u.removeChild(this.$mapContainer),this.eventEmitter.removeAllListeners(),this.map&&(this.map.remove(),this.$mapContainer=null)}},{key:"emit",value:function(i){for(var u,f=arguments.length,v=new Array(f>1?f-1:0),b=1;b<f;b++)v[b-1]=arguments[b];(u=this.eventEmitter).emit.apply(u,[i].concat(v))}},{key:"once",value:function(i){for(var u,f=arguments.length,v=new Array(f>1?f-1:0),b=1;b<f;b++)v[b-1]=arguments[b];(u=this.eventEmitter).once.apply(u,[i].concat(v))}},{key:"getMapContainer",value:function(){return this.$mapContainer}},{key:"exportMap",value:function(i){var u=this.map.getCanvas();return"jpg"===i?null==u?void 0:u.toDataURL("image/jpeg"):null==u?void 0:u.toDataURL("image/png")}},{key:"onCameraChanged",value:function(i){this.cameraChangedCallback=i}},{key:"creatAmapContainer",value:function(i){var u=i;"string"==typeof i&&(u=document.getElementById(i));var f=document.createElement("div");return f.style.cssText+="\n      position: absolute;\n      top: 0;\n      height: 100%;\n      width: 100%;\n    ",f.id="l7_mapbox_div"+el++,u.appendChild(f),f}},{key:"getMapStyle",value:function(i){return"string"!=typeof i?i:ru[i]?ru[i]:i}}]),n;var l}(),nc=(0,Ve.Z)(Us.prototype,"config",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hc=(0,Ve.Z)(Us.prototype,"configService",[Bu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ac=(0,Ve.Z)(Us.prototype,"coordinateSystemService",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fl=(0,Ve.Z)(Us.prototype,"eventEmitter",[Ju],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gc=Us))||Gc);!function(n,l){if(l||(l=document),l){var i=l.head||l.getElementsByTagName("head")[0];if(!i){i=l.createElement("head");var u=l.body||l.getElementsByTagName("body")[0];u?u.parentNode.insertBefore(i,u):l.documentElement.appendChild(i)}var f=l.createElement("style");f.type="text/css",f.styleSheet?f.styleSheet.cssText=n:f.appendChild(l.createTextNode(n)),i.appendChild(f)}}(".mapboxgl-ctrl-logo {\n display: none !important;\n}\n");var tl=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){return(0,X.Z)(this,i),l.apply(this,arguments)}return(0,q.Z)(i,[{key:"getServiceConstructor",value:function(){return Vs}}]),i}(_t),vl={},Nl={},ic=function(l){return Nl[l]},Nu=function(l,i){Nl[l]=i},Cu=function(l,i){vl[l]=i},zu={},nu={};function ac(n){return new Function("d","return {"+n.map(function(l,i){return JSON.stringify(l)+": d["+i+'] || ""'}).join(",")+"}")}function Zu(n){var l=Object.create(null),i=[];return n.forEach(function(u){for(var f in u)f in l||i.push(l[f]=f)}),i}function ns(n,l){var i=n+"",u=i.length;return u<l?new Array(l-u+1).join(0)+i:i}var Pu=function(n){var l=new RegExp('[",\n\r]'),i=n.charCodeAt(0);function f(ie,Re){var Vr,Je=[],It=ie.length,Zt=0,Tr=0,on=It<=0,mn=!1;function Pn(){if(on)return nu;if(mn)return mn=!1,zu;var ei,Ui,ti=Zt;if(34===ie.charCodeAt(ti)){for(;Zt++<It&&34!==ie.charCodeAt(Zt)||34===ie.charCodeAt(++Zt););return(ei=Zt)>=It?on=!0:10===(Ui=ie.charCodeAt(Zt++))?mn=!0:13===Ui&&(mn=!0,10===ie.charCodeAt(Zt)&&++Zt),ie.slice(ti+1,ei-1).replace(/""/g,'"')}for(;Zt<It;){if(10===(Ui=ie.charCodeAt(ei=Zt++)))mn=!0;else if(13===Ui)mn=!0,10===ie.charCodeAt(Zt)&&++Zt;else if(Ui!==i)continue;return ie.slice(ti,ei)}return on=!0,ie.slice(ti,It)}for(10===ie.charCodeAt(It-1)&&--It,13===ie.charCodeAt(It-1)&&--It;(Vr=Pn())!==nu;){for(var Hn=[];Vr!==zu&&Vr!==nu;)Hn.push(Vr),Vr=Pn();Re&&null==(Hn=Re(Hn,Tr++))||Je.push(Hn)}return Je}function v(ie,Re){return ie.map(function(Je){return Re.map(function(It){return se(Je[It])}).join(n)})}function N(ie){return ie.map(se).join(n)}function se(ie){return null==ie?"":ie instanceof Date?function(n){var l=n.getUTCHours(),i=n.getUTCMinutes(),u=n.getUTCSeconds(),f=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":function(n){return n<0?"-"+ns(-n,6):n>9999?"+"+ns(n,6):ns(n,4)}(n.getUTCFullYear())+"-"+ns(n.getUTCMonth()+1,2)+"-"+ns(n.getUTCDate(),2)+(f?"T"+ns(l,2)+":"+ns(i,2)+":"+ns(u,2)+"."+ns(f,3)+"Z":u?"T"+ns(l,2)+":"+ns(i,2)+":"+ns(u,2)+"Z":i||l?"T"+ns(l,2)+":"+ns(i,2)+"Z":"")}(ie):l.test(ie+="")?'"'+ie.replace(/"/g,'""')+'"':ie}return{parse:function(ie,Re){var Je,It,Zt=f(ie,function(Tr,Vr){if(Je)return Je(Tr,Vr-1);It=Tr,Je=Re?function(n,l){var i=ac(n);return function(u,f){return l(i(u),f,n)}}(Tr,Re):ac(Tr)});return Zt.columns=It||[],Zt},parseRows:f,format:function(ie,Re){return null==Re&&(Re=Zu(ie)),[Re.map(se).join(n)].concat(v(ie,Re)).join("\n")},formatBody:function(ie,Re){return null==Re&&(Re=Zu(ie)),v(ie,Re).join("\n")},formatRows:function(ie){return ie.map(N).join("\n")},formatRow:N,formatValue:se}}(",").parse,Ta=M(96109),lf=M(57452),Vl=M.n(lf);function ml(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function _u(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?ml(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):ml(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function wo(n,l){var i=l.x,u=l.y,f=l.x1,v=l.y1,b=l.coordinates,P=[];return n.forEach(function(I,N){var se=[];if(i&&u&&(se=[parseFloat(I[i]),parseFloat(I[u])]),i&&u&&f&&v&&(se=[[parseFloat(I[i]),parseFloat(I[u])],[parseFloat(I[f]),parseFloat(I[v])]]),b){var Je="Polygon";Array.isArray(b[0])||(Je="Point"),Array.isArray(b[0])&&!Array.isArray(b[0][0])&&(Je="LineString");var It={type:Je,coordinates:(0,Ta.Z)(I[b])};Vl()(It,!0),se=It.coordinates}var Zt=_u(_u({},I),{},{_id:N,coordinates:se});P.push(Zt)}),{dataArray:P}}var yl=M(70576);function Hs(n,l){!function(n,l){var i,u,f,v,b,P,I,N,se,ie,Re=0,Je="FeatureCollection"===n.type,It="Feature"===n.type,Zt=Je?n.features.length:1;for(i=0;i<Zt;i++){for(N=Je?n.features[i].properties:It?n.properties:{},se=Je?n.features[i].bbox:It?n.bbox:void 0,ie=Je?n.features[i].id:It?n.id:void 0,b=(I=!!(P=Je?n.features[i].geometry:It?n.geometry:n)&&"GeometryCollection"===P.type)?P.geometries.length:1,f=0;f<b;f++)if(null!==(v=I?P.geometries[f]:P))switch(v.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===l(v,Re,N,se,ie))return!1;break;case"GeometryCollection":for(u=0;u<v.geometries.length;u++)if(!1===l(v.geometries[u],Re,N,se,ie))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===l(null,Re,N,se,ie))return!1;Re++}}(n,function(i,u,f,v,b){var I,P=null===i?null:i.type;switch(P){case null:case"Point":case"LineString":case"Polygon":return!1!==l((0,yl.zL)(i,f,{bbox:v,id:b}),u,0)&&void 0}switch(P){case"MultiPoint":I="Point";break;case"MultiLineString":I="LineString";break;case"MultiPolygon":I="Polygon"}for(var N=0;N<i.coordinates.length;N++)if(!1===l((0,yl.zL)({type:I,coordinates:i.coordinates[N]},f),u,N))return!1})}function xu(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Bs(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?xu(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):xu(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var mo=M(33939),il=M.n(mo),ri=M(64871),An=M.n(ri),lc=M(55836),So=M.n(lc),Xs=M(37524),Po=M.n(Xs),fo=M(97185);function jl(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Gl(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?jl(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):jl(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Qi(n,l){var i=l.radius,u=void 0===i?40:i,f=l.maxZoom,v=void 0===f?18:f,b=l.minZoom,P=void 0===b?0:b,I=l.zoom;if(n.pointIndex){var se=n.pointIndex.getClusters(n.extent,Math.floor(void 0===I?2:I));return n.dataArray=function(n){return n.map(function(l,i){return Gl({coordinates:l.geometry.coordinates,_id:i+1},l.properties)})}(se),n}var ie=new(wt())({radius:u,minZoom:P,maxZoom:v}),Re={type:"FeatureCollection",features:[]};return Re.features=n.dataArray.map(function(Je){return{type:"Feature",geometry:{type:"Point",coordinates:Je.coordinates},properties:Gl({},Je)}}),ie.load(Re.features),ie}function bl(n){if(0===n.length)return 0;for(var u,l=n[0],i=0,f=1;f<n.length;f++)u=l+1*n[f],Math.abs(l)>=Math.abs(n[f])?i+=l-u+n[f]:i+=n[f]-u+l,l=u;return l+1*i}var is={min:function(n){if(0===n.length)throw new Error("min requires at least one data point");for(var l=n[0],i=1;i<n.length;i++)n[i]<l&&(l=n[i]);return l},max:function(n){if(0===n.length)throw new Error("max requires at least one data point");for(var l=n[0],i=1;i<n.length;i++)n[i]>l&&(l=n[i]);return l},mean:function(n){if(0===n.length)throw new Error("mean requires at least one data point");return bl(n)/n.length},sum:bl};function su(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Hl(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?su(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):su(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function Kc(n,l){if(Array.isArray(l))return l}var Sl=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(u,f){var v;return(0,X.Z)(this,i),v=l.call(this),(0,z.Z)((0,te.Z)(v),"data",void 0),(0,z.Z)((0,te.Z)(v),"extent",void 0),(0,z.Z)((0,te.Z)(v),"hooks",{init:new fo.ni}),(0,z.Z)((0,te.Z)(v),"parser",{type:"geojson"}),(0,z.Z)((0,te.Z)(v),"transforms",[]),(0,z.Z)((0,te.Z)(v),"cluster",!1),(0,z.Z)((0,te.Z)(v),"clusterOptions",{enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"}),(0,z.Z)((0,te.Z)(v),"mapService",void 0),(0,z.Z)((0,te.Z)(v),"invalidExtent",!1),(0,z.Z)((0,te.Z)(v),"originData",void 0),(0,z.Z)((0,te.Z)(v),"rawData",void 0),(0,z.Z)((0,te.Z)(v),"cfg",{}),(0,z.Z)((0,te.Z)(v),"clusterIndex",void 0),v.originData=u,v.initCfg(f),v.hooks.init.tap("parser",function(){v.excuteParser()}),v.hooks.init.tap("cluster",function(){v.initCluster()}),v.hooks.init.tap("transform",function(){v.executeTrans()}),v.init(),v}return(0,q.Z)(i,[{key:"setData",value:function(f,v){this.rawData=f,this.originData=f,this.initCfg(v),this.init(),this.emit("update")}},{key:"getClusters",value:function(f){return this.clusterIndex.getClusters(this.caculClusterExtent(2),f)}},{key:"getClustersLeaves",value:function(f){return this.clusterIndex.getLeaves(f,1/0)}},{key:"updateClusterData",value:function(f){var v=this,b=this.clusterOptions,P=b.method,I=void 0===P?"sum":P,N=b.field,se=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(f));this.clusterOptions.zoom=f,se.forEach(function(ie){ie.id||(ie.properties.point_count=1)}),(N||So()(I))&&(se=se.map(function(ie){var Re=ie.id;if(Re){var Zt,It=v.clusterIndex.getLeaves(Re,1/0).map(function(Vr){return Vr.properties});if(An()(I)&&N){var Tr=function(n,l){return n.map(function(i){return 1*i[l]})}(It,N);Zt=is[I](Tr)}So()(I)&&(Zt=I(It)),ie.properties.stat=Zt}else ie.properties.point_count=1;return ie})),this.data=ic("geojson")({type:"FeatureCollection",features:se}),this.executeTrans()}},{key:"getFeatureById",value:function(f){var v=this.parser.type;if("geojson"!==(void 0===v?"geojson":v)||this.cluster)return f<this.data.dataArray.length?this.data.dataArray[f]:"null";var P=f<this.originData.features.length?this.originData.features[f]:"null",I=Po()(P);if(0!==this.transforms.length){var N=this.data.dataArray.find(function(se){return se._id===f});I.properties=N}return I}},{key:"getFeatureId",value:function(f,v){var b=this.data.dataArray.find(function(P){return P[f]===name});return null==b?void 0:b._id}},{key:"destroy",value:function(){this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null}},{key:"caculClusterExtent",value:function(f){var v=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(v=(0,tt.yA)((0,tt.ds)(this.extent),f)),v[0].concat(v[1])}},{key:"initCfg",value:function(f){this.cfg=il()(this.cfg,f,Kc);var v=this.cfg;v&&(v.parser&&(this.parser=v.parser),v.transforms&&(this.transforms=v.transforms),this.cluster=v.cluster||!1,v.clusterOptions&&(this.cluster=!0,this.clusterOptions=Hl(Hl({},this.clusterOptions),v.clusterOptions)))}},{key:"excuteParser",value:function(){var f=this.parser,b=ic(f.type||"geojson");this.data=b(this.originData,f),this.extent=(0,tt.We)(this.data.dataArray),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3]}},{key:"executeTrans",value:function(){var f=this;this.transforms.forEach(function(b){var I=function(l){return vl[l]}(b.type)(f.data,b);Object.assign(f.data,I)})}},{key:"initCluster",value:function(){this.cluster&&(this.clusterIndex=Qi(this.data,this.clusterOptions||{}))}},{key:"init",value:function(){this.hooks.init.call(this)}}]),i}(Mt.EventEmitter);function Lc(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return ju(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ju(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,f=function(){};return{s:f,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(N){throw N},f}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var P,v=!0,b=!1;return{s:function(){i=i.call(n)},n:function(){var N=i.next();return v=N.done,N},e:function(N){b=!0,P=N},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(b)throw P}}}}function ju(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}var Xl=6378e3,a=Math.PI/3,s=[0,a,2*a,3*a,4*a,5*a];function o(n){return n[0]}function h(n){return n[1]}function S(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function C(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?S(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}function le(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Ee(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?le(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):le(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}M(88818);const We=Sl;Nu("geojson",function(n,l){var i=[],u={};return n.features=n.features.filter(function(v){var b=v.geometry;return null!=v&&b&&b.type&&b.coordinates&&b.coordinates.length>0}),Vl()(n,!0),0===n.features.length?{dataArray:[],featureKeys:u}:(Hs(n,function(v,b){var P=function(n){if(Array.isArray(n))return n;if("Feature"===n.type){if(null!==n.geometry)return n.geometry.coordinates}else if(n.coordinates)return n.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}(v),I=b,N=Bs(Bs({},v.properties),{},{coordinates:P,_id:I});i.push(N)}),{dataArray:i,featureKeys:u})}),Nu("image",function(n,l){var i=l.extent;return{images:new Promise(function(v){!function(n,l){var i=n,u=[];if("string"==typeof i)(0,tt.gJ)({url:i},function(b,P){u.push(P),l(u)});else{var f=i.length,v=0;i.forEach(function(b){(0,tt.gJ)({url:b},function(P,I){v++,u.push(I),v===f&&l(u)})})}}(n,function(b){v(b)})}),_id:1,dataArray:[{_id:0,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]}}),Nu("csv",function(n,l){return wo(Pu(n),l)}),Nu("json",wo),Nu("raster",function(n,l){var i=l.extent,u=l.width,f=l.height,v=l.min,b=l.max;return{_id:1,dataArray:[{_id:1,data:Array.from(n),width:u,height:f,min:v,max:b,coordinates:[[i[0],i[1]],[i[2],i[3]]]}]}}),Cu("cluster",Qi),Cu("filter",function(n,l){var i=l.callback;return i&&(n.dataArray=n.dataArray.filter(i)),n}),Cu("join",function(n,l){var i=l.sourceField,u=l.targetField,v={};return l.data.forEach(function(b){v[b[i]]=b}),n.dataArray=n.dataArray.map(function(b){var P=b[u];return Ee(Ee({},b),v[P])}),n}),Cu("map",function(n,l){var i=l.callback;return i&&(n.dataArray=n.dataArray.map(i)),n}),Cu("grid",function(n,l){var u=l.size,f=void 0===u?10:u,v=f/(2*Math.PI*Xl)*(256<<20)/2,b=function(n,l){var f,b,i=1/0,u=-1/0,v=Lc(n);try{for(v.s();!(b=v.n()).done;)f=b.value.coordinates[1],Number.isFinite(f)&&(i=f<i?f:i,u=f>u?f:u)}catch(mn){v.e(mn)}finally{v.f()}var N=function(n,l){return{yOffset:function(n){return n/Xl*(180/Math.PI)}(n),xOffset:function(n,l){return l/Xl*(180/Math.PI)/Math.cos(n*Math.PI/180)}(l,n)}}(l,(i+u)/2);if(N.xOffset<=0||N.yOffset<=0)return{gridHash:{},gridOffset:N};var Re,se={},ie=Lc(n);try{for(ie.s();!(Re=ie.n()).done;){var Je=Re.value,It=Je.coordinates[1],Zt=Je.coordinates[0];if(Number.isFinite(It)&&Number.isFinite(Zt)){var Tr=Math.floor((It+90)/N.yOffset),Vr=Math.floor((Zt+180)/N.xOffset),on="".concat(Tr,"-").concat(Vr);se[on]=se[on]||{count:0,points:[]},se[on].count+=1,se[on].points.push(Je)}}}catch(mn){ie.e(mn)}finally{ie.f()}return{gridHash:se,gridOffset:N}}(n.dataArray,f);return{yOffset:v,xOffset:v,radius:v,type:"grid",dataArray:function(n,l,i){return Object.keys(n).reduce(function(u,f,v){var b=f.split("-"),P=parseInt(b[0],10),I=parseInt(b[1],10),N={};if(i.field&&i.method){var se=tt.a5.getColumn(n[f].points,i.field);N[i.method]=tt.a5.statMap[i.method](se)}return Object.assign(N,{_id:v,coordinates:(0,tt.Z)([l.xOffset*(I+.5)-180,l.yOffset*(P+.5)-90]),rawData:n[f].points,count:n[f].count}),u.push(N),u},[])}(b.gridHash,b.gridOffset,l)}}),Cu("hexagon",function(n,l){var u=l.size,v=l.method,b=void 0===v?"sum":v,P=(void 0===u?10:u)/(2*Math.PI*6378e3)*(256<<20)/2,I=n.dataArray.map(function(Re){var Je=(0,tt.Z)(Re.coordinates),It=(0,ra.Z)(Je,2),Zt=It[0],Tr=It[1];return C(C({},Re),{},{coordinates:[Zt,Tr]})});return{dataArray:function(){var b,P,I,n=0,l=0,i=1,u=1,f=o,v=h;function N(ie){var It,Re={},Je=[],Zt=ie.length;for(It=0;It<Zt;++It)if(!isNaN(Vr=+f.call(null,Tr=ie[It],It,ie))&&!isNaN(on=+v.call(null,Tr,It,ie))){var Tr,Vr,on,mn=Math.round(on/=I),Pn=Math.round(Vr=Vr/P-(1&mn)/2),Hn=on-mn;if(3*Math.abs(Hn)>1){var ei=Vr-Pn,ti=Pn+(Vr<Pn?-1:1)/2,Ui=mn+(on<mn?-1:1),Sa=Vr-ti,Ua=on-Ui;ei*ei+Hn*Hn>Sa*Sa+Ua*Ua&&(Pn=ti+(1&mn?1:-1)/2,mn=Ui)}var Ii=Pn+"-"+mn,Va=Re[Ii];Va?Va.push(Tr):(Je.push(Va=Re[Ii]=[Tr]),Va.x=(Pn+(1&mn)/2)*P,Va.y=mn*I)}return Je}function se(ie){var Re=0,Je=0;return s.map(function(It){var Zt=Math.sin(It)*ie,Tr=-Math.cos(It)*ie,Vr=Zt-Re,on=Tr-Je;return Re=Zt,Je=Tr,[Vr,on]})}return N.hexagon=function(ie){return"m"+se(null==ie?b:+ie).join("l")+"z"},N.centers=function(){for(var ie=[],Re=Math.round(l/I),Je=Math.round(n/P),It=Re*I;It<u+b;It+=I,++Re)for(var Zt=Je*P+(1&Re)*P/2;Zt<i+P/2;Zt+=P)ie.push([Zt,It]);return ie},N.mesh=function(){var ie=se(b).slice(0,4).join("l");return N.centers().map(function(Re){return"M"+Re+"m"+ie}).join("")},N.x=function(ie){return arguments.length?(f=ie,N):f},N.y=function(ie){return arguments.length?(v=ie,N):v},N.radius=function(ie){return arguments.length?(P=2*(b=+ie)*Math.sin(a),I=1.5*b,N):b},N.size=function(ie){return arguments.length?(n=l=0,i=+ie[0],u=+ie[1],N):[i-n,u-l]},N.extent=function(ie){return arguments.length?(n=+ie[0][0],l=+ie[0][1],i=+ie[1][0],u=+ie[1][1],N):[[n,l],[i,u]]},N.radius(1)}().radius(P).x(function(Re){return Re.coordinates[0]}).y(function(Re){return Re.coordinates[1]})(I).map(function(Re,Je){var It;if(l.field&&b){var Zt=tt.a5.getColumn(Re,l.field);Re[b]=tt.a5.statMap[b](Zt)}return(0,z.Z)(It={},l.method,Re[b]),(0,z.Z)(It,"count",Re.length),(0,z.Z)(It,"rawData",Re),(0,z.Z)(It,"coordinates",[Re.x,Re.y]),(0,z.Z)(It,"_id",Je),It}),radius:P,xOffset:P,yOffset:P,type:"hexagon"}});var xt,zt,or,Jt,yr,Rr,$r,Xr,pn,qn,Un,Rn,ki,kn,st=M(35296),je=M.n(st),at=function(){function n(l,i){(0,X.Z)(this,n),(0,z.Z)(this,"attribute",void 0),(0,z.Z)(this,"buffer",void 0);var u=i.buffer,f=i.offset,v=i.stride,b=i.normalized,P=i.size,I=i.divisor;this.buffer=u,this.attribute={buffer:u.get(),offset:f||0,stride:v||0,normalized:b||!1,divisor:I||0},P&&(this.attribute.size=P)}return(0,q.Z)(n,[{key:"get",value:function(){return this.attribute}},{key:"updateBuffer",value:function(i){this.buffer.subData(i)}},{key:"destroy",value:function(){this.buffer.destroy()}}]),n}(),gi=((0,z.Z)(xt={},Z.gl.POINTS,"points"),(0,z.Z)(xt,Z.gl.LINES,"lines"),(0,z.Z)(xt,Z.gl.LINE_LOOP,"line loop"),(0,z.Z)(xt,Z.gl.LINE_STRIP,"line strip"),(0,z.Z)(xt,Z.gl.TRIANGLES,"triangles"),(0,z.Z)(xt,Z.gl.TRIANGLE_FAN,"triangle fan"),(0,z.Z)(xt,Z.gl.TRIANGLE_STRIP,"triangle strip"),xt),Vi=((0,z.Z)(zt={},Z.gl.STATIC_DRAW,"static"),(0,z.Z)(zt,Z.gl.DYNAMIC_DRAW,"dynamic"),(0,z.Z)(zt,Z.gl.STREAM_DRAW,"stream"),zt),li=((0,z.Z)(or={},Z.gl.BYTE,"int8"),(0,z.Z)(or,Z.gl.UNSIGNED_INT,"int16"),(0,z.Z)(or,Z.gl.INT,"int32"),(0,z.Z)(or,Z.gl.UNSIGNED_BYTE,"uint8"),(0,z.Z)(or,Z.gl.UNSIGNED_SHORT,"uint16"),(0,z.Z)(or,Z.gl.UNSIGNED_INT,"uint32"),(0,z.Z)(or,Z.gl.FLOAT,"float"),or),yi=((0,z.Z)(Jt={},Z.gl.ALPHA,"alpha"),(0,z.Z)(Jt,Z.gl.LUMINANCE,"luminance"),(0,z.Z)(Jt,Z.gl.LUMINANCE_ALPHA,"luminance alpha"),(0,z.Z)(Jt,Z.gl.RGB,"rgb"),(0,z.Z)(Jt,Z.gl.RGBA,"rgba"),(0,z.Z)(Jt,Z.gl.RGBA4,"rgba4"),(0,z.Z)(Jt,Z.gl.RGB5_A1,"rgb5 a1"),(0,z.Z)(Jt,Z.gl.RGB565,"rgb565"),(0,z.Z)(Jt,Z.gl.DEPTH_COMPONENT,"depth"),(0,z.Z)(Jt,Z.gl.DEPTH_STENCIL,"depth stencil"),Jt),Ni=((0,z.Z)(yr={},Z.gl.DONT_CARE,"dont care"),(0,z.Z)(yr,Z.gl.NICEST,"nice"),(0,z.Z)(yr,Z.gl.FASTEST,"fast"),yr),$=((0,z.Z)(Rr={},Z.gl.NEAREST,"nearest"),(0,z.Z)(Rr,Z.gl.LINEAR,"linear"),(0,z.Z)(Rr,Z.gl.LINEAR_MIPMAP_LINEAR,"mipmap"),(0,z.Z)(Rr,Z.gl.NEAREST_MIPMAP_LINEAR,"nearest mipmap linear"),(0,z.Z)(Rr,Z.gl.LINEAR_MIPMAP_NEAREST,"linear mipmap nearest"),(0,z.Z)(Rr,Z.gl.NEAREST_MIPMAP_NEAREST,"nearest mipmap nearest"),Rr),ee=((0,z.Z)($r={},Z.gl.REPEAT,"repeat"),(0,z.Z)($r,Z.gl.CLAMP_TO_EDGE,"clamp"),(0,z.Z)($r,Z.gl.MIRRORED_REPEAT,"mirror"),$r),L=((0,z.Z)(Xr={},Z.gl.NONE,"none"),(0,z.Z)(Xr,Z.gl.BROWSER_DEFAULT_WEBGL,"browser"),Xr),D=((0,z.Z)(pn={},Z.gl.NEVER,"never"),(0,z.Z)(pn,Z.gl.ALWAYS,"always"),(0,z.Z)(pn,Z.gl.LESS,"less"),(0,z.Z)(pn,Z.gl.LEQUAL,"lequal"),(0,z.Z)(pn,Z.gl.GREATER,"greater"),(0,z.Z)(pn,Z.gl.GEQUAL,"gequal"),(0,z.Z)(pn,Z.gl.EQUAL,"equal"),(0,z.Z)(pn,Z.gl.NOTEQUAL,"notequal"),pn),fe=((0,z.Z)(qn={},Z.gl.FUNC_ADD,"add"),(0,z.Z)(qn,Z.gl.MIN_EXT,"min"),(0,z.Z)(qn,Z.gl.MAX_EXT,"max"),(0,z.Z)(qn,Z.gl.FUNC_SUBTRACT,"subtract"),(0,z.Z)(qn,Z.gl.FUNC_REVERSE_SUBTRACT,"reverse subtract"),qn),Se=((0,z.Z)(Un={},Z.gl.ZERO,"zero"),(0,z.Z)(Un,Z.gl.ONE,"one"),(0,z.Z)(Un,Z.gl.SRC_COLOR,"src color"),(0,z.Z)(Un,Z.gl.ONE_MINUS_SRC_COLOR,"one minus src color"),(0,z.Z)(Un,Z.gl.SRC_ALPHA,"src alpha"),(0,z.Z)(Un,Z.gl.ONE_MINUS_SRC_ALPHA,"one minus src alpha"),(0,z.Z)(Un,Z.gl.DST_COLOR,"dst color"),(0,z.Z)(Un,Z.gl.ONE_MINUS_DST_COLOR,"one minus dst color"),(0,z.Z)(Un,Z.gl.DST_ALPHA,"dst alpha"),(0,z.Z)(Un,Z.gl.ONE_MINUS_DST_ALPHA,"one minus dst alpha"),(0,z.Z)(Un,Z.gl.CONSTANT_COLOR,"constant color"),(0,z.Z)(Un,Z.gl.ONE_MINUS_CONSTANT_COLOR,"one minus constant color"),(0,z.Z)(Un,Z.gl.CONSTANT_ALPHA,"constant alpha"),(0,z.Z)(Un,Z.gl.ONE_MINUS_CONSTANT_ALPHA,"one minus constant alpha"),(0,z.Z)(Un,Z.gl.SRC_ALPHA_SATURATE,"src alpha saturate"),Un),ct=((0,z.Z)(Rn={},Z.gl.NEVER,"never"),(0,z.Z)(Rn,Z.gl.ALWAYS,"always"),(0,z.Z)(Rn,Z.gl.LESS,"less"),(0,z.Z)(Rn,Z.gl.LEQUAL,"lequal"),(0,z.Z)(Rn,Z.gl.GREATER,"greater"),(0,z.Z)(Rn,Z.gl.GEQUAL,"gequal"),(0,z.Z)(Rn,Z.gl.EQUAL,"equal"),(0,z.Z)(Rn,Z.gl.NOTEQUAL,"notequal"),Rn),Pt=((0,z.Z)(ki={},Z.gl.ZERO,"zero"),(0,z.Z)(ki,Z.gl.KEEP,"keep"),(0,z.Z)(ki,Z.gl.REPLACE,"replace"),(0,z.Z)(ki,Z.gl.INVERT,"invert"),(0,z.Z)(ki,Z.gl.INCR,"increment"),(0,z.Z)(ki,Z.gl.DECR,"decrement"),(0,z.Z)(ki,Z.gl.INCR_WRAP,"increment wrap"),(0,z.Z)(ki,Z.gl.DECR_WRAP,"decrement wrap"),ki),bt=((0,z.Z)(kn={},Z.gl.FRONT,"front"),(0,z.Z)(kn,Z.gl.BACK,"back"),kn),rr=function(){function n(l,i){(0,X.Z)(this,n),(0,z.Z)(this,"buffer",void 0),this.buffer=l.buffer({data:i.data,usage:Vi[i.usage||Z.gl.STATIC_DRAW],type:li[i.type||Z.gl.UNSIGNED_BYTE]})}return(0,q.Z)(n,[{key:"get",value:function(){return this.buffer}},{key:"destroy",value:function(){this.buffer.destroy()}},{key:"subData",value:function(i){this.buffer.subdata(i.data,i.offset)}}]),n}(),jr=function(){function n(l,i){(0,X.Z)(this,n),(0,z.Z)(this,"elements",void 0),this.elements=l.elements({data:i.data,usage:Vi[i.usage||Z.gl.STATIC_DRAW],type:li[i.type||Z.gl.UNSIGNED_BYTE],count:i.count})}return(0,q.Z)(n,[{key:"get",value:function(){return this.elements}},{key:"subData",value:function(i){this.elements.subdata(i.data)}},{key:"destroy",value:function(){}}]),n}(),Mn=function(){function n(l,i){(0,X.Z)(this,n),(0,z.Z)(this,"framebuffer",void 0);var v=i.color,b=i.colors,N={width:i.width,height:i.height};Array.isArray(b)&&(N.colors=b.map(function(se){return se.get()})),v&&"boolean"!=typeof v&&(N.color=v.get()),this.framebuffer=l.framebuffer(N)}return(0,q.Z)(n,[{key:"get",value:function(){return this.framebuffer}},{key:"destroy",value:function(){this.framebuffer.destroy()}},{key:"resize",value:function(i){this.framebuffer.resize(i.width,i.height)}}]),n}(),Xn=M(85464),ni=M(47679),Ci=M.n(ni),wi=M(82358),ea=M.n(wi);function xa(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function ua(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?xa(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):xa(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var ia,Ha=function(){function n(l,i){(0,X.Z)(this,n),(0,z.Z)(this,"reGl",void 0),(0,z.Z)(this,"destroyed",!1),(0,z.Z)(this,"drawCommand",void 0),(0,z.Z)(this,"drawParams",void 0),(0,z.Z)(this,"options",void 0),(0,z.Z)(this,"uniforms",{}),this.reGl=l;var u=i.vs,f=i.fs,v=i.attributes,b=i.uniforms,P=i.primitive,I=i.count,N=i.elements,se=i.depth,ie=i.blend,Re=i.stencil,Je=i.cull,It=i.instances,Zt={};this.options=i,b&&(this.uniforms=this.extractUniforms(b),Object.keys(b).forEach(function(on){Zt[on]=l.prop(on)}));var Tr={};Object.keys(v).forEach(function(on){Tr[on]=v[on].get()});var Vr={attributes:Tr,frag:f,uniforms:Zt,vert:u,primitive:gi[void 0===P?Z.gl.TRIANGLES:P]};It&&(Vr.instances=It),I&&(Vr.count=I),N&&(Vr.elements=N.get()),this.initDepthDrawParams({depth:se},Vr),this.initBlendDrawParams({blend:ie},Vr),this.initStencilDrawParams({stencil:Re},Vr),this.initCullDrawParams({cull:Je},Vr),this.drawCommand=l(Vr),this.drawParams=Vr}return(0,q.Z)(n,[{key:"addUniforms",value:function(i){this.uniforms=ua(ua({},this.uniforms),this.extractUniforms(i))}},{key:"draw",value:function(i){if(!this.drawParams.attributes||0!==Object.keys(this.drawParams.attributes).length){var u=ua(ua({},this.uniforms),this.extractUniforms(i.uniforms||{})),f={};Object.keys(u).forEach(function(v){var b=(0,Xn.Z)(u[v]);f[v]="boolean"===b||"number"===b||Array.isArray(u[v])||u[v].BYTES_PER_ELEMENT?u[v]:u[v].get()}),this.drawCommand(f)}}},{key:"destroy",value:function(){this.drawParams.elements.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(function(i){i.destroy()}),this.destroyed=!0}},{key:"initDepthDrawParams",value:function(i,u){var f=i.depth;f&&(u.depth={enable:void 0===f.enable||!!f.enable,mask:void 0===f.mask||!!f.mask,func:D[f.func||Z.gl.LESS],range:f.range||[0,1]})}},{key:"initBlendDrawParams",value:function(i,u){var f=i.blend;if(f){var b=f.func,P=f.equation,I=f.color;u.blend={enable:!!f.enable,func:{srcRGB:Se[b&&b.srcRGB||Z.gl.SRC_ALPHA],srcAlpha:Se[b&&b.srcAlpha||Z.gl.SRC_ALPHA],dstRGB:Se[b&&b.dstRGB||Z.gl.ONE_MINUS_SRC_ALPHA],dstAlpha:Se[b&&b.dstAlpha||Z.gl.ONE_MINUS_SRC_ALPHA]},equation:{rgb:fe[P&&P.rgb||Z.gl.FUNC_ADD],alpha:fe[P&&P.alpha||Z.gl.FUNC_ADD]},color:void 0===I?[0,0,0,0]:I}}}},{key:"initStencilDrawParams",value:function(i,u){var f=i.stencil;if(f){var b=f.mask,I=f.func,N=void 0===I?{cmp:Z.gl.ALWAYS,ref:0,mask:-1}:I,se=f.opFront,ie=void 0===se?{fail:Z.gl.KEEP,zfail:Z.gl.KEEP,zpass:Z.gl.KEEP}:se,Re=f.opBack,Je=void 0===Re?{fail:Z.gl.KEEP,zfail:Z.gl.KEEP,zpass:Z.gl.KEEP}:Re;u.stencil={enable:!!f.enable,mask:void 0===b?-1:b,func:ua(ua({},N),{},{cmp:ct[N.cmp]}),opFront:{fail:Pt[ie.fail],zfail:Pt[ie.zfail],zpass:Pt[ie.zpass]},opBack:{fail:Pt[Je.fail],zfail:Pt[Je.zfail],zpass:Pt[Je.zpass]}}}}},{key:"initCullDrawParams",value:function(i,u){var f=i.cull;if(f){var b=f.face;u.cull={enable:!!f.enable,face:bt[void 0===b?Z.gl.BACK:b]}}}},{key:"extractUniforms",value:function(i){var u=this,f={};return Object.keys(i).forEach(function(v){u.extractUniformsRecursively(v,i[v],f,"")}),f}},{key:"extractUniformsRecursively",value:function(i,u,f,v){var b=this;null===u||"number"==typeof u||"boolean"==typeof u||Array.isArray(u)&&"number"==typeof u[0]||Ci()(u)||""===u||"resize"in u?f["".concat(v&&v+".").concat(i)]=u:(ea()(u)&&Object.keys(u).forEach(function(P){b.extractUniformsRecursively(P,u[P],f,"".concat(v&&v+".").concat(i))}),Array.isArray(u)&&u.forEach(function(P,I){Object.keys(P).forEach(function(N){b.extractUniformsRecursively(N,P[N],f,"".concat(v&&v+".").concat(i,"[").concat(I,"]"))})}))}}]),n}(),Wa=function(){function n(l,i){(0,X.Z)(this,n),(0,z.Z)(this,"texture",void 0),(0,z.Z)(this,"width",void 0),(0,z.Z)(this,"height",void 0);var u=i.data,f=i.type,v=void 0===f?Z.gl.UNSIGNED_BYTE:f,b=i.width,P=i.height,I=i.flipY,N=void 0!==I&&I,se=i.format,ie=void 0===se?Z.gl.RGBA:se,Re=i.mipmap,Je=void 0!==Re&&Re,It=i.wrapS,Zt=void 0===It?Z.gl.CLAMP_TO_EDGE:It,Tr=i.wrapT,Vr=void 0===Tr?Z.gl.CLAMP_TO_EDGE:Tr,on=i.aniso,mn=void 0===on?0:on,Pn=i.alignment,Hn=void 0===Pn?1:Pn,ei=i.premultiplyAlpha,ti=void 0!==ei&&ei,Ui=i.mag,Sa=void 0===Ui?Z.gl.NEAREST:Ui,Ua=i.min,Ii=void 0===Ua?Z.gl.NEAREST:Ua,Va=i.colorSpace,po=void 0===Va?Z.gl.BROWSER_DEFAULT_WEBGL:Va;this.width=b,this.height=P;var Ru={width:b,height:P,type:li[v],format:yi[ie],wrapS:ee[Zt],wrapT:ee[Vr],mag:$[Sa],min:$[Ii],alignment:Hn,flipY:N,colorSpace:L[po],premultiplyAlpha:ti,aniso:mn};u&&(Ru.data=u),"number"==typeof Je?Ru.mipmap=Ni[Je]:"boolean"==typeof Je&&(Ru.mipmap=Je),this.texture=l.texture(Ru)}return(0,q.Z)(n,[{key:"get",value:function(){return this.texture}},{key:"update",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.texture(i)}},{key:"bind",value:function(){this.texture._texture.bind()}},{key:"resize",value:function(i){var u=i.width,f=i.height;this.texture.resize(u,f),this.width=u,this.height=f}},{key:"destroy",value:function(){this.texture.destroy()}}]),n}(),ga=(0,va.b2)()(ia=function(){function n(){var l=this;(0,X.Z)(this,n),(0,z.Z)(this,"extensionObject",void 0),(0,z.Z)(this,"gl",void 0),(0,z.Z)(this,"$container",void 0),(0,z.Z)(this,"canvas",void 0),(0,z.Z)(this,"width",void 0),(0,z.Z)(this,"height",void 0),(0,z.Z)(this,"isDirty",void 0),(0,z.Z)(this,"createModel",function(i){return new Ha(l.gl,i)}),(0,z.Z)(this,"createAttribute",function(i){return new at(l.gl,i)}),(0,z.Z)(this,"createBuffer",function(i){return new rr(l.gl,i)}),(0,z.Z)(this,"createElements",function(i){return new jr(l.gl,i)}),(0,z.Z)(this,"createTexture2D",function(i){return new Wa(l.gl,i)}),(0,z.Z)(this,"createFramebuffer",function(i){return new Mn(l.gl,i)}),(0,z.Z)(this,"useFramebuffer",function(i,u){l.gl({framebuffer:i?i.get():null})(u)}),(0,z.Z)(this,"clear",function(i){var b=i.framebuffer,P=void 0===b?null:b,I={color:i.color,depth:i.depth,stencil:i.stencil};I.framebuffer=null===P?P:P.get(),l.gl.clear(I)}),(0,z.Z)(this,"viewport",function(i){var v=i.width,b=i.height;l.gl._gl.viewport(i.x,i.y,v,b),l.width=v,l.height=b,l.gl._refresh()}),(0,z.Z)(this,"readPixels",function(i){var u=i.framebuffer,I={x:i.x,y:i.y,width:i.width,height:i.height};return u&&(I.framebuffer=u.get()),l.gl.read(I)}),(0,z.Z)(this,"getViewportSize",function(){return{width:l.gl._gl.drawingBufferWidth,height:l.gl._gl.drawingBufferHeight}}),(0,z.Z)(this,"getContainer",function(){var i;return null===(i=l.canvas)||void 0===i?void 0:i.parentElement}),(0,z.Z)(this,"getCanvas",function(){return l.canvas}),(0,z.Z)(this,"getGLContext",function(){return l.gl._gl}),(0,z.Z)(this,"destroy",function(){l.gl.destroy()})}return(0,q.Z)(n,[{key:"init",value:(l=(0,Xt.Z)(_r().mark(function u(f,v){var b=this;return _r().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return this.canvas=f,I.next=3,new Promise(function(N,se){je()({canvas:b.canvas,attributes:{alpha:!0,antialias:v.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:v.preserveDrawingBuffer},extensions:["OES_element_index_uint","OES_standard_derivatives","angle_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture"],profile:!0,onDone:function(Re,Je){(Re||!Je)&&se(Re),N(Je)}})});case 3:this.gl=I.sent,this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")};case 5:case"end":return I.stop()}},u,this)})),function(u,f){return l.apply(this,arguments)})},{key:"testExtension",value:function(i){return!!this.getGLContext().getExtension(i)}},{key:"setBaseState",value:function(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}},{key:"setCustomLayerDefaults",value:function(){var i=this.getGLContext();i.disable(i.CULL_FACE)}},{key:"setDirty",value:function(i){this.isDirty=i}},{key:"getDirty",value:function(){return this.isDirty}}]),n;var l}())||ia;function la(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function no(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?la(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):la(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var go,Yl,uu,Ko,wu,Ys,Cf,Xf,ll,qc,$h,Li=function(){function n(l){(0,X.Z)(this,n),(0,z.Z)(this,"sceneService",void 0),(0,z.Z)(this,"mapService",void 0),(0,z.Z)(this,"controlService",void 0),(0,z.Z)(this,"layerService",void 0),(0,z.Z)(this,"iconService",void 0),(0,z.Z)(this,"markerService",void 0),(0,z.Z)(this,"popupService",void 0),(0,z.Z)(this,"fontService",void 0),(0,z.Z)(this,"interactionService",void 0),(0,z.Z)(this,"container",void 0);var i=l.id,u=l.map,f=(0,Z.Hp)();this.container=f,u.setContainer(f,i),f.bind(Z.vK.IRendererService).to(ga).inSingletonScope(),this.sceneService=f.get(Z.vK.ISceneService),this.mapService=f.get(Z.vK.IMapService),this.iconService=f.get(Z.vK.IIconService),this.fontService=f.get(Z.vK.IFontService),this.controlService=f.get(Z.vK.IControlService),this.layerService=f.get(Z.vK.ILayerService),this.markerService=f.get(Z.vK.IMarkerService),this.interactionService=f.get(Z.vK.IInteractionService),this.popupService=f.get(Z.vK.IPopupService),this.initComponent(i),this.sceneService.init(l),this.initControl()}return(0,q.Z)(n,[{key:"getServiceContainer",value:function(){return this.container}},{key:"getSize",value:function(){return this.mapService.getSize()}},{key:"getMinZoom",value:function(){return this.mapService.getMinZoom()}},{key:"getMaxZoom",value:function(){return this.mapService.getMaxZoom()}},{key:"getType",value:function(){return this.mapService.getType()}},{key:"getMapContainer",value:function(){return this.mapService.getMapContainer()}},{key:"getMapCanvasContainer",value:function(){return this.mapService.getMapCanvasContainer()}},{key:"getMapService",value:function(){return this.mapService}},{key:"exportPng",value:function(i){return this.sceneService.exportPng(i)}},{key:"exportMap",value:function(i){return this.sceneService.exportPng(i)}},{key:"registerRenderService",value:function(i){var u=this;this.sceneService.loaded?new i(this).init():this.on("loaded",function(){new i(u).init()})}},{key:"map",get:function(){return this.mapService.map}},{key:"setBgColor",value:function(i){this.mapService.setBgColor(i)}},{key:"addLayer",value:function(i){var u=(0,Z.e7)(this.container);i.setContainer(u),this.sceneService.addLayer(i)}},{key:"getLayers",value:function(){return this.layerService.getLayers()}},{key:"getLayer",value:function(i){return this.layerService.getLayer(i)}},{key:"getLayerByName",value:function(i){return this.layerService.getLayerByName(i)}},{key:"removeLayer",value:function(i){this.layerService.remove(i)}},{key:"removeAllLayer",value:function(){this.layerService.removeAllLayers()}},{key:"render",value:function(){this.sceneService.render()}},{key:"addIconFont",value:function(i,u){this.fontService.addIconFont(i,u)}},{key:"addIconFonts",value:function(i){var u=this;i.forEach(function(f){var v=(0,ra.Z)(f,2);u.fontService.addIconFont(v[0],v[1])})}},{key:"addFontFace",value:function(i,u){this.sceneService.addFontFace(i,u)}},{key:"addImage",value:function(i,u){this.iconService.addImage(i,u)}},{key:"hasImage",value:function(i){return this.iconService.hasImage(i)}},{key:"removeImage",value:function(i){this.iconService.removeImage(i)}},{key:"addIconFontGlyphs",value:function(i,u){this.fontService.addIconGlyphs(u)}},{key:"addControl",value:function(i){this.controlService.addControl(i,this.container)}},{key:"removeControl",value:function(i){this.controlService.removeControl(i)}},{key:"getControlByName",value:function(i){return this.controlService.getControlByName(i)}},{key:"addMarker",value:function(i){this.markerService.addMarker(i)}},{key:"addMarkerLayer",value:function(i){this.markerService.addMarkerLayer(i)}},{key:"removeMarkerLayer",value:function(i){this.markerService.removeMarkerLayer(i)}},{key:"removeAllMakers",value:function(){this.markerService.removeAllMarkers()}},{key:"addPopup",value:function(i){this.popupService.addPopup(i)}},{key:"on",value:function(i,u){-1===Z.SceneEventList.indexOf(i)?this.mapService.on(i,u):this.sceneService.on(i,u)}},{key:"once",value:function(i,u){-1===Z.SceneEventList.indexOf(i)?this.mapService.once(i,u):this.sceneService.once(i,u)}},{key:"off",value:function(i,u){-1===Z.SceneEventList.indexOf(i)?this.mapService.off(i,u):this.sceneService.off(i,u)}},{key:"getZoom",value:function(){return this.mapService.getZoom()}},{key:"getCenter",value:function(i){return this.mapService.getCenter(i)}},{key:"setCenter",value:function(i,u){return this.mapService.setCenter(i,u)}},{key:"getPitch",value:function(){return this.mapService.getPitch()}},{key:"setPitch",value:function(i){return this.mapService.setPitch(i)}},{key:"getRotation",value:function(){return this.mapService.getRotation()}},{key:"getBounds",value:function(){return this.mapService.getBounds()}},{key:"setRotation",value:function(i){this.mapService.setRotation(i)}},{key:"zoomIn",value:function(){this.mapService.zoomIn()}},{key:"zoomOut",value:function(){this.mapService.zoomOut()}},{key:"panTo",value:function(i){this.mapService.panTo(i)}},{key:"panBy",value:function(i,u){this.mapService.panBy(i,u)}},{key:"getContainer",value:function(){return this.mapService.getContainer()}},{key:"setZoom",value:function(i){this.mapService.setZoom(i)}},{key:"fitBounds",value:function(i,u){var f=this.sceneService.getSceneConfig(),b=f.animate;this.mapService.fitBounds(i,u||no(no({},f.fitBoundsOptions),{},{animate:b}))}},{key:"setZoomAndCenter",value:function(i,u){this.mapService.setZoomAndCenter(i,u)}},{key:"setMapStyle",value:function(i){this.mapService.setMapStyle(i)}},{key:"setMapStatus",value:function(i){this.mapService.setMapStatus(i)}},{key:"pixelToLngLat",value:function(i){return this.mapService.pixelToLngLat(i)}},{key:"lngLatToPixel",value:function(i){return this.mapService.lngLatToPixel(i)}},{key:"containerToLngLat",value:function(i){return this.mapService.containerToLngLat(i)}},{key:"lngLatToContainer",value:function(i){return this.mapService.lngLatToContainer(i)}},{key:"destroy",value:function(){this.sceneService.destroy()}},{key:"registerPostProcessingPass",value:function(i,u){this.container.bind(Z.vK.IPostProcessingPass).to(i).whenTargetNamed(u)}},{key:"initComponent",value:function(i){this.controlService.init({container:tt.SO.getContainer(i)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}},{key:"initControl",value:function(){var i=this.sceneService.getSceneConfig();i.logoVisible&&this.addControl(new Dt({position:i.logoPosition}))}}]),n}(),Ca=M(53867),ba=M.n(Ca),ul=(go=(0,va.b2)(),Yl=(0,va.f3)(Z.vK.IGlobalConfigService),go((Ko=function(){function n(){(0,X.Z)(this,n),(0,G.Z)(this,"configService",wu,this),(0,z.Z)(this,"enabled",void 0)}return(0,q.Z)(n,[{key:"apply",value:function(i,u){var f=this,b=u.postProcessingPassFactory,P=u.normalPassFactory;i.hooks.init.tap("MultiPassRendererPlugin",function(){var I=i.getLayerConfig(),se=I.passes,ie=void 0===se?[]:se;f.enabled=!!I.enableMultiPassRenderer&&!1!==i.getLayerConfig().enableMultiPassRenderer,f.enabled&&(i.multiPassRenderer=f.createMultiPassRenderer(i,ie,b,P),i.multiPassRenderer.setRenderFlag(!0))}),i.hooks.beforeRender.tap("MultiPassRendererPlugin",function(){})}},{key:"createMultiPassRenderer",value:function(i,u,f,v){var b=i.multiPassRenderer;return i.getLayerConfig().enablePicking&&b.add(v("pixelPicking")),b}}]),n}(),wu=(0,Ve.Z)(Ko.prototype,"configService",[Yl],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu=Ko))||uu),Kl=((0,z.Z)(Ys={},Z.BlendType.additive,{enable:!0,func:{srcRGB:Z.gl.ONE,dstRGB:Z.gl.ONE,srcAlpha:1,dstAlpha:1}}),(0,z.Z)(Ys,Z.BlendType.none,{enable:!1}),(0,z.Z)(Ys,Z.BlendType.normal,{enable:!0,func:{srcRGB:Z.gl.SRC_ALPHA,dstRGB:Z.gl.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}}),(0,z.Z)(Ys,Z.BlendType.subtractive,{enable:!0,func:{srcRGB:Z.gl.ONE,dstRGB:Z.gl.ONE,srcAlpha:Z.gl.ZERO,dstAlpha:Z.gl.ONE_MINUS_SRC_COLOR},equation:{rgb:Z.gl.FUNC_SUBTRACT,alpha:Z.gl.FUNC_SUBTRACT}}),(0,z.Z)(Ys,Z.BlendType.max,{enable:!0,func:{srcRGB:Z.gl.ONE,dstRGB:Z.gl.ONE},equation:{rgb:Z.gl.MAX_EXT}}),(0,z.Z)(Ys,Z.BlendType.min,{enable:!0,func:{srcRGB:Z.gl.ONE,dstRGB:Z.gl.ONE},equation:{rgb:Z.gl.MIN_EXT}}),Ys),Wu=M(80167),ca=M.n(Wu),Hf=M(81690),Tl=M.n(Hf);function Ks(n,l,i,u,f){l.updateStyleAttribute(n,i,u,f)}function Dc(n,l,i){An()(i)?Ks(n,l,i,function(u){return u}):ca()(i)?Ks(n,l,[i],void 0):Tl()(i)&&2===i.length&&(An()(i[0])&&So()(i[1])||An()(i[0])&&Tl()(i[1])&&ca()(i[1][0])&&ca()(i[1][1]))?Ks(n,l,i[0],i[1]):Ks(n,l,[1],void 0)}function hc(n,l,i){An()(i)?Ks(n,l,i,function(u){return u}):Tl()(i)&&2===i.length&&An()(i[0])&&So()(i[1])?Ks(n,l,i[0],i[1]):Tl()(i)&&2===i.length&&ca()(i[0])&&ca()(i[1])?Ks(n,l,i,void 0):Ks(n,l,[0,0],void 0)}function Qh(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}function ep(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function qs(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?ep(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):ep(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Sh,Af,$c,Bc,pf,tp=0,Jc=(Cf=(0,Z.yT)(Z.vK.IGlobalConfigService),Xf=(0,Z.yT)(Z.vK.IShaderModuleService),ll=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){var u,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,X.Z)(this,i),u=l.call(this),(0,z.Z)((0,te.Z)(u),"id","".concat(tp++)),(0,z.Z)((0,te.Z)(u),"name","".concat(tp)),(0,z.Z)((0,te.Z)(u),"type",void 0),(0,z.Z)((0,te.Z)(u),"visible",!0),(0,z.Z)((0,te.Z)(u),"zIndex",0),(0,z.Z)((0,te.Z)(u),"minZoom",void 0),(0,z.Z)((0,te.Z)(u),"maxZoom",void 0),(0,z.Z)((0,te.Z)(u),"inited",!1),(0,z.Z)((0,te.Z)(u),"layerModelNeedUpdate",!1),(0,z.Z)((0,te.Z)(u),"pickedFeatureID",null),(0,z.Z)((0,te.Z)(u),"selectedFeatureID",null),(0,z.Z)((0,te.Z)(u),"styleNeedUpdate",!1),(0,z.Z)((0,te.Z)(u),"rendering",void 0),(0,z.Z)((0,te.Z)(u),"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),(0,z.Z)((0,te.Z)(u),"hooks",{init:new fo.oI,afterInit:new fo.oI,beforeRender:new fo.oI,beforeRenderData:new fo.gg,afterRender:new fo.ni,beforePickingEncode:new fo.ni,afterPickingEncode:new fo.ni,beforeHighlight:new fo.ni(["pickedColor"]),afterHighlight:new fo.ni,beforeSelect:new fo.ni(["pickedColor"]),afterSelect:new fo.ni,beforeDestroy:new fo.ni,afterDestroy:new fo.ni}),(0,z.Z)((0,te.Z)(u),"models",[]),(0,z.Z)((0,te.Z)(u),"multiPassRenderer",void 0),(0,z.Z)((0,te.Z)(u),"plugins",void 0),(0,z.Z)((0,te.Z)(u),"sourceOption",void 0),(0,z.Z)((0,te.Z)(u),"layerModel",void 0),(0,G.Z)((0,te.Z)(u),"configService",qc,(0,te.Z)(u)),(0,G.Z)((0,te.Z)(u),"shaderModuleService",$h,(0,te.Z)(u)),(0,z.Z)((0,te.Z)(u),"cameraService",void 0),(0,z.Z)((0,te.Z)(u),"coordinateService",void 0),(0,z.Z)((0,te.Z)(u),"iconService",void 0),(0,z.Z)((0,te.Z)(u),"fontService",void 0),(0,z.Z)((0,te.Z)(u),"pickingService",void 0),(0,z.Z)((0,te.Z)(u),"rendererService",void 0),(0,z.Z)((0,te.Z)(u),"layerService",void 0),(0,z.Z)((0,te.Z)(u),"interactionService",void 0),(0,z.Z)((0,te.Z)(u),"mapService",void 0),(0,z.Z)((0,te.Z)(u),"styleAttributeService",void 0),(0,z.Z)((0,te.Z)(u),"layerSource",void 0),(0,z.Z)((0,te.Z)(u),"postProcessingPassFactory",void 0),(0,z.Z)((0,te.Z)(u),"normalPassFactory",void 0),(0,z.Z)((0,te.Z)(u),"animateOptions",{enable:!1}),(0,z.Z)((0,te.Z)(u),"container",void 0),(0,z.Z)((0,te.Z)(u),"encodedData",void 0),(0,z.Z)((0,te.Z)(u),"configSchema",void 0),(0,z.Z)((0,te.Z)(u),"currentPickId",null),(0,z.Z)((0,te.Z)(u),"rawConfig",void 0),(0,z.Z)((0,te.Z)(u),"needUpdateConfig",void 0),(0,z.Z)((0,te.Z)(u),"pendingStyleAttributes",[]),(0,z.Z)((0,te.Z)(u),"scaleOptions",{}),(0,z.Z)((0,te.Z)(u),"animateStartTime",void 0),(0,z.Z)((0,te.Z)(u),"aniamateStatus",!1),(0,z.Z)((0,te.Z)(u),"sourceEvent",function(){u.dataState.dataSourceNeedUpdate=!0;var v=u.getLayerConfig();v.autoFit&&u.fitBounds(v.fitBoundsOptions),u.emit("dataUpdate"),u.reRender()}),u.name=f.name||u.id,u.zIndex=f.zIndex||0,u.rawConfig=f,u}return(0,q.Z)(i,[{key:"getLayerConfig",value:function(){return this.configService.getLayerConfig(this.id)}},{key:"updateLayerConfig",value:function(f){if(this.inited){var v=this.container.get(Z.vK.SceneID);(function(n,l){n.opacity&&Dc("opacity",l,n.opacity),n.strokeWidth&&Dc("strokeWidth",l,n.strokeWidth),n.strokeOpacity&&Dc("strokeOpacity",l,n.strokeOpacity),n.stroke&&function(n,l,i){An()(i)?Ks(n,l,i,void 0):Tl()(i)&&2===i.length&&(An()(i[0])&&So()(i[1])||An()(i[0])&&Tl()(i[1])&&i[1].length>0)?Ks(n,l,i[0],i[1]):Ks(n,l,"#fff",void 0)}("stroke",l,n.stroke),n.offsets&&hc("offsets",l,n.offsets),n.textOffset&&hc("textOffset",l,n.textOffset)})(f,this),this.configService.setLayerConfig(v,this.id,qs(qs(qs({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),f)),this.needUpdateConfig={}}else this.needUpdateConfig=qs(qs({},this.needUpdateConfig),f)}},{key:"setContainer",value:function(f){this.container=f}},{key:"getContainer",value:function(){return this.container}},{key:"addPlugin",value:function(f){return this.plugins.push(f),this}},{key:"init",value:function(){var f=this,v=this.container.get(Z.vK.SceneID),b=this.rawConfig.enableMultiPassRenderer;this.configService.setLayerConfig(v,this.id,{enableMultiPassRenderer:void 0!==b&&b}),this.iconService=this.container.get(Z.vK.IIconService),this.fontService=this.container.get(Z.vK.IFontService),this.rendererService=this.container.get(Z.vK.IRendererService),this.layerService=this.container.get(Z.vK.ILayerService),this.interactionService=this.container.get(Z.vK.IInteractionService),this.pickingService=this.container.get(Z.vK.IPickingService),this.mapService=this.container.get(Z.vK.IMapService),this.cameraService=this.container.get(Z.vK.ICameraService),this.coordinateService=this.container.get(Z.vK.ICoordinateSystemService),this.postProcessingPassFactory=this.container.get(Z.vK.IFactoryPostProcessingPass),this.normalPassFactory=this.container.get(Z.vK.IFactoryNormalPass),this.styleAttributeService=this.container.get(Z.vK.IStyleAttributeService),this.multiPassRenderer=this.container.get(Z.vK.IMultiPassRenderer),this.multiPassRenderer.setLayer(this),this.pendingStyleAttributes.forEach(function(ie){var Re=ie.attributeName,Zt=ie.updateOptions;f.styleAttributeService.updateStyleAttribute(Re,{scale:qs({field:ie.attributeField},f.splitValuesAndCallbackInAttribute(ie.attributeValues,f.getLayerConfig()[Re]))},Zt)}),this.pendingStyleAttributes=[],this.plugins=this.container.getAll(Z.vK.ILayerPlugin);var N,I=function(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return Qh(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Qh(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,f=function(){};return{s:f,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(N){throw N},f}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var P,v=!0,b=!1;return{s:function(){i=i.call(n)},n:function(){var N=i.next();return v=N.done,N},e:function(N){b=!0,P=N},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(b)throw P}}}}(this.plugins);try{for(I.s();!(N=I.n()).done;)N.value.apply(this,{rendererService:this.rendererService,mapService:this.mapService,styleAttributeService:this.styleAttributeService,normalPassFactory:this.normalPassFactory,postProcessingPassFactory:this.postProcessingPassFactory})}catch(ie){I.e(ie)}finally{I.f()}return this.hooks.init.call(),this.hooks.afterInit.call(),this.emit("inited",{target:this,type:"inited"}),this.emit("add",{target:this,type:"add"}),this}},{key:"prepareBuildModel",value:function(){this.inited=!0,this.updateLayerConfig(qs(qs({},this.getDefaultConfig()),this.rawConfig));var v=this.getLayerConfig().animateOption;null!=v&&v.enable&&(this.layerService.startAnimate(),this.aniamateStatus=!0)}},{key:"color",value:function(f,v,b){return this.updateStyleAttribute("color",f,v,b),this}},{key:"texture",value:function(f,v,b){return this.updateStyleAttribute("texture",f,v,b),this}},{key:"rotate",value:function(f,v,b){return this.updateStyleAttribute("rotate",f,v,b),this}},{key:"size",value:function(f,v,b){return this.updateStyleAttribute("size",f,v,b),this}},{key:"filter",value:function(f,v,b){return this.updateStyleAttribute("filter",f,v,b),this}},{key:"shape",value:function(f,v,b){return this.updateStyleAttribute("shape",f,v,b),this}},{key:"label",value:function(f,v,b){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:f,attributeValues:v,updateOptions:b}),this}},{key:"animate",value:function(f){var v={};return ba()(f)?(v.enable=!0,v=qs(qs({},v),f)):v.enable=f,this.updateLayerConfig({animateOption:v}),this}},{key:"source",value:function(f,v){return null!=f&&f.data?(this.setSource(f),this):(this.sourceOption={data:f,options:v},this)}},{key:"setData",value:function(f,v){var b=this;return this.inited?this.layerSource.setData(f,v):this.on("inited",function(){b.layerSource.setData(f,v)}),this}},{key:"style",value:function(f){var v=this,b=f.passes,P=(0,St.Z)(f,["passes"]);return b&&function(n){return n.map(function(l){return"string"==typeof l&&(l=[l,{}]),l})}(b).forEach(function(I){var N=v.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(I[0]);N&&N.updateOptions(I[1])}),this.rawConfig=qs(qs({},this.rawConfig),P),this.container&&(this.updateLayerConfig(this.rawConfig),this.styleNeedUpdate=!0),this}},{key:"scale",value:function(f,v){return ba()(f)?this.scaleOptions=qs(qs({},this.scaleOptions),f):this.scaleOptions[f]=v,this}},{key:"renderLayers",value:function(){this.rendering=!0,this.layerService.renderLayers(),this.rendering=!1}},{key:"render",value:function(){return 0!==this.getEncodedData().length&&this.renderModels(),this}},{key:"active",value:function(f){var v={};return v.enableHighlight=!!ba()(f)||f,ba()(f)?(v.enableHighlight=!0,f.color&&(v.highlightColor=f.color)):v.enableHighlight=!!f,this.updateLayerConfig(v),this}},{key:"setActive",value:function(f,v){var b=this;if(ba()(f)){var P=f.x,I=void 0===P?0:P,N=f.y,se=void 0===N?0:N;this.updateLayerConfig({highlightColor:ba()(v)?v.color:this.getLayerConfig().highlightColor}),this.pick({x:I,y:se})}else this.updateLayerConfig({pickedFeatureID:f,highlightColor:ba()(v)?v.color:this.getLayerConfig().highlightColor}),this.hooks.beforeSelect.call((0,tt.Z6)(f)).then(function(){setTimeout(function(){b.reRender()},1)})}},{key:"select",value:function(f){var v={};return v.enableSelect=!!ba()(f)||f,ba()(f)?(v.enableSelect=!0,f.color&&(v.selectColor=f.color)):v.enableSelect=!!f,this.updateLayerConfig(v),this}},{key:"setSelect",value:function(f,v){var b=this;if(ba()(f)){var P=f.x,I=void 0===P?0:P,N=f.y,se=void 0===N?0:N;this.updateLayerConfig({selectColor:ba()(v)?v.color:this.getLayerConfig().selectColor}),this.pick({x:I,y:se})}else this.updateLayerConfig({pickedFeatureID:f,selectColor:ba()(v)?v.color:this.getLayerConfig().selectColor}),this.hooks.beforeSelect.call((0,tt.Z6)(f)).then(function(){setTimeout(function(){b.reRender()},1)})}},{key:"setBlend",value:function(f){this.updateLayerConfig({blend:f}),this.layerModelNeedUpdate=!0,this.reRender()}},{key:"show",value:function(){return this.updateLayerConfig({visible:!0}),this.reRender(),this}},{key:"hide",value:function(){return this.updateLayerConfig({visible:!1}),this.reRender(),this}},{key:"setIndex",value:function(f){return this.zIndex=f,this.layerService.updateRenderOrder(),this}},{key:"setCurrentPickId",value:function(f){this.currentPickId=f}},{key:"getCurrentPickId",value:function(){return this.currentPickId}},{key:"setCurrentSelectedId",value:function(f){this.selectedFeatureID=f}},{key:"getCurrentSelectedId",value:function(){return this.selectedFeatureID}},{key:"isVisible",value:function(){var f=this.mapService.getZoom(),v=this.getLayerConfig(),P=v.minZoom,N=v.maxZoom;return!!v.visible&&f>=(void 0===P?-1/0:P)&&f<=(void 0===N?1/0:N)}},{key:"setMinZoom",value:function(f){return this.updateLayerConfig({minZoom:f}),this}},{key:"getMinZoom",value:function(){return this.getLayerConfig().minZoom}},{key:"getMaxZoom",value:function(){return this.getLayerConfig().maxZoom}},{key:"get",value:function(f){return this.getLayerConfig()[f]}},{key:"setMaxZoom",value:function(f){return this.updateLayerConfig({maxZoom:f}),this}},{key:"fitBounds",value:function(f){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;var b=this.getSource().extent;return b.some(function(I){return Math.abs(I)===1/0})||this.mapService.fitBounds([[b[0],b[1]],[b[2],b[3]]],f),this}},{key:"destroy",value:function(){this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),this.multiPassRenderer.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),this.emit("remove",{target:this,type:"remove"}),this.removeAllListeners()}},{key:"clear",value:function(){this.styleAttributeService.clearAllAttributes()}},{key:"clearModels",value:function(){this.models.forEach(function(f){return f.destroy()}),this.layerModel.clearModels()}},{key:"isDirty",value:function(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(function(f){return f.needRescale||f.needRemapping||f.needRegenerateVertices}).length}},{key:"setSource",value:function(f){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=f,this.inited&&this.layerSource.cluster){var v=this.mapService.getZoom();this.layerSource.updateClusterData(v)}this.layerSource.on("update",this.sourceEvent)}},{key:"getSource",value:function(){return this.layerSource}},{key:"getScaleOptions",value:function(){return this.scaleOptions}},{key:"setEncodedData",value:function(f){this.encodedData=f}},{key:"getEncodedData",value:function(){return this.encodedData}},{key:"getLegendItems",value:function(f){var v=this.styleAttributeService.getLayerAttributeScale(f);return v?v.ticks?v.ticks().map(function(I){return(0,z.Z)({value:I},f,v(I))}):v.invertExtent?v.range().map(function(I){return(0,z.Z)({value:v.invertExtent(I)},f,I)}):void 0:[]}},{key:"pick",value:function(f){this.interactionService.triggerHover({x:f.x,y:f.y})}},{key:"boxSelect",value:function(f,v){this.pickingService.boxPickLayer(this,f,v)}},{key:"buildLayerModel",value:function(f){var v=f.moduleName,b=f.vertexShader,P=f.fragmentShader,I=f.triangulation,N=f.segmentNumber,se=(0,St.Z)(f,["moduleName","vertexShader","fragmentShader","triangulation","segmentNumber"]);this.shaderModuleService.registerModule(v,{vs:b,fs:P});var ie=this.shaderModuleService.getModule(v),Re=ie.vs,Je=ie.fs,It=ie.uniforms,Zt=this.rendererService.createModel,Tr=this.styleAttributeService.createAttributesAndIndices(this.encodedData,I,N);return Zt(qs({attributes:Tr.attributes,uniforms:It,fs:Je,vs:Re,elements:Tr.elements,blend:Kl[Z.BlendType.normal]},se))}},{key:"getTime",value:function(){return this.layerService.clock.getDelta()}},{key:"setAnimateStartTime",value:function(){this.animateStartTime=this.layerService.clock.getElapsedTime()}},{key:"stopAnimate",value:function(){this.aniamateStatus&&(this.layerService.stopAnimate(),this.aniamateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}},{key:"getLayerAnimateTime",value:function(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}},{key:"needPick",value:function(f){var v=this.getLayerConfig(),b=v.enableHighlight,P=void 0===b||b,I=v.enableSelect,N=void 0===I||I,se=-1!==this.eventNames().indexOf(f)||-1!==this.eventNames().indexOf("un"+f);return("click"===f||"dblclick"===f)&&N&&(se=!0),"mousemove"===f&&(P||-1!==this.eventNames().indexOf("mouseenter")||-1!==this.eventNames().indexOf("unmousemove")||-1!==this.eventNames().indexOf("mouseout"))&&(se=!0),this.isVisible()&&se}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"rebuildModels",value:function(){throw new Error("Method not implemented.")}},{key:"renderModels",value:function(){var f=this;return this.getEncodedData().length>0&&(this.layerModelNeedUpdate&&this.layerModel&&(this.models=this.layerModel.buildModels(),this.hooks.beforeRender.call(),this.layerModelNeedUpdate=!1),this.models.forEach(function(v){v.draw({uniforms:f.layerModel.getUninforms()})})),this}},{key:"updateStyleAttribute",value:function(f,v,b,P){this.inited?this.styleAttributeService.updateStyleAttribute(f,{scale:qs({field:v},this.splitValuesAndCallbackInAttribute(b,this.getLayerConfig()[v]))},P):this.pendingStyleAttributes.push({attributeName:f,attributeField:v,attributeValues:b,updateOptions:P})}},{key:"setEarthTime",value:function(f){console.warn("empty fn")}},{key:"getConfigSchema",value:function(){throw new Error("Method not implemented.")}},{key:"getModelType",value:function(){throw new Error("Method not implemented.")}},{key:"getDefaultConfig",value:function(){return{}}},{key:"reRender",value:function(){this.inited&&this.layerService.renderLayers()}},{key:"splitValuesAndCallbackInAttribute",value:function(f,v){return{values:So()(f)?void 0:f||v,callback:So()(f)?f:void 0}}}]),i}(Mt.EventEmitter),qc=(0,Ve.Z)(ll.prototype,"configService",[Cf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=(0,Ve.Z)(ll.prototype,"shaderModuleService",[Xf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ll),Tp=M(49977),Eo=M.n(Tp),pc=M(27859);function df(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}var Mu=(Sh=(0,Z.yT)(Z.vK.IGlobalConfigService),Af=(0,Z.yT)(Z.vK.IShaderModuleService),$c=function(){function n(l){(0,X.Z)(this,n),(0,z.Z)(this,"triangulation",void 0),(0,z.Z)(this,"createTexture2D",void 0),(0,z.Z)(this,"layer",void 0),(0,z.Z)(this,"dataTexture",void 0),(0,z.Z)(this,"DATA_TEXTURE_WIDTH",void 0),(0,z.Z)(this,"rowCount",void 0),(0,z.Z)(this,"cacheStyleProperties",void 0),(0,z.Z)(this,"cellLength",void 0),(0,z.Z)(this,"cellProperties",void 0),(0,z.Z)(this,"cellTypeLayout",void 0),(0,z.Z)(this,"stylePropertyesExist",void 0),(0,z.Z)(this,"dataTextureTest",void 0),(0,G.Z)(this,"configService",Bc,this),(0,G.Z)(this,"shaderModuleService",pf,this),(0,z.Z)(this,"rendererService",void 0),(0,z.Z)(this,"iconService",void 0),(0,z.Z)(this,"fontService",void 0),(0,z.Z)(this,"styleAttributeService",void 0),(0,z.Z)(this,"mapService",void 0),(0,z.Z)(this,"cameraService",void 0),(0,z.Z)(this,"layerService",void 0),this.layer=l,this.rendererService=l.getContainer().get(Z.vK.IRendererService),this.styleAttributeService=l.getContainer().get(Z.vK.IStyleAttributeService),this.mapService=l.getContainer().get(Z.vK.IMapService),this.iconService=l.getContainer().get(Z.vK.IIconService),this.fontService=l.getContainer().get(Z.vK.IFontService),this.cameraService=l.getContainer().get(Z.vK.ICameraService),this.layerService=l.getContainer().get(Z.vK.ILayerService),this.registerBuiltinAttributes(),this.startModelAnimate(),this.createTexture2D=this.rendererService.createTexture2D,this.DATA_TEXTURE_WIDTH=1024,this.rowCount=1,this.cellLength=0,this.cellProperties=[],this.cacheStyleProperties={opacity:void 0,strokeOpacity:void 0,strokeWidth:void 0,stroke:void 0,offsets:void 0},this.stylePropertyesExist={hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0},this.dataTextureTest=this.layerService.getOESTextureFloat(),this.dataTextureTest||(this.dataTexture=this.createTexture2D({data:new ImageData(1,1).data,mag:Z.gl.NEAREST,min:Z.gl.NEAREST,width:1,height:1}))}return(0,q.Z)(n,[{key:"clearLastCalRes",value:function(){this.cellProperties=[],this.cellLength=0,this.stylePropertyesExist={hasOpacity:0,hasStrokeOpacity:0,hasStrokeWidth:0,hasStroke:0,hasOffsets:0}}},{key:"getCellTypeLayout",value:function(){return this.dataTextureTest?[this.rowCount,this.DATA_TEXTURE_WIDTH,0,0,this.stylePropertyesExist.hasOpacity,this.stylePropertyesExist.hasStrokeOpacity,this.stylePropertyesExist.hasStrokeWidth,this.stylePropertyesExist.hasStroke,this.stylePropertyesExist.hasOffsets,0,0,0,0,0,0,1]:[1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,-1]}},{key:"dataTextureNeedUpdate",value:function(i){var u=!1;return Eo()(i.opacity,this.cacheStyleProperties.opacity)||(u=!0,this.cacheStyleProperties.opacity=i.opacity),Eo()(i.strokeOpacity,this.cacheStyleProperties.strokeOpacity)||(u=!0,this.cacheStyleProperties.strokeOpacity=i.strokeOpacity),Eo()(i.strokeWidth,this.cacheStyleProperties.strokeWidth)||(u=!0,this.cacheStyleProperties.strokeWidth=i.strokeWidth),Eo()(i.stroke,this.cacheStyleProperties.stroke)||(u=!0,this.cacheStyleProperties.stroke=i.stroke),Eo()(i.offsets,this.cacheStyleProperties.offsets)||(u=!0,this.cacheStyleProperties.offsets=i.offsets),void 0===this.dataTexture&&(u=!0),u}},{key:"judgeStyleAttributes",value:function(i){this.clearLastCalRes(),void 0!==i.opacity&&!ca()(i.opacity)&&(this.cellProperties.push({attr:"opacity",count:1}),this.stylePropertyesExist.hasOpacity=1,this.cellLength+=1),void 0!==i.strokeOpacity&&!ca()(i.strokeOpacity)&&(this.cellProperties.push({attr:"strokeOpacity",count:1}),this.stylePropertyesExist.hasStrokeOpacity=1,this.cellLength+=1),void 0!==i.strokeWidth&&!ca()(i.strokeWidth)&&(this.cellProperties.push({attr:"strokeWidth",count:1}),this.stylePropertyesExist.hasStrokeWidth=1,this.cellLength+=1),void 0!==i.stroke&&!this.isStaticColor(i.stroke)&&(this.cellProperties.push({attr:"stroke",count:4}),this.stylePropertyesExist.hasStroke=1,this.cellLength+=4),void 0!==i.offsets&&!this.isOffsetStatic(i.offsets)&&(this.cellProperties.push({attr:"offsets",count:2}),this.stylePropertyesExist.hasOffsets=1,this.cellLength+=2)}},{key:"isStaticColor",value:function(i){return!!An()(i)&&!!(0,pc.ZP)(i)}},{key:"getStrokeColor",value:function(i){if(this.isStaticColor(i)){var u=(0,tt.CI)(i);return u[0]=u[0]?u[0]:0,u[1]=u[1]?u[1]:0,u[2]=u[2]?u[2]:0,u[3]=u[3]?u[3]:0,u}return[0,0,0,0]}},{key:"isOffsetStatic",value:function(i){return!!(Tl()(i)&&2===i.length&&ca()(i[0])&&ca()(i[1]))}},{key:"patchMod",value:function(i,u){for(var f=0;f<u;f++)i.push(-1)}},{key:"patchData",value:function(i,u,f){var b,v=function(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return df(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return df(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,f=function(){};return{s:f,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(N){throw N},f}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var P,v=!0,b=!1;return{s:function(){i=i.call(n)},n:function(){var N=i.next();return v=N.done,N},e:function(N){b=!0,P=N},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(b)throw P}}}}(f);try{for(v.s();!(b=v.n()).done;){var P=b.value,I=P.attr,N=P.count,se=u[I];se?"stroke"===I?i.push.apply(i,(0,Ta.Z)((0,tt.CI)(se))):"offsets"===I?this.isOffsetStatic(se)?i.push(-se[0],se[1]):i.push(0,0):i.push(ca()(se)?se:1):this.patchMod(i,N)}}catch(ie){v.e(ie)}finally{v.f()}}},{key:"calDataFrame",value:function(i,u,f){for(var v=u.length,b=Math.ceil(v*i/this.DATA_TEXTURE_WIDTH),P=b*this.DATA_TEXTURE_WIDTH,I=[],N=0;N<v;N++)this.patchData(I,u[N],f);for(var ie=I.length;ie<P;ie++)I.push(-1);return{data:I,width:this.DATA_TEXTURE_WIDTH,height:b}}},{key:"getBlend",value:function(){var u=this.layer.getLayerConfig().blend;return Kl[Z.BlendType[void 0===u?"normal":u]]}},{key:"getDefaultStyle",value:function(){return{}}},{key:"getUninforms",value:function(){throw new Error("Method not implemented.")}},{key:"getAnimateUniforms",value:function(){return{}}},{key:"needUpdate",value:function(){return!1}},{key:"buildModels",value:function(){throw new Error("Method not implemented.")}},{key:"initModels",value:function(){throw new Error("Method not implemented.")}},{key:"clearModels",value:function(){}},{key:"getAttribute",value:function(){throw new Error("Method not implemented.")}},{key:"render",value:function(){throw new Error("Method not implemented.")}},{key:"registerBuiltinAttributes",value:function(){throw new Error("Method not implemented.")}},{key:"animateOption2Array",value:function(i){return[i.enable?0:1,i.duration||4,i.interval||.2,i.trailLength||.1]}},{key:"startModelAnimate",value:function(){this.layer.getLayerConfig().animateOption.enable&&this.layer.setAnimateStartTime()}}]),n}(),Bc=(0,Ve.Z)($c.prototype,"configService",[Sh],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pf=(0,Ve.Z)($c.prototype,"shaderModuleService",[Af],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$c),Yf=M(41604),Cl=M.n(Yf);function If(n){return n/180*Math.acos(-1)}function Qc(n){var l=If(n[0])+Math.PI/2,i=If(n[1]),u=100+.4*Math.random(),f=u*Math.cos(i)*Math.cos(l);return[u*Math.cos(i)*Math.sin(l),u*Math.sin(i),f]}var Ns=aa(),_s=(aa(),aa()),ql=aa(),mf=aa();function ef(n,l,i,u,f){return Ba(n,i,u),ko(n,n),[f/es(l=Ia(-n[1],n[0]),Ia(-i[1],i[0])),l]}function Js(n,l){return function(n,l,i){return n[0]=l,n[1]=i,n}(n,-l[1],l[0])}function Of(n,l,i){return m(n,l,i),ko(n,n),n}function qf(n,l){return n[0]===l[0]&&n[1]===l[1]}var rp=function(){function n(){var l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,X.Z)(this,n),(0,z.Z)(this,"complex",void 0),(0,z.Z)(this,"join",void 0),(0,z.Z)(this,"cap",void 0),(0,z.Z)(this,"miterLimit",void 0),(0,z.Z)(this,"thickness",void 0),(0,z.Z)(this,"normal",void 0),(0,z.Z)(this,"lastFlip",-1),(0,z.Z)(this,"miter",Ia(0,0)),(0,z.Z)(this,"started",!1),(0,z.Z)(this,"dash",!1),(0,z.Z)(this,"totalDistance",0),this.join=l.join||"miter",this.cap=l.cap||"butt",this.miterLimit=l.miterLimit||10,this.thickness=l.thickness||1,this.dash=l.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0}}return(0,q.Z)(n,[{key:"extrude_gaode2",value:function(i,u){var f=this.complex;if(i.length<=1)return f;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var v=i.length,b=f.startIndex,P=1;P<v;P++)b+=this.segment_gaode2(f,b,i[P-1],i[P],P<i.length-1?i[P+1]:null,u[P-1],u[P],P<u.length-1?u[P+1]:null);if(this.dash)for(var Zt=0;Zt<f.positions.length/6;Zt++)f.positions[6*Zt+5]=this.totalDistance;return f.startIndex=f.positions.length/6,f}},{key:"extrude",value:function(i){var u=this.complex;if(i.length<=1)return u;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;for(var f=i.length,v=u.startIndex,b=1;b<f;b++)v+=this.segment(u,v,i[b-1],i[b],b<i.length-1?i[b+1]:null);if(this.dash)for(var ie=0;ie<u.positions.length/6;ie++)u.positions[6*ie+5]=this.totalDistance;return u.startIndex=u.positions.length/6,u}},{key:"segment_gaode2",value:function(i,u,f,v,b,P,I,N){var se=0,ie=i.indices,Re=i.positions,Je=i.normals,It="square"===this.cap,Zt="bevel"===this.join,Tr=(0,tt.Z)([I[0],I[1]]),Vr=(0,tt.Z)([P[0],P[1]]);Of(_s,v,f);var on=0;if(this.dash&&(on=this.lineSegmentDistance(Tr,Vr),this.totalDistance+=on),this.normal||(this.normal=aa(),Js(this.normal,_s)),!this.started)if(this.started=!0,It){var mn=aa(),Pn=aa();Ba(mn,this.normal,_s),Ba(Pn,this.normal,_s),Je.push(Pn[0],Pn[1],0),Je.push(mn[0],mn[1],0),Re.push(f[0],f[1],0,this.totalDistance-on,-this.thickness,0),Re.push(f[0],f[1],0,this.totalDistance-on,this.thickness,0)}else this.extrusions(Re,Je,f,this.normal,this.thickness,this.totalDistance-on);if(ie.push(u+0,u+1,u+2),b){qf(v,b)&&Ba(b,v,ko(b,be(b,v,f))),Of(ql,b,v);var ti=ef(mf,aa(),_s,ql,this.thickness),Ui=(0,ra.Z)(ti,2),Sa=Ui[0],Ua=Ui[1],Ii=es(mf,this.normal)<0?-1:1,Va=Zt;Va||"miter"!==this.join||Sa>this.miterLimit&&(Va=!0),Va?(Je.push(this.normal[0],this.normal[1],0),Je.push(Ua[0],Ua[1],0),Re.push(v[0],v[1],0,this.totalDistance,-this.thickness*Ii,0),Re.push(v[0],v[1],0,this.totalDistance,this.thickness*Ii,0),ie.push.apply(ie,(0,Ta.Z)(this.lastFlip!==-Ii?[u,u+2,u+3]:[u+2,u+1,u+3])),ie.push(u+2,u+3,u+4),Js(Ns,ql),Ya(this.normal,Ns),Je.push(this.normal[0],this.normal[1],0),Re.push(v[0],v[1],0,this.totalDistance,-this.thickness*Ii,0),se+=3):(this.extrusions(Re,Je,v,Ua,Sa,this.totalDistance),ie.push.apply(ie,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),Ii=-1,Ya(this.normal,Ua),se+=2),this.lastFlip=Ii}else{if(Js(this.normal,_s),It){var Hn=aa(),ei=aa();m(ei,_s,this.normal),Ba(Hn,_s,this.normal),Je.push(ei[0],ei[1],0),Je.push(Hn[0],Hn[1],0),Re.push(v[0],v[1],0,this.totalDistance,this.thickness,0),Re.push(v[0],v[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(Re,Je,v,this.normal,this.thickness,this.totalDistance);ie.push.apply(ie,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),se+=2}return se}},{key:"segment",value:function(i,u,f,v,b){var P=0,I=i.indices,N=i.positions,se=i.normals,ie="square"===this.cap,Re="bevel"===this.join,Je=(0,tt.Z)([v[0],v[1]]),It=(0,tt.Z)([f[0],f[1]]);Of(_s,Je,It);var Zt=0;if(this.dash&&(Zt=this.lineSegmentDistance(Je,It),this.totalDistance+=Zt),this.normal||(this.normal=aa(),Js(this.normal,_s)),!this.started)if(this.started=!0,ie){var Tr=aa(),Vr=aa();Ba(Tr,this.normal,_s),Ba(Vr,this.normal,_s),se.push(Vr[0],Vr[1],0),se.push(Tr[0],Tr[1],0),N.push(f[0],f[1],0,this.totalDistance-Zt,-this.thickness,0),N.push(f[0],f[1],0,this.totalDistance-Zt,this.thickness,0)}else this.extrusions(N,se,f,this.normal,this.thickness,this.totalDistance-Zt);if(I.push(u+0,u+1,u+2),b){var Pn=(0,tt.Z)([b[0],b[1]]);qf(Je,Pn)&&Ba(Pn,Je,ko(Pn,be(Pn,Je,It))),Of(ql,Pn,Je);var Hn=ef(mf,aa(),_s,ql,this.thickness),ei=(0,ra.Z)(Hn,2),ti=ei[0],Ui=ei[1],Sa=es(mf,this.normal)<0?-1:1,Ua=Re;Ua||"miter"!==this.join||ti>this.miterLimit&&(Ua=!0),Ua?(se.push(this.normal[0],this.normal[1],0),se.push(Ui[0],Ui[1],0),N.push(v[0],v[1],0,this.totalDistance,-this.thickness*Sa,0),N.push(v[0],v[1],0,this.totalDistance,this.thickness*Sa,0),I.push.apply(I,(0,Ta.Z)(this.lastFlip!==-Sa?[u,u+2,u+3]:[u+2,u+1,u+3])),I.push(u+2,u+3,u+4),Js(Ns,ql),Ya(this.normal,Ns),se.push(this.normal[0],this.normal[1],0),N.push(v[0],v[1],0,this.totalDistance,-this.thickness*Sa,0),P+=3):(this.extrusions(N,se,v,Ui,ti,this.totalDistance),I.push.apply(I,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),Sa=-1,Ya(this.normal,Ui),P+=2),this.lastFlip=Sa}else{if(Js(this.normal,_s),ie){var on=aa(),mn=aa();m(mn,_s,this.normal),Ba(on,_s,this.normal),se.push(mn[0],mn[1],0),se.push(on[0],on[1],0),N.push(v[0],v[1],0,this.totalDistance,this.thickness,0),N.push(v[0],v[1],0,this.totalDistance,this.thickness,0)}else this.extrusions(N,se,v,this.normal,this.thickness,this.totalDistance);I.push.apply(I,(0,Ta.Z)(1===this.lastFlip?[u,u+2,u+3]:[u+2,u+1,u+3])),P+=2}return P}},{key:"extrusions",value:function(i,u,f,v,b,P){u.push(v[0],v[1],0),u.push(v[0],v[1],0),i.push(f[0],f[1],0,P,-b,0),i.push(f[0],f[1],0,P,b,0)}},{key:"lineSegmentDistance",value:function(i,u){var f=u[0]-i[0],v=u[1]-i[1];return Math.sqrt(f*f+v*v)}}]),n}();function tf(n){if(ca()(n[0]))return n;if(ca()(n[0][0]))throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8");if(ca()(n[0][0][0])){var i=0,u=0,f=0;return n.forEach(function(v){v.forEach(function(b){i+=b[0],u+=b[1],f++})}),[i/f,u/f,0]}throw new Error("\u5f53\u524d\u6570\u636e\u4e0d\u652f\u6301\u6807\u6ce8")}function Th(n){var l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=n[0][0],u=n[0][n[0].length-1];i[0]===u[0]&&i[1]===u[1]&&(n[0]=n[0].slice(0,n[0].length-1));for(var f=n[0].length,v=Cl().flatten(n),b=v.vertices,P=v.dimensions,I=[],N=[],se=[],ie=0;ie<b.length/P;ie++)2===P?I.push(b[2*ie],b[2*ie+1],1,-1,-1):I.push(b[3*ie],b[3*ie+1],1,-1,-1),se.push(0,0,1);var Re=Cl()(v.vertices,v.holes,v.dimensions);N.push.apply(N,(0,Ta.Z)(Re));for(var Je=function(Tr){var Vr=v.vertices.slice(Tr*P,(Tr+1)*P),on=v.vertices.slice((Tr+1)*P,(Tr+2)*P);0===on.length&&(on=v.vertices.slice(0,P));var mn=I.length/5;I.push(Vr[0],Vr[1],1,0,0,on[0],on[1],1,.1,0,Vr[0],Vr[1],0,0,.8,on[0],on[1],0,.1,.8);var Pn=Jf([on[0],on[1],1],[Vr[0],Vr[1],0],[Vr[0],Vr[1],1],l);se.push.apply(se,(0,Ta.Z)(Pn).concat((0,Ta.Z)(Pn),(0,Ta.Z)(Pn),(0,Ta.Z)(Pn))),N.push.apply(N,(0,Ta.Z)([1,2,0,3,2,1].map(function(Hn){return Hn+mn})))},It=0;It<f;It++)Je(It);return{positions:I,index:N,normals:se}}function Jf(n,l,i){var u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],f=er(),v=er(),b=er();u&&(n=(0,tt.vP)(n),l=(0,tt.vP)(l),i=(0,tt.vP)(i));var P=Wn.apply(ue,(0,Ta.Z)(n)),I=Wn.apply(ue,(0,Ta.Z)(l)),N=Wn.apply(ue,(0,Ta.Z)(i));Ma(f,N,I),Ma(v,P,I),Br(b,f,v);var se=er();return Vt(se,b),se}var lu,Ps=(()=>(function(n){n.CYLINDER="cylinder",n.SQUARECOLUMN="squareColumn",n.TRIANGLECOLUMN="triangleColumn",n.HEXAGONCOLUMN="hexagonColumn",n.PENTAGONCOLUMN="pentagonColumn"}(Ps||(Ps={})),Ps))(),Nc=(()=>(function(n){n.CIRCLE="circle",n.SQUARE="square",n.TRIANGLE="triangle",n.HEXAGON="hexagon",n.PENTAGON="pentagon"}(Nc||(Nc={})),Nc))();function Iu(n){for(var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=2*Math.PI/n,u=[],f=0;f<n;f++)u.push(i*f+l*Math.PI/12);var v=u.map(function(b){return[Math.sin(b+Math.PI/4),Math.cos(b+Math.PI/4),0]});return v}function Ch(){return Iu(30)}function Al(){return Iu(4)}function Jl(){return Iu(3)}function Ah(){return Iu(6,1)}function $f(){return Iu(5)}var yf=((0,z.Z)(lu={},Nc.CIRCLE,Ch),(0,z.Z)(lu,Nc.HEXAGON,Ah),(0,z.Z)(lu,Nc.TRIANGLE,Jl),(0,z.Z)(lu,Nc.SQUARE,Al),(0,z.Z)(lu,Nc.PENTAGON,$f),(0,z.Z)(lu,Ps.CYLINDER,Ch),(0,z.Z)(lu,Ps.HEXAGONCOLUMN,Ah),(0,z.Z)(lu,Ps.TRIANGLECOLUMN,Jl),(0,z.Z)(lu,Ps.SQUARECOLUMN,Al),(0,z.Z)(lu,Ps.PENTAGONCOLUMN,$f),lu),kf={};function as(n){var l=tf(n.coordinates);return{vertices:[].concat((0,Ta.Z)(l),(0,Ta.Z)(l),(0,Ta.Z)(l),(0,Ta.Z)(l)),indices:[0,1,2,2,3,0],size:l.length}}function Zo(n){var i=Qc(tf(n.coordinates));return{vertices:[].concat((0,Ta.Z)(i),(0,Ta.Z)(i),(0,Ta.Z)(i),(0,Ta.Z)(i)),indices:[0,1,2,2,3,0],size:i.length}}function os(n){var i=function(n){var l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(kf&&kf[n])return kf[n];var u=Th([yf[n]?yf[n]():yf.cylinder()],l);return kf[n]=u,u}(n.shape,!1);return{vertices:i.positions,indices:i.index,normals:i.normals,size:5}}function cu(n){var l=tf(n.coordinates);return{vertices:(0,Ta.Z)(l),indices:[0],size:l.length}}function Ph(n){var l=n.coordinates,i=n.originCoordinates,u=n.version,f=new rp({dash:!0,join:"bevel"});if("GAODE2.x"===u){var v=l;Array.isArray(v[0][0])||(v=[l]);var b=i;Array.isArray(b[0][0])||(b=[i]);for(var P=0;P<v.length;P++)f.extrude_gaode2(v[P],b[P])}else{var se=l;Array.isArray(se[0][0])||(se=[l]),se.forEach(function(Re){f.extrude(Re)})}var ie=f.complex;return{vertices:ie.positions,indices:ie.indices,normals:ie.normals,size:6}}function Ap(n){var l=n.coordinates,i=Cl().flatten(l),u=i.vertices,f=i.dimensions,v=i.holes;return{indices:Cl()(u,v,f),vertices:u,size:f}}function np(n){var i=Th(n.coordinates,!0);return{vertices:i.positions,indices:i.index,normals:i.normals,size:5}}var V=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){return(0,X.Z)(this,i),l.apply(this,arguments)}return(0,q.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,b=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:b})){this.judgeStyleAttributes({opacity:b});var P=this.layer.getEncodedData(),I=this.calDataFrame(this.cellLength,P,this.cellProperties),N=I.data,se=I.width,ie=I.height;this.rowCount=ie,this.dataTexture=this.createTexture2D(this.cellLength>0&&N.length>0?{flipY:!0,data:N,format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:se,height:ie}:{flipY:!0,data:[1],format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(b)?b:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointExtrude2",vertexShader:'precision highp float;\n\n#define pi 3.1415926535\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec3 a_Position;\nattribute vec3 a_Pos;\nattribute vec4 a_Color;\nattribute vec3 a_Size;\nattribute vec3 a_Normal;\n\nuniform float u_globel;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nfloat getYRadian(float x, float z) {\n  if(x > 0.0 && z > 0.0) {\n    return atan(x/z);\n  } else if(x > 0.0 && z <= 0.0){\n    return atan(-z/x) + pi/2.0;\n  } else if(x <= 0.0 && z <= 0.0) {\n    return  pi + atan(x/z); //atan(x/z) + \n  } else {\n    return atan(z/-x) + pi*3.0/2.0;\n  }\n}\n\nfloat getXRadian(float y, float r) {\n  return atan(y/r);\n}\n\nvoid main() {\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  vec3 size = a_Size * a_Position;\n\n  vec2 offset = project_pixel(size.xy);\n\n  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));\n\n  vec4 pos = vec4(project_pos.xy + offset, project_pixel(size.z), 1.0);\n\n  float lightWeight = calc_lighting(pos);\n  v_color =vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  // gl_Position = project_common_position_to_clipspace(pos);\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * pos;\n  } else {\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  \n  if(u_globel > 0.0) {\n    // \u5728\u5730\u7403\u6a21\u5f0f\u4e0b\uff0c\u5c06\u539f\u672c\u5782\u76f4\u4e8e xy \u5e73\u9762\u7684\u5706\u67f1\u8c03\u6574\u59ff\u6001\u5230\u9002\u5e94\u5706\u7684\u89d2\u5ea6\n    //\u65cb\u8f6c\u77e9\u9635mx\uff0c\u521b\u5efa\u7ed5x\u8f74\u65cb\u8f6c\u77e9\u9635\n    float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);\n    float xRadian = getXRadian(a_Pos.y, r);\n    float xcos = cos(xRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u4f59\u5f26\u503c\n    float xsin = sin(xRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u6b63\u5f26\u503c\n    mat4 mx = mat4(\n      1,0,0,0,  \n      0,xcos,-xsin,0,  \n      0,xsin,xcos,0,  \n      0,0,0,1);\n\n    //\u65cb\u8f6c\u77e9\u9635my\uff0c\u521b\u5efa\u7ed5y\u8f74\u65cb\u8f6c\u77e9\u9635\n    float yRadian = getYRadian(a_Pos.x, a_Pos.z);\n    float ycos = cos(yRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u4f59\u5f26\u503c\n    float ysin = sin(yRadian);//\u6c42\u89e3\u65cb\u8f6c\u89d2\u5ea6\u6b63\u5f26\u503c\n    mat4 my = mat4(\n      ycos,0,-ysin,0,  \n      0,1,0,0,  \n      ysin,0,ycos,0,  \n      0,0,0,1);\n\n    gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'varying vec4 v_color;\nuniform float u_opacity: 1.0;\n\n#pragma include "picking"\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:os,blend:this.getBlend()})]}},{key:"clearModels",value:function(){var f;null===(f=this.dataTexture)||void 0===f||f.destroy()}},{key:"registerBuiltinAttributes",value:function(){var f="GLOBEL"===this.mapService.version;this.styleAttributeService.registerStyleAttribute({name:"size",type:Z.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:3,update:function(b,P,I,N){var se=b.size;if(se){var ie=[];return Array.isArray(se)&&(ie=2===se.length?[se[0],se[0],se[1]]:se),Array.isArray(se)||(ie=[se,se,se]),ie}return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Z.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Z.gl.STATIC_DRAW,data:[],type:Z.gl.FLOAT},size:3,update:function(b,P,I,N,se){return se}}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Z.AttributeType.Attribute,descriptor:{name:"a_Pos",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:3,update:function(b,P){var I=tf(b.coordinates);return f?Qc([I[0],I[1]]):[I[0],I[1],0]}}})}}]),i}(Mu);var tr=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){return(0,X.Z)(this,i),l.apply(this,arguments)}return(0,q.Z)(i,[{key:"getUninforms",value:function(){var f=this.layer.getLayerConfig(),v=f.opacity,b=void 0===v?1:v,P=f.strokeOpacity,I=void 0===P?1:P,N=f.strokeWidth,se=void 0===N?0:N,ie=f.stroke,Re=void 0===ie?"rgba(0,0,0,0)":ie,Je=f.offsets,It=void 0===Je?[0,0]:Je;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:b,strokeOpacity:I,strokeWidth:se,stroke:Re,offsets:It})){this.judgeStyleAttributes({opacity:b,strokeOpacity:I,strokeWidth:se,stroke:Re,offsets:It});var Zt=this.layer.getEncodedData(),Tr=this.calDataFrame(this.cellLength,Zt,this.cellProperties),Vr=Tr.data,on=Tr.width,mn=Tr.height;this.rowCount=mn,this.dataTexture=this.createTexture2D(this.cellLength>0&&Vr.length>0?{flipY:!0,data:Vr,format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:on,height:mn}:{flipY:!0,data:[1],format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:1,height:1})}return{u_globel:"GLOBEL"===this.mapService.version?1:0,u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(b)?b:1,u_stroke_opacity:ca()(I)?I:1,u_stroke_width:ca()(se)?se:0,u_stroke_color:this.getStrokeColor(Re),u_offsets:this.isOffsetStatic(It)?It:[0,0]}}},{key:"getAnimateUniforms",value:function(){var f=this.layer.getLayerConfig();return{u_aimate:this.animateOption2Array(f.animateOption),u_time:this.layer.getLayerAnimateTime()}}},{key:"getAttribute",value:function(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),as)}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){var f="GLOBEL"===this.mapService.version;return[this.layer.buildLayerModel({moduleName:"pointfill",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Extrude;\nattribute float a_Size;\nattribute float a_Shape;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\nuniform float u_globel;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\n\nuniform float u_opacity : 1;\nuniform float u_stroke_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\nuniform vec2 u_offsets;\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\n\nvoid main() {\n  vec3 extrude = a_Extrude;\n  float shape_type = a_Shape;\n  float newSize = setPickingSize(a_Size);\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 strokeOpacityAndOffset = calStrokeOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][1] = strokeOpacityAndOffset.r;\n  textureOffset = strokeOpacityAndOffset.g;\n\n  vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n\n  // unpack color(vec2)\n  v_color = a_Color;\n\n  // radius(16-bit)\n  v_radius = newSize;\n\n  // TODO: billboard\n  // anti-alias\n  float antialiasblur = 1.0 / u_DevicePixelRatio / (newSize + u_stroke_width);\n\n  // construct point coords\n  // TODP: /abs(extrude.x) \u662f\u4e3a\u4e86\u517c\u5bb9\u5730\u7403\u6a21\u5f0f\n  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);\n\n  // vec2 offset = project_pixel(extrude * (newSize + u_stroke_width) + u_offsets);\n  vec2 offset = project_pixel(extrude.xy * (newSize + u_stroke_width) + textrueOffsets);\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * vec4(project_pos.xy + offset, 0.0, 1.0);\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));\n  }\n\n  if(u_globel > 0.0) {\n    gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1, 1.0);\n  }\n \n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:"#define Animate 0.0\n\nuniform float u_globel;\nuniform float u_blur : 0;\n// uniform float u_stroke_width : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\nvarying vec4 v_data;\nvarying vec4 v_color;\nvarying float v_radius;\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\n\n#pragma include \"sdf_2d\"\n#pragma include \"picking\"\n\n\nvoid main() {\n  int shape = int(floor(v_data.w + 0.5));\n\n \n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  float opacity = styleMappingMat[0][0];\n  float stroke_opacity = styleMappingMat[0][1];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 strokeColor = textrueStroke == vec4(0) ? v_color : textrueStroke;\n\n  lowp float antialiasblur = v_data.z;\n  float antialiased_blur = -max(u_blur, antialiasblur);\n  // float r = v_radius / (v_radius + u_stroke_width);\n  float r = v_radius / (v_radius + strokeWidth);\n\n  float outer_df;\n  float inner_df;\n  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'\n  if (shape == 0) {\n    outer_df = sdCircle(v_data.xy, 1.0);\n    inner_df = sdCircle(v_data.xy, r);\n  } else if (shape == 1) {\n    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);\n    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);\n  } else if (shape == 2) {\n    outer_df = sdBox(v_data.xy, vec2(1.));\n    inner_df = sdBox(v_data.xy, vec2(r));\n  } else if (shape == 3) {\n    outer_df = sdPentagon(v_data.xy, 0.8);\n    inner_df = sdPentagon(v_data.xy, r * 0.8);\n  } else if (shape == 4) {\n    outer_df = sdHexagon(v_data.xy, 0.8);\n    inner_df = sdHexagon(v_data.xy, r * 0.8);\n  } else if (shape == 5) {\n    outer_df = sdOctogon(v_data.xy, 1.0);\n    inner_df = sdOctogon(v_data.xy, r);\n  } else if (shape == 6) {\n    outer_df = sdHexagram(v_data.xy, 0.52);\n    inner_df = sdHexagram(v_data.xy, r * 0.52);\n  } else if (shape == 7) {\n    outer_df = sdRhombus(v_data.xy, vec2(1.0));\n    inner_df = sdRhombus(v_data.xy, vec2(r));\n  } else if (shape == 8) {\n    outer_df = sdVesica(v_data.xy, 1.1, 0.8);\n    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);\n  }\n\n  if(u_globel > 0.0) {\n    // TODO: \u5730\u7403\u6a21\u5f0f\u4e0b\u907f\u514d\u591a\u4f59\u7247\u5143\u7ed8\u5236\uff0c\u540c\u65f6\u4e5f\u80fd\u907f\u514d\u6709\u7528\u7247\u5143\u5728\u900f\u660e\u4e14\u91cd\u53e0\u7684\u60c5\u51b5\u4e0b\u65e0\u6cd5\u5199\u5165\n    // \u4ed8\u51fa\u7684\u4ee3\u4ef7\u662f\u8fb9\u7f18\u4f1a\u6709\u4e00\u4e9b\u952f\u9f7f\n    if(outer_df > antialiased_blur + 0.018) discard;\n  }\n  float opacity_t = smoothstep(0.0, antialiased_blur, outer_df);\n  \n \n  // float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(\n  //   antialiased_blur,\n  //   0.0,\n  //   inner_df\n  // );\n   float color_t = strokeWidth < 0.01 ? 0.0 : smoothstep(\n    antialiased_blur,\n    0.0,\n    inner_df\n  );\n  float PI = 3.14159;\n  float N_RINGS = 3.0;\n  float FREQ = 1.0;\n\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), strokeColor * stroke_opacity, color_t);\n\n  gl_FragColor.a = gl_FragColor.a * opacity_t;\n  if(u_aimate.x == Animate) {\n    float d = length(v_data.xy);\n    float intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_aimate.z - u_aimate.y * u_time)), 0.0, 1.0);\n    gl_FragColor = vec4(gl_FragColor.xyz, intensity);\n  }\n\n  gl_FragColor = filterColor(gl_FragColor);\n\n  \n\n}\n",triangulation:f?Zo:as,depth:{enable:f},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var f;null===(f=this.dataTexture)||void 0===f||f.destroy()}},{key:"animateOption2Array",value:function(f){return[f.enable?0:1,f.speed||1,f.rings||3,0]}},{key:"registerBuiltinAttributes",value:function(){var f=this,v="GLOBEL"===this.mapService.version;this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Z.AttributeType.Attribute,descriptor:{name:"a_Extrude",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:3,update:function(P,I,N,se){var ie;if(v){var Re=(0,ra.Z)(N,3),Je=Re[0],It=Re[1],Zt=Re[2],Tr=Wn(0,0,1),Vr=Wn(Je,0,Zt),on=Je>=0?oi(Tr,Vr):2*Math.PI-oi(Tr,Vr),mn=2*Math.PI-Math.asin(It/100),Pn=jt.create();jt.rotateY(Pn,Pn,on),jt.rotateX(Pn,Pn,mn);var Hn=Wn(1,1,0);nn(Hn,Hn,Pn),Vt(Hn,Hn);var ei=Wn(-1,1,0);nn(ei,ei,Pn),Vt(ei,ei);var ti=Wn(-1,-1,0);nn(ti,ti,Pn),Vt(ti,ti);var Ui=Wn(1,-1,0);nn(Ui,Ui,Pn),Vt(Ui,Ui),ie=[].concat((0,Ta.Z)(Hn),(0,Ta.Z)(ei),(0,Ta.Z)(ti),(0,Ta.Z)(Ui))}else ie=[1,1,0,-1,1,0,-1,-1,0,1,-1,0];var Sa=se%4*3;return[ie[Sa],ie[Sa+1],ie[Sa+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Z.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(P,I,N,se){var ie=P.size,Re=void 0===ie?5:ie;return Array.isArray(Re)?[Re[0]]:[Re]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Z.AttributeType.Attribute,descriptor:{name:"a_Shape",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(P,I,N,se){var ie=P.shape,Re=void 0===ie?2:ie;return[f.layer.getLayerConfig().shape2d.indexOf(Re)]}}})}}]),i}(Mu);var qr=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){var u;(0,X.Z)(this,i);for(var f=arguments.length,v=new Array(f),b=0;b<f;b++)v[b]=arguments[b];return u=l.call.apply(l,[this].concat(v)),(0,z.Z)((0,te.Z)(u),"texture",void 0),u}return(0,q.Z)(i,[{key:"getUninforms",value:function(){return{u_opacity:this.layer.getLayerConfig().opacity||1,u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128]}}},{key:"initModels",value:function(){var f=this;return this.initIconFontGlyphs(),this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",function(){f.updateTexture(),f.layer.render()}),[this.layer.buildLayerModel({moduleName:"pointiconImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_stroke_width : 1;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  //  vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n\n  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);\n    } else {\n      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n    }\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor=texture2D(u_texture,pos);\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n      // gl_FragColor.a =gl_FragColor.a * u_opacity;\n      gl_FragColor.a =gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:cu,primitive:Z.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"clearModels",value:function(){var f;null===(f=this.dataTexture)||void 0===f||f.destroy()}},{key:"registerBuiltinAttributes",value:function(){var f=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Z.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(b,P,I,N){var se=b.size;return Array.isArray(se)?[se[0]]:[se]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Z.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:2,update:function(b,P,I,N){var Je=f.fontService.mapping[f.fontService.getGlyph(b.shape)];return[Je.x,Je.y]}}})}},{key:"updateTexture",value:function(){var v=this.fontService.canvas;this.texture=(0,this.rendererService.createTexture2D)({data:v,mag:Z.gl.LINEAR,min:Z.gl.LINEAR,width:v.width,height:v.height})}},{key:"initIconFontGlyphs",value:function(){var f=this,v=this.layer.getLayerConfig(),b=v.fontWeight,P=void 0===b?"normal":b,I=v.fontFamily,N=void 0===I?"sans-serif":I,se=this.layer.getEncodedData(),ie=[];se.forEach(function(Re){var Je=Re.shape,It=void 0===Je?"":Je;It=It.toString();var Zt=f.fontService.getGlyph(It);-1===ie.indexOf(Zt)&&ie.push(Zt)}),this.fontService.setFontOptions({characterSet:ie,fontWeight:P,fontFamily:N,fontSize:48})}}]),i}(Mu);var Bt=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){var u;(0,X.Z)(this,i);for(var f=arguments.length,v=new Array(f),b=0;b<f;b++)v[b]=arguments[b];return u=l.call.apply(l,[this].concat(v)),(0,z.Z)((0,te.Z)(u),"texture",void 0),(0,z.Z)((0,te.Z)(u),"updateTexture",function(){var P=u.rendererService.createTexture2D;if(u.texture)return u.texture.update({data:u.iconService.getCanvas()}),void u.layer.renderLayers();u.texture=P({data:u.iconService.getCanvas(),mag:Z.gl.LINEAR,min:Z.gl.LINEAR,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})}),u}return(0,q.Z)(i,[{key:"getUninforms",value:function(){var f=this.layer.getLayerConfig(),v=f.opacity,b=f.offsets,P=void 0===b?[0,0]:b;if(this.rendererService.getDirty()&&this.texture.bind(),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v,offsets:P})){this.judgeStyleAttributes({opacity:v,offsets:P});var I=this.layer.getEncodedData(),N=this.calDataFrame(this.cellLength,I,this.cellProperties),se=N.data,ie=N.width,Re=N.height;this.rowCount=Re,this.dataTexture=this.createTexture2D(this.cellLength>0&&se.length>0?{flipY:!0,data:se,format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:ie,height:Re}:{flipY:!0,data:[1],format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_texture:this.texture,u_textSize:[1024,this.iconService.canvasHeight||128],u_opacity:ca()(v)?v:1,u_offsets:this.isOffsetStatic(P)?P:[0,0]}}},{key:"initModels",value:function(){return this.registerBuiltinAttributes(),this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var f,v;null===(f=this.texture)||void 0===f||f.destroy(),null===(v=this.dataTexture)||void 0===v||v.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"pointImage",vertexShader:'precision highp float;\nattribute vec3 a_Position;\nattribute vec4 a_Color;\nattribute vec2 a_Uv;\nattribute float a_Size;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_stroke_width : 1;\nuniform vec2 u_offsets;\n\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   v_color = a_Color;\n   v_uv = a_Uv;\n   vec4 project_pos = project_position(vec4(a_Position, 1.0));\n   \n  //  vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n\n  //  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n      gl_Position = u_Mvp * vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0);\n    } else {\n      gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy + offset),project_pos.z, 1.0));\n    }\n   gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n\n  setPickingColor(a_PickingColor);\n\n}\n',fragmentShader:'\nuniform sampler2D u_texture;\nvarying vec4 v_color;\nvarying vec2 v_uv;\nuniform vec2 u_textSize;\nuniform float u_opacity : 1;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main(){\n      float opacity = styleMappingMat[0][0];\n      vec2 pos= v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;\n      vec4 textureColor=texture2D(u_texture,pos);\n      if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){\n            gl_FragColor= textureColor;\n      }else {\n            gl_FragColor= step(0.01, textureColor.z) * v_color;\n      }\n      // gl_FragColor.a =gl_FragColor.a * u_opacity;\n      gl_FragColor.a =gl_FragColor.a * opacity;\n      gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:cu,primitive:Z.gl.POINTS,depth:{enable:!1},blend:this.getBlend()})]}},{key:"registerBuiltinAttributes",value:function(){var f=this;this.styleAttributeService.registerStyleAttribute({name:"size",type:Z.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(b,P,I,N){var se=b.size,ie=void 0===se?5:se;return Array.isArray(ie)?[ie[0]]:[ie]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Z.AttributeType.Attribute,descriptor:{name:"a_Uv",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:2,update:function(b,P,I,N){var Re=f.iconService.getIconMap()[b.shape]||{x:0,y:0};return[Re.x,Re.y]}}})}}]),i}(Mu);function bn(n){var l=n.coordinates;return{vertices:(0,Ta.Z)(l),indices:[0],size:l.length}}var tn=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){return(0,X.Z)(this,i),l.apply(this,arguments)}return(0,q.Z)(i,[{key:"getDefaultStyle",value:function(){return{blend:"additive"}}},{key:"getUninforms",value:function(){var f=this.layer.getLayerConfig(),v=f.opacity,b=void 0===v?1:v,P=f.offsets,I=void 0===P?[0,0]:P;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:b,offsets:I})){this.judgeStyleAttributes({opacity:b,offsets:I});var N=this.layer.getEncodedData(),se=this.calDataFrame(this.cellLength,N,this.cellProperties),ie=se.data,Re=se.width,Je=se.height;this.rowCount=Je,this.dataTexture=this.createTexture2D(this.cellLength>0&&ie.length>0?{flipY:!0,data:ie,format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:Re,height:Je}:{flipY:!0,data:[1],format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(b)?b:1,u_offsets:this.isOffsetStatic(I)?I:[0,0]}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"normalpoint",vertexShader:'\nattribute vec3 a_Position;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nattribute float a_Size;\nattribute vec4 a_Color;\nvarying vec4 v_color;\n\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n#pragma include "project"\nvoid main() {\n  v_color = a_Color;\n\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n  vec2 textrueOffsets = vec2(0.0, 0.0);\n  if(hasOffsets()) {\n    vec2 valueXPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.r = pos2value(valueXPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n\n    vec2 valueYPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    textrueOffsets.g = pos2value(valueYPos, columnWidth, rowHeight); // x\n    textureOffset += 1.0;\n  } else {\n    textrueOffsets = u_offsets;\n  }\n\n  // cal style mapping\n  \n  // vec2 offset = project_pixel(u_offsets);\n  vec2 offset = project_pixel(textrueOffsets);\n  // vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n  // gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\\\n  // \n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // vec2 offset = project_pixel((u_offsets));\n    gl_Position = u_Mvp * vec4(a_Position.xy + offset, a_Position.z, 1.0);\n  } else { // else\n    // vec2 offset = project_pixel(u_offsets);\n    vec4 project_pos = project_position(vec4(a_Position, 1.0)) + vec4(a_Size / 2.,-a_Size /2.,0.,0.);\n    gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));\n  }\n\n  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'\nuniform float u_opacity : 1;\nuniform vec2 u_offsets;\nvarying vec4 v_color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n\n  gl_FragColor = v_color;\n  // gl_FragColor.a =gl_FragColor.a * u_opacity;\n  gl_FragColor.a =gl_FragColor.a * opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:bn,depth:{enable:!1},primitive:Z.gl.POINTS,blend:this.getBlend()})]}},{key:"clearModels",value:function(){var f;null===(f=this.dataTexture)||void 0===f||f.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Z.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(v,b,P,I){var N=v.size,se=void 0===N?1:N;return Array.isArray(se)?[se[0]]:[se]}}})}},{key:"defaultStyleOptions",value:function(){return{blend:Z.BlendType.additive}}}]),i}(Mu);function Sr(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}const dn=function(){function n(l,i,u){(0,X.Z)(this,n),(0,z.Z)(this,"boxCells",[]),(0,z.Z)(this,"xCellCount",void 0),(0,z.Z)(this,"yCellCount",void 0),(0,z.Z)(this,"boxKeys",void 0),(0,z.Z)(this,"bboxes",void 0),(0,z.Z)(this,"width",void 0),(0,z.Z)(this,"height",void 0),(0,z.Z)(this,"xScale",void 0),(0,z.Z)(this,"yScale",void 0),(0,z.Z)(this,"boxUid",void 0);var f=this.boxCells;this.xCellCount=Math.ceil(l/u),this.yCellCount=Math.ceil(i/u);for(var v=0;v<this.xCellCount*this.yCellCount;v++)f.push([]);this.boxKeys=[],this.bboxes=[],this.width=l,this.height=i,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/i,this.boxUid=0}return(0,q.Z)(n,[{key:"insert",value:function(i,u,f,v,b){this.forEachCell(u,f,v,b,this.insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(v),this.bboxes.push(b)}},{key:"query",value:function(i,u,f,v,b){return this.queryHitTest(i,u,f,v,!1,b)}},{key:"hitTest",value:function(i,u,f,v,b){return this.queryHitTest(i,u,f,v,!0,b)}},{key:"insertBoxCell",value:function(i,u,f,v,b,P){this.boxCells[b].push(P)}},{key:"queryHitTest",value:function(i,u,f,v,b,P){if(f<0||i>this.width||v<0||u>this.height)return!b&&[];var I=[];if(i<=0&&u<=0&&this.width<=f&&this.height<=v){if(b)return!0;for(var N=0;N<this.boxKeys.length;N++)I.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});return P?I.filter(P):I}return this.forEachCell(i,u,f,v,this.queryCell,I,{hitTest:b,seenUids:{box:{},circle:{}}},P),b?I.length>0:I}},{key:"queryCell",value:function(i,u,f,v,b,P,I,N){var se=I.seenUids,ie=this.boxCells[b];if(null!==ie){var It,Re=this.bboxes,Je=function(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return Sr(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return Sr(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,f=function(){};return{s:f,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(N){throw N},f}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var P,v=!0,b=!1;return{s:function(){i=i.call(n)},n:function(){var N=i.next();return v=N.done,N},e:function(N){b=!0,P=N},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(b)throw P}}}}(ie);try{for(Je.s();!(It=Je.n()).done;){var Zt=It.value;if(!se.box[Zt]){se.box[Zt]=!0;var Tr=4*Zt;if(i<=Re[Tr+2]&&u<=Re[Tr+3]&&f>=Re[Tr+0]&&v>=Re[Tr+1]&&(!N||N(this.boxKeys[Zt]))){if(I.hitTest)return P.push(!0),!0;P.push({key:this.boxKeys[Zt],x1:Re[Tr],y1:Re[Tr+1],x2:Re[Tr+2],y2:Re[Tr+3]})}}}}catch(Vr){Je.e(Vr)}finally{Je.f()}}return!1}},{key:"forEachCell",value:function(i,u,f,v,b,P,I,N){for(var se=this.convertToXCellCoord(i),ie=this.convertToYCellCoord(u),Re=this.convertToXCellCoord(f),Je=this.convertToYCellCoord(v),It=se;It<=Re;It++)for(var Zt=ie;Zt<=Je;Zt++)if(b.call(this,i,u,f,v,this.xCellCount*Zt+It,P,I,N))return}},{key:"convertToXCellCoord",value:function(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}},{key:"convertToYCellCoord",value:function(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}}]),n}();var Jr=function(){function n(l,i){(0,X.Z)(this,n),(0,z.Z)(this,"width",void 0),(0,z.Z)(this,"height",void 0),(0,z.Z)(this,"grid",void 0),(0,z.Z)(this,"viewportPadding",100),(0,z.Z)(this,"screenRightBoundary",void 0),(0,z.Z)(this,"screenBottomBoundary",void 0),(0,z.Z)(this,"gridRightBoundary",void 0),(0,z.Z)(this,"gridBottomBoundary",void 0),this.width=l,this.height=i,this.viewportPadding=Math.max(l,i),this.grid=new dn(l+this.viewportPadding,i+this.viewportPadding,25),this.screenRightBoundary=l+this.viewportPadding,this.screenBottomBoundary=i+this.viewportPadding,this.gridRightBoundary=l+2*this.viewportPadding,this.gridBottomBoundary=i+2*this.viewportPadding}return(0,q.Z)(n,[{key:"placeCollisionBox",value:function(i){var u=i.x1+i.anchorPointX+this.viewportPadding,f=i.y1+i.anchorPointY+this.viewportPadding,v=i.x2+i.anchorPointX+this.viewportPadding,b=i.y2+i.anchorPointY+this.viewportPadding;return!this.isInsideGrid(u,f,v,b)||this.grid.hitTest(u,f,v,b)?{box:[]}:{box:[u,f,v,b]}}},{key:"insertCollisionBox",value:function(i,u){this.grid.insert({featureIndex:u},i[0],i[1],i[2],i[3])}},{key:"project",value:function(i,u,f){var v=bo.al(u,f,0,1),b=bo.Ue(),P=jt.fromValues.apply(jt,(0,Ta.Z)(i));return bo.fF(b,v,P),{x:(b[0]/b[3]+1)/2*this.width+this.viewportPadding,y:(-b[1]/b[3]+1)/2*this.height+this.viewportPadding}}},{key:"isInsideGrid",value:function(i,u,f,v){return f>=0&&i<this.gridRightBoundary&&v>=0&&u<this.gridBottomBoundary}}]),n}();function yn(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return zi(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return zi(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,f=function(){};return{s:f,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(N){throw N},f}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var P,v=!0,b=!1;return{s:function(){i=i.call(n)},n:function(){var N=i.next();return v=N.done,N},e:function(N){b=!0,P=N},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(b)throw P}}}}function zi(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}function Mi(n){var l=.5,i=.5;switch(n){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0;break;default:l=.5}switch(n){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0;break;default:i=.5}return{horizontalAlign:l,verticalAlign:i}}function En(n,l,i,u,f){if(f){var v=n[u],b=v.glyph;if(b)for(var I=(n[u].x+l[b].advance*v.scale)*f,N=i;N<=u;N++)n[N].x-=I}}function Sn(n,l,i,u,f,v,b){var se,P=(l-i)*f,I=(-u*b+.5)*v,N=yn(n);try{for(N.s();!(se=N.n()).done;){var ie=se.value;ie.x+=P,ie.y+=I}}catch(Re){N.e(Re)}finally{N.f()}}function _i(n,l,i,u,f,v,b){var I=0,N=-8,se=0,ie=n.positionedGlyphs,Re="right"===v?1:"left"===v?0:.5,Je=ie.length;i.forEach(function(on){on.split("").forEach(function(Pn){var Hn=l[Pn];Hn&&(ie.push({glyph:Pn,x:I,y:N+0,vertical:!1,scale:1,metrics:Hn}),I+=Hn.advance+b)}),ie.length!==Je&&(se=Math.max(I-b,se),En(ie,l,Je,ie.length-1,Re)),I=0,N+=u});var It=Mi(f),Zt=It.horizontalAlign,Tr=It.verticalAlign;Sn(ie,Re,Zt,Tr,se,u,i.length);var Vr=N- -8;n.top+=-Tr*Vr,n.bottom=n.top+Vr,n.left+=-Zt*se,n.right=n.left+se}function Zi(n,l,i,u,f,v,b){var I=0,N=-8,se=0,ie=n.positionedGlyphs,Re="right"===v?1:"left"===v?0:.5,Je=ie.length;i.forEach(function(on){var mn=l[on];mn&&(ie.push({glyph:on,x:I,y:N+0,vertical:!1,scale:1,metrics:mn}),I+=mn.advance+b),ie.length!==Je&&(se=Math.max(I-b,se),En(ie,l,Je,ie.length-1,Re)),I=0,N+=u});var It=Mi(f),Zt=It.horizontalAlign,Tr=It.verticalAlign;Sn(ie,Re,Zt,Tr,se,u,i.length);var Vr=N- -8;n.top+=-Tr*Vr,n.bottom=n.top+Vr,n.left+=-Zt*se,n.right=n.left+se}function ds(n,l){(null==l||l>n.length)&&(l=n.length);for(var i=0,u=new Array(l);i<l;i++)u[i]=n[i];return u}var Uo='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 48.0\nuniform sampler2D u_sdf_map;\nuniform float u_gamma_scale : 0.5;\n// uniform float u_font_size : 24.0;\nuniform float u_opacity : 1.0;\nuniform vec4 u_stroke_color : [0, 0, 0, 1];\nuniform float u_stroke_width : 2.0;\nuniform float u_halo_blur : 0.5;\nuniform float u_DevicePixelRatio;\n\nvarying vec4 v_color;\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\nvoid main() {\n  // get style data mapping\n  float opacity = styleMappingMat[0][0];\n  float strokeWidth = styleMappingMat[0][2];\n  vec4 textrueStroke = vec4(\n    styleMappingMat[1][0],\n    styleMappingMat[1][1],\n    styleMappingMat[1][2],\n    styleMappingMat[1][3]\n  );\n\n  // get sdf from atlas\n  float dist = texture2D(u_sdf_map, v_uv).a;\n\n  // float fontScale = u_font_size / FONT_SIZE;\n\n  // lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;\n  lowp float buff = (6.0 - strokeWidth / v_fontScale) / SDF_PX;\n  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;\n\n  highp float gamma_scaled = gamma * v_gamma_scale;\n\n  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);\n  // gl_FragColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), vec4(u_stroke_color.rgb, u_stroke_color.a * u_opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor = mix(vec4(v_color.rgb, v_color.a * opacity), vec4(textrueStroke.rgb, textrueStroke.a * opacity), smoothstep(0., 0.5, 1. - dist));\n  gl_FragColor.a= gl_FragColor.a * alpha;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',ss='#define SDF_PX 8.0\n#define EDGE_GAMMA 0.105\n#define FONT_SIZE 24.0\nattribute vec3 a_Position;\nattribute vec2 a_tex;\nattribute vec2 a_textOffsets;\nattribute vec4 a_Color;\nattribute float a_Size;\nattribute float a_Rotate;\n\nuniform vec2 u_sdf_map_size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec2 v_uv;\nvarying float v_gamma_scale;\nvarying vec4 v_color;\nvarying float v_fontScale;\n\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\nuniform float u_opacity : 1;\nuniform float u_stroke_width : 2;\nuniform vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n#pragma include "styleMappingCalStrokeWidth"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n   styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n\n   vec2 strokeWidthAndOffset = calStrokeWidthAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][2] = strokeWidthAndOffset.r;\n  textureOffset = strokeWidthAndOffset.g;\n\n  vec4 textrueStroke = vec4(-1.0, -1.0, -1.0, -1.0);\n  if(hasStroke()) {\n    vec2 valueRPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][0] = pos2value(valueRPos, columnWidth, rowHeight); // R\n    textureOffset += 1.0;\n\n    vec2 valueGPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][1] = pos2value(valueGPos, columnWidth, rowHeight); // G\n    textureOffset += 1.0;\n\n    vec2 valueBPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][2] = pos2value(valueBPos, columnWidth, rowHeight); // B\n    textureOffset += 1.0;\n\n    vec2 valueAPos = nextPos(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset);\n    styleMappingMat[1][3] = pos2value(valueAPos, columnWidth, rowHeight); // A\n    textureOffset += 1.0;\n  } else {\n    if(u_stroke_color == vec4(0.0)) {\n      styleMappingMat[1][0] = v_color.r;\n      styleMappingMat[1][1] = v_color.g;\n      styleMappingMat[1][2] = v_color.b;\n      styleMappingMat[1][3] = v_color.a;\n    } else {\n      styleMappingMat[1][0] = u_stroke_color.r;\n      styleMappingMat[1][1] = u_stroke_color.g;\n      styleMappingMat[1][2] = u_stroke_color.b;\n      styleMappingMat[1][3] = u_stroke_color.a;\n    }\n  }\n  \n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  v_color = a_Color;\n  v_uv = a_tex / u_sdf_map_size;\n\n  // \u6587\u672c\u7f29\u653e\u6bd4\u4f8b\n  float fontScale = a_Size / FONT_SIZE;\n  v_fontScale = fontScale;\n\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  highp float angle_sin = sin(a_Rotate);\n  highp float angle_cos = cos(a_Rotate);\n  mat2 rotation_matrix = mat2(angle_cos, -1.0 * angle_sin, angle_sin, angle_cos);\n  \n  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n\n  vec4 projected_position;\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n   projected_position  = u_Mvp * (vec4(a_Position.xyz, 1.0));\n  } else { // else\n   projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);\n  v_gamma_scale = gl_Position.w;\n  setPickingColor(a_PickingColor);\n\n}\n';function ms(n){var l=this,i=n.id,u=[],f=[];if(!l.glyphInfoMap||!l.glyphInfoMap[i])return{vertices:[],indices:[],size:7};var v=l.glyphInfoMap[i].centroid,b=2===v.length?[v[0],v[1],0]:v;return l.glyphInfoMap[i].glyphQuads.forEach(function(P,I){u.push.apply(u,(0,Ta.Z)(b).concat([P.tex.x,P.tex.y+P.tex.height,P.tl.x,P.tl.y],(0,Ta.Z)(b),[P.tex.x+P.tex.width,P.tex.y+P.tex.height,P.tr.x,P.tr.y],(0,Ta.Z)(b),[P.tex.x+P.tex.width,P.tex.y,P.br.x,P.br.y],(0,Ta.Z)(b),[P.tex.x,P.tex.y,P.bl.x,P.bl.y])),f.push(0+4*I,1+4*I,2+4*I,2+4*I,3+4*I,0+4*I)}),{vertices:u,indices:f,size:7}}var us=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){var u;(0,X.Z)(this,i);for(var f=arguments.length,v=new Array(f),b=0;b<f;b++)v[b]=arguments[b];return u=l.call.apply(l,[this].concat(v)),(0,z.Z)((0,te.Z)(u),"glyphInfo",void 0),(0,z.Z)((0,te.Z)(u),"glyphInfoMap",{}),(0,z.Z)((0,te.Z)(u),"texture",void 0),(0,z.Z)((0,te.Z)(u),"currentZoom",-1),(0,z.Z)((0,te.Z)(u),"extent",void 0),(0,z.Z)((0,te.Z)(u),"textureHeight",0),(0,z.Z)((0,te.Z)(u),"textCount",0),(0,z.Z)((0,te.Z)(u),"preTextStyle",{}),(0,z.Z)((0,te.Z)(u),"buildModels",function(){return u.initGlyph(),u.updateTexture(),u.filterGlyphs(),u.reBuildModel(),[u.layer.buildLayerModel({moduleName:"pointText",vertexShader:ss,fragmentShader:Uo,triangulation:ms.bind((0,te.Z)(u)),depth:{enable:!1},blend:u.getBlend()})]}),u}return(0,q.Z)(i,[{key:"getUninforms",value:function(){var f=this.layer.getLayerConfig(),v=f.opacity,b=void 0===v?1:v,P=f.stroke,I=void 0===P?"#fff":P,N=f.strokeWidth,se=void 0===N?0:N,ie=f.textAnchor,Re=void 0===ie?"center":ie,Je=f.textAllowOverlap,It=void 0!==Je&&Je,Zt=f.halo,Tr=void 0===Zt?.5:Zt,Vr=f.gamma,on=void 0===Vr?2:Vr,mn=this.fontService,Pn=mn.canvas,Hn=mn.mapping;if(Object.keys(Hn).length!==this.textCount&&(this.updateTexture(),this.textCount=Object.keys(Hn).length),this.preTextStyle={textAnchor:Re,textAllowOverlap:It},this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:b,strokeWidth:se,stroke:I})){this.judgeStyleAttributes({opacity:b,strokeWidth:se,stroke:I});var ei=this.layer.getEncodedData(),ti=this.calDataFrame(this.cellLength,ei,this.cellProperties),Ui=ti.data,Sa=ti.width,Ua=ti.height;this.rowCount=Ua,this.dataTexture=this.createTexture2D(this.cellLength>0&&Ui.length>0?{flipY:!0,data:Ui,format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:Sa,height:Ua}:{flipY:!0,data:[1],format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(b)?b:1,u_stroke_width:ca()(se)?se:0,u_stroke_color:this.getStrokeColor(I),u_sdf_map:this.texture,u_halo_blur:Tr,u_gamma_scale:on,u_sdf_map_size:[Pn.width,Pn.height]}}},{key:"initModels",value:function(){this.layer.on("remapping",this.buildModels),this.extent=this.textExtent();var f=this.layer.getLayerConfig(),v=f.textAnchor,P=f.textAllowOverlap;return this.preTextStyle={textAnchor:void 0===v?"center":v,textAllowOverlap:void 0===P||P},this.buildModels()}},{key:"needUpdate",value:function(){var v=this.layer.getLayerConfig().textAllowOverlap,b=void 0!==v&&v,P=this.mapService.getZoom(),I=this.mapService.getBounds(),N=(0,tt.oO)(this.extent,I);return(!b&&(Math.abs(this.currentZoom-P)>1||!N)||b!==this.preTextStyle.textAllowOverlap)&&(this.reBuildModel(),!0)}},{key:"clearModels",value:function(){var f;null===(f=this.dataTexture)||void 0===f||f.destroy(),this.layer.off("remapping",this.buildModels)}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"rotate",type:Z.AttributeType.Attribute,descriptor:{name:"a_Rotate",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(v,b,P,I){var N=v.rotate,se=void 0===N?0:N;return Array.isArray(se)?[se[0]]:[se]}}}),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Z.AttributeType.Attribute,descriptor:{name:"a_textOffsets",buffer:{usage:Z.gl.STATIC_DRAW,data:[],type:Z.gl.FLOAT},size:2,update:function(v,b,P,I){return[P[5],P[6]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Z.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(v,b,P,I){var N=v.size,se=void 0===N?12:N;return Array.isArray(se)?[se[0]]:[se]}}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Z.AttributeType.Attribute,descriptor:{name:"a_tex",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:2,update:function(v,b,P,I){return[P[3],P[4]]}}})}},{key:"textExtent",value:function(){var f=this.mapService.getBounds();return(0,tt.yA)(f,.5)}},{key:"initTextFont",value:function(){var f=this.layer.getLayerConfig(),v=f.fontWeight,b=void 0===v?"400":v,P=f.fontFamily,I=void 0===P?"sans-serif":P,N=this.layer.getEncodedData(),se=[];N.forEach(function(ie){var Zt,Re=ie.shape,Je=void 0===Re?"":Re,It=function(n,l){var i="undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(!i){if(Array.isArray(n)||(i=function(n,l){if(n){if("string"==typeof n)return ds(n,l);var i=Object.prototype.toString.call(n).slice(8,-1);if("Object"===i&&n.constructor&&(i=n.constructor.name),"Map"===i||"Set"===i)return Array.from(n);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return ds(n,l)}}(n))||l&&n&&"number"==typeof n.length){i&&(n=i);var u=0,f=function(){};return{s:f,n:function(){return u>=n.length?{done:!0}:{done:!1,value:n[u++]}},e:function(N){throw N},f}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var P,v=!0,b=!1;return{s:function(){i=i.call(n)},n:function(){var N=i.next();return v=N.done,N},e:function(N){b=!0,P=N},f:function(){try{!v&&null!=i.return&&i.return()}finally{if(b)throw P}}}}(Je=Je.toString());try{for(It.s();!(Zt=It.n()).done;){var Tr=Zt.value;-1===se.indexOf(Tr)&&se.push(Tr)}}catch(Vr){It.e(Vr)}finally{It.f()}}),this.fontService.setFontOptions({characterSet:se,fontWeight:b,fontFamily:I,iconfont:!1})}},{key:"initIconFontTex",value:function(){var f=this.layer.getLayerConfig(),v=f.fontWeight,b=void 0===v?"400":v,P=f.fontFamily,I=void 0===P?"sans-serif":P,N=this.layer.getEncodedData(),se=[];N.forEach(function(ie){var Re=ie.shape,Je=void 0===Re?"":Re;Je=Je.toString(),-1===se.indexOf(Je)&&se.push(Je)}),this.fontService.setFontOptions({characterSet:se,fontWeight:b,fontFamily:I,iconfont:!0})}},{key:"generateGlyphLayout",value:function(f){var v=this,b=this.fontService.mapping,P=this.layer.getLayerConfig(),I=P.spacing,N=void 0===I?2:I,se=P.textAnchor,ie=void 0===se?"center":se,Re=this.layer.getEncodedData();this.glyphInfo=Re.map(function(Je){var It=Je.shape,Tr=Je.id,Vr=Je.size,on=void 0===Vr?1:Vr,mn=Je.textOffset,Pn=void 0===mn?[0,0]:mn,Hn=function(n,l,i,u,f,v){var b=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[0,0],P=arguments.length>7?arguments[7]:void 0,I=n.split("\n"),N=[],se={positionedGlyphs:N,top:b[1],bottom:b[1],left:b[0],right:b[0],lineCount:I.length,text:n};return P?Zi(se,l,I,i,u,f,v):_i(se,l,I,i,u,f,v),!!N.length&&se}((void 0===It?"":It).toString(),b,on,ie,"center",N,Pn,f),ei=function(n){var P,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],i=arguments.length>2?arguments[2]:void 0,u=n.positionedGlyphs,v=[],b=yn(void 0===u?[]:u);try{for(b.s();!(P=b.n()).done;){var I=P.value,N=I.metrics,se=4,ie=N.advance*I.scale/2,Je=i?[0,0]:[I.x+ie+l[0],I.y+l[1]],It=(0-se)*I.scale-ie+Je[0],Zt=(0-se)*I.scale+Je[1],Tr=It+N.width*I.scale,Vr=Zt+N.height*I.scale;v.push({tl:{x:It,y:Zt},tr:{x:Tr,y:Zt},bl:{x:It,y:Vr},br:{x:Tr,y:Vr},tex:N,glyphOffset:i?[I.x+ie,I.y]:[0,0]})}}catch(ei){b.e(ei)}finally{b.f()}return v}(Hn,Pn,!1);return Je.shaping=Hn,Je.glyphQuads=ei,Je.centroid=tf(Je.coordinates),Je.originCentroid="GAODE2.x"===Je.version?tf(Je.originCoordinates):Je.originCentroid=Je.centroid,v.glyphInfoMap[Tr]={shaping:Hn,glyphQuads:ei,centroid:tf(Je.coordinates)},Je})}},{key:"filterGlyphs",value:function(){var f=this,v=this.layer.getLayerConfig(),b=v.padding,P=void 0===b?[4,4]:b,I=v.textAllowOverlap;if(void 0===I||!I){this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();var se=this.rendererService.getViewportSize(),Je=new Jr(se.width,se.height);this.glyphInfo.filter(function(Zt){var Tr=Zt.shaping,Vr=Zt.id,on=void 0===Vr?0:Vr,Hn=Zt.size/24,ei=f.mapService.lngLatToContainer("GAODE2.x"===Zt.version?Zt.originCentroid:Zt.centroid),Ui=Je.placeCollisionBox({x1:Tr.left*Hn-P[0],x2:Tr.right*Hn+P[0],y1:Tr.top*Hn-P[1],y2:Tr.bottom*Hn+P[1],anchorPointX:ei.x,anchorPointY:ei.y}).box;return!(!Ui||!Ui.length||(Je.insertCollisionBox(Ui,on),0))}).forEach(function(Zt){f.glyphInfoMap[Zt.id]=Zt})}}},{key:"initGlyph",value:function(){var v=this.layer.getLayerConfig().iconfont,b=void 0!==v&&v;b?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(b)}},{key:"updateTexture",value:function(){var f=this.rendererService.createTexture2D,v=this.fontService.canvas;this.textureHeight=v.height,this.texture&&this.texture.destroy(),this.texture=f({data:v,mag:Z.gl.LINEAR,min:Z.gl.LINEAR,width:v.width,height:v.height})}},{key:"reBuildModel",value:function(){this.filterGlyphs(),this.layer.models=[this.layer.buildLayerModel({moduleName:"pointText",vertexShader:ss,fragmentShader:Uo,triangulation:ms.bind(this),depth:{enable:!1},blend:this.getBlend()})]}}]),i}(Mu);const Hi={fill:tr,image:Bt,normal:tn,extrude:V,text:us,icon:qr};var uo=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){var u;(0,X.Z)(this,i);for(var f=arguments.length,v=new Array(f),b=0;b<f;b++)v[b]=arguments[b];return u=l.call.apply(l,[this].concat(v)),(0,z.Z)((0,te.Z)(u),"type","PointLayer"),u}return(0,q.Z)(i,[{key:"buildModels",value:function(){var f=this.getModelType();this.layerModel=new Hi[f](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getDefaultConfig",value:function(){return{normal:{blend:"additive"},fill:{blend:"normal"},extrude:{},image:{},icon:{},text:{blend:"normal"}}[this.getModelType()]}},{key:"getModelType",value:function(){var f=this.getEncodedData(),v=this.getLayerConfig(),b=v.shape2d,P=v.shape3d,I=this.iconService.getIconMap(),N=f.find(function(ie){return ie.hasOwnProperty("shape")});if(N){var se=N.shape;return"dot"===se?"normal":-1!==(null==b?void 0:b.indexOf(se))?"fill":-1!==(null==P?void 0:P.indexOf(se))?"extrude":I.hasOwnProperty(se)?"image":""!==this.fontService.getGlyph(se)?"icon":"text"}return"normal"}}]),i}(Jc);var Pl={solid:0,dash:1},Ye=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){var u;(0,X.Z)(this,i);for(var f=arguments.length,v=new Array(f),b=0;b<f;b++)v[b]=arguments[b];return u=l.call.apply(l,[this].concat(v)),(0,z.Z)((0,te.Z)(u),"texture",void 0),(0,z.Z)((0,te.Z)(u),"updateTexture",function(){var P=u.rendererService.createTexture2D;if(u.texture)return u.texture.update({data:u.iconService.getCanvas()}),void u.layer.render();u.texture=P({data:u.iconService.getCanvas(),mag:Z.gl.NEAREST,min:Z.gl.NEAREST,premultiplyAlpha:!1,width:1024,height:u.iconService.canvasHeight||128})}),u}return(0,q.Z)(i,[{key:"getUninforms",value:function(){var f=this.layer.getLayerConfig(),v=f.opacity,b=f.sourceColor,P=f.targetColor,I=f.textureBlend,N=void 0===I?"normal":I,se=f.lineType,ie=void 0===se?"solid":se,Re=f.dashArray,Je=void 0===Re?[10,5,0,0]:Re,It=f.lineTexture,Zt=void 0!==It&&It,Tr=f.iconStep,Vr=void 0===Tr?100:Tr;2===Je.length&&Je.push(0,0),this.rendererService.getDirty()&&this.texture.bind();var on=0,mn=[0,0,0,0],Pn=[0,0,0,0];if(b&&P&&(mn=(0,tt.CI)(b),Pn=(0,tt.CI)(P),on=1),this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:v})){this.judgeStyleAttributes({opacity:v});var Hn=this.layer.getEncodedData(),ei=this.calDataFrame(this.cellLength,Hn,this.cellProperties),ti=ei.data,Ui=ei.width,Sa=ei.height;this.rowCount=Sa,this.dataTexture=this.createTexture2D(this.cellLength>0&&ti.length>0?{flipY:!0,data:ti,format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:Ui,height:Sa}:{flipY:!0,data:[1],format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(v)?v:1,u_textureBlend:"normal"===N?0:1,u_line_type:Pl[ie],u_dash_array:Je,u_texture:this.texture,u_line_texture:Zt?1:0,u_icon_step:Vr,u_textSize:[1024,this.iconService.canvasHeight||128],u_linearColor:on,u_sourceColor:mn,u_targetColor:Pn}}},{key:"getAnimateUniforms",value:function(){var f=this.layer.getLayerConfig();return{u_aimate:this.animateOption2Array(f.animateOption),u_time:this.layer.getLayerAnimateTime()}}},{key:"initModels",value:function(){return this.updateTexture(),this.iconService.on("imageUpdate",this.updateTexture),this.buildModels()}},{key:"clearModels",value:function(){var f,v;null===(f=this.texture)||void 0===f||f.destroy(),null===(v=this.dataTexture)||void 0===v||v.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"line",vertexShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n\nattribute float a_Miter;\nattribute vec4 a_Color;\nattribute vec2 a_Size;\nattribute vec3 a_Normal;\nattribute vec3 a_Position;\n\nattribute vec2 a_iconMapUV;\n\n// dash line\nattribute float a_Total_Distance;\nattribute float a_Distance;\n\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\nuniform float u_line_type: 0.0;\nuniform vec4 u_dash_array: [10.0, 5., 0, 0];\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ];\nuniform float u_icon_step: 100;\n\n#pragma include "projection"\n#pragma include "picking"\n\nvarying vec4 v_color;\nvarying vec4 v_dash_array;\nvarying vec2 v_normal;\n\nvarying vec4 v_dataset; // \u6570\u636e\u96c6 - distance_ratio/distance/pixelLen/texV\n// texV \u7ebf\u56fe\u5c42 - \u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\uff08\u7ebf\u7684\u5bbd\u5ea6\u65b9\u5411\uff09\nvarying vec2 v_iconMapUV;\nuniform float u_linearColor: 0;\n\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  float d_distance_ratio; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n  float d_texPixelLen;    // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n\n  v_iconMapUV = a_iconMapUV;\n  d_texPixelLen = project_pixel(u_icon_step);\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) {\n    d_texPixelLen *= 10.0;\n  }\n\n  if(u_line_type == LineTypeDash) {\n    d_distance_ratio = a_Distance / a_Total_Distance;\n    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;\n  }\n  if(u_aimate.x == Animate || u_linearColor == 1.0) {\n      d_distance_ratio = a_Distance / a_Total_Distance;\n  }\n  v_normal = vec2(reverse_offset_normal(a_Normal) * sign(a_Miter));\n\n\n  v_color = a_Color;\n\n  vec3 size = a_Miter * setPickingSize(a_Size.x) * reverse_offset_normal(a_Normal);\n\n  vec2 offset = project_pixel(size.xy);\n\n  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // \u7ebf\u6a2a\u5411\u504f\u79fb\u7684\u8ddd\u79bb\uff08\u5411\u4e24\u4fa7\u504f\u79fb\u7684\u548c\uff09\n  float linePixelSize = project_pixel(a_Size.x) * 2.0;  // \u5b9a\u70b9\u4f4d\u7f6e\u504f\u79fb\uff0c\u6309\u5730\u56fe\u7b49\u7ea7\u7f29\u653e\u540e\u7684\u8ddd\u79bb \u5355\u4fa7 * 2\n  float texV = lineOffsetWidth/linePixelSize; // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n  // \u8bbe\u7f6e\u6570\u636e\u96c6\u7684\u53c2\u6570\n  v_dataset.r = d_distance_ratio; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n  v_dataset.g = a_Distance;       // \u5f53\u524d\u9876\u70b9\u7684\u8ddd\u79bb\n  v_dataset.b = d_texPixelLen;    // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n  v_dataset.a = texV;             // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0));\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y, 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xy + offset, a_Size.y / 8.0, 1.0)); // \u989d\u5916\u9664 8.0 \u662f\u4e3a\u4e86\u548cgaode1.x\u7684\u9ad8\u5ea6\u517c\u5bb9\n  } else {\n    float lineHeight = a_Size.y;\n    // \u517c\u5bb9 mapbox \u5728\u7ebf\u9ad8\u5ea6\u4e0a\u7684\u6548\u679c\u8868\u73b0\u57fa\u672c\u4e00\u81f4\n    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {\n      lineHeight = lineHeight*2.0/pow(2.0, 20.0 - u_Zoom);\n    }\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, lineHeight, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'#define LineTypeSolid 0.0\n#define LineTypeDash 1.0\n#define Animate 0.0\n#define LineTexture 1.0\nuniform float u_blur : 0.99;\nuniform float u_line_type: 0.0;\nuniform float u_opacity : 1.0;\nuniform float u_textureBlend;\nvarying vec4 v_color;\nvarying vec2 v_normal;\n\n// line texture\nuniform float u_line_texture;\nuniform sampler2D u_texture;\nuniform vec2 u_textSize;\n\n// dash\nuniform float u_dash_offset : 0.0;\nuniform float u_dash_ratio : 0.1;\nvarying vec4 v_dash_array;\n\nvarying vec4 v_dataset; // \u6570\u636e\u96c6 - distance_ratio/distance/pixelLen/texV\n\nvarying vec2 v_iconMapUV;\n\nuniform float u_linearColor: 0;\nuniform vec4 u_sourceColor;\nuniform vec4 u_targetColor;\n\n#pragma include "picking"\n\nuniform float u_time;\nuniform vec4 u_aimate: [ 0, 2., 1.0, 0.2 ]; // \u63a7\u5236\u8fd0\u52a8\n\nvarying mat4 styleMappingMat;\n// [animate, duration, interval, trailLength],\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  float animateSpeed = 0.0; // \u8fd0\u52a8\u901f\u5ea6\n  float d_distance_ratio = v_dataset.r; // \u5f53\u524d\u70b9\u4f4d\u8ddd\u79bb\u5360\u7ebf\u603b\u957f\u7684\u6bd4\u4f8b\n\n  if(u_linearColor == 1.0) { // \u4f7f\u7528\u6e10\u53d8\u989c\u8272\n    gl_FragColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);\n  } else { // \u4f7f\u7528 color \u65b9\u6cd5\u4f20\u5165\u7684\u989c\u8272\n     gl_FragColor = v_color;\n  }\n\n  // anti-alias\n  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));\n  gl_FragColor.a *= opacity; // \u5168\u5c40\u900f\u660e\u5ea6\n  if(u_aimate.x == Animate) {\n      animateSpeed = u_time / u_aimate.y;\n       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_aimate.z)* (1.0/ u_aimate.z) + animateSpeed);\n      alpha = (alpha + u_aimate.w -1.0) / u_aimate.w;\n      alpha = smoothstep(0., 1., alpha);\n      gl_FragColor.a *= alpha;\n  }\n // dash line\n  if(u_line_type == LineTypeDash) {\n    float flag = 0.;\n    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);\n    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {\n      flag = 1.;\n    }\n    gl_FragColor.a *=flag;\n  }\n\n  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture\n    float aDistance = v_dataset.g;      // \u5f53\u524d\u9876\u70b9\u7684\u8ddd\u79bb\n    float d_texPixelLen = v_dataset.b;  // \u8d34\u56fe\u7684\u50cf\u7d20\u957f\u5ea6\uff0c\u6839\u636e\u5730\u56fe\u5c42\u7ea7\u7f29\u653e\n    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);\n    float v = v_dataset.a;  // \u7ebf\u56fe\u5c42\u8d34\u56fe\u90e8\u5206\u7684 v \u5750\u6807\u503c\n\n    v = max(smoothstep(0.95, 1.0, v), v);\n    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, vec2(u, v)));\n    // gl_FragColor = filterColor(gl_FragColor + texture2D(u_texture, uv));\n     vec4 pattern = texture2D(u_texture, uv);\n\n    if(u_textureBlend == 0.0) { // normal\n      pattern.a = 0.0;\n      gl_FragColor = filterColor(gl_FragColor + pattern);\n    } else { // replace\n        pattern.a *= opacity;\n        if(gl_FragColor.a <= 0.0) {\n          pattern.a = 0.0;\n        }\n        gl_FragColor = filterColor(pattern);\n    }\n  } else {\n    gl_FragColor = filterColor(gl_FragColor);\n  }\n  // gl_FragColor = filterColor(vec4(1.0, 0.0, 0.0, 1.0));\n \n  // if(rV < r || rV > 1.0 - r) {\n  //   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);\n  // } \n  // if(v > 0.9) {\n  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);\n  // } else if(v < 0.1) {\n  //   gl_FragColor = vec4(0.17647, 0.43921568, 0.2, 1.0);\n  // }\n\n  // gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:Ph,primitive:Z.gl.TRIANGLES,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"registerBuiltinAttributes",value:function(){var f=this;this.layer.getLayerConfig(),this.styleAttributeService.registerStyleAttribute({name:"distance",type:Z.AttributeType.Attribute,descriptor:{name:"a_Distance",buffer:{usage:Z.gl.STATIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(N,se,ie,Re){return[ie[3]]}}}),this.styleAttributeService.registerStyleAttribute({name:"total_distance",type:Z.AttributeType.Attribute,descriptor:{name:"a_Total_Distance",buffer:{usage:Z.gl.STATIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(N,se,ie,Re){return[ie[5]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Z.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:2,update:function(N,se,ie,Re){var Je=N.size,It=void 0===Je?1:Je;return Array.isArray(It)?[It[0],It[1]]:[It,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Z.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Z.gl.STATIC_DRAW,data:[],type:Z.gl.FLOAT},size:3,update:function(N,se,ie,Re,Je){return Je}}}),this.styleAttributeService.registerStyleAttribute({name:"miter",type:Z.AttributeType.Attribute,descriptor:{name:"a_Miter",buffer:{usage:Z.gl.STATIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(N,se,ie,Re){return[ie[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Z.AttributeType.Attribute,descriptor:{name:"a_iconMapUV",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:2,update:function(N,se,ie,Re){var Zt=f.iconService.getIconMap()[N.texture]||{x:0,y:0};return[Zt.x,Zt.y]}}})}},{key:"loadImage",value:function(f){return new Promise(function(v,b){if(f instanceof HTMLImageElement)v(f);else{var P=new Image;P.crossOrigin="anonymous",P.onload=function(){v(P)},P.onerror=function(){b(new Error("Could not load image at "+f))},P.src=f instanceof File?URL.createObjectURL(f):f}})}}]),i}(Mu);var Ne=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){return(0,X.Z)(this,i),l.apply(this,arguments)}return(0,q.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,b=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:b})){this.judgeStyleAttributes({opacity:b});var P=this.layer.getEncodedData(),I=this.calDataFrame(this.cellLength,P,this.cellProperties),N=I.data,se=I.width,ie=I.height;this.rowCount=ie,this.dataTexture=this.createTexture2D(this.cellLength>0&&N.length>0?{flipY:!0,data:N,format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:se,height:ie}:{flipY:!0,data:[1],format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(b)?b:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygonExtrude",vertexShader:'precision highp float;\n\n#define ambientRatio 0.5\n#define diffuseRatio 0.3\n#define specularRatio 0.2\n\nattribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "light"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  styleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);\n  vec4 project_pos = project_position(pos);\n\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    // gl_Position = u_Mvp * (vec4(project_pos.xyz * vec3(1.0, 1.0, -1.0), 1.0));\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  float lightWeight = calc_lighting(pos);\n  // v_Color = a_Color;\n  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w);\n\n  setPickingColor(a_PickingColor);\n}\n',fragmentShader:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:np})]}},{key:"clearModels",value:function(){var f;null===(f=this.dataTexture)||void 0===f||f.destroy()}},{key:"registerBuiltinAttributes",value:function(){this.styleAttributeService.registerStyleAttribute({name:"normal",type:Z.AttributeType.Attribute,descriptor:{name:"a_Normal",buffer:{usage:Z.gl.STATIC_DRAW,data:[],type:Z.gl.FLOAT},size:3,update:function(v,b,P,I,N){return N}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Z.AttributeType.Attribute,descriptor:{name:"a_Size",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(v,b,P,I){var N=v.size,se=void 0===N?10:N;return Array.isArray(se)?[se[0]]:[se]}}})}}]),i}(Mu);const ut={fill:function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){return(0,X.Z)(this,i),l.apply(this,arguments)}return(0,q.Z)(i,[{key:"getUninforms",value:function(){var v=this.layer.getLayerConfig().opacity,b=void 0===v?1:v;if(this.dataTextureTest&&this.dataTextureNeedUpdate({opacity:b})){this.judgeStyleAttributes({opacity:b});var P=this.layer.getEncodedData(),I=this.calDataFrame(this.cellLength,P,this.cellProperties),N=I.data,se=I.width,ie=I.height;this.rowCount=ie,this.dataTexture=this.createTexture2D(this.cellLength>0&&N.length>0?{flipY:!0,data:N,format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:se,height:ie}:{flipY:!0,data:[1],format:Z.gl.LUMINANCE,type:Z.gl.FLOAT,width:1,height:1})}return{u_dataTexture:this.dataTexture,u_cellTypeLayout:this.getCellTypeLayout(),u_opacity:ca()(b)?b:1}}},{key:"initModels",value:function(){return this.buildModels()}},{key:"buildModels",value:function(){return[this.layer.buildLayerModel({moduleName:"polygon",vertexShader:'attribute vec4 a_Color;\nattribute vec3 a_Position;\nattribute vec3 a_Normal;\nattribute float a_Size;\nuniform mat4 u_ModelMatrix;\nuniform mat4 u_Mvp;\n\nvarying vec4 v_Color;\nuniform float u_opacity: 1.0;\nvarying mat4 styleMappingMat; // \u7528\u4e8e\u5c06\u5728\u9876\u70b9\u7740\u8272\u5668\u4e2d\u8ba1\u7b97\u597d\u7684\u6837\u5f0f\u503c\u4f20\u9012\u7ed9\u7247\u5143\n\n#pragma include "styleMapping"\n#pragma include "styleMappingCalOpacity"\n\n#pragma include "projection"\n#pragma include "picking"\n\nvoid main() {\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\nstyleMappingMat = mat4(\n    0.0, 0.0, 0.0, 0.0, // opacity - strokeOpacity - strokeWidth - empty\n    0.0, 0.0, 0.0, 0.0, // strokeR - strokeG - strokeB - strokeA\n    0.0, 0.0, 0.0, 0.0, // offsets[0] - offsets[1]\n    0.0, 0.0, 0.0, 0.0\n  );\n\n  float rowCount = u_cellTypeLayout[0][0];    // \u5f53\u524d\u7684\u6570\u636e\u7eb9\u7406\u6709\u51e0\u884c\n  float columnCount = u_cellTypeLayout[0][1]; // \u5f53\u770b\u5230\u6570\u636e\u7eb9\u7406\u6709\u51e0\u5217\n  float columnWidth = 1.0/columnCount;  // \u5217\u5bbd\n  float rowHeight = 1.0/rowCount;       // \u884c\u9ad8\n  float cellCount = calCellCount(); // opacity - strokeOpacity - strokeWidth - stroke - offsets\n  float id = a_vertexId; // \u7b2cn\u4e2a\u9876\u70b9\n  float cellCurrentRow = floor(id * cellCount / columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u884c\n  float cellCurrentColumn = mod(id * cellCount, columnCount) + 1.0; // \u8d77\u59cb\u70b9\u5728\u7b2c\u51e0\u5217\n  \n  // cell \u56fa\u5b9a\u987a\u5e8f opacity -> strokeOpacity -> strokeWidth -> stroke ... \n  // \u6309\u987a\u5e8f\u4ece cell \u4e2d\u53d6\u503c\u3001\u82e5\u6ca1\u6709\u5219\u81ea\u52a8\u5f80\u4e0b\u53d6\u503c\n  float textureOffset = 0.0; // \u5728 cell \u4e2d\u53d6\u503c\u7684\u504f\u79fb\u91cf\n\n  vec2 opacityAndOffset = calOpacityAndOffset(cellCurrentRow, cellCurrentColumn, columnCount, textureOffset, columnWidth, rowHeight);\n  styleMappingMat[0][0] = opacityAndOffset.r;\n  textureOffset = opacityAndOffset.g;\n  // cal style mapping - \u6570\u636e\u7eb9\u7406\u6620\u5c04\u90e8\u5206\u7684\u8ba1\u7b97\n\n  v_Color = a_Color;\n  vec4 project_pos = project_position(vec4(a_Position, 1.0));\n  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n\n  if(u_CoordinateSystem == COORDINATE_SYSTEM_P20_2) { // gaode2.x\n    gl_Position = u_Mvp * (vec4(project_pos.xyz, 1.0));\n  } else {\n    gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));\n  }\n\n  setPickingColor(a_PickingColor);\n}\n\n',fragmentShader:'uniform float u_opacity: 1.0;\nvarying vec4 v_Color;\nvarying mat4 styleMappingMat; // \u4f20\u9012\u4ece\u7247\u5143\u4e2d\u4f20\u9012\u7684\u6620\u5c04\u6570\u636e\n\n#pragma include "picking"\n\nvoid main() {\n  float opacity = styleMappingMat[0][0];\n  gl_FragColor = v_Color;\n  // gl_FragColor.a *= u_opacity;\n  gl_FragColor.a *= opacity;\n  gl_FragColor = filterColor(gl_FragColor);\n}\n',triangulation:Ap,blend:this.getBlend(),depth:{enable:!1}})]}},{key:"clearModels",value:function(){var f;null===(f=this.dataTexture)||void 0===f||f.destroy()}},{key:"registerBuiltinAttributes",value:function(){}}]),i}(Mu),line:Ye,extrude:Ne,text:us,point_fill:tr,point_image:Bt,point_normal:tn,point_extrude:V};var Nt,Gt,zr,sn,un,_n,an,Yn,In,Ze=function(n){(0,Y.Z)(i,n);var l=function(n){var l=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(n){return!1}}();return function(){var f,u=(0,et.Z)(n);if(l){var v=(0,et.Z)(this).constructor;f=Reflect.construct(u,arguments,v)}else f=u.apply(this,arguments);return(0,Xe.Z)(this,f)}}(i);function i(){var u;(0,X.Z)(this,i);for(var f=arguments.length,v=new Array(f),b=0;b<f;b++)v[b]=arguments[b];return u=l.call.apply(l,[this].concat(v)),(0,z.Z)((0,te.Z)(u),"type","PolygonLayer"),u}return(0,q.Z)(i,[{key:"buildModels",value:function(){var f=this.getModelType();this.layerModel=new ut[f](this),this.models=this.layerModel.initModels()}},{key:"rebuildModels",value:function(){this.models=this.layerModel.buildModels()}},{key:"getConfigSchema",value:function(){return{properties:{opacity:{type:"number",minimum:0,maximum:1}}}}},{key:"getModelType",value:function(){var f,v=this.styleAttributeService.getLayerStyleAttribute("shape"),b=null==v||null===(f=v.scale)||void 0===f?void 0:f.field;return"fill"===b?"fill":"extrude"===b?"extrude":"line"===b?"line":this.getPointModelType()}},{key:"getPointModelType",value:function(){var f=this.getEncodedData(),v=this.getLayerConfig(),b=v.shape2d,P=v.shape3d,I=this.iconService.getIconMap(),N=f.find(function(ie){return ie.hasOwnProperty("shape")});if(N){var se=N.shape;return"dot"===se?"point_normal":-1!==(null==b?void 0:b.indexOf(se))?"point_fill":-1!==(null==P?void 0:P.indexOf(se))?"point_extrude":I.hasOwnProperty(se)?"point_image":"text"}return"fill"}}]),i}(Jc);function Vn(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}var qa,Gn=(Nt=(0,va.b2)(),Gt=(0,va.f3)(Z.vK.IGlobalConfigService),zr=(0,va.f3)(Z.vK.IMapService),sn=(0,va.f3)(Z.vK.IFontService),Nt((_n=function(){function n(){(0,X.Z)(this,n),(0,G.Z)(this,"configService",an,this),(0,G.Z)(this,"mapService",Yn,this),(0,G.Z)(this,"fontService",In,this)}return(0,q.Z)(n,[{key:"apply",value:function(i,u){var f=this,v=u.styleAttributeService;i.hooks.init.tap("DataMappingPlugin",function(){f.generateMaping(i,{styleAttributeService:v})}),i.hooks.beforeRenderData.tap("DataMappingPlugin",function(){return i.dataState.dataMappingNeedUpdate=!1,f.generateMaping(i,{styleAttributeService:v}),!0}),i.hooks.beforeRender.tap("DataMappingPlugin",function(){if(!i.layerModelNeedUpdate){var b=v.getLayerStyleAttributes()||[],P=v.getLayerStyleAttribute("filter"),I=i.getSource().data.dataArray,N=b.filter(function(ie){return ie.needRemapping}),se=I;null!=P&&P.needRemapping&&null!=P&&P.scale&&(se=I.filter(function(ie){return f.applyAttributeMapping(P,ie)[0]})),N.length&&(null!=P&&P.needRemapping?(i.setEncodedData(f.mapping(b,se)),P.needRemapping=!1):i.setEncodedData(f.mapping(N,se,i.getEncodedData())),i.emit("remapping",null))}})}},{key:"generateMaping",value:function(i,u){var f=this,v=u.styleAttributeService,b=v.getLayerStyleAttributes()||[],P=v.getLayerStyleAttribute("filter"),I=i.getSource().data.dataArray,N=I;null!=P&&P.scale&&(N=I.filter(function(se){return f.applyAttributeMapping(P,se)[0]})),i.setEncodedData(this.mapping(b,N))}},{key:"mapping",value:function(i,u,f){var v=this,b=u.map(function(P,I){var se=function(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Vn(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Vn(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}({id:P._id,coordinates:P.coordinates},f?f[I]:{});return i.filter(function(ie){return void 0!==ie.scale}).forEach(function(ie){var Re=v.applyAttributeMapping(ie,P);ie.needRemapping=!1,"color"===ie.name&&(Re=Re.map(function(Je){return(0,tt.CI)(Je)})),se[ie.name]=Array.isArray(Re)&&1===Re.length?Re[0]:Re,"shape"===ie.name&&(se.shape=v.fontService.getIconFontKey(se[ie.name]))}),se});return b.length>0&&"GAODE2.x"===this.mapService.version&&("number"==typeof b[0].coordinates[0]?b.filter(function(P){return!P.originCoordinates}).map(function(P){P.version="GAODE2.x",P.originCoordinates=Po()(P.coordinates),P.coordinates=v.mapService.lngLatToCoord(P.coordinates)}):b.filter(function(P){return!P.originCoordinates}).map(function(P){P.version="GAODE2.x",P.originCoordinates=Po()(P.coordinates),P.coordinates=v.mapService.lngLatToCoords(P.coordinates)})),b}},{key:"applyAttributeMapping",value:function(i,u){var f;if(!i.scale)return[];var v=(null==i||null===(f=i.scale)||void 0===f?void 0:f.scalers)||[],b=[];return v.forEach(function(P){var I,N=P.field;(u.hasOwnProperty(N)||"variable"===(null===(I=i.scale)||void 0===I?void 0:I.type))&&b.push(u[N])}),i.mapping?i.mapping(b):[]}}]),n}(),an=(0,Ve.Z)(_n.prototype,"configService",[Gt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yn=(0,Ve.Z)(_n.prototype,"mapService",[zr],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=(0,Ve.Z)(_n.prototype,"fontService",[sn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),un=_n))||un),jo=(0,va.b2)()(qa=function(){function n(){(0,X.Z)(this,n),(0,z.Z)(this,"mapService",void 0)}return(0,q.Z)(n,[{key:"apply",value:function(i){var u=this;this.mapService=i.getContainer().get(Z.vK.IMapService),i.hooks.init.tap("DataSourcePlugin",function(){if(!i.getSource()){var v=i.sourceOption;i.setSource(new We(v.data,v.options))}u.updateClusterData(i)}),i.hooks.beforeRenderData.tap("DataSourcePlugin",function(){var f=u.updateClusterData(i),v=i.dataState.dataSourceNeedUpdate;return i.dataState.dataSourceNeedUpdate=!1,f||v})}},{key:"updateClusterData",value:function(i){var u=i.getSource(),f=u.cluster,v=u.clusterOptions,b=v.zoom,P=void 0===b?0:b,I=v.maxZoom,N=void 0===I?16:I,se=this.mapService.getZoom()-1;return!!(f&&(i.dataState.dataSourceNeedUpdate||Math.abs(P-se)>1)&&N>P)&&(u.updateClusterData(Math.floor(se)),!0)}}]),n}())||qa,$l=M(72699),ao=M.n($l),Fa=M(28303),zs=M.n(Fa);function Xu(n,l){return n<l?-1:n>l?1:n>=l?0:NaN}function Ou(n){return 1===n.length&&(n=function(n){return function(l,i){return Xu(n(l),i)}}(n)),{left:function(l,i,u,f){for(null==u&&(u=0),null==f&&(f=l.length);u<f;){var v=u+f>>>1;n(l[v],i)<0?u=v+1:f=v}return u},right:function(l,i,u,f){for(null==u&&(u=0),null==f&&(f=l.length);u<f;){var v=u+f>>>1;n(l[v],i)>0?f=v:u=v+1}return u}}}const Zc=Ou(Xu).right;var th=Math.sqrt(50),rh=Math.sqrt(10),Oh=Math.sqrt(2);function Rf(n,l,i){var u,v,b,P,f=-1;if(i=+i,(n=+n)==(l=+l)&&i>0)return[n];if((u=l<n)&&(v=n,n=l,l=v),0===(P=Ql(n,l,i))||!isFinite(P))return[];if(P>0)for(n=Math.ceil(n/P),l=Math.floor(l/P),b=new Array(v=Math.ceil(l-n+1));++f<v;)b[f]=(n+f)*P;else for(n=Math.floor(n*P),l=Math.ceil(l*P),b=new Array(v=Math.ceil(n-l+1));++f<v;)b[f]=(n-f)/P;return u&&b.reverse(),b}function Ql(n,l,i){var u=(l-n)/Math.max(0,i),f=Math.floor(Math.log(u)/Math.LN10),v=u/Math.pow(10,f);return f>=0?(v>=th?10:v>=rh?5:v>=Oh?2:1)*Math.pow(10,f):-Math.pow(10,-f)/(v>=th?10:v>=rh?5:v>=Oh?2:1)}function sp(n,l,i){var u=Math.abs(l-n)/Math.max(0,i),f=Math.pow(10,Math.floor(Math.log(u)/Math.LN10)),v=u/f;return v>=th?f*=10:v>=rh?f*=5:v>=Oh&&(f*=2),l<n?-f:f}function Ms(n){return null===n?NaN:+n}function xf(n,l,i){if(null==i&&(i=Ms),u=n.length){if((l=+l)<=0||u<2)return+i(n[0],0,n);if(l>=1)return+i(n[u-1],u-1,n);var u,f=(u-1)*l,v=Math.floor(f),b=+i(n[v],v,n);return b+(+i(n[v+1],v+1,n)-b)*(f-v)}}var Ml="$";function e(){}function t(n,l){var i=new e;if(n instanceof e)n.each(function(P,I){i.set(I,P)});else if(Array.isArray(n)){var v,u=-1,f=n.length;if(null==l)for(;++u<f;)i.set(u,n[u]);else for(;++u<f;)i.set(l(v=n[u],u,n),v)}else if(n)for(var b in n)i.set(b,n[b]);return i}e.prototype=t.prototype={constructor:e,has:function(n){return Ml+n in this},get:function(n){return this[Ml+n]},set:function(n,l){return this[Ml+n]=l,this},remove:function(n){var l=Ml+n;return l in this&&delete this[l]},clear:function(){for(var n in this)n[0]===Ml&&delete this[n]},keys:function(){var n=[];for(var l in this)l[0]===Ml&&n.push(l.slice(1));return n},values:function(){var n=[];for(var l in this)l[0]===Ml&&n.push(this[l]);return n},entries:function(){var n=[];for(var l in this)l[0]===Ml&&n.push({key:l.slice(1),value:this[l]});return n},size:function(){var n=0;for(var l in this)l[0]===Ml&&++n;return n},empty:function(){for(var n in this)if(n[0]===Ml)return!1;return!0},each:function(n){for(var l in this)l[0]===Ml&&n(this[l],l.slice(1),this)}};const r=t;function R(){}var j=r.prototype;R.prototype=function(n,l){var i=new R;if(n instanceof R)n.each(function(v){i.add(v)});else if(n){var u=-1,f=n.length;if(null==l)for(;++u<f;)i.add(n[u]);else for(;++u<f;)i.add(l(n[u],u,n))}return i}.prototype={constructor:R,has:j.has,add:function(n){return this[Ml+(n+="")]=n,this},remove:j.remove,clear:j.clear,values:j.keys,size:j.size,empty:j.empty,each:j.each};var me=Array.prototype,xe=me.map,Ge=me.slice;function He(n,l){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(l).domain(n)}return this}var it={name:"implicit"};function Lt(){var n=r(),l=[],i=[],u=it;function f(v){var b=v+"",P=n.get(b);if(!P){if(u!==it)return u;n.set(b,P=l.push(v))}return i[(P-1)%i.length]}return f.domain=function(v){if(!arguments.length)return l.slice();l=[],n=r();for(var I,N,b=-1,P=v.length;++b<P;)n.has(N=(I=v[b])+"")||n.set(N,l.push(I));return f},f.range=function(v){return arguments.length?(i=Ge.call(v),f):i.slice()},f.unknown=function(v){return arguments.length?(u=v,f):u},f.copy=function(){return Lt(l,i).unknown(u)},He.apply(f,arguments),f}function Lr(n,l,i,u,f){var v=n*n,b=v*n;return((1-3*n+3*v-b)*l+(4-6*v+3*b)*i+(1+3*n+3*v-3*b)*u+b*f)/6}function ii(n){return function(){return n}}function Si(n,l){var i=l-n;return i?function(n,l){return function(i){return n+i*l}}(n,i):ii(isNaN(n)?l:n)}const Qn=function n(l){var i=function(n){return 1==(n=+n)?Si:function(l,i){return i-l?function(n,l,i){return n=Math.pow(n,i),l=Math.pow(l,i)-n,i=1/i,function(u){return Math.pow(n+u*l,i)}}(l,i,n):ii(isNaN(l)?i:l)}}(l);function u(f,v){var b=i((f=(0,pc.B8)(f)).r,(v=(0,pc.B8)(v)).r),P=i(f.g,v.g),I=i(f.b,v.b),N=Si(f.opacity,v.opacity);return function(se){return f.r=b(se),f.g=P(se),f.b=I(se),f.opacity=N(se),f+""}}return u.gamma=n,u}(1);function da(n){return function(l){var b,P,i=l.length,u=new Array(i),f=new Array(i),v=new Array(i);for(b=0;b<i;++b)P=(0,pc.B8)(l[b]),u[b]=P.r||0,f[b]=P.g||0,v[b]=P.b||0;return u=n(u),f=n(f),v=n(v),P.opacity=1,function(I){return P.r=u(I),P.g=f(I),P.b=v(I),P+""}}}function Ra(n,l){var b,i=l?l.length:0,u=n?Math.min(i,n.length):0,f=new Array(u),v=new Array(i);for(b=0;b<u;++b)f[b]=Bo(n[b],l[b]);for(;b<i;++b)v[b]=l[b];return function(P){for(b=0;b<u;++b)v[b]=f[b](P);return v}}function Co(n,l){var i=new Date;return n=+n,l=+l,function(u){return i.setTime(n*(1-u)+l*u),i}}function Ao(n,l){return n=+n,l=+l,function(i){return n*(1-i)+l*i}}function Do(n,l){var f,i={},u={};for(f in(null===n||"object"!=typeof n)&&(n={}),(null===l||"object"!=typeof l)&&(l={}),l)f in n?i[f]=Bo(n[f],l[f]):u[f]=l[f];return function(v){for(f in i)u[f]=i[f](v);return u}}da(function(n){var l=n.length-1;return function(i){var u=i<=0?i=0:i>=1?(i=1,l-1):Math.floor(i*l),f=n[u],v=n[u+1];return Lr((i-u/l)*l,u>0?n[u-1]:2*f-v,f,v,u<l-1?n[u+2]:2*v-f)}}),da(function(n){var l=n.length;return function(i){var u=Math.floor(((i%=1)<0?++i:i)*l);return Lr((i-u/l)*l,n[(u+l-1)%l],n[u%l],n[(u+1)%l],n[(u+2)%l])}});var ho=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Oo=new RegExp(ho.source,"g");function fu(n,l){var u,f,v,i=ho.lastIndex=Oo.lastIndex=0,b=-1,P=[],I=[];for(n+="",l+="";(u=ho.exec(n))&&(f=Oo.exec(l));)(v=f.index)>i&&(v=l.slice(i,v),P[b]?P[b]+=v:P[++b]=v),(u=u[0])===(f=f[0])?P[b]?P[b]+=f:P[++b]=f:(P[++b]=null,I.push({i:b,x:Ao(u,f)})),i=Oo.lastIndex;return i<l.length&&(v=l.slice(i),P[b]?P[b]+=v:P[++b]=v),P.length<2?I[0]?function(n){return function(l){return n(l)+""}}(I[0].x):function(n){return function(){return n}}(l):(l=I.length,function(N){for(var ie,se=0;se<l;++se)P[(ie=I[se]).i]=ie.x(N);return P.join("")})}function Is(n,l){l||(l=[]);var f,i=n?Math.min(l.length,n.length):0,u=l.slice();return function(v){for(f=0;f<i;++f)u[f]=n[f]*(1-v)+l[f]*v;return u}}function Bo(n,l){var u,i=typeof l;return null==l||"boolean"===i?ii(l):("number"===i?Ao:"string"===i?(u=(0,pc.ZP)(l))?(l=u,Qn):fu:l instanceof pc.ZP?Qn:l instanceof Date?Co:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}(l)?Is:Array.isArray(l)?Ra:"function"!=typeof l.valueOf&&"function"!=typeof l.toString||isNaN(l)?Do:Ao)(n,l)}function Os(n,l){return n=+n,l=+l,function(i){return Math.round(n*(1-i)+l*i)}}function Ja(n){return+n}var Xa=[0,1];function qi(n){return n}function $s(n,l){return(l-=n=+n)?function(i){return(i-n)/l}:function(n){return function(){return n}}(isNaN(l)?NaN:.5)}function Zs(n){var u,l=n[0],i=n[n.length-1];return l>i&&(u=l,l=i,i=u),function(f){return Math.max(l,Math.min(i,f))}}function yo(n,l,i){var u=n[0],f=n[1],v=l[0],b=l[1];return f<u?(u=$s(f,u),v=i(b,v)):(u=$s(u,f),v=i(v,b)),function(P){return v(u(P))}}function fs(n,l,i){var u=Math.min(n.length,l.length)-1,f=new Array(u),v=new Array(u),b=-1;for(n[u]<n[0]&&(n=n.slice().reverse(),l=l.slice().reverse());++b<u;)f[b]=$s(n[b],n[b+1]),v[b]=i(l[b],l[b+1]);return function(P){var I=Zc(n,P,1,u)-1;return v[I](f[I](P))}}function ws(n,l){return l.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function Pa(){var u,f,v,P,I,N,n=Xa,l=Xa,i=Bo,b=qi;function se(){return P=Math.min(n.length,l.length)>2?fs:yo,I=N=null,ie}function ie(Re){return isNaN(Re=+Re)?v:(I||(I=P(n.map(u),l,i)))(u(b(Re)))}return ie.invert=function(Re){return b(f((N||(N=P(l,n.map(u),Ao)))(Re)))},ie.domain=function(Re){return arguments.length?(n=xe.call(Re,Ja),b===qi||(b=Zs(n)),se()):n.slice()},ie.range=function(Re){return arguments.length?(l=Ge.call(Re),se()):l.slice()},ie.rangeRound=function(Re){return l=Ge.call(Re),i=Os,se()},ie.clamp=function(Re){return arguments.length?(b=Re?Zs(n):qi,ie):b!==qi},ie.interpolate=function(Re){return arguments.length?(i=Re,se()):i},ie.unknown=function(Re){return arguments.length?(v=Re,ie):v},function(Re,Je){return u=Re,f=Je,se()}}function vc(n,l){return Pa()(n,l)}var kh,cl=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Il(n){if(!(l=cl.exec(n)))throw new Error("invalid format: "+n);var l;return new Fo({fill:l[1],align:l[2],sign:l[3],symbol:l[4],zero:l[5],width:l[6],comma:l[7],precision:l[8]&&l[8].slice(1),trim:l[9],type:l[10]})}function Fo(n){this.fill=void 0===n.fill?" ":n.fill+"",this.align=void 0===n.align?">":n.align+"",this.sign=void 0===n.sign?"-":n.sign+"",this.symbol=void 0===n.symbol?"":n.symbol+"",this.zero=!!n.zero,this.width=void 0===n.width?void 0:+n.width,this.comma=!!n.comma,this.precision=void 0===n.precision?void 0:+n.precision,this.trim=!!n.trim,this.type=void 0===n.type?"":n.type+""}function Ku(n,l){if((i=(n=l?n.toExponential(l-1):n.toExponential()).indexOf("e"))<0)return null;var i,u=n.slice(0,i);return[u.length>1?u[0]+u.slice(2):u,+n.slice(i+1)]}function mc(n){return(n=Ku(Math.abs(n)))?n[1]:NaN}function oh(n,l){var i=Ku(n,l);if(!i)return n+"";var u=i[0],f=i[1];return f<0?"0."+new Array(-f).join("0")+u:u.length>f+1?u.slice(0,f+1)+"."+u.slice(f+1):u+new Array(f-u.length+2).join("0")}Il.prototype=Fo.prototype,Fo.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Lh={"%":function(n,l){return(100*n).toFixed(l)},b:function(n){return Math.round(n).toString(2)},c:function(n){return n+""},d:function(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)},e:function(n,l){return n.toExponential(l)},f:function(n,l){return n.toFixed(l)},g:function(n,l){return n.toPrecision(l)},o:function(n){return Math.round(n).toString(8)},p:function(n,l){return oh(100*n,l)},r:oh,s:function(n,l){var i=Ku(n,l);if(!i)return n+"";var u=i[0],f=i[1],v=f-(kh=3*Math.max(-8,Math.min(8,Math.floor(f/3))))+1,b=u.length;return v===b?u:v>b?u+new Array(v-b+1).join("0"):v>0?u.slice(0,v)+"."+u.slice(v):"0."+new Array(1-v).join("0")+Ku(n,Math.max(0,l+v-1))[0]},X:function(n){return Math.round(n).toString(16).toUpperCase()},x:function(n){return Math.round(n).toString(16)}};function Rh(n){return n}var gc,bf,Dh,Vc=Array.prototype.map,sh=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function wf(n){var l=n.domain;return n.ticks=function(i){var u=l();return Rf(u[0],u[u.length-1],null==i?10:i)},n.tickFormat=function(i,u){var f=l();return function(n,l,i,u){var v,f=sp(n,l,i);switch((u=Il(null==u?",f":u)).type){case"s":var b=Math.max(Math.abs(n),Math.abs(l));return null==u.precision&&!isNaN(v=function(n,l){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(mc(l)/3)))-mc(Math.abs(n)))}(f,b))&&(u.precision=v),Dh(u,b);case"":case"e":case"g":case"p":case"r":null==u.precision&&!isNaN(v=function(n,l){return n=Math.abs(n),l=Math.abs(l)-n,Math.max(0,mc(l)-mc(n))+1}(f,Math.max(Math.abs(n),Math.abs(l))))&&(u.precision=v-("e"===u.type));break;case"f":case"%":null==u.precision&&!isNaN(v=function(n){return Math.max(0,-mc(Math.abs(n)))}(f))&&(u.precision=v-2*("%"===u.type))}return bf(u)}(f[0],f[f.length-1],null==i?10:i,u)},n.nice=function(i){null==i&&(i=10);var I,u=l(),f=0,v=u.length-1,b=u[f],P=u[v];return P<b&&(I=b,b=P,P=I,I=f,f=v,v=I),(I=Ql(b,P,i))>0?I=Ql(b=Math.floor(b/I)*I,P=Math.ceil(P/I)*I,i):I<0&&(I=Ql(b=Math.ceil(b*I)/I,P=Math.floor(P*I)/I,i)),I>0?(u[f]=Math.floor(b/I)*I,u[v]=Math.ceil(P/I)*I,l(u)):I<0&&(u[f]=Math.ceil(b*I)/I,u[v]=Math.floor(P*I)/I,l(u)),n},n}function Nh(n,l){var b,i=0,u=(n=n.slice()).length-1,f=n[i],v=n[u];return v<f&&(b=i,i=u,u=b,b=f,f=v,v=b),n[i]=l.floor(f),n[u]=l.ceil(v),n}function Bf(n){return Math.log(n)}function zh(n){return Math.exp(n)}function fh(n){return-Math.log(-n)}function Zh(n){return-Math.exp(-n)}function Ff(n){return isFinite(n)?+("1e"+n):n<0?0:n}function cp(n){return function(l){return-n(-l)}}function rd(n){var f,v,l=n(Bf,zh),i=l.domain,u=10;function b(){return f=function(n){return n===Math.E?Math.log:10===n&&Math.log10||2===n&&Math.log2||(n=Math.log(n),function(l){return Math.log(l)/n})}(u),v=function(n){return 10===n?Ff:n===Math.E?Math.exp:function(l){return Math.pow(n,l)}}(u),i()[0]<0?(f=cp(f),v=cp(v),n(fh,Zh)):n(Bf,zh),l}return l.base=function(P){return arguments.length?(u=+P,b()):u},l.domain=function(P){return arguments.length?(i(P),b()):i()},l.ticks=function(P){var ie,I=i(),N=I[0],se=I[I.length-1];(ie=se<N)&&(Re=N,N=se,se=Re);var It,Zt,Tr,Re=f(N),Je=f(se),Vr=null==P?10:+P,on=[];if(!(u%1)&&Je-Re<Vr){if(Re=Math.round(Re)-1,Je=Math.round(Je)+1,N>0){for(;Re<Je;++Re)for(Zt=1,It=v(Re);Zt<u;++Zt)if(!((Tr=It*Zt)<N)){if(Tr>se)break;on.push(Tr)}}else for(;Re<Je;++Re)for(Zt=u-1,It=v(Re);Zt>=1;--Zt)if(!((Tr=It*Zt)<N)){if(Tr>se)break;on.push(Tr)}}else on=Rf(Re,Je,Math.min(Je-Re,Vr)).map(v);return ie?on.reverse():on},l.tickFormat=function(P,I){if(null==I&&(I=10===u?".0e":","),"function"!=typeof I&&(I=bf(I)),P===1/0)return I;null==P&&(P=10);var N=Math.max(1,u*P/l.ticks().length);return function(se){var ie=se/v(Math.round(f(se)));return ie*u<u-.5&&(ie*=u),ie<=N?I(se):""}},l.nice=function(){return i(Nh(i(),{floor:function(P){return v(Math.floor(f(P)))},ceil:function(P){return v(Math.ceil(f(P)))}}))},l}function Go(n){return function(l){return l<0?-Math.pow(-l,n):Math.pow(l,n)}}function yc(n){return n<0?-Math.sqrt(-n):Math.sqrt(n)}function gd(n){return n<0?-n*n:n*n}function Sf(n){var l=n(qi,qi),i=1;function u(){return 1===i?n(qi,qi):.5===i?n(yc,gd):n(Go(i),Go(1/i))}return l.exponent=function(f){return arguments.length?(i=+f,u()):i},wf(l)}gc=function(n){var l=void 0===n.grouping||void 0===n.thousands?Rh:function(n,l){return function(i,u){for(var f=i.length,v=[],b=0,P=n[0],I=0;f>0&&P>0&&(I+P+1>u&&(P=Math.max(1,u-I)),v.push(i.substring(f-=P,f+P)),!((I+=P+1)>u));)P=n[b=(b+1)%n.length];return v.reverse().join(l)}}(Vc.call(n.grouping,Number),n.thousands+""),i=void 0===n.currency?"":n.currency[0]+"",u=void 0===n.currency?"":n.currency[1]+"",f=void 0===n.decimal?".":n.decimal+"",v=void 0===n.numerals?Rh:function(n){return function(l){return l.replace(/[0-9]/g,function(i){return n[+i]})}}(Vc.call(n.numerals,String)),b=void 0===n.percent?"%":n.percent+"",P=void 0===n.minus?"-":n.minus+"",I=void 0===n.nan?"NaN":n.nan+"";function N(ie){var Re=(ie=Il(ie)).fill,Je=ie.align,It=ie.sign,Zt=ie.symbol,Tr=ie.zero,Vr=ie.width,on=ie.comma,mn=ie.precision,Pn=ie.trim,Hn=ie.type;"n"===Hn?(on=!0,Hn="g"):Lh[Hn]||(void 0===mn&&(mn=12),Pn=!0,Hn="g"),(Tr||"0"===Re&&"="===Je)&&(Tr=!0,Re="0",Je="=");var ei="$"===Zt?i:"#"===Zt&&/[boxX]/.test(Hn)?"0"+Hn.toLowerCase():"",ti="$"===Zt?u:/[%p]/.test(Hn)?b:"",Ui=Lh[Hn],Sa=/[defgprs%]/.test(Hn);function Ua(Ii){var Ru,_p,xp,Va=ei,po=ti;if("c"===Hn)po=Ui(Ii)+po,Ii="";else{var bp=(Ii=+Ii)<0||1/Ii<0;if(Ii=isNaN(Ii)?I:Ui(Math.abs(Ii),mn),Pn&&(Ii=function(n){e:for(var f,l=n.length,i=1,u=-1;i<l;++i)switch(n[i]){case".":u=f=i;break;case"0":0===u&&(u=i),f=i;break;default:if(!+n[i])break e;u>0&&(u=0)}return u>0?n.slice(0,u)+n.slice(f+1):n}(Ii)),bp&&0==+Ii&&"+"!==It&&(bp=!1),Va=(bp?"("===It?It:P:"-"===It||"("===It?"":It)+Va,po=("s"===Hn?sh[8+kh/3]:"")+po+(bp&&"("===It?")":""),Sa)for(Ru=-1,_p=Ii.length;++Ru<_p;)if(48>(xp=Ii.charCodeAt(Ru))||xp>57){po=(46===xp?f+Ii.slice(Ru+1):Ii.slice(Ru))+po,Ii=Ii.slice(0,Ru);break}}on&&!Tr&&(Ii=l(Ii,1/0));var wp=Va.length+Ii.length+po.length,sf=wp<Vr?new Array(Vr-wp+1).join(Re):"";switch(on&&Tr&&(Ii=l(sf+Ii,sf.length?Vr-po.length:1/0),sf=""),Je){case"<":Ii=Va+Ii+po+sf;break;case"=":Ii=Va+sf+Ii+po;break;case"^":Ii=sf.slice(0,wp=sf.length>>1)+Va+Ii+po+sf.slice(wp);break;default:Ii=sf+Va+Ii+po}return v(Ii)}return mn=void 0===mn?6:/[gprs]/.test(Hn)?Math.max(1,Math.min(21,mn)):Math.max(0,Math.min(20,mn)),Ua.toString=function(){return ie+""},Ua}return{format:N,formatPrefix:function(ie,Re){var Je=N(((ie=Il(ie)).type="f",ie)),It=3*Math.max(-8,Math.min(8,Math.floor(mc(Re)/3))),Zt=Math.pow(10,-It),Tr=sh[8+It/3];return function(Vr){return Je(Zt*Vr)+Tr}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),bf=gc.format,Dh=gc.formatPrefix;var Nf=new Date,ph=new Date;function pu(n,l,i,u){function f(v){return n(v=0===arguments.length?new Date:new Date(+v)),v}return f.floor=function(v){return n(v=new Date(+v)),v},f.ceil=function(v){return n(v=new Date(v-1)),l(v,1),n(v),v},f.round=function(v){var b=f(v),P=f.ceil(v);return v-b<P-v?b:P},f.offset=function(v,b){return l(v=new Date(+v),null==b?1:Math.floor(b)),v},f.range=function(v,b,P){var N,I=[];if(v=f.ceil(v),P=null==P?1:Math.floor(P),!(v<b&&P>0))return I;do{I.push(N=new Date(+v)),l(v,P),n(v)}while(N<v&&v<b);return I},f.filter=function(v){return pu(function(b){if(b>=b)for(;n(b),!v(b);)b.setTime(b-1)},function(b,P){if(b>=b)if(P<0)for(;++P<=0;)for(;l(b,-1),!v(b););else for(;--P>=0;)for(;l(b,1),!v(b););})},i&&(f.count=function(v,b){return Nf.setTime(+v),ph.setTime(+b),n(Nf),n(ph),Math.floor(i(Nf,ph))},f.every=function(v){return v=Math.floor(v),isFinite(v)&&v>0?v>1?f.filter(u?function(b){return u(b)%v==0}:function(b){return f.count(0,b)%v==0}):f:null}),f}var Wh=pu(function(n){n.setMonth(0,1),n.setHours(0,0,0,0)},function(n,l){n.setFullYear(n.getFullYear()+l)},function(n,l){return l.getFullYear()-n.getFullYear()},function(n){return n.getFullYear()});Wh.every=function(n){return isFinite(n=Math.floor(n))&&n>0?pu(function(l){l.setFullYear(Math.floor(l.getFullYear()/n)*n),l.setMonth(0,1),l.setHours(0,0,0,0)},function(l,i){l.setFullYear(l.getFullYear()+i*n)}):null};const zf=Wh;const nd=pu(function(n){n.setDate(1),n.setHours(0,0,0,0)},function(n,l){n.setMonth(n.getMonth()+l)},function(n,l){return l.getMonth()-n.getMonth()+12*(l.getFullYear()-n.getFullYear())},function(n){return n.getMonth()});var dh=6e4,Rp=6048e5;function ku(n){return pu(function(l){l.setDate(l.getDate()-(l.getDay()+7-n)%7),l.setHours(0,0,0,0)},function(l,i){l.setDate(l.getDate()+7*i)},function(l,i){return(i-l-(i.getTimezoneOffset()-l.getTimezoneOffset())*dh)/Rp})}var Dp=ku(0),Kh=ku(1),xc=(ku(2),ku(3),ku(4));const qh=(ku(5),ku(6),pu(function(n){n.setHours(0,0,0,0)},function(n,l){n.setDate(n.getDate()+l)},function(n,l){return(l-n-(l.getTimezoneOffset()-n.getTimezoneOffset())*dh)/864e5},function(n){return n.getDate()-1}));const Np=pu(function(n){n.setTime(n-n.getMilliseconds()-1e3*n.getSeconds()-n.getMinutes()*dh)},function(n,l){n.setTime(+n+36e5*l)},function(n,l){return(l-n)/36e5},function(n){return n.getHours()});const Zp=pu(function(n){n.setTime(n-n.getMilliseconds()-1e3*n.getSeconds())},function(n,l){n.setTime(+n+l*dh)},function(n,l){return(l-n)/dh},function(n){return n.getMinutes()});const sd=pu(function(n){n.setTime(n-n.getMilliseconds())},function(n,l){n.setTime(+n+1e3*l)},function(n,l){return(l-n)/1e3},function(n){return n.getUTCSeconds()});var dp=pu(function(){},function(n,l){n.setTime(+n+l)},function(n,l){return l-n});dp.every=function(n){return n=Math.floor(n),isFinite(n)&&n>0?n>1?pu(function(l){l.setTime(Math.floor(l/n)*n)},function(l,i){l.setTime(+l+i*n)},function(l,i){return(i-l)/n}):dp:null};const ud=dp;function Uf(n){return pu(function(l){l.setUTCDate(l.getUTCDate()-(l.getUTCDay()+7-n)%7),l.setUTCHours(0,0,0,0)},function(l,i){l.setUTCDate(l.getUTCDate()+7*i)},function(l,i){return(i-l)/Rp})}var ld=Uf(0),vp=Uf(1),_h=(Uf(2),Uf(3),Uf(4));const jd=(Uf(5),Uf(6),pu(function(n){n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCDate(n.getUTCDate()+l)},function(n,l){return(l-n)/864e5},function(n){return n.getUTCDate()-1}));var Od=pu(function(n){n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},function(n,l){n.setUTCFullYear(n.getUTCFullYear()+l)},function(n,l){return l.getUTCFullYear()-n.getUTCFullYear()},function(n){return n.getUTCFullYear()});Od.every=function(n){return isFinite(n=Math.floor(n))&&n>0?pu(function(l){l.setUTCFullYear(Math.floor(l.getUTCFullYear()/n)*n),l.setUTCMonth(0,1),l.setUTCHours(0,0,0,0)},function(l,i){l.setUTCFullYear(l.getUTCFullYear()+i*n)}):null};const jp=Od;function kd(n){if(0<=n.y&&n.y<100){var l=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return l.setFullYear(n.y),l}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function Ld(n){if(0<=n.y&&n.y<100){var l=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return l.setUTCFullYear(n.y),l}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function Gp(n,l,i){return{y:n,m:l,d:i,H:0,M:0,S:0,L:0}}var gp,iv,Gd={"-":"",_:" ",0:"0"},Lu=/^\s*\d+/,nm=/^%/,im=/[\\^$*+?|[\]().{}]/g;function _o(n,l,i){var u=n<0?"-":"",f=(u?-n:n)+"",v=f.length;return u+(v<i?new Array(i-v+1).join(l)+f:f)}function am(n){return n.replace(im,"\\$&")}function Hp(n){return new RegExp("^(?:"+n.map(am).join("|")+")","i")}function Wp(n){for(var l={},i=-1,u=n.length;++i<u;)l[n[i].toLowerCase()]=i;return l}function om(n,l,i){var u=Lu.exec(l.slice(i,i+1));return u?(n.w=+u[0],i+u[0].length):-1}function sm(n,l,i){var u=Lu.exec(l.slice(i,i+1));return u?(n.u=+u[0],i+u[0].length):-1}function um(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.U=+u[0],i+u[0].length):-1}function lm(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.V=+u[0],i+u[0].length):-1}function cm(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.W=+u[0],i+u[0].length):-1}function Hd(n,l,i){var u=Lu.exec(l.slice(i,i+4));return u?(n.y=+u[0],i+u[0].length):-1}function Wd(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.y=+u[0]+(+u[0]>68?1900:2e3),i+u[0].length):-1}function fm(n,l,i){var u=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(l.slice(i,i+6));return u?(n.Z=u[1]?0:-(u[2]+(u[3]||"00")),i+u[0].length):-1}function hm(n,l,i){var u=Lu.exec(l.slice(i,i+1));return u?(n.q=3*u[0]-3,i+u[0].length):-1}function pm(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.m=u[0]-1,i+u[0].length):-1}function Xd(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.d=+u[0],i+u[0].length):-1}function dm(n,l,i){var u=Lu.exec(l.slice(i,i+3));return u?(n.m=0,n.d=+u[0],i+u[0].length):-1}function Yd(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.H=+u[0],i+u[0].length):-1}function vm(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.M=+u[0],i+u[0].length):-1}function mm(n,l,i){var u=Lu.exec(l.slice(i,i+2));return u?(n.S=+u[0],i+u[0].length):-1}function gm(n,l,i){var u=Lu.exec(l.slice(i,i+3));return u?(n.L=+u[0],i+u[0].length):-1}function ym(n,l,i){var u=Lu.exec(l.slice(i,i+6));return u?(n.L=Math.floor(u[0]/1e3),i+u[0].length):-1}function _m(n,l,i){var u=nm.exec(l.slice(i,i+1));return u?i+u[0].length:-1}function xm(n,l,i){var u=Lu.exec(l.slice(i));return u?(n.Q=+u[0],i+u[0].length):-1}function bm(n,l,i){var u=Lu.exec(l.slice(i));return u?(n.s=+u[0],i+u[0].length):-1}function Kd(n,l){return _o(n.getDate(),l,2)}function wm(n,l){return _o(n.getHours(),l,2)}function Sm(n,l){return _o(n.getHours()%12||12,l,2)}function Em(n,l){return _o(1+qh.count(zf(n),n),l,3)}function qd(n,l){return _o(n.getMilliseconds(),l,3)}function Tm(n,l){return qd(n,l)+"000"}function Cm(n,l){return _o(n.getMonth()+1,l,2)}function Am(n,l){return _o(n.getMinutes(),l,2)}function Pm(n,l){return _o(n.getSeconds(),l,2)}function Mm(n){var l=n.getDay();return 0===l?7:l}function Im(n,l){return _o(Dp.count(zf(n)-1,n),l,2)}function Jd(n){var l=n.getDay();return l>=4||0===l?xc(n):xc.ceil(n)}function Om(n,l){return n=Jd(n),_o(xc.count(zf(n),n)+(4===zf(n).getDay()),l,2)}function km(n){return n.getDay()}function Lm(n,l){return _o(Kh.count(zf(n)-1,n),l,2)}function Rm(n,l){return _o(n.getFullYear()%100,l,2)}function Dm(n,l){return _o((n=Jd(n)).getFullYear()%100,l,2)}function Bm(n,l){return _o(n.getFullYear()%1e4,l,4)}function Fm(n,l){var i=n.getDay();return _o((n=i>=4||0===i?xc(n):xc.ceil(n)).getFullYear()%1e4,l,4)}function Nm(n){var l=n.getTimezoneOffset();return(l>0?"-":(l*=-1,"+"))+_o(l/60|0,"0",2)+_o(l%60,"0",2)}function $d(n,l){return _o(n.getUTCDate(),l,2)}function zm(n,l){return _o(n.getUTCHours(),l,2)}function Zm(n,l){return _o(n.getUTCHours()%12||12,l,2)}function Um(n,l){return _o(1+jd.count(jp(n),n),l,3)}function Qd(n,l){return _o(n.getUTCMilliseconds(),l,3)}function Vm(n,l){return Qd(n,l)+"000"}function jm(n,l){return _o(n.getUTCMonth()+1,l,2)}function Gm(n,l){return _o(n.getUTCMinutes(),l,2)}function Hm(n,l){return _o(n.getUTCSeconds(),l,2)}function Wm(n){var l=n.getUTCDay();return 0===l?7:l}function Xm(n,l){return _o(ld.count(jp(n)-1,n),l,2)}function ev(n){var l=n.getUTCDay();return l>=4||0===l?_h(n):_h.ceil(n)}function Ym(n,l){return n=ev(n),_o(_h.count(jp(n),n)+(4===jp(n).getUTCDay()),l,2)}function Km(n){return n.getUTCDay()}function qm(n,l){return _o(vp.count(jp(n)-1,n),l,2)}function Jm(n,l){return _o(n.getUTCFullYear()%100,l,2)}function $m(n,l){return _o((n=ev(n)).getUTCFullYear()%100,l,2)}function Qm(n,l){return _o(n.getUTCFullYear()%1e4,l,4)}function e0(n,l){var i=n.getUTCDay();return _o((n=i>=4||0===i?_h(n):_h.ceil(n)).getUTCFullYear()%1e4,l,4)}function t0(){return"+0000"}function tv(){return"%"}function rv(n){return+n}function nv(n){return Math.floor(+n/1e3)}gp=function(n){var l=n.dateTime,i=n.date,u=n.time,f=n.periods,v=n.days,b=n.shortDays,P=n.months,I=n.shortMonths,N=Hp(f),se=Wp(f),ie=Hp(v),Re=Wp(v),Je=Hp(b),It=Wp(b),Zt=Hp(P),Tr=Wp(P),Vr=Hp(I),on=Wp(I),mn={a:function(Ri){return b[Ri.getDay()]},A:function(Ri){return v[Ri.getDay()]},b:function(Ri){return I[Ri.getMonth()]},B:function(Ri){return P[Ri.getMonth()]},c:null,d:Kd,e:Kd,f:Tm,g:Dm,G:Fm,H:wm,I:Sm,j:Em,L:qd,m:Cm,M:Am,p:function(Ri){return f[+(Ri.getHours()>=12)]},q:function(Ri){return 1+~~(Ri.getMonth()/3)},Q:rv,s:nv,S:Pm,u:Mm,U:Im,V:Om,w:km,W:Lm,x:null,X:null,y:Rm,Y:Bm,Z:Nm,"%":tv},Pn={a:function(Ri){return b[Ri.getUTCDay()]},A:function(Ri){return v[Ri.getUTCDay()]},b:function(Ri){return I[Ri.getUTCMonth()]},B:function(Ri){return P[Ri.getUTCMonth()]},c:null,d:$d,e:$d,f:Vm,g:$m,G:e0,H:zm,I:Zm,j:Um,L:Qd,m:jm,M:Gm,p:function(Ri){return f[+(Ri.getUTCHours()>=12)]},q:function(Ri){return 1+~~(Ri.getUTCMonth()/3)},Q:rv,s:nv,S:Hm,u:Wm,U:Xm,V:Ym,w:Km,W:qm,x:null,X:null,y:Jm,Y:Qm,Z:t0,"%":tv},Hn={a:function(Ri,eo,xo){var zn=Je.exec(eo.slice(xo));return zn?(Ri.w=It[zn[0].toLowerCase()],xo+zn[0].length):-1},A:function(Ri,eo,xo){var zn=ie.exec(eo.slice(xo));return zn?(Ri.w=Re[zn[0].toLowerCase()],xo+zn[0].length):-1},b:function(Ri,eo,xo){var zn=Vr.exec(eo.slice(xo));return zn?(Ri.m=on[zn[0].toLowerCase()],xo+zn[0].length):-1},B:function(Ri,eo,xo){var zn=Zt.exec(eo.slice(xo));return zn?(Ri.m=Tr[zn[0].toLowerCase()],xo+zn[0].length):-1},c:function(Ri,eo,xo){return Ui(Ri,l,eo,xo)},d:Xd,e:Xd,f:ym,g:Wd,G:Hd,H:Yd,I:Yd,j:dm,L:gm,m:pm,M:vm,p:function(Ri,eo,xo){var zn=N.exec(eo.slice(xo));return zn?(Ri.p=se[zn[0].toLowerCase()],xo+zn[0].length):-1},q:hm,Q:xm,s:bm,S:mm,u:sm,U:um,V:lm,w:om,W:cm,x:function(Ri,eo,xo){return Ui(Ri,i,eo,xo)},X:function(Ri,eo,xo){return Ui(Ri,u,eo,xo)},y:Wd,Y:Hd,Z:fm,"%":_m};function ei(Ri,eo){return function(xo){var wc,Jh,tm,zn=[],ec=-1,hs=0,bc=Ri.length;for(xo instanceof Date||(xo=new Date(+xo));++ec<bc;)37===Ri.charCodeAt(ec)&&(zn.push(Ri.slice(hs,ec)),null!=(Jh=Gd[wc=Ri.charAt(++ec)])?wc=Ri.charAt(++ec):Jh="e"===wc?" ":"0",(tm=eo[wc])&&(wc=tm(xo,Jh)),zn.push(wc),hs=ec+1);return zn.push(Ri.slice(hs,ec)),zn.join("")}}function ti(Ri,eo){return function(xo){var hs,bc,zn=Gp(1900,void 0,1);if(Ui(zn,Ri,xo+="",0)!=xo.length)return null;if("Q"in zn)return new Date(zn.Q);if("s"in zn)return new Date(1e3*zn.s+("L"in zn?zn.L:0));if(eo&&!("Z"in zn)&&(zn.Z=0),"p"in zn&&(zn.H=zn.H%12+12*zn.p),void 0===zn.m&&(zn.m="q"in zn?zn.q:0),"V"in zn){if(zn.V<1||zn.V>53)return null;"w"in zn||(zn.w=1),"Z"in zn?(bc=(hs=Ld(Gp(zn.y,0,1))).getUTCDay(),hs=bc>4||0===bc?vp.ceil(hs):vp(hs),hs=jd.offset(hs,7*(zn.V-1)),zn.y=hs.getUTCFullYear(),zn.m=hs.getUTCMonth(),zn.d=hs.getUTCDate()+(zn.w+6)%7):(bc=(hs=kd(Gp(zn.y,0,1))).getDay(),hs=bc>4||0===bc?Kh.ceil(hs):Kh(hs),hs=qh.offset(hs,7*(zn.V-1)),zn.y=hs.getFullYear(),zn.m=hs.getMonth(),zn.d=hs.getDate()+(zn.w+6)%7)}else("W"in zn||"U"in zn)&&("w"in zn||(zn.w="u"in zn?zn.u%7:"W"in zn?1:0),bc="Z"in zn?Ld(Gp(zn.y,0,1)).getUTCDay():kd(Gp(zn.y,0,1)).getDay(),zn.m=0,zn.d="W"in zn?(zn.w+6)%7+7*zn.W-(bc+5)%7:zn.w+7*zn.U-(bc+6)%7);return"Z"in zn?(zn.H+=zn.Z/100|0,zn.M+=zn.Z%100,Ld(zn)):kd(zn)}}function Ui(Ri,eo,xo,zn){for(var wc,Jh,ec=0,hs=eo.length,bc=xo.length;ec<hs;){if(zn>=bc)return-1;if(37===(wc=eo.charCodeAt(ec++))){if(wc=eo.charAt(ec++),!(Jh=Hn[wc in Gd?eo.charAt(ec++):wc])||(zn=Jh(Ri,xo,zn))<0)return-1}else if(wc!=xo.charCodeAt(zn++))return-1}return zn}return mn.x=ei(i,mn),mn.X=ei(u,mn),mn.c=ei(l,mn),Pn.x=ei(i,Pn),Pn.X=ei(u,Pn),Pn.c=ei(l,Pn),{format:function(Ri){var eo=ei(Ri+="",mn);return eo.toString=function(){return Ri},eo},parse:function(Ri){var eo=ti(Ri+="",!1);return eo.toString=function(){return Ri},eo},utcFormat:function(Ri){var eo=ei(Ri+="",Pn);return eo.toString=function(){return Ri},eo},utcParse:function(Ri){var eo=ti(Ri+="",!0);return eo.toString=function(){return Ri},eo}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),iv=gp.format;var Yp=6e4,Kp=60*Yp,qp=24*Kp,av=30*qp,Rd=365*qp;function s0(n){return new Date(n)}function u0(n){return n instanceof Date?+n:+new Date(+n)}function ov(n,l,i,u,f,v,b,P,I){var N=vc(qi,qi),se=N.invert,ie=N.domain,Re=I(".%L"),Je=I(":%S"),It=I("%I:%M"),Zt=I("%I %p"),Tr=I("%a %d"),Vr=I("%b %d"),on=I("%B"),mn=I("%Y"),Pn=[[b,1,1e3],[b,5,5e3],[b,15,15e3],[b,30,3e4],[v,1,Yp],[v,5,5*Yp],[v,15,15*Yp],[v,30,30*Yp],[f,1,Kp],[f,3,3*Kp],[f,6,6*Kp],[f,12,12*Kp],[u,1,qp],[u,2,2*qp],[i,1,6048e5],[l,1,av],[l,3,3*av],[n,1,Rd]];function Hn(ti){return(b(ti)<ti?Re:v(ti)<ti?Je:f(ti)<ti?It:u(ti)<ti?Zt:l(ti)<ti?i(ti)<ti?Tr:Vr:n(ti)<ti?on:mn)(ti)}function ei(ti,Ui,Sa,Ua){if(null==ti&&(ti=10),"number"==typeof ti){var Ii=Math.abs(Sa-Ui)/ti,Va=Ou(function(po){return po[2]}).right(Pn,Ii);Va===Pn.length?(Ua=sp(Ui/Rd,Sa/Rd,ti),ti=n):Va?(Ua=(Va=Pn[Ii/Pn[Va-1][2]<Pn[Va][2]/Ii?Va-1:Va])[1],ti=Va[0]):(Ua=Math.max(sp(Ui,Sa,ti),1),ti=P)}return null==Ua?ti:ti.every(Ua)}return N.invert=function(ti){return new Date(se(ti))},N.domain=function(ti){return arguments.length?ie(xe.call(ti,u0)):ie().map(s0)},N.ticks=function(ti,Ui){var po,Sa=ie(),Ua=Sa[0],Ii=Sa[Sa.length-1],Va=Ii<Ua;return Va&&(po=Ua,Ua=Ii,Ii=po),po=(po=ei(ti,Ua,Ii,Ui))?po.range(Ua,Ii+1):[],Va?po.reverse():po},N.tickFormat=function(ti,Ui){return null==Ui?Hn:I(Ui)},N.nice=function(ti,Ui){var Sa=ie();return(ti=ei(ti,Sa[0],Sa[Sa.length-1],Ui))?ie(Nh(Sa,ti)):N},N.copy=function(){return ws(N,ov(n,l,i,u,f,v,b,P,I))},N}var of,lv,cv,fv,Dd,hv,pv,dv,vv,mv,pd,gv,yv,g0=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,y0=((0,z.Z)(of={},Z.ScaleTypes.LINEAR,function lh(){var n=vc(qi,qi);return n.copy=function(){return ws(n,lh())},He.apply(n,arguments),wf(n)}),(0,z.Z)(of,Z.ScaleTypes.POWER,function jh(){var n=Sf(Pa());return n.copy=function(){return ws(n,jh()).exponent(n.exponent())},He.apply(n,arguments),n}),(0,z.Z)(of,Z.ScaleTypes.LOG,function fp(){var n=rd(Pa()).domain([1,10]);return n.copy=function(){return ws(n,fp()).base(n.base())},He.apply(n,arguments),n}),(0,z.Z)(of,Z.ScaleTypes.IDENTITY,function ch(n){var l;function i(u){return isNaN(u=+u)?l:u}return i.invert=i,i.domain=i.range=function(u){return arguments.length?(n=xe.call(u,Ja),i):n.slice()},i.unknown=function(u){return arguments.length?(l=u,i):l},i.copy=function(){return ch(n).unknown(l)},n=arguments.length?xe.call(n,Ja):[0,1],wf(i)}),(0,z.Z)(of,Z.ScaleTypes.TIME,function(){return He.apply(ov(zf,nd,Dp,qh,Np,Zp,sd,ud,iv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),(0,z.Z)(of,Z.ScaleTypes.QUANTILE,function Gh(){var u,n=[],l=[],i=[];function f(){var b=0,P=Math.max(1,l.length);for(i=new Array(P-1);++b<P;)i[b-1]=xf(n,b/P);return v}function v(b){return isNaN(b=+b)?u:l[Zc(i,b)]}return v.invertExtent=function(b){var P=l.indexOf(b);return P<0?[NaN,NaN]:[P>0?i[P-1]:n[0],P<i.length?i[P]:n[n.length-1]]},v.domain=function(b){if(!arguments.length)return n.slice();n=[];for(var N,P=0,I=b.length;P<I;++P)null!=(N=b[P])&&!isNaN(N=+N)&&n.push(N);return n.sort(Xu),f()},v.range=function(b){return arguments.length?(l=Ge.call(b),f()):l.slice()},v.unknown=function(b){return arguments.length?(u=b,v):u},v.quantiles=function(){return i.slice()},v.copy=function(){return Gh().domain(n).range(l).unknown(u)},He.apply(v,arguments)}),(0,z.Z)(of,Z.ScaleTypes.QUANTIZE,function _c(){var v,n=0,l=1,i=1,u=[.5],f=[0,1];function b(I){return I<=I?f[Zc(u,I,0,i)]:v}function P(){var I=-1;for(u=new Array(i);++I<i;)u[I]=((I+1)*l-(I-i)*n)/(i+1);return b}return b.domain=function(I){return arguments.length?(n=+I[0],l=+I[1],P()):[n,l]},b.range=function(I){return arguments.length?(i=(f=Ge.call(I)).length-1,P()):f.slice()},b.invertExtent=function(I){var N=f.indexOf(I);return N<0?[NaN,NaN]:N<1?[n,u[0]]:N>=i?[u[i-1],l]:[u[N-1],u[N]]},b.unknown=function(I){return arguments.length&&(v=I),b},b.thresholds=function(){return u.slice()},b.copy=function(){return _c().domain([n,l]).range(f).unknown(v)},He.apply(wf(b),arguments)}),(0,z.Z)(of,Z.ScaleTypes.THRESHOLD,function Hh(){var i,n=[.5],l=[0,1],u=1;function f(v){return v<=v?l[Zc(n,v,0,u)]:i}return f.domain=function(v){return arguments.length?(n=Ge.call(v),u=Math.min(n.length,l.length-1),f):n.slice()},f.range=function(v){return arguments.length?(l=Ge.call(v),u=Math.min(n.length,l.length-1),f):l.slice()},f.invertExtent=function(v){var b=l.indexOf(v);return[n[b-1],n[b]]},f.unknown=function(v){return arguments.length?(i=v,f):i},f.copy=function(){return Hh().domain(n).range(l).unknown(i)},He.apply(f,arguments)}),(0,z.Z)(of,Z.ScaleTypes.CAT,Lt),of),_0=(lv=(0,va.b2)(),cv=(0,va.f3)(Z.vK.IGlobalConfigService),lv((Dd=function(){function n(){(0,X.Z)(this,n),(0,G.Z)(this,"configService",hv,this),(0,z.Z)(this,"scaleCache",{}),(0,z.Z)(this,"scaleOptions",{})}return(0,q.Z)(n,[{key:"apply",value:function(i,u){var f=this,v=u.styleAttributeService;i.hooks.init.tap("FeatureScalePlugin",function(){f.scaleOptions=i.getScaleOptions();var b=v.getLayerStyleAttributes(),P=i.getSource().data.dataArray;0!==P.length&&f.caculateScalesForAttributes(b||[],P)}),i.hooks.beforeRenderData.tap("FeatureScalePlugin",function(){f.scaleOptions=i.getScaleOptions();var b=v.getLayerStyleAttributes(),P=i.getSource().data.dataArray;return f.caculateScalesForAttributes(b||[],P),i.layerModelNeedUpdate=!0,!0}),i.hooks.beforeRender.tap("FeatureScalePlugin",function(){if(!i.layerModelNeedUpdate){f.scaleOptions=i.getScaleOptions();var b=v.getLayerStyleAttributes();if(b){var P=i.getSource().data.dataArray;if(0===P.length)return;var I=b.filter(function(N){return N.needRescale});I.length&&f.caculateScalesForAttributes(I,P)}}})}},{key:"isNumber",value:function(i){return!isNaN(parseFloat(i))&&isFinite(i)}},{key:"caculateScalesForAttributes",value:function(i,u){var f=this;this.scaleCache={},i.forEach(function(v){if(v.scale){var b=v.scale,P=v.name;b.names=f.parseFields(v.scale.field||[]);var I=[];b.names.forEach(function(N){I.push(f.getOrCreateScale(N,v,u))}),I.some(function(N){return N.type===Z.StyleScaleType.VARIABLE})?(b.type=Z.StyleScaleType.VARIABLE,I.forEach(function(N){var se;if(!b.callback)if(b.values&&"text"!==b.values){var ie;if("linear"===(null===(ie=N.option)||void 0===ie?void 0:ie.type)&&b.values.length>2){var Re=N.scale.ticks(b.values.length);"color"===P&&N.scale.domain(Re)}N.scale.range(b.values)}else"cat"===(null===(se=N.option)||void 0===se?void 0:se.type)&&N.scale.range(N.option.domain)})):(b.type=Z.StyleScaleType.CONSTANT,b.defaultValues=I.map(function(N,se){return N.scale(b.names[se])})),b.scalers=I.map(function(N){return{field:N.field,func:N.scale,option:N.option}}),v.needRescale=!1}})}},{key:"getOrCreateScale",value:function(i,u,f){[i,u.name].join("_");var v,P=null===(v=u.scale)||void 0===v?void 0:v.values;return this.createScale(i,u.name,P,f)}},{key:"parseFields",value:function(i){return Array.isArray(i)?i:An()(i)?i.split("*"):[i]}},{key:"createScale",value:function(i,u,f,v){var b,P,I=this.scaleOptions[u]&&(null===(b=this.scaleOptions[u])||void 0===b?void 0:b.field)===i?this.scaleOptions[u]:this.scaleOptions[i],N={field:i,scale:void 0,type:Z.StyleScaleType.VARIABLE,option:I};if(!v||!v.length)return I&&I.type?N.scale=this.createDefaultScale(I):(N.scale=Lt([i]),N.type=Z.StyleScaleType.CONSTANT),N;var se=null===(P=v.find(function(Je){return!zs()(Je[i])}))||void 0===P?void 0:P[i];if(this.isNumber(i)||zs()(se)&&!I)N.scale=Lt([i]),N.type=Z.StyleScaleType.CONSTANT;else{var ie=I&&I.type||this.getDefaultType(se);"text"===f&&(ie=Z.ScaleTypes.CAT);var Re=this.createDefaultScaleConfig(ie,i,v);Object.assign(Re,I),N.scale=this.createDefaultScale(Re),N.option=Re}return N}},{key:"getDefaultType",value:function(i){var u=Z.ScaleTypes.LINEAR;return"string"==typeof i&&(u=g0.test(i)?Z.ScaleTypes.TIME:Z.ScaleTypes.CAT),u}},{key:"createDefaultScaleConfig",value:function(i,u,f){var v={type:i},b=(null==f?void 0:f.map(function(P){return P[u]}))||[];return i!==Z.ScaleTypes.CAT&&i!==Z.ScaleTypes.QUANTILE?v.domain=function(n,l){var f,v,b,i=n.length,u=-1;for(1;++u<i;)if(null!=(f=n[u])&&f>=f)for(v=b=f;++u<i;)null!=(f=n[u])&&(v>f&&(v=f),b<f&&(b=f));return[v,b]}(b):i===Z.ScaleTypes.CAT?v.domain=ao()(b):i===Z.ScaleTypes.QUANTILE&&(v.domain=b),v}},{key:"createDefaultScale",value:function(i){var f=i.domain,v=y0[i.type]();return f&&v.domain(f),v}}]),n}(),hv=(0,Ve.Z)(Dd.prototype,"configService",[cv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fv=Dd))||fv);function _v(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}var bv,Sv,Tv,b0=(pv=(0,va.b2)(),dv=(0,va.f3)(Z.vK.ICameraService),vv=(0,va.f3)(Z.vK.IRendererService),pv((pd=function(){function n(){(0,X.Z)(this,n),(0,G.Z)(this,"cameraService",gv,this),(0,G.Z)(this,"rendererService",yv,this)}return(0,q.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("LayerAnimateStylePlugin",function(){i.models.forEach(function(u){u.addUniforms(function(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?_v(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):_v(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}({},i.layerModel.getAnimateUniforms()))})})}}]),n}(),gv=(0,Ve.Z)(pd.prototype,"cameraService",[dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yv=(0,Ve.Z)(pd.prototype,"rendererService",[vv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mv=pd))||mv),w0=(0,va.b2)()(bv=function(){function n(){(0,X.Z)(this,n)}return(0,q.Z)(n,[{key:"apply",value:function(i){i.hooks.init.tap("LayerModelPlugin",function(){i.prepareBuildModel(),i.buildModels(),i.styleNeedUpdate=!1}),i.hooks.beforeRenderData.tap("DataSourcePlugin",function(){return i.prepareBuildModel(),i.clearModels(),i.buildModels(),i.layerModelNeedUpdate=!1,!1})}}]),n}())||bv,S0=(0,va.b2)()(Sv=function(){function n(){(0,X.Z)(this,n)}return(0,q.Z)(n,[{key:"apply",value:function(i){i.hooks.afterInit.tap("LayerStylePlugin",function(){i.updateLayerConfig({});var u=i.getLayerConfig(),v=u.fitBoundsOptions;u.autoFit&&setTimeout(function(){i.fitBounds(v)},100)})}}]),n}())||Sv;function Cv(n,l){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(n);l&&(u=u.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),i.push.apply(i,u)}return i}function Jp(n){for(var l=1;l<arguments.length;l++){var i=null!=arguments[l]?arguments[l]:{};l%2?Cv(Object(i),!0).forEach(function(u){(0,z.Z)(n,u,i[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Cv(Object(i)).forEach(function(u){Object.defineProperty(n,u,Object.getOwnPropertyDescriptor(i,u))})}return n}var Mv,Ov,kv,Lv,Rv,Dv,Bv,Fv,yp,Nv,zv,Zv,Uv,jv,Hv,Av={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},E0={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},T0={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},C0={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5},P0=(0,va.b2)()(Tv=function(){function n(){(0,X.Z)(this,n)}return(0,q.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("LightingPlugin",function(){i.getLayerConfig().enableLighting&&i.models.forEach(function(v){return v.addUniforms(Jp({},function(n){var l={u_DirectionalLights:new Array(3).fill(Jp({},T0)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Jp({},C0)),u_NumOfSpotLights:0};return(!n||!n.length)&&(n=[E0]),n.forEach(function(i,u){var f=i.type,v=void 0===f?"directional":f,b=(0,St.Z)(i,["type"]),P=Av[v].lights,I=Av[v].num,N=l[I];l[P][N]=Jp(Jp({},l[P][N]),b),l[I]++}),l}()))})})}}]),n}())||Tv,M0=(0,va.b2)()(Mv=function(){function n(){(0,X.Z)(this,n)}return(0,q.Z)(n,[{key:"apply",value:function(i,u){var v=u.styleAttributeService;i.hooks.init.tap("PixelPickingPlugin",function(){var P=i.getLayerConfig().enablePicking;v.registerStyleAttribute({name:"pickingColor",type:Z.AttributeType.Attribute,descriptor:{name:"a_PickingColor",buffer:{data:[],type:Z.gl.FLOAT},size:3,update:function(N,se){return P?(0,tt.Z6)(N.id):[0,0,0]}}})}),i.hooks.beforePickingEncode.tap("PixelPickingPlugin",function(){i.getLayerConfig().enablePicking&&i.isVisible()&&i.models.forEach(function(I){return I.addUniforms({u_PickingStage:1})})}),i.hooks.afterPickingEncode.tap("PixelPickingPlugin",function(){i.getLayerConfig().enablePicking&&i.isVisible()&&i.models.forEach(function(I){return I.addUniforms({u_PickingStage:2})})}),i.hooks.beforeHighlight.tap("PixelPickingPlugin",function(b){var I=i.getLayerConfig().highlightColor,N="string"==typeof I?(0,tt.CI)(I):I||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:(0,tt.W0)(new Uint8Array(b))}),i.models.forEach(function(se){return se.addUniforms({u_PickingStage:2,u_PickingColor:b,u_HighlightColor:N.map(function(ie){return 255*ie})})})}),i.hooks.beforeSelect.tap("PixelPickingPlugin",function(b){var I=i.getLayerConfig().selectColor,N="string"==typeof I?(0,tt.CI)(I):I||[1,0,0,1];i.updateLayerConfig({pickedFeatureID:(0,tt.W0)(new Uint8Array(b))}),i.models.forEach(function(se){return se.addUniforms({u_PickingStage:2,u_PickingColor:b,u_HighlightColor:N.map(function(ie){return 255*ie})})})})}}]),n}())||Mv,I0=(0,va.b2)()(Ov=function(){function n(){(0,X.Z)(this,n)}return(0,q.Z)(n,[{key:"apply",value:function(i,u){var f=this,v=u.styleAttributeService;i.hooks.init.tap("RegisterStyleAttributePlugin",function(){f.registerBuiltinAttributes(v)})}},{key:"registerBuiltinAttributes",value:function(i){i.registerStyleAttribute({name:"position",type:Z.AttributeType.Attribute,descriptor:{name:"a_Position",buffer:{data:[],type:Z.gl.FLOAT},size:3,update:function(f,v,b){return 2===b.length?[b[0],b[1],0]:[b[0],b[1],b[2]]}}}),i.registerStyleAttribute({name:"filter",type:Z.AttributeType.Attribute,descriptor:{name:"filter",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(f,v){return f.filter?[1]:[0]}}}),i.registerStyleAttribute({name:"color",type:Z.AttributeType.Attribute,descriptor:{name:"a_Color",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:4,update:function(f,v){var b=f.color;return b&&b.length?b:[1,1,1,1]}}}),i.registerStyleAttribute({name:"vertexId",type:Z.AttributeType.Attribute,descriptor:{name:"a_vertexId",buffer:{usage:Z.gl.DYNAMIC_DRAW,data:[],type:Z.gl.FLOAT},size:1,update:function(f,v,b,P){return[v]}}})}}]),n}())||Ov,O0=(kv=(0,va.b2)(),Lv=(0,va.f3)(Z.vK.ICameraService),Rv=(0,va.f3)(Z.vK.ICoordinateSystemService),Dv=(0,va.f3)(Z.vK.IRendererService),Bv=(0,va.f3)(Z.vK.IMapService),kv((yp=function(){function n(){(0,X.Z)(this,n),(0,G.Z)(this,"cameraService",Nv,this),(0,G.Z)(this,"coordinateSystemService",zv,this),(0,G.Z)(this,"rendererService",Zv,this),(0,G.Z)(this,"mapService",Uv,this)}return(0,q.Z)(n,[{key:"apply",value:function(i){var u=this,f=this.mapService.version,v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b=[0,0];i.hooks.beforeRender.tap("ShaderUniformPlugin",function(){u.coordinateSystemService.refresh(),"GAODE2.x"===f&&(v=u.mapService.map.customCoords.getMVPMatrix(),b=u.mapService.getCustomCoordCenter());var P=u.rendererService.getViewportSize(),I=P.width,N=P.height;i.models.forEach(function(se){var ie;se.addUniforms(((0,z.Z)(ie={},Z.CameraUniform.ProjectionMatrix,u.cameraService.getProjectionMatrix()),(0,z.Z)(ie,Z.CameraUniform.ViewMatrix,u.cameraService.getViewMatrix()),(0,z.Z)(ie,Z.CameraUniform.ViewProjectionMatrix,u.cameraService.getViewProjectionMatrix()),(0,z.Z)(ie,Z.CameraUniform.Zoom,u.cameraService.getZoom()),(0,z.Z)(ie,Z.CameraUniform.ZoomScale,u.cameraService.getZoomScale()),(0,z.Z)(ie,Z.CameraUniform.FocalDistance,u.cameraService.getFocalDistance()),(0,z.Z)(ie,Z.CameraUniform.CameraPosition,u.cameraService.getCameraPosition()),(0,z.Z)(ie,Z.CoordinateUniform.CoordinateSystem,u.coordinateSystemService.getCoordinateSystem()),(0,z.Z)(ie,Z.CoordinateUniform.ViewportCenter,u.coordinateSystemService.getViewportCenter()),(0,z.Z)(ie,Z.CoordinateUniform.ViewportCenterProjection,u.coordinateSystemService.getViewportCenterProjection()),(0,z.Z)(ie,Z.CoordinateUniform.PixelsPerDegree,u.coordinateSystemService.getPixelsPerDegree()),(0,z.Z)(ie,Z.CoordinateUniform.PixelsPerDegree2,u.coordinateSystemService.getPixelsPerDegree2()),(0,z.Z)(ie,Z.CoordinateUniform.PixelsPerMeter,u.coordinateSystemService.getPixelsPerMeter()),(0,z.Z)(ie,Z.CoordinateUniform.Mvp,v),(0,z.Z)(ie,"u_SceneCenterMKT",b),(0,z.Z)(ie,"u_ViewportSize",[I,N]),(0,z.Z)(ie,"u_DevicePixelRatio",window.devicePixelRatio),(0,z.Z)(ie,"u_ModelMatrix",u.cameraService.getModelMatrix()),(0,z.Z)(ie,"u_PickingBuffer",i.getLayerConfig().pickingBuffer||0),ie))})})}}]),n}(),Nv=(0,Ve.Z)(yp.prototype,"cameraService",[Lv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zv=(0,Ve.Z)(yp.prototype,"coordinateSystemService",[Rv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zv=(0,Ve.Z)(yp.prototype,"rendererService",[Dv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uv=(0,Ve.Z)(yp.prototype,"mapService",[Bv],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fv=yp))||Fv),k0=(0,va.b2)()(jv=function(){function n(){(0,X.Z)(this,n)}return(0,q.Z)(n,[{key:"apply",value:function(i){i.hooks.beforeRender.tap("UpdateModelPlugin",function(){i.layerModel&&i.layerModel.needUpdate()})}}]),n}())||jv,L0=(0,va.b2)()(Hv=function(){function n(){(0,X.Z)(this,n)}return(0,q.Z)(n,[{key:"apply",value:function(i,u){var f=this,v=u.styleAttributeService;i.hooks.init.tap("UpdateStyleAttributePlugin",function(){f.initStyleAttribute(i,{styleAttributeService:v})}),i.hooks.beforeRender.tap("UpdateStyleAttributePlugin",function(){i.layerModelNeedUpdate||f.updateStyleAtrribute(i,{styleAttributeService:v})})}},{key:"updateStyleAtrribute",value:function(i,u){var f=u.styleAttributeService,v=f.getLayerStyleAttributes()||[],b=f.getLayerStyleAttribute("filter"),P=f.getLayerStyleAttribute("shape");if(b&&b.needRegenerateVertices||P&&P.needRegenerateVertices)return i.layerModelNeedUpdate=!0,void v.forEach(function(I){return I.needRegenerateVertices=!1});v.filter(function(I){return I.needRegenerateVertices}).forEach(function(I){f.updateAttributeByFeatureRange(I.name,i.getEncodedData(),I.featureRange.startIndex,I.featureRange.endIndex),I.needRegenerateVertices=!1})}},{key:"initStyleAttribute",value:function(i,u){var f=u.styleAttributeService;(f.getLayerStyleAttributes()||[]).filter(function(b){return b.needRegenerateVertices}).forEach(function(b){f.updateAttributeByFeatureRange(b.name,i.getEncodedData(),b.featureRange.startIndex,b.featureRange.endIndex),b.needRegenerateVertices=!1})}}]),n}())||Hv;Z.nC.bind(Z.vK.ILayerPlugin).to(jo).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(I0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(_0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(Gn).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(S0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(L0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(k0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(ul).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(O0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(b0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(P0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(M0).inRequestScope(),Z.nC.bind(Z.vK.ILayerPlugin).to(w0).inRequestScope();var Vf=M(25917),jf=M(5304),Gf=M(88002),Bd=M(68939),R0=M(66660),Fd=M(91841);let D0=(()=>{class n{constructor(i){this.http=i}getSearchLockerCabinets(i){return this.http.get("smartlocker-locker/api/v1/locker-cabinets/unpaged?code.contains="+i)}getLockerCabinets(i){return this.http.get("smartlocker-locker/api/v1/locker-cabinets?code.equals="+i)}getAllLockerCabinets(i,u,f,v,b){let P="smartlocker-locker/api/v1/locker-cabinets/unpaged";return i&&""!==i.trim()&&(P=P.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==P?"?code.contains=":"&code.contains=",i)),u&&""!==u.trim()&&(P=P.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==P?"?maTinh.equals=":"&maTinh.equals=",u)),null!=f&&(P=P.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==P?"?maQuanHuyen.equals=":"&maQuanHuyen.equals=",f)),null!=v&&(P=P.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==P?"?phuongXaId.equals="+v:"&phuongXaId.equals="+v)),null!=b&&(P=P.concat("smartlocker-locker/api/v1/locker-cabinets/unpaged"==P?"?buuCucId.equals="+b:"&buuCucId.equals="+b)),this.http.get(P)}getAllBuuCucUpgrade(i,u,f,v){let b="smartlocker/api/v1/buu-cucs/unpaged";return i&&""!==i.trim()&&(b=b.concat("smartlocker/api/v1/buu-cucs/unpaged"==b?"?maTinh.equals=":"&maTinh.equals=",i)),null!=u&&(b=b.concat("smartlocker/api/v1/buu-cucs/unpaged"==b?"?maQuanHuyen.equals=":"&maQuanHuyen.equals=",u)),null!=f&&(b=b.concat("smartlocker/api/v1/buu-cucs/unpaged"==b?"?phuongXaId.equals="+f:"&phuongXaId.equals="+f)),null!=v&&(b=b.concat("smartlocker/api/v1/buu-cucs/unpaged"==b?"?id.equals="+v:"&id.equals="+v)),this.http.get(b)}getBuuCuSearch(i=0,u=10,f,v,b){let P="smartlocker/api/v1/buu-cucs?page="+i+"&size="+u;return f&&""!==f.trim()&&(P=P.concat("&maTinh.equals=",f)),null!=v&&(P=P.concat("&maQuanHuyen.equals=",v)),null!=b&&(P=P.concat("&phuongXaId.equals="+b)),this.http.get(P)}getAllProvince(){return this.http.get("smartlocker/api/v1/vtp-tinhs/unpaged")}getProvinceByCode(i){return this.http.get("smartlocker/api/v1/vtp-tinhs?maTinh.contains="+i)}getDistById(i){return this.http.get("smartlocker/api/v1/vtp-quan-huyens?maQuanHuyen.equals="+i)}getWardsById(i){return this.http.get("smartlocker/api/v1/vtp-phuong-xas?id.equals="+i)}getDistByProvince(i){return this.http.get("smartlocker/api/v1/vtp-quan-huyens/unpaged?maTinh.equals="+i)}getWardByDist(i){return this.http.get("smartlocker/api/v1/vtp-phuong-xas/unpaged?quanHuyenId.equals="+i)}findPost(i=null,u=null){return this.http.get(u?"smartlocker/api/v1/buu-cucs?phuongXaId.equals="+u+"&page=0&size=200":"smartlocker/api/v1/buu-cucs?maQuanHuyen.equals="+i+"&page=0&size=200")}getPostOfficeToCode(i){return this.http.get("smartlocker/api/v1/buu-cucs?maBuuCuc.equals="+i)}getPostOfficeById(i){return this.http.get("smartlocker/api/v1/buu-cucs?id.equals="+i)}}return n.\u0275fac=function(i){return new(i||n)(_.LFG(Fd.eN))},n.\u0275prov=_.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var B0=M(34100),Wv=M(17018),Nd=M(80269),zd=M(3679),Xv=M(14453),F0=M(29374),N0=M(84514),Yv=M(82677),Kv=M(25716),qv=M(76149),Jv=M(36442),$v=M(52496),Qv=M(53599),em=M(93845);let z0=(()=>{class n{transform(i){let u;switch(i){case 0:u="";break;case 1:u="green";break;case 2:u="red";break;case 3:u="#808080";break;case 4:u="gold"}return u}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=_.Yjl({name:"colorStatusDetail",type:n,pure:!0}),n})(),Z0=(()=>{class n{transform(i){let u;switch(i){case 0:u="OFFLINE";break;case 1:u="ONLINE";break;case 2:u="ERROR";break;case 3:u="FULL";break;case 4:u="LOCKED"}return u}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=_.Yjl({name:"textStatusDetail",type:n,pure:!0}),n})(),U0=(()=>{class n{transform(i,u){let f;switch(i){case 10:f=u.toLocaleUpperCase().startsWith("HUB")||u.toLocaleUpperCase().startsWith("CH")?"":"B\u01b0u C\u1ee5c";break;case 30:f=u.toLocaleUpperCase().startsWith("HUB")?"":"HUB";break;case 40:f=u.toLocaleUpperCase().startsWith("TTKNB")?"":"TTKNB";break;case 50:f=u.toLocaleUpperCase().startsWith("TTKT")?"":u.toLocaleUpperCase().startsWith("TTKT 1")||u.toLocaleUpperCase().startsWith("TTKT 2")||u.toLocaleUpperCase().startsWith("TTKT 3")||u.toLocaleUpperCase().startsWith("TTKT 4")?"TTKTL":"TTKT"}return f}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275pipe=_.Yjl({name:"levelPost",type:n,pure:!0}),n})();function V0(n,l){if(1&n&&_._UZ(0,"nz-option",45),2&n){const i=l.$implicit;_.Q6J("nzLabel",i.code)("nzValue",i.code)}}function j0(n,l){if(1&n&&_._UZ(0,"nz-option",46),2&n){const i=l.$implicit;_.Q6J("nzValue",i.maTinh)("nzLabel",i.name)}}function G0(n,l){if(1&n&&_._UZ(0,"nz-option",46),2&n){const i=l.$implicit;_.Q6J("nzValue",i.id)("nzLabel",i.tenQuanHuyen)}}function H0(n,l){if(1&n&&_._UZ(0,"nz-option",46),2&n){const i=l.$implicit;_.Q6J("nzValue",i.id)("nzLabel",i.name)}}function W0(n,l){if(1&n&&_._UZ(0,"nz-option",46),2&n){const i=l.$implicit;_.Q6J("nzValue",i.id)("nzLabel",i.name)}}function X0(n,l){1&n&&_._UZ(0,"nz-spin")}function Y0(n,l){if(1&n&&_.YNc(0,X0,1,0,"nz-spin",47),2&n){const i=_.oxw();_.Q6J("ngIf",i.isLoadingScroll)}}function K0(n,l){1&n&&_._UZ(0,"i",48)}function q0(n,l){1&n&&(_.TgZ(0,"h5",49),_._uU(1," T\u1ea5t c\u1ea3 c\xe1c b\u01b0u c\u1ee5c "),_.qZA())}function J0(n,l){1&n&&_._UZ(0,"i",48)}function $0(n,l){if(1&n&&(_.TgZ(0,"h5",49),_._uU(1),_.qZA()),2&n){const i=_.oxw();_.xp6(1),_.hij(" ",i.titleBreadCrumbProvince," ")}}function Q0(n,l){1&n&&_._UZ(0,"i",48)}function eg(n,l){if(1&n&&(_.TgZ(0,"h5",49),_._uU(1),_.qZA()),2&n){const i=_.oxw();_.xp6(1),_.hij(" ",i.titleBreadCrumbDist," ")}}function tg(n,l){1&n&&_._UZ(0,"i",48)}function rg(n,l){if(1&n&&(_.TgZ(0,"h5",49),_._uU(1),_.qZA()),2&n){const i=_.oxw();_.xp6(1),_.hij(" ",i.titleBreadCrumbWard," ")}}function ng(n,l){1&n&&_._UZ(0,"i",48)}function ig(n,l){if(1&n&&(_.TgZ(0,"h5",49),_._uU(1),_.qZA()),2&n){const i=_.oxw();_.xp6(1),_.hij(" ",i.titleBreadCrumbPost," ")}}function ag(n,l){1&n&&_._UZ(0,"i",48)}function og(n,l){if(1&n&&(_.TgZ(0,"h5",49),_._uU(1),_.qZA()),2&n){const i=_.oxw();_.xp6(1),_.hij(" ",i.titleBreadCrumb," ")}}function sg(n,l){1&n&&_._UZ(0,"img",50)}function ug(n,l){1&n&&_._UZ(0,"img",51)}function lg(n,l){1&n&&_._UZ(0,"img",52)}function cg(n,l){1&n&&_._UZ(0,"img",53)}function fg(n,l){1&n&&_._UZ(0,"img",54)}function hg(n,l){1&n&&_._UZ(0,"i",55)}function pg(n,l){1&n&&_._UZ(0,"i",56)}function dg(n,l){if(1&n){const i=_.EpF();_.TgZ(0,"div",57),_.TgZ(1,"h5",58),_._uU(2),_.qZA(),_.TgZ(3,"span",59),_.NdJ("click",function(){return _.CHM(i),_.oxw().clickMe()}),_._UZ(4,"i",60),_.qZA(),_.qZA()}if(2&n){const i=_.oxw();_.xp6(2),_.hij(" ",i.lockerItem&&i.lockerItem.code&&i.lockerItem.title?i.lockerItem.code.concat(" / ",i.lockerItem.title):"-"," ")}}function vg(n,l){if(1&n&&(_.TgZ(0,"nz-tag",78),_.ALo(1,"colorStatusDetail"),_._uU(2),_.ALo(3,"textStatusDetail"),_.qZA()),2&n){const i=_.oxw(2);_.Q6J("nzColor",_.lcZ(1,2,i.lockerItem.status)),_.xp6(2),_.Oqu(_.lcZ(3,4,i.lockerItem.status))}}function mg(n,l){1&n&&(_.TgZ(0,"div",79),_._uU(1," - "),_.qZA())}function gg(n,l){if(1&n&&(_.TgZ(0,"nz-tag",78),_.ALo(1,"colorStatusDetail"),_._uU(2),_.ALo(3,"textStatusDetail"),_.qZA()),2&n){const i=_.oxw(2);_.Q6J("nzColor",i.lockerItem.hardwareStatus.screen?_.lcZ(1,2,i.lockerItem.hardwareStatus.screen):""),_.xp6(2),_.Oqu(null!=i.lockerItem.hardwareStatus.screen?_.lcZ(3,4,i.lockerItem.hardwareStatus.screen):"-")}}function yg(n,l){1&n&&(_.TgZ(0,"span",79),_._uU(1,"-"),_.qZA())}function _g(n,l){if(1&n&&(_.TgZ(0,"nz-tag",78),_.ALo(1,"colorStatusDetail"),_._uU(2),_.ALo(3,"textStatusDetail"),_.qZA()),2&n){const i=_.oxw(2);_.Q6J("nzColor",i.lockerItem.hardwareStatus.firstCamera?_.lcZ(1,2,i.lockerItem.hardwareStatus.firstCamera):""),_.xp6(2),_.Oqu(null!=i.lockerItem.hardwareStatus.firstCamera?_.lcZ(3,4,i.lockerItem.hardwareStatus.firstCamera):"-")}}function xg(n,l){1&n&&(_.TgZ(0,"span",79),_._uU(1,"-"),_.qZA())}function bg(n,l){if(1&n&&(_.TgZ(0,"nz-tag",78),_.ALo(1,"colorStatusDetail"),_._uU(2),_.ALo(3,"textStatusDetail"),_.qZA()),2&n){const i=_.oxw(2);_.Q6J("nzColor",i.lockerItem.hardwareStatus.secondCamera?_.lcZ(1,2,i.lockerItem.hardwareStatus.secondCamera):""),_.xp6(2),_.Oqu(null!=i.lockerItem.hardwareStatus.secondCamera?_.lcZ(3,4,i.lockerItem.hardwareStatus.secondCamera):"-")}}function wg(n,l){1&n&&(_.TgZ(0,"div",79),_._uU(1," - "),_.qZA())}function Sg(n,l){if(1&n&&(_.TgZ(0,"nz-tag",78),_.ALo(1,"colorStatusDetail"),_._uU(2),_.ALo(3,"textStatusDetail"),_.qZA()),2&n){const i=_.oxw(2);_.Q6J("nzColor",i.lockerItem.hardwareStatus.powerMeter?_.lcZ(1,2,i.lockerItem.hardwareStatus.powerMeter):""),_.xp6(2),_.Oqu(null!=i.lockerItem.hardwareStatus.powerMeter?_.lcZ(3,4,i.lockerItem.hardwareStatus.powerMeter):"-")}}function Eg(n,l){1&n&&(_.TgZ(0,"div",79),_._uU(1," - "),_.qZA())}function Tg(n,l){if(1&n&&(_.TgZ(0,"nz-tag",78),_.ALo(1,"colorStatusDetail"),_._uU(2),_.ALo(3,"textStatusDetail"),_.qZA()),2&n){const i=_.oxw(2);_.Q6J("nzColor",i.lockerItem.hardwareStatus.wifi?_.lcZ(1,2,i.lockerItem.hardwareStatus.wifi):""),_.xp6(2),_.Oqu(null!=i.lockerItem.hardwareStatus.wifi?_.lcZ(3,4,i.lockerItem.hardwareStatus.wifi):"-")}}function Cg(n,l){if(1&n){const i=_.EpF();_.TgZ(0,"div",61),_.TgZ(1,"div",14),_.TgZ(2,"div",62),_._UZ(3,"img",63),_.TgZ(4,"span",64),_._uU(5,"B\u01b0u c\u1ee5c :"),_.qZA(),_.qZA(),_.TgZ(6,"div",65),_._uU(7),_.qZA(),_.qZA(),_.TgZ(8,"div",14),_.TgZ(9,"div",62),_._UZ(10,"img",66),_.TgZ(11,"span",64),_._uU(12,"\u0110\u1ecba ch\u1ec9 :"),_.qZA(),_.qZA(),_.TgZ(13,"div",65),_._uU(14),_.qZA(),_.qZA(),_.TgZ(15,"div",14),_.TgZ(16,"div",62),_._UZ(17,"img",67),_.TgZ(18,"span",64),_._uU(19,"Tr\u1ea1ng th\xe1i :"),_.qZA(),_.qZA(),_.TgZ(20,"div",65),_.YNc(21,vg,4,6,"nz-tag",68),_.qZA(),_.qZA(),_.TgZ(22,"div",69),_.TgZ(23,"div",70),_.TgZ(24,"div"),_.TgZ(25,"span",58),_._uU(26,"Giao d\u1ecbch"),_.qZA(),_.qZA(),_.TgZ(27,"div"),_.TgZ(28,"span",71),_._uU(29,"80"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(30,"div",70),_.TgZ(31,"div"),_.TgZ(32,"span",58),_._uU(33,"Ho\xe0n tr\u1ea3"),_.qZA(),_.qZA(),_.TgZ(34,"div"),_.TgZ(35,"span",71),_._uU(36,"80"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(37,"div",70),_.TgZ(38,"div"),_.TgZ(39,"span",58),_._uU(40,"C\xf2n tr\u1ed1ng"),_.qZA(),_.qZA(),_.TgZ(41,"div"),_.TgZ(42,"span",71),_._uU(43,"80"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(44,"div",70),_.TgZ(45,"div"),_.TgZ(46,"span",58),_._uU(47,"\u0110\u1ea7y"),_.qZA(),_.qZA(),_.TgZ(48,"div"),_.TgZ(49,"span",71),_._uU(50,"80"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(51,"div",70),_.TgZ(52,"div"),_.TgZ(53,"span",58),_._uU(54,"l\u1ed7i"),_.qZA(),_.qZA(),_.TgZ(55,"div"),_.TgZ(56,"span",71),_._uU(57,"80"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(58,"div",70),_.TgZ(59,"div"),_.TgZ(60,"span",58),_._uU(61,"\u0110\xf3ng t\u1ee7"),_.qZA(),_.qZA(),_.TgZ(62,"div"),_.TgZ(63,"span",71),_._uU(64,"80"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(65,"div",69),_.TgZ(66,"div",72),_.TgZ(67,"div"),_.TgZ(68,"span",58),_._uU(69,"Phi\xean b\u1ea3n ph\u1ea7n m\u1ec1m"),_.qZA(),_.qZA(),_.TgZ(70,"div"),_.TgZ(71,"span",71),_._uU(72),_.qZA(),_.qZA(),_.qZA(),_.TgZ(73,"div",70),_.TgZ(74,"div"),_.TgZ(75,"span",58),_._uU(76,"M\xe0n h\xecnh"),_.qZA(),_.qZA(),_.TgZ(77,"div"),_.YNc(78,mg,2,0,"div",73),_.YNc(79,gg,4,6,"nz-tag",68),_.qZA(),_.qZA(),_.TgZ(80,"div",62),_.TgZ(81,"div"),_.TgZ(82,"span",58),_._uU(83,"Camera"),_.qZA(),_.qZA(),_.TgZ(84,"div"),_.TgZ(85,"div",74),_.TgZ(86,"span",58),_._uU(87,"Cam 1: "),_.qZA(),_.YNc(88,yg,2,0,"span",73),_.YNc(89,_g,4,6,"nz-tag",68),_.qZA(),_.TgZ(90,"div"),_.TgZ(91,"span",58),_._uU(92,"Cam 2: "),_.qZA(),_.YNc(93,xg,2,0,"span",73),_.YNc(94,bg,4,6,"nz-tag",68),_.qZA(),_.qZA(),_.qZA(),_.TgZ(95,"div",70),_.TgZ(96,"div"),_.TgZ(97,"span",58),_._uU(98,"C\xf4ng t\u01a1 \u0111i\u1ec7n"),_.qZA(),_.qZA(),_.TgZ(99,"div"),_.YNc(100,wg,2,0,"div",73),_.YNc(101,Sg,4,6,"nz-tag",68),_.qZA(),_.qZA(),_.TgZ(102,"div",75),_.TgZ(103,"div"),_.TgZ(104,"span",58),_._uU(105,"Wifi"),_.qZA(),_.qZA(),_.TgZ(106,"div"),_.YNc(107,Eg,2,0,"div",73),_.YNc(108,Tg,4,6,"nz-tag",68),_.qZA(),_.qZA(),_.qZA(),_.TgZ(109,"div",76),_.TgZ(110,"button",77),_.NdJ("click",function(){_.CHM(i);const f=_.oxw();return f.viewDetail(f.lockerItem.id)}),_._uU(111," Xem chi ti\u1ebft "),_.qZA(),_.qZA(),_.qZA()}if(2&n){const i=_.oxw();_.xp6(7),_.hij(" ",i.lockerItem&&i.lockerItem.buuCuc.maBuuCuc?i.lockerItem.buuCuc.maBuuCuc:"-"," "),_.xp6(7),_.hij(" ",i.lockerItem&&i.lockerItem.address&&i.lockerItem.address.detail?i.lockerItem.address.detail.concat(",",i.lockerItem.address.vtpPhuongXa.name,",",i.lockerItem.address.vtpPhuongXa.quanHuyen.tenQuanHuyen,",",i.lockerItem.address.vtpPhuongXa.quanHuyen.tinh.name):"-"," "),_.xp6(7),_.Q6J("ngIf",null!=i.lockerItem.status),_.xp6(51),_.Oqu(i.lockerItem&&i.lockerItem.hardwareStatus&&i.lockerItem.hardwareStatus.softwareVersion?i.lockerItem.hardwareStatus.softwareVersion:"-"),_.xp6(6),_.Q6J("ngIf",null==i.lockerItem.hardwareStatus),_.xp6(1),_.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),_.xp6(9),_.Q6J("ngIf",null==i.lockerItem.hardwareStatus),_.xp6(1),_.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),_.xp6(4),_.Q6J("ngIf",null==i.lockerItem.hardwareStatus),_.xp6(1),_.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),_.xp6(6),_.Q6J("ngIf",null==i.lockerItem.hardwareStatus),_.xp6(1),_.Q6J("ngIf",null!=i.lockerItem.hardwareStatus),_.xp6(6),_.Q6J("ngIf",null==i.lockerItem.hardwareStatus),_.xp6(1),_.Q6J("ngIf",null!=i.lockerItem.hardwareStatus)}}function Ag(n,l){if(1&n){const i=_.EpF();_.TgZ(0,"div",57),_.TgZ(1,"h5",58),_._uU(2),_.ALo(3,"levelPost"),_.qZA(),_.TgZ(4,"span",59),_.NdJ("click",function(){return _.CHM(i),_.oxw().clickMePost()}),_._UZ(5,"i",60),_.qZA(),_.qZA()}if(2&n){const i=_.oxw();_.xp6(2),_.hij(" ",i.itemPostOffice&&i.itemPostOffice.name&&i.itemPostOffice.capBuuCuc?_.xi3(3,1,i.itemPostOffice.capBuuCuc,i.itemPostOffice.name).concat(" ",i.itemPostOffice.name):"-"," ")}}function Pg(n,l){if(1&n&&(_.TgZ(0,"div",80),_.TgZ(1,"div",81),_._UZ(2,"img",82),_.qZA(),_.TgZ(3,"div",14),_.TgZ(4,"div",72),_._UZ(5,"img",63),_.TgZ(6,"span",64),_._uU(7,"M\xe3 B\u01b0u c\u1ee5c :"),_.qZA(),_.qZA(),_.TgZ(8,"div",83),_._uU(9),_.qZA(),_.qZA(),_.TgZ(10,"div",14),_.TgZ(11,"div",72),_._UZ(12,"img",66),_.TgZ(13,"span",64),_._uU(14,"\u0110\u1ecba ch\u1ec9 :"),_.qZA(),_.qZA(),_.TgZ(15,"div",83),_._uU(16),_.qZA(),_.qZA(),_.TgZ(17,"div",84),_.TgZ(18,"div",72),_.TgZ(19,"span",85),_._uU(20,"M\xf4 t\u1ea3 :"),_.qZA(),_.qZA(),_.TgZ(21,"div",83),_._uU(22),_.qZA(),_.qZA(),_.qZA()),2&n){const i=_.oxw();_.xp6(9),_.hij(" ",i.itemPostOffice&&i.itemPostOffice.maBuuCuc?i.itemPostOffice.maBuuCuc:"-"," "),_.xp6(7),_.hij(" ",i.itemPostOffice&&i.itemPostOffice.address?i.itemPostOffice.address:"-"," "),_.xp6(6),_.hij(" ",i.itemPostOffice&&i.itemPostOffice.description?i.itemPostOffice.description:"-"," ")}}const Mg=function(){return[16,16]};let Ig=(()=>{class n{constructor(i,u,f,v){this.httpClient=i,this.mapService=u,this.router=f,this.baseService=v,this.visible=!1,this.countmap=0,this.visiblePost=!1,this.isLoadingMap=!1,this.listOfPostOffice=[],this.listOfHub=[],this.listOfTTKT=[],this.listOfTTB=[],this.listOfCH=[],this.countCH=0,this.countPost=0,this.countTTKT=0,this.countHub=0,this.countTTB=0,this.listOfPost=[],this.isLoadingScroll=!1,this.listOfCabinets=[],this.nzFilterOption=()=>!0,this.pageBuuCuc=0,this.sizeBuuCuc=10,this.totalBuuCuc=0}ngOnInit(){this.getBuuCucSearchLoad(),this.getProvince(),this.getData()}getDataCount(i){this.activeCount=0,this.offCount=0,this.fullCount=0,this.errorCount=0,this.lockerCount=0,i.forEach(u=>{switch(u.status){case 0:this.offCount=this.offCount+1;break;case 1:this.activeCount=+this.activeCount+1;break;case 2:this.errorCount=+this.errorCount+1;break;case 3:this.lockerCount=+this.lockerCount+1;break;case 4:this.fullCount=+this.fullCount+1}})}getCountPost(i){}getData(){this.httpClient.get("/assets/viettelpost.json").subscribe(i=>{this.scene=new Li({id:"map",map:new tl({pitch:0,style:i,center:[105.819746,21.023351],zoom:13,maxZoom:50})}),this.getLoad(),this.getDataLoadAllLocker(),this.getDataLoadAllPost()})}getLoad(){this.scene.on("loaded",()=>{fetch("/assets/map.json").then(f=>f.json()).then(f=>{this.countmap=this.countmap+1;const v=new Ze({}).source(f).active(!0);this.scene.addLayer(v)}),this.scene.addImage("postoffice","assets/b\u01b0u c\u1ee5c.svg"),this.scene.addImage("hub","assets/hub.svg"),this.scene.addImage("TTKT","assets/5Star.svg"),this.scene.addImage("TTB","assets/trung t\xe2m bay.svg"),this.scene.addImage("CH","assets/c\u1eeda h\xe0ng.svg"),this.scene.addImage("marker0","assets/locker-off.svg"),this.scene.addImage("marker1","assets/locker-onl.svg"),this.scene.addImage("marker2","assets/locker-error.svg"),this.scene.addImage("marker3","assets/locker-locked.svg"),this.scene.addImage("marker4","assets/locker-full.svg");const i=new ae({position:"topright"}),u=new Dr({position:"bottomright"});this.scene.addControl(i),this.scene.addControl(u)})}getDataLoadAllLocker(){this.scene.on("loaded",()=>{this.mapService.getAllLockerCabinets(this.codeSearch,this.provinceName,this.distName,this.wardName,this.postId).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(i=>i.data.data)).subscribe(i=>{i.length>0&&(this.totalLocker=i.length,this.getDataCount(i),this.pointLayerLocker=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("status",function(f){let v="";switch(f){case 0:v="marker0";break;case 1:v="marker1";break;case 2:v="marker2";break;case 3:v="marker3";break;case 4:v="marker4"}return v}).size(13).active({color:"blue"}),this.pointLayerLocker.on("mouseup",f=>{this.visible=!1,this.datasend=f,this.clickPoint({bubbles:!0,detail:this.datasend})}),this.pointLayerLocker.on("mouseout",f=>{this.visible=!1}),this.scene.addLayer(this.pointLayerLocker),this.layersControl=new $e({overlayers:{"T\u1ee7 SmartLocker":this.pointLayerLocker}}),this.scene.addControl(this.layersControl))})})}getDataLoadAllPost(){this.scene.on("loaded",()=>{this.isLoadingMap=!0,this.mapService.getAllBuuCucUpgrade(this.provinceName,this.distName,this.wardName,this.postId).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Bd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{this.totalPost=0,i.length>0&&(this.listOfTTKT=[],this.listOfHub=[],this.listOfPostOffice=[],this.listOfTTB=[],this.countPost=0,this.countTTKT=0,this.countHub=0,this.countTTB=0,this.listOfCH=[],this.countCH=0,i.forEach(u=>{switch(Number(u.capBuuCuc)){case 10:u.name.toLocaleUpperCase().startsWith("HUB")?this.listOfHub.push(u):u.name.toLocaleUpperCase().startsWith("CH")?this.listOfCH.push(u):this.listOfPostOffice.push(u);break;case 30:this.listOfHub.push(u);break;case 40:this.listOfTTB.push(u);break;case 50:this.listOfTTKT.push(u)}}),this.totalPost=this.listOfPostOffice.length,this.totalTTKT=this.listOfTTKT.length,this.totalTTB=this.listOfTTB.length,this.totalHUB=this.listOfHub.length,this.totalCH=this.listOfCH.length,this.pointLayerPost=new uo({}).source(this.listOfPostOffice,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("postoffice").size(14).active({color:"blue"}),this.pointLayerPost.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerPost.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerPost),this.getCountPost(this.scene),this.layersControl.addVisualLayer(this.pointLayerPost,"B\u01b0u C\u1ee5c"),this.getDataLoadAllCH(this.listOfCH),this.getDataLoadAllTTKT(this.listOfTTKT),this.getDataLoadAllTTB(this.listOfTTB),this.getDataLoadAllHUB(this.listOfHub),document.getElementsByClassName("l7-control-layers-selector")[1].addEventListener("click",()=>{this.countPost=this.countPost+1,this.totalPost=0==this.countPost||this.countPost%2==0?this.listOfPostOffice.length:0}),document.getElementsByClassName("l7-control-layers-selector")[2].addEventListener("click",()=>{this.countCH=this.countCH+1,this.totalCH=0==this.countCH||this.countCH%2==0?this.listOfCH.length:0}),document.getElementsByClassName("l7-control-layers-selector")[3].addEventListener("click",()=>{this.countTTKT=this.countTTKT+1,this.totalTTKT=0==this.countTTKT||this.countTTKT%2==0?this.listOfTTKT.length:0}),document.getElementsByClassName("l7-control-layers-selector")[4].addEventListener("click",()=>{this.countTTB=this.countTTB+1,this.totalTTB=0==this.countTTB||this.countTTB%2==0?this.listOfTTB.length:0}),document.getElementsByClassName("l7-control-layers-selector")[5].addEventListener("click",()=>{this.countHub=this.countHub+1,this.totalHUB=0==this.countHub||this.countHub%2==0?this.listOfHub.length:0}))})})}getDataLoadAllCH(i){this.pointLayerCH=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("CH").size(14).active({color:"blue"}),this.pointLayerCH.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerCH.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerCH),this.layersControl.addVisualLayer(this.pointLayerCH,"C\u1eeda h\xe0ng")}getDataLoadAllTTKT(i){this.pointLayerTTKT=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("TTKT").size(14).active({color:"blue"}),this.pointLayerTTKT.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerTTKT.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerTTKT),this.layersControl.addVisualLayer(this.pointLayerTTKT,"Trung T\xe2m Khai Th\xe1c")}getDataLoadAllTTB(i){this.pointLayerTTB=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("TTB").size(14).active({color:"blue"}),this.pointLayerTTB.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerTTB.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerTTB),this.layersControl.addVisualLayer(this.pointLayerTTB,"Trung T\xe2m Bay")}getDataLoadAllHUB(i){this.pointLayerHUB=new uo({}).source(i,{parser:{type:"json",x:"longitude",y:"latitude"}}).shape("hub").size(14).active({color:"blue"}),this.pointLayerHUB.on("mouseup",u=>{this.visiblePost=!1,this.clickPointPost({bubbles:!0,detail:u})}),this.pointLayerHUB.on("mouseout",u=>{setTimeout(()=>{this.visiblePost=!1},100)}),this.scene.addLayer(this.pointLayerHUB),this.layersControl.addVisualLayer(this.pointLayerHUB,"HUB")}clickPoint(i){this.lockerItem=i.detail.feature;let u=document.getElementById("popoverpoint");u.style.left=i.detail.x+"px",u.style.top=i.detail.y+"px",setTimeout(()=>{this.visible=!0},100)}clickMe(){this.visible=!1}clickPointPost(i){this.itemPostOffice=i.detail.feature;let u=document.getElementById("pointpost");u.style.left=i.detail.x+"px",u.style.top=i.detail.y+"px",setTimeout(()=>{this.visiblePost=!0},100)}clickMePost(){this.visiblePost=!1}change(i){}changePost(i){}viewDetail(i){this.router.navigateByUrl("/lockers/detail/"+i)}getDetailTitleMap(){null==this.provinceId&&(this.titleBreadCrumb="T\u1ea4T C\u1ea2 C\xc1C B\u01afU C\u1ee4C")}searchAll(){this.getDataItemLocker(),this.getDataItemPost()}searchCode(i){this.listOfCabinets=[],null!=i&&""!=i&&this.mapService.getSearchLockerCabinets(i).subscribe(u=>{u.data.data.length>0&&u.data.data.forEach(f=>{let v=new R0.i(f);this.listOfCabinets.push(v)})}),null!=this.codeSearch?this.mapService.getLockerCabinets(this.codeSearch).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{u.length>0&&(this.titleBreadCrumb=u[0].title)}):this.titleBreadCrumb=null,this.getDataItemLocker()}getProvince(){this.mapService.getAllProvince().subscribe(i=>{0==i.error&&(this.listOfProvince=i.data.data)})}pageChange(i){this.page=i,this.getDataItemLocker(),this.getDataItemPost()}getDataItemLocker(){this.isLoadingMap=!0,this.mapService.getAllLockerCabinets(this.codeSearch,this.provinceName,this.distName,this.wardName,this.postId).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Bd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{i.length>0?(this.totalLocker=i.length,this.getDataCount(i),this.pointLayerLocker.setData(i),this.scene.setZoomAndCenter(null!=this.postId?15:9,[i[0].longitude,i[0].latitude])):this.totalLocker=0})}getDataItemPost(){this.isLoadingMap=!0,this.totalPost=0,this.totalCH=0,this.totalHUB=0,this.totalTTB=0,this.totalTTKT=0,this.listOfTTKT=[],this.listOfHub=[],this.listOfPostOffice=[],this.listOfTTB=[],this.listOfCH=[],this.mapService.getAllBuuCucUpgrade(this.provinceName,this.distName,this.wardName,this.postId).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(i=>i.data.data),(0,Bd.x)(()=>{this.isLoadingMap=!1})).subscribe(i=>{i.length>0&&(i.forEach(u=>{switch(Number(u.capBuuCuc)){case 10:u.name.toLocaleUpperCase().startsWith("HUB")?this.listOfHub.push(u):u.name.toLocaleUpperCase().startsWith("CH")?this.listOfCH.push(u):this.listOfPostOffice.push(u);break;case 30:this.listOfHub.push(u);break;case 40:this.listOfTTB.push(u);break;case 50:this.listOfTTKT.push(u)}}),this.totalPost=this.listOfPostOffice.length,this.totalTTKT=this.listOfTTKT.length,this.totalTTB=this.listOfTTB.length,this.totalHUB=this.listOfHub.length,this.totalCH=this.listOfCH.length,this.pointLayerPost.setData(this.listOfPostOffice),this.pointLayerTTKT.setData(this.listOfTTKT),this.pointLayerTTB.setData(this.listOfTTB),this.pointLayerHUB.setData(this.listOfHub),this.pointLayerCH.setData(this.listOfCH),this.scene.setZoomAndCenter(null!=this.postId?15:null!=this.wardId&&null==this.postId?12:null==this.wardId&&null==this.postId&&null!=this.distId?11:9,[i[0].longitude,i[0].latitude]))})}provinceChange(i){this.provinceName=i,null!=i?(this.pageBuuCuc=0,this.listOfPost=[],this.mapService.getProvinceByCode(i).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{u.length>0&&(this.titleBreadCrumbProvince=u[0].name)}),this.mapService.getDistByProvince(i).subscribe(u=>{0==u.error&&(this.listOfWard=[],this.distId=null,this.wardId=null,this.wardName=null,this.distName=null,this.postId=null,this.listOfDist=u.data.data)})):(this.titleBreadCrumbProvince=null,this.titleBreadCrumbPost=null,this.titleBreadCrumbWard=null,this.titleBreadCrumbDist=null,this.pageBuuCuc=0,this.listOfPost=[],this.listOfDist=[],this.listOfWard=[],this.wardName=null,this.distName=null,this.postId=null,this.distId=null,this.wardId=null,this.provinceName=null),this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}distChange(i){if(this.distId=i,null!=i){this.pageBuuCuc=0,this.listOfPost=[];for(let u=0;u<this.listOfDist.length;u++)if(i==this.listOfDist[u].id){this.distName=this.listOfDist[u].maQuanHuyen,this.mapService.getDistById(this.distName).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(f=>f.data.data)).subscribe(f=>{f.length>0&&(this.titleBreadCrumbDist=f[0].tenQuanHuyen)});break}this.mapService.getWardByDist(i).subscribe(u=>{0==u.error&&(this.wardName=null,this.wardId=null,this.postId=null,this.listOfWard=u.data.data)})}else this.titleBreadCrumbDist=null,this.titleBreadCrumbPost=null,this.titleBreadCrumbWard=null,this.pageBuuCuc=0,this.listOfPost=[],this.listOfWard=[],this.wardName=null,this.postId=null,this.distName=null,this.distId=null,this.wardId=null;this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}wardChange(i){if(this.wardId=i,null!=i){this.pageBuuCuc=0,this.listOfPost=[];for(let u=0;u<this.listOfDist.length;u++)if(i==this.listOfWard[u].id){this.postId=null,this.wardName=this.listOfWard[u].id,this.mapService.getWardsById(this.wardName).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(f=>f.data.data)).subscribe(f=>{f.length>0&&(this.titleBreadCrumbWard=f[0].name)});break}}else this.titleBreadCrumbWard=null,this.titleBreadCrumbPost=null,this.pageBuuCuc=0,this.listOfPost=[],this.wardName=null,this.wardId=null,this.postId=null;this.getBuuCucSearchLoad(),this.getDataItemLocker(),this.getDataItemPost()}searchPost(i){this.postId=i,null!=i?this.mapService.getPostOfficeById(i).pipe((0,jf.K)(()=>(0,Vf.of)({data:[]})),(0,Gf.U)(u=>u.data.data)).subscribe(u=>{this.titleBreadCrumbPost=u[0].name}):this.titleBreadCrumbPost=null,this.getDataItemLocker(),this.getDataItemPost()}getBuuCucSearchLoad(){this.mapService.getBuuCuSearch(this.pageBuuCuc,this.sizeBuuCuc,this.provinceName,this.distName,this.wardName).subscribe(i=>{this.isLoadingScroll=!1,this.responseProcessBuuCuc(i)},i=>{console.log("Kh\xf4ng g\u01b0i \u0111\u01b0\u1ee3c th\xf4ng tin l\u1ea5y b\u01b0u c\u1ee5c",i)})}responseProcessBuuCuc(i){this.listOfPost=this.listOfPost==[]?i.data.data:this.listOfPost.concat(i.data.data),this.totalBuuCuc=i.data.total}loadMore(){this.totalBuuCuc>this.listOfPost.length&&(this.isLoadingScroll=!0,this.pageBuuCuc=this.pageBuuCuc+1,this.getBuuCucSearchLoad())}}return n.\u0275fac=function(i){return new(i||n)(_.Y36(Fd.eN),_.Y36(D0),_.Y36(p.F0),_.Y36(B0.bQ))},n.\u0275cmp=_.Xpm({type:n,selectors:[["cms-map"]],decls:101,vars:70,consts:[[1,"mt-0","mx-0"],["nz-row","",1,"row-search",3,"nzGutter"],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","4","nzXXl","5",1,"mt-1"],["nzShowSearch","","nzServerSearch","","nzAllowClear","","nzPlaceHolder","Nh\u1eadp m\xe3 locker",1,"width-full",3,"ngModel","nzShowArrow","nzFilterOption","ngModelChange","nzOnSearch"],[3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","4","nzXXl","4",1,"mt-1"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn t\u1ec9nh","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn qu\u1eadn/huy\u1ec7n","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn x\xe3/ph\u01b0\u1eddng","nzAllowClear","",1,"width-full",3,"ngModel","ngModelChange"],["nzShowSearch","","nzPlaceHolder","Ch\u1ecdn b\u01b0u c\u1ee5c","nzAllowClear","",1,"width-full",3,"ngModel","nzDropdownRender","nzScrollToBottom","ngModelChange"],["renderTemplate",""],["nz-col","","nzXs","12","nzSm","8","nzMd","8","nzLg","8","nzXl","2","nzXXl","2",1,"mt-1"],["nz-button","","nzType","primary",3,"click"],["nz-row","",1,"mt-3"],["nz-col","","nzSpan","24"],["nz-typography","","nzType","secondary"],["nz-icon","","nzType","right","nzTheme","outline","class","next-segment",4,"ngIf"],["nz-typography","","class","mt-0 mb-2 d-inline-block",4,"ngIf"],[3,"nzSpinning"],["nz-row","","nzGutter","16"],["nz-col","","nzXs","24","nzSm","24","nzMd","5","nzLg","5","nzXl","4","nzXXl","3"],["nz-row",""],["nz-col","","nzXs","10","nzSm","11","nzMd","24","nzLg","24","nzXl","24","nzXXl","24",1,"top-statistic"],[3,"nzValue","nzTitle","nzPrefix"],["prefixTplOne",""],["prefixTplOne1",""],["prefixTplOne2",""],["prefixTplOne3",""],["prefixTplOne4",""],["prefixTplOne5",""],["prefixTplOne6",""],[1,"mt-4","status-tag"],["nzStatus","success","nzText","Kh\u1ea3 d\u1ee5ng",1,"d-inline-block","d-md-block","mb-2","ml-2"],["nzStatus","default","nzText","\u0110\u1ea7y",1,"d-inline-block","d-md-block","mb-2","ml-2"],["nzStatus","error","nzText","L\u1ed7i",1,"d-inline-block","d-md-block","ml-2"],["nz-col","","nzXs","24","nzSm","25","nzMd","19","nzLg","19","nzXl","20","nzXXl","21"],["id","map",1,"map-wrapper"],["id","popoverpoint"],["nz-popover","",3,"nzPopoverTitle","nzPopoverVisible","nzPopoverContent","nzPopoverVisibleChange"],["titleTemplate",""],["contentTemplate",""],["id","pointpost"],["titleTemplatePost",""],["contentTemplatePost",""],[3,"nzLabel","nzValue"],[3,"nzValue","nzLabel"],[4,"ngIf"],["nz-icon","","nzType","right","nzTheme","outline",1,"next-segment"],["nz-typography","",1,"mt-0","mb-2","d-inline-block"],["src","/assets/postofficeall.svg","height","18",1,"mr-2"],["src","/assets/locker (2).svg","height","18",1,"mr-2"],["src","/assets/active.svg","height","18",1,"mr-2"],["src","/assets/full.svg","height","18",1,"mr-2"],["src","/assets/error.svg","height","18",1,"mr-2"],["nz-icon","","nzType","lock","nzTheme","outline",1,"mr-2",2,"font-size","20px","color","red"],["nz-icon","","nzType","disconnect","nzTheme","outline",1,"mr-2",2,"font-size","20px","color","#808080"],[1,"pt-2",2,"display","flex","justify-content","space-between"],["nz-typography",""],[2,"cursor","pointer",3,"click"],["nz-icon","","nzType","close","nzTheme","outline"],[1,"ml-2"],["nz-col","","nzSpan","6"],["src","assets/homepost.svg",1,"mr-2"],["nz-col","",1,"text-bold"],["nz-col","","nzSpan","18"],["src","assets/address.svg",1,"mr-2"],["src","assets/active.svg","height","16","width","16",1,"mr-2"],[3,"nzColor",4,"ngIf"],["nz-row","",1,"mt-4"],["nz-col","","nzSpan","4"],[1,"text-bold"],["nz-col","","nzSpan","7"],["class","text-center",4,"ngIf"],[1,"mb-3"],["nz-col","","nzSpan","3"],["nz-row","","nzJustify","center",1,"mb-3","mt-4"],["nz-button","","nzType","primary",2,"cursor","pointer",3,"click"],[3,"nzColor"],[1,"text-center"],[1,"mx-2"],["nz-row","",1,"mt-3",2,"display","flex","justify-content","center"],["src","assets/banner-vtp.png",1,"mb-2",2,"width","100%","height","100%"],["nz-col","","nzSpan","17"],["nz-row","",1,"my-3"],["nz-col","",1,"text-bold","pl-5"]],template:function(i,u){if(1&i&&(_.TgZ(0,"nz-card"),_.TgZ(1,"div",0),_.TgZ(2,"div",1),_.TgZ(3,"div",2),_.TgZ(4,"nz-select",3),_.NdJ("ngModelChange",function(v){return u.codeSearch=v})("nzOnSearch",function(v){return u.searchCode(v)}),_.YNc(5,V0,1,2,"nz-option",4),_.qZA(),_.qZA(),_.TgZ(6,"div",5),_.TgZ(7,"nz-select",6),_.NdJ("ngModelChange",function(v){return u.provinceChange(v)}),_.YNc(8,j0,1,2,"nz-option",7),_.qZA(),_.qZA(),_.TgZ(9,"div",5),_.TgZ(10,"nz-select",8),_.NdJ("ngModelChange",function(v){return u.distChange(v)}),_.YNc(11,G0,1,2,"nz-option",7),_.qZA(),_.qZA(),_.TgZ(12,"div",5),_.TgZ(13,"nz-select",9),_.NdJ("ngModelChange",function(v){return u.wardChange(v)}),_.YNc(14,H0,1,2,"nz-option",7),_.qZA(),_.qZA(),_.TgZ(15,"div",5),_.TgZ(16,"nz-select",10),_.NdJ("nzScrollToBottom",function(){return u.loadMore()})("ngModelChange",function(v){return u.searchPost(v)}),_.YNc(17,W0,1,2,"nz-option",7),_.YNc(18,Y0,1,1,"ng-template",null,11,_.W1O),_.qZA(),_.qZA(),_.TgZ(20,"div",12),_.TgZ(21,"button",13),_.NdJ("click",function(){return u.searchAll()}),_._uU(22," T\xecm ki\u1ebfm "),_.qZA(),_.qZA(),_.qZA(),_.TgZ(23,"div",14),_.TgZ(24,"div",15),_.TgZ(25,"span",16),_._uU(26,"Th\u1ed1ng k\xea"),_.qZA(),_.YNc(27,K0,1,0,"i",17),_.YNc(28,q0,2,0,"h5",18),_.YNc(29,J0,1,0,"i",17),_.YNc(30,$0,2,1,"h5",18),_.YNc(31,Q0,1,0,"i",17),_.YNc(32,eg,2,1,"h5",18),_.YNc(33,tg,1,0,"i",17),_.YNc(34,rg,2,1,"h5",18),_.YNc(35,ng,1,0,"i",17),_.YNc(36,ig,2,1,"h5",18),_.YNc(37,ag,1,0,"i",17),_.YNc(38,og,2,1,"h5",18),_.qZA(),_.qZA(),_.TgZ(39,"nz-spin",19),_.TgZ(40,"div",20),_.TgZ(41,"div",21),_.TgZ(42,"div"),_.TgZ(43,"div",22),_.TgZ(44,"div",23),_._UZ(45,"nz-statistic",24),_.ALo(46,"number"),_.YNc(47,sg,1,0,"ng-template",null,25,_.W1O),_.qZA(),_.TgZ(49,"div",23),_._UZ(50,"nz-statistic",24),_.ALo(51,"number"),_.YNc(52,ug,1,0,"ng-template",null,26,_.W1O),_.qZA(),_.TgZ(54,"div",23),_._UZ(55,"nz-statistic",24),_.ALo(56,"number"),_.YNc(57,lg,1,0,"ng-template",null,27,_.W1O),_.qZA(),_.TgZ(59,"div",23),_._UZ(60,"nz-statistic",24),_.ALo(61,"number"),_.YNc(62,cg,1,0,"ng-template",null,28,_.W1O),_.qZA(),_.TgZ(64,"div",23),_._UZ(65,"nz-statistic",24),_.ALo(66,"number"),_.YNc(67,fg,1,0,"ng-template",null,29,_.W1O),_.qZA(),_.TgZ(69,"div",23),_._UZ(70,"nz-statistic",24),_.ALo(71,"number"),_.YNc(72,hg,1,0,"ng-template",null,30,_.W1O),_.qZA(),_.TgZ(74,"div",23),_._UZ(75,"nz-statistic",24),_.ALo(76,"number"),_.YNc(77,pg,1,0,"ng-template",null,31,_.W1O),_.qZA(),_.qZA(),_.TgZ(79,"div",32),_.TgZ(80,"p",16),_._uU(81,"Qui \u01b0\u1edbc m\xe0u"),_.qZA(),_._UZ(82,"nz-badge",33),_._UZ(83,"nz-badge",34),_._UZ(84,"nz-badge",35),_.qZA(),_.qZA(),_.qZA(),_.TgZ(85,"div",36),_._UZ(86,"div",37),_.TgZ(87,"div"),_.TgZ(88,"div",38),_.TgZ(89,"span",39),_.NdJ("nzPopoverVisibleChange",function(v){return u.change(v)}),_.qZA(),_.YNc(90,dg,5,1,"ng-template",null,40,_.W1O),_.YNc(92,Cg,112,14,"ng-template",null,41,_.W1O),_.qZA(),_.qZA(),_.TgZ(94,"div"),_.TgZ(95,"div",42),_.TgZ(96,"span",39),_.NdJ("nzPopoverVisibleChange",function(v){return u.changePost(v)}),_.qZA(),_.YNc(97,Ag,6,4,"ng-template",null,43,_.W1O),_.YNc(99,Pg,23,3,"ng-template",null,44,_.W1O),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&i){const f=_.MAs(19),v=_.MAs(48),b=_.MAs(53),P=_.MAs(58),I=_.MAs(63),N=_.MAs(68),se=_.MAs(73),ie=_.MAs(78),Re=_.MAs(91),Je=_.MAs(93),It=_.MAs(98),Zt=_.MAs(100);_.xp6(2),_.Q6J("nzGutter",_.DdM(69,Mg)),_.xp6(2),_.Q6J("ngModel",u.codeSearch)("nzShowArrow",!1)("nzFilterOption",u.nzFilterOption),_.xp6(1),_.Q6J("ngForOf",u.listOfCabinets),_.xp6(2),_.Q6J("ngModel",u.provinceId),_.xp6(1),_.Q6J("ngForOf",u.listOfProvince),_.xp6(2),_.Q6J("ngModel",u.distId),_.xp6(1),_.Q6J("ngForOf",u.listOfDist),_.xp6(2),_.Q6J("ngModel",u.wardId),_.xp6(1),_.Q6J("ngForOf",u.listOfWard),_.xp6(2),_.Q6J("ngModel",u.postId)("nzDropdownRender",f)("nzDropdownRender",f),_.xp6(1),_.Q6J("ngForOf",u.listOfPost),_.xp6(10),_.Q6J("ngIf",null==u.titleBreadCrumbProvince&&null==u.titleBreadCrumbPost&&null==u.titleBreadCrumb),_.xp6(1),_.Q6J("ngIf",null==u.titleBreadCrumbProvince&&null==u.titleBreadCrumbPost&&null==u.titleBreadCrumb),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumbProvince),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumbProvince),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumbDist),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumbDist),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumbWard),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumbWard),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumbPost),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumbPost),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumb),_.xp6(1),_.Q6J("ngIf",null!=u.titleBreadCrumb),_.xp6(1),_.Q6J("nzSpinning",u.isLoadingMap),_.xp6(6),_.Q6J("nzValue",u.totalPost>=0&&u.totalTTB>=0&&u.totalHUB>=0&&u.totalTTKT>=0&&u.totalCH>=0?_.lcZ(46,55,u.totalPost+u.totalTTB+u.totalHUB+u.totalTTKT+u.totalCH):0)("nzTitle","T\u1ed5ng s\u1ed1 b\u01b0u c\u1ee5c")("nzPrefix",v),_.xp6(5),_.Q6J("nzValue",u.totalLocker?_.lcZ(51,57,u.totalLocker):0)("nzTitle","T\u1ed5ng S\u1ed1 Locker")("nzPrefix",b),_.xp6(5),_.Q6J("nzValue",u.activeCount?_.lcZ(56,59,u.activeCount):0)("nzTitle","\u0110ang kh\u1ea3 d\u1ee5ng")("nzPrefix",P),_.xp6(5),_.Q6J("nzValue",u.fullCount?_.lcZ(61,61,u.fullCount):0)("nzTitle","\u0110\u1ea7y")("nzPrefix",I),_.xp6(5),_.Q6J("nzValue",u.errorCount?_.lcZ(66,63,u.errorCount):0)("nzTitle","L\u1ed7i")("nzPrefix",N),_.xp6(5),_.Q6J("nzValue",u.lockerCount?_.lcZ(71,65,u.lockerCount):0)("nzTitle","Kh\xf3a")("nzPrefix",se),_.xp6(5),_.Q6J("nzValue",u.offCount?_.lcZ(76,67,u.offCount):0)("nzTitle","T\u1eaft")("nzPrefix",ie),_.xp6(14),_.Q6J("nzPopoverTitle",Re)("nzPopoverVisible",u.visible)("nzPopoverContent",Je),_.xp6(7),_.Q6J("nzPopoverTitle",It)("nzPopoverVisible",u.visiblePost)("nzPopoverContent",Zt)}},directives:[Wv.bd,W.SK,W.t3,Nd.Vq,zd.JJ,zd.On,w.sg,Xv.ix,F0.dQ,N0.w,Yv.ZU,w.O5,Kv.W,qv.my,Jv.x7,$v.lU,Nd.Ip,Qv.Ls,em.j],pipes:[w.JJ,z0,Z0,U0],styles:[".text-align[_ngcontent-%COMP%]{text-align:center}.next-segment[_ngcontent-%COMP%]{font-size:12px;color:#d9d9d9;margin-right:4px}.map-wrapper[_ngcontent-%COMP%]{justify-content:center;position:relative;min-height:calc(100vh - 220px);margin:6px 0 0;border-radius:6px;overflow:hidden}.top-statistic[_ngcontent-%COMP%]{background-color:#f6f6f6;border-radius:6px;margin:6px 16px 0 0;padding:10px 20px 6px}[_nghost-%COMP%]     .status-tag .ant-badge-status-dot{width:12px;height:12px}#popoverpoint[_ngcontent-%COMP%]{position:absolute}#pointpost[_ngcontent-%COMP%]{position:absolute}.width-full[_ngcontent-%COMP%]{width:100%!important}"]}),n})(),Og=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["cms-manager"]],decls:3,vars:0,consts:[["nz-row","",1,"my-4"],["nz-col","","nzXs","24","nzSm","24","nzMd","24","nzLg","24","nzXl","24"]],template:function(i,u){1&i&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._UZ(2,"cms-map"),_.qZA(),_.qZA())},directives:[W.SK,W.t3,Ig],styles:[""]}),n})();const kg=[{path:"",component:(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=_.Xpm({type:n,selectors:[["cms-dashboard"]],decls:2,vars:0,consts:[[1,"dashboard-wrapper"]],template:function(i,u){1&i&&(_.TgZ(0,"div",0),_._UZ(1,"cms-manager"),_.qZA())},directives:[Og],styles:["[_nghost-%COMP%]     .date-select-charts{min-width:160px}"]}),n})()}];let Lg=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[[p.Bz.forChild(kg)],p.Bz]}),n})();var Rg=M(57674),Dg=M(83385),Bg=M(43654),Fg=M(52079),Ng=M(94401),zg=M(49703),Zg=M(87966),Ug=M(26214),Vg=M(39242),jg=M(13791);let Gg=(()=>{class n{}return n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=_.oAB({type:n}),n.\u0275inj=_.cJS({imports:[[w.ez,Lg,Xv.sL,Qv.PV,W.Jb,Rg.o7,Yv.ZJ,Wv.vh,Dg.S,Bg.HQ,Fg.Wr,Ng.b1,zg.Gb,Nd.LV,Zg.Hb,Fd.JF,zd.u5,Ug.Qp,Vg.VchartsModule,qv.A2,Jv.mS,jg.zf,$v.$6,em.X,Kv.j]]}),n})()},88774:(dr,H,M)=>{dr.exports=M(67941)},70576:(dr,H,M)=>{"use strict";M.d(H,{zL:()=>W,DL:()=>Et,Ht:()=>$e});var ue=6371008.8,w={centimeters:100*ue,centimetres:100*ue,degrees:ue/111325,feet:3.28084*ue,inches:39.37*ue,kilometers:ue/1e3,kilometres:ue/1e3,meters:ue,metres:ue,miles:ue/1609.344,millimeters:1e3*ue,millimetres:1e3*ue,nauticalmiles:ue/1852,radians:1,yards:1.0936*ue};function W(_e,ve,ae){void 0===ae&&(ae={});var de={type:"Feature"};return(0===ae.id||ae.id)&&(de.id=ae.id),ae.bbox&&(de.bbox=ae.bbox),de.properties=ve||{},de.geometry=_e,de}function Et(_e,ve){void 0===ve&&(ve="kilometers");var ae=w[ve];if(!ae)throw new Error(ve+" units is invalid");return _e*ae}function $e(_e){return _e%360*Math.PI/180}},56326:(dr,H,M)=>{"use strict";function ue(w,p,_,W,X){var q={};return Object.keys(W).forEach(function(te){q[te]=W[te]}),q.enumerable=!!q.enumerable,q.configurable=!!q.configurable,("value"in q||q.initializer)&&(q.writable=!0),q=_.slice().reverse().reduce(function(te,Y){return Y(w,p,te)||te},q),X&&void 0!==q.initializer&&(q.value=q.initializer?q.initializer.call(X):void 0,q.initializer=void 0),void 0===q.initializer&&(Object.defineProperty(w,p,q),q=null),q}M.d(H,{Z:()=>ue})},32988:(dr,H,M)=>{"use strict";function ue(w,p){(null==p||p>w.length)&&(p=w.length);for(var _=0,W=new Array(p);_<p;_++)W[_]=w[_];return W}M.d(H,{Z:()=>ue})},66518:(dr,H,M)=>{"use strict";function ue(w){if(void 0===w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w}M.d(H,{Z:()=>ue})},75134:(dr,H,M)=>{"use strict";function ue(w,p){if(!(w instanceof p))throw new TypeError("Cannot call a class as a function")}M.d(H,{Z:()=>ue})},47289:(dr,H,M)=>{"use strict";function ue(p,_){for(var W=0;W<_.length;W++){var X=_[W];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(p,X.key,X)}}function w(p,_,W){return _&&ue(p.prototype,_),W&&ue(p,W),p}M.d(H,{Z:()=>w})},93512:(dr,H,M)=>{"use strict";function ue(w,p,_){return p in w?Object.defineProperty(w,p,{value:_,enumerable:!0,configurable:!0,writable:!0}):w[p]=_,w}M.d(H,{Z:()=>ue})},99187:(dr,H,M)=>{"use strict";function ue(w){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(_){return _.__proto__||Object.getPrototypeOf(_)})(w)}M.d(H,{Z:()=>ue})},41885:(dr,H,M)=>{"use strict";M.d(H,{Z:()=>w});var ue=M(92007);function w(p,_){if("function"!=typeof _&&null!==_)throw new TypeError("Super expression must either be null or a function");p.prototype=Object.create(_&&_.prototype,{constructor:{value:p,writable:!0,configurable:!0}}),_&&(0,ue.Z)(p,_)}},32952:(dr,H,M)=>{"use strict";function ue(w,p,_,W){!_||Object.defineProperty(w,p,{enumerable:_.enumerable,configurable:_.configurable,writable:_.writable,value:_.initializer?_.initializer.call(W):void 0})}M.d(H,{Z:()=>ue})},71189:(dr,H,M)=>{"use strict";function w(p,_){if(null==p)return{};var X,q,W=function(p,_){if(null==p)return{};var q,te,W={},X=Object.keys(p);for(te=0;te<X.length;te++)!(_.indexOf(q=X[te])>=0)&&(W[q]=p[q]);return W}(p,_);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(p);for(q=0;q<te.length;q++)!(_.indexOf(X=te[q])>=0)&&(!Object.prototype.propertyIsEnumerable.call(p,X)||(W[X]=p[X]))}return W}M.d(H,{Z:()=>w})},59553:(dr,H,M)=>{"use strict";M.d(H,{Z:()=>p});var ue=M(85464),w=M(66518);function p(_,W){return!W||"object"!==(0,ue.Z)(W)&&"function"!=typeof W?(0,w.Z)(_):W}},92007:(dr,H,M)=>{"use strict";function ue(w,p){return(ue=Object.setPrototypeOf||function(W,X){return W.__proto__=X,W})(w,p)}M.d(H,{Z:()=>ue})},83838:(dr,H,M)=>{"use strict";M.d(H,{Z:()=>W});var p=M(2491);function W(X,q){return function(X){if(Array.isArray(X))return X}(X)||function(X,q){var te=null==X?null:"undefined"!=typeof Symbol&&X[Symbol.iterator]||X["@@iterator"];if(null!=te){var z,Z,Y=[],Xe=!0,et=!1;try{for(te=te.call(X);!(Xe=(z=te.next()).done)&&(Y.push(z.value),!q||Y.length!==q);Xe=!0);}catch(tt){et=!0,Z=tt}finally{try{!Xe&&null!=te.return&&te.return()}finally{if(et)throw Z}}return Y}}(X,q)||(0,p.Z)(X,q)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},96109:(dr,H,M)=>{"use strict";M.d(H,{Z:()=>X});var ue=M(32988),_=M(2491);function X(q){return function(q){if(Array.isArray(q))return(0,ue.Z)(q)}(q)||function(q){if("undefined"!=typeof Symbol&&null!=q[Symbol.iterator]||null!=q["@@iterator"])return Array.from(q)}(q)||(0,_.Z)(q)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},85464:(dr,H,M)=>{"use strict";function ue(w){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(_){return typeof _}:function(_){return _&&"function"==typeof Symbol&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(w)}M.d(H,{Z:()=>ue})},2491:(dr,H,M)=>{"use strict";M.d(H,{Z:()=>w});var ue=M(32988);function w(p,_){if(p){if("string"==typeof p)return(0,ue.Z)(p,_);var W=Object.prototype.toString.call(p).slice(8,-1);if("Object"===W&&p.constructor&&(W=p.constructor.name),"Map"===W||"Set"===W)return Array.from(p);if("Arguments"===W||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(W))return(0,ue.Z)(p,_)}}}}]);